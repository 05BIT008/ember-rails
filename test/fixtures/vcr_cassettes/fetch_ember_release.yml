---
http_interactions:
- request:
    method: get
    uri: http://builds.emberjs.com/release/ember.js
    body:
      encoding: US-ASCII
      string: ''
    headers:
      Accept:
      - ! '*/*'
      User-Agent:
      - Ruby
  response:
    status:
      code: 200
      message: OK
    headers:
      X-Amz-Id-2:
      - s0JauP705scTi7umUZBUjwVnIvNKy/jFncdbyXkhfN+y0AtvWrhJmAYIOXHQbJNg
      X-Amz-Request-Id:
      - 075D828F9F85C540
      Date:
      - Wed, 30 Oct 2013 21:47:01 GMT
      Last-Modified:
      - Fri, 25 Oct 2013 20:17:10 GMT
      Etag:
      - ! '"361d9070cb86013a50a0f48f472f82ce"'
      Content-Type:
      - text/javascript
      Content-Length:
      - '1040400'
      Server:
      - AmazonS3
    body:
      encoding: ASCII-8BIT
      string: !binary |-
        IC8vIFZlcnNpb246IDEuMS4yCgooZnVuY3Rpb24oKSB7Ci8qZ2xvYmFsIF9f
        ZmFpbF9fKi8KCi8qKgpFbWJlciBEZWJ1ZwoKQG1vZHVsZSBlbWJlcgpAc3Vi
        bW9kdWxlIGVtYmVyLWRlYnVnCiovCgovKioKQGNsYXNzIEVtYmVyCiovCgpp
        ZiAoJ3VuZGVmaW5lZCcgPT09IHR5cGVvZiBFbWJlcikgewogIEVtYmVyID0g
        e307CgogIGlmICgndW5kZWZpbmVkJyAhPT0gdHlwZW9mIHdpbmRvdykgewog
        ICAgd2luZG93LkVtID0gd2luZG93LkVtYmVyID0gRW0gPSBFbWJlcjsKICB9
        Cn0KCkVtYmVyLkVOViA9ICd1bmRlZmluZWQnID09PSB0eXBlb2YgRU5WID8g
        e30gOiBFTlY7CgppZiAoISgnTUFOREFUT1JZX1NFVFRFUicgaW4gRW1iZXIu
        RU5WKSkgewogIEVtYmVyLkVOVi5NQU5EQVRPUllfU0VUVEVSID0gdHJ1ZTsg
        Ly8gZGVmYXVsdCB0byB0cnVlIGZvciBkZWJ1ZyBkaXN0Cn0KCi8qKgogIERl
        ZmluZSBhbiBhc3NlcnRpb24gdGhhdCB3aWxsIHRocm93IGFuIGV4Y2VwdGlv
        biBpZiB0aGUgY29uZGl0aW9uIGlzIG5vdAogIG1ldC4gRW1iZXIgYnVpbGQg
        dG9vbHMgd2lsbCByZW1vdmUgYW55IGNhbGxzIHRvIGBFbWJlci5hc3NlcnQo
        KWAgd2hlbgogIGRvaW5nIGEgcHJvZHVjdGlvbiBidWlsZC4gRXhhbXBsZToK
        CiAgYGBgamF2YXNjcmlwdAogIC8vIFRlc3QgZm9yIHRydXRoaW5lc3MKICBF
        bWJlci5hc3NlcnQoJ011c3QgcGFzcyBhIHZhbGlkIG9iamVjdCcsIG9iaik7
        CiAgLy8gRmFpbCB1bmNvbmRpdGlvbmFsbHkKICBFbWJlci5hc3NlcnQoJ1Ro
        aXMgY29kZSBwYXRoIHNob3VsZCBuZXZlciBiZSBydW4nKQogIGBgYAoKICBA
        bWV0aG9kIGFzc2VydAogIEBwYXJhbSB7U3RyaW5nfSBkZXNjIEEgZGVzY3Jp
        cHRpb24gb2YgdGhlIGFzc2VydGlvbi4gVGhpcyB3aWxsIGJlY29tZQogICAg
        dGhlIHRleHQgb2YgdGhlIEVycm9yIHRocm93biBpZiB0aGUgYXNzZXJ0aW9u
        IGZhaWxzLgogIEBwYXJhbSB7Qm9vbGVhbn0gdGVzdCBNdXN0IGJlIHRydXRo
        eSBmb3IgdGhlIGFzc2VydGlvbiB0byBwYXNzLiBJZgogICAgZmFsc3ksIGFu
        IGV4Y2VwdGlvbiB3aWxsIGJlIHRocm93bi4KKi8KRW1iZXIuYXNzZXJ0ID0g
        ZnVuY3Rpb24oZGVzYywgdGVzdCkgewogIGlmICghdGVzdCkgewogICAgRW1i
        ZXIuTG9nZ2VyLmFzc2VydCh0ZXN0LCBkZXNjKTsKICB9CgogIGlmIChFbWJl
        ci50ZXN0aW5nICYmICF0ZXN0KSB7CiAgICAvLyB3aGVuIHRlc3RpbmcsIGVu
        c3VyZSB0ZXN0IGZhaWx1cmVzIHdoZW4gYXNzZXJ0aW9ucyBmYWlsCiAgICB0
        aHJvdyBuZXcgRW1iZXIuRXJyb3IoIkFzc2VydGlvbiBGYWlsZWQ6ICIgKyBk
        ZXNjKTsKICB9Cn07CgoKLyoqCiAgRGlzcGxheSBhIHdhcm5pbmcgd2l0aCB0
        aGUgcHJvdmlkZWQgbWVzc2FnZS4gRW1iZXIgYnVpbGQgdG9vbHMgd2lsbAog
        IHJlbW92ZSBhbnkgY2FsbHMgdG8gYEVtYmVyLndhcm4oKWAgd2hlbiBkb2lu
        ZyBhIHByb2R1Y3Rpb24gYnVpbGQuCgogIEBtZXRob2Qgd2FybgogIEBwYXJh
        bSB7U3RyaW5nfSBtZXNzYWdlIEEgd2FybmluZyB0byBkaXNwbGF5LgogIEBw
        YXJhbSB7Qm9vbGVhbn0gdGVzdCBBbiBvcHRpb25hbCBib29sZWFuLiBJZiBm
        YWxzeSwgdGhlIHdhcm5pbmcKICAgIHdpbGwgYmUgZGlzcGxheWVkLgoqLwpF
        bWJlci53YXJuID0gZnVuY3Rpb24obWVzc2FnZSwgdGVzdCkgewogIGlmICgh
        dGVzdCkgewogICAgRW1iZXIuTG9nZ2VyLndhcm4oIldBUk5JTkc6ICIrbWVz
        c2FnZSk7CiAgICBpZiAoJ3RyYWNlJyBpbiBFbWJlci5Mb2dnZXIpIEVtYmVy
        LkxvZ2dlci50cmFjZSgpOwogIH0KfTsKCi8qKgogIERpc3BsYXkgYSBkZWJ1
        ZyBub3RpY2UuIEVtYmVyIGJ1aWxkIHRvb2xzIHdpbGwgcmVtb3ZlIGFueSBj
        YWxscyB0bwogIGBFbWJlci5kZWJ1ZygpYCB3aGVuIGRvaW5nIGEgcHJvZHVj
        dGlvbiBidWlsZC4KCiAgYGBgamF2YXNjcmlwdAogIEVtYmVyLmRlYnVnKCJJ
        J20gYSBkZWJ1ZyBub3RpY2UhIik7CiAgYGBgCgogIEBtZXRob2QgZGVidWcK
        ICBAcGFyYW0ge1N0cmluZ30gbWVzc2FnZSBBIGRlYnVnIG1lc3NhZ2UgdG8g
        ZGlzcGxheS4KKi8KRW1iZXIuZGVidWcgPSBmdW5jdGlvbihtZXNzYWdlKSB7
        CiAgRW1iZXIuTG9nZ2VyLmRlYnVnKCJERUJVRzogIittZXNzYWdlKTsKfTsK
        Ci8qKgogIERpc3BsYXkgYSBkZXByZWNhdGlvbiB3YXJuaW5nIHdpdGggdGhl
        IHByb3ZpZGVkIG1lc3NhZ2UgYW5kIGEgc3RhY2sgdHJhY2UKICAoQ2hyb21l
        IGFuZCBGaXJlZm94IG9ubHkpLiBFbWJlciBidWlsZCB0b29scyB3aWxsIHJl
        bW92ZSBhbnkgY2FsbHMgdG8KICBgRW1iZXIuZGVwcmVjYXRlKClgIHdoZW4g
        ZG9pbmcgYSBwcm9kdWN0aW9uIGJ1aWxkLgoKICBAbWV0aG9kIGRlcHJlY2F0
        ZQogIEBwYXJhbSB7U3RyaW5nfSBtZXNzYWdlIEEgZGVzY3JpcHRpb24gb2Yg
        dGhlIGRlcHJlY2F0aW9uLgogIEBwYXJhbSB7Qm9vbGVhbn0gdGVzdCBBbiBv
        cHRpb25hbCBib29sZWFuLiBJZiBmYWxzeSwgdGhlIGRlcHJlY2F0aW9uCiAg
        ICB3aWxsIGJlIGRpc3BsYXllZC4KKi8KRW1iZXIuZGVwcmVjYXRlID0gZnVu
        Y3Rpb24obWVzc2FnZSwgdGVzdCkgewogIGlmIChFbWJlci5URVNUSU5HX0RF
        UFJFQ0FUSU9OKSB7IHJldHVybjsgfQoKICBpZiAoYXJndW1lbnRzLmxlbmd0
        aCA9PT0gMSkgeyB0ZXN0ID0gZmFsc2U7IH0KICBpZiAodGVzdCkgeyByZXR1
        cm47IH0KCiAgaWYgKEVtYmVyLkVOVi5SQUlTRV9PTl9ERVBSRUNBVElPTikg
        eyB0aHJvdyBuZXcgRW1iZXIuRXJyb3IobWVzc2FnZSk7IH0KCiAgdmFyIGVy
        cm9yOwoKICAvLyBXaGVuIHVzaW5nIG5ldyBFcnJvciwgd2UgY2FuJ3QgZG8g
        dGhlIGFyZ3VtZW50cyBjaGVjayBmb3IgQ2hyb21lLiBBbHRlcm5hdGl2ZXMg
        YXJlIHdlbGNvbWUKICB0cnkgeyBfX2ZhaWxfXy5mYWlsKCk7IH0gY2F0Y2gg
        KGUpIHsgZXJyb3IgPSBlOyB9CgogIGlmIChFbWJlci5MT0dfU1RBQ0tUUkFD
        RV9PTl9ERVBSRUNBVElPTiAmJiBlcnJvci5zdGFjaykgewogICAgdmFyIHN0
        YWNrLCBzdGFja1N0ciA9ICcnOwogICAgaWYgKGVycm9yWydhcmd1bWVudHMn
        XSkgewogICAgICAvLyBDaHJvbWUKICAgICAgc3RhY2sgPSBlcnJvci5zdGFj
        ay5yZXBsYWNlKC9eXHMrYXRccysvZ20sICcnKS4KICAgICAgICAgICAgICAg
        ICAgICAgICAgICByZXBsYWNlKC9eKFteXChdKz8pKFtcbiRdKS9nbSwgJ3th
        bm9ueW1vdXN9KCQxKSQyJykuCiAgICAgICAgICAgICAgICAgICAgICAgICAg
        cmVwbGFjZSgvXk9iamVjdC48YW5vbnltb3VzPlxzKlwoKFteXCldKylcKS9n
        bSwgJ3thbm9ueW1vdXN9KCQxKScpLnNwbGl0KCdcbicpOwogICAgICBzdGFj
        ay5zaGlmdCgpOwogICAgfSBlbHNlIHsKICAgICAgLy8gRmlyZWZveAogICAg
        ICBzdGFjayA9IGVycm9yLnN0YWNrLnJlcGxhY2UoLyg/OlxuQDowKT9ccysk
        L20sICcnKS4KICAgICAgICAgICAgICAgICAgICAgICAgICByZXBsYWNlKC9e
        XCgvZ20sICd7YW5vbnltb3VzfSgnKS5zcGxpdCgnXG4nKTsKICAgIH0KCiAg
        ICBzdGFja1N0ciA9ICJcbiAgICAiICsgc3RhY2suc2xpY2UoMikuam9pbigi
        XG4gICAgIik7CiAgICBtZXNzYWdlID0gbWVzc2FnZSArIHN0YWNrU3RyOwog
        IH0KCiAgRW1iZXIuTG9nZ2VyLndhcm4oIkRFUFJFQ0FUSU9OOiAiK21lc3Nh
        Z2UpOwp9OwoKCgovKioKICBBbGlhcyBhbiBvbGQsIGRlcHJlY2F0ZWQgbWV0
        aG9kIHdpdGggaXRzIG5ldyBjb3VudGVycGFydC4KCiAgRGlzcGxheSBhIGRl
        cHJlY2F0aW9uIHdhcm5pbmcgd2l0aCB0aGUgcHJvdmlkZWQgbWVzc2FnZSBh
        bmQgYSBzdGFjayB0cmFjZQogIChDaHJvbWUgYW5kIEZpcmVmb3ggb25seSkg
        d2hlbiB0aGUgYXNzaWduZWQgbWV0aG9kIGlzIGNhbGxlZC4KCiAgRW1iZXIg
        YnVpbGQgdG9vbHMgd2lsbCBub3QgcmVtb3ZlIGNhbGxzIHRvIGBFbWJlci5k
        ZXByZWNhdGVGdW5jKClgLCB0aG91Z2gKICBubyB3YXJuaW5ncyB3aWxsIGJl
        IHNob3duIGluIHByb2R1Y3Rpb24uCgogIGBgYGphdmFzY3JpcHQKICBFbWJl
        ci5vbGRNZXRob2QgPSBFbWJlci5kZXByZWNhdGVGdW5jKCJQbGVhc2UgdXNl
        IHRoZSBuZXcsIHVwZGF0ZWQgbWV0aG9kIiwgRW1iZXIubmV3TWV0aG9kKTsK
        ICBgYGAKCiAgQG1ldGhvZCBkZXByZWNhdGVGdW5jCiAgQHBhcmFtIHtTdHJp
        bmd9IG1lc3NhZ2UgQSBkZXNjcmlwdGlvbiBvZiB0aGUgZGVwcmVjYXRpb24u
        CiAgQHBhcmFtIHtGdW5jdGlvbn0gZnVuYyBUaGUgbmV3IGZ1bmN0aW9uIGNh
        bGxlZCB0byByZXBsYWNlIGl0cyBkZXByZWNhdGVkIGNvdW50ZXJwYXJ0Lgog
        IEByZXR1cm4ge0Z1bmN0aW9ufSBhIG5ldyBmdW5jdGlvbiB0aGF0IHdyYXBw
        ZWQgdGhlIG9yaWdpbmFsIGZ1bmN0aW9uIHdpdGggYSBkZXByZWNhdGlvbiB3
        YXJuaW5nCiovCkVtYmVyLmRlcHJlY2F0ZUZ1bmMgPSBmdW5jdGlvbihtZXNz
        YWdlLCBmdW5jKSB7CiAgcmV0dXJuIGZ1bmN0aW9uKCkgewogICAgRW1iZXIu
        ZGVwcmVjYXRlKG1lc3NhZ2UpOwogICAgcmV0dXJuIGZ1bmMuYXBwbHkodGhp
        cywgYXJndW1lbnRzKTsKICB9Owp9OwoKCi8vIEluZm9ybSB0aGUgZGV2ZWxv
        cGVyIGFib3V0IHRoZSBFbWJlciBJbnNwZWN0b3IgaWYgbm90IGluc3RhbGxl
        ZC4KaWYgKCFFbWJlci50ZXN0aW5nKSB7CiAgaWYgKHR5cGVvZiB3aW5kb3cg
        IT09ICd1bmRlZmluZWQnICYmIHdpbmRvdy5jaHJvbWUgJiYgd2luZG93LmFk
        ZEV2ZW50TGlzdGVuZXIpIHsKICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVy
        KCJsb2FkIiwgZnVuY3Rpb24oKSB7CiAgICAgIGlmIChkb2N1bWVudC5ib2R5
        ICYmIGRvY3VtZW50LmJvZHkuZGF0YXNldCAmJiAhZG9jdW1lbnQuYm9keS5k
        YXRhc2V0LmVtYmVyRXh0ZW5zaW9uKSB7CiAgICAgICAgRW1iZXIuZGVidWco
        J0ZvciBtb3JlIGFkdmFuY2VkIGRlYnVnZ2luZywgaW5zdGFsbCB0aGUgRW1i
        ZXIgSW5zcGVjdG9yIGZyb20gaHR0cHM6Ly9jaHJvbWUuZ29vZ2xlLmNvbS93
        ZWJzdG9yZS9kZXRhaWwvZW1iZXItaW5zcGVjdG9yL2JtZGJsbmNlZ2tlbmth
        Y2llaWhmaHBqZnBwb2NvbmhpJyk7CiAgICAgIH0KICAgIH0sIGZhbHNlKTsK
        ICB9Cn0KCn0pKCk7CgogLy8gVmVyc2lvbjogMS4xLjIKCihmdW5jdGlvbigp
        IHsKdmFyIGRlZmluZSwgcmVxdWlyZU1vZHVsZTsKCihmdW5jdGlvbigpIHsK
        ICB2YXIgcmVnaXN0cnkgPSB7fSwgc2VlbiA9IHt9OwoKICBkZWZpbmUgPSBm
        dW5jdGlvbihuYW1lLCBkZXBzLCBjYWxsYmFjaykgewogICAgcmVnaXN0cnlb
        bmFtZV0gPSB7IGRlcHM6IGRlcHMsIGNhbGxiYWNrOiBjYWxsYmFjayB9Owog
        IH07CgogIHJlcXVpcmVNb2R1bGUgPSBmdW5jdGlvbihuYW1lKSB7CiAgICBp
        ZiAoc2VlbltuYW1lXSkgeyByZXR1cm4gc2VlbltuYW1lXTsgfQogICAgc2Vl
        bltuYW1lXSA9IHt9OwoKICAgIHZhciBtb2QsIGRlcHMsIGNhbGxiYWNrLCBy
        ZWlmaWVkLCBleHBvcnRzOwoKICAgIG1vZCA9IHJlZ2lzdHJ5W25hbWVdOwoK
        ICAgIGlmICghbW9kKSB7CiAgICAgIHRocm93IG5ldyBFcnJvcigiTW9kdWxl
        ICciICsgbmFtZSArICInIG5vdCBmb3VuZC4iKTsKICAgIH0KCiAgICBkZXBz
        ID0gbW9kLmRlcHM7CiAgICBjYWxsYmFjayA9IG1vZC5jYWxsYmFjazsKICAg
        IHJlaWZpZWQgPSBbXTsKCiAgICBmb3IgKHZhciBpPTAsIGw9ZGVwcy5sZW5n
        dGg7IGk8bDsgaSsrKSB7CiAgICAgIGlmIChkZXBzW2ldID09PSAnZXhwb3J0
        cycpIHsKICAgICAgICByZWlmaWVkLnB1c2goZXhwb3J0cyA9IHt9KTsKICAg
        ICAgfSBlbHNlIHsKICAgICAgICByZWlmaWVkLnB1c2gocmVxdWlyZU1vZHVs
        ZShkZXBzW2ldKSk7CiAgICAgIH0KICAgIH0KCiAgICB2YXIgdmFsdWUgPSBj
        YWxsYmFjay5hcHBseSh0aGlzLCByZWlmaWVkKTsKICAgIHJldHVybiBzZWVu
        W25hbWVdID0gZXhwb3J0cyB8fCB2YWx1ZTsKICB9Owp9KSgpOwooZnVuY3Rp
        b24oKSB7Ci8qZ2xvYmFscyBFbTp0cnVlIEVOViAqLwoKLyoqCkBtb2R1bGUg
        ZW1iZXIKQHN1Ym1vZHVsZSBlbWJlci1tZXRhbAoqLwoKLyoqCiAgQWxsIEVt
        YmVyIG1ldGhvZHMgYW5kIGZ1bmN0aW9ucyBhcmUgZGVmaW5lZCBpbnNpZGUg
        b2YgdGhpcyBuYW1lc3BhY2UuIFlvdQogIGdlbmVyYWxseSBzaG91bGQgbm90
        IGFkZCBuZXcgcHJvcGVydGllcyB0byB0aGlzIG5hbWVzcGFjZSBhcyBpdCBt
        YXkgYmUKICBvdmVyd3JpdHRlbiBieSBmdXR1cmUgdmVyc2lvbnMgb2YgRW1i
        ZXIuCgogIFlvdSBjYW4gYWxzbyB1c2UgdGhlIHNob3J0aGFuZCBgRW1gIGlu
        c3RlYWQgb2YgYEVtYmVyYC4KCiAgRW1iZXItUnVudGltZSBpcyBhIGZyYW1l
        d29yayB0aGF0IHByb3ZpZGVzIGNvcmUgZnVuY3Rpb25zIGZvciBFbWJlciBp
        bmNsdWRpbmcKICBjcm9zcy1wbGF0Zm9ybSBmdW5jdGlvbnMsIHN1cHBvcnQg
        Zm9yIHByb3BlcnR5IG9ic2VydmluZyBhbmQgb2JqZWN0cy4gSXRzCiAgZm9j
        dXMgaXMgb24gc21hbGwgc2l6ZSBhbmQgcGVyZm9ybWFuY2UuIFlvdSBjYW4g
        dXNlIHRoaXMgaW4gcGxhY2Ugb2Ygb3IKICBhbG9uZy1zaWRlIG90aGVyIGNy
        b3NzLXBsYXRmb3JtIGxpYnJhcmllcyBzdWNoIGFzIGpRdWVyeS4KCiAgVGhl
        IGNvcmUgUnVudGltZSBmcmFtZXdvcmsgaXMgYmFzZWQgb24gdGhlIGpRdWVy
        eSBBUEkgd2l0aCBhIG51bWJlciBvZgogIHBlcmZvcm1hbmNlIG9wdGltaXph
        dGlvbnMuCgogIEBjbGFzcyBFbWJlcgogIEBzdGF0aWMKICBAdmVyc2lvbiAx
        LjEuMgoqLwoKaWYgKCd1bmRlZmluZWQnID09PSB0eXBlb2YgRW1iZXIpIHsK
        ICAvLyBDcmVhdGUgY29yZSBvYmplY3QuIE1ha2UgaXQgYWN0IGxpa2UgYW4g
        aW5zdGFuY2Ugb2YgRW1iZXIuTmFtZXNwYWNlIHNvIHRoYXQKICAvLyBvYmpl
        Y3RzIGFzc2lnbmVkIHRvIGl0IGFyZSBnaXZlbiBhIHNhbmUgc3RyaW5nIHJl
        cHJlc2VudGF0aW9uLgogIEVtYmVyID0ge307Cn0KCi8vIERlZmF1bHQgaW1w
        b3J0cywgZXhwb3J0cyBhbmQgbG9va3VwIHRvIHRoZSBnbG9iYWwgb2JqZWN0
        Owp2YXIgaW1wb3J0cyA9IEVtYmVyLmltcG9ydHMgPSBFbWJlci5pbXBvcnRz
        IHx8IHRoaXM7CnZhciBleHBvcnRzID0gRW1iZXIuZXhwb3J0cyA9IEVtYmVy
        LmV4cG9ydHMgfHwgdGhpczsKdmFyIGxvb2t1cCAgPSBFbWJlci5sb29rdXAg
        ID0gRW1iZXIubG9va3VwICB8fCB0aGlzOwoKLy8gYWxpYXNlcyBuZWVkZWQg
        dG8ga2VlcCBtaW5pZmllcnMgZnJvbSByZW1vdmluZyB0aGUgZ2xvYmFsIGNv
        bnRleHQKZXhwb3J0cy5FbSA9IGV4cG9ydHMuRW1iZXIgPSBFbSA9IEVtYmVy
        OwoKLy8gTWFrZSBzdXJlIHRoZXNlIGFyZSBzZXQgd2hldGhlciBFbWJlciB3
        YXMgYWxyZWFkeSBkZWZpbmVkIG9yIG5vdAoKRW1iZXIuaXNOYW1lc3BhY2Ug
        PSB0cnVlOwoKRW1iZXIudG9TdHJpbmcgPSBmdW5jdGlvbigpIHsgcmV0dXJu
        ICJFbWJlciI7IH07CgoKLyoqCiAgQHByb3BlcnR5IFZFUlNJT04KICBAdHlw
        ZSBTdHJpbmcKICBAZGVmYXVsdCAnMS4xLjInCiAgQGZpbmFsCiovCkVtYmVy
        LlZFUlNJT04gPSAnMS4xLjInOwoKLyoqCiAgU3RhbmRhcmQgZW52aXJvbm1l
        bnRhbCB2YXJpYWJsZXMuIFlvdSBjYW4gZGVmaW5lIHRoZXNlIGluIGEgZ2xv
        YmFsIGBFTlZgCiAgdmFyaWFibGUgYmVmb3JlIGxvYWRpbmcgRW1iZXIgdG8g
        Y29udHJvbCB2YXJpb3VzIGNvbmZpZ3VyYXRpb24KICBzZXR0aW5ncy4KCiAg
        QHByb3BlcnR5IEVOVgogIEB0eXBlIEhhc2gKKi8KCmlmICgndW5kZWZpbmVk
        JyA9PT0gdHlwZW9mIEVOVikgewogIGV4cG9ydHMuRU5WID0ge307Cn0KCi8v
        IFdlIGRpc2FibGUgdGhlIFJBTkdFIEFQSSBieSBkZWZhdWx0IGZvciBwZXJm
        b3JtYW5jZSByZWFzb25zCmlmICgndW5kZWZpbmVkJyA9PT0gdHlwZW9mIEVO
        Vi5ESVNBQkxFX1JBTkdFX0FQSSkgewogIEVOVi5ESVNBQkxFX1JBTkdFX0FQ
        SSA9IHRydWU7Cn0KCgpFbWJlci5FTlYgPSBFbWJlci5FTlYgfHwgRU5WOwoK
        RW1iZXIuY29uZmlnID0gRW1iZXIuY29uZmlnIHx8IHt9OwoKLyoqCiAgSGFz
        aCBvZiBlbmFibGVkIENhbmFyeSBmZWF0dXJlcy4gQWRkIHRvIGJlZm9yZSBj
        cmVhdGluZyB5b3VyIGFwcGxpY2F0aW9uLgoKICBAcHJvcGVydHkgRkVBVFVS
        RVMKICBAdHlwZSBIYXNoCiovCgpFbWJlci5GRUFUVVJFUyA9IHt9OwoKLyoq
        CiAgVGVzdCB0aGF0IGEgZmVhdHVyZSBpcyBlbmFibGVkLiBQYXJzZWQgYnkg
        RW1iZXIncyBidWlsZCB0b29scyB0byBsZWF2ZQogIGV4cGVyaW1lbnRhbCBm
        ZWF0dXJlcyBvdXQgb2YgYmV0YS9zdGFibGUgYnVpbGRzLgoKICBAbWV0aG9k
        IGlzRW5hYmxlZAogIEBwYXJhbSB7c3RyaW5nfSBmZWF0dXJlCiovCgpFbWJl
        ci5GRUFUVVJFUy5pc0VuYWJsZWQgPSBmdW5jdGlvbihmZWF0dXJlKSB7CiAg
        cmV0dXJuIEVtYmVyLkZFQVRVUkVTW2ZlYXR1cmVdOwp9OwoKLy8gLi4uLi4u
        Li4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4u
        Li4uLi4uLgovLyBCT09UU1RSQVAKLy8KCi8qKgogIERldGVybWluZXMgd2hl
        dGhlciBFbWJlciBzaG91bGQgZW5oYW5jZXMgc29tZSBidWlsdC1pbiBvYmpl
        Y3QgcHJvdG90eXBlcyB0bwogIHByb3ZpZGUgYSBtb3JlIGZyaWVuZGx5IEFQ
        SS4gSWYgZW5hYmxlZCwgYSBmZXcgbWV0aG9kcyB3aWxsIGJlIGFkZGVkIHRv
        CiAgYEZ1bmN0aW9uYCwgYFN0cmluZ2AsIGFuZCBgQXJyYXlgLiBgT2JqZWN0
        LnByb3RvdHlwZWAgd2lsbCBub3QgYmUgZW5oYW5jZWQsCiAgd2hpY2ggaXMg
        dGhlIG9uZSB0aGF0IGNhdXNlcyBtb3N0IHRyb3VibGUgZm9yIHBlb3BsZS4K
        CiAgSW4gZ2VuZXJhbCB3ZSByZWNvbW1lbmQgbGVhdmluZyB0aGlzIG9wdGlv
        biBzZXQgdG8gdHJ1ZSBzaW5jZSBpdCByYXJlbHkKICBjb25mbGljdHMgd2l0
        aCBvdGhlciBjb2RlLiBJZiB5b3UgbmVlZCB0byB0dXJuIGl0IG9mZiBob3dl
        dmVyLCB5b3UgY2FuCiAgZGVmaW5lIGFuIGBFTlYuRVhURU5EX1BST1RPVFlQ
        RVNgIGNvbmZpZyB0byBkaXNhYmxlIGl0LgoKICBAcHJvcGVydHkgRVhURU5E
        X1BST1RPVFlQRVMKICBAdHlwZSBCb29sZWFuCiAgQGRlZmF1bHQgdHJ1ZQoq
        LwpFbWJlci5FWFRFTkRfUFJPVE9UWVBFUyA9IEVtYmVyLkVOVi5FWFRFTkRf
        UFJPVE9UWVBFUzsKCmlmICh0eXBlb2YgRW1iZXIuRVhURU5EX1BST1RPVFlQ
        RVMgPT09ICd1bmRlZmluZWQnKSB7CiAgRW1iZXIuRVhURU5EX1BST1RPVFlQ
        RVMgPSB0cnVlOwp9CgovKioKICBEZXRlcm1pbmVzIHdoZXRoZXIgRW1iZXIg
        bG9ncyBhIGZ1bGwgc3RhY2sgdHJhY2UgZHVyaW5nIGRlcHJlY2F0aW9uIHdh
        cm5pbmdzCgogIEBwcm9wZXJ0eSBMT0dfU1RBQ0tUUkFDRV9PTl9ERVBSRUNB
        VElPTgogIEB0eXBlIEJvb2xlYW4KICBAZGVmYXVsdCB0cnVlCiovCkVtYmVy
        LkxPR19TVEFDS1RSQUNFX09OX0RFUFJFQ0FUSU9OID0gKEVtYmVyLkVOVi5M
        T0dfU1RBQ0tUUkFDRV9PTl9ERVBSRUNBVElPTiAhPT0gZmFsc2UpOwoKLyoq
        CiAgRGV0ZXJtaW5lcyB3aGV0aGVyIEVtYmVyIHNob3VsZCBhZGQgRUNNQVNj
        cmlwdCA1IHNoaW1zIHRvIG9sZGVyIGJyb3dzZXJzLgoKICBAcHJvcGVydHkg
        U0hJTV9FUzUKICBAdHlwZSBCb29sZWFuCiAgQGRlZmF1bHQgRW1iZXIuRVhU
        RU5EX1BST1RPVFlQRVMKKi8KRW1iZXIuU0hJTV9FUzUgPSAoRW1iZXIuRU5W
        LlNISU1fRVM1ID09PSBmYWxzZSkgPyBmYWxzZSA6IEVtYmVyLkVYVEVORF9Q
        Uk9UT1RZUEVTOwoKLyoqCiAgRGV0ZXJtaW5lcyB3aGV0aGVyIEVtYmVyIGxv
        Z3MgaW5mbyBhYm91dCB2ZXJzaW9uIG9mIHVzZWQgbGlicmFyaWVzCgogIEBw
        cm9wZXJ0eSBMT0dfVkVSU0lPTgogIEB0eXBlIEJvb2xlYW4KICBAZGVmYXVs
        dCB0cnVlCiovCkVtYmVyLkxPR19WRVJTSU9OID0gKEVtYmVyLkVOVi5MT0df
        VkVSU0lPTiA9PT0gZmFsc2UpID8gZmFsc2UgOiB0cnVlOwoKLyoqCiAgRW1w
        dHkgZnVuY3Rpb24uIFVzZWZ1bCBmb3Igc29tZSBvcGVyYXRpb25zLiBBbHdh
        eXMgcmV0dXJucyBgdGhpc2AuCgogIEBtZXRob2QgSwogIEBwcml2YXRlCiAg
        QHJldHVybiB7T2JqZWN0fQoqLwpFbWJlci5LID0gZnVuY3Rpb24oKSB7IHJl
        dHVybiB0aGlzOyB9OwoKCi8vIFN0dWIgb3V0IHRoZSBtZXRob2RzIGRlZmlu
        ZWQgYnkgdGhlIGVtYmVyLWRlYnVnIHBhY2thZ2UgaW4gY2FzZSBpdCdzIG5v
        dCBsb2FkZWQKCmlmICgndW5kZWZpbmVkJyA9PT0gdHlwZW9mIEVtYmVyLmFz
        c2VydCkgeyBFbWJlci5hc3NlcnQgPSBFbWJlci5LOyB9CmlmICgndW5kZWZp
        bmVkJyA9PT0gdHlwZW9mIEVtYmVyLndhcm4pIHsgRW1iZXIud2FybiA9IEVt
        YmVyLks7IH0KaWYgKCd1bmRlZmluZWQnID09PSB0eXBlb2YgRW1iZXIuZGVi
        dWcpIHsgRW1iZXIuZGVidWcgPSBFbWJlci5LOyB9CmlmICgndW5kZWZpbmVk
        JyA9PT0gdHlwZW9mIEVtYmVyLmRlcHJlY2F0ZSkgeyBFbWJlci5kZXByZWNh
        dGUgPSBFbWJlci5LOyB9CmlmICgndW5kZWZpbmVkJyA9PT0gdHlwZW9mIEVt
        YmVyLmRlcHJlY2F0ZUZ1bmMpIHsKICBFbWJlci5kZXByZWNhdGVGdW5jID0g
        ZnVuY3Rpb24oXywgZnVuYykgeyByZXR1cm4gZnVuYzsgfTsKfQoKLyoqCiAg
        UHJldmlvdXNseSB3ZSB1c2VkIGBFbWJlci4kLnV1aWRgLCBob3dldmVyIGAk
        LnV1aWRgIGhhcyBiZWVuIHJlbW92ZWQgZnJvbQogIGpRdWVyeSBtYXN0ZXIu
        IFdlJ2xsIGp1c3QgYm9vdHN0cmFwIG91ciBvd24gdXVpZCBub3cuCgogIEBw
        cm9wZXJ0eSB1dWlkCiAgQHR5cGUgTnVtYmVyCiAgQHByaXZhdGUKKi8KRW1i
        ZXIudXVpZCA9IDA7CgovLyAuLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4u
        Li4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uCi8vIExPR0dFUgovLwoK
        ZnVuY3Rpb24gY29uc29sZU1ldGhvZChuYW1lKSB7CiAgdmFyIGNvbnNvbGVP
        Ymo7CiAgaWYgKGltcG9ydHMuY29uc29sZSkgewogICAgY29uc29sZU9iaiA9
        IGltcG9ydHMuY29uc29sZTsKICB9IGVsc2UgaWYgKHR5cGVvZiBjb25zb2xl
        ICE9PSAndW5kZWZpbmVkJykgewogICAgY29uc29sZU9iaiA9IGNvbnNvbGU7
        CiAgfQoKICB2YXIgbWV0aG9kID0gdHlwZW9mIGNvbnNvbGVPYmogPT09ICdv
        YmplY3QnID8gY29uc29sZU9ialtuYW1lXSA6IG51bGw7CgogIGlmIChtZXRo
        b2QpIHsKICAgIC8vIE9sZGVyIElFIGRvZXNuJ3Qgc3VwcG9ydCBhcHBseSwg
        YnV0IENocm9tZSBuZWVkcyBpdAogICAgaWYgKG1ldGhvZC5hcHBseSkgewog
        ICAgICByZXR1cm4gZnVuY3Rpb24oKSB7CiAgICAgICAgbWV0aG9kLmFwcGx5
        KGNvbnNvbGVPYmosIGFyZ3VtZW50cyk7CiAgICAgIH07CiAgICB9IGVsc2Ug
        ewogICAgICByZXR1cm4gZnVuY3Rpb24oKSB7CiAgICAgICAgdmFyIG1lc3Nh
        Z2UgPSBBcnJheS5wcm90b3R5cGUuam9pbi5jYWxsKGFyZ3VtZW50cywgJywg
        Jyk7CiAgICAgICAgbWV0aG9kKG1lc3NhZ2UpOwogICAgICB9OwogICAgfQog
        IH0KfQoKZnVuY3Rpb24gYXNzZXJ0UG9seWZpbGwodGVzdCwgbWVzc2FnZSkg
        ewogIGlmICghdGVzdCkgewogICAgdHJ5IHsKICAgICAgLy8gYXR0ZW1wdCB0
        byBwcmVzZXJ2ZSB0aGUgc3RhY2sKICAgICAgdGhyb3cgbmV3IEVycm9yKCJh
        c3NlcnRpb24gZmFpbGVkOiAiICsgbWVzc2FnZSk7CiAgICB9IGNhdGNoKGVy
        cm9yKSB7CiAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7CiAgICAgICAg
        dGhyb3cgZXJyb3I7CiAgICAgIH0sIDApOwogICAgfQogIH0KfQoKLyoqCiAg
        SW5zaWRlIEVtYmVyLU1ldGFsLCBzaW1wbHkgdXNlcyB0aGUgbWV0aG9kcyBm
        cm9tIGBpbXBvcnRzLmNvbnNvbGVgLgogIE92ZXJyaWRlIHRoaXMgdG8gcHJv
        dmlkZSBtb3JlIHJvYnVzdCBsb2dnaW5nIGZ1bmN0aW9uYWxpdHkuCgogIEBj
        bGFzcyBMb2dnZXIKICBAbmFtZXNwYWNlIEVtYmVyCiovCkVtYmVyLkxvZ2dl
        ciA9IHsKICAvKioKICAgTG9ncyB0aGUgYXJndW1lbnRzIHRvIHRoZSBjb25z
        b2xlLgogICBZb3UgY2FuIHBhc3MgYXMgbWFueSBhcmd1bWVudHMgYXMgeW91
        IHdhbnQgYW5kIHRoZXkgd2lsbCBiZSBqb2luZWQgdG9nZXRoZXIgd2l0aCBh
        IHNwYWNlLgoKICAgIGBgYGphdmFzY3JpcHQKICAgIHZhciBmb28gPSAxOwog
        ICAgRW1iZXIuTG9nZ2VyLmxvZygnbG9nIHZhbHVlIG9mIGZvbzonLCBmb28p
        OyAvLyAibG9nIHZhbHVlIG9mIGZvbzogMSIgd2lsbCBiZSBwcmludGVkIHRv
        IHRoZSBjb25zb2xlCiAgICBgYGAKCiAgIEBtZXRob2QgbG9nCiAgIEBmb3Ig
        RW1iZXIuTG9nZ2VyCiAgIEBwYXJhbSB7Kn0gYXJndW1lbnRzCiAgKi8KICBs
        b2c6ICAgY29uc29sZU1ldGhvZCgnbG9nJykgICB8fCBFbWJlci5LLAogIC8q
        KgogICBQcmludHMgdGhlIGFyZ3VtZW50cyB0byB0aGUgY29uc29sZSB3aXRo
        IGEgd2FybmluZyBpY29uLgogICBZb3UgY2FuIHBhc3MgYXMgbWFueSBhcmd1
        bWVudHMgYXMgeW91IHdhbnQgYW5kIHRoZXkgd2lsbCBiZSBqb2luZWQgdG9n
        ZXRoZXIgd2l0aCBhIHNwYWNlLgoKICAgIGBgYGphdmFzY3JpcHQKICAgIEVt
        YmVyLkxvZ2dlci53YXJuKCdTb21ldGhpbmcgaGFwcGVuZWQhJyk7IC8vICJT
        b21ldGhpbmcgaGFwcGVuZWQhIiB3aWxsIGJlIHByaW50ZWQgdG8gdGhlIGNv
        bnNvbGUgd2l0aCBhIHdhcm5pbmcgaWNvbi4KICAgIGBgYAoKICAgQG1ldGhv
        ZCB3YXJuCiAgIEBmb3IgRW1iZXIuTG9nZ2VyCiAgIEBwYXJhbSB7Kn0gYXJn
        dW1lbnRzCiAgKi8KICB3YXJuOiAgY29uc29sZU1ldGhvZCgnd2FybicpICB8
        fCBFbWJlci5LLAogIC8qKgogICBQcmludHMgdGhlIGFyZ3VtZW50cyB0byB0
        aGUgY29uc29sZSB3aXRoIGFuIGVycm9yIGljb24sIHJlZCB0ZXh0IGFuZCBh
        IHN0YWNrIHJhY2UuCiAgIFlvdSBjYW4gcGFzcyBhcyBtYW55IGFyZ3VtZW50
        cyBhcyB5b3Ugd2FudCBhbmQgdGhleSB3aWxsIGJlIGpvaW5lZCB0b2dldGhl
        ciB3aXRoIGEgc3BhY2UuCgogICAgYGBgamF2YXNjcmlwdAogICAgRW1iZXIu
        TG9nZ2VyLmVycm9yKCdEYW5nZXIhIERhbmdlciEnKTsgLy8gIkRhbmdlciEg
        RGFuZ2VyISIgd2lsbCBiZSBwcmludGVkIHRvIHRoZSBjb25zb2xlIGluIHJl
        ZCB0ZXh0LgogICAgYGBgCgogICBAbWV0aG9kIGVycm9yCiAgIEBmb3IgRW1i
        ZXIuTG9nZ2VyCiAgIEBwYXJhbSB7Kn0gYXJndW1lbnRzCiAgKi8KICBlcnJv
        cjogY29uc29sZU1ldGhvZCgnZXJyb3InKSB8fCBFbWJlci5LLAogIC8qKgog
        ICBMb2dzIHRoZSBhcmd1bWVudHMgdG8gdGhlIGNvbnNvbGUuCiAgIFlvdSBj
        YW4gcGFzcyBhcyBtYW55IGFyZ3VtZW50cyBhcyB5b3Ugd2FudCBhbmQgdGhl
        eSB3aWxsIGJlIGpvaW5lZCB0b2dldGhlciB3aXRoIGEgc3BhY2UuCgogICAg
        YGBgamF2YXNjcmlwdAogICAgdmFyIGZvbyA9IDE7CiAgICBFbWJlci5Mb2dn
        ZXIuaW5mbygnbG9nIHZhbHVlIG9mIGZvbzonLCBmb28pOyAvLyAibG9nIHZh
        bHVlIG9mIGZvbzogMSIgd2lsbCBiZSBwcmludGVkIHRvIHRoZSBjb25zb2xl
        CiAgICBgYGAKCiAgIEBtZXRob2QgaW5mbwogICBAZm9yIEVtYmVyLkxvZ2dl
        cgogICBAcGFyYW0geyp9IGFyZ3VtZW50cwogICovCiAgaW5mbzogIGNvbnNv
        bGVNZXRob2QoJ2luZm8nKSAgfHwgRW1iZXIuSywKICAvKioKICAgTG9ncyB0
        aGUgYXJndW1lbnRzIHRvIHRoZSBjb25zb2xlIGluIGJsdWUgdGV4dC4KICAg
        WW91IGNhbiBwYXNzIGFzIG1hbnkgYXJndW1lbnRzIGFzIHlvdSB3YW50IGFu
        ZCB0aGV5IHdpbGwgYmUgam9pbmVkIHRvZ2V0aGVyIHdpdGggYSBzcGFjZS4K
        CiAgICBgYGBqYXZhc2NyaXB0CiAgICB2YXIgZm9vID0gMTsKICAgIEVtYmVy
        LkxvZ2dlci5kZWJ1ZygnbG9nIHZhbHVlIG9mIGZvbzonLCBmb28pOyAvLyAi
        bG9nIHZhbHVlIG9mIGZvbzogMSIgd2lsbCBiZSBwcmludGVkIHRvIHRoZSBj
        b25zb2xlCiAgICBgYGAKCiAgIEBtZXRob2QgZGVidWcKICAgQGZvciBFbWJl
        ci5Mb2dnZXIKICAgQHBhcmFtIHsqfSBhcmd1bWVudHMKICAqLwogIGRlYnVn
        OiBjb25zb2xlTWV0aG9kKCdkZWJ1ZycpIHx8IGNvbnNvbGVNZXRob2QoJ2lu
        Zm8nKSB8fCBFbWJlci5LLAogIC8qKgoKICAgSWYgdGhlIHZhbHVlIHBhc3Nl
        ZCBpbnRvIEVtYmVyLkxvZ2dlci5hc3NlcnQgaXMgbm90IHRydXRoeSBpdCB3
        aWxsIHRocm93IGFuIGVycm9yIHdpdGggYSBzdGFjayB0cmFjZS4KCiAgICBg
        YGBqYXZhc2NyaXB0CiAgICBFbWJlci5Mb2dnZXIuYXNzZXJ0KHRydWUpOyAv
        LyB1bmRlZmluZWQKICAgIEVtYmVyLkxvZ2dlci5hc3NlcnQodHJ1ZSA9PT0g
        ZmFsc2UpOyAvLyBUaHJvd3MgYW4gQXNzZXJ0aW9uIGZhaWxlZCBlcnJvci4K
        ICAgIGBgYAoKICAgQG1ldGhvZCBhc3NlcnQKICAgQGZvciBFbWJlci5Mb2dn
        ZXIKICAgQHBhcmFtIHtCb29sZWFufSBib29sIFZhbHVlIHRvIHRlc3QKICAq
        LwogIGFzc2VydDogY29uc29sZU1ldGhvZCgnYXNzZXJ0JykgfHwgYXNzZXJ0
        UG9seWZpbGwKfTsKCgovLyAuLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4u
        Li4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uCi8vIEVSUk9SIEhBTkRM
        SU5HCi8vCgovKioKICBBIGZ1bmN0aW9uIG1heSBiZSBhc3NpZ25lZCB0byBg
        RW1iZXIub25lcnJvcmAgdG8gYmUgY2FsbGVkIHdoZW4gRW1iZXIKICBpbnRl
        cm5hbHMgZW5jb3VudGVyIGFuIGVycm9yLiBUaGlzIGlzIHVzZWZ1bCBmb3Ig
        c3BlY2lhbGl6ZWQgZXJyb3IgaGFuZGxpbmcKICBhbmQgcmVwb3J0aW5nIGNv
        ZGUuCgogIGBgYGphdmFzY3JpcHQKICBFbWJlci5vbmVycm9yID0gZnVuY3Rp
        b24oZXJyb3IpIHsKICAgIEVtLiQuYWpheCgnL3JlcG9ydC1lcnJvcicsICdQ
        T1NUJywgewogICAgICBzdGFjazogZXJyb3Iuc3RhY2ssCiAgICAgIG90aGVy
        SW5mb3JtYXRpb246ICd3aGF0ZXZlciBhcHAgc3RhdGUgeW91IHdhbnQgdG8g
        cHJvdmlkZScKICAgIH0pOwogIH07CiAgYGBgCgogIEBldmVudCBvbmVycm9y
        CiAgQGZvciBFbWJlcgogIEBwYXJhbSB7RXhjZXB0aW9ufSBlcnJvciB0aGUg
        ZXJyb3Igb2JqZWN0CiovCkVtYmVyLm9uZXJyb3IgPSBudWxsOwoKLyoqCiAg
        QHByaXZhdGUKCiAgV3JhcCBjb2RlIGJsb2NrIGluIGEgdHJ5L2NhdGNoIGlm
        IGBFbWJlci5vbmVycm9yYCBpcyBzZXQuCgogIEBtZXRob2QgaGFuZGxlRXJy
        b3JzCiAgQGZvciBFbWJlcgogIEBwYXJhbSB7RnVuY3Rpb259IGZ1bmMKICBA
        cGFyYW0gW2NvbnRleHRdCiovCkVtYmVyLmhhbmRsZUVycm9ycyA9IGZ1bmN0
        aW9uKGZ1bmMsIGNvbnRleHQpIHsKICAvLyBVbmZvcnR1bmF0ZWx5IGluIHNv
        bWUgYnJvd3NlcnMgd2UgbG9zZSB0aGUgYmFja3RyYWNlIGlmIHdlIHJldGhy
        b3cgdGhlIGV4aXN0aW5nIGVycm9yLAogIC8vIHNvIGluIHRoZSBldmVudCB0
        aGF0IHdlIGRvbid0IGhhdmUgYW4gYG9uZXJyb3JgIGhhbmRsZXIgd2UgZG9u
        J3Qgd3JhcCBpbiBhIHRyeS9jYXRjaAogIGlmICgnZnVuY3Rpb24nID09PSB0
        eXBlb2YgRW1iZXIub25lcnJvcikgewogICAgdHJ5IHsKICAgICAgcmV0dXJu
        IGZ1bmMuY2FsbChjb250ZXh0IHx8IHRoaXMpOwogICAgfSBjYXRjaCAoZXJy
        b3IpIHsKICAgICAgRW1iZXIub25lcnJvcihlcnJvcik7CiAgICB9CiAgfSBl
        bHNlIHsKICAgIHJldHVybiBmdW5jLmNhbGwoY29udGV4dCB8fCB0aGlzKTsK
        ICB9Cn07CgovKioKICBNZXJnZSB0aGUgY29udGVudHMgb2YgdHdvIG9iamVj
        dHMgdG9nZXRoZXIgaW50byB0aGUgZmlyc3Qgb2JqZWN0LgoKICBgYGBqYXZh
        c2NyaXB0CiAgRW1iZXIubWVyZ2Uoe2ZpcnN0OiAnVG9tJ30sIHtsYXN0OiAn
        RGFsZSd9KTsgLy8ge2ZpcnN0OiAnVG9tJywgbGFzdDogJ0RhbGUnfQogIHZh
        ciBhID0ge2ZpcnN0OiAnWWVodWRhJ30sIGIgPSB7bGFzdDogJ0thdHonfTsK
        ICBFbWJlci5tZXJnZShhLCBiKTsgLy8gYSA9PSB7Zmlyc3Q6ICdZZWh1ZGEn
        LCBsYXN0OiAnS2F0eid9LCBiID09IHtsYXN0OiAnS2F0eid9CiAgYGBgCgog
        IEBtZXRob2QgbWVyZ2UKICBAZm9yIEVtYmVyCiAgQHBhcmFtIHtPYmplY3R9
        IG9yaWdpbmFsIFRoZSBvYmplY3QgdG8gbWVyZ2UgaW50bwogIEBwYXJhbSB7
        T2JqZWN0fSB1cGRhdGVzIFRoZSBvYmplY3QgdG8gY29weSBwcm9wZXJ0aWVz
        IGZyb20KICBAcmV0dXJuIHtPYmplY3R9CiovCkVtYmVyLm1lcmdlID0gZnVu
        Y3Rpb24ob3JpZ2luYWwsIHVwZGF0ZXMpIHsKICBmb3IgKHZhciBwcm9wIGlu
        IHVwZGF0ZXMpIHsKICAgIGlmICghdXBkYXRlcy5oYXNPd25Qcm9wZXJ0eShw
        cm9wKSkgeyBjb250aW51ZTsgfQogICAgb3JpZ2luYWxbcHJvcF0gPSB1cGRh
        dGVzW3Byb3BdOwogIH0KICByZXR1cm4gb3JpZ2luYWw7Cn07CgovKioKICBS
        ZXR1cm5zIHRydWUgaWYgdGhlIHBhc3NlZCB2YWx1ZSBpcyBudWxsIG9yIHVu
        ZGVmaW5lZC4gVGhpcyBhdm9pZHMgZXJyb3JzCiAgZnJvbSBKU0xpbnQgY29t
        cGxhaW5pbmcgYWJvdXQgdXNlIG9mID09LCB3aGljaCBjYW4gYmUgdGVjaG5p
        Y2FsbHkKICBjb25mdXNpbmcuCgogIGBgYGphdmFzY3JpcHQKICBFbWJlci5p
        c05vbmUoKTsgICAgICAgICAgICAgIC8vIHRydWUKICBFbWJlci5pc05vbmUo
        bnVsbCk7ICAgICAgICAgIC8vIHRydWUKICBFbWJlci5pc05vbmUodW5kZWZp
        bmVkKTsgICAgIC8vIHRydWUKICBFbWJlci5pc05vbmUoJycpOyAgICAgICAg
        ICAgIC8vIGZhbHNlCiAgRW1iZXIuaXNOb25lKFtdKTsgICAgICAgICAgICAv
        LyBmYWxzZQogIEVtYmVyLmlzTm9uZShmdW5jdGlvbigpIHt9KTsgIC8vIGZh
        bHNlCiAgYGBgCgogIEBtZXRob2QgaXNOb25lCiAgQGZvciBFbWJlcgogIEBw
        YXJhbSB7T2JqZWN0fSBvYmogVmFsdWUgdG8gdGVzdAogIEByZXR1cm4ge0Jv
        b2xlYW59CiovCkVtYmVyLmlzTm9uZSA9IGZ1bmN0aW9uKG9iaikgewogIHJl
        dHVybiBvYmogPT09IG51bGwgfHwgb2JqID09PSB1bmRlZmluZWQ7Cn07CkVt
        YmVyLm5vbmUgPSBFbWJlci5kZXByZWNhdGVGdW5jKCJFbWJlci5ub25lIGlz
        IGRlcHJlY2F0ZWQuIFBsZWFzZSB1c2UgRW1iZXIuaXNOb25lIGluc3RlYWQu
        IiwgRW1iZXIuaXNOb25lKTsKCi8qKgogIFZlcmlmaWVzIHRoYXQgYSB2YWx1
        ZSBpcyBgbnVsbGAgb3IgYW4gZW1wdHkgc3RyaW5nLCBlbXB0eSBhcnJheSwK
        ICBvciBlbXB0eSBmdW5jdGlvbi4KCiAgQ29uc3RyYWlucyB0aGUgcnVsZXMg
        b24gYEVtYmVyLmlzTm9uZWAgYnkgcmV0dXJuaW5nIGZhbHNlIGZvciBlbXB0
        eQogIHN0cmluZyBhbmQgZW1wdHkgYXJyYXlzLgoKICBgYGBqYXZhc2NyaXB0
        CiAgRW1iZXIuaXNFbXB0eSgpOyAgICAgICAgICAgICAgICAvLyB0cnVlCiAg
        RW1iZXIuaXNFbXB0eShudWxsKTsgICAgICAgICAgICAvLyB0cnVlCiAgRW1i
        ZXIuaXNFbXB0eSh1bmRlZmluZWQpOyAgICAgICAvLyB0cnVlCiAgRW1iZXIu
        aXNFbXB0eSgnJyk7ICAgICAgICAgICAgICAvLyB0cnVlCiAgRW1iZXIuaXNF
        bXB0eShbXSk7ICAgICAgICAgICAgICAvLyB0cnVlCiAgRW1iZXIuaXNFbXB0
        eSgnQWRhbSBIYXdraW5zJyk7ICAvLyBmYWxzZQogIEVtYmVyLmlzRW1wdHko
        WzAsMSwyXSk7ICAgICAgICAgLy8gZmFsc2UKICBgYGAKCiAgQG1ldGhvZCBp
        c0VtcHR5CiAgQGZvciBFbWJlcgogIEBwYXJhbSB7T2JqZWN0fSBvYmogVmFs
        dWUgdG8gdGVzdAogIEByZXR1cm4ge0Jvb2xlYW59CiovCkVtYmVyLmlzRW1w
        dHkgPSBmdW5jdGlvbihvYmopIHsKICByZXR1cm4gRW1iZXIuaXNOb25lKG9i
        aikgfHwgKG9iai5sZW5ndGggPT09IDAgJiYgdHlwZW9mIG9iaiAhPT0gJ2Z1
        bmN0aW9uJykgfHwgKHR5cGVvZiBvYmogPT09ICdvYmplY3QnICYmIEVtYmVy
        LmdldChvYmosICdsZW5ndGgnKSA9PT0gMCk7Cn07CkVtYmVyLmVtcHR5ID0g
        RW1iZXIuZGVwcmVjYXRlRnVuYygiRW1iZXIuZW1wdHkgaXMgZGVwcmVjYXRl
        ZC4gUGxlYXNlIHVzZSBFbWJlci5pc0VtcHR5IGluc3RlYWQuIiwgRW1iZXIu
        aXNFbXB0eSkgOwoKCn0pKCk7CgoKCihmdW5jdGlvbigpIHsKLypnbG9iYWxz
        IE5vZGUgKi8KLyoqCkBtb2R1bGUgZW1iZXItbWV0YWwKKi8KCi8qKgogIFBs
        YXRmb3JtIHNwZWNpZmljIG1ldGhvZHMgYW5kIGZlYXR1cmUgZGV0ZWN0b3Jz
        IG5lZWRlZCBieSB0aGUgZnJhbWV3b3JrLgoKICBAY2xhc3MgcGxhdGZvcm0K
        ICBAbmFtZXNwYWNlIEVtYmVyCiAgQHN0YXRpYwoqLwp2YXIgcGxhdGZvcm0g
        PSBFbWJlci5wbGF0Zm9ybSA9IHt9OwoKCi8qKgogIElkZW50aWNhbCB0byBg
        T2JqZWN0LmNyZWF0ZSgpYC4gSW1wbGVtZW50cyBpZiBub3QgYXZhaWxhYmxl
        IG5hdGl2ZWx5LgoKICBAbWV0aG9kIGNyZWF0ZQogIEBmb3IgRW1iZXIKKi8K
        RW1iZXIuY3JlYXRlID0gT2JqZWN0LmNyZWF0ZTsKCi8vIElFOCBoYXMgT2Jq
        ZWN0LmNyZWF0ZSBidXQgaXQgY291bGRuJ3QgdHJlYXQgcHJvcGVydHkgZGVz
        Y3JpcHRlcnMuCmlmIChFbWJlci5jcmVhdGUpIHsKICBpZiAoRW1iZXIuY3Jl
        YXRlKHthOiAxfSwge2E6IHt2YWx1ZTogMn19KS5hICE9PSAyKSB7CiAgICBF
        bWJlci5jcmVhdGUgPSBudWxsOwogIH0KfQoKLy8gU1RVQl9PQkpFQ1RfQ1JF
        QVRFIGFsbG93cyB1cyB0byBvdmVycmlkZSBvdGhlciBsaWJyYXJpZXMgdGhh
        dCBzdHViCi8vIE9iamVjdC5jcmVhdGUgZGlmZmVyZW50IHRoYW4gd2Ugd291
        bGQgcHJlZmVyCmlmICghRW1iZXIuY3JlYXRlIHx8IEVtYmVyLkVOVi5TVFVC
        X09CSkVDVF9DUkVBVEUpIHsKICB2YXIgSyA9IGZ1bmN0aW9uKCkge307Cgog
        IEVtYmVyLmNyZWF0ZSA9IGZ1bmN0aW9uKG9iaiwgcHJvcHMpIHsKICAgIEsu
        cHJvdG90eXBlID0gb2JqOwogICAgb2JqID0gbmV3IEsoKTsKICAgIGlmIChw
        cm9wcykgewogICAgICBLLnByb3RvdHlwZSA9IG9iajsKICAgICAgZm9yICh2
        YXIgcHJvcCBpbiBwcm9wcykgewogICAgICAgIEsucHJvdG90eXBlW3Byb3Bd
        ID0gcHJvcHNbcHJvcF0udmFsdWU7CiAgICAgIH0KICAgICAgb2JqID0gbmV3
        IEsoKTsKICAgIH0KICAgIEsucHJvdG90eXBlID0gbnVsbDsKCiAgICByZXR1
        cm4gb2JqOwogIH07CgogIEVtYmVyLmNyZWF0ZS5pc1NpbXVsYXRlZCA9IHRy
        dWU7Cn0KCnZhciBkZWZpbmVQcm9wZXJ0eSA9IE9iamVjdC5kZWZpbmVQcm9w
        ZXJ0eTsKdmFyIGNhblJlZGVmaW5lUHJvcGVydGllcywgY2FuRGVmaW5lUHJv
        cGVydHlPbkRPTTsKCi8vIENhdGNoIElFOCB3aGVyZSBPYmplY3QuZGVmaW5l
        UHJvcGVydHkgZXhpc3RzIGJ1dCBvbmx5IHdvcmtzIG9uIERPTSBlbGVtZW50
        cwppZiAoZGVmaW5lUHJvcGVydHkpIHsKICB0cnkgewogICAgZGVmaW5lUHJv
        cGVydHkoe30sICdhJyx7Z2V0OmZ1bmN0aW9uKCkge319KTsKICB9IGNhdGNo
        IChlKSB7CiAgICBkZWZpbmVQcm9wZXJ0eSA9IG51bGw7CiAgfQp9CgppZiAo
        ZGVmaW5lUHJvcGVydHkpIHsKICAvLyBEZXRlY3RzIGEgYnVnIGluIEFuZHJv
        aWQgPDMuMiB3aGVyZSB5b3UgY2Fubm90IHJlZGVmaW5lIGEgcHJvcGVydHkg
        dXNpbmcKICAvLyBPYmplY3QuZGVmaW5lUHJvcGVydHkgb25jZSBhY2Nlc3Nv
        cnMgaGF2ZSBhbHJlYWR5IGJlZW4gc2V0LgogIGNhblJlZGVmaW5lUHJvcGVy
        dGllcyA9IChmdW5jdGlvbigpIHsKICAgIHZhciBvYmogPSB7fTsKCiAgICBk
        ZWZpbmVQcm9wZXJ0eShvYmosICdhJywgewogICAgICBjb25maWd1cmFibGU6
        IHRydWUsCiAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgIGdldDogZnVu
        Y3Rpb24oKSB7IH0sCiAgICAgIHNldDogZnVuY3Rpb24oKSB7IH0KICAgIH0p
        OwoKICAgIGRlZmluZVByb3BlcnR5KG9iaiwgJ2EnLCB7CiAgICAgIGNvbmZp
        Z3VyYWJsZTogdHJ1ZSwKICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAg
        d3JpdGFibGU6IHRydWUsCiAgICAgIHZhbHVlOiB0cnVlCiAgICB9KTsKCiAg
        ICByZXR1cm4gb2JqLmEgPT09IHRydWU7CiAgfSkoKTsKCiAgLy8gVGhpcyBp
        cyBmb3IgU2FmYXJpIDUuMCwgd2hpY2ggc3VwcG9ydHMgT2JqZWN0LmRlZmlu
        ZVByb3BlcnR5LCBidXQgbm90CiAgLy8gb24gRE9NIG5vZGVzLgogIGNhbkRl
        ZmluZVByb3BlcnR5T25ET00gPSAoZnVuY3Rpb24oKSB7CiAgICB0cnkgewog
        ICAgICBkZWZpbmVQcm9wZXJ0eShkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdk
        aXYnKSwgJ2RlZmluZVByb3BlcnR5T25ET00nLCB7fSk7CiAgICAgIHJldHVy
        biB0cnVlOwogICAgfSBjYXRjaChlKSB7IH0KCiAgICByZXR1cm4gZmFsc2U7
        CiAgfSkoKTsKCiAgaWYgKCFjYW5SZWRlZmluZVByb3BlcnRpZXMpIHsKICAg
        IGRlZmluZVByb3BlcnR5ID0gbnVsbDsKICB9IGVsc2UgaWYgKCFjYW5EZWZp
        bmVQcm9wZXJ0eU9uRE9NKSB7CiAgICBkZWZpbmVQcm9wZXJ0eSA9IGZ1bmN0
        aW9uKG9iaiwga2V5TmFtZSwgZGVzYykgewogICAgICB2YXIgaXNOb2RlOwoK
        ICAgICAgaWYgKHR5cGVvZiBOb2RlID09PSAib2JqZWN0IikgewogICAgICAg
        IGlzTm9kZSA9IG9iaiBpbnN0YW5jZW9mIE5vZGU7CiAgICAgIH0gZWxzZSB7
        CiAgICAgICAgaXNOb2RlID0gdHlwZW9mIG9iaiA9PT0gIm9iamVjdCIgJiYg
        dHlwZW9mIG9iai5ub2RlVHlwZSA9PT0gIm51bWJlciIgJiYgdHlwZW9mIG9i
        ai5ub2RlTmFtZSA9PT0gInN0cmluZyI7CiAgICAgIH0KCiAgICAgIGlmIChp
        c05vZGUpIHsKICAgICAgICAvLyBUT0RPOiBTaG91bGQgd2UgaGF2ZSBhIHdh
        cm5pbmcgaGVyZT8KICAgICAgICByZXR1cm4gKG9ialtrZXlOYW1lXSA9IGRl
        c2MudmFsdWUpOwogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiBPYmpl
        Y3QuZGVmaW5lUHJvcGVydHkob2JqLCBrZXlOYW1lLCBkZXNjKTsKICAgICAg
        fQogICAgfTsKICB9Cn0KCi8qKgpAY2xhc3MgcGxhdGZvcm0KQG5hbWVzcGFj
        ZSBFbWJlcgoqLwoKLyoqCiAgSWRlbnRpY2FsIHRvIGBPYmplY3QuZGVmaW5l
        UHJvcGVydHkoKWAuIEltcGxlbWVudHMgYXMgbXVjaCBmdW5jdGlvbmFsaXR5
        CiAgYXMgcG9zc2libGUgaWYgbm90IGF2YWlsYWJsZSBuYXRpdmVseS4KCiAg
        QG1ldGhvZCBkZWZpbmVQcm9wZXJ0eQogIEBwYXJhbSB7T2JqZWN0fSBvYmog
        VGhlIG9iamVjdCB0byBtb2RpZnkKICBAcGFyYW0ge1N0cmluZ30ga2V5TmFt
        ZSBwcm9wZXJ0eSBuYW1lIHRvIG1vZGlmeQogIEBwYXJhbSB7T2JqZWN0fSBk
        ZXNjIGRlc2NyaXB0b3IgaGFzaAogIEByZXR1cm4ge3ZvaWR9CiovCnBsYXRm
        b3JtLmRlZmluZVByb3BlcnR5ID0gZGVmaW5lUHJvcGVydHk7CgovKioKICBT
        ZXQgdG8gdHJ1ZSBpZiB0aGUgcGxhdGZvcm0gc3VwcG9ydHMgbmF0aXZlIGdl
        dHRlcnMgYW5kIHNldHRlcnMuCgogIEBwcm9wZXJ0eSBoYXNQcm9wZXJ0eUFj
        Y2Vzc29ycwogIEBmaW5hbAoqLwpwbGF0Zm9ybS5oYXNQcm9wZXJ0eUFjY2Vz
        c29ycyA9IHRydWU7CgppZiAoIXBsYXRmb3JtLmRlZmluZVByb3BlcnR5KSB7
        CiAgcGxhdGZvcm0uaGFzUHJvcGVydHlBY2Nlc3NvcnMgPSBmYWxzZTsKCiAg
        cGxhdGZvcm0uZGVmaW5lUHJvcGVydHkgPSBmdW5jdGlvbihvYmosIGtleU5h
        bWUsIGRlc2MpIHsKICAgIGlmICghZGVzYy5nZXQpIHsgb2JqW2tleU5hbWVd
        ID0gZGVzYy52YWx1ZTsgfQogIH07CgogIHBsYXRmb3JtLmRlZmluZVByb3Bl
        cnR5LmlzU2ltdWxhdGVkID0gdHJ1ZTsKfQoKaWYgKEVtYmVyLkVOVi5NQU5E
        QVRPUllfU0VUVEVSICYmICFwbGF0Zm9ybS5oYXNQcm9wZXJ0eUFjY2Vzc29y
        cykgewogIEVtYmVyLkVOVi5NQU5EQVRPUllfU0VUVEVSID0gZmFsc2U7Cn0K
        Cn0pKCk7CgoKCihmdW5jdGlvbigpIHsKLypqc2hpbnQgbmV3Y2FwOmZhbHNl
        Ki8KLyoqCkBtb2R1bGUgZW1iZXItbWV0YWwKKi8KCi8vIE5PVEU6IFRoZXJl
        IGlzIGEgYnVnIGluIGpzaGludCB0aGF0IGRvZXNuJ3QgcmVjb2duaXplIGBP
        YmplY3QoKWAgd2l0aG91dCBgbmV3YAovLyBhcyBiZWluZyBvayB1bmxlc3Mg
        Ym90aCBgbmV3Y2FwOmZhbHNlYCBhbmQgbm90IGB1c2Ugc3RyaWN0YC4KLy8g
        aHR0cHM6Ly9naXRodWIuY29tL2pzaGludC9qc2hpbnQvaXNzdWVzLzM5MgoK
        Ly8gVGVzdGluZyB0aGlzIGlzIG5vdCBpZGVhbCwgYnV0IHdlIHdhbnQgdG8g
        dXNlIG5hdGl2ZSBmdW5jdGlvbnMKLy8gaWYgYXZhaWxhYmxlLCBidXQgbm90
        IHRvIHVzZSB2ZXJzaW9ucyBjcmVhdGVkIGJ5IGxpYnJhcmllcyBsaWtlIFBy
        b3RvdHlwZQp2YXIgaXNOYXRpdmVGdW5jID0gZnVuY3Rpb24oZnVuYykgewog
        IC8vIFRoaXMgc2hvdWxkIHByb2JhYmx5IHdvcmsgaW4gYWxsIGJyb3dzZXJz
        IGxpa2VseSB0byBoYXZlIEVTNSBhcnJheSBtZXRob2RzCiAgcmV0dXJuIGZ1
        bmMgJiYgRnVuY3Rpb24ucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoZnVuYyku
        aW5kZXhPZignW25hdGl2ZSBjb2RlXScpID4gLTE7Cn07CgovLyBGcm9tOiBo
        dHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi9KYXZhU2NyaXB0L1Jl
        ZmVyZW5jZS9HbG9iYWxfT2JqZWN0cy9hcnJheS9tYXAKdmFyIGFycmF5TWFw
        ID0gaXNOYXRpdmVGdW5jKEFycmF5LnByb3RvdHlwZS5tYXApID8gQXJyYXku
        cHJvdG90eXBlLm1hcCA6IGZ1bmN0aW9uKGZ1biAvKiwgdGhpc3AgKi8pIHsK
        ICAvLyJ1c2Ugc3RyaWN0IjsKCiAgaWYgKHRoaXMgPT09IHZvaWQgMCB8fCB0
        aGlzID09PSBudWxsKSB7CiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCk7CiAg
        fQoKICB2YXIgdCA9IE9iamVjdCh0aGlzKTsKICB2YXIgbGVuID0gdC5sZW5n
        dGggPj4+IDA7CiAgaWYgKHR5cGVvZiBmdW4gIT09ICJmdW5jdGlvbiIpIHsK
        ICAgIHRocm93IG5ldyBUeXBlRXJyb3IoKTsKICB9CgogIHZhciByZXMgPSBu
        ZXcgQXJyYXkobGVuKTsKICB2YXIgdGhpc3AgPSBhcmd1bWVudHNbMV07CiAg
        Zm9yICh2YXIgaSA9IDA7IGkgPCBsZW47IGkrKykgewogICAgaWYgKGkgaW4g
        dCkgewogICAgICByZXNbaV0gPSBmdW4uY2FsbCh0aGlzcCwgdFtpXSwgaSwg
        dCk7CiAgICB9CiAgfQoKICByZXR1cm4gcmVzOwp9OwoKLy8gRnJvbTogaHR0
        cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4vSmF2YVNjcmlwdC9SZWZl
        cmVuY2UvR2xvYmFsX09iamVjdHMvYXJyYXkvZm9yZWFjaAp2YXIgYXJyYXlG
        b3JFYWNoID0gaXNOYXRpdmVGdW5jKEFycmF5LnByb3RvdHlwZS5mb3JFYWNo
        KSA/IEFycmF5LnByb3RvdHlwZS5mb3JFYWNoIDogZnVuY3Rpb24oZnVuIC8q
        LCB0aGlzcCAqLykgewogIC8vInVzZSBzdHJpY3QiOwoKICBpZiAodGhpcyA9
        PT0gdm9pZCAwIHx8IHRoaXMgPT09IG51bGwpIHsKICAgIHRocm93IG5ldyBU
        eXBlRXJyb3IoKTsKICB9CgogIHZhciB0ID0gT2JqZWN0KHRoaXMpOwogIHZh
        ciBsZW4gPSB0Lmxlbmd0aCA+Pj4gMDsKICBpZiAodHlwZW9mIGZ1biAhPT0g
        ImZ1bmN0aW9uIikgewogICAgdGhyb3cgbmV3IFR5cGVFcnJvcigpOwogIH0K
        CiAgdmFyIHRoaXNwID0gYXJndW1lbnRzWzFdOwogIGZvciAodmFyIGkgPSAw
        OyBpIDwgbGVuOyBpKyspIHsKICAgIGlmIChpIGluIHQpIHsKICAgICAgZnVu
        LmNhbGwodGhpc3AsIHRbaV0sIGksIHQpOwogICAgfQogIH0KfTsKCnZhciBh
        cnJheUluZGV4T2YgPSBpc05hdGl2ZUZ1bmMoQXJyYXkucHJvdG90eXBlLmlu
        ZGV4T2YpID8gQXJyYXkucHJvdG90eXBlLmluZGV4T2YgOiBmdW5jdGlvbiAo
        b2JqLCBmcm9tSW5kZXgpIHsKICBpZiAoZnJvbUluZGV4ID09PSBudWxsIHx8
        IGZyb21JbmRleCA9PT0gdW5kZWZpbmVkKSB7IGZyb21JbmRleCA9IDA7IH0K
        ICBlbHNlIGlmIChmcm9tSW5kZXggPCAwKSB7IGZyb21JbmRleCA9IE1hdGgu
        bWF4KDAsIHRoaXMubGVuZ3RoICsgZnJvbUluZGV4KTsgfQogIGZvciAodmFy
        IGkgPSBmcm9tSW5kZXgsIGogPSB0aGlzLmxlbmd0aDsgaSA8IGo7IGkrKykg
        ewogICAgaWYgKHRoaXNbaV0gPT09IG9iaikgeyByZXR1cm4gaTsgfQogIH0K
        ICByZXR1cm4gLTE7Cn07CgovKioKICBBcnJheSBwb2x5ZmlsbHMgdG8gc3Vw
        cG9ydCBFUzUgZmVhdHVyZXMgaW4gb2xkZXIgYnJvd3NlcnMuCgogIEBuYW1l
        c3BhY2UgRW1iZXIKICBAcHJvcGVydHkgQXJyYXlQb2x5ZmlsbHMKKi8KRW1i
        ZXIuQXJyYXlQb2x5ZmlsbHMgPSB7CiAgbWFwOiBhcnJheU1hcCwKICBmb3JF
        YWNoOiBhcnJheUZvckVhY2gsCiAgaW5kZXhPZjogYXJyYXlJbmRleE9mCn07
        CgppZiAoRW1iZXIuU0hJTV9FUzUpIHsKICBpZiAoIUFycmF5LnByb3RvdHlw
        ZS5tYXApIHsKICAgIEFycmF5LnByb3RvdHlwZS5tYXAgPSBhcnJheU1hcDsK
        ICB9CgogIGlmICghQXJyYXkucHJvdG90eXBlLmZvckVhY2gpIHsKICAgIEFy
        cmF5LnByb3RvdHlwZS5mb3JFYWNoID0gYXJyYXlGb3JFYWNoOwogIH0KCiAg
        aWYgKCFBcnJheS5wcm90b3R5cGUuaW5kZXhPZikgewogICAgQXJyYXkucHJv
        dG90eXBlLmluZGV4T2YgPSBhcnJheUluZGV4T2Y7CiAgfQp9Cgp9KSgpOwoK
        CgooZnVuY3Rpb24oKSB7Ci8qKgpAbW9kdWxlIGVtYmVyLW1ldGFsCiovCgoK
        dmFyIG9fZGVmaW5lUHJvcGVydHkgPSBFbWJlci5wbGF0Zm9ybS5kZWZpbmVQ
        cm9wZXJ0eSwKICAgIG9fY3JlYXRlID0gRW1iZXIuY3JlYXRlLAogICAgLy8g
        VXNlZCBmb3IgZ3VpZCBnZW5lcmF0aW9uLi4uCiAgICBHVUlEX0tFWSA9ICdf
        X2VtYmVyJysgKCsgbmV3IERhdGUoKSksCiAgICB1dWlkICAgICAgICAgPSAw
        LAogICAgbnVtYmVyQ2FjaGUgID0gW10sCiAgICBzdHJpbmdDYWNoZSAgPSB7
        fTsKCnZhciBNQU5EQVRPUllfU0VUVEVSID0gRW1iZXIuRU5WLk1BTkRBVE9S
        WV9TRVRURVI7CgovKioKICBAcHJpdmF0ZQoKICBBIHVuaXF1ZSBrZXkgdXNl
        ZCB0byBhc3NpZ24gZ3VpZHMgYW5kIG90aGVyIHByaXZhdGUgbWV0YWRhdGEg
        dG8gb2JqZWN0cy4KICBJZiB5b3UgaW5zcGVjdCBhbiBvYmplY3QgaW4geW91
        ciBicm93c2VyIGRlYnVnZ2VyIHlvdSB3aWxsIG9mdGVuIHNlZSB0aGVzZS4K
        ICBUaGV5IGNhbiBiZSBzYWZlbHkgaWdub3JlZC4KCiAgT24gYnJvd3NlcnMg
        dGhhdCBzdXBwb3J0IGl0LCB0aGVzZSBwcm9wZXJ0aWVzIGFyZSBhZGRlZCB3
        aXRoIGVudW1lcmF0aW9uCiAgZGlzYWJsZWQgc28gdGhleSB3b24ndCBzaG93
        IHVwIHdoZW4geW91IGl0ZXJhdGUgb3ZlciB5b3VyIHByb3BlcnRpZXMuCgog
        IEBwcm9wZXJ0eSBHVUlEX0tFWQogIEBmb3IgRW1iZXIKICBAdHlwZSBTdHJp
        bmcKICBAZmluYWwKKi8KRW1iZXIuR1VJRF9LRVkgPSBHVUlEX0tFWTsKCnZh
        ciBHVUlEX0RFU0MgPSB7CiAgd3JpdGFibGU6ICAgIGZhbHNlLAogIGNvbmZp
        Z3VyYWJsZTogZmFsc2UsCiAgZW51bWVyYWJsZTogIGZhbHNlLAogIHZhbHVl
        OiBudWxsCn07CgovKioKICBAcHJpdmF0ZQoKICBHZW5lcmF0ZXMgYSBuZXcg
        Z3VpZCwgb3B0aW9uYWxseSBzYXZpbmcgdGhlIGd1aWQgdG8gdGhlIG9iamVj
        dCB0aGF0IHlvdQogIHBhc3MgaW4uIFlvdSB3aWxsIHJhcmVseSBuZWVkIHRv
        IHVzZSB0aGlzIG1ldGhvZC4gSW5zdGVhZCB5b3Ugc2hvdWxkCiAgY2FsbCBg
        RW1iZXIuZ3VpZEZvcihvYmopYCwgd2hpY2ggcmV0dXJuIGFuIGV4aXN0aW5n
        IGd1aWQgaWYgYXZhaWxhYmxlLgoKICBAbWV0aG9kIGdlbmVyYXRlR3VpZAog
        IEBmb3IgRW1iZXIKICBAcGFyYW0ge09iamVjdH0gW29ial0gT2JqZWN0IHRo
        ZSBndWlkIHdpbGwgYmUgdXNlZCBmb3IuIElmIHBhc3NlZCBpbiwgdGhlIGd1
        aWQgd2lsbAogICAgYmUgc2F2ZWQgb24gdGhlIG9iamVjdCBhbmQgcmV1c2Vk
        IHdoZW5ldmVyIHlvdSBwYXNzIHRoZSBzYW1lIG9iamVjdAogICAgYWdhaW4u
        CgogICAgSWYgbm8gb2JqZWN0IGlzIHBhc3NlZCwganVzdCBnZW5lcmF0ZSBh
        IG5ldyBndWlkLgogIEBwYXJhbSB7U3RyaW5nfSBbcHJlZml4XSBQcmVmaXgg
        dG8gcGxhY2UgaW4gZnJvbnQgb2YgdGhlIGd1aWQuIFVzZWZ1bCB3aGVuIHlv
        dSB3YW50IHRvCiAgICBzZXBhcmF0ZSB0aGUgZ3VpZCBpbnRvIHNlcGFyYXRl
        IG5hbWVzcGFjZXMuCiAgQHJldHVybiB7U3RyaW5nfSB0aGUgZ3VpZAoqLwpF
        bWJlci5nZW5lcmF0ZUd1aWQgPSBmdW5jdGlvbiBnZW5lcmF0ZUd1aWQob2Jq
        LCBwcmVmaXgpIHsKICBpZiAoIXByZWZpeCkgcHJlZml4ID0gJ2VtYmVyJzsK
        ICB2YXIgcmV0ID0gKHByZWZpeCArICh1dWlkKyspKTsKICBpZiAob2JqKSB7
        CiAgICBHVUlEX0RFU0MudmFsdWUgPSByZXQ7CiAgICBvX2RlZmluZVByb3Bl
        cnR5KG9iaiwgR1VJRF9LRVksIEdVSURfREVTQyk7CiAgfQogIHJldHVybiBy
        ZXQgOwp9OwoKLyoqCiAgQHByaXZhdGUKCiAgUmV0dXJucyBhIHVuaXF1ZSBp
        ZCBmb3IgdGhlIG9iamVjdC4gSWYgdGhlIG9iamVjdCBkb2VzIG5vdCB5ZXQg
        aGF2ZSBhIGd1aWQsCiAgb25lIHdpbGwgYmUgYXNzaWduZWQgdG8gaXQuIFlv
        dSBjYW4gY2FsbCB0aGlzIG9uIGFueSBvYmplY3QsCiAgYEVtYmVyLk9iamVj
        dGAtYmFzZWQgb3Igbm90LCBidXQgYmUgYXdhcmUgdGhhdCBpdCB3aWxsIGFk
        ZCBhIGBfZ3VpZGAKICBwcm9wZXJ0eS4KCiAgWW91IGNhbiBhbHNvIHVzZSB0
        aGlzIG1ldGhvZCBvbiBET00gRWxlbWVudCBvYmplY3RzLgoKICBAbWV0aG9k
        IGd1aWRGb3IKICBAZm9yIEVtYmVyCiAgQHBhcmFtIHtPYmplY3R9IG9iaiBh
        bnkgb2JqZWN0LCBzdHJpbmcsIG51bWJlciwgRWxlbWVudCwgb3IgcHJpbWl0
        aXZlCiAgQHJldHVybiB7U3RyaW5nfSB0aGUgdW5pcXVlIGd1aWQgZm9yIHRo
        aXMgaW5zdGFuY2UuCiovCkVtYmVyLmd1aWRGb3IgPSBmdW5jdGlvbiBndWlk
        Rm9yKG9iaikgewoKICAvLyBzcGVjaWFsIGNhc2VzIHdoZXJlIHdlIGRvbid0
        IHdhbnQgdG8gYWRkIGEga2V5IHRvIG9iamVjdAogIGlmIChvYmogPT09IHVu
        ZGVmaW5lZCkgcmV0dXJuICIodW5kZWZpbmVkKSI7CiAgaWYgKG9iaiA9PT0g
        bnVsbCkgcmV0dXJuICIobnVsbCkiOwoKICB2YXIgcmV0OwogIHZhciB0eXBl
        ID0gdHlwZW9mIG9iajsKCiAgLy8gRG9uJ3QgYWxsb3cgcHJvdG90eXBlIGNo
        YW5nZXMgdG8gU3RyaW5nIGV0Yy4gdG8gY2hhbmdlIHRoZSBndWlkRm9yCiAg
        c3dpdGNoKHR5cGUpIHsKICAgIGNhc2UgJ251bWJlcic6CiAgICAgIHJldCA9
        IG51bWJlckNhY2hlW29ial07CiAgICAgIGlmICghcmV0KSByZXQgPSBudW1i
        ZXJDYWNoZVtvYmpdID0gJ251JytvYmo7CiAgICAgIHJldHVybiByZXQ7Cgog
        ICAgY2FzZSAnc3RyaW5nJzoKICAgICAgcmV0ID0gc3RyaW5nQ2FjaGVbb2Jq
        XTsKICAgICAgaWYgKCFyZXQpIHJldCA9IHN0cmluZ0NhY2hlW29ial0gPSAn
        c3QnKyh1dWlkKyspOwogICAgICByZXR1cm4gcmV0OwoKICAgIGNhc2UgJ2Jv
        b2xlYW4nOgogICAgICByZXR1cm4gb2JqID8gJyh0cnVlKScgOiAnKGZhbHNl
        KSc7CgogICAgZGVmYXVsdDoKICAgICAgaWYgKG9ialtHVUlEX0tFWV0pIHJl
        dHVybiBvYmpbR1VJRF9LRVldOwogICAgICBpZiAob2JqID09PSBPYmplY3Qp
        IHJldHVybiAnKE9iamVjdCknOwogICAgICBpZiAob2JqID09PSBBcnJheSkg
        IHJldHVybiAnKEFycmF5KSc7CiAgICAgIHJldCA9ICdlbWJlcicrKHV1aWQr
        Kyk7CiAgICAgIEdVSURfREVTQy52YWx1ZSA9IHJldDsKICAgICAgb19kZWZp
        bmVQcm9wZXJ0eShvYmosIEdVSURfS0VZLCBHVUlEX0RFU0MpOwogICAgICBy
        ZXR1cm4gcmV0OwogIH0KfTsKCi8vIC4uLi4uLi4uLi4uLi4uLi4uLi4uLi4u
        Li4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4KLy8gTUVUQQov
        LwoKdmFyIE1FVEFfREVTQyA9IHsKICB3cml0YWJsZTogICAgdHJ1ZSwKICBj
        b25maWd1cmFibGU6IGZhbHNlLAogIGVudW1lcmFibGU6ICBmYWxzZSwKICB2
        YWx1ZTogbnVsbAp9OwoKdmFyIE1FVEFfS0VZID0gRW1iZXIuR1VJRF9LRVkr
        J19tZXRhJzsKCi8qKgogIFRoZSBrZXkgdXNlZCB0byBzdG9yZSBtZXRhIGlu
        Zm9ybWF0aW9uIG9uIG9iamVjdCBmb3IgcHJvcGVydHkgb2JzZXJ2aW5nLgoK
        ICBAcHJvcGVydHkgTUVUQV9LRVkKICBAZm9yIEVtYmVyCiAgQHByaXZhdGUK
        ICBAZmluYWwKICBAdHlwZSBTdHJpbmcKKi8KRW1iZXIuTUVUQV9LRVkgPSBN
        RVRBX0tFWTsKCi8vIFBsYWNlaG9sZGVyIGZvciBub24td3JpdGFibGUgbWV0
        YXMuCnZhciBFTVBUWV9NRVRBID0gewogIGRlc2NzOiB7fSwKICB3YXRjaGlu
        Zzoge30KfTsKCmlmIChNQU5EQVRPUllfU0VUVEVSKSB7IEVNUFRZX01FVEEu
        dmFsdWVzID0ge307IH0KCkVtYmVyLkVNUFRZX01FVEEgPSBFTVBUWV9NRVRB
        OwoKaWYgKE9iamVjdC5mcmVlemUpIE9iamVjdC5mcmVlemUoRU1QVFlfTUVU
        QSk7Cgp2YXIgaXNEZWZpbmVQcm9wZXJ0eVNpbXVsYXRlZCA9IEVtYmVyLnBs
        YXRmb3JtLmRlZmluZVByb3BlcnR5LmlzU2ltdWxhdGVkOwoKZnVuY3Rpb24g
        TWV0YShvYmopIHsKICB0aGlzLmRlc2NzID0ge307CiAgdGhpcy53YXRjaGlu
        ZyA9IHt9OwogIHRoaXMuY2FjaGUgPSB7fTsKICB0aGlzLnNvdXJjZSA9IG9i
        ajsKfQoKaWYgKGlzRGVmaW5lUHJvcGVydHlTaW11bGF0ZWQpIHsKICAvLyBv
        biBwbGF0Zm9ybXMgdGhhdCBkb24ndCBzdXBwb3J0IGVudW1lcmFibGUgZmFs
        c2UKICAvLyBtYWtlIG1ldGEgZmFpbCBqUXVlcnkuaXNQbGFpbk9iamVjdCgp
        IHRvIGhpZGUgZnJvbQogIC8vIGpRdWVyeS5leHRlbmQoKSBieSBoYXZpbmcg
        YSBwcm9wZXJ0eSB0aGF0IGZhaWxzCiAgLy8gaGFzT3duUHJvcGVydHkgY2hl
        Y2suCiAgTWV0YS5wcm90b3R5cGUuX19wcmV2ZW50UGxhaW5PYmplY3RfXyA9
        IHRydWU7CgogIC8vIFdpdGhvdXQgbm9uLWVudW1lcmFibGUgcHJvcGVydGll
        cywgbWV0YSBvYmplY3RzIHdpbGwgYmUgb3V0cHV0IGluIEpTT04KICAvLyB1
        bmxlc3MgZXhwbGljaXRseSBzdXBwcmVzc2VkCiAgTWV0YS5wcm90b3R5cGUu
        dG9KU09OID0gZnVuY3Rpb24gKCkgeyB9Owp9CgovKioKICBSZXRyaWV2ZXMg
        dGhlIG1ldGEgaGFzaCBmb3IgYW4gb2JqZWN0LiBJZiBgd3JpdGFibGVgIGlz
        IHRydWUgZW5zdXJlcyB0aGUKICBoYXNoIGlzIHdyaXRhYmxlIGZvciB0aGlz
        IG9iamVjdCBhcyB3ZWxsLgoKICBUaGUgbWV0YSBvYmplY3QgY29udGFpbnMg
        aW5mb3JtYXRpb24gYWJvdXQgY29tcHV0ZWQgcHJvcGVydHkgZGVzY3JpcHRv
        cnMgYXMKICB3ZWxsIGFzIGFueSB3YXRjaGVkIHByb3BlcnRpZXMgYW5kIG90
        aGVyIGluZm9ybWF0aW9uLiBZb3UgZ2VuZXJhbGx5IHdpbGwKICBub3QgYWNj
        ZXNzIHRoaXMgaW5mb3JtYXRpb24gZGlyZWN0bHkgYnV0IGluc3RlYWQgd29y
        ayB3aXRoIGhpZ2hlciBsZXZlbAogIG1ldGhvZHMgdGhhdCBtYW5pcHVsYXRl
        IHRoaXMgaGFzaCBpbmRpcmVjdGx5LgoKICBAbWV0aG9kIG1ldGEKICBAZm9y
        IEVtYmVyCiAgQHByaXZhdGUKCiAgQHBhcmFtIHtPYmplY3R9IG9iaiBUaGUg
        b2JqZWN0IHRvIHJldHJpZXZlIG1ldGEgZm9yCiAgQHBhcmFtIHtCb29sZWFu
        fSBbd3JpdGFibGU9dHJ1ZV0gUGFzcyBgZmFsc2VgIGlmIHlvdSBkbyBub3Qg
        aW50ZW5kIHRvIG1vZGlmeQogICAgdGhlIG1ldGEgaGFzaCwgYWxsb3dpbmcg
        dGhlIG1ldGhvZCB0byBhdm9pZCBtYWtpbmcgYW4gdW5uZWNlc3NhcnkgY29w
        eS4KICBAcmV0dXJuIHtPYmplY3R9IHRoZSBtZXRhIGhhc2ggZm9yIGFuIG9i
        amVjdAoqLwpFbWJlci5tZXRhID0gZnVuY3Rpb24gbWV0YShvYmosIHdyaXRh
        YmxlKSB7CgogIHZhciByZXQgPSBvYmpbTUVUQV9LRVldOwogIGlmICh3cml0
        YWJsZT09PWZhbHNlKSByZXR1cm4gcmV0IHx8IEVNUFRZX01FVEE7CgogIGlm
        ICghcmV0KSB7CiAgICBpZiAoIWlzRGVmaW5lUHJvcGVydHlTaW11bGF0ZWQp
        IG9fZGVmaW5lUHJvcGVydHkob2JqLCBNRVRBX0tFWSwgTUVUQV9ERVNDKTsK
        CiAgICByZXQgPSBuZXcgTWV0YShvYmopOwoKICAgIGlmIChNQU5EQVRPUllf
        U0VUVEVSKSB7IHJldC52YWx1ZXMgPSB7fTsgfQoKICAgIG9ialtNRVRBX0tF
        WV0gPSByZXQ7CgogICAgLy8gbWFrZSBzdXJlIHdlIGRvbid0IGFjY2lkZW50
        YWxseSB0cnkgdG8gY3JlYXRlIGNvbnN0cnVjdG9yIGxpa2UgZGVzYwogICAg
        cmV0LmRlc2NzLmNvbnN0cnVjdG9yID0gbnVsbDsKCiAgfSBlbHNlIGlmIChy
        ZXQuc291cmNlICE9PSBvYmopIHsKICAgIGlmICghaXNEZWZpbmVQcm9wZXJ0
        eVNpbXVsYXRlZCkgb19kZWZpbmVQcm9wZXJ0eShvYmosIE1FVEFfS0VZLCBN
        RVRBX0RFU0MpOwoKICAgIHJldCA9IG9fY3JlYXRlKHJldCk7CiAgICByZXQu
        ZGVzY3MgICAgPSBvX2NyZWF0ZShyZXQuZGVzY3MpOwogICAgcmV0LndhdGNo
        aW5nID0gb19jcmVhdGUocmV0LndhdGNoaW5nKTsKICAgIHJldC5jYWNoZSAg
        ICA9IHt9OwogICAgcmV0LnNvdXJjZSAgID0gb2JqOwoKICAgIGlmIChNQU5E
        QVRPUllfU0VUVEVSKSB7IHJldC52YWx1ZXMgPSBvX2NyZWF0ZShyZXQudmFs
        dWVzKTsgfQoKICAgIG9ialtNRVRBX0tFWV0gPSByZXQ7CiAgfQogIHJldHVy
        biByZXQ7Cn07CgpFbWJlci5nZXRNZXRhID0gZnVuY3Rpb24gZ2V0TWV0YShv
        YmosIHByb3BlcnR5KSB7CiAgdmFyIG1ldGEgPSBFbWJlci5tZXRhKG9iaiwg
        ZmFsc2UpOwogIHJldHVybiBtZXRhW3Byb3BlcnR5XTsKfTsKCkVtYmVyLnNl
        dE1ldGEgPSBmdW5jdGlvbiBzZXRNZXRhKG9iaiwgcHJvcGVydHksIHZhbHVl
        KSB7CiAgdmFyIG1ldGEgPSBFbWJlci5tZXRhKG9iaiwgdHJ1ZSk7CiAgbWV0
        YVtwcm9wZXJ0eV0gPSB2YWx1ZTsKICByZXR1cm4gdmFsdWU7Cn07CgovKioK
        ICBAZGVwcmVjYXRlZAogIEBwcml2YXRlCgogIEluIG9yZGVyIHRvIHN0b3Jl
        IGRlZmF1bHRzIGZvciBhIGNsYXNzLCBhIHByb3RvdHlwZSBtYXkgbmVlZCB0
        byBjcmVhdGUKICBhIGRlZmF1bHQgbWV0YSBvYmplY3QsIHdoaWNoIHdpbGwg
        YmUgaW5oZXJpdGVkIGJ5IGFueSBvYmplY3RzIGluc3RhbnRpYXRlZAogIGZy
        b20gdGhlIGNsYXNzJ3MgY29uc3RydWN0b3IuCgogIEhvd2V2ZXIsIHRoZSBw
        cm9wZXJ0aWVzIG9mIHRoYXQgbWV0YSBvYmplY3QgYXJlIG9ubHkgc2hhbGxv
        dy1jbG9uZWQsCiAgc28gaWYgYSBwcm9wZXJ0eSBpcyBhIGhhc2ggKGxpa2Ug
        dGhlIGV2ZW50IHN5c3RlbSdzIGBsaXN0ZW5lcnNgIGhhc2gpLAogIGl0IHdp
        bGwgYnkgZGVmYXVsdCBiZSBzaGFyZWQgYWNyb3NzIGFsbCBpbnN0YW5jZXMg
        b2YgdGhhdCBjbGFzcy4KCiAgVGhpcyBtZXRob2QgYWxsb3dzIGV4dGVuc2lv
        bnMgdG8gZGVlcGx5IGNsb25lIGEgc2VyaWVzIG9mIG5lc3RlZCBoYXNoZXMg
        b3IKICBvdGhlciBjb21wbGV4IG9iamVjdHMuIEZvciBpbnN0YW5jZSwgdGhl
        IGV2ZW50IHN5c3RlbSBtaWdodCBwYXNzCiAgYFsnbGlzdGVuZXJzJywgJ2Zv
        bzpjaGFuZ2UnLCAnZW1iZXIxNTcnXWAgdG8gYHByZXBhcmVNZXRhUGF0aGAs
        IHdoaWNoIHdpbGwKICB3YWxrIGRvd24gdGhlIGtleXMgcHJvdmlkZWQuCgog
        IEZvciBlYWNoIGtleSwgaWYgdGhlIGtleSBkb2VzIG5vdCBleGlzdCwgaXQg
        aXMgY3JlYXRlZC4gSWYgaXQgYWxyZWFkeQogIGV4aXN0cyBhbmQgaXQgd2Fz
        IGluaGVyaXRlZCBmcm9tIGl0cyBjb25zdHJ1Y3RvciwgdGhlIGNvbnN0cnVj
        dG9yJ3MKICBrZXkgaXMgY2xvbmVkLgoKICBZb3UgY2FuIGFsc28gcGFzcyBm
        YWxzZSBmb3IgYHdyaXRhYmxlYCwgd2hpY2ggd2lsbCBzaW1wbHkgcmV0dXJu
        CiAgdW5kZWZpbmVkIGlmIGBwcmVwYXJlTWV0YVBhdGhgIGRpc2NvdmVycyBh
        bnkgcGFydCBvZiB0aGUgcGF0aCB0aGF0CiAgc2hhcmVkIG9yIHVuZGVmaW5l
        ZC4KCiAgQG1ldGhvZCBtZXRhUGF0aAogIEBmb3IgRW1iZXIKICBAcGFyYW0g
        e09iamVjdH0gb2JqIFRoZSBvYmplY3Qgd2hvc2UgbWV0YSB3ZSBhcmUgZXhh
        bWluaW5nCiAgQHBhcmFtIHtBcnJheX0gcGF0aCBBbiBhcnJheSBvZiBrZXlz
        IHRvIHdhbGsgZG93bgogIEBwYXJhbSB7Qm9vbGVhbn0gd3JpdGFibGUgd2hl
        dGhlciBvciBub3QgdG8gY3JlYXRlIGEgbmV3IG1ldGEKICAgIChvciBtZXRh
        IHByb3BlcnR5KSBpZiBvbmUgZG9lcyBub3QgYWxyZWFkeSBleGlzdCBvciBp
        ZiBpdCdzCiAgICBzaGFyZWQgd2l0aCBpdHMgY29uc3RydWN0b3IKKi8KRW1i
        ZXIubWV0YVBhdGggPSBmdW5jdGlvbiBtZXRhUGF0aChvYmosIHBhdGgsIHdy
        aXRhYmxlKSB7CiAgRW1iZXIuZGVwcmVjYXRlKCJFbWJlci5tZXRhUGF0aCBp
        cyBkZXByZWNhdGVkIGFuZCB3aWxsIGJlIHJlbW92ZWQgZnJvbSBmdXR1cmUg
        cmVsZWFzZXMuIik7CiAgdmFyIG1ldGEgPSBFbWJlci5tZXRhKG9iaiwgd3Jp
        dGFibGUpLCBrZXlOYW1lLCB2YWx1ZTsKCiAgZm9yICh2YXIgaT0wLCBsPXBh
        dGgubGVuZ3RoOyBpPGw7IGkrKykgewogICAga2V5TmFtZSA9IHBhdGhbaV07
        CiAgICB2YWx1ZSA9IG1ldGFba2V5TmFtZV07CgogICAgaWYgKCF2YWx1ZSkg
        ewogICAgICBpZiAoIXdyaXRhYmxlKSB7IHJldHVybiB1bmRlZmluZWQ7IH0K
        ICAgICAgdmFsdWUgPSBtZXRhW2tleU5hbWVdID0geyBfX2VtYmVyX3NvdXJj
        ZV9fOiBvYmogfTsKICAgIH0gZWxzZSBpZiAodmFsdWUuX19lbWJlcl9zb3Vy
        Y2VfXyAhPT0gb2JqKSB7CiAgICAgIGlmICghd3JpdGFibGUpIHsgcmV0dXJu
        IHVuZGVmaW5lZDsgfQogICAgICB2YWx1ZSA9IG1ldGFba2V5TmFtZV0gPSBv
        X2NyZWF0ZSh2YWx1ZSk7CiAgICAgIHZhbHVlLl9fZW1iZXJfc291cmNlX18g
        PSBvYmo7CiAgICB9CgogICAgbWV0YSA9IHZhbHVlOwogIH0KCiAgcmV0dXJu
        IHZhbHVlOwp9OwoKLyoqCiAgQHByaXZhdGUKCiAgV3JhcHMgdGhlIHBhc3Nl
        ZCBmdW5jdGlvbiBzbyB0aGF0IGB0aGlzLl9zdXBlcmAgd2lsbCBwb2ludCB0
        byB0aGUgc3VwZXJGdW5jCiAgd2hlbiB0aGUgZnVuY3Rpb24gaXMgaW52b2tl
        ZC4gVGhpcyBpcyB0aGUgcHJpbWl0aXZlIHdlIHVzZSB0byBpbXBsZW1lbnQK
        ICBjYWxscyB0byBzdXBlci4KCiAgQG1ldGhvZCB3cmFwCiAgQGZvciBFbWJl
        cgogIEBwYXJhbSB7RnVuY3Rpb259IGZ1bmMgVGhlIGZ1bmN0aW9uIHRvIGNh
        bGwKICBAcGFyYW0ge0Z1bmN0aW9ufSBzdXBlckZ1bmMgVGhlIHN1cGVyIGZ1
        bmN0aW9uLgogIEByZXR1cm4ge0Z1bmN0aW9ufSB3cmFwcGVkIGZ1bmN0aW9u
        LgoqLwpFbWJlci53cmFwID0gZnVuY3Rpb24oZnVuYywgc3VwZXJGdW5jKSB7
        CiAgZnVuY3Rpb24gSygpIHt9CgogIGZ1bmN0aW9uIHN1cGVyV3JhcHBlcigp
        IHsKICAgIHZhciByZXQsIHN1cCA9IHRoaXMuX3N1cGVyOwogICAgdGhpcy5f
        c3VwZXIgPSBzdXBlckZ1bmMgfHwgSzsKICAgIHJldCA9IGZ1bmMuYXBwbHko
        dGhpcywgYXJndW1lbnRzKTsKICAgIHRoaXMuX3N1cGVyID0gc3VwOwogICAg
        cmV0dXJuIHJldDsKICB9CgogIHN1cGVyV3JhcHBlci53cmFwcGVkRnVuY3Rp
        b24gPSBmdW5jOwogIHN1cGVyV3JhcHBlci5fX2VtYmVyX29ic2VydmVzX18g
        PSBmdW5jLl9fZW1iZXJfb2JzZXJ2ZXNfXzsKICBzdXBlcldyYXBwZXIuX19l
        bWJlcl9vYnNlcnZlc0JlZm9yZV9fID0gZnVuYy5fX2VtYmVyX29ic2VydmVz
        QmVmb3JlX187CiAgc3VwZXJXcmFwcGVyLl9fZW1iZXJfbGlzdGVuc19fID0g
        ZnVuYy5fX2VtYmVyX2xpc3RlbnNfXzsKCiAgcmV0dXJuIHN1cGVyV3JhcHBl
        cjsKfTsKCi8qKgogIFJldHVybnMgdHJ1ZSBpZiB0aGUgcGFzc2VkIG9iamVj
        dCBpcyBhbiBhcnJheSBvciBBcnJheS1saWtlLgoKICBFbWJlciBBcnJheSBQ
        cm90b2NvbDoKCiAgICAtIHRoZSBvYmplY3QgaGFzIGFuIG9iamVjdEF0IHBy
        b3BlcnR5CiAgICAtIHRoZSBvYmplY3QgaXMgYSBuYXRpdmUgQXJyYXkKICAg
        IC0gdGhlIG9iamVjdCBpcyBhbiBPYmplY3QsIGFuZCBoYXMgYSBsZW5ndGgg
        cHJvcGVydHkKCiAgVW5saWtlIGBFbWJlci50eXBlT2ZgIHRoaXMgbWV0aG9k
        IHJldHVybnMgdHJ1ZSBldmVuIGlmIHRoZSBwYXNzZWQgb2JqZWN0IGlzCiAg
        bm90IGZvcm1hbGx5IGFycmF5IGJ1dCBhcHBlYXJzIHRvIGJlIGFycmF5LWxp
        a2UgKGkuZS4gaW1wbGVtZW50cyBgRW1iZXIuQXJyYXlgKQoKICBgYGBqYXZh
        c2NyaXB0CiAgRW1iZXIuaXNBcnJheSgpOyAgICAgICAgICAgICAgICAgICAg
        ICAgICAgICAgICAgICAgICAgICAgICAgLy8gZmFsc2UKICBFbWJlci5pc0Fy
        cmF5KFtdKTsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
        ICAgICAvLyB0cnVlCiAgRW1iZXIuaXNBcnJheSggRW1iZXIuQXJyYXlQcm94
        eS5jcmVhdGUoeyBjb250ZW50OiBbXSB9KSApOyAgLy8gdHJ1ZQogIGBgYAoK
        ICBAbWV0aG9kIGlzQXJyYXkKICBAZm9yIEVtYmVyCiAgQHBhcmFtIHtPYmpl
        Y3R9IG9iaiBUaGUgb2JqZWN0IHRvIHRlc3QKICBAcmV0dXJuIHtCb29sZWFu
        fSB0cnVlIGlmIHRoZSBwYXNzZWQgb2JqZWN0IGlzIGFuIGFycmF5IG9yIEFy
        cmF5LWxpa2UKKi8KRW1iZXIuaXNBcnJheSA9IGZ1bmN0aW9uKG9iaikgewog
        IGlmICghb2JqIHx8IG9iai5zZXRJbnRlcnZhbCkgeyByZXR1cm4gZmFsc2U7
        IH0KICBpZiAoQXJyYXkuaXNBcnJheSAmJiBBcnJheS5pc0FycmF5KG9iaikp
        IHsgcmV0dXJuIHRydWU7IH0KICBpZiAoRW1iZXIuQXJyYXkgJiYgRW1iZXIu
        QXJyYXkuZGV0ZWN0KG9iaikpIHsgcmV0dXJuIHRydWU7IH0KICBpZiAoKG9i
        ai5sZW5ndGggIT09IHVuZGVmaW5lZCkgJiYgJ29iamVjdCc9PT10eXBlb2Yg
        b2JqKSB7IHJldHVybiB0cnVlOyB9CiAgcmV0dXJuIGZhbHNlOwp9OwoKLyoq
        CiAgRm9yY2VzIHRoZSBwYXNzZWQgb2JqZWN0IHRvIGJlIHBhcnQgb2YgYW4g
        YXJyYXkuIElmIHRoZSBvYmplY3QgaXMgYWxyZWFkeQogIGFuIGFycmF5IG9y
        IGFycmF5LWxpa2UsIHJldHVybnMgdGhlIG9iamVjdC4gT3RoZXJ3aXNlIGFk
        ZHMgdGhlIG9iamVjdCB0bwogIGFuIGFycmF5LiBJZiBvYmogaXMgYG51bGxg
        IG9yIGB1bmRlZmluZWRgLCByZXR1cm5zIGFuIGVtcHR5IGFycmF5LgoKICBg
        YGBqYXZhc2NyaXB0CiAgRW1iZXIubWFrZUFycmF5KCk7ICAgICAgICAgICAg
        ICAgICAgICAgICAgICAgLy8gW10KICBFbWJlci5tYWtlQXJyYXkobnVsbCk7
        ICAgICAgICAgICAgICAgICAgICAgICAvLyBbXQogIEVtYmVyLm1ha2VBcnJh
        eSh1bmRlZmluZWQpOyAgICAgICAgICAgICAgICAgIC8vIFtdCiAgRW1iZXIu
        bWFrZUFycmF5KCdsaW5kc2F5Jyk7ICAgICAgICAgICAgICAgICAgLy8gWyds
        aW5kc2F5J10KICBFbWJlci5tYWtlQXJyYXkoWzEsMiw0Ml0pOyAgICAgICAg
        ICAgICAgICAgICAvLyBbMSwyLDQyXQoKICB2YXIgY29udHJvbGxlciA9IEVt
        YmVyLkFycmF5UHJveHkuY3JlYXRlKHsgY29udGVudDogW10gfSk7CiAgRW1i
        ZXIubWFrZUFycmF5KGNvbnRyb2xsZXIpID09PSBjb250cm9sbGVyOyAgLy8g
        dHJ1ZQogIGBgYAoKICBAbWV0aG9kIG1ha2VBcnJheQogIEBmb3IgRW1iZXIK
        ICBAcGFyYW0ge09iamVjdH0gb2JqIHRoZSBvYmplY3QKICBAcmV0dXJuIHtB
        cnJheX0KKi8KRW1iZXIubWFrZUFycmF5ID0gZnVuY3Rpb24ob2JqKSB7CiAg
        aWYgKG9iaiA9PT0gbnVsbCB8fCBvYmogPT09IHVuZGVmaW5lZCkgeyByZXR1
        cm4gW107IH0KICByZXR1cm4gRW1iZXIuaXNBcnJheShvYmopID8gb2JqIDog
        W29ial07Cn07CgpmdW5jdGlvbiBjYW5JbnZva2Uob2JqLCBtZXRob2ROYW1l
        KSB7CiAgcmV0dXJuICEhKG9iaiAmJiB0eXBlb2Ygb2JqW21ldGhvZE5hbWVd
        ID09PSAnZnVuY3Rpb24nKTsKfQoKLyoqCiAgQ2hlY2tzIHRvIHNlZSBpZiB0
        aGUgYG1ldGhvZE5hbWVgIGV4aXN0cyBvbiB0aGUgYG9iamAuCgogIGBgYGph
        dmFzY3JpcHQKICB2YXIgZm9vID0ge2JhcjogRW1iZXIuSywgYmF6OiBudWxs
        fTsKICBFbWJlci5jYW5JbnZva2UoZm9vLCAnYmFyJyk7IC8vIHRydWUKICBF
        bWJlci5jYW5JbnZva2UoZm9vLCAnYmF6Jyk7IC8vIGZhbHNlCiAgRW1iZXIu
        Y2FuSW52b2tlKGZvbywgJ2JhdCcpOyAvLyBmYWxzZQogIGBgYAoKICBAbWV0
        aG9kIGNhbkludm9rZQogIEBmb3IgRW1iZXIKICBAcGFyYW0ge09iamVjdH0g
        b2JqIFRoZSBvYmplY3QgdG8gY2hlY2sgZm9yIHRoZSBtZXRob2QKICBAcGFy
        YW0ge1N0cmluZ30gbWV0aG9kTmFtZSBUaGUgbWV0aG9kIG5hbWUgdG8gY2hl
        Y2sgZm9yCiAgQHJldHVybiB7Qm9vbGVhbn0KKi8KRW1iZXIuY2FuSW52b2tl
        ID0gY2FuSW52b2tlOwoKLyoqCiAgQ2hlY2tzIHRvIHNlZSBpZiB0aGUgYG1l
        dGhvZE5hbWVgIGV4aXN0cyBvbiB0aGUgYG9iamAsCiAgYW5kIGlmIGl0IGRv
        ZXMsIGludm9rZXMgaXQgd2l0aCB0aGUgYXJndW1lbnRzIHBhc3NlZC4KCiAg
        YGBgamF2YXNjcmlwdAogIHZhciBkID0gbmV3IERhdGUoJzAzLzE1LzIwMTMn
        KTsKICBFbWJlci50cnlJbnZva2UoZCwgJ2dldFRpbWUnKTsgLy8gMTM2MzMy
        MDAwMDAwMAogIEVtYmVyLnRyeUludm9rZShkLCAnc2V0RnVsbFllYXInLCBb
        MjAxNF0pOyAvLyAxMzk0ODU2MDAwMDAwCiAgRW1iZXIudHJ5SW52b2tlKGQs
        ICdub1N1Y2hNZXRob2QnLCBbMjAxNF0pOyAvLyB1bmRlZmluZWQKICBgYGAK
        CiAgQG1ldGhvZCB0cnlJbnZva2UKICBAZm9yIEVtYmVyCiAgQHBhcmFtIHtP
        YmplY3R9IG9iaiBUaGUgb2JqZWN0IHRvIGNoZWNrIGZvciB0aGUgbWV0aG9k
        CiAgQHBhcmFtIHtTdHJpbmd9IG1ldGhvZE5hbWUgVGhlIG1ldGhvZCBuYW1l
        IHRvIGNoZWNrIGZvcgogIEBwYXJhbSB7QXJyYXl9IFthcmdzXSBUaGUgYXJn
        dW1lbnRzIHRvIHBhc3MgdG8gdGhlIG1ldGhvZAogIEByZXR1cm4geyp9IHRo
        ZSByZXR1cm4gdmFsdWUgb2YgdGhlIGludm9rZWQgbWV0aG9kIG9yIHVuZGVm
        aW5lZCBpZiBpdCBjYW5ub3QgYmUgaW52b2tlZAoqLwpFbWJlci50cnlJbnZv
        a2UgPSBmdW5jdGlvbihvYmosIG1ldGhvZE5hbWUsIGFyZ3MpIHsKICBpZiAo
        Y2FuSW52b2tlKG9iaiwgbWV0aG9kTmFtZSkpIHsKICAgIHJldHVybiBvYmpb
        bWV0aG9kTmFtZV0uYXBwbHkob2JqLCBhcmdzIHx8IFtdKTsKICB9Cn07Cgov
        LyBodHRwczovL2dpdGh1Yi5jb20vZW1iZXJqcy9lbWJlci5qcy9wdWxsLzE2
        MTcKdmFyIG5lZWRzRmluYWxseUZpeCA9IChmdW5jdGlvbigpIHsKICB2YXIg
        Y291bnQgPSAwOwogIHRyeXsKICAgIHRyeSB7IH0KICAgIGZpbmFsbHkgewog
        ICAgICBjb3VudCsrOwogICAgICB0aHJvdyBuZXcgRXJyb3IoJ25lZWRzRmlu
        YWxseUZpeFRlc3QnKTsKICAgIH0KICB9IGNhdGNoIChlKSB7fQoKICByZXR1
        cm4gY291bnQgIT09IDE7Cn0pKCk7CgovKioKICBQcm92aWRlcyB0cnkgeyB9
        IGZpbmFsbHkgeyB9IGZ1bmN0aW9uYWxpdHksIHdoaWxlIHdvcmtpbmcKICBh
        cm91bmQgU2FmYXJpJ3MgZG91YmxlIGZpbmFsbHkgYnVnLgoKICBgYGBqYXZh
        c2NyaXB0CiAgdmFyIHRyeWFibGUgPSBmdW5jdGlvbigpIHsKICAgIHNvbWVS
        ZXNvdXJjZS5sb2NrKCk7CiAgICBydW5DYWxsYmFjaygpOyAvLyBNYXkgdGhy
        b3cgZXJyb3IuCiAgfTsKICB2YXIgZmluYWxpemVyID0gZnVuY3Rpb24oKSB7
        CiAgICBzb21lUmVzb3VyY2UudW5sb2NrKCk7CiAgfTsKICBFbWJlci50cnlG
        aW5hbGx5KHRyeWFibGUsIGZpbmFsaXplcik7CiAgYGBgCgogIEBtZXRob2Qg
        dHJ5RmluYWxseQogIEBmb3IgRW1iZXIKICBAcGFyYW0ge0Z1bmN0aW9ufSB0
        cnlhYmxlIFRoZSBmdW5jdGlvbiB0byBydW4gdGhlIHRyeSBjYWxsYmFjawog
        IEBwYXJhbSB7RnVuY3Rpb259IGZpbmFsaXplciBUaGUgZnVuY3Rpb24gdG8g
        cnVuIHRoZSBmaW5hbGx5IGNhbGxiYWNrCiAgQHBhcmFtIHtPYmplY3R9IFti
        aW5kaW5nXSBUaGUgb3B0aW9uYWwgY2FsbGluZyBvYmplY3QuIERlZmF1bHRz
        IHRvICd0aGlzJwogIEByZXR1cm4geyp9IFRoZSByZXR1cm4gdmFsdWUgaXMg
        dGhlIHRoYXQgb2YgdGhlIGZpbmFsaXplciwKICB1bmxlc3MgdGhhdCB2YWx1
        ZSBpcyB1bmRlZmluZWQsIGluIHdoaWNoIGNhc2UgaXQgaXMgdGhlIHJldHVy
        biB2YWx1ZQogIG9mIHRoZSB0cnlhYmxlCiovCgppZiAobmVlZHNGaW5hbGx5
        Rml4KSB7CiAgRW1iZXIudHJ5RmluYWxseSA9IGZ1bmN0aW9uKHRyeWFibGUs
        IGZpbmFsaXplciwgYmluZGluZykgewogICAgdmFyIHJlc3VsdCwgZmluYWxS
        ZXN1bHQsIGZpbmFsRXJyb3I7CgogICAgYmluZGluZyA9IGJpbmRpbmcgfHwg
        dGhpczsKCiAgICB0cnkgewogICAgICByZXN1bHQgPSB0cnlhYmxlLmNhbGwo
        YmluZGluZyk7CiAgICB9IGZpbmFsbHkgewogICAgICB0cnkgewogICAgICAg
        IGZpbmFsUmVzdWx0ID0gZmluYWxpemVyLmNhbGwoYmluZGluZyk7CiAgICAg
        IH0gY2F0Y2ggKGUpIHsKICAgICAgICBmaW5hbEVycm9yID0gZTsKICAgICAg
        fQogICAgfQoKICAgIGlmIChmaW5hbEVycm9yKSB7IHRocm93IGZpbmFsRXJy
        b3I7IH0KCiAgICByZXR1cm4gKGZpbmFsUmVzdWx0ID09PSB1bmRlZmluZWQp
        ID8gcmVzdWx0IDogZmluYWxSZXN1bHQ7CiAgfTsKfSBlbHNlIHsKICBFbWJl
        ci50cnlGaW5hbGx5ID0gZnVuY3Rpb24odHJ5YWJsZSwgZmluYWxpemVyLCBi
        aW5kaW5nKSB7CiAgICB2YXIgcmVzdWx0LCBmaW5hbFJlc3VsdDsKCiAgICBi
        aW5kaW5nID0gYmluZGluZyB8fCB0aGlzOwoKICAgIHRyeSB7CiAgICAgIHJl
        c3VsdCA9IHRyeWFibGUuY2FsbChiaW5kaW5nKTsKICAgIH0gZmluYWxseSB7
        CiAgICAgIGZpbmFsUmVzdWx0ID0gZmluYWxpemVyLmNhbGwoYmluZGluZyk7
        CiAgICB9CgogICAgcmV0dXJuIChmaW5hbFJlc3VsdCA9PT0gdW5kZWZpbmVk
        KSA/IHJlc3VsdCA6IGZpbmFsUmVzdWx0OwogIH07Cn0KCi8qKgogIFByb3Zp
        ZGVzIHRyeSB7IH0gY2F0Y2ggZmluYWxseSB7IH0gZnVuY3Rpb25hbGl0eSwg
        d2hpbGUgd29ya2luZwogIGFyb3VuZCBTYWZhcmkncyBkb3VibGUgZmluYWxs
        eSBidWcuCgogIGBgYGphdmFzY3JpcHQKICB2YXIgdHJ5YWJsZSA9IGZ1bmN0
        aW9uKCkgewogICAgZm9yIChpPTAsIGw9bGlzdGVuZXJzLmxlbmd0aDsgaTxs
        OyBpKyspIHsKICAgICAgbGlzdGVuZXIgPSBsaXN0ZW5lcnNbaV07CiAgICAg
        IGJlZm9yZVZhbHVlc1tpXSA9IGxpc3RlbmVyLmJlZm9yZShuYW1lLCB0aW1l
        KCksIHBheWxvYWQpOwogICAgfQoKICAgIHJldHVybiBjYWxsYmFjay5jYWxs
        KGJpbmRpbmcpOwogIH07CgogIHZhciBjYXRjaGFibGUgPSBmdW5jdGlvbihl
        KSB7CiAgICBwYXlsb2FkID0gcGF5bG9hZCB8fCB7fTsKICAgIHBheWxvYWQu
        ZXhjZXB0aW9uID0gZTsKICB9OwoKICB2YXIgZmluYWxpemVyID0gZnVuY3Rp
        b24oKSB7CiAgICBmb3IgKGk9MCwgbD1saXN0ZW5lcnMubGVuZ3RoOyBpPGw7
        IGkrKykgewogICAgICBsaXN0ZW5lciA9IGxpc3RlbmVyc1tpXTsKICAgICAg
        bGlzdGVuZXIuYWZ0ZXIobmFtZSwgdGltZSgpLCBwYXlsb2FkLCBiZWZvcmVW
        YWx1ZXNbaV0pOwogICAgfQogIH07CiAgRW1iZXIudHJ5Q2F0Y2hGaW5hbGx5
        KHRyeWFibGUsIGNhdGNoYWJsZSwgZmluYWxpemVyKTsKICBgYGAKCiAgQG1l
        dGhvZCB0cnlDYXRjaEZpbmFsbHkKICBAZm9yIEVtYmVyCiAgQHBhcmFtIHtG
        dW5jdGlvbn0gdHJ5YWJsZSBUaGUgZnVuY3Rpb24gdG8gcnVuIHRoZSB0cnkg
        Y2FsbGJhY2sKICBAcGFyYW0ge0Z1bmN0aW9ufSBjYXRjaGFibGUgVGhlIGZ1
        bmN0aW9uIHRvIHJ1biB0aGUgY2F0Y2hhYmxlIGNhbGxiYWNrCiAgQHBhcmFt
        IHtGdW5jdGlvbn0gZmluYWxpemVyIFRoZSBmdW5jdGlvbiB0byBydW4gdGhl
        IGZpbmFsbHkgY2FsbGJhY2sKICBAcGFyYW0ge09iamVjdH0gW2JpbmRpbmdd
        IFRoZSBvcHRpb25hbCBjYWxsaW5nIG9iamVjdC4gRGVmYXVsdHMgdG8gJ3Ro
        aXMnCiAgQHJldHVybiB7Kn0gVGhlIHJldHVybiB2YWx1ZSBpcyB0aGUgdGhh
        dCBvZiB0aGUgZmluYWxpemVyLAogIHVubGVzcyB0aGF0IHZhbHVlIGlzIHVu
        ZGVmaW5lZCwgaW4gd2hpY2ggY2FzZSBpdCBpcyB0aGUgcmV0dXJuIHZhbHVl
        CiAgb2YgdGhlIHRyeWFibGUuCiovCmlmIChuZWVkc0ZpbmFsbHlGaXgpIHsK
        ICBFbWJlci50cnlDYXRjaEZpbmFsbHkgPSBmdW5jdGlvbih0cnlhYmxlLCBj
        YXRjaGFibGUsIGZpbmFsaXplciwgYmluZGluZykgewogICAgdmFyIHJlc3Vs
        dCwgZmluYWxSZXN1bHQsIGZpbmFsRXJyb3I7CgogICAgYmluZGluZyA9IGJp
        bmRpbmcgfHwgdGhpczsKCiAgICB0cnkgewogICAgICByZXN1bHQgPSB0cnlh
        YmxlLmNhbGwoYmluZGluZyk7CiAgICB9IGNhdGNoKGVycm9yKSB7CiAgICAg
        IHJlc3VsdCA9IGNhdGNoYWJsZS5jYWxsKGJpbmRpbmcsIGVycm9yKTsKICAg
        IH0gZmluYWxseSB7CiAgICAgIHRyeSB7CiAgICAgICAgZmluYWxSZXN1bHQg
        PSBmaW5hbGl6ZXIuY2FsbChiaW5kaW5nKTsKICAgICAgfSBjYXRjaCAoZSkg
        ewogICAgICAgIGZpbmFsRXJyb3IgPSBlOwogICAgICB9CiAgICB9CgogICAg
        aWYgKGZpbmFsRXJyb3IpIHsgdGhyb3cgZmluYWxFcnJvcjsgfQoKICAgIHJl
        dHVybiAoZmluYWxSZXN1bHQgPT09IHVuZGVmaW5lZCkgPyByZXN1bHQgOiBm
        aW5hbFJlc3VsdDsKICB9Owp9IGVsc2UgewogIEVtYmVyLnRyeUNhdGNoRmlu
        YWxseSA9IGZ1bmN0aW9uKHRyeWFibGUsIGNhdGNoYWJsZSwgZmluYWxpemVy
        LCBiaW5kaW5nKSB7CiAgICB2YXIgcmVzdWx0LCBmaW5hbFJlc3VsdDsKCiAg
        ICBiaW5kaW5nID0gYmluZGluZyB8fCB0aGlzOwoKICAgIHRyeSB7CiAgICAg
        IHJlc3VsdCA9IHRyeWFibGUuY2FsbChiaW5kaW5nKTsKICAgIH0gY2F0Y2go
        ZXJyb3IpIHsKICAgICAgcmVzdWx0ID0gY2F0Y2hhYmxlLmNhbGwoYmluZGlu
        ZywgZXJyb3IpOwogICAgfSBmaW5hbGx5IHsKICAgICAgZmluYWxSZXN1bHQg
        PSBmaW5hbGl6ZXIuY2FsbChiaW5kaW5nKTsKICAgIH0KCiAgICByZXR1cm4g
        KGZpbmFsUmVzdWx0ID09PSB1bmRlZmluZWQpID8gcmVzdWx0IDogZmluYWxS
        ZXN1bHQ7CiAgfTsKfQoKLy8gLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4u
        Li4uLi4uLi4uLi4uLgovLyBUWVBJTkcgJiBBUlJBWSBNRVNTQUdJTkcKLy8K
        CnZhciBUWVBFX01BUCA9IHt9Owp2YXIgdCA9ICJCb29sZWFuIE51bWJlciBT
        dHJpbmcgRnVuY3Rpb24gQXJyYXkgRGF0ZSBSZWdFeHAgT2JqZWN0Ii5zcGxp
        dCgiICIpOwpFbWJlci5BcnJheVBvbHlmaWxscy5mb3JFYWNoLmNhbGwodCwg
        ZnVuY3Rpb24obmFtZSkgewogIFRZUEVfTUFQWyAiW29iamVjdCAiICsgbmFt
        ZSArICJdIiBdID0gbmFtZS50b0xvd2VyQ2FzZSgpOwp9KTsKCnZhciB0b1N0
        cmluZyA9IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmc7CgovKioKICBSZXR1
        cm5zIGEgY29uc2lzdGVudCB0eXBlIGZvciB0aGUgcGFzc2VkIGl0ZW0uCgog
        IFVzZSB0aGlzIGluc3RlYWQgb2YgdGhlIGJ1aWx0LWluIGB0eXBlb2ZgIHRv
        IGdldCB0aGUgdHlwZSBvZiBhbiBpdGVtLgogIEl0IHdpbGwgcmV0dXJuIHRo
        ZSBzYW1lIHJlc3VsdCBhY3Jvc3MgYWxsIGJyb3dzZXJzIGFuZCBpbmNsdWRl
        cyBhIGJpdAogIG1vcmUgZGV0YWlsLiBIZXJlIGlzIHdoYXQgd2lsbCBiZSBy
        ZXR1cm5lZDoKCiAgICAgIHwgUmV0dXJuIFZhbHVlICB8IE1lYW5pbmcgICAg
        ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfAog
        ICAgICB8LS0tLS0tLS0tLS0tLS0tfC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
        LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLXwKICAgICAgfCAnc3Ry
        aW5nJyAgICAgIHwgU3RyaW5nIHByaW1pdGl2ZSAgICAgICAgICAgICAgICAg
        ICAgICAgICAgICAgICAgICAgICB8CiAgICAgIHwgJ251bWJlcicgICAgICB8
        IE51bWJlciBwcmltaXRpdmUgICAgICAgICAgICAgICAgICAgICAgICAgICAg
        ICAgICAgICAgfAogICAgICB8ICdib29sZWFuJyAgICAgfCBCb29sZWFuIHBy
        aW1pdGl2ZSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwK
        ICAgICAgfCAnbnVsbCcgICAgICAgIHwgTnVsbCB2YWx1ZSAgICAgICAgICAg
        ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8CiAgICAgIHwgJ3Vu
        ZGVmaW5lZCcgICB8IFVuZGVmaW5lZCB2YWx1ZSAgICAgICAgICAgICAgICAg
        ICAgICAgICAgICAgICAgICAgICAgfAogICAgICB8ICdmdW5jdGlvbicgICAg
        fCBBIGZ1bmN0aW9uICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
        ICAgICAgICAgIHwKICAgICAgfCAnYXJyYXknICAgICAgIHwgQW4gaW5zdGFu
        Y2Ugb2YgQXJyYXkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8
        CiAgICAgIHwgJ2NsYXNzJyAgICAgICB8IEFuIEVtYmVyIGNsYXNzIChjcmVh
        dGVkIHVzaW5nIEVtYmVyLk9iamVjdC5leHRlbmQoKSkgfAogICAgICB8ICdp
        bnN0YW5jZScgICAgfCBBbiBFbWJlciBvYmplY3QgaW5zdGFuY2UgICAgICAg
        ICAgICAgICAgICAgICAgICAgICAgIHwKICAgICAgfCAnZXJyb3InICAgICAg
        IHwgQW4gaW5zdGFuY2Ugb2YgdGhlIEVycm9yIG9iamVjdCAgICAgICAgICAg
        ICAgICAgICAgICB8CiAgICAgIHwgJ29iamVjdCcgICAgICB8IEEgSmF2YVNj
        cmlwdCBvYmplY3Qgbm90IGluaGVyaXRpbmcgZnJvbSBFbWJlci5PYmplY3Qg
        fAoKICBFeGFtcGxlczoKCiAgYGBgamF2YXNjcmlwdAogIEVtYmVyLnR5cGVP
        ZigpOyAgICAgICAgICAgICAgICAgICAgICAgLy8gJ3VuZGVmaW5lZCcKICBF
        bWJlci50eXBlT2YobnVsbCk7ICAgICAgICAgICAgICAgICAgIC8vICdudWxs
        JwogIEVtYmVyLnR5cGVPZih1bmRlZmluZWQpOyAgICAgICAgICAgICAgLy8g
        J3VuZGVmaW5lZCcKICBFbWJlci50eXBlT2YoJ21pY2hhZWwnKTsgICAgICAg
        ICAgICAgIC8vICdzdHJpbmcnCiAgRW1iZXIudHlwZU9mKDEwMSk7ICAgICAg
        ICAgICAgICAgICAgICAvLyAnbnVtYmVyJwogIEVtYmVyLnR5cGVPZih0cnVl
        KTsgICAgICAgICAgICAgICAgICAgLy8gJ2Jvb2xlYW4nCiAgRW1iZXIudHlw
        ZU9mKEVtYmVyLm1ha2VBcnJheSk7ICAgICAgICAvLyAnZnVuY3Rpb24nCiAg
        RW1iZXIudHlwZU9mKFsxLDIsOTBdKTsgICAgICAgICAgICAgICAvLyAnYXJy
        YXknCiAgRW1iZXIudHlwZU9mKEVtYmVyLk9iamVjdC5leHRlbmQoKSk7ICAv
        LyAnY2xhc3MnCiAgRW1iZXIudHlwZU9mKEVtYmVyLk9iamVjdC5jcmVhdGUo
        KSk7ICAvLyAnaW5zdGFuY2UnCiAgRW1iZXIudHlwZU9mKG5ldyBFcnJvcign
        dGVhbW9jaWwnKSk7ICAvLyAnZXJyb3InCgogIC8vICJub3JtYWwiIEphdmFT
        Y3JpcHQgb2JqZWN0CiAgRW1iZXIudHlwZU9mKHthOiAnYid9KTsgICAgICAg
        ICAgICAgIC8vICdvYmplY3QnCiAgYGBgCgogIEBtZXRob2QgdHlwZU9mCiAg
        QGZvciBFbWJlcgogIEBwYXJhbSB7T2JqZWN0fSBpdGVtIHRoZSBpdGVtIHRv
        IGNoZWNrCiAgQHJldHVybiB7U3RyaW5nfSB0aGUgdHlwZQoqLwpFbWJlci50
        eXBlT2YgPSBmdW5jdGlvbihpdGVtKSB7CiAgdmFyIHJldDsKCiAgcmV0ID0g
        KGl0ZW0gPT09IG51bGwgfHwgaXRlbSA9PT0gdW5kZWZpbmVkKSA/IFN0cmlu
        ZyhpdGVtKSA6IFRZUEVfTUFQW3RvU3RyaW5nLmNhbGwoaXRlbSldIHx8ICdv
        YmplY3QnOwoKICBpZiAocmV0ID09PSAnZnVuY3Rpb24nKSB7CiAgICBpZiAo
        RW1iZXIuT2JqZWN0ICYmIEVtYmVyLk9iamVjdC5kZXRlY3QoaXRlbSkpIHJl
        dCA9ICdjbGFzcyc7CiAgfSBlbHNlIGlmIChyZXQgPT09ICdvYmplY3QnKSB7
        CiAgICBpZiAoaXRlbSBpbnN0YW5jZW9mIEVycm9yKSByZXQgPSAnZXJyb3In
        OwogICAgZWxzZSBpZiAoRW1iZXIuT2JqZWN0ICYmIGl0ZW0gaW5zdGFuY2Vv
        ZiBFbWJlci5PYmplY3QpIHJldCA9ICdpbnN0YW5jZSc7CiAgICBlbHNlIHJl
        dCA9ICdvYmplY3QnOwogIH0KCiAgcmV0dXJuIHJldDsKfTsKCn0pKCk7CgoK
        CihmdW5jdGlvbigpIHsKLy8gRW1iZXIudHJ5Q2F0Y2hGaW5hbGx5CgovKioK
        ICBUaGUgcHVycG9zZSBvZiB0aGUgRW1iZXIgSW5zdHJ1bWVudGF0aW9uIG1v
        ZHVsZSBpcwogIHRvIHByb3ZpZGUgZWZmaWNpZW50LCBnZW5lcmFsLXB1cnBv
        c2UgaW5zdHJ1bWVudGF0aW9uCiAgZm9yIEVtYmVyLgoKICBTdWJzY3JpYmUg
        dG8gYSBsaXN0ZW5lciBieSB1c2luZyBgRW1iZXIuc3Vic2NyaWJlYDoKCiAg
        YGBgamF2YXNjcmlwdAogIEVtYmVyLnN1YnNjcmliZSgicmVuZGVyIiwgewog
        ICAgYmVmb3JlOiBmdW5jdGlvbihuYW1lLCB0aW1lc3RhbXAsIHBheWxvYWQp
        IHsKCiAgICB9LAoKICAgIGFmdGVyOiBmdW5jdGlvbihuYW1lLCB0aW1lc3Rh
        bXAsIHBheWxvYWQpIHsKCiAgICB9CiAgfSk7CiAgYGBgCgogIElmIHlvdSBy
        ZXR1cm4gYSB2YWx1ZSBmcm9tIHRoZSBgYmVmb3JlYCBjYWxsYmFjaywgdGhh
        dCBzYW1lCiAgdmFsdWUgd2lsbCBiZSBwYXNzZWQgYXMgYSBmb3VydGggcGFy
        YW1ldGVyIHRvIHRoZSBgYWZ0ZXJgCiAgY2FsbGJhY2suCgogIEluc3RydW1l
        bnQgYSBibG9jayBvZiBjb2RlIGJ5IHVzaW5nIGBFbWJlci5pbnN0cnVtZW50
        YDoKCiAgYGBgamF2YXNjcmlwdAogIEVtYmVyLmluc3RydW1lbnQoInJlbmRl
        ci5oYW5kbGViYXJzIiwgcGF5bG9hZCwgZnVuY3Rpb24oKSB7CiAgICAvLyBy
        ZW5kZXJpbmcgbG9naWMKICB9LCBiaW5kaW5nKTsKICBgYGAKCiAgRXZlbnQg
        bmFtZXMgcGFzc2VkIHRvIGBFbWJlci5pbnN0cnVtZW50YCBhcmUgbmFtZXNw
        YWNlZAogIGJ5IHBlcmlvZHMsIGZyb20gbW9yZSBnZW5lcmFsIHRvIG1vcmUg
        c3BlY2lmaWMuIFN1YnNjcmliZXJzCiAgY2FuIGxpc3RlbiBmb3IgZXZlbnRz
        IGJ5IHdoYXRldmVyIGxldmVsIG9mIGdyYW51bGFyaXR5IHRoZXkKICBhcmUg
        aW50ZXJlc3RlZCBpbi4KCiAgSW4gdGhlIGFib3ZlIGV4YW1wbGUsIHRoZSBl
        dmVudCBpcyBgcmVuZGVyLmhhbmRsZWJhcnNgLAogIGFuZCB0aGUgc3Vic2Ny
        aWJlciBsaXN0ZW5lZCBmb3IgYWxsIGV2ZW50cyBiZWdpbm5pbmcgd2l0aAog
        IGByZW5kZXJgLiBJdCB3b3VsZCByZWNlaXZlIGNhbGxiYWNrcyBmb3IgZXZl
        bnRzIG5hbWVkCiAgYHJlbmRlcmAsIGByZW5kZXIuaGFuZGxlYmFyc2AsIGBy
        ZW5kZXIuY29udGFpbmVyYCwgb3IKICBldmVuIGByZW5kZXIuaGFuZGxlYmFy
        cy5sYXlvdXRgLgoKICBAY2xhc3MgSW5zdHJ1bWVudGF0aW9uCiAgQG5hbWVz
        cGFjZSBFbWJlcgogIEBzdGF0aWMKKi8KRW1iZXIuSW5zdHJ1bWVudGF0aW9u
        ID0ge307Cgp2YXIgc3Vic2NyaWJlcnMgPSBbXSwgY2FjaGUgPSB7fTsKCnZh
        ciBwb3B1bGF0ZUxpc3RlbmVycyA9IGZ1bmN0aW9uKG5hbWUpIHsKICB2YXIg
        bGlzdGVuZXJzID0gW10sIHN1YnNjcmliZXI7CgogIGZvciAodmFyIGk9MCwg
        bD1zdWJzY3JpYmVycy5sZW5ndGg7IGk8bDsgaSsrKSB7CiAgICBzdWJzY3Jp
        YmVyID0gc3Vic2NyaWJlcnNbaV07CiAgICBpZiAoc3Vic2NyaWJlci5yZWdl
        eC50ZXN0KG5hbWUpKSB7CiAgICAgIGxpc3RlbmVycy5wdXNoKHN1YnNjcmli
        ZXIub2JqZWN0KTsKICAgIH0KICB9CgogIGNhY2hlW25hbWVdID0gbGlzdGVu
        ZXJzOwogIHJldHVybiBsaXN0ZW5lcnM7Cn07Cgp2YXIgdGltZSA9IChmdW5j
        dGlvbigpIHsKICB2YXIgcGVyZiA9ICd1bmRlZmluZWQnICE9PSB0eXBlb2Yg
        d2luZG93ID8gd2luZG93LnBlcmZvcm1hbmNlIHx8IHt9IDoge307CiAgdmFy
        IGZuID0gcGVyZi5ub3cgfHwgcGVyZi5tb3pOb3cgfHwgcGVyZi53ZWJraXRO
        b3cgfHwgcGVyZi5tc05vdyB8fCBwZXJmLm9Ob3c7CiAgLy8gZm4uYmluZCB3
        aWxsIGJlIGF2YWlsYWJsZSBpbiBhbGwgdGhlIGJyb3dzZXJzIHRoYXQgc3Vw
        cG9ydCB0aGUgYWR2YW5jZWQgd2luZG93LnBlcmZvcm1hbmNlLi4uIDstKQog
        IHJldHVybiBmbiA/IGZuLmJpbmQocGVyZikgOiBmdW5jdGlvbigpIHsgcmV0
        dXJuICtuZXcgRGF0ZSgpOyB9Owp9KSgpOwoKLyoqCiAgTm90aWZpZXMgZXZl
        bnQncyBzdWJzY3JpYmVycywgY2FsbHMgYGJlZm9yZWAgYW5kIGBhZnRlcmAg
        aG9va3MuCgogIEBtZXRob2QgaW5zdHJ1bWVudAogIEBuYW1lc3BhY2UgRW1i
        ZXIuSW5zdHJ1bWVudGF0aW9uCgogIEBwYXJhbSB7U3RyaW5nfSBbbmFtZV0g
        TmFtZXNwYWNlZCBldmVudCBuYW1lLgogIEBwYXJhbSB7T2JqZWN0fSBwYXls
        b2FkCiAgQHBhcmFtIHtGdW5jdGlvbn0gY2FsbGJhY2sgRnVuY3Rpb24gdGhh
        dCB5b3UncmUgaW5zdHJ1bWVudGluZy4KICBAcGFyYW0ge09iamVjdH0gYmlu
        ZGluZyBDb250ZXh0IHRoYXQgaW5zdHJ1bWVudCBmdW5jdGlvbiBpcyBjYWxs
        ZWQgd2l0aC4KKi8KRW1iZXIuSW5zdHJ1bWVudGF0aW9uLmluc3RydW1lbnQg
        PSBmdW5jdGlvbihuYW1lLCBwYXlsb2FkLCBjYWxsYmFjaywgYmluZGluZykg
        ewogIHZhciBsaXN0ZW5lcnMgPSBjYWNoZVtuYW1lXSwgdGltZU5hbWUsIHJl
        dDsKCiAgaWYgKEVtYmVyLlNUUlVDVFVSRURfUFJPRklMRSkgewogICAgdGlt
        ZU5hbWUgPSBuYW1lICsgIjogIiArIHBheWxvYWQub2JqZWN0OwogICAgY29u
        c29sZS50aW1lKHRpbWVOYW1lKTsKICB9CgogIGlmICghbGlzdGVuZXJzKSB7
        CiAgICBsaXN0ZW5lcnMgPSBwb3B1bGF0ZUxpc3RlbmVycyhuYW1lKTsKICB9
        CgogIGlmIChsaXN0ZW5lcnMubGVuZ3RoID09PSAwKSB7CiAgICByZXQgPSBj
        YWxsYmFjay5jYWxsKGJpbmRpbmcpOwogICAgaWYgKEVtYmVyLlNUUlVDVFVS
        RURfUFJPRklMRSkgeyBjb25zb2xlLnRpbWVFbmQodGltZU5hbWUpOyB9CiAg
        ICByZXR1cm4gcmV0OwogIH0KCiAgdmFyIGJlZm9yZVZhbHVlcyA9IFtdLCBs
        aXN0ZW5lciwgaSwgbDsKCiAgZnVuY3Rpb24gdHJ5YWJsZSgpIHsKICAgIGZv
        ciAoaT0wLCBsPWxpc3RlbmVycy5sZW5ndGg7IGk8bDsgaSsrKSB7CiAgICAg
        IGxpc3RlbmVyID0gbGlzdGVuZXJzW2ldOwogICAgICBiZWZvcmVWYWx1ZXNb
        aV0gPSBsaXN0ZW5lci5iZWZvcmUobmFtZSwgdGltZSgpLCBwYXlsb2FkKTsK
        ICAgIH0KCiAgICByZXR1cm4gY2FsbGJhY2suY2FsbChiaW5kaW5nKTsKICB9
        CgogIGZ1bmN0aW9uIGNhdGNoYWJsZShlKSB7CiAgICBwYXlsb2FkID0gcGF5
        bG9hZCB8fCB7fTsKICAgIHBheWxvYWQuZXhjZXB0aW9uID0gZTsKICB9Cgog
        IGZ1bmN0aW9uIGZpbmFsaXplcigpIHsKICAgIGZvciAoaT0wLCBsPWxpc3Rl
        bmVycy5sZW5ndGg7IGk8bDsgaSsrKSB7CiAgICAgIGxpc3RlbmVyID0gbGlz
        dGVuZXJzW2ldOwogICAgICBsaXN0ZW5lci5hZnRlcihuYW1lLCB0aW1lKCks
        IHBheWxvYWQsIGJlZm9yZVZhbHVlc1tpXSk7CiAgICB9CgogICAgaWYgKEVt
        YmVyLlNUUlVDVFVSRURfUFJPRklMRSkgewogICAgICBjb25zb2xlLnRpbWVF
        bmQodGltZU5hbWUpOwogICAgfQogIH0KCiAgcmV0dXJuIEVtYmVyLnRyeUNh
        dGNoRmluYWxseSh0cnlhYmxlLCBjYXRjaGFibGUsIGZpbmFsaXplcik7Cn07
        CgovKioKICBTdWJzY3JpYmVzIHRvIGEgcGFydGljdWxhciBldmVudCBvciBp
        bnN0cnVtZW50ZWQgYmxvY2sgb2YgY29kZS4KCiAgQG1ldGhvZCBzdWJzY3Jp
        YmUKICBAbmFtZXNwYWNlIEVtYmVyLkluc3RydW1lbnRhdGlvbgoKICBAcGFy
        YW0ge1N0cmluZ30gW3BhdHRlcm5dIE5hbWVzcGFjZWQgZXZlbnQgbmFtZS4K
        ICBAcGFyYW0ge09iamVjdH0gW29iamVjdF0gQmVmb3JlIGFuZCBBZnRlciBo
        b29rcy4KKi8KRW1iZXIuSW5zdHJ1bWVudGF0aW9uLnN1YnNjcmliZSA9IGZ1
        bmN0aW9uKHBhdHRlcm4sIG9iamVjdCkgewogIHZhciBwYXRocyA9IHBhdHRl
        cm4uc3BsaXQoIi4iKSwgcGF0aCwgcmVnZXggPSBbXTsKCiAgZm9yICh2YXIg
        aT0wLCBsPXBhdGhzLmxlbmd0aDsgaTxsOyBpKyspIHsKICAgIHBhdGggPSBw
        YXRoc1tpXTsKICAgIGlmIChwYXRoID09PSAiKiIpIHsKICAgICAgcmVnZXgu
        cHVzaCgiW15cXC5dKiIpOwogICAgfSBlbHNlIHsKICAgICAgcmVnZXgucHVz
        aChwYXRoKTsKICAgIH0KICB9CgogIHJlZ2V4ID0gcmVnZXguam9pbigiXFwu
        Iik7CiAgcmVnZXggPSByZWdleCArICIoXFwuLiopPyI7CgogIHZhciBzdWJz
        Y3JpYmVyID0gewogICAgcGF0dGVybjogcGF0dGVybiwKICAgIHJlZ2V4OiBu
        ZXcgUmVnRXhwKCJeIiArIHJlZ2V4ICsgIiQiKSwKICAgIG9iamVjdDogb2Jq
        ZWN0CiAgfTsKCiAgc3Vic2NyaWJlcnMucHVzaChzdWJzY3JpYmVyKTsKICBj
        YWNoZSA9IHt9OwoKICByZXR1cm4gc3Vic2NyaWJlcjsKfTsKCi8qKgogIFVu
        c3Vic2NyaWJlcyBmcm9tIGEgcGFydGljdWxhciBldmVudCBvciBpbnN0cnVt
        ZW50ZWQgYmxvY2sgb2YgY29kZS4KCiAgQG1ldGhvZCB1bnN1YnNjcmliZQog
        IEBuYW1lc3BhY2UgRW1iZXIuSW5zdHJ1bWVudGF0aW9uCgogIEBwYXJhbSB7
        T2JqZWN0fSBbc3Vic2NyaWJlcl0KKi8KRW1iZXIuSW5zdHJ1bWVudGF0aW9u
        LnVuc3Vic2NyaWJlID0gZnVuY3Rpb24oc3Vic2NyaWJlcikgewogIHZhciBp
        bmRleDsKCiAgZm9yICh2YXIgaT0wLCBsPXN1YnNjcmliZXJzLmxlbmd0aDsg
        aTxsOyBpKyspIHsKICAgIGlmIChzdWJzY3JpYmVyc1tpXSA9PT0gc3Vic2Ny
        aWJlcikgewogICAgICBpbmRleCA9IGk7CiAgICB9CiAgfQoKICBzdWJzY3Jp
        YmVycy5zcGxpY2UoaW5kZXgsIDEpOwogIGNhY2hlID0ge307Cn07CgovKioK
        ICBSZXNldHMgYEVtYmVyLkluc3RydW1lbnRhdGlvbmAgYnkgZmx1c2hpbmcg
        bGlzdCBvZiBzdWJzY3JpYmVycy4KCiAgQG1ldGhvZCByZXNldAogIEBuYW1l
        c3BhY2UgRW1iZXIuSW5zdHJ1bWVudGF0aW9uCiovCkVtYmVyLkluc3RydW1l
        bnRhdGlvbi5yZXNldCA9IGZ1bmN0aW9uKCkgewogIHN1YnNjcmliZXJzID0g
        W107CiAgY2FjaGUgPSB7fTsKfTsKCkVtYmVyLmluc3RydW1lbnQgPSBFbWJl
        ci5JbnN0cnVtZW50YXRpb24uaW5zdHJ1bWVudDsKRW1iZXIuc3Vic2NyaWJl
        ID0gRW1iZXIuSW5zdHJ1bWVudGF0aW9uLnN1YnNjcmliZTsKfSkoKTsKCgoK
        KGZ1bmN0aW9uKCkgewp2YXIgbWFwLCBmb3JFYWNoLCBpbmRleE9mLCBzcGxp
        Y2U7Cm1hcCAgICAgPSBBcnJheS5wcm90b3R5cGUubWFwICAgICB8fCBFbWJl
        ci5BcnJheVBvbHlmaWxscy5tYXA7CmZvckVhY2ggPSBBcnJheS5wcm90b3R5
        cGUuZm9yRWFjaCB8fCBFbWJlci5BcnJheVBvbHlmaWxscy5mb3JFYWNoOwpp
        bmRleE9mID0gQXJyYXkucHJvdG90eXBlLmluZGV4T2YgfHwgRW1iZXIuQXJy
        YXlQb2x5ZmlsbHMuaW5kZXhPZjsKc3BsaWNlID0gQXJyYXkucHJvdG90eXBl
        LnNwbGljZTsKCnZhciB1dGlscyA9IEVtYmVyLkVudW1lcmFibGVVdGlscyA9
        IHsKICBtYXA6IGZ1bmN0aW9uKG9iaiwgY2FsbGJhY2ssIHRoaXNBcmcpIHsK
        ICAgIHJldHVybiBvYmoubWFwID8gb2JqLm1hcC5jYWxsKG9iaiwgY2FsbGJh
        Y2ssIHRoaXNBcmcpIDogbWFwLmNhbGwob2JqLCBjYWxsYmFjaywgdGhpc0Fy
        Zyk7CiAgfSwKCiAgZm9yRWFjaDogZnVuY3Rpb24ob2JqLCBjYWxsYmFjaywg
        dGhpc0FyZykgewogICAgcmV0dXJuIG9iai5mb3JFYWNoID8gb2JqLmZvckVh
        Y2guY2FsbChvYmosIGNhbGxiYWNrLCB0aGlzQXJnKSA6IGZvckVhY2guY2Fs
        bChvYmosIGNhbGxiYWNrLCB0aGlzQXJnKTsKICB9LAoKICBpbmRleE9mOiBm
        dW5jdGlvbihvYmosIGVsZW1lbnQsIGluZGV4KSB7CiAgICByZXR1cm4gb2Jq
        LmluZGV4T2YgPyBvYmouaW5kZXhPZi5jYWxsKG9iaiwgZWxlbWVudCwgaW5k
        ZXgpIDogaW5kZXhPZi5jYWxsKG9iaiwgZWxlbWVudCwgaW5kZXgpOwogIH0s
        CgogIGluZGV4ZXNPZjogZnVuY3Rpb24ob2JqLCBlbGVtZW50cykgewogICAg
        cmV0dXJuIGVsZW1lbnRzID09PSB1bmRlZmluZWQgPyBbXSA6IHV0aWxzLm1h
        cChlbGVtZW50cywgZnVuY3Rpb24oaXRlbSkgewogICAgICByZXR1cm4gdXRp
        bHMuaW5kZXhPZihvYmosIGl0ZW0pOwogICAgfSk7CiAgfSwKCiAgYWRkT2Jq
        ZWN0OiBmdW5jdGlvbihhcnJheSwgaXRlbSkgewogICAgdmFyIGluZGV4ID0g
        dXRpbHMuaW5kZXhPZihhcnJheSwgaXRlbSk7CiAgICBpZiAoaW5kZXggPT09
        IC0xKSB7IGFycmF5LnB1c2goaXRlbSk7IH0KICB9LAoKICByZW1vdmVPYmpl
        Y3Q6IGZ1bmN0aW9uKGFycmF5LCBpdGVtKSB7CiAgICB2YXIgaW5kZXggPSB1
        dGlscy5pbmRleE9mKGFycmF5LCBpdGVtKTsKICAgIGlmIChpbmRleCAhPT0g
        LTEpIHsgYXJyYXkuc3BsaWNlKGluZGV4LCAxKTsgfQogIH0sCgogIF9yZXBs
        YWNlOiBmdW5jdGlvbihhcnJheSwgaWR4LCBhbXQsIG9iamVjdHMpIHsKICAg
        IHZhciBhcmdzID0gW10uY29uY2F0KG9iamVjdHMpLCBjaHVuaywgcmV0ID0g
        W10sCiAgICAgICAgLy8gaHR0cHM6Ly9jb2RlLmdvb2dsZS5jb20vcC9jaHJv
        bWl1bS9pc3N1ZXMvZGV0YWlsP2lkPTU2NTg4CiAgICAgICAgc2l6ZSA9IDYw
        MDAwLCBzdGFydCA9IGlkeCwgZW5kcyA9IGFtdCwgY291bnQ7CgogICAgd2hp
        bGUgKGFyZ3MubGVuZ3RoKSB7CiAgICAgIGNvdW50ID0gZW5kcyA+IHNpemUg
        PyBzaXplIDogZW5kczsKICAgICAgaWYgKGNvdW50IDw9IDApIHsgY291bnQg
        PSAwOyB9CgogICAgICBjaHVuayA9IGFyZ3Muc3BsaWNlKDAsIHNpemUpOwog
        ICAgICBjaHVuayA9IFtzdGFydCwgY291bnRdLmNvbmNhdChjaHVuayk7Cgog
        ICAgICBzdGFydCArPSBzaXplOwogICAgICBlbmRzIC09IGNvdW50OwoKICAg
        ICAgcmV0ID0gcmV0LmNvbmNhdChzcGxpY2UuYXBwbHkoYXJyYXksIGNodW5r
        KSk7CiAgICB9CiAgICByZXR1cm4gcmV0OwogIH0sCgogIHJlcGxhY2U6IGZ1
        bmN0aW9uKGFycmF5LCBpZHgsIGFtdCwgb2JqZWN0cykgewogICAgaWYgKGFy
        cmF5LnJlcGxhY2UpIHsKICAgICAgcmV0dXJuIGFycmF5LnJlcGxhY2UoaWR4
        LCBhbXQsIG9iamVjdHMpOwogICAgfSBlbHNlIHsKICAgICAgcmV0dXJuIHV0
        aWxzLl9yZXBsYWNlKGFycmF5LCBpZHgsIGFtdCwgb2JqZWN0cyk7CiAgICB9
        CiAgfSwKCiAgaW50ZXJzZWN0aW9uOiBmdW5jdGlvbihhcnJheTEsIGFycmF5
        MikgewogICAgdmFyIGludGVyc2VjdGlvbiA9IFtdOwoKICAgIHV0aWxzLmZv
        ckVhY2goYXJyYXkxLCBmdW5jdGlvbihlbGVtZW50KSB7CiAgICAgIGlmICh1
        dGlscy5pbmRleE9mKGFycmF5MiwgZWxlbWVudCkgPj0gMCkgewogICAgICAg
        IGludGVyc2VjdGlvbi5wdXNoKGVsZW1lbnQpOwogICAgICB9CiAgICB9KTsK
        CiAgICByZXR1cm4gaW50ZXJzZWN0aW9uOwogIH0KfTsKCn0pKCk7CgoKCihm
        dW5jdGlvbigpIHsKLyoqCkBtb2R1bGUgZW1iZXItbWV0YWwKKi8KCnZhciBN
        RVRBX0tFWSA9IEVtYmVyLk1FVEFfS0VZLCBnZXQ7Cgp2YXIgTUFOREFUT1JZ
        X1NFVFRFUiA9IEVtYmVyLkVOVi5NQU5EQVRPUllfU0VUVEVSOwoKdmFyIElT
        X0dMT0JBTF9QQVRIID0gL14oW0EtWiRdfChbMC05XVtBLVokXSkpLipbXC5c
        Kl0vOwp2YXIgSEFTX1RISVMgID0gL150aGlzW1wuXCpdLzsKdmFyIEZJUlNU
        X0tFWSA9IC9eKFteXC5cKl0rKS87CgovLyAuLi4uLi4uLi4uLi4uLi4uLi4u
        Li4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uCi8vIEdF
        VCBBTkQgU0VUCi8vCi8vIElmIHdlIGFyZSBvbiBhIHBsYXRmb3JtIHRoYXQg
        c3VwcG9ydHMgYWNjZXNzb3JzIHdlIGNhbiB1c2UgdGhvc2UuCi8vIE90aGVy
        d2lzZSBzaW11bGF0ZSBhY2Nlc3NvcnMgYnkgbG9va2luZyB1cCB0aGUgcHJv
        cGVydHkgZGlyZWN0bHkgb24gdGhlCi8vIG9iamVjdC4KCi8qKgogIEdldHMg
        dGhlIHZhbHVlIG9mIGEgcHJvcGVydHkgb24gYW4gb2JqZWN0LiBJZiB0aGUg
        cHJvcGVydHkgaXMgY29tcHV0ZWQsCiAgdGhlIGZ1bmN0aW9uIHdpbGwgYmUg
        aW52b2tlZC4gSWYgdGhlIHByb3BlcnR5IGlzIG5vdCBkZWZpbmVkIGJ1dCB0
        aGUKICBvYmplY3QgaW1wbGVtZW50cyB0aGUgYHVua25vd25Qcm9wZXJ0eWAg
        bWV0aG9kIHRoZW4gdGhhdCB3aWxsIGJlIGludm9rZWQuCgogIElmIHlvdSBw
        bGFuIHRvIHJ1biBvbiBJRTggYW5kIG9sZGVyIGJyb3dzZXJzIHRoZW4geW91
        IHNob3VsZCB1c2UgdGhpcwogIG1ldGhvZCBhbnl0aW1lIHlvdSB3YW50IHRv
        IHJldHJpZXZlIGEgcHJvcGVydHkgb24gYW4gb2JqZWN0IHRoYXQgeW91IGRv
        bid0CiAga25vdyBmb3Igc3VyZSBpcyBwcml2YXRlLiAoUHJvcGVydGllcyBi
        ZWdpbm5pbmcgd2l0aCBhbiB1bmRlcnNjb3JlICdfJwogIGFyZSBjb25zaWRl
        cmVkIHByaXZhdGUuKQoKICBPbiBhbGwgbmV3ZXIgYnJvd3NlcnMsIHlvdSBv
        bmx5IG5lZWQgdG8gdXNlIHRoaXMgbWV0aG9kIHRvIHJldHJpZXZlCiAgcHJv
        cGVydGllcyBpZiB0aGUgcHJvcGVydHkgbWlnaHQgbm90IGJlIGRlZmluZWQg
        b24gdGhlIG9iamVjdCBhbmQgeW91IHdhbnQKICB0byByZXNwZWN0IHRoZSBg
        dW5rbm93blByb3BlcnR5YCBoYW5kbGVyLiBPdGhlcndpc2UgeW91IGNhbiBp
        Z25vcmUgdGhpcwogIG1ldGhvZC4KCiAgTm90ZSB0aGF0IGlmIHRoZSBvYmpl
        Y3QgaXRzZWxmIGlzIGB1bmRlZmluZWRgLCB0aGlzIG1ldGhvZCB3aWxsIHRo
        cm93CiAgYW4gZXJyb3IuCgogIEBtZXRob2QgZ2V0CiAgQGZvciBFbWJlcgog
        IEBwYXJhbSB7T2JqZWN0fSBvYmogVGhlIG9iamVjdCB0byByZXRyaWV2ZSBm
        cm9tLgogIEBwYXJhbSB7U3RyaW5nfSBrZXlOYW1lIFRoZSBwcm9wZXJ0eSBr
        ZXkgdG8gcmV0cmlldmUKICBAcmV0dXJuIHtPYmplY3R9IHRoZSBwcm9wZXJ0
        eSB2YWx1ZSBvciBgbnVsbGAuCiovCmdldCA9IGZ1bmN0aW9uIGdldChvYmos
        IGtleU5hbWUpIHsKICAvLyBIZWxwZXJzIHRoYXQgb3BlcmF0ZSB3aXRoICd0
        aGlzJyB3aXRoaW4gYW4gI2VhY2gKICBpZiAoa2V5TmFtZSA9PT0gJycpIHsK
        ICAgIHJldHVybiBvYmo7CiAgfQoKICBpZiAoIWtleU5hbWUgJiYgJ3N0cmlu
        Zyc9PT10eXBlb2Ygb2JqKSB7CiAgICBrZXlOYW1lID0gb2JqOwogICAgb2Jq
        ID0gbnVsbDsKICB9CgogIEVtYmVyLmFzc2VydCgiQ2Fubm90IGNhbGwgZ2V0
        IHdpdGggIisga2V5TmFtZSArIiBrZXkuIiwgISFrZXlOYW1lKTsKICBFbWJl
        ci5hc3NlcnQoIkNhbm5vdCBjYWxsIGdldCB3aXRoICciKyBrZXlOYW1lICsi
        JyBvbiBhbiB1bmRlZmluZWQgb2JqZWN0LiIsIG9iaiAhPT0gdW5kZWZpbmVk
        KTsKCiAgaWYgKG9iaiA9PT0gbnVsbCB8fCBrZXlOYW1lLmluZGV4T2YoJy4n
        KSAhPT0gLTEpIHsKICAgIHJldHVybiBnZXRQYXRoKG9iaiwga2V5TmFtZSk7
        CiAgfQoKICB2YXIgbWV0YSA9IG9ialtNRVRBX0tFWV0sIGRlc2MgPSBtZXRh
        ICYmIG1ldGEuZGVzY3Nba2V5TmFtZV0sIHJldDsKICBpZiAoZGVzYykgewog
        ICAgcmV0dXJuIGRlc2MuZ2V0KG9iaiwga2V5TmFtZSk7CiAgfSBlbHNlIHsK
        ICAgIGlmIChNQU5EQVRPUllfU0VUVEVSICYmIG1ldGEgJiYgbWV0YS53YXRj
        aGluZ1trZXlOYW1lXSA+IDApIHsKICAgICAgcmV0ID0gbWV0YS52YWx1ZXNb
        a2V5TmFtZV07CiAgICB9IGVsc2UgewogICAgICByZXQgPSBvYmpba2V5TmFt
        ZV07CiAgICB9CgogICAgaWYgKHJldCA9PT0gdW5kZWZpbmVkICYmCiAgICAg
        ICAgJ29iamVjdCcgPT09IHR5cGVvZiBvYmogJiYgIShrZXlOYW1lIGluIG9i
        aikgJiYgJ2Z1bmN0aW9uJyA9PT0gdHlwZW9mIG9iai51bmtub3duUHJvcGVy
        dHkpIHsKICAgICAgcmV0dXJuIG9iai51bmtub3duUHJvcGVydHkoa2V5TmFt
        ZSk7CiAgICB9CgogICAgcmV0dXJuIHJldDsKICB9Cn07CgovLyBDdXJyZW50
        bHkgdXNlZCBvbmx5IGJ5IEVtYmVyIERhdGEgdGVzdHMKaWYgKEVtYmVyLmNv
        bmZpZy5vdmVycmlkZUFjY2Vzc29ycykgewogIEVtYmVyLmdldCA9IGdldDsK
        ICBFbWJlci5jb25maWcub3ZlcnJpZGVBY2Nlc3NvcnMoKTsKICBnZXQgPSBF
        bWJlci5nZXQ7Cn0KCi8qKgogIEBwcml2YXRlCgogIE5vcm1hbGl6ZXMgYSB0
        YXJnZXQvcGF0aCBwYWlyIHRvIHJlZmxlY3QgdGhhdCBhY3R1YWwgdGFyZ2V0
        L3BhdGggdGhhdCBzaG91bGQKICBiZSBvYnNlcnZlZCwgZXRjLiBUaGlzIHRh
        a2VzIGludG8gYWNjb3VudCBwYXNzaW5nIGluIGdsb2JhbCBwcm9wZXJ0eQog
        IHBhdGhzIChpLmUuIGEgcGF0aCBiZWdpbm5pbmcgd2l0aCBhIGNhcHRpYWwg
        bGV0dGVyIG5vdCBkZWZpbmVkIG9uIHRoZQogIHRhcmdldCkgYW5kICogc2Vw
        YXJhdG9ycy4KCiAgQG1ldGhvZCBub3JtYWxpemVUdXBsZQogIEBmb3IgRW1i
        ZXIKICBAcGFyYW0ge09iamVjdH0gdGFyZ2V0IFRoZSBjdXJyZW50IHRhcmdl
        dC4gTWF5IGJlIGBudWxsYC4KICBAcGFyYW0ge1N0cmluZ30gcGF0aCBBIHBh
        dGggb24gdGhlIHRhcmdldCBvciBhIGdsb2JhbCBwcm9wZXJ0eSBwYXRoLgog
        IEByZXR1cm4ge0FycmF5fSBhIHRlbXBvcmFyeSBhcnJheSB3aXRoIHRoZSBu
        b3JtYWxpemVkIHRhcmdldC9wYXRoIHBhaXIuCiovCnZhciBub3JtYWxpemVU
        dXBsZSA9IEVtYmVyLm5vcm1hbGl6ZVR1cGxlID0gZnVuY3Rpb24odGFyZ2V0
        LCBwYXRoKSB7CiAgdmFyIGhhc1RoaXMgID0gSEFTX1RISVMudGVzdChwYXRo
        KSwKICAgICAgaXNHbG9iYWwgPSAhaGFzVGhpcyAmJiBJU19HTE9CQUxfUEFU
        SC50ZXN0KHBhdGgpLAogICAgICBrZXk7CgogIGlmICghdGFyZ2V0IHx8IGlz
        R2xvYmFsKSB0YXJnZXQgPSBFbWJlci5sb29rdXA7CiAgaWYgKGhhc1RoaXMp
        IHBhdGggPSBwYXRoLnNsaWNlKDUpOwoKICBpZiAodGFyZ2V0ID09PSBFbWJl
        ci5sb29rdXApIHsKICAgIGtleSA9IHBhdGgubWF0Y2goRklSU1RfS0VZKVsw
        XTsKICAgIHRhcmdldCA9IGdldCh0YXJnZXQsIGtleSk7CiAgICBwYXRoICAg
        PSBwYXRoLnNsaWNlKGtleS5sZW5ndGgrMSk7CiAgfQoKICAvLyBtdXN0IHJl
        dHVybiBzb21lIGtpbmQgb2YgcGF0aCB0byBiZSB2YWxpZCBlbHNlIG90aGVy
        IHRoaW5ncyB3aWxsIGJyZWFrLgogIGlmICghcGF0aCB8fCBwYXRoLmxlbmd0
        aD09PTApIHRocm93IG5ldyBFcnJvcignSW52YWxpZCBQYXRoJyk7CgogIHJl
        dHVybiBbIHRhcmdldCwgcGF0aCBdOwp9OwoKdmFyIGdldFBhdGggPSBFbWJl
        ci5fZ2V0UGF0aCA9IGZ1bmN0aW9uKHJvb3QsIHBhdGgpIHsKICB2YXIgaGFz
        VGhpcywgcGFydHMsIHR1cGxlLCBpZHgsIGxlbjsKCiAgLy8gSWYgdGhlcmUg
        aXMgbm8gcm9vdCBhbmQgcGF0aCBpcyBhIGtleSBuYW1lLCByZXR1cm4gdGhh
        dAogIC8vIHByb3BlcnR5IGZyb20gdGhlIGdsb2JhbCBvYmplY3QuCiAgLy8g
        RS5nLiBnZXQoJ0VtYmVyJykgLT4gRW1iZXIKICBpZiAocm9vdCA9PT0gbnVs
        bCAmJiBwYXRoLmluZGV4T2YoJy4nKSA9PT0gLTEpIHsgcmV0dXJuIGdldChF
        bWJlci5sb29rdXAsIHBhdGgpOyB9CgogIC8vIGRldGVjdCBjb21wbGljYXRl
        ZCBwYXRocyBhbmQgbm9ybWFsaXplIHRoZW0KICBoYXNUaGlzICA9IEhBU19U
        SElTLnRlc3QocGF0aCk7CgogIGlmICghcm9vdCB8fCBoYXNUaGlzKSB7CiAg
        ICB0dXBsZSA9IG5vcm1hbGl6ZVR1cGxlKHJvb3QsIHBhdGgpOwogICAgcm9v
        dCA9IHR1cGxlWzBdOwogICAgcGF0aCA9IHR1cGxlWzFdOwogICAgdHVwbGUu
        bGVuZ3RoID0gMDsKICB9CgogIHBhcnRzID0gcGF0aC5zcGxpdCgiLiIpOwog
        IGxlbiA9IHBhcnRzLmxlbmd0aDsKICBmb3IgKGlkeCA9IDA7IHJvb3QgIT0g
        bnVsbCAmJiBpZHggPCBsZW47IGlkeCsrKSB7CiAgICByb290ID0gZ2V0KHJv
        b3QsIHBhcnRzW2lkeF0sIHRydWUpOwogICAgaWYgKHJvb3QgJiYgcm9vdC5p
        c0Rlc3Ryb3llZCkgeyByZXR1cm4gdW5kZWZpbmVkOyB9CiAgfQogIHJldHVy
        biByb290Owp9OwoKRW1iZXIuZ2V0V2l0aERlZmF1bHQgPSBmdW5jdGlvbihy
        b290LCBrZXksIGRlZmF1bHRWYWx1ZSkgewogIHZhciB2YWx1ZSA9IGdldChy
        b290LCBrZXkpOwoKICBpZiAodmFsdWUgPT09IHVuZGVmaW5lZCkgeyByZXR1
        cm4gZGVmYXVsdFZhbHVlOyB9CiAgcmV0dXJuIHZhbHVlOwp9OwoKCkVtYmVy
        LmdldCA9IGdldDsKRW1iZXIuZ2V0UGF0aCA9IEVtYmVyLmRlcHJlY2F0ZUZ1
        bmMoJ2dldFBhdGggaXMgZGVwcmVjYXRlZCBzaW5jZSBnZXQgbm93IHN1cHBv
        cnRzIHBhdGhzJywgRW1iZXIuZ2V0KTsKCn0pKCk7CgoKCihmdW5jdGlvbigp
        IHsKLyoqCkBtb2R1bGUgZW1iZXItbWV0YWwKKi8KCnZhciBvX2NyZWF0ZSA9
        IEVtYmVyLmNyZWF0ZSwKICAgIG1ldGFGb3IgPSBFbWJlci5tZXRhLAogICAg
        TUVUQV9LRVkgPSBFbWJlci5NRVRBX0tFWSwKICAgIGFfc2xpY2UgPSBbXS5z
        bGljZSwKICAgIC8qIGxpc3RlbmVyIGZsYWdzICovCiAgICBPTkNFID0gMSwg
        U1VTUEVOREVEID0gMjsKCi8qCiAgVGhlIGV2ZW50IHN5c3RlbSB1c2VzIGEg
        c2VyaWVzIG9mIG5lc3RlZCBoYXNoZXMgdG8gc3RvcmUgbGlzdGVuZXJzIG9u
        IGFuCiAgb2JqZWN0LiBXaGVuIGEgbGlzdGVuZXIgaXMgcmVnaXN0ZXJlZCwg
        b3Igd2hlbiBhbiBldmVudCBhcnJpdmVzLCB0aGVzZQogIGhhc2hlcyBhcmUg
        Y29uc3VsdGVkIHRvIGRldGVybWluZSB3aGljaCB0YXJnZXQgYW5kIGFjdGlv
        biBwYWlyIHRvIGludm9rZS4KCiAgVGhlIGhhc2hlcyBhcmUgc3RvcmVkIGlu
        IHRoZSBvYmplY3QncyBtZXRhIGhhc2gsIGFuZCBsb29rIGxpa2UgdGhpczoK
        CiAgICAgIC8vIE9iamVjdCdzIG1ldGEgaGFzaAogICAgICB7CiAgICAgICAg
        bGlzdGVuZXJzOiB7ICAgICAgIC8vIHZhcmlhYmxlIG5hbWU6IGBsaXN0ZW5l
        clNldGAKICAgICAgICAgICJmb286Y2hhbmdlZCI6IFsgLy8gdmFyaWFibGUg
        bmFtZTogYGFjdGlvbnNgCiAgICAgICAgICAgIHRhcmdldCwgbWV0aG9kLCBm
        bGFncwogICAgICAgICAgXQogICAgICAgIH0KICAgICAgfQoKKi8KCmZ1bmN0
        aW9uIGluZGV4T2YoYXJyYXksIHRhcmdldCwgbWV0aG9kKSB7CiAgdmFyIGlu
        ZGV4ID0gLTE7CiAgZm9yICh2YXIgaSA9IDAsIGwgPSBhcnJheS5sZW5ndGg7
        IGkgPCBsOyBpICs9IDMpIHsKICAgIGlmICh0YXJnZXQgPT09IGFycmF5W2ld
        ICYmIG1ldGhvZCA9PT0gYXJyYXlbaSsxXSkgeyBpbmRleCA9IGk7IGJyZWFr
        OyB9CiAgfQogIHJldHVybiBpbmRleDsKfQoKZnVuY3Rpb24gYWN0aW9uc0Zv
        cihvYmosIGV2ZW50TmFtZSkgewogIHZhciBtZXRhID0gbWV0YUZvcihvYmos
        IHRydWUpLAogICAgICBhY3Rpb25zOwoKICBpZiAoIW1ldGEubGlzdGVuZXJz
        KSB7IG1ldGEubGlzdGVuZXJzID0ge307IH0KCiAgaWYgKCFtZXRhLmhhc093
        blByb3BlcnR5KCdsaXN0ZW5lcnMnKSkgewogICAgLy8gc2V0dXAgaW5oZXJp
        dGVkIGNvcHkgb2YgdGhlIGxpc3RlbmVycyBvYmplY3QKICAgIG1ldGEubGlz
        dGVuZXJzID0gb19jcmVhdGUobWV0YS5saXN0ZW5lcnMpOwogIH0KCiAgYWN0
        aW9ucyA9IG1ldGEubGlzdGVuZXJzW2V2ZW50TmFtZV07CgogIC8vIGlmIHRo
        ZXJlIGFyZSBhY3Rpb25zLCBidXQgdGhlIGV2ZW50TmFtZSBkb2Vzbid0IGV4
        aXN0IGluIG91ciBsaXN0ZW5lcnMsIHRoZW4gY29weSB0aGVtIGZyb20gdGhl
        IHByb3RvdHlwZQogIGlmIChhY3Rpb25zICYmICFtZXRhLmxpc3RlbmVycy5o
        YXNPd25Qcm9wZXJ0eShldmVudE5hbWUpKSB7CiAgICBhY3Rpb25zID0gbWV0
        YS5saXN0ZW5lcnNbZXZlbnROYW1lXSA9IG1ldGEubGlzdGVuZXJzW2V2ZW50
        TmFtZV0uc2xpY2UoKTsKICB9IGVsc2UgaWYgKCFhY3Rpb25zKSB7CiAgICBh
        Y3Rpb25zID0gbWV0YS5saXN0ZW5lcnNbZXZlbnROYW1lXSA9IFtdOwogIH0K
        CiAgcmV0dXJuIGFjdGlvbnM7Cn0KCmZ1bmN0aW9uIGFjdGlvbnNVbmlvbihv
        YmosIGV2ZW50TmFtZSwgb3RoZXJBY3Rpb25zKSB7CiAgdmFyIG1ldGEgPSBv
        YmpbTUVUQV9LRVldLAogICAgICBhY3Rpb25zID0gbWV0YSAmJiBtZXRhLmxp
        c3RlbmVycyAmJiBtZXRhLmxpc3RlbmVyc1tldmVudE5hbWVdOwoKICBpZiAo
        IWFjdGlvbnMpIHsgcmV0dXJuOyB9CiAgZm9yICh2YXIgaSA9IGFjdGlvbnMu
        bGVuZ3RoIC0gMzsgaSA+PSAwOyBpIC09IDMpIHsKICAgIHZhciB0YXJnZXQg
        PSBhY3Rpb25zW2ldLAogICAgICAgIG1ldGhvZCA9IGFjdGlvbnNbaSsxXSwK
        ICAgICAgICBmbGFncyA9IGFjdGlvbnNbaSsyXSwKICAgICAgICBhY3Rpb25J
        bmRleCA9IGluZGV4T2Yob3RoZXJBY3Rpb25zLCB0YXJnZXQsIG1ldGhvZCk7
        CgogICAgaWYgKGFjdGlvbkluZGV4ID09PSAtMSkgewogICAgICBvdGhlckFj
        dGlvbnMucHVzaCh0YXJnZXQsIG1ldGhvZCwgZmxhZ3MpOwogICAgfQogIH0K
        fQoKZnVuY3Rpb24gYWN0aW9uc0RpZmYob2JqLCBldmVudE5hbWUsIG90aGVy
        QWN0aW9ucykgewogIHZhciBtZXRhID0gb2JqW01FVEFfS0VZXSwKICAgICAg
        YWN0aW9ucyA9IG1ldGEgJiYgbWV0YS5saXN0ZW5lcnMgJiYgbWV0YS5saXN0
        ZW5lcnNbZXZlbnROYW1lXSwKICAgICAgZGlmZkFjdGlvbnMgPSBbXTsKCiAg
        aWYgKCFhY3Rpb25zKSB7IHJldHVybjsgfQogIGZvciAodmFyIGkgPSBhY3Rp
        b25zLmxlbmd0aCAtIDM7IGkgPj0gMDsgaSAtPSAzKSB7CiAgICB2YXIgdGFy
        Z2V0ID0gYWN0aW9uc1tpXSwKICAgICAgICBtZXRob2QgPSBhY3Rpb25zW2kr
        MV0sCiAgICAgICAgZmxhZ3MgPSBhY3Rpb25zW2krMl0sCiAgICAgICAgYWN0
        aW9uSW5kZXggPSBpbmRleE9mKG90aGVyQWN0aW9ucywgdGFyZ2V0LCBtZXRo
        b2QpOwoKICAgIGlmIChhY3Rpb25JbmRleCAhPT0gLTEpIHsgY29udGludWU7
        IH0KCiAgICBvdGhlckFjdGlvbnMucHVzaCh0YXJnZXQsIG1ldGhvZCwgZmxh
        Z3MpOwogICAgZGlmZkFjdGlvbnMucHVzaCh0YXJnZXQsIG1ldGhvZCwgZmxh
        Z3MpOwogIH0KCiAgcmV0dXJuIGRpZmZBY3Rpb25zOwp9CgovKioKICBBZGQg
        YW4gZXZlbnQgbGlzdGVuZXIKCiAgQG1ldGhvZCBhZGRMaXN0ZW5lcgogIEBm
        b3IgRW1iZXIKICBAcGFyYW0gb2JqCiAgQHBhcmFtIHtTdHJpbmd9IGV2ZW50
        TmFtZQogIEBwYXJhbSB7T2JqZWN0fEZ1bmN0aW9ufSB0YXJnZXRPck1ldGhv
        ZCBBIHRhcmdldCBvYmplY3Qgb3IgYSBmdW5jdGlvbgogIEBwYXJhbSB7RnVu
        Y3Rpb258U3RyaW5nfSBtZXRob2QgQSBmdW5jdGlvbiBvciB0aGUgbmFtZSBv
        ZiBhIGZ1bmN0aW9uIHRvIGJlIGNhbGxlZCBvbiBgdGFyZ2V0YAogIEBwYXJh
        bSB7Qm9vbGVhbn0gb25jZSBBIGZsYWcgd2hldGhlciBhIGZ1bmN0aW9uIHNo
        b3VsZCBvbmx5IGJlIGNhbGxlZCBvbmNlCiovCmZ1bmN0aW9uIGFkZExpc3Rl
        bmVyKG9iaiwgZXZlbnROYW1lLCB0YXJnZXQsIG1ldGhvZCwgb25jZSkgewog
        IEVtYmVyLmFzc2VydCgiWW91IG11c3QgcGFzcyBhdCBsZWFzdCBhbiBvYmpl
        Y3QgYW5kIGV2ZW50IG5hbWUgdG8gRW1iZXIuYWRkTGlzdGVuZXIiLCAhIW9i
        aiAmJiAhIWV2ZW50TmFtZSk7CgogIGlmICghbWV0aG9kICYmICdmdW5jdGlv
        bicgPT09IHR5cGVvZiB0YXJnZXQpIHsKICAgIG1ldGhvZCA9IHRhcmdldDsK
        ICAgIHRhcmdldCA9IG51bGw7CiAgfQoKICB2YXIgYWN0aW9ucyA9IGFjdGlv
        bnNGb3Iob2JqLCBldmVudE5hbWUpLAogICAgICBhY3Rpb25JbmRleCA9IGlu
        ZGV4T2YoYWN0aW9ucywgdGFyZ2V0LCBtZXRob2QpLAogICAgICBmbGFncyA9
        IDA7CgogIGlmIChvbmNlKSBmbGFncyB8PSBPTkNFOwoKICBpZiAoYWN0aW9u
        SW5kZXggIT09IC0xKSB7IHJldHVybjsgfQoKICBhY3Rpb25zLnB1c2godGFy
        Z2V0LCBtZXRob2QsIGZsYWdzKTsKCiAgaWYgKCdmdW5jdGlvbicgPT09IHR5
        cGVvZiBvYmouZGlkQWRkTGlzdGVuZXIpIHsKICAgIG9iai5kaWRBZGRMaXN0
        ZW5lcihldmVudE5hbWUsIHRhcmdldCwgbWV0aG9kKTsKICB9Cn0KCi8qKgog
        IFJlbW92ZSBhbiBldmVudCBsaXN0ZW5lcgoKICBBcmd1bWVudHMgc2hvdWxk
        IG1hdGNoIHRob3NlIHBhc3NlZCB0byBgRW1iZXIuYWRkTGlzdGVuZXJgLgoK
        ICBAbWV0aG9kIHJlbW92ZUxpc3RlbmVyCiAgQGZvciBFbWJlcgogIEBwYXJh
        bSBvYmoKICBAcGFyYW0ge1N0cmluZ30gZXZlbnROYW1lCiAgQHBhcmFtIHtP
        YmplY3R8RnVuY3Rpb259IHRhcmdldE9yTWV0aG9kIEEgdGFyZ2V0IG9iamVj
        dCBvciBhIGZ1bmN0aW9uCiAgQHBhcmFtIHtGdW5jdGlvbnxTdHJpbmd9IG1l
        dGhvZCBBIGZ1bmN0aW9uIG9yIHRoZSBuYW1lIG9mIGEgZnVuY3Rpb24gdG8g
        YmUgY2FsbGVkIG9uIGB0YXJnZXRgCiovCmZ1bmN0aW9uIHJlbW92ZUxpc3Rl
        bmVyKG9iaiwgZXZlbnROYW1lLCB0YXJnZXQsIG1ldGhvZCkgewogIEVtYmVy
        LmFzc2VydCgiWW91IG11c3QgcGFzcyBhdCBsZWFzdCBhbiBvYmplY3QgYW5k
        IGV2ZW50IG5hbWUgdG8gRW1iZXIucmVtb3ZlTGlzdGVuZXIiLCAhIW9iaiAm
        JiAhIWV2ZW50TmFtZSk7CgogIGlmICghbWV0aG9kICYmICdmdW5jdGlvbicg
        PT09IHR5cGVvZiB0YXJnZXQpIHsKICAgIG1ldGhvZCA9IHRhcmdldDsKICAg
        IHRhcmdldCA9IG51bGw7CiAgfQoKICBmdW5jdGlvbiBfcmVtb3ZlTGlzdGVu
        ZXIodGFyZ2V0LCBtZXRob2QpIHsKICAgIHZhciBhY3Rpb25zID0gYWN0aW9u
        c0ZvcihvYmosIGV2ZW50TmFtZSksCiAgICAgICAgYWN0aW9uSW5kZXggPSBp
        bmRleE9mKGFjdGlvbnMsIHRhcmdldCwgbWV0aG9kKTsKCiAgICAvLyBhY3Rp
        b24gZG9lc24ndCBleGlzdCwgZ2l2ZSB1cCBzaWxlbnRseQogICAgaWYgKGFj
        dGlvbkluZGV4ID09PSAtMSkgeyByZXR1cm47IH0KCiAgICBhY3Rpb25zLnNw
        bGljZShhY3Rpb25JbmRleCwgMyk7CgogICAgaWYgKCdmdW5jdGlvbicgPT09
        IHR5cGVvZiBvYmouZGlkUmVtb3ZlTGlzdGVuZXIpIHsKICAgICAgb2JqLmRp
        ZFJlbW92ZUxpc3RlbmVyKGV2ZW50TmFtZSwgdGFyZ2V0LCBtZXRob2QpOwog
        ICAgfQogIH0KCiAgaWYgKG1ldGhvZCkgewogICAgX3JlbW92ZUxpc3RlbmVy
        KHRhcmdldCwgbWV0aG9kKTsKICB9IGVsc2UgewogICAgdmFyIG1ldGEgPSBv
        YmpbTUVUQV9LRVldLAogICAgICAgIGFjdGlvbnMgPSBtZXRhICYmIG1ldGEu
        bGlzdGVuZXJzICYmIG1ldGEubGlzdGVuZXJzW2V2ZW50TmFtZV07CgogICAg
        aWYgKCFhY3Rpb25zKSB7IHJldHVybjsgfQogICAgZm9yICh2YXIgaSA9IGFj
        dGlvbnMubGVuZ3RoIC0gMzsgaSA+PSAwOyBpIC09IDMpIHsKICAgICAgX3Jl
        bW92ZUxpc3RlbmVyKGFjdGlvbnNbaV0sIGFjdGlvbnNbaSsxXSk7CiAgICB9
        CiAgfQp9CgovKioKICBAcHJpdmF0ZQoKICBTdXNwZW5kIGxpc3RlbmVyIGR1
        cmluZyBjYWxsYmFjay4KCiAgVGhpcyBzaG91bGQgb25seSBiZSB1c2VkIGJ5
        IHRoZSB0YXJnZXQgb2YgdGhlIGV2ZW50IGxpc3RlbmVyCiAgd2hlbiBpdCBp
        cyB0YWtpbmcgYW4gYWN0aW9uIHRoYXQgd291bGQgY2F1c2UgdGhlIGV2ZW50
        LCBlLmcuCiAgYW4gb2JqZWN0IG1pZ2h0IHN1c3BlbmQgaXRzIHByb3BlcnR5
        IGNoYW5nZSBsaXN0ZW5lciB3aGlsZSBpdCBpcwogIHNldHRpbmcgdGhhdCBw
        cm9wZXJ0eS4KCiAgQG1ldGhvZCBzdXNwZW5kTGlzdGVuZXIKICBAZm9yIEVt
        YmVyCiAgQHBhcmFtIG9iagogIEBwYXJhbSB7U3RyaW5nfSBldmVudE5hbWUK
        ICBAcGFyYW0ge09iamVjdHxGdW5jdGlvbn0gdGFyZ2V0T3JNZXRob2QgQSB0
        YXJnZXQgb2JqZWN0IG9yIGEgZnVuY3Rpb24KICBAcGFyYW0ge0Z1bmN0aW9u
        fFN0cmluZ30gbWV0aG9kIEEgZnVuY3Rpb24gb3IgdGhlIG5hbWUgb2YgYSBm
        dW5jdGlvbiB0byBiZSBjYWxsZWQgb24gYHRhcmdldGAKICBAcGFyYW0ge0Z1
        bmN0aW9ufSBjYWxsYmFjawoqLwpmdW5jdGlvbiBzdXNwZW5kTGlzdGVuZXIo
        b2JqLCBldmVudE5hbWUsIHRhcmdldCwgbWV0aG9kLCBjYWxsYmFjaykgewog
        IGlmICghbWV0aG9kICYmICdmdW5jdGlvbicgPT09IHR5cGVvZiB0YXJnZXQp
        IHsKICAgIG1ldGhvZCA9IHRhcmdldDsKICAgIHRhcmdldCA9IG51bGw7CiAg
        fQoKICB2YXIgYWN0aW9ucyA9IGFjdGlvbnNGb3Iob2JqLCBldmVudE5hbWUp
        LAogICAgICBhY3Rpb25JbmRleCA9IGluZGV4T2YoYWN0aW9ucywgdGFyZ2V0
        LCBtZXRob2QpOwoKICBpZiAoYWN0aW9uSW5kZXggIT09IC0xKSB7CiAgICBh
        Y3Rpb25zW2FjdGlvbkluZGV4KzJdIHw9IFNVU1BFTkRFRDsgLy8gbWFyayB0
        aGUgYWN0aW9uIGFzIHN1c3BlbmRlZAogIH0KCiAgZnVuY3Rpb24gdHJ5YWJs
        ZSgpICAgeyByZXR1cm4gY2FsbGJhY2suY2FsbCh0YXJnZXQpOyB9CiAgZnVu
        Y3Rpb24gZmluYWxpemVyKCkgeyBpZiAoYWN0aW9uSW5kZXggIT09IC0xKSB7
        IGFjdGlvbnNbYWN0aW9uSW5kZXgrMl0gJj0gflNVU1BFTkRFRDsgfSB9Cgog
        IHJldHVybiBFbWJlci50cnlGaW5hbGx5KHRyeWFibGUsIGZpbmFsaXplcik7
        Cn0KCi8qKgogIEBwcml2YXRlCgogIFN1c3BlbmRzIG11bHRpcGxlIGxpc3Rl
        bmVycyBkdXJpbmcgYSBjYWxsYmFjay4KCiAgCiAgQG1ldGhvZCBzdXNwZW5k
        TGlzdGVuZXJzCiAgQGZvciBFbWJlcgogIEBwYXJhbSBvYmoKICBAcGFyYW0g
        e0FycmF5fSBldmVudE5hbWUgQXJyYXkgb2YgZXZlbnQgbmFtZXMKICBAcGFy
        YW0ge09iamVjdHxGdW5jdGlvbn0gdGFyZ2V0T3JNZXRob2QgQSB0YXJnZXQg
        b2JqZWN0IG9yIGEgZnVuY3Rpb24KICBAcGFyYW0ge0Z1bmN0aW9ufFN0cmlu
        Z30gbWV0aG9kIEEgZnVuY3Rpb24gb3IgdGhlIG5hbWUgb2YgYSBmdW5jdGlv
        biB0byBiZSBjYWxsZWQgb24gYHRhcmdldGAKICBAcGFyYW0ge0Z1bmN0aW9u
        fSBjYWxsYmFjawoqLwpmdW5jdGlvbiBzdXNwZW5kTGlzdGVuZXJzKG9iaiwg
        ZXZlbnROYW1lcywgdGFyZ2V0LCBtZXRob2QsIGNhbGxiYWNrKSB7CiAgaWYg
        KCFtZXRob2QgJiYgJ2Z1bmN0aW9uJyA9PT0gdHlwZW9mIHRhcmdldCkgewog
        ICAgbWV0aG9kID0gdGFyZ2V0OwogICAgdGFyZ2V0ID0gbnVsbDsKICB9Cgog
        IHZhciBzdXNwZW5kZWRBY3Rpb25zID0gW10sCiAgICAgIGFjdGlvbnNMaXN0
        ID0gW10sCiAgICAgIGV2ZW50TmFtZSwgYWN0aW9ucywgaSwgbDsKCiAgZm9y
        IChpPTAsIGw9ZXZlbnROYW1lcy5sZW5ndGg7IGk8bDsgaSsrKSB7CiAgICBl
        dmVudE5hbWUgPSBldmVudE5hbWVzW2ldOwogICAgYWN0aW9ucyA9IGFjdGlv
        bnNGb3Iob2JqLCBldmVudE5hbWUpOwogICAgdmFyIGFjdGlvbkluZGV4ID0g
        aW5kZXhPZihhY3Rpb25zLCB0YXJnZXQsIG1ldGhvZCk7CgogICAgaWYgKGFj
        dGlvbkluZGV4ICE9PSAtMSkgewogICAgICBhY3Rpb25zW2FjdGlvbkluZGV4
        KzJdIHw9IFNVU1BFTkRFRDsKICAgICAgc3VzcGVuZGVkQWN0aW9ucy5wdXNo
        KGFjdGlvbkluZGV4KTsKICAgICAgYWN0aW9uc0xpc3QucHVzaChhY3Rpb25z
        KTsKICAgIH0KICB9CgogIGZ1bmN0aW9uIHRyeWFibGUoKSB7IHJldHVybiBj
        YWxsYmFjay5jYWxsKHRhcmdldCk7IH0KCiAgZnVuY3Rpb24gZmluYWxpemVy
        KCkgewogICAgZm9yICh2YXIgaSA9IDAsIGwgPSBzdXNwZW5kZWRBY3Rpb25z
        Lmxlbmd0aDsgaSA8IGw7IGkrKykgewogICAgICB2YXIgYWN0aW9uSW5kZXgg
        PSBzdXNwZW5kZWRBY3Rpb25zW2ldOwogICAgICBhY3Rpb25zTGlzdFtpXVth
        Y3Rpb25JbmRleCsyXSAmPSB+U1VTUEVOREVEOwogICAgfQogIH0KCiAgcmV0
        dXJuIEVtYmVyLnRyeUZpbmFsbHkodHJ5YWJsZSwgZmluYWxpemVyKTsKfQoK
        LyoqCiAgQHByaXZhdGUKCiAgUmV0dXJuIGEgbGlzdCBvZiBjdXJyZW50bHkg
        d2F0Y2hlZCBldmVudHMKCiAgQG1ldGhvZCB3YXRjaGVkRXZlbnRzCiAgQGZv
        ciBFbWJlcgogIEBwYXJhbSBvYmoKKi8KZnVuY3Rpb24gd2F0Y2hlZEV2ZW50
        cyhvYmopIHsKICB2YXIgbGlzdGVuZXJzID0gb2JqW01FVEFfS0VZXS5saXN0
        ZW5lcnMsIHJldCA9IFtdOwoKICBpZiAobGlzdGVuZXJzKSB7CiAgICBmb3Io
        dmFyIGV2ZW50TmFtZSBpbiBsaXN0ZW5lcnMpIHsKICAgICAgaWYgKGxpc3Rl
        bmVyc1tldmVudE5hbWVdKSB7IHJldC5wdXNoKGV2ZW50TmFtZSk7IH0KICAg
        IH0KICB9CiAgcmV0dXJuIHJldDsKfQoKLyoqCiAgU2VuZCBhbiBldmVudC4g
        VGhlIGV4ZWN1dGlvbiBvZiBzdXNwZW5kZWQgbGlzdGVuZXJzCiAgaXMgc2tp
        cHBlZCwgYW5kIG9uY2UgbGlzdGVuZXJzIGFyZSByZW1vdmVkLiBBIGxpc3Rl
        bmVyIHdpdGhvdXQKICBhIHRhcmdldCBpcyBleGVjdXRlZCBvbiB0aGUgcGFz
        c2VkIG9iamVjdC4gSWYgYW4gYXJyYXkgb2YgYWN0aW9ucwogIGlzIG5vdCBw
        YXNzZWQsIHRoZSBhY3Rpb25zIHN0b3JlZCBvbiB0aGUgcGFzc2VkIG9iamVj
        dCBhcmUgaW52b2tlZC4KICAKICBAbWV0aG9kIHNlbmRFdmVudAogIEBmb3Ig
        RW1iZXIKICBAcGFyYW0gb2JqCiAgQHBhcmFtIHtTdHJpbmd9IGV2ZW50TmFt
        ZQogIEBwYXJhbSB7QXJyYXl9IHBhcmFtcyBPcHRpb25hbCBwYXJhbWV0ZXJz
        IGZvciBlYWNoIGxpc3RlbmVyLgogIEBwYXJhbSB7QXJyYXl9IGFjdGlvbnMg
        T3B0aW9uYWwgYXJyYXkgb2YgYWN0aW9ucyAobGlzdGVuZXJzKS4KICBAcmV0
        dXJuIHRydWUKKi8KZnVuY3Rpb24gc2VuZEV2ZW50KG9iaiwgZXZlbnROYW1l
        LCBwYXJhbXMsIGFjdGlvbnMpIHsKICAvLyBmaXJzdCBnaXZlIG9iamVjdCBh
        IGNoYW5jZSB0byBoYW5kbGUgaXQKICBpZiAob2JqICE9PSBFbWJlciAmJiAn
        ZnVuY3Rpb24nID09PSB0eXBlb2Ygb2JqLnNlbmRFdmVudCkgewogICAgb2Jq
        LnNlbmRFdmVudChldmVudE5hbWUsIHBhcmFtcyk7CiAgfQoKICBpZiAoIWFj
        dGlvbnMpIHsKICAgIHZhciBtZXRhID0gb2JqW01FVEFfS0VZXTsKICAgIGFj
        dGlvbnMgPSBtZXRhICYmIG1ldGEubGlzdGVuZXJzICYmIG1ldGEubGlzdGVu
        ZXJzW2V2ZW50TmFtZV07CiAgfQoKICBpZiAoIWFjdGlvbnMpIHsgcmV0dXJu
        OyB9CgogIGZvciAodmFyIGkgPSBhY3Rpb25zLmxlbmd0aCAtIDM7IGkgPj0g
        MDsgaSAtPSAzKSB7IC8vIGxvb3BpbmcgaW4gcmV2ZXJzZSBmb3Igb25jZSBs
        aXN0ZW5lcnMKICAgIHZhciB0YXJnZXQgPSBhY3Rpb25zW2ldLCBtZXRob2Qg
        PSBhY3Rpb25zW2krMV0sIGZsYWdzID0gYWN0aW9uc1tpKzJdOwogICAgaWYg
        KCFtZXRob2QpIHsgY29udGludWU7IH0KICAgIGlmIChmbGFncyAmIFNVU1BF
        TkRFRCkgeyBjb250aW51ZTsgfQogICAgaWYgKGZsYWdzICYgT05DRSkgeyBy
        ZW1vdmVMaXN0ZW5lcihvYmosIGV2ZW50TmFtZSwgdGFyZ2V0LCBtZXRob2Qp
        OyB9CiAgICBpZiAoIXRhcmdldCkgeyB0YXJnZXQgPSBvYmo7IH0KICAgIGlm
        ICgnc3RyaW5nJyA9PT0gdHlwZW9mIG1ldGhvZCkgeyBtZXRob2QgPSB0YXJn
        ZXRbbWV0aG9kXTsgfQogICAgaWYgKHBhcmFtcykgewogICAgICBtZXRob2Qu
        YXBwbHkodGFyZ2V0LCBwYXJhbXMpOwogICAgfSBlbHNlIHsKICAgICAgbWV0
        aG9kLmNhbGwodGFyZ2V0KTsKICAgIH0KICB9CiAgcmV0dXJuIHRydWU7Cn0K
        Ci8qKgogIEBwcml2YXRlCiAgQG1ldGhvZCBoYXNMaXN0ZW5lcnMKICBAZm9y
        IEVtYmVyCiAgQHBhcmFtIG9iagogIEBwYXJhbSB7U3RyaW5nfSBldmVudE5h
        bWUKKi8KZnVuY3Rpb24gaGFzTGlzdGVuZXJzKG9iaiwgZXZlbnROYW1lKSB7
        CiAgdmFyIG1ldGEgPSBvYmpbTUVUQV9LRVldLAogICAgICBhY3Rpb25zID0g
        bWV0YSAmJiBtZXRhLmxpc3RlbmVycyAmJiBtZXRhLmxpc3RlbmVyc1tldmVu
        dE5hbWVdOwoKICByZXR1cm4gISEoYWN0aW9ucyAmJiBhY3Rpb25zLmxlbmd0
        aCk7Cn0KCi8qKgogIEBwcml2YXRlCiAgQG1ldGhvZCBsaXN0ZW5lcnNGb3IK
        ICBAZm9yIEVtYmVyCiAgQHBhcmFtIG9iagogIEBwYXJhbSB7U3RyaW5nfSBl
        dmVudE5hbWUKKi8KZnVuY3Rpb24gbGlzdGVuZXJzRm9yKG9iaiwgZXZlbnRO
        YW1lKSB7CiAgdmFyIHJldCA9IFtdOwogIHZhciBtZXRhID0gb2JqW01FVEFf
        S0VZXSwKICAgICAgYWN0aW9ucyA9IG1ldGEgJiYgbWV0YS5saXN0ZW5lcnMg
        JiYgbWV0YS5saXN0ZW5lcnNbZXZlbnROYW1lXTsKCiAgaWYgKCFhY3Rpb25z
        KSB7IHJldHVybiByZXQ7IH0KCiAgZm9yICh2YXIgaSA9IDAsIGwgPSBhY3Rp
        b25zLmxlbmd0aDsgaSA8IGw7IGkgKz0gMykgewogICAgdmFyIHRhcmdldCA9
        IGFjdGlvbnNbaV0sCiAgICAgICAgbWV0aG9kID0gYWN0aW9uc1tpKzFdOwog
        ICAgcmV0LnB1c2goW3RhcmdldCwgbWV0aG9kXSk7CiAgfQoKICByZXR1cm4g
        cmV0Owp9CgovKioKICBEZWZpbmUgYSBwcm9wZXJ0eSBhcyBhIGZ1bmN0aW9u
        IHRoYXQgc2hvdWxkIGJlIGV4ZWN1dGVkIHdoZW4KICBhIHNwZWNpZmllZCBl
        dmVudCBvciBldmVudHMgYXJlIHRyaWdnZXJlZC4KCiAgICAgIHZhciBKb2Ig
        PSBFbWJlci5PYmplY3QuZXh0ZW5kKHsKICAgICAgICBsb2dDb21wbGV0ZWQ6
        IEVtYmVyLm9uKCdjb21wbGV0ZWQnLCBmdW5jdGlvbigpewogICAgICAgICAg
        Y29uc29sZS5sb2coJ0pvYiBjb21wbGV0ZWQhJyk7CiAgICAgICAgfSkKICAg
        ICAgfSk7CiAgICAgIHZhciBqb2IgPSBKb2IuY3JlYXRlKCk7CiAgICAgIEVt
        YmVyLnNlbmRFdmVudChqb2IsICdjb21wbGV0ZWQnKTsgLy8gTG9ncyAiSm9i
        IGNvbXBsZXRlZCEiCgogIEBtZXRob2Qgb24KICBAZm9yIEVtYmVyCiAgQHBh
        cmFtIHtTdHJpbmd9IGV2ZW50TmFtZXMqCiAgQHBhcmFtIHtGdW5jdGlvbn0g
        ZnVuYwogIEByZXR1cm4gZnVuYwoqLwpFbWJlci5vbiA9IGZ1bmN0aW9uKCl7
        CiAgdmFyIGZ1bmMgPSBhX3NsaWNlLmNhbGwoYXJndW1lbnRzLCAtMSlbMF0s
        CiAgICAgIGV2ZW50cyA9IGFfc2xpY2UuY2FsbChhcmd1bWVudHMsIDAsIC0x
        KTsKICBmdW5jLl9fZW1iZXJfbGlzdGVuc19fID0gZXZlbnRzOwogIHJldHVy
        biBmdW5jOwp9OwoKRW1iZXIuYWRkTGlzdGVuZXIgPSBhZGRMaXN0ZW5lcjsK
        RW1iZXIucmVtb3ZlTGlzdGVuZXIgPSByZW1vdmVMaXN0ZW5lcjsKRW1iZXIu
        X3N1c3BlbmRMaXN0ZW5lciA9IHN1c3BlbmRMaXN0ZW5lcjsKRW1iZXIuX3N1
        c3BlbmRMaXN0ZW5lcnMgPSBzdXNwZW5kTGlzdGVuZXJzOwpFbWJlci5zZW5k
        RXZlbnQgPSBzZW5kRXZlbnQ7CkVtYmVyLmhhc0xpc3RlbmVycyA9IGhhc0xp
        c3RlbmVyczsKRW1iZXIud2F0Y2hlZEV2ZW50cyA9IHdhdGNoZWRFdmVudHM7
        CkVtYmVyLmxpc3RlbmVyc0ZvciA9IGxpc3RlbmVyc0ZvcjsKRW1iZXIubGlz
        dGVuZXJzRGlmZiA9IGFjdGlvbnNEaWZmOwpFbWJlci5saXN0ZW5lcnNVbmlv
        biA9IGFjdGlvbnNVbmlvbjsKCn0pKCk7CgoKCihmdW5jdGlvbigpIHsKdmFy
        IGd1aWRGb3IgPSBFbWJlci5ndWlkRm9yLAogICAgc2VuZEV2ZW50ID0gRW1i
        ZXIuc2VuZEV2ZW50OwoKLyoKICB0aGlzLm9ic2VydmVyU2V0ID0gewogICAg
        W3NlbmRlckd1aWRdOiB7IC8vIHZhcmlhYmxlIG5hbWU6IGBrZXlTZXRgCiAg
        ICAgIFtrZXlOYW1lXTogbGlzdEluZGV4CiAgICB9CiAgfSwKICB0aGlzLm9i
        c2VydmVycyA9IFsKICAgIHsKICAgICAgc2VuZGVyOiBvYmosCiAgICAgIGtl
        eU5hbWU6IGtleU5hbWUsCiAgICAgIGV2ZW50TmFtZTogZXZlbnROYW1lLAog
        ICAgICBsaXN0ZW5lcnM6IFsKICAgICAgICBbdGFyZ2V0LCBtZXRob2QsIGZs
        YWdzXQogICAgICBdCiAgICB9LAogICAgLi4uCiAgXQoqLwp2YXIgT2JzZXJ2
        ZXJTZXQgPSBFbWJlci5fT2JzZXJ2ZXJTZXQgPSBmdW5jdGlvbigpIHsKICB0
        aGlzLmNsZWFyKCk7Cn07CgpPYnNlcnZlclNldC5wcm90b3R5cGUuYWRkID0g
        ZnVuY3Rpb24oc2VuZGVyLCBrZXlOYW1lLCBldmVudE5hbWUpIHsKICB2YXIg
        b2JzZXJ2ZXJTZXQgPSB0aGlzLm9ic2VydmVyU2V0LAogICAgICBvYnNlcnZl
        cnMgPSB0aGlzLm9ic2VydmVycywKICAgICAgc2VuZGVyR3VpZCA9IGd1aWRG
        b3Ioc2VuZGVyKSwKICAgICAga2V5U2V0ID0gb2JzZXJ2ZXJTZXRbc2VuZGVy
        R3VpZF0sCiAgICAgIGluZGV4OwoKICBpZiAoIWtleVNldCkgewogICAgb2Jz
        ZXJ2ZXJTZXRbc2VuZGVyR3VpZF0gPSBrZXlTZXQgPSB7fTsKICB9CiAgaW5k
        ZXggPSBrZXlTZXRba2V5TmFtZV07CiAgaWYgKGluZGV4ID09PSB1bmRlZmlu
        ZWQpIHsKICAgIGluZGV4ID0gb2JzZXJ2ZXJzLnB1c2goewogICAgICBzZW5k
        ZXI6IHNlbmRlciwKICAgICAga2V5TmFtZToga2V5TmFtZSwKICAgICAgZXZl
        bnROYW1lOiBldmVudE5hbWUsCiAgICAgIGxpc3RlbmVyczogW10KICAgIH0p
        IC0gMTsKICAgIGtleVNldFtrZXlOYW1lXSA9IGluZGV4OwogIH0KICByZXR1
        cm4gb2JzZXJ2ZXJzW2luZGV4XS5saXN0ZW5lcnM7Cn07CgpPYnNlcnZlclNl
        dC5wcm90b3R5cGUuZmx1c2ggPSBmdW5jdGlvbigpIHsKICB2YXIgb2JzZXJ2
        ZXJzID0gdGhpcy5vYnNlcnZlcnMsIGksIGxlbiwgb2JzZXJ2ZXIsIHNlbmRl
        cjsKICB0aGlzLmNsZWFyKCk7CiAgZm9yIChpPTAsIGxlbj1vYnNlcnZlcnMu
        bGVuZ3RoOyBpIDwgbGVuOyArK2kpIHsKICAgIG9ic2VydmVyID0gb2JzZXJ2
        ZXJzW2ldOwogICAgc2VuZGVyID0gb2JzZXJ2ZXIuc2VuZGVyOwogICAgaWYg
        KHNlbmRlci5pc0Rlc3Ryb3lpbmcgfHwgc2VuZGVyLmlzRGVzdHJveWVkKSB7
        IGNvbnRpbnVlOyB9CiAgICBzZW5kRXZlbnQoc2VuZGVyLCBvYnNlcnZlci5l
        dmVudE5hbWUsIFtzZW5kZXIsIG9ic2VydmVyLmtleU5hbWVdLCBvYnNlcnZl
        ci5saXN0ZW5lcnMpOwogIH0KfTsKCk9ic2VydmVyU2V0LnByb3RvdHlwZS5j
        bGVhciA9IGZ1bmN0aW9uKCkgewogIHRoaXMub2JzZXJ2ZXJTZXQgPSB7fTsK
        ICB0aGlzLm9ic2VydmVycyA9IFtdOwp9Owp9KSgpOwoKCgooZnVuY3Rpb24o
        KSB7CnZhciBtZXRhRm9yID0gRW1iZXIubWV0YSwKICAgIGd1aWRGb3IgPSBF
        bWJlci5ndWlkRm9yLAogICAgdHJ5RmluYWxseSA9IEVtYmVyLnRyeUZpbmFs
        bHksCiAgICBzZW5kRXZlbnQgPSBFbWJlci5zZW5kRXZlbnQsCiAgICBsaXN0
        ZW5lcnNVbmlvbiA9IEVtYmVyLmxpc3RlbmVyc1VuaW9uLAogICAgbGlzdGVu
        ZXJzRGlmZiA9IEVtYmVyLmxpc3RlbmVyc0RpZmYsCiAgICBPYnNlcnZlclNl
        dCA9IEVtYmVyLl9PYnNlcnZlclNldCwKICAgIGJlZm9yZU9ic2VydmVyU2V0
        ID0gbmV3IE9ic2VydmVyU2V0KCksCiAgICBvYnNlcnZlclNldCA9IG5ldyBP
        YnNlcnZlclNldCgpLAogICAgZGVmZXJyZWQgPSAwOwoKLy8gLi4uLi4uLi4u
        Li4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4u
        Li4uLgovLyBQUk9QRVJUWSBDSEFOR0VTCi8vCgovKioKICBUaGlzIGZ1bmN0
        aW9uIGlzIGNhbGxlZCBqdXN0IGJlZm9yZSBhbiBvYmplY3QgcHJvcGVydHkg
        aXMgYWJvdXQgdG8gY2hhbmdlLgogIEl0IHdpbGwgbm90aWZ5IGFueSBiZWZv
        cmUgb2JzZXJ2ZXJzIGFuZCBwcmVwYXJlIGNhY2hlcyBhbW9uZyBvdGhlciB0
        aGluZ3MuCgogIE5vcm1hbGx5IHlvdSB3aWxsIG5vdCBuZWVkIHRvIGNhbGwg
        dGhpcyBtZXRob2QgZGlyZWN0bHkgYnV0IGlmIGZvciBzb21lCiAgcmVhc29u
        IHlvdSBjYW4ndCBkaXJlY3RseSB3YXRjaCBhIHByb3BlcnR5IHlvdSBjYW4g
        aW52b2tlIHRoaXMgbWV0aG9kCiAgbWFudWFsbHkgYWxvbmcgd2l0aCBgRW1i
        ZXIucHJvcGVydHlEaWRDaGFuZ2UoKWAgd2hpY2ggeW91IHNob3VsZCBjYWxs
        IGp1c3QKICBhZnRlciB0aGUgcHJvcGVydHkgdmFsdWUgY2hhbmdlcy4KCiAg
        QG1ldGhvZCBwcm9wZXJ0eVdpbGxDaGFuZ2UKICBAZm9yIEVtYmVyCiAgQHBh
        cmFtIHtPYmplY3R9IG9iaiBUaGUgb2JqZWN0IHdpdGggdGhlIHByb3BlcnR5
        IHRoYXQgd2lsbCBjaGFuZ2UKICBAcGFyYW0ge1N0cmluZ30ga2V5TmFtZSBU
        aGUgcHJvcGVydHkga2V5IChvciBwYXRoKSB0aGF0IHdpbGwgY2hhbmdlLgog
        IEByZXR1cm4ge3ZvaWR9CiovCmZ1bmN0aW9uIHByb3BlcnR5V2lsbENoYW5n
        ZShvYmosIGtleU5hbWUpIHsKICB2YXIgbSA9IG1ldGFGb3Iob2JqLCBmYWxz
        ZSksCiAgICAgIHdhdGNoaW5nID0gbS53YXRjaGluZ1trZXlOYW1lXSA+IDAg
        fHwga2V5TmFtZSA9PT0gJ2xlbmd0aCcsCiAgICAgIHByb3RvID0gbS5wcm90
        bywKICAgICAgZGVzYyA9IG0uZGVzY3Nba2V5TmFtZV07CgogIGlmICghd2F0
        Y2hpbmcpIHsgcmV0dXJuOyB9CiAgaWYgKHByb3RvID09PSBvYmopIHsgcmV0
        dXJuOyB9CiAgaWYgKGRlc2MgJiYgZGVzYy53aWxsQ2hhbmdlKSB7IGRlc2Mu
        d2lsbENoYW5nZShvYmosIGtleU5hbWUpOyB9CiAgZGVwZW5kZW50S2V5c1dp
        bGxDaGFuZ2Uob2JqLCBrZXlOYW1lLCBtKTsKICBjaGFpbnNXaWxsQ2hhbmdl
        KG9iaiwga2V5TmFtZSwgbSk7CiAgbm90aWZ5QmVmb3JlT2JzZXJ2ZXJzKG9i
        aiwga2V5TmFtZSk7Cn0KRW1iZXIucHJvcGVydHlXaWxsQ2hhbmdlID0gcHJv
        cGVydHlXaWxsQ2hhbmdlOwoKLyoqCiAgVGhpcyBmdW5jdGlvbiBpcyBjYWxs
        ZWQganVzdCBhZnRlciBhbiBvYmplY3QgcHJvcGVydHkgaGFzIGNoYW5nZWQu
        CiAgSXQgd2lsbCBub3RpZnkgYW55IG9ic2VydmVycyBhbmQgY2xlYXIgY2Fj
        aGVzIGFtb25nIG90aGVyIHRoaW5ncy4KCiAgTm9ybWFsbHkgeW91IHdpbGwg
        bm90IG5lZWQgdG8gY2FsbCB0aGlzIG1ldGhvZCBkaXJlY3RseSBidXQgaWYg
        Zm9yIHNvbWUKICByZWFzb24geW91IGNhbid0IGRpcmVjdGx5IHdhdGNoIGEg
        cHJvcGVydHkgeW91IGNhbiBpbnZva2UgdGhpcyBtZXRob2QKICBtYW51YWxs
        eSBhbG9uZyB3aXRoIGBFbWJlci5wcm9wZXJ0eVdpbGxDaGFuZ2UoKWAgd2hp
        Y2ggeW91IHNob3VsZCBjYWxsIGp1c3QKICBiZWZvcmUgdGhlIHByb3BlcnR5
        IHZhbHVlIGNoYW5nZXMuCgogIEBtZXRob2QgcHJvcGVydHlEaWRDaGFuZ2UK
        ICBAZm9yIEVtYmVyCiAgQHBhcmFtIHtPYmplY3R9IG9iaiBUaGUgb2JqZWN0
        IHdpdGggdGhlIHByb3BlcnR5IHRoYXQgd2lsbCBjaGFuZ2UKICBAcGFyYW0g
        e1N0cmluZ30ga2V5TmFtZSBUaGUgcHJvcGVydHkga2V5IChvciBwYXRoKSB0
        aGF0IHdpbGwgY2hhbmdlLgogIEByZXR1cm4ge3ZvaWR9CiovCmZ1bmN0aW9u
        IHByb3BlcnR5RGlkQ2hhbmdlKG9iaiwga2V5TmFtZSkgewogIHZhciBtID0g
        bWV0YUZvcihvYmosIGZhbHNlKSwKICAgICAgd2F0Y2hpbmcgPSBtLndhdGNo
        aW5nW2tleU5hbWVdID4gMCB8fCBrZXlOYW1lID09PSAnbGVuZ3RoJywKICAg
        ICAgcHJvdG8gPSBtLnByb3RvLAogICAgICBkZXNjID0gbS5kZXNjc1trZXlO
        YW1lXTsKCiAgaWYgKHByb3RvID09PSBvYmopIHsgcmV0dXJuOyB9CgogIC8v
        IHNob3VsZG4ndCB0aGlzIG1lYW4gdGhhdCB3ZSdyZSB3YXRjaGluZyB0aGlz
        IGtleT8KICBpZiAoZGVzYyAmJiBkZXNjLmRpZENoYW5nZSkgeyBkZXNjLmRp
        ZENoYW5nZShvYmosIGtleU5hbWUpOyB9CiAgaWYgKCF3YXRjaGluZyAmJiBr
        ZXlOYW1lICE9PSAnbGVuZ3RoJykgeyByZXR1cm47IH0KCiAgZGVwZW5kZW50
        S2V5c0RpZENoYW5nZShvYmosIGtleU5hbWUsIG0pOwogIGNoYWluc0RpZENo
        YW5nZShvYmosIGtleU5hbWUsIG0sIGZhbHNlKTsKICBub3RpZnlPYnNlcnZl
        cnMob2JqLCBrZXlOYW1lKTsKfQpFbWJlci5wcm9wZXJ0eURpZENoYW5nZSA9
        IHByb3BlcnR5RGlkQ2hhbmdlOwoKdmFyIFdJTExfU0VFTiwgRElEX1NFRU47
        CgovLyBjYWxsZWQgd2hlbmV2ZXIgYSBwcm9wZXJ0eSBpcyBhYm91dCB0byBj
        aGFuZ2UgdG8gY2xlYXIgdGhlIGNhY2hlIG9mIGFueSBkZXBlbmRlbnQga2V5
        cyAoYW5kIG5vdGlmeSB0aG9zZSBwcm9wZXJ0aWVzIG9mIGNoYW5nZXMsIGV0
        Yy4uLikKZnVuY3Rpb24gZGVwZW5kZW50S2V5c1dpbGxDaGFuZ2Uob2JqLCBk
        ZXBLZXksIG1ldGEpIHsKICBpZiAob2JqLmlzRGVzdHJveWluZykgeyByZXR1
        cm47IH0KCiAgdmFyIHNlZW4gPSBXSUxMX1NFRU4sIHRvcCA9ICFzZWVuOwog
        IGlmICh0b3ApIHsgc2VlbiA9IFdJTExfU0VFTiA9IHt9OyB9CiAgaXRlckRl
        cHMocHJvcGVydHlXaWxsQ2hhbmdlLCBvYmosIGRlcEtleSwgc2VlbiwgbWV0
        YSk7CiAgaWYgKHRvcCkgeyBXSUxMX1NFRU4gPSBudWxsOyB9Cn0KCi8vIGNh
        bGxlZCB3aGVuZXZlciBhIHByb3BlcnR5IGhhcyBqdXN0IGNoYW5nZWQgdG8g
        dXBkYXRlIGRlcGVuZGVudCBrZXlzCmZ1bmN0aW9uIGRlcGVuZGVudEtleXNE
        aWRDaGFuZ2Uob2JqLCBkZXBLZXksIG1ldGEpIHsKICBpZiAob2JqLmlzRGVz
        dHJveWluZykgeyByZXR1cm47IH0KCiAgdmFyIHNlZW4gPSBESURfU0VFTiwg
        dG9wID0gIXNlZW47CiAgaWYgKHRvcCkgeyBzZWVuID0gRElEX1NFRU4gPSB7
        fTsgfQogIGl0ZXJEZXBzKHByb3BlcnR5RGlkQ2hhbmdlLCBvYmosIGRlcEtl
        eSwgc2VlbiwgbWV0YSk7CiAgaWYgKHRvcCkgeyBESURfU0VFTiA9IG51bGw7
        IH0KfQoKZnVuY3Rpb24gaXRlckRlcHMobWV0aG9kLCBvYmosIGRlcEtleSwg
        c2VlbiwgbWV0YSkgewogIHZhciBndWlkID0gZ3VpZEZvcihvYmopOwogIGlm
        ICghc2VlbltndWlkXSkgc2VlbltndWlkXSA9IHt9OwogIGlmIChzZWVuW2d1
        aWRdW2RlcEtleV0pIHJldHVybjsKICBzZWVuW2d1aWRdW2RlcEtleV0gPSB0
        cnVlOwoKICB2YXIgZGVwcyA9IG1ldGEuZGVwczsKICBkZXBzID0gZGVwcyAm
        JiBkZXBzW2RlcEtleV07CiAgaWYgKGRlcHMpIHsKICAgIGZvcih2YXIga2V5
        IGluIGRlcHMpIHsKICAgICAgdmFyIGRlc2MgPSBtZXRhLmRlc2NzW2tleV07
        CiAgICAgIGlmIChkZXNjICYmIGRlc2MuX3N1c3BlbmRlZCA9PT0gb2JqKSBj
        b250aW51ZTsKICAgICAgbWV0aG9kKG9iaiwga2V5KTsKICAgIH0KICB9Cn0K
        CmZ1bmN0aW9uIGNoYWluc1dpbGxDaGFuZ2Uob2JqLCBrZXlOYW1lLCBtKSB7
        CiAgaWYgKCEobS5oYXNPd25Qcm9wZXJ0eSgnY2hhaW5XYXRjaGVycycpICYm
        CiAgICAgICAgbS5jaGFpbldhdGNoZXJzW2tleU5hbWVdKSkgewogICAgcmV0
        dXJuOwogIH0KCiAgdmFyIG5vZGVzID0gbS5jaGFpbldhdGNoZXJzW2tleU5h
        bWVdLAogICAgICBldmVudHMgPSBbXSwKICAgICAgaSwgbDsKCiAgZm9yKGkg
        PSAwLCBsID0gbm9kZXMubGVuZ3RoOyBpIDwgbDsgaSsrKSB7CiAgICBub2Rl
        c1tpXS53aWxsQ2hhbmdlKGV2ZW50cyk7CiAgfQoKICBmb3IgKGkgPSAwLCBs
        ID0gZXZlbnRzLmxlbmd0aDsgaSA8IGw7IGkgKz0gMikgewogICAgcHJvcGVy
        dHlXaWxsQ2hhbmdlKGV2ZW50c1tpXSwgZXZlbnRzW2krMV0pOwogIH0KfQoK
        ZnVuY3Rpb24gY2hhaW5zRGlkQ2hhbmdlKG9iaiwga2V5TmFtZSwgbSwgc3Vw
        cHJlc3NFdmVudHMpIHsKICBpZiAoIShtLmhhc093blByb3BlcnR5KCdjaGFp
        bldhdGNoZXJzJykgJiYKICAgICAgICBtLmNoYWluV2F0Y2hlcnNba2V5TmFt
        ZV0pKSB7CiAgICByZXR1cm47CiAgfQoKICB2YXIgbm9kZXMgPSBtLmNoYWlu
        V2F0Y2hlcnNba2V5TmFtZV0sCiAgICAgIGV2ZW50cyA9IHN1cHByZXNzRXZl
        bnRzID8gbnVsbCA6IFtdLAogICAgICBpLCBsOwoKICBmb3IoaSA9IDAsIGwg
        PSBub2Rlcy5sZW5ndGg7IGkgPCBsOyBpKyspIHsKICAgIG5vZGVzW2ldLmRp
        ZENoYW5nZShldmVudHMpOwogIH0KCiAgaWYgKHN1cHByZXNzRXZlbnRzKSB7
        CiAgICByZXR1cm47CiAgfQoKICBmb3IgKGkgPSAwLCBsID0gZXZlbnRzLmxl
        bmd0aDsgaSA8IGw7IGkgKz0gMikgewogICAgcHJvcGVydHlEaWRDaGFuZ2Uo
        ZXZlbnRzW2ldLCBldmVudHNbaSsxXSk7CiAgfQp9CgpFbWJlci5vdmVycmlk
        ZUNoYWlucyA9IGZ1bmN0aW9uKG9iaiwga2V5TmFtZSwgbSkgewogIGNoYWlu
        c0RpZENoYW5nZShvYmosIGtleU5hbWUsIG0sIHRydWUpOwp9OwoKLyoqCiAg
        QG1ldGhvZCBiZWdpblByb3BlcnR5Q2hhbmdlcwogIEBjaGFpbmFibGUKKi8K
        ZnVuY3Rpb24gYmVnaW5Qcm9wZXJ0eUNoYW5nZXMoKSB7CiAgZGVmZXJyZWQr
        KzsKfQoKRW1iZXIuYmVnaW5Qcm9wZXJ0eUNoYW5nZXMgPSBiZWdpblByb3Bl
        cnR5Q2hhbmdlczsKCi8qKgogIEBtZXRob2QgZW5kUHJvcGVydHlDaGFuZ2Vz
        CiovCmZ1bmN0aW9uIGVuZFByb3BlcnR5Q2hhbmdlcygpIHsKICBkZWZlcnJl
        ZC0tOwogIGlmIChkZWZlcnJlZDw9MCkgewogICAgYmVmb3JlT2JzZXJ2ZXJT
        ZXQuY2xlYXIoKTsKICAgIG9ic2VydmVyU2V0LmZsdXNoKCk7CiAgfQp9CgpF
        bWJlci5lbmRQcm9wZXJ0eUNoYW5nZXMgPSBlbmRQcm9wZXJ0eUNoYW5nZXM7
        CgovKioKICBNYWtlIGEgc2VyaWVzIG9mIHByb3BlcnR5IGNoYW5nZXMgdG9n
        ZXRoZXIgaW4gYW4KICBleGNlcHRpb24tc2FmZSB3YXkuCgogIGBgYGphdmFz
        Y3JpcHQKICBFbWJlci5jaGFuZ2VQcm9wZXJ0aWVzKGZ1bmN0aW9uKCkgewog
        ICAgb2JqMS5zZXQoJ2ZvbycsIG1heUJsb3dVcFdoZW5TZXQpOwogICAgb2Jq
        Mi5zZXQoJ2JhcicsIGJheik7CiAgfSk7CiAgYGBgCgogIEBtZXRob2QgY2hh
        bmdlUHJvcGVydGllcwogIEBwYXJhbSB7RnVuY3Rpb259IGNhbGxiYWNrCiAg
        QHBhcmFtIFtiaW5kaW5nXQoqLwpFbWJlci5jaGFuZ2VQcm9wZXJ0aWVzID0g
        ZnVuY3Rpb24oY2IsIGJpbmRpbmcpIHsKICBiZWdpblByb3BlcnR5Q2hhbmdl
        cygpOwogIHRyeUZpbmFsbHkoY2IsIGVuZFByb3BlcnR5Q2hhbmdlcywgYmlu
        ZGluZyk7Cn07CgpmdW5jdGlvbiBub3RpZnlCZWZvcmVPYnNlcnZlcnMob2Jq
        LCBrZXlOYW1lKSB7CiAgaWYgKG9iai5pc0Rlc3Ryb3lpbmcpIHsgcmV0dXJu
        OyB9CgogIHZhciBldmVudE5hbWUgPSBrZXlOYW1lICsgJzpiZWZvcmUnLCBs
        aXN0ZW5lcnMsIGRpZmY7CiAgaWYgKGRlZmVycmVkKSB7CiAgICBsaXN0ZW5l
        cnMgPSBiZWZvcmVPYnNlcnZlclNldC5hZGQob2JqLCBrZXlOYW1lLCBldmVu
        dE5hbWUpOwogICAgZGlmZiA9IGxpc3RlbmVyc0RpZmYob2JqLCBldmVudE5h
        bWUsIGxpc3RlbmVycyk7CiAgICBzZW5kRXZlbnQob2JqLCBldmVudE5hbWUs
        IFtvYmosIGtleU5hbWVdLCBkaWZmKTsKICB9IGVsc2UgewogICAgc2VuZEV2
        ZW50KG9iaiwgZXZlbnROYW1lLCBbb2JqLCBrZXlOYW1lXSk7CiAgfQp9Cgpm
        dW5jdGlvbiBub3RpZnlPYnNlcnZlcnMob2JqLCBrZXlOYW1lKSB7CiAgaWYg
        KG9iai5pc0Rlc3Ryb3lpbmcpIHsgcmV0dXJuOyB9CgogIHZhciBldmVudE5h
        bWUgPSBrZXlOYW1lICsgJzpjaGFuZ2UnLCBsaXN0ZW5lcnM7CiAgaWYgKGRl
        ZmVycmVkKSB7CiAgICBsaXN0ZW5lcnMgPSBvYnNlcnZlclNldC5hZGQob2Jq
        LCBrZXlOYW1lLCBldmVudE5hbWUpOwogICAgbGlzdGVuZXJzVW5pb24ob2Jq
        LCBldmVudE5hbWUsIGxpc3RlbmVycyk7CiAgfSBlbHNlIHsKICAgIHNlbmRF
        dmVudChvYmosIGV2ZW50TmFtZSwgW29iaiwga2V5TmFtZV0pOwogIH0KfQoK
        fSkoKTsKCgoKKGZ1bmN0aW9uKCkgewovLyBNRVRBX0tFWQovLyBfZ2V0UGF0
        aAovLyBwcm9wZXJ0eVdpbGxDaGFuZ2UsIHByb3BlcnR5RGlkQ2hhbmdlCgp2
        YXIgTUVUQV9LRVkgPSBFbWJlci5NRVRBX0tFWSwKICAgIE1BTkRBVE9SWV9T
        RVRURVIgPSBFbWJlci5FTlYuTUFOREFUT1JZX1NFVFRFUiwKICAgIElTX0dM
        T0JBTCA9IC9eKFtBLVokXXwoWzAtOV1bQS1aJF0pKS8sCiAgICBnZXRQYXRo
        ID0gRW1iZXIuX2dldFBhdGg7CgovKioKICBTZXRzIHRoZSB2YWx1ZSBvZiBh
        IHByb3BlcnR5IG9uIGFuIG9iamVjdCwgcmVzcGVjdGluZyBjb21wdXRlZCBw
        cm9wZXJ0aWVzCiAgYW5kIG5vdGlmeWluZyBvYnNlcnZlcnMgYW5kIG90aGVy
        IGxpc3RlbmVycyBvZiB0aGUgY2hhbmdlLiBJZiB0aGUKICBwcm9wZXJ0eSBp
        cyBub3QgZGVmaW5lZCBidXQgdGhlIG9iamVjdCBpbXBsZW1lbnRzIHRoZSBg
        c2V0VW5rbm93blByb3BlcnR5YAogIG1ldGhvZCB0aGVuIHRoYXQgd2lsbCBi
        ZSBpbnZva2VkIGFzIHdlbGwuCgogIElmIHlvdSBwbGFuIHRvIHJ1biBvbiBJ
        RTggYW5kIG9sZGVyIGJyb3dzZXJzIHRoZW4geW91IHNob3VsZCB1c2UgdGhp
        cwogIG1ldGhvZCBhbnl0aW1lIHlvdSB3YW50IHRvIHNldCBhIHByb3BlcnR5
        IG9uIGFuIG9iamVjdCB0aGF0IHlvdSBkb24ndAogIGtub3cgZm9yIHN1cmUg
        aXMgcHJpdmF0ZS4gKFByb3BlcnRpZXMgYmVnaW5uaW5nIHdpdGggYW4gdW5k
        ZXJzY29yZSAnXycKICBhcmUgY29uc2lkZXJlZCBwcml2YXRlLikKCiAgT24g
        YWxsIG5ld2VyIGJyb3dzZXJzLCB5b3Ugb25seSBuZWVkIHRvIHVzZSB0aGlz
        IG1ldGhvZCB0byBzZXQKICBwcm9wZXJ0aWVzIGlmIHRoZSBwcm9wZXJ0eSBt
        aWdodCBub3QgYmUgZGVmaW5lZCBvbiB0aGUgb2JqZWN0IGFuZCB5b3Ugd2Fu
        dAogIHRvIHJlc3BlY3QgdGhlIGBzZXRVbmtub3duUHJvcGVydHlgIGhhbmRs
        ZXIuIE90aGVyd2lzZSB5b3UgY2FuIGlnbm9yZSB0aGlzCiAgbWV0aG9kLgoK
        ICBAbWV0aG9kIHNldAogIEBmb3IgRW1iZXIKICBAcGFyYW0ge09iamVjdH0g
        b2JqIFRoZSBvYmplY3QgdG8gbW9kaWZ5LgogIEBwYXJhbSB7U3RyaW5nfSBr
        ZXlOYW1lIFRoZSBwcm9wZXJ0eSBrZXkgdG8gc2V0CiAgQHBhcmFtIHtPYmpl
        Y3R9IHZhbHVlIFRoZSB2YWx1ZSB0byBzZXQKICBAcmV0dXJuIHtPYmplY3R9
        IHRoZSBwYXNzZWQgdmFsdWUuCiovCnZhciBzZXQgPSBmdW5jdGlvbiBzZXQo
        b2JqLCBrZXlOYW1lLCB2YWx1ZSwgdG9sZXJhbnQpIHsKICBpZiAodHlwZW9m
        IG9iaiA9PT0gJ3N0cmluZycpIHsKICAgIEVtYmVyLmFzc2VydCgiUGF0aCAn
        IiArIG9iaiArICInIG11c3QgYmUgZ2xvYmFsIGlmIG5vIG9iaiBpcyBnaXZl
        bi4iLCBJU19HTE9CQUwudGVzdChvYmopKTsKICAgIHZhbHVlID0ga2V5TmFt
        ZTsKICAgIGtleU5hbWUgPSBvYmo7CiAgICBvYmogPSBudWxsOwogIH0KCiAg
        RW1iZXIuYXNzZXJ0KCJDYW5ub3QgY2FsbCBzZXQgd2l0aCAiKyBrZXlOYW1l
        ICsiIGtleS4iLCAhIWtleU5hbWUpOwoKICBpZiAoIW9iaiB8fCBrZXlOYW1l
        LmluZGV4T2YoJy4nKSAhPT0gLTEpIHsKICAgIHJldHVybiBzZXRQYXRoKG9i
        aiwga2V5TmFtZSwgdmFsdWUsIHRvbGVyYW50KTsKICB9CgogIEVtYmVyLmFz
        c2VydCgiWW91IG5lZWQgdG8gcHJvdmlkZSBhbiBvYmplY3QgYW5kIGtleSB0
        byBgc2V0YC4iLCAhIW9iaiAmJiBrZXlOYW1lICE9PSB1bmRlZmluZWQpOwog
        IEVtYmVyLmFzc2VydCgnY2FsbGluZyBzZXQgb24gZGVzdHJveWVkIG9iamVj
        dCcsICFvYmouaXNEZXN0cm95ZWQpOwoKICB2YXIgbWV0YSA9IG9ialtNRVRB
        X0tFWV0sIGRlc2MgPSBtZXRhICYmIG1ldGEuZGVzY3Nba2V5TmFtZV0sCiAg
        ICAgIGlzVW5rbm93biwgY3VycmVudFZhbHVlOwogIGlmIChkZXNjKSB7CiAg
        ICBkZXNjLnNldChvYmosIGtleU5hbWUsIHZhbHVlKTsKICB9IGVsc2Ugewog
        ICAgaXNVbmtub3duID0gJ29iamVjdCcgPT09IHR5cGVvZiBvYmogJiYgIShr
        ZXlOYW1lIGluIG9iaik7CgogICAgLy8gc2V0VW5rbm93blByb3BlcnR5IGlz
        IGNhbGxlZCBpZiBgb2JqYCBpcyBhbiBvYmplY3QsCiAgICAvLyB0aGUgcHJv
        cGVydHkgZG9lcyBub3QgYWxyZWFkeSBleGlzdCwgYW5kIHRoZQogICAgLy8g
        YHNldFVua25vd25Qcm9wZXJ0eWAgbWV0aG9kIGV4aXN0cyBvbiB0aGUgb2Jq
        ZWN0CiAgICBpZiAoaXNVbmtub3duICYmICdmdW5jdGlvbicgPT09IHR5cGVv
        ZiBvYmouc2V0VW5rbm93blByb3BlcnR5KSB7CiAgICAgIG9iai5zZXRVbmtu
        b3duUHJvcGVydHkoa2V5TmFtZSwgdmFsdWUpOwogICAgfSBlbHNlIGlmICht
        ZXRhICYmIG1ldGEud2F0Y2hpbmdba2V5TmFtZV0gPiAwKSB7CiAgICAgIGlm
        IChNQU5EQVRPUllfU0VUVEVSKSB7CiAgICAgICAgY3VycmVudFZhbHVlID0g
        bWV0YS52YWx1ZXNba2V5TmFtZV07CiAgICAgIH0gZWxzZSB7CiAgICAgICAg
        Y3VycmVudFZhbHVlID0gb2JqW2tleU5hbWVdOwogICAgICB9CiAgICAgIC8v
        IG9ubHkgdHJpZ2dlciBhIGNoYW5nZSBpZiB0aGUgdmFsdWUgaGFzIGNoYW5n
        ZWQKICAgICAgaWYgKHZhbHVlICE9PSBjdXJyZW50VmFsdWUpIHsKICAgICAg
        ICBFbWJlci5wcm9wZXJ0eVdpbGxDaGFuZ2Uob2JqLCBrZXlOYW1lKTsKICAg
        ICAgICBpZiAoTUFOREFUT1JZX1NFVFRFUikgewogICAgICAgICAgaWYgKGN1
        cnJlbnRWYWx1ZSA9PT0gdW5kZWZpbmVkICYmICEoa2V5TmFtZSBpbiBvYmop
        KSB7CiAgICAgICAgICAgIEVtYmVyLmRlZmluZVByb3BlcnR5KG9iaiwga2V5
        TmFtZSwgbnVsbCwgdmFsdWUpOyAvLyBzZXR1cCBtYW5kYXRvcnkgc2V0dGVy
        CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBtZXRhLnZhbHVlc1tr
        ZXlOYW1lXSA9IHZhbHVlOwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7
        CiAgICAgICAgICBvYmpba2V5TmFtZV0gPSB2YWx1ZTsKICAgICAgICB9CiAg
        ICAgICAgRW1iZXIucHJvcGVydHlEaWRDaGFuZ2Uob2JqLCBrZXlOYW1lKTsK
        ICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgb2JqW2tleU5hbWVdID0gdmFs
        dWU7CiAgICB9CiAgfQogIHJldHVybiB2YWx1ZTsKfTsKCi8vIEN1cnJlbnRs
        eSB1c2VkIG9ubHkgYnkgRW1iZXIgRGF0YSB0ZXN0cwppZiAoRW1iZXIuY29u
        ZmlnLm92ZXJyaWRlQWNjZXNzb3JzKSB7CiAgRW1iZXIuc2V0ID0gc2V0Owog
        IEVtYmVyLmNvbmZpZy5vdmVycmlkZUFjY2Vzc29ycygpOwogIHNldCA9IEVt
        YmVyLnNldDsKfQoKZnVuY3Rpb24gc2V0UGF0aChyb290LCBwYXRoLCB2YWx1
        ZSwgdG9sZXJhbnQpIHsKICB2YXIga2V5TmFtZTsKCiAgLy8gZ2V0IHRoZSBs
        YXN0IHBhcnQgb2YgdGhlIHBhdGgKICBrZXlOYW1lID0gcGF0aC5zbGljZShw
        YXRoLmxhc3RJbmRleE9mKCcuJykgKyAxKTsKCiAgLy8gZ2V0IHRoZSBmaXJz
        dCBwYXJ0IG9mIHRoZSBwYXJ0CiAgcGF0aCAgICA9IHBhdGguc2xpY2UoMCwg
        cGF0aC5sZW5ndGgtKGtleU5hbWUubGVuZ3RoKzEpKTsKCiAgLy8gdW5sZXNz
        IHRoZSBwYXRoIGlzIHRoaXMsIGxvb2sgdXAgdGhlIGZpcnN0IHBhcnQgdG8K
        ICAvLyBnZXQgdGhlIHJvb3QKICBpZiAocGF0aCAhPT0gJ3RoaXMnKSB7CiAg
        ICByb290ID0gZ2V0UGF0aChyb290LCBwYXRoKTsKICB9CgogIGlmICgha2V5
        TmFtZSB8fCBrZXlOYW1lLmxlbmd0aCA9PT0gMCkgewogICAgdGhyb3cgbmV3
        IEVycm9yKCdZb3UgcGFzc2VkIGFuIGVtcHR5IHBhdGgnKTsKICB9CgogIGlm
        ICghcm9vdCkgewogICAgaWYgKHRvbGVyYW50KSB7IHJldHVybjsgfQogICAg
        ZWxzZSB7IHRocm93IG5ldyBFcnJvcignT2JqZWN0IGluIHBhdGggJytwYXRo
        KycgY291bGQgbm90IGJlIGZvdW5kIG9yIHdhcyBkZXN0cm95ZWQuJyk7IH0K
        ICB9CgogIHJldHVybiBzZXQocm9vdCwga2V5TmFtZSwgdmFsdWUpOwp9CgpF
        bWJlci5zZXQgPSBzZXQ7CkVtYmVyLnNldFBhdGggPSBFbWJlci5kZXByZWNh
        dGVGdW5jKCdzZXRQYXRoIGlzIGRlcHJlY2F0ZWQgc2luY2Ugc2V0IG5vdyBz
        dXBwb3J0cyBwYXRocycsIEVtYmVyLnNldCk7CgovKioKICBFcnJvci10b2xl
        cmFudCBmb3JtIG9mIGBFbWJlci5zZXRgLiBXaWxsIG5vdCBibG93IHVwIGlm
        IGFueSBwYXJ0IG9mIHRoZQogIGNoYWluIGlzIGB1bmRlZmluZWRgLCBgbnVs
        bGAsIG9yIGRlc3Ryb3llZC4KCiAgVGhpcyBpcyBwcmltYXJpbHkgdXNlZCB3
        aGVuIHN5bmNpbmcgYmluZGluZ3MsIHdoaWNoIG1heSB0cnkgdG8gdXBkYXRl
        IGFmdGVyCiAgYW4gb2JqZWN0IGhhcyBiZWVuIGRlc3Ryb3llZC4KCiAgQG1l
        dGhvZCB0cnlTZXQKICBAZm9yIEVtYmVyCiAgQHBhcmFtIHtPYmplY3R9IG9i
        aiBUaGUgb2JqZWN0IHRvIG1vZGlmeS4KICBAcGFyYW0ge1N0cmluZ30gcGF0
        aCBUaGUgcHJvcGVydHkgcGF0aCB0byBzZXQKICBAcGFyYW0ge09iamVjdH0g
        dmFsdWUgVGhlIHZhbHVlIHRvIHNldAoqLwpFbWJlci50cnlTZXQgPSBmdW5j
        dGlvbihyb290LCBwYXRoLCB2YWx1ZSkgewogIHJldHVybiBzZXQocm9vdCwg
        cGF0aCwgdmFsdWUsIHRydWUpOwp9OwpFbWJlci50cnlTZXRQYXRoID0gRW1i
        ZXIuZGVwcmVjYXRlRnVuYygndHJ5U2V0UGF0aCBoYXMgYmVlbiByZW5hbWVk
        IHRvIHRyeVNldCcsIEVtYmVyLnRyeVNldCk7Cgp9KSgpOwoKCgooZnVuY3Rp
        b24oKSB7Ci8qKgpAbW9kdWxlIGVtYmVyLW1ldGFsCiovCgovKgogIEphdmFT
        Y3JpcHQgKGJlZm9yZSBFUzYpIGRvZXMgbm90IGhhdmUgYSBNYXAgaW1wbGVt
        ZW50YXRpb24uIE9iamVjdHMsCiAgd2hpY2ggYXJlIG9mdGVuIHVzZWQgYXMg
        ZGljdGlvbmFyaWVzLCBtYXkgb25seSBoYXZlIFN0cmluZ3MgYXMga2V5cy4K
        CiAgQmVjYXVzZSBFbWJlciBoYXMgYSB3YXkgdG8gZ2V0IGEgdW5pcXVlIGlk
        ZW50aWZpZXIgZm9yIGV2ZXJ5IG9iamVjdAogIHZpYSBgRW1iZXIuZ3VpZEZv
        cmAsIHdlIGNhbiBpbXBsZW1lbnQgYSBwZXJmb3JtYW50IE1hcCB3aXRoIGFy
        Yml0cmFyeQogIGtleXMuIEJlY2F1c2UgaXQgaXMgY29tbW9ubHkgdXNlZCBp
        biBsb3ctbGV2ZWwgYm9va2tlZXBpbmcsIE1hcCBpcwogIGltcGxlbWVudGVk
        IGFzIGEgcHVyZSBKYXZhU2NyaXB0IG9iamVjdCBmb3IgcGVyZm9ybWFuY2Uu
        CgogIFRoaXMgaW1wbGVtZW50YXRpb24gZm9sbG93cyB0aGUgY3VycmVudCBp
        dGVyYXRpb24gb2YgdGhlIEVTNiBwcm9wb3NhbCBmb3IKICBtYXBzIChodHRw
        Oi8vd2lraS5lY21hc2NyaXB0Lm9yZy9kb2t1LnBocD9pZD1oYXJtb255OnNp
        bXBsZV9tYXBzX2FuZF9zZXRzKSwKICB3aXRoIHR3byBleGNlcHRpb25zLiBG
        aXJzdCwgYmVjYXVzZSB3ZSBuZWVkIG91ciBpbXBsZW1lbnRhdGlvbiB0byBi
        ZSBwbGVhc2FudAogIG9uIG9sZGVyIGJyb3dzZXJzLCB3ZSBkbyBub3QgdXNl
        IHRoZSBgZGVsZXRlYCBuYW1lICh1c2luZyBgcmVtb3ZlYCBpbnN0ZWFkKS4K
        ICBTZWNvbmQsIGFzIHdlIGRvIG5vdCBoYXZlIHRoZSBsdXh1cnkgb2YgaW4t
        Vk0gaXRlcmF0aW9uLCB3ZSBpbXBsZW1lbnQgYQogIGZvckVhY2ggbWV0aG9k
        IGZvciBpdGVyYXRpb24uCgogIE1hcCBpcyBtb2NrZWQgb3V0IHRvIGxvb2sg
        bGlrZSBhbiBFbWJlciBvYmplY3QsIHNvIHlvdSBjYW4gZG8KICBgRW1iZXIu
        TWFwLmNyZWF0ZSgpYCBmb3Igc3ltbWV0cnkgd2l0aCBvdGhlciBFbWJlciBj
        bGFzc2VzLgoqLwp2YXIgc2V0ID0gRW1iZXIuc2V0LAogICAgZ3VpZEZvciA9
        IEVtYmVyLmd1aWRGb3IsCiAgICBpbmRleE9mID0gRW1iZXIuQXJyYXlQb2x5
        ZmlsbHMuaW5kZXhPZjsKCnZhciBjb3B5ID0gZnVuY3Rpb24ob2JqKSB7CiAg
        dmFyIG91dHB1dCA9IHt9OwoKICBmb3IgKHZhciBwcm9wIGluIG9iaikgewog
        ICAgaWYgKG9iai5oYXNPd25Qcm9wZXJ0eShwcm9wKSkgeyBvdXRwdXRbcHJv
        cF0gPSBvYmpbcHJvcF07IH0KICB9CgogIHJldHVybiBvdXRwdXQ7Cn07Cgp2
        YXIgY29weU1hcCA9IGZ1bmN0aW9uKG9yaWdpbmFsLCBuZXdPYmplY3QpIHsK
        ICB2YXIga2V5cyA9IG9yaWdpbmFsLmtleXMuY29weSgpLAogICAgICB2YWx1
        ZXMgPSBjb3B5KG9yaWdpbmFsLnZhbHVlcyk7CgogIG5ld09iamVjdC5rZXlz
        ID0ga2V5czsKICBuZXdPYmplY3QudmFsdWVzID0gdmFsdWVzOwogIG5ld09i
        amVjdC5sZW5ndGggPSBvcmlnaW5hbC5sZW5ndGg7CgogIHJldHVybiBuZXdP
        YmplY3Q7Cn07CgovKioKICBUaGlzIGNsYXNzIGlzIHVzZWQgaW50ZXJuYWxs
        eSBieSBFbWJlciBhbmQgRW1iZXIgRGF0YS4KICBQbGVhc2UgZG8gbm90IHVz
        ZSBpdCBhdCB0aGlzIHRpbWUuIFdlIHBsYW4gdG8gY2xlYW4gaXQgdXAKICBh
        bmQgYWRkIG1hbnkgdGVzdHMgc29vbi4KCiAgQGNsYXNzIE9yZGVyZWRTZXQK
        ICBAbmFtZXNwYWNlIEVtYmVyCiAgQGNvbnN0cnVjdG9yCiAgQHByaXZhdGUK
        Ki8KdmFyIE9yZGVyZWRTZXQgPSBFbWJlci5PcmRlcmVkU2V0ID0gZnVuY3Rp
        b24oKSB7CiAgdGhpcy5jbGVhcigpOwp9OwoKLyoqCiAgQG1ldGhvZCBjcmVh
        dGUKICBAc3RhdGljCiAgQHJldHVybiB7RW1iZXIuT3JkZXJlZFNldH0KKi8K
        T3JkZXJlZFNldC5jcmVhdGUgPSBmdW5jdGlvbigpIHsKICByZXR1cm4gbmV3
        IE9yZGVyZWRTZXQoKTsKfTsKCgpPcmRlcmVkU2V0LnByb3RvdHlwZSA9IHsK
        ICAvKioKICAgIEBtZXRob2QgY2xlYXIKICAqLwogIGNsZWFyOiBmdW5jdGlv
        bigpIHsKICAgIHRoaXMucHJlc2VuY2VTZXQgPSB7fTsKICAgIHRoaXMubGlz
        dCA9IFtdOwogIH0sCgogIC8qKgogICAgQG1ldGhvZCBhZGQKICAgIEBwYXJh
        bSBvYmoKICAqLwogIGFkZDogZnVuY3Rpb24ob2JqKSB7CiAgICB2YXIgZ3Vp
        ZCA9IGd1aWRGb3Iob2JqKSwKICAgICAgICBwcmVzZW5jZVNldCA9IHRoaXMu
        cHJlc2VuY2VTZXQsCiAgICAgICAgbGlzdCA9IHRoaXMubGlzdDsKCiAgICBp
        ZiAoZ3VpZCBpbiBwcmVzZW5jZVNldCkgeyByZXR1cm47IH0KCiAgICBwcmVz
        ZW5jZVNldFtndWlkXSA9IHRydWU7CiAgICBsaXN0LnB1c2gob2JqKTsKICB9
        LAoKICAvKioKICAgIEBtZXRob2QgcmVtb3ZlCiAgICBAcGFyYW0gb2JqCiAg
        Ki8KICByZW1vdmU6IGZ1bmN0aW9uKG9iaikgewogICAgdmFyIGd1aWQgPSBn
        dWlkRm9yKG9iaiksCiAgICAgICAgcHJlc2VuY2VTZXQgPSB0aGlzLnByZXNl
        bmNlU2V0LAogICAgICAgIGxpc3QgPSB0aGlzLmxpc3Q7CgogICAgZGVsZXRl
        IHByZXNlbmNlU2V0W2d1aWRdOwoKICAgIHZhciBpbmRleCA9IGluZGV4T2Yu
        Y2FsbChsaXN0LCBvYmopOwogICAgaWYgKGluZGV4ID4gLTEpIHsKICAgICAg
        bGlzdC5zcGxpY2UoaW5kZXgsIDEpOwogICAgfQogIH0sCgogIC8qKgogICAg
        QG1ldGhvZCBpc0VtcHR5CiAgICBAcmV0dXJuIHtCb29sZWFufQogICovCiAg
        aXNFbXB0eTogZnVuY3Rpb24oKSB7CiAgICByZXR1cm4gdGhpcy5saXN0Lmxl
        bmd0aCA9PT0gMDsKICB9LAoKICAvKioKICAgIEBtZXRob2QgaGFzCiAgICBA
        cGFyYW0gb2JqCiAgICBAcmV0dXJuIHtCb29sZWFufQogICovCiAgaGFzOiBm
        dW5jdGlvbihvYmopIHsKICAgIHZhciBndWlkID0gZ3VpZEZvcihvYmopLAog
        ICAgICAgIHByZXNlbmNlU2V0ID0gdGhpcy5wcmVzZW5jZVNldDsKCiAgICBy
        ZXR1cm4gZ3VpZCBpbiBwcmVzZW5jZVNldDsKICB9LAoKICAvKioKICAgIEBt
        ZXRob2QgZm9yRWFjaAogICAgQHBhcmFtIHtGdW5jdGlvbn0gZm4KICAgIEBw
        YXJhbSBzZWxmCiAgKi8KICBmb3JFYWNoOiBmdW5jdGlvbihmbiwgc2VsZikg
        ewogICAgLy8gYWxsb3cgbXV0YXRpb24gZHVyaW5nIGl0ZXJhdGlvbgogICAg
        dmFyIGxpc3QgPSB0aGlzLnRvQXJyYXkoKTsKCiAgICBmb3IgKHZhciBpID0g
        MCwgaiA9IGxpc3QubGVuZ3RoOyBpIDwgajsgaSsrKSB7CiAgICAgIGZuLmNh
        bGwoc2VsZiwgbGlzdFtpXSk7CiAgICB9CiAgfSwKCiAgLyoqCiAgICBAbWV0
        aG9kIHRvQXJyYXkKICAgIEByZXR1cm4ge0FycmF5fQogICovCiAgdG9BcnJh
        eTogZnVuY3Rpb24oKSB7CiAgICByZXR1cm4gdGhpcy5saXN0LnNsaWNlKCk7
        CiAgfSwKCiAgLyoqCiAgICBAbWV0aG9kIGNvcHkKICAgIEByZXR1cm4ge0Vt
        YmVyLk9yZGVyZWRTZXR9CiAgKi8KICBjb3B5OiBmdW5jdGlvbigpIHsKICAg
        IHZhciBzZXQgPSBuZXcgT3JkZXJlZFNldCgpOwoKICAgIHNldC5wcmVzZW5j
        ZVNldCA9IGNvcHkodGhpcy5wcmVzZW5jZVNldCk7CiAgICBzZXQubGlzdCA9
        IHRoaXMudG9BcnJheSgpOwoKICAgIHJldHVybiBzZXQ7CiAgfQp9OwoKLyoq
        CiAgQSBNYXAgc3RvcmVzIHZhbHVlcyBpbmRleGVkIGJ5IGtleXMuIFVubGlr
        ZSBKYXZhU2NyaXB0J3MKICBkZWZhdWx0IE9iamVjdHMsIHRoZSBrZXlzIG9m
        IGEgTWFwIGNhbiBiZSBhbnkgSmF2YVNjcmlwdAogIG9iamVjdC4KCiAgSW50
        ZXJuYWxseSwgYSBNYXAgaGFzIHR3byBkYXRhIHN0cnVjdHVyZXM6CgogIDEu
        IGBrZXlzYDogYW4gT3JkZXJlZFNldCBvZiBhbGwgb2YgdGhlIGV4aXN0aW5n
        IGtleXMKICAyLiBgdmFsdWVzYDogYSBKYXZhU2NyaXB0IE9iamVjdCBpbmRl
        eGVkIGJ5IHRoZSBgRW1iZXIuZ3VpZEZvcihrZXkpYAoKICBXaGVuIGEga2V5
        L3ZhbHVlIHBhaXIgaXMgYWRkZWQgZm9yIHRoZSBmaXJzdCB0aW1lLCB3ZQog
        IGFkZCB0aGUga2V5IHRvIHRoZSBga2V5c2AgT3JkZXJlZFNldCwgYW5kIGNy
        ZWF0ZSBvcgogIHJlcGxhY2UgYW4gZW50cnkgaW4gYHZhbHVlc2AuIFdoZW4g
        YW4gZW50cnkgaXMgZGVsZXRlZCwKICB3ZSBkZWxldGUgaXRzIGVudHJ5IGlu
        IGBrZXlzYCBhbmQgYHZhbHVlc2AuCgogIEBjbGFzcyBNYXAKICBAbmFtZXNw
        YWNlIEVtYmVyCiAgQHByaXZhdGUKICBAY29uc3RydWN0b3IKKi8KdmFyIE1h
        cCA9IEVtYmVyLk1hcCA9IGZ1bmN0aW9uKCkgewogIHRoaXMua2V5cyA9IEVt
        YmVyLk9yZGVyZWRTZXQuY3JlYXRlKCk7CiAgdGhpcy52YWx1ZXMgPSB7fTsK
        fTsKCi8qKgogIEBtZXRob2QgY3JlYXRlCiAgQHN0YXRpYwoqLwpNYXAuY3Jl
        YXRlID0gZnVuY3Rpb24oKSB7CiAgcmV0dXJuIG5ldyBNYXAoKTsKfTsKCk1h
        cC5wcm90b3R5cGUgPSB7CiAgLyoqCiAgICBUaGlzIHByb3BlcnR5IHdpbGwg
        Y2hhbmdlIGFzIHRoZSBudW1iZXIgb2Ygb2JqZWN0cyBpbiB0aGUgbWFwIGNo
        YW5nZXMuCiAgIAogICAgQHByb3BlcnR5IGxlbmd0aAogICAgQHR5cGUgbnVt
        YmVyCiAgICBAZGVmYXVsdCAwCiAgKi8KICBsZW5ndGg6IDAsCiAgICAKICAg
        IAogIC8qKgogICAgUmV0cmlldmUgdGhlIHZhbHVlIGFzc29jaWF0ZWQgd2l0
        aCBhIGdpdmVuIGtleS4KCiAgICBAbWV0aG9kIGdldAogICAgQHBhcmFtIHsq
        fSBrZXkKICAgIEByZXR1cm4geyp9IHRoZSB2YWx1ZSBhc3NvY2lhdGVkIHdp
        dGggdGhlIGtleSwgb3IgYHVuZGVmaW5lZGAKICAqLwogIGdldDogZnVuY3Rp
        b24oa2V5KSB7CiAgICB2YXIgdmFsdWVzID0gdGhpcy52YWx1ZXMsCiAgICAg
        ICAgZ3VpZCA9IGd1aWRGb3Ioa2V5KTsKCiAgICByZXR1cm4gdmFsdWVzW2d1
        aWRdOwogIH0sCgogIC8qKgogICAgQWRkcyBhIHZhbHVlIHRvIHRoZSBtYXAu
        IElmIGEgdmFsdWUgZm9yIHRoZSBnaXZlbiBrZXkgaGFzIGFscmVhZHkgYmVl
        bgogICAgcHJvdmlkZWQsIHRoZSBuZXcgdmFsdWUgd2lsbCByZXBsYWNlIHRo
        ZSBvbGQgdmFsdWUuCgogICAgQG1ldGhvZCBzZXQKICAgIEBwYXJhbSB7Kn0g
        a2V5CiAgICBAcGFyYW0geyp9IHZhbHVlCiAgKi8KICBzZXQ6IGZ1bmN0aW9u
        KGtleSwgdmFsdWUpIHsKICAgIHZhciBrZXlzID0gdGhpcy5rZXlzLAogICAg
        ICAgIHZhbHVlcyA9IHRoaXMudmFsdWVzLAogICAgICAgIGd1aWQgPSBndWlk
        Rm9yKGtleSk7CgogICAga2V5cy5hZGQoa2V5KTsKICAgIHZhbHVlc1tndWlk
        XSA9IHZhbHVlOwogICAgc2V0KHRoaXMsICdsZW5ndGgnLCBrZXlzLmxpc3Qu
        bGVuZ3RoKTsKICB9LAoKICAvKioKICAgIFJlbW92ZXMgYSB2YWx1ZSBmcm9t
        IHRoZSBtYXAgZm9yIGFuIGFzc29jaWF0ZWQga2V5LgoKICAgIEBtZXRob2Qg
        cmVtb3ZlCiAgICBAcGFyYW0geyp9IGtleQogICAgQHJldHVybiB7Qm9vbGVh
        bn0gdHJ1ZSBpZiBhbiBpdGVtIHdhcyByZW1vdmVkLCBmYWxzZSBvdGhlcndp
        c2UKICAqLwogIHJlbW92ZTogZnVuY3Rpb24oa2V5KSB7CiAgICAvLyBkb24n
        dCB1c2UgRVM2ICJkZWxldGUiIGJlY2F1c2UgaXQgd2lsbCBiZSBhbm5veWlu
        ZwogICAgLy8gdG8gdXNlIGluIGJyb3dzZXJzIHRoYXQgYXJlIG5vdCBFUzYg
        ZnJpZW5kbHk7CiAgICB2YXIga2V5cyA9IHRoaXMua2V5cywKICAgICAgICB2
        YWx1ZXMgPSB0aGlzLnZhbHVlcywKICAgICAgICBndWlkID0gZ3VpZEZvcihr
        ZXkpOwoKICAgIGlmICh2YWx1ZXMuaGFzT3duUHJvcGVydHkoZ3VpZCkpIHsK
        ICAgICAga2V5cy5yZW1vdmUoa2V5KTsKICAgICAgZGVsZXRlIHZhbHVlc1tn
        dWlkXTsKICAgICAgc2V0KHRoaXMsICdsZW5ndGgnLCBrZXlzLmxpc3QubGVu
        Z3RoKTsKICAgICAgcmV0dXJuIHRydWU7CiAgICB9IGVsc2UgewogICAgICBy
        ZXR1cm4gZmFsc2U7CiAgICB9CiAgfSwKCiAgLyoqCiAgICBDaGVjayB3aGV0
        aGVyIGEga2V5IGlzIHByZXNlbnQuCgogICAgQG1ldGhvZCBoYXMKICAgIEBw
        YXJhbSB7Kn0ga2V5CiAgICBAcmV0dXJuIHtCb29sZWFufSB0cnVlIGlmIHRo
        ZSBpdGVtIHdhcyBwcmVzZW50LCBmYWxzZSBvdGhlcndpc2UKICAqLwogIGhh
        czogZnVuY3Rpb24oa2V5KSB7CiAgICB2YXIgdmFsdWVzID0gdGhpcy52YWx1
        ZXMsCiAgICAgICAgZ3VpZCA9IGd1aWRGb3Ioa2V5KTsKCiAgICByZXR1cm4g
        dmFsdWVzLmhhc093blByb3BlcnR5KGd1aWQpOwogIH0sCgogIC8qKgogICAg
        SXRlcmF0ZSBvdmVyIGFsbCB0aGUga2V5cyBhbmQgdmFsdWVzLiBDYWxscyB0
        aGUgZnVuY3Rpb24gb25jZQogICAgZm9yIGVhY2gga2V5LCBwYXNzaW5nIGlu
        IHRoZSBrZXkgYW5kIHZhbHVlLCBpbiB0aGF0IG9yZGVyLgoKICAgIFRoZSBr
        ZXlzIGFyZSBndWFyYW50ZWVkIHRvIGJlIGl0ZXJhdGVkIG92ZXIgaW4gaW5z
        ZXJ0aW9uIG9yZGVyLgoKICAgIEBtZXRob2QgZm9yRWFjaAogICAgQHBhcmFt
        IHtGdW5jdGlvbn0gY2FsbGJhY2sKICAgIEBwYXJhbSB7Kn0gc2VsZiBpZiBw
        YXNzZWQsIHRoZSBgdGhpc2AgdmFsdWUgaW5zaWRlIHRoZQogICAgICBjYWxs
        YmFjay4gQnkgZGVmYXVsdCwgYHRoaXNgIGlzIHRoZSBtYXAuCiAgKi8KICBm
        b3JFYWNoOiBmdW5jdGlvbihjYWxsYmFjaywgc2VsZikgewogICAgdmFyIGtl
        eXMgPSB0aGlzLmtleXMsCiAgICAgICAgdmFsdWVzID0gdGhpcy52YWx1ZXM7
        CgogICAga2V5cy5mb3JFYWNoKGZ1bmN0aW9uKGtleSkgewogICAgICB2YXIg
        Z3VpZCA9IGd1aWRGb3Ioa2V5KTsKICAgICAgY2FsbGJhY2suY2FsbChzZWxm
        LCBrZXksIHZhbHVlc1tndWlkXSk7CiAgICB9KTsKICB9LAoKICAvKioKICAg
        IEBtZXRob2QgY29weQogICAgQHJldHVybiB7RW1iZXIuTWFwfQogICovCiAg
        Y29weTogZnVuY3Rpb24oKSB7CiAgICByZXR1cm4gY29weU1hcCh0aGlzLCBu
        ZXcgTWFwKCkpOwogIH0KfTsKCi8qKgogIEBjbGFzcyBNYXBXaXRoRGVmYXVs
        dAogIEBuYW1lc3BhY2UgRW1iZXIKICBAZXh0ZW5kcyBFbWJlci5NYXAKICBA
        cHJpdmF0ZQogIEBjb25zdHJ1Y3RvcgogIEBwYXJhbSBbb3B0aW9uc10KICAg
        IEBwYXJhbSB7Kn0gW29wdGlvbnMuZGVmYXVsdFZhbHVlXQoqLwp2YXIgTWFw
        V2l0aERlZmF1bHQgPSBFbWJlci5NYXBXaXRoRGVmYXVsdCA9IGZ1bmN0aW9u
        KG9wdGlvbnMpIHsKICBNYXAuY2FsbCh0aGlzKTsKICB0aGlzLmRlZmF1bHRW
        YWx1ZSA9IG9wdGlvbnMuZGVmYXVsdFZhbHVlOwp9OwoKLyoqCiAgQG1ldGhv
        ZCBjcmVhdGUKICBAc3RhdGljCiAgQHBhcmFtIFtvcHRpb25zXQogICAgQHBh
        cmFtIHsqfSBbb3B0aW9ucy5kZWZhdWx0VmFsdWVdCiAgQHJldHVybiB7RW1i
        ZXIuTWFwV2l0aERlZmF1bHR8RW1iZXIuTWFwfSBJZiBvcHRpb25zIGFyZSBw
        YXNzZWQsIHJldHVybnMKICAgIGBFbWJlci5NYXBXaXRoRGVmYXVsdGAgb3Ro
        ZXJ3aXNlIHJldHVybnMgYEVtYmVyLk1hcGAKKi8KTWFwV2l0aERlZmF1bHQu
        Y3JlYXRlID0gZnVuY3Rpb24ob3B0aW9ucykgewogIGlmIChvcHRpb25zKSB7
        CiAgICByZXR1cm4gbmV3IE1hcFdpdGhEZWZhdWx0KG9wdGlvbnMpOwogIH0g
        ZWxzZSB7CiAgICByZXR1cm4gbmV3IE1hcCgpOwogIH0KfTsKCk1hcFdpdGhE
        ZWZhdWx0LnByb3RvdHlwZSA9IEVtYmVyLmNyZWF0ZShNYXAucHJvdG90eXBl
        KTsKCi8qKgogIFJldHJpZXZlIHRoZSB2YWx1ZSBhc3NvY2lhdGVkIHdpdGgg
        YSBnaXZlbiBrZXkuCgogIEBtZXRob2QgZ2V0CiAgQHBhcmFtIHsqfSBrZXkK
        ICBAcmV0dXJuIHsqfSB0aGUgdmFsdWUgYXNzb2NpYXRlZCB3aXRoIHRoZSBr
        ZXksIG9yIHRoZSBkZWZhdWx0IHZhbHVlCiovCk1hcFdpdGhEZWZhdWx0LnBy
        b3RvdHlwZS5nZXQgPSBmdW5jdGlvbihrZXkpIHsKICB2YXIgaGFzVmFsdWUg
        PSB0aGlzLmhhcyhrZXkpOwoKICBpZiAoaGFzVmFsdWUpIHsKICAgIHJldHVy
        biBNYXAucHJvdG90eXBlLmdldC5jYWxsKHRoaXMsIGtleSk7CiAgfSBlbHNl
        IHsKICAgIHZhciBkZWZhdWx0VmFsdWUgPSB0aGlzLmRlZmF1bHRWYWx1ZShr
        ZXkpOwogICAgdGhpcy5zZXQoa2V5LCBkZWZhdWx0VmFsdWUpOwogICAgcmV0
        dXJuIGRlZmF1bHRWYWx1ZTsKICB9Cn07CgovKioKICBAbWV0aG9kIGNvcHkK
        ICBAcmV0dXJuIHtFbWJlci5NYXBXaXRoRGVmYXVsdH0KKi8KTWFwV2l0aERl
        ZmF1bHQucHJvdG90eXBlLmNvcHkgPSBmdW5jdGlvbigpIHsKICByZXR1cm4g
        Y29weU1hcCh0aGlzLCBuZXcgTWFwV2l0aERlZmF1bHQoewogICAgZGVmYXVs
        dFZhbHVlOiB0aGlzLmRlZmF1bHRWYWx1ZQogIH0pKTsKfTsKCn0pKCk7CgoK
        CihmdW5jdGlvbigpIHsKLyoqCkBtb2R1bGUgZW1iZXItbWV0YWwKKi8KCnZh
        ciBNRVRBX0tFWSA9IEVtYmVyLk1FVEFfS0VZLAogICAgbWV0YUZvciA9IEVt
        YmVyLm1ldGEsCiAgICBvYmplY3REZWZpbmVQcm9wZXJ0eSA9IEVtYmVyLnBs
        YXRmb3JtLmRlZmluZVByb3BlcnR5OwoKdmFyIE1BTkRBVE9SWV9TRVRURVIg
        PSBFbWJlci5FTlYuTUFOREFUT1JZX1NFVFRFUjsKCi8vIC4uLi4uLi4uLi4u
        Li4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4u
        Li4KLy8gREVTQ1JJUFRPUgovLwoKLyoqCiAgT2JqZWN0cyBvZiB0aGlzIHR5
        cGUgY2FuIGltcGxlbWVudCBhbiBpbnRlcmZhY2UgdG8gcmVzcG9uZCB0byBy
        ZXF1ZXN0cyB0bwogIGdldCBhbmQgc2V0LiBUaGUgZGVmYXVsdCBpbXBsZW1l
        bnRhdGlvbiBoYW5kbGVzIHNpbXBsZSBwcm9wZXJ0aWVzLgoKICBZb3UgZ2Vu
        ZXJhbGx5IHdvbid0IG5lZWQgdG8gY3JlYXRlIG9yIHN1YmNsYXNzIHRoaXMg
        ZGlyZWN0bHkuCgogIEBjbGFzcyBEZXNjcmlwdG9yCiAgQG5hbWVzcGFjZSBF
        bWJlcgogIEBwcml2YXRlCiAgQGNvbnN0cnVjdG9yCiovCkVtYmVyLkRlc2Ny
        aXB0b3IgPSBmdW5jdGlvbigpIHt9OwoKLy8gLi4uLi4uLi4uLi4uLi4uLi4u
        Li4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLgovLyBE
        RUZJTklORyBQUk9QRVJUSUVTIEFQSQovLwoKdmFyIE1BTkRBVE9SWV9TRVRU
        RVJfRlVOQ1RJT04gPSBFbWJlci5NQU5EQVRPUllfU0VUVEVSX0ZVTkNUSU9O
        ID0gZnVuY3Rpb24odmFsdWUpIHsKICBFbWJlci5hc3NlcnQoIllvdSBtdXN0
        IHVzZSBFbWJlci5zZXQoKSB0byBhY2Nlc3MgdGhpcyBwcm9wZXJ0eSAob2Yg
        IiArIHRoaXMgKyAiKSIsIGZhbHNlKTsKfTsKCnZhciBERUZBVUxUX0dFVFRF
        Ul9GVU5DVElPTiA9IEVtYmVyLkRFRkFVTFRfR0VUVEVSX0ZVTkNUSU9OID0g
        ZnVuY3Rpb24obmFtZSkgewogIHJldHVybiBmdW5jdGlvbigpIHsKICAgIHZh
        ciBtZXRhID0gdGhpc1tNRVRBX0tFWV07CiAgICByZXR1cm4gbWV0YSAmJiBt
        ZXRhLnZhbHVlc1tuYW1lXTsKICB9Owp9OwoKLyoqCiAgQHByaXZhdGUKCiAg
        Tk9URTogVGhpcyBpcyBhIGxvdy1sZXZlbCBtZXRob2QgdXNlZCBieSBvdGhl
        ciBwYXJ0cyBvZiB0aGUgQVBJLiBZb3UgYWxtb3N0CiAgbmV2ZXIgd2FudCB0
        byBjYWxsIHRoaXMgbWV0aG9kIGRpcmVjdGx5LiBJbnN0ZWFkIHlvdSBzaG91
        bGQgdXNlCiAgYEVtYmVyLm1peGluKClgIHRvIGRlZmluZSBuZXcgcHJvcGVy
        dGllcy4KCiAgRGVmaW5lcyBhIHByb3BlcnR5IG9uIGFuIG9iamVjdC4gVGhp
        cyBtZXRob2Qgd29ya3MgbXVjaCBsaWtlIHRoZSBFUzUKICBgT2JqZWN0LmRl
        ZmluZVByb3BlcnR5KClgIG1ldGhvZCBleGNlcHQgdGhhdCBpdCBjYW4gYWxz
        byBhY2NlcHQgY29tcHV0ZWQKICBwcm9wZXJ0aWVzIGFuZCBvdGhlciBzcGVj
        aWFsIGRlc2NyaXB0b3JzLgoKICBOb3JtYWxseSB0aGlzIG1ldGhvZCB0YWtl
        cyBvbmx5IHRocmVlIHBhcmFtZXRlcnMuIEhvd2V2ZXIgaWYgeW91IHBhc3Mg
        YW4KICBpbnN0YW5jZSBvZiBgRW1iZXIuRGVzY3JpcHRvcmAgYXMgdGhlIHRo
        aXJkIHBhcmFtIHRoZW4geW91IGNhbiBwYXNzIGFuCiAgb3B0aW9uYWwgdmFs
        dWUgYXMgdGhlIGZvdXJ0aCBwYXJhbWV0ZXIuIFRoaXMgaXMgb2Z0ZW4gbW9y
        ZSBlZmZpY2llbnQgdGhhbgogIGNyZWF0aW5nIG5ldyBkZXNjcmlwdG9yIGhh
        c2hlcyBmb3IgZWFjaCBwcm9wZXJ0eS4KCiAgIyMgRXhhbXBsZXMKCiAgYGBg
        amF2YXNjcmlwdAogIC8vIEVTNSBjb21wYXRpYmxlIG1vZGUKICBFbWJlci5k
        ZWZpbmVQcm9wZXJ0eShjb250YWN0LCAnZmlyc3ROYW1lJywgewogICAgd3Jp
        dGFibGU6IHRydWUsCiAgICBjb25maWd1cmFibGU6IGZhbHNlLAogICAgZW51
        bWVyYWJsZTogdHJ1ZSwKICAgIHZhbHVlOiAnQ2hhcmxlcycKICB9KTsKCiAg
        Ly8gZGVmaW5lIGEgc2ltcGxlIHByb3BlcnR5CiAgRW1iZXIuZGVmaW5lUHJv
        cGVydHkoY29udGFjdCwgJ2xhc3ROYW1lJywgdW5kZWZpbmVkLCAnSm9sbGV5
        Jyk7CgogIC8vIGRlZmluZSBhIGNvbXB1dGVkIHByb3BlcnR5CiAgRW1iZXIu
        ZGVmaW5lUHJvcGVydHkoY29udGFjdCwgJ2Z1bGxOYW1lJywgRW1iZXIuY29t
        cHV0ZWQoZnVuY3Rpb24oKSB7CiAgICByZXR1cm4gdGhpcy5maXJzdE5hbWUr
        JyAnK3RoaXMubGFzdE5hbWU7CiAgfSkucHJvcGVydHkoJ2ZpcnN0TmFtZScs
        ICdsYXN0TmFtZScpKTsKICBgYGAKCiAgQG1ldGhvZCBkZWZpbmVQcm9wZXJ0
        eQogIEBmb3IgRW1iZXIKICBAcGFyYW0ge09iamVjdH0gb2JqIHRoZSBvYmpl
        Y3QgdG8gZGVmaW5lIHRoaXMgcHJvcGVydHkgb24uIFRoaXMgbWF5IGJlIGEg
        cHJvdG90eXBlLgogIEBwYXJhbSB7U3RyaW5nfSBrZXlOYW1lIHRoZSBuYW1l
        IG9mIHRoZSBwcm9wZXJ0eQogIEBwYXJhbSB7RW1iZXIuRGVzY3JpcHRvcn0g
        W2Rlc2NdIGFuIGluc3RhbmNlIG9mIGBFbWJlci5EZXNjcmlwdG9yYCAodHlw
        aWNhbGx5IGEKICAgIGNvbXB1dGVkIHByb3BlcnR5KSBvciBhbiBFUzUgZGVz
        Y3JpcHRvci4KICAgIFlvdSBtdXN0IHByb3ZpZGUgdGhpcyBvciBgZGF0YWAg
        YnV0IG5vdCBib3RoLgogIEBwYXJhbSB7Kn0gW2RhdGFdIHNvbWV0aGluZyBv
        dGhlciB0aGFuIGEgZGVzY3JpcHRvciwgdGhhdCB3aWxsCiAgICBiZWNvbWUg
        dGhlIGV4cGxpY2l0IHZhbHVlIG9mIHRoaXMgcHJvcGVydHkuCiovCkVtYmVy
        LmRlZmluZVByb3BlcnR5ID0gZnVuY3Rpb24ob2JqLCBrZXlOYW1lLCBkZXNj
        LCBkYXRhLCBtZXRhKSB7CiAgdmFyIGRlc2NzLCBleGlzdGluZ0Rlc2MsIHdh
        dGNoaW5nLCB2YWx1ZTsKCiAgaWYgKCFtZXRhKSBtZXRhID0gbWV0YUZvcihv
        YmopOwogIGRlc2NzID0gbWV0YS5kZXNjczsKICBleGlzdGluZ0Rlc2MgPSBt
        ZXRhLmRlc2NzW2tleU5hbWVdOwogIHdhdGNoaW5nID0gbWV0YS53YXRjaGlu
        Z1trZXlOYW1lXSA+IDA7CgogIGlmIChleGlzdGluZ0Rlc2MgaW5zdGFuY2Vv
        ZiBFbWJlci5EZXNjcmlwdG9yKSB7CiAgICBleGlzdGluZ0Rlc2MudGVhcmRv
        d24ob2JqLCBrZXlOYW1lKTsKICB9CgogIGlmIChkZXNjIGluc3RhbmNlb2Yg
        RW1iZXIuRGVzY3JpcHRvcikgewogICAgdmFsdWUgPSBkZXNjOwoKICAgIGRl
        c2NzW2tleU5hbWVdID0gZGVzYzsKICAgIGlmIChNQU5EQVRPUllfU0VUVEVS
        ICYmIHdhdGNoaW5nKSB7CiAgICAgIG9iamVjdERlZmluZVByb3BlcnR5KG9i
        aiwga2V5TmFtZSwgewogICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAg
        ICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgIHdyaXRhYmxlOiB0cnVl
        LAogICAgICAgIHZhbHVlOiB1bmRlZmluZWQgLy8gbWFrZSBlbnVtZXJhYmxl
        CiAgICAgIH0pOwogICAgfSBlbHNlIHsKICAgICAgb2JqW2tleU5hbWVdID0g
        dW5kZWZpbmVkOyAvLyBtYWtlIGVudW1lcmFibGUKICAgIH0KICB9IGVsc2Ug
        ewogICAgZGVzY3Nba2V5TmFtZV0gPSB1bmRlZmluZWQ7IC8vIHNoYWRvdyBk
        ZXNjcmlwdG9yIGluIHByb3RvCiAgICBpZiAoZGVzYyA9PSBudWxsKSB7CiAg
        ICAgIHZhbHVlID0gZGF0YTsKCiAgICAgIGlmIChNQU5EQVRPUllfU0VUVEVS
        ICYmIHdhdGNoaW5nKSB7CiAgICAgICAgbWV0YS52YWx1ZXNba2V5TmFtZV0g
        PSBkYXRhOwogICAgICAgIG9iamVjdERlZmluZVByb3BlcnR5KG9iaiwga2V5
        TmFtZSwgewogICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAg
        ICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICAgIHNldDogTUFOREFUT1JZ
        X1NFVFRFUl9GVU5DVElPTiwKICAgICAgICAgIGdldDogREVGQVVMVF9HRVRU
        RVJfRlVOQ1RJT04oa2V5TmFtZSkKICAgICAgICB9KTsKICAgICAgfSBlbHNl
        IHsKICAgICAgICBvYmpba2V5TmFtZV0gPSBkYXRhOwogICAgICB9CiAgICB9
        IGVsc2UgewogICAgICB2YWx1ZSA9IGRlc2M7CgogICAgICAvLyBjb21wYXRp
        YmlsaXR5IHdpdGggRVM1CiAgICAgIG9iamVjdERlZmluZVByb3BlcnR5KG9i
        aiwga2V5TmFtZSwgZGVzYyk7CiAgICB9CiAgfQoKICAvLyBpZiBrZXkgaXMg
        YmVpbmcgd2F0Y2hlZCwgb3ZlcnJpZGUgY2hhaW5zIHRoYXQKICAvLyB3ZXJl
        IGluaXRpYWxpemVkIHdpdGggdGhlIHByb3RvdHlwZQogIGlmICh3YXRjaGlu
        ZykgeyBFbWJlci5vdmVycmlkZUNoYWlucyhvYmosIGtleU5hbWUsIG1ldGEp
        OyB9CgogIC8vIFRoZSBgdmFsdWVgIHBhc3NlZCB0byB0aGUgYGRpZERlZmlu
        ZVByb3BlcnR5YCBob29rIGlzCiAgLy8gZWl0aGVyIHRoZSBkZXNjcmlwdG9y
        IG9yIGRhdGEsIHdoaWNoZXZlciB3YXMgcGFzc2VkLgogIGlmIChvYmouZGlk
        RGVmaW5lUHJvcGVydHkpIHsgb2JqLmRpZERlZmluZVByb3BlcnR5KG9iaiwg
        a2V5TmFtZSwgdmFsdWUpOyB9CgogIHJldHVybiB0aGlzOwp9OwoKCn0pKCk7
        CgoKCihmdW5jdGlvbigpIHsKdmFyIGdldCA9IEVtYmVyLmdldDsKCi8qKgog
        IFRvIGdldCBtdWx0aXBsZSBwcm9wZXJ0aWVzIGF0IG9uY2UsIGNhbGwgYEVt
        YmVyLmdldFByb3BlcnRpZXNgCiAgd2l0aCBhbiBvYmplY3QgZm9sbG93ZWQg
        YnkgYSBsaXN0IG9mIHN0cmluZ3Mgb3IgYW4gYXJyYXk6CgogIGBgYGphdmFz
        Y3JpcHQKICBFbWJlci5nZXRQcm9wZXJ0aWVzKHJlY29yZCwgJ2ZpcnN0TmFt
        ZScsICdsYXN0TmFtZScsICd6aXBDb2RlJyk7ICAvLyB7IGZpcnN0TmFtZTog
        J0pvaG4nLCBsYXN0TmFtZTogJ0RvZScsIHppcENvZGU6ICcxMDAxMScgfQog
        IGBgYAoKICBpcyBlcXVpdmFsZW50IHRvOgoKICBgYGBqYXZhc2NyaXB0CiAg
        RW1iZXIuZ2V0UHJvcGVydGllcyhyZWNvcmQsIFsnZmlyc3ROYW1lJywgJ2xh
        c3ROYW1lJywgJ3ppcENvZGUnXSk7ICAvLyB7IGZpcnN0TmFtZTogJ0pvaG4n
        LCBsYXN0TmFtZTogJ0RvZScsIHppcENvZGU6ICcxMDAxMScgfQogIGBgYAoK
        ICBAbWV0aG9kIGdldFByb3BlcnRpZXMKICBAcGFyYW0gb2JqCiAgQHBhcmFt
        IHtTdHJpbmcuLi58QXJyYXl9IGxpc3Qgb2Yga2V5cyB0byBnZXQKICBAcmV0
        dXJuIHtIYXNofQoqLwpFbWJlci5nZXRQcm9wZXJ0aWVzID0gZnVuY3Rpb24o
        b2JqKSB7CiAgdmFyIHJldCA9IHt9LAogICAgICBwcm9wZXJ0eU5hbWVzID0g
        YXJndW1lbnRzLAogICAgICBpID0gMTsKCiAgaWYgKGFyZ3VtZW50cy5sZW5n
        dGggPT09IDIgJiYgRW1iZXIudHlwZU9mKGFyZ3VtZW50c1sxXSkgPT09ICdh
        cnJheScpIHsKICAgIGkgPSAwOwogICAgcHJvcGVydHlOYW1lcyA9IGFyZ3Vt
        ZW50c1sxXTsKICB9CiAgZm9yKHZhciBsZW4gPSBwcm9wZXJ0eU5hbWVzLmxl
        bmd0aDsgaSA8IGxlbjsgaSsrKSB7CiAgICByZXRbcHJvcGVydHlOYW1lc1tp
        XV0gPSBnZXQob2JqLCBwcm9wZXJ0eU5hbWVzW2ldKTsKICB9CiAgcmV0dXJu
        IHJldDsKfTsKCn0pKCk7CgoKCihmdW5jdGlvbigpIHsKdmFyIGNoYW5nZVBy
        b3BlcnRpZXMgPSBFbWJlci5jaGFuZ2VQcm9wZXJ0aWVzLAogICAgc2V0ID0g
        RW1iZXIuc2V0OwoKLyoqCiAgU2V0IGEgbGlzdCBvZiBwcm9wZXJ0aWVzIG9u
        IGFuIG9iamVjdC4gVGhlc2UgcHJvcGVydGllcyBhcmUgc2V0IGluc2lkZQog
        IGEgc2luZ2xlIGBiZWdpblByb3BlcnR5Q2hhbmdlc2AgYW5kIGBlbmRQcm9w
        ZXJ0eUNoYW5nZXNgIGJhdGNoLCBzbwogIG9ic2VydmVycyB3aWxsIGJlIGJ1
        ZmZlcmVkLgoKICBgYGBqYXZhc2NyaXB0CiAgYW5PYmplY3Quc2V0UHJvcGVy
        dGllcyh7CiAgICBmaXJzdE5hbWU6ICJTdGFubGV5IiwKICAgIGxhc3ROYW1l
        OiAiU3R1YXJ0IiwKICAgIGFnZTogIjIxIgogIH0pCiAgYGBgCgogIEBtZXRo
        b2Qgc2V0UHJvcGVydGllcwogIEBwYXJhbSBzZWxmCiAgQHBhcmFtIHtPYmpl
        Y3R9IGhhc2gKICBAcmV0dXJuIHNlbGYKKi8KRW1iZXIuc2V0UHJvcGVydGll
        cyA9IGZ1bmN0aW9uKHNlbGYsIGhhc2gpIHsKICBjaGFuZ2VQcm9wZXJ0aWVz
        KGZ1bmN0aW9uKCkgewogICAgZm9yKHZhciBwcm9wIGluIGhhc2gpIHsKICAg
        ICAgaWYgKGhhc2guaGFzT3duUHJvcGVydHkocHJvcCkpIHsgc2V0KHNlbGYs
        IHByb3AsIGhhc2hbcHJvcF0pOyB9CiAgICB9CiAgfSk7CiAgcmV0dXJuIHNl
        bGY7Cn07Cgp9KSgpOwoKCgooZnVuY3Rpb24oKSB7CnZhciBtZXRhRm9yID0g
        RW1iZXIubWV0YSwgLy8gdXRpbHMuanMKICAgIHR5cGVPZiA9IEVtYmVyLnR5
        cGVPZiwgLy8gdXRpbHMuanMKICAgIE1BTkRBVE9SWV9TRVRURVIgPSBFbWJl
        ci5FTlYuTUFOREFUT1JZX1NFVFRFUiwKICAgIG9fZGVmaW5lUHJvcGVydHkg
        PSBFbWJlci5wbGF0Zm9ybS5kZWZpbmVQcm9wZXJ0eTsKCkVtYmVyLndhdGNo
        S2V5ID0gZnVuY3Rpb24ob2JqLCBrZXlOYW1lKSB7CiAgLy8gY2FuJ3Qgd2F0
        Y2ggbGVuZ3RoIG9uIEFycmF5IC0gaXQgaXMgc3BlY2lhbC4uLgogIGlmIChr
        ZXlOYW1lID09PSAnbGVuZ3RoJyAmJiB0eXBlT2Yob2JqKSA9PT0gJ2FycmF5
        JykgeyByZXR1cm47IH0KCiAgdmFyIG0gPSBtZXRhRm9yKG9iaiksIHdhdGNo
        aW5nID0gbS53YXRjaGluZzsKCiAgLy8gYWN0aXZhdGUgd2F0Y2hpbmcgZmly
        c3QgdGltZQogIGlmICghd2F0Y2hpbmdba2V5TmFtZV0pIHsKICAgIHdhdGNo
        aW5nW2tleU5hbWVdID0gMTsKCiAgICBpZiAoJ2Z1bmN0aW9uJyA9PT0gdHlw
        ZW9mIG9iai53aWxsV2F0Y2hQcm9wZXJ0eSkgewogICAgICBvYmoud2lsbFdh
        dGNoUHJvcGVydHkoa2V5TmFtZSk7CiAgICB9CgogICAgaWYgKE1BTkRBVE9S
        WV9TRVRURVIgJiYga2V5TmFtZSBpbiBvYmopIHsKICAgICAgbS52YWx1ZXNb
        a2V5TmFtZV0gPSBvYmpba2V5TmFtZV07CiAgICAgIG9fZGVmaW5lUHJvcGVy
        dHkob2JqLCBrZXlOYW1lLCB7CiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVl
        LAogICAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgICAgc2V0OiBFbWJl
        ci5NQU5EQVRPUllfU0VUVEVSX0ZVTkNUSU9OLAogICAgICAgIGdldDogRW1i
        ZXIuREVGQVVMVF9HRVRURVJfRlVOQ1RJT04oa2V5TmFtZSkKICAgICAgfSk7
        CiAgICB9CiAgfSBlbHNlIHsKICAgIHdhdGNoaW5nW2tleU5hbWVdID0gKHdh
        dGNoaW5nW2tleU5hbWVdIHx8IDApICsgMTsKICB9Cn07CgoKRW1iZXIudW53
        YXRjaEtleSA9IGZ1bmN0aW9uKG9iaiwga2V5TmFtZSkgewogIHZhciBtID0g
        bWV0YUZvcihvYmopLCB3YXRjaGluZyA9IG0ud2F0Y2hpbmc7CgogIGlmICh3
        YXRjaGluZ1trZXlOYW1lXSA9PT0gMSkgewogICAgd2F0Y2hpbmdba2V5TmFt
        ZV0gPSAwOwoKICAgIGlmICgnZnVuY3Rpb24nID09PSB0eXBlb2Ygb2JqLmRp
        ZFVud2F0Y2hQcm9wZXJ0eSkgewogICAgICBvYmouZGlkVW53YXRjaFByb3Bl
        cnR5KGtleU5hbWUpOwogICAgfQoKICAgIGlmIChNQU5EQVRPUllfU0VUVEVS
        ICYmIGtleU5hbWUgaW4gb2JqKSB7CiAgICAgIG9fZGVmaW5lUHJvcGVydHko
        b2JqLCBrZXlOYW1lLCB7CiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAog
        ICAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgICAgd3JpdGFibGU6IHRy
        dWUsCiAgICAgICAgdmFsdWU6IG0udmFsdWVzW2tleU5hbWVdCiAgICAgIH0p
        OwogICAgICBkZWxldGUgbS52YWx1ZXNba2V5TmFtZV07CiAgICB9CiAgfSBl
        bHNlIGlmICh3YXRjaGluZ1trZXlOYW1lXSA+IDEpIHsKICAgIHdhdGNoaW5n
        W2tleU5hbWVdLS07CiAgfQp9OwoKfSkoKTsKCgoKKGZ1bmN0aW9uKCkgewp2
        YXIgbWV0YUZvciA9IEVtYmVyLm1ldGEsIC8vIHV0aWxzLmpzCiAgICBnZXQg
        PSBFbWJlci5nZXQsIC8vIHByb3BlcnR5X2dldC5qcwogICAgbm9ybWFsaXpl
        VHVwbGUgPSBFbWJlci5ub3JtYWxpemVUdXBsZSwgLy8gcHJvcGVydHlfZ2V0
        LmpzCiAgICBmb3JFYWNoID0gRW1iZXIuQXJyYXlQb2x5ZmlsbHMuZm9yRWFj
        aCwgLy8gYXJyYXkuanMKICAgIHdhcm4gPSBFbWJlci53YXJuLAogICAgd2F0
        Y2hLZXkgPSBFbWJlci53YXRjaEtleSwKICAgIHVud2F0Y2hLZXkgPSBFbWJl
        ci51bndhdGNoS2V5LAogICAgRklSU1RfS0VZID0gL14oW15cLlwqXSspLzsK
        CmZ1bmN0aW9uIGZpcnN0S2V5KHBhdGgpIHsKICByZXR1cm4gcGF0aC5tYXRj
        aChGSVJTVF9LRVkpWzBdOwp9Cgp2YXIgcGVuZGluZ1F1ZXVlID0gW107Cgov
        LyBhdHRlbXB0cyB0byBhZGQgdGhlIHBlbmRpbmdRdWV1ZSBjaGFpbnMgYWdh
        aW4uIElmIHNvbWUgb2YgdGhlbSBlbmQgdXAKLy8gYmFjayBpbiB0aGUgcXVl
        dWUgYW5kIHJlc2NoZWR1bGUgaXMgdHJ1ZSwgc2NoZWR1bGVzIGEgdGltZW91
        dCB0byB0cnkKLy8gYWdhaW4uCkVtYmVyLmZsdXNoUGVuZGluZ0NoYWlucyA9
        IGZ1bmN0aW9uKCkgewogIGlmIChwZW5kaW5nUXVldWUubGVuZ3RoID09PSAw
        KSB7IHJldHVybjsgfSAvLyBub3RoaW5nIHRvIGRvCgogIHZhciBxdWV1ZSA9
        IHBlbmRpbmdRdWV1ZTsKICBwZW5kaW5nUXVldWUgPSBbXTsKCiAgZm9yRWFj
        aC5jYWxsKHF1ZXVlLCBmdW5jdGlvbihxKSB7IHFbMF0uYWRkKHFbMV0pOyB9
        KTsKCiAgd2FybignV2F0Y2hpbmcgYW4gdW5kZWZpbmVkIGdsb2JhbCwgRW1i
        ZXIgZXhwZWN0cyB3YXRjaGVkIGdsb2JhbHMgdG8gYmUgc2V0dXAgYnkgdGhl
        IHRpbWUgdGhlIHJ1biBsb29wIGlzIGZsdXNoZWQsIGNoZWNrIGZvciB0eXBv
        cycsIHBlbmRpbmdRdWV1ZS5sZW5ndGggPT09IDApOwp9OwoKCmZ1bmN0aW9u
        IGFkZENoYWluV2F0Y2hlcihvYmosIGtleU5hbWUsIG5vZGUpIHsKICBpZiAo
        IW9iaiB8fCAoJ29iamVjdCcgIT09IHR5cGVvZiBvYmopKSB7IHJldHVybjsg
        fSAvLyBub3RoaW5nIHRvIGRvCgogIHZhciBtID0gbWV0YUZvcihvYmopLCBu
        b2RlcyA9IG0uY2hhaW5XYXRjaGVyczsKCiAgaWYgKCFtLmhhc093blByb3Bl
        cnR5KCdjaGFpbldhdGNoZXJzJykpIHsKICAgIG5vZGVzID0gbS5jaGFpbldh
        dGNoZXJzID0ge307CiAgfQoKICBpZiAoIW5vZGVzW2tleU5hbWVdKSB7IG5v
        ZGVzW2tleU5hbWVdID0gW107IH0KICBub2Rlc1trZXlOYW1lXS5wdXNoKG5v
        ZGUpOwogIHdhdGNoS2V5KG9iaiwga2V5TmFtZSk7Cn0KCnZhciByZW1vdmVD
        aGFpbldhdGNoZXIgPSBFbWJlci5yZW1vdmVDaGFpbldhdGNoZXIgPSBmdW5j
        dGlvbihvYmosIGtleU5hbWUsIG5vZGUpIHsKICBpZiAoIW9iaiB8fCAnb2Jq
        ZWN0JyAhPT0gdHlwZW9mIG9iaikgeyByZXR1cm47IH0gLy8gbm90aGluZyB0
        byBkbwoKICB2YXIgbSA9IG1ldGFGb3Iob2JqLCBmYWxzZSk7CiAgaWYgKCFt
        Lmhhc093blByb3BlcnR5KCdjaGFpbldhdGNoZXJzJykpIHsgcmV0dXJuOyB9
        IC8vIG5vdGhpbmcgdG8gZG8KCiAgdmFyIG5vZGVzID0gbS5jaGFpbldhdGNo
        ZXJzOwoKICBpZiAobm9kZXNba2V5TmFtZV0pIHsKICAgIG5vZGVzID0gbm9k
        ZXNba2V5TmFtZV07CiAgICBmb3IgKHZhciBpID0gMCwgbCA9IG5vZGVzLmxl
        bmd0aDsgaSA8IGw7IGkrKykgewogICAgICBpZiAobm9kZXNbaV0gPT09IG5v
        ZGUpIHsgbm9kZXMuc3BsaWNlKGksIDEpOyB9CiAgICB9CiAgfQogIHVud2F0
        Y2hLZXkob2JqLCBrZXlOYW1lKTsKfTsKCi8vIEEgQ2hhaW5Ob2RlIHdhdGNo
        ZXMgYSBzaW5nbGUga2V5IG9uIGFuIG9iamVjdC4gSWYgeW91IHByb3ZpZGUg
        YSBzdGFydGluZwovLyB2YWx1ZSBmb3IgdGhlIGtleSB0aGVuIHRoZSBub2Rl
        IHdvbid0IGFjdHVhbGx5IHdhdGNoIGl0LiBGb3IgYSByb290IG5vZGUKLy8g
        cGFzcyBudWxsIGZvciBwYXJlbnQgYW5kIGtleSBhbmQgb2JqZWN0IGZvciB2
        YWx1ZS4KdmFyIENoYWluTm9kZSA9IEVtYmVyLl9DaGFpbk5vZGUgPSBmdW5j
        dGlvbihwYXJlbnQsIGtleSwgdmFsdWUpIHsKICB0aGlzLl9wYXJlbnQgPSBw
        YXJlbnQ7CiAgdGhpcy5fa2V5ICAgID0ga2V5OwoKICAvLyBfd2F0Y2hpbmcg
        aXMgdHJ1ZSB3aGVuIGNhbGxpbmcgZ2V0KHRoaXMuX3BhcmVudCwgdGhpcy5f
        a2V5KSB3aWxsCiAgLy8gcmV0dXJuIHRoZSB2YWx1ZSBvZiB0aGlzIG5vZGUu
        CiAgLy8KICAvLyBJdCBpcyBmYWxzZSBmb3IgdGhlIHJvb3Qgb2YgYSBjaGFp
        biAoYmVjYXVzZSB3ZSBoYXZlIG5vIHBhcmVudCkKICAvLyBhbmQgZm9yIGds
        b2JhbCBwYXRocyAoYmVjYXVzZSB0aGUgcGFyZW50IG5vZGUgaXMgdGhlIG9i
        amVjdCB3aXRoCiAgLy8gdGhlIG9ic2VydmVyIG9uIGl0KQogIHRoaXMuX3dh
        dGNoaW5nID0gdmFsdWU9PT11bmRlZmluZWQ7CgogIHRoaXMuX3ZhbHVlICA9
        IHZhbHVlOwogIHRoaXMuX3BhdGhzID0ge307CiAgaWYgKHRoaXMuX3dhdGNo
        aW5nKSB7CiAgICB0aGlzLl9vYmplY3QgPSBwYXJlbnQudmFsdWUoKTsKICAg
        IGlmICh0aGlzLl9vYmplY3QpIHsgYWRkQ2hhaW5XYXRjaGVyKHRoaXMuX29i
        amVjdCwgdGhpcy5fa2V5LCB0aGlzKTsgfQogIH0KCiAgLy8gU3BlY2lhbC1j
        YXNlOiB0aGUgRWFjaFByb3h5IHJlbGllcyBvbiBpbW1lZGlhdGUgZXZhbHVh
        dGlvbiB0bwogIC8vIGVzdGFibGlzaCBpdHMgb2JzZXJ2ZXJzLgogIC8vCiAg
        Ly8gVE9ETzogUmVwbGFjZSB0aGlzIHdpdGggYW4gZWZmaWNpZW50IGNhbGxi
        YWNrIHRoYXQgdGhlIEVhY2hQcm94eQogIC8vIGNhbiBpbXBsZW1lbnQuCiAg
        aWYgKHRoaXMuX3BhcmVudCAmJiB0aGlzLl9wYXJlbnQuX2tleSA9PT0gJ0Bl
        YWNoJykgewogICAgdGhpcy52YWx1ZSgpOwogIH0KfTsKCnZhciBDaGFpbk5v
        ZGVQcm90b3R5cGUgPSBDaGFpbk5vZGUucHJvdG90eXBlOwoKZnVuY3Rpb24g
        bGF6eUdldChvYmosIGtleSkgewogIGlmICghb2JqKSByZXR1cm4gdW5kZWZp
        bmVkOwoKICB2YXIgbWV0YSA9IG1ldGFGb3Iob2JqLCBmYWxzZSk7CiAgLy8g
        Y2hlY2sgaWYgb2JqZWN0IG1lYW50IG9ubHkgdG8gYmUgYSBwcm90b3R5cGUK
        ICBpZiAobWV0YS5wcm90byA9PT0gb2JqKSByZXR1cm4gdW5kZWZpbmVkOwoK
        ICBpZiAoa2V5ID09PSAiQGVhY2giKSByZXR1cm4gZ2V0KG9iaiwga2V5KTsK
        CiAgLy8gaWYgYSBDUCBvbmx5IHJldHVybiBjYWNoZWQgdmFsdWUKICB2YXIg
        ZGVzYyA9IG1ldGEuZGVzY3Nba2V5XTsKICBpZiAoZGVzYyAmJiBkZXNjLl9j
        YWNoZWFibGUpIHsKICAgIGlmIChrZXkgaW4gbWV0YS5jYWNoZSkgewogICAg
        ICByZXR1cm4gbWV0YS5jYWNoZVtrZXldOwogICAgfSBlbHNlIHsKICAgICAg
        cmV0dXJuIHVuZGVmaW5lZDsKICAgIH0KICB9CgogIHJldHVybiBnZXQob2Jq
        LCBrZXkpOwp9CgpDaGFpbk5vZGVQcm90b3R5cGUudmFsdWUgPSBmdW5jdGlv
        bigpIHsKICBpZiAodGhpcy5fdmFsdWUgPT09IHVuZGVmaW5lZCAmJiB0aGlz
        Ll93YXRjaGluZykgewogICAgdmFyIG9iaiA9IHRoaXMuX3BhcmVudC52YWx1
        ZSgpOwogICAgdGhpcy5fdmFsdWUgPSBsYXp5R2V0KG9iaiwgdGhpcy5fa2V5
        KTsKICB9CiAgcmV0dXJuIHRoaXMuX3ZhbHVlOwp9OwoKQ2hhaW5Ob2RlUHJv
        dG90eXBlLmRlc3Ryb3kgPSBmdW5jdGlvbigpIHsKICBpZiAodGhpcy5fd2F0
        Y2hpbmcpIHsKICAgIHZhciBvYmogPSB0aGlzLl9vYmplY3Q7CiAgICBpZiAo
        b2JqKSB7IHJlbW92ZUNoYWluV2F0Y2hlcihvYmosIHRoaXMuX2tleSwgdGhp
        cyk7IH0KICAgIHRoaXMuX3dhdGNoaW5nID0gZmFsc2U7IC8vIHNvIGZ1dHVy
        ZSBjYWxscyBkbyBub3RoaW5nCiAgfQp9OwoKLy8gY29waWVzIGEgdG9wIGxl
        dmVsIG9iamVjdCBvbmx5CkNoYWluTm9kZVByb3RvdHlwZS5jb3B5ID0gZnVu
        Y3Rpb24ob2JqKSB7CiAgdmFyIHJldCA9IG5ldyBDaGFpbk5vZGUobnVsbCwg
        bnVsbCwgb2JqKSwKICAgICAgcGF0aHMgPSB0aGlzLl9wYXRocywgcGF0aDsK
        ICBmb3IgKHBhdGggaW4gcGF0aHMpIHsKICAgIGlmIChwYXRoc1twYXRoXSA8
        PSAwKSB7IGNvbnRpbnVlOyB9IC8vIHRoaXMgY2hlY2sgd2lsbCBhbHNvIGNh
        dGNoIG5vbi1udW1iZXIgdmFscy4KICAgIHJldC5hZGQocGF0aCk7CiAgfQog
        IHJldHVybiByZXQ7Cn07CgovLyBjYWxsZWQgb24gdGhlIHJvb3Qgbm9kZSBv
        ZiBhIGNoYWluIHRvIHNldHVwIHdhdGNoZXJzIG9uIHRoZSBzcGVjaWZpZWQK
        Ly8gcGF0aC4KQ2hhaW5Ob2RlUHJvdG90eXBlLmFkZCA9IGZ1bmN0aW9uKHBh
        dGgpIHsKICB2YXIgb2JqLCB0dXBsZSwga2V5LCBzcmMsIHBhdGhzOwoKICBw
        YXRocyA9IHRoaXMuX3BhdGhzOwogIHBhdGhzW3BhdGhdID0gKHBhdGhzW3Bh
        dGhdIHx8IDApICsgMTsKCiAgb2JqID0gdGhpcy52YWx1ZSgpOwogIHR1cGxl
        ID0gbm9ybWFsaXplVHVwbGUob2JqLCBwYXRoKTsKCiAgLy8gdGhlIHBhdGgg
        d2FzIGEgbG9jYWwgcGF0aAogIGlmICh0dXBsZVswXSAmJiB0dXBsZVswXSA9
        PT0gb2JqKSB7CiAgICBwYXRoID0gdHVwbGVbMV07CiAgICBrZXkgID0gZmly
        c3RLZXkocGF0aCk7CiAgICBwYXRoID0gcGF0aC5zbGljZShrZXkubGVuZ3Ro
        KzEpOwoKICAvLyBnbG9iYWwgcGF0aCwgYnV0IG9iamVjdCBkb2VzIG5vdCBl
        eGlzdCB5ZXQuCiAgLy8gcHV0IGludG8gYSBxdWV1ZSBhbmQgdHJ5IHRvIGNv
        bm5lY3QgbGF0ZXIuCiAgfSBlbHNlIGlmICghdHVwbGVbMF0pIHsKICAgIHBl
        bmRpbmdRdWV1ZS5wdXNoKFt0aGlzLCBwYXRoXSk7CiAgICB0dXBsZS5sZW5n
        dGggPSAwOwogICAgcmV0dXJuOwoKICAvLyBnbG9iYWwgcGF0aCwgYW5kIG9i
        amVjdCBhbHJlYWR5IGV4aXN0cwogIH0gZWxzZSB7CiAgICBzcmMgID0gdHVw
        bGVbMF07CiAgICBrZXkgID0gcGF0aC5zbGljZSgwLCAwLSh0dXBsZVsxXS5s
        ZW5ndGgrMSkpOwogICAgcGF0aCA9IHR1cGxlWzFdOwogIH0KCiAgdHVwbGUu
        bGVuZ3RoID0gMDsKICB0aGlzLmNoYWluKGtleSwgcGF0aCwgc3JjKTsKfTsK
        Ci8vIGNhbGxlZCBvbiB0aGUgcm9vdCBub2RlIG9mIGEgY2hhaW4gdG8gdGVh
        cmRvd24gd2F0Y2hlciBvbiB0aGUgc3BlY2lmaWVkCi8vIHBhdGgKQ2hhaW5O
        b2RlUHJvdG90eXBlLnJlbW92ZSA9IGZ1bmN0aW9uKHBhdGgpIHsKICB2YXIg
        b2JqLCB0dXBsZSwga2V5LCBzcmMsIHBhdGhzOwoKICBwYXRocyA9IHRoaXMu
        X3BhdGhzOwogIGlmIChwYXRoc1twYXRoXSA+IDApIHsgcGF0aHNbcGF0aF0t
        LTsgfQoKICBvYmogPSB0aGlzLnZhbHVlKCk7CiAgdHVwbGUgPSBub3JtYWxp
        emVUdXBsZShvYmosIHBhdGgpOwogIGlmICh0dXBsZVswXSA9PT0gb2JqKSB7
        CiAgICBwYXRoID0gdHVwbGVbMV07CiAgICBrZXkgID0gZmlyc3RLZXkocGF0
        aCk7CiAgICBwYXRoID0gcGF0aC5zbGljZShrZXkubGVuZ3RoKzEpOwogIH0g
        ZWxzZSB7CiAgICBzcmMgID0gdHVwbGVbMF07CiAgICBrZXkgID0gcGF0aC5z
        bGljZSgwLCAwLSh0dXBsZVsxXS5sZW5ndGgrMSkpOwogICAgcGF0aCA9IHR1
        cGxlWzFdOwogIH0KCiAgdHVwbGUubGVuZ3RoID0gMDsKICB0aGlzLnVuY2hh
        aW4oa2V5LCBwYXRoKTsKfTsKCkNoYWluTm9kZVByb3RvdHlwZS5jb3VudCA9
        IDA7CgpDaGFpbk5vZGVQcm90b3R5cGUuY2hhaW4gPSBmdW5jdGlvbihrZXks
        IHBhdGgsIHNyYykgewogIHZhciBjaGFpbnMgPSB0aGlzLl9jaGFpbnMsIG5v
        ZGU7CiAgaWYgKCFjaGFpbnMpIHsgY2hhaW5zID0gdGhpcy5fY2hhaW5zID0g
        e307IH0KCiAgbm9kZSA9IGNoYWluc1trZXldOwogIGlmICghbm9kZSkgeyBu
        b2RlID0gY2hhaW5zW2tleV0gPSBuZXcgQ2hhaW5Ob2RlKHRoaXMsIGtleSwg
        c3JjKTsgfQogIG5vZGUuY291bnQrKzsgLy8gY291bnQgY2hhaW5zLi4uCgog
        IC8vIGNoYWluIHJlc3Qgb2YgcGF0aCBpZiB0aGVyZSBpcyBvbmUKICBpZiAo
        cGF0aCAmJiBwYXRoLmxlbmd0aD4wKSB7CiAgICBrZXkgPSBmaXJzdEtleShw
        YXRoKTsKICAgIHBhdGggPSBwYXRoLnNsaWNlKGtleS5sZW5ndGgrMSk7CiAg
        ICBub2RlLmNoYWluKGtleSwgcGF0aCk7IC8vIE5PVEU6IG5vIHNyYyBtZWFu
        cyBpdCB3aWxsIG9ic2VydmUgY2hhbmdlcy4uLgogIH0KfTsKCkNoYWluTm9k
        ZVByb3RvdHlwZS51bmNoYWluID0gZnVuY3Rpb24oa2V5LCBwYXRoKSB7CiAg
        dmFyIGNoYWlucyA9IHRoaXMuX2NoYWlucywgbm9kZSA9IGNoYWluc1trZXld
        OwoKICAvLyB1bmNoYWluIHJlc3Qgb2YgcGF0aCBmaXJzdC4uLgogIGlmIChw
        YXRoICYmIHBhdGgubGVuZ3RoPjEpIHsKICAgIGtleSAgPSBmaXJzdEtleShw
        YXRoKTsKICAgIHBhdGggPSBwYXRoLnNsaWNlKGtleS5sZW5ndGgrMSk7CiAg
        ICBub2RlLnVuY2hhaW4oa2V5LCBwYXRoKTsKICB9CgogIC8vIGRlbGV0ZSBu
        b2RlIGlmIG5lZWRlZC4KICBub2RlLmNvdW50LS07CiAgaWYgKG5vZGUuY291
        bnQ8PTApIHsKICAgIGRlbGV0ZSBjaGFpbnNbbm9kZS5fa2V5XTsKICAgIG5v
        ZGUuZGVzdHJveSgpOwogIH0KCn07CgpDaGFpbk5vZGVQcm90b3R5cGUud2ls
        bENoYW5nZSA9IGZ1bmN0aW9uKGV2ZW50cykgewogIHZhciBjaGFpbnMgPSB0
        aGlzLl9jaGFpbnM7CiAgaWYgKGNoYWlucykgewogICAgZm9yKHZhciBrZXkg
        aW4gY2hhaW5zKSB7CiAgICAgIGlmICghY2hhaW5zLmhhc093blByb3BlcnR5
        KGtleSkpIHsgY29udGludWU7IH0KICAgICAgY2hhaW5zW2tleV0ud2lsbENo
        YW5nZShldmVudHMpOwogICAgfQogIH0KCiAgaWYgKHRoaXMuX3BhcmVudCkg
        eyB0aGlzLl9wYXJlbnQuY2hhaW5XaWxsQ2hhbmdlKHRoaXMsIHRoaXMuX2tl
        eSwgMSwgZXZlbnRzKTsgfQp9OwoKQ2hhaW5Ob2RlUHJvdG90eXBlLmNoYWlu
        V2lsbENoYW5nZSA9IGZ1bmN0aW9uKGNoYWluLCBwYXRoLCBkZXB0aCwgZXZl
        bnRzKSB7CiAgaWYgKHRoaXMuX2tleSkgeyBwYXRoID0gdGhpcy5fa2V5ICsg
        Jy4nICsgcGF0aDsgfQoKICBpZiAodGhpcy5fcGFyZW50KSB7CiAgICB0aGlz
        Ll9wYXJlbnQuY2hhaW5XaWxsQ2hhbmdlKHRoaXMsIHBhdGgsIGRlcHRoKzEs
        IGV2ZW50cyk7CiAgfSBlbHNlIHsKICAgIGlmIChkZXB0aCA+IDEpIHsKICAg
        ICAgZXZlbnRzLnB1c2godGhpcy52YWx1ZSgpLCBwYXRoKTsKICAgIH0KICAg
        IHBhdGggPSAndGhpcy4nICsgcGF0aDsKICAgIGlmICh0aGlzLl9wYXRoc1tw
        YXRoXSA+IDApIHsKICAgICAgZXZlbnRzLnB1c2godGhpcy52YWx1ZSgpLCBw
        YXRoKTsKICAgIH0KICB9Cn07CgpDaGFpbk5vZGVQcm90b3R5cGUuY2hhaW5E
        aWRDaGFuZ2UgPSBmdW5jdGlvbihjaGFpbiwgcGF0aCwgZGVwdGgsIGV2ZW50
        cykgewogIGlmICh0aGlzLl9rZXkpIHsgcGF0aCA9IHRoaXMuX2tleSArICcu
        JyArIHBhdGg7IH0KICBpZiAodGhpcy5fcGFyZW50KSB7CiAgICB0aGlzLl9w
        YXJlbnQuY2hhaW5EaWRDaGFuZ2UodGhpcywgcGF0aCwgZGVwdGgrMSwgZXZl
        bnRzKTsKICB9IGVsc2UgewogICAgaWYgKGRlcHRoID4gMSkgewogICAgICBl
        dmVudHMucHVzaCh0aGlzLnZhbHVlKCksIHBhdGgpOwogICAgfQogICAgcGF0
        aCA9ICd0aGlzLicgKyBwYXRoOwogICAgaWYgKHRoaXMuX3BhdGhzW3BhdGhd
        ID4gMCkgewogICAgICBldmVudHMucHVzaCh0aGlzLnZhbHVlKCksIHBhdGgp
        OwogICAgfQogIH0KfTsKCkNoYWluTm9kZVByb3RvdHlwZS5kaWRDaGFuZ2Ug
        PSBmdW5jdGlvbihldmVudHMpIHsKICAvLyBpbnZhbGlkYXRlIG15IG93biB2
        YWx1ZSBmaXJzdC4KICBpZiAodGhpcy5fd2F0Y2hpbmcpIHsKICAgIHZhciBv
        YmogPSB0aGlzLl9wYXJlbnQudmFsdWUoKTsKICAgIGlmIChvYmogIT09IHRo
        aXMuX29iamVjdCkgewogICAgICByZW1vdmVDaGFpbldhdGNoZXIodGhpcy5f
        b2JqZWN0LCB0aGlzLl9rZXksIHRoaXMpOwogICAgICB0aGlzLl9vYmplY3Qg
        PSBvYmo7CiAgICAgIGFkZENoYWluV2F0Y2hlcihvYmosIHRoaXMuX2tleSwg
        dGhpcyk7CiAgICB9CiAgICB0aGlzLl92YWx1ZSAgPSB1bmRlZmluZWQ7Cgog
        ICAgLy8gU3BlY2lhbC1jYXNlOiB0aGUgRWFjaFByb3h5IHJlbGllcyBvbiBp
        bW1lZGlhdGUgZXZhbHVhdGlvbiB0bwogICAgLy8gZXN0YWJsaXNoIGl0cyBv
        YnNlcnZlcnMuCiAgICBpZiAodGhpcy5fcGFyZW50ICYmIHRoaXMuX3BhcmVu
        dC5fa2V5ID09PSAnQGVhY2gnKQogICAgICB0aGlzLnZhbHVlKCk7CiAgfQoK
        ICAvLyB0aGVuIG5vdGlmeSBjaGFpbnMuLi4KICB2YXIgY2hhaW5zID0gdGhp
        cy5fY2hhaW5zOwogIGlmIChjaGFpbnMpIHsKICAgIGZvcih2YXIga2V5IGlu
        IGNoYWlucykgewogICAgICBpZiAoIWNoYWlucy5oYXNPd25Qcm9wZXJ0eShr
        ZXkpKSB7IGNvbnRpbnVlOyB9CiAgICAgIGNoYWluc1trZXldLmRpZENoYW5n
        ZShldmVudHMpOwogICAgfQogIH0KCiAgLy8gaWYgbm8gZXZlbnRzIGFyZSBw
        YXNzZWQgaW4gdGhlbiB3ZSBvbmx5IGNhcmUgYWJvdXQgdGhlIGFib3ZlIHdp
        cmluZyB1cGRhdGUKICBpZiAoZXZlbnRzID09PSBudWxsKSB7IHJldHVybjsg
        fQoKICAvLyBhbmQgZmluYWxseSB0ZWxsIHBhcmVudCBhYm91dCBteSBwYXRo
        IGNoYW5naW5nLi4uCiAgaWYgKHRoaXMuX3BhcmVudCkgeyB0aGlzLl9wYXJl
        bnQuY2hhaW5EaWRDaGFuZ2UodGhpcywgdGhpcy5fa2V5LCAxLCBldmVudHMp
        OyB9Cn07CgpFbWJlci5maW5pc2hDaGFpbnMgPSBmdW5jdGlvbihvYmopIHsK
        ICB2YXIgbSA9IG1ldGFGb3Iob2JqLCBmYWxzZSksIGNoYWlucyA9IG0uY2hh
        aW5zOwogIGlmIChjaGFpbnMpIHsKICAgIGlmIChjaGFpbnMudmFsdWUoKSAh
        PT0gb2JqKSB7CiAgICAgIG0uY2hhaW5zID0gY2hhaW5zID0gY2hhaW5zLmNv
        cHkob2JqKTsKICAgIH0KICAgIGNoYWlucy5kaWRDaGFuZ2UobnVsbCk7CiAg
        fQp9OwoKfSkoKTsKCgoKKGZ1bmN0aW9uKCkgewp2YXIgbWV0YUZvciA9IEVt
        YmVyLm1ldGEsIC8vIHV0aWxzLmpzCiAgICB0eXBlT2YgPSBFbWJlci50eXBl
        T2YsIC8vIHV0aWxzLmpzCiAgICBDaGFpbk5vZGUgPSBFbWJlci5fQ2hhaW5O
        b2RlOyAvLyBjaGFpbnMuanMKCi8vIGdldCB0aGUgY2hhaW5zIGZvciB0aGUg
        Y3VycmVudCBvYmplY3QuIElmIHRoZSBjdXJyZW50IG9iamVjdCBoYXMKLy8g
        Y2hhaW5zIGluaGVyaXRlZCBmcm9tIHRoZSBwcm90byB0aGV5IHdpbGwgYmUg
        Y2xvbmVkIGFuZCByZWNvbmZpZ3VyZWQgZm9yCi8vIHRoZSBjdXJyZW50IG9i
        amVjdC4KZnVuY3Rpb24gY2hhaW5zRm9yKG9iaikgewogIHZhciBtID0gbWV0
        YUZvcihvYmopLCByZXQgPSBtLmNoYWluczsKICBpZiAoIXJldCkgewogICAg
        cmV0ID0gbS5jaGFpbnMgPSBuZXcgQ2hhaW5Ob2RlKG51bGwsIG51bGwsIG9i
        aik7CiAgfSBlbHNlIGlmIChyZXQudmFsdWUoKSAhPT0gb2JqKSB7CiAgICBy
        ZXQgPSBtLmNoYWlucyA9IHJldC5jb3B5KG9iaik7CiAgfQogIHJldHVybiBy
        ZXQ7Cn0KCkVtYmVyLndhdGNoUGF0aCA9IGZ1bmN0aW9uKG9iaiwga2V5UGF0
        aCkgewogIC8vIGNhbid0IHdhdGNoIGxlbmd0aCBvbiBBcnJheSAtIGl0IGlz
        IHNwZWNpYWwuLi4KICBpZiAoa2V5UGF0aCA9PT0gJ2xlbmd0aCcgJiYgdHlw
        ZU9mKG9iaikgPT09ICdhcnJheScpIHsgcmV0dXJuOyB9CgogIHZhciBtID0g
        bWV0YUZvcihvYmopLCB3YXRjaGluZyA9IG0ud2F0Y2hpbmc7CgogIGlmICgh
        d2F0Y2hpbmdba2V5UGF0aF0pIHsgLy8gYWN0aXZhdGUgd2F0Y2hpbmcgZmly
        c3QgdGltZQogICAgd2F0Y2hpbmdba2V5UGF0aF0gPSAxOwogICAgY2hhaW5z
        Rm9yKG9iaikuYWRkKGtleVBhdGgpOwogIH0gZWxzZSB7CiAgICB3YXRjaGlu
        Z1trZXlQYXRoXSA9ICh3YXRjaGluZ1trZXlQYXRoXSB8fCAwKSArIDE7CiAg
        fQp9OwoKRW1iZXIudW53YXRjaFBhdGggPSBmdW5jdGlvbihvYmosIGtleVBh
        dGgpIHsKICB2YXIgbSA9IG1ldGFGb3Iob2JqKSwgd2F0Y2hpbmcgPSBtLndh
        dGNoaW5nOwoKICBpZiAod2F0Y2hpbmdba2V5UGF0aF0gPT09IDEpIHsKICAg
        IHdhdGNoaW5nW2tleVBhdGhdID0gMDsKICAgIGNoYWluc0ZvcihvYmopLnJl
        bW92ZShrZXlQYXRoKTsKICB9IGVsc2UgaWYgKHdhdGNoaW5nW2tleVBhdGhd
        ID4gMSkgewogICAgd2F0Y2hpbmdba2V5UGF0aF0tLTsKICB9Cn07Cn0pKCk7
        CgoKCihmdW5jdGlvbigpIHsKLyoqCkBtb2R1bGUgZW1iZXItbWV0YWwKKi8K
        CnZhciBtZXRhRm9yID0gRW1iZXIubWV0YSwgLy8gdXRpbHMuanMKICAgIEdV
        SURfS0VZID0gRW1iZXIuR1VJRF9LRVksIC8vIHV0aWxzLmpzCiAgICBNRVRB
        X0tFWSA9IEVtYmVyLk1FVEFfS0VZLCAvLyB1dGlscy5qcwogICAgcmVtb3Zl
        Q2hhaW5XYXRjaGVyID0gRW1iZXIucmVtb3ZlQ2hhaW5XYXRjaGVyLAogICAg
        d2F0Y2hLZXkgPSBFbWJlci53YXRjaEtleSwgLy8gd2F0Y2hfa2V5LmpzCiAg
        ICB1bndhdGNoS2V5ID0gRW1iZXIudW53YXRjaEtleSwKICAgIHdhdGNoUGF0
        aCA9IEVtYmVyLndhdGNoUGF0aCwgLy8gd2F0Y2hfcGF0aC5qcwogICAgdW53
        YXRjaFBhdGggPSBFbWJlci51bndhdGNoUGF0aCwKICAgIHR5cGVPZiA9IEVt
        YmVyLnR5cGVPZiwgLy8gdXRpbHMuanMKICAgIGdlbmVyYXRlR3VpZCA9IEVt
        YmVyLmdlbmVyYXRlR3VpZCwKICAgIElTX1BBVEggPSAvW1wuXCpdLzsKCi8v
        IHJldHVybnMgdHJ1ZSBpZiB0aGUgcGFzc2VkIHBhdGggaXMganVzdCBhIGtl
        eU5hbWUKZnVuY3Rpb24gaXNLZXlOYW1lKHBhdGgpIHsKICByZXR1cm4gcGF0
        aD09PScqJyB8fCAhSVNfUEFUSC50ZXN0KHBhdGgpOwp9CgovKioKICBAcHJp
        dmF0ZQoKICBTdGFydHMgd2F0Y2hpbmcgYSBwcm9wZXJ0eSBvbiBhbiBvYmpl
        Y3QuIFdoZW5ldmVyIHRoZSBwcm9wZXJ0eSBjaGFuZ2VzLAogIGludm9rZXMg
        YEVtYmVyLnByb3BlcnR5V2lsbENoYW5nZWAgYW5kIGBFbWJlci5wcm9wZXJ0
        eURpZENoYW5nZWAuIFRoaXMgaXMgdGhlCiAgcHJpbWl0aXZlIHVzZWQgYnkg
        b2JzZXJ2ZXJzIGFuZCBkZXBlbmRlbnQga2V5czsgdXN1YWxseSB5b3Ugd2ls
        bCBuZXZlciBjYWxsCiAgdGhpcyBtZXRob2QgZGlyZWN0bHkgYnV0IGluc3Rl
        YWQgdXNlIGhpZ2hlciBsZXZlbCBtZXRob2RzIGxpa2UKICBgRW1iZXIuYWRk
        T2JzZXJ2ZXIoKWAKCiAgQG1ldGhvZCB3YXRjaAogIEBmb3IgRW1iZXIKICBA
        cGFyYW0gb2JqCiAgQHBhcmFtIHtTdHJpbmd9IGtleU5hbWUKKi8KRW1iZXIu
        d2F0Y2ggPSBmdW5jdGlvbihvYmosIGtleVBhdGgpIHsKICAvLyBjYW4ndCB3
        YXRjaCBsZW5ndGggb24gQXJyYXkgLSBpdCBpcyBzcGVjaWFsLi4uCiAgaWYg
        KGtleVBhdGggPT09ICdsZW5ndGgnICYmIHR5cGVPZihvYmopID09PSAnYXJy
        YXknKSB7IHJldHVybjsgfQoKICBpZiAoaXNLZXlOYW1lKGtleVBhdGgpKSB7
        CiAgICB3YXRjaEtleShvYmosIGtleVBhdGgpOwogIH0gZWxzZSB7CiAgICB3
        YXRjaFBhdGgob2JqLCBrZXlQYXRoKTsKICB9Cn07CgpFbWJlci5pc1dhdGNo
        aW5nID0gZnVuY3Rpb24gaXNXYXRjaGluZyhvYmosIGtleSkgewogIHZhciBt
        ZXRhID0gb2JqW01FVEFfS0VZXTsKICByZXR1cm4gKG1ldGEgJiYgbWV0YS53
        YXRjaGluZ1trZXldKSA+IDA7Cn07CgpFbWJlci53YXRjaC5mbHVzaFBlbmRp
        bmcgPSBFbWJlci5mbHVzaFBlbmRpbmdDaGFpbnM7CgpFbWJlci51bndhdGNo
        ID0gZnVuY3Rpb24ob2JqLCBrZXlQYXRoKSB7CiAgLy8gY2FuJ3Qgd2F0Y2gg
        bGVuZ3RoIG9uIEFycmF5IC0gaXQgaXMgc3BlY2lhbC4uLgogIGlmIChrZXlQ
        YXRoID09PSAnbGVuZ3RoJyAmJiB0eXBlT2Yob2JqKSA9PT0gJ2FycmF5Jykg
        eyByZXR1cm47IH0KCiAgaWYgKGlzS2V5TmFtZShrZXlQYXRoKSkgewogICAg
        dW53YXRjaEtleShvYmosIGtleVBhdGgpOwogIH0gZWxzZSB7CiAgICB1bndh
        dGNoUGF0aChvYmosIGtleVBhdGgpOwogIH0KfTsKCi8qKgogIEBwcml2YXRl
        CgogIENhbGwgb24gYW4gb2JqZWN0IHdoZW4geW91IGZpcnN0IGJlZ2V0IGl0
        IGZyb20gYW5vdGhlciBvYmplY3QuIFRoaXMgd2lsbAogIHNldHVwIGFueSBj
        aGFpbmVkIHdhdGNoZXJzIG9uIHRoZSBvYmplY3QgaW5zdGFuY2UgYXMgbmVl
        ZGVkLiBUaGlzIG1ldGhvZCBpcwogIHNhZmUgdG8gY2FsbCBtdWx0aXBsZSB0
        aW1lcy4KCiAgQG1ldGhvZCByZXdhdGNoCiAgQGZvciBFbWJlcgogIEBwYXJh
        bSBvYmoKKi8KRW1iZXIucmV3YXRjaCA9IGZ1bmN0aW9uKG9iaikgewogIHZh
        ciBtID0gbWV0YUZvcihvYmosIGZhbHNlKSwgY2hhaW5zID0gbS5jaGFpbnM7
        CgogIC8vIG1ha2Ugc3VyZSB0aGUgb2JqZWN0IGhhcyBpdHMgb3duIGd1aWQu
        CiAgaWYgKEdVSURfS0VZIGluIG9iaiAmJiAhb2JqLmhhc093blByb3BlcnR5
        KEdVSURfS0VZKSkgewogICAgZ2VuZXJhdGVHdWlkKG9iaiwgJ2VtYmVyJyk7
        CiAgfQoKICAvLyBtYWtlIHN1cmUgYW55IGNoYWluZWQgd2F0Y2hlcnMgdXBk
        YXRlLgogIGlmIChjaGFpbnMgJiYgY2hhaW5zLnZhbHVlKCkgIT09IG9iaikg
        ewogICAgbS5jaGFpbnMgPSBjaGFpbnMuY29weShvYmopOwogIH0KfTsKCnZh
        ciBOT0RFX1NUQUNLID0gW107CgovKioKICBUZWFycyBkb3duIHRoZSBtZXRh
        IG9uIGFuIG9iamVjdCBzbyB0aGF0IGl0IGNhbiBiZSBnYXJiYWdlIGNvbGxl
        Y3RlZC4KICBNdWx0aXBsZSBjYWxscyB3aWxsIGhhdmUgbm8gZWZmZWN0LgoK
        ICBAbWV0aG9kIGRlc3Ryb3kKICBAZm9yIEVtYmVyCiAgQHBhcmFtIHtPYmpl
        Y3R9IG9iaiAgdGhlIG9iamVjdCB0byBkZXN0cm95CiAgQHJldHVybiB7dm9p
        ZH0KKi8KRW1iZXIuZGVzdHJveSA9IGZ1bmN0aW9uIChvYmopIHsKICB2YXIg
        bWV0YSA9IG9ialtNRVRBX0tFWV0sIG5vZGUsIG5vZGVzLCBrZXksIG5vZGVP
        YmplY3Q7CiAgaWYgKG1ldGEpIHsKICAgIG9ialtNRVRBX0tFWV0gPSBudWxs
        OwogICAgLy8gcmVtb3ZlIGNoYWluV2F0Y2hlcnMgdG8gcmVtb3ZlIGNpcmN1
        bGFyIHJlZmVyZW5jZXMgdGhhdCB3b3VsZCBwcmV2ZW50IEdDCiAgICBub2Rl
        ID0gbWV0YS5jaGFpbnM7CiAgICBpZiAobm9kZSkgewogICAgICBOT0RFX1NU
        QUNLLnB1c2gobm9kZSk7CiAgICAgIC8vIHByb2Nlc3MgdHJlZQogICAgICB3
        aGlsZSAoTk9ERV9TVEFDSy5sZW5ndGggPiAwKSB7CiAgICAgICAgbm9kZSA9
        IE5PREVfU1RBQ0sucG9wKCk7CiAgICAgICAgLy8gcHVzaCBjaGlsZHJlbgog
        ICAgICAgIG5vZGVzID0gbm9kZS5fY2hhaW5zOwogICAgICAgIGlmIChub2Rl
        cykgewogICAgICAgICAgZm9yIChrZXkgaW4gbm9kZXMpIHsKICAgICAgICAg
        ICAgaWYgKG5vZGVzLmhhc093blByb3BlcnR5KGtleSkpIHsKICAgICAgICAg
        ICAgICBOT0RFX1NUQUNLLnB1c2gobm9kZXNba2V5XSk7CiAgICAgICAgICAg
        IH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgLy8gcmVtb3ZlIGNo
        YWluV2F0Y2hlciBpbiBub2RlIG9iamVjdAogICAgICAgIGlmIChub2RlLl93
        YXRjaGluZykgewogICAgICAgICAgbm9kZU9iamVjdCA9IG5vZGUuX29iamVj
        dDsKICAgICAgICAgIGlmIChub2RlT2JqZWN0KSB7CiAgICAgICAgICAgIHJl
        bW92ZUNoYWluV2F0Y2hlcihub2RlT2JqZWN0LCBub2RlLl9rZXksIG5vZGUp
        OwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfQogIH0KfTsK
        Cn0pKCk7CgoKCihmdW5jdGlvbigpIHsKLyoqCkBtb2R1bGUgZW1iZXItbWV0
        YWwKKi8KCkVtYmVyLndhcm4oIlRoZSBDUF9ERUZBVUxUX0NBQ0hFQUJMRSBm
        bGFnIGhhcyBiZWVuIHJlbW92ZWQgYW5kIGNvbXB1dGVkIHByb3BlcnRpZXMg
        YXJlIGFsd2F5cyBjYWNoZWQgYnkgZGVmYXVsdC4gVXNlIGB2b2xhdGlsZWAg
        aWYgeW91IGRvbid0IHdhbnQgY2FjaGluZy4iLCBFbWJlci5FTlYuQ1BfREVG
        QVVMVF9DQUNIRUFCTEUgIT09IGZhbHNlKTsKCgp2YXIgZ2V0ID0gRW1iZXIu
        Z2V0LAogICAgc2V0ID0gRW1iZXIuc2V0LAogICAgbWV0YUZvciA9IEVtYmVy
        Lm1ldGEsCiAgICBhX3NsaWNlID0gW10uc2xpY2UsCiAgICBvX2NyZWF0ZSA9
        IEVtYmVyLmNyZWF0ZSwKICAgIE1FVEFfS0VZID0gRW1iZXIuTUVUQV9LRVks
        CiAgICB3YXRjaCA9IEVtYmVyLndhdGNoLAogICAgdW53YXRjaCA9IEVtYmVy
        LnVud2F0Y2g7CgovLyAuLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4u
        Li4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uCi8vIERFUEVOREVOVCBLRVlT
        Ci8vCgovLyBkYXRhIHN0cnVjdHVyZToKLy8gIG1ldGEuZGVwcyA9IHsKLy8g
        ICAnZGVwS2V5JzogewovLyAgICAgJ2tleU5hbWUnOiBjb3VudCwKLy8gICB9
        Ci8vICB9CgovKgogIFRoaXMgZnVuY3Rpb24gcmV0dXJucyBhIG1hcCBvZiB1
        bmlxdWUgZGVwZW5kZW5jaWVzIGZvciBhCiAgZ2l2ZW4gb2JqZWN0IGFuZCBr
        ZXkuCiovCmZ1bmN0aW9uIGtleXNGb3JEZXAoZGVwc01ldGEsIGRlcEtleSkg
        ewogIHZhciBrZXlzID0gZGVwc01ldGFbZGVwS2V5XTsKICBpZiAoIWtleXMp
        IHsKICAgIC8vIGlmIHRoZXJlIGFyZSBubyBkZXBlbmRlbmNpZXMgeWV0IGZv
        ciBhIHRoZSBnaXZlbiBrZXkKICAgIC8vIGNyZWF0ZSBhIG5ldyBlbXB0eSBs
        aXN0IG9mIGRlcGVuZGVuY2llcyBmb3IgdGhlIGtleQogICAga2V5cyA9IGRl
        cHNNZXRhW2RlcEtleV0gPSB7fTsKICB9IGVsc2UgaWYgKCFkZXBzTWV0YS5o
        YXNPd25Qcm9wZXJ0eShkZXBLZXkpKSB7CiAgICAvLyBvdGhlcndpc2UgaWYg
        dGhlIGRlcGVuZGVuY3kgbGlzdCBpcyBpbmhlcml0ZWQgZnJvbQogICAgLy8g
        YSBzdXBlcmNsYXNzLCBjbG9uZSB0aGUgaGFzaAogICAga2V5cyA9IGRlcHNN
        ZXRhW2RlcEtleV0gPSBvX2NyZWF0ZShrZXlzKTsKICB9CiAgcmV0dXJuIGtl
        eXM7Cn0KCmZ1bmN0aW9uIG1ldGFGb3JEZXBzKG1ldGEpIHsKICByZXR1cm4g
        a2V5c0ZvckRlcChtZXRhLCAnZGVwcycpOwp9CgpmdW5jdGlvbiBhZGREZXBl
        bmRlbnRLZXlzKGRlc2MsIG9iaiwga2V5TmFtZSwgbWV0YSkgewogIC8vIHRo
        ZSBkZXNjcmlwdG9yIGhhcyBhIGxpc3Qgb2YgZGVwZW5kZW50IGtleXMsIHNv
        CiAgLy8gYWRkIGFsbCBvZiBpdHMgZGVwZW5kZW50IGtleXMuCiAgdmFyIGRl
        cEtleXMgPSBkZXNjLl9kZXBlbmRlbnRLZXlzLCBkZXBzTWV0YSwgaWR4LCBs
        ZW4sIGRlcEtleSwga2V5czsKICBpZiAoIWRlcEtleXMpIHJldHVybjsKCiAg
        ZGVwc01ldGEgPSBtZXRhRm9yRGVwcyhtZXRhKTsKCiAgZm9yKGlkeCA9IDAs
        IGxlbiA9IGRlcEtleXMubGVuZ3RoOyBpZHggPCBsZW47IGlkeCsrKSB7CiAg
        ICBkZXBLZXkgPSBkZXBLZXlzW2lkeF07CiAgICAvLyBMb29rdXAga2V5cyBt
        ZXRhIGZvciBkZXBLZXkKICAgIGtleXMgPSBrZXlzRm9yRGVwKGRlcHNNZXRh
        LCBkZXBLZXkpOwogICAgLy8gSW5jcmVtZW50IHRoZSBudW1iZXIgb2YgdGlt
        ZXMgZGVwS2V5IGRlcGVuZHMgb24ga2V5TmFtZS4KICAgIGtleXNba2V5TmFt
        ZV0gPSAoa2V5c1trZXlOYW1lXSB8fCAwKSArIDE7CiAgICAvLyBXYXRjaCB0
        aGUgZGVwS2V5CiAgICB3YXRjaChvYmosIGRlcEtleSk7CiAgfQp9CgpmdW5j
        dGlvbiByZW1vdmVEZXBlbmRlbnRLZXlzKGRlc2MsIG9iaiwga2V5TmFtZSwg
        bWV0YSkgewogIC8vIHRoZSBkZXNjcmlwdG9yIGhhcyBhIGxpc3Qgb2YgZGVw
        ZW5kZW50IGtleXMsIHNvCiAgLy8gYWRkIGFsbCBvZiBpdHMgZGVwZW5kZW50
        IGtleXMuCiAgdmFyIGRlcEtleXMgPSBkZXNjLl9kZXBlbmRlbnRLZXlzLCBk
        ZXBzTWV0YSwgaWR4LCBsZW4sIGRlcEtleSwga2V5czsKICBpZiAoIWRlcEtl
        eXMpIHJldHVybjsKCiAgZGVwc01ldGEgPSBtZXRhRm9yRGVwcyhtZXRhKTsK
        CiAgZm9yKGlkeCA9IDAsIGxlbiA9IGRlcEtleXMubGVuZ3RoOyBpZHggPCBs
        ZW47IGlkeCsrKSB7CiAgICBkZXBLZXkgPSBkZXBLZXlzW2lkeF07CiAgICAv
        LyBMb29rdXAga2V5cyBtZXRhIGZvciBkZXBLZXkKICAgIGtleXMgPSBrZXlz
        Rm9yRGVwKGRlcHNNZXRhLCBkZXBLZXkpOwogICAgLy8gSW5jcmVtZW50IHRo
        ZSBudW1iZXIgb2YgdGltZXMgZGVwS2V5IGRlcGVuZHMgb24ga2V5TmFtZS4K
        ICAgIGtleXNba2V5TmFtZV0gPSAoa2V5c1trZXlOYW1lXSB8fCAwKSAtIDE7
        CiAgICAvLyBXYXRjaCB0aGUgZGVwS2V5CiAgICB1bndhdGNoKG9iaiwgZGVw
        S2V5KTsKICB9Cn0KCi8vIC4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4u
        Li4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4KLy8gQ09NUFVURUQgUFJP
        UEVSVFkKLy8KCi8qKgogIEEgY29tcHV0ZWQgcHJvcGVydHkgdHJhbnNmb3Jt
        cyBhbiBvYmplY3RzIGZ1bmN0aW9uIGludG8gYSBwcm9wZXJ0eS4KCiAgQnkg
        ZGVmYXVsdCB0aGUgZnVuY3Rpb24gYmFja2luZyB0aGUgY29tcHV0ZWQgcHJv
        cGVydHkgd2lsbCBvbmx5IGJlIGNhbGxlZAogIG9uY2UgYW5kIHRoZSByZXN1
        bHQgd2lsbCBiZSBjYWNoZWQuIFlvdSBjYW4gc3BlY2lmeSB2YXJpb3VzIHBy
        b3BlcnRpZXMKICB0aGF0IHlvdXIgY29tcHV0ZWQgcHJvcGVydHkgaXMgZGVw
        ZW5kZW50IG9uLiBUaGlzIHdpbGwgZm9yY2UgdGhlIGNhY2hlZAogIHJlc3Vs
        dCB0byBiZSByZWNvbXB1dGVkIGlmIHRoZSBkZXBlbmRlbmNpZXMgYXJlIG1v
        ZGlmaWVkLgoKICBJbiB0aGUgZm9sbG93aW5nIGV4YW1wbGUgd2UgZGVjbGFy
        ZSBhIGNvbXB1dGVkIHByb3BlcnR5IChieSBjYWxsaW5nCiAgYC5wcm9wZXJ0
        eSgpYCBvbiB0aGUgZnVsbE5hbWUgZnVuY3Rpb24pIGFuZCBzZXR1cCB0aGUg
        cHJvcGVydGllcwogIGRlcGVuZGVuY2llcyAoZGVwZW5kaW5nIG9uIGZpcnN0
        TmFtZSBhbmQgbGFzdE5hbWUpLiBUaGUgZnVsbE5hbWUgZnVuY3Rpb24KICB3
        aWxsIGJlIGNhbGxlZCBvbmNlIChyZWdhcmRsZXNzIG9mIGhvdyBtYW55IHRp
        bWVzIGl0IGlzIGFjY2Vzc2VkKSBhcyBsb25nCiAgYXMgaXQncyBkZXBlbmRl
        bmNpZXMgaGF2ZSBub3QgYmVlbiBjaGFuZ2VkLiBPbmNlIGZpcnN0TmFtZSBv
        ciBsYXN0TmFtZSBhcmUgdXBkYXRlZAogIGFueSBmdXR1cmUgY2FsbHMgKG9y
        IGFueXRoaW5nIGJvdW5kKSB0byBmdWxsTmFtZSB3aWxsIGluY29ycG9yYXRl
        IHRoZSBuZXcKICB2YWx1ZXMuCgogIGBgYGphdmFzY3JpcHQKICBQZXJzb24g
        PSBFbWJlci5PYmplY3QuZXh0ZW5kKHsKICAgIC8vIHRoZXNlIHdpbGwgYmUg
        c3VwcGxpZWQgYnkgYGNyZWF0ZWAKICAgIGZpcnN0TmFtZTogbnVsbCwKICAg
        IGxhc3ROYW1lOiBudWxsLAoKICAgIGZ1bGxOYW1lOiBmdW5jdGlvbigpIHsK
        ICAgICAgdmFyIGZpcnN0TmFtZSA9IHRoaXMuZ2V0KCdmaXJzdE5hbWUnKTsK
        ICAgICAgdmFyIGxhc3ROYW1lID0gdGhpcy5nZXQoJ2xhc3ROYW1lJyk7Cgog
        ICAgIHJldHVybiBmaXJzdE5hbWUgKyAnICcgKyBsYXN0TmFtZTsKICAgIH0u
        cHJvcGVydHkoJ2ZpcnN0TmFtZScsICdsYXN0TmFtZScpCiAgfSk7CgogIHZh
        ciB0b20gPSBQZXJzb24uY3JlYXRlKHsKICAgIGZpcnN0TmFtZTogIlRvbSIs
        CiAgICBsYXN0TmFtZTogIkRhbGUiCiAgfSk7CgogIHRvbS5nZXQoJ2Z1bGxO
        YW1lJykgLy8gIlRvbSBEYWxlIgogIGBgYAoKICBZb3UgY2FuIGFsc28gZGVm
        aW5lIHdoYXQgRW1iZXIgc2hvdWxkIGRvIHdoZW4gc2V0dGluZyBhIGNvbXB1
        dGVkIHByb3BlcnR5LgogIElmIHlvdSB0cnkgdG8gc2V0IGEgY29tcHV0ZWQg
        cHJvcGVydHksIGl0IHdpbGwgYmUgaW52b2tlZCB3aXRoIHRoZSBrZXkgYW5k
        CiAgdmFsdWUgeW91IHdhbnQgdG8gc2V0IGl0IHRvLiBZb3UgY2FuIGFsc28g
        YWNjZXB0IHRoZSBwcmV2aW91cyB2YWx1ZSBhcyB0aGUKICB0aGlyZCBwYXJh
        bWV0ZXIuCgogIGBgYGphdmFzY3JpcHQKCiBQZXJzb24gPSBFbWJlci5PYmpl
        Y3QuZXh0ZW5kKHsKICAgIC8vIHRoZXNlIHdpbGwgYmUgc3VwcGxpZWQgYnkg
        YGNyZWF0ZWAKICAgIGZpcnN0TmFtZTogbnVsbCwKICAgIGxhc3ROYW1lOiBu
        dWxsLAoKICAgIGZ1bGxOYW1lOiBmdW5jdGlvbihrZXksIHZhbHVlLCBvbGRW
        YWx1ZSkgewogICAgICAvLyBnZXR0ZXIKICAgICAgaWYgKGFyZ3VtZW50cy5s
        ZW5ndGggPT09IDEpIHsKICAgICAgICB2YXIgZmlyc3ROYW1lID0gdGhpcy5n
        ZXQoJ2ZpcnN0TmFtZScpOwogICAgICAgIHZhciBsYXN0TmFtZSA9IHRoaXMu
        Z2V0KCdsYXN0TmFtZScpOwoKICAgICAgICByZXR1cm4gZmlyc3ROYW1lICsg
        JyAnICsgbGFzdE5hbWU7CgogICAgICAvLyBzZXR0ZXIKICAgICAgfSBlbHNl
        IHsKICAgICAgICB2YXIgbmFtZSA9IHZhbHVlLnNwbGl0KCIgIik7CgogICAg
        ICAgIHRoaXMuc2V0KCdmaXJzdE5hbWUnLCBuYW1lWzBdKTsKICAgICAgICB0
        aGlzLnNldCgnbGFzdE5hbWUnLCBuYW1lWzFdKTsKCiAgICAgICAgcmV0dXJu
        IHZhbHVlOwogICAgICB9CiAgICB9LnByb3BlcnR5KCdmaXJzdE5hbWUnLCAn
        bGFzdE5hbWUnKQogIH0pOwoKICB2YXIgcGVyc29uID0gUGVyc29uLmNyZWF0
        ZSgpOwogIHBlcnNvbi5zZXQoJ2Z1bGxOYW1lJywgIlBldGVyIFdhZ2VuZXQi
        KTsKICBwZXJzb24uZ2V0KCdmaXJzdE5hbWUnKSAvLyBQZXRlcgogIHBlcnNv
        bi5nZXQoJ2xhc3ROYW1lJykgLy8gV2FnZW5ldAogIGBgYAoKICBAY2xhc3Mg
        Q29tcHV0ZWRQcm9wZXJ0eQogIEBuYW1lc3BhY2UgRW1iZXIKICBAZXh0ZW5k
        cyBFbWJlci5EZXNjcmlwdG9yCiAgQGNvbnN0cnVjdG9yCiovCmZ1bmN0aW9u
        IENvbXB1dGVkUHJvcGVydHkoZnVuYywgb3B0cykgewogIHRoaXMuZnVuYyA9
        IGZ1bmM7CgogIHRoaXMuX2NhY2hlYWJsZSA9IChvcHRzICYmIG9wdHMuY2Fj
        aGVhYmxlICE9PSB1bmRlZmluZWQpID8gb3B0cy5jYWNoZWFibGUgOiB0cnVl
        OwogIHRoaXMuX2RlcGVuZGVudEtleXMgPSBvcHRzICYmIG9wdHMuZGVwZW5k
        ZW50S2V5czsKICB0aGlzLl9yZWFkT25seSA9IG9wdHMgJiYgKG9wdHMucmVh
        ZE9ubHkgIT09IHVuZGVmaW5lZCB8fCAhIW9wdHMucmVhZE9ubHkpOwp9CgpF
        bWJlci5Db21wdXRlZFByb3BlcnR5ID0gQ29tcHV0ZWRQcm9wZXJ0eTsKQ29t
        cHV0ZWRQcm9wZXJ0eS5wcm90b3R5cGUgPSBuZXcgRW1iZXIuRGVzY3JpcHRv
        cigpOwoKdmFyIENvbXB1dGVkUHJvcGVydHlQcm90b3R5cGUgPSBDb21wdXRl
        ZFByb3BlcnR5LnByb3RvdHlwZTsKCi8qKgogIFByb3BlcnRpZXMgYXJlIGNh
        Y2hlYWJsZSBieSBkZWZhdWx0LiBDb21wdXRlZCBwcm9wZXJ0eSB3aWxsIGF1
        dG9tYXRpY2FsbHkKICBjYWNoZSB0aGUgcmV0dXJuIHZhbHVlIG9mIHlvdXIg
        ZnVuY3Rpb24gdW50aWwgb25lIG9mIHRoZSBkZXBlbmRlbnQga2V5cyBjaGFu
        Z2VzLgoKICBDYWxsIGB2b2xhdGlsZSgpYCB0byBzZXQgaXQgaW50byBub24t
        Y2FjaGVkIG1vZGUuIFdoZW4gaW4gdGhpcyBtb2RlCiAgdGhlIGNvbXB1dGVk
        IHByb3BlcnR5IHdpbGwgbm90IGF1dG9tYXRpY2FsbHkgY2FjaGUgdGhlIHJl
        dHVybiB2YWx1ZS4KCiAgSG93ZXZlciwgaWYgYSBwcm9wZXJ0eSBpcyBwcm9w
        ZXJseSBvYnNlcnZhYmxlLCB0aGVyZSBpcyBubyByZWFzb24gdG8gZGlzYWJs
        ZQogIGNhY2hpbmcuCgogIEBtZXRob2QgY2FjaGVhYmxlCiAgQHBhcmFtIHtC
        b29sZWFufSBhRmxhZyBvcHRpb25hbCBzZXQgdG8gYGZhbHNlYCB0byBkaXNh
        YmxlIGNhY2hpbmcKICBAcmV0dXJuIHtFbWJlci5Db21wdXRlZFByb3BlcnR5
        fSB0aGlzCiAgQGNoYWluYWJsZQoqLwpDb21wdXRlZFByb3BlcnR5UHJvdG90
        eXBlLmNhY2hlYWJsZSA9IGZ1bmN0aW9uKGFGbGFnKSB7CiAgdGhpcy5fY2Fj
        aGVhYmxlID0gYUZsYWcgIT09IGZhbHNlOwogIHJldHVybiB0aGlzOwp9OwoK
        LyoqCiAgQ2FsbCBvbiBhIGNvbXB1dGVkIHByb3BlcnR5IHRvIHNldCBpdCBp
        bnRvIG5vbi1jYWNoZWQgbW9kZS4gV2hlbiBpbiB0aGlzCiAgbW9kZSB0aGUg
        Y29tcHV0ZWQgcHJvcGVydHkgd2lsbCBub3QgYXV0b21hdGljYWxseSBjYWNo
        ZSB0aGUgcmV0dXJuIHZhbHVlLgoKICBgYGBqYXZhc2NyaXB0CiAgTXlBcHAu
        b3V0c2lkZVNlcnZpY2UgPSBFbWJlci5PYmplY3QuY3JlYXRlKHsKICAgIHZh
        bHVlOiBmdW5jdGlvbigpIHsKICAgICAgcmV0dXJuIE91dHNpZGVTZXJ2aWNl
        LmdldFZhbHVlKCk7CiAgICB9LnByb3BlcnR5KCkudm9sYXRpbGUoKQogIH0p
        OwogIGBgYAoKICBAbWV0aG9kIHZvbGF0aWxlCiAgQHJldHVybiB7RW1iZXIu
        Q29tcHV0ZWRQcm9wZXJ0eX0gdGhpcwogIEBjaGFpbmFibGUKKi8KQ29tcHV0
        ZWRQcm9wZXJ0eVByb3RvdHlwZS52b2xhdGlsZSA9IGZ1bmN0aW9uKCkgewog
        IHJldHVybiB0aGlzLmNhY2hlYWJsZShmYWxzZSk7Cn07CgovKioKICBDYWxs
        IG9uIGEgY29tcHV0ZWQgcHJvcGVydHkgdG8gc2V0IGl0IGludG8gcmVhZC1v
        bmx5IG1vZGUuIFdoZW4gaW4gdGhpcwogIG1vZGUgdGhlIGNvbXB1dGVkIHBy
        b3BlcnR5IHdpbGwgdGhyb3cgYW4gZXJyb3Igd2hlbiBzZXQuCgogIGBgYGph
        dmFzY3JpcHQKICBNeUFwcC5wZXJzb24gPSBFbWJlci5PYmplY3QuY3JlYXRl
        KHsKICAgIGd1aWQ6IGZ1bmN0aW9uKCkgewogICAgICByZXR1cm4gJ2d1aWQt
        Z3VpZC1ndWlkJzsKICAgIH0ucHJvcGVydHkoKS5yZWFkT25seSgpCiAgfSk7
        CgogIE15QXBwLnBlcnNvbi5zZXQoJ2d1aWQnLCAnbmV3LWd1aWQnKTsgLy8g
        d2lsbCB0aHJvdyBhbiBleGNlcHRpb24KICBgYGAKCiAgQG1ldGhvZCByZWFk
        T25seQogIEByZXR1cm4ge0VtYmVyLkNvbXB1dGVkUHJvcGVydHl9IHRoaXMK
        ICBAY2hhaW5hYmxlCiovCkNvbXB1dGVkUHJvcGVydHlQcm90b3R5cGUucmVh
        ZE9ubHkgPSBmdW5jdGlvbihyZWFkT25seSkgewogIHRoaXMuX3JlYWRPbmx5
        ID0gcmVhZE9ubHkgPT09IHVuZGVmaW5lZCB8fCAhIXJlYWRPbmx5OwogIHJl
        dHVybiB0aGlzOwp9OwoKLyoqCiAgU2V0cyB0aGUgZGVwZW5kZW50IGtleXMg
        b24gdGhpcyBjb21wdXRlZCBwcm9wZXJ0eS4gUGFzcyBhbnkgbnVtYmVyIG9m
        CiAgYXJndW1lbnRzIGNvbnRhaW5pbmcga2V5IHBhdGhzIHRoYXQgdGhpcyBj
        b21wdXRlZCBwcm9wZXJ0eSBkZXBlbmRzIG9uLgoKICBgYGBqYXZhc2NyaXB0
        CiAgTXlBcHAucHJlc2lkZW50ID0gRW1iZXIuT2JqZWN0LmNyZWF0ZSh7CiAg
        ICBmdWxsTmFtZTogRW1iZXIuY29tcHV0ZWQoZnVuY3Rpb24oKSB7CiAgICAg
        IHJldHVybiB0aGlzLmdldCgnZmlyc3ROYW1lJykgKyAnICcgKyB0aGlzLmdl
        dCgnbGFzdE5hbWUnKTsKCiAgICAgIC8vIFRlbGwgRW1iZXIgdGhhdCB0aGlz
        IGNvbXB1dGVkIHByb3BlcnR5IGRlcGVuZHMgb24gZmlyc3ROYW1lCiAgICAg
        IC8vIGFuZCBsYXN0TmFtZQogICAgfSkucHJvcGVydHkoJ2ZpcnN0TmFtZScs
        ICdsYXN0TmFtZScpCiAgfSk7CiAgYGBgCgogIEBtZXRob2QgcHJvcGVydHkK
        ICBAcGFyYW0ge1N0cmluZ30gcGF0aCogemVybyBvciBtb3JlIHByb3BlcnR5
        IHBhdGhzCiAgQHJldHVybiB7RW1iZXIuQ29tcHV0ZWRQcm9wZXJ0eX0gdGhp
        cwogIEBjaGFpbmFibGUKKi8KQ29tcHV0ZWRQcm9wZXJ0eVByb3RvdHlwZS5w
        cm9wZXJ0eSA9IGZ1bmN0aW9uKCkgewogIHZhciBhcmdzID0gW107CiAgZm9y
        ICh2YXIgaSA9IDAsIGwgPSBhcmd1bWVudHMubGVuZ3RoOyBpIDwgbDsgaSsr
        KSB7CiAgICBhcmdzLnB1c2goYXJndW1lbnRzW2ldKTsKICB9CiAgdGhpcy5f
        ZGVwZW5kZW50S2V5cyA9IGFyZ3M7CiAgcmV0dXJuIHRoaXM7Cn07CgovKioK
        ICBJbiBzb21lIGNhc2VzLCB5b3UgbWF5IHdhbnQgdG8gYW5ub3RhdGUgY29t
        cHV0ZWQgcHJvcGVydGllcyB3aXRoIGFkZGl0aW9uYWwKICBtZXRhZGF0YSBh
        Ym91dCBob3cgdGhleSBmdW5jdGlvbiBvciB3aGF0IHZhbHVlcyB0aGV5IG9w
        ZXJhdGUgb24uIEZvciBleGFtcGxlLAogIGNvbXB1dGVkIHByb3BlcnR5IGZ1
        bmN0aW9ucyBtYXkgY2xvc2Ugb3ZlciB2YXJpYWJsZXMgdGhhdCBhcmUgdGhl
        biBubyBsb25nZXIKICBhdmFpbGFibGUgZm9yIGludHJvc3BlY3Rpb24uCgog
        IFlvdSBjYW4gcGFzcyBhIGhhc2ggb2YgdGhlc2UgdmFsdWVzIHRvIGEgY29t
        cHV0ZWQgcHJvcGVydHkgbGlrZSB0aGlzOgoKICBgYGAKICBwZXJzb246IGZ1
        bmN0aW9uKCkgewogICAgdmFyIHBlcnNvbklkID0gdGhpcy5nZXQoJ3BlcnNv
        bklkJyk7CiAgICByZXR1cm4gQXBwLlBlcnNvbi5jcmVhdGUoeyBpZDogcGVy
        c29uSWQgfSk7CiAgfS5wcm9wZXJ0eSgpLm1ldGEoeyB0eXBlOiBBcHAuUGVy
        c29uIH0pCiAgYGBgCgogIFRoZSBoYXNoIHRoYXQgeW91IHBhc3MgdG8gdGhl
        IGBtZXRhKClgIGZ1bmN0aW9uIHdpbGwgYmUgc2F2ZWQgb24gdGhlCiAgY29t
        cHV0ZWQgcHJvcGVydHkgZGVzY3JpcHRvciB1bmRlciB0aGUgYF9tZXRhYCBr
        ZXkuIEVtYmVyIHJ1bnRpbWUKICBleHBvc2VzIGEgcHVibGljIEFQSSBmb3Ig
        cmV0cmlldmluZyB0aGVzZSB2YWx1ZXMgZnJvbSBjbGFzc2VzLAogIHZpYSB0
        aGUgYG1ldGFGb3JQcm9wZXJ0eSgpYCBmdW5jdGlvbi4KCiAgQG1ldGhvZCBt
        ZXRhCiAgQHBhcmFtIHtIYXNofSBtZXRhCiAgQGNoYWluYWJsZQoqLwoKQ29t
        cHV0ZWRQcm9wZXJ0eVByb3RvdHlwZS5tZXRhID0gZnVuY3Rpb24obWV0YSkg
        ewogIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAwKSB7CiAgICByZXR1cm4g
        dGhpcy5fbWV0YSB8fCB7fTsKICB9IGVsc2UgewogICAgdGhpcy5fbWV0YSA9
        IG1ldGE7CiAgICByZXR1cm4gdGhpczsKICB9Cn07CgovKiBpbXBsIGRlc2Ny
        aXB0b3IgQVBJICovCkNvbXB1dGVkUHJvcGVydHlQcm90b3R5cGUuZGlkQ2hh
        bmdlID0gZnVuY3Rpb24ob2JqLCBrZXlOYW1lKSB7CiAgLy8gX3N1c3BlbmRl
        ZCBpcyBzZXQgdmlhIGEgQ1Auc2V0IHRvIGVuc3VyZSB3ZSBkb24ndCBjbGVh
        cgogIC8vIHRoZSBjYWNoZWQgdmFsdWUgc2V0IGJ5IHRoZSBzZXR0ZXIKICBp
        ZiAodGhpcy5fY2FjaGVhYmxlICYmIHRoaXMuX3N1c3BlbmRlZCAhPT0gb2Jq
        KSB7CiAgICB2YXIgbWV0YSA9IG1ldGFGb3Iob2JqKTsKICAgIGlmIChrZXlO
        YW1lIGluIG1ldGEuY2FjaGUpIHsKICAgICAgZGVsZXRlIG1ldGEuY2FjaGVb
        a2V5TmFtZV07CiAgICAgIHJlbW92ZURlcGVuZGVudEtleXModGhpcywgb2Jq
        LCBrZXlOYW1lLCBtZXRhKTsKICAgIH0KICB9Cn07CgpmdW5jdGlvbiBmaW5p
        c2hDaGFpbnMoY2hhaW5Ob2RlcykKewogIGZvciAodmFyIGk9MCwgbD1jaGFp
        bk5vZGVzLmxlbmd0aDsgaTxsOyBpKyspIHsKICAgIGNoYWluTm9kZXNbaV0u
        ZGlkQ2hhbmdlKG51bGwpOwogIH0KfQoKLyoqCiAgQWNjZXNzIHRoZSB2YWx1
        ZSBvZiB0aGUgZnVuY3Rpb24gYmFja2luZyB0aGUgY29tcHV0ZWQgcHJvcGVy
        dHkuCiAgSWYgdGhpcyBwcm9wZXJ0eSBoYXMgYWxyZWFkeSBiZWVuIGNhY2hl
        ZCwgcmV0dXJuIHRoZSBjYWNoZWQgcmVzdWx0LgogIE90aGVyd2lzZSwgY2Fs
        bCB0aGUgZnVuY3Rpb24gcGFzc2luZyB0aGUgcHJvcGVydHkgbmFtZSBhcyBh
        biBhcmd1bWVudC4KCiAgYGBgamF2YXNjcmlwdAogIFBlcnNvbiA9IEVtYmVy
        Lk9iamVjdC5leHRlbmQoewogICAgZnVsbE5hbWU6IGZ1bmN0aW9uKGtleU5h
        bWUpIHsKICAgICAgLy8gdGhlIGtleU5hbWUgcGFyYW1ldGVyIGlzICdmdWxs
        TmFtZScgaW4gdGhpcyBjYXNlLgoKICAgICAgcmV0dXJuIHRoaXMuZ2V0KCdm
        aXJzdE5hbWUnKSArICcgJyArIHRoaXMuZ2V0KCdsYXN0TmFtZScpOwogICAg
        fS5wcm9wZXJ0eSgnZmlyc3ROYW1lJywgJ2xhc3ROYW1lJykKICB9KTsKCgog
        IHZhciB0b20gPSBQZXJzb24uY3JlYXRlKHsKICAgIGZpcnN0TmFtZTogIlRv
        bSIsCiAgICBsYXN0TmFtZTogIkRhbGUiCiAgfSk7CgogIHRvbS5nZXQoJ2Z1
        bGxOYW1lJykgLy8gIlRvbSBEYWxlIgogIGBgYAoKICBAbWV0aG9kIGdldAog
        IEBwYXJhbSB7U3RyaW5nfSBrZXlOYW1lIFRoZSBrZXkgYmVpbmcgYWNjZXNz
        ZWQuCiAgQHJldHVybiB7T2JqZWN0fSBUaGUgcmV0dXJuIHZhbHVlIG9mIHRo
        ZSBmdW5jdGlvbiBiYWNraW5nIHRoZSBDUC4KKi8KQ29tcHV0ZWRQcm9wZXJ0
        eVByb3RvdHlwZS5nZXQgPSBmdW5jdGlvbihvYmosIGtleU5hbWUpIHsKICB2
        YXIgcmV0LCBjYWNoZSwgbWV0YSwgY2hhaW5Ob2RlczsKICBpZiAodGhpcy5f
        Y2FjaGVhYmxlKSB7CiAgICBtZXRhID0gbWV0YUZvcihvYmopOwogICAgY2Fj
        aGUgPSBtZXRhLmNhY2hlOwogICAgaWYgKGtleU5hbWUgaW4gY2FjaGUpIHsg
        cmV0dXJuIGNhY2hlW2tleU5hbWVdOyB9CiAgICByZXQgPSBjYWNoZVtrZXlO
        YW1lXSA9IHRoaXMuZnVuYy5jYWxsKG9iaiwga2V5TmFtZSk7CiAgICBjaGFp
        bk5vZGVzID0gbWV0YS5jaGFpbldhdGNoZXJzICYmIG1ldGEuY2hhaW5XYXRj
        aGVyc1trZXlOYW1lXTsKICAgIGlmIChjaGFpbk5vZGVzKSB7IGZpbmlzaENo
        YWlucyhjaGFpbk5vZGVzKTsgfQogICAgYWRkRGVwZW5kZW50S2V5cyh0aGlz
        LCBvYmosIGtleU5hbWUsIG1ldGEpOwogIH0gZWxzZSB7CiAgICByZXQgPSB0
        aGlzLmZ1bmMuY2FsbChvYmosIGtleU5hbWUpOwogIH0KICByZXR1cm4gcmV0
        Owp9OwoKLyoqCiAgU2V0IHRoZSB2YWx1ZSBvZiBhIGNvbXB1dGVkIHByb3Bl
        cnR5LiBJZiB0aGUgZnVuY3Rpb24gdGhhdCBiYWNrcyB5b3VyCiAgY29tcHV0
        ZWQgcHJvcGVydHkgZG9lcyBub3QgYWNjZXB0IGFyZ3VtZW50cyB0aGVuIHRo
        ZSBkZWZhdWx0IGFjdGlvbiBmb3IKICBzZXR0aW5nIHdvdWxkIGJlIHRvIGRl
        ZmluZSB0aGUgcHJvcGVydHkgb24gdGhlIGN1cnJlbnQgb2JqZWN0LCBhbmQg
        c2V0CiAgdGhlIHZhbHVlIG9mIHRoZSBwcm9wZXJ0eSB0byB0aGUgdmFsdWUg
        YmVpbmcgc2V0LgoKICBHZW5lcmFsbHkgc3BlYWtpbmcgaWYgeW91IGludGVu
        ZCBmb3IgeW91ciBjb21wdXRlZCBwcm9wZXJ0eSB0byBiZSBzZXQKICB5b3Vy
        IGJhY2tpbmcgZnVuY3Rpb24gc2hvdWxkIGFjY2VwdCBlaXRoZXIgdHdvIG9y
        IHRocmVlIGFyZ3VtZW50cy4KCiAgQG1ldGhvZCBzZXQKICBAcGFyYW0ge1N0
        cmluZ30ga2V5TmFtZSBUaGUga2V5IGJlaW5nIGFjY2Vzc2VkLgogIEBwYXJh
        bSB7T2JqZWN0fSBuZXdWYWx1ZSBUaGUgbmV3IHZhbHVlIGJlaW5nIGFzc2ln
        bmVkLgogIEBwYXJhbSB7U3RyaW5nfSBvbGRWYWx1ZSBUaGUgb2xkIHZhbHVl
        IGJlaW5nIHJlcGxhY2VkLgogIEByZXR1cm4ge09iamVjdH0gVGhlIHJldHVy
        biB2YWx1ZSBvZiB0aGUgZnVuY3Rpb24gYmFja2luZyB0aGUgQ1AuCiovCkNv
        bXB1dGVkUHJvcGVydHlQcm90b3R5cGUuc2V0ID0gZnVuY3Rpb24ob2JqLCBr
        ZXlOYW1lLCB2YWx1ZSkgewogIHZhciBjYWNoZWFibGUgPSB0aGlzLl9jYWNo
        ZWFibGUsCiAgICAgIGZ1bmMgPSB0aGlzLmZ1bmMsCiAgICAgIG1ldGEgPSBt
        ZXRhRm9yKG9iaiwgY2FjaGVhYmxlKSwKICAgICAgd2F0Y2hlZCA9IG1ldGEu
        d2F0Y2hpbmdba2V5TmFtZV0sCiAgICAgIG9sZFN1c3BlbmRlZCA9IHRoaXMu
        X3N1c3BlbmRlZCwKICAgICAgaGFkQ2FjaGVkVmFsdWUgPSBmYWxzZSwKICAg
        ICAgY2FjaGUgPSBtZXRhLmNhY2hlLAogICAgICBmdW5jQXJnTGVuZ3RoLCBj
        YWNoZWRWYWx1ZSwgcmV0OwoKICBpZiAodGhpcy5fcmVhZE9ubHkpIHsKICAg
        IHRocm93IG5ldyBFcnJvcignQ2Fubm90IFNldDogJyArIGtleU5hbWUgKyAn
        IG9uOiAnICsgb2JqLnRvU3RyaW5nKCkgKTsKICB9CgogIHRoaXMuX3N1c3Bl
        bmRlZCA9IG9iajsKCiAgdHJ5IHsKCiAgICBpZiAoY2FjaGVhYmxlICYmIGNh
        Y2hlLmhhc093blByb3BlcnR5KGtleU5hbWUpKSB7CiAgICAgIGNhY2hlZFZh
        bHVlID0gY2FjaGVba2V5TmFtZV07CiAgICAgIGhhZENhY2hlZFZhbHVlID0g
        dHJ1ZTsKICAgIH0KCiAgICAvLyBDaGVjayBpZiB0aGUgQ1AgaGFzIGJlZW4g
        d3JhcHBlZC4gSWYgaWYgaGFzLCB1c2UgdGhlCiAgICAvLyBsZW5ndGggZnJv
        bSB0aGUgd3JhcHBlZCBmdW5jdGlvbi4KICAgIGZ1bmNBcmdMZW5ndGggPSAo
        ZnVuYy53cmFwcGVkRnVuY3Rpb24gPyBmdW5jLndyYXBwZWRGdW5jdGlvbi5s
        ZW5ndGggOiBmdW5jLmxlbmd0aCk7CgogICAgLy8gRm9yIGJhY2t3YXJkcy1j
        b21wYXRpYmlsaXR5IHdpdGggY29tcHV0ZWQgcHJvcGVydGllcwogICAgLy8g
        dGhhdCBjaGVjayBmb3IgYXJndW1lbnRzLmxlbmd0aCA9PT0gMiB0byBkZXRl
        cm1pbmUgaWYKICAgIC8vIHRoZXkgYXJlIGJlaW5nIGdldCBvciBzZXQsIG9u
        bHkgcGFzcyB0aGUgb2xkIGNhY2hlZAogICAgLy8gdmFsdWUgaWYgdGhlIGNv
        bXB1dGVkIHByb3BlcnR5IG9wdHMgaW50byBhIHRoaXJkCiAgICAvLyBhcmd1
        bWVudC4KICAgIGlmIChmdW5jQXJnTGVuZ3RoID09PSAzKSB7CiAgICAgIHJl
        dCA9IGZ1bmMuY2FsbChvYmosIGtleU5hbWUsIHZhbHVlLCBjYWNoZWRWYWx1
        ZSk7CiAgICB9IGVsc2UgaWYgKGZ1bmNBcmdMZW5ndGggPT09IDIpIHsKICAg
        ICAgcmV0ID0gZnVuYy5jYWxsKG9iaiwga2V5TmFtZSwgdmFsdWUpOwogICAg
        fSBlbHNlIHsKICAgICAgRW1iZXIuZGVmaW5lUHJvcGVydHkob2JqLCBrZXlO
        YW1lLCBudWxsLCBjYWNoZWRWYWx1ZSk7CiAgICAgIEVtYmVyLnNldChvYmos
        IGtleU5hbWUsIHZhbHVlKTsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGlm
        IChoYWRDYWNoZWRWYWx1ZSAmJiBjYWNoZWRWYWx1ZSA9PT0gcmV0KSB7IHJl
        dHVybjsgfQoKICAgIGlmICh3YXRjaGVkKSB7IEVtYmVyLnByb3BlcnR5V2ls
        bENoYW5nZShvYmosIGtleU5hbWUpOyB9CgogICAgaWYgKGhhZENhY2hlZFZh
        bHVlKSB7CiAgICAgIGRlbGV0ZSBjYWNoZVtrZXlOYW1lXTsKICAgIH0KCiAg
        ICBpZiAoY2FjaGVhYmxlKSB7CiAgICAgIGlmICghaGFkQ2FjaGVkVmFsdWUp
        IHsKICAgICAgICBhZGREZXBlbmRlbnRLZXlzKHRoaXMsIG9iaiwga2V5TmFt
        ZSwgbWV0YSk7CiAgICAgIH0KICAgICAgY2FjaGVba2V5TmFtZV0gPSByZXQ7
        CiAgICB9CgogICAgaWYgKHdhdGNoZWQpIHsgRW1iZXIucHJvcGVydHlEaWRD
        aGFuZ2Uob2JqLCBrZXlOYW1lKTsgfQogIH0gZmluYWxseSB7CiAgICB0aGlz
        Ll9zdXNwZW5kZWQgPSBvbGRTdXNwZW5kZWQ7CiAgfQogIHJldHVybiByZXQ7
        Cn07CgovKiBjYWxsZWQgYmVmb3JlIHByb3BlcnR5IGlzIG92ZXJyaWRkZW4g
        Ki8KQ29tcHV0ZWRQcm9wZXJ0eVByb3RvdHlwZS50ZWFyZG93biA9IGZ1bmN0
        aW9uKG9iaiwga2V5TmFtZSkgewogIHZhciBtZXRhID0gbWV0YUZvcihvYmop
        OwoKICBpZiAoa2V5TmFtZSBpbiBtZXRhLmNhY2hlKSB7CiAgICByZW1vdmVE
        ZXBlbmRlbnRLZXlzKHRoaXMsIG9iaiwga2V5TmFtZSwgbWV0YSk7CiAgfQoK
        ICBpZiAodGhpcy5fY2FjaGVhYmxlKSB7IGRlbGV0ZSBtZXRhLmNhY2hlW2tl
        eU5hbWVdOyB9CgogIHJldHVybiBudWxsOyAvLyBubyB2YWx1ZSB0byByZXN0
        b3JlCn07CgoKLyoqCiAgVGhpcyBoZWxwZXIgcmV0dXJucyBhIG5ldyBwcm9w
        ZXJ0eSBkZXNjcmlwdG9yIHRoYXQgd3JhcHMgdGhlIHBhc3NlZAogIGNvbXB1
        dGVkIHByb3BlcnR5IGZ1bmN0aW9uLiBZb3UgY2FuIHVzZSB0aGlzIGhlbHBl
        ciB0byBkZWZpbmUgcHJvcGVydGllcwogIHdpdGggbWl4aW5zIG9yIHZpYSBg
        RW1iZXIuZGVmaW5lUHJvcGVydHkoKWAuCgogIFRoZSBmdW5jdGlvbiB5b3Ug
        cGFzcyB3aWxsIGJlIHVzZWQgdG8gYm90aCBnZXQgYW5kIHNldCBwcm9wZXJ0
        eSB2YWx1ZXMuCiAgVGhlIGZ1bmN0aW9uIHNob3VsZCBhY2NlcHQgdHdvIHBh
        cmFtZXRlcnMsIGtleSBhbmQgdmFsdWUuIElmIHZhbHVlIGlzIG5vdAogIHVu
        ZGVmaW5lZCB5b3Ugc2hvdWxkIHNldCB0aGUgdmFsdWUgZmlyc3QuIEluIGVp
        dGhlciBjYXNlIHJldHVybiB0aGUKICBjdXJyZW50IHZhbHVlIG9mIHRoZSBw
        cm9wZXJ0eS4KICBAbWV0aG9kIGNvbXB1dGVkCiAgQGZvciBFbWJlcgogIEBw
        YXJhbSB7RnVuY3Rpb259IGZ1bmMgVGhlIGNvbXB1dGVkIHByb3BlcnR5IGZ1
        bmN0aW9uLgogIEByZXR1cm4ge0VtYmVyLkNvbXB1dGVkUHJvcGVydHl9IHBy
        b3BlcnR5IGRlc2NyaXB0b3IgaW5zdGFuY2UKKi8KRW1iZXIuY29tcHV0ZWQg
        PSBmdW5jdGlvbihmdW5jKSB7CiAgdmFyIGFyZ3M7CgogIGlmIChhcmd1bWVu
        dHMubGVuZ3RoID4gMSkgewogICAgYXJncyA9IGFfc2xpY2UuY2FsbChhcmd1
        bWVudHMsIDAsIC0xKTsKICAgIGZ1bmMgPSBhX3NsaWNlLmNhbGwoYXJndW1l
        bnRzLCAtMSlbMF07CiAgfQoKICBpZiAodHlwZW9mIGZ1bmMgIT09ICJmdW5j
        dGlvbiIpIHsKICAgIHRocm93IG5ldyBFcnJvcigiQ29tcHV0ZWQgUHJvcGVy
        dHkgZGVjbGFyZWQgd2l0aG91dCBhIHByb3BlcnR5IGZ1bmN0aW9uIik7CiAg
        fQoKICB2YXIgY3AgPSBuZXcgQ29tcHV0ZWRQcm9wZXJ0eShmdW5jKTsKCiAg
        aWYgKGFyZ3MpIHsKICAgIGNwLnByb3BlcnR5LmFwcGx5KGNwLCBhcmdzKTsK
        ICB9CgogIHJldHVybiBjcDsKfTsKCi8qKgogIFJldHVybnMgdGhlIGNhY2hl
        ZCB2YWx1ZSBmb3IgYSBwcm9wZXJ0eSwgaWYgb25lIGV4aXN0cy4KICBUaGlz
        IGNhbiBiZSB1c2VmdWwgZm9yIHBlZWtpbmcgYXQgdGhlIHZhbHVlIG9mIGEg
        Y29tcHV0ZWQKICBwcm9wZXJ0eSB0aGF0IGlzIGdlbmVyYXRlZCBsYXppbHks
        IHdpdGhvdXQgYWNjaWRlbnRhbGx5IGNhdXNpbmcKICBpdCB0byBiZSBjcmVh
        dGVkLgoKICBAbWV0aG9kIGNhY2hlRm9yCiAgQGZvciBFbWJlcgogIEBwYXJh
        bSB7T2JqZWN0fSBvYmogdGhlIG9iamVjdCB3aG9zZSBwcm9wZXJ0eSB5b3Ug
        d2FudCB0byBjaGVjawogIEBwYXJhbSB7U3RyaW5nfSBrZXkgdGhlIG5hbWUg
        b2YgdGhlIHByb3BlcnR5IHdob3NlIGNhY2hlZCB2YWx1ZSB5b3Ugd2FudAog
        ICAgdG8gcmV0dXJuCiAgQHJldHVybiB7Kn0gdGhlIGNhY2hlZCB2YWx1ZQoq
        LwpFbWJlci5jYWNoZUZvciA9IGZ1bmN0aW9uIGNhY2hlRm9yKG9iaiwga2V5
        KSB7CiAgdmFyIGNhY2hlID0gbWV0YUZvcihvYmosIGZhbHNlKS5jYWNoZTsK
        CiAgaWYgKGNhY2hlICYmIGtleSBpbiBjYWNoZSkgewogICAgcmV0dXJuIGNh
        Y2hlW2tleV07CiAgfQp9OwoKZnVuY3Rpb24gZ2V0UHJvcGVydGllcyhzZWxm
        LCBwcm9wZXJ0eU5hbWVzKSB7CiAgdmFyIHJldCA9IHt9OwogIGZvcih2YXIg
        aSA9IDA7IGkgPCBwcm9wZXJ0eU5hbWVzLmxlbmd0aDsgaSsrKSB7CiAgICBy
        ZXRbcHJvcGVydHlOYW1lc1tpXV0gPSBnZXQoc2VsZiwgcHJvcGVydHlOYW1l
        c1tpXSk7CiAgfQogIHJldHVybiByZXQ7Cn0KCmZ1bmN0aW9uIHJlZ2lzdGVy
        Q29tcHV0ZWQobmFtZSwgbWFjcm8pIHsKICBFbWJlci5jb21wdXRlZFtuYW1l
        XSA9IGZ1bmN0aW9uKGRlcGVuZGVudEtleSkgewogICAgdmFyIGFyZ3MgPSBh
        X3NsaWNlLmNhbGwoYXJndW1lbnRzKTsKICAgIHJldHVybiBFbWJlci5jb21w
        dXRlZChkZXBlbmRlbnRLZXksIGZ1bmN0aW9uKCkgewogICAgICByZXR1cm4g
        bWFjcm8uYXBwbHkodGhpcywgYXJncyk7CiAgICB9KTsKICB9Owp9CgpmdW5j
        dGlvbiByZWdpc3RlckNvbXB1dGVkV2l0aFByb3BlcnRpZXMobmFtZSwgbWFj
        cm8pIHsKICBFbWJlci5jb21wdXRlZFtuYW1lXSA9IGZ1bmN0aW9uKCkgewog
        ICAgdmFyIHByb3BlcnRpZXMgPSBhX3NsaWNlLmNhbGwoYXJndW1lbnRzKTsK
        CiAgICB2YXIgY29tcHV0ZWQgPSBFbWJlci5jb21wdXRlZChmdW5jdGlvbigp
        IHsKICAgICAgcmV0dXJuIG1hY3JvLmFwcGx5KHRoaXMsIFtnZXRQcm9wZXJ0
        aWVzKHRoaXMsIHByb3BlcnRpZXMpXSk7CiAgICB9KTsKCiAgICByZXR1cm4g
        Y29tcHV0ZWQucHJvcGVydHkuYXBwbHkoY29tcHV0ZWQsIHByb3BlcnRpZXMp
        OwogIH07Cn0KCi8qKgogIEEgY29tcHV0ZWQgcHJvcGVydHkgdGhhdCByZXR1
        cm5zIHRydWUgaWYgdGhlIHZhbHVlIG9mIHRoZSBkZXBlbmRlbnQKICBwcm9w
        ZXJ0eSBpcyBudWxsLCBhbiBlbXB0eSBzdHJpbmcsIGVtcHR5IGFycmF5LCBv
        ciBlbXB0eSBmdW5jdGlvbi4KCiAgTm90ZTogV2hlbiB1c2luZyBgRW1iZXIu
        Y29tcHV0ZWQuZW1wdHlgIHRvIHdhdGNoIGFuIGFycmF5IG1ha2Ugc3VyZSB0
        bwogIHVzZSB0aGUgYGFycmF5LltdYCBzeW50YXggc28gdGhlIGNvbXB1dGVk
        IGNhbiBzdWJzY3JpYmUgdG8gdHJhbnNpdGlvbnMKICBmcm9tIGVtcHR5IHRv
        IG5vbi1lbXB0eSBzdGF0ZXMuCgogIEV4YW1wbGUKCiAgYGBgamF2YXNjcmlw
        dAogIHZhciBUb0RvTGlzdCA9IEVtYmVyLk9iamVjdC5leHRlbmQoewogICAg
        ZG9uZTogRW1iZXIuY29tcHV0ZWQuZW1wdHkoJ3RvZG9zLltdJykgLy8gZGV0
        ZWN0IGFycmF5IGNoYW5nZXMKICB9KTsKICB2YXIgdG9kb0xpc3QgPSBUb0Rv
        TGlzdC5jcmVhdGUoe3RvZG9zOiBbJ1VuaXQgVGVzdCcsICdEb2N1bWVudGF0
        aW9uJywgJ1JlbGVhc2UnXX0pOwogIHRvZG9MaXN0LmdldCgnZG9uZScpOyAv
        LyBmYWxzZQogIHRvZG9MaXN0LmdldCgndG9kb3MnKS5jbGVhcigpOyAvLyBb
        XQogIHRvZG9MaXN0LmdldCgnZG9uZScpOyAvLyB0cnVlCiAgYGBgCgogIEBt
        ZXRob2QgY29tcHV0ZWQuZW1wdHkKICBAZm9yIEVtYmVyCiAgQHBhcmFtIHtT
        dHJpbmd9IGRlcGVuZGVudEtleQogIEByZXR1cm4ge0VtYmVyLkNvbXB1dGVk
        UHJvcGVydHl9IGNvbXB1dGVkIHByb3BlcnR5IHdoaWNoIG5lZ2F0ZQogIHRo
        ZSBvcmlnaW5hbCB2YWx1ZSBmb3IgcHJvcGVydHkKKi8KcmVnaXN0ZXJDb21w
        dXRlZCgnZW1wdHknLCBmdW5jdGlvbihkZXBlbmRlbnRLZXkpIHsKICByZXR1
        cm4gRW1iZXIuaXNFbXB0eShnZXQodGhpcywgZGVwZW5kZW50S2V5KSk7Cn0p
        OwoKLyoqCiAgQSBjb21wdXRlZCBwcm9wZXJ0eSB0aGF0IHJldHVybnMgdHJ1
        ZSBpZiB0aGUgdmFsdWUgb2YgdGhlIGRlcGVuZGVudAogIHByb3BlcnR5IGlz
        IE5PVCBudWxsLCBhbiBlbXB0eSBzdHJpbmcsIGVtcHR5IGFycmF5LCBvciBl
        bXB0eSBmdW5jdGlvbi4KCiAgRXhhbXBsZQoKICBgYGBqYXZhc2NyaXB0CiAg
        dmFyIEhhbXBzdGVyID0gRW1iZXIuT2JqZWN0LmV4dGVuZCh7CiAgICBoYXNT
        dHVmZjogRW1iZXIuY29tcHV0ZWQubm90RW1wdHkoJ2JhY2twYWNrJykKICB9
        KTsKICB2YXIgaGFtcHN0ZXIgPSBIYW1wc3Rlci5jcmVhdGUoe2JhY2twYWNr
        OiBbJ0Zvb2QnLCAnU2xlZXBpbmcgQmFnJywgJ1RlbnQnXX0pOwogIGhhbXBz
        dGVyLmdldCgnaGFzU3R1ZmYnKTsgLy8gdHJ1ZQogIGhhbXBzdGVyLmdldCgn
        YmFja3BhY2snKS5jbGVhcigpOyAvLyBbXQogIGhhbXBzdGVyLmdldCgnaGFz
        U3R1ZmYnKTsgLy8gZmFsc2UKICBgYGAKCiAgQG1ldGhvZCBjb21wdXRlZC5u
        b3RFbXB0eQogIEBmb3IgRW1iZXIKICBAcGFyYW0ge1N0cmluZ30gZGVwZW5k
        ZW50S2V5CiAgQHJldHVybiB7RW1iZXIuQ29tcHV0ZWRQcm9wZXJ0eX0gY29t
        cHV0ZWQgcHJvcGVydHkgd2hpY2ggcmV0dXJucyB0cnVlIGlmCiAgb3JpZ2lu
        YWwgdmFsdWUgZm9yIHByb3BlcnR5IGlzIG5vdCBlbXB0eS4KKi8KcmVnaXN0
        ZXJDb21wdXRlZCgnbm90RW1wdHknLCBmdW5jdGlvbihkZXBlbmRlbnRLZXkp
        IHsKICByZXR1cm4gIUVtYmVyLmlzRW1wdHkoZ2V0KHRoaXMsIGRlcGVuZGVu
        dEtleSkpOwp9KTsKCi8qKgogIEEgY29tcHV0ZWQgcHJvcGVydHkgdGhhdCBy
        ZXR1cm5zIHRydWUgaWYgdGhlIHZhbHVlIG9mIHRoZSBkZXBlbmRlbnQKICBw
        cm9wZXJ0eSBpcyBudWxsIG9yIHVuZGVmaW5lZC4gVGhpcyBhdm9pZHMgZXJy
        b3JzIGZyb20gSlNMaW50IGNvbXBsYWluaW5nCiAgYWJvdXQgdXNlIG9mID09
        LCB3aGljaCBjYW4gYmUgdGVjaG5pY2FsbHkgY29uZnVzaW5nLgoKICBFeGFt
        cGxlCgogIGBgYGphdmFzY3JpcHQKICB2YXIgSGFtcHN0ZXIgPSBFbWJlci5P
        YmplY3QuZXh0ZW5kKHsKICAgIGlzSHVuZ3J5OiBFbWJlci5jb21wdXRlZC5u
        b25lKCdmb29kJykKICB9KTsKICB2YXIgaGFtcHN0ZXIgPSBIYW1wc3Rlci5j
        cmVhdGUoKTsKICBoYW1wc3Rlci5nZXQoJ2lzSHVuZ3J5Jyk7IC8vIHRydWUK
        ICBoYW1wc3Rlci5zZXQoJ2Zvb2QnLCAnQmFuYW5hJyk7CiAgaGFtcHN0ZXIu
        Z2V0KCdpc0h1bmdyeScpOyAvLyBmYWxzZQogIGhhbXBzdGVyLnNldCgnZm9v
        ZCcsIG51bGwpOwogIGhhbXBzdGVyLmdldCgnaXNIdW5ncnknKTsgLy8gdHJ1
        ZQogIGBgYAoKICBAbWV0aG9kIGNvbXB1dGVkLm5vbmUKICBAZm9yIEVtYmVy
        CiAgQHBhcmFtIHtTdHJpbmd9IGRlcGVuZGVudEtleQogIEByZXR1cm4ge0Vt
        YmVyLkNvbXB1dGVkUHJvcGVydHl9IGNvbXB1dGVkIHByb3BlcnR5IHdoaWNo
        CiAgcmV0dXJucyB0cnVlIGlmIG9yaWdpbmFsIHZhbHVlIGZvciBwcm9wZXJ0
        eSBpcyBudWxsIG9yIHVuZGVmaW5lZC4KKi8KcmVnaXN0ZXJDb21wdXRlZCgn
        bm9uZScsIGZ1bmN0aW9uKGRlcGVuZGVudEtleSkgewogIHJldHVybiBFbWJl
        ci5pc05vbmUoZ2V0KHRoaXMsIGRlcGVuZGVudEtleSkpOwp9KTsKCi8qKgog
        IEEgY29tcHV0ZWQgcHJvcGVydHkgdGhhdCByZXR1cm5zIHRoZSBpbnZlcnNl
        IGJvb2xlYW4gdmFsdWUKICBvZiB0aGUgb3JpZ2luYWwgdmFsdWUgZm9yIHRo
        ZSBkZXBlbmRlbnQgcHJvcGVydHkuCgogIEV4YW1wbGUKCiAgYGBgamF2YXNj
        cmlwdAogIHZhciBVc2VyID0gRW1iZXIuT2JqZWN0LmV4dGVuZCh7CiAgICBp
        c0Fub255bW91czogRW1iZXIuY29tcHV0ZWQubm90KCdsb2dnZWRJbicpCiAg
        fSk7CiAgdmFyIHVzZXIgPSBVc2VyLmNyZWF0ZSh7bG9nZ2VkSW46IGZhbHNl
        fSk7CiAgdXNlci5nZXQoJ2lzQW5vbnltb3VzJyk7IC8vIHRydWUKICB1c2Vy
        LnNldCgnbG9nZ2VkSW4nLCB0cnVlKTsKICB1c2VyLmdldCgnaXNBbm9ueW1v
        dXMnKTsgLy8gZmFsc2UKICBgYGAKCiAgQG1ldGhvZCBjb21wdXRlZC5ub3QK
        ICBAZm9yIEVtYmVyCiAgQHBhcmFtIHtTdHJpbmd9IGRlcGVuZGVudEtleQog
        IEByZXR1cm4ge0VtYmVyLkNvbXB1dGVkUHJvcGVydHl9IGNvbXB1dGVkIHBy
        b3BlcnR5IHdoaWNoIHJldHVybnMKICBpbnZlcnNlIG9mIHRoZSBvcmlnaW5h
        bCB2YWx1ZSBmb3IgcHJvcGVydHkKKi8KcmVnaXN0ZXJDb21wdXRlZCgnbm90
        JywgZnVuY3Rpb24oZGVwZW5kZW50S2V5KSB7CiAgcmV0dXJuICFnZXQodGhp
        cywgZGVwZW5kZW50S2V5KTsKfSk7CgovKioKICBBIGNvbXB1dGVkIHByb3Bl
        cnR5IHRoYXQgY29udmVydHMgdGhlIHByb3ZpZGVkIGRlcGVuZGVudCBwcm9w
        ZXJ0eQogIGludG8gYSBib29sZWFuIHZhbHVlLgoKICBgYGBqYXZhc2NyaXB0
        CiAgdmFyIEhhbXBzdGVyID0gRW1iZXIuT2JqZWN0LmV4dGVuZCh7CiAgICBo
        YXNCYW5hbmFzOiBFbWJlci5jb21wdXRlZC5ib29sKCdudW1CYW5hbmFzJykK
        ICB9KTsKICB2YXIgaGFtcHN0ZXIgPSBIYW1wc3Rlci5jcmVhdGUoKTsKICBo
        YW1wc3Rlci5nZXQoJ2hhc0JhbmFuYXMnKTsgLy8gZmFsc2UKICBoYW1wc3Rl
        ci5zZXQoJ251bUJhbmFuYXMnLCAwKTsKICBoYW1wc3Rlci5nZXQoJ2hhc0Jh
        bmFuYXMnKTsgLy8gZmFsc2UKICBoYW1wc3Rlci5zZXQoJ251bUJhbmFuYXMn
        LCAxKTsKICBoYW1wc3Rlci5nZXQoJ2hhc0JhbmFuYXMnKTsgLy8gdHJ1ZQog
        IGhhbXBzdGVyLnNldCgnbnVtQmFuYW5hcycsIG51bGwpOwogIGhhbXBzdGVy
        LmdldCgnaGFzQmFuYW5hcycpOyAvLyBmYWxzZQogIGBgYAoKICBAbWV0aG9k
        IGNvbXB1dGVkLmJvb2wKICBAZm9yIEVtYmVyCiAgQHBhcmFtIHtTdHJpbmd9
        IGRlcGVuZGVudEtleQogIEByZXR1cm4ge0VtYmVyLkNvbXB1dGVkUHJvcGVy
        dHl9IGNvbXB1dGVkIHByb3BlcnR5IHdoaWNoIGNvbnZlcnRzCiAgdG8gYm9v
        bGVhbiB0aGUgb3JpZ2luYWwgdmFsdWUgZm9yIHByb3BlcnR5CiovCnJlZ2lz
        dGVyQ29tcHV0ZWQoJ2Jvb2wnLCBmdW5jdGlvbihkZXBlbmRlbnRLZXkpIHsK
        ICByZXR1cm4gISFnZXQodGhpcywgZGVwZW5kZW50S2V5KTsKfSk7CgovKioK
        ICBBIGNvbXB1dGVkIHByb3BlcnR5IHdoaWNoIG1hdGNoZXMgdGhlIG9yaWdp
        bmFsIHZhbHVlIGZvciB0aGUKICBkZXBlbmRlbnQgcHJvcGVydHkgYWdhaW5z
        dCBhIGdpdmVuIFJlZ0V4cCwgcmV0dXJuaW5nIGB0cnVlYAogIGlmIHRoZXkg
        dmFsdWVzIG1hdGNoZXMgdGhlIFJlZ0V4cCBhbmQgYGZhbHNlYCBpZiBpdCBk
        b2VzIG5vdC4KCiAgRXhhbXBsZQoKICBgYGBqYXZhc2NyaXB0CiAgdmFyIFVz
        ZXIgPSBFbWJlci5PYmplY3QuZXh0ZW5kKHsKICAgIGhhc1ZhbGlkRW1haWw6
        IEVtYmVyLmNvbXB1dGVkLm1hdGNoKCdlbWFpbCcsIC9eLitALitcLi4rJC8p
        CiAgfSk7CiAgdmFyIHVzZXIgPSBVc2VyLmNyZWF0ZSh7bG9nZ2VkSW46IGZh
        bHNlfSk7CiAgdXNlci5nZXQoJ2hhc1ZhbGlkRW1haWwnKTsgLy8gZmFsc2UK
        ICB1c2VyLnNldCgnZW1haWwnLCAnJyk7CiAgdXNlci5nZXQoJ2hhc1ZhbGlk
        RW1haWwnKTsgLy8gZmFsc2UKICB1c2VyLnNldCgnZW1haWwnLCAnZW1iZXJf
        aGFtcHN0ZXJAZXhhbXBsZS5jb20nKTsKICB1c2VyLmdldCgnaGFzVmFsaWRF
        bWFpbCcpOyAvLyB0cnVlCiAgYGBgCgogIEBtZXRob2QgY29tcHV0ZWQubWF0
        Y2gKICBAZm9yIEVtYmVyCiAgQHBhcmFtIHtTdHJpbmd9IGRlcGVuZGVudEtl
        eQogIEBwYXJhbSB7UmVnRXhwfSByZWdleHAKICBAcmV0dXJuIHtFbWJlci5D
        b21wdXRlZFByb3BlcnR5fSBjb21wdXRlZCBwcm9wZXJ0eSB3aGljaCBtYXRj
        aAogIHRoZSBvcmlnaW5hbCB2YWx1ZSBmb3IgcHJvcGVydHkgYWdhaW5zdCBh
        IGdpdmVuIFJlZ0V4cAoqLwpyZWdpc3RlckNvbXB1dGVkKCdtYXRjaCcsIGZ1
        bmN0aW9uKGRlcGVuZGVudEtleSwgcmVnZXhwKSB7CiAgdmFyIHZhbHVlID0g
        Z2V0KHRoaXMsIGRlcGVuZGVudEtleSk7CiAgcmV0dXJuIHR5cGVvZiB2YWx1
        ZSA9PT0gJ3N0cmluZycgPyAhIXZhbHVlLm1hdGNoKHJlZ2V4cCkgOiBmYWxz
        ZTsKfSk7CgovKioKICBBIGNvbXB1dGVkIHByb3BlcnR5IHRoYXQgcmV0dXJu
        cyB0cnVlIGlmIHRoZSBwcm92aWRlZCBkZXBlbmRlbnQgcHJvcGVydHkKICBp
        cyBlcXVhbCB0byB0aGUgZ2l2ZW4gdmFsdWUuCgogIEV4YW1wbGUKCiAgYGBg
        amF2YXNjcmlwdAogIHZhciBIYW1wc3RlciA9IEVtYmVyLk9iamVjdC5leHRl
        bmQoewogICAgbmFwVGltZTogRW1iZXIuY29tcHV0ZWQuZXF1YWwoJ3N0YXRl
        JywgJ3NsZWVweScpCiAgfSk7CiAgdmFyIGhhbXBzdGVyID0gSGFtcHN0ZXIu
        Y3JlYXRlKCk7CiAgaGFtcHN0ZXIuZ2V0KCduYXBUaW1lJyk7IC8vIGZhbHNl
        CiAgaGFtcHN0ZXIuc2V0KCdzdGF0ZScsICdzbGVlcHknKTsKICBoYW1wc3Rl
        ci5nZXQoJ25hcFRpbWUnKTsgLy8gdHJ1ZQogIGhhbXBzdGVyLnNldCgnc3Rh
        dGUnLCAnaHVuZ3J5Jyk7CiAgaGFtcHN0ZXIuZ2V0KCduYXBUaW1lJyk7IC8v
        IGZhbHNlCiAgYGBgCgogIEBtZXRob2QgY29tcHV0ZWQuZXF1YWwKICBAZm9y
        IEVtYmVyCiAgQHBhcmFtIHtTdHJpbmd9IGRlcGVuZGVudEtleQogIEBwYXJh
        bSB7U3RyaW5nfE51bWJlcnxPYmplY3R9IHZhbHVlCiAgQHJldHVybiB7RW1i
        ZXIuQ29tcHV0ZWRQcm9wZXJ0eX0gY29tcHV0ZWQgcHJvcGVydHkgd2hpY2gg
        cmV0dXJucyB0cnVlIGlmCiAgdGhlIG9yaWdpbmFsIHZhbHVlIGZvciBwcm9w
        ZXJ0eSBpcyBlcXVhbCB0byB0aGUgZ2l2ZW4gdmFsdWUuCiovCnJlZ2lzdGVy
        Q29tcHV0ZWQoJ2VxdWFsJywgZnVuY3Rpb24oZGVwZW5kZW50S2V5LCB2YWx1
        ZSkgewogIHJldHVybiBnZXQodGhpcywgZGVwZW5kZW50S2V5KSA9PT0gdmFs
        dWU7Cn0pOwoKLyoqCiAgQSBjb21wdXRlZCBwcm9wZXJ0eSB0aGF0IHJldHVy
        bnMgdHJ1ZSBpZiB0aGUgcHJvdmllZCBkZXBlbmRlbnQgcHJvcGVydHkKICBp
        cyBncmVhdGVyIHRoYW4gdGhlIHByb3ZpZGVkIHZhbHVlLgoKICBFeGFtcGxl
        CgogIGBgYGphdmFzY3JpcHQKICB2YXIgSGFtcHN0ZXIgPSBFbWJlci5PYmpl
        Y3QuZXh0ZW5kKHsKICAgIGhhc1Rvb01hbnlCYW5hbmFzOiBFbWJlci5jb21w
        dXRlZC5ndCgnbnVtQmFuYW5hcycsIDEwKQogIH0pOwogIHZhciBoYW1wc3Rl
        ciA9IEhhbXBzdGVyLmNyZWF0ZSgpOwogIGhhbXBzdGVyLmdldCgnaGFzVG9v
        TWFueUJhbmFuYXMnKTsgLy8gZmFsc2UKICBoYW1wc3Rlci5zZXQoJ251bUJh
        bmFuYXMnLCAzKTsKICBoYW1wc3Rlci5nZXQoJ2hhc1Rvb01hbnlCYW5hbmFz
        Jyk7IC8vIGZhbHNlCiAgaGFtcHN0ZXIuc2V0KCdudW1CYW5hbmFzJywgMTEp
        OwogIGhhbXBzdGVyLmdldCgnaGFzVG9vTWFueUJhbmFuYXMnKTsgLy8gdHJ1
        ZQogIGBgYAoKICBAbWV0aG9kIGNvbXB1dGVkLmd0CiAgQGZvciBFbWJlcgog
        IEBwYXJhbSB7U3RyaW5nfSBkZXBlbmRlbnRLZXkKICBAcGFyYW0ge051bWJl
        cn0gdmFsdWUKICBAcmV0dXJuIHtFbWJlci5Db21wdXRlZFByb3BlcnR5fSBj
        b21wdXRlZCBwcm9wZXJ0eSB3aGljaCByZXR1cm5zIHRydWUgaWYKICB0aGUg
        b3JpZ2luYWwgdmFsdWUgZm9yIHByb3BlcnR5IGlzIGdyZWF0ZXIgdGhlbiBn
        aXZlbiB2YWx1ZS4KKi8KcmVnaXN0ZXJDb21wdXRlZCgnZ3QnLCBmdW5jdGlv
        bihkZXBlbmRlbnRLZXksIHZhbHVlKSB7CiAgcmV0dXJuIGdldCh0aGlzLCBk
        ZXBlbmRlbnRLZXkpID4gdmFsdWU7Cn0pOwoKLyoqCiAgQSBjb21wdXRlZCBw
        cm9wZXJ0eSB0aGF0IHJldHVybnMgdHJ1ZSBpZiB0aGUgcHJvdmlkZWQgZGVw
        ZW5kZW50IHByb3BlcnR5CiAgaXMgZ3JlYXRlciB0aGFuIG9yIGVxdWFsIHRv
        IHRoZSBwcm92aWRlZCB2YWx1ZS4KCiAgRXhhbXBsZQoKICBgYGBqYXZhc2Ny
        aXB0CiAgdmFyIEhhbXBzdGVyID0gRW1iZXIuT2JqZWN0LmV4dGVuZCh7CiAg
        ICBoYXNUb29NYW55QmFuYW5hczogRW1iZXIuY29tcHV0ZWQuZ3RlKCdudW1C
        YW5hbmFzJywgMTApCiAgfSk7CiAgdmFyIGhhbXBzdGVyID0gSGFtcHN0ZXIu
        Y3JlYXRlKCk7CiAgaGFtcHN0ZXIuZ2V0KCdoYXNUb29NYW55QmFuYW5hcycp
        OyAvLyBmYWxzZQogIGhhbXBzdGVyLnNldCgnbnVtQmFuYW5hcycsIDMpOwog
        IGhhbXBzdGVyLmdldCgnaGFzVG9vTWFueUJhbmFuYXMnKTsgLy8gZmFsc2UK
        ICBoYW1wc3Rlci5zZXQoJ251bUJhbmFuYXMnLCAxMCk7CiAgaGFtcHN0ZXIu
        Z2V0KCdoYXNUb29NYW55QmFuYW5hcycpOyAvLyB0cnVlCiAgYGBgCgogIEBt
        ZXRob2QgY29tcHV0ZWQuZ3RlCiAgQGZvciBFbWJlcgogIEBwYXJhbSB7U3Ry
        aW5nfSBkZXBlbmRlbnRLZXkKICBAcGFyYW0ge051bWJlcn0gdmFsdWUKICBA
        cmV0dXJuIHtFbWJlci5Db21wdXRlZFByb3BlcnR5fSBjb21wdXRlZCBwcm9w
        ZXJ0eSB3aGljaCByZXR1cm5zIHRydWUgaWYKICB0aGUgb3JpZ2luYWwgdmFs
        dWUgZm9yIHByb3BlcnR5IGlzIGdyZWF0ZXIgb3IgZXF1YWwgdGhlbiBnaXZl
        biB2YWx1ZS4KKi8KcmVnaXN0ZXJDb21wdXRlZCgnZ3RlJywgZnVuY3Rpb24o
        ZGVwZW5kZW50S2V5LCB2YWx1ZSkgewogIHJldHVybiBnZXQodGhpcywgZGVw
        ZW5kZW50S2V5KSA+PSB2YWx1ZTsKfSk7CgovKioKICBBIGNvbXB1dGVkIHBy
        b3BlcnR5IHRoYXQgcmV0dXJucyB0cnVlIGlmIHRoZSBwcm92aWRlZCBkZXBl
        bmRlbnQgcHJvcGVydHkKICBpcyBsZXNzIHRoYW4gdGhlIHByb3ZpZGVkIHZh
        bHVlLgoKICBFeGFtcGxlCgogIGBgYGphdmFzY3JpcHQKICB2YXIgSGFtcHN0
        ZXIgPSBFbWJlci5PYmplY3QuZXh0ZW5kKHsKICAgIG5lZWRzTW9yZUJhbmFu
        YXM6IEVtYmVyLmNvbXB1dGVkLmx0KCdudW1CYW5hbmFzJywgMykKICB9KTsK
        ICB2YXIgaGFtcHN0ZXIgPSBIYW1wc3Rlci5jcmVhdGUoKTsKICBoYW1wc3Rl
        ci5nZXQoJ25lZWRzTW9yZUJhbmFuYXMnKTsgLy8gdHJ1ZQogIGhhbXBzdGVy
        LnNldCgnbnVtQmFuYW5hcycsIDMpOwogIGhhbXBzdGVyLmdldCgnbmVlZHNN
        b3JlQmFuYW5hcycpOyAvLyBmYWxzZQogIGhhbXBzdGVyLnNldCgnbnVtQmFu
        YW5hcycsIDIpOwogIGhhbXBzdGVyLmdldCgnbmVlZHNNb3JlQmFuYW5hcycp
        OyAvLyB0cnVlCiAgYGBgCgogIEBtZXRob2QgY29tcHV0ZWQubHQKICBAZm9y
        IEVtYmVyCiAgQHBhcmFtIHtTdHJpbmd9IGRlcGVuZGVudEtleQogIEBwYXJh
        bSB7TnVtYmVyfSB2YWx1ZQogIEByZXR1cm4ge0VtYmVyLkNvbXB1dGVkUHJv
        cGVydHl9IGNvbXB1dGVkIHByb3BlcnR5IHdoaWNoIHJldHVybnMgdHJ1ZSBp
        ZgogIHRoZSBvcmlnaW5hbCB2YWx1ZSBmb3IgcHJvcGVydHkgaXMgbGVzcyB0
        aGVuIGdpdmVuIHZhbHVlLgoqLwpyZWdpc3RlckNvbXB1dGVkKCdsdCcsIGZ1
        bmN0aW9uKGRlcGVuZGVudEtleSwgdmFsdWUpIHsKICByZXR1cm4gZ2V0KHRo
        aXMsIGRlcGVuZGVudEtleSkgPCB2YWx1ZTsKfSk7CgovKioKICBBIGNvbXB1
        dGVkIHByb3BlcnR5IHRoYXQgcmV0dXJucyB0cnVlIGlmIHRoZSBwcm92aWRl
        ZCBkZXBlbmRlbnQgcHJvcGVydHkKICBpcyBsZXNzIHRoYW4gb3IgZXF1YWwg
        dG8gdGhlIHByb3ZpZGVkIHZhbHVlLgoKICBFeGFtcGxlCgogIGBgYGphdmFz
        Y3JpcHQKICB2YXIgSGFtcHN0ZXIgPSBFbWJlci5PYmplY3QuZXh0ZW5kKHsK
        ICAgIG5lZWRzTW9yZUJhbmFuYXM6IEVtYmVyLmNvbXB1dGVkLmx0ZSgnbnVt
        QmFuYW5hcycsIDMpCiAgfSk7CiAgdmFyIGhhbXBzdGVyID0gSGFtcHN0ZXIu
        Y3JlYXRlKCk7CiAgaGFtcHN0ZXIuZ2V0KCduZWVkc01vcmVCYW5hbmFzJyk7
        IC8vIHRydWUKICBoYW1wc3Rlci5zZXQoJ251bUJhbmFuYXMnLCA1KTsKICBo
        YW1wc3Rlci5nZXQoJ25lZWRzTW9yZUJhbmFuYXMnKTsgLy8gZmFsc2UKICBo
        YW1wc3Rlci5zZXQoJ251bUJhbmFuYXMnLCAzKTsKICBoYW1wc3Rlci5nZXQo
        J25lZWRzTW9yZUJhbmFuYXMnKTsgLy8gdHJ1ZQogIGBgYAoKICBAbWV0aG9k
        IGNvbXB1dGVkLmx0ZQogIEBmb3IgRW1iZXIKICBAcGFyYW0ge1N0cmluZ30g
        ZGVwZW5kZW50S2V5CiAgQHBhcmFtIHtOdW1iZXJ9IHZhbHVlCiAgQHJldHVy
        biB7RW1iZXIuQ29tcHV0ZWRQcm9wZXJ0eX0gY29tcHV0ZWQgcHJvcGVydHkg
        d2hpY2ggcmV0dXJucyB0cnVlIGlmCiAgdGhlIG9yaWdpbmFsIHZhbHVlIGZv
        ciBwcm9wZXJ0eSBpcyBsZXNzIG9yIGVxdWFsIHRoZW4gZ2l2ZW4gdmFsdWUu
        CiovCnJlZ2lzdGVyQ29tcHV0ZWQoJ2x0ZScsIGZ1bmN0aW9uKGRlcGVuZGVu
        dEtleSwgdmFsdWUpIHsKICByZXR1cm4gZ2V0KHRoaXMsIGRlcGVuZGVudEtl
        eSkgPD0gdmFsdWU7Cn0pOwoKLyoqCiAgQSBjb21wdXRlZCBwcm9wZXJ0eSB0
        aGF0IHBlcmZvcm1zIGEgbG9naWNhbCBgYW5kYCBvbiB0aGUKICBvcmlnaW5h
        bCB2YWx1ZXMgZm9yIHRoZSBwcm92aWRlZCBkZXBlbmRlbnQgcHJvcGVydGll
        cy4KCgogIEV4YW1wbGUKCiAgYGBgamF2YXNjcmlwdAogIHZhciBIYW1wc3Rl
        ciA9IEVtYmVyLk9iamVjdC5leHRlbmQoewogICAgcmVhZHlGb3JDYW1wOiBF
        bWJlci5jb21wdXRlZC5hbmQoJ2hhc1RlbnQnLCAnaGFzQmFja3BhY2snKQog
        IH0pOwogIHZhciBoYW1wc3RlciA9IEhhbXBzdGVyLmNyZWF0ZSgpOwogIGhh
        bXBzdGVyLmdldCgncmVhZHlGb3JDYW1wJyk7IC8vIGZhbHNlCiAgaGFtcHN0
        ZXIuc2V0KCdoYXNUZW50JywgdHJ1ZSk7CiAgaGFtcHN0ZXIuZ2V0KCdyZWFk
        eUZvckNhbXAnKTsgLy8gZmFsc2UKICBoYW1wc3Rlci5zZXQoJ2hhc0JhY2tw
        YWNrJywgdHJ1ZSk7CiAgaGFtcHN0ZXIuZ2V0KCdyZWFkeUZvckNhbXAnKTsg
        Ly8gdHJ1ZQogIGBgYAoKICBAbWV0aG9kIGNvbXB1dGVkLmFuZAogIEBmb3Ig
        RW1iZXIKICBAcGFyYW0ge1N0cmluZ30gZGVwZW5kZW50S2V5LCBbZGVwZW5k
        ZW50S2V5Li4uXQogIEByZXR1cm4ge0VtYmVyLkNvbXB1dGVkUHJvcGVydHl9
        IGNvbXB1dGVkIHByb3BlcnR5IHdoaWNoIHBlcmZvcm1zCiAgYSBsb2dpY2Fs
        IGBhbmRgIG9uIHRoZSB2YWx1ZXMgb2YgYWxsIHRoZSBvcmlnaW5hbCB2YWx1
        ZXMgZm9yIHByb3BlcnRpZXMuCiovCnJlZ2lzdGVyQ29tcHV0ZWRXaXRoUHJv
        cGVydGllcygnYW5kJywgZnVuY3Rpb24ocHJvcGVydGllcykgewogIGZvciAo
        dmFyIGtleSBpbiBwcm9wZXJ0aWVzKSB7CiAgICBpZiAocHJvcGVydGllcy5o
        YXNPd25Qcm9wZXJ0eShrZXkpICYmICFwcm9wZXJ0aWVzW2tleV0pIHsKICAg
        ICAgcmV0dXJuIGZhbHNlOwogICAgfQogIH0KICByZXR1cm4gdHJ1ZTsKfSk7
        CgovKioKICBBIGNvbXB1dGVkIHByb3BlcnR5IHdoaWNoIHBlcmZvcm1zIGEg
        bG9naWNhbCBgb3JgIG9uIHRoZQogIG9yaWdpbmFsIHZhbHVlcyBmb3IgdGhl
        IHByb3ZpZGVkIGRlcGVuZGVudCBwcm9wZXJ0aWVzLgoKICBFeGFtcGxlCgog
        IGBgYGphdmFzY3JpcHQKICB2YXIgSGFtcHN0ZXIgPSBFbWJlci5PYmplY3Qu
        ZXh0ZW5kKHsKICAgIHJlYWR5Rm9yUmFpbjogRW1iZXIuY29tcHV0ZWQub3Io
        J2hhc0phY2tldCcsICdoYXNVbWJyZWxsYScpCiAgfSk7CiAgdmFyIGhhbXBz
        dGVyID0gSGFtcHN0ZXIuY3JlYXRlKCk7CiAgaGFtcHN0ZXIuZ2V0KCdyZWFk
        eUZvclJhaW4nKTsgLy8gZmFsc2UKICBoYW1wc3Rlci5zZXQoJ2hhc0phY2tl
        dCcsIHRydWUpOwogIGhhbXBzdGVyLmdldCgncmVhZHlGb3JSYWluJyk7IC8v
        IHRydWUKICBgYGAKCiAgQG1ldGhvZCBjb21wdXRlZC5vcgogIEBmb3IgRW1i
        ZXIKICBAcGFyYW0ge1N0cmluZ30gZGVwZW5kZW50S2V5LCBbZGVwZW5kZW50
        S2V5Li4uXQogIEByZXR1cm4ge0VtYmVyLkNvbXB1dGVkUHJvcGVydHl9IGNv
        bXB1dGVkIHByb3BlcnR5IHdoaWNoIHBlcmZvcm1zCiAgYSBsb2dpY2FsIGBv
        cmAgb24gdGhlIHZhbHVlcyBvZiBhbGwgdGhlIG9yaWdpbmFsIHZhbHVlcyBm
        b3IgcHJvcGVydGllcy4KKi8KcmVnaXN0ZXJDb21wdXRlZFdpdGhQcm9wZXJ0
        aWVzKCdvcicsIGZ1bmN0aW9uKHByb3BlcnRpZXMpIHsKICBmb3IgKHZhciBr
        ZXkgaW4gcHJvcGVydGllcykgewogICAgaWYgKHByb3BlcnRpZXMuaGFzT3du
        UHJvcGVydHkoa2V5KSAmJiBwcm9wZXJ0aWVzW2tleV0pIHsKICAgICAgcmV0
        dXJuIHRydWU7CiAgICB9CiAgfQogIHJldHVybiBmYWxzZTsKfSk7CgovKioK
        ICBBIGNvbXB1dGVkIHByb3BlcnR5IHRoYXQgcmV0dXJucyB0aGUgZmlyc3Qg
        dHJ1dGh5IHZhbHVlCiAgZnJvbSBhIGxpc3Qgb2YgZGVwZW5kZW50IHByb3Bl
        cnRpZXMuCgogIEV4YW1wbGUKCiAgYGBgamF2YXNjcmlwdAogIHZhciBIYW1w
        c3RlciA9IEVtYmVyLk9iamVjdC5leHRlbmQoewogICAgaGFzQ2xvdGhlczog
        RW1iZXIuY29tcHV0ZWQuYW55KCdoYXQnLCAnc2hpcnQnKQogIH0pOwogIHZh
        ciBoYW1wc3RlciA9IEhhbXBzdGVyLmNyZWF0ZSgpOwogIGhhbXBzdGVyLmdl
        dCgnaGFzQ2xvdGhlcycpOyAvLyBudWxsCiAgaGFtcHN0ZXIuc2V0KCdzaGly
        dCcsICdIYXdhaWlhbiBTaGlydCcpOwogIGhhbXBzdGVyLmdldCgnaGFzQ2xv
        dGhlcycpOyAvLyAnSGF3YWlpYW4gU2hpcnQnCiAgYGBgCgogIEBtZXRob2Qg
        Y29tcHV0ZWQuYW55CiAgQGZvciBFbWJlcgogIEBwYXJhbSB7U3RyaW5nfSBk
        ZXBlbmRlbnRLZXksIFtkZXBlbmRlbnRLZXkuLi5dCiAgQHJldHVybiB7RW1i
        ZXIuQ29tcHV0ZWRQcm9wZXJ0eX0gY29tcHV0ZWQgcHJvcGVydHkgd2hpY2gg
        cmV0dXJucwogIHRoZSBmaXJzdCB0cnV0aHkgdmFsdWUgb2YgZ2l2ZW4gbGlz
        dCBvZiBwcm9wZXJ0aWVzLgoqLwpyZWdpc3RlckNvbXB1dGVkV2l0aFByb3Bl
        cnRpZXMoJ2FueScsIGZ1bmN0aW9uKHByb3BlcnRpZXMpIHsKICBmb3IgKHZh
        ciBrZXkgaW4gcHJvcGVydGllcykgewogICAgaWYgKHByb3BlcnRpZXMuaGFz
        T3duUHJvcGVydHkoa2V5KSAmJiBwcm9wZXJ0aWVzW2tleV0pIHsKICAgICAg
        cmV0dXJuIHByb3BlcnRpZXNba2V5XTsKICAgIH0KICB9CiAgcmV0dXJuIG51
        bGw7Cn0pOwoKLyoqCiAgQSBjb21wdXRlZCBwcm9wZXJ0eSB0aGF0IHJldHVy
        bnMgdGhlIGFycmF5IG9mIHZhbHVlcwogIGZvciB0aGUgcHJvdmlkZWQgZGVw
        ZW5kZW50IHByb3BlcnRpZXMuCgogIEV4YW1wbGUKCiAgYGBgamF2YXNjcmlw
        dAogIHZhciBIYW1wc3RlciA9IEVtYmVyLk9iamVjdC5leHRlbmQoewogICAg
        Y2xvdGhlczogRW1iZXIuY29tcHV0ZWQubWFwKCdoYXQnLCAnc2hpcnQnKQog
        IH0pOwogIHZhciBoYW1wc3RlciA9IEhhbXBzdGVyLmNyZWF0ZSgpOwogIGhh
        bXBzdGVyLmdldCgnY2xvdGhlcycpOyAvLyBbbnVsbCwgbnVsbF0KICBoYW1w
        c3Rlci5zZXQoJ2hhdCcsICdDYW1wIEhhdCcpOwogIGhhbXBzdGVyLnNldCgn
        c2hpcnQnLCAnQ2FtcCBTaGlydCcpOwogIGhhbXBzdGVyLmdldCgnY2xvdGhl
        cycpOyAvLyBbJ0NhbXAgSGF0JywgJ0NhbXAgU2hpcnQnXQogIGBgYAoKICBA
        bWV0aG9kIGNvbXB1dGVkLm1hcAogIEBmb3IgRW1iZXIKICBAcGFyYW0ge1N0
        cmluZ30gZGVwZW5kZW50S2V5LCBbZGVwZW5kZW50S2V5Li4uXQogIEByZXR1
        cm4ge0VtYmVyLkNvbXB1dGVkUHJvcGVydHl9IGNvbXB1dGVkIHByb3BlcnR5
        IHdoaWNoIG1hcHMKICB2YWx1ZXMgb2YgYWxsIHBhc3NlZCBwcm9wZXJ0aWVz
        IGluIHRvIGFuIGFycmF5LgoqLwpyZWdpc3RlckNvbXB1dGVkV2l0aFByb3Bl
        cnRpZXMoJ2NvbGxlY3QnLCBmdW5jdGlvbihwcm9wZXJ0aWVzKSB7CiAgdmFy
        IHJlcyA9IFtdOwogIGZvciAodmFyIGtleSBpbiBwcm9wZXJ0aWVzKSB7CiAg
        ICBpZiAocHJvcGVydGllcy5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7CiAgICAg
        IGlmIChFbWJlci5pc05vbmUocHJvcGVydGllc1trZXldKSkgewogICAgICAg
        IHJlcy5wdXNoKG51bGwpOwogICAgICB9IGVsc2UgewogICAgICAgIHJlcy5w
        dXNoKHByb3BlcnRpZXNba2V5XSk7CiAgICAgIH0KICAgIH0KICB9CiAgcmV0
        dXJuIHJlczsKfSk7CgovKioKICBDcmVhdGVzIGEgbmV3IHByb3BlcnR5IHRo
        YXQgaXMgYW4gYWxpYXMgZm9yIGFub3RoZXIgcHJvcGVydHkKICBvbiBhbiBv
        YmplY3QuIENhbGxzIHRvIGBnZXRgIG9yIGBzZXRgIHRoaXMgcHJvcGVydHkg
        YmVoYXZlIGFzCiAgdGhvdWdoIHRoZXkgd2VyZSBjYWxsZWQgb24gdGhlIG9y
        aWdpbmFsIHByb3BlcnR5LgoKICBgYGBqYXZhc2NyaXB0CiAgUGVyc29uID0g
        RW1iZXIuT2JqZWN0LmV4dGVuZCh7CiAgICBuYW1lOiAnQWxleCBNYXRjaG5l
        ZXInLAogICAgbm9tZW46IEVtYmVyLmNvbXB1dGVkLmFsaWFzKCduYW1lJykK
        ICB9KTsKCiAgYWxleCA9IFBlcnNvbi5jcmVhdGUoKTsKICBhbGV4LmdldCgn
        bm9tZW4nKTsgLy8gJ0FsZXggTWF0Y2huZWVyJwogIGFsZXguZ2V0KCduYW1l
        Jyk7ICAvLyAnQWxleCBNYXRjaG5lZXInCgogIGFsZXguc2V0KCdub21lbics
        ICdAbWFjaHR5Jyk7CiAgYWxleC5nZXQoJ25hbWUnKTsgIC8vICdAbWFjaHR5
        JwogIGBgYAogIEBtZXRob2QgY29tcHV0ZWQuYWxpYXMKICBAZm9yIEVtYmVy
        CiAgQHBhcmFtIHtTdHJpbmd9IGRlcGVuZGVudEtleQogIEByZXR1cm4ge0Vt
        YmVyLkNvbXB1dGVkUHJvcGVydHl9IGNvbXB1dGVkIHByb3BlcnR5IHdoaWNo
        IGNyZWF0ZXMgYW4KICBhbGlhcyB0byB0aGUgb3JpZ2luYWwgdmFsdWUgZm9y
        IHByb3BlcnR5LgoqLwpFbWJlci5jb21wdXRlZC5hbGlhcyA9IGZ1bmN0aW9u
        KGRlcGVuZGVudEtleSkgewogIHJldHVybiBFbWJlci5jb21wdXRlZChkZXBl
        bmRlbnRLZXksIGZ1bmN0aW9uKGtleSwgdmFsdWUpIHsKICAgIGlmIChhcmd1
        bWVudHMubGVuZ3RoID4gMSkgewogICAgICBzZXQodGhpcywgZGVwZW5kZW50
        S2V5LCB2YWx1ZSk7CiAgICAgIHJldHVybiB2YWx1ZTsKICAgIH0gZWxzZSB7
        CiAgICAgIHJldHVybiBnZXQodGhpcywgZGVwZW5kZW50S2V5KTsKICAgIH0K
        ICB9KTsKfTsKCi8qKgogIFdoZXJlIGBjb21wdXRlZC5hbGlhc2AgYWxpYXNl
        cyBgZ2V0YCBhbmQgYHNldGAsIGFuZCBhbGxvd3MgZm9yIGJpZGlyZWN0aW9u
        YWwKICBkYXRhIGZsb3csIGBjb21wdXRlZC5vbmVXYXlgIG9ubHkgcHJvdmlk
        ZXMgYW4gYWxpYXNlZCBgZ2V0YC4gVGhlIGBzZXRgIHdpbGwKICBub3QgbXV0
        YXRlIHRoZSB1cHN0cmVhbSBwcm9wZXJ0eSwgcmF0aGVyIGNhdXNlcyB0aGUg
        Y3VycmVudCBwcm9wZXJ0eSB0bwogIGJlY29tZSB0aGUgdmFsdWUgc2V0LiBU
        aGlzIGNhdXNlcyB0aGUgZG93bnN0cmVhbSBwcm9wZXJ0eSB0byBwZXJtZW50
        YW50bHkKICBkaXZlcmdlIGZyb20gdGhlIHVwc3RyZWFtIHByb3BlcnR5LgoK
        ICBFeGFtcGxlCgogIGBgYGphdmFzY3JpcHQKICBVc2VyID0gRW1iZXIuT2Jq
        ZWN0LmV4dGVuZCh7CiAgICBmaXJzdE5hbWU6IG51bGwsCiAgICBsYXN0TmFt
        ZTogbnVsbCwKICAgIG5pY2tOYW1lOiBFbWJlci5jb21wdXRlZC5vbmVXYXko
        J2ZpcnN0TmFtZScpCiAgfSk7CgogIHVzZXIgPSBVc2VyLmNyZWF0ZSh7CiAg
        ICBmaXJzdE5hbWU6ICdUZWRkeScsCiAgICBsYXN0TmFtZTogICdaZWVubnkn
        CiAgfSk7CgogIHVzZXIuZ2V0KCduaWNrTmFtZScpOwogICMgJ1RlZGR5JwoK
        ICB1c2VyLnNldCgnbmlja05hbWUnLCAnVGVkZHlCZWFyJyk7CiAgIyAnVGVk
        ZHlCZWFyJwoKICB1c2VyLmdldCgnZmlyc3ROYW1lJyk7CiAgIyAnVGVkZHkn
        CiAgYGBgCgogIEBtZXRob2QgY29tcHV0ZWQub25lV2F5CiAgQGZvciBFbWJl
        cgogIEBwYXJhbSB7U3RyaW5nfSBkZXBlbmRlbnRLZXkKICBAcmV0dXJuIHtF
        bWJlci5Db21wdXRlZFByb3BlcnR5fSBjb21wdXRlZCBwcm9wZXJ0eSB3aGlj
        aCBjcmVhdGVzIGEKICBvbmUgd2F5IGNvbXB1dGVkIHByb3BlcnR5IHRvIHRo
        ZSBvcmlnaW5hbCB2YWx1ZSBmb3IgcHJvcGVydHkuCiovCkVtYmVyLmNvbXB1
        dGVkLm9uZVdheSA9IGZ1bmN0aW9uKGRlcGVuZGVudEtleSkgewogIHJldHVy
        biBFbWJlci5jb21wdXRlZChkZXBlbmRlbnRLZXksIGZ1bmN0aW9uKCkgewog
        ICAgcmV0dXJuIGdldCh0aGlzLCBkZXBlbmRlbnRLZXkpOwogIH0pOwp9OwoK
        Ci8qKgogIEEgY29tcHV0ZWQgcHJvcGVydHkgdGhhdCBhY3RzIGxpa2UgYSBz
        dGFuZGFyZCBnZXR0ZXIgYW5kIHNldHRlciwKICBidXQgcmV0dXJucyB0aGUg
        dmFsdWUgYXQgdGhlIHByb3ZpZGVkIGBkZWZhdWx0UGF0aGAgaWYgdGhlCiAg
        cHJvcGVydHkgaXRzZWxmIGhhcyBub3QgYmVlbiBzZXQgdG8gYSB2YWx1ZQoK
        ICBFeGFtcGxlCgogIGBgYGphdmFzY3JpcHQKICB2YXIgSGFtcHN0ZXIgPSBF
        bWJlci5PYmplY3QuZXh0ZW5kKHsKICAgIHdpc2hMaXN0OiBFbWJlci5jb21w
        dXRlZC5kZWZhdWx0VG8oJ2Zhdm9yaXRlRm9vZCcpCiAgfSk7CiAgdmFyIGhh
        bXBzdGVyID0gSGFtcHN0ZXIuY3JlYXRlKHtmYXZvcml0ZUZvb2Q6ICdCYW5h
        bmEnfSk7CiAgaGFtcHN0ZXIuZ2V0KCd3aXNoTGlzdCcpOyAvLyAnQmFuYW5h
        JwogIGhhbXBzdGVyLnNldCgnd2lzaExpc3QnLCAnTW9yZSBVbml0IFRlc3Rz
        Jyk7CiAgaGFtcHN0ZXIuZ2V0KCd3aXNoTGlzdCcpOyAvLyAnTW9yZSBVbml0
        IFRlc3RzJwogIGhhbXBzdGVyLmdldCgnZmF2b3JpdGVGb29kJyk7IC8vICdC
        YW5hbmEnCiAgYGBgCgogIEBtZXRob2QgY29tcHV0ZWQuZGVmYXVsdFRvCiAg
        QGZvciBFbWJlcgogIEBwYXJhbSB7U3RyaW5nfSBkZWZhdWx0UGF0aAogIEBy
        ZXR1cm4ge0VtYmVyLkNvbXB1dGVkUHJvcGVydHl9IGNvbXB1dGVkIHByb3Bl
        cnR5IHdoaWNoIGFjdHMgbGlrZQogIGEgc3RhbmRhcmQgZ2V0dGVyIGFuZCBz
        ZXR0ZXIsIGJ1dCBkZWZhdWx0cyB0byB0aGUgdmFsdWUgZnJvbSBgZGVmYXVs
        dFBhdGhgLgoqLwpFbWJlci5jb21wdXRlZC5kZWZhdWx0VG8gPSBmdW5jdGlv
        bihkZWZhdWx0UGF0aCkgewogIHJldHVybiBFbWJlci5jb21wdXRlZChmdW5j
        dGlvbihrZXksIG5ld1ZhbHVlLCBjYWNoZWRWYWx1ZSkgewogICAgaWYgKGFy
        Z3VtZW50cy5sZW5ndGggPT09IDEpIHsKICAgICAgcmV0dXJuIGNhY2hlZFZh
        bHVlICE9IG51bGwgPyBjYWNoZWRWYWx1ZSA6IGdldCh0aGlzLCBkZWZhdWx0
        UGF0aCk7CiAgICB9CiAgICByZXR1cm4gbmV3VmFsdWUgIT0gbnVsbCA/IG5l
        d1ZhbHVlIDogZ2V0KHRoaXMsIGRlZmF1bHRQYXRoKTsKICB9KTsKfTsKCgoK
        fSkoKTsKCgoKKGZ1bmN0aW9uKCkgewovLyBFbWJlci50cnlGaW5hbGx5Ci8q
        KgpAbW9kdWxlIGVtYmVyLW1ldGFsCiovCgp2YXIgQUZURVJfT0JTRVJWRVJT
        ID0gJzpjaGFuZ2UnOwp2YXIgQkVGT1JFX09CU0VSVkVSUyA9ICc6YmVmb3Jl
        JzsKCmZ1bmN0aW9uIGNoYW5nZUV2ZW50KGtleU5hbWUpIHsKICByZXR1cm4g
        a2V5TmFtZStBRlRFUl9PQlNFUlZFUlM7Cn0KCmZ1bmN0aW9uIGJlZm9yZUV2
        ZW50KGtleU5hbWUpIHsKICByZXR1cm4ga2V5TmFtZStCRUZPUkVfT0JTRVJW
        RVJTOwp9CgovKioKICBAbWV0aG9kIGFkZE9ic2VydmVyCiAgQHBhcmFtIG9i
        agogIEBwYXJhbSB7U3RyaW5nfSBwYXRoCiAgQHBhcmFtIHtPYmplY3R8RnVu
        Y3Rpb259IHRhcmdldE9yTWV0aG9kCiAgQHBhcmFtIHtGdW5jdGlvbnxTdHJp
        bmd9IFttZXRob2RdCiovCkVtYmVyLmFkZE9ic2VydmVyID0gZnVuY3Rpb24o
        b2JqLCBwYXRoLCB0YXJnZXQsIG1ldGhvZCkgewogIEVtYmVyLmFkZExpc3Rl
        bmVyKG9iaiwgY2hhbmdlRXZlbnQocGF0aCksIHRhcmdldCwgbWV0aG9kKTsK
        ICBFbWJlci53YXRjaChvYmosIHBhdGgpOwogIHJldHVybiB0aGlzOwp9OwoK
        RW1iZXIub2JzZXJ2ZXJzRm9yID0gZnVuY3Rpb24ob2JqLCBwYXRoKSB7CiAg
        cmV0dXJuIEVtYmVyLmxpc3RlbmVyc0ZvcihvYmosIGNoYW5nZUV2ZW50KHBh
        dGgpKTsKfTsKCi8qKgogIEBtZXRob2QgcmVtb3ZlT2JzZXJ2ZXIKICBAcGFy
        YW0gb2JqCiAgQHBhcmFtIHtTdHJpbmd9IHBhdGgKICBAcGFyYW0ge09iamVj
        dHxGdW5jdGlvbn0gdGFyZ2V0T3JNZXRob2QKICBAcGFyYW0ge0Z1bmN0aW9u
        fFN0cmluZ30gW21ldGhvZF0KKi8KRW1iZXIucmVtb3ZlT2JzZXJ2ZXIgPSBm
        dW5jdGlvbihvYmosIHBhdGgsIHRhcmdldCwgbWV0aG9kKSB7CiAgRW1iZXIu
        dW53YXRjaChvYmosIHBhdGgpOwogIEVtYmVyLnJlbW92ZUxpc3RlbmVyKG9i
        aiwgY2hhbmdlRXZlbnQocGF0aCksIHRhcmdldCwgbWV0aG9kKTsKICByZXR1
        cm4gdGhpczsKfTsKCi8qKgogIEBtZXRob2QgYWRkQmVmb3JlT2JzZXJ2ZXIK
        ICBAcGFyYW0gb2JqCiAgQHBhcmFtIHtTdHJpbmd9IHBhdGgKICBAcGFyYW0g
        e09iamVjdHxGdW5jdGlvbn0gdGFyZ2V0T3JNZXRob2QKICBAcGFyYW0ge0Z1
        bmN0aW9ufFN0cmluZ30gW21ldGhvZF0KKi8KRW1iZXIuYWRkQmVmb3JlT2Jz
        ZXJ2ZXIgPSBmdW5jdGlvbihvYmosIHBhdGgsIHRhcmdldCwgbWV0aG9kKSB7
        CiAgRW1iZXIuYWRkTGlzdGVuZXIob2JqLCBiZWZvcmVFdmVudChwYXRoKSwg
        dGFyZ2V0LCBtZXRob2QpOwogIEVtYmVyLndhdGNoKG9iaiwgcGF0aCk7CiAg
        cmV0dXJuIHRoaXM7Cn07CgovLyBTdXNwZW5kIG9ic2VydmVyIGR1cmluZyBj
        YWxsYmFjay4KLy8KLy8gVGhpcyBzaG91bGQgb25seSBiZSB1c2VkIGJ5IHRo
        ZSB0YXJnZXQgb2YgdGhlIG9ic2VydmVyCi8vIHdoaWxlIGl0IGlzIHNldHRp
        bmcgdGhlIG9ic2VydmVkIHBhdGguCkVtYmVyLl9zdXNwZW5kQmVmb3JlT2Jz
        ZXJ2ZXIgPSBmdW5jdGlvbihvYmosIHBhdGgsIHRhcmdldCwgbWV0aG9kLCBj
        YWxsYmFjaykgewogIHJldHVybiBFbWJlci5fc3VzcGVuZExpc3RlbmVyKG9i
        aiwgYmVmb3JlRXZlbnQocGF0aCksIHRhcmdldCwgbWV0aG9kLCBjYWxsYmFj
        ayk7Cn07CgpFbWJlci5fc3VzcGVuZE9ic2VydmVyID0gZnVuY3Rpb24ob2Jq
        LCBwYXRoLCB0YXJnZXQsIG1ldGhvZCwgY2FsbGJhY2spIHsKICByZXR1cm4g
        RW1iZXIuX3N1c3BlbmRMaXN0ZW5lcihvYmosIGNoYW5nZUV2ZW50KHBhdGgp
        LCB0YXJnZXQsIG1ldGhvZCwgY2FsbGJhY2spOwp9OwoKdmFyIG1hcCA9IEVt
        YmVyLkFycmF5UG9seWZpbGxzLm1hcDsKCkVtYmVyLl9zdXNwZW5kQmVmb3Jl
        T2JzZXJ2ZXJzID0gZnVuY3Rpb24ob2JqLCBwYXRocywgdGFyZ2V0LCBtZXRo
        b2QsIGNhbGxiYWNrKSB7CiAgdmFyIGV2ZW50cyA9IG1hcC5jYWxsKHBhdGhz
        LCBiZWZvcmVFdmVudCk7CiAgcmV0dXJuIEVtYmVyLl9zdXNwZW5kTGlzdGVu
        ZXJzKG9iaiwgZXZlbnRzLCB0YXJnZXQsIG1ldGhvZCwgY2FsbGJhY2spOwp9
        OwoKRW1iZXIuX3N1c3BlbmRPYnNlcnZlcnMgPSBmdW5jdGlvbihvYmosIHBh
        dGhzLCB0YXJnZXQsIG1ldGhvZCwgY2FsbGJhY2spIHsKICB2YXIgZXZlbnRz
        ID0gbWFwLmNhbGwocGF0aHMsIGNoYW5nZUV2ZW50KTsKICByZXR1cm4gRW1i
        ZXIuX3N1c3BlbmRMaXN0ZW5lcnMob2JqLCBldmVudHMsIHRhcmdldCwgbWV0
        aG9kLCBjYWxsYmFjayk7Cn07CgpFbWJlci5iZWZvcmVPYnNlcnZlcnNGb3Ig
        PSBmdW5jdGlvbihvYmosIHBhdGgpIHsKICByZXR1cm4gRW1iZXIubGlzdGVu
        ZXJzRm9yKG9iaiwgYmVmb3JlRXZlbnQocGF0aCkpOwp9OwoKLyoqCiAgQG1l
        dGhvZCByZW1vdmVCZWZvcmVPYnNlcnZlcgogIEBwYXJhbSBvYmoKICBAcGFy
        YW0ge1N0cmluZ30gcGF0aAogIEBwYXJhbSB7T2JqZWN0fEZ1bmN0aW9ufSB0
        YXJnZXRPck1ldGhvZAogIEBwYXJhbSB7RnVuY3Rpb258U3RyaW5nfSBbbWV0
        aG9kXQoqLwpFbWJlci5yZW1vdmVCZWZvcmVPYnNlcnZlciA9IGZ1bmN0aW9u
        KG9iaiwgcGF0aCwgdGFyZ2V0LCBtZXRob2QpIHsKICBFbWJlci51bndhdGNo
        KG9iaiwgcGF0aCk7CiAgRW1iZXIucmVtb3ZlTGlzdGVuZXIob2JqLCBiZWZv
        cmVFdmVudChwYXRoKSwgdGFyZ2V0LCBtZXRob2QpOwogIHJldHVybiB0aGlz
        Owp9Owp9KSgpOwoKCgooZnVuY3Rpb24oKSB7CmRlZmluZSgiYmFja2J1cm5l
        ci9xdWV1ZSIsCiAgWyJleHBvcnRzIl0sCiAgZnVuY3Rpb24oX19leHBvcnRz
        X18pIHsKICAgICJ1c2Ugc3RyaWN0IjsKICAgIGZ1bmN0aW9uIFF1ZXVlKGRh
        cSwgbmFtZSwgb3B0aW9ucykgewogICAgICB0aGlzLmRhcSA9IGRhcTsKICAg
        ICAgdGhpcy5uYW1lID0gbmFtZTsKICAgICAgdGhpcy5vcHRpb25zID0gb3B0
        aW9uczsKICAgICAgdGhpcy5fcXVldWUgPSBbXTsKICAgIH0KCiAgICBRdWV1
        ZS5wcm90b3R5cGUgPSB7CiAgICAgIGRhcTogbnVsbCwKICAgICAgbmFtZTog
        bnVsbCwKICAgICAgb3B0aW9uczogbnVsbCwKICAgICAgX3F1ZXVlOiBudWxs
        LAoKICAgICAgcHVzaDogZnVuY3Rpb24odGFyZ2V0LCBtZXRob2QsIGFyZ3Ms
        IHN0YWNrKSB7CiAgICAgICAgdmFyIHF1ZXVlID0gdGhpcy5fcXVldWU7CiAg
        ICAgICAgcXVldWUucHVzaCh0YXJnZXQsIG1ldGhvZCwgYXJncywgc3RhY2sp
        OwogICAgICAgIHJldHVybiB7cXVldWU6IHRoaXMsIHRhcmdldDogdGFyZ2V0
        LCBtZXRob2Q6IG1ldGhvZH07CiAgICAgIH0sCgogICAgICBwdXNoVW5pcXVl
        OiBmdW5jdGlvbih0YXJnZXQsIG1ldGhvZCwgYXJncywgc3RhY2spIHsKICAg
        ICAgICB2YXIgcXVldWUgPSB0aGlzLl9xdWV1ZSwgY3VycmVudFRhcmdldCwg
        Y3VycmVudE1ldGhvZCwgaSwgbDsKCiAgICAgICAgZm9yIChpID0gMCwgbCA9
        IHF1ZXVlLmxlbmd0aDsgaSA8IGw7IGkgKz0gNCkgewogICAgICAgICAgY3Vy
        cmVudFRhcmdldCA9IHF1ZXVlW2ldOwogICAgICAgICAgY3VycmVudE1ldGhv
        ZCA9IHF1ZXVlW2krMV07CgogICAgICAgICAgaWYgKGN1cnJlbnRUYXJnZXQg
        PT09IHRhcmdldCAmJiBjdXJyZW50TWV0aG9kID09PSBtZXRob2QpIHsKICAg
        ICAgICAgICAgcXVldWVbaSsyXSA9IGFyZ3M7IC8vIHJlcGxhY2UgYXJncwog
        ICAgICAgICAgICBxdWV1ZVtpKzNdID0gc3RhY2s7IC8vIHJlcGxhY2Ugc3Rh
        Y2sKICAgICAgICAgICAgcmV0dXJuIHtxdWV1ZTogdGhpcywgdGFyZ2V0OiB0
        YXJnZXQsIG1ldGhvZDogbWV0aG9kfTsgLy8gVE9ETzogdGVzdCB0aGlzIGNv
        ZGUgcGF0aAogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgdGhpcy5f
        cXVldWUucHVzaCh0YXJnZXQsIG1ldGhvZCwgYXJncywgc3RhY2spOwogICAg
        ICAgIHJldHVybiB7cXVldWU6IHRoaXMsIHRhcmdldDogdGFyZ2V0LCBtZXRo
        b2Q6IG1ldGhvZH07CiAgICAgIH0sCgogICAgICAvLyBUT0RPOiByZW1vdmUg
        bWUsIG9ubHkgYmVpbmcgdXNlZCBmb3IgRW1iZXIucnVuLnN5bmMKICAgICAg
        Zmx1c2g6IGZ1bmN0aW9uKCkgewogICAgICAgIHZhciBxdWV1ZSA9IHRoaXMu
        X3F1ZXVlLAogICAgICAgICAgICBvcHRpb25zID0gdGhpcy5vcHRpb25zLAog
        ICAgICAgICAgICBiZWZvcmUgPSBvcHRpb25zICYmIG9wdGlvbnMuYmVmb3Jl
        LAogICAgICAgICAgICBhZnRlciA9IG9wdGlvbnMgJiYgb3B0aW9ucy5hZnRl
        ciwKICAgICAgICAgICAgdGFyZ2V0LCBtZXRob2QsIGFyZ3MsIHN0YWNrLCBp
        LCBsID0gcXVldWUubGVuZ3RoOwoKICAgICAgICBpZiAobCAmJiBiZWZvcmUp
        IHsgYmVmb3JlKCk7IH0KICAgICAgICBmb3IgKGkgPSAwOyBpIDwgbDsgaSAr
        PSA0KSB7CiAgICAgICAgICB0YXJnZXQgPSBxdWV1ZVtpXTsKICAgICAgICAg
        IG1ldGhvZCA9IHF1ZXVlW2krMV07CiAgICAgICAgICBhcmdzICAgPSBxdWV1
        ZVtpKzJdOwogICAgICAgICAgc3RhY2sgID0gcXVldWVbaSszXTsgLy8gRGVi
        dWdnaW5nIGFzc2lzdGFuY2UKCiAgICAgICAgICAvLyBUT0RPOiBlcnJvciBo
        YW5kbGluZwogICAgICAgICAgaWYgKGFyZ3MgJiYgYXJncy5sZW5ndGggPiAw
        KSB7CiAgICAgICAgICAgIG1ldGhvZC5hcHBseSh0YXJnZXQsIGFyZ3MpOwog
        ICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgbWV0aG9kLmNhbGwodGFy
        Z2V0KTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgaWYgKGwgJiYg
        YWZ0ZXIpIHsgYWZ0ZXIoKTsgfQoKICAgICAgICAvLyBjaGVjayBpZiBuZXcg
        aXRlbXMgaGF2ZSBiZWVuIGFkZGVkCiAgICAgICAgaWYgKHF1ZXVlLmxlbmd0
        aCA+IGwpIHsKICAgICAgICAgIHRoaXMuX3F1ZXVlID0gcXVldWUuc2xpY2Uo
        bCk7CiAgICAgICAgICB0aGlzLmZsdXNoKCk7CiAgICAgICAgfSBlbHNlIHsK
        ICAgICAgICAgIHRoaXMuX3F1ZXVlLmxlbmd0aCA9IDA7CiAgICAgICAgfQog
        ICAgICB9LAoKICAgICAgY2FuY2VsOiBmdW5jdGlvbihhY3Rpb25Ub0NhbmNl
        bCkgewogICAgICAgIHZhciBxdWV1ZSA9IHRoaXMuX3F1ZXVlLCBjdXJyZW50
        VGFyZ2V0LCBjdXJyZW50TWV0aG9kLCBpLCBsOwoKICAgICAgICBmb3IgKGkg
        PSAwLCBsID0gcXVldWUubGVuZ3RoOyBpIDwgbDsgaSArPSA0KSB7CiAgICAg
        ICAgICBjdXJyZW50VGFyZ2V0ID0gcXVldWVbaV07CiAgICAgICAgICBjdXJy
        ZW50TWV0aG9kID0gcXVldWVbaSsxXTsKCiAgICAgICAgICBpZiAoY3VycmVu
        dFRhcmdldCA9PT0gYWN0aW9uVG9DYW5jZWwudGFyZ2V0ICYmIGN1cnJlbnRN
        ZXRob2QgPT09IGFjdGlvblRvQ2FuY2VsLm1ldGhvZCkgewogICAgICAgICAg
        ICBxdWV1ZS5zcGxpY2UoaSwgNCk7CiAgICAgICAgICAgIHJldHVybiB0cnVl
        OwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgLy8gaWYgbm90IGZv
        dW5kIGluIGN1cnJlbnQgcXVldWUKICAgICAgICAvLyBjb3VsZCBiZSBpbiB0
        aGUgcXVldWUgdGhhdCBpcyBiZWluZyBmbHVzaGVkCiAgICAgICAgcXVldWUg
        PSB0aGlzLl9xdWV1ZUJlaW5nRmx1c2hlZDsKICAgICAgICBpZiAoIXF1ZXVl
        KSB7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIGZvciAo
        aSA9IDAsIGwgPSBxdWV1ZS5sZW5ndGg7IGkgPCBsOyBpICs9IDQpIHsKICAg
        ICAgICAgIGN1cnJlbnRUYXJnZXQgPSBxdWV1ZVtpXTsKICAgICAgICAgIGN1
        cnJlbnRNZXRob2QgPSBxdWV1ZVtpKzFdOwoKICAgICAgICAgIGlmIChjdXJy
        ZW50VGFyZ2V0ID09PSBhY3Rpb25Ub0NhbmNlbC50YXJnZXQgJiYgY3VycmVu
        dE1ldGhvZCA9PT0gYWN0aW9uVG9DYW5jZWwubWV0aG9kKSB7CiAgICAgICAg
        ICAgIC8vIGRvbid0IG1lc3Mgd2l0aCBhcnJheSBkdXJpbmcgZmx1c2gKICAg
        ICAgICAgICAgLy8ganVzdCBudWxsaWZ5IHRoZSBtZXRob2QKICAgICAgICAg
        ICAgcXVldWVbaSsxXSA9IG51bGw7CiAgICAgICAgICAgIHJldHVybiB0cnVl
        OwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfTsKCgogICAg
        X19leHBvcnRzX18uUXVldWUgPSBRdWV1ZTsKICB9KTsKCmRlZmluZSgiYmFj
        a2J1cm5lci9kZWZlcnJlZF9hY3Rpb25fcXVldWVzIiwKICBbImJhY2tidXJu
        ZXIvcXVldWUiLCJleHBvcnRzIl0sCiAgZnVuY3Rpb24oX19kZXBlbmRlbmN5
        MV9fLCBfX2V4cG9ydHNfXykgewogICAgInVzZSBzdHJpY3QiOwogICAgdmFy
        IFF1ZXVlID0gX19kZXBlbmRlbmN5MV9fLlF1ZXVlOwoKICAgIGZ1bmN0aW9u
        IERlZmVycmVkQWN0aW9uUXVldWVzKHF1ZXVlTmFtZXMsIG9wdGlvbnMpIHsK
        ICAgICAgdmFyIHF1ZXVlcyA9IHRoaXMucXVldWVzID0ge307CiAgICAgIHRo
        aXMucXVldWVOYW1lcyA9IHF1ZXVlTmFtZXMgPSBxdWV1ZU5hbWVzIHx8IFtd
        OwoKICAgICAgdmFyIHF1ZXVlTmFtZTsKICAgICAgZm9yICh2YXIgaSA9IDAs
        IGwgPSBxdWV1ZU5hbWVzLmxlbmd0aDsgaSA8IGw7IGkrKykgewogICAgICAg
        IHF1ZXVlTmFtZSA9IHF1ZXVlTmFtZXNbaV07CiAgICAgICAgcXVldWVzW3F1
        ZXVlTmFtZV0gPSBuZXcgUXVldWUodGhpcywgcXVldWVOYW1lLCBvcHRpb25z
        W3F1ZXVlTmFtZV0pOwogICAgICB9CiAgICB9CgogICAgRGVmZXJyZWRBY3Rp
        b25RdWV1ZXMucHJvdG90eXBlID0gewogICAgICBxdWV1ZU5hbWVzOiBudWxs
        LAogICAgICBxdWV1ZXM6IG51bGwsCgogICAgICBzY2hlZHVsZTogZnVuY3Rp
        b24ocXVldWVOYW1lLCB0YXJnZXQsIG1ldGhvZCwgYXJncywgb25jZUZsYWcs
        IHN0YWNrKSB7CiAgICAgICAgdmFyIHF1ZXVlcyA9IHRoaXMucXVldWVzLAog
        ICAgICAgICAgICBxdWV1ZSA9IHF1ZXVlc1txdWV1ZU5hbWVdOwoKICAgICAg
        ICBpZiAoIXF1ZXVlKSB7IHRocm93IG5ldyBFcnJvcigiWW91IGF0dGVtcHRl
        ZCB0byBzY2hlZHVsZSBhbiBhY3Rpb24gaW4gYSBxdWV1ZSAoIiArIHF1ZXVl
        TmFtZSArICIpIHRoYXQgZG9lc24ndCBleGlzdCIpOyB9CgogICAgICAgIGlm
        IChvbmNlRmxhZykgewogICAgICAgICAgcmV0dXJuIHF1ZXVlLnB1c2hVbmlx
        dWUodGFyZ2V0LCBtZXRob2QsIGFyZ3MsIHN0YWNrKTsKICAgICAgICB9IGVs
        c2UgewogICAgICAgICAgcmV0dXJuIHF1ZXVlLnB1c2godGFyZ2V0LCBtZXRo
        b2QsIGFyZ3MsIHN0YWNrKTsKICAgICAgICB9CiAgICAgIH0sCgogICAgICBm
        bHVzaDogZnVuY3Rpb24oKSB7CiAgICAgICAgdmFyIHF1ZXVlcyA9IHRoaXMu
        cXVldWVzLAogICAgICAgICAgICBxdWV1ZU5hbWVzID0gdGhpcy5xdWV1ZU5h
        bWVzLAogICAgICAgICAgICBxdWV1ZU5hbWUsIHF1ZXVlLCBxdWV1ZUl0ZW1z
        LCBwcmlvclF1ZXVlTmFtZUluZGV4LAogICAgICAgICAgICBxdWV1ZU5hbWVJ
        bmRleCA9IDAsIG51bWJlck9mUXVldWVzID0gcXVldWVOYW1lcy5sZW5ndGg7
        CgogICAgICAgIG91dGVybG9vcDoKICAgICAgICB3aGlsZSAocXVldWVOYW1l
        SW5kZXggPCBudW1iZXJPZlF1ZXVlcykgewogICAgICAgICAgcXVldWVOYW1l
        ID0gcXVldWVOYW1lc1txdWV1ZU5hbWVJbmRleF07CiAgICAgICAgICBxdWV1
        ZSA9IHF1ZXVlc1txdWV1ZU5hbWVdOwogICAgICAgICAgcXVldWVJdGVtcyA9
        IHF1ZXVlLl9xdWV1ZUJlaW5nRmx1c2hlZCA9IHF1ZXVlLl9xdWV1ZS5zbGlj
        ZSgpOwogICAgICAgICAgcXVldWUuX3F1ZXVlID0gW107CgogICAgICAgICAg
        dmFyIG9wdGlvbnMgPSBxdWV1ZS5vcHRpb25zLAogICAgICAgICAgICAgIGJl
        Zm9yZSA9IG9wdGlvbnMgJiYgb3B0aW9ucy5iZWZvcmUsCiAgICAgICAgICAg
        ICAgYWZ0ZXIgPSBvcHRpb25zICYmIG9wdGlvbnMuYWZ0ZXIsCiAgICAgICAg
        ICAgICAgdGFyZ2V0LCBtZXRob2QsIGFyZ3MsIHN0YWNrLAogICAgICAgICAg
        ICAgIHF1ZXVlSW5kZXggPSAwLCBudW1iZXJPZlF1ZXVlSXRlbXMgPSBxdWV1
        ZUl0ZW1zLmxlbmd0aDsKCiAgICAgICAgICBpZiAobnVtYmVyT2ZRdWV1ZUl0
        ZW1zICYmIGJlZm9yZSkgeyBiZWZvcmUoKTsgfQogICAgICAgICAgd2hpbGUg
        KHF1ZXVlSW5kZXggPCBudW1iZXJPZlF1ZXVlSXRlbXMpIHsKICAgICAgICAg
        ICAgdGFyZ2V0ID0gcXVldWVJdGVtc1txdWV1ZUluZGV4XTsKICAgICAgICAg
        ICAgbWV0aG9kID0gcXVldWVJdGVtc1txdWV1ZUluZGV4KzFdOwogICAgICAg
        ICAgICBhcmdzICAgPSBxdWV1ZUl0ZW1zW3F1ZXVlSW5kZXgrMl07CiAgICAg
        ICAgICAgIHN0YWNrICA9IHF1ZXVlSXRlbXNbcXVldWVJbmRleCszXTsgLy8g
        RGVidWdnaW5nIGFzc2lzdGFuY2UKCiAgICAgICAgICAgIGlmICh0eXBlb2Yg
        bWV0aG9kID09PSAnc3RyaW5nJykgeyBtZXRob2QgPSB0YXJnZXRbbWV0aG9k
        XTsgfQoKICAgICAgICAgICAgLy8gbWV0aG9kIGNvdWxkIGhhdmUgYmVlbiBu
        dWxsaWZpZWQgLyBjYW5jZWxlZCBkdXJpbmcgZmx1c2gKICAgICAgICAgICAg
        aWYgKG1ldGhvZCkgewogICAgICAgICAgICAgIC8vIFRPRE86IGVycm9yIGhh
        bmRsaW5nCiAgICAgICAgICAgICAgaWYgKGFyZ3MgJiYgYXJncy5sZW5ndGgg
        PiAwKSB7CiAgICAgICAgICAgICAgICBtZXRob2QuYXBwbHkodGFyZ2V0LCBh
        cmdzKTsKICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAg
        bWV0aG9kLmNhbGwodGFyZ2V0KTsKICAgICAgICAgICAgICB9CiAgICAgICAg
        ICAgIH0KCiAgICAgICAgICAgIHF1ZXVlSW5kZXggKz0gNDsKICAgICAgICAg
        IH0KICAgICAgICAgIHF1ZXVlLl9xdWV1ZUJlaW5nRmx1c2hlZCA9IG51bGw7
        CiAgICAgICAgICBpZiAobnVtYmVyT2ZRdWV1ZUl0ZW1zICYmIGFmdGVyKSB7
        IGFmdGVyKCk7IH0KCiAgICAgICAgICBpZiAoKHByaW9yUXVldWVOYW1lSW5k
        ZXggPSBpbmRleE9mUHJpb3JRdWV1ZVdpdGhBY3Rpb25zKHRoaXMsIHF1ZXVl
        TmFtZUluZGV4KSkgIT09IC0xKSB7CiAgICAgICAgICAgIHF1ZXVlTmFtZUlu
        ZGV4ID0gcHJpb3JRdWV1ZU5hbWVJbmRleDsKICAgICAgICAgICAgY29udGlu
        dWUgb3V0ZXJsb29wOwogICAgICAgICAgfQoKICAgICAgICAgIHF1ZXVlTmFt
        ZUluZGV4Kys7CiAgICAgICAgfQogICAgICB9CiAgICB9OwoKICAgIGZ1bmN0
        aW9uIGluZGV4T2ZQcmlvclF1ZXVlV2l0aEFjdGlvbnMoZGFxLCBjdXJyZW50
        UXVldWVJbmRleCkgewogICAgICB2YXIgcXVldWVOYW1lLCBxdWV1ZTsKCiAg
        ICAgIGZvciAodmFyIGkgPSAwLCBsID0gY3VycmVudFF1ZXVlSW5kZXg7IGkg
        PD0gbDsgaSsrKSB7CiAgICAgICAgcXVldWVOYW1lID0gZGFxLnF1ZXVlTmFt
        ZXNbaV07CiAgICAgICAgcXVldWUgPSBkYXEucXVldWVzW3F1ZXVlTmFtZV07
        CiAgICAgICAgaWYgKHF1ZXVlLl9xdWV1ZS5sZW5ndGgpIHsgcmV0dXJuIGk7
        IH0KICAgICAgfQoKICAgICAgcmV0dXJuIC0xOwogICAgfQoKCiAgICBfX2V4
        cG9ydHNfXy5EZWZlcnJlZEFjdGlvblF1ZXVlcyA9IERlZmVycmVkQWN0aW9u
        UXVldWVzOwogIH0pOwoKZGVmaW5lKCJiYWNrYnVybmVyIiwKICBbImJhY2ti
        dXJuZXIvZGVmZXJyZWRfYWN0aW9uX3F1ZXVlcyIsImV4cG9ydHMiXSwKICBm
        dW5jdGlvbihfX2RlcGVuZGVuY3kxX18sIF9fZXhwb3J0c19fKSB7CiAgICAi
        dXNlIHN0cmljdCI7CiAgICB2YXIgRGVmZXJyZWRBY3Rpb25RdWV1ZXMgPSBf
        X2RlcGVuZGVuY3kxX18uRGVmZXJyZWRBY3Rpb25RdWV1ZXM7CgogICAgdmFy
        IHNsaWNlID0gW10uc2xpY2UsCiAgICAgICAgcG9wID0gW10ucG9wLAogICAg
        ICAgIHRocm90dGxlcnMgPSBbXSwKICAgICAgICBkZWJvdW5jZWVzID0gW10s
        CiAgICAgICAgdGltZXJzID0gW10sCiAgICAgICAgYXV0b3J1biwgbGF0ZXJU
        aW1lciwgbGF0ZXJUaW1lckV4cGlyZXNBdCwKICAgICAgICBnbG9iYWwgPSB0
        aGlzLAogICAgICAgIE5VTUJFUiA9IC9cZCsvOwoKICAgIGZ1bmN0aW9uIGlz
        Q29lcmNhYmxlTnVtYmVyKG51bWJlcikgewogICAgICByZXR1cm4gdHlwZW9m
        IG51bWJlciA9PT0gJ251bWJlcicgfHwgTlVNQkVSLnRlc3QobnVtYmVyKTsK
        ICAgIH0KCiAgICBmdW5jdGlvbiBCYWNrYnVybmVyKHF1ZXVlTmFtZXMsIG9w
        dGlvbnMpIHsKICAgICAgdGhpcy5xdWV1ZU5hbWVzID0gcXVldWVOYW1lczsK
        ICAgICAgdGhpcy5vcHRpb25zID0gb3B0aW9ucyB8fCB7fTsKICAgICAgaWYg
        KCF0aGlzLm9wdGlvbnMuZGVmYXVsdFF1ZXVlKSB7CiAgICAgICAgdGhpcy5v
        cHRpb25zLmRlZmF1bHRRdWV1ZSA9IHF1ZXVlTmFtZXNbMF07CiAgICAgIH0K
        ICAgICAgdGhpcy5pbnN0YW5jZVN0YWNrID0gW107CiAgICB9CgogICAgQmFj
        a2J1cm5lci5wcm90b3R5cGUgPSB7CiAgICAgIHF1ZXVlTmFtZXM6IG51bGws
        CiAgICAgIG9wdGlvbnM6IG51bGwsCiAgICAgIGN1cnJlbnRJbnN0YW5jZTog
        bnVsbCwKICAgICAgaW5zdGFuY2VTdGFjazogbnVsbCwKCiAgICAgIGJlZ2lu
        OiBmdW5jdGlvbigpIHsKICAgICAgICB2YXIgb25CZWdpbiA9IHRoaXMub3B0
        aW9ucyAmJiB0aGlzLm9wdGlvbnMub25CZWdpbiwKICAgICAgICAgICAgcHJl
        dmlvdXNJbnN0YW5jZSA9IHRoaXMuY3VycmVudEluc3RhbmNlOwoKICAgICAg
        ICBpZiAocHJldmlvdXNJbnN0YW5jZSkgewogICAgICAgICAgdGhpcy5pbnN0
        YW5jZVN0YWNrLnB1c2gocHJldmlvdXNJbnN0YW5jZSk7CiAgICAgICAgfQoK
        ICAgICAgICB0aGlzLmN1cnJlbnRJbnN0YW5jZSA9IG5ldyBEZWZlcnJlZEFj
        dGlvblF1ZXVlcyh0aGlzLnF1ZXVlTmFtZXMsIHRoaXMub3B0aW9ucyk7CiAg
        ICAgICAgaWYgKG9uQmVnaW4pIHsKICAgICAgICAgIG9uQmVnaW4odGhpcy5j
        dXJyZW50SW5zdGFuY2UsIHByZXZpb3VzSW5zdGFuY2UpOwogICAgICAgIH0K
        ICAgICAgfSwKCiAgICAgIGVuZDogZnVuY3Rpb24oKSB7CiAgICAgICAgdmFy
        IG9uRW5kID0gdGhpcy5vcHRpb25zICYmIHRoaXMub3B0aW9ucy5vbkVuZCwK
        ICAgICAgICAgICAgY3VycmVudEluc3RhbmNlID0gdGhpcy5jdXJyZW50SW5z
        dGFuY2UsCiAgICAgICAgICAgIG5leHRJbnN0YW5jZSA9IG51bGw7CgogICAg
        ICAgIHRyeSB7CiAgICAgICAgICBjdXJyZW50SW5zdGFuY2UuZmx1c2goKTsK
        ICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgdGhpcy5jdXJyZW50SW5z
        dGFuY2UgPSBudWxsOwoKICAgICAgICAgIGlmICh0aGlzLmluc3RhbmNlU3Rh
        Y2subGVuZ3RoKSB7CiAgICAgICAgICAgIG5leHRJbnN0YW5jZSA9IHRoaXMu
        aW5zdGFuY2VTdGFjay5wb3AoKTsKICAgICAgICAgICAgdGhpcy5jdXJyZW50
        SW5zdGFuY2UgPSBuZXh0SW5zdGFuY2U7CiAgICAgICAgICB9CgogICAgICAg
        ICAgaWYgKG9uRW5kKSB7CiAgICAgICAgICAgIG9uRW5kKGN1cnJlbnRJbnN0
        YW5jZSwgbmV4dEluc3RhbmNlKTsKICAgICAgICAgIH0KICAgICAgICB9CiAg
        ICAgIH0sCgogICAgICBydW46IGZ1bmN0aW9uKHRhcmdldCwgbWV0aG9kIC8q
        LCBhcmdzICovKSB7CiAgICAgICAgdmFyIHJldDsKICAgICAgICB0aGlzLmJl
        Z2luKCk7CgogICAgICAgIGlmICghbWV0aG9kKSB7CiAgICAgICAgICBtZXRo
        b2QgPSB0YXJnZXQ7CiAgICAgICAgICB0YXJnZXQgPSBudWxsOwogICAgICAg
        IH0KCiAgICAgICAgaWYgKHR5cGVvZiBtZXRob2QgPT09ICdzdHJpbmcnKSB7
        CiAgICAgICAgICBtZXRob2QgPSB0YXJnZXRbbWV0aG9kXTsKICAgICAgICB9
        CgogICAgICAgIC8vIFByZXZlbnQgU2FmYXJpIGRvdWJsZS1maW5hbGx5Lgog
        ICAgICAgIHZhciBmaW5hbGx5QWxyZWFkeUNhbGxlZCA9IGZhbHNlOwogICAg
        ICAgIHRyeSB7CiAgICAgICAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA+IDIp
        IHsKICAgICAgICAgICAgcmV0ID0gbWV0aG9kLmFwcGx5KHRhcmdldCwgc2xp
        Y2UuY2FsbChhcmd1bWVudHMsIDIpKTsKICAgICAgICAgIH0gZWxzZSB7CiAg
        ICAgICAgICAgIHJldCA9IG1ldGhvZC5jYWxsKHRhcmdldCk7CiAgICAgICAg
        ICB9CiAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgIGlmICghZmluYWxs
        eUFscmVhZHlDYWxsZWQpIHsKICAgICAgICAgICAgZmluYWxseUFscmVhZHlD
        YWxsZWQgPSB0cnVlOwogICAgICAgICAgICB0aGlzLmVuZCgpOwogICAgICAg
        ICAgfQogICAgICAgIH0KICAgICAgICByZXR1cm4gcmV0OwogICAgICB9LAoK
        ICAgICAgZGVmZXI6IGZ1bmN0aW9uKHF1ZXVlTmFtZSwgdGFyZ2V0LCBtZXRo
        b2QgLyogLCBhcmdzICovKSB7CiAgICAgICAgaWYgKCFtZXRob2QpIHsKICAg
        ICAgICAgIG1ldGhvZCA9IHRhcmdldDsKICAgICAgICAgIHRhcmdldCA9IG51
        bGw7CiAgICAgICAgfQoKICAgICAgICBpZiAodHlwZW9mIG1ldGhvZCA9PT0g
        J3N0cmluZycpIHsKICAgICAgICAgIG1ldGhvZCA9IHRhcmdldFttZXRob2Rd
        OwogICAgICAgIH0KCiAgICAgICAgdmFyIHN0YWNrID0gdGhpcy5ERUJVRyA/
        IG5ldyBFcnJvcigpLnN0YWNrIDogdW5kZWZpbmVkLAogICAgICAgICAgICBh
        cmdzID0gYXJndW1lbnRzLmxlbmd0aCA+IDMgPyBzbGljZS5jYWxsKGFyZ3Vt
        ZW50cywgMykgOiB1bmRlZmluZWQ7CiAgICAgICAgaWYgKCF0aGlzLmN1cnJl
        bnRJbnN0YW5jZSkgeyBjcmVhdGVBdXRvcnVuKHRoaXMpOyB9CiAgICAgICAg
        cmV0dXJuIHRoaXMuY3VycmVudEluc3RhbmNlLnNjaGVkdWxlKHF1ZXVlTmFt
        ZSwgdGFyZ2V0LCBtZXRob2QsIGFyZ3MsIGZhbHNlLCBzdGFjayk7CiAgICAg
        IH0sCgogICAgICBkZWZlck9uY2U6IGZ1bmN0aW9uKHF1ZXVlTmFtZSwgdGFy
        Z2V0LCBtZXRob2QgLyogLCBhcmdzICovKSB7CiAgICAgICAgaWYgKCFtZXRo
        b2QpIHsKICAgICAgICAgIG1ldGhvZCA9IHRhcmdldDsKICAgICAgICAgIHRh
        cmdldCA9IG51bGw7CiAgICAgICAgfQoKICAgICAgICBpZiAodHlwZW9mIG1l
        dGhvZCA9PT0gJ3N0cmluZycpIHsKICAgICAgICAgIG1ldGhvZCA9IHRhcmdl
        dFttZXRob2RdOwogICAgICAgIH0KCiAgICAgICAgdmFyIHN0YWNrID0gdGhp
        cy5ERUJVRyA/IG5ldyBFcnJvcigpLnN0YWNrIDogdW5kZWZpbmVkLAogICAg
        ICAgICAgICBhcmdzID0gYXJndW1lbnRzLmxlbmd0aCA+IDMgPyBzbGljZS5j
        YWxsKGFyZ3VtZW50cywgMykgOiB1bmRlZmluZWQ7CiAgICAgICAgaWYgKCF0
        aGlzLmN1cnJlbnRJbnN0YW5jZSkgeyBjcmVhdGVBdXRvcnVuKHRoaXMpOyB9
        CiAgICAgICAgcmV0dXJuIHRoaXMuY3VycmVudEluc3RhbmNlLnNjaGVkdWxl
        KHF1ZXVlTmFtZSwgdGFyZ2V0LCBtZXRob2QsIGFyZ3MsIHRydWUsIHN0YWNr
        KTsKICAgICAgfSwKCiAgICAgIHNldFRpbWVvdXQ6IGZ1bmN0aW9uKCkgewog
        ICAgICAgIHZhciBhcmdzID0gc2xpY2UuY2FsbChhcmd1bWVudHMpOwogICAg
        ICAgIHZhciBsZW5ndGggPSBhcmdzLmxlbmd0aDsKICAgICAgICB2YXIgbWV0
        aG9kLCB3YWl0LCB0YXJnZXQ7CiAgICAgICAgdmFyIHNlbGYgPSB0aGlzOwog
        ICAgICAgIHZhciBtZXRob2RPclRhcmdldCwgbWV0aG9kT3JXYWl0LCBtZXRo
        b2RPckFyZ3M7CgogICAgICAgIGlmIChsZW5ndGggPT09IDApIHsKICAgICAg
        ICAgIHJldHVybjsKICAgICAgICB9IGVsc2UgaWYgKGxlbmd0aCA9PT0gMSkg
        ewogICAgICAgICAgbWV0aG9kID0gYXJncy5zaGlmdCgpOwogICAgICAgICAg
        d2FpdCA9IDA7CiAgICAgICAgfSBlbHNlIGlmIChsZW5ndGggPT09IDIpIHsK
        ICAgICAgICAgIG1ldGhvZE9yVGFyZ2V0ID0gYXJnc1swXTsKICAgICAgICAg
        IG1ldGhvZE9yV2FpdCA9IGFyZ3NbMV07CgogICAgICAgICAgaWYgKHR5cGVv
        ZiBtZXRob2RPcldhaXQgPT09ICdmdW5jdGlvbicgfHwgdHlwZW9mICBtZXRo
        b2RPclRhcmdldFttZXRob2RPcldhaXRdID09PSAnZnVuY3Rpb24nKSB7CiAg
        ICAgICAgICAgIHRhcmdldCA9IGFyZ3Muc2hpZnQoKTsKICAgICAgICAgICAg
        bWV0aG9kID0gYXJncy5zaGlmdCgpOwogICAgICAgICAgICB3YWl0ID0gMDsK
        ICAgICAgICAgIH0gZWxzZSBpZiAoaXNDb2VyY2FibGVOdW1iZXIobWV0aG9k
        T3JXYWl0KSkgewogICAgICAgICAgICBtZXRob2QgPSBhcmdzLnNoaWZ0KCk7
        CiAgICAgICAgICAgIHdhaXQgPSBhcmdzLnNoaWZ0KCk7CiAgICAgICAgICB9
        IGVsc2UgewogICAgICAgICAgICBtZXRob2QgPSBhcmdzLnNoaWZ0KCk7CiAg
        ICAgICAgICAgIHdhaXQgPSAgMDsKICAgICAgICAgIH0KICAgICAgICB9IGVs
        c2UgewogICAgICAgICAgdmFyIGxhc3QgPSBhcmdzW2FyZ3MubGVuZ3RoIC0g
        MV07CgogICAgICAgICAgaWYgKGlzQ29lcmNhYmxlTnVtYmVyKGxhc3QpKSB7
        CiAgICAgICAgICAgIHdhaXQgPSBhcmdzLnBvcCgpOwogICAgICAgICAgfQoK
        ICAgICAgICAgIG1ldGhvZE9yVGFyZ2V0ID0gYXJnc1swXTsKICAgICAgICAg
        IG1ldGhvZE9yQXJncyA9IGFyZ3NbMV07CgogICAgICAgICAgaWYgKHR5cGVv
        ZiBtZXRob2RPckFyZ3MgPT09ICdmdW5jdGlvbicgfHwgKHR5cGVvZiBtZXRo
        b2RPckFyZ3MgPT09ICdzdHJpbmcnICYmCiAgICAgICAgICAgICAgICAgICAg
        ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWV0aG9kT3JUYXJn
        ZXQgIT09IG51bGwgJiYKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
        ICAgICAgICAgICAgICAgICAgICAgICBtZXRob2RPckFyZ3MgaW4gbWV0aG9k
        T3JUYXJnZXQpKSB7CiAgICAgICAgICAgIHRhcmdldCA9IGFyZ3Muc2hpZnQo
        KTsKICAgICAgICAgICAgbWV0aG9kID0gYXJncy5zaGlmdCgpOwogICAgICAg
        ICAgfSBlbHNlIHsKICAgICAgICAgICAgbWV0aG9kID0gYXJncy5zaGlmdCgp
        OwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgdmFyIGV4ZWN1dGVB
        dCA9ICgrbmV3IERhdGUoKSkgKyBwYXJzZUludCh3YWl0LCAxMCk7CgogICAg
        ICAgIGlmICh0eXBlb2YgbWV0aG9kID09PSAnc3RyaW5nJykgewogICAgICAg
        ICAgbWV0aG9kID0gdGFyZ2V0W21ldGhvZF07CiAgICAgICAgfQoKICAgICAg
        ICBmdW5jdGlvbiBmbigpIHsKICAgICAgICAgIG1ldGhvZC5hcHBseSh0YXJn
        ZXQsIGFyZ3MpOwogICAgICAgIH0KCiAgICAgICAgLy8gZmluZCBwb3NpdGlv
        biB0byBpbnNlcnQgLSBUT0RPOiBiaW5hcnkgc2VhcmNoCiAgICAgICAgdmFy
        IGksIGw7CiAgICAgICAgZm9yIChpID0gMCwgbCA9IHRpbWVycy5sZW5ndGg7
        IGkgPCBsOyBpICs9IDIpIHsKICAgICAgICAgIGlmIChleGVjdXRlQXQgPCB0
        aW1lcnNbaV0pIHsgYnJlYWs7IH0KICAgICAgICB9CgogICAgICAgIHRpbWVy
        cy5zcGxpY2UoaSwgMCwgZXhlY3V0ZUF0LCBmbik7CgogICAgICAgIGlmIChs
        YXRlclRpbWVyICYmIGxhdGVyVGltZXJFeHBpcmVzQXQgPCBleGVjdXRlQXQp
        IHsgcmV0dXJuIGZuOyB9CgogICAgICAgIGlmIChsYXRlclRpbWVyKSB7CiAg
        ICAgICAgICBjbGVhclRpbWVvdXQobGF0ZXJUaW1lcik7CiAgICAgICAgICBs
        YXRlclRpbWVyID0gbnVsbDsKICAgICAgICB9CiAgICAgICAgbGF0ZXJUaW1l
        ciA9IGdsb2JhbC5zZXRUaW1lb3V0KGZ1bmN0aW9uKCkgewogICAgICAgICAg
        ZXhlY3V0ZVRpbWVycyhzZWxmKTsKICAgICAgICAgIGxhdGVyVGltZXIgPSBu
        dWxsOwogICAgICAgICAgbGF0ZXJUaW1lckV4cGlyZXNBdCA9IG51bGw7CiAg
        ICAgICAgfSwgd2FpdCk7CiAgICAgICAgbGF0ZXJUaW1lckV4cGlyZXNBdCA9
        IGV4ZWN1dGVBdDsKCiAgICAgICAgcmV0dXJuIGZuOwogICAgICB9LAoKICAg
        ICAgdGhyb3R0bGU6IGZ1bmN0aW9uKHRhcmdldCwgbWV0aG9kIC8qICwgYXJn
        cywgd2FpdCAqLykgewogICAgICAgIHZhciBzZWxmID0gdGhpcywKICAgICAg
        ICAgICAgYXJncyA9IGFyZ3VtZW50cywKICAgICAgICAgICAgd2FpdCA9IHBv
        cC5jYWxsKGFyZ3MpLAogICAgICAgICAgICB0aHJvdHRsZXI7CgogICAgICAg
        IGZvciAodmFyIGkgPSAwLCBsID0gdGhyb3R0bGVycy5sZW5ndGg7IGkgPCBs
        OyBpKyspIHsKICAgICAgICAgIHRocm90dGxlciA9IHRocm90dGxlcnNbaV07
        CiAgICAgICAgICBpZiAodGhyb3R0bGVyWzBdID09PSB0YXJnZXQgJiYgdGhy
        b3R0bGVyWzFdID09PSBtZXRob2QpIHsgcmV0dXJuOyB9IC8vIGRvIG5vdGhp
        bmcKICAgICAgICB9CgogICAgICAgIHZhciB0aW1lciA9IGdsb2JhbC5zZXRU
        aW1lb3V0KGZ1bmN0aW9uKCkgewogICAgICAgICAgc2VsZi5ydW4uYXBwbHko
        c2VsZiwgYXJncyk7CgogICAgICAgICAgLy8gcmVtb3ZlIHRocm90dGxlcgog
        ICAgICAgICAgdmFyIGluZGV4ID0gLTE7CiAgICAgICAgICBmb3IgKHZhciBp
        ID0gMCwgbCA9IHRocm90dGxlcnMubGVuZ3RoOyBpIDwgbDsgaSsrKSB7CiAg
        ICAgICAgICAgIHRocm90dGxlciA9IHRocm90dGxlcnNbaV07CiAgICAgICAg
        ICAgIGlmICh0aHJvdHRsZXJbMF0gPT09IHRhcmdldCAmJiB0aHJvdHRsZXJb
        MV0gPT09IG1ldGhvZCkgewogICAgICAgICAgICAgIGluZGV4ID0gaTsKICAg
        ICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQogICAgICAgICAgfQoK
        ICAgICAgICAgIGlmIChpbmRleCA+IC0xKSB7IHRocm90dGxlcnMuc3BsaWNl
        KGluZGV4LCAxKTsgfQogICAgICAgIH0sIHdhaXQpOwoKICAgICAgICB0aHJv
        dHRsZXJzLnB1c2goW3RhcmdldCwgbWV0aG9kLCB0aW1lcl0pOwogICAgICB9
        LAoKICAgICAgZGVib3VuY2U6IGZ1bmN0aW9uKHRhcmdldCwgbWV0aG9kIC8q
        ICwgYXJncywgd2FpdCwgW2ltbWVkaWF0ZV0gKi8pIHsKICAgICAgICB2YXIg
        c2VsZiA9IHRoaXMsCiAgICAgICAgICAgIGFyZ3MgPSBhcmd1bWVudHMsCiAg
        ICAgICAgICAgIGltbWVkaWF0ZSA9IHBvcC5jYWxsKGFyZ3MpLAogICAgICAg
        ICAgICB3YWl0LAogICAgICAgICAgICBpbmRleCwKICAgICAgICAgICAgZGVi
        b3VuY2VlOwoKICAgICAgICBpZiAodHlwZW9mIGltbWVkaWF0ZSA9PT0gIm51
        bWJlciIpIHsKICAgICAgICAgIHdhaXQgPSBpbW1lZGlhdGU7CiAgICAgICAg
        ICBpbW1lZGlhdGUgPSBmYWxzZTsKICAgICAgICB9IGVsc2UgewogICAgICAg
        ICAgd2FpdCA9IHBvcC5jYWxsKGFyZ3MpOwogICAgICAgIH0KCiAgICAgICAg
        Ly8gUmVtb3ZlIGRlYm91bmNlZQogICAgICAgIGluZGV4ID0gZmluZERlYm91
        bmNlZSh0YXJnZXQsIG1ldGhvZCk7CgogICAgICAgIGlmIChpbmRleCAhPT0g
        LTEpIHsKICAgICAgICAgIGRlYm91bmNlZSA9IGRlYm91bmNlZXNbaW5kZXhd
        OwogICAgICAgICAgZGVib3VuY2Vlcy5zcGxpY2UoaW5kZXgsIDEpOwogICAg
        ICAgICAgY2xlYXJUaW1lb3V0KGRlYm91bmNlZVsyXSk7CiAgICAgICAgfQoK
        ICAgICAgICB2YXIgdGltZXIgPSBnbG9iYWwuc2V0VGltZW91dChmdW5jdGlv
        bigpIHsKICAgICAgICAgIGlmICghaW1tZWRpYXRlKSB7CiAgICAgICAgICAg
        IHNlbGYucnVuLmFwcGx5KHNlbGYsIGFyZ3MpOwogICAgICAgICAgfQogICAg
        ICAgICAgaW5kZXggPSBmaW5kRGVib3VuY2VlKHRhcmdldCwgbWV0aG9kKTsK
        ICAgICAgICAgIGlmIChpbmRleCkgewogICAgICAgICAgICBkZWJvdW5jZWVz
        LnNwbGljZShpbmRleCwgMSk7CiAgICAgICAgICB9CiAgICAgICAgfSwgd2Fp
        dCk7CgogICAgICAgIGlmIChpbW1lZGlhdGUgJiYgaW5kZXggPT09IC0xKSB7
        CiAgICAgICAgICBzZWxmLnJ1bi5hcHBseShzZWxmLCBhcmdzKTsKICAgICAg
        ICB9CgogICAgICAgIGRlYm91bmNlZXMucHVzaChbdGFyZ2V0LCBtZXRob2Qs
        IHRpbWVyXSk7CiAgICAgIH0sCgogICAgICBjYW5jZWxUaW1lcnM6IGZ1bmN0
        aW9uKCkgewogICAgICAgIHZhciBpLCBsZW47CgogICAgICAgIGZvciAoaSA9
        IDAsIGxlbiA9IHRocm90dGxlcnMubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHsK
        ICAgICAgICAgIGNsZWFyVGltZW91dCh0aHJvdHRsZXJzW2ldWzJdKTsKICAg
        ICAgICB9CiAgICAgICAgdGhyb3R0bGVycyA9IFtdOwoKICAgICAgICBmb3Ig
        KGkgPSAwLCBsZW4gPSBkZWJvdW5jZWVzLmxlbmd0aDsgaSA8IGxlbjsgaSsr
        KSB7CiAgICAgICAgICBjbGVhclRpbWVvdXQoZGVib3VuY2Vlc1tpXVsyXSk7
        CiAgICAgICAgfQogICAgICAgIGRlYm91bmNlZXMgPSBbXTsKCiAgICAgICAg
        aWYgKGxhdGVyVGltZXIpIHsKICAgICAgICAgIGNsZWFyVGltZW91dChsYXRl
        clRpbWVyKTsKICAgICAgICAgIGxhdGVyVGltZXIgPSBudWxsOwogICAgICAg
        IH0KICAgICAgICB0aW1lcnMgPSBbXTsKCiAgICAgICAgaWYgKGF1dG9ydW4p
        IHsKICAgICAgICAgIGNsZWFyVGltZW91dChhdXRvcnVuKTsKICAgICAgICAg
        IGF1dG9ydW4gPSBudWxsOwogICAgICAgIH0KICAgICAgfSwKCiAgICAgIGhh
        c1RpbWVyczogZnVuY3Rpb24oKSB7CiAgICAgICAgcmV0dXJuICEhdGltZXJz
        Lmxlbmd0aCB8fCBhdXRvcnVuOwogICAgICB9LAoKICAgICAgY2FuY2VsOiBm
        dW5jdGlvbih0aW1lcikgewogICAgICAgIGlmICh0aW1lciAmJiB0eXBlb2Yg
        dGltZXIgPT09ICdvYmplY3QnICYmIHRpbWVyLnF1ZXVlICYmIHRpbWVyLm1l
        dGhvZCkgeyAvLyB3ZSdyZSBjYW5jZWxsaW5nIGEgZGVmZXJPbmNlCiAgICAg
        ICAgICByZXR1cm4gdGltZXIucXVldWUuY2FuY2VsKHRpbWVyKTsKICAgICAg
        ICB9IGVsc2UgaWYgKHR5cGVvZiB0aW1lciA9PT0gJ2Z1bmN0aW9uJykgeyAv
        LyB3ZSdyZSBjYW5jZWxsaW5nIGEgc2V0VGltZW91dAogICAgICAgICAgZm9y
        ICh2YXIgaSA9IDAsIGwgPSB0aW1lcnMubGVuZ3RoOyBpIDwgbDsgaSArPSAy
        KSB7CiAgICAgICAgICAgIGlmICh0aW1lcnNbaSArIDFdID09PSB0aW1lcikg
        ewogICAgICAgICAgICAgIHRpbWVycy5zcGxpY2UoaSwgMik7IC8vIHJlbW92
        ZSB0aGUgdHdvIGVsZW1lbnRzCiAgICAgICAgICAgICAgcmV0dXJuIHRydWU7
        CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9IGVsc2Ugewog
        ICAgICAgICAgcmV0dXJuOyAvLyB0aW1lciB3YXMgbnVsbCBvciBub3QgYSB0
        aW1lcgogICAgICAgIH0KICAgICAgfQogICAgfTsKCiAgICBCYWNrYnVybmVy
        LnByb3RvdHlwZS5zY2hlZHVsZSA9IEJhY2tidXJuZXIucHJvdG90eXBlLmRl
        ZmVyOwogICAgQmFja2J1cm5lci5wcm90b3R5cGUuc2NoZWR1bGVPbmNlID0g
        QmFja2J1cm5lci5wcm90b3R5cGUuZGVmZXJPbmNlOwogICAgQmFja2J1cm5l
        ci5wcm90b3R5cGUubGF0ZXIgPSBCYWNrYnVybmVyLnByb3RvdHlwZS5zZXRU
        aW1lb3V0OwoKICAgIGZ1bmN0aW9uIGNyZWF0ZUF1dG9ydW4oYmFja2J1cm5l
        cikgewogICAgICBiYWNrYnVybmVyLmJlZ2luKCk7CiAgICAgIGF1dG9ydW4g
        PSBnbG9iYWwuc2V0VGltZW91dChmdW5jdGlvbigpIHsKICAgICAgICBhdXRv
        cnVuID0gbnVsbDsKICAgICAgICBiYWNrYnVybmVyLmVuZCgpOwogICAgICB9
        KTsKICAgIH0KCiAgICBmdW5jdGlvbiBleGVjdXRlVGltZXJzKHNlbGYpIHsK
        ICAgICAgdmFyIG5vdyA9ICtuZXcgRGF0ZSgpLAogICAgICAgICAgdGltZSwg
        Zm5zLCBpLCBsOwoKICAgICAgc2VsZi5ydW4oZnVuY3Rpb24oKSB7CiAgICAg
        ICAgLy8gVE9ETzogYmluYXJ5IHNlYXJjaAogICAgICAgIGZvciAoaSA9IDAs
        IGwgPSB0aW1lcnMubGVuZ3RoOyBpIDwgbDsgaSArPSAyKSB7CiAgICAgICAg
        ICB0aW1lID0gdGltZXJzW2ldOwogICAgICAgICAgaWYgKHRpbWUgPiBub3cp
        IHsgYnJlYWs7IH0KICAgICAgICB9CgogICAgICAgIGZucyA9IHRpbWVycy5z
        cGxpY2UoMCwgaSk7CgogICAgICAgIGZvciAoaSA9IDEsIGwgPSBmbnMubGVu
        Z3RoOyBpIDwgbDsgaSArPSAyKSB7CiAgICAgICAgICBzZWxmLnNjaGVkdWxl
        KHNlbGYub3B0aW9ucy5kZWZhdWx0UXVldWUsIG51bGwsIGZuc1tpXSk7CiAg
        ICAgICAgfQogICAgICB9KTsKCiAgICAgIGlmICh0aW1lcnMubGVuZ3RoKSB7
        CiAgICAgICAgbGF0ZXJUaW1lciA9IGdsb2JhbC5zZXRUaW1lb3V0KGZ1bmN0
        aW9uKCkgewogICAgICAgICAgZXhlY3V0ZVRpbWVycyhzZWxmKTsKICAgICAg
        ICAgIGxhdGVyVGltZXIgPSBudWxsOwogICAgICAgICAgbGF0ZXJUaW1lckV4
        cGlyZXNBdCA9IG51bGw7CiAgICAgICAgfSwgdGltZXJzWzBdIC0gbm93KTsK
        ICAgICAgICBsYXRlclRpbWVyRXhwaXJlc0F0ID0gdGltZXJzWzBdOwogICAg
        ICB9CiAgICB9CgogICAgZnVuY3Rpb24gZmluZERlYm91bmNlZSh0YXJnZXQs
        IG1ldGhvZCkgewogICAgICB2YXIgZGVib3VuY2VlLAogICAgICAgICAgaW5k
        ZXggPSAtMTsKCiAgICAgIGZvciAodmFyIGkgPSAwLCBsID0gZGVib3VuY2Vl
        cy5sZW5ndGg7IGkgPCBsOyBpKyspIHsKICAgICAgICBkZWJvdW5jZWUgPSBk
        ZWJvdW5jZWVzW2ldOwogICAgICAgIGlmIChkZWJvdW5jZWVbMF0gPT09IHRh
        cmdldCAmJiBkZWJvdW5jZWVbMV0gPT09IG1ldGhvZCkgewogICAgICAgICAg
        aW5kZXggPSBpOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICB9
        CgogICAgICByZXR1cm4gaW5kZXg7CiAgICB9CgoKICAgIF9fZXhwb3J0c19f
        LkJhY2tidXJuZXIgPSBCYWNrYnVybmVyOwogIH0pOwoKfSkoKTsKCgoKKGZ1
        bmN0aW9uKCkgewp2YXIgb25CZWdpbiA9IGZ1bmN0aW9uKGN1cnJlbnQpIHsK
        ICBFbWJlci5ydW4uY3VycmVudFJ1bkxvb3AgPSBjdXJyZW50Owp9OwoKdmFy
        IG9uRW5kID0gZnVuY3Rpb24oY3VycmVudCwgbmV4dCkgewogIEVtYmVyLnJ1
        bi5jdXJyZW50UnVuTG9vcCA9IG5leHQ7Cn07Cgp2YXIgQmFja2J1cm5lciA9
        IHJlcXVpcmVNb2R1bGUoJ2JhY2tidXJuZXInKS5CYWNrYnVybmVyLAogICAg
        YmFja2J1cm5lciA9IG5ldyBCYWNrYnVybmVyKFsnc3luYycsICdhY3Rpb25z
        JywgJ2Rlc3Ryb3knXSwgewogICAgICBzeW5jOiB7CiAgICAgICAgYmVmb3Jl
        OiBFbWJlci5iZWdpblByb3BlcnR5Q2hhbmdlcywKICAgICAgICBhZnRlcjog
        RW1iZXIuZW5kUHJvcGVydHlDaGFuZ2VzCiAgICAgIH0sCiAgICAgIGRlZmF1
        bHRRdWV1ZTogJ2FjdGlvbnMnLAogICAgICBvbkJlZ2luOiBvbkJlZ2luLAog
        ICAgICBvbkVuZDogb25FbmQKICAgIH0pLAogICAgc2xpY2UgPSBbXS5zbGlj
        ZTsKCi8vIC4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4u
        Li4uLi4uLi4uLi4uLi4uLi4uLi4KLy8gRW1iZXIucnVuIC0gdGhpcyBpcyBp
        ZGVhbGx5IHRoZSBvbmx5IHB1YmxpYyBBUEkgdGhlIGRldiBzZWVzCi8vCgov
        KioKICBSdW5zIHRoZSBwYXNzZWQgdGFyZ2V0IGFuZCBtZXRob2QgaW5zaWRl
        IG9mIGEgUnVuTG9vcCwgZW5zdXJpbmcgYW55CiAgZGVmZXJyZWQgYWN0aW9u
        cyBpbmNsdWRpbmcgYmluZGluZ3MgYW5kIHZpZXdzIHVwZGF0ZXMgYXJlIGZs
        dXNoZWQgYXQgdGhlCiAgZW5kLgoKICBOb3JtYWxseSB5b3Ugc2hvdWxkIG5v
        dCBuZWVkIHRvIGludm9rZSB0aGlzIG1ldGhvZCB5b3Vyc2VsZi4gSG93ZXZl
        ciBpZgogIHlvdSBhcmUgaW1wbGVtZW50aW5nIHJhdyBldmVudCBoYW5kbGVy
        cyB3aGVuIGludGVyZmFjaW5nIHdpdGggb3RoZXIKICBsaWJyYXJpZXMgb3Ig
        cGx1Z2lucywgeW91IHNob3VsZCBwcm9iYWJseSB3cmFwIGFsbCBvZiB5b3Vy
        IGNvZGUgaW5zaWRlIHRoaXMKICBjYWxsLgoKICBgYGBqYXZhc2NyaXB0CiAg
        RW1iZXIucnVuKGZ1bmN0aW9uKCkgewogICAgLy8gY29kZSB0byBiZSBleGVj
        dXRlIHdpdGhpbiBhIFJ1bkxvb3AKICB9KTsKICBgYGAKCiAgQGNsYXNzIHJ1
        bgogIEBuYW1lc3BhY2UgRW1iZXIKICBAc3RhdGljCiAgQGNvbnN0cnVjdG9y
        CiAgQHBhcmFtIHtPYmplY3R9IFt0YXJnZXRdIHRhcmdldCBvZiBtZXRob2Qg
        dG8gY2FsbAogIEBwYXJhbSB7RnVuY3Rpb258U3RyaW5nfSBtZXRob2QgTWV0
        aG9kIHRvIGludm9rZS4KICAgIE1heSBiZSBhIGZ1bmN0aW9uIG9yIGEgc3Ry
        aW5nLiBJZiB5b3UgcGFzcyBhIHN0cmluZwogICAgdGhlbiBpdCB3aWxsIGJl
        IGxvb2tlZCB1cCBvbiB0aGUgcGFzc2VkIHRhcmdldC4KICBAcGFyYW0ge09i
        amVjdH0gW2FyZ3MqXSBBbnkgYWRkaXRpb25hbCBhcmd1bWVudHMgeW91IHdp
        c2ggdG8gcGFzcyB0byB0aGUgbWV0aG9kLgogIEByZXR1cm4ge09iamVjdH0g
        cmV0dXJuIHZhbHVlIGZyb20gaW52b2tpbmcgdGhlIHBhc3NlZCBmdW5jdGlv
        bi4KKi8KRW1iZXIucnVuID0gZnVuY3Rpb24odGFyZ2V0LCBtZXRob2QpIHsK
        ICB2YXIgcmV0OwoKICBpZiAoRW1iZXIub25lcnJvcikgewogICAgdHJ5IHsK
        ICAgICAgcmV0ID0gYmFja2J1cm5lci5ydW4uYXBwbHkoYmFja2J1cm5lciwg
        YXJndW1lbnRzKTsKICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgRW1iZXIub25l
        cnJvcihlKTsKICAgIH0KICB9IGVsc2UgewogICAgcmV0ID0gYmFja2J1cm5l
        ci5ydW4uYXBwbHkoYmFja2J1cm5lciwgYXJndW1lbnRzKTsKICB9CgogIHJl
        dHVybiByZXQ7Cn07CgovKioKCiAgSWYgbm8gcnVuLWxvb3AgaXMgcHJlc2Vu
        dCwgaXQgY3JlYXRlcyBhIG5ldyBvbmUuIElmIGEgcnVuIGxvb3AgaXMKICBw
        cmVzZW50IGl0IHdpbGwgcXVldWUgaXRzZWxmIHRvIHJ1biBvbiB0aGUgZXhp
        c3RpbmcgcnVuLWxvb3BzIGFjdGlvbgogIHF1ZXVlLgoKICBQbGVhc2Ugbm90
        ZTogVGhpcyBpcyBub3QgZm9yIG5vcm1hbCB1c2FnZSwgYW5kIHNob3VsZCBi
        ZSB1c2VkIHNwYXJpbmdseS4KCiAgSWYgaW52b2tlZCB3aGVuIG5vdCB3aXRo
        aW4gYSBydW4gbG9vcDoKCiAgYGBgamF2YXNjcmlwdAogIEVtYmVyLnJ1bi5q
        b2luKGZ1bmN0aW9uKCkgewogICAgLy8gY3JlYXRlcyBhIG5ldyBydW4tbG9v
        cAogIH0pOwogIGBgYAoKICBBbHRlcm5hdGl2ZWx5LCBpZiBjYWxsZWQgd2l0
        aGluIGFuIGV4aXN0aW5nIHJ1biBsb29wOgoKICBgYGBqYXZhc2NyaXB0CiAg
        RW1iZXIucnVuKGZ1bmN0aW9uKCkgewogICAgLy8gY3JlYXRlcyBhIG5ldyBy
        dW4tbG9vcAogICAgRW1iZXIucnVuLmpvaW4oZnVuY3Rpb24oKSB7CiAgICAg
        IC8vIGpvaW5zIHdpdGggdGhlIGV4aXN0aW5nIHJ1bi1sb29wLCBhbmQgcXVl
        dWVzIGZvciBpbnZvY2F0aW9uIG9uCiAgICAgIC8vIHRoZSBleGlzdGluZyBy
        dW4tbG9vcHMgYWN0aW9uIHF1ZXVlLgogICAgfSk7CiAgfSk7CiAgYGBgCgog
        IEBtZXRob2Qgam9pbgogIEBuYW1lc3BhY2UgRW1iZXIKICBAcGFyYW0ge09i
        amVjdH0gW3RhcmdldF0gdGFyZ2V0IG9mIG1ldGhvZCB0byBjYWxsCiAgQHBh
        cmFtIHtGdW5jdGlvbnxTdHJpbmd9IG1ldGhvZCBNZXRob2QgdG8gaW52b2tl
        LgogICAgTWF5IGJlIGEgZnVuY3Rpb24gb3IgYSBzdHJpbmcuIElmIHlvdSBw
        YXNzIGEgc3RyaW5nCiAgICB0aGVuIGl0IHdpbGwgYmUgbG9va2VkIHVwIG9u
        IHRoZSBwYXNzZWQgdGFyZ2V0LgogIEBwYXJhbSB7T2JqZWN0fSBbYXJncypd
        IEFueSBhZGRpdGlvbmFsIGFyZ3VtZW50cyB5b3Ugd2lzaCB0byBwYXNzIHRv
        IHRoZSBtZXRob2QuCiAgQHJldHVybiB7T2JqZWN0fSByZXR1cm4gdmFsdWUg
        ZnJvbSBpbnZva2luZyB0aGUgcGFzc2VkIGZ1bmN0aW9uLiBQbGVhc2Ugbm90
        ZSwKICB3aGVuIGNhbGxlZCB3aXRoaW4gYW4gZXhpc3RpbmcgbG9vcCwgbm8g
        cmV0dXJuIHZhbHVlIGlzIHBvc3NpYmxlLgoqLwpFbWJlci5ydW4uam9pbiA9
        IGZ1bmN0aW9uKHRhcmdldCwgbWV0aG9kKSB7CiAgaWYgKCFFbWJlci5ydW4u
        Y3VycmVudFJ1bkxvb3ApIHsKICAgIHJldHVybiBFbWJlci5ydW4uYXBwbHko
        RW1iZXIucnVuLCBhcmd1bWVudHMpOwogIH0KCiAgdmFyIGFyZ3MgPSBzbGlj
        ZS5jYWxsKGFyZ3VtZW50cyk7CiAgYXJncy51bnNoaWZ0KCdhY3Rpb25zJyk7
        CiAgRW1iZXIucnVuLnNjaGVkdWxlLmFwcGx5KEVtYmVyLnJ1biwgYXJncyk7
        Cn07CgpFbWJlci5ydW4uYmFja2J1cm5lciA9IGJhY2tidXJuZXI7Cgp2YXIg
        cnVuID0gRW1iZXIucnVuOwoKRW1iZXIucnVuLmN1cnJlbnRSdW5Mb29wID0g
        bnVsbDsKCkVtYmVyLnJ1bi5xdWV1ZXMgPSBiYWNrYnVybmVyLnF1ZXVlTmFt
        ZXM7CgovKioKICBCZWdpbnMgYSBuZXcgUnVuTG9vcC4gQW55IGRlZmVycmVk
        IGFjdGlvbnMgaW52b2tlZCBhZnRlciB0aGUgYmVnaW4gd2lsbAogIGJlIGJ1
        ZmZlcmVkIHVudGlsIHlvdSBpbnZva2UgYSBtYXRjaGluZyBjYWxsIHRvIGBF
        bWJlci5ydW4uZW5kKClgLiBUaGlzIGlzCiAgYSBsb3dlci1sZXZlbCB3YXkg
        dG8gdXNlIGEgUnVuTG9vcCBpbnN0ZWFkIG9mIHVzaW5nIGBFbWJlci5ydW4o
        KWAuCgogIGBgYGphdmFzY3JpcHQKICBFbWJlci5ydW4uYmVnaW4oKTsKICAv
        LyBjb2RlIHRvIGJlIGV4ZWN1dGUgd2l0aGluIGEgUnVuTG9vcAogIEVtYmVy
        LnJ1bi5lbmQoKTsKICBgYGAKCiAgQG1ldGhvZCBiZWdpbgogIEByZXR1cm4g
        e3ZvaWR9CiovCkVtYmVyLnJ1bi5iZWdpbiA9IGZ1bmN0aW9uKCkgewogIGJh
        Y2tidXJuZXIuYmVnaW4oKTsKfTsKCi8qKgogIEVuZHMgYSBSdW5Mb29wLiBU
        aGlzIG11c3QgYmUgY2FsbGVkIHNvbWV0aW1lIGFmdGVyIHlvdSBjYWxsCiAg
        YEVtYmVyLnJ1bi5iZWdpbigpYCB0byBmbHVzaCBhbnkgZGVmZXJyZWQgYWN0
        aW9ucy4gVGhpcyBpcyBhIGxvd2VyLWxldmVsIHdheQogIHRvIHVzZSBhIFJ1
        bkxvb3AgaW5zdGVhZCBvZiB1c2luZyBgRW1iZXIucnVuKClgLgoKICBgYGBq
        YXZhc2NyaXB0CiAgRW1iZXIucnVuLmJlZ2luKCk7CiAgLy8gY29kZSB0byBi
        ZSBleGVjdXRlIHdpdGhpbiBhIFJ1bkxvb3AKICBFbWJlci5ydW4uZW5kKCk7
        CiAgYGBgCgogIEBtZXRob2QgZW5kCiAgQHJldHVybiB7dm9pZH0KKi8KRW1i
        ZXIucnVuLmVuZCA9IGZ1bmN0aW9uKCkgewogIGJhY2tidXJuZXIuZW5kKCk7
        Cn07CgovKioKICBBcnJheSBvZiBuYW1lZCBxdWV1ZXMuIFRoaXMgYXJyYXkg
        ZGV0ZXJtaW5lcyB0aGUgb3JkZXIgaW4gd2hpY2ggcXVldWVzCiAgYXJlIGZs
        dXNoZWQgYXQgdGhlIGVuZCBvZiB0aGUgUnVuTG9vcC4gWW91IGNhbiBkZWZp
        bmUgeW91ciBvd24gcXVldWVzIGJ5CiAgc2ltcGx5IGFkZGluZyB0aGUgcXVl
        dWUgbmFtZSB0byB0aGlzIGFycmF5LiBOb3JtYWxseSB5b3Ugc2hvdWxkIG5v
        dCBuZWVkCiAgdG8gaW5zcGVjdCBvciBtb2RpZnkgdGhpcyBwcm9wZXJ0eS4K
        CiAgQHByb3BlcnR5IHF1ZXVlcwogIEB0eXBlIEFycmF5CiAgQGRlZmF1bHQg
        WydzeW5jJywgJ2FjdGlvbnMnLCAnZGVzdHJveSddCiovCgovKioKICBBZGRz
        IHRoZSBwYXNzZWQgdGFyZ2V0L21ldGhvZCBhbmQgYW55IG9wdGlvbmFsIGFy
        Z3VtZW50cyB0byB0aGUgbmFtZWQKICBxdWV1ZSB0byBiZSBleGVjdXRlZCBh
        dCB0aGUgZW5kIG9mIHRoZSBSdW5Mb29wLiBJZiB5b3UgaGF2ZSBub3QgYWxy
        ZWFkeQogIHN0YXJ0ZWQgYSBSdW5Mb29wIHdoZW4gY2FsbGluZyB0aGlzIG1l
        dGhvZCBvbmUgd2lsbCBiZSBzdGFydGVkIGZvciB5b3UKICBhdXRvbWF0aWNh
        bGx5LgoKICBBdCB0aGUgZW5kIG9mIGEgUnVuTG9vcCwgYW55IG1ldGhvZHMg
        c2NoZWR1bGVkIGluIHRoaXMgd2F5IHdpbGwgYmUgaW52b2tlZC4KICBNZXRo
        b2RzIHdpbGwgYmUgaW52b2tlZCBpbiBhbiBvcmRlciBtYXRjaGluZyB0aGUg
        bmFtZWQgcXVldWVzIGRlZmluZWQgaW4KICB0aGUgYEVtYmVyLnJ1bi5xdWV1
        ZXNgIHByb3BlcnR5LgoKICBgYGBqYXZhc2NyaXB0CiAgRW1iZXIucnVuLnNj
        aGVkdWxlKCdzeW5jJywgdGhpcywgZnVuY3Rpb24oKSB7CiAgICAvLyB0aGlz
        IHdpbGwgYmUgZXhlY3V0ZWQgaW4gdGhlIGZpcnN0IFJ1bkxvb3AgcXVldWUs
        IHdoZW4gYmluZGluZ3MgYXJlIHN5bmNlZAogICAgY29uc29sZS5sb2coInNj
        aGVkdWxlZCBvbiBzeW5jIHF1ZXVlIik7CiAgfSk7CgogIEVtYmVyLnJ1bi5z
        Y2hlZHVsZSgnYWN0aW9ucycsIHRoaXMsIGZ1bmN0aW9uKCkgewogICAgLy8g
        dGhpcyB3aWxsIGJlIGV4ZWN1dGVkIGluIHRoZSAnYWN0aW9ucycgcXVldWUs
        IGFmdGVyIGJpbmRpbmdzIGhhdmUgc3luY2VkLgogICAgY29uc29sZS5sb2co
        InNjaGVkdWxlZCBvbiBhY3Rpb25zIHF1ZXVlIik7CiAgfSk7CgogIC8vIE5v
        dGUgdGhlIGZ1bmN0aW9ucyB3aWxsIGJlIHJ1biBpbiBvcmRlciBiYXNlZCBv
        biB0aGUgcnVuIHF1ZXVlcyBvcmRlci4gT3V0cHV0IHdvdWxkIGJlOgogIC8v
        ICAgc2NoZWR1bGVkIG9uIHN5bmMgcXVldWUKICAvLyAgIHNjaGVkdWxlZCBv
        biBhY3Rpb25zIHF1ZXVlCiAgYGBgCgogIEBtZXRob2Qgc2NoZWR1bGUKICBA
        cGFyYW0ge1N0cmluZ30gcXVldWUgVGhlIG5hbWUgb2YgdGhlIHF1ZXVlIHRv
        IHNjaGVkdWxlIGFnYWluc3QuCiAgICBEZWZhdWx0IHF1ZXVlcyBhcmUgJ3N5
        bmMnIGFuZCAnYWN0aW9ucycKICBAcGFyYW0ge09iamVjdH0gW3RhcmdldF0g
        dGFyZ2V0IG9iamVjdCB0byB1c2UgYXMgdGhlIGNvbnRleHQgd2hlbiBpbnZv
        a2luZyBhIG1ldGhvZC4KICBAcGFyYW0ge1N0cmluZ3xGdW5jdGlvbn0gbWV0
        aG9kIFRoZSBtZXRob2QgdG8gaW52b2tlLiBJZiB5b3UgcGFzcyBhIHN0cmlu
        ZyBpdAogICAgd2lsbCBiZSByZXNvbHZlZCBvbiB0aGUgdGFyZ2V0IG9iamVj
        dCBhdCB0aGUgdGltZSB0aGUgc2NoZWR1bGVkIGl0ZW0gaXMKICAgIGludm9r
        ZWQgYWxsb3dpbmcgeW91IHRvIGNoYW5nZSB0aGUgdGFyZ2V0IGZ1bmN0aW9u
        LgogIEBwYXJhbSB7T2JqZWN0fSBbYXJndW1lbnRzKl0gT3B0aW9uYWwgYXJn
        dW1lbnRzIHRvIGJlIHBhc3NlZCB0byB0aGUgcXVldWVkIG1ldGhvZC4KICBA
        cmV0dXJuIHt2b2lkfQoqLwpFbWJlci5ydW4uc2NoZWR1bGUgPSBmdW5jdGlv
        bihxdWV1ZSwgdGFyZ2V0LCBtZXRob2QpIHsKICBjaGVja0F1dG9SdW4oKTsK
        ICBiYWNrYnVybmVyLnNjaGVkdWxlLmFwcGx5KGJhY2tidXJuZXIsIGFyZ3Vt
        ZW50cyk7Cn07CgovLyBVc2VkIGJ5IGdsb2JhbCB0ZXN0IHRlYXJkb3duCkVt
        YmVyLnJ1bi5oYXNTY2hlZHVsZWRUaW1lcnMgPSBmdW5jdGlvbigpIHsKICBy
        ZXR1cm4gYmFja2J1cm5lci5oYXNUaW1lcnMoKTsKfTsKCi8vIFVzZWQgYnkg
        Z2xvYmFsIHRlc3QgdGVhcmRvd24KRW1iZXIucnVuLmNhbmNlbFRpbWVycyA9
        IGZ1bmN0aW9uICgpIHsKICBiYWNrYnVybmVyLmNhbmNlbFRpbWVycygpOwp9
        OwoKLyoqCiAgSW1tZWRpYXRlbHkgZmx1c2hlcyBhbnkgZXZlbnRzIHNjaGVk
        dWxlZCBpbiB0aGUgJ3N5bmMnIHF1ZXVlLiBCaW5kaW5ncwogIHVzZSB0aGlz
        IHF1ZXVlIHNvIHRoaXMgbWV0aG9kIGlzIGEgdXNlZnVsIHdheSB0byBpbW1l
        ZGlhdGVseSBmb3JjZSBhbGwKICBiaW5kaW5ncyBpbiB0aGUgYXBwbGljYXRp
        b24gdG8gc3luYy4KCiAgWW91IHNob3VsZCBjYWxsIHRoaXMgbWV0aG9kIGFu
        eXRpbWUgeW91IG5lZWQgYW55IGNoYW5nZWQgc3RhdGUgdG8gcHJvcGFnYXRl
        CiAgdGhyb3VnaG91dCB0aGUgYXBwIGltbWVkaWF0ZWx5IHdpdGhvdXQgcmVw
        YWludGluZyB0aGUgVUkgKHdoaWNoIGhhcHBlbnMKICBpbiB0aGUgbGF0ZXIg
        J3JlbmRlcicgcXVldWUgYWRkZWQgYnkgdGhlIGBlbWJlci12aWV3c2AgcGFj
        a2FnZSkuCgogIGBgYGphdmFzY3JpcHQKICBFbWJlci5ydW4uc3luYygpOwog
        IGBgYAoKICBAbWV0aG9kIHN5bmMKICBAcmV0dXJuIHt2b2lkfQoqLwpFbWJl
        ci5ydW4uc3luYyA9IGZ1bmN0aW9uKCkgewogIGlmIChiYWNrYnVybmVyLmN1
        cnJlbnRJbnN0YW5jZSkgewogICAgYmFja2J1cm5lci5jdXJyZW50SW5zdGFu
        Y2UucXVldWVzLnN5bmMuZmx1c2goKTsKICB9Cn07CgovKioKICBJbnZva2Vz
        IHRoZSBwYXNzZWQgdGFyZ2V0L21ldGhvZCBhbmQgb3B0aW9uYWwgYXJndW1l
        bnRzIGFmdGVyIGEgc3BlY2lmaWVkCiAgcGVyaW9kIGlmIHRpbWUuIFRoZSBs
        YXN0IHBhcmFtZXRlciBvZiB0aGlzIG1ldGhvZCBtdXN0IGFsd2F5cyBiZSBh
        IG51bWJlcgogIG9mIG1pbGxpc2Vjb25kcy4KCiAgWW91IHNob3VsZCB1c2Ug
        dGhpcyBtZXRob2Qgd2hlbmV2ZXIgeW91IG5lZWQgdG8gcnVuIHNvbWUgYWN0
        aW9uIGFmdGVyIGEKICBwZXJpb2Qgb2YgdGltZSBpbnN0ZWFkIG9mIHVzaW5n
        IGBzZXRUaW1lb3V0KClgLiBUaGlzIG1ldGhvZCB3aWxsIGVuc3VyZSB0aGF0
        CiAgaXRlbXMgdGhhdCBleHBpcmUgZHVyaW5nIHRoZSBzYW1lIHNjcmlwdCBl
        eGVjdXRpb24gY3ljbGUgYWxsIGV4ZWN1dGUKICB0b2dldGhlciwgd2hpY2gg
        aXMgb2Z0ZW4gbW9yZSBlZmZpY2llbnQgdGhhbiB1c2luZyBhIHJlYWwgc2V0
        VGltZW91dC4KCiAgYGBgamF2YXNjcmlwdAogIEVtYmVyLnJ1bi5sYXRlciht
        eUNvbnRleHQsIGZ1bmN0aW9uKCkgewogICAgLy8gY29kZSBoZXJlIHdpbGwg
        ZXhlY3V0ZSB3aXRoaW4gYSBSdW5Mb29wIGluIGFib3V0IDUwMG1zIHdpdGgg
        dGhpcyA9PSBteUNvbnRleHQKICB9LCA1MDApOwogIGBgYAoKICBAbWV0aG9k
        IGxhdGVyCiAgQHBhcmFtIHtPYmplY3R9IFt0YXJnZXRdIHRhcmdldCBvZiBt
        ZXRob2QgdG8gaW52b2tlCiAgQHBhcmFtIHtGdW5jdGlvbnxTdHJpbmd9IG1l
        dGhvZCBUaGUgbWV0aG9kIHRvIGludm9rZS4KICAgIElmIHlvdSBwYXNzIGEg
        c3RyaW5nIGl0IHdpbGwgYmUgcmVzb2x2ZWQgb24gdGhlCiAgICB0YXJnZXQg
        YXQgdGhlIHRpbWUgdGhlIG1ldGhvZCBpcyBpbnZva2VkLgogIEBwYXJhbSB7
        T2JqZWN0fSBbYXJncypdIE9wdGlvbmFsIGFyZ3VtZW50cyB0byBwYXNzIHRv
        IHRoZSB0aW1lb3V0LgogIEBwYXJhbSB7TnVtYmVyfSB3YWl0IE51bWJlciBv
        ZiBtaWxsaXNlY29uZHMgdG8gd2FpdC4KICBAcmV0dXJuIHtTdHJpbmd9IGEg
        c3RyaW5nIHlvdSBjYW4gdXNlIHRvIGNhbmNlbCB0aGUgdGltZXIgaW4KICAg
        IGBFbWJlci5ydW4uY2FuY2VsYCBsYXRlci4KKi8KRW1iZXIucnVuLmxhdGVy
        ID0gZnVuY3Rpb24odGFyZ2V0LCBtZXRob2QpIHsKICByZXR1cm4gYmFja2J1
        cm5lci5sYXRlci5hcHBseShiYWNrYnVybmVyLCBhcmd1bWVudHMpOwp9OwoK
        LyoqCiAgU2NoZWR1bGUgYSBmdW5jdGlvbiB0byBydW4gb25lIHRpbWUgZHVy
        aW5nIHRoZSBjdXJyZW50IFJ1bkxvb3AuIFRoaXMgaXMgZXF1aXZhbGVudAog
        IHRvIGNhbGxpbmcgYHNjaGVkdWxlT25jZWAgd2l0aCB0aGUgImFjdGlvbnMi
        IHF1ZXVlLgoKICBAbWV0aG9kIG9uY2UKICBAcGFyYW0ge09iamVjdH0gW3Rh
        cmdldF0gVGhlIHRhcmdldCBvZiB0aGUgbWV0aG9kIHRvIGludm9rZS4KICBA
        cGFyYW0ge0Z1bmN0aW9ufFN0cmluZ30gbWV0aG9kIFRoZSBtZXRob2QgdG8g
        aW52b2tlLgogICAgSWYgeW91IHBhc3MgYSBzdHJpbmcgaXQgd2lsbCBiZSBy
        ZXNvbHZlZCBvbiB0aGUKICAgIHRhcmdldCBhdCB0aGUgdGltZSB0aGUgbWV0
        aG9kIGlzIGludm9rZWQuCiAgQHBhcmFtIHtPYmplY3R9IFthcmdzKl0gT3B0
        aW9uYWwgYXJndW1lbnRzIHRvIHBhc3MgdG8gdGhlIHRpbWVvdXQuCiAgQHJl
        dHVybiB7T2JqZWN0fSB0aW1lcgoqLwpFbWJlci5ydW4ub25jZSA9IGZ1bmN0
        aW9uKHRhcmdldCwgbWV0aG9kKSB7CiAgY2hlY2tBdXRvUnVuKCk7CiAgdmFy
        IGFyZ3MgPSBzbGljZS5jYWxsKGFyZ3VtZW50cyk7CiAgYXJncy51bnNoaWZ0
        KCdhY3Rpb25zJyk7CiAgcmV0dXJuIGJhY2tidXJuZXIuc2NoZWR1bGVPbmNl
        LmFwcGx5KGJhY2tidXJuZXIsIGFyZ3MpOwp9OwoKLyoqCiAgU2NoZWR1bGVz
        IGEgZnVuY3Rpb24gdG8gcnVuIG9uZSB0aW1lIGluIGEgZ2l2ZW4gcXVldWUg
        b2YgdGhlIGN1cnJlbnQgUnVuTG9vcC4KICBDYWxsaW5nIHRoaXMgbWV0aG9k
        IHdpdGggdGhlIHNhbWUgcXVldWUvdGFyZ2V0L21ldGhvZCBjb21iaW5hdGlv
        biB3aWxsIGhhdmUKICBubyBlZmZlY3QgKHBhc3QgdGhlIGluaXRpYWwgY2Fs
        bCkuCgogIE5vdGUgdGhhdCBhbHRob3VnaCB5b3UgY2FuIHBhc3Mgb3B0aW9u
        YWwgYXJndW1lbnRzIHRoZXNlIHdpbGwgbm90IGJlCiAgY29uc2lkZXJlZCB3
        aGVuIGxvb2tpbmcgZm9yIGR1cGxpY2F0ZXMuIE5ldyBhcmd1bWVudHMgd2ls
        bCByZXBsYWNlIHByZXZpb3VzCiAgY2FsbHMuCgogIGBgYGphdmFzY3JpcHQK
        ICBFbWJlci5ydW4oZnVuY3Rpb24oKSB7CiAgICB2YXIgc2F5SGkgPSBmdW5j
        dGlvbigpIHsgY29uc29sZS5sb2coJ2hpJyk7IH0KICAgIEVtYmVyLnJ1bi5z
        Y2hlZHVsZU9uY2UoJ2FmdGVyUmVuZGVyJywgbXlDb250ZXh0LCBzYXlIaSk7
        CiAgICBFbWJlci5ydW4uc2NoZWR1bGVPbmNlKCdhZnRlclJlbmRlcicsIG15
        Q29udGV4dCwgc2F5SGkpOwogICAgLy8gc2F5SGkgd2lsbCBvbmx5IGJlIGV4
        ZWN1dGVkIG9uY2UsIGluIHRoZSBhZnRlclJlbmRlciBxdWV1ZSBvZiB0aGUg
        UnVuTG9vcAogIH0pOwogIGBgYAoKICBBbHNvIG5vdGUgdGhhdCBwYXNzaW5n
        IGFuIGFub255bW91cyBmdW5jdGlvbiB0byBgRW1iZXIucnVuLnNjaGVkdWxl
        T25jZWAgd2lsbAogIG5vdCBwcmV2ZW50IGFkZGl0aW9uYWwgY2FsbHMgd2l0
        aCBhbiBpZGVudGljYWwgYW5vbnltb3VzIGZ1bmN0aW9uIGZyb20KICBzY2hl
        ZHVsaW5nIHRoZSBpdGVtcyBtdWx0aXBsZSB0aW1lcywgZS5nLjoKCiAgYGBg
        amF2YXNjcmlwdAogIGZ1bmN0aW9uIHNjaGVkdWxlSXQoKSB7CiAgICBFbWJl
        ci5ydW4uc2NoZWR1bGVPbmNlKCdhY3Rpb25zJywgbXlDb250ZXh0LCBmdW5j
        dGlvbigpIHsgY29uc29sZS5sb2coIkNsb3N1cmUiKTsgfSk7CiAgfQogIHNj
        aGVkdWxlSXQoKTsKICBzY2hlZHVsZUl0KCk7CiAgLy8gIkNsb3N1cmUiIHdp
        bGwgcHJpbnQgdHdpY2UsIGV2ZW4gdGhvdWdoIHdlJ3JlIHVzaW5nIGBFbWJl
        ci5ydW4uc2NoZWR1bGVPbmNlYCwKICAvLyBiZWNhdXNlIHRoZSBmdW5jdGlv
        biB3ZSBwYXNzIHRvIGl0IGlzIGFub255bW91cyBhbmQgd29uJ3QgbWF0Y2gg
        dGhlCiAgLy8gcHJldmlvdXNseSBzY2hlZHVsZWQgb3BlcmF0aW9uLgogIGBg
        YAoKICBBdmFpbGFibGUgcXVldWVzLCBhbmQgdGhlaXIgb3JkZXIsIGNhbiBi
        ZSBmb3VuZCBhdCBgRW1iZXIucnVuLnF1ZXVlc2AKCiAgQG1ldGhvZCBzY2hl
        ZHVsZU9uY2UKICBAcGFyYW0ge1N0cmluZ30gW3F1ZXVlXSBUaGUgbmFtZSBv
        ZiB0aGUgcXVldWUgdG8gc2NoZWR1bGUgYWdhaW5zdC4gRGVmYXVsdCBxdWV1
        ZXMgYXJlICdzeW5jJyBhbmQgJ2FjdGlvbnMnLgogIEBwYXJhbSB7T2JqZWN0
        fSBbdGFyZ2V0XSBUaGUgdGFyZ2V0IG9mIHRoZSBtZXRob2QgdG8gaW52b2tl
        LgogIEBwYXJhbSB7RnVuY3Rpb258U3RyaW5nfSBtZXRob2QgVGhlIG1ldGhv
        ZCB0byBpbnZva2UuCiAgICBJZiB5b3UgcGFzcyBhIHN0cmluZyBpdCB3aWxs
        IGJlIHJlc29sdmVkIG9uIHRoZQogICAgdGFyZ2V0IGF0IHRoZSB0aW1lIHRo
        ZSBtZXRob2QgaXMgaW52b2tlZC4KICBAcGFyYW0ge09iamVjdH0gW2FyZ3Mq
        XSBPcHRpb25hbCBhcmd1bWVudHMgdG8gcGFzcyB0byB0aGUgdGltZW91dC4K
        ICBAcmV0dXJuIHtPYmplY3R9IHRpbWVyCiovCkVtYmVyLnJ1bi5zY2hlZHVs
        ZU9uY2UgPSBmdW5jdGlvbihxdWV1ZSwgdGFyZ2V0LCBtZXRob2QpIHsKICBj
        aGVja0F1dG9SdW4oKTsKICByZXR1cm4gYmFja2J1cm5lci5zY2hlZHVsZU9u
        Y2UuYXBwbHkoYmFja2J1cm5lciwgYXJndW1lbnRzKTsKfTsKCi8qKgogIFNj
        aGVkdWxlcyBhbiBpdGVtIHRvIHJ1biBmcm9tIHdpdGhpbiBhIHNlcGFyYXRl
        IHJ1biBsb29wLCBhZnRlcgogIGNvbnRyb2wgaGFzIGJlZW4gcmV0dXJuZWQg
        dG8gdGhlIHN5c3RlbS4gVGhpcyBpcyBlcXVpdmFsZW50IHRvIGNhbGxpbmcK
        ICBgRW1iZXIucnVuLmxhdGVyYCB3aXRoIGEgd2FpdCB0aW1lIG9mIDFtcy4K
        CiAgYGBgamF2YXNjcmlwdAogIEVtYmVyLnJ1bi5uZXh0KG15Q29udGV4dCwg
        ZnVuY3Rpb24oKSB7CiAgICAvLyBjb2RlIHRvIGJlIGV4ZWN1dGVkIGluIHRo
        ZSBuZXh0IHJ1biBsb29wLCB3aGljaCB3aWxsIGJlIHNjaGVkdWxlZCBhZnRl
        ciB0aGUgY3VycmVudCBvbmUKICB9KTsKICBgYGAKCiAgTXVsdGlwbGUgb3Bl
        cmF0aW9ucyBzY2hlZHVsZWQgd2l0aCBgRW1iZXIucnVuLm5leHRgIHdpbGwg
        Y29hbGVzY2UKICBpbnRvIHRoZSBzYW1lIGxhdGVyIHJ1biBsb29wLCBhbG9u
        ZyB3aXRoIGFueSBvdGhlciBvcGVyYXRpb25zCiAgc2NoZWR1bGVkIGJ5IGBF
        bWJlci5ydW4ubGF0ZXJgIHRoYXQgZXhwaXJlIHJpZ2h0IGFyb3VuZCB0aGUg
        c2FtZQogIHRpbWUgdGhhdCBgRW1iZXIucnVuLm5leHRgIG9wZXJhdGlvbnMg
        d2lsbCBmaXJlLgoKICBOb3RlIHRoYXQgdGhlcmUgYXJlIG9mdGVuIGFsdGVy
        bmF0aXZlcyB0byB1c2luZyBgRW1iZXIucnVuLm5leHRgLgogIEZvciBpbnN0
        YW5jZSwgaWYgeW91J2QgbGlrZSB0byBzY2hlZHVsZSBhbiBvcGVyYXRpb24g
        dG8gaGFwcGVuCiAgYWZ0ZXIgYWxsIERPTSBlbGVtZW50IG9wZXJhdGlvbnMg
        aGF2ZSBjb21wbGV0ZWQgd2l0aGluIHRoZSBjdXJyZW50CiAgcnVuIGxvb3As
        IHlvdSBjYW4gbWFrZSB1c2Ugb2YgdGhlIGBhZnRlclJlbmRlcmAgcnVuIGxv
        b3AgcXVldWUgKGFkZGVkCiAgYnkgdGhlIGBlbWJlci12aWV3c2AgcGFja2Fn
        ZSwgYWxvbmcgd2l0aCB0aGUgcHJlY2VkaW5nIGByZW5kZXJgIHF1ZXVlCiAg
        d2hlcmUgYWxsIHRoZSBET00gZWxlbWVudCBvcGVyYXRpb25zIGhhcHBlbiku
        IEV4YW1wbGU6CgogIGBgYGphdmFzY3JpcHQKICBBcHAuTXlDb2xsZWN0aW9u
        VmlldyA9IEVtYmVyLkNvbGxlY3Rpb25WaWV3LmV4dGVuZCh7CiAgICBkaWRJ
        bnNlcnRFbGVtZW50OiBmdW5jdGlvbigpIHsKICAgICAgRW1iZXIucnVuLnNj
        aGVkdWxlT25jZSgnYWZ0ZXJSZW5kZXInLCB0aGlzLCAncHJvY2Vzc0NoaWxk
        RWxlbWVudHMnKTsKICAgIH0sCiAgICBwcm9jZXNzQ2hpbGRFbGVtZW50czog
        ZnVuY3Rpb24oKSB7CiAgICAgIC8vIC4uLiBkbyBzb21ldGhpbmcgd2l0aCBj
        b2xsZWN0aW9uVmlldydzIGNoaWxkIHZpZXcKICAgICAgLy8gZWxlbWVudHMg
        YWZ0ZXIgdGhleSd2ZSBmaW5pc2hlZCByZW5kZXJpbmcsIHdoaWNoCiAgICAg
        IC8vIGNhbid0IGJlIGRvbmUgd2l0aGluIHRoZSBDb2xsZWN0aW9uVmlldydz
        CiAgICAgIC8vIGBkaWRJbnNlcnRFbGVtZW50YCBob29rIGJlY2F1c2UgdGhh
        dCBnZXRzIHJ1bgogICAgICAvLyBiZWZvcmUgdGhlIGNoaWxkIGVsZW1lbnRz
        IGhhdmUgYmVlbiBhZGRlZCB0byB0aGUgRE9NLgogICAgfQogIH0pOwogIGBg
        YAoKICBPbmUgYmVuZWZpdCBvZiB0aGUgYWJvdmUgYXBwcm9hY2ggY29tcGFy
        ZWQgdG8gdXNpbmcgYEVtYmVyLnJ1bi5uZXh0YCBpcwogIHRoYXQgeW91IHdp
        bGwgYmUgYWJsZSB0byBwZXJmb3JtIERPTS9DU1Mgb3BlcmF0aW9ucyBiZWZv
        cmUgdW5wcm9jZXNzZWQKICBlbGVtZW50cyBhcmUgcmVuZGVyZWQgdG8gdGhl
        IHNjcmVlbiwgd2hpY2ggbWF5IHByZXZlbnQgZmxpY2tlcmluZyBvcgogIG90
        aGVyIGFydGlmYWN0cyBjYXVzZWQgYnkgZGVsYXlpbmcgcHJvY2Vzc2luZyB1
        bnRpbCBhZnRlciByZW5kZXJpbmcuCgogIFRoZSBvdGhlciBtYWpvciBiZW5l
        Zml0IHRvIHRoZSBhYm92ZSBhcHByb2FjaCBpcyB0aGF0IGBFbWJlci5ydW4u
        bmV4dGAKICBpbnRyb2R1Y2VzIGFuIGVsZW1lbnQgb2Ygbm9uLWRldGVybWlu
        aXNtLCB3aGljaCBjYW4gbWFrZSB0aGluZ3MgbXVjaAogIGhhcmRlciB0byB0
        ZXN0LCBkdWUgdG8gaXRzIHJlbGlhbmNlIG9uIGBzZXRUaW1lb3V0YDsgaXQn
        cyBtdWNoIGhhcmRlcgogIHRvIGd1YXJhbnRlZSB0aGUgb3JkZXIgb2Ygc2No
        ZWR1bGVkIG9wZXJhdGlvbnMgd2hlbiB0aGV5IGFyZSBzY2hlZHVsZWQKICBv
        dXRzaWRlIG9mIHRoZSBjdXJyZW50IHJ1biBsb29wLCBpLmUuIHdpdGggYEVt
        YmVyLnJ1bi5uZXh0YC4KCiAgQG1ldGhvZCBuZXh0CiAgQHBhcmFtIHtPYmpl
        Y3R9IFt0YXJnZXRdIHRhcmdldCBvZiBtZXRob2QgdG8gaW52b2tlCiAgQHBh
        cmFtIHtGdW5jdGlvbnxTdHJpbmd9IG1ldGhvZCBUaGUgbWV0aG9kIHRvIGlu
        dm9rZS4KICAgIElmIHlvdSBwYXNzIGEgc3RyaW5nIGl0IHdpbGwgYmUgcmVz
        b2x2ZWQgb24gdGhlCiAgICB0YXJnZXQgYXQgdGhlIHRpbWUgdGhlIG1ldGhv
        ZCBpcyBpbnZva2VkLgogIEBwYXJhbSB7T2JqZWN0fSBbYXJncypdIE9wdGlv
        bmFsIGFyZ3VtZW50cyB0byBwYXNzIHRvIHRoZSB0aW1lb3V0LgogIEByZXR1
        cm4ge09iamVjdH0gdGltZXIKKi8KRW1iZXIucnVuLm5leHQgPSBmdW5jdGlv
        bigpIHsKICB2YXIgYXJncyA9IHNsaWNlLmNhbGwoYXJndW1lbnRzKTsKICBh
        cmdzLnB1c2goMSk7CiAgcmV0dXJuIGJhY2tidXJuZXIubGF0ZXIuYXBwbHko
        YmFja2J1cm5lciwgYXJncyk7Cn07CgovKioKICBDYW5jZWxzIGEgc2NoZWR1
        bGVkIGl0ZW0uIE11c3QgYmUgYSB2YWx1ZSByZXR1cm5lZCBieSBgRW1iZXIu
        cnVuLmxhdGVyKClgLAogIGBFbWJlci5ydW4ub25jZSgpYCwgb3IgYEVtYmVy
        LnJ1bi5uZXh0KClgLgoKICBgYGBqYXZhc2NyaXB0CiAgdmFyIHJ1bk5leHQg
        PSBFbWJlci5ydW4ubmV4dChteUNvbnRleHQsIGZ1bmN0aW9uKCkgewogICAg
        Ly8gd2lsbCBub3QgYmUgZXhlY3V0ZWQKICB9KTsKICBFbWJlci5ydW4uY2Fu
        Y2VsKHJ1bk5leHQpOwoKICB2YXIgcnVuTGF0ZXIgPSBFbWJlci5ydW4ubGF0
        ZXIobXlDb250ZXh0LCBmdW5jdGlvbigpIHsKICAgIC8vIHdpbGwgbm90IGJl
        IGV4ZWN1dGVkCiAgfSwgNTAwKTsKICBFbWJlci5ydW4uY2FuY2VsKHJ1bkxh
        dGVyKTsKCiAgdmFyIHJ1bk9uY2UgPSBFbWJlci5ydW4ub25jZShteUNvbnRl
        eHQsIGZ1bmN0aW9uKCkgewogICAgLy8gd2lsbCBub3QgYmUgZXhlY3V0ZWQK
        ICB9KTsKICBFbWJlci5ydW4uY2FuY2VsKHJ1bk9uY2UpOwogIGBgYAoKICBA
        bWV0aG9kIGNhbmNlbAogIEBwYXJhbSB7T2JqZWN0fSB0aW1lciBUaW1lciBv
        YmplY3QgdG8gY2FuY2VsCiAgQHJldHVybiB7dm9pZH0KKi8KRW1iZXIucnVu
        LmNhbmNlbCA9IGZ1bmN0aW9uKHRpbWVyKSB7CiAgcmV0dXJuIGJhY2tidXJu
        ZXIuY2FuY2VsKHRpbWVyKTsKfTsKCi8qKgogIERlbGF5IGNhbGxpbmcgdGhl
        IHRhcmdldCBtZXRob2QgdW50aWwgdGhlIGRlYm91bmNlIHBlcmlvZCBoYXMg
        ZWxhcHNlZAogIHdpdGggbm8gYWRkaXRpb25hbCBkZWJvdW5jZSBjYWxscy4g
        SWYgYGRlYm91bmNlYCBpcyBjYWxsZWQgYWdhaW4gYmVmb3JlCiAgdGhlIHNw
        ZWNpZmllZCB0aW1lIGhhcyBlbGFwc2VkLCB0aGUgdGltZXIgaXMgcmVzZXQg
        YW5kIHRoZSBlbnRpcmUgcGVyaW9kCiAgbXVzdCBwYXNzIGFnYWluIGJlZm9y
        ZSB0aGUgdGFyZ2V0IG1ldGhvZCBpcyBjYWxsZWQuCgogIFRoaXMgbWV0aG9k
        IHNob3VsZCBiZSB1c2VkIHdoZW4gYW4gZXZlbnQgbWF5IGJlIGNhbGxlZCBt
        dWx0aXBsZSB0aW1lcwogIGJ1dCB0aGUgYWN0aW9uIHNob3VsZCBvbmx5IGJl
        IGNhbGxlZCBvbmNlIHdoZW4gdGhlIGV2ZW50IGlzIGRvbmUgZmlyaW5nLgog
        IEEgY29tbW9uIGV4YW1wbGUgaXMgZm9yIHNjcm9sbCBldmVudHMgd2hlcmUg
        eW91IG9ubHkgd2FudCB1cGRhdGVzIHRvCiAgaGFwcGVuIG9uY2Ugc2Nyb2xs
        aW5nIGhhcyBjZWFzZWQuCgogIGBgYGphdmFzY3JpcHQKICAgIHZhciBteUZ1
        bmMgPSBmdW5jdGlvbigpIHsgY29uc29sZS5sb2codGhpcy5uYW1lICsgJyBy
        YW4uJyk7IH07CiAgICB2YXIgbXlDb250ZXh0ID0ge25hbWU6ICdkZWJvdW5j
        ZSd9OwoKICAgIEVtYmVyLnJ1bi5kZWJvdW5jZShteUNvbnRleHQsIG15RnVu
        YywgMTUwKTsKCiAgICAvLyBsZXNzIHRoYW4gMTUwbXMgcGFzc2VzCgogICAg
        RW1iZXIucnVuLmRlYm91bmNlKG15Q29udGV4dCwgbXlGdW5jLCAxNTApOwoK
        ICAgIC8vIDE1MG1zIHBhc3NlcwogICAgLy8gbXlGdW5jIGlzIGludm9rZWQg
        d2l0aCBjb250ZXh0IG15Q29udGV4dAogICAgLy8gY29uc29sZSBsb2dzICdk
        ZWJvdW5jZSByYW4uJyBvbmUgdGltZS4KICBgYGAKCiAgQG1ldGhvZCBkZWJv
        dW5jZQogIEBwYXJhbSB7T2JqZWN0fSBbdGFyZ2V0XSB0YXJnZXQgb2YgbWV0
        aG9kIHRvIGludm9rZQogIEBwYXJhbSB7RnVuY3Rpb258U3RyaW5nfSBtZXRo
        b2QgVGhlIG1ldGhvZCB0byBpbnZva2UuCiAgICBNYXkgYmUgYSBmdW5jdGlv
        biBvciBhIHN0cmluZy4gSWYgeW91IHBhc3MgYSBzdHJpbmcKICAgIHRoZW4g
        aXQgd2lsbCBiZSBsb29rZWQgdXAgb24gdGhlIHBhc3NlZCB0YXJnZXQuCiAg
        QHBhcmFtIHtPYmplY3R9IFthcmdzKl0gT3B0aW9uYWwgYXJndW1lbnRzIHRv
        IHBhc3MgdG8gdGhlIHRpbWVvdXQuCiAgQHBhcmFtIHtOdW1iZXJ9IHdhaXQg
        TnVtYmVyIG9mIG1pbGxpc2Vjb25kcyB0byB3YWl0LgogIEBwYXJhbSB7Qm9v
        bGVhbn0gaW1tZWRpYXRlIFRyaWdnZXIgdGhlIGZ1bmN0aW9uIG9uIHRoZSBs
        ZWFkaW5nIGluc3RlYWQgb2YgdGhlIHRyYWlsaW5nIGVkZ2Ugb2YgdGhlIHdh
        aXQgaW50ZXJ2YWwuCiAgQHJldHVybiB7dm9pZH0KKi8KRW1iZXIucnVuLmRl
        Ym91bmNlID0gZnVuY3Rpb24oKSB7CiAgcmV0dXJuIGJhY2tidXJuZXIuZGVi
        b3VuY2UuYXBwbHkoYmFja2J1cm5lciwgYXJndW1lbnRzKTsKfTsKCi8qKgog
        IEVuc3VyZSB0aGF0IHRoZSB0YXJnZXQgbWV0aG9kIGlzIG5ldmVyIGNhbGxl
        ZCBtb3JlIGZyZXF1ZW50bHkgdGhhbgogIHRoZSBzcGVjaWZpZWQgc3BhY2lu
        ZyBwZXJpb2QuCgogIGBgYGphdmFzY3JpcHQKICAgIHZhciBteUZ1bmMgPSBm
        dW5jdGlvbigpIHsgY29uc29sZS5sb2codGhpcy5uYW1lICsgJyByYW4uJyk7
        IH07CiAgICB2YXIgbXlDb250ZXh0ID0ge25hbWU6ICd0aHJvdHRsZSd9OwoK
        ICAgIEVtYmVyLnJ1bi50aHJvdHRsZShteUNvbnRleHQsIG15RnVuYywgMTUw
        KTsKCiAgICAvLyA1MG1zIHBhc3NlcwogICAgRW1iZXIucnVuLnRocm90dGxl
        KG15Q29udGV4dCwgbXlGdW5jLCAxNTApOwoKICAgIC8vIDUwbXMgcGFzc2Vz
        CiAgICBFbWJlci5ydW4udGhyb3R0bGUobXlDb250ZXh0LCBteUZ1bmMsIDE1
        MCk7CgogICAgLy8gNTBtcyBwYXNzZXMKICAgIEVtYmVyLnJ1bi50aHJvdHRs
        ZShteUNvbnRleHQsIG15RnVuYywgMTUwKTsKCiAgICAvLyAxNTBtcyBwYXNz
        ZXMKICAgIC8vIG15RnVuYyBpcyBpbnZva2VkIHdpdGggY29udGV4dCBteUNv
        bnRleHQKICAgIC8vIGNvbnNvbGUgbG9ncyAndGhyb3R0bGUgcmFuLicgdHdp
        Y2UsIDE1MG1zIGFwYXJ0LgogIGBgYAoKICBAbWV0aG9kIHRocm90dGxlCiAg
        QHBhcmFtIHtPYmplY3R9IFt0YXJnZXRdIHRhcmdldCBvZiBtZXRob2QgdG8g
        aW52b2tlCiAgQHBhcmFtIHtGdW5jdGlvbnxTdHJpbmd9IG1ldGhvZCBUaGUg
        bWV0aG9kIHRvIGludm9rZS4KICAgIE1heSBiZSBhIGZ1bmN0aW9uIG9yIGEg
        c3RyaW5nLiBJZiB5b3UgcGFzcyBhIHN0cmluZwogICAgdGhlbiBpdCB3aWxs
        IGJlIGxvb2tlZCB1cCBvbiB0aGUgcGFzc2VkIHRhcmdldC4KICBAcGFyYW0g
        e09iamVjdH0gW2FyZ3MqXSBPcHRpb25hbCBhcmd1bWVudHMgdG8gcGFzcyB0
        byB0aGUgdGltZW91dC4KICBAcGFyYW0ge051bWJlcn0gc3BhY2luZyBOdW1i
        ZXIgb2YgbWlsbGlzZWNvbmRzIHRvIHNwYWNlIG91dCByZXF1ZXN0cy4KICBA
        cmV0dXJuIHt2b2lkfQoqLwpFbWJlci5ydW4udGhyb3R0bGUgPSBmdW5jdGlv
        bigpIHsKICByZXR1cm4gYmFja2J1cm5lci50aHJvdHRsZS5hcHBseShiYWNr
        YnVybmVyLCBhcmd1bWVudHMpOwp9OwoKLy8gTWFrZSBzdXJlIGl0J3Mgbm90
        IGFuIGF1dG9ydW4gZHVyaW5nIHRlc3RpbmcKZnVuY3Rpb24gY2hlY2tBdXRv
        UnVuKCkgewogIGlmICghRW1iZXIucnVuLmN1cnJlbnRSdW5Mb29wKSB7CiAg
        ICBFbWJlci5hc3NlcnQoIllvdSBoYXZlIHR1cm5lZCBvbiB0ZXN0aW5nIG1v
        ZGUsIHdoaWNoIGRpc2FibGVkIHRoZSBydW4tbG9vcCdzIGF1dG9ydW4uIFlv
        dSB3aWxsIG5lZWQgdG8gd3JhcCBhbnkgY29kZSB3aXRoIGFzeW5jaHJvbm91
        cyBzaWRlLWVmZmVjdHMgaW4gYW4gRW1iZXIucnVuIiwgIUVtYmVyLnRlc3Rp
        bmcpOwogIH0KfQoKfSkoKTsKCgoKKGZ1bmN0aW9uKCkgewovLyBFbWJlci5M
        b2dnZXIKLy8gZ2V0Ci8vIHNldAovLyBndWlkRm9yLCBtZXRhCi8vIGFkZE9i
        c2VydmVyLCByZW1vdmVPYnNlcnZlcgovLyBFbWJlci5ydW4uc2NoZWR1bGUK
        LyoqCkBtb2R1bGUgZW1iZXItbWV0YWwKKi8KCi8vIC4uLi4uLi4uLi4uLi4u
        Li4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4K
        Ly8gQ09OU1RBTlRTCi8vCgovKioKICBEZWJ1ZyBwYXJhbWV0ZXIgeW91IGNh
        biB0dXJuIG9uLiBUaGlzIHdpbGwgbG9nIGFsbCBiaW5kaW5ncyB0aGF0IGZp
        cmUgdG8KICB0aGUgY29uc29sZS4gVGhpcyBzaG91bGQgYmUgZGlzYWJsZWQg
        aW4gcHJvZHVjdGlvbiBjb2RlLiBOb3RlIHRoYXQgeW91CiAgY2FuIGFsc28g
        ZW5hYmxlIHRoaXMgZnJvbSB0aGUgY29uc29sZSBvciB0ZW1wb3JhcmlseS4K
        CiAgQHByb3BlcnR5IExPR19CSU5ESU5HUwogIEBmb3IgRW1iZXIKICBAdHlw
        ZSBCb29sZWFuCiAgQGRlZmF1bHQgZmFsc2UKKi8KRW1iZXIuTE9HX0JJTkRJ
        TkdTID0gZmFsc2UgfHwgISFFbWJlci5FTlYuTE9HX0JJTkRJTkdTOwoKdmFy
        IGdldCAgICAgPSBFbWJlci5nZXQsCiAgICBzZXQgICAgID0gRW1iZXIuc2V0
        LAogICAgZ3VpZEZvciA9IEVtYmVyLmd1aWRGb3IsCiAgICBJU19HTE9CQUwg
        PSAvXihbQS1aJF18KFswLTldW0EtWiRdKSkvOwoKLyoqCiAgUmV0dXJucyB0
        cnVlIGlmIHRoZSBwcm92aWRlZCBwYXRoIGlzIGdsb2JhbCAoZS5nLiwgYE15
        QXBwLmZvb0NvbnRyb2xsZXIuYmFyYCkKICBpbnN0ZWFkIG9mIGxvY2FsIChg
        Zm9vLmJhci5iYXpgKS4KCiAgQG1ldGhvZCBpc0dsb2JhbFBhdGgKICBAZm9y
        IEVtYmVyCiAgQHByaXZhdGUKICBAcGFyYW0ge1N0cmluZ30gcGF0aAogIEBy
        ZXR1cm4gQm9vbGVhbgoqLwp2YXIgaXNHbG9iYWxQYXRoID0gRW1iZXIuaXNH
        bG9iYWxQYXRoID0gZnVuY3Rpb24ocGF0aCkgewogIHJldHVybiBJU19HTE9C
        QUwudGVzdChwYXRoKTsKfTsKCmZ1bmN0aW9uIGdldFdpdGhHbG9iYWxzKG9i
        aiwgcGF0aCkgewogIHJldHVybiBnZXQoaXNHbG9iYWxQYXRoKHBhdGgpID8g
        RW1iZXIubG9va3VwIDogb2JqLCBwYXRoKTsKfQoKLy8gLi4uLi4uLi4uLi4u
        Li4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4u
        LgovLyBCSU5ESU5HCi8vCgp2YXIgQmluZGluZyA9IGZ1bmN0aW9uKHRvUGF0
        aCwgZnJvbVBhdGgpIHsKICB0aGlzLl9kaXJlY3Rpb24gPSAnZndkJzsKICB0
        aGlzLl9mcm9tID0gZnJvbVBhdGg7CiAgdGhpcy5fdG8gICA9IHRvUGF0aDsK
        ICB0aGlzLl9kaXJlY3Rpb25NYXAgPSBFbWJlci5NYXAuY3JlYXRlKCk7Cn07
        CgovKioKQGNsYXNzIEJpbmRpbmcKQG5hbWVzcGFjZSBFbWJlcgoqLwoKQmlu
        ZGluZy5wcm90b3R5cGUgPSB7CiAgLyoqCiAgICBUaGlzIGNvcGllcyB0aGUg
        QmluZGluZyBzbyBpdCBjYW4gYmUgY29ubmVjdGVkIHRvIGFub3RoZXIgb2Jq
        ZWN0LgoKICAgIEBtZXRob2QgY29weQogICAgQHJldHVybiB7RW1iZXIuQmlu
        ZGluZ30gYHRoaXNgCiAgKi8KICBjb3B5OiBmdW5jdGlvbiAoKSB7CiAgICB2
        YXIgY29weSA9IG5ldyBCaW5kaW5nKHRoaXMuX3RvLCB0aGlzLl9mcm9tKTsK
        ICAgIGlmICh0aGlzLl9vbmVXYXkpIHsgY29weS5fb25lV2F5ID0gdHJ1ZTsg
        fQogICAgcmV0dXJuIGNvcHk7CiAgfSwKCiAgLy8gLi4uLi4uLi4uLi4uLi4u
        Li4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLgog
        IC8vIENPTkZJRwogIC8vCgogIC8qKgogICAgVGhpcyB3aWxsIHNldCBgZnJv
        bWAgcHJvcGVydHkgcGF0aCB0byB0aGUgc3BlY2lmaWVkIHZhbHVlLiBJdCB3
        aWxsIG5vdAogICAgYXR0ZW1wdCB0byByZXNvbHZlIHRoaXMgcHJvcGVydHkg
        cGF0aCB0byBhbiBhY3R1YWwgb2JqZWN0IHVudGlsIHlvdQogICAgY29ubmVj
        dCB0aGUgYmluZGluZy4KCiAgICBUaGUgYmluZGluZyB3aWxsIHNlYXJjaCBm
        b3IgdGhlIHByb3BlcnR5IHBhdGggc3RhcnRpbmcgYXQgdGhlIHJvb3Qgb2Jq
        ZWN0CiAgICB5b3UgcGFzcyB3aGVuIHlvdSBgY29ubmVjdCgpYCB0aGUgYmlu
        ZGluZy4gSXQgZm9sbG93cyB0aGUgc2FtZSBydWxlcyBhcwogICAgYGdldCgp
        YCAtIHNlZSB0aGF0IG1ldGhvZCBmb3IgbW9yZSBpbmZvcm1hdGlvbi4KCiAg
        ICBAbWV0aG9kIGZyb20KICAgIEBwYXJhbSB7U3RyaW5nfSBwYXRoIHRoZSBw
        cm9wZXJ0eSBwYXRoIHRvIGNvbm5lY3QgdG8KICAgIEByZXR1cm4ge0VtYmVy
        LkJpbmRpbmd9IGB0aGlzYAogICovCiAgZnJvbTogZnVuY3Rpb24ocGF0aCkg
        ewogICAgdGhpcy5fZnJvbSA9IHBhdGg7CiAgICByZXR1cm4gdGhpczsKICB9
        LAoKICAvKioKICAgIFRoaXMgd2lsbCBzZXQgdGhlIGB0b2AgcHJvcGVydHkg
        cGF0aCB0byB0aGUgc3BlY2lmaWVkIHZhbHVlLiBJdCB3aWxsIG5vdAogICAg
        YXR0ZW1wdCB0byByZXNvbHZlIHRoaXMgcHJvcGVydHkgcGF0aCB0byBhbiBh
        Y3R1YWwgb2JqZWN0IHVudGlsIHlvdQogICAgY29ubmVjdCB0aGUgYmluZGlu
        Zy4KCiAgICBUaGUgYmluZGluZyB3aWxsIHNlYXJjaCBmb3IgdGhlIHByb3Bl
        cnR5IHBhdGggc3RhcnRpbmcgYXQgdGhlIHJvb3Qgb2JqZWN0CiAgICB5b3Ug
        cGFzcyB3aGVuIHlvdSBgY29ubmVjdCgpYCB0aGUgYmluZGluZy4gSXQgZm9s
        bG93cyB0aGUgc2FtZSBydWxlcyBhcwogICAgYGdldCgpYCAtIHNlZSB0aGF0
        IG1ldGhvZCBmb3IgbW9yZSBpbmZvcm1hdGlvbi4KCiAgICBAbWV0aG9kIHRv
        CiAgICBAcGFyYW0ge1N0cmluZ3xUdXBsZX0gcGF0aCBBIHByb3BlcnR5IHBh
        dGggb3IgdHVwbGUKICAgIEByZXR1cm4ge0VtYmVyLkJpbmRpbmd9IGB0aGlz
        YAogICovCiAgdG86IGZ1bmN0aW9uKHBhdGgpIHsKICAgIHRoaXMuX3RvID0g
        cGF0aDsKICAgIHJldHVybiB0aGlzOwogIH0sCgogIC8qKgogICAgQ29uZmln
        dXJlcyB0aGUgYmluZGluZyBhcyBvbmUgd2F5LiBBIG9uZS13YXkgYmluZGlu
        ZyB3aWxsIHJlbGF5IGNoYW5nZXMKICAgIG9uIHRoZSBgZnJvbWAgc2lkZSB0
        byB0aGUgYHRvYCBzaWRlLCBidXQgbm90IHRoZSBvdGhlciB3YXkgYXJvdW5k
        LiBUaGlzCiAgICBtZWFucyB0aGF0IGlmIHlvdSBjaGFuZ2UgdGhlIGB0b2Ag
        c2lkZSBkaXJlY3RseSwgdGhlIGBmcm9tYCBzaWRlIG1heSBoYXZlCiAgICBh
        IGRpZmZlcmVudCB2YWx1ZS4KCiAgICBAbWV0aG9kIG9uZVdheQogICAgQHJl
        dHVybiB7RW1iZXIuQmluZGluZ30gYHRoaXNgCiAgKi8KICBvbmVXYXk6IGZ1
        bmN0aW9uKCkgewogICAgdGhpcy5fb25lV2F5ID0gdHJ1ZTsKICAgIHJldHVy
        biB0aGlzOwogIH0sCgogIC8qKgogICAgQG1ldGhvZCB0b1N0cmluZwogICAg
        QHJldHVybiB7U3RyaW5nfSBzdHJpbmcgcmVwcmVzZW50YXRpb24gb2YgYmlu
        ZGluZwogICovCiAgdG9TdHJpbmc6IGZ1bmN0aW9uKCkgewogICAgdmFyIG9u
        ZVdheSA9IHRoaXMuX29uZVdheSA/ICdbb25lV2F5XScgOiAnJzsKICAgIHJl
        dHVybiAiRW1iZXIuQmluZGluZzwiICsgZ3VpZEZvcih0aGlzKSArICI+KCIg
        KyB0aGlzLl9mcm9tICsgIiAtPiAiICsgdGhpcy5fdG8gKyAiKSIgKyBvbmVX
        YXk7CiAgfSwKCiAgLy8gLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4u
        Li4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLgogIC8vIENPTk5FQ1QgQU5E
        IFNZTkMKICAvLwoKICAvKioKICAgIEF0dGVtcHRzIHRvIGNvbm5lY3QgdGhp
        cyBiaW5kaW5nIGluc3RhbmNlIHNvIHRoYXQgaXQgY2FuIHJlY2VpdmUgYW5k
        IHJlbGF5CiAgICBjaGFuZ2VzLiBUaGlzIG1ldGhvZCB3aWxsIHJhaXNlIGFu
        IGV4Y2VwdGlvbiBpZiB5b3UgaGF2ZSBub3Qgc2V0IHRoZQogICAgZnJvbS90
        byBwcm9wZXJ0aWVzIHlldC4KCiAgICBAbWV0aG9kIGNvbm5lY3QKICAgIEBw
        YXJhbSB7T2JqZWN0fSBvYmogVGhlIHJvb3Qgb2JqZWN0IGZvciB0aGlzIGJp
        bmRpbmcuCiAgICBAcmV0dXJuIHtFbWJlci5CaW5kaW5nfSBgdGhpc2AKICAq
        LwogIGNvbm5lY3Q6IGZ1bmN0aW9uKG9iaikgewogICAgRW1iZXIuYXNzZXJ0
        KCdNdXN0IHBhc3MgYSB2YWxpZCBvYmplY3QgdG8gRW1iZXIuQmluZGluZy5j
        b25uZWN0KCknLCAhIW9iaik7CgogICAgdmFyIGZyb21QYXRoID0gdGhpcy5f
        ZnJvbSwgdG9QYXRoID0gdGhpcy5fdG87CiAgICBFbWJlci50cnlTZXQob2Jq
        LCB0b1BhdGgsIGdldFdpdGhHbG9iYWxzKG9iaiwgZnJvbVBhdGgpKTsKCiAg
        ICAvLyBhZGQgYW4gb2JzZXJ2ZXIgb24gdGhlIG9iamVjdCB0byBiZSBub3Rp
        ZmllZCB3aGVuIHRoZSBiaW5kaW5nIHNob3VsZCBiZSB1cGRhdGVkCiAgICBF
        bWJlci5hZGRPYnNlcnZlcihvYmosIGZyb21QYXRoLCB0aGlzLCB0aGlzLmZy
        b21EaWRDaGFuZ2UpOwoKICAgIC8vIGlmIHRoZSBiaW5kaW5nIGlzIGEgdHdv
        LXdheSBiaW5kaW5nLCBhbHNvIHNldCB1cCBhbiBvYnNlcnZlciBvbiB0aGUg
        dGFyZ2V0CiAgICBpZiAoIXRoaXMuX29uZVdheSkgeyBFbWJlci5hZGRPYnNl
        cnZlcihvYmosIHRvUGF0aCwgdGhpcywgdGhpcy50b0RpZENoYW5nZSk7IH0K
        CiAgICB0aGlzLl9yZWFkeVRvU3luYyA9IHRydWU7CgogICAgcmV0dXJuIHRo
        aXM7CiAgfSwKCiAgLyoqCiAgICBEaXNjb25uZWN0cyB0aGUgYmluZGluZyBp
        bnN0YW5jZS4gQ2hhbmdlcyB3aWxsIG5vIGxvbmdlciBiZSByZWxheWVkLiBZ
        b3UKICAgIHdpbGwgbm90IHVzdWFsbHkgbmVlZCB0byBjYWxsIHRoaXMgbWV0
        aG9kLgoKICAgIEBtZXRob2QgZGlzY29ubmVjdAogICAgQHBhcmFtIHtPYmpl
        Y3R9IG9iaiBUaGUgcm9vdCBvYmplY3QgeW91IHBhc3NlZCB3aGVuIGNvbm5l
        Y3RpbmcgdGhlIGJpbmRpbmcuCiAgICBAcmV0dXJuIHtFbWJlci5CaW5kaW5n
        fSBgdGhpc2AKICAqLwogIGRpc2Nvbm5lY3Q6IGZ1bmN0aW9uKG9iaikgewog
        ICAgRW1iZXIuYXNzZXJ0KCdNdXN0IHBhc3MgYSB2YWxpZCBvYmplY3QgdG8g
        RW1iZXIuQmluZGluZy5kaXNjb25uZWN0KCknLCAhIW9iaik7CgogICAgdmFy
        IHR3b1dheSA9ICF0aGlzLl9vbmVXYXk7CgogICAgLy8gcmVtb3ZlIGFuIG9i
        c2VydmVyIG9uIHRoZSBvYmplY3Qgc28gd2UncmUgbm8gbG9uZ2VyIG5vdGlm
        aWVkIG9mCiAgICAvLyBjaGFuZ2VzIHRoYXQgc2hvdWxkIHVwZGF0ZSBiaW5k
        aW5ncy4KICAgIEVtYmVyLnJlbW92ZU9ic2VydmVyKG9iaiwgdGhpcy5fZnJv
        bSwgdGhpcywgdGhpcy5mcm9tRGlkQ2hhbmdlKTsKCiAgICAvLyBpZiB0aGUg
        YmluZGluZyBpcyB0d28td2F5LCByZW1vdmUgdGhlIG9ic2VydmVyIGZyb20g
        dGhlIHRhcmdldCBhcyB3ZWxsCiAgICBpZiAodHdvV2F5KSB7IEVtYmVyLnJl
        bW92ZU9ic2VydmVyKG9iaiwgdGhpcy5fdG8sIHRoaXMsIHRoaXMudG9EaWRD
        aGFuZ2UpOyB9CgogICAgdGhpcy5fcmVhZHlUb1N5bmMgPSBmYWxzZTsgLy8g
        ZGlzYWJsZSBzY2hlZHVsZWQgc3luY3MuLi4KICAgIHJldHVybiB0aGlzOwog
        IH0sCgogIC8vIC4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4u
        Li4uLi4uLi4uLi4uLi4uLi4uLi4uLi4KICAvLyBQUklWQVRFCiAgLy8KCiAg
        LyogY2FsbGVkIHdoZW4gdGhlIGZyb20gc2lkZSBjaGFuZ2VzICovCiAgZnJv
        bURpZENoYW5nZTogZnVuY3Rpb24odGFyZ2V0KSB7CiAgICB0aGlzLl9zY2hl
        ZHVsZVN5bmModGFyZ2V0LCAnZndkJyk7CiAgfSwKCiAgLyogY2FsbGVkIHdo
        ZW4gdGhlIHRvIHNpZGUgY2hhbmdlcyAqLwogIHRvRGlkQ2hhbmdlOiBmdW5j
        dGlvbih0YXJnZXQpIHsKICAgIHRoaXMuX3NjaGVkdWxlU3luYyh0YXJnZXQs
        ICdiYWNrJyk7CiAgfSwKCiAgX3NjaGVkdWxlU3luYzogZnVuY3Rpb24ob2Jq
        LCBkaXIpIHsKICAgIHZhciBkaXJlY3Rpb25NYXAgPSB0aGlzLl9kaXJlY3Rp
        b25NYXA7CiAgICB2YXIgZXhpc3RpbmdEaXIgPSBkaXJlY3Rpb25NYXAuZ2V0
        KG9iaik7CgogICAgLy8gaWYgd2UgaGF2ZW4ndCBzY2hlZHVsZWQgdGhlIGJp
        bmRpbmcgeWV0LCBzY2hlZHVsZSBpdAogICAgaWYgKCFleGlzdGluZ0Rpcikg
        ewogICAgICBFbWJlci5ydW4uc2NoZWR1bGUoJ3N5bmMnLCB0aGlzLCB0aGlz
        Ll9zeW5jLCBvYmopOwogICAgICBkaXJlY3Rpb25NYXAuc2V0KG9iaiwgZGly
        KTsKICAgIH0KCiAgICAvLyBJZiBib3RoIGEgJ2JhY2snIGFuZCAnZndkJyBz
        eW5jIGhhdmUgYmVlbiBzY2hlZHVsZWQgb24gdGhlIHNhbWUgb2JqZWN0LAog
        ICAgLy8gZGVmYXVsdCB0byBhICdmd2QnIHN5bmMgc28gdGhhdCBpdCByZW1h
        aW5zIGRldGVybWluaXN0aWMuCiAgICBpZiAoZXhpc3RpbmdEaXIgPT09ICdi
        YWNrJyAmJiBkaXIgPT09ICdmd2QnKSB7CiAgICAgIGRpcmVjdGlvbk1hcC5z
        ZXQob2JqLCAnZndkJyk7CiAgICB9CiAgfSwKCiAgX3N5bmM6IGZ1bmN0aW9u
        KG9iaikgewogICAgdmFyIGxvZyA9IEVtYmVyLkxPR19CSU5ESU5HUzsKCiAg
        ICAvLyBkb24ndCBzeW5jaHJvbml6ZSBkZXN0cm95ZWQgb2JqZWN0cyBvciBk
        aXNjb25uZWN0ZWQgYmluZGluZ3MKICAgIGlmIChvYmouaXNEZXN0cm95ZWQg
        fHwgIXRoaXMuX3JlYWR5VG9TeW5jKSB7IHJldHVybjsgfQoKICAgIC8vIGdl
        dCB0aGUgZGlyZWN0aW9uIG9mIHRoZSBiaW5kaW5nIGZvciB0aGUgb2JqZWN0
        IHdlIGFyZQogICAgLy8gc3luY2hyb25pemluZyBmcm9tCiAgICB2YXIgZGly
        ZWN0aW9uTWFwID0gdGhpcy5fZGlyZWN0aW9uTWFwOwogICAgdmFyIGRpcmVj
        dGlvbiA9IGRpcmVjdGlvbk1hcC5nZXQob2JqKTsKCiAgICB2YXIgZnJvbVBh
        dGggPSB0aGlzLl9mcm9tLCB0b1BhdGggPSB0aGlzLl90bzsKCiAgICBkaXJl
        Y3Rpb25NYXAucmVtb3ZlKG9iaik7CgogICAgLy8gaWYgd2UncmUgc3luY2hy
        b25pemluZyBmcm9tIHRoZSByZW1vdGUgb2JqZWN0Li4uCiAgICBpZiAoZGly
        ZWN0aW9uID09PSAnZndkJykgewogICAgICB2YXIgZnJvbVZhbHVlID0gZ2V0
        V2l0aEdsb2JhbHMob2JqLCB0aGlzLl9mcm9tKTsKICAgICAgaWYgKGxvZykg
        ewogICAgICAgIEVtYmVyLkxvZ2dlci5sb2coJyAnLCB0aGlzLnRvU3RyaW5n
        KCksICctPicsIGZyb21WYWx1ZSwgb2JqKTsKICAgICAgfQogICAgICBpZiAo
        dGhpcy5fb25lV2F5KSB7CiAgICAgICAgRW1iZXIudHJ5U2V0KG9iaiwgdG9Q
        YXRoLCBmcm9tVmFsdWUpOwogICAgICB9IGVsc2UgewogICAgICAgIEVtYmVy
        Ll9zdXNwZW5kT2JzZXJ2ZXIob2JqLCB0b1BhdGgsIHRoaXMsIHRoaXMudG9E
        aWRDaGFuZ2UsIGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEVtYmVyLnRyeVNl
        dChvYmosIHRvUGF0aCwgZnJvbVZhbHVlKTsKICAgICAgICB9KTsKICAgICAg
        fQogICAgLy8gaWYgd2UncmUgc3luY2hyb25pemluZyAqdG8qIHRoZSByZW1v
        dGUgb2JqZWN0CiAgICB9IGVsc2UgaWYgKGRpcmVjdGlvbiA9PT0gJ2JhY2sn
        KSB7CiAgICAgIHZhciB0b1ZhbHVlID0gZ2V0KG9iaiwgdGhpcy5fdG8pOwog
        ICAgICBpZiAobG9nKSB7CiAgICAgICAgRW1iZXIuTG9nZ2VyLmxvZygnICcs
        IHRoaXMudG9TdHJpbmcoKSwgJzwtJywgdG9WYWx1ZSwgb2JqKTsKICAgICAg
        fQogICAgICBFbWJlci5fc3VzcGVuZE9ic2VydmVyKG9iaiwgZnJvbVBhdGgs
        IHRoaXMsIHRoaXMuZnJvbURpZENoYW5nZSwgZnVuY3Rpb24gKCkgewogICAg
        ICAgIEVtYmVyLnRyeVNldChFbWJlci5pc0dsb2JhbFBhdGgoZnJvbVBhdGgp
        ID8gRW1iZXIubG9va3VwIDogb2JqLCBmcm9tUGF0aCwgdG9WYWx1ZSk7CiAg
        ICAgIH0pOwogICAgfQogIH0KCn07CgpmdW5jdGlvbiBtaXhpblByb3BlcnRp
        ZXModG8sIGZyb20pIHsKICBmb3IgKHZhciBrZXkgaW4gZnJvbSkgewogICAg
        aWYgKGZyb20uaGFzT3duUHJvcGVydHkoa2V5KSkgewogICAgICB0b1trZXld
        ID0gZnJvbVtrZXldOwogICAgfQogIH0KfQoKbWl4aW5Qcm9wZXJ0aWVzKEJp
        bmRpbmcsIHsKCiAgLyoKICAgIFNlZSBgRW1iZXIuQmluZGluZy5mcm9tYC4K
        CiAgICBAbWV0aG9kIGZyb20KICAgIEBzdGF0aWMKICAqLwogIGZyb206IGZ1
        bmN0aW9uKCkgewogICAgdmFyIEMgPSB0aGlzLCBiaW5kaW5nID0gbmV3IEMo
        KTsKICAgIHJldHVybiBiaW5kaW5nLmZyb20uYXBwbHkoYmluZGluZywgYXJn
        dW1lbnRzKTsKICB9LAoKICAvKgogICAgU2VlIGBFbWJlci5CaW5kaW5nLnRv
        YC4KCiAgICBAbWV0aG9kIHRvCiAgICBAc3RhdGljCiAgKi8KICB0bzogZnVu
        Y3Rpb24oKSB7CiAgICB2YXIgQyA9IHRoaXMsIGJpbmRpbmcgPSBuZXcgQygp
        OwogICAgcmV0dXJuIGJpbmRpbmcudG8uYXBwbHkoYmluZGluZywgYXJndW1l
        bnRzKTsKICB9LAoKICAvKioKICAgIENyZWF0ZXMgYSBuZXcgQmluZGluZyBp
        bnN0YW5jZSBhbmQgbWFrZXMgaXQgYXBwbHkgaW4gYSBzaW5nbGUgZGlyZWN0
        aW9uLgogICAgQSBvbmUtd2F5IGJpbmRpbmcgd2lsbCByZWxheSBjaGFuZ2Vz
        IG9uIHRoZSBgZnJvbWAgc2lkZSBvYmplY3QgKHN1cHBsaWVkCiAgICBhcyB0
        aGUgYGZyb21gIGFyZ3VtZW50KSB0aGUgYHRvYCBzaWRlLCBidXQgbm90IHRo
        ZSBvdGhlciB3YXkgYXJvdW5kLgogICAgVGhpcyBtZWFucyB0aGF0IGlmIHlv
        dSBjaGFuZ2UgdGhlICJ0byIgc2lkZSBkaXJlY3RseSwgdGhlICJmcm9tIiBz
        aWRlIG1heSBoYXZlCiAgICBhIGRpZmZlcmVudCB2YWx1ZS4KCiAgICBTZWUg
        YEJpbmRpbmcub25lV2F5YC4KCiAgICBAbWV0aG9kIG9uZVdheQogICAgQHBh
        cmFtIHtTdHJpbmd9IGZyb20gZnJvbSBwYXRoLgogICAgQHBhcmFtIHtCb29s
        ZWFufSBbZmxhZ10gKE9wdGlvbmFsKSBwYXNzaW5nIG5vdGhpbmcgaGVyZSB3
        aWxsIG1ha2UgdGhlCiAgICAgIGJpbmRpbmcgYG9uZVdheWAuIFlvdSBjYW4g
        aW5zdGVhZCBwYXNzIGBmYWxzZWAgdG8gZGlzYWJsZSBgb25lV2F5YCwgbWFr
        aW5nIHRoZQogICAgICBiaW5kaW5nIHR3byB3YXkgYWdhaW4uCiAgICBAcmV0
        dXJuIHtFbWJlci5CaW5kaW5nfSBgdGhpc2AKICAqLwogIG9uZVdheTogZnVu
        Y3Rpb24oZnJvbSwgZmxhZykgewogICAgdmFyIEMgPSB0aGlzLCBiaW5kaW5n
        ID0gbmV3IEMobnVsbCwgZnJvbSk7CiAgICByZXR1cm4gYmluZGluZy5vbmVX
        YXkoZmxhZyk7CiAgfQoKfSk7CgovKioKICBBbiBgRW1iZXIuQmluZGluZ2Ag
        Y29ubmVjdHMgdGhlIHByb3BlcnRpZXMgb2YgdHdvIG9iamVjdHMgc28gdGhh
        dCB3aGVuZXZlcgogIHRoZSB2YWx1ZSBvZiBvbmUgcHJvcGVydHkgY2hhbmdl
        cywgdGhlIG90aGVyIHByb3BlcnR5IHdpbGwgYmUgY2hhbmdlZCBhbHNvLgoK
        ICAjIyBBdXRvbWF0aWMgQ3JlYXRpb24gb2YgQmluZGluZ3Mgd2l0aCBgL14q
        QmluZGluZy9gLW5hbWVkIFByb3BlcnRpZXMKCiAgWW91IGRvIG5vdCB1c3Vh
        bGx5IGNyZWF0ZSBCaW5kaW5nIG9iamVjdHMgZGlyZWN0bHkgYnV0IGluc3Rl
        YWQgZGVzY3JpYmUKICBiaW5kaW5ncyBpbiB5b3VyIGNsYXNzIG9yIG9iamVj
        dCBkZWZpbml0aW9uIHVzaW5nIGF1dG9tYXRpYyBiaW5kaW5nCiAgZGV0ZWN0
        aW9uLgoKICBQcm9wZXJ0aWVzIGVuZGluZyBpbiBhIGBCaW5kaW5nYCBzdWZm
        aXggd2lsbCBiZSBjb252ZXJ0ZWQgdG8gYEVtYmVyLkJpbmRpbmdgCiAgaW5z
        dGFuY2VzLiBUaGUgdmFsdWUgb2YgdGhpcyBwcm9wZXJ0eSBzaG91bGQgYmUg
        YSBzdHJpbmcgcmVwcmVzZW50aW5nIGEgcGF0aAogIHRvIGFub3RoZXIgb2Jq
        ZWN0IG9yIGEgY3VzdG9tIGJpbmRpbmcgaW5zdGFuY2VkIGNyZWF0ZWQgdXNp
        bmcgQmluZGluZyBoZWxwZXJzCiAgKHNlZSAiT25lIFdheSBCaW5kaW5ncyIp
        OgoKICBgYGAKICB2YWx1ZUJpbmRpbmc6ICJNeUFwcC5zb21lQ29udHJvbGxl
        ci50aXRsZSIKICBgYGAKCiAgVGhpcyB3aWxsIGNyZWF0ZSBhIGJpbmRpbmcg
        ZnJvbSBgTXlBcHAuc29tZUNvbnRyb2xsZXIudGl0bGVgIHRvIHRoZSBgdmFs
        dWVgCiAgcHJvcGVydHkgb2YgeW91ciBvYmplY3QgaW5zdGFuY2UgYXV0b21h
        dGljYWxseS4gTm93IHRoZSB0d28gdmFsdWVzIHdpbGwgYmUKICBrZXB0IGlu
        IHN5bmMuCgogICMjIE9uZSBXYXkgQmluZGluZ3MKCiAgT25lIGVzcGVjaWFs
        bHkgdXNlZnVsIGJpbmRpbmcgY3VzdG9taXphdGlvbiB5b3UgY2FuIHVzZSBp
        cyB0aGUgYG9uZVdheSgpYAogIGhlbHBlci4gVGhpcyBoZWxwZXIgdGVsbHMg
        RW1iZXIgdGhhdCB5b3UgYXJlIG9ubHkgaW50ZXJlc3RlZCBpbgogIHJlY2Vp
        dmluZyBjaGFuZ2VzIG9uIHRoZSBvYmplY3QgeW91IGFyZSBiaW5kaW5nIGZy
        b20uIEZvciBleGFtcGxlLCBpZiB5b3UKICBhcmUgYmluZGluZyB0byBhIHBy
        ZWZlcmVuY2UgYW5kIHlvdSB3YW50IHRvIGJlIG5vdGlmaWVkIGlmIHRoZSBw
        cmVmZXJlbmNlCiAgaGFzIGNoYW5nZWQsIGJ1dCB5b3VyIG9iamVjdCB3aWxs
        IG5vdCBiZSBjaGFuZ2luZyB0aGUgcHJlZmVyZW5jZSBpdHNlbGYsIHlvdQog
        IGNvdWxkIGRvOgoKICBgYGAKICBiaWdUaXRsZXNCaW5kaW5nOiBFbWJlci5C
        aW5kaW5nLm9uZVdheSgiTXlBcHAucHJlZmVyZW5jZXNDb250cm9sbGVyLmJp
        Z1RpdGxlcyIpCiAgYGBgCgogIFRoaXMgd2F5IGlmIHRoZSB2YWx1ZSBvZiBg
        TXlBcHAucHJlZmVyZW5jZXNDb250cm9sbGVyLmJpZ1RpdGxlc2AgY2hhbmdl
        cyB0aGUKICBgYmlnVGl0bGVzYCBwcm9wZXJ0eSBvZiB5b3VyIG9iamVjdCB3
        aWxsIGNoYW5nZSBhbHNvLiBIb3dldmVyLCBpZiB5b3UKICBjaGFuZ2UgdGhl
        IHZhbHVlIG9mIHlvdXIgYGJpZ1RpdGxlc2AgcHJvcGVydHksIGl0IHdpbGwg
        bm90IHVwZGF0ZSB0aGUKICBgcHJlZmVyZW5jZXNDb250cm9sbGVyYC4KCiAg
        T25lIHdheSBiaW5kaW5ncyBhcmUgYWxtb3N0IHR3aWNlIGFzIGZhc3QgdG8g
        c2V0dXAgYW5kIHR3aWNlIGFzIGZhc3QgdG8KICBleGVjdXRlIGJlY2F1c2Ug
        dGhlIGJpbmRpbmcgb25seSBoYXMgdG8gd29ycnkgYWJvdXQgY2hhbmdlcyB0
        byBvbmUgc2lkZS4KCiAgWW91IHNob3VsZCBjb25zaWRlciB1c2luZyBvbmUg
        d2F5IGJpbmRpbmdzIGFueXRpbWUgeW91IGhhdmUgYW4gb2JqZWN0IHRoYXQK
        ICBtYXkgYmUgY3JlYXRlZCBmcmVxdWVudGx5IGFuZCB5b3UgZG8gbm90IGlu
        dGVuZCB0byBjaGFuZ2UgYSBwcm9wZXJ0eTsgb25seQogIHRvIG1vbml0b3Ig
        aXQgZm9yIGNoYW5nZXMgKHN1Y2ggYXMgaW4gdGhlIGV4YW1wbGUgYWJvdmUp
        LgoKICAjIyBBZGRpbmcgQmluZGluZ3MgTWFudWFsbHkKCiAgQWxsIG9mIHRo
        ZSBleGFtcGxlcyBhYm92ZSBzaG93IHlvdSBob3cgdG8gY29uZmlndXJlIGEg
        Y3VzdG9tIGJpbmRpbmcsIGJ1dCB0aGUKICByZXN1bHQgb2YgdGhlc2UgY3Vz
        dG9taXphdGlvbnMgd2lsbCBiZSBhIGJpbmRpbmcgdGVtcGxhdGUsIG5vdCBh
        IGZ1bGx5IGFjdGl2ZQogIEJpbmRpbmcgaW5zdGFuY2UuIFRoZSBiaW5kaW5n
        IHdpbGwgYWN0dWFsbHkgYmVjb21lIGFjdGl2ZSBvbmx5IHdoZW4geW91CiAg
        aW5zdGFudGlhdGUgdGhlIG9iamVjdCB0aGUgYmluZGluZyBiZWxvbmdzIHRv
        LiBJdCBpcyB1c2VmdWwgaG93ZXZlciwgdG8KICB1bmRlcnN0YW5kIHdoYXQg
        YWN0dWFsbHkgaGFwcGVucyB3aGVuIHRoZSBiaW5kaW5nIGlzIGFjdGl2YXRl
        ZC4KCiAgRm9yIGEgYmluZGluZyB0byBmdW5jdGlvbiBpdCBtdXN0IGhhdmUg
        YXQgbGVhc3QgYSBgZnJvbWAgcHJvcGVydHkgYW5kIGEgYHRvYAogIHByb3Bl
        cnR5LiBUaGUgYGZyb21gIHByb3BlcnR5IHBhdGggcG9pbnRzIHRvIHRoZSBv
        YmplY3Qva2V5IHRoYXQgeW91IHdhbnQgdG8KICBiaW5kIGZyb20gd2hpbGUg
        dGhlIGB0b2AgcGF0aCBwb2ludHMgdG8gdGhlIG9iamVjdC9rZXkgeW91IHdh
        bnQgdG8gYmluZCB0by4KCiAgV2hlbiB5b3UgZGVmaW5lIGEgY3VzdG9tIGJp
        bmRpbmcsIHlvdSBhcmUgdXN1YWxseSBkZXNjcmliaW5nIHRoZSBwcm9wZXJ0
        eQogIHlvdSB3YW50IHRvIGJpbmQgZnJvbSAoc3VjaCBhcyBgTXlBcHAuc29t
        ZUNvbnRyb2xsZXIudmFsdWVgIGluIHRoZSBleGFtcGxlcwogIGFib3ZlKS4g
        V2hlbiB5b3VyIG9iamVjdCBpcyBjcmVhdGVkLCBpdCB3aWxsIGF1dG9tYXRp
        Y2FsbHkgYXNzaWduIHRoZSB2YWx1ZQogIHlvdSB3YW50IHRvIGJpbmQgYHRv
        YCBiYXNlZCBvbiB0aGUgbmFtZSBvZiB5b3VyIGJpbmRpbmcga2V5LiBJbiB0
        aGUKICBleGFtcGxlcyBhYm92ZSwgZHVyaW5nIGluaXQsIEVtYmVyIG9iamVj
        dHMgd2lsbCBlZmZlY3RpdmVseSBjYWxsCiAgc29tZXRoaW5nIGxpa2UgdGhp
        cyBvbiB5b3VyIGJpbmRpbmc6CgogIGBgYGphdmFzY3JpcHQKICBiaW5kaW5n
        ID0gRW1iZXIuQmluZGluZy5mcm9tKHRoaXMudmFsdWVCaW5kaW5nKS50bygi
        dmFsdWUiKTsKICBgYGAKCiAgVGhpcyBjcmVhdGVzIGEgbmV3IGJpbmRpbmcg
        aW5zdGFuY2UgYmFzZWQgb24gdGhlIHRlbXBsYXRlIHlvdSBwcm92aWRlLCBh
        bmQKICBzZXRzIHRoZSB0byBwYXRoIHRvIHRoZSBgdmFsdWVgIHByb3BlcnR5
        IG9mIHRoZSBuZXcgb2JqZWN0LiBOb3cgdGhhdCB0aGUKICBiaW5kaW5nIGlz
        IGZ1bGx5IGNvbmZpZ3VyZWQgd2l0aCBhIGBmcm9tYCBhbmQgYSBgdG9gLCBp
        dCBzaW1wbHkgbmVlZHMgdG8gYmUKICBjb25uZWN0ZWQgdG8gYmVjb21lIGFj
        dGl2ZS4gVGhpcyBpcyBkb25lIHRocm91Z2ggdGhlIGBjb25uZWN0KClgIG1l
        dGhvZDoKCiAgYGBgamF2YXNjcmlwdAogIGJpbmRpbmcuY29ubmVjdCh0aGlz
        KTsKICBgYGAKCiAgTm90ZSB0aGF0IHdoZW4geW91IGNvbm5lY3QgYSBiaW5k
        aW5nIHlvdSBwYXNzIHRoZSBvYmplY3QgeW91IHdhbnQgaXQgdG8gYmUKICBj
        b25uZWN0ZWQgdG8uIFRoaXMgb2JqZWN0IHdpbGwgYmUgdXNlZCBhcyB0aGUg
        cm9vdCBmb3IgYm90aCB0aGUgZnJvbSBhbmQKICB0byBzaWRlIG9mIHRoZSBi
        aW5kaW5nIHdoZW4gaW5zcGVjdGluZyByZWxhdGl2ZSBwYXRocy4gVGhpcyBh
        bGxvd3MgdGhlCiAgYmluZGluZyB0byBiZSBhdXRvbWF0aWNhbGx5IGluaGVy
        aXRlZCBieSBzdWJjbGFzc2VkIG9iamVjdHMgYXMgd2VsbC4KCiAgTm93IHRo
        YXQgdGhlIGJpbmRpbmcgaXMgY29ubmVjdGVkLCBpdCB3aWxsIG9ic2VydmUg
        Ym90aCB0aGUgZnJvbSBhbmQgdG8gc2lkZQogIGFuZCByZWxheSBjaGFuZ2Vz
        LgoKICBJZiB5b3UgZXZlciBuZWVkZWQgdG8gZG8gc28gKHlvdSBhbG1vc3Qg
        bmV2ZXIgd2lsbCwgYnV0IGl0IGlzIHVzZWZ1bCB0bwogIHVuZGVyc3RhbmQg
        dGhpcyBhbnl3YXkpLCB5b3UgY291bGQgbWFudWFsbHkgY3JlYXRlIGFuIGFj
        dGl2ZSBiaW5kaW5nIGJ5CiAgdXNpbmcgdGhlIGBFbWJlci5iaW5kKClgIGhl
        bHBlciBtZXRob2QuIChUaGlzIGlzIHRoZSBzYW1lIG1ldGhvZCB1c2VkIGJ5
        CiAgdG8gc2V0dXAgeW91ciBiaW5kaW5ncyBvbiBvYmplY3RzKToKCiAgYGBg
        amF2YXNjcmlwdAogIEVtYmVyLmJpbmQoTXlBcHAuYW5vdGhlck9iamVjdCwg
        InZhbHVlIiwgIk15QXBwLnNvbWVDb250cm9sbGVyLnZhbHVlIik7CiAgYGBg
        CgogIEJvdGggb2YgdGhlc2UgY29kZSBmcmFnbWVudHMgaGF2ZSB0aGUgc2Ft
        ZSBlZmZlY3QgYXMgZG9pbmcgdGhlIG1vc3QgZnJpZW5kbHkKICBmb3JtIG9m
        IGJpbmRpbmcgY3JlYXRpb24gbGlrZSBzbzoKCiAgYGBgamF2YXNjcmlwdAog
        IE15QXBwLmFub3RoZXJPYmplY3QgPSBFbWJlci5PYmplY3QuY3JlYXRlKHsK
        ICAgIHZhbHVlQmluZGluZzogIk15QXBwLnNvbWVDb250cm9sbGVyLnZhbHVl
        IiwKCiAgICAvLyBPVEhFUiBDT0RFIEZPUiBUSElTIE9CSkVDVC4uLgogIH0p
        OwogIGBgYAoKICBFbWJlcidzIGJ1aWx0IGluIGJpbmRpbmcgY3JlYXRpb24g
        bWV0aG9kIG1ha2VzIGl0IGVhc3kgdG8gYXV0b21hdGljYWxseQogIGNyZWF0
        ZSBiaW5kaW5ncyBmb3IgeW91LiBZb3Ugc2hvdWxkIGFsd2F5cyB1c2UgdGhl
        IGhpZ2hlc3QtbGV2ZWwgQVBJcwogIGF2YWlsYWJsZSwgZXZlbiBpZiB5b3Ug
        dW5kZXJzdGFuZCBob3cgaXQgd29ya3MgdW5kZXJuZWF0aC4KCiAgQGNsYXNz
        IEJpbmRpbmcKICBAbmFtZXNwYWNlIEVtYmVyCiAgQHNpbmNlIEVtYmVyIDAu
        OQoqLwpFbWJlci5CaW5kaW5nID0gQmluZGluZzsKCgovKioKICBHbG9iYWwg
        aGVscGVyIG1ldGhvZCB0byBjcmVhdGUgYSBuZXcgYmluZGluZy4gSnVzdCBw
        YXNzIHRoZSByb290IG9iamVjdAogIGFsb25nIHdpdGggYSBgdG9gIGFuZCBg
        ZnJvbWAgcGF0aCB0byBjcmVhdGUgYW5kIGNvbm5lY3QgdGhlIGJpbmRpbmcu
        CgogIEBtZXRob2QgYmluZAogIEBmb3IgRW1iZXIKICBAcGFyYW0ge09iamVj
        dH0gb2JqIFRoZSByb290IG9iamVjdCBvZiB0aGUgdHJhbnNmb3JtLgogIEBw
        YXJhbSB7U3RyaW5nfSB0byBUaGUgcGF0aCB0byB0aGUgJ3RvJyBzaWRlIG9m
        IHRoZSBiaW5kaW5nLgogICAgTXVzdCBiZSByZWxhdGl2ZSB0byBvYmouCiAg
        QHBhcmFtIHtTdHJpbmd9IGZyb20gVGhlIHBhdGggdG8gdGhlICdmcm9tJyBz
        aWRlIG9mIHRoZSBiaW5kaW5nLgogICAgTXVzdCBiZSByZWxhdGl2ZSB0byBv
        Ymogb3IgYSBnbG9iYWwgcGF0aC4KICBAcmV0dXJuIHtFbWJlci5CaW5kaW5n
        fSBiaW5kaW5nIGluc3RhbmNlCiovCkVtYmVyLmJpbmQgPSBmdW5jdGlvbihv
        YmosIHRvLCBmcm9tKSB7CiAgcmV0dXJuIG5ldyBFbWJlci5CaW5kaW5nKHRv
        LCBmcm9tKS5jb25uZWN0KG9iaik7Cn07CgovKioKICBAbWV0aG9kIG9uZVdh
        eQogIEBmb3IgRW1iZXIKICBAcGFyYW0ge09iamVjdH0gb2JqIFRoZSByb290
        IG9iamVjdCBvZiB0aGUgdHJhbnNmb3JtLgogIEBwYXJhbSB7U3RyaW5nfSB0
        byBUaGUgcGF0aCB0byB0aGUgJ3RvJyBzaWRlIG9mIHRoZSBiaW5kaW5nLgog
        ICAgTXVzdCBiZSByZWxhdGl2ZSB0byBvYmouCiAgQHBhcmFtIHtTdHJpbmd9
        IGZyb20gVGhlIHBhdGggdG8gdGhlICdmcm9tJyBzaWRlIG9mIHRoZSBiaW5k
        aW5nLgogICAgTXVzdCBiZSByZWxhdGl2ZSB0byBvYmogb3IgYSBnbG9iYWwg
        cGF0aC4KICBAcmV0dXJuIHtFbWJlci5CaW5kaW5nfSBiaW5kaW5nIGluc3Rh
        bmNlCiovCkVtYmVyLm9uZVdheSA9IGZ1bmN0aW9uKG9iaiwgdG8sIGZyb20p
        IHsKICByZXR1cm4gbmV3IEVtYmVyLkJpbmRpbmcodG8sIGZyb20pLm9uZVdh
        eSgpLmNvbm5lY3Qob2JqKTsKfTsKCn0pKCk7CgoKCihmdW5jdGlvbigpIHsK
        LyoqCkBtb2R1bGUgZW1iZXIKQHN1Ym1vZHVsZSBlbWJlci1tZXRhbAoqLwoK
        dmFyIE1peGluLCBSRVFVSVJFRCwgQWxpYXMsCiAgICBhX21hcCA9IEVtYmVy
        LkFycmF5UG9seWZpbGxzLm1hcCwKICAgIGFfaW5kZXhPZiA9IEVtYmVyLkFy
        cmF5UG9seWZpbGxzLmluZGV4T2YsCiAgICBhX2ZvckVhY2ggPSBFbWJlci5B
        cnJheVBvbHlmaWxscy5mb3JFYWNoLAogICAgYV9zbGljZSA9IFtdLnNsaWNl
        LAogICAgb19jcmVhdGUgPSBFbWJlci5jcmVhdGUsCiAgICBkZWZpbmVQcm9w
        ZXJ0eSA9IEVtYmVyLmRlZmluZVByb3BlcnR5LAogICAgZ3VpZEZvciA9IEVt
        YmVyLmd1aWRGb3I7CgpmdW5jdGlvbiBtaXhpbnNNZXRhKG9iaikgewogIHZh
        ciBtID0gRW1iZXIubWV0YShvYmosIHRydWUpLCByZXQgPSBtLm1peGluczsK
        ICBpZiAoIXJldCkgewogICAgcmV0ID0gbS5taXhpbnMgPSB7fTsKICB9IGVs
        c2UgaWYgKCFtLmhhc093blByb3BlcnR5KCdtaXhpbnMnKSkgewogICAgcmV0
        ID0gbS5taXhpbnMgPSBvX2NyZWF0ZShyZXQpOwogIH0KICByZXR1cm4gcmV0
        Owp9CgpmdW5jdGlvbiBpbml0TWl4aW4obWl4aW4sIGFyZ3MpIHsKICBpZiAo
        YXJncyAmJiBhcmdzLmxlbmd0aCA+IDApIHsKICAgIG1peGluLm1peGlucyA9
        IGFfbWFwLmNhbGwoYXJncywgZnVuY3Rpb24oeCkgewogICAgICBpZiAoeCBp
        bnN0YW5jZW9mIE1peGluKSB7IHJldHVybiB4OyB9CgogICAgICAvLyBOb3Rl
        OiBNYW51YWxseSBzZXR1cCBhIHByaW1pdGl2ZSBtaXhpbiBoZXJlLiBUaGlz
        IGlzIHRoZSBvbmx5CiAgICAgIC8vIHdheSB0byBhY3R1YWxseSBnZXQgYSBw
        cmltaXRpdmUgbWl4aW4uIFRoaXMgd2F5IG5vcm1hbCBjcmVhdGlvbgogICAg
        ICAvLyBvZiBtaXhpbnMgd2lsbCBnaXZlIHlvdSBjb21iaW5lZCBtaXhpbnMu
        Li4KICAgICAgdmFyIG1peGluID0gbmV3IE1peGluKCk7CiAgICAgIG1peGlu
        LnByb3BlcnRpZXMgPSB4OwogICAgICByZXR1cm4gbWl4aW47CiAgICB9KTsK
        ICB9CiAgcmV0dXJuIG1peGluOwp9CgpmdW5jdGlvbiBpc01ldGhvZChvYmop
        IHsKICByZXR1cm4gJ2Z1bmN0aW9uJyA9PT0gdHlwZW9mIG9iaiAmJgogICAg
        ICAgICBvYmouaXNNZXRob2QgIT09IGZhbHNlICYmCiAgICAgICAgIG9iaiAh
        PT0gQm9vbGVhbiAmJiBvYmogIT09IE9iamVjdCAmJiBvYmogIT09IE51bWJl
        ciAmJiBvYmogIT09IEFycmF5ICYmIG9iaiAhPT0gRGF0ZSAmJiBvYmogIT09
        IFN0cmluZzsKfQoKdmFyIENPTlRJTlVFID0ge307CgpmdW5jdGlvbiBtaXhp
        blByb3BlcnRpZXMobWl4aW5zTWV0YSwgbWl4aW4pIHsKICB2YXIgZ3VpZDsK
        CiAgaWYgKG1peGluIGluc3RhbmNlb2YgTWl4aW4pIHsKICAgIGd1aWQgPSBn
        dWlkRm9yKG1peGluKTsKICAgIGlmIChtaXhpbnNNZXRhW2d1aWRdKSB7IHJl
        dHVybiBDT05USU5VRTsgfQogICAgbWl4aW5zTWV0YVtndWlkXSA9IG1peGlu
        OwogICAgcmV0dXJuIG1peGluLnByb3BlcnRpZXM7CiAgfSBlbHNlIHsKICAg
        IHJldHVybiBtaXhpbjsgLy8gYXBwbHkgYW5vbnltb3VzIG1peGluIHByb3Bl
        cnRpZXMKICB9Cn0KCmZ1bmN0aW9uIGNvbmNhdGVuYXRlZE1peGluUHJvcGVy
        dGllcyhjb25jYXRQcm9wLCBwcm9wcywgdmFsdWVzLCBiYXNlKSB7CiAgdmFy
        IGNvbmNhdHM7CgogIC8vIHJlc2V0IGJlZm9yZSBhZGRpbmcgZWFjaCBuZXcg
        bWl4aW4gdG8gcGlja3VwIGNvbmNhdHMgZnJvbSBwcmV2aW91cwogIGNvbmNh
        dHMgPSB2YWx1ZXNbY29uY2F0UHJvcF0gfHwgYmFzZVtjb25jYXRQcm9wXTsK
        ICBpZiAocHJvcHNbY29uY2F0UHJvcF0pIHsKICAgIGNvbmNhdHMgPSBjb25j
        YXRzID8gY29uY2F0cy5jb25jYXQocHJvcHNbY29uY2F0UHJvcF0pIDogcHJv
        cHNbY29uY2F0UHJvcF07CiAgfQoKICByZXR1cm4gY29uY2F0czsKfQoKZnVu
        Y3Rpb24gZ2l2ZURlc2NyaXB0b3JTdXBlcihtZXRhLCBrZXksIHByb3BlcnR5
        LCB2YWx1ZXMsIGRlc2NzKSB7CiAgdmFyIHN1cGVyUHJvcGVydHk7CgogIC8v
        IENvbXB1dGVkIHByb3BlcnRpZXMgb3ZlcnJpZGUgbWV0aG9kcywgYW5kIGRv
        IG5vdCBjYWxsIHN1cGVyIHRvIHRoZW0KICBpZiAodmFsdWVzW2tleV0gPT09
        IHVuZGVmaW5lZCkgewogICAgLy8gRmluZCB0aGUgb3JpZ2luYWwgZGVzY3Jp
        cHRvciBpbiBhIHBhcmVudCBtaXhpbgogICAgc3VwZXJQcm9wZXJ0eSA9IGRl
        c2NzW2tleV07CiAgfQoKICAvLyBJZiB3ZSBkaWRuJ3QgZmluZCB0aGUgb3Jp
        Z2luYWwgZGVzY3JpcHRvciBpbiBhIHBhcmVudCBtaXhpbiwgZmluZAogIC8v
        IGl0IG9uIHRoZSBvcmlnaW5hbCBvYmplY3QuCiAgc3VwZXJQcm9wZXJ0eSA9
        IHN1cGVyUHJvcGVydHkgfHwgbWV0YS5kZXNjc1trZXldOwoKICBpZiAoIXN1
        cGVyUHJvcGVydHkgfHwgIShzdXBlclByb3BlcnR5IGluc3RhbmNlb2YgRW1i
        ZXIuQ29tcHV0ZWRQcm9wZXJ0eSkpIHsKICAgIHJldHVybiBwcm9wZXJ0eTsK
        ICB9CgogIC8vIFNpbmNlIG11bHRpcGxlIG1peGlucyBtYXkgaW5oZXJpdCBm
        cm9tIHRoZSBzYW1lIHBhcmVudCwgd2UgbmVlZAogIC8vIHRvIGNsb25lIHRo
        ZSBjb21wdXRlZCBwcm9wZXJ0eSBzbyB0aGF0IG90aGVyIG1peGlucyBkbyBu
        b3QgcmVjZWl2ZQogIC8vIHRoZSB3cmFwcGVkIHZlcnNpb24uCiAgcHJvcGVy
        dHkgPSBvX2NyZWF0ZShwcm9wZXJ0eSk7CiAgcHJvcGVydHkuZnVuYyA9IEVt
        YmVyLndyYXAocHJvcGVydHkuZnVuYywgc3VwZXJQcm9wZXJ0eS5mdW5jKTsK
        CiAgcmV0dXJuIHByb3BlcnR5Owp9CgpmdW5jdGlvbiBnaXZlTWV0aG9kU3Vw
        ZXIob2JqLCBrZXksIG1ldGhvZCwgdmFsdWVzLCBkZXNjcykgewogIHZhciBz
        dXBlck1ldGhvZDsKCiAgLy8gTWV0aG9kcyBvdmVyd3JpdGUgY29tcHV0ZWQg
        cHJvcGVydGllcywgYW5kIGRvIG5vdCBjYWxsIHN1cGVyIHRvIHRoZW0uCiAg
        aWYgKGRlc2NzW2tleV0gPT09IHVuZGVmaW5lZCkgewogICAgLy8gRmluZCB0
        aGUgb3JpZ2luYWwgbWV0aG9kIGluIGEgcGFyZW50IG1peGluCiAgICBzdXBl
        ck1ldGhvZCA9IHZhbHVlc1trZXldOwogIH0KCiAgLy8gSWYgd2UgZGlkbid0
        IGZpbmQgdGhlIG9yaWdpbmFsIHZhbHVlIGluIGEgcGFyZW50IG1peGluLCBm
        aW5kIGl0IGluCiAgLy8gdGhlIG9yaWdpbmFsIG9iamVjdAogIHN1cGVyTWV0
        aG9kID0gc3VwZXJNZXRob2QgfHwgb2JqW2tleV07CgogIC8vIE9ubHkgd3Jh
        cCB0aGUgbmV3IG1ldGhvZCBpZiB0aGUgb3JpZ2luYWwgbWV0aG9kIHdhcyBh
        IGZ1bmN0aW9uCiAgaWYgKCdmdW5jdGlvbicgIT09IHR5cGVvZiBzdXBlck1l
        dGhvZCkgewogICAgcmV0dXJuIG1ldGhvZDsKICB9CgogIHJldHVybiBFbWJl
        ci53cmFwKG1ldGhvZCwgc3VwZXJNZXRob2QpOwp9CgpmdW5jdGlvbiBhcHBs
        eUNvbmNhdGVuYXRlZFByb3BlcnRpZXMob2JqLCBrZXksIHZhbHVlLCB2YWx1
        ZXMpIHsKICB2YXIgYmFzZVZhbHVlID0gdmFsdWVzW2tleV0gfHwgb2JqW2tl
        eV07CgogIGlmIChiYXNlVmFsdWUpIHsKICAgIGlmICgnZnVuY3Rpb24nID09
        PSB0eXBlb2YgYmFzZVZhbHVlLmNvbmNhdCkgewogICAgICByZXR1cm4gYmFz
        ZVZhbHVlLmNvbmNhdCh2YWx1ZSk7CiAgICB9IGVsc2UgewogICAgICByZXR1
        cm4gRW1iZXIubWFrZUFycmF5KGJhc2VWYWx1ZSkuY29uY2F0KHZhbHVlKTsK
        ICAgIH0KICB9IGVsc2UgewogICAgcmV0dXJuIEVtYmVyLm1ha2VBcnJheSh2
        YWx1ZSk7CiAgfQp9CgpmdW5jdGlvbiBhcHBseU1lcmdlZFByb3BlcnRpZXMo
        b2JqLCBrZXksIHZhbHVlLCB2YWx1ZXMpIHsKICB2YXIgYmFzZVZhbHVlID0g
        dmFsdWVzW2tleV0gfHwgb2JqW2tleV07CgogIGlmICghYmFzZVZhbHVlKSB7
        IHJldHVybiB2YWx1ZTsgfQoKICB2YXIgbmV3QmFzZSA9IEVtYmVyLm1lcmdl
        KHt9LCBiYXNlVmFsdWUpOwogIGZvciAodmFyIHByb3AgaW4gdmFsdWUpIHsK
        ICAgIGlmICghdmFsdWUuaGFzT3duUHJvcGVydHkocHJvcCkpIHsgY29udGlu
        dWU7IH0KCiAgICB2YXIgcHJvcFZhbHVlID0gdmFsdWVbcHJvcF07CiAgICBp
        ZiAoaXNNZXRob2QocHJvcFZhbHVlKSkgewogICAgICAvLyBUT0RPOiBzdXBw
        b3J0IGZvciBDb21wdXRlZCBQcm9wZXJ0aWVzLCBldGM/CiAgICAgIG5ld0Jh
        c2VbcHJvcF0gPSBnaXZlTWV0aG9kU3VwZXIob2JqLCBwcm9wLCBwcm9wVmFs
        dWUsIGJhc2VWYWx1ZSwge30pOwogICAgfSBlbHNlIHsKICAgICAgbmV3QmFz
        ZVtwcm9wXSA9IHByb3BWYWx1ZTsKICAgIH0KICB9CgogIHJldHVybiBuZXdC
        YXNlOwp9CgpmdW5jdGlvbiBhZGROb3JtYWxpemVkUHJvcGVydHkoYmFzZSwg
        a2V5LCB2YWx1ZSwgbWV0YSwgZGVzY3MsIHZhbHVlcywgY29uY2F0cywgbWVy
        Z2luZ3MpIHsKICBpZiAodmFsdWUgaW5zdGFuY2VvZiBFbWJlci5EZXNjcmlw
        dG9yKSB7CiAgICBpZiAodmFsdWUgPT09IFJFUVVJUkVEICYmIGRlc2NzW2tl
        eV0pIHsgcmV0dXJuIENPTlRJTlVFOyB9CgogICAgLy8gV3JhcCBkZXNjcmlw
        dG9yIGZ1bmN0aW9uIHRvIGltcGxlbWVudAogICAgLy8gX3N1cGVyKCkgaWYg
        bmVlZGVkCiAgICBpZiAodmFsdWUuZnVuYykgewogICAgICB2YWx1ZSA9IGdp
        dmVEZXNjcmlwdG9yU3VwZXIobWV0YSwga2V5LCB2YWx1ZSwgdmFsdWVzLCBk
        ZXNjcyk7CiAgICB9CgogICAgZGVzY3Nba2V5XSAgPSB2YWx1ZTsKICAgIHZh
        bHVlc1trZXldID0gdW5kZWZpbmVkOwogIH0gZWxzZSB7CiAgICBpZiAoKGNv
        bmNhdHMgJiYgYV9pbmRleE9mLmNhbGwoY29uY2F0cywga2V5KSA+PSAwKSB8
        fAogICAgICAgICAgICAgICAga2V5ID09PSAnY29uY2F0ZW5hdGVkUHJvcGVy
        dGllcycgfHwKICAgICAgICAgICAgICAgIGtleSA9PT0gJ21lcmdlZFByb3Bl
        cnRpZXMnKSB7CiAgICAgIHZhbHVlID0gYXBwbHlDb25jYXRlbmF0ZWRQcm9w
        ZXJ0aWVzKGJhc2UsIGtleSwgdmFsdWUsIHZhbHVlcyk7CiAgICB9IGVsc2Ug
        aWYgKChtZXJnaW5ncyAmJiBhX2luZGV4T2YuY2FsbChtZXJnaW5ncywga2V5
        KSA+PSAwKSkgewogICAgICB2YWx1ZSA9IGFwcGx5TWVyZ2VkUHJvcGVydGll
        cyhiYXNlLCBrZXksIHZhbHVlLCB2YWx1ZXMpOwogICAgfSBlbHNlIGlmIChp
        c01ldGhvZCh2YWx1ZSkpIHsKICAgICAgdmFsdWUgPSBnaXZlTWV0aG9kU3Vw
        ZXIoYmFzZSwga2V5LCB2YWx1ZSwgdmFsdWVzLCBkZXNjcyk7CiAgICB9Cgog
        ICAgZGVzY3Nba2V5XSA9IHVuZGVmaW5lZDsKICAgIHZhbHVlc1trZXldID0g
        dmFsdWU7CiAgfQp9CgpmdW5jdGlvbiBtZXJnZU1peGlucyhtaXhpbnMsIG0s
        IGRlc2NzLCB2YWx1ZXMsIGJhc2UsIGtleXMpIHsKICB2YXIgbWl4aW4sIHBy
        b3BzLCBrZXksIGNvbmNhdHMsIG1lcmdpbmdzLCBtZXRhOwoKICBmdW5jdGlv
        biByZW1vdmVLZXlzKGtleU5hbWUpIHsKICAgIGRlbGV0ZSBkZXNjc1trZXlO
        YW1lXTsKICAgIGRlbGV0ZSB2YWx1ZXNba2V5TmFtZV07CiAgfQoKICBmb3Io
        dmFyIGk9MCwgbD1taXhpbnMubGVuZ3RoOyBpPGw7IGkrKykgewogICAgbWl4
        aW4gPSBtaXhpbnNbaV07CiAgICBFbWJlci5hc3NlcnQoJ0V4cGVjdGVkIGhh
        c2ggb3IgTWl4aW4gaW5zdGFuY2UsIGdvdCAnICsgT2JqZWN0LnByb3RvdHlw
        ZS50b1N0cmluZy5jYWxsKG1peGluKSwgdHlwZW9mIG1peGluID09PSAnb2Jq
        ZWN0JyAmJiBtaXhpbiAhPT0gbnVsbCAmJiBPYmplY3QucHJvdG90eXBlLnRv
        U3RyaW5nLmNhbGwobWl4aW4pICE9PSAnW29iamVjdCBBcnJheV0nKTsKCiAg
        ICBwcm9wcyA9IG1peGluUHJvcGVydGllcyhtLCBtaXhpbik7CiAgICBpZiAo
        cHJvcHMgPT09IENPTlRJTlVFKSB7IGNvbnRpbnVlOyB9CgogICAgaWYgKHBy
        b3BzKSB7CiAgICAgIG1ldGEgPSBFbWJlci5tZXRhKGJhc2UpOwogICAgICBp
        ZiAoYmFzZS53aWxsTWVyZ2VNaXhpbikgeyBiYXNlLndpbGxNZXJnZU1peGlu
        KHByb3BzKTsgfQogICAgICBjb25jYXRzID0gY29uY2F0ZW5hdGVkTWl4aW5Q
        cm9wZXJ0aWVzKCdjb25jYXRlbmF0ZWRQcm9wZXJ0aWVzJywgcHJvcHMsIHZh
        bHVlcywgYmFzZSk7CiAgICAgIG1lcmdpbmdzID0gY29uY2F0ZW5hdGVkTWl4
        aW5Qcm9wZXJ0aWVzKCdtZXJnZWRQcm9wZXJ0aWVzJywgcHJvcHMsIHZhbHVl
        cywgYmFzZSk7CgogICAgICBmb3IgKGtleSBpbiBwcm9wcykgewogICAgICAg
        IGlmICghcHJvcHMuaGFzT3duUHJvcGVydHkoa2V5KSkgeyBjb250aW51ZTsg
        fQogICAgICAgIGtleXMucHVzaChrZXkpOwogICAgICAgIGFkZE5vcm1hbGl6
        ZWRQcm9wZXJ0eShiYXNlLCBrZXksIHByb3BzW2tleV0sIG1ldGEsIGRlc2Nz
        LCB2YWx1ZXMsIGNvbmNhdHMsIG1lcmdpbmdzKTsKICAgICAgfQoKICAgICAg
        Ly8gbWFudWFsbHkgY29weSB0b1N0cmluZygpIGJlY2F1c2Ugc29tZSBKUyBl
        bmdpbmVzIGRvIG5vdCBlbnVtZXJhdGUgaXQKICAgICAgaWYgKHByb3BzLmhh
        c093blByb3BlcnR5KCd0b1N0cmluZycpKSB7IGJhc2UudG9TdHJpbmcgPSBw
        cm9wcy50b1N0cmluZzsgfQogICAgfSBlbHNlIGlmIChtaXhpbi5taXhpbnMp
        IHsKICAgICAgbWVyZ2VNaXhpbnMobWl4aW4ubWl4aW5zLCBtLCBkZXNjcywg
        dmFsdWVzLCBiYXNlLCBrZXlzKTsKICAgICAgaWYgKG1peGluLl93aXRob3V0
        KSB7IGFfZm9yRWFjaC5jYWxsKG1peGluLl93aXRob3V0LCByZW1vdmVLZXlz
        KTsgfQogICAgfQogIH0KfQoKdmFyIElTX0JJTkRJTkcgPSBFbWJlci5JU19C
        SU5ESU5HID0gL14uK0JpbmRpbmckLzsKCmZ1bmN0aW9uIGRldGVjdEJpbmRp
        bmcob2JqLCBrZXksIHZhbHVlLCBtKSB7CiAgaWYgKElTX0JJTkRJTkcudGVz
        dChrZXkpKSB7CiAgICB2YXIgYmluZGluZ3MgPSBtLmJpbmRpbmdzOwogICAg
        aWYgKCFiaW5kaW5ncykgewogICAgICBiaW5kaW5ncyA9IG0uYmluZGluZ3Mg
        PSB7fTsKICAgIH0gZWxzZSBpZiAoIW0uaGFzT3duUHJvcGVydHkoJ2JpbmRp
        bmdzJykpIHsKICAgICAgYmluZGluZ3MgPSBtLmJpbmRpbmdzID0gb19jcmVh
        dGUobS5iaW5kaW5ncyk7CiAgICB9CiAgICBiaW5kaW5nc1trZXldID0gdmFs
        dWU7CiAgfQp9CgpmdW5jdGlvbiBjb25uZWN0QmluZGluZ3Mob2JqLCBtKSB7
        CiAgLy8gVE9ETyBNaXhpbi5hcHBseShpbnN0YW5jZSkgc2hvdWxkIGRpc2Nv
        bm5lY3QgYmluZGluZyBpZiBleGlzdHMKICB2YXIgYmluZGluZ3MgPSBtLmJp
        bmRpbmdzLCBrZXksIGJpbmRpbmcsIHRvOwogIGlmIChiaW5kaW5ncykgewog
        ICAgZm9yIChrZXkgaW4gYmluZGluZ3MpIHsKICAgICAgYmluZGluZyA9IGJp
        bmRpbmdzW2tleV07CiAgICAgIGlmIChiaW5kaW5nKSB7CiAgICAgICAgdG8g
        PSBrZXkuc2xpY2UoMCwgLTcpOyAvLyBzdHJpcCBCaW5kaW5nIG9mZiBlbmQK
        ICAgICAgICBpZiAoYmluZGluZyBpbnN0YW5jZW9mIEVtYmVyLkJpbmRpbmcp
        IHsKICAgICAgICAgIGJpbmRpbmcgPSBiaW5kaW5nLmNvcHkoKTsgLy8gY29w
        eSBwcm90b3R5cGVzJyBpbnN0YW5jZQogICAgICAgICAgYmluZGluZy50byh0
        byk7CiAgICAgICAgfSBlbHNlIHsgLy8gYmluZGluZyBpcyBzdHJpbmcgcGF0
        aAogICAgICAgICAgYmluZGluZyA9IG5ldyBFbWJlci5CaW5kaW5nKHRvLCBi
        aW5kaW5nKTsKICAgICAgICB9CiAgICAgICAgYmluZGluZy5jb25uZWN0KG9i
        aik7CiAgICAgICAgb2JqW2tleV0gPSBiaW5kaW5nOwogICAgICB9CiAgICB9
        CiAgICAvLyBtYXJrIGFzIGFwcGxpZWQKICAgIG0uYmluZGluZ3MgPSB7fTsK
        ICB9Cn0KCmZ1bmN0aW9uIGZpbmlzaFBhcnRpYWwob2JqLCBtKSB7CiAgY29u
        bmVjdEJpbmRpbmdzKG9iaiwgbSB8fCBFbWJlci5tZXRhKG9iaikpOwogIHJl
        dHVybiBvYmo7Cn0KCmZ1bmN0aW9uIGZvbGxvd0FsaWFzKG9iaiwgZGVzYywg
        bSwgZGVzY3MsIHZhbHVlcykgewogIHZhciBhbHRLZXkgPSBkZXNjLm1ldGhv
        ZE5hbWUsIHZhbHVlOwogIGlmIChkZXNjc1thbHRLZXldIHx8IHZhbHVlc1th
        bHRLZXldKSB7CiAgICB2YWx1ZSA9IHZhbHVlc1thbHRLZXldOwogICAgZGVz
        YyAgPSBkZXNjc1thbHRLZXldOwogIH0gZWxzZSBpZiAobS5kZXNjc1thbHRL
        ZXldKSB7CiAgICBkZXNjICA9IG0uZGVzY3NbYWx0S2V5XTsKICAgIHZhbHVl
        ID0gdW5kZWZpbmVkOwogIH0gZWxzZSB7CiAgICBkZXNjID0gdW5kZWZpbmVk
        OwogICAgdmFsdWUgPSBvYmpbYWx0S2V5XTsKICB9CgogIHJldHVybiB7IGRl
        c2M6IGRlc2MsIHZhbHVlOiB2YWx1ZSB9Owp9CgpmdW5jdGlvbiB1cGRhdGVP
        YnNlcnZlcnNBbmRMaXN0ZW5lcnMob2JqLCBrZXksIG9ic2VydmVyT3JMaXN0
        ZW5lciwgcGF0aHNLZXksIHVwZGF0ZU1ldGhvZCkgewogIHZhciBwYXRocyA9
        IG9ic2VydmVyT3JMaXN0ZW5lcltwYXRoc0tleV07CgogIGlmIChwYXRocykg
        ewogICAgZm9yICh2YXIgaT0wLCBsPXBhdGhzLmxlbmd0aDsgaTxsOyBpKysp
        IHsKICAgICAgRW1iZXJbdXBkYXRlTWV0aG9kXShvYmosIHBhdGhzW2ldLCBu
        dWxsLCBrZXkpOwogICAgfQogIH0KfQoKZnVuY3Rpb24gcmVwbGFjZU9ic2Vy
        dmVyc0FuZExpc3RlbmVycyhvYmosIGtleSwgb2JzZXJ2ZXJPckxpc3RlbmVy
        KSB7CiAgdmFyIHByZXYgPSBvYmpba2V5XTsKCiAgaWYgKCdmdW5jdGlvbicg
        PT09IHR5cGVvZiBwcmV2KSB7CiAgICB1cGRhdGVPYnNlcnZlcnNBbmRMaXN0
        ZW5lcnMob2JqLCBrZXksIHByZXYsICdfX2VtYmVyX29ic2VydmVzQmVmb3Jl
        X18nLCAncmVtb3ZlQmVmb3JlT2JzZXJ2ZXInKTsKICAgIHVwZGF0ZU9ic2Vy
        dmVyc0FuZExpc3RlbmVycyhvYmosIGtleSwgcHJldiwgJ19fZW1iZXJfb2Jz
        ZXJ2ZXNfXycsICdyZW1vdmVPYnNlcnZlcicpOwogICAgdXBkYXRlT2JzZXJ2
        ZXJzQW5kTGlzdGVuZXJzKG9iaiwga2V5LCBwcmV2LCAnX19lbWJlcl9saXN0
        ZW5zX18nLCAncmVtb3ZlTGlzdGVuZXInKTsKICB9CgogIGlmICgnZnVuY3Rp
        b24nID09PSB0eXBlb2Ygb2JzZXJ2ZXJPckxpc3RlbmVyKSB7CiAgICB1cGRh
        dGVPYnNlcnZlcnNBbmRMaXN0ZW5lcnMob2JqLCBrZXksIG9ic2VydmVyT3JM
        aXN0ZW5lciwgJ19fZW1iZXJfb2JzZXJ2ZXNCZWZvcmVfXycsICdhZGRCZWZv
        cmVPYnNlcnZlcicpOwogICAgdXBkYXRlT2JzZXJ2ZXJzQW5kTGlzdGVuZXJz
        KG9iaiwga2V5LCBvYnNlcnZlck9yTGlzdGVuZXIsICdfX2VtYmVyX29ic2Vy
        dmVzX18nLCAnYWRkT2JzZXJ2ZXInKTsKICAgIHVwZGF0ZU9ic2VydmVyc0Fu
        ZExpc3RlbmVycyhvYmosIGtleSwgb2JzZXJ2ZXJPckxpc3RlbmVyLCAnX19l
        bWJlcl9saXN0ZW5zX18nLCAnYWRkTGlzdGVuZXInKTsKICB9Cn0KCmZ1bmN0
        aW9uIGFwcGx5TWl4aW4ob2JqLCBtaXhpbnMsIHBhcnRpYWwpIHsKICB2YXIg
        ZGVzY3MgPSB7fSwgdmFsdWVzID0ge30sIG0gPSBFbWJlci5tZXRhKG9iaiks
        CiAgICAgIGtleSwgdmFsdWUsIGRlc2MsIGtleXMgPSBbXTsKCiAgLy8gR28g
        dGhyb3VnaCBhbGwgbWl4aW5zIGFuZCBoYXNoZXMgcGFzc2VkIGluLCBhbmQ6
        CiAgLy8KICAvLyAqIEhhbmRsZSBjb25jYXRlbmF0ZWQgcHJvcGVydGllcwog
        IC8vICogSGFuZGxlIG1lcmdlZCBwcm9wZXJ0aWVzCiAgLy8gKiBTZXQgdXAg
        X3N1cGVyIHdyYXBwaW5nIGlmIG5lY2Vzc2FyeQogIC8vICogU2V0IHVwIGNv
        bXB1dGVkIHByb3BlcnR5IGRlc2NyaXB0b3JzCiAgLy8gKiBDb3B5aW5nIGB0
        b1N0cmluZ2AgaW4gYnJva2VuIGJyb3dzZXJzCiAgbWVyZ2VNaXhpbnMobWl4
        aW5zLCBtaXhpbnNNZXRhKG9iaiksIGRlc2NzLCB2YWx1ZXMsIG9iaiwga2V5
        cyk7CgogIGZvcih2YXIgaSA9IDAsIGwgPSBrZXlzLmxlbmd0aDsgaSA8IGw7
        IGkrKykgewogICAga2V5ID0ga2V5c1tpXTsKICAgIGlmIChrZXkgPT09ICdj
        b25zdHJ1Y3RvcicgfHwgIXZhbHVlcy5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7
        IGNvbnRpbnVlOyB9CgogICAgZGVzYyA9IGRlc2NzW2tleV07CiAgICB2YWx1
        ZSA9IHZhbHVlc1trZXldOwoKICAgIGlmIChkZXNjID09PSBSRVFVSVJFRCkg
        eyBjb250aW51ZTsgfQoKICAgIHdoaWxlIChkZXNjICYmIGRlc2MgaW5zdGFu
        Y2VvZiBBbGlhcykgewogICAgICB2YXIgZm9sbG93ZWQgPSBmb2xsb3dBbGlh
        cyhvYmosIGRlc2MsIG0sIGRlc2NzLCB2YWx1ZXMpOwogICAgICBkZXNjID0g
        Zm9sbG93ZWQuZGVzYzsKICAgICAgdmFsdWUgPSBmb2xsb3dlZC52YWx1ZTsK
        ICAgIH0KCiAgICBpZiAoZGVzYyA9PT0gdW5kZWZpbmVkICYmIHZhbHVlID09
        PSB1bmRlZmluZWQpIHsgY29udGludWU7IH0KCiAgICByZXBsYWNlT2JzZXJ2
        ZXJzQW5kTGlzdGVuZXJzKG9iaiwga2V5LCB2YWx1ZSk7CiAgICBkZXRlY3RC
        aW5kaW5nKG9iaiwga2V5LCB2YWx1ZSwgbSk7CiAgICBkZWZpbmVQcm9wZXJ0
        eShvYmosIGtleSwgZGVzYywgdmFsdWUsIG0pOwogIH0KCiAgaWYgKCFwYXJ0
        aWFsKSB7IC8vIGRvbid0IGFwcGx5IHRvIHByb3RvdHlwZQogICAgZmluaXNo
        UGFydGlhbChvYmosIG0pOwogIH0KCiAgcmV0dXJuIG9iajsKfQoKLyoqCiAg
        QG1ldGhvZCBtaXhpbgogIEBmb3IgRW1iZXIKICBAcGFyYW0gb2JqCiAgQHBh
        cmFtIG1peGlucyoKICBAcmV0dXJuIG9iagoqLwpFbWJlci5taXhpbiA9IGZ1
        bmN0aW9uKG9iaikgewogIHZhciBhcmdzID0gYV9zbGljZS5jYWxsKGFyZ3Vt
        ZW50cywgMSk7CiAgYXBwbHlNaXhpbihvYmosIGFyZ3MsIGZhbHNlKTsKICBy
        ZXR1cm4gb2JqOwp9OwoKLyoqCiAgVGhlIGBFbWJlci5NaXhpbmAgY2xhc3Mg
        YWxsb3dzIHlvdSB0byBjcmVhdGUgbWl4aW5zLCB3aG9zZSBwcm9wZXJ0aWVz
        IGNhbiBiZQogIGFkZGVkIHRvIG90aGVyIGNsYXNzZXMuIEZvciBpbnN0YW5j
        ZSwKCiAgYGBgamF2YXNjcmlwdAogIEFwcC5FZGl0YWJsZSA9IEVtYmVyLk1p
        eGluLmNyZWF0ZSh7CiAgICBlZGl0OiBmdW5jdGlvbigpIHsKICAgICAgY29u
        c29sZS5sb2coJ3N0YXJ0aW5nIHRvIGVkaXQnKTsKICAgICAgdGhpcy5zZXQo
        J2lzRWRpdGluZycsIHRydWUpOwogICAgfSwKICAgIGlzRWRpdGluZzogZmFs
        c2UKICB9KTsKCiAgLy8gTWl4IG1peGlucyBpbnRvIGNsYXNzZXMgYnkgcGFz
        c2luZyB0aGVtIGFzIHRoZSBmaXJzdCBhcmd1bWVudHMgdG8KICAvLyAuZXh0
        ZW5kLgogIEFwcC5Db21tZW50VmlldyA9IEVtYmVyLlZpZXcuZXh0ZW5kKEFw
        cC5FZGl0YWJsZSwgewogICAgdGVtcGxhdGU6IEVtYmVyLkhhbmRsZWJhcnMu
        Y29tcGlsZSgne3sjaWYgdmlldy5pc0VkaXRpbmd9fS4uLnt7ZWxzZX19Li4u
        e3svaWZ9fScpCiAgfSk7CgogIGNvbW1lbnRWaWV3ID0gQXBwLkNvbW1lbnRW
        aWV3LmNyZWF0ZSgpOwogIGNvbW1lbnRWaWV3LmVkaXQoKTsgLy8gb3V0cHV0
        cyAnc3RhcnRpbmcgdG8gZWRpdCcKICBgYGAKCiAgTm90ZSB0aGF0IE1peGlu
        cyBhcmUgY3JlYXRlZCB3aXRoIGBFbWJlci5NaXhpbi5jcmVhdGVgLCBub3QK
        ICBgRW1iZXIuTWl4aW4uZXh0ZW5kYC4KCiAgTm90ZSB0aGF0IG1peGlucyBl
        eHRlbmQgYSBjb25zdHJ1Y3RvcidzIHByb3RvdHlwZSBzbyBhcnJheXMgYW5k
        IG9iamVjdCBsaXRlcmFscwogIGRlZmluZWQgYXMgcHJvcGVydGllcyB3aWxs
        IGJlIHNoYXJlZCBhbW9uZ3N0IG9iamVjdHMgdGhhdCBpbXBsZW1lbnQgdGhl
        IG1peGluLgogIElmIHlvdSB3YW50IHRvIGRlZmluZSBhbiBwcm9wZXJ0eSBp
        biBhIG1peGluIHRoYXQgaXMgbm90IHNoYXJlZCwgeW91IGNhbiBkZWZpbmUK
        ICBpdCBlaXRoZXIgYXMgYSBjb21wdXRlZCBwcm9wZXJ0eSBvciBoYXZlIGl0
        IGJlIGNyZWF0ZWQgb24gaW5pdGlhbGl6YXRpb24gb2YgdGhlIG9iamVjdC4K
        CiAgYGBgamF2YXNjcmlwdAogIC8vZmlsdGVycyBhcnJheSB3aWxsIGJlIHNo
        YXJlZCBhbW9uZ3N0IGFueSBvYmplY3QgaW1wbGVtZW50aW5nIG1peGluCiAg
        QXBwLkZpbHRlcmFibGUgPSBFbWJlci5NaXhpbi5jcmVhdGUoewogICAgZmls
        dGVyczogRW1iZXIuQSgpCiAgfSk7CgogIC8vZmlsdGVycyB3aWxsIGJlIGEg
        c2VwYXJhdGUgIGFycmF5IGZvciBldmVyeSBvYmplY3QgaW1wbGVtZW50aW5n
        IHRoZSBtaXhpbgogIEFwcC5GaWx0ZXJhYmxlID0gRW1iZXIuTWl4aW4uY3Jl
        YXRlKHsKICAgIGZpbHRlcnM6IEVtYmVyLmNvbXB1dGVkKGZ1bmN0aW9uKCl7
        cmV0dXJuIEVtYmVyLkEoKTt9KQogIH0pOwoKICAvL2ZpbHRlcnMgd2lsbCBi
        ZSBjcmVhdGVkIGFzIGEgc2VwYXJhdGUgYXJyYXkgZHVyaW5nIHRoZSBvYmpl
        Y3QncyBpbml0aWFsaXphdGlvbgogIEFwcC5GaWx0ZXJhYmxlID0gRW1iZXIu
        TWl4aW4uY3JlYXRlKHsKICAgIGluaXQ6IGZ1bmN0aW9uKCkgewogICAgICB0
        aGlzLl9zdXBlcigpOwogICAgICB0aGlzLnNldCgiZmlsdGVycyIsIEVtYmVy
        LkEoKSk7CiAgICB9CiAgfSk7CiAgYGBgCgogIEBjbGFzcyBNaXhpbgogIEBu
        YW1lc3BhY2UgRW1iZXIKKi8KRW1iZXIuTWl4aW4gPSBmdW5jdGlvbigpIHsg
        cmV0dXJuIGluaXRNaXhpbih0aGlzLCBhcmd1bWVudHMpOyB9OwoKTWl4aW4g
        PSBFbWJlci5NaXhpbjsKCk1peGluLnByb3RvdHlwZSA9IHsKICBwcm9wZXJ0
        aWVzOiBudWxsLAogIG1peGluczogbnVsbCwKICBvd25lckNvbnN0cnVjdG9y
        OiBudWxsCn07CgpNaXhpbi5fYXBwbHkgPSBhcHBseU1peGluOwoKTWl4aW4u
        YXBwbHlQYXJ0aWFsID0gZnVuY3Rpb24ob2JqKSB7CiAgdmFyIGFyZ3MgPSBh
        X3NsaWNlLmNhbGwoYXJndW1lbnRzLCAxKTsKICByZXR1cm4gYXBwbHlNaXhp
        bihvYmosIGFyZ3MsIHRydWUpOwp9OwoKTWl4aW4uZmluaXNoUGFydGlhbCA9
        IGZpbmlzaFBhcnRpYWw7CgpFbWJlci5hbnlVbnByb2Nlc3NlZE1peGlucyA9
        IGZhbHNlOwoKLyoqCiAgQG1ldGhvZCBjcmVhdGUKICBAc3RhdGljCiAgQHBh
        cmFtIGFyZ3VtZW50cyoKKi8KTWl4aW4uY3JlYXRlID0gZnVuY3Rpb24oKSB7
        CiAgRW1iZXIuYW55VW5wcm9jZXNzZWRNaXhpbnMgPSB0cnVlOwogIHZhciBN
        ID0gdGhpczsKICByZXR1cm4gaW5pdE1peGluKG5ldyBNKCksIGFyZ3VtZW50
        cyk7Cn07Cgp2YXIgTWl4aW5Qcm90b3R5cGUgPSBNaXhpbi5wcm90b3R5cGU7
        CgovKioKICBAbWV0aG9kIHJlb3BlbgogIEBwYXJhbSBhcmd1bWVudHMqCiov
        Ck1peGluUHJvdG90eXBlLnJlb3BlbiA9IGZ1bmN0aW9uKCkgewogIHZhciBt
        aXhpbiwgdG1wOwoKICBpZiAodGhpcy5wcm9wZXJ0aWVzKSB7CiAgICBtaXhp
        biA9IE1peGluLmNyZWF0ZSgpOwogICAgbWl4aW4ucHJvcGVydGllcyA9IHRo
        aXMucHJvcGVydGllczsKICAgIGRlbGV0ZSB0aGlzLnByb3BlcnRpZXM7CiAg
        ICB0aGlzLm1peGlucyA9IFttaXhpbl07CiAgfSBlbHNlIGlmICghdGhpcy5t
        aXhpbnMpIHsKICAgIHRoaXMubWl4aW5zID0gW107CiAgfQoKICB2YXIgbGVu
        ID0gYXJndW1lbnRzLmxlbmd0aCwgbWl4aW5zID0gdGhpcy5taXhpbnMsIGlk
        eDsKCiAgZm9yKGlkeD0wOyBpZHggPCBsZW47IGlkeCsrKSB7CiAgICBtaXhp
        biA9IGFyZ3VtZW50c1tpZHhdOwogICAgRW1iZXIuYXNzZXJ0KCdFeHBlY3Rl
        ZCBoYXNoIG9yIE1peGluIGluc3RhbmNlLCBnb3QgJyArIE9iamVjdC5wcm90
        b3R5cGUudG9TdHJpbmcuY2FsbChtaXhpbiksIHR5cGVvZiBtaXhpbiA9PT0g
        J29iamVjdCcgJiYgbWl4aW4gIT09IG51bGwgJiYgT2JqZWN0LnByb3RvdHlw
        ZS50b1N0cmluZy5jYWxsKG1peGluKSAhPT0gJ1tvYmplY3QgQXJyYXldJyk7
        CgogICAgaWYgKG1peGluIGluc3RhbmNlb2YgTWl4aW4pIHsKICAgICAgbWl4
        aW5zLnB1c2gobWl4aW4pOwogICAgfSBlbHNlIHsKICAgICAgdG1wID0gTWl4
        aW4uY3JlYXRlKCk7CiAgICAgIHRtcC5wcm9wZXJ0aWVzID0gbWl4aW47CiAg
        ICAgIG1peGlucy5wdXNoKHRtcCk7CiAgICB9CiAgfQoKICByZXR1cm4gdGhp
        czsKfTsKCi8qKgogIEBtZXRob2QgYXBwbHkKICBAcGFyYW0gb2JqCiAgQHJl
        dHVybiBhcHBsaWVkIG9iamVjdAoqLwpNaXhpblByb3RvdHlwZS5hcHBseSA9
        IGZ1bmN0aW9uKG9iaikgewogIHJldHVybiBhcHBseU1peGluKG9iaiwgW3Ro
        aXNdLCBmYWxzZSk7Cn07CgpNaXhpblByb3RvdHlwZS5hcHBseVBhcnRpYWwg
        PSBmdW5jdGlvbihvYmopIHsKICByZXR1cm4gYXBwbHlNaXhpbihvYmosIFt0
        aGlzXSwgdHJ1ZSk7Cn07CgpmdW5jdGlvbiBfZGV0ZWN0KGN1ck1peGluLCB0
        YXJnZXRNaXhpbiwgc2VlbikgewogIHZhciBndWlkID0gZ3VpZEZvcihjdXJN
        aXhpbik7CgogIGlmIChzZWVuW2d1aWRdKSB7IHJldHVybiBmYWxzZTsgfQog
        IHNlZW5bZ3VpZF0gPSB0cnVlOwoKICBpZiAoY3VyTWl4aW4gPT09IHRhcmdl
        dE1peGluKSB7IHJldHVybiB0cnVlOyB9CiAgdmFyIG1peGlucyA9IGN1ck1p
        eGluLm1peGlucywgbG9jID0gbWl4aW5zID8gbWl4aW5zLmxlbmd0aCA6IDA7
        CiAgd2hpbGUgKC0tbG9jID49IDApIHsKICAgIGlmIChfZGV0ZWN0KG1peGlu
        c1tsb2NdLCB0YXJnZXRNaXhpbiwgc2VlbikpIHsgcmV0dXJuIHRydWU7IH0K
        ICB9CiAgcmV0dXJuIGZhbHNlOwp9CgovKioKICBAbWV0aG9kIGRldGVjdAog
        IEBwYXJhbSBvYmoKICBAcmV0dXJuIHtCb29sZWFufQoqLwpNaXhpblByb3Rv
        dHlwZS5kZXRlY3QgPSBmdW5jdGlvbihvYmopIHsKICBpZiAoIW9iaikgeyBy
        ZXR1cm4gZmFsc2U7IH0KICBpZiAob2JqIGluc3RhbmNlb2YgTWl4aW4pIHsg
        cmV0dXJuIF9kZXRlY3Qob2JqLCB0aGlzLCB7fSk7IH0KICB2YXIgbWl4aW5z
        ID0gRW1iZXIubWV0YShvYmosIGZhbHNlKS5taXhpbnM7CiAgaWYgKG1peGlu
        cykgewogICAgcmV0dXJuICEhbWl4aW5zW2d1aWRGb3IodGhpcyldOwogIH0K
        ICByZXR1cm4gZmFsc2U7Cn07CgpNaXhpblByb3RvdHlwZS53aXRob3V0ID0g
        ZnVuY3Rpb24oKSB7CiAgdmFyIHJldCA9IG5ldyBNaXhpbih0aGlzKTsKICBy
        ZXQuX3dpdGhvdXQgPSBhX3NsaWNlLmNhbGwoYXJndW1lbnRzKTsKICByZXR1
        cm4gcmV0Owp9OwoKZnVuY3Rpb24gX2tleXMocmV0LCBtaXhpbiwgc2Vlbikg
        ewogIGlmIChzZWVuW2d1aWRGb3IobWl4aW4pXSkgeyByZXR1cm47IH0KICBz
        ZWVuW2d1aWRGb3IobWl4aW4pXSA9IHRydWU7CgogIGlmIChtaXhpbi5wcm9w
        ZXJ0aWVzKSB7CiAgICB2YXIgcHJvcHMgPSBtaXhpbi5wcm9wZXJ0aWVzOwog
        ICAgZm9yICh2YXIga2V5IGluIHByb3BzKSB7CiAgICAgIGlmIChwcm9wcy5o
        YXNPd25Qcm9wZXJ0eShrZXkpKSB7IHJldFtrZXldID0gdHJ1ZTsgfQogICAg
        fQogIH0gZWxzZSBpZiAobWl4aW4ubWl4aW5zKSB7CiAgICBhX2ZvckVhY2gu
        Y2FsbChtaXhpbi5taXhpbnMsIGZ1bmN0aW9uKHgpIHsgX2tleXMocmV0LCB4
        LCBzZWVuKTsgfSk7CiAgfQp9CgpNaXhpblByb3RvdHlwZS5rZXlzID0gZnVu
        Y3Rpb24oKSB7CiAgdmFyIGtleXMgPSB7fSwgc2VlbiA9IHt9LCByZXQgPSBb
        XTsKICBfa2V5cyhrZXlzLCB0aGlzLCBzZWVuKTsKICBmb3IodmFyIGtleSBp
        biBrZXlzKSB7CiAgICBpZiAoa2V5cy5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7
        IHJldC5wdXNoKGtleSk7IH0KICB9CiAgcmV0dXJuIHJldDsKfTsKCi8vIHJl
        dHVybnMgdGhlIG1peGlucyBjdXJyZW50bHkgYXBwbGllZCB0byB0aGUgc3Bl
        Y2lmaWVkIG9iamVjdAovLyBUT0RPOiBNYWtlIEVtYmVyLm1peGluCk1peGlu
        Lm1peGlucyA9IGZ1bmN0aW9uKG9iaikgewogIHZhciBtaXhpbnMgPSBFbWJl
        ci5tZXRhKG9iaiwgZmFsc2UpLm1peGlucywgcmV0ID0gW107CgogIGlmICgh
        bWl4aW5zKSB7IHJldHVybiByZXQ7IH0KCiAgZm9yICh2YXIga2V5IGluIG1p
        eGlucykgewogICAgdmFyIG1peGluID0gbWl4aW5zW2tleV07CgogICAgLy8g
        c2tpcCBwcmltaXRpdmUgbWl4aW5zIHNpbmNlIHRoZXNlIGFyZSBhbHdheXMg
        YW5vbnltb3VzCiAgICBpZiAoIW1peGluLnByb3BlcnRpZXMpIHsgcmV0LnB1
        c2gobWl4aW4pOyB9CiAgfQoKICByZXR1cm4gcmV0Owp9OwoKUkVRVUlSRUQg
        PSBuZXcgRW1iZXIuRGVzY3JpcHRvcigpOwpSRVFVSVJFRC50b1N0cmluZyA9
        IGZ1bmN0aW9uKCkgeyByZXR1cm4gJyhSZXF1aXJlZCBQcm9wZXJ0eSknOyB9
        OwoKLyoqCiAgRGVub3RlcyBhIHJlcXVpcmVkIHByb3BlcnR5IGZvciBhIG1p
        eGluCgogIEBtZXRob2QgcmVxdWlyZWQKICBAZm9yIEVtYmVyCiovCkVtYmVy
        LnJlcXVpcmVkID0gZnVuY3Rpb24oKSB7CiAgcmV0dXJuIFJFUVVJUkVEOwp9
        OwoKQWxpYXMgPSBmdW5jdGlvbihtZXRob2ROYW1lKSB7CiAgdGhpcy5tZXRo
        b2ROYW1lID0gbWV0aG9kTmFtZTsKfTsKQWxpYXMucHJvdG90eXBlID0gbmV3
        IEVtYmVyLkRlc2NyaXB0b3IoKTsKCi8qKgogIE1ha2VzIGEgcHJvcGVydHkg
        b3IgbWV0aG9kIGF2YWlsYWJsZSB2aWEgYW4gYWRkaXRpb25hbCBuYW1lLgoK
        ICBgYGBqYXZhc2NyaXB0CiAgQXBwLlBhaW50U2FtcGxlID0gRW1iZXIuT2Jq
        ZWN0LmV4dGVuZCh7CiAgICBjb2xvcjogJ3JlZCcsCiAgICBjb2xvdXI6IEVt
        YmVyLmFsaWFzKCdjb2xvcicpLAogICAgbmFtZTogZnVuY3Rpb24oKSB7CiAg
        ICAgIHJldHVybiAiWmVkIjsKICAgIH0sCiAgICBtb25pa2VyOiBFbWJlci5h
        bGlhcygibmFtZSIpCiAgfSk7CgogIHZhciBwYWludFNhbXBsZSA9IEFwcC5Q
        YWludFNhbXBsZS5jcmVhdGUoKQogIHBhaW50U2FtcGxlLmdldCgnY29sb3Vy
        Jyk7ICAvLyAncmVkJwogIHBhaW50U2FtcGxlLm1vbmlrZXIoKTsgICAgICAv
        LyAnWmVkJwogIGBgYAoKICBAbWV0aG9kIGFsaWFzCiAgQGZvciBFbWJlcgog
        IEBwYXJhbSB7U3RyaW5nfSBtZXRob2ROYW1lIG5hbWUgb2YgdGhlIG1ldGhv
        ZCBvciBwcm9wZXJ0eSB0byBhbGlhcwogIEByZXR1cm4ge0VtYmVyLkRlc2Ny
        aXB0b3J9CiAgQGRlcHJlY2F0ZWQgVXNlIGBFbWJlci5hbGlhc01ldGhvZGAg
        b3IgYEVtYmVyLmNvbXB1dGVkLmFsaWFzYCBpbnN0ZWFkCiovCkVtYmVyLmFs
        aWFzID0gZnVuY3Rpb24obWV0aG9kTmFtZSkgewogIEVtYmVyLmRlcHJlY2F0
        ZSgiRW1iZXIuYWxpYXMgaXMgZGVwcmVjYXRlZC4gUGxlYXNlIHVzZSBFbWJl
        ci5hbGlhc01ldGhvZCBvciBFbWJlci5jb21wdXRlZC5hbGlhcyBpbnN0ZWFk
        LiIpOwogIHJldHVybiBuZXcgQWxpYXMobWV0aG9kTmFtZSk7Cn07CgovKioK
        ICBNYWtlcyBhIG1ldGhvZCBhdmFpbGFibGUgdmlhIGFuIGFkZGl0aW9uYWwg
        bmFtZS4KCiAgYGBgamF2YXNjcmlwdAogIEFwcC5QZXJzb24gPSBFbWJlci5P
        YmplY3QuZXh0ZW5kKHsKICAgIG5hbWU6IGZ1bmN0aW9uKCkgewogICAgICBy
        ZXR1cm4gJ1RvbWh1ZGEgS2F0emRhbGUnOwogICAgfSwKICAgIG1vbmlrZXI6
        IEVtYmVyLmFsaWFzTWV0aG9kKCduYW1lJykKICB9KTsKCiAgdmFyIGdvb2RH
        dXkgPSBBcHAuUGVyc29uLmNyZWF0ZSgpCiAgYGBgCgogIEBtZXRob2QgYWxp
        YXNNZXRob2QKICBAZm9yIEVtYmVyCiAgQHBhcmFtIHtTdHJpbmd9IG1ldGhv
        ZE5hbWUgbmFtZSBvZiB0aGUgbWV0aG9kIHRvIGFsaWFzCiAgQHJldHVybiB7
        RW1iZXIuRGVzY3JpcHRvcn0KKi8KRW1iZXIuYWxpYXNNZXRob2QgPSBmdW5j
        dGlvbihtZXRob2ROYW1lKSB7CiAgcmV0dXJuIG5ldyBBbGlhcyhtZXRob2RO
        YW1lKTsKfTsKCi8vIC4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4u
        Li4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4KLy8gT0JTRVJWRVIgSEVMUEVS
        Ci8vCgovKioKICBTcGVjaWZ5IGEgbWV0aG9kIHRoYXQgb2JzZXJ2ZXMgcHJv
        cGVydHkgY2hhbmdlcy4KCiAgYGBgamF2YXNjcmlwdAogIEVtYmVyLk9iamVj
        dC5leHRlbmQoewogICAgdmFsdWVPYnNlcnZlcjogRW1iZXIub2JzZXJ2ZXIo
        ZnVuY3Rpb24oKSB7CiAgICAgIC8vIEV4ZWN1dGVzIHdoZW5ldmVyIHRoZSAi
        dmFsdWUiIHByb3BlcnR5IGNoYW5nZXMKICAgIH0sICd2YWx1ZScpCiAgfSk7
        CiAgYGBgCgogIEluIHRoZSBmdXR1cmUgdGhpcyBtZXRob2QgbWF5IGJlY29t
        ZSBhc3luY2hyb25vdXMuIElmIHlvdSB3YW50IHRvIGVuc3VyZQogIHN5bmNo
        cm9ub3VzIGJlaGF2aW9yLCB1c2UgYGltbWVkaWF0ZU9ic2VydmVyYC4KCiAg
        QWxzbyBhdmFpbGFibGUgYXMgYEZ1bmN0aW9uLnByb3RvdHlwZS5vYnNlcnZl
        c2AgaWYgcHJvdG90eXBlIGV4dGVuc2lvbnMgYXJlCiAgZW5hYmxlZC4KCiAg
        QG1ldGhvZCBvYnNlcnZlcgogIEBmb3IgRW1iZXIKICBAcGFyYW0ge0Z1bmN0
        aW9ufSBmdW5jCiAgQHBhcmFtIHtTdHJpbmd9IHByb3BlcnR5TmFtZXMqCiAg
        QHJldHVybiBmdW5jCiovCkVtYmVyLm9ic2VydmVyID0gZnVuY3Rpb24oZnVu
        YykgewogIHZhciBwYXRocyA9IGFfc2xpY2UuY2FsbChhcmd1bWVudHMsIDEp
        OwogIGZ1bmMuX19lbWJlcl9vYnNlcnZlc19fID0gcGF0aHM7CiAgcmV0dXJu
        IGZ1bmM7Cn07CgovKioKICBTcGVjaWZ5IGEgbWV0aG9kIHRoYXQgb2JzZXJ2
        ZXMgcHJvcGVydHkgY2hhbmdlcy4KCiAgYGBgamF2YXNjcmlwdAogIEVtYmVy
        Lk9iamVjdC5leHRlbmQoewogICAgdmFsdWVPYnNlcnZlcjogRW1iZXIuaW1t
        ZWRpYXRlT2JzZXJ2ZXIoZnVuY3Rpb24oKSB7CiAgICAgIC8vIEV4ZWN1dGVz
        IHdoZW5ldmVyIHRoZSAidmFsdWUiIHByb3BlcnR5IGNoYW5nZXMKICAgIH0s
        ICd2YWx1ZScpCiAgfSk7CiAgYGBgCgogIEluIHRoZSBmdXR1cmUsIGBFbWJl
        ci5vYnNlcnZlcmAgbWF5IGJlY29tZSBhc3luY2hyb25vdXMuIEluIHRoaXMg
        ZXZlbnQsCiAgYEVtYmVyLmltbWVkaWF0ZU9ic2VydmVyYCB3aWxsIG1haW50
        YWluIHRoZSBzeW5jaHJvbm91cyBiZWhhdmlvci4KCiAgQWxzbyBhdmFpbGFi
        bGUgYXMgYEZ1bmN0aW9uLnByb3RvdHlwZS5vYnNlcnZlc0ltbWVkaWF0ZWx5
        YCBpZiBwcm90b3R5cGUgZXh0ZW5zaW9ucyBhcmUKICBlbmFibGVkLgoKICBA
        bWV0aG9kIGltbWVkaWF0ZU9ic2VydmVyCiAgQGZvciBFbWJlcgogIEBwYXJh
        bSB7RnVuY3Rpb259IGZ1bmMKICBAcGFyYW0ge1N0cmluZ30gcHJvcGVydHlO
        YW1lcyoKICBAcmV0dXJuIGZ1bmMKKi8KRW1iZXIuaW1tZWRpYXRlT2JzZXJ2
        ZXIgPSBmdW5jdGlvbigpIHsKICBmb3IgKHZhciBpPTAsIGw9YXJndW1lbnRz
        Lmxlbmd0aDsgaTxsOyBpKyspIHsKICAgIHZhciBhcmcgPSBhcmd1bWVudHNb
        aV07CiAgICBFbWJlci5hc3NlcnQoIkltbWVkaWF0ZSBvYnNlcnZlcnMgbXVz
        dCBvYnNlcnZlIGludGVybmFsIHByb3BlcnRpZXMgb25seSwgbm90IHByb3Bl
        cnRpZXMgb24gb3RoZXIgb2JqZWN0cy4iLCB0eXBlb2YgYXJnICE9PSAic3Ry
        aW5nIiB8fCBhcmcuaW5kZXhPZignLicpID09PSAtMSk7CiAgfQoKICByZXR1
        cm4gRW1iZXIub2JzZXJ2ZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKfTsK
        Ci8qKgogIFdoZW4gb2JzZXJ2ZXJzIGZpcmUsIHRoZXkgYXJlIGNhbGxlZCB3
        aXRoIHRoZSBhcmd1bWVudHMgYG9iamAsIGBrZXlOYW1lYC4KCiAgTm90ZSwg
        YEBlYWNoLnByb3BlcnR5YCBvYnNlcnZlciBpcyBjYWxsZWQgcGVyIGVhY2gg
        YWRkIG9yIHJlcGxhY2Ugb2YgYW4gZWxlbWVudAogIGFuZCBpdCdzIG5vdCBj
        YWxsZWQgd2l0aCBhIHNwZWNpZmljIGVudW1lcmF0aW9uIGl0ZW0uCgogIEEg
        YGJlZm9yZU9ic2VydmVyYCBmaXJlcyBiZWZvcmUgYSBwcm9wZXJ0eSBjaGFu
        Z2VzLgoKICBBIGBiZWZvcmVPYnNlcnZlcmAgaXMgYW4gYWx0ZXJuYXRpdmUg
        Zm9ybSBvZiBgLm9ic2VydmVzQmVmb3JlKClgLgoKICBgYGBqYXZhc2NyaXB0
        CiAgQXBwLlBlcnNvblZpZXcgPSBFbWJlci5WaWV3LmV4dGVuZCh7CgogICAg
        ZnJpZW5kczogW3sgbmFtZTogJ1RvbScgfSwgeyBuYW1lOiAnU3RlZmFuJyB9
        LCB7IG5hbWU6ICdLcmlzJyB9XSwKCiAgICB2YWx1ZVdpbGxDaGFuZ2U6IEVt
        YmVyLmJlZm9yZU9ic2VydmVyKGZ1bmN0aW9uKG9iaiwga2V5TmFtZSkgewog
        ICAgICB0aGlzLmNoYW5naW5nRnJvbSA9IG9iai5nZXQoa2V5TmFtZSk7CiAg
        ICB9LCAnY29udGVudC52YWx1ZScpLAoKICAgIHZhbHVlRGlkQ2hhbmdlOiBF
        bWJlci5vYnNlcnZlcihmdW5jdGlvbihvYmosIGtleU5hbWUpIHsKICAgICAg
        ICAvLyBvbmx5IHJ1biBpZiB1cGRhdGluZyBhIHZhbHVlIGFscmVhZHkgaW4g
        dGhlIERPTQogICAgICAgIGlmICh0aGlzLmdldCgnc3RhdGUnKSA9PT0gJ2lu
        RE9NJykgewogICAgICAgICAgdmFyIGNvbG9yID0gb2JqLmdldChrZXlOYW1l
        KSA+IHRoaXMuY2hhbmdpbmdGcm9tID8gJ2dyZWVuJyA6ICdyZWQnOwogICAg
        ICAgICAgLy8gbG9naWMKICAgICAgICB9CiAgICB9LCAnY29udGVudC52YWx1
        ZScpLAoKICAgIGZyaWVuZHNEaWRDaGFuZ2U6IEVtYmVyLm9ic2VydmVyKGZ1
        bmN0aW9uKG9iaiwga2V5TmFtZSkgewogICAgICAvLyBzb21lIGxvZ2ljCiAg
        ICAgIC8vIG9iai5nZXQoa2V5TmFtZSkgcmV0dXJucyBmcmllbmRzIGFycmF5
        CiAgICB9LCAnZnJpZW5kcy5AZWFjaC5uYW1lJykKICB9KTsKICBgYGAKCiAg
        QWxzbyBhdmFpbGFibGUgYXMgYEZ1bmN0aW9uLnByb3RvdHlwZS5vYnNlcnZl
        c0JlZm9yZWAgaWYgcHJvdG90eXBlIGV4dGVuc2lvbnMgYXJlCiAgZW5hYmxl
        ZC4KCiAgQG1ldGhvZCBiZWZvcmVPYnNlcnZlcgogIEBmb3IgRW1iZXIKICBA
        cGFyYW0ge0Z1bmN0aW9ufSBmdW5jCiAgQHBhcmFtIHtTdHJpbmd9IHByb3Bl
        cnR5TmFtZXMqCiAgQHJldHVybiBmdW5jCiovCkVtYmVyLmJlZm9yZU9ic2Vy
        dmVyID0gZnVuY3Rpb24oZnVuYykgewogIHZhciBwYXRocyA9IGFfc2xpY2Uu
        Y2FsbChhcmd1bWVudHMsIDEpOwogIGZ1bmMuX19lbWJlcl9vYnNlcnZlc0Jl
        Zm9yZV9fID0gcGF0aHM7CiAgcmV0dXJuIGZ1bmM7Cn07Cgp9KSgpOwoKCgoo
        ZnVuY3Rpb24oKSB7Ci8vIFByb3ZpZGVzIGEgd2F5IHRvIHJlZ2lzdGVyIGxp
        YnJhcnkgdmVyc2lvbnMgd2l0aCBlbWJlci4KdmFyIGZvckVhY2ggPSBFbWJl
        ci5FbnVtZXJhYmxlVXRpbHMuZm9yRWFjaCwKICAgIGluZGV4T2YgPSBFbWJl
        ci5FbnVtZXJhYmxlVXRpbHMuaW5kZXhPZjsKCkVtYmVyLmxpYnJhcmllcyA9
        IGZ1bmN0aW9uKCkgewogIHZhciBsaWJyYXJpZXMgICAgPSBbXTsKICB2YXIg
        Y29yZUxpYkluZGV4ID0gMDsKCiAgdmFyIGdldExpYnJhcnkgPSBmdW5jdGlv
        bihuYW1lKSB7CiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxpYnJhcmllcy5s
        ZW5ndGg7IGkrKykgewogICAgICBpZiAobGlicmFyaWVzW2ldLm5hbWUgPT09
        IG5hbWUpIHsKICAgICAgICByZXR1cm4gbGlicmFyaWVzW2ldOwogICAgICB9
        CiAgICB9CiAgfTsKCiAgbGlicmFyaWVzLnJlZ2lzdGVyID0gZnVuY3Rpb24o
        bmFtZSwgdmVyc2lvbikgewogICAgaWYgKCFnZXRMaWJyYXJ5KG5hbWUpKSB7
        CiAgICAgIGxpYnJhcmllcy5wdXNoKHtuYW1lOiBuYW1lLCB2ZXJzaW9uOiB2
        ZXJzaW9ufSk7CiAgICB9CiAgfTsKCiAgbGlicmFyaWVzLnJlZ2lzdGVyQ29y
        ZUxpYnJhcnkgPSBmdW5jdGlvbihuYW1lLCB2ZXJzaW9uKSB7CiAgICBpZiAo
        IWdldExpYnJhcnkobmFtZSkpIHsKICAgICAgbGlicmFyaWVzLnNwbGljZShj
        b3JlTGliSW5kZXgrKywgMCwge25hbWU6IG5hbWUsIHZlcnNpb246IHZlcnNp
        b259KTsKICAgIH0KICB9OwoKICBsaWJyYXJpZXMuZGVSZWdpc3RlciA9IGZ1
        bmN0aW9uKG5hbWUpIHsKICAgIHZhciBsaWIgPSBnZXRMaWJyYXJ5KG5hbWUp
        OwogICAgaWYgKGxpYikgbGlicmFyaWVzLnNwbGljZShpbmRleE9mKGxpYnJh
        cmllcywgbGliKSwgMSk7CiAgfTsKCiAgbGlicmFyaWVzLmVhY2ggPSBmdW5j
        dGlvbiAoY2FsbGJhY2spIHsKICAgIGZvckVhY2gobGlicmFyaWVzLCBmdW5j
        dGlvbihsaWIpIHsKICAgICAgY2FsbGJhY2sobGliLm5hbWUsIGxpYi52ZXJz
        aW9uKTsKICAgIH0pOwogIH07CgogIHJldHVybiBsaWJyYXJpZXM7Cn0oKTsK
        CkVtYmVyLmxpYnJhcmllcy5yZWdpc3RlckNvcmVMaWJyYXJ5KCdFbWJlcics
        IEVtYmVyLlZFUlNJT04pOwoKfSkoKTsKCgoKKGZ1bmN0aW9uKCkgewovKioK
        RW1iZXIgTWV0YWwKCkBtb2R1bGUgZW1iZXIKQHN1Ym1vZHVsZSBlbWJlci1t
        ZXRhbAoqLwoKfSkoKTsKCihmdW5jdGlvbigpIHsKZGVmaW5lKCJyc3ZwL2Fs
        bCIsCiAgWyJyc3ZwL3Byb21pc2UiLCJleHBvcnRzIl0sCiAgZnVuY3Rpb24o
        X19kZXBlbmRlbmN5MV9fLCBfX2V4cG9ydHNfXykgewogICAgInVzZSBzdHJp
        Y3QiOwogICAgdmFyIFByb21pc2UgPSBfX2RlcGVuZGVuY3kxX18uUHJvbWlz
        ZTsKICAgIC8qIGdsb2JhbCB0b1N0cmluZyAqLwoKCiAgICBmdW5jdGlvbiBh
        bGwocHJvbWlzZXMpIHsKICAgICAgaWYgKE9iamVjdC5wcm90b3R5cGUudG9T
        dHJpbmcuY2FsbChwcm9taXNlcykgIT09ICJbb2JqZWN0IEFycmF5XSIpIHsK
        ICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdZb3UgbXVzdCBwYXNzIGFu
        IGFycmF5IHRvIGFsbC4nKTsKICAgICAgfQoKICAgICAgcmV0dXJuIG5ldyBQ
        cm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkgewogICAgICAgIHZh
        ciByZXN1bHRzID0gW10sIHJlbWFpbmluZyA9IHByb21pc2VzLmxlbmd0aCwK
        ICAgICAgICBwcm9taXNlOwoKICAgICAgICBpZiAocmVtYWluaW5nID09PSAw
        KSB7CiAgICAgICAgICByZXNvbHZlKFtdKTsKICAgICAgICB9CgogICAgICAg
        IGZ1bmN0aW9uIHJlc29sdmVyKGluZGV4KSB7CiAgICAgICAgICByZXR1cm4g
        ZnVuY3Rpb24odmFsdWUpIHsKICAgICAgICAgICAgcmVzb2x2ZUFsbChpbmRl
        eCwgdmFsdWUpOwogICAgICAgICAgfTsKICAgICAgICB9CgogICAgICAgIGZ1
        bmN0aW9uIHJlc29sdmVBbGwoaW5kZXgsIHZhbHVlKSB7CiAgICAgICAgICBy
        ZXN1bHRzW2luZGV4XSA9IHZhbHVlOwogICAgICAgICAgaWYgKC0tcmVtYWlu
        aW5nID09PSAwKSB7CiAgICAgICAgICAgIHJlc29sdmUocmVzdWx0cyk7CiAg
        ICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBmb3IgKHZhciBpID0gMDsg
        aSA8IHByb21pc2VzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICBwcm9taXNl
        ID0gcHJvbWlzZXNbaV07CgogICAgICAgICAgaWYgKHByb21pc2UgJiYgdHlw
        ZW9mIHByb21pc2UudGhlbiA9PT0gJ2Z1bmN0aW9uJykgewogICAgICAgICAg
        ICBwcm9taXNlLnRoZW4ocmVzb2x2ZXIoaSksIHJlamVjdCk7CiAgICAgICAg
        ICB9IGVsc2UgewogICAgICAgICAgICByZXNvbHZlQWxsKGksIHByb21pc2Up
        OwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSk7CiAgICB9CgoKICAg
        IF9fZXhwb3J0c19fLmFsbCA9IGFsbDsKICB9KTsKZGVmaW5lKCJyc3ZwL2Fz
        eW5jIiwKICBbImV4cG9ydHMiXSwKICBmdW5jdGlvbihfX2V4cG9ydHNfXykg
        ewogICAgInVzZSBzdHJpY3QiOwogICAgdmFyIGJyb3dzZXJHbG9iYWwgPSAo
        dHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcpID8gd2luZG93IDoge307
        CiAgICB2YXIgQnJvd3Nlck11dGF0aW9uT2JzZXJ2ZXIgPSBicm93c2VyR2xv
        YmFsLk11dGF0aW9uT2JzZXJ2ZXIgfHwgYnJvd3Nlckdsb2JhbC5XZWJLaXRN
        dXRhdGlvbk9ic2VydmVyOwogICAgdmFyIGFzeW5jOwogICAgdmFyIGxvY2Fs
        ID0gKHR5cGVvZiBnbG9iYWwgIT09ICd1bmRlZmluZWQnKSA/IGdsb2JhbCA6
        IHRoaXM7CgogICAgLy8gb2xkIG5vZGUKICAgIGZ1bmN0aW9uIHVzZU5leHRU
        aWNrKCkgewogICAgICByZXR1cm4gZnVuY3Rpb24oY2FsbGJhY2ssIGFyZykg
        ewogICAgICAgIHByb2Nlc3MubmV4dFRpY2soZnVuY3Rpb24oKSB7CiAgICAg
        ICAgICBjYWxsYmFjayhhcmcpOwogICAgICAgIH0pOwogICAgICB9OwogICAg
        fQoKICAgIC8vIG5vZGUgPj0gMC4xMC54CiAgICBmdW5jdGlvbiB1c2VTZXRJ
        bW1lZGlhdGUoKSB7CiAgICAgIHJldHVybiBmdW5jdGlvbihjYWxsYmFjaywg
        YXJnKSB7CiAgICAgICAgLyogZ2xvYmFsICBzZXRJbW1lZGlhdGUgKi8KICAg
        ICAgICBzZXRJbW1lZGlhdGUoZnVuY3Rpb24oKXsKICAgICAgICAgIGNhbGxi
        YWNrKGFyZyk7CiAgICAgICAgfSk7CiAgICAgIH07CiAgICB9CgogICAgZnVu
        Y3Rpb24gdXNlTXV0YXRpb25PYnNlcnZlcigpIHsKICAgICAgdmFyIHF1ZXVl
        ID0gW107CgogICAgICB2YXIgb2JzZXJ2ZXIgPSBuZXcgQnJvd3Nlck11dGF0
        aW9uT2JzZXJ2ZXIoZnVuY3Rpb24oKSB7CiAgICAgICAgdmFyIHRvUHJvY2Vz
        cyA9IHF1ZXVlLnNsaWNlKCk7CiAgICAgICAgcXVldWUgPSBbXTsKCiAgICAg
        ICAgdG9Qcm9jZXNzLmZvckVhY2goZnVuY3Rpb24odHVwbGUpIHsKICAgICAg
        ICAgIHZhciBjYWxsYmFjayA9IHR1cGxlWzBdLCBhcmc9IHR1cGxlWzFdOwog
        ICAgICAgICAgY2FsbGJhY2soYXJnKTsKICAgICAgICB9KTsKICAgICAgfSk7
        CgogICAgICB2YXIgZWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQo
        J2RpdicpOwogICAgICBvYnNlcnZlci5vYnNlcnZlKGVsZW1lbnQsIHsgYXR0
        cmlidXRlczogdHJ1ZSB9KTsKCiAgICAgIC8vIENocm9tZSBNZW1vcnkgTGVh
        azogaHR0cHM6Ly9idWdzLndlYmtpdC5vcmcvc2hvd19idWcuY2dpP2lkPTkz
        NjYxCiAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCd1bmxvYWQnLCBm
        dW5jdGlvbigpewogICAgICAgIG9ic2VydmVyLmRpc2Nvbm5lY3QoKTsKICAg
        ICAgICBvYnNlcnZlciA9IG51bGw7CiAgICAgIH0sIGZhbHNlKTsKCiAgICAg
        IHJldHVybiBmdW5jdGlvbihjYWxsYmFjaywgYXJnKSB7CiAgICAgICAgcXVl
        dWUucHVzaChbY2FsbGJhY2ssIGFyZ10pOwogICAgICAgIGVsZW1lbnQuc2V0
        QXR0cmlidXRlKCdkcmFpblF1ZXVlJywgJ2RyYWluUXVldWUnKTsKICAgICAg
        fTsKICAgIH0KCiAgICBmdW5jdGlvbiB1c2VTZXRUaW1lb3V0KCkgewogICAg
        ICByZXR1cm4gZnVuY3Rpb24oY2FsbGJhY2ssIGFyZykgewogICAgICAgIGxv
        Y2FsLnNldFRpbWVvdXQoZnVuY3Rpb24oKSB7CiAgICAgICAgICBjYWxsYmFj
        ayhhcmcpOwogICAgICAgIH0sIDEpOwogICAgICB9OwogICAgfQoKICAgIGlm
        ICh0eXBlb2Ygc2V0SW1tZWRpYXRlID09PSAnZnVuY3Rpb24nKSB7CiAgICAg
        IGFzeW5jID0gdXNlU2V0SW1tZWRpYXRlKCk7CiAgICB9IGVsc2UgaWYgKHR5
        cGVvZiBwcm9jZXNzICE9PSAndW5kZWZpbmVkJyAmJiB7fS50b1N0cmluZy5j
        YWxsKHByb2Nlc3MpID09PSAnW29iamVjdCBwcm9jZXNzXScpIHsKICAgICAg
        YXN5bmMgPSB1c2VOZXh0VGljaygpOwogICAgfSBlbHNlIGlmIChCcm93c2Vy
        TXV0YXRpb25PYnNlcnZlcikgewogICAgICBhc3luYyA9IHVzZU11dGF0aW9u
        T2JzZXJ2ZXIoKTsKICAgIH0gZWxzZSB7CiAgICAgIGFzeW5jID0gdXNlU2V0
        VGltZW91dCgpOwogICAgfQoKCiAgICBfX2V4cG9ydHNfXy5hc3luYyA9IGFz
        eW5jOwogIH0pOwpkZWZpbmUoInJzdnAvY29uZmlnIiwKICBbInJzdnAvYXN5
        bmMiLCJleHBvcnRzIl0sCiAgZnVuY3Rpb24oX19kZXBlbmRlbmN5MV9fLCBf
        X2V4cG9ydHNfXykgewogICAgInVzZSBzdHJpY3QiOwogICAgdmFyIGFzeW5j
        ID0gX19kZXBlbmRlbmN5MV9fLmFzeW5jOwoKICAgIHZhciBjb25maWcgPSB7
        fTsKICAgIGNvbmZpZy5hc3luYyA9IGFzeW5jOwoKCiAgICBfX2V4cG9ydHNf
        Xy5jb25maWcgPSBjb25maWc7CiAgfSk7CmRlZmluZSgicnN2cC9kZWZlciIs
        CiAgWyJyc3ZwL3Byb21pc2UiLCJleHBvcnRzIl0sCiAgZnVuY3Rpb24oX19k
        ZXBlbmRlbmN5MV9fLCBfX2V4cG9ydHNfXykgewogICAgInVzZSBzdHJpY3Qi
        OwogICAgdmFyIFByb21pc2UgPSBfX2RlcGVuZGVuY3kxX18uUHJvbWlzZTsK
        CiAgICBmdW5jdGlvbiBkZWZlcigpIHsKICAgICAgdmFyIGRlZmVycmVkID0g
        ewogICAgICAgIC8vIHByZS1hbGxvY2F0ZSBzaGFwZQogICAgICAgIHJlc29s
        dmU6IHVuZGVmaW5lZCwKICAgICAgICByZWplY3Q6ICB1bmRlZmluZWQsCiAg
        ICAgICAgcHJvbWlzZTogdW5kZWZpbmVkCiAgICAgIH07CgogICAgICBkZWZl
        cnJlZC5wcm9taXNlID0gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwg
        cmVqZWN0KSB7CiAgICAgICAgZGVmZXJyZWQucmVzb2x2ZSA9IHJlc29sdmU7
        CiAgICAgICAgZGVmZXJyZWQucmVqZWN0ID0gcmVqZWN0OwogICAgICB9KTsK
        CiAgICAgIHJldHVybiBkZWZlcnJlZDsKICAgIH0KCgogICAgX19leHBvcnRz
        X18uZGVmZXIgPSBkZWZlcjsKICB9KTsKZGVmaW5lKCJyc3ZwL2V2ZW50cyIs
        CiAgWyJleHBvcnRzIl0sCiAgZnVuY3Rpb24oX19leHBvcnRzX18pIHsKICAg
        ICJ1c2Ugc3RyaWN0IjsKICAgIHZhciBFdmVudCA9IGZ1bmN0aW9uKHR5cGUs
        IG9wdGlvbnMpIHsKICAgICAgdGhpcy50eXBlID0gdHlwZTsKCiAgICAgIGZv
        ciAodmFyIG9wdGlvbiBpbiBvcHRpb25zKSB7CiAgICAgICAgaWYgKCFvcHRp
        b25zLmhhc093blByb3BlcnR5KG9wdGlvbikpIHsgY29udGludWU7IH0KCiAg
        ICAgICAgdGhpc1tvcHRpb25dID0gb3B0aW9uc1tvcHRpb25dOwogICAgICB9
        CiAgICB9OwoKICAgIHZhciBpbmRleE9mID0gZnVuY3Rpb24oY2FsbGJhY2tz
        LCBjYWxsYmFjaykgewogICAgICBmb3IgKHZhciBpPTAsIGw9Y2FsbGJhY2tz
        Lmxlbmd0aDsgaTxsOyBpKyspIHsKICAgICAgICBpZiAoY2FsbGJhY2tzW2ld
        WzBdID09PSBjYWxsYmFjaykgeyByZXR1cm4gaTsgfQogICAgICB9CgogICAg
        ICByZXR1cm4gLTE7CiAgICB9OwoKICAgIHZhciBjYWxsYmFja3NGb3IgPSBm
        dW5jdGlvbihvYmplY3QpIHsKICAgICAgdmFyIGNhbGxiYWNrcyA9IG9iamVj
        dC5fcHJvbWlzZUNhbGxiYWNrczsKCiAgICAgIGlmICghY2FsbGJhY2tzKSB7
        CiAgICAgICAgY2FsbGJhY2tzID0gb2JqZWN0Ll9wcm9taXNlQ2FsbGJhY2tz
        ID0ge307CiAgICAgIH0KCiAgICAgIHJldHVybiBjYWxsYmFja3M7CiAgICB9
        OwoKICAgIHZhciBFdmVudFRhcmdldCA9IHsKICAgICAgbWl4aW46IGZ1bmN0
        aW9uKG9iamVjdCkgewogICAgICAgIG9iamVjdC5vbiA9IHRoaXMub247CiAg
        ICAgICAgb2JqZWN0Lm9mZiA9IHRoaXMub2ZmOwogICAgICAgIG9iamVjdC50
        cmlnZ2VyID0gdGhpcy50cmlnZ2VyOwogICAgICAgIHJldHVybiBvYmplY3Q7
        CiAgICAgIH0sCgogICAgICBvbjogZnVuY3Rpb24oZXZlbnROYW1lcywgY2Fs
        bGJhY2ssIGJpbmRpbmcpIHsKICAgICAgICB2YXIgYWxsQ2FsbGJhY2tzID0g
        Y2FsbGJhY2tzRm9yKHRoaXMpLCBjYWxsYmFja3MsIGV2ZW50TmFtZTsKICAg
        ICAgICBldmVudE5hbWVzID0gZXZlbnROYW1lcy5zcGxpdCgvXHMrLyk7CiAg
        ICAgICAgYmluZGluZyA9IGJpbmRpbmcgfHwgdGhpczsKCiAgICAgICAgd2hp
        bGUgKGV2ZW50TmFtZSA9IGV2ZW50TmFtZXMuc2hpZnQoKSkgewogICAgICAg
        ICAgY2FsbGJhY2tzID0gYWxsQ2FsbGJhY2tzW2V2ZW50TmFtZV07CgogICAg
        ICAgICAgaWYgKCFjYWxsYmFja3MpIHsKICAgICAgICAgICAgY2FsbGJhY2tz
        ID0gYWxsQ2FsbGJhY2tzW2V2ZW50TmFtZV0gPSBbXTsKICAgICAgICAgIH0K
        CiAgICAgICAgICBpZiAoaW5kZXhPZihjYWxsYmFja3MsIGNhbGxiYWNrKSA9
        PT0gLTEpIHsKICAgICAgICAgICAgY2FsbGJhY2tzLnB1c2goW2NhbGxiYWNr
        LCBiaW5kaW5nXSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9LAoK
        ICAgICAgb2ZmOiBmdW5jdGlvbihldmVudE5hbWVzLCBjYWxsYmFjaykgewog
        ICAgICAgIHZhciBhbGxDYWxsYmFja3MgPSBjYWxsYmFja3NGb3IodGhpcyks
        IGNhbGxiYWNrcywgZXZlbnROYW1lLCBpbmRleDsKICAgICAgICBldmVudE5h
        bWVzID0gZXZlbnROYW1lcy5zcGxpdCgvXHMrLyk7CgogICAgICAgIHdoaWxl
        IChldmVudE5hbWUgPSBldmVudE5hbWVzLnNoaWZ0KCkpIHsKICAgICAgICAg
        IGlmICghY2FsbGJhY2spIHsKICAgICAgICAgICAgYWxsQ2FsbGJhY2tzW2V2
        ZW50TmFtZV0gPSBbXTsKICAgICAgICAgICAgY29udGludWU7CiAgICAgICAg
        ICB9CgogICAgICAgICAgY2FsbGJhY2tzID0gYWxsQ2FsbGJhY2tzW2V2ZW50
        TmFtZV07CgogICAgICAgICAgaW5kZXggPSBpbmRleE9mKGNhbGxiYWNrcywg
        Y2FsbGJhY2spOwoKICAgICAgICAgIGlmIChpbmRleCAhPT0gLTEpIHsgY2Fs
        bGJhY2tzLnNwbGljZShpbmRleCwgMSk7IH0KICAgICAgICB9CiAgICAgIH0s
        CgogICAgICB0cmlnZ2VyOiBmdW5jdGlvbihldmVudE5hbWUsIG9wdGlvbnMp
        IHsKICAgICAgICB2YXIgYWxsQ2FsbGJhY2tzID0gY2FsbGJhY2tzRm9yKHRo
        aXMpLAogICAgICAgICAgICBjYWxsYmFja3MsIGNhbGxiYWNrVHVwbGUsIGNh
        bGxiYWNrLCBiaW5kaW5nLCBldmVudDsKCiAgICAgICAgaWYgKGNhbGxiYWNr
        cyA9IGFsbENhbGxiYWNrc1tldmVudE5hbWVdKSB7CiAgICAgICAgICAvLyBE
        b24ndCBjYWNoZSB0aGUgY2FsbGJhY2tzLmxlbmd0aCBzaW5jZSBpdCBtYXkg
        Z3JvdwogICAgICAgICAgZm9yICh2YXIgaT0wOyBpPGNhbGxiYWNrcy5sZW5n
        dGg7IGkrKykgewogICAgICAgICAgICBjYWxsYmFja1R1cGxlID0gY2FsbGJh
        Y2tzW2ldOwogICAgICAgICAgICBjYWxsYmFjayA9IGNhbGxiYWNrVHVwbGVb
        MF07CiAgICAgICAgICAgIGJpbmRpbmcgPSBjYWxsYmFja1R1cGxlWzFdOwoK
        ICAgICAgICAgICAgaWYgKHR5cGVvZiBvcHRpb25zICE9PSAnb2JqZWN0Jykg
        ewogICAgICAgICAgICAgIG9wdGlvbnMgPSB7IGRldGFpbDogb3B0aW9ucyB9
        OwogICAgICAgICAgICB9CgogICAgICAgICAgICBldmVudCA9IG5ldyBFdmVu
        dChldmVudE5hbWUsIG9wdGlvbnMpOwogICAgICAgICAgICBjYWxsYmFjay5j
        YWxsKGJpbmRpbmcsIGV2ZW50KTsKICAgICAgICAgIH0KICAgICAgICB9CiAg
        ICAgIH0KICAgIH07CgoKICAgIF9fZXhwb3J0c19fLkV2ZW50VGFyZ2V0ID0g
        RXZlbnRUYXJnZXQ7CiAgfSk7CmRlZmluZSgicnN2cC9oYXNoIiwKICBbInJz
        dnAvZGVmZXIiLCJleHBvcnRzIl0sCiAgZnVuY3Rpb24oX19kZXBlbmRlbmN5
        MV9fLCBfX2V4cG9ydHNfXykgewogICAgInVzZSBzdHJpY3QiOwogICAgdmFy
        IGRlZmVyID0gX19kZXBlbmRlbmN5MV9fLmRlZmVyOwoKICAgIGZ1bmN0aW9u
        IHNpemUob2JqZWN0KSB7CiAgICAgIHZhciBzID0gMDsKCiAgICAgIGZvciAo
        dmFyIHByb3AgaW4gb2JqZWN0KSB7CiAgICAgICAgcysrOwogICAgICB9Cgog
        ICAgICByZXR1cm4gczsKICAgIH0KCiAgICBmdW5jdGlvbiBoYXNoKHByb21p
        c2VzKSB7CiAgICAgIHZhciByZXN1bHRzID0ge30sIGRlZmVycmVkID0gZGVm
        ZXIoKSwgcmVtYWluaW5nID0gc2l6ZShwcm9taXNlcyk7CgogICAgICBpZiAo
        cmVtYWluaW5nID09PSAwKSB7CiAgICAgICAgZGVmZXJyZWQucmVzb2x2ZSh7
        fSk7CiAgICAgIH0KCiAgICAgIHZhciByZXNvbHZlciA9IGZ1bmN0aW9uKHBy
        b3ApIHsKICAgICAgICByZXR1cm4gZnVuY3Rpb24odmFsdWUpIHsKICAgICAg
        ICAgIHJlc29sdmVBbGwocHJvcCwgdmFsdWUpOwogICAgICAgIH07CiAgICAg
        IH07CgogICAgICB2YXIgcmVzb2x2ZUFsbCA9IGZ1bmN0aW9uKHByb3AsIHZh
        bHVlKSB7CiAgICAgICAgcmVzdWx0c1twcm9wXSA9IHZhbHVlOwogICAgICAg
        IGlmICgtLXJlbWFpbmluZyA9PT0gMCkgewogICAgICAgICAgZGVmZXJyZWQu
        cmVzb2x2ZShyZXN1bHRzKTsKICAgICAgICB9CiAgICAgIH07CgogICAgICB2
        YXIgcmVqZWN0QWxsID0gZnVuY3Rpb24oZXJyb3IpIHsKICAgICAgICBkZWZl
        cnJlZC5yZWplY3QoZXJyb3IpOwogICAgICB9OwoKICAgICAgZm9yICh2YXIg
        cHJvcCBpbiBwcm9taXNlcykgewogICAgICAgIGlmIChwcm9taXNlc1twcm9w
        XSAmJiB0eXBlb2YgcHJvbWlzZXNbcHJvcF0udGhlbiA9PT0gJ2Z1bmN0aW9u
        JykgewogICAgICAgICAgcHJvbWlzZXNbcHJvcF0udGhlbihyZXNvbHZlcihw
        cm9wKSwgcmVqZWN0QWxsKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAg
        cmVzb2x2ZUFsbChwcm9wLCBwcm9taXNlc1twcm9wXSk7CiAgICAgICAgfQog
        ICAgICB9CgogICAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTsKICAgIH0K
        CgogICAgX19leHBvcnRzX18uaGFzaCA9IGhhc2g7CiAgfSk7CmRlZmluZSgi
        cnN2cC9ub2RlIiwKICBbInJzdnAvcHJvbWlzZSIsInJzdnAvYWxsIiwiZXhw
        b3J0cyJdLAogIGZ1bmN0aW9uKF9fZGVwZW5kZW5jeTFfXywgX19kZXBlbmRl
        bmN5Ml9fLCBfX2V4cG9ydHNfXykgewogICAgInVzZSBzdHJpY3QiOwogICAg
        dmFyIFByb21pc2UgPSBfX2RlcGVuZGVuY3kxX18uUHJvbWlzZTsKICAgIHZh
        ciBhbGwgPSBfX2RlcGVuZGVuY3kyX18uYWxsOwoKICAgIGZ1bmN0aW9uIG1h
        a2VOb2RlQ2FsbGJhY2tGb3IocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgIHJl
        dHVybiBmdW5jdGlvbiAoZXJyb3IsIHZhbHVlKSB7CiAgICAgICAgaWYgKGVy
        cm9yKSB7CiAgICAgICAgICByZWplY3QoZXJyb3IpOwogICAgICAgIH0gZWxz
        ZSBpZiAoYXJndW1lbnRzLmxlbmd0aCA+IDIpIHsKICAgICAgICAgIHJlc29s
        dmUoQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLCAxKSk7
        CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHJlc29sdmUodmFsdWUpOwog
        ICAgICAgIH0KICAgICAgfTsKICAgIH0KCiAgICBmdW5jdGlvbiBkZW5vZGVp
        Znkobm9kZUZ1bmMpIHsKICAgICAgcmV0dXJuIGZ1bmN0aW9uKCkgIHsKICAg
        ICAgICB2YXIgbm9kZUFyZ3MgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2Fs
        bChhcmd1bWVudHMpLCByZXNvbHZlLCByZWplY3Q7CiAgICAgICAgdmFyIHRo
        aXNBcmcgPSB0aGlzOwoKICAgICAgICB2YXIgcHJvbWlzZSA9IG5ldyBQcm9t
        aXNlKGZ1bmN0aW9uKG5vZGVSZXNvbHZlLCBub2RlUmVqZWN0KSB7CiAgICAg
        ICAgICByZXNvbHZlID0gbm9kZVJlc29sdmU7CiAgICAgICAgICByZWplY3Qg
        PSBub2RlUmVqZWN0OwogICAgICAgIH0pOwoKICAgICAgICBhbGwobm9kZUFy
        Z3MpLnRoZW4oZnVuY3Rpb24obm9kZUFyZ3MpIHsKICAgICAgICAgIG5vZGVB
        cmdzLnB1c2gobWFrZU5vZGVDYWxsYmFja0ZvcihyZXNvbHZlLCByZWplY3Qp
        KTsKCiAgICAgICAgICB0cnkgewogICAgICAgICAgICBub2RlRnVuYy5hcHBs
        eSh0aGlzQXJnLCBub2RlQXJncyk7CiAgICAgICAgICB9IGNhdGNoKGUpIHsK
        ICAgICAgICAgICAgcmVqZWN0KGUpOwogICAgICAgICAgfQogICAgICAgIH0p
        OwoKICAgICAgICByZXR1cm4gcHJvbWlzZTsKICAgICAgfTsKICAgIH0KCgog
        ICAgX19leHBvcnRzX18uZGVub2RlaWZ5ID0gZGVub2RlaWZ5OwogIH0pOwpk
        ZWZpbmUoInJzdnAvcHJvbWlzZSIsCiAgWyJyc3ZwL2NvbmZpZyIsInJzdnAv
        ZXZlbnRzIiwiZXhwb3J0cyJdLAogIGZ1bmN0aW9uKF9fZGVwZW5kZW5jeTFf
        XywgX19kZXBlbmRlbmN5Ml9fLCBfX2V4cG9ydHNfXykgewogICAgInVzZSBz
        dHJpY3QiOwogICAgdmFyIGNvbmZpZyA9IF9fZGVwZW5kZW5jeTFfXy5jb25m
        aWc7CiAgICB2YXIgRXZlbnRUYXJnZXQgPSBfX2RlcGVuZGVuY3kyX18uRXZl
        bnRUYXJnZXQ7CgogICAgZnVuY3Rpb24gb2JqZWN0T3JGdW5jdGlvbih4KSB7
        CiAgICAgIHJldHVybiBpc0Z1bmN0aW9uKHgpIHx8ICh0eXBlb2YgeCA9PT0g
        Im9iamVjdCIgJiYgeCAhPT0gbnVsbCk7CiAgICB9CgogICAgZnVuY3Rpb24g
        aXNGdW5jdGlvbih4KXsKICAgICAgcmV0dXJuIHR5cGVvZiB4ID09PSAiZnVu
        Y3Rpb24iOwogICAgfQoKICAgIHZhciBQcm9taXNlID0gZnVuY3Rpb24ocmVz
        b2x2ZXIpIHsKICAgICAgdmFyIHByb21pc2UgPSB0aGlzLAogICAgICByZXNv
        bHZlZCA9IGZhbHNlOwoKICAgICAgaWYgKHR5cGVvZiByZXNvbHZlciAhPT0g
        J2Z1bmN0aW9uJykgewogICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ1lv
        dSBtdXN0IHBhc3MgYSByZXNvbHZlciBmdW5jdGlvbiBhcyB0aGUgc29sZSBh
        cmd1bWVudCB0byB0aGUgcHJvbWlzZSBjb25zdHJ1Y3RvcicpOwogICAgICB9
        CgogICAgICBpZiAoIShwcm9taXNlIGluc3RhbmNlb2YgUHJvbWlzZSkpIHsK
        ICAgICAgICByZXR1cm4gbmV3IFByb21pc2UocmVzb2x2ZXIpOwogICAgICB9
        CgogICAgICB2YXIgcmVzb2x2ZVByb21pc2UgPSBmdW5jdGlvbih2YWx1ZSkg
        ewogICAgICAgIGlmIChyZXNvbHZlZCkgeyByZXR1cm47IH0KICAgICAgICBy
        ZXNvbHZlZCA9IHRydWU7CiAgICAgICAgcmVzb2x2ZShwcm9taXNlLCB2YWx1
        ZSk7CiAgICAgIH07CgogICAgICB2YXIgcmVqZWN0UHJvbWlzZSA9IGZ1bmN0
        aW9uKHZhbHVlKSB7CiAgICAgICAgaWYgKHJlc29sdmVkKSB7IHJldHVybjsg
        fQogICAgICAgIHJlc29sdmVkID0gdHJ1ZTsKICAgICAgICByZWplY3QocHJv
        bWlzZSwgdmFsdWUpOwogICAgICB9OwoKICAgICAgdGhpcy5vbigncHJvbWlz
        ZTpyZXNvbHZlZCcsIGZ1bmN0aW9uKGV2ZW50KSB7CiAgICAgICAgdGhpcy50
        cmlnZ2VyKCdzdWNjZXNzJywgeyBkZXRhaWw6IGV2ZW50LmRldGFpbCB9KTsK
        ICAgICAgfSwgdGhpcyk7CgogICAgICB0aGlzLm9uKCdwcm9taXNlOmZhaWxl
        ZCcsIGZ1bmN0aW9uKGV2ZW50KSB7CiAgICAgICAgdGhpcy50cmlnZ2VyKCdl
        cnJvcicsIHsgZGV0YWlsOiBldmVudC5kZXRhaWwgfSk7CiAgICAgIH0sIHRo
        aXMpOwoKICAgICAgdGhpcy5vbignZXJyb3InLCBvbmVycm9yKTsKCiAgICAg
        IHRyeSB7CiAgICAgICAgcmVzb2x2ZXIocmVzb2x2ZVByb21pc2UsIHJlamVj
        dFByb21pc2UpOwogICAgICB9IGNhdGNoKGUpIHsKICAgICAgICByZWplY3RQ
        cm9taXNlKGUpOwogICAgICB9CiAgICB9OwoKICAgIGZ1bmN0aW9uIG9uZXJy
        b3IoZXZlbnQpIHsKICAgICAgaWYgKGNvbmZpZy5vbmVycm9yKSB7CiAgICAg
        ICAgY29uZmlnLm9uZXJyb3IoZXZlbnQuZGV0YWlsKTsKICAgICAgfQogICAg
        fQoKICAgIHZhciBpbnZva2VDYWxsYmFjayA9IGZ1bmN0aW9uKHR5cGUsIHBy
        b21pc2UsIGNhbGxiYWNrLCBldmVudCkgewogICAgICB2YXIgaGFzQ2FsbGJh
        Y2sgPSBpc0Z1bmN0aW9uKGNhbGxiYWNrKSwKICAgICAgICAgIHZhbHVlLCBl
        cnJvciwgc3VjY2VlZGVkLCBmYWlsZWQ7CgogICAgICBpZiAoaGFzQ2FsbGJh
        Y2spIHsKICAgICAgICB0cnkgewogICAgICAgICAgdmFsdWUgPSBjYWxsYmFj
        ayhldmVudC5kZXRhaWwpOwogICAgICAgICAgc3VjY2VlZGVkID0gdHJ1ZTsK
        ICAgICAgICB9IGNhdGNoKGUpIHsKICAgICAgICAgIGZhaWxlZCA9IHRydWU7
        CiAgICAgICAgICBlcnJvciA9IGU7CiAgICAgICAgfQogICAgICB9IGVsc2Ug
        ewogICAgICAgIHZhbHVlID0gZXZlbnQuZGV0YWlsOwogICAgICAgIHN1Y2Nl
        ZWRlZCA9IHRydWU7CiAgICAgIH0KCiAgICAgIGlmIChoYW5kbGVUaGVuYWJs
        ZShwcm9taXNlLCB2YWx1ZSkpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0g
        ZWxzZSBpZiAoaGFzQ2FsbGJhY2sgJiYgc3VjY2VlZGVkKSB7CiAgICAgICAg
        cmVzb2x2ZShwcm9taXNlLCB2YWx1ZSk7CiAgICAgIH0gZWxzZSBpZiAoZmFp
        bGVkKSB7CiAgICAgICAgcmVqZWN0KHByb21pc2UsIGVycm9yKTsKICAgICAg
        fSBlbHNlIGlmICh0eXBlID09PSAncmVzb2x2ZScpIHsKICAgICAgICByZXNv
        bHZlKHByb21pc2UsIHZhbHVlKTsKICAgICAgfSBlbHNlIGlmICh0eXBlID09
        PSAncmVqZWN0JykgewogICAgICAgIHJlamVjdChwcm9taXNlLCB2YWx1ZSk7
        CiAgICAgIH0KICAgIH07CgogICAgUHJvbWlzZS5wcm90b3R5cGUgPSB7CiAg
        ICAgIGNvbnN0cnVjdG9yOiBQcm9taXNlLAoKICAgICAgaXNSZWplY3RlZDog
        dW5kZWZpbmVkLAogICAgICBpc0Z1bGZpbGxlZDogdW5kZWZpbmVkLAogICAg
        ICByZWplY3RlZFJlYXNvbjogdW5kZWZpbmVkLAogICAgICBmdWxmaWxsbWVu
        dFZhbHVlOiB1bmRlZmluZWQsCgogICAgICB0aGVuOiBmdW5jdGlvbihkb25l
        LCBmYWlsKSB7CiAgICAgICAgdGhpcy5vZmYoJ2Vycm9yJywgb25lcnJvcik7
        CgogICAgICAgIHZhciB0aGVuUHJvbWlzZSA9IG5ldyB0aGlzLmNvbnN0cnVj
        dG9yKGZ1bmN0aW9uKCkge30pOwoKICAgICAgICBpZiAodGhpcy5pc0Z1bGZp
        bGxlZCkgewogICAgICAgICAgY29uZmlnLmFzeW5jKGZ1bmN0aW9uKHByb21p
        c2UpIHsKICAgICAgICAgICAgaW52b2tlQ2FsbGJhY2soJ3Jlc29sdmUnLCB0
        aGVuUHJvbWlzZSwgZG9uZSwgeyBkZXRhaWw6IHByb21pc2UuZnVsZmlsbG1l
        bnRWYWx1ZSB9KTsKICAgICAgICAgIH0sIHRoaXMpOwogICAgICAgIH0KCiAg
        ICAgICAgaWYgKHRoaXMuaXNSZWplY3RlZCkgewogICAgICAgICAgY29uZmln
        LmFzeW5jKGZ1bmN0aW9uKHByb21pc2UpIHsKICAgICAgICAgICAgaW52b2tl
        Q2FsbGJhY2soJ3JlamVjdCcsIHRoZW5Qcm9taXNlLCBmYWlsLCB7IGRldGFp
        bDogcHJvbWlzZS5yZWplY3RlZFJlYXNvbiB9KTsKICAgICAgICAgIH0sIHRo
        aXMpOwogICAgICAgIH0KCiAgICAgICAgdGhpcy5vbigncHJvbWlzZTpyZXNv
        bHZlZCcsIGZ1bmN0aW9uKGV2ZW50KSB7CiAgICAgICAgICBpbnZva2VDYWxs
        YmFjaygncmVzb2x2ZScsIHRoZW5Qcm9taXNlLCBkb25lLCBldmVudCk7CiAg
        ICAgICAgfSk7CgogICAgICAgIHRoaXMub24oJ3Byb21pc2U6ZmFpbGVkJywg
        ZnVuY3Rpb24oZXZlbnQpIHsKICAgICAgICAgIGludm9rZUNhbGxiYWNrKCdy
        ZWplY3QnLCB0aGVuUHJvbWlzZSwgZmFpbCwgZXZlbnQpOwogICAgICAgIH0p
        OwoKICAgICAgICByZXR1cm4gdGhlblByb21pc2U7CiAgICAgIH0sCgogICAg
        ICBmYWlsOiBmdW5jdGlvbihmYWlsKSB7CiAgICAgICAgcmV0dXJuIHRoaXMu
        dGhlbihudWxsLCBmYWlsKTsKICAgICAgfQogICAgfTsKCiAgICBFdmVudFRh
        cmdldC5taXhpbihQcm9taXNlLnByb3RvdHlwZSk7CgogICAgZnVuY3Rpb24g
        cmVzb2x2ZShwcm9taXNlLCB2YWx1ZSkgewogICAgICBpZiAocHJvbWlzZSA9
        PT0gdmFsdWUpIHsKICAgICAgICBmdWxmaWxsKHByb21pc2UsIHZhbHVlKTsK
        ICAgICAgfSBlbHNlIGlmICghaGFuZGxlVGhlbmFibGUocHJvbWlzZSwgdmFs
        dWUpKSB7CiAgICAgICAgZnVsZmlsbChwcm9taXNlLCB2YWx1ZSk7CiAgICAg
        IH0KICAgIH0KCiAgICBmdW5jdGlvbiBoYW5kbGVUaGVuYWJsZShwcm9taXNl
        LCB2YWx1ZSkgewogICAgICB2YXIgdGhlbiA9IG51bGwsCiAgICAgIHJlc29s
        dmVkOwoKICAgICAgdHJ5IHsKICAgICAgICBpZiAocHJvbWlzZSA9PT0gdmFs
        dWUpIHsKICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoIkEgcHJvbWlz
        ZXMgY2FsbGJhY2sgY2Fubm90IHJldHVybiB0aGF0IHNhbWUgcHJvbWlzZS4i
        KTsKICAgICAgICB9CgogICAgICAgIGlmIChvYmplY3RPckZ1bmN0aW9uKHZh
        bHVlKSkgewogICAgICAgICAgdGhlbiA9IHZhbHVlLnRoZW47CgogICAgICAg
        ICAgaWYgKGlzRnVuY3Rpb24odGhlbikpIHsKICAgICAgICAgICAgdGhlbi5j
        YWxsKHZhbHVlLCBmdW5jdGlvbih2YWwpIHsKICAgICAgICAgICAgICBpZiAo
        cmVzb2x2ZWQpIHsgcmV0dXJuIHRydWU7IH0KICAgICAgICAgICAgICByZXNv
        bHZlZCA9IHRydWU7CgogICAgICAgICAgICAgIGlmICh2YWx1ZSAhPT0gdmFs
        KSB7CiAgICAgICAgICAgICAgICByZXNvbHZlKHByb21pc2UsIHZhbCk7CiAg
        ICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGZ1bGZpbGwo
        cHJvbWlzZSwgdmFsKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0s
        IGZ1bmN0aW9uKHZhbCkgewogICAgICAgICAgICAgIGlmIChyZXNvbHZlZCkg
        eyByZXR1cm4gdHJ1ZTsgfQogICAgICAgICAgICAgIHJlc29sdmVkID0gdHJ1
        ZTsKCiAgICAgICAgICAgICAgcmVqZWN0KHByb21pc2UsIHZhbCk7CiAgICAg
        ICAgICAgIH0pOwoKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAg
        ICB9CiAgICAgICAgfQogICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAg
        IHJlamVjdChwcm9taXNlLCBlcnJvcik7CiAgICAgICAgcmV0dXJuIHRydWU7
        CiAgICAgIH0KCiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICBmdW5j
        dGlvbiBmdWxmaWxsKHByb21pc2UsIHZhbHVlKSB7CiAgICAgIGNvbmZpZy5h
        c3luYyhmdW5jdGlvbigpIHsKICAgICAgICBwcm9taXNlLnRyaWdnZXIoJ3By
        b21pc2U6cmVzb2x2ZWQnLCB7IGRldGFpbDogdmFsdWUgfSk7CiAgICAgICAg
        cHJvbWlzZS5pc0Z1bGZpbGxlZCA9IHRydWU7CiAgICAgICAgcHJvbWlzZS5m
        dWxmaWxsbWVudFZhbHVlID0gdmFsdWU7CiAgICAgIH0pOwogICAgfQoKICAg
        IGZ1bmN0aW9uIHJlamVjdChwcm9taXNlLCB2YWx1ZSkgewogICAgICBjb25m
        aWcuYXN5bmMoZnVuY3Rpb24oKSB7CiAgICAgICAgcHJvbWlzZS50cmlnZ2Vy
        KCdwcm9taXNlOmZhaWxlZCcsIHsgZGV0YWlsOiB2YWx1ZSB9KTsKICAgICAg
        ICBwcm9taXNlLmlzUmVqZWN0ZWQgPSB0cnVlOwogICAgICAgIHByb21pc2Uu
        cmVqZWN0ZWRSZWFzb24gPSB2YWx1ZTsKICAgICAgfSk7CiAgICB9CgoKICAg
        IF9fZXhwb3J0c19fLlByb21pc2UgPSBQcm9taXNlOwogIH0pOwpkZWZpbmUo
        InJzdnAvcmVqZWN0IiwKICBbInJzdnAvcHJvbWlzZSIsImV4cG9ydHMiXSwK
        ICBmdW5jdGlvbihfX2RlcGVuZGVuY3kxX18sIF9fZXhwb3J0c19fKSB7CiAg
        ICAidXNlIHN0cmljdCI7CiAgICB2YXIgUHJvbWlzZSA9IF9fZGVwZW5kZW5j
        eTFfXy5Qcm9taXNlOwoKICAgIGZ1bmN0aW9uIHJlamVjdChyZWFzb24pIHsK
        ICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCBy
        ZWplY3QpIHsKICAgICAgICByZWplY3QocmVhc29uKTsKICAgICAgfSk7CiAg
        ICB9CgoKICAgIF9fZXhwb3J0c19fLnJlamVjdCA9IHJlamVjdDsKICB9KTsK
        ZGVmaW5lKCJyc3ZwL3Jlc29sdmUiLAogIFsicnN2cC9wcm9taXNlIiwiZXhw
        b3J0cyJdLAogIGZ1bmN0aW9uKF9fZGVwZW5kZW5jeTFfXywgX19leHBvcnRz
        X18pIHsKICAgICJ1c2Ugc3RyaWN0IjsKICAgIHZhciBQcm9taXNlID0gX19k
        ZXBlbmRlbmN5MV9fLlByb21pc2U7CgogICAgZnVuY3Rpb24gcmVzb2x2ZSh0
        aGVuYWJsZSkgewogICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24o
        cmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgICAgcmVzb2x2ZSh0aGVuYWJsZSk7
        CiAgICAgIH0pOwogICAgfQoKCiAgICBfX2V4cG9ydHNfXy5yZXNvbHZlID0g
        cmVzb2x2ZTsKICB9KTsKZGVmaW5lKCJyc3ZwL3JldGhyb3ciLAogIFsiZXhw
        b3J0cyJdLAogIGZ1bmN0aW9uKF9fZXhwb3J0c19fKSB7CiAgICAidXNlIHN0
        cmljdCI7CiAgICB2YXIgbG9jYWwgPSAodHlwZW9mIGdsb2JhbCA9PT0gInVu
        ZGVmaW5lZCIpID8gdGhpcyA6IGdsb2JhbDsKCiAgICBmdW5jdGlvbiByZXRo
        cm93KHJlYXNvbikgewogICAgICBsb2NhbC5zZXRUaW1lb3V0KGZ1bmN0aW9u
        KCkgewogICAgICAgIHRocm93IHJlYXNvbjsKICAgICAgfSk7CiAgICAgIHRo
        cm93IHJlYXNvbjsKICAgIH0KCgogICAgX19leHBvcnRzX18ucmV0aHJvdyA9
        IHJldGhyb3c7CiAgfSk7CmRlZmluZSgicnN2cCIsCiAgWyJyc3ZwL2V2ZW50
        cyIsInJzdnAvcHJvbWlzZSIsInJzdnAvbm9kZSIsInJzdnAvYWxsIiwicnN2
        cC9oYXNoIiwicnN2cC9yZXRocm93IiwicnN2cC9kZWZlciIsInJzdnAvY29u
        ZmlnIiwicnN2cC9yZXNvbHZlIiwicnN2cC9yZWplY3QiLCJleHBvcnRzIl0s
        CiAgZnVuY3Rpb24oX19kZXBlbmRlbmN5MV9fLCBfX2RlcGVuZGVuY3kyX18s
        IF9fZGVwZW5kZW5jeTNfXywgX19kZXBlbmRlbmN5NF9fLCBfX2RlcGVuZGVu
        Y3k1X18sIF9fZGVwZW5kZW5jeTZfXywgX19kZXBlbmRlbmN5N19fLCBfX2Rl
        cGVuZGVuY3k4X18sIF9fZGVwZW5kZW5jeTlfXywgX19kZXBlbmRlbmN5MTBf
        XywgX19leHBvcnRzX18pIHsKICAgICJ1c2Ugc3RyaWN0IjsKICAgIHZhciBF
        dmVudFRhcmdldCA9IF9fZGVwZW5kZW5jeTFfXy5FdmVudFRhcmdldDsKICAg
        IHZhciBQcm9taXNlID0gX19kZXBlbmRlbmN5Ml9fLlByb21pc2U7CiAgICB2
        YXIgZGVub2RlaWZ5ID0gX19kZXBlbmRlbmN5M19fLmRlbm9kZWlmeTsKICAg
        IHZhciBhbGwgPSBfX2RlcGVuZGVuY3k0X18uYWxsOwogICAgdmFyIGhhc2gg
        PSBfX2RlcGVuZGVuY3k1X18uaGFzaDsKICAgIHZhciByZXRocm93ID0gX19k
        ZXBlbmRlbmN5Nl9fLnJldGhyb3c7CiAgICB2YXIgZGVmZXIgPSBfX2RlcGVu
        ZGVuY3k3X18uZGVmZXI7CiAgICB2YXIgY29uZmlnID0gX19kZXBlbmRlbmN5
        OF9fLmNvbmZpZzsKICAgIHZhciByZXNvbHZlID0gX19kZXBlbmRlbmN5OV9f
        LnJlc29sdmU7CiAgICB2YXIgcmVqZWN0ID0gX19kZXBlbmRlbmN5MTBfXy5y
        ZWplY3Q7CgogICAgZnVuY3Rpb24gY29uZmlndXJlKG5hbWUsIHZhbHVlKSB7
        CiAgICAgIGNvbmZpZ1tuYW1lXSA9IHZhbHVlOwogICAgfQoKCiAgICBfX2V4
        cG9ydHNfXy5Qcm9taXNlID0gUHJvbWlzZTsKICAgIF9fZXhwb3J0c19fLkV2
        ZW50VGFyZ2V0ID0gRXZlbnRUYXJnZXQ7CiAgICBfX2V4cG9ydHNfXy5hbGwg
        PSBhbGw7CiAgICBfX2V4cG9ydHNfXy5oYXNoID0gaGFzaDsKICAgIF9fZXhw
        b3J0c19fLnJldGhyb3cgPSByZXRocm93OwogICAgX19leHBvcnRzX18uZGVm
        ZXIgPSBkZWZlcjsKICAgIF9fZXhwb3J0c19fLmRlbm9kZWlmeSA9IGRlbm9k
        ZWlmeTsKICAgIF9fZXhwb3J0c19fLmNvbmZpZ3VyZSA9IGNvbmZpZ3VyZTsK
        ICAgIF9fZXhwb3J0c19fLnJlc29sdmUgPSByZXNvbHZlOwogICAgX19leHBv
        cnRzX18ucmVqZWN0ID0gcmVqZWN0OwogIH0pOwp9KSgpOwoKKGZ1bmN0aW9u
        KCkgewovKioKQHByaXZhdGUKUHVibGljIGFwaSBmb3IgdGhlIGNvbnRhaW5l
        ciBpcyBzdGlsbCBpbiBmbHV4LgpUaGUgcHVibGljIGFwaSwgc3BlY2lmaWVk
        IG9uIHRoZSBhcHBsaWNhdGlvbiBuYW1lc3BhY2Ugc2hvdWxkIGJlIGNvbnNp
        ZGVyZWQgdGhlIHN0YWJsZSBhcGkuCi8vIEBtb2R1bGUgY29udGFpbmVyCiov
        CgovKgogRmxhZyB0byBlbmFibGUvZGlzYWJsZSBtb2RlbCBmYWN0b3J5IGlu
        amVjdGlvbnMgKGRpc2FibGVkIGJ5IGRlZmF1bHQpCiBJZiBtb2RlbCBmYWN0
        b3J5IGluamVjdGlvbnMgYXJlIGVuYWJsZWQsIG1vZGVscyBzaG91bGQgbm90
        IGJlCiBhY2Nlc3NlZCBnbG9iYWxseSAob25seSB0aHJvdWdoIGBjb250YWlu
        ZXIubG9va3VwRmFjdG9yeSgnbW9kZWw6bW9kZWxOYW1lJykpYCk7CiovCkVt
        YmVyLk1PREVMX0ZBQ1RPUllfSU5KRUNUSU9OUyA9IGZhbHNlIHx8ICEhRW1i
        ZXIuRU5WLk1PREVMX0ZBQ1RPUllfSU5KRUNUSU9OUzsKCmRlZmluZSgiY29u
        dGFpbmVyIiwKICBbXSwKICBmdW5jdGlvbigpIHsKCiAgICAvLyBBIHNhZmUg
        YW5kIHNpbXBsZSBpbmhlcml0aW5nIG9iamVjdC4KICAgIGZ1bmN0aW9uIElu
        aGVyaXRpbmdEaWN0KHBhcmVudCkgewogICAgICB0aGlzLnBhcmVudCA9IHBh
        cmVudDsKICAgICAgdGhpcy5kaWN0ID0ge307CiAgICB9CgogICAgSW5oZXJp
        dGluZ0RpY3QucHJvdG90eXBlID0gewoKICAgICAgLyoqCiAgICAgICAgQHBy
        b3BlcnR5IHBhcmVudAogICAgICAgIEB0eXBlIEluaGVyaXRpbmdEaWN0CiAg
        ICAgICAgQGRlZmF1bHQgbnVsbAogICAgICAqLwoKICAgICAgcGFyZW50OiBu
        dWxsLAoKICAgICAgLyoqCiAgICAgICAgT2JqZWN0IHVzZWQgdG8gc3RvcmUg
        dGhlIGN1cnJlbnQgbm9kZXMgZGF0YS4KCiAgICAgICAgQHByb3BlcnR5IGRp
        Y3QKICAgICAgICBAdHlwZSBPYmplY3QKICAgICAgICBAZGVmYXVsdCBPYmpl
        Y3QKICAgICAgKi8KICAgICAgZGljdDogbnVsbCwKCiAgICAgIC8qKgogICAg
        ICAgIFJldHJpZXZlIHRoZSB2YWx1ZSBnaXZlbiBhIGtleSwgaWYgdGhlIHZh
        bHVlIGlzIHByZXNlbnQgYXQgdGhlIGN1cnJlbnQKICAgICAgICBsZXZlbCB1
        c2UgaXQsIG90aGVyd2lzZSB3YWxrIHVwIHRoZSBwYXJlbnQgaGllcmFyY2h5
        IGFuZCB0cnkgYWdhaW4uIElmCiAgICAgICAgbm8gbWF0Y2hpbmcga2V5IGlz
        IGZvdW5kLCByZXR1cm4gdW5kZWZpbmVkLgoKICAgICAgICBAbWV0aG9kIGdl
        dAogICAgICAgIEByZXR1cm4ge2FueX0KICAgICAgKi8KICAgICAgZ2V0OiBm
        dW5jdGlvbihrZXkpIHsKICAgICAgICB2YXIgZGljdCA9IHRoaXMuZGljdDsK
        CiAgICAgICAgaWYgKGRpY3QuaGFzT3duUHJvcGVydHkoa2V5KSkgewogICAg
        ICAgICAgcmV0dXJuIGRpY3Rba2V5XTsKICAgICAgICB9CgogICAgICAgIGlm
        ICh0aGlzLnBhcmVudCkgewogICAgICAgICAgcmV0dXJuIHRoaXMucGFyZW50
        LmdldChrZXkpOwogICAgICAgIH0KICAgICAgfSwKCiAgICAgIC8qKgogICAg
        ICAgIFNldCB0aGUgZ2l2ZW4gdmFsdWUgZm9yIHRoZSBnaXZlbiBrZXksIGF0
        IHRoZSBjdXJyZW50IGxldmVsLgoKICAgICAgICBAbWV0aG9kIHNldAogICAg
        ICAgIEBwYXJhbSB7U3RyaW5nfSBrZXkKICAgICAgICBAcGFyYW0ge0FueX0g
        dmFsdWUKICAgICAgKi8KICAgICAgc2V0OiBmdW5jdGlvbihrZXksIHZhbHVl
        KSB7CiAgICAgICAgdGhpcy5kaWN0W2tleV0gPSB2YWx1ZTsKICAgICAgfSwK
        CiAgICAgIC8qKgogICAgICAgIERlbGV0ZSB0aGUgZ2l2ZW4ga2V5CgogICAg
        ICAgIEBtZXRob2QgcmVtb3ZlCiAgICAgICAgQHBhcmFtIHtTdHJpbmd9IGtl
        eQogICAgICAqLwogICAgICByZW1vdmU6IGZ1bmN0aW9uKGtleSkgewogICAg
        ICAgIGRlbGV0ZSB0aGlzLmRpY3Rba2V5XTsKICAgICAgfSwKCiAgICAgIC8q
        KgogICAgICAgIENoZWNrIGZvciB0aGUgZXhpc3RlbmNlIG9mIGdpdmVuIGEg
        a2V5LCBpZiB0aGUga2V5IGlzIHByZXNlbnQgYXQgdGhlIGN1cnJlbnQKICAg
        ICAgICBsZXZlbCByZXR1cm4gdHJ1ZSwgb3RoZXJ3aXNlIHdhbGsgdXAgdGhl
        IHBhcmVudCBoaWVyYXJjaHkgYW5kIHRyeSBhZ2Fpbi4gSWYKICAgICAgICBu
        byBtYXRjaGluZyBrZXkgaXMgZm91bmQsIHJldHVybiBmYWxzZS4KCiAgICAg
        ICAgQG1ldGhvZCBoYXMKICAgICAgICBAcGFyYW0ge1N0cmluZ30ga2V5CiAg
        ICAgICAgQHJldHVybiB7Qm9vbGVhbn0KICAgICAgKi8KICAgICAgaGFzOiBm
        dW5jdGlvbihrZXkpIHsKICAgICAgICB2YXIgZGljdCA9IHRoaXMuZGljdDsK
        CiAgICAgICAgaWYgKGRpY3QuaGFzT3duUHJvcGVydHkoa2V5KSkgewogICAg
        ICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQoKICAgICAgICBpZiAodGhp
        cy5wYXJlbnQpIHsKICAgICAgICAgIHJldHVybiB0aGlzLnBhcmVudC5oYXMo
        a2V5KTsKICAgICAgICB9CgogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAg
        fSwKCiAgICAgIC8qKgogICAgICAgIEl0ZXJhdGUgYW5kIGludm9rZSBhIGNh
        bGxiYWNrIGZvciBlYWNoIGxvY2FsIGtleS12YWx1ZSBwYWlyLgoKICAgICAg
        ICBAbWV0aG9kIGVhY2hMb2NhbAogICAgICAgIEBwYXJhbSB7RnVuY3Rpb259
        IGNhbGxiYWNrCiAgICAgICAgQHBhcmFtIHtPYmplY3R9IGJpbmRpbmcKICAg
        ICAgKi8KICAgICAgZWFjaExvY2FsOiBmdW5jdGlvbihjYWxsYmFjaywgYmlu
        ZGluZykgewogICAgICAgIHZhciBkaWN0ID0gdGhpcy5kaWN0OwoKICAgICAg
        ICBmb3IgKHZhciBwcm9wIGluIGRpY3QpIHsKICAgICAgICAgIGlmIChkaWN0
        Lmhhc093blByb3BlcnR5KHByb3ApKSB7CiAgICAgICAgICAgIGNhbGxiYWNr
        LmNhbGwoYmluZGluZywgcHJvcCwgZGljdFtwcm9wXSk7CiAgICAgICAgICB9
        CiAgICAgICAgfQogICAgICB9CiAgICB9OwoKCiAgICAvLyBBIGxpZ2h0d2Vp
        Z2h0IGNvbnRhaW5lciB0aGF0IGhlbHBzIHRvIGFzc2VtYmxlIGFuZCBkZWNv
        dXBsZSBjb21wb25lbnRzLgogICAgLy8gUHVibGljIGFwaSBmb3IgdGhlIGNv
        bnRhaW5lciBpcyBzdGlsbCBpbiBmbHV4LgogICAgLy8gVGhlIHB1YmxpYyBh
        cGksIHNwZWNpZmllZCBvbiB0aGUgYXBwbGljYXRpb24gbmFtZXNwYWNlIHNo
        b3VsZCBiZSBjb25zaWRlcmVkIHRoZSBzdGFibGUgYXBpLgogICAgZnVuY3Rp
        b24gQ29udGFpbmVyKHBhcmVudCkgewogICAgICB0aGlzLnBhcmVudCA9IHBh
        cmVudDsKICAgICAgdGhpcy5jaGlsZHJlbiA9IFtdOwoKICAgICAgdGhpcy5y
        ZXNvbHZlciA9IHBhcmVudCAmJiBwYXJlbnQucmVzb2x2ZXIgfHwgZnVuY3Rp
        b24oKSB7fTsKCiAgICAgIHRoaXMucmVnaXN0cnkgPSBuZXcgSW5oZXJpdGlu
        Z0RpY3QocGFyZW50ICYmIHBhcmVudC5yZWdpc3RyeSk7CiAgICAgIHRoaXMu
        Y2FjaGUgPSBuZXcgSW5oZXJpdGluZ0RpY3QocGFyZW50ICYmIHBhcmVudC5j
        YWNoZSk7CiAgICAgIHRoaXMuZmFjdG9yeUNhY2hlID0gbmV3IEluaGVyaXRp
        bmdEaWN0KHBhcmVudCAmJiBwYXJlbnQuY2FjaGUpOwogICAgICB0aGlzLnR5
        cGVJbmplY3Rpb25zID0gbmV3IEluaGVyaXRpbmdEaWN0KHBhcmVudCAmJiBw
        YXJlbnQudHlwZUluamVjdGlvbnMpOwogICAgICB0aGlzLmluamVjdGlvbnMg
        PSB7fTsKCiAgICAgIHRoaXMuZmFjdG9yeVR5cGVJbmplY3Rpb25zID0gbmV3
        IEluaGVyaXRpbmdEaWN0KHBhcmVudCAmJiBwYXJlbnQuZmFjdG9yeVR5cGVJ
        bmplY3Rpb25zKTsKICAgICAgdGhpcy5mYWN0b3J5SW5qZWN0aW9ucyA9IHt9
        OwoKICAgICAgdGhpcy5fb3B0aW9ucyA9IG5ldyBJbmhlcml0aW5nRGljdChw
        YXJlbnQgJiYgcGFyZW50Ll9vcHRpb25zKTsKICAgICAgdGhpcy5fdHlwZU9w
        dGlvbnMgPSBuZXcgSW5oZXJpdGluZ0RpY3QocGFyZW50ICYmIHBhcmVudC5f
        dHlwZU9wdGlvbnMpOwogICAgfQoKICAgIENvbnRhaW5lci5wcm90b3R5cGUg
        PSB7CgogICAgICAvKioKICAgICAgICBAcHJvcGVydHkgcGFyZW50CiAgICAg
        ICAgQHR5cGUgQ29udGFpbmVyCiAgICAgICAgQGRlZmF1bHQgbnVsbAogICAg
        ICAqLwogICAgICBwYXJlbnQ6IG51bGwsCgogICAgICAvKioKICAgICAgICBA
        cHJvcGVydHkgY2hpbGRyZW4KICAgICAgICBAdHlwZSBBcnJheQogICAgICAg
        IEBkZWZhdWx0IFtdCiAgICAgICovCiAgICAgIGNoaWxkcmVuOiBudWxsLAoK
        ICAgICAgLyoqCiAgICAgICAgQHByb3BlcnR5IHJlc29sdmVyCiAgICAgICAg
        QHR5cGUgZnVuY3Rpb24KICAgICAgKi8KICAgICAgcmVzb2x2ZXI6IG51bGws
        CgogICAgICAvKioKICAgICAgICBAcHJvcGVydHkgcmVnaXN0cnkKICAgICAg
        ICBAdHlwZSBJbmhlcml0aW5nRGljdAogICAgICAqLwogICAgICByZWdpc3Ry
        eTogbnVsbCwKCiAgICAgIC8qKgogICAgICAgIEBwcm9wZXJ0eSBjYWNoZQog
        ICAgICAgIEB0eXBlIEluaGVyaXRpbmdEaWN0CiAgICAgICovCiAgICAgIGNh
        Y2hlOiBudWxsLAoKICAgICAgLyoqCiAgICAgICAgQHByb3BlcnR5IHR5cGVJ
        bmplY3Rpb25zCiAgICAgICAgQHR5cGUgSW5oZXJpdGluZ0RpY3QKICAgICAg
        Ki8KICAgICAgdHlwZUluamVjdGlvbnM6IG51bGwsCgogICAgICAvKioKICAg
        ICAgICBAcHJvcGVydHkgaW5qZWN0aW9ucwogICAgICAgIEB0eXBlIE9iamVj
        dAogICAgICAgIEBkZWZhdWx0IHt9CiAgICAgICovCiAgICAgIGluamVjdGlv
        bnM6IG51bGwsCgogICAgICAvKioKICAgICAgICBAcHJpdmF0ZQoKICAgICAg
        ICBAcHJvcGVydHkgX29wdGlvbnMKICAgICAgICBAdHlwZSBJbmhlcml0aW5n
        RGljdAogICAgICAgIEBkZWZhdWx0IG51bGwKICAgICAgKi8KICAgICAgX29w
        dGlvbnM6IG51bGwsCgogICAgICAvKioKICAgICAgICBAcHJpdmF0ZQoKICAg
        ICAgICBAcHJvcGVydHkgX3R5cGVPcHRpb25zCiAgICAgICAgQHR5cGUgSW5o
        ZXJpdGluZ0RpY3QKICAgICAgKi8KICAgICAgX3R5cGVPcHRpb25zOiBudWxs
        LAoKICAgICAgLyoqCiAgICAgICAgUmV0dXJucyBhIG5ldyBjaGlsZCBvZiB0
        aGUgY3VycmVudCBjb250YWluZXIuIFRoZXNlIGNoaWxkcmVuIGFyZSBjb25m
        aWd1cmVkCiAgICAgICAgdG8gY29ycmVjdGx5IGluaGVyaXQgZnJvbSB0aGUg
        Y3VycmVudCBjb250YWluZXIuCgogICAgICAgIEBtZXRob2QgY2hpbGQKICAg
        ICAgICBAcmV0dXJuIHtDb250YWluZXJ9CiAgICAgICovCiAgICAgIGNoaWxk
        OiBmdW5jdGlvbigpIHsKICAgICAgICB2YXIgY29udGFpbmVyID0gbmV3IENv
        bnRhaW5lcih0aGlzKTsKICAgICAgICB0aGlzLmNoaWxkcmVuLnB1c2goY29u
        dGFpbmVyKTsKICAgICAgICByZXR1cm4gY29udGFpbmVyOwogICAgICB9LAoK
        ICAgICAgLyoqCiAgICAgICAgU2V0cyBhIGtleS12YWx1ZSBwYWlyIG9uIHRo
        ZSBjdXJyZW50IGNvbnRhaW5lci4gSWYgYSBwYXJlbnQgY29udGFpbmVyLAog
        ICAgICAgIGhhcyB0aGUgc2FtZSBrZXksIG9uY2Ugc2V0IG9uIGEgY2hpbGQs
        IHRoZSBwYXJlbnQgYW5kIGNoaWxkIHdpbGwgZGl2ZXJnZQogICAgICAgIGFz
        IGV4cGVjdGVkLgoKICAgICAgICBAbWV0aG9kIHNldAogICAgICAgIEBwYXJh
        bSB7T2JqZWN0fSBvYmplY3QKICAgICAgICBAcGFyYW0ge1N0cmluZ30ga2V5
        CiAgICAgICAgQHBhcmFtIHthbnl9IHZhbHVlCiAgICAgICovCiAgICAgIHNl
        dDogZnVuY3Rpb24ob2JqZWN0LCBrZXksIHZhbHVlKSB7CiAgICAgICAgb2Jq
        ZWN0W2tleV0gPSB2YWx1ZTsKICAgICAgfSwKCiAgICAgIC8qKgogICAgICAg
        IFJlZ2lzdGVycyBhIGZhY3RvcnkgZm9yIGxhdGVyIGluamVjdGlvbi4KCiAg
        ICAgICAgRXhhbXBsZToKCiAgICAgICAgYGBgamF2YXNjcmlwdAogICAgICAg
        IHZhciBjb250YWluZXIgPSBuZXcgQ29udGFpbmVyKCk7CgogICAgICAgIGNv
        bnRhaW5lci5yZWdpc3RlcignbW9kZWw6dXNlcicsIFBlcnNvbiwge3Npbmds
        ZXRvbjogZmFsc2UgfSk7CiAgICAgICAgY29udGFpbmVyLnJlZ2lzdGVyKCdm
        cnVpdDpmYXZvcml0ZScsIE9yYW5nZSk7CiAgICAgICAgY29udGFpbmVyLnJl
        Z2lzdGVyKCdjb21tdW5pY2F0aW9uOm1haW4nLCBFbWFpbCwge3NpbmdsZXRv
        bjogZmFsc2V9KTsKICAgICAgICBgYGAKCiAgICAgICAgQG1ldGhvZCByZWdp
        c3RlcgogICAgICAgIEBwYXJhbSB7U3RyaW5nfSBmdWxsTmFtZQogICAgICAg
        IEBwYXJhbSB7RnVuY3Rpb259IGZhY3RvcnkKICAgICAgICBAcGFyYW0ge09i
        amVjdH0gb3B0aW9ucwogICAgICAqLwogICAgICByZWdpc3RlcjogZnVuY3Rp
        b24oZnVsbE5hbWUsIGZhY3RvcnksIG9wdGlvbnMpIHsKICAgICAgICBpZiAo
        ZnVsbE5hbWUuaW5kZXhPZignOicpID09PSAtMSkgewogICAgICAgICAgdGhy
        b3cgbmV3IFR5cGVFcnJvcigibWFsZm9ybWVkIGZ1bGxOYW1lLCBleHBlY3Rl
        ZDogYHR5cGU6bmFtZWAgZ290OiAiICsgZnVsbE5hbWUgKyAiIik7CiAgICAg
        ICAgfQoKICAgICAgICBpZiAoZmFjdG9yeSA9PT0gdW5kZWZpbmVkKSB7CiAg
        ICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdBdHRlbXB0aW5nIHRvIHJl
        Z2lzdGVyIGFuIHVua25vd24gZmFjdG9yeTogYCcgKyBmdWxsTmFtZSArICdg
        Jyk7CiAgICAgICAgfQoKICAgICAgICB2YXIgbm9ybWFsaXplZE5hbWUgPSB0
        aGlzLm5vcm1hbGl6ZShmdWxsTmFtZSk7CgogICAgICAgIGlmICh0aGlzLmNh
        Y2hlLmhhcyhub3JtYWxpemVkTmFtZSkpIHsKICAgICAgICAgIHRocm93IG5l
        dyBFcnJvcignQ2Fubm90IHJlLXJlZ2lzdGVyOiBgJyArIGZ1bGxOYW1lICsn
        YCwgYXMgaXQgaGFzIGFscmVhZHkgYmVlbiBsb29rZWQgdXAuJyk7CiAgICAg
        ICAgfQoKICAgICAgICB0aGlzLnJlZ2lzdHJ5LnNldChub3JtYWxpemVkTmFt
        ZSwgZmFjdG9yeSk7CiAgICAgICAgdGhpcy5fb3B0aW9ucy5zZXQobm9ybWFs
        aXplZE5hbWUsIG9wdGlvbnMgfHwge30pOwogICAgICB9LAoKICAgICAgLyoq
        CiAgICAgICAgVW5yZWdpc3RlciBhIGZ1bGxOYW1lCgogICAgICAgIGBgYGph
        dmFzY3JpcHQKICAgICAgICB2YXIgY29udGFpbmVyID0gbmV3IENvbnRhaW5l
        cigpOwogICAgICAgIGNvbnRhaW5lci5yZWdpc3RlcignbW9kZWw6dXNlcics
        IFVzZXIpOwoKICAgICAgICBjb250YWluZXIubG9va3VwKCdtb2RlbDp1c2Vy
        JykgaW5zdGFuY2VvZiBVc2VyIC8vPT4gdHJ1ZQoKICAgICAgICBjb250YWlu
        ZXIudW5yZWdpc3RlcignbW9kZWw6dXNlcicpCiAgICAgICAgY29udGFpbmVy
        Lmxvb2t1cCgnbW9kZWw6dXNlcicpID09PSB1bmRlZmluZWQgLy89PiB0cnVl
        CiAgICAgICAgYGBgCgogICAgICAgIEBtZXRob2QgdW5yZWdpc3RlcgogICAg
        ICAgIEBwYXJhbSB7U3RyaW5nfSBmdWxsTmFtZQogICAgICAgKi8KICAgICAg
        dW5yZWdpc3RlcjogZnVuY3Rpb24oZnVsbE5hbWUpIHsKICAgICAgICB2YXIg
        bm9ybWFsaXplZE5hbWUgPSB0aGlzLm5vcm1hbGl6ZShmdWxsTmFtZSk7Cgog
        ICAgICAgIHRoaXMucmVnaXN0cnkucmVtb3ZlKG5vcm1hbGl6ZWROYW1lKTsK
        ICAgICAgICB0aGlzLmNhY2hlLnJlbW92ZShub3JtYWxpemVkTmFtZSk7CiAg
        ICAgICAgdGhpcy5mYWN0b3J5Q2FjaGUucmVtb3ZlKG5vcm1hbGl6ZWROYW1l
        KTsKICAgICAgICB0aGlzLl9vcHRpb25zLnJlbW92ZShub3JtYWxpemVkTmFt
        ZSk7CiAgICAgIH0sCgogICAgICAvKioKICAgICAgICBHaXZlbiBhIGZ1bGxO
        YW1lIHJldHVybiB0aGUgY29ycmVzcG9uZGluZyBmYWN0b3J5LgoKICAgICAg
        ICBCeSBkZWZhdWx0IGByZXNvbHZlYCB3aWxsIHJldHJpZXZlIHRoZSBmYWN0
        b3J5IGZyb20KICAgICAgICBpdHMgY29udGFpbmVyJ3MgcmVnaXN0cnkuCgog
        ICAgICAgIGBgYGphdmFzY3JpcHQKICAgICAgICB2YXIgY29udGFpbmVyID0g
        bmV3IENvbnRhaW5lcigpOwogICAgICAgIGNvbnRhaW5lci5yZWdpc3Rlcign
        YXBpOnR3aXR0ZXInLCBUd2l0dGVyKTsKCiAgICAgICAgY29udGFpbmVyLnJl
        c29sdmUoJ2FwaTp0d2l0dGVyJykgLy8gPT4gVHdpdHRlcgogICAgICAgIGBg
        YAoKICAgICAgICBPcHRpb25hbGx5IHRoZSBjb250YWluZXIgY2FuIGJlIHBy
        b3ZpZGVkIHdpdGggYSBjdXN0b20gcmVzb2x2ZXIuCiAgICAgICAgSWYgcHJv
        dmlkZWQsIGByZXNvbHZlYCB3aWxsIGZpcnN0IHByb3ZpZGUgdGhlIGN1c3Rv
        bSByZXNvbHZlcgogICAgICAgIHRoZSBvcHBlcnR1bml0eSB0byByZXNvbHZl
        IHRoZSBmdWxsTmFtZSwgb3RoZXJ3aXNlIGl0IHdpbGwgZmFsbGJhY2sKICAg
        ICAgICB0byB0aGUgcmVnaXN0cnkuCgogICAgICAgIGBgYGphdmFzY3JpcHQK
        ICAgICAgICB2YXIgY29udGFpbmVyID0gbmV3IENvbnRhaW5lcigpOwogICAg
        ICAgIGNvbnRhaW5lci5yZXNvbHZlciA9IGZ1bmN0aW9uKGZ1bGxOYW1lKSB7
        CiAgICAgICAgICAvLyBsb29rdXAgdmlhIHRoZSBtb2R1bGUgc3lzdGVtIG9m
        IGNob2ljZQogICAgICAgIH07CgogICAgICAgIC8vIHRoZSB0d2l0dGVyIGZh
        Y3RvcnkgaXMgYWRkZWQgdG8gdGhlIG1vZHVsZSBzeXN0ZW0KICAgICAgICBj
        b250YWluZXIucmVzb2x2ZSgnYXBpOnR3aXR0ZXInKSAvLyA9PiBUd2l0dGVy
        CiAgICAgICAgYGBgCgogICAgICAgIEBtZXRob2QgcmVzb2x2ZQogICAgICAg
        IEBwYXJhbSB7U3RyaW5nfSBmdWxsTmFtZQogICAgICAgIEByZXR1cm4ge0Z1
        bmN0aW9ufSBmdWxsTmFtZSdzIGZhY3RvcnkKICAgICAgKi8KICAgICAgcmVz
        b2x2ZTogZnVuY3Rpb24oZnVsbE5hbWUpIHsKICAgICAgICByZXR1cm4gdGhp
        cy5yZXNvbHZlcihmdWxsTmFtZSkgfHwgdGhpcy5yZWdpc3RyeS5nZXQoZnVs
        bE5hbWUpOwogICAgICB9LAoKICAgICAgLyoqCiAgICAgICAgQSBob29rIHRo
        YXQgY2FuIGJlIHVzZWQgdG8gZGVzY3JpYmUgaG93IHRoZSByZXNvbHZlciB3
        aWxsCiAgICAgICAgYXR0ZW1wdCB0byBmaW5kIHRoZSBmYWN0b3J5LgoKICAg
        ICAgICBGb3IgZXhhbXBsZSwgdGhlIGRlZmF1bHQgRW1iZXIgYC5kZXNjcmli
        ZWAgcmV0dXJucyB0aGUgZnVsbAogICAgICAgIGNsYXNzIG5hbWUgKGluY2x1
        ZGluZyBuYW1lc3BhY2UpIHdoZXJlIEVtYmVyJ3MgcmVzb2x2ZXIgZXhwZWN0
        cwogICAgICAgIHRvIGZpbmQgdGhlIGBmdWxsTmFtZWAuCgogICAgICAgIEBt
        ZXRob2QgZGVzY3JpYmUKICAgICAgKi8KICAgICAgZGVzY3JpYmU6IGZ1bmN0
        aW9uKGZ1bGxOYW1lKSB7CiAgICAgICAgcmV0dXJuIGZ1bGxOYW1lOwogICAg
        ICB9LAoKICAgICAgLyoqCiAgICAgICAgQSBob29rIHRvIGVuYWJsZSBjdXN0
        b20gZnVsbE5hbWUgbm9ybWFsaXphdGlvbiBiZWhhdmlvdXIKCiAgICAgICAg
        QG1ldGhvZCBub3JtYWxpemUKICAgICAgICBAcGFyYW0ge1N0cmluZ30gZnVs
        bE5hbWUKICAgICAgICBAcmV0dXJuIHtzdHJpbmd9IG5vcm1hbGl6ZWQgZnVs
        bE5hbWUKICAgICAgKi8KICAgICAgbm9ybWFsaXplOiBmdW5jdGlvbihmdWxs
        TmFtZSkgewogICAgICAgIHJldHVybiBmdWxsTmFtZTsKICAgICAgfSwKCiAg
        ICAgIC8qKgogICAgICAgIEBtZXRob2QgbWFrZVRvU3RyaW5nCgogICAgICAg
        IEBwYXJhbSB7YW55fSBmYWN0b3J5CiAgICAgICAgQHBhcmFtIHtzdHJpbmd9
        IGZ1bGxOYW1lCiAgICAgICAgQHJldHVybiB7ZnVuY3Rpb259IHRvU3RyaW5n
        IGZ1bmN0aW9uCiAgICAgICovCiAgICAgIG1ha2VUb1N0cmluZzogZnVuY3Rp
        b24oZmFjdG9yeSwgZnVsbE5hbWUpIHsKICAgICAgICByZXR1cm4gZmFjdG9y
        eS50b1N0cmluZygpOwogICAgICB9LAoKICAgICAgLyoqCiAgICAgICAgR2l2
        ZW4gYSBmdWxsTmFtZSByZXR1cm4gYSBjb3JyZXNwb25kaW5nIGluc3RhbmNl
        LgoKICAgICAgICBUaGUgZGVmYXVsdCBiZWhhdmlvdXIgaXMgZm9yIGxvb2t1
        cCB0byByZXR1cm4gYSBzaW5nbGV0b24gaW5zdGFuY2UuCiAgICAgICAgVGhl
        IHNpbmdsZXRvbiBpcyBzY29wZWQgdG8gdGhlIGNvbnRhaW5lciwgYWxsb3dp
        bmcgbXVsdGlwbGUgY29udGFpbmVycwogICAgICAgIHRvIGFsbCBoYXZlIHRo
        ZWlyIG93biBsb2NhbGx5IHNjb3BlZCBzaW5nbGV0b25zLgoKICAgICAgICBg
        YGBqYXZhc2NyaXB0CiAgICAgICAgdmFyIGNvbnRhaW5lciA9IG5ldyBDb250
        YWluZXIoKTsKICAgICAgICBjb250YWluZXIucmVnaXN0ZXIoJ2FwaTp0d2l0
        dGVyJywgVHdpdHRlcik7CgogICAgICAgIHZhciB0d2l0dGVyID0gY29udGFp
        bmVyLmxvb2t1cCgnYXBpOnR3aXR0ZXInKTsKCiAgICAgICAgdHdpdHRlciBp
        bnN0YW5jZW9mIFR3aXR0ZXI7IC8vID0+IHRydWUKCiAgICAgICAgLy8gYnkg
        ZGVmYXVsdCB0aGUgY29udGFpbmVyIHdpbGwgcmV0dXJuIHNpbmdsZXRvbnMK
        ICAgICAgICB0d2l0dGVyMiA9IGNvbnRhaW5lci5sb29rdXAoJ2FwaTp0d2l0
        dGVyJyk7CiAgICAgICAgdHdpdHRlciBpbnN0YW5jZW9mIFR3aXR0ZXI7IC8v
        ID0+IHRydWUKCiAgICAgICAgdHdpdHRlciA9PT0gdHdpdHRlcjI7IC8vPT4g
        dHJ1ZQogICAgICAgIGBgYAoKICAgICAgICBJZiBzaW5nbGV0b25zIGFyZSBu
        b3Qgd2FudGVkIGFuIG9wdGlvbmFsIGZsYWcgY2FuIGJlIHByb3ZpZGVkIGF0
        IGxvb2t1cC4KCiAgICAgICAgYGBgamF2YXNjcmlwdAogICAgICAgIHZhciBj
        b250YWluZXIgPSBuZXcgQ29udGFpbmVyKCk7CiAgICAgICAgY29udGFpbmVy
        LnJlZ2lzdGVyKCdhcGk6dHdpdHRlcicsIFR3aXR0ZXIpOwoKICAgICAgICB2
        YXIgdHdpdHRlciA9IGNvbnRhaW5lci5sb29rdXAoJ2FwaTp0d2l0dGVyJywg
        eyBzaW5nbGV0b246IGZhbHNlIH0pOwogICAgICAgIHZhciB0d2l0dGVyMiA9
        IGNvbnRhaW5lci5sb29rdXAoJ2FwaTp0d2l0dGVyJywgeyBzaW5nbGV0b246
        IGZhbHNlIH0pOwoKICAgICAgICB0d2l0dGVyID09PSB0d2l0dGVyMjsgLy89
        PiBmYWxzZQogICAgICAgIGBgYAoKICAgICAgICBAbWV0aG9kIGxvb2t1cAog
        ICAgICAgIEBwYXJhbSB7U3RyaW5nfSBmdWxsTmFtZQogICAgICAgIEBwYXJh
        bSB7T2JqZWN0fSBvcHRpb25zCiAgICAgICAgQHJldHVybiB7YW55fQogICAg
        ICAqLwogICAgICBsb29rdXA6IGZ1bmN0aW9uKGZ1bGxOYW1lLCBvcHRpb25z
        KSB7CiAgICAgICAgZnVsbE5hbWUgPSB0aGlzLm5vcm1hbGl6ZShmdWxsTmFt
        ZSk7CgogICAgICAgIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9OwoKICAgICAg
        ICBpZiAodGhpcy5jYWNoZS5oYXMoZnVsbE5hbWUpICYmIG9wdGlvbnMuc2lu
        Z2xldG9uICE9PSBmYWxzZSkgewogICAgICAgICAgcmV0dXJuIHRoaXMuY2Fj
        aGUuZ2V0KGZ1bGxOYW1lKTsKICAgICAgICB9CgogICAgICAgIHZhciB2YWx1
        ZSA9IGluc3RhbnRpYXRlKHRoaXMsIGZ1bGxOYW1lKTsKCiAgICAgICAgaWYg
        KHZhbHVlID09PSB1bmRlZmluZWQpIHsgcmV0dXJuOyB9CgogICAgICAgIGlm
        IChpc1NpbmdsZXRvbih0aGlzLCBmdWxsTmFtZSkgJiYgb3B0aW9ucy5zaW5n
        bGV0b24gIT09IGZhbHNlKSB7CiAgICAgICAgICB0aGlzLmNhY2hlLnNldChm
        dWxsTmFtZSwgdmFsdWUpOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIHZh
        bHVlOwogICAgICB9LAoKICAgICAgLyoqCiAgICAgICAgR2l2ZW4gYSBmdWxs
        TmFtZSByZXR1cm4gdGhlIGNvcnJlc3BvbmRpbmcgZmFjdG9yeS4KCiAgICAg
        ICAgQG1ldGhvZCBsb29rdXBGYWN0b3J5CiAgICAgICAgQHBhcmFtIHtTdHJp
        bmd9IGZ1bGxOYW1lCiAgICAgICAgQHJldHVybiB7YW55fQogICAgICAqLwog
        ICAgICBsb29rdXBGYWN0b3J5OiBmdW5jdGlvbihmdWxsTmFtZSkgewogICAg
        ICAgIHJldHVybiBmYWN0b3J5Rm9yKHRoaXMsIGZ1bGxOYW1lKTsKICAgICAg
        fSwKCiAgICAgIC8qKgogICAgICAgIEdpdmVuIGEgZnVsbE5hbWUgY2hlY2sg
        aWYgdGhlIGNvbnRhaW5lciBpcyBhd2FyZSBvZiBpdHMgZmFjdG9yeQogICAg
        ICAgIG9yIHNpbmdsZXRvbiBpbnN0YW5jZS4KCiAgICAgICAgQG1ldGhvZCBo
        YXMKICAgICAgICBAcGFyYW0ge1N0cmluZ30gZnVsbE5hbWUKICAgICAgICBA
        cmV0dXJuIHtCb29sZWFufQogICAgICAqLwogICAgICBoYXM6IGZ1bmN0aW9u
        KGZ1bGxOYW1lKSB7CiAgICAgICAgaWYgKHRoaXMuY2FjaGUuaGFzKGZ1bGxO
        YW1lKSkgewogICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQoKICAg
        ICAgICByZXR1cm4gISFmYWN0b3J5Rm9yKHRoaXMsIGZ1bGxOYW1lKTsKICAg
        ICAgfSwKCiAgICAgIC8qKgogICAgICAgIEFsbG93IHJlZ2lzdGVyaW5nIG9w
        dGlvbnMgZm9yIGFsbCBmYWN0b3JpZXMgb2YgYSB0eXBlLgoKICAgICAgICBg
        YGBqYXZhc2NyaXB0CiAgICAgICAgdmFyIGNvbnRhaW5lciA9IG5ldyBDb250
        YWluZXIoKTsKCiAgICAgICAgLy8gaWYgYWxsIG9mIHR5cGUgYGNvbm5lY3Rp
        b25gIG11c3Qgbm90IGJlIHNpbmdsZXRvbnMKICAgICAgICBjb250YWluZXIu
        b3B0aW9uc0ZvclR5cGUoJ2Nvbm5lY3Rpb24nLCB7IHNpbmdsZXRvbjogZmFs
        c2UgfSk7CgogICAgICAgIGNvbnRhaW5lci5yZWdpc3RlcignY29ubmVjdGlv
        bjp0d2l0dGVyJywgVHdpdHRlckNvbm5lY3Rpb24pOwogICAgICAgIGNvbnRh
        aW5lci5yZWdpc3RlcignY29ubmVjdGlvbjpmYWNlYm9vaycsIEZhY2Vib29r
        Q29ubmVjdGlvbik7CgogICAgICAgIHZhciB0d2l0dGVyID0gY29udGFpbmVy
        Lmxvb2t1cCgnY29ubmVjdGlvbjp0d2l0dGVyJyk7CiAgICAgICAgdmFyIHR3
        aXR0ZXIyID0gY29udGFpbmVyLmxvb2t1cCgnY29ubmVjdGlvbjp0d2l0dGVy
        Jyk7CgogICAgICAgIHR3aXR0ZXIgPT09IHR3aXR0ZXIyOyAvLyA9PiBmYWxz
        ZQoKICAgICAgICB2YXIgZmFjZWJvb2sgPSBjb250YWluZXIubG9va3VwKCdj
        b25uZWN0aW9uOmZhY2Vib29rJyk7CiAgICAgICAgdmFyIGZhY2Vib29rMiA9
        IGNvbnRhaW5lci5sb29rdXAoJ2Nvbm5lY3Rpb246ZmFjZWJvb2snKTsKCiAg
        ICAgICAgZmFjZWJvb2sgPT09IGZhY2Vib29rMjsgLy8gPT4gZmFsc2UKICAg
        ICAgICBgYGAKCiAgICAgICAgQG1ldGhvZCBvcHRpb25zRm9yVHlwZQogICAg
        ICAgIEBwYXJhbSB7U3RyaW5nfSB0eXBlCiAgICAgICAgQHBhcmFtIHtPYmpl
        Y3R9IG9wdGlvbnMKICAgICAgKi8KICAgICAgb3B0aW9uc0ZvclR5cGU6IGZ1
        bmN0aW9uKHR5cGUsIG9wdGlvbnMpIHsKICAgICAgICBpZiAodGhpcy5wYXJl
        bnQpIHsgaWxsZWdhbENoaWxkT3BlcmF0aW9uKCdvcHRpb25zRm9yVHlwZScp
        OyB9CgogICAgICAgIHRoaXMuX3R5cGVPcHRpb25zLnNldCh0eXBlLCBvcHRp
        b25zKTsKICAgICAgfSwKCiAgICAgIC8qKgogICAgICAgIEBtZXRob2Qgb3B0
        aW9ucwogICAgICAgIEBwYXJhbSB7U3RyaW5nfSB0eXBlCiAgICAgICAgQHBh
        cmFtIHtPYmplY3R9IG9wdGlvbnMKICAgICAgKi8KICAgICAgb3B0aW9uczog
        ZnVuY3Rpb24odHlwZSwgb3B0aW9ucykgewogICAgICAgIHRoaXMub3B0aW9u
        c0ZvclR5cGUodHlwZSwgb3B0aW9ucyk7CiAgICAgIH0sCgogICAgICAvKioK
        ICAgICAgICBAcHJpdmF0ZQoKICAgICAgICBVc2VkIG9ubHkgdmlhIGBpbmpl
        Y3Rpb25gLgoKICAgICAgICBQcm92aWRlcyBhIHNwZWNpYWxpemVkIGZvcm0g
        b2YgaW5qZWN0aW9uLCBzcGVjaWZpY2FsbHkgZW5hYmxpbmcKICAgICAgICBh
        bGwgb2JqZWN0cyBvZiBvbmUgdHlwZSB0byBiZSBpbmplY3RlZCB3aXRoIGEg
        cmVmZXJlbmNlIHRvIGFub3RoZXIKICAgICAgICBvYmplY3QuCgogICAgICAg
        IEZvciBleGFtcGxlLCBwcm92aWRlZCBlYWNoIG9iamVjdCBvZiB0eXBlIGBj
        b250cm9sbGVyYCBuZWVkZWQgYSBgcm91dGVyYC4KICAgICAgICBvbmUgd291
        bGQgZG8gdGhlIGZvbGxvd2luZzoKCiAgICAgICAgYGBgamF2YXNjcmlwdAog
        ICAgICAgIHZhciBjb250YWluZXIgPSBuZXcgQ29udGFpbmVyKCk7CgogICAg
        ICAgIGNvbnRhaW5lci5yZWdpc3Rlcigncm91dGVyOm1haW4nLCBSb3V0ZXIp
        OwogICAgICAgIGNvbnRhaW5lci5yZWdpc3RlcignY29udHJvbGxlcjp1c2Vy
        JywgVXNlckNvbnRyb2xsZXIpOwogICAgICAgIGNvbnRhaW5lci5yZWdpc3Rl
        cignY29udHJvbGxlcjpwb3N0JywgUG9zdENvbnRyb2xsZXIpOwoKICAgICAg
        ICBjb250YWluZXIudHlwZUluamVjdGlvbignY29udHJvbGxlcicsICdyb3V0
        ZXInLCAncm91dGVyOm1haW4nKTsKCiAgICAgICAgdmFyIHVzZXIgPSBjb250
        YWluZXIubG9va3VwKCdjb250cm9sbGVyOnVzZXInKTsKICAgICAgICB2YXIg
        cG9zdCA9IGNvbnRhaW5lci5sb29rdXAoJ2NvbnRyb2xsZXI6cG9zdCcpOwoK
        ICAgICAgICB1c2VyLnJvdXRlciBpbnN0YW5jZW9mIFJvdXRlcjsgLy89PiB0
        cnVlCiAgICAgICAgcG9zdC5yb3V0ZXIgaW5zdGFuY2VvZiBSb3V0ZXI7IC8v
        PT4gdHJ1ZQoKICAgICAgICAvLyBib3RoIGNvbnRyb2xsZXJzIHNoYXJlIHRo
        ZSBzYW1lIHJvdXRlcgogICAgICAgIHVzZXIucm91dGVyID09PSBwb3N0LnJv
        dXRlcjsgLy89PiB0cnVlCiAgICAgICAgYGBgCgogICAgICAgIEBtZXRob2Qg
        dHlwZUluamVjdGlvbgogICAgICAgIEBwYXJhbSB7U3RyaW5nfSB0eXBlCiAg
        ICAgICAgQHBhcmFtIHtTdHJpbmd9IHByb3BlcnR5CiAgICAgICAgQHBhcmFt
        IHtTdHJpbmd9IGZ1bGxOYW1lCiAgICAgICovCiAgICAgIHR5cGVJbmplY3Rp
        b246IGZ1bmN0aW9uKHR5cGUsIHByb3BlcnR5LCBmdWxsTmFtZSkgewogICAg
        ICAgIGlmICh0aGlzLnBhcmVudCkgeyBpbGxlZ2FsQ2hpbGRPcGVyYXRpb24o
        J3R5cGVJbmplY3Rpb24nKTsgfQoKICAgICAgICBhZGRUeXBlSW5qZWN0aW9u
        KHRoaXMudHlwZUluamVjdGlvbnMsIHR5cGUsIHByb3BlcnR5LCBmdWxsTmFt
        ZSk7CiAgICAgIH0sCgogICAgICAvKioKICAgICAgICBEZWZpbmVzIGluamVj
        dGlvbiBydWxlcy4KCiAgICAgICAgVGhlc2UgcnVsZXMgYXJlIHVzZWQgdG8g
        aW5qZWN0IGRlcGVuZGVuY2llcyBvbnRvIG9iamVjdHMgd2hlbiB0aGV5CiAg
        ICAgICAgYXJlIGluc3RhbnRpYXRlZC4KCiAgICAgICAgVHdvIGZvcm1zIG9m
        IGluamVjdGlvbnMgYXJlIHBvc3NpYmxlOgoKICAgICAgKiBJbmplY3Rpbmcg
        b25lIGZ1bGxOYW1lIG9uIGFub3RoZXIgZnVsbE5hbWUKICAgICAgKiBJbmpl
        Y3Rpbmcgb25lIGZ1bGxOYW1lIG9uIGEgdHlwZQoKICAgICAgICBFeGFtcGxl
        OgoKICAgICAgICBgYGBqYXZhc2NyaXB0CiAgICAgICAgdmFyIGNvbnRhaW5l
        ciA9IG5ldyBDb250YWluZXIoKTsKCiAgICAgICAgY29udGFpbmVyLnJlZ2lz
        dGVyKCdzb3VyY2U6bWFpbicsIFNvdXJjZSk7CiAgICAgICAgY29udGFpbmVy
        LnJlZ2lzdGVyKCdtb2RlbDp1c2VyJywgVXNlcik7CiAgICAgICAgY29udGFp
        bmVyLnJlZ2lzdGVyKCdtb2RlbDpwb3N0JywgUG9zdCk7CgogICAgICAgIC8v
        IGluamVjdGluZyBvbmUgZnVsbE5hbWUgb24gYW5vdGhlciBmdWxsTmFtZQog
        ICAgICAgIC8vIGVnLiBlYWNoIHVzZXIgbW9kZWwgZ2V0cyBhIHBvc3QgbW9k
        ZWwKICAgICAgICBjb250YWluZXIuaW5qZWN0aW9uKCdtb2RlbDp1c2VyJywg
        J3Bvc3QnLCAnbW9kZWw6cG9zdCcpOwoKICAgICAgICAvLyBpbmplY3Rpbmcg
        b25lIGZ1bGxOYW1lIG9uIGFub3RoZXIgdHlwZQogICAgICAgIGNvbnRhaW5l
        ci5pbmplY3Rpb24oJ21vZGVsJywgJ3NvdXJjZScsICdzb3VyY2U6bWFpbicp
        OwoKICAgICAgICB2YXIgdXNlciA9IGNvbnRhaW5lci5sb29rdXAoJ21vZGVs
        OnVzZXInKTsKICAgICAgICB2YXIgcG9zdCA9IGNvbnRhaW5lci5sb29rdXAo
        J21vZGVsOnBvc3QnKTsKCiAgICAgICAgdXNlci5zb3VyY2UgaW5zdGFuY2Vv
        ZiBTb3VyY2U7IC8vPT4gdHJ1ZQogICAgICAgIHBvc3Quc291cmNlIGluc3Rh
        bmNlb2YgU291cmNlOyAvLz0+IHRydWUKCiAgICAgICAgdXNlci5wb3N0IGlu
        c3RhbmNlb2YgUG9zdDsgLy89PiB0cnVlCgogICAgICAgIC8vIGFuZCBib3Ro
        IG1vZGVscyBzaGFyZSB0aGUgc2FtZSBzb3VyY2UKICAgICAgICB1c2VyLnNv
        dXJjZSA9PT0gcG9zdC5zb3VyY2U7IC8vPT4gdHJ1ZQogICAgICAgIGBgYAoK
        ICAgICAgICBAbWV0aG9kIGluamVjdGlvbgogICAgICAgIEBwYXJhbSB7U3Ry
        aW5nfSBmYWN0b3J5TmFtZQogICAgICAgIEBwYXJhbSB7U3RyaW5nfSBwcm9w
        ZXJ0eQogICAgICAgIEBwYXJhbSB7U3RyaW5nfSBpbmplY3Rpb25OYW1lCiAg
        ICAgICovCiAgICAgIGluamVjdGlvbjogZnVuY3Rpb24oZmFjdG9yeU5hbWUs
        IHByb3BlcnR5LCBpbmplY3Rpb25OYW1lKSB7CiAgICAgICAgaWYgKHRoaXMu
        cGFyZW50KSB7IGlsbGVnYWxDaGlsZE9wZXJhdGlvbignaW5qZWN0aW9uJyk7
        IH0KCiAgICAgICAgaWYgKGZhY3RvcnlOYW1lLmluZGV4T2YoJzonKSA9PT0g
        LTEpIHsKICAgICAgICAgIHJldHVybiB0aGlzLnR5cGVJbmplY3Rpb24oZmFj
        dG9yeU5hbWUsIHByb3BlcnR5LCBpbmplY3Rpb25OYW1lKTsKICAgICAgICB9
        CgogICAgICAgIGFkZEluamVjdGlvbih0aGlzLmluamVjdGlvbnMsIGZhY3Rv
        cnlOYW1lLCBwcm9wZXJ0eSwgaW5qZWN0aW9uTmFtZSk7CiAgICAgIH0sCgoK
        ICAgICAgLyoqCiAgICAgICAgQHByaXZhdGUKCiAgICAgICAgVXNlZCBvbmx5
        IHZpYSBgZmFjdG9yeUluamVjdGlvbmAuCgogICAgICAgIFByb3ZpZGVzIGEg
        c3BlY2lhbGl6ZWQgZm9ybSBvZiBpbmplY3Rpb24sIHNwZWNpZmljYWxseSBl
        bmFibGluZwogICAgICAgIGFsbCBmYWN0b3J5IG9mIG9uZSB0eXBlIHRvIGJl
        IGluamVjdGVkIHdpdGggYSByZWZlcmVuY2UgdG8gYW5vdGhlcgogICAgICAg
        IG9iamVjdC4KCiAgICAgICAgRm9yIGV4YW1wbGUsIHByb3ZpZGVkIGVhY2gg
        ZmFjdG9yeSBvZiB0eXBlIGBtb2RlbGAgbmVlZGVkIGEgYHN0b3JlYC4KICAg
        ICAgICBvbmUgd291bGQgZG8gdGhlIGZvbGxvd2luZzoKCiAgICAgICAgYGBg
        amF2YXNjcmlwdAogICAgICAgIHZhciBjb250YWluZXIgPSBuZXcgQ29udGFp
        bmVyKCk7CgogICAgICAgIGNvbnRhaW5lci5yZWdpc3RlckZhY3RvcnkoJ21v
        ZGVsOnVzZXInLCBVc2VyKTsKICAgICAgICBjb250YWluZXIucmVnaXN0ZXIo
        J3N0b3JlOm1haW4nLCBTb21lU3RvcmUpOwoKICAgICAgICBjb250YWluZXIu
        ZmFjdG9yeVR5cGVJbmplY3Rpb24oJ21vZGVsJywgJ3N0b3JlJywgJ3N0b3Jl
        Om1haW4nKTsKCiAgICAgICAgdmFyIHN0b3JlID0gY29udGFpbmVyLmxvb2t1
        cCgnc3RvcmU6bWFpbicpOwogICAgICAgIHZhciBVc2VyRmFjdG9yeSA9IGNv
        bnRhaW5lci5sb29rdXBGYWN0b3J5KCdtb2RlbDp1c2VyJyk7CgogICAgICAg
        IFVzZXJGYWN0b3J5LnN0b3JlIGluc3RhbmNlb2YgU29tZVN0b3JlOyAvLz0+
        IHRydWUKICAgICAgICBgYGAKCiAgICAgICAgQG1ldGhvZCBmYWN0b3J5VHlw
        ZUluamVjdGlvbgogICAgICAgIEBwYXJhbSB7U3RyaW5nfSB0eXBlCiAgICAg
        ICAgQHBhcmFtIHtTdHJpbmd9IHByb3BlcnR5CiAgICAgICAgQHBhcmFtIHtT
        dHJpbmd9IGZ1bGxOYW1lCiAgICAgICovCiAgICAgIGZhY3RvcnlUeXBlSW5q
        ZWN0aW9uOiBmdW5jdGlvbih0eXBlLCBwcm9wZXJ0eSwgZnVsbE5hbWUpIHsK
        ICAgICAgICBpZiAodGhpcy5wYXJlbnQpIHsgaWxsZWdhbENoaWxkT3BlcmF0
        aW9uKCdmYWN0b3J5VHlwZUluamVjdGlvbicpOyB9CgogICAgICAgIGFkZFR5
        cGVJbmplY3Rpb24odGhpcy5mYWN0b3J5VHlwZUluamVjdGlvbnMsIHR5cGUs
        IHByb3BlcnR5LCBmdWxsTmFtZSk7CiAgICAgIH0sCgogICAgICAvKioKICAg
        ICAgICBEZWZpbmVzIGZhY3RvcnkgaW5qZWN0aW9uIHJ1bGVzLgoKICAgICAg
        ICBTaW1pbGFyIHRvIHJlZ3VsYXIgaW5qZWN0aW9uIHJ1bGVzLCBidXQgYXJl
        IHJ1biBhZ2FpbnN0IGZhY3RvcmllcywgdmlhCiAgICAgICAgYENvbnRhaW5l
        ciNsb29rdXBGYWN0b3J5YC4KCiAgICAgICAgVGhlc2UgcnVsZXMgYXJlIHVz
        ZWQgdG8gaW5qZWN0IG9iamVjdHMgb250byBmYWN0b3JpZXMgd2hlbiB0aGV5
        CiAgICAgICAgYXJlIGxvb2tlZCB1cC4KCiAgICAgICAgVHdvIGZvcm1zIG9m
        IGluamVjdGlvbnMgYXJlIHBvc3NpYmxlOgoKICAgICAgKiBJbmplY3Rpbmcg
        b25lIGZ1bGxOYW1lIG9uIGFub3RoZXIgZnVsbE5hbWUKICAgICAgKiBJbmpl
        Y3Rpbmcgb25lIGZ1bGxOYW1lIG9uIGEgdHlwZQoKICAgICAgICBFeGFtcGxl
        OgoKICAgICAgICBgYGBqYXZhc2NyaXB0CiAgICAgICAgdmFyIGNvbnRhaW5l
        ciA9IG5ldyBDb250YWluZXIoKTsKCiAgICAgICAgY29udGFpbmVyLnJlZ2lz
        dGVyKCdzdG9yZTptYWluJywgU3RvcmUpOwogICAgICAgIGNvbnRhaW5lci5y
        ZWdpc3Rlcignc3RvcmU6c2Vjb25kYXJ5JywgT3RoZXJTdG9yZSk7CiAgICAg
        ICAgY29udGFpbmVyLnJlZ2lzdGVyKCdtb2RlbDp1c2VyJywgVXNlcik7CiAg
        ICAgICAgY29udGFpbmVyLnJlZ2lzdGVyKCdtb2RlbDpwb3N0JywgUG9zdCk7
        CgogICAgICAgIC8vIGluamVjdGluZyBvbmUgZnVsbE5hbWUgb24gYW5vdGhl
        ciB0eXBlCiAgICAgICAgY29udGFpbmVyLmZhY3RvcnlJbmplY3Rpb24oJ21v
        ZGVsJywgJ3N0b3JlJywgJ3N0b3JlOm1haW4nKTsKCiAgICAgICAgLy8gaW5q
        ZWN0aW5nIG9uZSBmdWxsTmFtZSBvbiBhbm90aGVyIGZ1bGxOYW1lCiAgICAg
        ICAgY29udGFpbmVyLmZhY3RvcnlJbmplY3Rpb24oJ21vZGVsOnBvc3QnLCAn
        c2Vjb25kYXJ5U3RvcmUnLCAnc3RvcmU6c2Vjb25kYXJ5Jyk7CgogICAgICAg
        IHZhciBVc2VyRmFjdG9yeSA9IGNvbnRhaW5lci5sb29rdXBGYWN0b3J5KCdt
        b2RlbDp1c2VyJyk7CiAgICAgICAgdmFyIFBvc3RGYWN0b3J5ID0gY29udGFp
        bmVyLmxvb2t1cEZhY3RvcnkoJ21vZGVsOnBvc3QnKTsKICAgICAgICB2YXIg
        c3RvcmUgPSBjb250YWluZXIubG9va3VwKCdzdG9yZTptYWluJyk7CgogICAg
        ICAgIFVzZXJGYWN0b3J5LnN0b3JlIGluc3RhbmNlb2YgU3RvcmU7IC8vPT4g
        dHJ1ZQogICAgICAgIFVzZXJGYWN0b3J5LnNlY29uZGFyeVN0b3JlIGluc3Rh
        bmNlb2YgT3RoZXJTdG9yZTsgLy89PiBmYWxzZQoKICAgICAgICBQb3N0RmFj
        dG9yeS5zdG9yZSBpbnN0YW5jZW9mIFN0b3JlOyAvLz0+IHRydWUKICAgICAg
        ICBQb3N0RmFjdG9yeS5zZWNvbmRhcnlTdG9yZSBpbnN0YW5jZW9mIE90aGVy
        U3RvcmU7IC8vPT4gdHJ1ZQoKICAgICAgICAvLyBhbmQgYm90aCBtb2RlbHMg
        c2hhcmUgdGhlIHNhbWUgc291cmNlIGluc3RhbmNlCiAgICAgICAgVXNlckZh
        Y3Rvcnkuc3RvcmUgPT09IFBvc3RGYWN0b3J5LnN0b3JlOyAvLz0+IHRydWUK
        ICAgICAgICBgYGAKCiAgICAgICAgQG1ldGhvZCBmYWN0b3J5SW5qZWN0aW9u
        CiAgICAgICAgQHBhcmFtIHtTdHJpbmd9IGZhY3RvcnlOYW1lCiAgICAgICAg
        QHBhcmFtIHtTdHJpbmd9IHByb3BlcnR5CiAgICAgICAgQHBhcmFtIHtTdHJp
        bmd9IGluamVjdGlvbk5hbWUKICAgICAgKi8KICAgICAgZmFjdG9yeUluamVj
        dGlvbjogZnVuY3Rpb24oZmFjdG9yeU5hbWUsIHByb3BlcnR5LCBpbmplY3Rp
        b25OYW1lKSB7CiAgICAgICAgaWYgKHRoaXMucGFyZW50KSB7IGlsbGVnYWxD
        aGlsZE9wZXJhdGlvbignaW5qZWN0aW9uJyk7IH0KCiAgICAgICAgaWYgKGZh
        Y3RvcnlOYW1lLmluZGV4T2YoJzonKSA9PT0gLTEpIHsKICAgICAgICAgIHJl
        dHVybiB0aGlzLmZhY3RvcnlUeXBlSW5qZWN0aW9uKGZhY3RvcnlOYW1lLCBw
        cm9wZXJ0eSwgaW5qZWN0aW9uTmFtZSk7CiAgICAgICAgfQoKICAgICAgICBh
        ZGRJbmplY3Rpb24odGhpcy5mYWN0b3J5SW5qZWN0aW9ucywgZmFjdG9yeU5h
        bWUsIHByb3BlcnR5LCBpbmplY3Rpb25OYW1lKTsKICAgICAgfSwKCiAgICAg
        IC8qKgogICAgICAgIEEgZGVwdGggZmlyc3QgdHJhdmVyc2FsLCBkZXN0cm95
        aW5nIHRoZSBjb250YWluZXIsIGl0cyBkZXNjZW5kYW50IGNvbnRhaW5lcnMg
        YW5kIGFsbAogICAgICAgIHRoZWlyIG1hbmFnZWQgb2JqZWN0cy4KCiAgICAg
        ICAgQG1ldGhvZCBkZXN0cm95CiAgICAgICovCiAgICAgIGRlc3Ryb3k6IGZ1
        bmN0aW9uKCkgewogICAgICAgIHRoaXMuaXNEZXN0cm95ZWQgPSB0cnVlOwoK
        ICAgICAgICBmb3IgKHZhciBpPTAsIGw9dGhpcy5jaGlsZHJlbi5sZW5ndGg7
        IGk8bDsgaSsrKSB7CiAgICAgICAgICB0aGlzLmNoaWxkcmVuW2ldLmRlc3Ry
        b3koKTsKICAgICAgICB9CgogICAgICAgIHRoaXMuY2hpbGRyZW4gPSBbXTsK
        CiAgICAgICAgZWFjaERlc3Ryb3lhYmxlKHRoaXMsIGZ1bmN0aW9uKGl0ZW0p
        IHsKICAgICAgICAgIGl0ZW0uZGVzdHJveSgpOwogICAgICAgIH0pOwoKICAg
        ICAgICB0aGlzLnBhcmVudCA9IHVuZGVmaW5lZDsKICAgICAgICB0aGlzLmlz
        RGVzdHJveWVkID0gdHJ1ZTsKICAgICAgfSwKCiAgICAgIC8qKgogICAgICAg
        IEBtZXRob2QgcmVzZXQKICAgICAgKi8KICAgICAgcmVzZXQ6IGZ1bmN0aW9u
        KCkgewogICAgICAgIGZvciAodmFyIGk9MCwgbD10aGlzLmNoaWxkcmVuLmxl
        bmd0aDsgaTxsOyBpKyspIHsKICAgICAgICAgIHJlc2V0Q2FjaGUodGhpcy5j
        aGlsZHJlbltpXSk7CiAgICAgICAgfQogICAgICAgIHJlc2V0Q2FjaGUodGhp
        cyk7CiAgICAgIH0KICAgIH07CgogICAgZnVuY3Rpb24gaWxsZWdhbENoaWxk
        T3BlcmF0aW9uKG9wZXJhdGlvbikgewogICAgICB0aHJvdyBuZXcgRXJyb3Io
        b3BlcmF0aW9uICsgIiBpcyBub3QgY3VycmVudGx5IHN1cHBvcnRlZCBvbiBj
        aGlsZCBjb250YWluZXJzIik7CiAgICB9CgogICAgZnVuY3Rpb24gaXNTaW5n
        bGV0b24oY29udGFpbmVyLCBmdWxsTmFtZSkgewogICAgICB2YXIgc2luZ2xl
        dG9uID0gb3B0aW9uKGNvbnRhaW5lciwgZnVsbE5hbWUsICdzaW5nbGV0b24n
        KTsKCiAgICAgIHJldHVybiBzaW5nbGV0b24gIT09IGZhbHNlOwogICAgfQoK
        ICAgIGZ1bmN0aW9uIGJ1aWxkSW5qZWN0aW9ucyhjb250YWluZXIsIGluamVj
        dGlvbnMpIHsKICAgICAgdmFyIGhhc2ggPSB7fTsKCiAgICAgIGlmICghaW5q
        ZWN0aW9ucykgeyByZXR1cm4gaGFzaDsgfQoKICAgICAgdmFyIGluamVjdGlv
        biwgbG9va3VwOwoKICAgICAgZm9yICh2YXIgaT0wLCBsPWluamVjdGlvbnMu
        bGVuZ3RoOyBpPGw7IGkrKykgewogICAgICAgIGluamVjdGlvbiA9IGluamVj
        dGlvbnNbaV07CiAgICAgICAgbG9va3VwID0gY29udGFpbmVyLmxvb2t1cChp
        bmplY3Rpb24uZnVsbE5hbWUpOwoKICAgICAgICBpZiAobG9va3VwICE9PSB1
        bmRlZmluZWQpIHsKICAgICAgICAgIGhhc2hbaW5qZWN0aW9uLnByb3BlcnR5
        XSA9IGxvb2t1cDsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhyb3cg
        bmV3IEVycm9yKCdBdHRlbXB0aW5nIHRvIGluamVjdCBhbiB1bmtub3duIGlu
        amVjdGlvbjogYCcgKyBpbmplY3Rpb24uZnVsbE5hbWUgKyAnYCcpOwogICAg
        ICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIGhhc2g7CiAgICB9CgogICAg
        ZnVuY3Rpb24gb3B0aW9uKGNvbnRhaW5lciwgZnVsbE5hbWUsIG9wdGlvbk5h
        bWUpIHsKICAgICAgdmFyIG9wdGlvbnMgPSBjb250YWluZXIuX29wdGlvbnMu
        Z2V0KGZ1bGxOYW1lKTsKCiAgICAgIGlmIChvcHRpb25zICYmIG9wdGlvbnNb
        b3B0aW9uTmFtZV0gIT09IHVuZGVmaW5lZCkgewogICAgICAgIHJldHVybiBv
        cHRpb25zW29wdGlvbk5hbWVdOwogICAgICB9CgogICAgICB2YXIgdHlwZSA9
        IGZ1bGxOYW1lLnNwbGl0KCI6IilbMF07CiAgICAgIG9wdGlvbnMgPSBjb250
        YWluZXIuX3R5cGVPcHRpb25zLmdldCh0eXBlKTsKCiAgICAgIGlmIChvcHRp
        b25zKSB7CiAgICAgICAgcmV0dXJuIG9wdGlvbnNbb3B0aW9uTmFtZV07CiAg
        ICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiBmYWN0b3J5Rm9yKGNvbnRhaW5l
        ciwgZnVsbE5hbWUpIHsKICAgICAgdmFyIG5hbWUgPSBjb250YWluZXIubm9y
        bWFsaXplKGZ1bGxOYW1lKTsKICAgICAgdmFyIGZhY3RvcnkgPSBjb250YWlu
        ZXIucmVzb2x2ZShuYW1lKTsKICAgICAgdmFyIGluamVjdGVkRmFjdG9yeTsK
        ICAgICAgdmFyIGNhY2hlID0gY29udGFpbmVyLmZhY3RvcnlDYWNoZTsKICAg
        ICAgdmFyIHR5cGUgPSBmdWxsTmFtZS5zcGxpdCgiOiIpWzBdOwoKICAgICAg
        aWYgKGZhY3RvcnkgPT09IHVuZGVmaW5lZCkgeyByZXR1cm47IH0KCiAgICAg
        IGlmIChjYWNoZS5oYXMoZnVsbE5hbWUpKSB7CiAgICAgICAgcmV0dXJuIGNh
        Y2hlLmdldChmdWxsTmFtZSk7CiAgICAgIH0KCiAgICAgIGlmICghZmFjdG9y
        eSB8fCB0eXBlb2YgZmFjdG9yeS5leHRlbmQgIT09ICdmdW5jdGlvbicgfHwg
        KCFFbWJlci5NT0RFTF9GQUNUT1JZX0lOSkVDVElPTlMgJiYgdHlwZSA9PT0g
        J21vZGVsJykpIHsKICAgICAgICAvLyBUT0RPOiB0aGluayBhYm91dCBhICdz
        YWZlJyBtZXJnZSBzdHlsZSBleHRlbnNpb24KICAgICAgICAvLyBmb3Igbm93
        IGp1c3QgZmFsbGJhY2sgdG8gY3JlYXRlIHRpbWUgaW5qZWN0aW9uCiAgICAg
        ICAgcmV0dXJuIGZhY3Rvcnk7CiAgICAgIH0gZWxzZSB7CgogICAgICAgIHZh
        ciBpbmplY3Rpb25zICAgICAgICA9IGluamVjdGlvbnNGb3IoY29udGFpbmVy
        LCBmdWxsTmFtZSk7CiAgICAgICAgdmFyIGZhY3RvcnlJbmplY3Rpb25zID0g
        ZmFjdG9yeUluamVjdGlvbnNGb3IoY29udGFpbmVyLCBmdWxsTmFtZSk7Cgog
        ICAgICAgIGZhY3RvcnlJbmplY3Rpb25zLl90b1N0cmluZyA9IGNvbnRhaW5l
        ci5tYWtlVG9TdHJpbmcoZmFjdG9yeSwgZnVsbE5hbWUpOwoKICAgICAgICBp
        bmplY3RlZEZhY3RvcnkgPSBmYWN0b3J5LmV4dGVuZChpbmplY3Rpb25zKTsK
        ICAgICAgICBpbmplY3RlZEZhY3RvcnkucmVvcGVuQ2xhc3MoZmFjdG9yeUlu
        amVjdGlvbnMpOwoKICAgICAgICBjYWNoZS5zZXQoZnVsbE5hbWUsIGluamVj
        dGVkRmFjdG9yeSk7CgogICAgICAgIHJldHVybiBpbmplY3RlZEZhY3Rvcnk7
        CiAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiBpbmplY3Rpb25zRm9yKGNv
        bnRhaW5lciAsZnVsbE5hbWUpIHsKICAgICAgdmFyIHNwbGl0TmFtZSA9IGZ1
        bGxOYW1lLnNwbGl0KCI6IiksCiAgICAgICAgdHlwZSA9IHNwbGl0TmFtZVsw
        XSwKICAgICAgICBpbmplY3Rpb25zID0gW107CgogICAgICBpbmplY3Rpb25z
        ID0gaW5qZWN0aW9ucy5jb25jYXQoY29udGFpbmVyLnR5cGVJbmplY3Rpb25z
        LmdldCh0eXBlKSB8fCBbXSk7CiAgICAgIGluamVjdGlvbnMgPSBpbmplY3Rp
        b25zLmNvbmNhdChjb250YWluZXIuaW5qZWN0aW9uc1tmdWxsTmFtZV0gfHwg
        W10pOwoKICAgICAgaW5qZWN0aW9ucyA9IGJ1aWxkSW5qZWN0aW9ucyhjb250
        YWluZXIsIGluamVjdGlvbnMpOwogICAgICBpbmplY3Rpb25zLl9kZWJ1Z0Nv
        bnRhaW5lcktleSA9IGZ1bGxOYW1lOwogICAgICBpbmplY3Rpb25zLmNvbnRh
        aW5lciA9IGNvbnRhaW5lcjsKCiAgICAgIHJldHVybiBpbmplY3Rpb25zOwog
        ICAgfQoKICAgIGZ1bmN0aW9uIGZhY3RvcnlJbmplY3Rpb25zRm9yKGNvbnRh
        aW5lciwgZnVsbE5hbWUpIHsKICAgICAgdmFyIHNwbGl0TmFtZSA9IGZ1bGxO
        YW1lLnNwbGl0KCI6IiksCiAgICAgICAgdHlwZSA9IHNwbGl0TmFtZVswXSwK
        ICAgICAgICBmYWN0b3J5SW5qZWN0aW9ucyA9IFtdOwoKICAgICAgZmFjdG9y
        eUluamVjdGlvbnMgPSBmYWN0b3J5SW5qZWN0aW9ucy5jb25jYXQoY29udGFp
        bmVyLmZhY3RvcnlUeXBlSW5qZWN0aW9ucy5nZXQodHlwZSkgfHwgW10pOwog
        ICAgICBmYWN0b3J5SW5qZWN0aW9ucyA9IGZhY3RvcnlJbmplY3Rpb25zLmNv
        bmNhdChjb250YWluZXIuZmFjdG9yeUluamVjdGlvbnNbZnVsbE5hbWVdIHx8
        IFtdKTsKCiAgICAgIGZhY3RvcnlJbmplY3Rpb25zID0gYnVpbGRJbmplY3Rp
        b25zKGNvbnRhaW5lciwgZmFjdG9yeUluamVjdGlvbnMpOwogICAgICBmYWN0
        b3J5SW5qZWN0aW9ucy5fZGVidWdDb250YWluZXJLZXkgPSBmdWxsTmFtZTsK
        CiAgICAgIHJldHVybiBmYWN0b3J5SW5qZWN0aW9uczsKICAgIH0KCiAgICBm
        dW5jdGlvbiBpbnN0YW50aWF0ZShjb250YWluZXIsIGZ1bGxOYW1lKSB7CiAg
        ICAgIHZhciBmYWN0b3J5ID0gZmFjdG9yeUZvcihjb250YWluZXIsIGZ1bGxO
        YW1lKTsKCiAgICAgIGlmIChvcHRpb24oY29udGFpbmVyLCBmdWxsTmFtZSwg
        J2luc3RhbnRpYXRlJykgPT09IGZhbHNlKSB7CiAgICAgICAgcmV0dXJuIGZh
        Y3Rvcnk7CiAgICAgIH0KCiAgICAgIGlmIChmYWN0b3J5KSB7CiAgICAgICAg
        aWYgKHR5cGVvZiBmYWN0b3J5LmV4dGVuZCA9PT0gJ2Z1bmN0aW9uJykgewog
        ICAgICAgICAgLy8gYXNzdW1lIHRoZSBmYWN0b3J5IHdhcyBleHRlbmRhYmxl
        IGFuZCBpcyBhbHJlYWR5IGluamVjdGVkCiAgICAgICAgICByZXR1cm4gZmFj
        dG9yeS5jcmVhdGUoKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgLy8g
        YXNzdW1lIHRoZSBmYWN0b3J5IHdhcyBleHRlbmRhYmxlCiAgICAgICAgICAv
        LyB0byBjcmVhdGUgdGltZSBpbmplY3Rpb25zCiAgICAgICAgICAvLyBUT0RP
        OiBzdXBwb3J0IG5ldydpbmcgZm9yIGluc3RhbnRpYXRpb24gYW5kIG1lcmdl
        IGluamVjdGlvbnMgZm9yIHB1cmUgSlMgRnVuY3Rpb25zCiAgICAgICAgICBy
        ZXR1cm4gZmFjdG9yeS5jcmVhdGUoaW5qZWN0aW9uc0Zvcihjb250YWluZXIs
        IGZ1bGxOYW1lKSk7CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgZnVu
        Y3Rpb24gZWFjaERlc3Ryb3lhYmxlKGNvbnRhaW5lciwgY2FsbGJhY2spIHsK
        ICAgICAgY29udGFpbmVyLmNhY2hlLmVhY2hMb2NhbChmdW5jdGlvbihrZXks
        IHZhbHVlKSB7CiAgICAgICAgaWYgKG9wdGlvbihjb250YWluZXIsIGtleSwg
        J2luc3RhbnRpYXRlJykgPT09IGZhbHNlKSB7IHJldHVybjsgfQogICAgICAg
        IGNhbGxiYWNrKHZhbHVlKTsKICAgICAgfSk7CiAgICB9CgogICAgZnVuY3Rp
        b24gcmVzZXRDYWNoZShjb250YWluZXIpIHsKICAgICAgY29udGFpbmVyLmNh
        Y2hlLmVhY2hMb2NhbChmdW5jdGlvbihrZXksIHZhbHVlKSB7CiAgICAgICAg
        aWYgKG9wdGlvbihjb250YWluZXIsIGtleSwgJ2luc3RhbnRpYXRlJykgPT09
        IGZhbHNlKSB7IHJldHVybjsgfQogICAgICAgIHZhbHVlLmRlc3Ryb3koKTsK
        ICAgICAgfSk7CiAgICAgIGNvbnRhaW5lci5jYWNoZS5kaWN0ID0ge307CiAg
        ICB9CgogICAgZnVuY3Rpb24gYWRkVHlwZUluamVjdGlvbihydWxlcywgdHlw
        ZSwgcHJvcGVydHksIGZ1bGxOYW1lKSB7CiAgICAgIHZhciBpbmplY3Rpb25z
        ID0gcnVsZXMuZ2V0KHR5cGUpOwoKICAgICAgaWYgKCFpbmplY3Rpb25zKSB7
        CiAgICAgICAgaW5qZWN0aW9ucyA9IFtdOwogICAgICAgIHJ1bGVzLnNldCh0
        eXBlLCBpbmplY3Rpb25zKTsKICAgICAgfQoKICAgICAgaW5qZWN0aW9ucy5w
        dXNoKHsKICAgICAgICBwcm9wZXJ0eTogcHJvcGVydHksCiAgICAgICAgZnVs
        bE5hbWU6IGZ1bGxOYW1lCiAgICAgIH0pOwogICAgfQoKICAgIGZ1bmN0aW9u
        IGFkZEluamVjdGlvbihydWxlcywgZmFjdG9yeU5hbWUsIHByb3BlcnR5LCBp
        bmplY3Rpb25OYW1lKSB7CiAgICAgIHZhciBpbmplY3Rpb25zID0gcnVsZXNb
        ZmFjdG9yeU5hbWVdID0gcnVsZXNbZmFjdG9yeU5hbWVdIHx8IFtdOwogICAg
        ICBpbmplY3Rpb25zLnB1c2goeyBwcm9wZXJ0eTogcHJvcGVydHksIGZ1bGxO
        YW1lOiBpbmplY3Rpb25OYW1lIH0pOwogICAgfQoKICAgIHJldHVybiBDb250
        YWluZXI7Cn0pOwoKfSkoKTsKCihmdW5jdGlvbigpIHsKLypnbG9iYWxzIEVO
        ViAqLwovKioKQG1vZHVsZSBlbWJlcgpAc3VibW9kdWxlIGVtYmVyLXJ1bnRp
        bWUKKi8KCnZhciBpbmRleE9mID0gRW1iZXIuRW51bWVyYWJsZVV0aWxzLmlu
        ZGV4T2Y7CgovKioKIFRoaXMgd2lsbCBjb21wYXJlIHR3byBqYXZhc2NyaXB0
        IHZhbHVlcyBvZiBwb3NzaWJseSBkaWZmZXJlbnQgdHlwZXMuCiBJdCB3aWxs
        IHRlbGwgeW91IHdoaWNoIG9uZSBpcyBncmVhdGVyIHRoYW4gdGhlIG90aGVy
        IGJ5IHJldHVybmluZzoKCiAgLSAtMSBpZiB0aGUgZmlyc3QgaXMgc21hbGxl
        ciB0aGFuIHRoZSBzZWNvbmQsCiAgLSAwIGlmIGJvdGggYXJlIGVxdWFsLAog
        IC0gMSBpZiB0aGUgZmlyc3QgaXMgZ3JlYXRlciB0aGFuIHRoZSBzZWNvbmQu
        CgogVGhlIG9yZGVyIGlzIGNhbGN1bGF0ZWQgYmFzZWQgb24gYEVtYmVyLk9S
        REVSX0RFRklOSVRJT05gLCBpZiB0eXBlcyBhcmUgZGlmZmVyZW50LgogSW4g
        Y2FzZSB0aGV5IGhhdmUgdGhlIHNhbWUgdHlwZSBhbiBhcHByb3ByaWF0ZSBj
        b21wYXJpc29uIGZvciB0aGlzIHR5cGUgaXMgbWFkZS4KCiAgYGBgamF2YXNj
        cmlwdAogIEVtYmVyLmNvbXBhcmUoJ2hlbGxvJywgJ2hlbGxvJyk7ICAvLyAw
        CiAgRW1iZXIuY29tcGFyZSgnYWJjJywgJ2RmZycpOyAgICAgIC8vIC0xCiAg
        RW1iZXIuY29tcGFyZSgyLCAxKTsgICAgICAgICAgICAgIC8vIDEKICBgYGAK
        CiBAbWV0aG9kIGNvbXBhcmUKIEBmb3IgRW1iZXIKIEBwYXJhbSB7T2JqZWN0
        fSB2IEZpcnN0IHZhbHVlIHRvIGNvbXBhcmUKIEBwYXJhbSB7T2JqZWN0fSB3
        IFNlY29uZCB2YWx1ZSB0byBjb21wYXJlCiBAcmV0dXJuIHtOdW1iZXJ9IC0x
        IGlmIHYgPCB3LCAwIGlmIHYgPSB3IGFuZCAxIGlmIHYgPiB3LgoqLwpFbWJl
        ci5jb21wYXJlID0gZnVuY3Rpb24gY29tcGFyZSh2LCB3KSB7CiAgaWYgKHYg
        PT09IHcpIHsgcmV0dXJuIDA7IH0KCiAgdmFyIHR5cGUxID0gRW1iZXIudHlw
        ZU9mKHYpOwogIHZhciB0eXBlMiA9IEVtYmVyLnR5cGVPZih3KTsKCiAgdmFy
        IENvbXBhcmFibGUgPSBFbWJlci5Db21wYXJhYmxlOwogIGlmIChDb21wYXJh
        YmxlKSB7CiAgICBpZiAodHlwZTE9PT0naW5zdGFuY2UnICYmIENvbXBhcmFi
        bGUuZGV0ZWN0KHYuY29uc3RydWN0b3IpKSB7CiAgICAgIHJldHVybiB2LmNv
        bnN0cnVjdG9yLmNvbXBhcmUodiwgdyk7CiAgICB9CgogICAgaWYgKHR5cGUy
        ID09PSAnaW5zdGFuY2UnICYmIENvbXBhcmFibGUuZGV0ZWN0KHcuY29uc3Ry
        dWN0b3IpKSB7CiAgICAgIHJldHVybiAxLXcuY29uc3RydWN0b3IuY29tcGFy
        ZSh3LCB2KTsKICAgIH0KICB9CgogIC8vIElmIHdlIGhhdmVuJ3QgeWV0IGdl
        bmVyYXRlZCBhIHJldmVyc2UtbWFwcGluZyBvZiBFbWJlci5PUkRFUl9ERUZJ
        TklUSU9OLAogIC8vIGRvIHNvIG5vdy4KICB2YXIgbWFwcGluZyA9IEVtYmVy
        Lk9SREVSX0RFRklOSVRJT05fTUFQUElORzsKICBpZiAoIW1hcHBpbmcpIHsK
        ICAgIHZhciBvcmRlciA9IEVtYmVyLk9SREVSX0RFRklOSVRJT047CiAgICBt
        YXBwaW5nID0gRW1iZXIuT1JERVJfREVGSU5JVElPTl9NQVBQSU5HID0ge307
        CiAgICB2YXIgaWR4LCBsZW47CiAgICBmb3IgKGlkeCA9IDAsIGxlbiA9IG9y
        ZGVyLmxlbmd0aDsgaWR4IDwgbGVuOyAgKytpZHgpIHsKICAgICAgbWFwcGlu
        Z1tvcmRlcltpZHhdXSA9IGlkeDsKICAgIH0KCiAgICAvLyBXZSBubyBsb25n
        ZXIgbmVlZCBFbWJlci5PUkRFUl9ERUZJTklUSU9OLgogICAgZGVsZXRlIEVt
        YmVyLk9SREVSX0RFRklOSVRJT047CiAgfQoKICB2YXIgdHlwZTFJbmRleCA9
        IG1hcHBpbmdbdHlwZTFdOwogIHZhciB0eXBlMkluZGV4ID0gbWFwcGluZ1t0
        eXBlMl07CgogIGlmICh0eXBlMUluZGV4IDwgdHlwZTJJbmRleCkgeyByZXR1
        cm4gLTE7IH0KICBpZiAodHlwZTFJbmRleCA+IHR5cGUySW5kZXgpIHsgcmV0
        dXJuIDE7IH0KCiAgLy8gdHlwZXMgYXJlIGVxdWFsIC0gc28gd2UgaGF2ZSB0
        byBjaGVjayB2YWx1ZXMgbm93CiAgc3dpdGNoICh0eXBlMSkgewogICAgY2Fz
        ZSAnYm9vbGVhbic6CiAgICBjYXNlICdudW1iZXInOgogICAgICBpZiAodiA8
        IHcpIHsgcmV0dXJuIC0xOyB9CiAgICAgIGlmICh2ID4gdykgeyByZXR1cm4g
        MTsgfQogICAgICByZXR1cm4gMDsKCiAgICBjYXNlICdzdHJpbmcnOgogICAg
        ICB2YXIgY29tcCA9IHYubG9jYWxlQ29tcGFyZSh3KTsKICAgICAgaWYgKGNv
        bXAgPCAwKSB7IHJldHVybiAtMTsgfQogICAgICBpZiAoY29tcCA+IDApIHsg
        cmV0dXJuIDE7IH0KICAgICAgcmV0dXJuIDA7CgogICAgY2FzZSAnYXJyYXkn
        OgogICAgICB2YXIgdkxlbiA9IHYubGVuZ3RoOwogICAgICB2YXIgd0xlbiA9
        IHcubGVuZ3RoOwogICAgICB2YXIgbCA9IE1hdGgubWluKHZMZW4sIHdMZW4p
        OwogICAgICB2YXIgciA9IDA7CiAgICAgIHZhciBpID0gMDsKICAgICAgd2hp
        bGUgKHIgPT09IDAgJiYgaSA8IGwpIHsKICAgICAgICByID0gY29tcGFyZSh2
        W2ldLHdbaV0pOwogICAgICAgIGkrKzsKICAgICAgfQogICAgICBpZiAociAh
        PT0gMCkgeyByZXR1cm4gcjsgfQoKICAgICAgLy8gYWxsIGVsZW1lbnRzIGFy
        ZSBlcXVhbCBub3cKICAgICAgLy8gc2hvcnRlciBhcnJheSBzaG91bGQgYmUg
        b3JkZXJlZCBmaXJzdAogICAgICBpZiAodkxlbiA8IHdMZW4pIHsgcmV0dXJu
        IC0xOyB9CiAgICAgIGlmICh2TGVuID4gd0xlbikgeyByZXR1cm4gMTsgfQog
        ICAgICAvLyBhcnJheXMgYXJlIGVxdWFsIG5vdwogICAgICByZXR1cm4gMDsK
        CiAgICBjYXNlICdpbnN0YW5jZSc6CiAgICAgIGlmIChFbWJlci5Db21wYXJh
        YmxlICYmIEVtYmVyLkNvbXBhcmFibGUuZGV0ZWN0KHYpKSB7CiAgICAgICAg
        cmV0dXJuIHYuY29tcGFyZSh2LCB3KTsKICAgICAgfQogICAgICByZXR1cm4g
        MDsKCiAgICBjYXNlICdkYXRlJzoKICAgICAgdmFyIHZOdW0gPSB2LmdldFRp
        bWUoKTsKICAgICAgdmFyIHdOdW0gPSB3LmdldFRpbWUoKTsKICAgICAgaWYg
        KHZOdW0gPCB3TnVtKSB7IHJldHVybiAtMTsgfQogICAgICBpZiAodk51bSA+
        IHdOdW0pIHsgcmV0dXJuIDE7IH0KICAgICAgcmV0dXJuIDA7CgogICAgZGVm
        YXVsdDoKICAgICAgcmV0dXJuIDA7CiAgfQp9OwoKZnVuY3Rpb24gX2NvcHko
        b2JqLCBkZWVwLCBzZWVuLCBjb3BpZXMpIHsKICB2YXIgcmV0LCBsb2MsIGtl
        eTsKCiAgLy8gcHJpbWl0aXZlIGRhdGEgdHlwZXMgYXJlIGltbXV0YWJsZSwg
        anVzdCByZXR1cm4gdGhlbS4KICBpZiAoJ29iamVjdCcgIT09IHR5cGVvZiBv
        YmogfHwgb2JqPT09bnVsbCkgcmV0dXJuIG9iajsKCiAgLy8gYXZvaWQgY3lj
        bGljYWwgbG9vcHMKICBpZiAoZGVlcCAmJiAobG9jPWluZGV4T2Yoc2Vlbiwg
        b2JqKSk+PTApIHJldHVybiBjb3BpZXNbbG9jXTsKCiAgRW1iZXIuYXNzZXJ0
        KCdDYW5ub3QgY2xvbmUgYW4gRW1iZXIuT2JqZWN0IHRoYXQgZG9lcyBub3Qg
        aW1wbGVtZW50IEVtYmVyLkNvcHlhYmxlJywgIShvYmogaW5zdGFuY2VvZiBF
        bWJlci5PYmplY3QpIHx8IChFbWJlci5Db3B5YWJsZSAmJiBFbWJlci5Db3B5
        YWJsZS5kZXRlY3Qob2JqKSkpOwoKICAvLyBJTVBPUlRBTlQ6IHRoaXMgc3Bl
        Y2lmaWMgdGVzdCB3aWxsIGRldGVjdCBhIG5hdGl2ZSBhcnJheSBvbmx5LiBB
        bnkgb3RoZXIKICAvLyBvYmplY3Qgd2lsbCBuZWVkIHRvIGltcGxlbWVudCBD
        b3B5YWJsZS4KICBpZiAoRW1iZXIudHlwZU9mKG9iaikgPT09ICdhcnJheScp
        IHsKICAgIHJldCA9IG9iai5zbGljZSgpOwogICAgaWYgKGRlZXApIHsKICAg
        ICAgbG9jID0gcmV0Lmxlbmd0aDsKICAgICAgd2hpbGUoLS1sb2M+PTApIHJl
        dFtsb2NdID0gX2NvcHkocmV0W2xvY10sIGRlZXAsIHNlZW4sIGNvcGllcyk7
        CiAgICB9CiAgfSBlbHNlIGlmIChFbWJlci5Db3B5YWJsZSAmJiBFbWJlci5D
        b3B5YWJsZS5kZXRlY3Qob2JqKSkgewogICAgcmV0ID0gb2JqLmNvcHkoZGVl
        cCwgc2VlbiwgY29waWVzKTsKICB9IGVsc2UgewogICAgcmV0ID0ge307CiAg
        ICBmb3Ioa2V5IGluIG9iaikgewogICAgICBpZiAoIW9iai5oYXNPd25Qcm9w
        ZXJ0eShrZXkpKSBjb250aW51ZTsKCiAgICAgIC8vIFByZXZlbnRzIGJyb3dz
        ZXJzIHRoYXQgZG9uJ3QgcmVzcGVjdCBub24tZW51bWVyYWJpbGl0eSBmcm9t
        CiAgICAgIC8vIGNvcHlpbmcgaW50ZXJuYWwgRW1iZXIgcHJvcGVydGllcwog
        ICAgICBpZiAoa2V5LnN1YnN0cmluZygwLDIpID09PSAnX18nKSBjb250aW51
        ZTsKCiAgICAgIHJldFtrZXldID0gZGVlcCA/IF9jb3B5KG9ialtrZXldLCBk
        ZWVwLCBzZWVuLCBjb3BpZXMpIDogb2JqW2tleV07CiAgICB9CiAgfQoKICBp
        ZiAoZGVlcCkgewogICAgc2Vlbi5wdXNoKG9iaik7CiAgICBjb3BpZXMucHVz
        aChyZXQpOwogIH0KCiAgcmV0dXJuIHJldDsKfQoKLyoqCiAgQ3JlYXRlcyBh
        IGNsb25lIG9mIHRoZSBwYXNzZWQgb2JqZWN0LiBUaGlzIGZ1bmN0aW9uIGNh
        biB0YWtlIGp1c3QgYWJvdXQKICBhbnkgdHlwZSBvZiBvYmplY3QgYW5kIGNy
        ZWF0ZSBhIGNsb25lIG9mIGl0LCBpbmNsdWRpbmcgcHJpbWl0aXZlIHZhbHVl
        cwogICh3aGljaCBhcmUgbm90IGFjdHVhbGx5IGNsb25lZCBiZWNhdXNlIHRo
        ZXkgYXJlIGltbXV0YWJsZSkuCgogIElmIHRoZSBwYXNzZWQgb2JqZWN0IGlt
        cGxlbWVudHMgdGhlIGBjbG9uZSgpYCBtZXRob2QsIHRoZW4gdGhpcyBmdW5j
        dGlvbgogIHdpbGwgc2ltcGx5IGNhbGwgdGhhdCBtZXRob2QgYW5kIHJldHVy
        biB0aGUgcmVzdWx0LgoKICBAbWV0aG9kIGNvcHkKICBAZm9yIEVtYmVyCiAg
        QHBhcmFtIHtPYmplY3R9IG9iaiBUaGUgb2JqZWN0IHRvIGNsb25lCiAgQHBh
        cmFtIHtCb29sZWFufSBkZWVwIElmIHRydWUsIGEgZGVlcCBjb3B5IG9mIHRo
        ZSBvYmplY3QgaXMgbWFkZQogIEByZXR1cm4ge09iamVjdH0gVGhlIGNsb25l
        ZCBvYmplY3QKKi8KRW1iZXIuY29weSA9IGZ1bmN0aW9uKG9iaiwgZGVlcCkg
        ewogIC8vIGZhc3QgcGF0aHMKICBpZiAoJ29iamVjdCcgIT09IHR5cGVvZiBv
        YmogfHwgb2JqPT09bnVsbCkgcmV0dXJuIG9iajsgLy8gY2FuJ3QgY29weSBw
        cmltaXRpdmVzCiAgaWYgKEVtYmVyLkNvcHlhYmxlICYmIEVtYmVyLkNvcHlh
        YmxlLmRldGVjdChvYmopKSByZXR1cm4gb2JqLmNvcHkoZGVlcCk7CiAgcmV0
        dXJuIF9jb3B5KG9iaiwgZGVlcCwgZGVlcCA/IFtdIDogbnVsbCwgZGVlcCA/
        IFtdIDogbnVsbCk7Cn07CgovKioKICBDb252ZW5pZW5jZSBtZXRob2QgdG8g
        aW5zcGVjdCBhbiBvYmplY3QuIFRoaXMgbWV0aG9kIHdpbGwgYXR0ZW1wdCB0
        bwogIGNvbnZlcnQgdGhlIG9iamVjdCBpbnRvIGEgdXNlZnVsIHN0cmluZyBk
        ZXNjcmlwdGlvbi4KCiAgSXQgaXMgYSBwcmV0dHkgc2ltcGxlIGltcGxlbWVu
        dGF0aW9uLiBJZiB5b3Ugd2FudCBzb21ldGhpbmcgbW9yZSByb2J1c3QsCiAg
        dXNlIHNvbWV0aGluZyBsaWtlIEpTRHVtcDogaHR0cHM6Ly9naXRodWIuY29t
        L05WL2pzRHVtcAoKICBAbWV0aG9kIGluc3BlY3QKICBAZm9yIEVtYmVyCiAg
        QHBhcmFtIHtPYmplY3R9IG9iaiBUaGUgb2JqZWN0IHlvdSB3YW50IHRvIGlu
        c3BlY3QuCiAgQHJldHVybiB7U3RyaW5nfSBBIGRlc2NyaXB0aW9uIG9mIHRo
        ZSBvYmplY3QKKi8KRW1iZXIuaW5zcGVjdCA9IGZ1bmN0aW9uKG9iaikgewog
        IHZhciB0eXBlID0gRW1iZXIudHlwZU9mKG9iaik7CiAgaWYgKHR5cGUgPT09
        ICdhcnJheScpIHsKICAgIHJldHVybiAnWycgKyBvYmogKyAnXSc7CiAgfQog
        IGlmICh0eXBlICE9PSAnb2JqZWN0JykgewogICAgcmV0dXJuIG9iaiArICcn
        OwogIH0KCiAgdmFyIHYsIHJldCA9IFtdOwogIGZvcih2YXIga2V5IGluIG9i
        aikgewogICAgaWYgKG9iai5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7CiAgICAg
        IHYgPSBvYmpba2V5XTsKICAgICAgaWYgKHYgPT09ICd0b1N0cmluZycpIHsg
        Y29udGludWU7IH0gLy8gaWdub3JlIHVzZWxlc3MgaXRlbXMKICAgICAgaWYg
        KEVtYmVyLnR5cGVPZih2KSA9PT0gJ2Z1bmN0aW9uJykgeyB2ID0gImZ1bmN0
        aW9uKCkgeyAuLi4gfSI7IH0KICAgICAgcmV0LnB1c2goa2V5ICsgIjogIiAr
        IHYpOwogICAgfQogIH0KICByZXR1cm4gInsiICsgcmV0LmpvaW4oIiwgIikg
        KyAifSI7Cn07CgovKioKICBDb21wYXJlcyB0d28gb2JqZWN0cywgcmV0dXJu
        aW5nIHRydWUgaWYgdGhleSBhcmUgbG9naWNhbGx5IGVxdWFsLiBUaGlzIGlz
        CiAgYSBkZWVwZXIgY29tcGFyaXNvbiB0aGFuIGEgc2ltcGxlIHRyaXBsZSBl
        cXVhbC4gRm9yIHNldHMgaXQgd2lsbCBjb21wYXJlIHRoZQogIGludGVybmFs
        IG9iamVjdHMuIEZvciBhbnkgb3RoZXIgb2JqZWN0IHRoYXQgaW1wbGVtZW50
        cyBgaXNFcXVhbCgpYCBpdCB3aWxsCiAgcmVzcGVjdCB0aGF0IG1ldGhvZC4K
        CiAgYGBgamF2YXNjcmlwdAogIEVtYmVyLmlzRXF1YWwoJ2hlbGxvJywgJ2hl
        bGxvJyk7ICAvLyB0cnVlCiAgRW1iZXIuaXNFcXVhbCgxLCAyKTsgICAgICAg
        ICAgICAgIC8vIGZhbHNlCiAgRW1iZXIuaXNFcXVhbChbNCwyXSwgWzQsMl0p
        OyAgICAgIC8vIGZhbHNlCiAgYGBgCgogIEBtZXRob2QgaXNFcXVhbAogIEBm
        b3IgRW1iZXIKICBAcGFyYW0ge09iamVjdH0gYSBmaXJzdCBvYmplY3QgdG8g
        Y29tcGFyZQogIEBwYXJhbSB7T2JqZWN0fSBiIHNlY29uZCBvYmplY3QgdG8g
        Y29tcGFyZQogIEByZXR1cm4ge0Jvb2xlYW59CiovCkVtYmVyLmlzRXF1YWwg
        PSBmdW5jdGlvbihhLCBiKSB7CiAgaWYgKGEgJiYgJ2Z1bmN0aW9uJz09PXR5
        cGVvZiBhLmlzRXF1YWwpIHJldHVybiBhLmlzRXF1YWwoYik7CiAgcmV0dXJu
        IGEgPT09IGI7Cn07CgovLyBVc2VkIGJ5IEVtYmVyLmNvbXBhcmUKRW1iZXIu
        T1JERVJfREVGSU5JVElPTiA9IEVtYmVyLkVOVi5PUkRFUl9ERUZJTklUSU9O
        IHx8IFsKICAndW5kZWZpbmVkJywKICAnbnVsbCcsCiAgJ2Jvb2xlYW4nLAog
        ICdudW1iZXInLAogICdzdHJpbmcnLAogICdhcnJheScsCiAgJ29iamVjdCcs
        CiAgJ2luc3RhbmNlJywKICAnZnVuY3Rpb24nLAogICdjbGFzcycsCiAgJ2Rh
        dGUnCl07CgovKioKICBSZXR1cm5zIGFsbCBvZiB0aGUga2V5cyBkZWZpbmVk
        IG9uIGFuIG9iamVjdCBvciBoYXNoLiBUaGlzIGlzIHVzZWZ1bAogIHdoZW4g
        aW5zcGVjdGluZyBvYmplY3RzIGZvciBkZWJ1Z2dpbmcuIE9uIGJyb3dzZXJz
        IHRoYXQgc3VwcG9ydCBpdCwgdGhpcwogIHVzZXMgdGhlIG5hdGl2ZSBgT2Jq
        ZWN0LmtleXNgIGltcGxlbWVudGF0aW9uLgoKICBAbWV0aG9kIGtleXMKICBA
        Zm9yIEVtYmVyCiAgQHBhcmFtIHtPYmplY3R9IG9iagogIEByZXR1cm4ge0Fy
        cmF5fSBBcnJheSBjb250YWluaW5nIGtleXMgb2Ygb2JqCiovCkVtYmVyLmtl
        eXMgPSBPYmplY3Qua2V5czsKCmlmICghRW1iZXIua2V5cyB8fCBFbWJlci5j
        cmVhdGUuaXNTaW11bGF0ZWQpIHsKICB2YXIgcHJvdG90eXBlUHJvcGVydGll
        cyA9IFsKICAgICdjb25zdHJ1Y3RvcicsCiAgICAnaGFzT3duUHJvcGVydHkn
        LAogICAgJ2lzUHJvdG90eXBlT2YnLAogICAgJ3Byb3BlcnR5SXNFbnVtZXJh
        YmxlJywKICAgICd2YWx1ZU9mJywKICAgICd0b0xvY2FsZVN0cmluZycsCiAg
        ICAndG9TdHJpbmcnCiAgXSwKICBwdXNoUHJvcGVydHlOYW1lID0gZnVuY3Rp
        b24ob2JqLCBhcnJheSwga2V5KSB7CiAgICAvLyBQcmV2ZW50cyBicm93c2Vy
        cyB0aGF0IGRvbid0IHJlc3BlY3Qgbm9uLWVudW1lcmFiaWxpdHkgZnJvbQog
        ICAgLy8gY29weWluZyBpbnRlcm5hbCBFbWJlciBwcm9wZXJ0aWVzCiAgICBp
        ZiAoa2V5LnN1YnN0cmluZygwLDIpID09PSAnX18nKSByZXR1cm47CiAgICBp
        ZiAoa2V5ID09PSAnX3N1cGVyJykgcmV0dXJuOwogICAgaWYgKGluZGV4T2Yo
        YXJyYXksIGtleSkgPj0gMCkgcmV0dXJuOwogICAgaWYgKCFvYmouaGFzT3du
        UHJvcGVydHkoa2V5KSkgcmV0dXJuOwoKICAgIGFycmF5LnB1c2goa2V5KTsK
        ICB9OwoKICBFbWJlci5rZXlzID0gZnVuY3Rpb24ob2JqKSB7CiAgICB2YXIg
        cmV0ID0gW10sIGtleTsKICAgIGZvciAoa2V5IGluIG9iaikgewogICAgICBw
        dXNoUHJvcGVydHlOYW1lKG9iaiwgcmV0LCBrZXkpOwogICAgfQoKICAgIC8v
        IElFOCBkb2Vzbid0IGVudW1lcmF0ZSBwcm9wZXJ0eSB0aGF0IG5hbWVkIHRo
        ZSBzYW1lIGFzIHByb3RvdHlwZSBwcm9wZXJ0aWVzLgogICAgZm9yICh2YXIg
        aSA9IDAsIGwgPSBwcm90b3R5cGVQcm9wZXJ0aWVzLmxlbmd0aDsgaSA8IGw7
        IGkrKykgewogICAgICBrZXkgPSBwcm90b3R5cGVQcm9wZXJ0aWVzW2ldOwoK
        ICAgICAgcHVzaFByb3BlcnR5TmFtZShvYmosIHJldCwga2V5KTsKICAgIH0K
        CiAgICByZXR1cm4gcmV0OwogIH07Cn0KCi8vIC4uLi4uLi4uLi4uLi4uLi4u
        Li4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4KLy8g
        RVJST1IKLy8KCnZhciBlcnJvclByb3BzID0gWydkZXNjcmlwdGlvbicsICdm
        aWxlTmFtZScsICdsaW5lTnVtYmVyJywgJ21lc3NhZ2UnLCAnbmFtZScsICdu
        dW1iZXInLCAnc3RhY2snXTsKCi8qKgogIEEgc3ViY2xhc3Mgb2YgdGhlIEph
        dmFTY3JpcHQgRXJyb3Igb2JqZWN0IGZvciB1c2UgaW4gRW1iZXIuCgogIEBj
        bGFzcyBFcnJvcgogIEBuYW1lc3BhY2UgRW1iZXIKICBAZXh0ZW5kcyBFcnJv
        cgogIEBjb25zdHJ1Y3RvcgoqLwpFbWJlci5FcnJvciA9IGZ1bmN0aW9uKCkg
        ewogIHZhciB0bXAgPSBFcnJvci5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwoK
        ICAvLyBVbmZvcnR1bmF0ZWx5IGVycm9ycyBhcmUgbm90IGVudW1lcmFibGUg
        aW4gQ2hyb21lIChhdCBsZWFzdCksIHNvIGBmb3IgcHJvcCBpbiB0bXBgIGRv
        ZXNuJ3Qgd29yay4KICBmb3IgKHZhciBpZHggPSAwOyBpZHggPCBlcnJvclBy
        b3BzLmxlbmd0aDsgaWR4KyspIHsKICAgIHRoaXNbZXJyb3JQcm9wc1tpZHhd
        XSA9IHRtcFtlcnJvclByb3BzW2lkeF1dOwogIH0KfTsKCkVtYmVyLkVycm9y
        LnByb3RvdHlwZSA9IEVtYmVyLmNyZWF0ZShFcnJvci5wcm90b3R5cGUpOwoK
        fSkoKTsKCgoKKGZ1bmN0aW9uKCkgewovKioKQG1vZHVsZSBlbWJlcgpAc3Vi
        bW9kdWxlIGVtYmVyLXJ1bnRpbWUKKi8KCi8vIC4uLi4uLi4uLi4uLi4uLi4u
        Li4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4KLy8g
        SEVMUEVSUwovLwoKdmFyIGdldCA9IEVtYmVyLmdldCwgc2V0ID0gRW1iZXIu
        c2V0Owp2YXIgYV9zbGljZSA9IEFycmF5LnByb3RvdHlwZS5zbGljZTsKdmFy
        IGFfaW5kZXhPZiA9IEVtYmVyLkVudW1lcmFibGVVdGlscy5pbmRleE9mOwoK
        dmFyIGNvbnRleHRzID0gW107CgpmdW5jdGlvbiBwb3BDdHgoKSB7CiAgcmV0
        dXJuIGNvbnRleHRzLmxlbmd0aD09PTAgPyB7fSA6IGNvbnRleHRzLnBvcCgp
        Owp9CgpmdW5jdGlvbiBwdXNoQ3R4KGN0eCkgewogIGNvbnRleHRzLnB1c2go
        Y3R4KTsKICByZXR1cm4gbnVsbDsKfQoKZnVuY3Rpb24gaXRlcihrZXksIHZh
        bHVlKSB7CiAgdmFyIHZhbHVlUHJvdmlkZWQgPSBhcmd1bWVudHMubGVuZ3Ro
        ID09PSAyOwoKICBmdW5jdGlvbiBpKGl0ZW0pIHsKICAgIHZhciBjdXIgPSBn
        ZXQoaXRlbSwga2V5KTsKICAgIHJldHVybiB2YWx1ZVByb3ZpZGVkID8gdmFs
        dWU9PT1jdXIgOiAhIWN1cjsKICB9CiAgcmV0dXJuIGkgOwp9CgovKioKICBU
        aGlzIG1peGluIGRlZmluZXMgdGhlIGNvbW1vbiBpbnRlcmZhY2UgaW1wbGVt
        ZW50ZWQgYnkgZW51bWVyYWJsZSBvYmplY3RzCiAgaW4gRW1iZXIuIE1vc3Qg
        b2YgdGhlc2UgbWV0aG9kcyBmb2xsb3cgdGhlIHN0YW5kYXJkIEFycmF5IGl0
        ZXJhdGlvbgogIEFQSSBkZWZpbmVkIHVwIHRvIEphdmFTY3JpcHQgMS44IChl
        eGNsdWRpbmcgbGFuZ3VhZ2Utc3BlY2lmaWMgZmVhdHVyZXMgdGhhdAogIGNh
        bm5vdCBiZSBlbXVsYXRlZCBpbiBvbGRlciB2ZXJzaW9ucyBvZiBKYXZhU2Ny
        aXB0KS4KCiAgVGhpcyBtaXhpbiBpcyBhcHBsaWVkIGF1dG9tYXRpY2FsbHkg
        dG8gdGhlIEFycmF5IGNsYXNzIG9uIHBhZ2UgbG9hZCwgc28geW91CiAgY2Fu
        IHVzZSBhbnkgb2YgdGhlc2UgbWV0aG9kcyBvbiBzaW1wbGUgYXJyYXlzLiBJ
        ZiBBcnJheSBhbHJlYWR5IGltcGxlbWVudHMKICBvbmUgb2YgdGhlc2UgbWV0
        aG9kcywgdGhlIG1peGluIHdpbGwgbm90IG92ZXJyaWRlIHRoZW0uCgogICMj
        IFdyaXRpbmcgWW91ciBPd24gRW51bWVyYWJsZQoKICBUbyBtYWtlIHlvdXIg
        b3duIGN1c3RvbSBjbGFzcyBlbnVtZXJhYmxlLCB5b3UgbmVlZCB0d28gaXRl
        bXM6CgogIDEuIFlvdSBtdXN0IGhhdmUgYSBsZW5ndGggcHJvcGVydHkuIFRo
        aXMgcHJvcGVydHkgc2hvdWxkIGNoYW5nZSB3aGVuZXZlcgogICAgIHRoZSBu
        dW1iZXIgb2YgaXRlbXMgaW4geW91ciBlbnVtZXJhYmxlIG9iamVjdCBjaGFu
        Z2VzLiBJZiB5b3UgdXNpbmcgdGhpcwogICAgIHdpdGggYW4gYEVtYmVyLk9i
        amVjdGAgc3ViY2xhc3MsIHlvdSBzaG91bGQgYmUgc3VyZSB0byBjaGFuZ2Ug
        dGhlIGxlbmd0aAogICAgIHByb3BlcnR5IHVzaW5nIGBzZXQoKS5gCgogIDIu
        IElmIHlvdSBtdXN0IGltcGxlbWVudCBgbmV4dE9iamVjdCgpLmAgU2VlIGRv
        Y3VtZW50YXRpb24uCgogIE9uY2UgeW91IGhhdmUgdGhlc2UgdHdvIG1ldGhv
        ZHMgaW1wbGVtZW50LCBhcHBseSB0aGUgYEVtYmVyLkVudW1lcmFibGVgIG1p
        eGluCiAgdG8geW91ciBjbGFzcyBhbmQgeW91IHdpbGwgYmUgYWJsZSB0byBl
        bnVtZXJhdGUgdGhlIGNvbnRlbnRzIG9mIHlvdXIgb2JqZWN0CiAgbGlrZSBh
        bnkgb3RoZXIgY29sbGVjdGlvbi4KCiAgIyMgVXNpbmcgRW1iZXIgRW51bWVy
        YXRpb24gd2l0aCBPdGhlciBMaWJyYXJpZXMKCiAgTWFueSBvdGhlciBsaWJy
        YXJpZXMgcHJvdmlkZSBzb21lIGtpbmQgb2YgaXRlcmF0b3Igb3IgZW51bWVy
        YXRpb24gbGlrZQogIGZhY2lsaXR5LiBUaGlzIGlzIG9mdGVuIHdoZXJlIHRo
        ZSBtb3N0IGNvbW1vbiBBUEkgY29uZmxpY3RzIG9jY3VyLgogIEVtYmVyJ3Mg
        QVBJIGlzIGRlc2lnbmVkIHRvIGJlIGFzIGZyaWVuZGx5IGFzIHBvc3NpYmxl
        IHdpdGggb3RoZXIKICBsaWJyYXJpZXMgYnkgaW1wbGVtZW50aW5nIG9ubHkg
        bWV0aG9kcyB0aGF0IG1vc3RseSBjb3JyZXNwb25kIHRvIHRoZQogIEphdmFT
        Y3JpcHQgMS44IEFQSS4KCiAgQGNsYXNzIEVudW1lcmFibGUKICBAbmFtZXNw
        YWNlIEVtYmVyCiAgQHNpbmNlIEVtYmVyIDAuOQoqLwpFbWJlci5FbnVtZXJh
        YmxlID0gRW1iZXIuTWl4aW4uY3JlYXRlKHsKCiAgLyoqCiAgICBJbXBsZW1l
        bnQgdGhpcyBtZXRob2QgdG8gbWFrZSB5b3VyIGNsYXNzIGVudW1lcmFibGUu
        CgogICAgVGhpcyBtZXRob2Qgd2lsbCBiZSBjYWxsIHJlcGVhdGVkbHkgZHVy
        aW5nIGVudW1lcmF0aW9uLiBUaGUgaW5kZXggdmFsdWUKICAgIHdpbGwgYWx3
        YXlzIGJlZ2luIHdpdGggMCBhbmQgaW5jcmVtZW50IG1vbm90b25pY2FsbHku
        IFlvdSBkb24ndCBoYXZlIHRvCiAgICByZWx5IG9uIHRoZSBpbmRleCB2YWx1
        ZSB0byBkZXRlcm1pbmUgd2hhdCBvYmplY3QgdG8gcmV0dXJuLCBidXQgeW91
        IHNob3VsZAogICAgYWx3YXlzIGNoZWNrIHRoZSB2YWx1ZSBhbmQgc3RhcnQg
        ZnJvbSB0aGUgYmVnaW5uaW5nIHdoZW4geW91IHNlZSB0aGUKICAgIHJlcXVl
        c3RlZCBpbmRleCBpcyAwLgoKICAgIFRoZSBgcHJldmlvdXNPYmplY3RgIGlz
        IHRoZSBvYmplY3QgdGhhdCB3YXMgcmV0dXJuZWQgZnJvbSB0aGUgbGFzdCBj
        YWxsCiAgICB0byBgbmV4dE9iamVjdGAgZm9yIHRoZSBjdXJyZW50IGl0ZXJh
        dGlvbi4gVGhpcyBpcyBhIHVzZWZ1bCB3YXkgdG8KICAgIG1hbmFnZSBpdGVy
        YXRpb24gaWYgeW91IGFyZSB0cmFjaW5nIGEgbGlua2VkIGxpc3QsIGZvciBl
        eGFtcGxlLgoKICAgIEZpbmFsbHkgdGhlIGNvbnRleHQgcGFyYW1ldGVyIHdp
        bGwgYWx3YXlzIGNvbnRhaW4gYSBoYXNoIHlvdSBjYW4gdXNlIGFzCiAgICBh
        ICJzY3JhdGNocGFkIiB0byBtYWludGFpbiBhbnkgb3RoZXIgc3RhdGUgeW91
        IG5lZWQgaW4gb3JkZXIgdG8gaXRlcmF0ZQogICAgcHJvcGVybHkuIFRoZSBj
        b250ZXh0IG9iamVjdCBpcyByZXVzZWQgYW5kIGlzIG5vdCByZXNldCBiZXR3
        ZWVuCiAgICBpdGVyYXRpb25zIHNvIG1ha2Ugc3VyZSB5b3Ugc2V0dXAgdGhl
        IGNvbnRleHQgd2l0aCBhIGZyZXNoIHN0YXRlIHdoZW5ldmVyCiAgICB0aGUg
        aW5kZXggcGFyYW1ldGVyIGlzIDAuCgogICAgR2VuZXJhbGx5IGl0ZXJhdG9y
        cyB3aWxsIGNvbnRpbnVlIHRvIGNhbGwgYG5leHRPYmplY3RgIHVudGlsIHRo
        ZSBpbmRleAogICAgcmVhY2hlcyB0aGUgeW91ciBjdXJyZW50IGxlbmd0aC0x
        LiBJZiB5b3UgcnVuIG91dCBvZiBkYXRhIGJlZm9yZSB0aGlzCiAgICB0aW1l
        IGZvciBzb21lIHJlYXNvbiwgeW91IHNob3VsZCBzaW1wbHkgcmV0dXJuIHVu
        ZGVmaW5lZC4KCiAgICBUaGUgZGVmYXVsdCBpbXBsZW1lbnRhdGlvbiBvZiB0
        aGlzIG1ldGhvZCBzaW1wbHkgbG9va3MgdXAgdGhlIGluZGV4LgogICAgVGhp
        cyB3b3JrcyBncmVhdCBvbiBhbnkgQXJyYXktbGlrZSBvYmplY3RzLgoKICAg
        IEBtZXRob2QgbmV4dE9iamVjdAogICAgQHBhcmFtIHtOdW1iZXJ9IGluZGV4
        IHRoZSBjdXJyZW50IGluZGV4IG9mIHRoZSBpdGVyYXRpb24KICAgIEBwYXJh
        bSB7T2JqZWN0fSBwcmV2aW91c09iamVjdCB0aGUgdmFsdWUgcmV0dXJuZWQg
        YnkgdGhlIGxhc3QgY2FsbCB0bwogICAgICBgbmV4dE9iamVjdGAuCiAgICBA
        cGFyYW0ge09iamVjdH0gY29udGV4dCBhIGNvbnRleHQgb2JqZWN0IHlvdSBj
        YW4gdXNlIHRvIG1haW50YWluIHN0YXRlLgogICAgQHJldHVybiB7T2JqZWN0
        fSB0aGUgbmV4dCBvYmplY3QgaW4gdGhlIGl0ZXJhdGlvbiBvciB1bmRlZmlu
        ZWQKICAqLwogIG5leHRPYmplY3Q6IEVtYmVyLnJlcXVpcmVkKEZ1bmN0aW9u
        KSwKCiAgLyoqCiAgICBIZWxwZXIgbWV0aG9kIHJldHVybnMgdGhlIGZpcnN0
        IG9iamVjdCBmcm9tIGEgY29sbGVjdGlvbi4gVGhpcyBpcyB1c3VhbGx5CiAg
        ICB1c2VkIGJ5IGJpbmRpbmdzIGFuZCBvdGhlciBwYXJ0cyBvZiB0aGUgZnJh
        bWV3b3JrIHRvIGV4dHJhY3QgYSBzaW5nbGUKICAgIG9iamVjdCBpZiB0aGUg
        ZW51bWVyYWJsZSBjb250YWlucyBvbmx5IG9uZSBpdGVtLgoKICAgIElmIHlv
        dSBvdmVycmlkZSB0aGlzIG1ldGhvZCwgeW91IHNob3VsZCBpbXBsZW1lbnQg
        aXQgc28gdGhhdCBpdCB3aWxsCiAgICBhbHdheXMgcmV0dXJuIHRoZSBzYW1l
        IHZhbHVlIGVhY2ggdGltZSBpdCBpcyBjYWxsZWQuIElmIHlvdXIgZW51bWVy
        YWJsZQogICAgY29udGFpbnMgb25seSBvbmUgb2JqZWN0LCB0aGlzIG1ldGhv
        ZCBzaG91bGQgYWx3YXlzIHJldHVybiB0aGF0IG9iamVjdC4KICAgIElmIHlv
        dXIgZW51bWVyYWJsZSBpcyBlbXB0eSwgdGhpcyBtZXRob2Qgc2hvdWxkIHJl
        dHVybiBgdW5kZWZpbmVkYC4KCiAgICBgYGBqYXZhc2NyaXB0CiAgICB2YXIg
        YXJyID0gWyJhIiwgImIiLCAiYyJdOwogICAgYXJyLmdldCgnZmlyc3RPYmpl
        Y3QnKTsgIC8vICJhIgoKICAgIHZhciBhcnIgPSBbXTsKICAgIGFyci5nZXQo
        J2ZpcnN0T2JqZWN0Jyk7ICAvLyB1bmRlZmluZWQKICAgIGBgYAoKICAgIEBw
        cm9wZXJ0eSBmaXJzdE9iamVjdAogICAgQHJldHVybiB7T2JqZWN0fSB0aGUg
        b2JqZWN0IG9yIHVuZGVmaW5lZAogICovCiAgZmlyc3RPYmplY3Q6IEVtYmVy
        LmNvbXB1dGVkKGZ1bmN0aW9uKCkgewogICAgaWYgKGdldCh0aGlzLCAnbGVu
        Z3RoJyk9PT0wKSByZXR1cm4gdW5kZWZpbmVkIDsKCiAgICAvLyBoYW5kbGUg
        Z2VuZXJpYyBlbnVtZXJhYmxlcwogICAgdmFyIGNvbnRleHQgPSBwb3BDdHgo
        KSwgcmV0OwogICAgcmV0ID0gdGhpcy5uZXh0T2JqZWN0KDAsIG51bGwsIGNv
        bnRleHQpOwogICAgcHVzaEN0eChjb250ZXh0KTsKICAgIHJldHVybiByZXQg
        OwogIH0pLnByb3BlcnR5KCdbXScpLAoKICAvKioKICAgIEhlbHBlciBtZXRo
        b2QgcmV0dXJucyB0aGUgbGFzdCBvYmplY3QgZnJvbSBhIGNvbGxlY3Rpb24u
        IElmIHlvdXIgZW51bWVyYWJsZQogICAgY29udGFpbnMgb25seSBvbmUgb2Jq
        ZWN0LCB0aGlzIG1ldGhvZCBzaG91bGQgYWx3YXlzIHJldHVybiB0aGF0IG9i
        amVjdC4KICAgIElmIHlvdXIgZW51bWVyYWJsZSBpcyBlbXB0eSwgdGhpcyBt
        ZXRob2Qgc2hvdWxkIHJldHVybiBgdW5kZWZpbmVkYC4KCiAgICBgYGBqYXZh
        c2NyaXB0CiAgICB2YXIgYXJyID0gWyJhIiwgImIiLCAiYyJdOwogICAgYXJy
        LmdldCgnbGFzdE9iamVjdCcpOyAgLy8gImMiCgogICAgdmFyIGFyciA9IFtd
        OwogICAgYXJyLmdldCgnbGFzdE9iamVjdCcpOyAgLy8gdW5kZWZpbmVkCiAg
        ICBgYGAKCiAgICBAcHJvcGVydHkgbGFzdE9iamVjdAogICAgQHJldHVybiB7
        T2JqZWN0fSB0aGUgbGFzdCBvYmplY3Qgb3IgdW5kZWZpbmVkCiAgKi8KICBs
        YXN0T2JqZWN0OiBFbWJlci5jb21wdXRlZChmdW5jdGlvbigpIHsKICAgIHZh
        ciBsZW4gPSBnZXQodGhpcywgJ2xlbmd0aCcpOwogICAgaWYgKGxlbj09PTAp
        IHJldHVybiB1bmRlZmluZWQgOwogICAgdmFyIGNvbnRleHQgPSBwb3BDdHgo
        KSwgaWR4PTAsIGN1ciwgbGFzdCA9IG51bGw7CiAgICBkbyB7CiAgICAgIGxh
        c3QgPSBjdXI7CiAgICAgIGN1ciA9IHRoaXMubmV4dE9iamVjdChpZHgrKywg
        bGFzdCwgY29udGV4dCk7CiAgICB9IHdoaWxlIChjdXIgIT09IHVuZGVmaW5l
        ZCk7CiAgICBwdXNoQ3R4KGNvbnRleHQpOwogICAgcmV0dXJuIGxhc3Q7CiAg
        fSkucHJvcGVydHkoJ1tdJyksCgogIC8qKgogICAgUmV0dXJucyBgdHJ1ZWAg
        aWYgdGhlIHBhc3NlZCBvYmplY3QgY2FuIGJlIGZvdW5kIGluIHRoZSByZWNl
        aXZlci4gVGhlCiAgICBkZWZhdWx0IHZlcnNpb24gd2lsbCBpdGVyYXRlIHRo
        cm91Z2ggdGhlIGVudW1lcmFibGUgdW50aWwgdGhlIG9iamVjdAogICAgaXMg
        Zm91bmQuIFlvdSBtYXkgd2FudCB0byBvdmVycmlkZSB0aGlzIHdpdGggYSBt
        b3JlIGVmZmljaWVudCB2ZXJzaW9uLgoKICAgIGBgYGphdmFzY3JpcHQKICAg
        IHZhciBhcnIgPSBbImEiLCAiYiIsICJjIl07CiAgICBhcnIuY29udGFpbnMo
        ImEiKTsgLy8gdHJ1ZQogICAgYXJyLmNvbnRhaW5zKCJ6Iik7IC8vIGZhbHNl
        CiAgICBgYGAKCiAgICBAbWV0aG9kIGNvbnRhaW5zCiAgICBAcGFyYW0ge09i
        amVjdH0gb2JqIFRoZSBvYmplY3QgdG8gc2VhcmNoIGZvci4KICAgIEByZXR1
        cm4ge0Jvb2xlYW59IGB0cnVlYCBpZiBvYmplY3QgaXMgZm91bmQgaW4gZW51
        bWVyYWJsZS4KICAqLwogIGNvbnRhaW5zOiBmdW5jdGlvbihvYmopIHsKICAg
        IHJldHVybiB0aGlzLmZpbmQoZnVuY3Rpb24oaXRlbSkgeyByZXR1cm4gaXRl
        bT09PW9iajsgfSkgIT09IHVuZGVmaW5lZDsKICB9LAoKICAvKioKICAgIEl0
        ZXJhdGVzIHRocm91Z2ggdGhlIGVudW1lcmFibGUsIGNhbGxpbmcgdGhlIHBh
        c3NlZCBmdW5jdGlvbiBvbiBlYWNoCiAgICBpdGVtLiBUaGlzIG1ldGhvZCBj
        b3JyZXNwb25kcyB0byB0aGUgYGZvckVhY2goKWAgbWV0aG9kIGRlZmluZWQg
        aW4KICAgIEphdmFTY3JpcHQgMS42LgoKICAgIFRoZSBjYWxsYmFjayBtZXRo
        b2QgeW91IHByb3ZpZGUgc2hvdWxkIGhhdmUgdGhlIGZvbGxvd2luZyBzaWdu
        YXR1cmUgKGFsbAogICAgcGFyYW1ldGVycyBhcmUgb3B0aW9uYWwpOgoKICAg
        IGBgYGphdmFzY3JpcHQKICAgIGZ1bmN0aW9uKGl0ZW0sIGluZGV4LCBlbnVt
        ZXJhYmxlKTsKICAgIGBgYAoKICAgIC0gYGl0ZW1gIGlzIHRoZSBjdXJyZW50
        IGl0ZW0gaW4gdGhlIGl0ZXJhdGlvbi4KICAgIC0gYGluZGV4YCBpcyB0aGUg
        Y3VycmVudCBpbmRleCBpbiB0aGUgaXRlcmF0aW9uLgogICAgLSBgZW51bWVy
        YWJsZWAgaXMgdGhlIGVudW1lcmFibGUgb2JqZWN0IGl0c2VsZi4KCiAgICBO
        b3RlIHRoYXQgaW4gYWRkaXRpb24gdG8gYSBjYWxsYmFjaywgeW91IGNhbiBh
        bHNvIHBhc3MgYW4gb3B0aW9uYWwgdGFyZ2V0CiAgICBvYmplY3QgdGhhdCB3
        aWxsIGJlIHNldCBhcyBgdGhpc2Agb24gdGhlIGNvbnRleHQuIFRoaXMgaXMg
        YSBnb29kIHdheQogICAgdG8gZ2l2ZSB5b3VyIGl0ZXJhdG9yIGZ1bmN0aW9u
        IGFjY2VzcyB0byB0aGUgY3VycmVudCBvYmplY3QuCgogICAgQG1ldGhvZCBm
        b3JFYWNoCiAgICBAcGFyYW0ge0Z1bmN0aW9ufSBjYWxsYmFjayBUaGUgY2Fs
        bGJhY2sgdG8gZXhlY3V0ZQogICAgQHBhcmFtIHtPYmplY3R9IFt0YXJnZXRd
        IFRoZSB0YXJnZXQgb2JqZWN0IHRvIHVzZQogICAgQHJldHVybiB7T2JqZWN0
        fSByZWNlaXZlcgogICovCiAgZm9yRWFjaDogZnVuY3Rpb24oY2FsbGJhY2ss
        IHRhcmdldCkgewogICAgaWYgKHR5cGVvZiBjYWxsYmFjayAhPT0gImZ1bmN0
        aW9uIikgdGhyb3cgbmV3IFR5cGVFcnJvcigpIDsKICAgIHZhciBsZW4gPSBn
        ZXQodGhpcywgJ2xlbmd0aCcpLCBsYXN0ID0gbnVsbCwgY29udGV4dCA9IHBv
        cEN0eCgpOwoKICAgIGlmICh0YXJnZXQgPT09IHVuZGVmaW5lZCkgdGFyZ2V0
        ID0gbnVsbDsKCiAgICBmb3IodmFyIGlkeD0wO2lkeDxsZW47aWR4KyspIHsK
        ICAgICAgdmFyIG5leHQgPSB0aGlzLm5leHRPYmplY3QoaWR4LCBsYXN0LCBj
        b250ZXh0KSA7CiAgICAgIGNhbGxiYWNrLmNhbGwodGFyZ2V0LCBuZXh0LCBp
        ZHgsIHRoaXMpOwogICAgICBsYXN0ID0gbmV4dCA7CiAgICB9CiAgICBsYXN0
        ID0gbnVsbCA7CiAgICBjb250ZXh0ID0gcHVzaEN0eChjb250ZXh0KTsKICAg
        IHJldHVybiB0aGlzIDsKICB9LAoKICAvKioKICAgIEFsaWFzIGZvciBgbWFw
        QnlgCgogICAgQG1ldGhvZCBnZXRFYWNoCiAgICBAcGFyYW0ge1N0cmluZ30g
        a2V5IG5hbWUgb2YgdGhlIHByb3BlcnR5CiAgICBAcmV0dXJuIHtBcnJheX0g
        VGhlIG1hcHBlZCBhcnJheS4KICAqLwogIGdldEVhY2g6IGZ1bmN0aW9uKGtl
        eSkgewogICAgcmV0dXJuIHRoaXMubWFwQnkoa2V5KTsKICB9LAoKICAvKioK
        ICAgIFNldHMgdGhlIHZhbHVlIG9uIHRoZSBuYW1lZCBwcm9wZXJ0eSBmb3Ig
        ZWFjaCBtZW1iZXIuIFRoaXMgaXMgbW9yZQogICAgZWZmaWNpZW50IHRoYW4g
        dXNpbmcgb3RoZXIgbWV0aG9kcyBkZWZpbmVkIG9uIHRoaXMgaGVscGVyLiBJ
        ZiB0aGUgb2JqZWN0CiAgICBpbXBsZW1lbnRzIEVtYmVyLk9ic2VydmFibGUs
        IHRoZSB2YWx1ZSB3aWxsIGJlIGNoYW5nZWQgdG8gYHNldCgpLGAgb3RoZXJ3
        aXNlCiAgICBpdCB3aWxsIGJlIHNldCBkaXJlY3RseS4gYG51bGxgIG9iamVj
        dHMgYXJlIHNraXBwZWQuCgogICAgQG1ldGhvZCBzZXRFYWNoCiAgICBAcGFy
        YW0ge1N0cmluZ30ga2V5IFRoZSBrZXkgdG8gc2V0CiAgICBAcGFyYW0ge09i
        amVjdH0gdmFsdWUgVGhlIG9iamVjdCB0byBzZXQKICAgIEByZXR1cm4ge09i
        amVjdH0gcmVjZWl2ZXIKICAqLwogIHNldEVhY2g6IGZ1bmN0aW9uKGtleSwg
        dmFsdWUpIHsKICAgIHJldHVybiB0aGlzLmZvckVhY2goZnVuY3Rpb24oaXRl
        bSkgewogICAgICBzZXQoaXRlbSwga2V5LCB2YWx1ZSk7CiAgICB9KTsKICB9
        LAoKICAvKioKICAgIE1hcHMgYWxsIG9mIHRoZSBpdGVtcyBpbiB0aGUgZW51
        bWVyYXRpb24gdG8gYW5vdGhlciB2YWx1ZSwgcmV0dXJuaW5nCiAgICBhIG5l
        dyBhcnJheS4gVGhpcyBtZXRob2QgY29ycmVzcG9uZHMgdG8gYG1hcCgpYCBk
        ZWZpbmVkIGluIEphdmFTY3JpcHQgMS42LgoKICAgIFRoZSBjYWxsYmFjayBt
        ZXRob2QgeW91IHByb3ZpZGUgc2hvdWxkIGhhdmUgdGhlIGZvbGxvd2luZyBz
        aWduYXR1cmUgKGFsbAogICAgcGFyYW1ldGVycyBhcmUgb3B0aW9uYWwpOgoK
        ICAgIGBgYGphdmFzY3JpcHQKICAgIGZ1bmN0aW9uKGl0ZW0sIGluZGV4LCBl
        bnVtZXJhYmxlKTsKICAgIGBgYAoKICAgIC0gYGl0ZW1gIGlzIHRoZSBjdXJy
        ZW50IGl0ZW0gaW4gdGhlIGl0ZXJhdGlvbi4KICAgIC0gYGluZGV4YCBpcyB0
        aGUgY3VycmVudCBpbmRleCBpbiB0aGUgaXRlcmF0aW9uLgogICAgLSBgZW51
        bWVyYWJsZWAgaXMgdGhlIGVudW1lcmFibGUgb2JqZWN0IGl0c2VsZi4KCiAg
        ICBJdCBzaG91bGQgcmV0dXJuIHRoZSBtYXBwZWQgdmFsdWUuCgogICAgTm90
        ZSB0aGF0IGluIGFkZGl0aW9uIHRvIGEgY2FsbGJhY2ssIHlvdSBjYW4gYWxz
        byBwYXNzIGFuIG9wdGlvbmFsIHRhcmdldAogICAgb2JqZWN0IHRoYXQgd2ls
        bCBiZSBzZXQgYXMgYHRoaXNgIG9uIHRoZSBjb250ZXh0LiBUaGlzIGlzIGEg
        Z29vZCB3YXkKICAgIHRvIGdpdmUgeW91ciBpdGVyYXRvciBmdW5jdGlvbiBh
        Y2Nlc3MgdG8gdGhlIGN1cnJlbnQgb2JqZWN0LgoKICAgIEBtZXRob2QgbWFw
        CiAgICBAcGFyYW0ge0Z1bmN0aW9ufSBjYWxsYmFjayBUaGUgY2FsbGJhY2sg
        dG8gZXhlY3V0ZQogICAgQHBhcmFtIHtPYmplY3R9IFt0YXJnZXRdIFRoZSB0
        YXJnZXQgb2JqZWN0IHRvIHVzZQogICAgQHJldHVybiB7QXJyYXl9IFRoZSBt
        YXBwZWQgYXJyYXkuCiAgKi8KICBtYXA6IGZ1bmN0aW9uKGNhbGxiYWNrLCB0
        YXJnZXQpIHsKICAgIHZhciByZXQgPSBFbWJlci5BKCk7CiAgICB0aGlzLmZv
        ckVhY2goZnVuY3Rpb24oeCwgaWR4LCBpKSB7CiAgICAgIHJldFtpZHhdID0g
        Y2FsbGJhY2suY2FsbCh0YXJnZXQsIHgsIGlkeCxpKTsKICAgIH0pOwogICAg
        cmV0dXJuIHJldCA7CiAgfSwKCiAgLyoqCiAgICBTaW1pbGFyIHRvIG1hcCwg
        dGhpcyBzcGVjaWFsaXplZCBmdW5jdGlvbiByZXR1cm5zIHRoZSB2YWx1ZSBv
        ZiB0aGUgbmFtZWQKICAgIHByb3BlcnR5IG9uIGFsbCBpdGVtcyBpbiB0aGUg
        ZW51bWVyYXRpb24uCgogICAgQG1ldGhvZCBtYXBCeQogICAgQHBhcmFtIHtT
        dHJpbmd9IGtleSBuYW1lIG9mIHRoZSBwcm9wZXJ0eQogICAgQHJldHVybiB7
        QXJyYXl9IFRoZSBtYXBwZWQgYXJyYXkuCiAgKi8KICBtYXBCeTogZnVuY3Rp
        b24oa2V5KSB7CiAgICByZXR1cm4gdGhpcy5tYXAoZnVuY3Rpb24obmV4dCkg
        ewogICAgICByZXR1cm4gZ2V0KG5leHQsIGtleSk7CiAgICB9KTsKICB9LAoK
        ICAvKioKICAgIFNpbWlsYXIgdG8gbWFwLCB0aGlzIHNwZWNpYWxpemVkIGZ1
        bmN0aW9uIHJldHVybnMgdGhlIHZhbHVlIG9mIHRoZSBuYW1lZAogICAgcHJv
        cGVydHkgb24gYWxsIGl0ZW1zIGluIHRoZSBlbnVtZXJhdGlvbi4KCiAgICBA
        bWV0aG9kIG1hcFByb3BlcnR5CiAgICBAcGFyYW0ge1N0cmluZ30ga2V5IG5h
        bWUgb2YgdGhlIHByb3BlcnR5CiAgICBAcmV0dXJuIHtBcnJheX0gVGhlIG1h
        cHBlZCBhcnJheS4KICAgIEBkZXByZWNhdGVkIFVzZSBgbWFwQnlgIGluc3Rl
        YWQKICAqLwoKICBtYXBQcm9wZXJ0eTogRW1iZXIuYWxpYXNNZXRob2QoJ21h
        cEJ5JyksCgogIC8qKgogICAgUmV0dXJucyBhbiBhcnJheSB3aXRoIGFsbCBv
        ZiB0aGUgaXRlbXMgaW4gdGhlIGVudW1lcmF0aW9uIHRoYXQgdGhlIHBhc3Nl
        ZAogICAgZnVuY3Rpb24gcmV0dXJucyB0cnVlIGZvci4gVGhpcyBtZXRob2Qg
        Y29ycmVzcG9uZHMgdG8gYGZpbHRlcigpYCBkZWZpbmVkIGluCiAgICBKYXZh
        U2NyaXB0IDEuNi4KCiAgICBUaGUgY2FsbGJhY2sgbWV0aG9kIHlvdSBwcm92
        aWRlIHNob3VsZCBoYXZlIHRoZSBmb2xsb3dpbmcgc2lnbmF0dXJlIChhbGwK
        ICAgIHBhcmFtZXRlcnMgYXJlIG9wdGlvbmFsKToKCiAgICBgYGBqYXZhc2Ny
        aXB0CiAgICBmdW5jdGlvbihpdGVtLCBpbmRleCwgZW51bWVyYWJsZSk7CiAg
        ICBgYGAKCiAgICAtIGBpdGVtYCBpcyB0aGUgY3VycmVudCBpdGVtIGluIHRo
        ZSBpdGVyYXRpb24uCiAgICAtIGBpbmRleGAgaXMgdGhlIGN1cnJlbnQgaW5k
        ZXggaW4gdGhlIGl0ZXJhdGlvbi4KICAgIC0gYGVudW1lcmFibGVgIGlzIHRo
        ZSBlbnVtZXJhYmxlIG9iamVjdCBpdHNlbGYuCgogICAgSXQgc2hvdWxkIHJl
        dHVybiB0aGUgYHRydWVgIHRvIGluY2x1ZGUgdGhlIGl0ZW0gaW4gdGhlIHJl
        c3VsdHMsIGBmYWxzZWAKICAgIG90aGVyd2lzZS4KCiAgICBOb3RlIHRoYXQg
        aW4gYWRkaXRpb24gdG8gYSBjYWxsYmFjaywgeW91IGNhbiBhbHNvIHBhc3Mg
        YW4gb3B0aW9uYWwgdGFyZ2V0CiAgICBvYmplY3QgdGhhdCB3aWxsIGJlIHNl
        dCBhcyBgdGhpc2Agb24gdGhlIGNvbnRleHQuIFRoaXMgaXMgYSBnb29kIHdh
        eQogICAgdG8gZ2l2ZSB5b3VyIGl0ZXJhdG9yIGZ1bmN0aW9uIGFjY2VzcyB0
        byB0aGUgY3VycmVudCBvYmplY3QuCgogICAgQG1ldGhvZCBmaWx0ZXIKICAg
        IEBwYXJhbSB7RnVuY3Rpb259IGNhbGxiYWNrIFRoZSBjYWxsYmFjayB0byBl
        eGVjdXRlCiAgICBAcGFyYW0ge09iamVjdH0gW3RhcmdldF0gVGhlIHRhcmdl
        dCBvYmplY3QgdG8gdXNlCiAgICBAcmV0dXJuIHtBcnJheX0gQSBmaWx0ZXJl
        ZCBhcnJheS4KICAqLwogIGZpbHRlcjogZnVuY3Rpb24oY2FsbGJhY2ssIHRh
        cmdldCkgewogICAgdmFyIHJldCA9IEVtYmVyLkEoKTsKICAgIHRoaXMuZm9y
        RWFjaChmdW5jdGlvbih4LCBpZHgsIGkpIHsKICAgICAgaWYgKGNhbGxiYWNr
        LmNhbGwodGFyZ2V0LCB4LCBpZHgsIGkpKSByZXQucHVzaCh4KTsKICAgIH0p
        OwogICAgcmV0dXJuIHJldCA7CiAgfSwKCiAgLyoqCiAgICBSZXR1cm5zIGFu
        IGFycmF5IHdpdGggYWxsIG9mIHRoZSBpdGVtcyBpbiB0aGUgZW51bWVyYXRp
        b24gd2hlcmUgdGhlIHBhc3NlZAogICAgZnVuY3Rpb24gcmV0dXJucyBmYWxz
        ZSBmb3IuIFRoaXMgbWV0aG9kIGlzIHRoZSBpbnZlcnNlIG9mIGZpbHRlcigp
        LgoKICAgIFRoZSBjYWxsYmFjayBtZXRob2QgeW91IHByb3ZpZGUgc2hvdWxk
        IGhhdmUgdGhlIGZvbGxvd2luZyBzaWduYXR1cmUgKGFsbAogICAgcGFyYW1l
        dGVycyBhcmUgb3B0aW9uYWwpOgoKICAgICAgICAgIGZ1bmN0aW9uKGl0ZW0s
        IGluZGV4LCBlbnVtZXJhYmxlKTsKCiAgICAtICppdGVtKiBpcyB0aGUgY3Vy
        cmVudCBpdGVtIGluIHRoZSBpdGVyYXRpb24uCiAgICAtICppbmRleCogaXMg
        dGhlIGN1cnJlbnQgaW5kZXggaW4gdGhlIGl0ZXJhdGlvbgogICAgLSAqZW51
        bWVyYWJsZSogaXMgdGhlIGVudW1lcmFibGUgb2JqZWN0IGl0c2VsZi4KCiAg
        ICBJdCBzaG91bGQgcmV0dXJuIHRoZSBhIGZhbHNleSB2YWx1ZSB0byBpbmNs
        dWRlIHRoZSBpdGVtIGluIHRoZSByZXN1bHRzLgoKICAgIE5vdGUgdGhhdCBp
        biBhZGRpdGlvbiB0byBhIGNhbGxiYWNrLCB5b3UgY2FuIGFsc28gcGFzcyBh
        biBvcHRpb25hbCB0YXJnZXQKICAgIG9iamVjdCB0aGF0IHdpbGwgYmUgc2V0
        IGFzICJ0aGlzIiBvbiB0aGUgY29udGV4dC4gVGhpcyBpcyBhIGdvb2Qgd2F5
        CiAgICB0byBnaXZlIHlvdXIgaXRlcmF0b3IgZnVuY3Rpb24gYWNjZXNzIHRv
        IHRoZSBjdXJyZW50IG9iamVjdC4KCiAgICBAbWV0aG9kIHJlamVjdAogICAg
        QHBhcmFtIHtGdW5jdGlvbn0gY2FsbGJhY2sgVGhlIGNhbGxiYWNrIHRvIGV4
        ZWN1dGUKICAgIEBwYXJhbSB7T2JqZWN0fSBbdGFyZ2V0XSBUaGUgdGFyZ2V0
        IG9iamVjdCB0byB1c2UKICAgIEByZXR1cm4ge0FycmF5fSBBIHJlamVjdGVk
        IGFycmF5LgogICAqLwogIHJlamVjdDogZnVuY3Rpb24oY2FsbGJhY2ssIHRh
        cmdldCkgewogICAgcmV0dXJuIHRoaXMuZmlsdGVyKGZ1bmN0aW9uKCkgewog
        ICAgICByZXR1cm4gIShjYWxsYmFjay5hcHBseSh0YXJnZXQsIGFyZ3VtZW50
        cykpOwogICAgfSk7CiAgfSwKCiAgLyoqCiAgICBSZXR1cm5zIGFuIGFycmF5
        IHdpdGgganVzdCB0aGUgaXRlbXMgd2l0aCB0aGUgbWF0Y2hlZCBwcm9wZXJ0
        eS4gWW91CiAgICBjYW4gcGFzcyBhbiBvcHRpb25hbCBzZWNvbmQgYXJndW1l
        bnQgd2l0aCB0aGUgdGFyZ2V0IHZhbHVlLiBPdGhlcndpc2UKICAgIHRoaXMg
        d2lsbCBtYXRjaCBhbnkgcHJvcGVydHkgdGhhdCBldmFsdWF0ZXMgdG8gYHRy
        dWVgLgoKICAgIEBtZXRob2QgZmlsdGVyQnkKICAgIEBwYXJhbSB7U3RyaW5n
        fSBrZXkgdGhlIHByb3BlcnR5IHRvIHRlc3QKICAgIEBwYXJhbSB7U3RyaW5n
        fSBbdmFsdWVdIG9wdGlvbmFsIHZhbHVlIHRvIHRlc3QgYWdhaW5zdC4KICAg
        IEByZXR1cm4ge0FycmF5fSBmaWx0ZXJlZCBhcnJheQogICovCiAgZmlsdGVy
        Qnk6IGZ1bmN0aW9uKGtleSwgdmFsdWUpIHsKICAgIHJldHVybiB0aGlzLmZp
        bHRlcihpdGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykpOwogIH0sCgogIC8q
        KgogICAgUmV0dXJucyBhbiBhcnJheSB3aXRoIGp1c3QgdGhlIGl0ZW1zIHdp
        dGggdGhlIG1hdGNoZWQgcHJvcGVydHkuIFlvdQogICAgY2FuIHBhc3MgYW4g
        b3B0aW9uYWwgc2Vjb25kIGFyZ3VtZW50IHdpdGggdGhlIHRhcmdldCB2YWx1
        ZS4gT3RoZXJ3aXNlCiAgICB0aGlzIHdpbGwgbWF0Y2ggYW55IHByb3BlcnR5
        IHRoYXQgZXZhbHVhdGVzIHRvIGB0cnVlYC4KCiAgICBAbWV0aG9kIGZpbHRl
        clByb3BlcnR5CiAgICBAcGFyYW0ge1N0cmluZ30ga2V5IHRoZSBwcm9wZXJ0
        eSB0byB0ZXN0CiAgICBAcGFyYW0ge1N0cmluZ30gW3ZhbHVlXSBvcHRpb25h
        bCB2YWx1ZSB0byB0ZXN0IGFnYWluc3QuCiAgICBAcmV0dXJuIHtBcnJheX0g
        ZmlsdGVyZWQgYXJyYXkKICAgIEBkZXByZWNhdGVkIFVzZSBgZmlsdGVyQnlg
        IGluc3RlYWQKICAqLwogIGZpbHRlclByb3BlcnR5OiBFbWJlci5hbGlhc01l
        dGhvZCgnZmlsdGVyQnknKSwKCiAgLyoqCiAgICBSZXR1cm5zIGFuIGFycmF5
        IHdpdGggdGhlIGl0ZW1zIHRoYXQgZG8gbm90IGhhdmUgdHJ1dGh5IHZhbHVl
        cyBmb3IKICAgIGtleS4gIFlvdSBjYW4gcGFzcyBhbiBvcHRpb25hbCBzZWNv
        bmQgYXJndW1lbnQgd2l0aCB0aGUgdGFyZ2V0IHZhbHVlLiAgT3RoZXJ3aXNl
        CiAgICB0aGlzIHdpbGwgbWF0Y2ggYW55IHByb3BlcnR5IHRoYXQgZXZhbHVh
        dGVzIHRvIGZhbHNlLgoKICAgIEBtZXRob2QgcmVqZWN0QnkKICAgIEBwYXJh
        bSB7U3RyaW5nfSBrZXkgdGhlIHByb3BlcnR5IHRvIHRlc3QKICAgIEBwYXJh
        bSB7U3RyaW5nfSBbdmFsdWVdIG9wdGlvbmFsIHZhbHVlIHRvIHRlc3QgYWdh
        aW5zdC4KICAgIEByZXR1cm4ge0FycmF5fSByZWplY3RlZCBhcnJheQogICov
        CiAgcmVqZWN0Qnk6IGZ1bmN0aW9uKGtleSwgdmFsdWUpIHsKICAgIHZhciBl
        eGFjdFZhbHVlID0gZnVuY3Rpb24oaXRlbSkgeyByZXR1cm4gZ2V0KGl0ZW0s
        IGtleSkgPT09IHZhbHVlOyB9LAogICAgICAgIGhhc1ZhbHVlID0gZnVuY3Rp
        b24oaXRlbSkgeyByZXR1cm4gISFnZXQoaXRlbSwga2V5KTsgfSwKICAgICAg
        ICB1c2UgPSAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMiA/IGV4YWN0VmFsdWUg
        OiBoYXNWYWx1ZSk7CgogICAgcmV0dXJuIHRoaXMucmVqZWN0KHVzZSk7CiAg
        fSwKCiAgLyoqCiAgICBSZXR1cm5zIGFuIGFycmF5IHdpdGggdGhlIGl0ZW1z
        IHRoYXQgZG8gbm90IGhhdmUgdHJ1dGh5IHZhbHVlcyBmb3IKICAgIGtleS4g
        IFlvdSBjYW4gcGFzcyBhbiBvcHRpb25hbCBzZWNvbmQgYXJndW1lbnQgd2l0
        aCB0aGUgdGFyZ2V0IHZhbHVlLiAgT3RoZXJ3aXNlCiAgICB0aGlzIHdpbGwg
        bWF0Y2ggYW55IHByb3BlcnR5IHRoYXQgZXZhbHVhdGVzIHRvIGZhbHNlLgoK
        ICAgIEBtZXRob2QgcmVqZWN0UHJvcGVydHkKICAgIEBwYXJhbSB7U3RyaW5n
        fSBrZXkgdGhlIHByb3BlcnR5IHRvIHRlc3QKICAgIEBwYXJhbSB7U3RyaW5n
        fSBbdmFsdWVdIG9wdGlvbmFsIHZhbHVlIHRvIHRlc3QgYWdhaW5zdC4KICAg
        IEByZXR1cm4ge0FycmF5fSByZWplY3RlZCBhcnJheQogICAgQGRlcHJlY2F0
        ZWQgVXNlIGByZWplY3RCeWAgaW5zdGVhZAogICovCiAgcmVqZWN0UHJvcGVy
        dHk6IEVtYmVyLmFsaWFzTWV0aG9kKCdyZWplY3RCeScpLAoKICAvKioKICAg
        IFJldHVybnMgdGhlIGZpcnN0IGl0ZW0gaW4gdGhlIGFycmF5IGZvciB3aGlj
        aCB0aGUgY2FsbGJhY2sgcmV0dXJucyB0cnVlLgogICAgVGhpcyBtZXRob2Qg
        d29ya3Mgc2ltaWxhciB0byB0aGUgYGZpbHRlcigpYCBtZXRob2QgZGVmaW5l
        ZCBpbiBKYXZhU2NyaXB0IDEuNgogICAgZXhjZXB0IHRoYXQgaXQgd2lsbCBz
        dG9wIHdvcmtpbmcgb24gdGhlIGFycmF5IG9uY2UgYSBtYXRjaCBpcyBmb3Vu
        ZC4KCiAgICBUaGUgY2FsbGJhY2sgbWV0aG9kIHlvdSBwcm92aWRlIHNob3Vs
        ZCBoYXZlIHRoZSBmb2xsb3dpbmcgc2lnbmF0dXJlIChhbGwKICAgIHBhcmFt
        ZXRlcnMgYXJlIG9wdGlvbmFsKToKCiAgICBgYGBqYXZhc2NyaXB0CiAgICBm
        dW5jdGlvbihpdGVtLCBpbmRleCwgZW51bWVyYWJsZSk7CiAgICBgYGAKCiAg
        ICAtIGBpdGVtYCBpcyB0aGUgY3VycmVudCBpdGVtIGluIHRoZSBpdGVyYXRp
        b24uCiAgICAtIGBpbmRleGAgaXMgdGhlIGN1cnJlbnQgaW5kZXggaW4gdGhl
        IGl0ZXJhdGlvbi4KICAgIC0gYGVudW1lcmFibGVgIGlzIHRoZSBlbnVtZXJh
        YmxlIG9iamVjdCBpdHNlbGYuCgogICAgSXQgc2hvdWxkIHJldHVybiB0aGUg
        YHRydWVgIHRvIGluY2x1ZGUgdGhlIGl0ZW0gaW4gdGhlIHJlc3VsdHMsIGBm
        YWxzZWAKICAgIG90aGVyd2lzZS4KCiAgICBOb3RlIHRoYXQgaW4gYWRkaXRp
        b24gdG8gYSBjYWxsYmFjaywgeW91IGNhbiBhbHNvIHBhc3MgYW4gb3B0aW9u
        YWwgdGFyZ2V0CiAgICBvYmplY3QgdGhhdCB3aWxsIGJlIHNldCBhcyBgdGhp
        c2Agb24gdGhlIGNvbnRleHQuIFRoaXMgaXMgYSBnb29kIHdheQogICAgdG8g
        Z2l2ZSB5b3VyIGl0ZXJhdG9yIGZ1bmN0aW9uIGFjY2VzcyB0byB0aGUgY3Vy
        cmVudCBvYmplY3QuCgogICAgQG1ldGhvZCBmaW5kCiAgICBAcGFyYW0ge0Z1
        bmN0aW9ufSBjYWxsYmFjayBUaGUgY2FsbGJhY2sgdG8gZXhlY3V0ZQogICAg
        QHBhcmFtIHtPYmplY3R9IFt0YXJnZXRdIFRoZSB0YXJnZXQgb2JqZWN0IHRv
        IHVzZQogICAgQHJldHVybiB7T2JqZWN0fSBGb3VuZCBpdGVtIG9yIGB1bmRl
        ZmluZWRgLgogICovCiAgZmluZDogZnVuY3Rpb24oY2FsbGJhY2ssIHRhcmdl
        dCkgewogICAgdmFyIGxlbiA9IGdldCh0aGlzLCAnbGVuZ3RoJykgOwogICAg
        aWYgKHRhcmdldCA9PT0gdW5kZWZpbmVkKSB0YXJnZXQgPSBudWxsOwoKICAg
        IHZhciBsYXN0ID0gbnVsbCwgbmV4dCwgZm91bmQgPSBmYWxzZSwgcmV0IDsK
        ICAgIHZhciBjb250ZXh0ID0gcG9wQ3R4KCk7CiAgICBmb3IodmFyIGlkeD0w
        O2lkeDxsZW4gJiYgIWZvdW5kO2lkeCsrKSB7CiAgICAgIG5leHQgPSB0aGlz
        Lm5leHRPYmplY3QoaWR4LCBsYXN0LCBjb250ZXh0KSA7CiAgICAgIGlmIChm
        b3VuZCA9IGNhbGxiYWNrLmNhbGwodGFyZ2V0LCBuZXh0LCBpZHgsIHRoaXMp
        KSByZXQgPSBuZXh0IDsKICAgICAgbGFzdCA9IG5leHQgOwogICAgfQogICAg
        bmV4dCA9IGxhc3QgPSBudWxsIDsKICAgIGNvbnRleHQgPSBwdXNoQ3R4KGNv
        bnRleHQpOwogICAgcmV0dXJuIHJldCA7CiAgfSwKCiAgLyoqCiAgICBSZXR1
        cm5zIHRoZSBmaXJzdCBpdGVtIHdpdGggYSBwcm9wZXJ0eSBtYXRjaGluZyB0
        aGUgcGFzc2VkIHZhbHVlLiBZb3UKICAgIGNhbiBwYXNzIGFuIG9wdGlvbmFs
        IHNlY29uZCBhcmd1bWVudCB3aXRoIHRoZSB0YXJnZXQgdmFsdWUuIE90aGVy
        d2lzZQogICAgdGhpcyB3aWxsIG1hdGNoIGFueSBwcm9wZXJ0eSB0aGF0IGV2
        YWx1YXRlcyB0byBgdHJ1ZWAuCgogICAgVGhpcyBtZXRob2Qgd29ya3MgbXVj
        aCBsaWtlIHRoZSBtb3JlIGdlbmVyaWMgYGZpbmQoKWAgbWV0aG9kLgoKICAg
        IEBtZXRob2QgZmluZEJ5CiAgICBAcGFyYW0ge1N0cmluZ30ga2V5IHRoZSBw
        cm9wZXJ0eSB0byB0ZXN0CiAgICBAcGFyYW0ge1N0cmluZ30gW3ZhbHVlXSBv
        cHRpb25hbCB2YWx1ZSB0byB0ZXN0IGFnYWluc3QuCiAgICBAcmV0dXJuIHtP
        YmplY3R9IGZvdW5kIGl0ZW0gb3IgYHVuZGVmaW5lZGAKICAqLwogIGZpbmRC
        eTogZnVuY3Rpb24oa2V5LCB2YWx1ZSkgewogICAgcmV0dXJuIHRoaXMuZmlu
        ZChpdGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykpOwogIH0sCgogIC8qKgog
        ICAgUmV0dXJucyB0aGUgZmlyc3QgaXRlbSB3aXRoIGEgcHJvcGVydHkgbWF0
        Y2hpbmcgdGhlIHBhc3NlZCB2YWx1ZS4gWW91CiAgICBjYW4gcGFzcyBhbiBv
        cHRpb25hbCBzZWNvbmQgYXJndW1lbnQgd2l0aCB0aGUgdGFyZ2V0IHZhbHVl
        LiBPdGhlcndpc2UKICAgIHRoaXMgd2lsbCBtYXRjaCBhbnkgcHJvcGVydHkg
        dGhhdCBldmFsdWF0ZXMgdG8gYHRydWVgLgoKICAgIFRoaXMgbWV0aG9kIHdv
        cmtzIG11Y2ggbGlrZSB0aGUgbW9yZSBnZW5lcmljIGBmaW5kKClgIG1ldGhv
        ZC4KCiAgICBAbWV0aG9kIGZpbmRQcm9wZXJ0eQogICAgQHBhcmFtIHtTdHJp
        bmd9IGtleSB0aGUgcHJvcGVydHkgdG8gdGVzdAogICAgQHBhcmFtIHtTdHJp
        bmd9IFt2YWx1ZV0gb3B0aW9uYWwgdmFsdWUgdG8gdGVzdCBhZ2FpbnN0Lgog
        ICAgQHJldHVybiB7T2JqZWN0fSBmb3VuZCBpdGVtIG9yIGB1bmRlZmluZWRg
        CiAgICBAZGVwcmVjYXRlZCBVc2UgYGZpbmRCeWAgaW5zdGVhZAogICovCiAg
        ZmluZFByb3BlcnR5OiBFbWJlci5hbGlhc01ldGhvZCgnZmluZEJ5JyksCgog
        IC8qKgogICAgUmV0dXJucyBgdHJ1ZWAgaWYgdGhlIHBhc3NlZCBmdW5jdGlv
        biByZXR1cm5zIHRydWUgZm9yIGV2ZXJ5IGl0ZW0gaW4gdGhlCiAgICBlbnVt
        ZXJhdGlvbi4gVGhpcyBjb3JyZXNwb25kcyB3aXRoIHRoZSBgZXZlcnkoKWAg
        bWV0aG9kIGluIEphdmFTY3JpcHQgMS42LgoKICAgIFRoZSBjYWxsYmFjayBt
        ZXRob2QgeW91IHByb3ZpZGUgc2hvdWxkIGhhdmUgdGhlIGZvbGxvd2luZyBz
        aWduYXR1cmUgKGFsbAogICAgcGFyYW1ldGVycyBhcmUgb3B0aW9uYWwpOgoK
        ICAgIGBgYGphdmFzY3JpcHQKICAgIGZ1bmN0aW9uKGl0ZW0sIGluZGV4LCBl
        bnVtZXJhYmxlKTsKICAgIGBgYAoKICAgIC0gYGl0ZW1gIGlzIHRoZSBjdXJy
        ZW50IGl0ZW0gaW4gdGhlIGl0ZXJhdGlvbi4KICAgIC0gYGluZGV4YCBpcyB0
        aGUgY3VycmVudCBpbmRleCBpbiB0aGUgaXRlcmF0aW9uLgogICAgLSBgZW51
        bWVyYWJsZWAgaXMgdGhlIGVudW1lcmFibGUgb2JqZWN0IGl0c2VsZi4KCiAg
        ICBJdCBzaG91bGQgcmV0dXJuIHRoZSBgdHJ1ZWAgb3IgYGZhbHNlYC4KCiAg
        ICBOb3RlIHRoYXQgaW4gYWRkaXRpb24gdG8gYSBjYWxsYmFjaywgeW91IGNh
        biBhbHNvIHBhc3MgYW4gb3B0aW9uYWwgdGFyZ2V0CiAgICBvYmplY3QgdGhh
        dCB3aWxsIGJlIHNldCBhcyBgdGhpc2Agb24gdGhlIGNvbnRleHQuIFRoaXMg
        aXMgYSBnb29kIHdheQogICAgdG8gZ2l2ZSB5b3VyIGl0ZXJhdG9yIGZ1bmN0
        aW9uIGFjY2VzcyB0byB0aGUgY3VycmVudCBvYmplY3QuCgogICAgRXhhbXBs
        ZSBVc2FnZToKCiAgICBgYGBqYXZhc2NyaXB0CiAgICBpZiAocGVvcGxlLmV2
        ZXJ5KGlzRW5naW5lZXIpKSB7IFBheWNoZWNrcy5hZGRCaWdCb251cygpOyB9
        CiAgICBgYGAKCiAgICBAbWV0aG9kIGV2ZXJ5CiAgICBAcGFyYW0ge0Z1bmN0
        aW9ufSBjYWxsYmFjayBUaGUgY2FsbGJhY2sgdG8gZXhlY3V0ZQogICAgQHBh
        cmFtIHtPYmplY3R9IFt0YXJnZXRdIFRoZSB0YXJnZXQgb2JqZWN0IHRvIHVz
        ZQogICAgQHJldHVybiB7Qm9vbGVhbn0KICAqLwogIGV2ZXJ5OiBmdW5jdGlv
        bihjYWxsYmFjaywgdGFyZ2V0KSB7CiAgICByZXR1cm4gIXRoaXMuZmluZChm
        dW5jdGlvbih4LCBpZHgsIGkpIHsKICAgICAgcmV0dXJuICFjYWxsYmFjay5j
        YWxsKHRhcmdldCwgeCwgaWR4LCBpKTsKICAgIH0pOwogIH0sCgogIC8qKgog
        ICAgUmV0dXJucyBgdHJ1ZWAgaWYgdGhlIHBhc3NlZCBwcm9wZXJ0eSByZXNv
        bHZlcyB0byBgdHJ1ZWAgZm9yIGFsbCBpdGVtcyBpbgogICAgdGhlIGVudW1l
        cmFibGUuIFRoaXMgbWV0aG9kIGlzIG9mdGVuIHNpbXBsZXIvZmFzdGVyIHRo
        YW4gdXNpbmcgYSBjYWxsYmFjay4KCiAgICBAbWV0aG9kIGV2ZXJ5QnkKICAg
        IEBwYXJhbSB7U3RyaW5nfSBrZXkgdGhlIHByb3BlcnR5IHRvIHRlc3QKICAg
        IEBwYXJhbSB7U3RyaW5nfSBbdmFsdWVdIG9wdGlvbmFsIHZhbHVlIHRvIHRl
        c3QgYWdhaW5zdC4KICAgIEByZXR1cm4ge0Jvb2xlYW59CiAgKi8KICBldmVy
        eUJ5OiBmdW5jdGlvbihrZXksIHZhbHVlKSB7CiAgICByZXR1cm4gdGhpcy5l
        dmVyeShpdGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykpOwogIH0sCgogIC8q
        KgogICAgUmV0dXJucyBgdHJ1ZWAgaWYgdGhlIHBhc3NlZCBwcm9wZXJ0eSBy
        ZXNvbHZlcyB0byBgdHJ1ZWAgZm9yIGFsbCBpdGVtcyBpbgogICAgdGhlIGVu
        dW1lcmFibGUuIFRoaXMgbWV0aG9kIGlzIG9mdGVuIHNpbXBsZXIvZmFzdGVy
        IHRoYW4gdXNpbmcgYSBjYWxsYmFjay4KCiAgICBAbWV0aG9kIGV2ZXJ5UHJv
        cGVydHkKICAgIEBwYXJhbSB7U3RyaW5nfSBrZXkgdGhlIHByb3BlcnR5IHRv
        IHRlc3QKICAgIEBwYXJhbSB7U3RyaW5nfSBbdmFsdWVdIG9wdGlvbmFsIHZh
        bHVlIHRvIHRlc3QgYWdhaW5zdC4KICAgIEByZXR1cm4ge0Jvb2xlYW59CiAg
        ICBAZGVwcmVjYXRlZCBVc2UgYGV2ZXJ5QnlgIGluc3RlYWQKICAqLwogIGV2
        ZXJ5UHJvcGVydHk6IEVtYmVyLmFsaWFzTWV0aG9kKCdldmVyeUJ5JyksCgog
        IC8qKgogICAgUmV0dXJucyBgdHJ1ZWAgaWYgdGhlIHBhc3NlZCBmdW5jdGlv
        biByZXR1cm5zIHRydWUgZm9yIGFueSBpdGVtIGluIHRoZQogICAgZW51bWVy
        YXRpb24uIFRoaXMgY29ycmVzcG9uZHMgd2l0aCB0aGUgYHNvbWUoKWAgbWV0
        aG9kIGluIEphdmFTY3JpcHQgMS42LgoKICAgIFRoZSBjYWxsYmFjayBtZXRo
        b2QgeW91IHByb3ZpZGUgc2hvdWxkIGhhdmUgdGhlIGZvbGxvd2luZyBzaWdu
        YXR1cmUgKGFsbAogICAgcGFyYW1ldGVycyBhcmUgb3B0aW9uYWwpOgoKICAg
        IGBgYGphdmFzY3JpcHQKICAgIGZ1bmN0aW9uKGl0ZW0sIGluZGV4LCBlbnVt
        ZXJhYmxlKTsKICAgIGBgYAoKICAgIC0gYGl0ZW1gIGlzIHRoZSBjdXJyZW50
        IGl0ZW0gaW4gdGhlIGl0ZXJhdGlvbi4KICAgIC0gYGluZGV4YCBpcyB0aGUg
        Y3VycmVudCBpbmRleCBpbiB0aGUgaXRlcmF0aW9uLgogICAgLSBgZW51bWVy
        YWJsZWAgaXMgdGhlIGVudW1lcmFibGUgb2JqZWN0IGl0c2VsZi4KCiAgICBJ
        dCBzaG91bGQgcmV0dXJuIHRoZSBgdHJ1ZWAgdG8gaW5jbHVkZSB0aGUgaXRl
        bSBpbiB0aGUgcmVzdWx0cywgYGZhbHNlYAogICAgb3RoZXJ3aXNlLgoKICAg
        IE5vdGUgdGhhdCBpbiBhZGRpdGlvbiB0byBhIGNhbGxiYWNrLCB5b3UgY2Fu
        IGFsc28gcGFzcyBhbiBvcHRpb25hbCB0YXJnZXQKICAgIG9iamVjdCB0aGF0
        IHdpbGwgYmUgc2V0IGFzIGB0aGlzYCBvbiB0aGUgY29udGV4dC4gVGhpcyBp
        cyBhIGdvb2Qgd2F5CiAgICB0byBnaXZlIHlvdXIgaXRlcmF0b3IgZnVuY3Rp
        b24gYWNjZXNzIHRvIHRoZSBjdXJyZW50IG9iamVjdC4KCiAgICBVc2FnZSBF
        eGFtcGxlOgoKICAgIGBgYGphdmFzY3JpcHQKICAgIGlmIChwZW9wbGUuYW55
        KGlzTWFuYWdlcikpIHsgUGF5Y2hlY2tzLmFkZEJpZ2dlckJvbnVzKCk7IH0K
        ICAgIGBgYAoKICAgIEBtZXRob2QgYW55CiAgICBAcGFyYW0ge0Z1bmN0aW9u
        fSBjYWxsYmFjayBUaGUgY2FsbGJhY2sgdG8gZXhlY3V0ZQogICAgQHBhcmFt
        IHtPYmplY3R9IFt0YXJnZXRdIFRoZSB0YXJnZXQgb2JqZWN0IHRvIHVzZQog
        ICAgQHJldHVybiB7Qm9vbGVhbn0gYHRydWVgIGlmIHRoZSBwYXNzZWQgZnVu
        Y3Rpb24gcmV0dXJucyBgdHJ1ZWAgZm9yIGFueSBpdGVtCiAgKi8KICBhbnk6
        IGZ1bmN0aW9uKGNhbGxiYWNrLCB0YXJnZXQpIHsKICAgIHJldHVybiAhIXRo
        aXMuZmluZChmdW5jdGlvbih4LCBpZHgsIGkpIHsKICAgICAgcmV0dXJuICEh
        Y2FsbGJhY2suY2FsbCh0YXJnZXQsIHgsIGlkeCwgaSk7CiAgICB9KTsKICB9
        LAoKICAvKioKICAgIFJldHVybnMgYHRydWVgIGlmIHRoZSBwYXNzZWQgZnVu
        Y3Rpb24gcmV0dXJucyB0cnVlIGZvciBhbnkgaXRlbSBpbiB0aGUKICAgIGVu
        dW1lcmF0aW9uLiBUaGlzIGNvcnJlc3BvbmRzIHdpdGggdGhlIGBzb21lKClg
        IG1ldGhvZCBpbiBKYXZhU2NyaXB0IDEuNi4KCiAgICBUaGUgY2FsbGJhY2sg
        bWV0aG9kIHlvdSBwcm92aWRlIHNob3VsZCBoYXZlIHRoZSBmb2xsb3dpbmcg
        c2lnbmF0dXJlIChhbGwKICAgIHBhcmFtZXRlcnMgYXJlIG9wdGlvbmFsKToK
        CiAgICBgYGBqYXZhc2NyaXB0CiAgICBmdW5jdGlvbihpdGVtLCBpbmRleCwg
        ZW51bWVyYWJsZSk7CiAgICBgYGAKCiAgICAtIGBpdGVtYCBpcyB0aGUgY3Vy
        cmVudCBpdGVtIGluIHRoZSBpdGVyYXRpb24uCiAgICAtIGBpbmRleGAgaXMg
        dGhlIGN1cnJlbnQgaW5kZXggaW4gdGhlIGl0ZXJhdGlvbi4KICAgIC0gYGVu
        dW1lcmFibGVgIGlzIHRoZSBlbnVtZXJhYmxlIG9iamVjdCBpdHNlbGYuCgog
        ICAgSXQgc2hvdWxkIHJldHVybiB0aGUgYHRydWVgIHRvIGluY2x1ZGUgdGhl
        IGl0ZW0gaW4gdGhlIHJlc3VsdHMsIGBmYWxzZWAKICAgIG90aGVyd2lzZS4K
        CiAgICBOb3RlIHRoYXQgaW4gYWRkaXRpb24gdG8gYSBjYWxsYmFjaywgeW91
        IGNhbiBhbHNvIHBhc3MgYW4gb3B0aW9uYWwgdGFyZ2V0CiAgICBvYmplY3Qg
        dGhhdCB3aWxsIGJlIHNldCBhcyBgdGhpc2Agb24gdGhlIGNvbnRleHQuIFRo
        aXMgaXMgYSBnb29kIHdheQogICAgdG8gZ2l2ZSB5b3VyIGl0ZXJhdG9yIGZ1
        bmN0aW9uIGFjY2VzcyB0byB0aGUgY3VycmVudCBvYmplY3QuCgogICAgVXNh
        Z2UgRXhhbXBsZToKCiAgICBgYGBqYXZhc2NyaXB0CiAgICBpZiAocGVvcGxl
        LnNvbWUoaXNNYW5hZ2VyKSkgeyBQYXljaGVja3MuYWRkQmlnZ2VyQm9udXMo
        KTsgfQogICAgYGBgCgogICAgQG1ldGhvZCBzb21lCiAgICBAcGFyYW0ge0Z1
        bmN0aW9ufSBjYWxsYmFjayBUaGUgY2FsbGJhY2sgdG8gZXhlY3V0ZQogICAg
        QHBhcmFtIHtPYmplY3R9IFt0YXJnZXRdIFRoZSB0YXJnZXQgb2JqZWN0IHRv
        IHVzZQogICAgQHJldHVybiB7Qm9vbGVhbn0gYHRydWVgIGlmIHRoZSBwYXNz
        ZWQgZnVuY3Rpb24gcmV0dXJucyBgdHJ1ZWAgZm9yIGFueSBpdGVtCiAgICBA
        ZGVwcmVjYXRlZCBVc2UgYGFueWAgaW5zdGVhZAogICovCiAgc29tZTogRW1i
        ZXIuYWxpYXNNZXRob2QoJ2FueScpLAoKICAvKioKICAgIFJldHVybnMgYHRy
        dWVgIGlmIHRoZSBwYXNzZWQgcHJvcGVydHkgcmVzb2x2ZXMgdG8gYHRydWVg
        IGZvciBhbnkgaXRlbSBpbgogICAgdGhlIGVudW1lcmFibGUuIFRoaXMgbWV0
        aG9kIGlzIG9mdGVuIHNpbXBsZXIvZmFzdGVyIHRoYW4gdXNpbmcgYSBjYWxs
        YmFjay4KCiAgICBAbWV0aG9kIGFueUJ5CiAgICBAcGFyYW0ge1N0cmluZ30g
        a2V5IHRoZSBwcm9wZXJ0eSB0byB0ZXN0CiAgICBAcGFyYW0ge1N0cmluZ30g
        W3ZhbHVlXSBvcHRpb25hbCB2YWx1ZSB0byB0ZXN0IGFnYWluc3QuCiAgICBA
        cmV0dXJuIHtCb29sZWFufSBgdHJ1ZWAgaWYgdGhlIHBhc3NlZCBmdW5jdGlv
        biByZXR1cm5zIGB0cnVlYCBmb3IgYW55IGl0ZW0KICAqLwogIGFueUJ5OiBm
        dW5jdGlvbihrZXksIHZhbHVlKSB7CiAgICByZXR1cm4gdGhpcy5hbnkoaXRl
        ci5hcHBseSh0aGlzLCBhcmd1bWVudHMpKTsKICB9LAoKICAvKioKICAgIFJl
        dHVybnMgYHRydWVgIGlmIHRoZSBwYXNzZWQgcHJvcGVydHkgcmVzb2x2ZXMg
        dG8gYHRydWVgIGZvciBhbnkgaXRlbSBpbgogICAgdGhlIGVudW1lcmFibGUu
        IFRoaXMgbWV0aG9kIGlzIG9mdGVuIHNpbXBsZXIvZmFzdGVyIHRoYW4gdXNp
        bmcgYSBjYWxsYmFjay4KCiAgICBAbWV0aG9kIHNvbWVQcm9wZXJ0eQogICAg
        QHBhcmFtIHtTdHJpbmd9IGtleSB0aGUgcHJvcGVydHkgdG8gdGVzdAogICAg
        QHBhcmFtIHtTdHJpbmd9IFt2YWx1ZV0gb3B0aW9uYWwgdmFsdWUgdG8gdGVz
        dCBhZ2FpbnN0LgogICAgQHJldHVybiB7Qm9vbGVhbn0gYHRydWVgIGlmIHRo
        ZSBwYXNzZWQgZnVuY3Rpb24gcmV0dXJucyBgdHJ1ZWAgZm9yIGFueSBpdGVt
        CiAgICBAZGVwcmVjYXRlZCBVc2UgYGFueUJ5YCBpbnN0ZWFkCiAgKi8KICBz
        b21lUHJvcGVydHk6IEVtYmVyLmFsaWFzTWV0aG9kKCdhbnlCeScpLAoKICAv
        KioKICAgIFRoaXMgd2lsbCBjb21iaW5lIHRoZSB2YWx1ZXMgb2YgdGhlIGVu
        dW1lcmF0b3IgaW50byBhIHNpbmdsZSB2YWx1ZS4gSXQKICAgIGlzIGEgdXNl
        ZnVsIHdheSB0byBjb2xsZWN0IGEgc3VtbWFyeSB2YWx1ZSBmcm9tIGFuIGVu
        dW1lcmF0aW9uLiBUaGlzCiAgICBjb3JyZXNwb25kcyB0byB0aGUgYHJlZHVj
        ZSgpYCBtZXRob2QgZGVmaW5lZCBpbiBKYXZhU2NyaXB0IDEuOC4KCiAgICBU
        aGUgY2FsbGJhY2sgbWV0aG9kIHlvdSBwcm92aWRlIHNob3VsZCBoYXZlIHRo
        ZSBmb2xsb3dpbmcgc2lnbmF0dXJlIChhbGwKICAgIHBhcmFtZXRlcnMgYXJl
        IG9wdGlvbmFsKToKCiAgICBgYGBqYXZhc2NyaXB0CiAgICBmdW5jdGlvbihw
        cmV2aW91c1ZhbHVlLCBpdGVtLCBpbmRleCwgZW51bWVyYWJsZSk7CiAgICBg
        YGAKCiAgICAtIGBwcmV2aW91c1ZhbHVlYCBpcyB0aGUgdmFsdWUgcmV0dXJu
        ZWQgYnkgdGhlIGxhc3QgY2FsbCB0byB0aGUgaXRlcmF0b3IuCiAgICAtIGBp
        dGVtYCBpcyB0aGUgY3VycmVudCBpdGVtIGluIHRoZSBpdGVyYXRpb24uCiAg
        ICAtIGBpbmRleGAgaXMgdGhlIGN1cnJlbnQgaW5kZXggaW4gdGhlIGl0ZXJh
        dGlvbi4KICAgIC0gYGVudW1lcmFibGVgIGlzIHRoZSBlbnVtZXJhYmxlIG9i
        amVjdCBpdHNlbGYuCgogICAgUmV0dXJuIHRoZSBuZXcgY3VtdWxhdGl2ZSB2
        YWx1ZS4KCiAgICBJbiBhZGRpdGlvbiB0byB0aGUgY2FsbGJhY2sgeW91IGNh
        biBhbHNvIHBhc3MgYW4gYGluaXRpYWxWYWx1ZWAuIEFuIGVycm9yCiAgICB3
        aWxsIGJlIHJhaXNlZCBpZiB5b3UgZG8gbm90IHBhc3MgYW4gaW5pdGlhbCB2
        YWx1ZSBhbmQgdGhlIGVudW1lcmF0b3IgaXMKICAgIGVtcHR5LgoKICAgIE5v
        dGUgdGhhdCB1bmxpa2UgdGhlIG90aGVyIG1ldGhvZHMsIHRoaXMgbWV0aG9k
        IGRvZXMgbm90IGFsbG93IHlvdSB0bwogICAgcGFzcyBhIHRhcmdldCBvYmpl
        Y3QgdG8gc2V0IGFzIHRoaXMgZm9yIHRoZSBjYWxsYmFjay4gSXQncyBwYXJ0
        IG9mIHRoZQogICAgc3BlYy4gU29ycnkuCgogICAgQG1ldGhvZCByZWR1Y2UK
        ICAgIEBwYXJhbSB7RnVuY3Rpb259IGNhbGxiYWNrIFRoZSBjYWxsYmFjayB0
        byBleGVjdXRlCiAgICBAcGFyYW0ge09iamVjdH0gaW5pdGlhbFZhbHVlIElu
        aXRpYWwgdmFsdWUgZm9yIHRoZSByZWR1Y2UKICAgIEBwYXJhbSB7U3RyaW5n
        fSByZWR1Y2VyUHJvcGVydHkgaW50ZXJuYWwgdXNlIG9ubHkuCiAgICBAcmV0
        dXJuIHtPYmplY3R9IFRoZSByZWR1Y2VkIHZhbHVlLgogICovCiAgcmVkdWNl
        OiBmdW5jdGlvbihjYWxsYmFjaywgaW5pdGlhbFZhbHVlLCByZWR1Y2VyUHJv
        cGVydHkpIHsKICAgIGlmICh0eXBlb2YgY2FsbGJhY2sgIT09ICJmdW5jdGlv
        biIpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcigpOyB9CgogICAgdmFyIHJldCA9
        IGluaXRpYWxWYWx1ZTsKCiAgICB0aGlzLmZvckVhY2goZnVuY3Rpb24oaXRl
        bSwgaSkgewogICAgICByZXQgPSBjYWxsYmFjay5jYWxsKG51bGwsIHJldCwg
        aXRlbSwgaSwgdGhpcywgcmVkdWNlclByb3BlcnR5KTsKICAgIH0sIHRoaXMp
        OwoKICAgIHJldHVybiByZXQ7CiAgfSwKCiAgLyoqCiAgICBJbnZva2VzIHRo
        ZSBuYW1lZCBtZXRob2Qgb24gZXZlcnkgb2JqZWN0IGluIHRoZSByZWNlaXZl
        ciB0aGF0CiAgICBpbXBsZW1lbnRzIGl0LiBUaGlzIG1ldGhvZCBjb3JyZXNw
        b25kcyB0byB0aGUgaW1wbGVtZW50YXRpb24gaW4KICAgIFByb3RvdHlwZSAx
        LjYuCgogICAgQG1ldGhvZCBpbnZva2UKICAgIEBwYXJhbSB7U3RyaW5nfSBt
        ZXRob2ROYW1lIHRoZSBuYW1lIG9mIHRoZSBtZXRob2QKICAgIEBwYXJhbSB7
        T2JqZWN0Li4ufSBhcmdzIG9wdGlvbmFsIGFyZ3VtZW50cyB0byBwYXNzIGFz
        IHdlbGwuCiAgICBAcmV0dXJuIHtBcnJheX0gcmV0dXJuIHZhbHVlcyBmcm9t
        IGNhbGxpbmcgaW52b2tlLgogICovCiAgaW52b2tlOiBmdW5jdGlvbihtZXRo
        b2ROYW1lKSB7CiAgICB2YXIgYXJncywgcmV0ID0gRW1iZXIuQSgpOwogICAg
        aWYgKGFyZ3VtZW50cy5sZW5ndGg+MSkgYXJncyA9IGFfc2xpY2UuY2FsbChh
        cmd1bWVudHMsIDEpOwoKICAgIHRoaXMuZm9yRWFjaChmdW5jdGlvbih4LCBp
        ZHgpIHsKICAgICAgdmFyIG1ldGhvZCA9IHggJiYgeFttZXRob2ROYW1lXTsK
        ICAgICAgaWYgKCdmdW5jdGlvbicgPT09IHR5cGVvZiBtZXRob2QpIHsKICAg
        ICAgICByZXRbaWR4XSA9IGFyZ3MgPyBtZXRob2QuYXBwbHkoeCwgYXJncykg
        OiBtZXRob2QuY2FsbCh4KTsKICAgICAgfQogICAgfSwgdGhpcyk7CgogICAg
        cmV0dXJuIHJldDsKICB9LAoKICAvKioKICAgIFNpbXBseSBjb252ZXJ0cyB0
        aGUgZW51bWVyYWJsZSBpbnRvIGEgZ2VudWluZSBhcnJheS4gVGhlIG9yZGVy
        IGlzIG5vdAogICAgZ3VhcmFudGVlZC4gQ29ycmVzcG9uZHMgdG8gdGhlIG1l
        dGhvZCBpbXBsZW1lbnRlZCBieSBQcm90b3R5cGUuCgogICAgQG1ldGhvZCB0
        b0FycmF5CiAgICBAcmV0dXJuIHtBcnJheX0gdGhlIGVudW1lcmFibGUgYXMg
        YW4gYXJyYXkuCiAgKi8KICB0b0FycmF5OiBmdW5jdGlvbigpIHsKICAgIHZh
        ciByZXQgPSBFbWJlci5BKCk7CiAgICB0aGlzLmZvckVhY2goZnVuY3Rpb24o
        bywgaWR4KSB7IHJldFtpZHhdID0gbzsgfSk7CiAgICByZXR1cm4gcmV0IDsK
        ICB9LAoKICAvKioKICAgIFJldHVybnMgYSBjb3B5IG9mIHRoZSBhcnJheSB3
        aXRoIGFsbCBudWxsIGFuZCB1bmRlZmluZWQgZWxlbWVudHMgcmVtb3ZlZC4K
        CiAgICBgYGBqYXZhc2NyaXB0CiAgICB2YXIgYXJyID0gWyJhIiwgbnVsbCwg
        ImMiLCB1bmRlZmluZWRdOwogICAgYXJyLmNvbXBhY3QoKTsgIC8vIFsiYSIs
        ICJjIl0KICAgIGBgYAoKICAgIEBtZXRob2QgY29tcGFjdAogICAgQHJldHVy
        biB7QXJyYXl9IHRoZSBhcnJheSB3aXRob3V0IG51bGwgYW5kIHVuZGVmaW5l
        ZCBlbGVtZW50cy4KICAqLwogIGNvbXBhY3Q6IGZ1bmN0aW9uKCkgewogICAg
        cmV0dXJuIHRoaXMuZmlsdGVyKGZ1bmN0aW9uKHZhbHVlKSB7IHJldHVybiB2
        YWx1ZSAhPSBudWxsOyB9KTsKICB9LAoKICAvKioKICAgIFJldHVybnMgYSBu
        ZXcgZW51bWVyYWJsZSB0aGF0IGV4Y2x1ZGVzIHRoZSBwYXNzZWQgdmFsdWUu
        IFRoZSBkZWZhdWx0CiAgICBpbXBsZW1lbnRhdGlvbiByZXR1cm5zIGFuIGFy
        cmF5IHJlZ2FyZGxlc3Mgb2YgdGhlIHJlY2VpdmVyIHR5cGUgdW5sZXNzCiAg
        ICB0aGUgcmVjZWl2ZXIgZG9lcyBub3QgY29udGFpbiB0aGUgdmFsdWUuCgog
        ICAgYGBgamF2YXNjcmlwdAogICAgdmFyIGFyciA9IFsiYSIsICJiIiwgImEi
        LCAiYyJdOwogICAgYXJyLndpdGhvdXQoImEiKTsgIC8vIFsiYiIsICJjIl0K
        ICAgIGBgYAoKICAgIEBtZXRob2Qgd2l0aG91dAogICAgQHBhcmFtIHtPYmpl
        Y3R9IHZhbHVlCiAgICBAcmV0dXJuIHtFbWJlci5FbnVtZXJhYmxlfQogICov
        CiAgd2l0aG91dDogZnVuY3Rpb24odmFsdWUpIHsKICAgIGlmICghdGhpcy5j
        b250YWlucyh2YWx1ZSkpIHJldHVybiB0aGlzOyAvLyBub3RoaW5nIHRvIGRv
        CiAgICB2YXIgcmV0ID0gRW1iZXIuQSgpOwogICAgdGhpcy5mb3JFYWNoKGZ1
        bmN0aW9uKGspIHsKICAgICAgaWYgKGsgIT09IHZhbHVlKSByZXRbcmV0Lmxl
        bmd0aF0gPSBrOwogICAgfSkgOwogICAgcmV0dXJuIHJldCA7CiAgfSwKCiAg
        LyoqCiAgICBSZXR1cm5zIGEgbmV3IGVudW1lcmFibGUgdGhhdCBjb250YWlu
        cyBvbmx5IHVuaXF1ZSB2YWx1ZXMuIFRoZSBkZWZhdWx0CiAgICBpbXBsZW1l
        bnRhdGlvbiByZXR1cm5zIGFuIGFycmF5IHJlZ2FyZGxlc3Mgb2YgdGhlIHJl
        Y2VpdmVyIHR5cGUuCgogICAgYGBgamF2YXNjcmlwdAogICAgdmFyIGFyciA9
        IFsiYSIsICJhIiwgImIiLCAiYiJdOwogICAgYXJyLnVuaXEoKTsgIC8vIFsi
        YSIsICJiIl0KICAgIGBgYAoKICAgIEBtZXRob2QgdW5pcQogICAgQHJldHVy
        biB7RW1iZXIuRW51bWVyYWJsZX0KICAqLwogIHVuaXE6IGZ1bmN0aW9uKCkg
        ewogICAgdmFyIHJldCA9IEVtYmVyLkEoKTsKICAgIHRoaXMuZm9yRWFjaChm
        dW5jdGlvbihrKSB7CiAgICAgIGlmIChhX2luZGV4T2YocmV0LCBrKTwwKSBy
        ZXQucHVzaChrKTsKICAgIH0pOwogICAgcmV0dXJuIHJldDsKICB9LAoKICAv
        KioKICAgIFRoaXMgcHJvcGVydHkgd2lsbCB0cmlnZ2VyIGFueXRpbWUgdGhl
        IGVudW1lcmFibGUncyBjb250ZW50IGNoYW5nZXMuCiAgICBZb3UgY2FuIG9i
        c2VydmUgdGhpcyBwcm9wZXJ0eSB0byBiZSBub3RpZmllZCBvZiBjaGFuZ2Vz
        IHRvIHRoZSBlbnVtZXJhYmxlcwogICAgY29udGVudC4KCiAgICBGb3IgcGxh
        aW4gZW51bWVyYWJsZXMsIHRoaXMgcHJvcGVydHkgaXMgcmVhZCBvbmx5LiBg
        RW1iZXIuQXJyYXlgIG92ZXJyaWRlcwogICAgdGhpcyBtZXRob2QuCgogICAg
        QHByb3BlcnR5IFtdCiAgICBAdHlwZSBFbWJlci5BcnJheQogICAgQHJldHVy
        biB0aGlzCiAgKi8KICAnW10nOiBFbWJlci5jb21wdXRlZChmdW5jdGlvbihr
        ZXksIHZhbHVlKSB7CiAgICByZXR1cm4gdGhpczsKICB9KSwKCiAgLy8gLi4u
        Li4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4u
        Li4uLi4uLi4uLgogIC8vIEVOVU1FUkFCTEUgT0JTRVJWRVJTCiAgLy8KCiAg
        LyoqCiAgICBSZWdpc3RlcnMgYW4gZW51bWVyYWJsZSBvYnNlcnZlci4gTXVz
        dCBpbXBsZW1lbnQgYEVtYmVyLkVudW1lcmFibGVPYnNlcnZlcmAKICAgIG1p
        eGluLgoKICAgIEBtZXRob2QgYWRkRW51bWVyYWJsZU9ic2VydmVyCiAgICBA
        cGFyYW0ge09iamVjdH0gdGFyZ2V0CiAgICBAcGFyYW0ge0hhc2h9IFtvcHRz
        XQogICAgQHJldHVybiB0aGlzCiAgKi8KICBhZGRFbnVtZXJhYmxlT2JzZXJ2
        ZXI6IGZ1bmN0aW9uKHRhcmdldCwgb3B0cykgewogICAgdmFyIHdpbGxDaGFu
        Z2UgPSAob3B0cyAmJiBvcHRzLndpbGxDaGFuZ2UpIHx8ICdlbnVtZXJhYmxl
        V2lsbENoYW5nZScsCiAgICAgICAgZGlkQ2hhbmdlICA9IChvcHRzICYmIG9w
        dHMuZGlkQ2hhbmdlKSB8fCAnZW51bWVyYWJsZURpZENoYW5nZSc7CgogICAg
        dmFyIGhhc09ic2VydmVycyA9IGdldCh0aGlzLCAnaGFzRW51bWVyYWJsZU9i
        c2VydmVycycpOwogICAgaWYgKCFoYXNPYnNlcnZlcnMpIEVtYmVyLnByb3Bl
        cnR5V2lsbENoYW5nZSh0aGlzLCAnaGFzRW51bWVyYWJsZU9ic2VydmVycycp
        OwogICAgRW1iZXIuYWRkTGlzdGVuZXIodGhpcywgJ0BlbnVtZXJhYmxlOmJl
        Zm9yZScsIHRhcmdldCwgd2lsbENoYW5nZSk7CiAgICBFbWJlci5hZGRMaXN0
        ZW5lcih0aGlzLCAnQGVudW1lcmFibGU6Y2hhbmdlJywgdGFyZ2V0LCBkaWRD
        aGFuZ2UpOwogICAgaWYgKCFoYXNPYnNlcnZlcnMpIEVtYmVyLnByb3BlcnR5
        RGlkQ2hhbmdlKHRoaXMsICdoYXNFbnVtZXJhYmxlT2JzZXJ2ZXJzJyk7CiAg
        ICByZXR1cm4gdGhpczsKICB9LAoKICAvKioKICAgIFJlbW92ZXMgYSByZWdp
        c3RlcmVkIGVudW1lcmFibGUgb2JzZXJ2ZXIuCgogICAgQG1ldGhvZCByZW1v
        dmVFbnVtZXJhYmxlT2JzZXJ2ZXIKICAgIEBwYXJhbSB7T2JqZWN0fSB0YXJn
        ZXQKICAgIEBwYXJhbSB7SGFzaH0gW29wdHNdCiAgICBAcmV0dXJuIHRoaXMK
        ICAqLwogIHJlbW92ZUVudW1lcmFibGVPYnNlcnZlcjogZnVuY3Rpb24odGFy
        Z2V0LCBvcHRzKSB7CiAgICB2YXIgd2lsbENoYW5nZSA9IChvcHRzICYmIG9w
        dHMud2lsbENoYW5nZSkgfHwgJ2VudW1lcmFibGVXaWxsQ2hhbmdlJywKICAg
        ICAgICBkaWRDaGFuZ2UgID0gKG9wdHMgJiYgb3B0cy5kaWRDaGFuZ2UpIHx8
        ICdlbnVtZXJhYmxlRGlkQ2hhbmdlJzsKCiAgICB2YXIgaGFzT2JzZXJ2ZXJz
        ID0gZ2V0KHRoaXMsICdoYXNFbnVtZXJhYmxlT2JzZXJ2ZXJzJyk7CiAgICBp
        ZiAoaGFzT2JzZXJ2ZXJzKSBFbWJlci5wcm9wZXJ0eVdpbGxDaGFuZ2UodGhp
        cywgJ2hhc0VudW1lcmFibGVPYnNlcnZlcnMnKTsKICAgIEVtYmVyLnJlbW92
        ZUxpc3RlbmVyKHRoaXMsICdAZW51bWVyYWJsZTpiZWZvcmUnLCB0YXJnZXQs
        IHdpbGxDaGFuZ2UpOwogICAgRW1iZXIucmVtb3ZlTGlzdGVuZXIodGhpcywg
        J0BlbnVtZXJhYmxlOmNoYW5nZScsIHRhcmdldCwgZGlkQ2hhbmdlKTsKICAg
        IGlmIChoYXNPYnNlcnZlcnMpIEVtYmVyLnByb3BlcnR5RGlkQ2hhbmdlKHRo
        aXMsICdoYXNFbnVtZXJhYmxlT2JzZXJ2ZXJzJyk7CiAgICByZXR1cm4gdGhp
        czsKICB9LAoKICAvKioKICAgIEJlY29tZXMgdHJ1ZSB3aGVuZXZlciB0aGUg
        YXJyYXkgY3VycmVudGx5IGhhcyBvYnNlcnZlcnMgd2F0Y2hpbmcgY2hhbmdl
        cwogICAgb24gdGhlIGFycmF5LgoKICAgIEBwcm9wZXJ0eSBoYXNFbnVtZXJh
        YmxlT2JzZXJ2ZXJzCiAgICBAdHlwZSBCb29sZWFuCiAgKi8KICBoYXNFbnVt
        ZXJhYmxlT2JzZXJ2ZXJzOiBFbWJlci5jb21wdXRlZChmdW5jdGlvbigpIHsK
        ICAgIHJldHVybiBFbWJlci5oYXNMaXN0ZW5lcnModGhpcywgJ0BlbnVtZXJh
        YmxlOmNoYW5nZScpIHx8IEVtYmVyLmhhc0xpc3RlbmVycyh0aGlzLCAnQGVu
        dW1lcmFibGU6YmVmb3JlJyk7CiAgfSksCgoKICAvKioKICAgIEludm9rZSB0
        aGlzIG1ldGhvZCBqdXN0IGJlZm9yZSB0aGUgY29udGVudHMgb2YgeW91ciBl
        bnVtZXJhYmxlIHdpbGwKICAgIGNoYW5nZS4gWW91IGNhbiBlaXRoZXIgb21p
        dCB0aGUgcGFyYW1ldGVycyBjb21wbGV0ZWx5IG9yIHBhc3MgdGhlIG9iamVj
        dHMKICAgIHRvIGJlIHJlbW92ZWQgb3IgYWRkZWQgaWYgYXZhaWxhYmxlIG9y
        IGp1c3QgYSBjb3VudC4KCiAgICBAbWV0aG9kIGVudW1lcmFibGVDb250ZW50
        V2lsbENoYW5nZQogICAgQHBhcmFtIHtFbWJlci5FbnVtZXJhYmxlfE51bWJl
        cn0gcmVtb3ZpbmcgQW4gZW51bWVyYWJsZSBvZiB0aGUgb2JqZWN0cyB0bwog
        ICAgICBiZSByZW1vdmVkIG9yIHRoZSBudW1iZXIgb2YgaXRlbXMgdG8gYmUg
        cmVtb3ZlZC4KICAgIEBwYXJhbSB7RW1iZXIuRW51bWVyYWJsZXxOdW1iZXJ9
        IGFkZGluZyBBbiBlbnVtZXJhYmxlIG9mIHRoZSBvYmplY3RzIHRvIGJlCiAg
        ICAgIGFkZGVkIG9yIHRoZSBudW1iZXIgb2YgaXRlbXMgdG8gYmUgYWRkZWQu
        CiAgICBAY2hhaW5hYmxlCiAgKi8KICBlbnVtZXJhYmxlQ29udGVudFdpbGxD
        aGFuZ2U6IGZ1bmN0aW9uKHJlbW92aW5nLCBhZGRpbmcpIHsKCiAgICB2YXIg
        cmVtb3ZlQ250LCBhZGRDbnQsIGhhc0RlbHRhOwoKICAgIGlmICgnbnVtYmVy
        JyA9PT0gdHlwZW9mIHJlbW92aW5nKSByZW1vdmVDbnQgPSByZW1vdmluZzsK
        ICAgIGVsc2UgaWYgKHJlbW92aW5nKSByZW1vdmVDbnQgPSBnZXQocmVtb3Zp
        bmcsICdsZW5ndGgnKTsKICAgIGVsc2UgcmVtb3ZlQ250ID0gcmVtb3Zpbmcg
        PSAtMTsKCiAgICBpZiAoJ251bWJlcicgPT09IHR5cGVvZiBhZGRpbmcpIGFk
        ZENudCA9IGFkZGluZzsKICAgIGVsc2UgaWYgKGFkZGluZykgYWRkQ250ID0g
        Z2V0KGFkZGluZywnbGVuZ3RoJyk7CiAgICBlbHNlIGFkZENudCA9IGFkZGlu
        ZyA9IC0xOwoKICAgIGhhc0RlbHRhID0gYWRkQ250PDAgfHwgcmVtb3ZlQ250
        PDAgfHwgYWRkQ250LXJlbW92ZUNudCE9PTA7CgogICAgaWYgKHJlbW92aW5n
        ID09PSAtMSkgcmVtb3ZpbmcgPSBudWxsOwogICAgaWYgKGFkZGluZyAgID09
        PSAtMSkgYWRkaW5nICAgPSBudWxsOwoKICAgIEVtYmVyLnByb3BlcnR5V2ls
        bENoYW5nZSh0aGlzLCAnW10nKTsKICAgIGlmIChoYXNEZWx0YSkgRW1iZXIu
        cHJvcGVydHlXaWxsQ2hhbmdlKHRoaXMsICdsZW5ndGgnKTsKICAgIEVtYmVy
        LnNlbmRFdmVudCh0aGlzLCAnQGVudW1lcmFibGU6YmVmb3JlJywgW3RoaXMs
        IHJlbW92aW5nLCBhZGRpbmddKTsKCiAgICByZXR1cm4gdGhpczsKICB9LAoK
        ICAvKioKICAgIEludm9rZSB0aGlzIG1ldGhvZCB3aGVuIHRoZSBjb250ZW50
        cyBvZiB5b3VyIGVudW1lcmFibGUgaGFzIGNoYW5nZWQuCiAgICBUaGlzIHdp
        bGwgbm90aWZ5IGFueSBvYnNlcnZlcnMgd2F0Y2hpbmcgZm9yIGNvbnRlbnQg
        Y2hhbmdlcy4gSWYgeW91ciBhcmUKICAgIGltcGxlbWVudGluZyBhbiBvcmRl
        cmVkIGVudW1lcmFibGUgKHN1Y2ggYXMgYW4gYXJyYXkpLCBhbHNvIHBhc3Mg
        dGhlCiAgICBzdGFydCBhbmQgZW5kIHZhbHVlcyB3aGVyZSB0aGUgY29udGVu
        dCBjaGFuZ2VkIHNvIHRoYXQgaXQgY2FuIGJlIHVzZWQgdG8KICAgIG5vdGlm
        eSByYW5nZSBvYnNlcnZlcnMuCgogICAgQG1ldGhvZCBlbnVtZXJhYmxlQ29u
        dGVudERpZENoYW5nZQogICAgQHBhcmFtIHtOdW1iZXJ9IFtzdGFydF0gb3B0
        aW9uYWwgc3RhcnQgb2Zmc2V0IGZvciB0aGUgY29udGVudCBjaGFuZ2UuCiAg
        ICAgIEZvciB1bm9yZGVyZWQgZW51bWVyYWJsZXMsIHlvdSBzaG91bGQgYWx3
        YXlzIHBhc3MgLTEuCiAgICBAcGFyYW0ge0VtYmVyLkVudW1lcmFibGV8TnVt
        YmVyfSByZW1vdmluZyBBbiBlbnVtZXJhYmxlIG9mIHRoZSBvYmplY3RzIHRv
        CiAgICAgIGJlIHJlbW92ZWQgb3IgdGhlIG51bWJlciBvZiBpdGVtcyB0byBi
        ZSByZW1vdmVkLgogICAgQHBhcmFtIHtFbWJlci5FbnVtZXJhYmxlfE51bWJl
        cn0gYWRkaW5nICBBbiBlbnVtZXJhYmxlIG9mIHRoZSBvYmplY3RzIHRvCiAg
        ICAgIGJlIGFkZGVkIG9yIHRoZSBudW1iZXIgb2YgaXRlbXMgdG8gYmUgYWRk
        ZWQuCiAgICBAY2hhaW5hYmxlCiAgKi8KICBlbnVtZXJhYmxlQ29udGVudERp
        ZENoYW5nZTogZnVuY3Rpb24ocmVtb3ZpbmcsIGFkZGluZykgewogICAgdmFy
        IHJlbW92ZUNudCwgYWRkQ250LCBoYXNEZWx0YTsKCiAgICBpZiAoJ251bWJl
        cicgPT09IHR5cGVvZiByZW1vdmluZykgcmVtb3ZlQ250ID0gcmVtb3Zpbmc7
        CiAgICBlbHNlIGlmIChyZW1vdmluZykgcmVtb3ZlQ250ID0gZ2V0KHJlbW92
        aW5nLCAnbGVuZ3RoJyk7CiAgICBlbHNlIHJlbW92ZUNudCA9IHJlbW92aW5n
        ID0gLTE7CgogICAgaWYgKCdudW1iZXInID09PSB0eXBlb2YgYWRkaW5nKSBh
        ZGRDbnQgPSBhZGRpbmc7CiAgICBlbHNlIGlmIChhZGRpbmcpIGFkZENudCA9
        IGdldChhZGRpbmcsICdsZW5ndGgnKTsKICAgIGVsc2UgYWRkQ250ID0gYWRk
        aW5nID0gLTE7CgogICAgaGFzRGVsdGEgPSBhZGRDbnQ8MCB8fCByZW1vdmVD
        bnQ8MCB8fCBhZGRDbnQtcmVtb3ZlQ250IT09MDsKCiAgICBpZiAocmVtb3Zp
        bmcgPT09IC0xKSByZW1vdmluZyA9IG51bGw7CiAgICBpZiAoYWRkaW5nICAg
        PT09IC0xKSBhZGRpbmcgICA9IG51bGw7CgogICAgRW1iZXIuc2VuZEV2ZW50
        KHRoaXMsICdAZW51bWVyYWJsZTpjaGFuZ2UnLCBbdGhpcywgcmVtb3Zpbmcs
        IGFkZGluZ10pOwogICAgaWYgKGhhc0RlbHRhKSBFbWJlci5wcm9wZXJ0eURp
        ZENoYW5nZSh0aGlzLCAnbGVuZ3RoJyk7CiAgICBFbWJlci5wcm9wZXJ0eURp
        ZENoYW5nZSh0aGlzLCAnW10nKTsKCiAgICByZXR1cm4gdGhpcyA7CiAgfQoK
        fSkgOwoKfSkoKTsKCgoKKGZ1bmN0aW9uKCkgewovKioKQG1vZHVsZSBlbWJl
        cgpAc3VibW9kdWxlIGVtYmVyLXJ1bnRpbWUKKi8KCi8vIC4uLi4uLi4uLi4u
        Li4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4u
        Li4KLy8gSEVMUEVSUwovLwoKdmFyIGdldCA9IEVtYmVyLmdldCwgc2V0ID0g
        RW1iZXIuc2V0LCBpc05vbmUgPSBFbWJlci5pc05vbmUsIG1hcCA9IEVtYmVy
        LkVudW1lcmFibGVVdGlscy5tYXAsIGNhY2hlRm9yID0gRW1iZXIuY2FjaGVG
        b3I7CgovLyAuLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4u
        Li4uLi4uLi4uLi4uLi4uLi4uLi4uCi8vIEFSUkFZCi8vCi8qKgogIFRoaXMg
        bW9kdWxlIGltcGxlbWVudHMgT2JzZXJ2ZXItZnJpZW5kbHkgQXJyYXktbGlr
        ZSBiZWhhdmlvci4gVGhpcyBtaXhpbiBpcwogIHBpY2tlZCB1cCBieSB0aGUg
        QXJyYXkgY2xhc3MgYXMgd2VsbCBhcyBvdGhlciBjb250cm9sbGVycywgZXRj
        LiB0aGF0IHdhbnQgdG8KICBhcHBlYXIgdG8gYmUgYXJyYXlzLgoKICBVbmxp
        a2UgYEVtYmVyLkVudW1lcmFibGUsYCB0aGlzIG1peGluIGRlZmluZXMgbWV0
        aG9kcyBzcGVjaWZpY2FsbHkgZm9yCiAgY29sbGVjdGlvbnMgdGhhdCBwcm92
        aWRlIGluZGV4LW9yZGVyZWQgYWNjZXNzIHRvIHRoZWlyIGNvbnRlbnRzLiBX
        aGVuIHlvdQogIGFyZSBkZXNpZ25pbmcgY29kZSB0aGF0IG5lZWRzIHRvIGFj
        Y2VwdCBhbnkga2luZCBvZiBBcnJheS1saWtlIG9iamVjdCwgeW91CiAgc2hv
        dWxkIHVzZSB0aGVzZSBtZXRob2RzIGluc3RlYWQgb2YgQXJyYXkgcHJpbWl0
        aXZlcyBiZWNhdXNlIHRoZXNlIHdpbGwKICBwcm9wZXJseSBub3RpZnkgb2Jz
        ZXJ2ZXJzIG9mIGNoYW5nZXMgdG8gdGhlIGFycmF5LgoKICBBbHRob3VnaCB0
        aGVzZSBtZXRob2RzIGFyZSBlZmZpY2llbnQsIHRoZXkgZG8gYWRkIGEgbGF5
        ZXIgb2YgaW5kaXJlY3Rpb24gdG8KICB5b3VyIGFwcGxpY2F0aW9uIHNvIGl0
        IGlzIGEgZ29vZCBpZGVhIHRvIHVzZSB0aGVtIG9ubHkgd2hlbiB5b3UgbmVl
        ZCB0aGUKICBmbGV4aWJpbGl0eSBvZiB1c2luZyBib3RoIHRydWUgSmF2YVNj
        cmlwdCBhcnJheXMgYW5kICJ2aXJ0dWFsIiBhcnJheXMgc3VjaAogIGFzIGNv
        bnRyb2xsZXJzIGFuZCBjb2xsZWN0aW9ucy4KCiAgWW91IGNhbiB1c2UgdGhl
        IG1ldGhvZHMgZGVmaW5lZCBpbiB0aGlzIG1vZHVsZSB0byBhY2Nlc3MgYW5k
        IG1vZGlmeSBhcnJheQogIGNvbnRlbnRzIGluIGEgS1ZPLWZyaWVuZGx5IHdh
        eS4gWW91IGNhbiBhbHNvIGJlIG5vdGlmaWVkIHdoZW5ldmVyIHRoZQogIG1l
        bWJlcnNoaXAgb2YgYW4gYXJyYXkgY2hhbmdlcyBieSBjaGFuZ2luZyB0aGUg
        c3ludGF4IG9mIHRoZSBwcm9wZXJ0eSB0bwogIGAub2JzZXJ2ZXMoJypteVBy
        b3BlcnR5LltdJylgLgoKICBUbyBzdXBwb3J0IGBFbWJlci5BcnJheWAgaW4g
        eW91ciBvd24gY2xhc3MsIHlvdSBtdXN0IG92ZXJyaWRlIHR3bwogIHByaW1p
        dGl2ZXMgdG8gdXNlIGl0OiBgcmVwbGFjZSgpYCBhbmQgYG9iamVjdEF0KClg
        LgoKICBOb3RlIHRoYXQgdGhlIEVtYmVyLkFycmF5IG1peGluIGFsc28gaW5j
        b3Jwb3JhdGVzIHRoZSBgRW1iZXIuRW51bWVyYWJsZWAKICBtaXhpbi4gQWxs
        IGBFbWJlci5BcnJheWAtbGlrZSBvYmplY3RzIGFyZSBhbHNvIGVudW1lcmFi
        bGUuCgogIEBjbGFzcyBBcnJheQogIEBuYW1lc3BhY2UgRW1iZXIKICBAdXNl
        cyBFbWJlci5FbnVtZXJhYmxlCiAgQHNpbmNlIEVtYmVyIDAuOS4wCiovCkVt
        YmVyLkFycmF5ID0gRW1iZXIuTWl4aW4uY3JlYXRlKEVtYmVyLkVudW1lcmFi
        bGUsIC8qKiBAc2NvcGUgRW1iZXIuQXJyYXkucHJvdG90eXBlICovIHsKCiAg
        LyoqCiAgICBZb3VyIGFycmF5IG11c3Qgc3VwcG9ydCB0aGUgYGxlbmd0aGAg
        cHJvcGVydHkuIFlvdXIgcmVwbGFjZSBtZXRob2RzIHNob3VsZAogICAgc2V0
        IHRoaXMgcHJvcGVydHkgd2hlbmV2ZXIgaXQgY2hhbmdlcy4KCiAgICBAcHJv
        cGVydHkge051bWJlcn0gbGVuZ3RoCiAgKi8KICBsZW5ndGg6IEVtYmVyLnJl
        cXVpcmVkKCksCgogIC8qKgogICAgUmV0dXJucyB0aGUgb2JqZWN0IGF0IHRo
        ZSBnaXZlbiBgaW5kZXhgLiBJZiB0aGUgZ2l2ZW4gYGluZGV4YCBpcyBuZWdh
        dGl2ZQogICAgb3IgaXMgZ3JlYXRlciBvciBlcXVhbCB0aGFuIHRoZSBhcnJh
        eSBsZW5ndGgsIHJldHVybnMgYHVuZGVmaW5lZGAuCgogICAgVGhpcyBpcyBv
        bmUgb2YgdGhlIHByaW1pdGl2ZXMgeW91IG11c3QgaW1wbGVtZW50IHRvIHN1
        cHBvcnQgYEVtYmVyLkFycmF5YC4KICAgIElmIHlvdXIgb2JqZWN0IHN1cHBv
        cnRzIHJldHJpZXZpbmcgdGhlIHZhbHVlIG9mIGFuIGFycmF5IGl0ZW0gdXNp
        bmcgYGdldCgpYAogICAgKGkuZS4gYG15QXJyYXkuZ2V0KDApYCksIHRoZW4g
        eW91IGRvIG5vdCBuZWVkIHRvIGltcGxlbWVudCB0aGlzIG1ldGhvZAogICAg
        eW91cnNlbGYuCgogICAgYGBgamF2YXNjcmlwdAogICAgdmFyIGFyciA9IFsn
        YScsICdiJywgJ2MnLCAnZCddOwogICAgYXJyLm9iamVjdEF0KDApOyAgIC8v
        ICJhIgogICAgYXJyLm9iamVjdEF0KDMpOyAgIC8vICJkIgogICAgYXJyLm9i
        amVjdEF0KC0xKTsgIC8vIHVuZGVmaW5lZAogICAgYXJyLm9iamVjdEF0KDQp
        OyAgIC8vIHVuZGVmaW5lZAogICAgYXJyLm9iamVjdEF0KDUpOyAgIC8vIHVu
        ZGVmaW5lZAogICAgYGBgCgogICAgQG1ldGhvZCBvYmplY3RBdAogICAgQHBh
        cmFtIHtOdW1iZXJ9IGlkeCBUaGUgaW5kZXggb2YgdGhlIGl0ZW0gdG8gcmV0
        dXJuLgogICAgQHJldHVybiB7Kn0gaXRlbSBhdCBpbmRleCBvciB1bmRlZmlu
        ZWQKICAqLwogIG9iamVjdEF0OiBmdW5jdGlvbihpZHgpIHsKICAgIGlmICgo
        aWR4IDwgMCkgfHwgKGlkeD49Z2V0KHRoaXMsICdsZW5ndGgnKSkpIHJldHVy
        biB1bmRlZmluZWQgOwogICAgcmV0dXJuIGdldCh0aGlzLCBpZHgpOwogIH0s
        CgogIC8qKgogICAgVGhpcyByZXR1cm5zIHRoZSBvYmplY3RzIGF0IHRoZSBz
        cGVjaWZpZWQgaW5kZXhlcywgdXNpbmcgYG9iamVjdEF0YC4KCiAgICBgYGBq
        YXZhc2NyaXB0CiAgICB2YXIgYXJyID3CoFsnYScsICdiJywgJ2MnLCAnZCdd
        OwogICAgYXJyLm9iamVjdHNBdChbMCwgMSwgMl0pOyAgLy8gWyJhIiwgImIi
        LCAiYyJdCiAgICBhcnIub2JqZWN0c0F0KFsyLCAzLCA0XSk7ICAvLyBbImMi
        LCAiZCIsIHVuZGVmaW5lZF0KICAgIGBgYAoKICAgIEBtZXRob2Qgb2JqZWN0
        c0F0CiAgICBAcGFyYW0ge0FycmF5fSBpbmRleGVzIEFuIGFycmF5IG9mIGlu
        ZGV4ZXMgb2YgaXRlbXMgdG8gcmV0dXJuLgogICAgQHJldHVybiB7QXJyYXl9
        CiAgICovCiAgb2JqZWN0c0F0OiBmdW5jdGlvbihpbmRleGVzKSB7CiAgICB2
        YXIgc2VsZiA9IHRoaXM7CiAgICByZXR1cm4gbWFwKGluZGV4ZXMsIGZ1bmN0
        aW9uKGlkeCkgeyByZXR1cm4gc2VsZi5vYmplY3RBdChpZHgpOyB9KTsKICB9
        LAoKICAvLyBvdmVycmlkZXMgRW1iZXIuRW51bWVyYWJsZSB2ZXJzaW9uCiAg
        bmV4dE9iamVjdDogZnVuY3Rpb24oaWR4KSB7CiAgICByZXR1cm4gdGhpcy5v
        YmplY3RBdChpZHgpOwogIH0sCgogIC8qKgogICAgVGhpcyBpcyB0aGUgaGFu
        ZGxlciBmb3IgdGhlIHNwZWNpYWwgYXJyYXkgY29udGVudCBwcm9wZXJ0eS4g
        SWYgeW91IGdldAogICAgdGhpcyBwcm9wZXJ0eSwgaXQgd2lsbCByZXR1cm4g
        dGhpcy4gSWYgeW91IHNldCB0aGlzIHByb3BlcnR5IGl0IGEgbmV3CiAgICBh
        cnJheSwgaXQgd2lsbCByZXBsYWNlIHRoZSBjdXJyZW50IGNvbnRlbnQuCgog
        ICAgVGhpcyBwcm9wZXJ0eSBvdmVycmlkZXMgdGhlIGRlZmF1bHQgcHJvcGVy
        dHkgZGVmaW5lZCBpbiBgRW1iZXIuRW51bWVyYWJsZWAuCgogICAgQHByb3Bl
        cnR5IFtdCiAgICBAcmV0dXJuIHRoaXMKICAqLwogICdbXSc6IEVtYmVyLmNv
        bXB1dGVkKGZ1bmN0aW9uKGtleSwgdmFsdWUpIHsKICAgIGlmICh2YWx1ZSAh
        PT0gdW5kZWZpbmVkKSB0aGlzLnJlcGxhY2UoMCwgZ2V0KHRoaXMsICdsZW5n
        dGgnKSwgdmFsdWUpIDsKICAgIHJldHVybiB0aGlzIDsKICB9KSwKCiAgZmly
        c3RPYmplY3Q6IEVtYmVyLmNvbXB1dGVkKGZ1bmN0aW9uKCkgewogICAgcmV0
        dXJuIHRoaXMub2JqZWN0QXQoMCk7CiAgfSksCgogIGxhc3RPYmplY3Q6IEVt
        YmVyLmNvbXB1dGVkKGZ1bmN0aW9uKCkgewogICAgcmV0dXJuIHRoaXMub2Jq
        ZWN0QXQoZ2V0KHRoaXMsICdsZW5ndGgnKS0xKTsKICB9KSwKCiAgLy8gb3B0
        aW1pemVkIHZlcnNpb24gZnJvbSBFbnVtZXJhYmxlCiAgY29udGFpbnM6IGZ1
        bmN0aW9uKG9iaikgewogICAgcmV0dXJuIHRoaXMuaW5kZXhPZihvYmopID49
        IDA7CiAgfSwKCiAgLy8gQWRkIGFueSBleHRyYSBtZXRob2RzIHRvIEVtYmVy
        LkFycmF5IHRoYXQgYXJlIG5hdGl2ZSB0byB0aGUgYnVpbHQtaW4gQXJyYXku
        CiAgLyoqCiAgICBSZXR1cm5zIGEgbmV3IGFycmF5IHRoYXQgaXMgYSBzbGlj
        ZSBvZiB0aGUgcmVjZWl2ZXIuIFRoaXMgaW1wbGVtZW50YXRpb24KICAgIHVz
        ZXMgdGhlIG9ic2VydmFibGUgYXJyYXkgbWV0aG9kcyB0byByZXRyaWV2ZSB0
        aGUgb2JqZWN0cyBmb3IgdGhlIG5ldwogICAgc2xpY2UuCgogICAgYGBgamF2
        YXNjcmlwdAogICAgdmFyIGFyciA9IFsncmVkJywgJ2dyZWVuJywgJ2JsdWUn
        XTsKICAgIGFyci5zbGljZSgwKTsgICAgICAgLy8gWydyZWQnLCAnZ3JlZW4n
        LCAnYmx1ZSddCiAgICBhcnIuc2xpY2UoMCwgMik7ICAgIC8vIFsncmVkJywg
        J2dyZWVuJ10KICAgIGFyci5zbGljZSgxLCAxMDApOyAgLy8gWydncmVlbics
        ICdibHVlJ10KICAgIGBgYAoKICAgIEBtZXRob2Qgc2xpY2UKICAgIEBwYXJh
        bSB7SW50ZWdlcn0gYmVnaW5JbmRleCAoT3B0aW9uYWwpIGluZGV4IHRvIGJl
        Z2luIHNsaWNpbmcgZnJvbS4KICAgIEBwYXJhbSB7SW50ZWdlcn0gZW5kSW5k
        ZXggKE9wdGlvbmFsKSBpbmRleCB0byBlbmQgdGhlIHNsaWNlIGF0LgogICAg
        QHJldHVybiB7QXJyYXl9IE5ldyBhcnJheSB3aXRoIHNwZWNpZmllZCBzbGlj
        ZQogICovCiAgc2xpY2U6IGZ1bmN0aW9uKGJlZ2luSW5kZXgsIGVuZEluZGV4
        KSB7CiAgICB2YXIgcmV0ID0gRW1iZXIuQSgpOwogICAgdmFyIGxlbmd0aCA9
        IGdldCh0aGlzLCAnbGVuZ3RoJykgOwogICAgaWYgKGlzTm9uZShiZWdpbklu
        ZGV4KSkgYmVnaW5JbmRleCA9IDAgOwogICAgaWYgKGlzTm9uZShlbmRJbmRl
        eCkgfHwgKGVuZEluZGV4ID4gbGVuZ3RoKSkgZW5kSW5kZXggPSBsZW5ndGgg
        OwoKICAgIGlmIChiZWdpbkluZGV4IDwgMCkgYmVnaW5JbmRleCA9IGxlbmd0
        aCArIGJlZ2luSW5kZXg7CiAgICBpZiAoZW5kSW5kZXggPCAwKSBlbmRJbmRl
        eCA9IGxlbmd0aCArIGVuZEluZGV4OwoKICAgIHdoaWxlKGJlZ2luSW5kZXgg
        PCBlbmRJbmRleCkgewogICAgICByZXRbcmV0Lmxlbmd0aF0gPSB0aGlzLm9i
        amVjdEF0KGJlZ2luSW5kZXgrKykgOwogICAgfQogICAgcmV0dXJuIHJldCA7
        CiAgfSwKCiAgLyoqCiAgICBSZXR1cm5zIHRoZSBpbmRleCBvZiB0aGUgZ2l2
        ZW4gb2JqZWN0J3MgZmlyc3Qgb2NjdXJyZW5jZS4KICAgIElmIG5vIGBzdGFy
        dEF0YCBhcmd1bWVudCBpcyBnaXZlbiwgdGhlIHN0YXJ0aW5nIGxvY2F0aW9u
        IHRvCiAgICBzZWFyY2ggaXMgMC4gSWYgaXQncyBuZWdhdGl2ZSwgd2lsbCBj
        b3VudCBiYWNrd2FyZCBmcm9tCiAgICB0aGUgZW5kIG9mIHRoZSBhcnJheS4g
        UmV0dXJucyAtMSBpZiBubyBtYXRjaCBpcyBmb3VuZC4KCiAgICBgYGBqYXZh
        c2NyaXB0CiAgICB2YXIgYXJyID0gWyJhIiwgImIiLCAiYyIsICJkIiwgImEi
        XTsKICAgIGFyci5pbmRleE9mKCJhIik7ICAgICAgIC8vICAwCiAgICBhcnIu
        aW5kZXhPZigieiIpOyAgICAgICAvLyAtMQogICAgYXJyLmluZGV4T2YoImEi
        LCAyKTsgICAgLy8gIDQKICAgIGFyci5pbmRleE9mKCJhIiwgLTEpOyAgIC8v
        ICA0CiAgICBhcnIuaW5kZXhPZigiYiIsIDMpOyAgICAvLyAtMQogICAgYXJy
        LmluZGV4T2YoImEiLCAxMDApOyAgLy8gLTEKICAgIGBgYAoKICAgIEBtZXRo
        b2QgaW5kZXhPZgogICAgQHBhcmFtIHtPYmplY3R9IG9iamVjdCB0aGUgaXRl
        bSB0byBzZWFyY2ggZm9yCiAgICBAcGFyYW0ge051bWJlcn0gc3RhcnRBdCBv
        cHRpb25hbCBzdGFydGluZyBsb2NhdGlvbiB0byBzZWFyY2gsIGRlZmF1bHQg
        MAogICAgQHJldHVybiB7TnVtYmVyfSBpbmRleCBvciAtMSBpZiBub3QgZm91
        bmQKICAqLwogIGluZGV4T2Y6IGZ1bmN0aW9uKG9iamVjdCwgc3RhcnRBdCkg
        ewogICAgdmFyIGlkeCwgbGVuID0gZ2V0KHRoaXMsICdsZW5ndGgnKTsKCiAg
        ICBpZiAoc3RhcnRBdCA9PT0gdW5kZWZpbmVkKSBzdGFydEF0ID0gMDsKICAg
        IGlmIChzdGFydEF0IDwgMCkgc3RhcnRBdCArPSBsZW47CgogICAgZm9yKGlk
        eD1zdGFydEF0O2lkeDxsZW47aWR4KyspIHsKICAgICAgaWYgKHRoaXMub2Jq
        ZWN0QXQoaWR4KSA9PT0gb2JqZWN0KSByZXR1cm4gaWR4IDsKICAgIH0KICAg
        IHJldHVybiAtMTsKICB9LAoKICAvKioKICAgIFJldHVybnMgdGhlIGluZGV4
        IG9mIHRoZSBnaXZlbiBvYmplY3QncyBsYXN0IG9jY3VycmVuY2UuCiAgICBJ
        ZiBubyBgc3RhcnRBdGAgYXJndW1lbnQgaXMgZ2l2ZW4sIHRoZSBzZWFyY2gg
        c3RhcnRzIGZyb20KICAgIHRoZSBsYXN0IHBvc2l0aW9uLiBJZiBpdCdzIG5l
        Z2F0aXZlLCB3aWxsIGNvdW50IGJhY2t3YXJkCiAgICBmcm9tIHRoZSBlbmQg
        b2YgdGhlIGFycmF5LiBSZXR1cm5zIC0xIGlmIG5vIG1hdGNoIGlzIGZvdW5k
        LgoKICAgIGBgYGphdmFzY3JpcHQKICAgIHZhciBhcnIgPSBbImEiLCAiYiIs
        ICJjIiwgImQiLCAiYSJdOwogICAgYXJyLmxhc3RJbmRleE9mKCJhIik7ICAg
        ICAgIC8vICA0CiAgICBhcnIubGFzdEluZGV4T2YoInoiKTsgICAgICAgLy8g
        LTEKICAgIGFyci5sYXN0SW5kZXhPZigiYSIsIDIpOyAgICAvLyAgMAogICAg
        YXJyLmxhc3RJbmRleE9mKCJhIiwgLTEpOyAgIC8vICA0CiAgICBhcnIubGFz
        dEluZGV4T2YoImIiLCAzKTsgICAgLy8gIDEKICAgIGFyci5sYXN0SW5kZXhP
        ZigiYSIsIDEwMCk7ICAvLyAgNAogICAgYGBgCgogICAgQG1ldGhvZCBsYXN0
        SW5kZXhPZgogICAgQHBhcmFtIHtPYmplY3R9IG9iamVjdCB0aGUgaXRlbSB0
        byBzZWFyY2ggZm9yCiAgICBAcGFyYW0ge051bWJlcn0gc3RhcnRBdCBvcHRp
        b25hbCBzdGFydGluZyBsb2NhdGlvbiB0byBzZWFyY2gsIGRlZmF1bHQgMAog
        ICAgQHJldHVybiB7TnVtYmVyfSBpbmRleCBvciAtMSBpZiBub3QgZm91bmQK
        ICAqLwogIGxhc3RJbmRleE9mOiBmdW5jdGlvbihvYmplY3QsIHN0YXJ0QXQp
        IHsKICAgIHZhciBpZHgsIGxlbiA9IGdldCh0aGlzLCAnbGVuZ3RoJyk7Cgog
        ICAgaWYgKHN0YXJ0QXQgPT09IHVuZGVmaW5lZCB8fCBzdGFydEF0ID49IGxl
        bikgc3RhcnRBdCA9IGxlbi0xOwogICAgaWYgKHN0YXJ0QXQgPCAwKSBzdGFy
        dEF0ICs9IGxlbjsKCiAgICBmb3IoaWR4PXN0YXJ0QXQ7aWR4Pj0wO2lkeC0t
        KSB7CiAgICAgIGlmICh0aGlzLm9iamVjdEF0KGlkeCkgPT09IG9iamVjdCkg
        cmV0dXJuIGlkeCA7CiAgICB9CiAgICByZXR1cm4gLTE7CiAgfSwKCiAgLy8g
        Li4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4u
        Li4uLi4uLi4uLi4uLgogIC8vIEFSUkFZIE9CU0VSVkVSUwogIC8vCgogIC8q
        KgogICAgQWRkcyBhbiBhcnJheSBvYnNlcnZlciB0byB0aGUgcmVjZWl2aW5n
        IGFycmF5LiBUaGUgYXJyYXkgb2JzZXJ2ZXIgb2JqZWN0CiAgICBub3JtYWxs
        eSBtdXN0IGltcGxlbWVudCB0d28gbWV0aG9kczoKCiAgICAqIGBhcnJheVdp
        bGxDaGFuZ2Uob2JzZXJ2ZWRPYmosIHN0YXJ0LCByZW1vdmVDb3VudCwgYWRk
        Q291bnQpYCAtIFRoaXMgbWV0aG9kIHdpbGwgYmUKICAgICAgY2FsbGVkIGp1
        c3QgYmVmb3JlIHRoZSBhcnJheSBpcyBtb2RpZmllZC4KICAgICogYGFycmF5
        RGlkQ2hhbmdlKG9ic2VydmVkT2JqLCBzdGFydCwgcmVtb3ZlQ291bnQsIGFk
        ZENvdW50KWAgLSBUaGlzIG1ldGhvZCB3aWxsIGJlCiAgICAgIGNhbGxlZCBq
        dXN0IGFmdGVyIHRoZSBhcnJheSBpcyBtb2RpZmllZC4KCiAgICBCb3RoIGNh
        bGxiYWNrcyB3aWxsIGJlIHBhc3NlZCB0aGUgb2JzZXJ2ZWQgb2JqZWN0LCBz
        dGFydGluZyBpbmRleCBvZiB0aGUKICAgIGNoYW5nZSBhcyB3ZWxsIGEgYSBj
        b3VudCBvZiB0aGUgaXRlbXMgdG8gYmUgcmVtb3ZlZCBhbmQgYWRkZWQuIFlv
        dSBjYW4gdXNlCiAgICB0aGVzZSBjYWxsYmFja3MgdG8gb3B0aW9uYWxseSBp
        bnNwZWN0IHRoZSBhcnJheSBkdXJpbmcgdGhlIGNoYW5nZSwgY2xlYXIKICAg
        IGNhY2hlcywgb3IgZG8gYW55IG90aGVyIGJvb2trZWVwaW5nIG5lY2Vzc2Fy
        eS4KCiAgICBJbiBhZGRpdGlvbiB0byBwYXNzaW5nIGEgdGFyZ2V0LCB5b3Ug
        Y2FuIGFsc28gaW5jbHVkZSBhbiBvcHRpb25zIGhhc2gKICAgIHdoaWNoIHlv
        dSBjYW4gdXNlIHRvIG92ZXJyaWRlIHRoZSBtZXRob2QgbmFtZXMgdGhhdCB3
        aWxsIGJlIGludm9rZWQgb24gdGhlCiAgICB0YXJnZXQuCgogICAgQG1ldGhv
        ZCBhZGRBcnJheU9ic2VydmVyCiAgICBAcGFyYW0ge09iamVjdH0gdGFyZ2V0
        IFRoZSBvYnNlcnZlciBvYmplY3QuCiAgICBAcGFyYW0ge0hhc2h9IG9wdHMg
        T3B0aW9uYWwgaGFzaCBvZiBjb25maWd1cmF0aW9uIG9wdGlvbnMgaW5jbHVk
        aW5nCiAgICAgIGB3aWxsQ2hhbmdlYCBhbmQgYGRpZENoYW5nZWAgb3B0aW9u
        LgogICAgQHJldHVybiB7RW1iZXIuQXJyYXl9IHJlY2VpdmVyCiAgKi8KICBh
        ZGRBcnJheU9ic2VydmVyOiBmdW5jdGlvbih0YXJnZXQsIG9wdHMpIHsKICAg
        IHZhciB3aWxsQ2hhbmdlID0gKG9wdHMgJiYgb3B0cy53aWxsQ2hhbmdlKSB8
        fCAnYXJyYXlXaWxsQ2hhbmdlJywKICAgICAgICBkaWRDaGFuZ2UgID0gKG9w
        dHMgJiYgb3B0cy5kaWRDaGFuZ2UpIHx8ICdhcnJheURpZENoYW5nZSc7Cgog
        ICAgdmFyIGhhc09ic2VydmVycyA9IGdldCh0aGlzLCAnaGFzQXJyYXlPYnNl
        cnZlcnMnKTsKICAgIGlmICghaGFzT2JzZXJ2ZXJzKSBFbWJlci5wcm9wZXJ0
        eVdpbGxDaGFuZ2UodGhpcywgJ2hhc0FycmF5T2JzZXJ2ZXJzJyk7CiAgICBF
        bWJlci5hZGRMaXN0ZW5lcih0aGlzLCAnQGFycmF5OmJlZm9yZScsIHRhcmdl
        dCwgd2lsbENoYW5nZSk7CiAgICBFbWJlci5hZGRMaXN0ZW5lcih0aGlzLCAn
        QGFycmF5OmNoYW5nZScsIHRhcmdldCwgZGlkQ2hhbmdlKTsKICAgIGlmICgh
        aGFzT2JzZXJ2ZXJzKSBFbWJlci5wcm9wZXJ0eURpZENoYW5nZSh0aGlzLCAn
        aGFzQXJyYXlPYnNlcnZlcnMnKTsKICAgIHJldHVybiB0aGlzOwogIH0sCgog
        IC8qKgogICAgUmVtb3ZlcyBhbiBhcnJheSBvYnNlcnZlciBmcm9tIHRoZSBv
        YmplY3QgaWYgdGhlIG9ic2VydmVyIGlzIGN1cnJlbnQKICAgIHJlZ2lzdGVy
        ZWQuIENhbGxpbmcgdGhpcyBtZXRob2QgbXVsdGlwbGUgdGltZXMgd2l0aCB0
        aGUgc2FtZSBvYmplY3Qgd2lsbAogICAgaGF2ZSBubyBlZmZlY3QuCgogICAg
        QG1ldGhvZCByZW1vdmVBcnJheU9ic2VydmVyCiAgICBAcGFyYW0ge09iamVj
        dH0gdGFyZ2V0IFRoZSBvYmplY3Qgb2JzZXJ2aW5nIHRoZSBhcnJheS4KICAg
        IEBwYXJhbSB7SGFzaH0gb3B0cyBPcHRpb25hbCBoYXNoIG9mIGNvbmZpZ3Vy
        YXRpb24gb3B0aW9ucyBpbmNsdWRpbmcKICAgICAgYHdpbGxDaGFuZ2VgIGFu
        ZCBgZGlkQ2hhbmdlYCBvcHRpb24uCiAgICBAcmV0dXJuIHtFbWJlci5BcnJh
        eX0gcmVjZWl2ZXIKICAqLwogIHJlbW92ZUFycmF5T2JzZXJ2ZXI6IGZ1bmN0
        aW9uKHRhcmdldCwgb3B0cykgewogICAgdmFyIHdpbGxDaGFuZ2UgPSAob3B0
        cyAmJiBvcHRzLndpbGxDaGFuZ2UpIHx8ICdhcnJheVdpbGxDaGFuZ2UnLAog
        ICAgICAgIGRpZENoYW5nZSAgPSAob3B0cyAmJiBvcHRzLmRpZENoYW5nZSkg
        fHwgJ2FycmF5RGlkQ2hhbmdlJzsKCiAgICB2YXIgaGFzT2JzZXJ2ZXJzID0g
        Z2V0KHRoaXMsICdoYXNBcnJheU9ic2VydmVycycpOwogICAgaWYgKGhhc09i
        c2VydmVycykgRW1iZXIucHJvcGVydHlXaWxsQ2hhbmdlKHRoaXMsICdoYXNB
        cnJheU9ic2VydmVycycpOwogICAgRW1iZXIucmVtb3ZlTGlzdGVuZXIodGhp
        cywgJ0BhcnJheTpiZWZvcmUnLCB0YXJnZXQsIHdpbGxDaGFuZ2UpOwogICAg
        RW1iZXIucmVtb3ZlTGlzdGVuZXIodGhpcywgJ0BhcnJheTpjaGFuZ2UnLCB0
        YXJnZXQsIGRpZENoYW5nZSk7CiAgICBpZiAoaGFzT2JzZXJ2ZXJzKSBFbWJl
        ci5wcm9wZXJ0eURpZENoYW5nZSh0aGlzLCAnaGFzQXJyYXlPYnNlcnZlcnMn
        KTsKICAgIHJldHVybiB0aGlzOwogIH0sCgogIC8qKgogICAgQmVjb21lcyB0
        cnVlIHdoZW5ldmVyIHRoZSBhcnJheSBjdXJyZW50bHkgaGFzIG9ic2VydmVy
        cyB3YXRjaGluZyBjaGFuZ2VzCiAgICBvbiB0aGUgYXJyYXkuCgogICAgQHBy
        b3BlcnR5IEJvb2xlYW4KICAqLwogIGhhc0FycmF5T2JzZXJ2ZXJzOiBFbWJl
        ci5jb21wdXRlZChmdW5jdGlvbigpIHsKICAgIHJldHVybiBFbWJlci5oYXNM
        aXN0ZW5lcnModGhpcywgJ0BhcnJheTpjaGFuZ2UnKSB8fCBFbWJlci5oYXNM
        aXN0ZW5lcnModGhpcywgJ0BhcnJheTpiZWZvcmUnKTsKICB9KSwKCiAgLyoq
        CiAgICBJZiB5b3UgYXJlIGltcGxlbWVudGluZyBhbiBvYmplY3QgdGhhdCBz
        dXBwb3J0cyBgRW1iZXIuQXJyYXlgLCBjYWxsIHRoaXMKICAgIG1ldGhvZCBq
        dXN0IGJlZm9yZSB0aGUgYXJyYXkgY29udGVudCBjaGFuZ2VzIHRvIG5vdGlm
        eSBhbnkgb2JzZXJ2ZXJzIGFuZAogICAgaW52YWxpZGF0ZSBhbnkgcmVsYXRl
        ZCBwcm9wZXJ0aWVzLiBQYXNzIHRoZSBzdGFydGluZyBpbmRleCBvZiB0aGUg
        Y2hhbmdlCiAgICBhcyB3ZWxsIGFzIGEgZGVsdGEgb2YgdGhlIGFtb3VudHMg
        dG8gY2hhbmdlLgoKICAgIEBtZXRob2QgYXJyYXlDb250ZW50V2lsbENoYW5n
        ZQogICAgQHBhcmFtIHtOdW1iZXJ9IHN0YXJ0SWR4IFRoZSBzdGFydGluZyBp
        bmRleCBpbiB0aGUgYXJyYXkgdGhhdCB3aWxsIGNoYW5nZS4KICAgIEBwYXJh
        bSB7TnVtYmVyfSByZW1vdmVBbXQgVGhlIG51bWJlciBvZiBpdGVtcyB0aGF0
        IHdpbGwgYmUgcmVtb3ZlZC4gSWYgeW91CiAgICAgIHBhc3MgYG51bGxgIGFz
        c3VtZXMgMAogICAgQHBhcmFtIHtOdW1iZXJ9IGFkZEFtdCBUaGUgbnVtYmVy
        IG9mIGl0ZW1zIHRoYXQgd2lsbCBiZSBhZGRlZC4gSWYgeW91CiAgICAgIHBh
        c3MgYG51bGxgIGFzc3VtZXMgMC4KICAgIEByZXR1cm4ge0VtYmVyLkFycmF5
        fSByZWNlaXZlcgogICovCiAgYXJyYXlDb250ZW50V2lsbENoYW5nZTogZnVu
        Y3Rpb24oc3RhcnRJZHgsIHJlbW92ZUFtdCwgYWRkQW10KSB7CgogICAgLy8g
        aWYgbm8gYXJncyBhcmUgcGFzc2VkIGFzc3VtZSBldmVyeXRoaW5nIGNoYW5n
        ZXMKICAgIGlmIChzdGFydElkeD09PXVuZGVmaW5lZCkgewogICAgICBzdGFy
        dElkeCA9IDA7CiAgICAgIHJlbW92ZUFtdCA9IGFkZEFtdCA9IC0xOwogICAg
        fSBlbHNlIHsKICAgICAgaWYgKHJlbW92ZUFtdCA9PT0gdW5kZWZpbmVkKSBy
        ZW1vdmVBbXQ9LTE7CiAgICAgIGlmIChhZGRBbXQgICAgPT09IHVuZGVmaW5l
        ZCkgYWRkQW10PS0xOwogICAgfQoKICAgIC8vIE1ha2Ugc3VyZSB0aGUgQGVh
        Y2ggcHJveHkgaXMgc2V0IHVwIGlmIGFueW9uZSBpcyBvYnNlcnZpbmcgQGVh
        Y2gKICAgIGlmIChFbWJlci5pc1dhdGNoaW5nKHRoaXMsICdAZWFjaCcpKSB7
        IGdldCh0aGlzLCAnQGVhY2gnKTsgfQoKICAgIEVtYmVyLnNlbmRFdmVudCh0
        aGlzLCAnQGFycmF5OmJlZm9yZScsIFt0aGlzLCBzdGFydElkeCwgcmVtb3Zl
        QW10LCBhZGRBbXRdKTsKCiAgICB2YXIgcmVtb3ZpbmcsIGxpbTsKICAgIGlm
        IChzdGFydElkeD49MCAmJiByZW1vdmVBbXQ+PTAgJiYgZ2V0KHRoaXMsICdo
        YXNFbnVtZXJhYmxlT2JzZXJ2ZXJzJykpIHsKICAgICAgcmVtb3ZpbmcgPSBb
        XTsKICAgICAgbGltID0gc3RhcnRJZHgrcmVtb3ZlQW10OwogICAgICBmb3Io
        dmFyIGlkeD1zdGFydElkeDtpZHg8bGltO2lkeCsrKSByZW1vdmluZy5wdXNo
        KHRoaXMub2JqZWN0QXQoaWR4KSk7CiAgICB9IGVsc2UgewogICAgICByZW1v
        dmluZyA9IHJlbW92ZUFtdDsKICAgIH0KCiAgICB0aGlzLmVudW1lcmFibGVD
        b250ZW50V2lsbENoYW5nZShyZW1vdmluZywgYWRkQW10KTsKCiAgICByZXR1
        cm4gdGhpczsKICB9LAoKICAvKioKICAgIElmIHlvdSBhcmUgaW1wbGVtZW50
        aW5nIGFuIG9iamVjdCB0aGF0IHN1cHBvcnRzIGBFbWJlci5BcnJheWAsIGNh
        bGwgdGhpcwogICAgbWV0aG9kIGp1c3QgYWZ0ZXIgdGhlIGFycmF5IGNvbnRl
        bnQgY2hhbmdlcyB0byBub3RpZnkgYW55IG9ic2VydmVycyBhbmQKICAgIGlu
        dmFsaWRhdGUgYW55IHJlbGF0ZWQgcHJvcGVydGllcy4gUGFzcyB0aGUgc3Rh
        cnRpbmcgaW5kZXggb2YgdGhlIGNoYW5nZQogICAgYXMgd2VsbCBhcyBhIGRl
        bHRhIG9mIHRoZSBhbW91bnRzIHRvIGNoYW5nZS4KCiAgICBAbWV0aG9kIGFy
        cmF5Q29udGVudERpZENoYW5nZQogICAgQHBhcmFtIHtOdW1iZXJ9IHN0YXJ0
        SWR4IFRoZSBzdGFydGluZyBpbmRleCBpbiB0aGUgYXJyYXkgdGhhdCBkaWQg
        Y2hhbmdlLgogICAgQHBhcmFtIHtOdW1iZXJ9IHJlbW92ZUFtdCBUaGUgbnVt
        YmVyIG9mIGl0ZW1zIHRoYXQgd2VyZSByZW1vdmVkLiBJZiB5b3UKICAgICAg
        cGFzcyBgbnVsbGAgYXNzdW1lcyAwCiAgICBAcGFyYW0ge051bWJlcn0gYWRk
        QW10IFRoZSBudW1iZXIgb2YgaXRlbXMgdGhhdCB3ZXJlIGFkZGVkLiBJZiB5
        b3UKICAgICAgcGFzcyBgbnVsbGAgYXNzdW1lcyAwLgogICAgQHJldHVybiB7
        RW1iZXIuQXJyYXl9IHJlY2VpdmVyCiAgKi8KICBhcnJheUNvbnRlbnREaWRD
        aGFuZ2U6IGZ1bmN0aW9uKHN0YXJ0SWR4LCByZW1vdmVBbXQsIGFkZEFtdCkg
        ewoKICAgIC8vIGlmIG5vIGFyZ3MgYXJlIHBhc3NlZCBhc3N1bWUgZXZlcnl0
        aGluZyBjaGFuZ2VzCiAgICBpZiAoc3RhcnRJZHg9PT11bmRlZmluZWQpIHsK
        ICAgICAgc3RhcnRJZHggPSAwOwogICAgICByZW1vdmVBbXQgPSBhZGRBbXQg
        PSAtMTsKICAgIH0gZWxzZSB7CiAgICAgIGlmIChyZW1vdmVBbXQgPT09IHVu
        ZGVmaW5lZCkgcmVtb3ZlQW10PS0xOwogICAgICBpZiAoYWRkQW10ICAgID09
        PSB1bmRlZmluZWQpIGFkZEFtdD0tMTsKICAgIH0KCiAgICB2YXIgYWRkaW5n
        LCBsaW07CiAgICBpZiAoc3RhcnRJZHg+PTAgJiYgYWRkQW10Pj0wICYmIGdl
        dCh0aGlzLCAnaGFzRW51bWVyYWJsZU9ic2VydmVycycpKSB7CiAgICAgIGFk
        ZGluZyA9IFtdOwogICAgICBsaW0gPSBzdGFydElkeCthZGRBbXQ7CiAgICAg
        IGZvcih2YXIgaWR4PXN0YXJ0SWR4O2lkeDxsaW07aWR4KyspIGFkZGluZy5w
        dXNoKHRoaXMub2JqZWN0QXQoaWR4KSk7CiAgICB9IGVsc2UgewogICAgICBh
        ZGRpbmcgPSBhZGRBbXQ7CiAgICB9CgogICAgdGhpcy5lbnVtZXJhYmxlQ29u
        dGVudERpZENoYW5nZShyZW1vdmVBbXQsIGFkZGluZyk7CiAgICBFbWJlci5z
        ZW5kRXZlbnQodGhpcywgJ0BhcnJheTpjaGFuZ2UnLCBbdGhpcywgc3RhcnRJ
        ZHgsIHJlbW92ZUFtdCwgYWRkQW10XSk7CgogICAgdmFyIGxlbmd0aCAgICAg
        ID0gZ2V0KHRoaXMsICdsZW5ndGgnKSwKICAgICAgICBjYWNoZWRGaXJzdCA9
        IGNhY2hlRm9yKHRoaXMsICdmaXJzdE9iamVjdCcpLAogICAgICAgIGNhY2hl
        ZExhc3QgID0gY2FjaGVGb3IodGhpcywgJ2xhc3RPYmplY3QnKTsKICAgIGlm
        ICh0aGlzLm9iamVjdEF0KDApICE9PSBjYWNoZWRGaXJzdCkgewogICAgICBF
        bWJlci5wcm9wZXJ0eVdpbGxDaGFuZ2UodGhpcywgJ2ZpcnN0T2JqZWN0Jyk7
        CiAgICAgIEVtYmVyLnByb3BlcnR5RGlkQ2hhbmdlKHRoaXMsICdmaXJzdE9i
        amVjdCcpOwogICAgfQogICAgaWYgKHRoaXMub2JqZWN0QXQobGVuZ3RoLTEp
        ICE9PSBjYWNoZWRMYXN0KSB7CiAgICAgIEVtYmVyLnByb3BlcnR5V2lsbENo
        YW5nZSh0aGlzLCAnbGFzdE9iamVjdCcpOwogICAgICBFbWJlci5wcm9wZXJ0
        eURpZENoYW5nZSh0aGlzLCAnbGFzdE9iamVjdCcpOwogICAgfQoKICAgIHJl
        dHVybiB0aGlzOwogIH0sCgogIC8vIC4uLi4uLi4uLi4uLi4uLi4uLi4uLi4u
        Li4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4KICAvLyBFTlVN
        RVJBVEVEIFBST1BFUlRJRVMKICAvLwoKICAvKioKICAgIFJldHVybnMgYSBz
        cGVjaWFsIG9iamVjdCB0aGF0IGNhbiBiZSB1c2VkIHRvIG9ic2VydmUgaW5k
        aXZpZHVhbCBwcm9wZXJ0aWVzCiAgICBvbiB0aGUgYXJyYXkuIEp1c3QgZ2V0
        IGFuIGVxdWl2YWxlbnQgcHJvcGVydHkgb24gdGhpcyBvYmplY3QgYW5kIGl0
        IHdpbGwKICAgIHJldHVybiBhbiBlbnVtZXJhYmxlIHRoYXQgbWFwcyBhdXRv
        bWF0aWNhbGx5IHRvIHRoZSBuYW1lZCBrZXkgb24gdGhlCiAgICBtZW1iZXIg
        b2JqZWN0cy4KCiAgICBJZiB5b3UgbWVyZWx5IHdhbnQgdG8gd2F0Y2ggZm9y
        IGFueSBpdGVtcyBiZWluZyBhZGRlZCBvciByZW1vdmVkIHRvIHRoZSBhcnJh
        eSwKICAgIHVzZSB0aGUgYFtdYCBwcm9wZXJ0eSBpbnN0ZWFkIG9mIGBAZWFj
        aGAuCgogICAgQHByb3BlcnR5IEBlYWNoCiAgKi8KICAnQGVhY2gnOiBFbWJl
        ci5jb21wdXRlZChmdW5jdGlvbigpIHsKICAgIGlmICghdGhpcy5fX2VhY2gp
        IHRoaXMuX19lYWNoID0gbmV3IEVtYmVyLkVhY2hQcm94eSh0aGlzKTsKICAg
        IHJldHVybiB0aGlzLl9fZWFjaDsKICB9KQoKfSkgOwoKfSkoKTsKCgoKKGZ1
        bmN0aW9uKCkgewp2YXIgZ2V0ID0gRW1iZXIuZ2V0LAogICAgc2V0ID0gRW1i
        ZXIuc2V0LAogICAgZ3VpZEZvciA9IEVtYmVyLmd1aWRGb3IsCiAgICBtZXRh
        Rm9yID0gRW1iZXIubWV0YSwKICAgIHByb3BlcnR5V2lsbENoYW5nZSA9IEVt
        YmVyLnByb3BlcnR5V2lsbENoYW5nZSwKICAgIHByb3BlcnR5RGlkQ2hhbmdl
        ID0gRW1iZXIucHJvcGVydHlEaWRDaGFuZ2UsCiAgICBhZGRCZWZvcmVPYnNl
        cnZlciA9IEVtYmVyLmFkZEJlZm9yZU9ic2VydmVyLAogICAgcmVtb3ZlQmVm
        b3JlT2JzZXJ2ZXIgPSBFbWJlci5yZW1vdmVCZWZvcmVPYnNlcnZlciwKICAg
        IGFkZE9ic2VydmVyID0gRW1iZXIuYWRkT2JzZXJ2ZXIsCiAgICByZW1vdmVP
        YnNlcnZlciA9IEVtYmVyLnJlbW92ZU9ic2VydmVyLAogICAgQ29tcHV0ZWRQ
        cm9wZXJ0eSA9IEVtYmVyLkNvbXB1dGVkUHJvcGVydHksCiAgICBhX3NsaWNl
        ID0gW10uc2xpY2UsCiAgICBvX2NyZWF0ZSA9IEVtYmVyLmNyZWF0ZSwKICAg
        IGZvckVhY2ggPSBFbWJlci5FbnVtZXJhYmxlVXRpbHMuZm9yRWFjaCwKICAg
        IC8vIEhlcmUgd2UgZXhwbGljaXRseSBkb24ndCBhbGxvdyBgQGVhY2guZm9v
        YDsgaXQgd291bGQgcmVxdWlyZSBzb21lIHNwZWNpYWwKICAgIC8vIHRlc3Rp
        bmcsIGJ1dCB0aGVyZSdzIG5vIHBhcnRpY3VsYXIgcmVhc29uIHdoeSBpdCBz
        aG91bGQgYmUgZGlzYWxsb3dlZC4KICAgIGVhY2hQcm9wZXJ0eVBhdHRlcm4g
        PSAvXiguKilcLkBlYWNoXC4oLiopLywKICAgIGRvdWJsZUVhY2hQcm9wZXJ0
        eVBhdHRlcm4gPSAvKC4qXC5AZWFjaCl7Mix9LzsKCi8qCiAgVHJhY2tzIGNo
        YW5nZXMgdG8gZGVwZW5kZW50IGFycmF5cywgYXMgd2VsbCBhcyB0byBwcm9w
        ZXJ0aWVzIG9mIGl0ZW1zIGluCiAgZGVwZW5kZW50IGFycmF5cy4KCiAgQGNs
        YXNzIERlcGVuZGVudEFycmF5c09ic2VydmVyCiovCmZ1bmN0aW9uIERlcGVu
        ZGVudEFycmF5c09ic2VydmVyKGNhbGxiYWNrcywgY3AsIGluc3RhbmNlTWV0
        YSwgY29udGV4dCwgcHJvcGVydHlOYW1lLCBzdWdhck1ldGEpIHsKICAvLyB1
        c2VyIHNwZWNpZmllZCBjYWxsYmFja3MgZm9yIGBhZGRlZEl0ZW1gIGFuZCBg
        cmVtb3ZlZEl0ZW1gCiAgdGhpcy5jYWxsYmFja3MgPSBjYWxsYmFja3M7Cgog
        IC8vIHRoZSBjb21wdXRlZCBwcm9wZXJ0eTogcmVtZW1iZXIgdGhlc2UgYXJl
        IHNoYXJlZCBhY3Jvc3MgaW5zdGFuY2VzCiAgdGhpcy5jcCA9IGNwOwoKICAv
        LyB0aGUgUmVkdWNlQ29tcHV0ZWRQcm9wZXJ0eUluc3RhbmNlTWV0YSB0aGlz
        IERlcGVuZGVudEFycmF5c09ic2VydmVyIGlzCiAgLy8gYXNzb2NpYXRlZCB3
        aXRoCiAgdGhpcy5pbnN0YW5jZU1ldGEgPSBpbnN0YW5jZU1ldGE7CgogIC8v
        IEEgbWFwIG9mIGFycmF5IGd1aWRzIHRvIGRlcGVuZGVudEtleXMsIGZvciB0
        aGUgZ2l2ZW4gY29udGV4dC4gIFdlIHRyYWNrCiAgLy8gdGhpcyBiZWNhdXNl
        IHdlIHdhbnQgdG8gc2V0IHVwIHRoZSBjb21wdXRlZCBwcm9wZXJ0eSBwb3Rl
        bnRpYWxseSBiZWZvcmUgdGhlCiAgLy8gZGVwZW5kZW50IGFycmF5IGV2ZW4g
        ZXhpc3RzLCBidXQgd2hlbiB0aGUgYXJyYXkgb2JzZXJ2ZXIgZmlyZXMsIHdl
        IGxhY2sKICAvLyBlbm91Z2ggY29udGV4dCB0byBrbm93IHdoYXQgdG8gdXBk
        YXRlOiB3ZSBjYW4gcmVjb3ZlciB0aGF0IGNvbnRleHQgYnkKICAvLyBnZXR0
        aW5nIHRoZSBkZXBlbmRlbnRLZXkuCiAgdGhpcy5kZXBlbmRlbnRLZXlzQnlH
        dWlkID0ge307CgogIC8vIGEgbWFwIG9mIGRlcGVuZGVudCBhcnJheSBndWlk
        cyAtPiBFbWJlci5UcmFja2VkQXJyYXkgaW5zdGFuY2VzLiAgV2UgdXNlCiAg
        Ly8gdGhpcyB0byBsYXppbHkgcmVjb21wdXRlIGluZGV4ZXMgZm9yIGl0ZW0g
        cHJvcGVydHkgb2JzZXJ2ZXJzLgogIHRoaXMudHJhY2tlZEFycmF5c0J5R3Vp
        ZCA9IHt9OwoKICAvLyBUaGlzIGlzIHVzZWQgdG8gY29hbGVzY2UgaXRlbSBj
        aGFuZ2VzIGZyb20gcHJvcGVydHkgb2JzZXJ2ZXJzLgogIHRoaXMuY2hhbmdl
        ZEl0ZW1zID0ge307Cn0KCmZ1bmN0aW9uIEl0ZW1Qcm9wZXJ0eU9ic2VydmVy
        Q29udGV4dCAoZGVwZW5kZW50QXJyYXksIGluZGV4LCB0cmFja2VkQXJyYXkp
        IHsKICBFbWJlci5hc3NlcnQoIkludGVybmFsIGVycm9yOiB0cmFja2VkQXJy
        YXkgaXMgbnVsbCBvciB1bmRlZmluZWQiLCB0cmFja2VkQXJyYXkpOwoKICB0
        aGlzLmRlcGVuZGVudEFycmF5ID0gZGVwZW5kZW50QXJyYXk7CiAgdGhpcy5p
        bmRleCA9IGluZGV4OwogIHRoaXMuaXRlbSA9IGRlcGVuZGVudEFycmF5Lm9i
        amVjdEF0KGluZGV4KTsKICB0aGlzLnRyYWNrZWRBcnJheSA9IHRyYWNrZWRB
        cnJheTsKICB0aGlzLmJlZm9yZU9ic2VydmVyID0gbnVsbDsKICB0aGlzLm9i
        c2VydmVyID0gbnVsbDsKCiAgdGhpcy5kZXN0cm95ZWQgPSBmYWxzZTsKfQoK
        RGVwZW5kZW50QXJyYXlzT2JzZXJ2ZXIucHJvdG90eXBlID0gewogIHNldFZh
        bHVlOiBmdW5jdGlvbiAobmV3VmFsdWUpIHsKICAgIHRoaXMuaW5zdGFuY2VN
        ZXRhLnNldFZhbHVlKG5ld1ZhbHVlLCB0cnVlKTsKICB9LAogIGdldFZhbHVl
        OiBmdW5jdGlvbiAoKSB7CiAgICByZXR1cm4gdGhpcy5pbnN0YW5jZU1ldGEu
        Z2V0VmFsdWUoKTsKICB9LAoKICBzZXR1cE9ic2VydmVyczogZnVuY3Rpb24g
        KGRlcGVuZGVudEFycmF5LCBkZXBlbmRlbnRLZXkpIHsKICAgIEVtYmVyLmFz
        c2VydCgiZGVwZW5kZW50IGFycmF5IG11c3QgYmUgYW4gYEVtYmVyLkFycmF5
        YCIsIEVtYmVyLkFycmF5LmRldGVjdChkZXBlbmRlbnRBcnJheSkpOwoKICAg
        IHRoaXMuZGVwZW5kZW50S2V5c0J5R3VpZFtndWlkRm9yKGRlcGVuZGVudEFy
        cmF5KV0gPSBkZXBlbmRlbnRLZXk7CgogICAgZGVwZW5kZW50QXJyYXkuYWRk
        QXJyYXlPYnNlcnZlcih0aGlzLCB7CiAgICAgIHdpbGxDaGFuZ2U6ICdkZXBl
        bmRlbnRBcnJheVdpbGxDaGFuZ2UnLAogICAgICBkaWRDaGFuZ2U6ICdkZXBl
        bmRlbnRBcnJheURpZENoYW5nZScKICAgIH0pOwoKICAgIGlmICh0aGlzLmNw
        Ll9pdGVtUHJvcGVydHlLZXlzW2RlcGVuZGVudEtleV0pIHsKICAgICAgdGhp
        cy5zZXR1cFByb3BlcnR5T2JzZXJ2ZXJzKGRlcGVuZGVudEtleSwgdGhpcy5j
        cC5faXRlbVByb3BlcnR5S2V5c1tkZXBlbmRlbnRLZXldKTsKICAgIH0KICB9
        LAoKICB0ZWFyZG93bk9ic2VydmVyczogZnVuY3Rpb24gKGRlcGVuZGVudEFy
        cmF5LCBkZXBlbmRlbnRLZXkpIHsKICAgIHZhciBpdGVtUHJvcGVydHlLZXlz
        ID0gdGhpcy5jcC5faXRlbVByb3BlcnR5S2V5c1tkZXBlbmRlbnRLZXldIHx8
        IFtdOwoKICAgIGRlbGV0ZSB0aGlzLmRlcGVuZGVudEtleXNCeUd1aWRbZ3Vp
        ZEZvcihkZXBlbmRlbnRBcnJheSldOwoKICAgIHRoaXMudGVhcmRvd25Qcm9w
        ZXJ0eU9ic2VydmVycyhkZXBlbmRlbnRLZXksIGl0ZW1Qcm9wZXJ0eUtleXMp
        OwoKICAgIGRlcGVuZGVudEFycmF5LnJlbW92ZUFycmF5T2JzZXJ2ZXIodGhp
        cywgewogICAgICB3aWxsQ2hhbmdlOiAnZGVwZW5kZW50QXJyYXlXaWxsQ2hh
        bmdlJywKICAgICAgZGlkQ2hhbmdlOiAnZGVwZW5kZW50QXJyYXlEaWRDaGFu
        Z2UnCiAgICB9KTsKICB9LAoKICBzZXR1cFByb3BlcnR5T2JzZXJ2ZXJzOiBm
        dW5jdGlvbiAoZGVwZW5kZW50S2V5LCBpdGVtUHJvcGVydHlLZXlzKSB7CiAg
        ICB2YXIgZGVwZW5kZW50QXJyYXkgPSBnZXQodGhpcy5pbnN0YW5jZU1ldGEu
        Y29udGV4dCwgZGVwZW5kZW50S2V5KSwKICAgICAgICBsZW5ndGggPSBnZXQo
        ZGVwZW5kZW50QXJyYXksICdsZW5ndGgnKSwKICAgICAgICBvYnNlcnZlckNv
        bnRleHRzID0gbmV3IEFycmF5KGxlbmd0aCk7CgogICAgdGhpcy5yZXNldFRy
        YW5zZm9ybWF0aW9ucyhkZXBlbmRlbnRLZXksIG9ic2VydmVyQ29udGV4dHMp
        OwoKICAgIGZvckVhY2goZGVwZW5kZW50QXJyYXksIGZ1bmN0aW9uIChpdGVt
        LCBpbmRleCkgewogICAgICB2YXIgb2JzZXJ2ZXJDb250ZXh0ID0gdGhpcy5j
        cmVhdGVQcm9wZXJ0eU9ic2VydmVyQ29udGV4dChkZXBlbmRlbnRBcnJheSwg
        aW5kZXgsIHRoaXMudHJhY2tlZEFycmF5c0J5R3VpZFtkZXBlbmRlbnRLZXld
        KTsKICAgICAgb2JzZXJ2ZXJDb250ZXh0c1tpbmRleF0gPSBvYnNlcnZlckNv
        bnRleHQ7CgogICAgICBmb3JFYWNoKGl0ZW1Qcm9wZXJ0eUtleXMsIGZ1bmN0
        aW9uIChwcm9wZXJ0eUtleSkgewogICAgICAgIGFkZEJlZm9yZU9ic2VydmVy
        KGl0ZW0sIHByb3BlcnR5S2V5LCB0aGlzLCBvYnNlcnZlckNvbnRleHQuYmVm
        b3JlT2JzZXJ2ZXIpOwogICAgICAgIGFkZE9ic2VydmVyKGl0ZW0sIHByb3Bl
        cnR5S2V5LCB0aGlzLCBvYnNlcnZlckNvbnRleHQub2JzZXJ2ZXIpOwogICAg
        ICB9LCB0aGlzKTsKICAgIH0sIHRoaXMpOwogIH0sCgogIHRlYXJkb3duUHJv
        cGVydHlPYnNlcnZlcnM6IGZ1bmN0aW9uIChkZXBlbmRlbnRLZXksIGl0ZW1Q
        cm9wZXJ0eUtleXMpIHsKICAgIHZhciBkZXBlbmRlbnRBcnJheU9ic2VydmVy
        ID0gdGhpcywKICAgICAgICB0cmFja2VkQXJyYXkgPSB0aGlzLnRyYWNrZWRB
        cnJheXNCeUd1aWRbZGVwZW5kZW50S2V5XSwKICAgICAgICBiZWZvcmVPYnNl
        cnZlciwKICAgICAgICBvYnNlcnZlciwKICAgICAgICBpdGVtOwoKICAgIGlm
        ICghdHJhY2tlZEFycmF5KSB7IHJldHVybjsgfQoKICAgIHRyYWNrZWRBcnJh
        eS5hcHBseShmdW5jdGlvbiAob2JzZXJ2ZXJDb250ZXh0cywgb2Zmc2V0LCBv
        cGVyYXRpb24pIHsKICAgICAgaWYgKG9wZXJhdGlvbiA9PT0gRW1iZXIuVHJh
        Y2tlZEFycmF5LkRFTEVURSkgeyByZXR1cm47IH0KCiAgICAgIGZvckVhY2go
        b2JzZXJ2ZXJDb250ZXh0cywgZnVuY3Rpb24gKG9ic2VydmVyQ29udGV4dCkg
        ewogICAgICAgIG9ic2VydmVyQ29udGV4dC5kZXN0cm95ZWQgPSB0cnVlOwog
        ICAgICAgIGJlZm9yZU9ic2VydmVyID0gb2JzZXJ2ZXJDb250ZXh0LmJlZm9y
        ZU9ic2VydmVyOwogICAgICAgIG9ic2VydmVyID0gb2JzZXJ2ZXJDb250ZXh0
        Lm9ic2VydmVyOwogICAgICAgIGl0ZW0gPSBvYnNlcnZlckNvbnRleHQuaXRl
        bTsKCiAgICAgICAgZm9yRWFjaChpdGVtUHJvcGVydHlLZXlzLCBmdW5jdGlv
        biAocHJvcGVydHlLZXkpIHsKICAgICAgICAgIHJlbW92ZUJlZm9yZU9ic2Vy
        dmVyKGl0ZW0sIHByb3BlcnR5S2V5LCBkZXBlbmRlbnRBcnJheU9ic2VydmVy
        LCBiZWZvcmVPYnNlcnZlcik7CiAgICAgICAgICByZW1vdmVPYnNlcnZlcihp
        dGVtLCBwcm9wZXJ0eUtleSwgZGVwZW5kZW50QXJyYXlPYnNlcnZlciwgb2Jz
        ZXJ2ZXIpOwogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0pOwogIH0sCgog
        IGNyZWF0ZVByb3BlcnR5T2JzZXJ2ZXJDb250ZXh0OiBmdW5jdGlvbiAoZGVw
        ZW5kZW50QXJyYXksIGluZGV4LCB0cmFja2VkQXJyYXkpIHsKICAgIHZhciBv
        YnNlcnZlckNvbnRleHQgPSBuZXcgSXRlbVByb3BlcnR5T2JzZXJ2ZXJDb250
        ZXh0KGRlcGVuZGVudEFycmF5LCBpbmRleCwgdHJhY2tlZEFycmF5KTsKCiAg
        ICB0aGlzLmNyZWF0ZVByb3BlcnR5T2JzZXJ2ZXIob2JzZXJ2ZXJDb250ZXh0
        KTsKCiAgICByZXR1cm4gb2JzZXJ2ZXJDb250ZXh0OwogIH0sCgogIGNyZWF0
        ZVByb3BlcnR5T2JzZXJ2ZXI6IGZ1bmN0aW9uIChvYnNlcnZlckNvbnRleHQp
        IHsKICAgIHZhciBkZXBlbmRlbnRBcnJheU9ic2VydmVyID0gdGhpczsKCiAg
        ICBvYnNlcnZlckNvbnRleHQuYmVmb3JlT2JzZXJ2ZXIgPSBmdW5jdGlvbiAo
        b2JqLCBrZXlOYW1lKSB7CiAgICAgIHJldHVybiBkZXBlbmRlbnRBcnJheU9i
        c2VydmVyLml0ZW1Qcm9wZXJ0eVdpbGxDaGFuZ2Uob2JqLCBrZXlOYW1lLCBv
        YnNlcnZlckNvbnRleHQuZGVwZW5kZW50QXJyYXksIG9ic2VydmVyQ29udGV4
        dCk7CiAgICB9OwogICAgb2JzZXJ2ZXJDb250ZXh0Lm9ic2VydmVyID0gZnVu
        Y3Rpb24gKG9iaiwga2V5TmFtZSkgewogICAgICByZXR1cm4gZGVwZW5kZW50
        QXJyYXlPYnNlcnZlci5pdGVtUHJvcGVydHlEaWRDaGFuZ2Uob2JqLCBrZXlO
        YW1lLCBvYnNlcnZlckNvbnRleHQuZGVwZW5kZW50QXJyYXksIG9ic2VydmVy
        Q29udGV4dCk7CiAgICB9OwogIH0sCgogIHJlc2V0VHJhbnNmb3JtYXRpb25z
        OiBmdW5jdGlvbiAoZGVwZW5kZW50S2V5LCBvYnNlcnZlckNvbnRleHRzKSB7
        CiAgICB0aGlzLnRyYWNrZWRBcnJheXNCeUd1aWRbZGVwZW5kZW50S2V5XSA9
        IG5ldyBFbWJlci5UcmFja2VkQXJyYXkob2JzZXJ2ZXJDb250ZXh0cyk7CiAg
        fSwKCiAgdHJhY2tBZGQ6IGZ1bmN0aW9uIChkZXBlbmRlbnRLZXksIGluZGV4
        LCBuZXdJdGVtcykgewogICAgdmFyIHRyYWNrZWRBcnJheSA9IHRoaXMudHJh
        Y2tlZEFycmF5c0J5R3VpZFtkZXBlbmRlbnRLZXldOwogICAgaWYgKHRyYWNr
        ZWRBcnJheSkgewogICAgICB0cmFja2VkQXJyYXkuYWRkSXRlbXMoaW5kZXgs
        IG5ld0l0ZW1zKTsKICAgIH0KICB9LAoKICB0cmFja1JlbW92ZTogZnVuY3Rp
        b24gKGRlcGVuZGVudEtleSwgaW5kZXgsIHJlbW92ZWRDb3VudCkgewogICAg
        dmFyIHRyYWNrZWRBcnJheSA9IHRoaXMudHJhY2tlZEFycmF5c0J5R3VpZFtk
        ZXBlbmRlbnRLZXldOwoKICAgIGlmICh0cmFja2VkQXJyYXkpIHsKICAgICAg
        cmV0dXJuIHRyYWNrZWRBcnJheS5yZW1vdmVJdGVtcyhpbmRleCwgcmVtb3Zl
        ZENvdW50KTsKICAgIH0KCiAgICByZXR1cm4gW107CiAgfSwKCiAgdXBkYXRl
        SW5kZXhlczogZnVuY3Rpb24gKHRyYWNrZWRBcnJheSwgYXJyYXkpIHsKICAg
        IHZhciBsZW5ndGggPSBnZXQoYXJyYXksICdsZW5ndGgnKTsKICAgIC8vIE9Q
        VElNSVpFOiB3ZSBjb3VsZCBzdG9wIHVwZGF0aW5nIG9uY2Ugd2UgaGl0IHRo
        ZSBvYmplY3Qgd2hvc2Ugb2JzZXJ2ZXIKICAgIC8vIGZpcmVkOyBpZSBwYXJ0
        aWFsbHkgYXBwbHkgdGhlIHRyYW5zZm9ybWF0aW9ucwogICAgdHJhY2tlZEFy
        cmF5LmFwcGx5KGZ1bmN0aW9uIChvYnNlcnZlckNvbnRleHRzLCBvZmZzZXQs
        IG9wZXJhdGlvbikgewogICAgICAvLyB3ZSBkb24ndCBldmVuIGhhdmUgb2Jz
        ZXJ2ZXIgY29udGV4dHMgZm9yIHJlbW92ZWQgaXRlbXMsIGV2ZW4gaWYgd2Ug
        ZGlkLAogICAgICAvLyB0aGV5IG5vIGxvbmdlciBoYXZlIGFueSBpbmRleCBp
        biB0aGUgYXJyYXkKICAgICAgaWYgKG9wZXJhdGlvbiA9PT0gRW1iZXIuVHJh
        Y2tlZEFycmF5LkRFTEVURSkgeyByZXR1cm47IH0KICAgICAgaWYgKG9wZXJh
        dGlvbiA9PT0gRW1iZXIuVHJhY2tlZEFycmF5LlJFVEFJTiAmJiBvYnNlcnZl
        ckNvbnRleHRzLmxlbmd0aCA9PT0gbGVuZ3RoICYmIG9mZnNldCA9PT0gMCkg
        ewogICAgICAgIC8vIElmIHdlIHVwZGF0ZSBtYW55IGl0ZW1zIHdlIGRvbid0
        IHdhbnQgdG8gd2FsayB0aGUgYXJyYXkgZWFjaCB0aW1lOiB3ZQogICAgICAg
        IC8vIG9ubHkgbmVlZCB0byB1cGRhdGUgdGhlIGluZGV4ZXMgYXQgbW9zdCBv
        bmNlIHBlciBydW4gbG9vcC4KICAgICAgICByZXR1cm47CiAgICAgIH0KCiAg
        ICAgIGZvckVhY2gob2JzZXJ2ZXJDb250ZXh0cywgZnVuY3Rpb24gKGNvbnRl
        eHQsIGluZGV4KSB7CiAgICAgICAgY29udGV4dC5pbmRleCA9IGluZGV4ICsg
        b2Zmc2V0OwogICAgICB9KTsKICAgIH0pOwogIH0sCgogIGRlcGVuZGVudEFy
        cmF5V2lsbENoYW5nZTogZnVuY3Rpb24gKGRlcGVuZGVudEFycmF5LCBpbmRl
        eCwgcmVtb3ZlZENvdW50LCBhZGRlZENvdW50KSB7CiAgICB2YXIgcmVtb3Zl
        ZEl0ZW0gPSB0aGlzLmNhbGxiYWNrcy5yZW1vdmVkSXRlbSwKICAgICAgICBj
        aGFuZ2VNZXRhLAogICAgICAgIGd1aWQgPSBndWlkRm9yKGRlcGVuZGVudEFy
        cmF5KSwKICAgICAgICBkZXBlbmRlbnRLZXkgPSB0aGlzLmRlcGVuZGVudEtl
        eXNCeUd1aWRbZ3VpZF0sCiAgICAgICAgaXRlbVByb3BlcnR5S2V5cyA9IHRo
        aXMuY3AuX2l0ZW1Qcm9wZXJ0eUtleXNbZGVwZW5kZW50S2V5XSB8fCBbXSwK
        ICAgICAgICBpdGVtLAogICAgICAgIGl0ZW1JbmRleCwKICAgICAgICBzbGlj
        ZUluZGV4LAogICAgICAgIG9ic2VydmVyQ29udGV4dHM7CgogICAgb2JzZXJ2
        ZXJDb250ZXh0cyA9IHRoaXMudHJhY2tSZW1vdmUoZGVwZW5kZW50S2V5LCBp
        bmRleCwgcmVtb3ZlZENvdW50KTsKCiAgICBmdW5jdGlvbiByZW1vdmVPYnNl
        cnZlcnMocHJvcGVydHlLZXkpIHsKICAgICAgb2JzZXJ2ZXJDb250ZXh0c1tz
        bGljZUluZGV4XS5kZXN0cm95ZWQgPSB0cnVlOwogICAgICByZW1vdmVCZWZv
        cmVPYnNlcnZlcihpdGVtLCBwcm9wZXJ0eUtleSwgdGhpcywgb2JzZXJ2ZXJD
        b250ZXh0c1tzbGljZUluZGV4XS5iZWZvcmVPYnNlcnZlcik7CiAgICAgIHJl
        bW92ZU9ic2VydmVyKGl0ZW0sIHByb3BlcnR5S2V5LCB0aGlzLCBvYnNlcnZl
        ckNvbnRleHRzW3NsaWNlSW5kZXhdLm9ic2VydmVyKTsKICAgIH0KCiAgICBm
        b3IgKHNsaWNlSW5kZXggPSByZW1vdmVkQ291bnQgLSAxOyBzbGljZUluZGV4
        ID49IDA7IC0tc2xpY2VJbmRleCkgewogICAgICBpdGVtSW5kZXggPSBpbmRl
        eCArIHNsaWNlSW5kZXg7CiAgICAgIGl0ZW0gPSBkZXBlbmRlbnRBcnJheS5v
        YmplY3RBdChpdGVtSW5kZXgpOwoKICAgICAgZm9yRWFjaChpdGVtUHJvcGVy
        dHlLZXlzLCByZW1vdmVPYnNlcnZlcnMsIHRoaXMpOwoKICAgICAgY2hhbmdl
        TWV0YSA9IGNyZWF0ZUNoYW5nZU1ldGEoZGVwZW5kZW50QXJyYXksIGl0ZW0s
        IGl0ZW1JbmRleCwgdGhpcy5pbnN0YW5jZU1ldGEucHJvcGVydHlOYW1lLCB0
        aGlzLmNwKTsKICAgICAgdGhpcy5zZXRWYWx1ZSggcmVtb3ZlZEl0ZW0uY2Fs
        bCgKICAgICAgICB0aGlzLmluc3RhbmNlTWV0YS5jb250ZXh0LCB0aGlzLmdl
        dFZhbHVlKCksIGl0ZW0sIGNoYW5nZU1ldGEsIHRoaXMuaW5zdGFuY2VNZXRh
        LnN1Z2FyTWV0YSkpOwogICAgfQogIH0sCgogIGRlcGVuZGVudEFycmF5RGlk
        Q2hhbmdlOiBmdW5jdGlvbiAoZGVwZW5kZW50QXJyYXksIGluZGV4LCByZW1v
        dmVkQ291bnQsIGFkZGVkQ291bnQpIHsKICAgIHZhciBhZGRlZEl0ZW0gPSB0
        aGlzLmNhbGxiYWNrcy5hZGRlZEl0ZW0sCiAgICAgICAgZ3VpZCA9IGd1aWRG
        b3IoZGVwZW5kZW50QXJyYXkpLAogICAgICAgIGRlcGVuZGVudEtleSA9IHRo
        aXMuZGVwZW5kZW50S2V5c0J5R3VpZFtndWlkXSwKICAgICAgICBvYnNlcnZl
        ckNvbnRleHRzID0gbmV3IEFycmF5KGFkZGVkQ291bnQpLAogICAgICAgIGl0
        ZW1Qcm9wZXJ0eUtleXMgPSB0aGlzLmNwLl9pdGVtUHJvcGVydHlLZXlzW2Rl
        cGVuZGVudEtleV0sCiAgICAgICAgY2hhbmdlTWV0YSwKICAgICAgICBvYnNl
        cnZlckNvbnRleHQ7CgogICAgZm9yRWFjaChkZXBlbmRlbnRBcnJheS5zbGlj
        ZShpbmRleCwgaW5kZXggKyBhZGRlZENvdW50KSwgZnVuY3Rpb24gKGl0ZW0s
        IHNsaWNlSW5kZXgpIHsKICAgICAgaWYgKGl0ZW1Qcm9wZXJ0eUtleXMpIHsK
        ICAgICAgICBvYnNlcnZlckNvbnRleHQgPQogICAgICAgICAgb2JzZXJ2ZXJD
        b250ZXh0c1tzbGljZUluZGV4XSA9CiAgICAgICAgICB0aGlzLmNyZWF0ZVBy
        b3BlcnR5T2JzZXJ2ZXJDb250ZXh0KGRlcGVuZGVudEFycmF5LCBpbmRleCAr
        IHNsaWNlSW5kZXgsIHRoaXMudHJhY2tlZEFycmF5c0J5R3VpZFtkZXBlbmRl
        bnRLZXldKTsKICAgICAgICBmb3JFYWNoKGl0ZW1Qcm9wZXJ0eUtleXMsIGZ1
        bmN0aW9uIChwcm9wZXJ0eUtleSkgewogICAgICAgICAgYWRkQmVmb3JlT2Jz
        ZXJ2ZXIoaXRlbSwgcHJvcGVydHlLZXksIHRoaXMsIG9ic2VydmVyQ29udGV4
        dC5iZWZvcmVPYnNlcnZlcik7CiAgICAgICAgICBhZGRPYnNlcnZlcihpdGVt
        LCBwcm9wZXJ0eUtleSwgdGhpcywgb2JzZXJ2ZXJDb250ZXh0Lm9ic2VydmVy
        KTsKICAgICAgICB9LCB0aGlzKTsKICAgICAgfQoKICAgICAgY2hhbmdlTWV0
        YSA9IGNyZWF0ZUNoYW5nZU1ldGEoZGVwZW5kZW50QXJyYXksIGl0ZW0sIGlu
        ZGV4ICsgc2xpY2VJbmRleCwgdGhpcy5pbnN0YW5jZU1ldGEucHJvcGVydHlO
        YW1lLCB0aGlzLmNwKTsKICAgICAgdGhpcy5zZXRWYWx1ZSggYWRkZWRJdGVt
        LmNhbGwoCiAgICAgICAgdGhpcy5pbnN0YW5jZU1ldGEuY29udGV4dCwgdGhp
        cy5nZXRWYWx1ZSgpLCBpdGVtLCBjaGFuZ2VNZXRhLCB0aGlzLmluc3RhbmNl
        TWV0YS5zdWdhck1ldGEpKTsKICAgIH0sIHRoaXMpOwoKICAgIHRoaXMudHJh
        Y2tBZGQoZGVwZW5kZW50S2V5LCBpbmRleCwgb2JzZXJ2ZXJDb250ZXh0cyk7
        CiAgfSwKCiAgaXRlbVByb3BlcnR5V2lsbENoYW5nZTogZnVuY3Rpb24gKG9i
        aiwga2V5TmFtZSwgYXJyYXksIG9ic2VydmVyQ29udGV4dCkgewogICAgdmFy
        IGd1aWQgPSBndWlkRm9yKG9iaik7CgogICAgaWYgKCF0aGlzLmNoYW5nZWRJ
        dGVtc1tndWlkXSkgewogICAgICB0aGlzLmNoYW5nZWRJdGVtc1tndWlkXSA9
        IHsKICAgICAgICBhcnJheTogICAgICAgICAgICBhcnJheSwKICAgICAgICBv
        YnNlcnZlckNvbnRleHQ6ICBvYnNlcnZlckNvbnRleHQsCiAgICAgICAgb2Jq
        OiAgICAgICAgICAgICAgb2JqLAogICAgICAgIHByZXZpb3VzVmFsdWVzOiAg
        IHt9CiAgICAgIH07CiAgICB9CgogICAgdGhpcy5jaGFuZ2VkSXRlbXNbZ3Vp
        ZF0ucHJldmlvdXNWYWx1ZXNba2V5TmFtZV0gPSBnZXQob2JqLCBrZXlOYW1l
        KTsKICB9LAoKICBpdGVtUHJvcGVydHlEaWRDaGFuZ2U6IGZ1bmN0aW9uKG9i
        aiwga2V5TmFtZSwgYXJyYXksIG9ic2VydmVyQ29udGV4dCkgewogICAgdGhp
        cy5mbHVzaENoYW5nZXMoKTsKICB9LAoKICBmbHVzaENoYW5nZXM6IGZ1bmN0
        aW9uKCkgewogICAgdmFyIGNoYW5nZWRJdGVtcyA9IHRoaXMuY2hhbmdlZEl0
        ZW1zLCBrZXksIGMsIGNoYW5nZU1ldGE7CgogICAgZm9yIChrZXkgaW4gY2hh
        bmdlZEl0ZW1zKSB7CiAgICAgIGMgPSBjaGFuZ2VkSXRlbXNba2V5XTsKICAg
        ICAgaWYgKGMub2JzZXJ2ZXJDb250ZXh0LmRlc3Ryb3llZCkgeyBjb250aW51
        ZTsgfQoKICAgICAgdGhpcy51cGRhdGVJbmRleGVzKGMub2JzZXJ2ZXJDb250
        ZXh0LnRyYWNrZWRBcnJheSwgYy5vYnNlcnZlckNvbnRleHQuZGVwZW5kZW50
        QXJyYXkpOwoKICAgICAgY2hhbmdlTWV0YSA9IGNyZWF0ZUNoYW5nZU1ldGEo
        Yy5hcnJheSwgYy5vYmosIGMub2JzZXJ2ZXJDb250ZXh0LmluZGV4LCB0aGlz
        Lmluc3RhbmNlTWV0YS5wcm9wZXJ0eU5hbWUsIHRoaXMuY3AsIGMucHJldmlv
        dXNWYWx1ZXMpOwogICAgICB0aGlzLnNldFZhbHVlKAogICAgICAgIHRoaXMu
        Y2FsbGJhY2tzLnJlbW92ZWRJdGVtLmNhbGwodGhpcy5pbnN0YW5jZU1ldGEu
        Y29udGV4dCwgdGhpcy5nZXRWYWx1ZSgpLCBjLm9iaiwgY2hhbmdlTWV0YSwg
        dGhpcy5pbnN0YW5jZU1ldGEuc3VnYXJNZXRhKSk7CiAgICAgIHRoaXMuc2V0
        VmFsdWUoCiAgICAgICAgdGhpcy5jYWxsYmFja3MuYWRkZWRJdGVtLmNhbGwo
        dGhpcy5pbnN0YW5jZU1ldGEuY29udGV4dCwgdGhpcy5nZXRWYWx1ZSgpLCBj
        Lm9iaiwgY2hhbmdlTWV0YSwgdGhpcy5pbnN0YW5jZU1ldGEuc3VnYXJNZXRh
        KSk7CiAgICB9CiAgICB0aGlzLmNoYW5nZWRJdGVtcyA9IHt9OwogIH0KfTsK
        CmZ1bmN0aW9uIGNyZWF0ZUNoYW5nZU1ldGEoZGVwZW5kZW50QXJyYXksIGl0
        ZW0sIGluZGV4LCBwcm9wZXJ0eU5hbWUsIHByb3BlcnR5LCBwcmV2aW91c1Zh
        bHVlcykgewogIHZhciBtZXRhID0gewogICAgYXJyYXlDaGFuZ2VkOiBkZXBl
        bmRlbnRBcnJheSwKICAgIGluZGV4OiBpbmRleCwKICAgIGl0ZW06IGl0ZW0s
        CiAgICBwcm9wZXJ0eU5hbWU6IHByb3BlcnR5TmFtZSwKICAgIHByb3BlcnR5
        OiBwcm9wZXJ0eQogIH07CgogIGlmIChwcmV2aW91c1ZhbHVlcykgewogICAg
        Ly8gcHJldmlvdXMgdmFsdWVzIG9ubHkgYXZhaWxhYmxlIGZvciBpdGVtIHBy
        b3BlcnR5IGNoYW5nZXMKICAgIG1ldGEucHJldmlvdXNWYWx1ZXMgPSBwcmV2
        aW91c1ZhbHVlczsKICB9CgogIHJldHVybiBtZXRhOwp9CgpmdW5jdGlvbiBh
        ZGRJdGVtcyAoZGVwZW5kZW50QXJyYXksIGNhbGxiYWNrcywgY3AsIHByb3Bl
        cnR5TmFtZSwgbWV0YSkgewogIGZvckVhY2goZGVwZW5kZW50QXJyYXksIGZ1
        bmN0aW9uIChpdGVtLCBpbmRleCkgewogICAgbWV0YS5zZXRWYWx1ZSggY2Fs
        bGJhY2tzLmFkZGVkSXRlbS5jYWxsKAogICAgICB0aGlzLCBtZXRhLmdldFZh
        bHVlKCksIGl0ZW0sIGNyZWF0ZUNoYW5nZU1ldGEoZGVwZW5kZW50QXJyYXks
        IGl0ZW0sIGluZGV4LCBwcm9wZXJ0eU5hbWUsIGNwKSwgbWV0YS5zdWdhck1l
        dGEpKTsKICB9LCB0aGlzKTsKfQoKZnVuY3Rpb24gcmVzZXQoY3AsIHByb3Bl
        cnR5TmFtZSkgewogIHZhciBjYWxsYmFja3MgPSBjcC5fY2FsbGJhY2tzKCks
        CiAgICAgIG1ldGE7CgogIGlmIChjcC5faGFzSW5zdGFuY2VNZXRhKHRoaXMs
        IHByb3BlcnR5TmFtZSkpIHsKICAgIG1ldGEgPSBjcC5faW5zdGFuY2VNZXRh
        KHRoaXMsIHByb3BlcnR5TmFtZSk7CiAgICBtZXRhLnNldFZhbHVlKGNwLnJl
        c2V0VmFsdWUobWV0YS5nZXRWYWx1ZSgpKSk7CiAgfSBlbHNlIHsKICAgIG1l
        dGEgPSBjcC5faW5zdGFuY2VNZXRhKHRoaXMsIHByb3BlcnR5TmFtZSk7CiAg
        fQoKICBpZiAoY3Aub3B0aW9ucy5pbml0aWFsaXplKSB7CiAgICBjcC5vcHRp
        b25zLmluaXRpYWxpemUuY2FsbCh0aGlzLCBtZXRhLmdldFZhbHVlKCksIHsg
        cHJvcGVydHk6IGNwLCBwcm9wZXJ0eU5hbWU6IHByb3BlcnR5TmFtZSB9LCBt
        ZXRhLnN1Z2FyTWV0YSk7CiAgfQp9CgpmdW5jdGlvbiBSZWR1Y2VDb21wdXRl
        ZFByb3BlcnR5SW5zdGFuY2VNZXRhKGNvbnRleHQsIHByb3BlcnR5TmFtZSwg
        aW5pdGlhbFZhbHVlKSB7CiAgdGhpcy5jb250ZXh0ID0gY29udGV4dDsKICB0
        aGlzLnByb3BlcnR5TmFtZSA9IHByb3BlcnR5TmFtZTsKICB0aGlzLmNhY2hl
        ID0gbWV0YUZvcihjb250ZXh0KS5jYWNoZTsKCiAgdGhpcy5kZXBlbmRlbnRB
        cnJheXMgPSB7fTsKICB0aGlzLnN1Z2FyTWV0YSA9IHt9OwoKICB0aGlzLmlu
        aXRpYWxWYWx1ZSA9IGluaXRpYWxWYWx1ZTsKfQoKUmVkdWNlQ29tcHV0ZWRQ
        cm9wZXJ0eUluc3RhbmNlTWV0YS5wcm90b3R5cGUgPSB7CiAgZ2V0VmFsdWU6
        IGZ1bmN0aW9uICgpIHsKICAgIGlmICh0aGlzLnByb3BlcnR5TmFtZSBpbiB0
        aGlzLmNhY2hlKSB7CiAgICAgIHJldHVybiB0aGlzLmNhY2hlW3RoaXMucHJv
        cGVydHlOYW1lXTsKICAgIH0gZWxzZSB7CiAgICAgIHJldHVybiB0aGlzLmlu
        aXRpYWxWYWx1ZTsKICAgIH0KICB9LAoKICBzZXRWYWx1ZTogZnVuY3Rpb24o
        bmV3VmFsdWUsIHRyaWdnZXJPYnNlcnZlcnMpIHsKICAgIC8vIFRoaXMgbGV0
        cyBzdWdhcnMgZm9yY2UgYSByZWNvbXB1dGF0aW9uLCBoYW5keSBmb3IgdmVy
        eSBzaW1wbGUKICAgIC8vIGltcGxlbWVudGF0aW9ucyBvZiBlZyBtYXguCiAg
        ICBpZiAobmV3VmFsdWUgIT09IHVuZGVmaW5lZCkgewogICAgICB2YXIgZmly
        ZU9ic2VydmVycyA9IHRyaWdnZXJPYnNlcnZlcnMgJiYgKG5ld1ZhbHVlICE9
        PSB0aGlzLmNhY2hlW3RoaXMucHJvcGVydHlOYW1lXSk7CgogICAgICBpZiAo
        ZmlyZU9ic2VydmVycykgewogICAgICAgIHByb3BlcnR5V2lsbENoYW5nZSh0
        aGlzLmNvbnRleHQsIHRoaXMucHJvcGVydHlOYW1lKTsKICAgICAgfQoKICAg
        ICAgdGhpcy5jYWNoZVt0aGlzLnByb3BlcnR5TmFtZV0gPSBuZXdWYWx1ZTsK
        CiAgICAgIGlmIChmaXJlT2JzZXJ2ZXJzKSB7CiAgICAgICAgcHJvcGVydHlE
        aWRDaGFuZ2UodGhpcy5jb250ZXh0LCB0aGlzLnByb3BlcnR5TmFtZSk7CiAg
        ICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIGRlbGV0ZSB0aGlzLmNhY2hlW3Ro
        aXMucHJvcGVydHlOYW1lXTsKICAgIH0KICB9Cn07CgovKioKICBBIGNvbXB1
        dGVkIHByb3BlcnR5IHdob3NlIGRlcGVuZGVudCBrZXlzIGFyZSBhcnJheXMg
        YW5kIHdoaWNoIGlzIHVwZGF0ZWQgd2l0aAogICJvbmUgYXQgYSB0aW1lIiBz
        ZW1hbnRpY3MuCgogIEBjbGFzcyBSZWR1Y2VDb21wdXRlZFByb3BlcnR5CiAg
        QG5hbWVzcGFjZSBFbWJlcgogIEBleHRlbmRzIEVtYmVyLkNvbXB1dGVkUHJv
        cGVydHkKICBAY29uc3RydWN0b3IKKi8KZnVuY3Rpb24gUmVkdWNlQ29tcHV0
        ZWRQcm9wZXJ0eShvcHRpb25zKSB7CiAgdmFyIGNwID0gdGhpczsKCiAgdGhp
        cy5vcHRpb25zID0gb3B0aW9uczsKICB0aGlzLl9pbnN0YW5jZU1ldGFzID0g
        e307CgogIHRoaXMuX2RlcGVuZGVudEtleXMgPSBudWxsOwogIC8vIEEgbWFw
        IG9mIGRlcGVuZGVudEtleSAtPiBbaXRlbVByb3BlcnR5LCAuLi5dIHRoYXQg
        dHJhY2tzIHdoYXQgcHJvcGVydGllcyBvZgogIC8vIGl0ZW1zIGluIHRoZSBh
        cnJheSB3ZSBtdXN0IHRyYWNrIHRvIHVwZGF0ZSB0aGlzIHByb3BlcnR5Lgog
        IHRoaXMuX2l0ZW1Qcm9wZXJ0eUtleXMgPSB7fTsKICB0aGlzLl9wcmV2aW91
        c0l0ZW1Qcm9wZXJ0eUtleXMgPSB7fTsKCiAgdGhpcy5yZWFkT25seSgpOwog
        IHRoaXMuY2FjaGVhYmxlKCk7CgogIHRoaXMucmVjb21wdXRlT25jZSA9IGZ1
        bmN0aW9uKHByb3BlcnR5TmFtZSkgewogICAgLy8gV2hhdCB3ZSByZWFsbHkg
        d2FudCB0byBkbyBpcyBjb2FsZXNjZSBieSA8Y3AsIHByb3BlcnR5TmFtZT4u
        CiAgICAvLyBXZSBuZWVkIGEgZm9ybSBvZiBgc2NoZWR1bGVPbmNlYCB0aGF0
        IGFjY2VwdHMgYW4gYXJiaXRyYXJ5IHRva2VuIHRvCiAgICAvLyBjb2FsZXNj
        ZSBieSwgaW4gYWRkaXRpb24gdG8gdGhlIHRhcmdldCBhbmQgbWV0aG9kLgog
        ICAgRW1iZXIucnVuLm9uY2UodGhpcywgcmVjb21wdXRlLCBwcm9wZXJ0eU5h
        bWUpOwogIH07CiAgdmFyIHJlY29tcHV0ZSA9IGZ1bmN0aW9uKHByb3BlcnR5
        TmFtZSkgewogICAgdmFyIGRlcGVuZGVudEtleXMgPSBjcC5fZGVwZW5kZW50
        S2V5cywKICAgICAgICBtZXRhID0gY3AuX2luc3RhbmNlTWV0YSh0aGlzLCBw
        cm9wZXJ0eU5hbWUpLAogICAgICAgIGNhbGxiYWNrcyA9IGNwLl9jYWxsYmFj
        a3MoKTsKCiAgICByZXNldC5jYWxsKHRoaXMsIGNwLCBwcm9wZXJ0eU5hbWUp
        OwoKICAgIGZvckVhY2goY3AuX2RlcGVuZGVudEtleXMsIGZ1bmN0aW9uIChk
        ZXBlbmRlbnRLZXkpIHsKICAgICAgdmFyIGRlcGVuZGVudEFycmF5ID0gZ2V0
        KHRoaXMsIGRlcGVuZGVudEtleSksCiAgICAgICAgICBwcmV2aW91c0RlcGVu
        ZGVudEFycmF5ID0gbWV0YS5kZXBlbmRlbnRBcnJheXNbZGVwZW5kZW50S2V5
        XTsKCiAgICAgIGlmIChkZXBlbmRlbnRBcnJheSA9PT0gcHJldmlvdXNEZXBl
        bmRlbnRBcnJheSkgewogICAgICAgIC8vIFRoZSBhcnJheSBtYXkgYmUgdGhl
        IHNhbWUsIGJ1dCBvdXIgaXRlbSBwcm9wZXJ0eSBrZXlzIG1heSBoYXZlCiAg
        ICAgICAgLy8gY2hhbmdlZCwgc28gd2Ugc2V0IHRoZW0gdXAgYWdhaW4uICBX
        ZSBjYW4ndCBlYXNpbHkgdGVsbCBpZiB0aGV5J3ZlCiAgICAgICAgLy8gY2hh
        bmdlZDogdGhlIGFycmF5IG1heSBiZSB0aGUgc2FtZSBvYmplY3QsIGJ1dCB3
        aXRoIGRpZmZlcmVudAogICAgICAgIC8vIGNvbnRlbnRzLgogICAgICAgIGlm
        IChjcC5fcHJldmlvdXNJdGVtUHJvcGVydHlLZXlzW2RlcGVuZGVudEtleV0p
        IHsKICAgICAgICAgIGRlbGV0ZSBjcC5fcHJldmlvdXNJdGVtUHJvcGVydHlL
        ZXlzW2RlcGVuZGVudEtleV07CiAgICAgICAgICBtZXRhLmRlcGVuZGVudEFy
        cmF5c09ic2VydmVyLnNldHVwUHJvcGVydHlPYnNlcnZlcnMoZGVwZW5kZW50
        S2V5LCBjcC5faXRlbVByb3BlcnR5S2V5c1tkZXBlbmRlbnRLZXldKTsKICAg
        ICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgbWV0YS5kZXBlbmRlbnRB
        cnJheXNbZGVwZW5kZW50S2V5XSA9IGRlcGVuZGVudEFycmF5OwoKICAgICAg
        ICBpZiAocHJldmlvdXNEZXBlbmRlbnRBcnJheSkgewogICAgICAgICAgbWV0
        YS5kZXBlbmRlbnRBcnJheXNPYnNlcnZlci50ZWFyZG93bk9ic2VydmVycyhw
        cmV2aW91c0RlcGVuZGVudEFycmF5LCBkZXBlbmRlbnRLZXkpOwogICAgICAg
        IH0KCiAgICAgICAgaWYgKGRlcGVuZGVudEFycmF5KSB7CiAgICAgICAgICBt
        ZXRhLmRlcGVuZGVudEFycmF5c09ic2VydmVyLnNldHVwT2JzZXJ2ZXJzKGRl
        cGVuZGVudEFycmF5LCBkZXBlbmRlbnRLZXkpOwogICAgICAgIH0KICAgICAg
        fQogICAgfSwgdGhpcyk7CgogICAgZm9yRWFjaChjcC5fZGVwZW5kZW50S2V5
        cywgZnVuY3Rpb24oZGVwZW5kZW50S2V5KSB7CiAgICAgIHZhciBkZXBlbmRl
        bnRBcnJheSA9IGdldCh0aGlzLCBkZXBlbmRlbnRLZXkpOwogICAgICBpZiAo
        ZGVwZW5kZW50QXJyYXkpIHsKICAgICAgICBhZGRJdGVtcy5jYWxsKHRoaXMs
        IGRlcGVuZGVudEFycmF5LCBjYWxsYmFja3MsIGNwLCBwcm9wZXJ0eU5hbWUs
        IG1ldGEpOwogICAgICB9CiAgICB9LCB0aGlzKTsKICB9OwoKICB0aGlzLmZ1
        bmMgPSBmdW5jdGlvbiAocHJvcGVydHlOYW1lKSB7CiAgICBFbWJlci5hc3Nl
        cnQoIkNvbXB1dGVkIHJlZHVjZSB2YWx1ZXMgcmVxdWlyZSBhdCBsZWFzdCBv
        bmUgZGVwZW5kZW50IGtleSIsIGNwLl9kZXBlbmRlbnRLZXlzKTsKCiAgICBy
        ZWNvbXB1dGUuY2FsbCh0aGlzLCBwcm9wZXJ0eU5hbWUpOwoKICAgIHJldHVy
        biBjcC5faW5zdGFuY2VNZXRhKHRoaXMsIHByb3BlcnR5TmFtZSkuZ2V0VmFs
        dWUoKTsKICB9Owp9CgpFbWJlci5SZWR1Y2VDb21wdXRlZFByb3BlcnR5ID0g
        UmVkdWNlQ29tcHV0ZWRQcm9wZXJ0eTsKUmVkdWNlQ29tcHV0ZWRQcm9wZXJ0
        eS5wcm90b3R5cGUgPSBvX2NyZWF0ZShDb21wdXRlZFByb3BlcnR5LnByb3Rv
        dHlwZSk7CgpmdW5jdGlvbiBkZWZhdWx0Q2FsbGJhY2soY29tcHV0ZWRWYWx1
        ZSkgewogIHJldHVybiBjb21wdXRlZFZhbHVlOwp9CgpSZWR1Y2VDb21wdXRl
        ZFByb3BlcnR5LnByb3RvdHlwZS5fY2FsbGJhY2tzID0gZnVuY3Rpb24gKCkg
        ewogIGlmICghdGhpcy5jYWxsYmFja3MpIHsKICAgIHZhciBvcHRpb25zID0g
        dGhpcy5vcHRpb25zOwogICAgdGhpcy5jYWxsYmFja3MgPSB7CiAgICAgIHJl
        bW92ZWRJdGVtOiBvcHRpb25zLnJlbW92ZWRJdGVtIHx8IGRlZmF1bHRDYWxs
        YmFjaywKICAgICAgYWRkZWRJdGVtOiBvcHRpb25zLmFkZGVkSXRlbSB8fCBk
        ZWZhdWx0Q2FsbGJhY2sKICAgIH07CiAgfQogIHJldHVybiB0aGlzLmNhbGxi
        YWNrczsKfTsKClJlZHVjZUNvbXB1dGVkUHJvcGVydHkucHJvdG90eXBlLl9o
        YXNJbnN0YW5jZU1ldGEgPSBmdW5jdGlvbiAoY29udGV4dCwgcHJvcGVydHlO
        YW1lKSB7CiAgdmFyIGd1aWQgPSBndWlkRm9yKGNvbnRleHQpLAogICAgICBr
        ZXkgPSBndWlkICsgJzonICsgcHJvcGVydHlOYW1lOwoKICByZXR1cm4gISF0
        aGlzLl9pbnN0YW5jZU1ldGFzW2tleV07Cn07CgpSZWR1Y2VDb21wdXRlZFBy
        b3BlcnR5LnByb3RvdHlwZS5faW5zdGFuY2VNZXRhID0gZnVuY3Rpb24gKGNv
        bnRleHQsIHByb3BlcnR5TmFtZSkgewogIHZhciBndWlkID0gZ3VpZEZvcihj
        b250ZXh0KSwKICAgICAga2V5ID0gZ3VpZCArICc6JyArIHByb3BlcnR5TmFt
        ZSwKICAgICAgbWV0YSA9IHRoaXMuX2luc3RhbmNlTWV0YXNba2V5XTsKCiAg
        aWYgKCFtZXRhKSB7CiAgICBtZXRhID0gdGhpcy5faW5zdGFuY2VNZXRhc1tr
        ZXldID0gbmV3IFJlZHVjZUNvbXB1dGVkUHJvcGVydHlJbnN0YW5jZU1ldGEo
        Y29udGV4dCwgcHJvcGVydHlOYW1lLCB0aGlzLmluaXRpYWxWYWx1ZSgpKTsK
        ICAgIG1ldGEuZGVwZW5kZW50QXJyYXlzT2JzZXJ2ZXIgPSBuZXcgRGVwZW5k
        ZW50QXJyYXlzT2JzZXJ2ZXIodGhpcy5fY2FsbGJhY2tzKCksIHRoaXMsIG1l
        dGEsIGNvbnRleHQsIHByb3BlcnR5TmFtZSwgbWV0YS5zdWdhck1ldGEpOwog
        IH0KCiAgcmV0dXJuIG1ldGE7Cn07CgpSZWR1Y2VDb21wdXRlZFByb3BlcnR5
        LnByb3RvdHlwZS5pbml0aWFsVmFsdWUgPSBmdW5jdGlvbiAoKSB7CiAgaWYg
        KHR5cGVvZiB0aGlzLm9wdGlvbnMuaW5pdGlhbFZhbHVlID09PSAnZnVuY3Rp
        b24nKSB7CiAgICByZXR1cm4gdGhpcy5vcHRpb25zLmluaXRpYWxWYWx1ZSgp
        OwogIH0KICBlbHNlIHsKICAgIHJldHVybiB0aGlzLm9wdGlvbnMuaW5pdGlh
        bFZhbHVlOwogIH0KfTsKClJlZHVjZUNvbXB1dGVkUHJvcGVydHkucHJvdG90
        eXBlLnJlc2V0VmFsdWUgPSBmdW5jdGlvbiAodmFsdWUpIHsKICByZXR1cm4g
        dGhpcy5pbml0aWFsVmFsdWUoKTsKfTsKClJlZHVjZUNvbXB1dGVkUHJvcGVy
        dHkucHJvdG90eXBlLml0ZW1Qcm9wZXJ0eUtleSA9IGZ1bmN0aW9uIChkZXBl
        bmRlbnRBcnJheUtleSwgaXRlbVByb3BlcnR5S2V5KSB7CiAgdGhpcy5faXRl
        bVByb3BlcnR5S2V5c1tkZXBlbmRlbnRBcnJheUtleV0gPSB0aGlzLl9pdGVt
        UHJvcGVydHlLZXlzW2RlcGVuZGVudEFycmF5S2V5XSB8fCBbXTsKICB0aGlz
        Ll9pdGVtUHJvcGVydHlLZXlzW2RlcGVuZGVudEFycmF5S2V5XS5wdXNoKGl0
        ZW1Qcm9wZXJ0eUtleSk7Cn07CgpSZWR1Y2VDb21wdXRlZFByb3BlcnR5LnBy
        b3RvdHlwZS5jbGVhckl0ZW1Qcm9wZXJ0eUtleXMgPSBmdW5jdGlvbiAoZGVw
        ZW5kZW50QXJyYXlLZXkpIHsKICBpZiAodGhpcy5faXRlbVByb3BlcnR5S2V5
        c1tkZXBlbmRlbnRBcnJheUtleV0pIHsKICAgIHRoaXMuX3ByZXZpb3VzSXRl
        bVByb3BlcnR5S2V5c1tkZXBlbmRlbnRBcnJheUtleV0gPSB0aGlzLl9pdGVt
        UHJvcGVydHlLZXlzW2RlcGVuZGVudEFycmF5S2V5XTsKICAgIHRoaXMuX2l0
        ZW1Qcm9wZXJ0eUtleXNbZGVwZW5kZW50QXJyYXlLZXldID0gW107CiAgfQp9
        OwoKUmVkdWNlQ29tcHV0ZWRQcm9wZXJ0eS5wcm90b3R5cGUucHJvcGVydHkg
        PSBmdW5jdGlvbiAoKSB7CiAgdmFyIGNwID0gdGhpcywKICAgICAgYXJncyA9
        IGFfc2xpY2UuY2FsbChhcmd1bWVudHMpLAogICAgICBwcm9wZXJ0eUFyZ3Mg
        PSBuZXcgRW1iZXIuU2V0KCksCiAgICAgIG1hdGNoLAogICAgICBkZXBlbmRl
        bnRBcnJheUtleSwKICAgICAgaXRlbVByb3BlcnR5S2V5OwoKICBmb3JFYWNo
        KGFfc2xpY2UuY2FsbChhcmd1bWVudHMpLCBmdW5jdGlvbiAoZGVwZW5kZW50
        S2V5KSB7CiAgICBpZiAoZG91YmxlRWFjaFByb3BlcnR5UGF0dGVybi50ZXN0
        KGRlcGVuZGVudEtleSkpIHsKICAgICAgdGhyb3cgbmV3IEVtYmVyLkVycm9y
        KCJOZXN0ZWQgQGVhY2ggcHJvcGVydGllcyBub3Qgc3VwcG9ydGVkOiAiICsg
        ZGVwZW5kZW50S2V5KTsKICAgIH0gZWxzZSBpZiAobWF0Y2ggPSBlYWNoUHJv
        cGVydHlQYXR0ZXJuLmV4ZWMoZGVwZW5kZW50S2V5KSkgewogICAgICBkZXBl
        bmRlbnRBcnJheUtleSA9IG1hdGNoWzFdOwogICAgICBpdGVtUHJvcGVydHlL
        ZXkgPSBtYXRjaFsyXTsKICAgICAgY3AuaXRlbVByb3BlcnR5S2V5KGRlcGVu
        ZGVudEFycmF5S2V5LCBpdGVtUHJvcGVydHlLZXkpOwogICAgICBwcm9wZXJ0
        eUFyZ3MuYWRkKGRlcGVuZGVudEFycmF5S2V5KTsKICAgIH0gZWxzZSB7CiAg
        ICAgIHByb3BlcnR5QXJncy5hZGQoZGVwZW5kZW50S2V5KTsKICAgIH0KICB9
        KTsKCiAgcmV0dXJuIENvbXB1dGVkUHJvcGVydHkucHJvdG90eXBlLnByb3Bl
        cnR5LmFwcGx5KHRoaXMsIHByb3BlcnR5QXJncy50b0FycmF5KCkpOwp9OwoK
        LyoqCiAgQ3JlYXRlcyBhIGNvbXB1dGVkIHByb3BlcnR5IHdoaWNoIG9wZXJh
        dGVzIG9uIGRlcGVuZGVudCBhcnJheXMgYW5kCiAgaXMgdXBkYXRlZCB3aXRo
        ICJvbmUgYXQgYSB0aW1lIiBzZW1hbnRpY3MuIFdoZW4gaXRlbXMgYXJlIGFk
        ZGVkIG9yCiAgcmVtb3ZlZCBmcm9tIHRoZSBkZXBlbmRlbnQgYXJyYXkocykg
        YSByZWR1Y2UgY29tcHV0ZWQgb25seSBvcGVyYXRlcwogIG9uIHRoZSBjaGFu
        Z2UgaW5zdGVhZCBvZiByZS1ldmFsdWF0aW5nIHRoZSBlbnRpcmUgYXJyYXku
        CgogIElmIHRoZXJlIGFyZSBtb3JlIHRoYW4gb25lIGFyZ3VtZW50cyB0aGUg
        Zmlyc3QgYXJndW1lbnRzIGFyZQogIGNvbnNpZGVyZWQgdG8gYmUgZGVwZW5k
        ZW50IHByb3BlcnR5IGtleXMuIFRoZSBsYXN0IGFyZ3VtZW50IGlzCiAgcmVx
        dWlyZWQgdG8gYmUgYW4gb3B0aW9ucyBvYmplY3QuIFRoZSBvcHRpb25zIG9i
        amVjdCBjYW4gaGF2ZSB0aGUKICBmb2xsb3dpbmcgZm91ciBwcm9wZXJ0aWVz
        OgoKICBgaW5pdGlhbFZhbHVlYCAtIEEgdmFsdWUgb3IgZnVuY3Rpb24gdGhh
        dCB3aWxsIGJlIHVzZWQgYXMgdGhlIGluaXRpYWwKICB2YWx1ZSBmb3IgdGhl
        IGNvbXB1dGVkLiBJZiB0aGlzIHByb3BlcnR5IGlzIGEgZnVuY3Rpb24gdGhl
        IHJlc3VsdCBvZiBjYWxsaW5nCiAgdGhlIGZ1bmN0aW9uIHdpbGwgYmUgdXNl
        ZCBhcyB0aGUgaW5pdGlhbCB2YWx1ZS4gVGhpcyBwcm9wZXJ0eSBpcyByZXF1
        aXJlZC4KCiAgYGluaXRpYWxpemVgIC0gQW4gb3B0aW9uYWwgaW5pdGlhbGl6
        ZSBmdW5jdGlvbi4gVHlwaWNhbGx5IHRoaXMgd2lsbCBiZSB1c2VkCiAgdG8g
        c2V0IHVwIHN0YXRlIG9uIHRoZSBpbnN0YW5jZU1ldGEgb2JqZWN0LgoKICBg
        cmVtb3ZlZEl0ZW1gIC0gQSBmdW5jdGlvbiB0aGF0IGlzIGNhbGxlZCBlYWNo
        IHRpbWUgYW4gZWxlbWVudCBpcyByZW1vdmVkCiAgZnJvbSB0aGUgYXJyYXku
        CgogIGBhZGRlZEl0ZW1gIC0gQSBmdW5jdGlvbiB0aGF0IGlzIGNhbGxlZCBl
        YWNoIHRpbWUgYW4gZWxlbWVudCBpcyBhZGRlZCB0bwogIHRoZSBhcnJheS4K
        CgogIFRoZSBgaW5pdGlhbGl6ZWAgZnVuY3Rpb24gaGFzIHRoZSBmb2xsb3dp
        bmcgc2lnbmF0dXJlOgoKICBgYGBqYXZhc2NyaXB0CiAgIGZ1bmN0aW9uIChp
        bml0aWFsVmFsdWUsIGNoYW5nZU1ldGEsIGluc3RhbmNlTWV0YSkKICBgYGAK
        CiAgYGluaXRpYWxWYWx1ZWAgLSBUaGUgdmFsdWUgb2YgdGhlIGBpbml0aWFs
        VmFsdWVgIHByb3BlcnR5IGZyb20gdGhlCiAgb3B0aW9ucyBvYmplY3QuCgog
        IGBjaGFuZ2VNZXRhYCAtIEFuIG9iamVjdCB3aGljaCBjb250YWlucyBtZXRh
        IGluZm9ybWF0aW9uIGFib3V0IHRoZQogIGNvbXB1dGVkLiBJdCBjb250YWlu
        cyB0aGUgZm9sbG93aW5nIHByb3BlcnRpZXM6CgogICAgIC0gYHByb3BlcnR5
        YCB0aGUgY29tcHV0ZWQgcHJvcGVydHkKICAgICAtIGBwcm9wZXJ0eU5hbWVg
        IHRoZSBuYW1lIG9mIHRoZSBwcm9wZXJ0eSBvbiB0aGUgb2JqZWN0CgogIGBp
        bnN0YW5jZU1ldGFgIC0gQW4gb2JqZWN0IHRoYXQgY2FuIGJlIHVzZWQgdG8g
        c3RvcmUgbWV0YQogIGluZm9ybWF0aW9uIG5lZWRlZCBmb3IgY2FsY3VsYXRp
        bmcgeW91ciBjb21wdXRlZC4gRm9yIGV4YW1wbGUgYQogIHVuaXF1ZSBjb21w
        dXRlZCBtaWdodCB1c2UgdGhpcyB0byBzdG9yZSB0aGUgbnVtYmVyIG9mIHRp
        bWVzIGEgZ2l2ZW4KICBlbGVtZW50IGlzIGZvdW5kIGluIHRoZSBkZXBlbmRl
        bnQgYXJyYXkuCgoKICBUaGUgYHJlbW92ZWRJdGVtYCBhbmQgYGFkZGVkSXRl
        bWAgZnVuY3Rpb25zIGJvdGggaGF2ZSB0aGUgZm9sbG93aW5nIHNpZ25hdHVy
        ZToKCiAgYGBgamF2YXNjcmlwdAogIGZ1bmN0aW9uIChhY2N1bXVsYXRlZFZh
        bHVlLCBpdGVtLCBjaGFuZ2VNZXRhLCBpbnN0YW5jZU1ldGEpCiAgYGBgCgog
        IGBhY2N1bXVsYXRlZFZhbHVlYCAtIFRoZSB2YWx1ZSByZXR1cm5lZCBmcm9t
        IHRoZSBsYXN0IHRpbWUKICBgcmVtb3ZlZEl0ZW1gIG9yIGBhZGRlZEl0ZW1g
        IHdhcyBjYWxsZWQgb3IgYGluaXRpYWxWYWx1ZWAuCgogIGBpdGVtYCAtIHRo
        ZSBlbGVtZW50IGFkZGVkIG9yIHJlbW92ZWQgZnJvbSB0aGUgYXJyYXkKCiAg
        YGNoYW5nZU1ldGFgIC0gQW4gb2JqZWN0IHdoaWNoIGNvbnRhaW5zIG1ldGEg
        aW5mb3JtYXRpb24gYWJvdXQgdGhlCiAgY2hhbmdlLiBJdCBjb250YWlucyB0
        aGUgZm9sbG93aW5nIHByb3BlcnRpZXM6CgogICAgLSBgcHJvcGVydHlgIHRo
        ZSBjb21wdXRlZCBwcm9wZXJ0eQogICAgLSBgcHJvcGVydHlOYW1lYCB0aGUg
        bmFtZSBvZiB0aGUgcHJvcGVydHkgb24gdGhlIG9iamVjdAogICAgLSBgaW5k
        ZXhgIHRoZSBpbmRleCBvZiB0aGUgYWRkZWQgb3IgcmVtb3ZlZCBpdGVtCiAg
        ICAtIGBpdGVtYCB0aGUgYWRkZWQgb3IgcmVtb3ZlZCBpdGVtOiB0aGlzIGlz
        IGV4YWN0bHkgdGhlIHNhbWUgYXMKICAgICAgdGhlIHNlY29uZCBhcmcKICAg
        IC0gYGFycmF5Q2hhbmdlZGAgdGhlIGFycmF5IHRoYXQgdHJpZ2dlcmVkIHRo
        ZSBjaGFuZ2UuIENhbiBiZQogICAgICB1c2VmdWwgd2hlbiBkZXBlbmRpbmcg
        b24gbXVsdGlwbGUgYXJyYXlzLgoKICBGb3IgcHJvcGVydHkgY2hhbmdlcyB0
        cmlnZ2VyZWQgb24gYW4gaXRlbSBwcm9wZXJ0eSBjaGFuZ2UgKHdoZW4KICBk
        ZXBLZXkgaXMgc29tZXRoaW5nIGxpa2UgYHNvbWVBcnJheS5AZWFjaC5zb21l
        UHJvcGVydHlgKSwKICBgY2hhbmdlTWV0YWAgd2lsbCBhbHNvIGNvbnRhaW4g
        dGhlIGZvbGxvd2luZyBwcm9wZXJ0eToKCiAgICAtIGBwcmV2aW91c1ZhbHVl
        c2AgYW4gb2JqZWN0IHdob3NlIGtleXMgYXJlIHRoZSBwcm9wZXJ0aWVzIHRo
        YXQgY2hhbmdlZCBvbgogICAgdGhlIGl0ZW0sIGFuZCB3aG9zZSB2YWx1ZXMg
        YXJlIHRoZSBpdGVtJ3MgcHJldmlvdXMgdmFsdWVzLgoKICBgcHJldmlvdXNW
        YWx1ZXNgIGlzIGltcG9ydGFudCBFbWJlciBjb2FsZXNjZXMgaXRlbSBwcm9w
        ZXJ0eSBjaGFuZ2VzIHZpYQogIEVtYmVyLnJ1bi5vbmNlLiBUaGlzIG1lYW5z
        IHRoYXQgYnkgdGhlIHRpbWUgcmVtb3ZlZEl0ZW0gZ2V0cyBjYWxsZWQsIGl0
        ZW0gaGFzCiAgdGhlIG5ldyB2YWx1ZXMsIGJ1dCB5b3UgbWF5IG5lZWQgdGhl
        IHByZXZpb3VzIHZhbHVlIChlZyBmb3Igc29ydGluZyAmCiAgZmlsdGVyaW5n
        KS4KCiAgYGluc3RhbmNlTWV0YWAgLSBBbiBvYmplY3QgdGhhdCBjYW4gYmUg
        dXNlZCB0byBzdG9yZSBtZXRhCiAgaW5mb3JtYXRpb24gbmVlZGVkIGZvciBj
        YWxjdWxhdGluZyB5b3VyIGNvbXB1dGVkLiBGb3IgZXhhbXBsZSBhCiAgdW5p
        cXVlIGNvbXB1dGVkIG1pZ2h0IHVzZSB0aGlzIHRvIHN0b3JlIHRoZSBudW1i
        ZXIgb2YgdGltZXMgYSBnaXZlbgogIGVsZW1lbnQgaXMgZm91bmQgaW4gdGhl
        IGRlcGVuZGVudCBhcnJheS4KCiAgVGhlIGByZW1vdmVkSXRlbWAgYW5kIGBh
        ZGRlZEl0ZW1gIGZ1bmN0aW9ucyBzaG91bGQgcmV0dXJuIHRoZSBhY2N1bXVs
        YXRlZAogIHZhbHVlLiBJdCBpcyBhY2NlcHRhYmxlIHRvIG5vdCByZXR1cm4g
        YW55dGhpbmcgKGllIHJldHVybiB1bmRlZmluZWQpCiAgdG8gaW52YWxpZGF0
        ZSB0aGUgY29tcHV0YXRpb24uIFRoaXMgaXMgZ2VuZXJhbGx5IG5vdCBhIGdv
        b2QgaWRlYSBmb3IKICBhcnJheUNvbXB1dGVkIGJ1dCBpdCdzIHVzZWQgaW4g
        ZWcgbWF4IGFuZCBtaW4uCgogIE5vdGUgdGhhdCBvYnNlcnZlcnMgd2lsbCBi
        ZSBmaXJlZCBpZiBlaXRoZXIgb2YgdGhlc2UgZnVuY3Rpb25zIHJldHVybiBh
        IHZhbHVlCiAgdGhhdCBkaWZmZXJzIGZyb20gdGhlIGFjY3VtdWxhdGVkIHZh
        bHVlLiAgV2hlbiByZXR1cm5pbmcgYW4gb2JqZWN0IHRoYXQKICBtdXRhdGVz
        IGluIHJlc3BvbnNlIHRvIGFycmF5IGNoYW5nZXMsIGZvciBleGFtcGxlIGFu
        IGFycmF5IHRoYXQgbWFwcwogIGV2ZXJ5dGhpbmcgZnJvbSBzb21lIG90aGVy
        IGFycmF5IChzZWUgYEVtYmVyLmNvbXB1dGVkLm1hcGApLCBpdCBpcyB1c3Vh
        bGx5CiAgaW1wb3J0YW50IHRoYXQgdGhlICpzYW1lKiBhcnJheSBiZSByZXR1
        cm5lZCB0byBhdm9pZCBhY2NpZGVudGFsbHkgdHJpZ2dlcmluZyBvYnNlcnZl
        cnMuCgogIEV4YW1wbGUKCiAgYGBgamF2YXNjcmlwdAogIEVtYmVyLmNvbXB1
        dGVkLm1heCA9IGZ1bmN0aW9uIChkZXBlbmRlbnRLZXkpIHsKICAgIHJldHVy
        biBFbWJlci5yZWR1Y2VDb21wdXRlZC5jYWxsKG51bGwsIGRlcGVuZGVudEtl
        eSwgewogICAgICBpbml0aWFsVmFsdWU6IC1JbmZpbml0eSwKCiAgICAgIGFk
        ZGVkSXRlbTogZnVuY3Rpb24gKGFjY3VtdWxhdGVkVmFsdWUsIGl0ZW0sIGNo
        YW5nZU1ldGEsIGluc3RhbmNlTWV0YSkgewogICAgICAgIHJldHVybiBNYXRo
        Lm1heChhY2N1bXVsYXRlZFZhbHVlLCBpdGVtKTsKICAgICAgfSwKCiAgICAg
        IHJlbW92ZWRJdGVtOiBmdW5jdGlvbiAoYWNjdW11bGF0ZWRWYWx1ZSwgaXRl
        bSwgY2hhbmdlTWV0YSwgaW5zdGFuY2VNZXRhKSB7CiAgICAgICAgaWYgKGl0
        ZW0gPCBhY2N1bXVsYXRlZFZhbHVlKSB7CiAgICAgICAgICByZXR1cm4gYWNj
        dW11bGF0ZWRWYWx1ZTsKICAgICAgICB9CiAgICAgIH0KICAgIH0pOwogIH07
        CiAgYGBgCgogIEBtZXRob2QgcmVkdWNlQ29tcHV0ZWQKICBAZm9yIEVtYmVy
        CiAgQHBhcmFtIHtTdHJpbmd9IFtkZXBlbmRlbnRLZXlzKl0KICBAcGFyYW0g
        e09iamVjdH0gb3B0aW9ucwogIEByZXR1cm4ge0VtYmVyLkNvbXB1dGVkUHJv
        cGVydHl9CiovCkVtYmVyLnJlZHVjZUNvbXB1dGVkID0gZnVuY3Rpb24gKG9w
        dGlvbnMpIHsKICB2YXIgYXJnczsKCiAgaWYgKGFyZ3VtZW50cy5sZW5ndGgg
        PiAxKSB7CiAgICBhcmdzID0gYV9zbGljZS5jYWxsKGFyZ3VtZW50cywgMCwg
        LTEpOwogICAgb3B0aW9ucyA9IGFfc2xpY2UuY2FsbChhcmd1bWVudHMsIC0x
        KVswXTsKICB9CgogIGlmICh0eXBlb2Ygb3B0aW9ucyAhPT0gIm9iamVjdCIp
        IHsKICAgIHRocm93IG5ldyBFbWJlci5FcnJvcigiUmVkdWNlIENvbXB1dGVk
        IFByb3BlcnR5IGRlY2xhcmVkIHdpdGhvdXQgYW4gb3B0aW9ucyBoYXNoIik7
        CiAgfQoKICBpZiAoISgnaW5pdGlhbFZhbHVlJyBpbiBvcHRpb25zKSkgewog
        ICAgdGhyb3cgbmV3IEVtYmVyLkVycm9yKCJSZWR1Y2UgQ29tcHV0ZWQgUHJv
        cGVydHkgZGVjbGFyZWQgd2l0aG91dCBhbiBpbml0aWFsIHZhbHVlIik7CiAg
        fQoKICB2YXIgY3AgPSBuZXcgUmVkdWNlQ29tcHV0ZWRQcm9wZXJ0eShvcHRp
        b25zKTsKCiAgaWYgKGFyZ3MpIHsKICAgIGNwLnByb3BlcnR5LmFwcGx5KGNw
        LCBhcmdzKTsKICB9CgogIHJldHVybiBjcDsKfTsKCn0pKCk7CgoKCihmdW5j
        dGlvbigpIHsKdmFyIFJlZHVjZUNvbXB1dGVkUHJvcGVydHkgPSBFbWJlci5S
        ZWR1Y2VDb21wdXRlZFByb3BlcnR5LAogICAgYV9zbGljZSA9IFtdLnNsaWNl
        LAogICAgb19jcmVhdGUgPSBFbWJlci5jcmVhdGUsCiAgICBmb3JFYWNoID0g
        RW1iZXIuRW51bWVyYWJsZVV0aWxzLmZvckVhY2g7CgpmdW5jdGlvbiBBcnJh
        eUNvbXB1dGVkUHJvcGVydHkoKSB7CiAgdmFyIGNwID0gdGhpczsKCiAgUmVk
        dWNlQ29tcHV0ZWRQcm9wZXJ0eS5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwoK
        ICB0aGlzLmZ1bmMgPSAoZnVuY3Rpb24ocmVkdWNlRnVuYykgewogICAgcmV0
        dXJuIGZ1bmN0aW9uIChwcm9wZXJ0eU5hbWUpIHsKICAgICAgaWYgKCFjcC5f
        aGFzSW5zdGFuY2VNZXRhKHRoaXMsIHByb3BlcnR5TmFtZSkpIHsKICAgICAg
        ICAvLyBXaGVuIHdlIHJlY29tcHV0ZSBhbiBhcnJheSBjb21wdXRlZCBwcm9w
        ZXJ0eSwgd2UgbmVlZCBhbHJlYWR5CiAgICAgICAgLy8gcmV0cmlldmVkIGFy
        cmF5cyB0byBiZSB1cGRhdGVkOyB3ZSBjYW4ndCBzaW1wbHkgZW1wdHkgdGhl
        IGNhY2hlIGFuZAogICAgICAgIC8vIGhvcGUgdGhlIGFycmF5IGlzIHJlLXJl
        dHJpZXZlZC4KICAgICAgICBmb3JFYWNoKGNwLl9kZXBlbmRlbnRLZXlzLCBm
        dW5jdGlvbihkZXBlbmRlbnRLZXkpIHsKICAgICAgICAgIEVtYmVyLmFkZE9i
        c2VydmVyKHRoaXMsIGRlcGVuZGVudEtleSwgZnVuY3Rpb24oKSB7CiAgICAg
        ICAgICAgIGNwLnJlY29tcHV0ZU9uY2UuY2FsbCh0aGlzLCBwcm9wZXJ0eU5h
        bWUpOwogICAgICAgICAgfSk7CiAgICAgICAgfSwgdGhpcyk7CiAgICAgIH0K
        CiAgICAgIHJldHVybiByZWR1Y2VGdW5jLmFwcGx5KHRoaXMsIGFyZ3VtZW50
        cyk7CiAgICB9OwogIH0pKHRoaXMuZnVuYyk7CgogIHJldHVybiB0aGlzOwp9
        CkVtYmVyLkFycmF5Q29tcHV0ZWRQcm9wZXJ0eSA9IEFycmF5Q29tcHV0ZWRQ
        cm9wZXJ0eTsKQXJyYXlDb21wdXRlZFByb3BlcnR5LnByb3RvdHlwZSA9IG9f
        Y3JlYXRlKFJlZHVjZUNvbXB1dGVkUHJvcGVydHkucHJvdG90eXBlKTsKQXJy
        YXlDb21wdXRlZFByb3BlcnR5LnByb3RvdHlwZS5pbml0aWFsVmFsdWUgPSBm
        dW5jdGlvbiAoKSB7CiAgcmV0dXJuIEVtYmVyLkEoKTsKfTsKQXJyYXlDb21w
        dXRlZFByb3BlcnR5LnByb3RvdHlwZS5yZXNldFZhbHVlID0gZnVuY3Rpb24g
        KGFycmF5KSB7CiAgYXJyYXkuY2xlYXIoKTsKICByZXR1cm4gYXJyYXk7Cn07
        CgovKioKICBDcmVhdGVzIGEgY29tcHV0ZWQgcHJvcGVydHkgd2hpY2ggb3Bl
        cmF0ZXMgb24gZGVwZW5kZW50IGFycmF5cyBhbmQKICBpcyB1cGRhdGVkIHdp
        dGggIm9uZSBhdCBhIHRpbWUiIHNlbWFudGljcy4gV2hlbiBpdGVtcyBhcmUg
        YWRkZWQgb3IKICByZW1vdmVkIGZyb20gdGhlIGRlcGVuZGVudCBhcnJheShz
        KSBhbiBhcnJheSBjb21wdXRlZCBvbmx5IG9wZXJhdGVzCiAgb24gdGhlIGNo
        YW5nZSBpbnN0ZWFkIG9mIHJlLWV2YWx1YXRpbmcgdGhlIGVudGlyZSBhcnJh
        eS4gVGhpcyBzaG91bGQKICByZXR1cm4gYW4gYXJyYXksIGlmIHlvdSdkIGxp
        a2UgdG8gdXNlICJvbmUgYXQgYSB0aW1lIiBzZW1hbnRpY3MgYW5kCiAgY29t
        cHV0ZSBzb21lIHZhbHVlIG90aGVyIHRoZW4gYW4gYXJyYXkgbG9vayBhdAog
        IGBFbWJlci5yZWR1Y2VDb21wdXRlZGAuCgogIElmIHRoZXJlIGFyZSBtb3Jl
        IHRoYW4gb25lIGFyZ3VtZW50cyB0aGUgZmlyc3QgYXJndW1lbnRzIGFyZQog
        IGNvbnNpZGVyZWQgdG8gYmUgZGVwZW5kZW50IHByb3BlcnR5IGtleXMuIFRo
        ZSBsYXN0IGFyZ3VtZW50IGlzCiAgcmVxdWlyZWQgdG8gYmUgYW4gb3B0aW9u
        cyBvYmplY3QuIFRoZSBvcHRpb25zIG9iamVjdCBjYW4gaGF2ZSB0aGUKICBm
        b2xsb3dpbmcgdGhyZWUgcHJvcGVydGllcy4KCiAgYGluaXRpYWxpemVgIC0g
        QW4gb3B0aW9uYWwgaW5pdGlhbGl6ZSBmdW5jdGlvbi4gVHlwaWNhbGx5IHRo
        aXMgd2lsbCBiZSB1c2VkCiAgdG8gc2V0IHVwIHN0YXRlIG9uIHRoZSBpbnN0
        YW5jZU1ldGEgb2JqZWN0LgoKICBgcmVtb3ZlZEl0ZW1gIC0gQSBmdW5jdGlv
        biB0aGF0IGlzIGNhbGxlZCBlYWNoIHRpbWUgYW4gZWxlbWVudCBpcwogIHJl
        bW92ZWQgZnJvbSB0aGUgYXJyYXkuCgogIGBhZGRlZEl0ZW1gIC0gQSBmdW5j
        dGlvbiB0aGF0IGlzIGNhbGxlZCBlYWNoIHRpbWUgYW4gZWxlbWVudCBpcwog
        IGFkZGVkIHRvIHRoZSBhcnJheS4KCgogIFRoZSBgaW5pdGlhbGl6ZWAgZnVu
        Y3Rpb24gaGFzIHRoZSBmb2xsb3dpbmcgc2lnbmF0dXJlOgoKICBgYGBqYXZh
        c2NyaXB0CiAgIGZ1bmN0aW9uIChhcnJheSwgY2hhbmdlTWV0YSwgaW5zdGFu
        Y2VNZXRhKQogIGBgYAoKICBgYXJyYXlgIC0gVGhlIGluaXRpYWwgdmFsdWUg
        b2YgdGhlIGFycmF5Q29tcHV0ZWQsIGFuIGVtcHR5IGFycmF5LgoKICBgY2hh
        bmdlTWV0YWAgLSBBbiBvYmplY3Qgd2hpY2ggY29udGFpbnMgbWV0YSBpbmZv
        cm1hdGlvbiBhYm91dCB0aGUKICBjb21wdXRlZC4gSXQgY29udGFpbnMgdGhl
        IGZvbGxvd2luZyBwcm9wZXJ0aWVzOgoKICAgICAtIGBwcm9wZXJ0eWAgdGhl
        IGNvbXB1dGVkIHByb3BlcnR5CiAgICAgLSBgcHJvcGVydHlOYW1lYCB0aGUg
        bmFtZSBvZiB0aGUgcHJvcGVydHkgb24gdGhlIG9iamVjdAoKICBgaW5zdGFu
        Y2VNZXRhYCAtIEFuIG9iamVjdCB0aGF0IGNhbiBiZSB1c2VkIHRvIHN0b3Jl
        IG1ldGEKICBpbmZvcm1hdGlvbiBuZWVkZWQgZm9yIGNhbGN1bGF0aW5nIHlv
        dXIgY29tcHV0ZWQuIEZvciBleGFtcGxlIGEKICB1bmlxdWUgY29tcHV0ZWQg
        bWlnaHQgdXNlIHRoaXMgdG8gc3RvcmUgdGhlIG51bWJlciBvZiB0aW1lcyBh
        IGdpdmVuCiAgZWxlbWVudCBpcyBmb3VuZCBpbiB0aGUgZGVwZW5kZW50IGFy
        cmF5LgoKCiAgVGhlIGByZW1vdmVkSXRlbWAgYW5kIGBhZGRlZEl0ZW1gIGZ1
        bmN0aW9ucyBib3RoIGhhdmUgdGhlIGZvbGxvd2luZyBzaWduYXR1cmU6Cgog
        IGBgYGphdmFzY3JpcHQKICBmdW5jdGlvbiAoYWNjdW11bGF0ZWRWYWx1ZSwg
        aXRlbSwgY2hhbmdlTWV0YSwgaW5zdGFuY2VNZXRhKQogIGBgYAoKICBgYWNj
        dW11bGF0ZWRWYWx1ZWAgLSBUaGUgdmFsdWUgcmV0dXJuZWQgZnJvbSB0aGUg
        bGFzdCB0aW1lCiAgYHJlbW92ZWRJdGVtYCBvciBgYWRkZWRJdGVtYCB3YXMg
        Y2FsbGVkIG9yIGFuIGVtcHR5IGFycmF5LgoKICBgaXRlbWAgLSB0aGUgZWxl
        bWVudCBhZGRlZCBvciByZW1vdmVkIGZyb20gdGhlIGFycmF5CgogIGBjaGFu
        Z2VNZXRhYCAtIEFuIG9iamVjdCB3aGljaCBjb250YWlucyBtZXRhIGluZm9y
        bWF0aW9uIGFib3V0IHRoZQogIGNoYW5nZS4gSXQgY29udGFpbnMgdGhlIGZv
        bGxvd2luZyBwcm9wZXJ0aWVzOgoKICAgIC0gYHByb3BlcnR5YCB0aGUgY29t
        cHV0ZWQgcHJvcGVydHkKICAgIC0gYHByb3BlcnR5TmFtZWAgdGhlIG5hbWUg
        b2YgdGhlIHByb3BlcnR5IG9uIHRoZSBvYmplY3QKICAgIC0gYGluZGV4YCB0
        aGUgaW5kZXggb2YgdGhlIGFkZGVkIG9yIHJlbW92ZWQgaXRlbQogICAgLSBg
        aXRlbWAgdGhlIGFkZGVkIG9yIHJlbW92ZWQgaXRlbTogdGhpcyBpcyBleGFj
        dGx5IHRoZSBzYW1lIGFzCiAgICAgIHRoZSBzZWNvbmQgYXJnCiAgICAtIGBh
        cnJheUNoYW5nZWRgIHRoZSBhcnJheSB0aGF0IHRyaWdnZXJlZCB0aGUgY2hh
        bmdlLiBDYW4gYmUKICAgICAgdXNlZnVsIHdoZW4gZGVwZW5kaW5nIG9uIG11
        bHRpcGxlIGFycmF5cy4KCiAgRm9yIHByb3BlcnR5IGNoYW5nZXMgdHJpZ2dl
        cmVkIG9uIGFuIGl0ZW0gcHJvcGVydHkgY2hhbmdlICh3aGVuCiAgZGVwS2V5
        IGlzIHNvbWV0aGluZyBsaWtlIGBzb21lQXJyYXkuQGVhY2guc29tZVByb3Bl
        cnR5YCksCiAgYGNoYW5nZU1ldGFgIHdpbGwgYWxzbyBjb250YWluIHRoZSBm
        b2xsb3dpbmcgcHJvcGVydHk6CgogICAgLSBgcHJldmlvdXNWYWx1ZXNgIGFu
        IG9iamVjdCB3aG9zZSBrZXlzIGFyZSB0aGUgcHJvcGVydGllcyB0aGF0IGNo
        YW5nZWQgb24KICAgIHRoZSBpdGVtLCBhbmQgd2hvc2UgdmFsdWVzIGFyZSB0
        aGUgaXRlbSdzIHByZXZpb3VzIHZhbHVlcy4KCiAgYHByZXZpb3VzVmFsdWVz
        YCBpcyBpbXBvcnRhbnQgRW1iZXIgY29hbGVzY2VzIGl0ZW0gcHJvcGVydHkg
        Y2hhbmdlcyB2aWEKICBFbWJlci5ydW4ub25jZS4gVGhpcyBtZWFucyB0aGF0
        IGJ5IHRoZSB0aW1lIHJlbW92ZWRJdGVtIGdldHMgY2FsbGVkLCBpdGVtIGhh
        cwogIHRoZSBuZXcgdmFsdWVzLCBidXQgeW91IG1heSBuZWVkIHRoZSBwcmV2
        aW91cyB2YWx1ZSAoZWcgZm9yIHNvcnRpbmcgJgogIGZpbHRlcmluZykuCgog
        IGBpbnN0YW5jZU1ldGFgIC0gQW4gb2JqZWN0IHRoYXQgY2FuIGJlIHVzZWQg
        dG8gc3RvcmUgbWV0YQogIGluZm9ybWF0aW9uIG5lZWRlZCBmb3IgY2FsY3Vs
        YXRpbmcgeW91ciBjb21wdXRlZC4gRm9yIGV4YW1wbGUgYQogIHVuaXF1ZSBj
        b21wdXRlZCBtaWdodCB1c2UgdGhpcyB0byBzdG9yZSB0aGUgbnVtYmVyIG9m
        IHRpbWVzIGEgZ2l2ZW4KICBlbGVtZW50IGlzIGZvdW5kIGluIHRoZSBkZXBl
        bmRlbnQgYXJyYXkuCgogIFRoZSBgcmVtb3ZlZEl0ZW1gIGFuZCBgYWRkZWRJ
        dGVtYCBmdW5jdGlvbnMgc2hvdWxkIHJldHVybiB0aGUgYWNjdW11bGF0ZWQK
        ICB2YWx1ZS4gSXQgaXMgYWNjZXB0YWJsZSB0byBub3QgcmV0dXJuIGFueXRo
        aW5nIChpZSByZXR1cm4gdW5kZWZpbmVkKQogIHRvIGludmFsaWRhdGUgdGhl
        IGNvbXB1dGF0aW9uLiBUaGlzIGlzIGdlbmVyYWxseSBub3QgYSBnb29kIGlk
        ZWEgZm9yCiAgYXJyYXlDb21wdXRlZCBidXQgaXQncyB1c2VkIGluIGVnIG1h
        eCBhbmQgbWluLgoKICBFeGFtcGxlCgogIGBgYGphdmFzY3JpcHQKICBFbWJl
        ci5jb21wdXRlZC5tYXAgPSBmdW5jdGlvbihkZXBlbmRlbnRLZXksIGNhbGxi
        YWNrKSB7CiAgICB2YXIgb3B0aW9ucyA9IHsKICAgICAgYWRkZWRJdGVtOiBm
        dW5jdGlvbihhcnJheSwgaXRlbSwgY2hhbmdlTWV0YSwgaW5zdGFuY2VNZXRh
        KSB7CiAgICAgICAgdmFyIG1hcHBlZCA9IGNhbGxiYWNrKGl0ZW0pOwogICAg
        ICAgIGFycmF5Lmluc2VydEF0KGNoYW5nZU1ldGEuaW5kZXgsIG1hcHBlZCk7
        CiAgICAgICAgcmV0dXJuIGFycmF5OwogICAgICB9LAogICAgICByZW1vdmVk
        SXRlbTogZnVuY3Rpb24oYXJyYXksIGl0ZW0sIGNoYW5nZU1ldGEsIGluc3Rh
        bmNlTWV0YSkgewogICAgICAgIGFycmF5LnJlbW92ZUF0KGNoYW5nZU1ldGEu
        aW5kZXgsIDEpOwogICAgICAgIHJldHVybiBhcnJheTsKICAgICAgfQogICAg
        fTsKCiAgICByZXR1cm4gRW1iZXIuYXJyYXlDb21wdXRlZChkZXBlbmRlbnRL
        ZXksIG9wdGlvbnMpOwogIH07CiAgYGBgCgogIEBtZXRob2QgYXJyYXlDb21w
        dXRlZAogIEBmb3IgRW1iZXIKICBAcGFyYW0ge1N0cmluZ30gW2RlcGVuZGVu
        dEtleXMqXQogIEBwYXJhbSB7T2JqZWN0fSBvcHRpb25zCiAgQHJldHVybiB7
        RW1iZXIuQ29tcHV0ZWRQcm9wZXJ0eX0KKi8KRW1iZXIuYXJyYXlDb21wdXRl
        ZCA9IGZ1bmN0aW9uIChvcHRpb25zKSB7CiAgdmFyIGFyZ3M7CgogIGlmIChh
        cmd1bWVudHMubGVuZ3RoID4gMSkgewogICAgYXJncyA9IGFfc2xpY2UuY2Fs
        bChhcmd1bWVudHMsIDAsIC0xKTsKICAgIG9wdGlvbnMgPSBhX3NsaWNlLmNh
        bGwoYXJndW1lbnRzLCAtMSlbMF07CiAgfQoKICBpZiAodHlwZW9mIG9wdGlv
        bnMgIT09ICJvYmplY3QiKSB7CiAgICB0aHJvdyBuZXcgRW1iZXIuRXJyb3Io
        IkFycmF5IENvbXB1dGVkIFByb3BlcnR5IGRlY2xhcmVkIHdpdGhvdXQgYW4g
        b3B0aW9ucyBoYXNoIik7CiAgfQoKICB2YXIgY3AgPSBuZXcgQXJyYXlDb21w
        dXRlZFByb3BlcnR5KG9wdGlvbnMpOwoKICBpZiAoYXJncykgewogICAgY3Au
        cHJvcGVydHkuYXBwbHkoY3AsIGFyZ3MpOwogIH0KCiAgcmV0dXJuIGNwOwp9
        OwoKfSkoKTsKCgoKKGZ1bmN0aW9uKCkgewovKioKQG1vZHVsZSBlbWJlcgpA
        c3VibW9kdWxlIGVtYmVyLXJ1bnRpbWUKKi8KCnZhciBnZXQgPSBFbWJlci5n
        ZXQsCiAgICBzZXQgPSBFbWJlci5zZXQsCiAgICBndWlkRm9yID0gRW1iZXIu
        Z3VpZEZvciwKICAgIG1lcmdlID0gRW1iZXIubWVyZ2UsCiAgICBhX3NsaWNl
        ID0gW10uc2xpY2UsCiAgICBmb3JFYWNoID0gRW1iZXIuRW51bWVyYWJsZVV0
        aWxzLmZvckVhY2gsCiAgICBtYXAgPSBFbWJlci5FbnVtZXJhYmxlVXRpbHMu
        bWFwOwoKLyoqCiAgQSBjb21wdXRlZCBwcm9wZXJ0eSB0aGF0IGNhbGN1bGF0
        ZXMgdGhlIG1heGltdW0gdmFsdWUgaW4gdGhlCiAgZGVwZW5kZW50IGFycmF5
        LiBUaGlzIHdpbGwgcmV0dXJuIGAtSW5maW5pdHlgIHdoZW4gdGhlIGRlcGVu
        ZGVudAogIGFycmF5IGlzIGVtcHR5LgoKICBFeGFtcGxlCgogIGBgYGphdmFz
        Y3JpcHQKICBBcHAuUGVyc29uID0gRW1iZXIuT2JqZWN0LmV4dGVuZCh7CiAg
        ICBjaGlsZEFnZXM6IEVtYmVyLmNvbXB1dGVkLm1hcEJ5KCdjaGlsZHJlbics
        ICdhZ2UnKSwKICAgIG1heENoaWxkQWdlOiBFbWJlci5jb21wdXRlZC5tYXgo
        J2NoaWxkQWdlcycpCiAgfSk7CgogIHZhciBsb3JkQnlyb24gPSBBcHAuUGVy
        c29uLmNyZWF0ZSh7Y2hpbGRyZW46IFtdfSk7CiAgbG9yZEJ5cm9uLmdldCgn
        bWF4Q2hpbGRBZ2UnKTsgLy8gLUluZmluaXR5CiAgbG9yZEJ5cm9uLmdldCgn
        Y2hpbGRyZW4nKS5wdXNoT2JqZWN0KHtuYW1lOiAnQXVndXN0YSBBZGEgQnly
        b24nLCBhZ2U6IDd9KTsKICBsb3JkQnlyb24uZ2V0KCdtYXhDaGlsZEFnZScp
        OyAvLyA3CiAgbG9yZEJ5cm9uLmdldCgnY2hpbGRyZW4nKS5wdXNoT2JqZWN0
        cyhbe25hbWU6ICdBbGxlZ3JhIEJ5cm9uJywgYWdlOiA1fSwge25hbWU6ICdF
        bGl6YWJldGggTWVkb3JhIExlaWdoJywgYWdlOiA4fV0pOwogIGxvcmRCeXJv
        bi5nZXQoJ21heENoaWxkQWdlJyk7IC8vIDgKICBgYGAKCiAgQG1ldGhvZCBj
        b21wdXRlZC5tYXgKICBAZm9yIEVtYmVyCiAgQHBhcmFtIHtTdHJpbmd9IGRl
        cGVuZGVudEtleQogIEByZXR1cm4ge0VtYmVyLkNvbXB1dGVkUHJvcGVydHl9
        IGNvbXB1dGVzIHRoZSBsYXJnZXN0IHZhbHVlIGluIHRoZSBkZXBlbmRlbnRL
        ZXkncyBhcnJheQoqLwpFbWJlci5jb21wdXRlZC5tYXggPSBmdW5jdGlvbiAo
        ZGVwZW5kZW50S2V5KSB7CiAgcmV0dXJuIEVtYmVyLnJlZHVjZUNvbXB1dGVk
        LmNhbGwobnVsbCwgZGVwZW5kZW50S2V5LCB7CiAgICBpbml0aWFsVmFsdWU6
        IC1JbmZpbml0eSwKCiAgICBhZGRlZEl0ZW06IGZ1bmN0aW9uIChhY2N1bXVs
        YXRlZFZhbHVlLCBpdGVtLCBjaGFuZ2VNZXRhLCBpbnN0YW5jZU1ldGEpIHsK
        ICAgICAgcmV0dXJuIE1hdGgubWF4KGFjY3VtdWxhdGVkVmFsdWUsIGl0ZW0p
        OwogICAgfSwKCiAgICByZW1vdmVkSXRlbTogZnVuY3Rpb24gKGFjY3VtdWxh
        dGVkVmFsdWUsIGl0ZW0sIGNoYW5nZU1ldGEsIGluc3RhbmNlTWV0YSkgewog
        ICAgICBpZiAoaXRlbSA8IGFjY3VtdWxhdGVkVmFsdWUpIHsKICAgICAgICBy
        ZXR1cm4gYWNjdW11bGF0ZWRWYWx1ZTsKICAgICAgfQogICAgfQogIH0pOwp9
        OwoKLyoqCiAgQSBjb21wdXRlZCBwcm9wZXJ0eSB0aGF0IGNhbGN1bGF0ZXMg
        dGhlIG1pbmltdW0gdmFsdWUgaW4gdGhlCiAgZGVwZW5kZW50IGFycmF5LiBU
        aGlzIHdpbGwgcmV0dXJuIGBJbmZpbml0eWAgd2hlbiB0aGUgZGVwZW5kZW50
        CiAgYXJyYXkgaXMgZW1wdHkuCgogIEV4YW1wbGUKCiAgYGBgamF2YXNjcmlw
        dAogIEFwcC5QZXJzb24gPSBFbWJlci5PYmplY3QuZXh0ZW5kKHsKICAgIGNo
        aWxkQWdlczogRW1iZXIuY29tcHV0ZWQubWFwQnkoJ2NoaWxkcmVuJywgJ2Fn
        ZScpLAogICAgbWluQ2hpbGRBZ2U6IEVtYmVyLmNvbXB1dGVkLm1pbignY2hp
        bGRBZ2VzJykKICB9KTsKCiAgdmFyIGxvcmRCeXJvbiA9IEFwcC5QZXJzb24u
        Y3JlYXRlKHtjaGlsZHJlbjogW119KTsKICBsb3JkQnlyb24uZ2V0KCdtaW5D
        aGlsZEFnZScpOyAvLyBJbmZpbml0eQogIGxvcmRCeXJvbi5nZXQoJ2NoaWxk
        cmVuJykucHVzaE9iamVjdCh7bmFtZTogJ0F1Z3VzdGEgQWRhIEJ5cm9uJywg
        YWdlOiA3fSk7CiAgbG9yZEJ5cm9uLmdldCgnbWluQ2hpbGRBZ2UnKTsgLy8g
        NwogIGxvcmRCeXJvbi5nZXQoJ2NoaWxkcmVuJykucHVzaE9iamVjdHMoW3tu
        YW1lOiAnQWxsZWdyYSBCeXJvbicsIGFnZTogNX0sIHtuYW1lOiAnRWxpemFi
        ZXRoIE1lZG9yYSBMZWlnaCcsIGFnZTogOH1dKTsKICBsb3JkQnlyb24uZ2V0
        KCdtaW5DaGlsZEFnZScpOyAvLyA1CiAgYGBgCgogIEBtZXRob2QgY29tcHV0
        ZWQubWluCiAgQGZvciBFbWJlcgogIEBwYXJhbSB7U3RyaW5nfSBkZXBlbmRl
        bnRLZXkKICBAcmV0dXJuIHtFbWJlci5Db21wdXRlZFByb3BlcnR5fSBjb21w
        dXRlcyB0aGUgc21hbGxlc3QgdmFsdWUgaW4gdGhlIGRlcGVuZGVudEtleSdz
        IGFycmF5CiovCkVtYmVyLmNvbXB1dGVkLm1pbiA9IGZ1bmN0aW9uIChkZXBl
        bmRlbnRLZXkpIHsKICByZXR1cm4gRW1iZXIucmVkdWNlQ29tcHV0ZWQuY2Fs
        bChudWxsLCBkZXBlbmRlbnRLZXksIHsKICAgIGluaXRpYWxWYWx1ZTogSW5m
        aW5pdHksCgogICAgYWRkZWRJdGVtOiBmdW5jdGlvbiAoYWNjdW11bGF0ZWRW
        YWx1ZSwgaXRlbSwgY2hhbmdlTWV0YSwgaW5zdGFuY2VNZXRhKSB7CiAgICAg
        IHJldHVybiBNYXRoLm1pbihhY2N1bXVsYXRlZFZhbHVlLCBpdGVtKTsKICAg
        IH0sCgogICAgcmVtb3ZlZEl0ZW06IGZ1bmN0aW9uIChhY2N1bXVsYXRlZFZh
        bHVlLCBpdGVtLCBjaGFuZ2VNZXRhLCBpbnN0YW5jZU1ldGEpIHsKICAgICAg
        aWYgKGl0ZW0gPiBhY2N1bXVsYXRlZFZhbHVlKSB7CiAgICAgICAgcmV0dXJu
        IGFjY3VtdWxhdGVkVmFsdWU7CiAgICAgIH0KICAgIH0KICB9KTsKfTsKCi8q
        KgogIFJldHVybnMgYW4gYXJyYXkgbWFwcGVkIHZpYSB0aGUgY2FsbGJhY2sK
        CiAgVGhlIGNhbGxiYWNrIG1ldGhvZCB5b3UgcHJvdmlkZSBzaG91bGQgaGF2
        ZSB0aGUgZm9sbG93aW5nIHNpZ25hdHVyZToKCiAgYGBgamF2YXNjcmlwdAog
        IGZ1bmN0aW9uKGl0ZW0pOwogIGBgYAoKICAtIGBpdGVtYCBpcyB0aGUgY3Vy
        cmVudCBpdGVtIGluIHRoZSBpdGVyYXRpb24uCgogIEV4YW1wbGUKCiAgYGBg
        amF2YXNjcmlwdAogIEFwcC5IYW1wc3RlciA9IEVtYmVyLk9iamVjdC5leHRl
        bmQoewogICAgZXhjaXRpbmdDaG9yZXM6IEVtYmVyLmNvbXB1dGVkLm1hcCgn
        Y2hvcmVzJywgZnVuY3Rpb24oY2hvcmUpIHsKICAgICAgcmV0dXJuIGNob3Jl
        LnRvVXBwZXJDYXNlKCkgKyAnISc7CiAgICB9KQogIH0pOwoKICB2YXIgaGFt
        cHN0ZXIgPSBBcHAuSGFtcHN0ZXIuY3JlYXRlKHtjaG9yZXM6IFsnY29vaycs
        ICdjbGVhbicsICd3cml0ZSBtb3JlIHVuaXQgdGVzdHMnXX0pOwogIGhhbXBz
        dGVyLmdldCgnZXhjaXRpbmdDaG9yZXMnKTsgLy8gWydDT09LIScsICdDTEVB
        TiEnLCAnV1JJVEUgTU9SRSBVTklUIFRFU1RTISddCiAgYGBgCgogIEBtZXRo
        b2QgY29tcHV0ZWQubWFwCiAgQGZvciBFbWJlcgogIEBwYXJhbSB7U3RyaW5n
        fSBkZXBlbmRlbnRLZXkKICBAcGFyYW0ge0Z1bmN0aW9ufSBjYWxsYmFjawog
        IEByZXR1cm4ge0VtYmVyLkNvbXB1dGVkUHJvcGVydHl9IGFuIGFycmF5IG1h
        cHBlZCB2aWEgdGhlIGNhbGxiYWNrCiovCkVtYmVyLmNvbXB1dGVkLm1hcCA9
        IGZ1bmN0aW9uKGRlcGVuZGVudEtleSwgY2FsbGJhY2spIHsKICB2YXIgb3B0
        aW9ucyA9IHsKICAgIGFkZGVkSXRlbTogZnVuY3Rpb24oYXJyYXksIGl0ZW0s
        IGNoYW5nZU1ldGEsIGluc3RhbmNlTWV0YSkgewogICAgICB2YXIgbWFwcGVk
        ID0gY2FsbGJhY2suY2FsbCh0aGlzLCBpdGVtKTsKICAgICAgYXJyYXkuaW5z
        ZXJ0QXQoY2hhbmdlTWV0YS5pbmRleCwgbWFwcGVkKTsKICAgICAgcmV0dXJu
        IGFycmF5OwogICAgfSwKICAgIHJlbW92ZWRJdGVtOiBmdW5jdGlvbihhcnJh
        eSwgaXRlbSwgY2hhbmdlTWV0YSwgaW5zdGFuY2VNZXRhKSB7CiAgICAgIGFy
        cmF5LnJlbW92ZUF0KGNoYW5nZU1ldGEuaW5kZXgsIDEpOwogICAgICByZXR1
        cm4gYXJyYXk7CiAgICB9CiAgfTsKCiAgcmV0dXJuIEVtYmVyLmFycmF5Q29t
        cHV0ZWQoZGVwZW5kZW50S2V5LCBvcHRpb25zKTsKfTsKCi8qKgogIFJldHVy
        bnMgYW4gYXJyYXkgbWFwcGVkIHRvIHRoZSBzcGVjaWZpZWQga2V5LgoKICBF
        eGFtcGxlCgogIGBgYGphdmFzY3JpcHQKICBBcHAuUGVyc29uID0gRW1iZXIu
        T2JqZWN0LmV4dGVuZCh7CiAgICBjaGlsZEFnZXM6IEVtYmVyLmNvbXB1dGVk
        Lm1hcEJ5KCdjaGlsZHJlbicsICdhZ2UnKQogIH0pOwoKICB2YXIgbG9yZEJ5
        cm9uID0gQXBwLlBlcnNvbi5jcmVhdGUoe2NoaWxkcmVuOiBbXX0pOwogIGxv
        cmRCeXJvbi5nZXQoJ2NoaWxkQWdlcycpOyAvLyBbXQogIGxvcmRCeXJvbi5n
        ZXQoJ2NoaWxkcmVuJykucHVzaE9iamVjdCh7bmFtZTogJ0F1Z3VzdGEgQWRh
        IEJ5cm9uJywgYWdlOiA3fSk7CiAgbG9yZEJ5cm9uLmdldCgnY2hpbGRBZ2Vz
        Jyk7IC8vIFs3XQogIGxvcmRCeXJvbi5nZXQoJ2NoaWxkcmVuJykucHVzaE9i
        amVjdHMoW3tuYW1lOiAnQWxsZWdyYSBCeXJvbicsIGFnZTogNX0sIHtuYW1l
        OiAnRWxpemFiZXRoIE1lZG9yYSBMZWlnaCcsIGFnZTogOH1dKTsKICBsb3Jk
        Qnlyb24uZ2V0KCdjaGlsZEFnZXMnKTsgLy8gWzcsIDUsIDhdCiAgYGBgCgog
        IEBtZXRob2QgY29tcHV0ZWQubWFwQnkKICBAZm9yIEVtYmVyCiAgQHBhcmFt
        IHtTdHJpbmd9IGRlcGVuZGVudEtleQogIEBwYXJhbSB7U3RyaW5nfSBwcm9w
        ZXJ0eUtleQogIEByZXR1cm4ge0VtYmVyLkNvbXB1dGVkUHJvcGVydHl9IGFu
        IGFycmF5IG1hcHBlZCB0byB0aGUgc3BlY2lmaWVkIGtleQoqLwpFbWJlci5j
        b21wdXRlZC5tYXBCeSA9IGZ1bmN0aW9uKGRlcGVuZGVudEtleSwgcHJvcGVy
        dHlLZXkpIHsKICB2YXIgY2FsbGJhY2sgPSBmdW5jdGlvbihpdGVtKSB7IHJl
        dHVybiBnZXQoaXRlbSwgcHJvcGVydHlLZXkpOyB9OwogIHJldHVybiBFbWJl
        ci5jb21wdXRlZC5tYXAoZGVwZW5kZW50S2V5ICsgJy5AZWFjaC4nICsgcHJv
        cGVydHlLZXksIGNhbGxiYWNrKTsKfTsKCi8qKgogIEBtZXRob2QgY29tcHV0
        ZWQubWFwUHJvcGVydHkKICBAZm9yIEVtYmVyCiAgQGRlcHJlY2F0ZWQgVXNl
        IGBFbWJlci5jb21wdXRlZC5tYXBCeWAgaW5zdGVhZAogIEBwYXJhbSBkZXBl
        bmRlbnRLZXkKICBAcGFyYW0gcHJvcGVydHlLZXkKKi8KRW1iZXIuY29tcHV0
        ZWQubWFwUHJvcGVydHkgPSBFbWJlci5jb21wdXRlZC5tYXBCeTsKCi8qKgog
        IEZpbHRlcnMgdGhlIGFycmF5IGJ5IHRoZSBjYWxsYmFjay4KCiAgVGhlIGNh
        bGxiYWNrIG1ldGhvZCB5b3UgcHJvdmlkZSBzaG91bGQgaGF2ZSB0aGUgZm9s
        bG93aW5nIHNpZ25hdHVyZToKCiAgYGBgamF2YXNjcmlwdAogIGZ1bmN0aW9u
        KGl0ZW0pOwogIGBgYAoKICAtIGBpdGVtYCBpcyB0aGUgY3VycmVudCBpdGVt
        IGluIHRoZSBpdGVyYXRpb24uCgogIEV4YW1wbGUKCiAgYGBgamF2YXNjcmlw
        dAogIEFwcC5IYW1wc3RlciA9IEVtYmVyLk9iamVjdC5leHRlbmQoewogICAg
        cmVtYWluaW5nQ2hvcmVzOiBFbWJlci5jb21wdXRlZC5maWx0ZXIoJ2Nob3Jl
        cycsIGZ1bmN0aW9uKGNob3JlKSB7CiAgICAgIHJldHVybiAhY2hvcmUuZG9u
        ZTsKICAgIH0pCiAgfSk7CgogIHZhciBoYW1wc3RlciA9IEFwcC5IYW1wc3Rl
        ci5jcmVhdGUoe2Nob3JlczogWwogICAge25hbWU6ICdjb29rJywgZG9uZTog
        dHJ1ZX0sCiAgICB7bmFtZTogJ2NsZWFuJywgZG9uZTogdHJ1ZX0sCiAgICB7
        bmFtZTogJ3dyaXRlIG1vcmUgdW5pdCB0ZXN0cycsIGRvbmU6IGZhbHNlfQog
        IF19KTsKICBoYW1wc3Rlci5nZXQoJ3JlbWFpbmluZ0Nob3JlcycpOyAvLyBb
        e25hbWU6ICd3cml0ZSBtb3JlIHVuaXQgdGVzdHMnLCBkb25lOiBmYWxzZX1d
        CiAgYGBgCgogIEBtZXRob2QgY29tcHV0ZWQuZmlsdGVyCiAgQGZvciBFbWJl
        cgogIEBwYXJhbSB7U3RyaW5nfSBkZXBlbmRlbnRLZXkKICBAcGFyYW0ge0Z1
        bmN0aW9ufSBjYWxsYmFjawogIEByZXR1cm4ge0VtYmVyLkNvbXB1dGVkUHJv
        cGVydHl9IHRoZSBmaWx0ZXJlZCBhcnJheQoqLwpFbWJlci5jb21wdXRlZC5m
        aWx0ZXIgPSBmdW5jdGlvbihkZXBlbmRlbnRLZXksIGNhbGxiYWNrKSB7CiAg
        dmFyIG9wdGlvbnMgPSB7CiAgICBpbml0aWFsaXplOiBmdW5jdGlvbiAoYXJy
        YXksIGNoYW5nZU1ldGEsIGluc3RhbmNlTWV0YSkgewogICAgICBpbnN0YW5j
        ZU1ldGEuZmlsdGVyZWRBcnJheUluZGV4ZXMgPSBuZXcgRW1iZXIuU3ViQXJy
        YXkoKTsKICAgIH0sCgogICAgYWRkZWRJdGVtOiBmdW5jdGlvbihhcnJheSwg
        aXRlbSwgY2hhbmdlTWV0YSwgaW5zdGFuY2VNZXRhKSB7CiAgICAgIHZhciBt
        YXRjaCA9ICEhY2FsbGJhY2suY2FsbCh0aGlzLCBpdGVtKSwKICAgICAgICAg
        IGZpbHRlckluZGV4ID0gaW5zdGFuY2VNZXRhLmZpbHRlcmVkQXJyYXlJbmRl
        eGVzLmFkZEl0ZW0oY2hhbmdlTWV0YS5pbmRleCwgbWF0Y2gpOwoKICAgICAg
        aWYgKG1hdGNoKSB7CiAgICAgICAgYXJyYXkuaW5zZXJ0QXQoZmlsdGVySW5k
        ZXgsIGl0ZW0pOwogICAgICB9CgogICAgICByZXR1cm4gYXJyYXk7CiAgICB9
        LAoKICAgIHJlbW92ZWRJdGVtOiBmdW5jdGlvbihhcnJheSwgaXRlbSwgY2hh
        bmdlTWV0YSwgaW5zdGFuY2VNZXRhKSB7CiAgICAgIHZhciBmaWx0ZXJJbmRl
        eCA9IGluc3RhbmNlTWV0YS5maWx0ZXJlZEFycmF5SW5kZXhlcy5yZW1vdmVJ
        dGVtKGNoYW5nZU1ldGEuaW5kZXgpOwoKICAgICAgaWYgKGZpbHRlckluZGV4
        ID4gLTEpIHsKICAgICAgICBhcnJheS5yZW1vdmVBdChmaWx0ZXJJbmRleCk7
        CiAgICAgIH0KCiAgICAgIHJldHVybiBhcnJheTsKICAgIH0KICB9OwoKICBy
        ZXR1cm4gRW1iZXIuYXJyYXlDb21wdXRlZChkZXBlbmRlbnRLZXksIG9wdGlv
        bnMpOwp9OwoKLyoqCiAgRmlsdGVycyB0aGUgYXJyYXkgYnkgdGhlIHByb3Bl
        cnR5IGFuZCB2YWx1ZQoKICBFeGFtcGxlCgogIGBgYGphdmFzY3JpcHQKICBB
        cHAuSGFtcHN0ZXIgPSBFbWJlci5PYmplY3QuZXh0ZW5kKHsKICAgIHJlbWFp
        bmluZ0Nob3JlczogRW1iZXIuY29tcHV0ZWQuZmlsdGVyQnkoJ2Nob3Jlcycs
        ICdkb25lJywgZmFsc2UpCiAgfSk7CgogIHZhciBoYW1wc3RlciA9IEFwcC5I
        YW1wc3Rlci5jcmVhdGUoe2Nob3JlczogWwogICAge25hbWU6ICdjb29rJywg
        ZG9uZTogdHJ1ZX0sCiAgICB7bmFtZTogJ2NsZWFuJywgZG9uZTogdHJ1ZX0s
        CiAgICB7bmFtZTogJ3dyaXRlIG1vcmUgdW5pdCB0ZXN0cycsIGRvbmU6IGZh
        bHNlfQogIF19KTsKICBoYW1wc3Rlci5nZXQoJ3JlbWFpbmluZ0Nob3Jlcycp
        OyAvLyBbe25hbWU6ICd3cml0ZSBtb3JlIHVuaXQgdGVzdHMnLCBkb25lOiBm
        YWxzZX1dCiAgYGBgCgogIEBtZXRob2QgY29tcHV0ZWQuZmlsdGVyQnkKICBA
        Zm9yIEVtYmVyCiAgQHBhcmFtIHtTdHJpbmd9IGRlcGVuZGVudEtleQogIEBw
        YXJhbSB7U3RyaW5nfSBwcm9wZXJ0eUtleQogIEBwYXJhbSB7U3RyaW5nfSB2
        YWx1ZQogIEByZXR1cm4ge0VtYmVyLkNvbXB1dGVkUHJvcGVydHl9IHRoZSBm
        aWx0ZXJlZCBhcnJheQoqLwpFbWJlci5jb21wdXRlZC5maWx0ZXJCeSA9IGZ1
        bmN0aW9uKGRlcGVuZGVudEtleSwgcHJvcGVydHlLZXksIHZhbHVlKSB7CiAg
        dmFyIGNhbGxiYWNrOwoKICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMikg
        ewogICAgY2FsbGJhY2sgPSBmdW5jdGlvbihpdGVtKSB7CiAgICAgIHJldHVy
        biBnZXQoaXRlbSwgcHJvcGVydHlLZXkpOwogICAgfTsKICB9IGVsc2Ugewog
        ICAgY2FsbGJhY2sgPSBmdW5jdGlvbihpdGVtKSB7CiAgICAgIHJldHVybiBn
        ZXQoaXRlbSwgcHJvcGVydHlLZXkpID09PSB2YWx1ZTsKICAgIH07CiAgfQoK
        ICByZXR1cm4gRW1iZXIuY29tcHV0ZWQuZmlsdGVyKGRlcGVuZGVudEtleSAr
        ICcuQGVhY2guJyArIHByb3BlcnR5S2V5LCBjYWxsYmFjayk7Cn07CgovKioK
        ICBAbWV0aG9kIGNvbXB1dGVkLmZpbHRlclByb3BlcnR5CiAgQGZvciBFbWJl
        cgogIEBwYXJhbSBkZXBlbmRlbnRLZXkKICBAcGFyYW0gcHJvcGVydHlLZXkK
        ICBAcGFyYW0gdmFsdWUKICBAZGVwcmVjYXRlZCBVc2UgYEVtYmVyLmNvbXB1
        dGVkLmZpbHRlckJ5YCBpbnN0ZWFkCiovCkVtYmVyLmNvbXB1dGVkLmZpbHRl
        clByb3BlcnR5ID0gRW1iZXIuY29tcHV0ZWQuZmlsdGVyQnk7CgovKioKICBB
        IGNvbXB1dGVkIHByb3BlcnR5IHdoaWNoIHJldHVybnMgYSBuZXcgYXJyYXkg
        d2l0aCBhbGwgdGhlIHVuaXF1ZQogIGVsZW1lbnRzIGZyb20gb25lIG9yIG1v
        cmUgZGVwZW5kZW50IGFycmF5cy4KCiAgRXhhbXBsZQoKICBgYGBqYXZhc2Ny
        aXB0CiAgQXBwLkhhbXBzdGVyID0gRW1iZXIuT2JqZWN0LmV4dGVuZCh7CiAg
        ICB1bmlxdWVGcnVpdHM6IEVtYmVyLmNvbXB1dGVkLnVuaXEoJ2ZydWl0cycp
        CiAgfSk7CgogIHZhciBoYW1wc3RlciA9IEFwcC5IYW1wc3Rlci5jcmVhdGUo
        e2ZydWl0czogWwogICAgJ2JhbmFuYScsCiAgICAnZ3JhcGUnLAogICAgJ2th
        bGUnLAogICAgJ2JhbmFuYScKICBdfSk7CiAgaGFtcHN0ZXIuZ2V0KCd1bmlx
        dWVGcnVpdHMnKTsgLy8gWydiYW5hbmEnLCAnZ3JhcGUnLCAna2FsZSddCiAg
        YGBgCgogIEBtZXRob2QgY29tcHV0ZWQudW5pcQogIEBmb3IgRW1iZXIKICBA
        cGFyYW0ge1N0cmluZ30gcHJvcGVydHlLZXkqCiAgQHJldHVybiB7RW1iZXIu
        Q29tcHV0ZWRQcm9wZXJ0eX0gY29tcHV0ZXMgYSBuZXcgYXJyYXkgd2l0aCBh
        bGwgdGhlCiAgdW5pcXVlIGVsZW1lbnRzIGZyb20gdGhlIGRlcGVuZGVudCBh
        cnJheQoqLwpFbWJlci5jb21wdXRlZC51bmlxID0gZnVuY3Rpb24oKSB7CiAg
        dmFyIGFyZ3MgPSBhX3NsaWNlLmNhbGwoYXJndW1lbnRzKTsKICBhcmdzLnB1
        c2goewogICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24oYXJyYXksIGNoYW5nZU1l
        dGEsIGluc3RhbmNlTWV0YSkgewogICAgICBpbnN0YW5jZU1ldGEuaXRlbUNv
        dW50cyA9IHt9OwogICAgfSwKCiAgICBhZGRlZEl0ZW06IGZ1bmN0aW9uKGFy
        cmF5LCBpdGVtLCBjaGFuZ2VNZXRhLCBpbnN0YW5jZU1ldGEpIHsKICAgICAg
        dmFyIGd1aWQgPSBndWlkRm9yKGl0ZW0pOwoKICAgICAgaWYgKCFpbnN0YW5j
        ZU1ldGEuaXRlbUNvdW50c1tndWlkXSkgewogICAgICAgIGluc3RhbmNlTWV0
        YS5pdGVtQ291bnRzW2d1aWRdID0gMTsKICAgICAgfSBlbHNlIHsKICAgICAg
        ICArK2luc3RhbmNlTWV0YS5pdGVtQ291bnRzW2d1aWRdOwogICAgICB9CiAg
        ICAgIGFycmF5LmFkZE9iamVjdChpdGVtKTsKICAgICAgcmV0dXJuIGFycmF5
        OwogICAgfSwKICAgIHJlbW92ZWRJdGVtOiBmdW5jdGlvbihhcnJheSwgaXRl
        bSwgXywgaW5zdGFuY2VNZXRhKSB7CiAgICAgIHZhciBndWlkID0gZ3VpZEZv
        cihpdGVtKSwKICAgICAgICAgIGl0ZW1Db3VudHMgPSBpbnN0YW5jZU1ldGEu
        aXRlbUNvdW50czsKCiAgICAgIGlmICgtLWl0ZW1Db3VudHNbZ3VpZF0gPT09
        IDApIHsKICAgICAgICBhcnJheS5yZW1vdmVPYmplY3QoaXRlbSk7CiAgICAg
        IH0KICAgICAgcmV0dXJuIGFycmF5OwogICAgfQogIH0pOwogIHJldHVybiBF
        bWJlci5hcnJheUNvbXB1dGVkLmFwcGx5KG51bGwsIGFyZ3MpOwp9OwoKLyoq
        CiAgQWxpYXMgZm9yIFtFbWJlci5jb21wdXRlZC51bmlxXSgvYXBpLyNtZXRo
        b2RfY29tcHV0ZWRfdW5pcSkuCgogIEBtZXRob2QgY29tcHV0ZWQudW5pb24K
        ICBAZm9yIEVtYmVyCiAgQHBhcmFtIHtTdHJpbmd9IHByb3BlcnR5S2V5Kgog
        IEByZXR1cm4ge0VtYmVyLkNvbXB1dGVkUHJvcGVydHl9IGNvbXB1dGVzIGEg
        bmV3IGFycmF5IHdpdGggYWxsIHRoZQogIHVuaXF1ZSBlbGVtZW50cyBmcm9t
        IHRoZSBkZXBlbmRlbnQgYXJyYXkKKi8KRW1iZXIuY29tcHV0ZWQudW5pb24g
        PSBFbWJlci5jb21wdXRlZC51bmlxOwoKLyoqCiAgQSBjb21wdXRlZCBwcm9w
        ZXJ0eSB3aGljaCByZXR1cm5zIGEgbmV3IGFycmF5IHdpdGggYWxsIHRoZSBk
        dXBsaWNhdGVkCiAgZWxlbWVudHMgZnJvbSB0d28gb3IgbW9yZSBkZXBlbmRl
        bnkgYXJyYXlzLgoKICBFeGFtcGxlCgogIGBgYGphdmFzY3JpcHQKICB2YXIg
        b2JqID0gRW1iZXIuT2JqZWN0LmNyZWF0ZVdpdGhNaXhpbnMoewogICAgYWRh
        RnJpZW5kczogWydDaGFybGVzIEJhYmJhZ2UnLCAnSm9obiBIb2Job3VzZScs
        ICdXaWxsaWFtIEtpbmcnLCAnTWFyeSBTb21lcnZpbGxlJ10sCiAgICBjaGFy
        bGVzRnJpZW5kczogWydXaWxsaWFtIEtpbmcnLCAnTWFyeSBTb21lcnZpbGxl
        JywgJ0FkYSBMb3ZlbGFjZScsICdHZW9yZ2UgUGVhY29jayddLAogICAgZnJp
        ZW5kc0luQ29tbW9uOiBFbWJlci5jb21wdXRlZC5pbnRlcnNlY3QoJ2FkYUZy
        aWVuZHMnLCAnY2hhcmxlc0ZyaWVuZHMnKQogIH0pOwoKICBvYmouZ2V0KCdm
        cmllbmRzSW5Db21tb24nKTsgLy8gWydXaWxsaWFtIEtpbmcnLCAnTWFyeSBT
        b21lcnZpbGxlJ10KICBgYGAKCiAgQG1ldGhvZCBjb21wdXRlZC5pbnRlcnNl
        Y3QKICBAZm9yIEVtYmVyCiAgQHBhcmFtIHtTdHJpbmd9IHByb3BlcnR5S2V5
        KgogIEByZXR1cm4ge0VtYmVyLkNvbXB1dGVkUHJvcGVydHl9IGNvbXB1dGVz
        IGEgbmV3IGFycmF5IHdpdGggYWxsIHRoZQogIGR1cGxpY2F0ZWQgZWxlbWVu
        dHMgZnJvbSB0aGUgZGVwZW5kZW50IGFycmF5cwoqLwpFbWJlci5jb21wdXRl
        ZC5pbnRlcnNlY3QgPSBmdW5jdGlvbiAoKSB7CiAgdmFyIGdldERlcGVuZGVu
        dEtleUd1aWRzID0gZnVuY3Rpb24gKGNoYW5nZU1ldGEpIHsKICAgIHJldHVy
        biBtYXAoY2hhbmdlTWV0YS5wcm9wZXJ0eS5fZGVwZW5kZW50S2V5cywgZnVu
        Y3Rpb24gKGRlcGVuZGVudEtleSkgewogICAgICByZXR1cm4gZ3VpZEZvcihk
        ZXBlbmRlbnRLZXkpOwogICAgfSk7CiAgfTsKCiAgdmFyIGFyZ3MgPSBhX3Ns
        aWNlLmNhbGwoYXJndW1lbnRzKTsKICBhcmdzLnB1c2goewogICAgaW5pdGlh
        bGl6ZTogZnVuY3Rpb24gKGFycmF5LCBjaGFuZ2VNZXRhLCBpbnN0YW5jZU1l
        dGEpIHsKICAgICAgaW5zdGFuY2VNZXRhLml0ZW1Db3VudHMgPSB7fTsKICAg
        IH0sCgogICAgYWRkZWRJdGVtOiBmdW5jdGlvbihhcnJheSwgaXRlbSwgY2hh
        bmdlTWV0YSwgaW5zdGFuY2VNZXRhKSB7CiAgICAgIHZhciBpdGVtR3VpZCA9
        IGd1aWRGb3IoaXRlbSksCiAgICAgICAgICBkZXBlbmRlbnRHdWlkcyA9IGdl
        dERlcGVuZGVudEtleUd1aWRzKGNoYW5nZU1ldGEpLAogICAgICAgICAgZGVw
        ZW5kZW50R3VpZCA9IGd1aWRGb3IoY2hhbmdlTWV0YS5hcnJheUNoYW5nZWQp
        LAogICAgICAgICAgbnVtYmVyT2ZEZXBlbmRlbnRBcnJheXMgPSBjaGFuZ2VN
        ZXRhLnByb3BlcnR5Ll9kZXBlbmRlbnRLZXlzLmxlbmd0aCwKICAgICAgICAg
        IGl0ZW1Db3VudHMgPSBpbnN0YW5jZU1ldGEuaXRlbUNvdW50czsKCiAgICAg
        IGlmICghaXRlbUNvdW50c1tpdGVtR3VpZF0pIHsgaXRlbUNvdW50c1tpdGVt
        R3VpZF0gPSB7fTsgfQogICAgICBpZiAoaXRlbUNvdW50c1tpdGVtR3VpZF1b
        ZGVwZW5kZW50R3VpZF0gPT09IHVuZGVmaW5lZCkgeyBpdGVtQ291bnRzW2l0
        ZW1HdWlkXVtkZXBlbmRlbnRHdWlkXSA9IDA7IH0KCiAgICAgIGlmICgrK2l0
        ZW1Db3VudHNbaXRlbUd1aWRdW2RlcGVuZGVudEd1aWRdID09PSAxICYmCiAg
        ICAgICAgICBudW1iZXJPZkRlcGVuZGVudEFycmF5cyA9PT0gRW1iZXIua2V5
        cyhpdGVtQ291bnRzW2l0ZW1HdWlkXSkubGVuZ3RoKSB7CgogICAgICAgIGFy
        cmF5LmFkZE9iamVjdChpdGVtKTsKICAgICAgfQogICAgICByZXR1cm4gYXJy
        YXk7CiAgICB9LAogICAgcmVtb3ZlZEl0ZW06IGZ1bmN0aW9uKGFycmF5LCBp
        dGVtLCBjaGFuZ2VNZXRhLCBpbnN0YW5jZU1ldGEpIHsKICAgICAgdmFyIGl0
        ZW1HdWlkID0gZ3VpZEZvcihpdGVtKSwKICAgICAgICAgIGRlcGVuZGVudEd1
        aWRzID0gZ2V0RGVwZW5kZW50S2V5R3VpZHMoY2hhbmdlTWV0YSksCiAgICAg
        ICAgICBkZXBlbmRlbnRHdWlkID0gZ3VpZEZvcihjaGFuZ2VNZXRhLmFycmF5
        Q2hhbmdlZCksCiAgICAgICAgICBudW1iZXJPZkRlcGVuZGVudEFycmF5cyA9
        IGNoYW5nZU1ldGEucHJvcGVydHkuX2RlcGVuZGVudEtleXMubGVuZ3RoLAog
        ICAgICAgICAgbnVtYmVyT2ZBcnJheXNJdGVtQXBwZWFyc0luLAogICAgICAg
        ICAgaXRlbUNvdW50cyA9IGluc3RhbmNlTWV0YS5pdGVtQ291bnRzOwoKICAg
        ICAgaWYgKGl0ZW1Db3VudHNbaXRlbUd1aWRdW2RlcGVuZGVudEd1aWRdID09
        PSB1bmRlZmluZWQpIHsgaXRlbUNvdW50c1tpdGVtR3VpZF1bZGVwZW5kZW50
        R3VpZF0gPSAwOyB9CiAgICAgIGlmICgtLWl0ZW1Db3VudHNbaXRlbUd1aWRd
        W2RlcGVuZGVudEd1aWRdID09PSAwKSB7CiAgICAgICAgZGVsZXRlIGl0ZW1D
        b3VudHNbaXRlbUd1aWRdW2RlcGVuZGVudEd1aWRdOwogICAgICAgIG51bWJl
        ck9mQXJyYXlzSXRlbUFwcGVhcnNJbiA9IEVtYmVyLmtleXMoaXRlbUNvdW50
        c1tpdGVtR3VpZF0pLmxlbmd0aDsKCiAgICAgICAgaWYgKG51bWJlck9mQXJy
        YXlzSXRlbUFwcGVhcnNJbiA9PT0gMCkgewogICAgICAgICAgZGVsZXRlIGl0
        ZW1Db3VudHNbaXRlbUd1aWRdOwogICAgICAgIH0KICAgICAgICBhcnJheS5y
        ZW1vdmVPYmplY3QoaXRlbSk7CiAgICAgIH0KICAgICAgcmV0dXJuIGFycmF5
        OwogICAgfQogIH0pOwogIHJldHVybiBFbWJlci5hcnJheUNvbXB1dGVkLmFw
        cGx5KG51bGwsIGFyZ3MpOwp9OwoKLyoqCiAgQSBjb21wdXRlZCBwcm9wZXJ0
        eSB3aGljaCByZXR1cm5zIGEgbmV3IGFycmF5IHdpdGggYWxsIHRoZQogIHBy
        b3BlcnRpZXMgZnJvbSB0aGUgZmlyc3QgZGVwZW5kZW50IGFycmF5IHRoYXQg
        YXJlIG5vdCBpbiB0aGUgc2Vjb25kCiAgZGVwZW5kZW50IGFycmF5LgoKICBF
        eGFtcGxlCgogIGBgYGphdmFzY3JpcHQKICBBcHAuSGFtcHN0ZXIgPSBFbWJl
        ci5PYmplY3QuZXh0ZW5kKHsKICAgIGxpa2VzOiBbJ2JhbmFuYScsICdncmFw
        ZScsICdrYWxlJ10sCiAgICB3YW50czogRW1iZXIuY29tcHV0ZWQuc2V0RGlm
        ZignbGlrZXMnLCAnZnJ1aXRzJykKICB9KTsKCiAgdmFyIGhhbXBzdGVyID0g
        QXBwLkhhbXBzdGVyLmNyZWF0ZSh7ZnJ1aXRzOiBbCiAgICAnZ3JhcGUnLAog
        ICAgJ2thbGUnLAogIF19KTsKICBoYW1wc3Rlci5nZXQoJ3dhbnRzJyk7IC8v
        IFsnYmFuYW5hJ10KICBgYGAKCiAgQG1ldGhvZCBjb21wdXRlZC5zZXREaWZm
        CiAgQGZvciBFbWJlcgogIEBwYXJhbSB7U3RyaW5nfSBzZXRBUHJvcGVydHkK
        ICBAcGFyYW0ge1N0cmluZ30gc2V0QlByb3BlcnR5CiAgQHJldHVybiB7RW1i
        ZXIuQ29tcHV0ZWRQcm9wZXJ0eX0gY29tcHV0ZXMgYSBuZXcgYXJyYXkgd2l0
        aCBhbGwgdGhlCiAgaXRlbXMgZnJvbSB0aGUgZmlyc3QgZGVwZW5kZW50IGFy
        cmF5IHRoYXQgYXJlIG5vdCBpbiB0aGUgc2Vjb25kCiAgZGVwZW5kZW50IGFy
        cmF5CiovCkVtYmVyLmNvbXB1dGVkLnNldERpZmYgPSBmdW5jdGlvbiAoc2V0
        QVByb3BlcnR5LCBzZXRCUHJvcGVydHkpIHsKICBpZiAoYXJndW1lbnRzLmxl
        bmd0aCAhPT0gMikgewogICAgdGhyb3cgbmV3IEVtYmVyLkVycm9yKCJzZXRE
        aWZmIHJlcXVpcmVzIGV4YWN0bHkgdHdvIGRlcGVuZGVudCBhcnJheXMuIik7
        CiAgfQogIHJldHVybiBFbWJlci5hcnJheUNvbXB1dGVkLmNhbGwobnVsbCwg
        c2V0QVByb3BlcnR5LCBzZXRCUHJvcGVydHksIHsKICAgIGFkZGVkSXRlbTog
        ZnVuY3Rpb24gKGFycmF5LCBpdGVtLCBjaGFuZ2VNZXRhLCBpbnN0YW5jZU1l
        dGEpIHsKICAgICAgdmFyIHNldEEgPSBnZXQodGhpcywgc2V0QVByb3BlcnR5
        KSwKICAgICAgICAgIHNldEIgPSBnZXQodGhpcywgc2V0QlByb3BlcnR5KTsK
        CiAgICAgIGlmIChjaGFuZ2VNZXRhLmFycmF5Q2hhbmdlZCA9PT0gc2V0QSkg
        ewogICAgICAgIGlmICghc2V0Qi5jb250YWlucyhpdGVtKSkgewogICAgICAg
        ICAgYXJyYXkuYWRkT2JqZWN0KGl0ZW0pOwogICAgICAgIH0KICAgICAgfSBl
        bHNlIHsKICAgICAgICBhcnJheS5yZW1vdmVPYmplY3QoaXRlbSk7CiAgICAg
        IH0KICAgICAgcmV0dXJuIGFycmF5OwogICAgfSwKCiAgICByZW1vdmVkSXRl
        bTogZnVuY3Rpb24gKGFycmF5LCBpdGVtLCBjaGFuZ2VNZXRhLCBpbnN0YW5j
        ZU1ldGEpIHsKICAgICAgdmFyIHNldEEgPSBnZXQodGhpcywgc2V0QVByb3Bl
        cnR5KSwKICAgICAgICAgIHNldEIgPSBnZXQodGhpcywgc2V0QlByb3BlcnR5
        KTsKCiAgICAgIGlmIChjaGFuZ2VNZXRhLmFycmF5Q2hhbmdlZCA9PT0gc2V0
        QikgewogICAgICAgIGlmIChzZXRBLmNvbnRhaW5zKGl0ZW0pKSB7CiAgICAg
        ICAgICBhcnJheS5hZGRPYmplY3QoaXRlbSk7CiAgICAgICAgfQogICAgICB9
        IGVsc2UgewogICAgICAgIGFycmF5LnJlbW92ZU9iamVjdChpdGVtKTsKICAg
        ICAgfQogICAgICByZXR1cm4gYXJyYXk7CiAgICB9CiAgfSk7Cn07CgpmdW5j
        dGlvbiBiaW5hcnlTZWFyY2goYXJyYXksIGl0ZW0sIGxvdywgaGlnaCkgewog
        IHZhciBtaWQsIG1pZEl0ZW0sIHJlcywgZ3VpZE1pZCwgZ3VpZEl0ZW07Cgog
        IGlmIChhcmd1bWVudHMubGVuZ3RoIDwgNCkgeyBoaWdoID0gZ2V0KGFycmF5
        LCAnbGVuZ3RoJyk7IH0KICBpZiAoYXJndW1lbnRzLmxlbmd0aCA8IDMpIHsg
        bG93ID0gMDsgfQoKICBpZiAobG93ID09PSBoaWdoKSB7CiAgICByZXR1cm4g
        bG93OwogIH0KCiAgbWlkID0gbG93ICsgTWF0aC5mbG9vcigoaGlnaCAtIGxv
        dykgLyAyKTsKICBtaWRJdGVtID0gYXJyYXkub2JqZWN0QXQobWlkKTsKCiAg
        Z3VpZE1pZCA9IF9ndWlkRm9yKG1pZEl0ZW0pOwogIGd1aWRJdGVtID0gX2d1
        aWRGb3IoaXRlbSk7CgogIGlmIChndWlkTWlkID09PSBndWlkSXRlbSkgewog
        ICAgcmV0dXJuIG1pZDsKICB9CgogIHJlcyA9IHRoaXMub3JkZXIobWlkSXRl
        bSwgaXRlbSk7CiAgaWYgKHJlcyA9PT0gMCkgewogICAgcmVzID0gZ3VpZE1p
        ZCA8IGd1aWRJdGVtID8gLTEgOiAxOwogIH0KCgogIGlmIChyZXMgPCAwKSB7
        CiAgICByZXR1cm4gdGhpcy5iaW5hcnlTZWFyY2goYXJyYXksIGl0ZW0sIG1p
        ZCsxLCBoaWdoKTsKICB9IGVsc2UgaWYgKHJlcyA+IDApIHsKICAgIHJldHVy
        biB0aGlzLmJpbmFyeVNlYXJjaChhcnJheSwgaXRlbSwgbG93LCBtaWQpOwog
        IH0KCiAgcmV0dXJuIG1pZDsKCiAgZnVuY3Rpb24gX2d1aWRGb3IoaXRlbSkg
        ewogICAgaWYgKEVtYmVyLk9iamVjdFByb3h5LmRldGVjdEluc3RhbmNlKGl0
        ZW0pKSB7CiAgICAgIHJldHVybiBndWlkRm9yKGdldChpdGVtLCAnY29udGVu
        dCcpKTsKICAgIH0KICAgIHJldHVybiBndWlkRm9yKGl0ZW0pOwogIH0KfQoK
        LyoqCiAgQSBjb21wdXRlZCBwcm9wZXJ0eSB3aGljaCByZXR1cm5zIGEgbmV3
        IGFycmF5IHdpdGggYWxsIHRoZQogIHByb3BlcnRpZXMgZnJvbSB0aGUgZmly
        c3QgZGVwZW5kZW50IGFycmF5IHNvcnRlZCBiYXNlZCBvbiBhIHByb3BlcnR5
        CiAgb3Igc29ydCBmdW5jdGlvbi4KCiAgVGhlIGNhbGxiYWNrIG1ldGhvZCB5
        b3UgcHJvdmlkZSBzaG91bGQgaGF2ZSB0aGUgZm9sbG93aW5nIHNpZ25hdHVy
        ZToKCiAgYGBgamF2YXNjcmlwdAogIGZ1bmN0aW9uKGl0ZW1BLCBpdGVtQik7
        CiAgYGBgCgogIC0gYGl0ZW1BYCB0aGUgZmlyc3QgaXRlbSB0byBjb21wYXJl
        LgogIC0gYGl0ZW1CYCB0aGUgc2Vjb25kIGl0ZW0gdG8gY29tcGFyZS4KCiAg
        VGhpcyBmdW5jdGlvbiBzaG91bGQgcmV0dXJuIGAtMWAgd2hlbiBgaXRlbUFg
        IHNob3VsZCBjb21lIGJlZm9yZQogIGBpdGVtQmAuIEl0IHNob3VsZCByZXR1
        cm4gYDFgIHdoZW4gYGl0ZW1BYCBzaG91bGQgY29tZSBhZnRlcgogIGBpdGVt
        QmAuIElmIHRoZSBgaXRlbUFgIGFuZCBgaXRlbUJgIGFyZSBlcXVhbCB0aGlz
        IGZ1bmN0aW9uIHNob3VsZCByZXR1cm4gYDBgLgoKICBFeGFtcGxlCgogIGBg
        YGphdmFzY3JpcHQKICB2YXIgVG9Eb0xpc3QgPSBFbWJlci5PYmplY3QuZXh0
        ZW5kKHsKICAgIHRvZG9zU29ydGluZzogWyduYW1lJ10sCiAgICBzb3J0ZWRU
        b2RvczogRW1iZXIuY29tcHV0ZWQuc29ydCgndG9kb3MnLCAndG9kb3NTb3J0
        aW5nJyksCiAgICBwcmlvcml0eVRvZG9zOiBFbWJlci5jb21wdXRlZC5zb3J0
        KCd0b2RvcycsIGZ1bmN0aW9uKGEsIGIpewogICAgICBpZiAoYS5wcmlvcml0
        eSA+IGIucHJpb3JpdHkpIHsKICAgICAgICByZXR1cm4gMTsKICAgICAgfSBl
        bHNlIGlmIChhLnByaW9yaXR5IDwgYi5wcmlvcml0eSkgewogICAgICAgIHJl
        dHVybiAtMTsKICAgICAgfQogICAgICByZXR1cm4gMDsKICAgIH0pLAogIH0p
        OwogIHZhciB0b2RvTGlzdCA9IFRvRG9MaXN0LmNyZWF0ZSh7dG9kb3M6IFsK
        ICAgIHtuYW1lOiAnVW5pdCBUZXN0JywgcHJpb3JpdHk6IDJ9LAogICAge25h
        bWU6ICdEb2N1bWVudGF0aW9uJywgcHJpb3JpdHk6IDN9LAogICAge25hbWU6
        ICdSZWxlYXNlJywgcHJpb3JpdHk6IDF9CiAgXX0pOwoKICB0b2RvTGlzdC5n
        ZXQoJ3NvcnRlZFRvZG9zJyk7IC8vIFt7bmFtZTonRG9jdW1lbnRhdGlvbics
        IHByaW9yaXR5OjN9LCB7bmFtZTonUmVsZWFzZScsIHByaW9yaXR5OjF9LCB7
        bmFtZTonVW5pdCBUZXN0JywgcHJpb3JpdHk6Mn1dCiAgdG9kb0xpc3QuZ2V0
        KCdwcmlvcml0eVRvZG9zJyk7IC8vIFt7bmFtZTonUmVsZWFzZScsIHByaW9y
        aXR5OjF9LCB7bmFtZTonVW5pdCBUZXN0JywgcHJpb3JpdHk6Mn0sIHtuYW1l
        OidEb2N1bWVudGF0aW9uJywgcHJpb3JpdHk6M31dCiAgYGBgCgogIEBtZXRo
        b2QgY29tcHV0ZWQuc29ydAogIEBmb3IgRW1iZXIKICBAcGFyYW0ge1N0cmlu
        Z30gZGVwZW5kZW50S2V5CiAgQHBhcmFtIHtTdHJpbmcgb3IgRnVuY3Rpb259
        IHNvcnREZWZpbml0aW9uIGEgZGVwZW5kZW50IGtleSB0byBhbgogIGFycmF5
        IG9mIHNvcnQgcHJvcGVydGllcyBvciBhIGZ1bmN0aW9uIHRvIHVzZSB3aGVu
        IHNvcnRpbmcKICBAcmV0dXJuIHtFbWJlci5Db21wdXRlZFByb3BlcnR5fSBj
        b21wdXRlcyBhIG5ldyBzb3J0ZWQgYXJyYXkgYmFzZWQKICBvbiB0aGUgc29y
        dCBwcm9wZXJ0eSBhcnJheSBvciBjYWxsYmFjayBmdW5jdGlvbgoqLwpFbWJl
        ci5jb21wdXRlZC5zb3J0ID0gZnVuY3Rpb24gKGl0ZW1zS2V5LCBzb3J0RGVm
        aW5pdGlvbikgewogIEVtYmVyLmFzc2VydCgiRW1iZXIuY29tcHV0ZWQuc29y
        dCByZXF1aXJlcyB0d28gYXJndW1lbnRzOiBhbiBhcnJheSBrZXkgdG8gc29y
        dCBhbmQgZWl0aGVyIGEgc29ydCBwcm9wZXJ0aWVzIGtleSBvciBzb3J0IGZ1
        bmN0aW9uIiwgYXJndW1lbnRzLmxlbmd0aCA9PT0gMik7CgogIHZhciBpbml0
        Rm4sIHNvcnRQcm9wZXJ0aWVzS2V5OwoKICBpZiAodHlwZW9mIHNvcnREZWZp
        bml0aW9uID09PSAnZnVuY3Rpb24nKSB7CiAgICBpbml0Rm4gPSBmdW5jdGlv
        biAoYXJyYXksIGNoYW5nZU1ldGEsIGluc3RhbmNlTWV0YSkgewogICAgICBp
        bnN0YW5jZU1ldGEub3JkZXIgPSBzb3J0RGVmaW5pdGlvbjsKICAgICAgaW5z
        dGFuY2VNZXRhLmJpbmFyeVNlYXJjaCA9IGJpbmFyeVNlYXJjaDsKICAgIH07
        CiAgfSBlbHNlIHsKICAgIHNvcnRQcm9wZXJ0aWVzS2V5ID0gc29ydERlZmlu
        aXRpb247CiAgICBpbml0Rm4gPSBmdW5jdGlvbiAoYXJyYXksIGNoYW5nZU1l
        dGEsIGluc3RhbmNlTWV0YSkgewogICAgICBmdW5jdGlvbiBzZXR1cFNvcnRQ
        cm9wZXJ0aWVzKCkgewogICAgICAgIHZhciBzb3J0UHJvcGVydHlEZWZpbml0
        aW9ucyA9IGdldCh0aGlzLCBzb3J0UHJvcGVydGllc0tleSksCiAgICAgICAg
        ICAgIHNvcnRQcm9wZXJ0eSwKICAgICAgICAgICAgc29ydFByb3BlcnRpZXMg
        PSBpbnN0YW5jZU1ldGEuc29ydFByb3BlcnRpZXMgPSBbXSwKICAgICAgICAg
        ICAgc29ydFByb3BlcnR5QXNjZW5kaW5nID0gaW5zdGFuY2VNZXRhLnNvcnRQ
        cm9wZXJ0eUFzY2VuZGluZyA9IHt9LAogICAgICAgICAgICBpZHgsCiAgICAg
        ICAgICAgIGFzYzsKCiAgICAgICAgRW1iZXIuYXNzZXJ0KCJDYW5ub3Qgc29y
        dDogJyIgKyBzb3J0UHJvcGVydGllc0tleSArICInIGlzIG5vdCBhbiBhcnJh
        eS4iLCBFbWJlci5pc0FycmF5KHNvcnRQcm9wZXJ0eURlZmluaXRpb25zKSk7
        CgogICAgICAgIGNoYW5nZU1ldGEucHJvcGVydHkuY2xlYXJJdGVtUHJvcGVy
        dHlLZXlzKGl0ZW1zS2V5KTsKCiAgICAgICAgZm9yRWFjaChzb3J0UHJvcGVy
        dHlEZWZpbml0aW9ucywgZnVuY3Rpb24gKHNvcnRQcm9wZXJ0eURlZmluaXRp
        b24pIHsKICAgICAgICAgIGlmICgoaWR4ID0gc29ydFByb3BlcnR5RGVmaW5p
        dGlvbi5pbmRleE9mKCc6JykpICE9PSAtMSkgewogICAgICAgICAgICBzb3J0
        UHJvcGVydHkgPSBzb3J0UHJvcGVydHlEZWZpbml0aW9uLnN1YnN0cmluZygw
        LCBpZHgpOwogICAgICAgICAgICBhc2MgPSBzb3J0UHJvcGVydHlEZWZpbml0
        aW9uLnN1YnN0cmluZyhpZHgrMSkudG9Mb3dlckNhc2UoKSAhPT0gJ2Rlc2Mn
        OwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgc29ydFByb3BlcnR5
        ID0gc29ydFByb3BlcnR5RGVmaW5pdGlvbjsKICAgICAgICAgICAgYXNjID0g
        dHJ1ZTsKICAgICAgICAgIH0KCiAgICAgICAgICBzb3J0UHJvcGVydGllcy5w
        dXNoKHNvcnRQcm9wZXJ0eSk7CiAgICAgICAgICBzb3J0UHJvcGVydHlBc2Nl
        bmRpbmdbc29ydFByb3BlcnR5XSA9IGFzYzsKICAgICAgICAgIGNoYW5nZU1l
        dGEucHJvcGVydHkuaXRlbVByb3BlcnR5S2V5KGl0ZW1zS2V5LCBzb3J0UHJv
        cGVydHkpOwogICAgICAgIH0pOwoKICAgICAgICBzb3J0UHJvcGVydHlEZWZp
        bml0aW9ucy5hZGRPYnNlcnZlcignQGVhY2gnLCB0aGlzLCB1cGRhdGVTb3J0
        UHJvcGVydGllc09uY2UpOwogICAgICB9CgogICAgICBmdW5jdGlvbiB1cGRh
        dGVTb3J0UHJvcGVydGllc09uY2UoKSB7CiAgICAgICAgRW1iZXIucnVuLm9u
        Y2UodGhpcywgdXBkYXRlU29ydFByb3BlcnRpZXMsIGNoYW5nZU1ldGEucHJv
        cGVydHlOYW1lKTsKICAgICAgfQoKICAgICAgZnVuY3Rpb24gdXBkYXRlU29y
        dFByb3BlcnRpZXMocHJvcGVydHlOYW1lKSB7CiAgICAgICAgc2V0dXBTb3J0
        UHJvcGVydGllcy5jYWxsKHRoaXMpOwogICAgICAgIGNoYW5nZU1ldGEucHJv
        cGVydHkucmVjb21wdXRlT25jZS5jYWxsKHRoaXMsIHByb3BlcnR5TmFtZSk7
        CiAgICAgIH0KCiAgICAgIEVtYmVyLmFkZE9ic2VydmVyKHRoaXMsIHNvcnRQ
        cm9wZXJ0aWVzS2V5LCB1cGRhdGVTb3J0UHJvcGVydGllc09uY2UpOwoKICAg
        ICAgc2V0dXBTb3J0UHJvcGVydGllcy5jYWxsKHRoaXMpOwoKCiAgICAgIGlu
        c3RhbmNlTWV0YS5vcmRlciA9IGZ1bmN0aW9uIChpdGVtQSwgaXRlbUIpIHsK
        ICAgICAgICB2YXIgc29ydFByb3BlcnR5LCByZXN1bHQsIGFzYzsKICAgICAg
        ICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuc29ydFByb3BlcnRpZXMubGVu
        Z3RoOyArK2kpIHsKICAgICAgICAgIHNvcnRQcm9wZXJ0eSA9IHRoaXMuc29y
        dFByb3BlcnRpZXNbaV07CiAgICAgICAgICByZXN1bHQgPSBFbWJlci5jb21w
        YXJlKGdldChpdGVtQSwgc29ydFByb3BlcnR5KSwgZ2V0KGl0ZW1CLCBzb3J0
        UHJvcGVydHkpKTsKCiAgICAgICAgICBpZiAocmVzdWx0ICE9PSAwKSB7CiAg
        ICAgICAgICAgIGFzYyA9IHRoaXMuc29ydFByb3BlcnR5QXNjZW5kaW5nW3Nv
        cnRQcm9wZXJ0eV07CiAgICAgICAgICAgIHJldHVybiBhc2MgPyByZXN1bHQg
        OiAoLTEgKiByZXN1bHQpOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAg
        ICAgcmV0dXJuIDA7CiAgICAgIH07CgogICAgICBpbnN0YW5jZU1ldGEuYmlu
        YXJ5U2VhcmNoID0gYmluYXJ5U2VhcmNoOwogICAgfTsKICB9CgogIHJldHVy
        biBFbWJlci5hcnJheUNvbXB1dGVkLmNhbGwobnVsbCwgaXRlbXNLZXksIHsK
        ICAgIGluaXRpYWxpemU6IGluaXRGbiwKCiAgICBhZGRlZEl0ZW06IGZ1bmN0
        aW9uIChhcnJheSwgaXRlbSwgY2hhbmdlTWV0YSwgaW5zdGFuY2VNZXRhKSB7
        CiAgICAgIHZhciBpbmRleCA9IGluc3RhbmNlTWV0YS5iaW5hcnlTZWFyY2go
        YXJyYXksIGl0ZW0pOwogICAgICBhcnJheS5pbnNlcnRBdChpbmRleCwgaXRl
        bSk7CiAgICAgIHJldHVybiBhcnJheTsKICAgIH0sCgogICAgcmVtb3ZlZEl0
        ZW06IGZ1bmN0aW9uIChhcnJheSwgaXRlbSwgY2hhbmdlTWV0YSwgaW5zdGFu
        Y2VNZXRhKSB7CiAgICAgIHZhciBwcm94eVByb3BlcnRpZXMsIGluZGV4LCBz
        ZWFyY2hJdGVtOwoKICAgICAgaWYgKGNoYW5nZU1ldGEucHJldmlvdXNWYWx1
        ZXMpIHsKICAgICAgICBwcm94eVByb3BlcnRpZXMgPSBtZXJnZSh7IGNvbnRl
        bnQ6IGl0ZW0gfSwgY2hhbmdlTWV0YS5wcmV2aW91c1ZhbHVlcyk7CgogICAg
        ICAgIHNlYXJjaEl0ZW0gPSBFbWJlci5PYmplY3RQcm94eS5jcmVhdGUocHJv
        eHlQcm9wZXJ0aWVzKTsKICAgICB9IGVsc2UgewogICAgICAgc2VhcmNoSXRl
        bSA9IGl0ZW07CiAgICAgfQoKICAgICAgaW5kZXggPSBpbnN0YW5jZU1ldGEu
        YmluYXJ5U2VhcmNoKGFycmF5LCBzZWFyY2hJdGVtKTsKICAgICAgYXJyYXku
        cmVtb3ZlQXQoaW5kZXgpOwogICAgICByZXR1cm4gYXJyYXk7CiAgICB9CiAg
        fSk7Cn07Cgp9KSgpOwoKCgooZnVuY3Rpb24oKSB7Ci8qKgogIEV4cG9zZSBS
        U1ZQIGltcGxlbWVudGF0aW9uCiAgCiAgRG9jdW1lbnRhdGlvbiBjYW4gYmUg
        Zm91bmQgaGVyZTogaHR0cHM6Ly9naXRodWIuY29tL3RpbGRlaW8vcnN2cC5q
        cy9ibG9iL21hc3Rlci9SRUFETUUubWQKCiAgQGNsYXNzIFJTVlAKICBAbmFt
        ZXNwYWNlIEVtYmVyCiAgQGNvbnN0cnVjdG9yCiovCkVtYmVyLlJTVlAgPSBy
        ZXF1aXJlTW9kdWxlKCdyc3ZwJyk7Cgp9KSgpOwoKCgooZnVuY3Rpb24oKSB7
        Ci8qKgpAbW9kdWxlIGVtYmVyCkBzdWJtb2R1bGUgZW1iZXItcnVudGltZQoq
        LwoKdmFyIFNUUklOR19EQVNIRVJJWkVfUkVHRVhQID0gKC9bIF9dL2cpOwp2
        YXIgU1RSSU5HX0RBU0hFUklaRV9DQUNIRSA9IHt9Owp2YXIgU1RSSU5HX0RF
        Q0FNRUxJWkVfUkVHRVhQID0gKC8oW2EtelxkXSkoW0EtWl0pL2cpOwp2YXIg
        U1RSSU5HX0NBTUVMSVpFX1JFR0VYUCA9ICgvKFwtfF98XC58XHMpKyguKT8v
        Zyk7CnZhciBTVFJJTkdfVU5ERVJTQ09SRV9SRUdFWFBfMSA9ICgvKFthLXpc
        ZF0pKFtBLVpdKykvZyk7CnZhciBTVFJJTkdfVU5ERVJTQ09SRV9SRUdFWFBf
        MiA9ICgvXC18XHMrL2cpOwoKLyoqCiAgRGVmaW5lcyB0aGUgaGFzaCBvZiBs
        b2NhbGl6ZWQgc3RyaW5ncyBmb3IgdGhlIGN1cnJlbnQgbGFuZ3VhZ2UuIFVz
        ZWQgYnkKICB0aGUgYEVtYmVyLlN0cmluZy5sb2MoKWAgaGVscGVyLiBUbyBs
        b2NhbGl6ZSwgYWRkIHN0cmluZyB2YWx1ZXMgdG8gdGhpcwogIGhhc2guCgog
        IEBwcm9wZXJ0eSBTVFJJTkdTCiAgQGZvciBFbWJlcgogIEB0eXBlIEhhc2gK
        Ki8KRW1iZXIuU1RSSU5HUyA9IHt9OwoKLyoqCiAgRGVmaW5lcyBzdHJpbmcg
        aGVscGVyIG1ldGhvZHMgaW5jbHVkaW5nIHN0cmluZyBmb3JtYXR0aW5nIGFu
        ZCBsb2NhbGl6YXRpb24uCiAgVW5sZXNzIGBFbWJlci5FWFRFTkRfUFJPVE9U
        WVBFUy5TdHJpbmdgIGlzIGBmYWxzZWAgdGhlc2UgbWV0aG9kcyB3aWxsIGFs
        c28gYmUKICBhZGRlZCB0byB0aGUgYFN0cmluZy5wcm90b3R5cGVgIGFzIHdl
        bGwuCgogIEBjbGFzcyBTdHJpbmcKICBAbmFtZXNwYWNlIEVtYmVyCiAgQHN0
        YXRpYwoqLwpFbWJlci5TdHJpbmcgPSB7CgogIC8qKgogICAgQXBwbHkgZm9y
        bWF0dGluZyBvcHRpb25zIHRvIHRoZSBzdHJpbmcuIFRoaXMgd2lsbCBsb29r
        IGZvciBvY2N1cnJlbmNlcwogICAgb2YgIiVAIiBpbiB5b3VyIHN0cmluZyBh
        bmQgc3Vic3RpdHV0ZSB0aGVtIHdpdGggdGhlIGFyZ3VtZW50cyB5b3UgcGFz
        cyBpbnRvCiAgICB0aGlzIG1ldGhvZC4gSWYgeW91IHdhbnQgdG8gY29udHJv
        bCB0aGUgc3BlY2lmaWMgb3JkZXIgb2YgcmVwbGFjZW1lbnQsCiAgICB5b3Ug
        Y2FuIGFkZCBhIG51bWJlciBhZnRlciB0aGUga2V5IGFzIHdlbGwgdG8gaW5k
        aWNhdGUgd2hpY2ggYXJndW1lbnQKICAgIHlvdSB3YW50IHRvIGluc2VydC4K
        CiAgICBPcmRlcmVkIGluc2VydGlvbnMgYXJlIG1vc3QgdXNlZnVsIHdoZW4g
        YnVpbGRpbmcgbG9jIHN0cmluZ3Mgd2hlcmUgdmFsdWVzCiAgICB5b3UgbmVl
        ZCB0byBpbnNlcnQgbWF5IGFwcGVhciBpbiBkaWZmZXJlbnQgb3JkZXJzLgoK
        ICAgIGBgYGphdmFzY3JpcHQKICAgICJIZWxsbyAlQCAlQCIuZm10KCdKb2hu
        JywgJ0RvZScpOyAgICAgLy8gIkhlbGxvIEpvaG4gRG9lIgogICAgIkhlbGxv
        ICVAMiwgJUAxIi5mbXQoJ0pvaG4nLCAnRG9lJyk7ICAvLyAiSGVsbG8gRG9l
        LCBKb2huIgogICAgYGBgCgogICAgQG1ldGhvZCBmbXQKICAgIEBwYXJhbSB7
        U3RyaW5nfSBzdHIgVGhlIHN0cmluZyB0byBmb3JtYXQKICAgIEBwYXJhbSB7
        QXJyYXl9IGZvcm1hdHMgQW4gYXJyYXkgb2YgcGFyYW1ldGVycyB0byBpbnRl
        cnBvbGF0ZSBpbnRvIHN0cmluZy4KICAgIEByZXR1cm4ge1N0cmluZ30gZm9y
        bWF0dGVkIHN0cmluZwogICovCiAgZm10OiBmdW5jdGlvbihzdHIsIGZvcm1h
        dHMpIHsKICAgIC8vIGZpcnN0LCByZXBsYWNlIGFueSBPUkRFUkVEIHJlcGxh
        Y2VtZW50cy4KICAgIHZhciBpZHggID0gMDsgLy8gdGhlIGN1cnJlbnQgaW5k
        ZXggZm9yIG5vbi1udW1lcmljYWwgcmVwbGFjZW1lbnRzCiAgICByZXR1cm4g
        c3RyLnJlcGxhY2UoLyVAKFswLTldKyk/L2csIGZ1bmN0aW9uKHMsIGFyZ0lu
        ZGV4KSB7CiAgICAgIGFyZ0luZGV4ID0gKGFyZ0luZGV4KSA/IHBhcnNlSW50
        KGFyZ0luZGV4LCAxMCkgLSAxIDogaWR4Kys7CiAgICAgIHMgPSBmb3JtYXRz
        W2FyZ0luZGV4XTsKICAgICAgcmV0dXJuIChzID09PSBudWxsKSA/ICcobnVs
        bCknIDogKHMgPT09IHVuZGVmaW5lZCkgPyAnJyA6IEVtYmVyLmluc3BlY3Qo
        cyk7CiAgICB9KSA7CiAgfSwKCiAgLyoqCiAgICBGb3JtYXRzIHRoZSBwYXNz
        ZWQgc3RyaW5nLCBidXQgZmlyc3QgbG9va3MgdXAgdGhlIHN0cmluZyBpbiB0
        aGUgbG9jYWxpemVkCiAgICBzdHJpbmdzIGhhc2guIFRoaXMgaXMgYSBjb252
        ZW5pZW50IHdheSB0byBsb2NhbGl6ZSB0ZXh0LiBTZWUKICAgIGBFbWJlci5T
        dHJpbmcuZm10KClgIGZvciBtb3JlIGluZm9ybWF0aW9uIG9uIGZvcm1hdHRp
        bmcuCgogICAgTm90ZSB0aGF0IGl0IGlzIHRyYWRpdGlvbmFsIGJ1dCBub3Qg
        cmVxdWlyZWQgdG8gcHJlZml4IGxvY2FsaXplZCBzdHJpbmcKICAgIGtleXMg
        d2l0aCBhbiB1bmRlcnNjb3JlIG9yIG90aGVyIGNoYXJhY3RlciBzbyB5b3Ug
        Y2FuIGVhc2lseSBpZGVudGlmeQogICAgbG9jYWxpemVkIHN0cmluZ3MuCgog
        ICAgYGBgamF2YXNjcmlwdAogICAgRW1iZXIuU1RSSU5HUyA9IHsKICAgICAg
        J19IZWxsbyBXb3JsZCc6ICdCb25qb3VyIGxlIG1vbmRlJywKICAgICAgJ19I
        ZWxsbyAlQCAlQCc6ICdCb25qb3VyICVAICVAJwogICAgfTsKCiAgICBFbWJl
        ci5TdHJpbmcubG9jKCJfSGVsbG8gV29ybGQiKTsgIC8vICdCb25qb3VyIGxl
        IG1vbmRlJzsKICAgIEVtYmVyLlN0cmluZy5sb2MoIl9IZWxsbyAlQCAlQCIs
        IFsiSm9obiIsICJTbWl0aCJdKTsgIC8vICJCb25qb3VyIEpvaG4gU21pdGgi
        OwogICAgYGBgCgogICAgQG1ldGhvZCBsb2MKICAgIEBwYXJhbSB7U3RyaW5n
        fSBzdHIgVGhlIHN0cmluZyB0byBmb3JtYXQKICAgIEBwYXJhbSB7QXJyYXl9
        IGZvcm1hdHMgT3B0aW9uYWwgYXJyYXkgb2YgcGFyYW1ldGVycyB0byBpbnRl
        cnBvbGF0ZSBpbnRvIHN0cmluZy4KICAgIEByZXR1cm4ge1N0cmluZ30gZm9y
        bWF0dGVkIHN0cmluZwogICovCiAgbG9jOiBmdW5jdGlvbihzdHIsIGZvcm1h
        dHMpIHsKICAgIHN0ciA9IEVtYmVyLlNUUklOR1Nbc3RyXSB8fCBzdHI7CiAg
        ICByZXR1cm4gRW1iZXIuU3RyaW5nLmZtdChzdHIsIGZvcm1hdHMpIDsKICB9
        LAoKICAvKioKICAgIFNwbGl0cyBhIHN0cmluZyBpbnRvIHNlcGFyYXRlIHVu
        aXRzIHNlcGFyYXRlZCBieSBzcGFjZXMsIGVsaW1pbmF0aW5nIGFueQogICAg
        ZW1wdHkgc3RyaW5ncyBpbiB0aGUgcHJvY2Vzcy4gVGhpcyBpcyBhIGNvbnZl
        bmllbmNlIG1ldGhvZCBmb3Igc3BsaXQgdGhhdAogICAgaXMgbW9zdGx5IHVz
        ZWZ1bCB3aGVuIGFwcGxpZWQgdG8gdGhlIGBTdHJpbmcucHJvdG90eXBlYC4K
        CiAgICBgYGBqYXZhc2NyaXB0CiAgICBFbWJlci5TdHJpbmcudygiYWxwaGEg
        YmV0YSBnYW1tYSIpLmZvckVhY2goZnVuY3Rpb24oa2V5KSB7CiAgICAgIGNv
        bnNvbGUubG9nKGtleSk7CiAgICB9KTsKCiAgICAvLyA+IGFscGhhCiAgICAv
        LyA+IGJldGEKICAgIC8vID4gZ2FtbWEKICAgIGBgYAoKICAgIEBtZXRob2Qg
        dwogICAgQHBhcmFtIHtTdHJpbmd9IHN0ciBUaGUgc3RyaW5nIHRvIHNwbGl0
        CiAgICBAcmV0dXJuIHtTdHJpbmd9IHNwbGl0IHN0cmluZwogICovCiAgdzog
        ZnVuY3Rpb24oc3RyKSB7IHJldHVybiBzdHIuc3BsaXQoL1xzKy8pOyB9LAoK
        ICAvKioKICAgIENvbnZlcnRzIGEgY2FtZWxpemVkIHN0cmluZyBpbnRvIGFs
        bCBsb3dlciBjYXNlIHNlcGFyYXRlZCBieSB1bmRlcnNjb3Jlcy4KCiAgICBg
        YGBqYXZhc2NyaXB0CiAgICAnaW5uZXJIVE1MJy5kZWNhbWVsaXplKCk7ICAg
        ICAgICAgICAvLyAnaW5uZXJfaHRtbCcKICAgICdhY3Rpb25fbmFtZScuZGVj
        YW1lbGl6ZSgpOyAgICAgICAgLy8gJ2FjdGlvbl9uYW1lJwogICAgJ2Nzcy1j
        bGFzcy1uYW1lJy5kZWNhbWVsaXplKCk7ICAgICAvLyAnY3NzLWNsYXNzLW5h
        bWUnCiAgICAnbXkgZmF2b3JpdGUgaXRlbXMnLmRlY2FtZWxpemUoKTsgIC8v
        ICdteSBmYXZvcml0ZSBpdGVtcycKICAgIGBgYAoKICAgIEBtZXRob2QgZGVj
        YW1lbGl6ZQogICAgQHBhcmFtIHtTdHJpbmd9IHN0ciBUaGUgc3RyaW5nIHRv
        IGRlY2FtZWxpemUuCiAgICBAcmV0dXJuIHtTdHJpbmd9IHRoZSBkZWNhbWVs
        aXplZCBzdHJpbmcuCiAgKi8KICBkZWNhbWVsaXplOiBmdW5jdGlvbihzdHIp
        IHsKICAgIHJldHVybiBzdHIucmVwbGFjZShTVFJJTkdfREVDQU1FTElaRV9S
        RUdFWFAsICckMV8kMicpLnRvTG93ZXJDYXNlKCk7CiAgfSwKCiAgLyoqCiAg
        ICBSZXBsYWNlcyB1bmRlcnNjb3Jlcywgc3BhY2VzLCBvciBjYW1lbENhc2Ug
        d2l0aCBkYXNoZXMuCgogICAgYGBgamF2YXNjcmlwdAogICAgJ2lubmVySFRN
        TCcuZGFzaGVyaXplKCk7ICAgICAgICAgIC8vICdpbm5lci1odG1sJwogICAg
        J2FjdGlvbl9uYW1lJy5kYXNoZXJpemUoKTsgICAgICAgIC8vICdhY3Rpb24t
        bmFtZScKICAgICdjc3MtY2xhc3MtbmFtZScuZGFzaGVyaXplKCk7ICAgICAv
        LyAnY3NzLWNsYXNzLW5hbWUnCiAgICAnbXkgZmF2b3JpdGUgaXRlbXMnLmRh
        c2hlcml6ZSgpOyAgLy8gJ215LWZhdm9yaXRlLWl0ZW1zJwogICAgYGBgCgog
        ICAgQG1ldGhvZCBkYXNoZXJpemUKICAgIEBwYXJhbSB7U3RyaW5nfSBzdHIg
        VGhlIHN0cmluZyB0byBkYXNoZXJpemUuCiAgICBAcmV0dXJuIHtTdHJpbmd9
        IHRoZSBkYXNoZXJpemVkIHN0cmluZy4KICAqLwogIGRhc2hlcml6ZTogZnVu
        Y3Rpb24oc3RyKSB7CiAgICB2YXIgY2FjaGUgPSBTVFJJTkdfREFTSEVSSVpF
        X0NBQ0hFLAogICAgICAgIGhpdCAgID0gY2FjaGUuaGFzT3duUHJvcGVydHko
        c3RyKSwKICAgICAgICByZXQ7CgogICAgaWYgKGhpdCkgewogICAgICByZXR1
        cm4gY2FjaGVbc3RyXTsKICAgIH0gZWxzZSB7CiAgICAgIHJldCA9IEVtYmVy
        LlN0cmluZy5kZWNhbWVsaXplKHN0cikucmVwbGFjZShTVFJJTkdfREFTSEVS
        SVpFX1JFR0VYUCwnLScpOwogICAgICBjYWNoZVtzdHJdID0gcmV0OwogICAg
        fQoKICAgIHJldHVybiByZXQ7CiAgfSwKCiAgLyoqCiAgICBSZXR1cm5zIHRo
        ZSBsb3dlckNhbWVsQ2FzZSBmb3JtIG9mIGEgc3RyaW5nLgoKICAgIGBgYGph
        dmFzY3JpcHQKICAgICdpbm5lckhUTUwnLmNhbWVsaXplKCk7ICAgICAgICAg
        IC8vICdpbm5lckhUTUwnCiAgICAnYWN0aW9uX25hbWUnLmNhbWVsaXplKCk7
        ICAgICAgICAvLyAnYWN0aW9uTmFtZScKICAgICdjc3MtY2xhc3MtbmFtZScu
        Y2FtZWxpemUoKTsgICAgIC8vICdjc3NDbGFzc05hbWUnCiAgICAnbXkgZmF2
        b3JpdGUgaXRlbXMnLmNhbWVsaXplKCk7ICAvLyAnbXlGYXZvcml0ZUl0ZW1z
        JwogICAgJ015IEZhdm9yaXRlIEl0ZW1zJy5jYW1lbGl6ZSgpOyAgLy8gJ215
        RmF2b3JpdGVJdGVtcycKICAgIGBgYAoKICAgIEBtZXRob2QgY2FtZWxpemUK
        ICAgIEBwYXJhbSB7U3RyaW5nfSBzdHIgVGhlIHN0cmluZyB0byBjYW1lbGl6
        ZS4KICAgIEByZXR1cm4ge1N0cmluZ30gdGhlIGNhbWVsaXplZCBzdHJpbmcu
        CiAgKi8KICBjYW1lbGl6ZTogZnVuY3Rpb24oc3RyKSB7CiAgICByZXR1cm4g
        c3RyLnJlcGxhY2UoU1RSSU5HX0NBTUVMSVpFX1JFR0VYUCwgZnVuY3Rpb24o
        bWF0Y2gsIHNlcGFyYXRvciwgY2hyKSB7CiAgICAgIHJldHVybiBjaHIgPyBj
        aHIudG9VcHBlckNhc2UoKSA6ICcnOwogICAgfSkucmVwbGFjZSgvXihbQS1a
        XSkvLCBmdW5jdGlvbihtYXRjaCwgc2VwYXJhdG9yLCBjaHIpIHsKICAgICAg
        cmV0dXJuIG1hdGNoLnRvTG93ZXJDYXNlKCk7CiAgICB9KTsKICB9LAoKICAv
        KioKICAgIFJldHVybnMgdGhlIFVwcGVyQ2FtZWxDYXNlIGZvcm0gb2YgYSBz
        dHJpbmcuCgogICAgYGBgamF2YXNjcmlwdAogICAgJ2lubmVySFRNTCcuY2xh
        c3NpZnkoKTsgICAgICAgICAgLy8gJ0lubmVySFRNTCcKICAgICdhY3Rpb25f
        bmFtZScuY2xhc3NpZnkoKTsgICAgICAgIC8vICdBY3Rpb25OYW1lJwogICAg
        J2Nzcy1jbGFzcy1uYW1lJy5jbGFzc2lmeSgpOyAgICAgLy8gJ0Nzc0NsYXNz
        TmFtZScKICAgICdteSBmYXZvcml0ZSBpdGVtcycuY2xhc3NpZnkoKTsgIC8v
        ICdNeUZhdm9yaXRlSXRlbXMnCiAgICBgYGAKCiAgICBAbWV0aG9kIGNsYXNz
        aWZ5CiAgICBAcGFyYW0ge1N0cmluZ30gc3RyIHRoZSBzdHJpbmcgdG8gY2xh
        c3NpZnkKICAgIEByZXR1cm4ge1N0cmluZ30gdGhlIGNsYXNzaWZpZWQgc3Ry
        aW5nCiAgKi8KICBjbGFzc2lmeTogZnVuY3Rpb24oc3RyKSB7CiAgICB2YXIg
        cGFydHMgPSBzdHIuc3BsaXQoIi4iKSwKICAgICAgICBvdXQgPSBbXTsKCiAg
        ICBmb3IgKHZhciBpPTAsIGw9cGFydHMubGVuZ3RoOyBpPGw7IGkrKykgewog
        ICAgICB2YXIgY2FtZWxpemVkID0gRW1iZXIuU3RyaW5nLmNhbWVsaXplKHBh
        cnRzW2ldKTsKICAgICAgb3V0LnB1c2goY2FtZWxpemVkLmNoYXJBdCgwKS50
        b1VwcGVyQ2FzZSgpICsgY2FtZWxpemVkLnN1YnN0cigxKSk7CiAgICB9Cgog
        ICAgcmV0dXJuIG91dC5qb2luKCIuIik7CiAgfSwKCiAgLyoqCiAgICBNb3Jl
        IGdlbmVyYWwgdGhhbiBkZWNhbWVsaXplLiBSZXR1cm5zIHRoZSBsb3dlclxf
        Y2FzZVxfYW5kXF91bmRlcnNjb3JlZAogICAgZm9ybSBvZiBhIHN0cmluZy4K
        CiAgICBgYGBqYXZhc2NyaXB0CiAgICAnaW5uZXJIVE1MJy51bmRlcnNjb3Jl
        KCk7ICAgICAgICAgIC8vICdpbm5lcl9odG1sJwogICAgJ2FjdGlvbl9uYW1l
        Jy51bmRlcnNjb3JlKCk7ICAgICAgICAvLyAnYWN0aW9uX25hbWUnCiAgICAn
        Y3NzLWNsYXNzLW5hbWUnLnVuZGVyc2NvcmUoKTsgICAgIC8vICdjc3NfY2xh
        c3NfbmFtZScKICAgICdteSBmYXZvcml0ZSBpdGVtcycudW5kZXJzY29yZSgp
        OyAgLy8gJ215X2Zhdm9yaXRlX2l0ZW1zJwogICAgYGBgCgogICAgQG1ldGhv
        ZCB1bmRlcnNjb3JlCiAgICBAcGFyYW0ge1N0cmluZ30gc3RyIFRoZSBzdHJp
        bmcgdG8gdW5kZXJzY29yZS4KICAgIEByZXR1cm4ge1N0cmluZ30gdGhlIHVu
        ZGVyc2NvcmVkIHN0cmluZy4KICAqLwogIHVuZGVyc2NvcmU6IGZ1bmN0aW9u
        KHN0cikgewogICAgcmV0dXJuIHN0ci5yZXBsYWNlKFNUUklOR19VTkRFUlND
        T1JFX1JFR0VYUF8xLCAnJDFfJDInKS4KICAgICAgcmVwbGFjZShTVFJJTkdf
        VU5ERVJTQ09SRV9SRUdFWFBfMiwgJ18nKS50b0xvd2VyQ2FzZSgpOwogIH0s
        CgogIC8qKgogICAgUmV0dXJucyB0aGUgQ2FwaXRhbGl6ZWQgZm9ybSBvZiBh
        IHN0cmluZwoKICAgIGBgYGphdmFzY3JpcHQKICAgICdpbm5lckhUTUwnLmNh
        cGl0YWxpemUoKSAgICAgICAgIC8vICdJbm5lckhUTUwnCiAgICAnYWN0aW9u
        X25hbWUnLmNhcGl0YWxpemUoKSAgICAgICAvLyAnQWN0aW9uX25hbWUnCiAg
        ICAnY3NzLWNsYXNzLW5hbWUnLmNhcGl0YWxpemUoKSAgICAvLyAnQ3NzLWNs
        YXNzLW5hbWUnCiAgICAnbXkgZmF2b3JpdGUgaXRlbXMnLmNhcGl0YWxpemUo
        KSAvLyAnTXkgZmF2b3JpdGUgaXRlbXMnCiAgICBgYGAKCiAgICBAbWV0aG9k
        IGNhcGl0YWxpemUKICAgIEBwYXJhbSB7U3RyaW5nfSBzdHIgVGhlIHN0cmlu
        ZyB0byBjYXBpdGFsaXplLgogICAgQHJldHVybiB7U3RyaW5nfSBUaGUgY2Fw
        aXRhbGl6ZWQgc3RyaW5nLgogICovCiAgY2FwaXRhbGl6ZTogZnVuY3Rpb24o
        c3RyKSB7CiAgICByZXR1cm4gc3RyLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgp
        ICsgc3RyLnN1YnN0cigxKTsKICB9Cgp9OwoKfSkoKTsKCgoKKGZ1bmN0aW9u
        KCkgewovKioKQG1vZHVsZSBlbWJlcgpAc3VibW9kdWxlIGVtYmVyLXJ1bnRp
        bWUKKi8KCgoKdmFyIGZtdCA9IEVtYmVyLlN0cmluZy5mbXQsCiAgICB3ICAg
        PSBFbWJlci5TdHJpbmcudywKICAgIGxvYyA9IEVtYmVyLlN0cmluZy5sb2Ms
        CiAgICBjYW1lbGl6ZSA9IEVtYmVyLlN0cmluZy5jYW1lbGl6ZSwKICAgIGRl
        Y2FtZWxpemUgPSBFbWJlci5TdHJpbmcuZGVjYW1lbGl6ZSwKICAgIGRhc2hl
        cml6ZSA9IEVtYmVyLlN0cmluZy5kYXNoZXJpemUsCiAgICB1bmRlcnNjb3Jl
        ID0gRW1iZXIuU3RyaW5nLnVuZGVyc2NvcmUsCiAgICBjYXBpdGFsaXplID0g
        RW1iZXIuU3RyaW5nLmNhcGl0YWxpemUsCiAgICBjbGFzc2lmeSA9IEVtYmVy
        LlN0cmluZy5jbGFzc2lmeTsKCmlmIChFbWJlci5FWFRFTkRfUFJPVE9UWVBF
        UyA9PT0gdHJ1ZSB8fCBFbWJlci5FWFRFTkRfUFJPVE9UWVBFUy5TdHJpbmcp
        IHsKCiAgLyoqCiAgICBTZWUgW0VtYmVyLlN0cmluZy5mbXRdKC9hcGkvY2xh
        c3Nlcy9FbWJlci5TdHJpbmcuaHRtbCNtZXRob2RfZm10KS4KCiAgICBAbWV0
        aG9kIGZtdAogICAgQGZvciBTdHJpbmcKICAqLwogIFN0cmluZy5wcm90b3R5
        cGUuZm10ID0gZnVuY3Rpb24oKSB7CiAgICByZXR1cm4gZm10KHRoaXMsIGFy
        Z3VtZW50cyk7CiAgfTsKCiAgLyoqCiAgICBTZWUgW0VtYmVyLlN0cmluZy53
        XSgvYXBpL2NsYXNzZXMvRW1iZXIuU3RyaW5nLmh0bWwjbWV0aG9kX3cpLgoK
        ICAgIEBtZXRob2QgdwogICAgQGZvciBTdHJpbmcKICAqLwogIFN0cmluZy5w
        cm90b3R5cGUudyA9IGZ1bmN0aW9uKCkgewogICAgcmV0dXJuIHcodGhpcyk7
        CiAgfTsKCiAgLyoqCiAgICBTZWUgW0VtYmVyLlN0cmluZy5sb2NdKC9hcGkv
        Y2xhc3Nlcy9FbWJlci5TdHJpbmcuaHRtbCNtZXRob2RfbG9jKS4KCiAgICBA
        bWV0aG9kIGxvYwogICAgQGZvciBTdHJpbmcKICAqLwogIFN0cmluZy5wcm90
        b3R5cGUubG9jID0gZnVuY3Rpb24oKSB7CiAgICByZXR1cm4gbG9jKHRoaXMs
        IGFyZ3VtZW50cyk7CiAgfTsKCiAgLyoqCiAgICBTZWUgW0VtYmVyLlN0cmlu
        Zy5jYW1lbGl6ZV0oL2FwaS9jbGFzc2VzL0VtYmVyLlN0cmluZy5odG1sI21l
        dGhvZF9jYW1lbGl6ZSkuCgogICAgQG1ldGhvZCBjYW1lbGl6ZQogICAgQGZv
        ciBTdHJpbmcKICAqLwogIFN0cmluZy5wcm90b3R5cGUuY2FtZWxpemUgPSBm
        dW5jdGlvbigpIHsKICAgIHJldHVybiBjYW1lbGl6ZSh0aGlzKTsKICB9OwoK
        ICAvKioKICAgIFNlZSBbRW1iZXIuU3RyaW5nLmRlY2FtZWxpemVdKC9hcGkv
        Y2xhc3Nlcy9FbWJlci5TdHJpbmcuaHRtbCNtZXRob2RfZGVjYW1lbGl6ZSku
        CgogICAgQG1ldGhvZCBkZWNhbWVsaXplCiAgICBAZm9yIFN0cmluZwogICov
        CiAgU3RyaW5nLnByb3RvdHlwZS5kZWNhbWVsaXplID0gZnVuY3Rpb24oKSB7
        CiAgICByZXR1cm4gZGVjYW1lbGl6ZSh0aGlzKTsKICB9OwoKICAvKioKICAg
        IFNlZSBbRW1iZXIuU3RyaW5nLmRhc2hlcml6ZV0oL2FwaS9jbGFzc2VzL0Vt
        YmVyLlN0cmluZy5odG1sI21ldGhvZF9kYXNoZXJpemUpLgoKICAgIEBtZXRo
        b2QgZGFzaGVyaXplCiAgICBAZm9yIFN0cmluZwogICovCiAgU3RyaW5nLnBy
        b3RvdHlwZS5kYXNoZXJpemUgPSBmdW5jdGlvbigpIHsKICAgIHJldHVybiBk
        YXNoZXJpemUodGhpcyk7CiAgfTsKCiAgLyoqCiAgICBTZWUgW0VtYmVyLlN0
        cmluZy51bmRlcnNjb3JlXSgvYXBpL2NsYXNzZXMvRW1iZXIuU3RyaW5nLmh0
        bWwjbWV0aG9kX3VuZGVyc2NvcmUpLgoKICAgIEBtZXRob2QgdW5kZXJzY29y
        ZQogICAgQGZvciBTdHJpbmcKICAqLwogIFN0cmluZy5wcm90b3R5cGUudW5k
        ZXJzY29yZSA9IGZ1bmN0aW9uKCkgewogICAgcmV0dXJuIHVuZGVyc2NvcmUo
        dGhpcyk7CiAgfTsKCiAgLyoqCiAgICBTZWUgW0VtYmVyLlN0cmluZy5jbGFz
        c2lmeV0oL2FwaS9jbGFzc2VzL0VtYmVyLlN0cmluZy5odG1sI21ldGhvZF9j
        bGFzc2lmeSkuCgogICAgQG1ldGhvZCBjbGFzc2lmeQogICAgQGZvciBTdHJp
        bmcKICAqLwogIFN0cmluZy5wcm90b3R5cGUuY2xhc3NpZnkgPSBmdW5jdGlv
        bigpIHsKICAgIHJldHVybiBjbGFzc2lmeSh0aGlzKTsKICB9OwoKICAvKioK
        ICAgIFNlZSBbRW1iZXIuU3RyaW5nLmNhcGl0YWxpemVdKC9hcGkvY2xhc3Nl
        cy9FbWJlci5TdHJpbmcuaHRtbCNtZXRob2RfY2FwaXRhbGl6ZSkuCgogICAg
        QG1ldGhvZCBjYXBpdGFsaXplCiAgICBAZm9yIFN0cmluZwogICovCiAgU3Ry
        aW5nLnByb3RvdHlwZS5jYXBpdGFsaXplID0gZnVuY3Rpb24oKSB7CiAgICBy
        ZXR1cm4gY2FwaXRhbGl6ZSh0aGlzKTsKICB9OwoKfQoKCn0pKCk7CgoKCihm
        dW5jdGlvbigpIHsKLyoqCkBtb2R1bGUgZW1iZXIKQHN1Ym1vZHVsZSBlbWJl
        ci1ydW50aW1lCiovCgp2YXIgYV9zbGljZSA9IEFycmF5LnByb3RvdHlwZS5z
        bGljZTsKCmlmIChFbWJlci5FWFRFTkRfUFJPVE9UWVBFUyA9PT0gdHJ1ZSB8
        fCBFbWJlci5FWFRFTkRfUFJPVE9UWVBFUy5GdW5jdGlvbikgewoKICAvKioK
        ICAgIFRoZSBgcHJvcGVydHlgIGV4dGVuc2lvbiBvZiBKYXZhc2NyaXB0J3Mg
        RnVuY3Rpb24gcHJvdG90eXBlIGlzIGF2YWlsYWJsZQogICAgd2hlbiBgRW1i
        ZXIuRVhURU5EX1BST1RPVFlQRVNgIG9yIGBFbWJlci5FWFRFTkRfUFJPVE9U
        WVBFUy5GdW5jdGlvbmAgaXMKICAgIGB0cnVlYCwgd2hpY2ggaXMgdGhlIGRl
        ZmF1bHQuCgogICAgQ29tcHV0ZWQgcHJvcGVydGllcyBhbGxvdyB5b3UgdG8g
        dHJlYXQgYSBmdW5jdGlvbiBsaWtlIGEgcHJvcGVydHk6CgogICAgYGBgamF2
        YXNjcmlwdAogICAgTXlBcHAuUHJlc2lkZW50ID0gRW1iZXIuT2JqZWN0LmV4
        dGVuZCh7CiAgICAgIGZpcnN0TmFtZTogJycsCiAgICAgIGxhc3ROYW1lOiAg
        JycsCgogICAgICBmdWxsTmFtZTogZnVuY3Rpb24oKSB7CiAgICAgICAgcmV0
        dXJuIHRoaXMuZ2V0KCdmaXJzdE5hbWUnKSArICcgJyArIHRoaXMuZ2V0KCds
        YXN0TmFtZScpOwoKICAgICAgICAvLyBDYWxsIHRoaXMgZmxhZyB0byBtYXJr
        IHRoZSBmdW5jdGlvbiBhcyBhIHByb3BlcnR5CiAgICAgIH0ucHJvcGVydHko
        KQogICAgfSk7CgogICAgdmFyIHByZXNpZGVudCA9IE15QXBwLlByZXNpZGVu
        dC5jcmVhdGUoewogICAgICBmaXJzdE5hbWU6ICJCYXJhY2siLAogICAgICBs
        YXN0TmFtZTogIk9iYW1hIgogICAgfSk7CgogICAgcHJlc2lkZW50LmdldCgn
        ZnVsbE5hbWUnKTsgICAgLy8gIkJhcmFjayBPYmFtYSIKICAgIGBgYAoKICAg
        IFRyZWF0aW5nIGEgZnVuY3Rpb24gbGlrZSBhIHByb3BlcnR5IGlzIHVzZWZ1
        bCBiZWNhdXNlIHRoZXkgY2FuIHdvcmsgd2l0aAogICAgYmluZGluZ3MsIGp1
        c3QgbGlrZSBhbnkgb3RoZXIgcHJvcGVydHkuCgogICAgTWFueSBjb21wdXRl
        ZCBwcm9wZXJ0aWVzIGhhdmUgZGVwZW5kZW5jaWVzIG9uIG90aGVyIHByb3Bl
        cnRpZXMuIEZvcgogICAgZXhhbXBsZSwgaW4gdGhlIGFib3ZlIGV4YW1wbGUs
        IHRoZSBgZnVsbE5hbWVgIHByb3BlcnR5IGRlcGVuZHMgb24KICAgIGBmaXJz
        dE5hbWVgIGFuZCBgbGFzdE5hbWVgIHRvIGRldGVybWluZSBpdHMgdmFsdWUu
        IFlvdSBjYW4gdGVsbCBFbWJlcgogICAgYWJvdXQgdGhlc2UgZGVwZW5kZW5j
        aWVzIGxpa2UgdGhpczoKCiAgICBgYGBqYXZhc2NyaXB0CiAgICBNeUFwcC5Q
        cmVzaWRlbnQgPSBFbWJlci5PYmplY3QuZXh0ZW5kKHsKICAgICAgZmlyc3RO
        YW1lOiAnJywKICAgICAgbGFzdE5hbWU6ICAnJywKCiAgICAgIGZ1bGxOYW1l
        OiBmdW5jdGlvbigpIHsKICAgICAgICByZXR1cm4gdGhpcy5nZXQoJ2ZpcnN0
        TmFtZScpICsgJyAnICsgdGhpcy5nZXQoJ2xhc3ROYW1lJyk7CgogICAgICAg
        IC8vIFRlbGwgRW1iZXIuanMgdGhhdCB0aGlzIGNvbXB1dGVkIHByb3BlcnR5
        IGRlcGVuZHMgb24gZmlyc3ROYW1lCiAgICAgICAgLy8gYW5kIGxhc3ROYW1l
        CiAgICAgIH0ucHJvcGVydHkoJ2ZpcnN0TmFtZScsICdsYXN0TmFtZScpCiAg
        ICB9KTsKICAgIGBgYAoKICAgIE1ha2Ugc3VyZSB5b3UgbGlzdCB0aGVzZSBk
        ZXBlbmRlbmNpZXMgc28gRW1iZXIga25vd3Mgd2hlbiB0byB1cGRhdGUKICAg
        IGJpbmRpbmdzIHRoYXQgY29ubmVjdCB0byBhIGNvbXB1dGVkIHByb3BlcnR5
        LiBDaGFuZ2luZyBhIGRlcGVuZGVuY3kKICAgIHdpbGwgbm90IGltbWVkaWF0
        ZWx5IHRyaWdnZXIgYW4gdXBkYXRlIG9mIHRoZSBjb21wdXRlZCBwcm9wZXJ0
        eSwgYnV0CiAgICB3aWxsIGluc3RlYWQgY2xlYXIgdGhlIGNhY2hlIHNvIHRo
        YXQgaXQgaXMgdXBkYXRlZCB3aGVuIHRoZSBuZXh0IGBnZXRgCiAgICBpcyBj
        YWxsZWQgb24gdGhlIHByb3BlcnR5LgoKICAgIFNlZSBbRW1iZXIuQ29tcHV0
        ZWRQcm9wZXJ0eV0oL2FwaS9jbGFzc2VzL0VtYmVyLkNvbXB1dGVkUHJvcGVy
        dHkuaHRtbCksIFtFbWJlci5jb21wdXRlZF0oL2FwaS8jbWV0aG9kX2NvbXB1
        dGVkKS4KCiAgICBAbWV0aG9kIHByb3BlcnR5CiAgICBAZm9yIEZ1bmN0aW9u
        CiAgKi8KICBGdW5jdGlvbi5wcm90b3R5cGUucHJvcGVydHkgPSBmdW5jdGlv
        bigpIHsKICAgIHZhciByZXQgPSBFbWJlci5jb21wdXRlZCh0aGlzKTsKICAg
        IHJldHVybiByZXQucHJvcGVydHkuYXBwbHkocmV0LCBhcmd1bWVudHMpOwog
        IH07CgogIC8qKgogICAgVGhlIGBvYnNlcnZlc2AgZXh0ZW5zaW9uIG9mIEph
        dmFzY3JpcHQncyBGdW5jdGlvbiBwcm90b3R5cGUgaXMgYXZhaWxhYmxlCiAg
        ICB3aGVuIGBFbWJlci5FWFRFTkRfUFJPVE9UWVBFU2Agb3IgYEVtYmVyLkVY
        VEVORF9QUk9UT1RZUEVTLkZ1bmN0aW9uYCBpcwogICAgdHJ1ZSwgd2hpY2gg
        aXMgdGhlIGRlZmF1bHQuCgogICAgWW91IGNhbiBvYnNlcnZlIHByb3BlcnR5
        IGNoYW5nZXMgc2ltcGx5IGJ5IGFkZGluZyB0aGUgYG9ic2VydmVzYAogICAg
        Y2FsbCB0byB0aGUgZW5kIG9mIHlvdXIgbWV0aG9kIGRlY2xhcmF0aW9ucyBp
        biBjbGFzc2VzIHRoYXQgeW91IHdyaXRlLgogICAgRm9yIGV4YW1wbGU6Cgog
        ICAgYGBgamF2YXNjcmlwdAogICAgRW1iZXIuT2JqZWN0LmV4dGVuZCh7CiAg
        ICAgIHZhbHVlT2JzZXJ2ZXI6IGZ1bmN0aW9uKCkgewogICAgICAgIC8vIEV4
        ZWN1dGVzIHdoZW5ldmVyIHRoZSAidmFsdWUiIHByb3BlcnR5IGNoYW5nZXMK
        ICAgICAgfS5vYnNlcnZlcygndmFsdWUnKQogICAgfSk7CiAgICBgYGAKCiAg
        ICBJbiB0aGUgZnV0dXJlIHRoaXMgbWV0aG9kIG1heSBiZWNvbWUgYXN5bmNo
        cm9ub3VzLiBJZiB5b3Ugd2FudCB0byBlbnN1cmUKICAgIHN5bmNocm9ub3Vz
        IGJlaGF2aW9yLCB1c2UgYG9ic2VydmVzSW1tZWRpYXRlbHlgLgoKICAgIFNl
        ZSBgRW1iZXIub2JzZXJ2ZXJgLgoKICAgIEBtZXRob2Qgb2JzZXJ2ZXMKICAg
        IEBmb3IgRnVuY3Rpb24KICAqLwogIEZ1bmN0aW9uLnByb3RvdHlwZS5vYnNl
        cnZlcyA9IGZ1bmN0aW9uKCkgewogICAgdGhpcy5fX2VtYmVyX29ic2VydmVz
        X18gPSBhX3NsaWNlLmNhbGwoYXJndW1lbnRzKTsKICAgIHJldHVybiB0aGlz
        OwogIH07CgogIC8qKgogICAgVGhlIGBvYnNlcnZlc0ltbWVkaWF0ZWx5YCBl
        eHRlbnNpb24gb2YgSmF2YXNjcmlwdCdzIEZ1bmN0aW9uIHByb3RvdHlwZSBp
        cwogICAgYXZhaWxhYmxlIHdoZW4gYEVtYmVyLkVYVEVORF9QUk9UT1RZUEVT
        YCBvcgogICAgYEVtYmVyLkVYVEVORF9QUk9UT1RZUEVTLkZ1bmN0aW9uYCBp
        cyB0cnVlLCB3aGljaCBpcyB0aGUgZGVmYXVsdC4KCiAgICBZb3UgY2FuIG9i
        c2VydmUgcHJvcGVydHkgY2hhbmdlcyBzaW1wbHkgYnkgYWRkaW5nIHRoZSBg
        b2JzZXJ2ZXNJbW1lZGlhdGVseWAKICAgIGNhbGwgdG8gdGhlIGVuZCBvZiB5
        b3VyIG1ldGhvZCBkZWNsYXJhdGlvbnMgaW4gY2xhc3NlcyB0aGF0IHlvdSB3
        cml0ZS4KICAgIEZvciBleGFtcGxlOgoKICAgIGBgYGphdmFzY3JpcHQKICAg
        IEVtYmVyLk9iamVjdC5leHRlbmQoewogICAgICB2YWx1ZU9ic2VydmVyOiBm
        dW5jdGlvbigpIHsKICAgICAgICAvLyBFeGVjdXRlcyBpbW1lZGlhdGVseSBh
        ZnRlciB0aGUgInZhbHVlIiBwcm9wZXJ0eSBjaGFuZ2VzCiAgICAgIH0ub2Jz
        ZXJ2ZXNJbW1lZGlhdGVseSgndmFsdWUnKQogICAgfSk7CiAgICBgYGAKCiAg
        ICBJbiB0aGUgZnV0dXJlLCBgb2JzZXJ2ZXNgIG1heSBiZWNvbWUgYXN5bmNo
        cm9ub3VzLiBJbiB0aGlzIGV2ZW50LAogICAgYG9ic2VydmVzSW1tZWRpYXRl
        bHlgIHdpbGwgbWFpbnRhaW4gdGhlIHN5bmNocm9ub3VzIGJlaGF2aW9yLgoK
        ICAgIFNlZSBgRW1iZXIuaW1tZWRpYXRlT2JzZXJ2ZXJgLgoKICAgIEBtZXRo
        b2Qgb2JzZXJ2ZXNJbW1lZGlhdGVseQogICAgQGZvciBGdW5jdGlvbgogICov
        CiAgRnVuY3Rpb24ucHJvdG90eXBlLm9ic2VydmVzSW1tZWRpYXRlbHkgPSBm
        dW5jdGlvbigpIHsKICAgIGZvciAodmFyIGk9MCwgbD1hcmd1bWVudHMubGVu
        Z3RoOyBpPGw7IGkrKykgewogICAgICB2YXIgYXJnID0gYXJndW1lbnRzW2ld
        OwogICAgICBFbWJlci5hc3NlcnQoIkltbWVkaWF0ZSBvYnNlcnZlcnMgbXVz
        dCBvYnNlcnZlIGludGVybmFsIHByb3BlcnRpZXMgb25seSwgbm90IHByb3Bl
        cnRpZXMgb24gb3RoZXIgb2JqZWN0cy4iLCBhcmcuaW5kZXhPZignLicpID09
        PSAtMSk7CiAgICB9CgogICAgcmV0dXJuIHRoaXMub2JzZXJ2ZXMuYXBwbHko
        dGhpcywgYXJndW1lbnRzKTsKICB9OwoKICAvKioKICAgIFRoZSBgb2JzZXJ2
        ZXNCZWZvcmVgIGV4dGVuc2lvbiBvZiBKYXZhc2NyaXB0J3MgRnVuY3Rpb24g
        cHJvdG90eXBlIGlzCiAgICBhdmFpbGFibGUgd2hlbiBgRW1iZXIuRVhURU5E
        X1BST1RPVFlQRVNgIG9yCiAgICBgRW1iZXIuRVhURU5EX1BST1RPVFlQRVMu
        RnVuY3Rpb25gIGlzIHRydWUsIHdoaWNoIGlzIHRoZSBkZWZhdWx0LgoKICAg
        IFlvdSBjYW4gZ2V0IG5vdGlmaWVkIHdoZW4gYSBwcm9wZXJ0eSBjaGFuZ2Ug
        aXMgYWJvdXQgdG8gaGFwcGVuIGJ5CiAgICBieSBhZGRpbmcgdGhlIGBvYnNl
        cnZlc0JlZm9yZWAgY2FsbCB0byB0aGUgZW5kIG9mIHlvdXIgbWV0aG9kCiAg
        ICBkZWNsYXJhdGlvbnMgaW4gY2xhc3NlcyB0aGF0IHlvdSB3cml0ZS4gRm9y
        IGV4YW1wbGU6CgogICAgYGBgamF2YXNjcmlwdAogICAgRW1iZXIuT2JqZWN0
        LmV4dGVuZCh7CiAgICAgIHZhbHVlT2JzZXJ2ZXI6IGZ1bmN0aW9uKCkgewog
        ICAgICAgIC8vIEV4ZWN1dGVzIHdoZW5ldmVyIHRoZSAidmFsdWUiIHByb3Bl
        cnR5IGlzIGFib3V0IHRvIGNoYW5nZQogICAgICB9Lm9ic2VydmVzQmVmb3Jl
        KCd2YWx1ZScpCiAgICB9KTsKICAgIGBgYAoKICAgIFNlZSBgRW1iZXIuYmVm
        b3JlT2JzZXJ2ZXJgLgoKICAgIEBtZXRob2Qgb2JzZXJ2ZXNCZWZvcmUKICAg
        IEBmb3IgRnVuY3Rpb24KICAqLwogIEZ1bmN0aW9uLnByb3RvdHlwZS5vYnNl
        cnZlc0JlZm9yZSA9IGZ1bmN0aW9uKCkgewogICAgdGhpcy5fX2VtYmVyX29i
        c2VydmVzQmVmb3JlX18gPSBhX3NsaWNlLmNhbGwoYXJndW1lbnRzKTsKICAg
        IHJldHVybiB0aGlzOwogIH07CgogIC8qKgogICAgVGhlIGBvbmAgZXh0ZW5z
        aW9uIG9mIEphdmFzY3JpcHQncyBGdW5jdGlvbiBwcm90b3R5cGUgaXMgYXZh
        aWxhYmxlCiAgICB3aGVuIGBFbWJlci5FWFRFTkRfUFJPVE9UWVBFU2Agb3Ig
        YEVtYmVyLkVYVEVORF9QUk9UT1RZUEVTLkZ1bmN0aW9uYCBpcwogICAgdHJ1
        ZSwgd2hpY2ggaXMgdGhlIGRlZmF1bHQuCgogICAgWW91IGNhbiBsaXN0ZW4g
        Zm9yIGV2ZW50cyBzaW1wbHkgYnkgYWRkaW5nIHRoZSBgb25gIGNhbGwgdG8g
        dGhlIGVuZCBvZgogICAgeW91ciBtZXRob2QgZGVjbGFyYXRpb25zIGluIGNs
        YXNzZXMgb3IgbWl4aW5zIHRoYXQgeW91IHdyaXRlLiBGb3IgZXhhbXBsZToK
        CiAgICBgYGBqYXZhc2NyaXB0CiAgICBFbWJlci5NaXhpbi5jcmVhdGUoewog
        ICAgICBkb1NvbWV0aGluZ1dpdGhFbGVtZW50OiBmdW5jdGlvbigpIHsKICAg
        ICAgICAvLyBFeGVjdXRlcyB3aGVuZXZlciB0aGUgImRpZEluc2VydEVsZW1l
        bnQiIGV2ZW50IGZpcmVzCiAgICAgIH0ub24oJ2RpZEluc2VydEVsZW1lbnQn
        KQogICAgfSk7CiAgICBgYGAKCiAgICBTZWUgYEVtYmVyLm9uYC4KCiAgICBA
        bWV0aG9kIG9uCiAgICBAZm9yIEZ1bmN0aW9uCiAgKi8KICBGdW5jdGlvbi5w
        cm90b3R5cGUub24gPSBmdW5jdGlvbigpIHsKICAgIHZhciBldmVudHMgPSBh
        X3NsaWNlLmNhbGwoYXJndW1lbnRzKTsKICAgIHRoaXMuX19lbWJlcl9saXN0
        ZW5zX18gPSBldmVudHM7CiAgICByZXR1cm4gdGhpczsKICB9Owp9CgoKfSko
        KTsKCgoKKGZ1bmN0aW9uKCkgewoKfSkoKTsKCgoKKGZ1bmN0aW9uKCkgewov
        KioKQG1vZHVsZSBlbWJlcgpAc3VibW9kdWxlIGVtYmVyLXJ1bnRpbWUKKi8K
        CgovKioKICBJbXBsZW1lbnRzIHNvbWUgc3RhbmRhcmQgbWV0aG9kcyBmb3Ig
        Y29tcGFyaW5nIG9iamVjdHMuIEFkZCB0aGlzIG1peGluIHRvCiAgYW55IGNs
        YXNzIHlvdSBjcmVhdGUgdGhhdCBjYW4gY29tcGFyZSBpdHMgaW5zdGFuY2Vz
        LgoKICBZb3Ugc2hvdWxkIGltcGxlbWVudCB0aGUgYGNvbXBhcmUoKWAgbWV0
        aG9kLgoKICBAY2xhc3MgQ29tcGFyYWJsZQogIEBuYW1lc3BhY2UgRW1iZXIK
        ICBAc2luY2UgRW1iZXIgMC45CiovCkVtYmVyLkNvbXBhcmFibGUgPSBFbWJl
        ci5NaXhpbi5jcmVhdGUoIC8qKiBAc2NvcGUgRW1iZXIuQ29tcGFyYWJsZS5w
        cm90b3R5cGUgKi97CgogIC8qKgogICAgT3ZlcnJpZGUgdG8gcmV0dXJuIHRo
        ZSByZXN1bHQgb2YgdGhlIGNvbXBhcmlzb24gb2YgdGhlIHR3byBwYXJhbWV0
        ZXJzLiBUaGUKICAgIGNvbXBhcmUgbWV0aG9kIHNob3VsZCByZXR1cm46Cgog
        ICAgLSBgLTFgIGlmIGBhIDwgYmAKICAgIC0gYDBgIGlmIGBhID09IGJgCiAg
        ICAtIGAxYCBpZiBgYSA+IGJgCgogICAgRGVmYXVsdCBpbXBsZW1lbnRhdGlv
        biByYWlzZXMgYW4gZXhjZXB0aW9uLgoKICAgIEBtZXRob2QgY29tcGFyZQog
        ICAgQHBhcmFtIGEge09iamVjdH0gdGhlIGZpcnN0IG9iamVjdCB0byBjb21w
        YXJlCiAgICBAcGFyYW0gYiB7T2JqZWN0fSB0aGUgc2Vjb25kIG9iamVjdCB0
        byBjb21wYXJlCiAgICBAcmV0dXJuIHtJbnRlZ2VyfSB0aGUgcmVzdWx0IG9m
        IHRoZSBjb21wYXJpc29uCiAgKi8KICBjb21wYXJlOiBFbWJlci5yZXF1aXJl
        ZChGdW5jdGlvbikKCn0pOwoKCn0pKCk7CgoKCihmdW5jdGlvbigpIHsKLyoq
        CkBtb2R1bGUgZW1iZXIKQHN1Ym1vZHVsZSBlbWJlci1ydW50aW1lCiovCgoK
        CnZhciBnZXQgPSBFbWJlci5nZXQsIHNldCA9IEVtYmVyLnNldDsKCi8qKgog
        IEltcGxlbWVudHMgc29tZSBzdGFuZGFyZCBtZXRob2RzIGZvciBjb3B5aW5n
        IGFuIG9iamVjdC4gQWRkIHRoaXMgbWl4aW4gdG8KICBhbnkgb2JqZWN0IHlv
        dSBjcmVhdGUgdGhhdCBjYW4gY3JlYXRlIGEgY29weSBvZiBpdHNlbGYuIFRo
        aXMgbWl4aW4gaXMKICBhZGRlZCBhdXRvbWF0aWNhbGx5IHRvIHRoZSBidWls
        dC1pbiBhcnJheS4KCiAgWW91IHNob3VsZCBnZW5lcmFsbHkgaW1wbGVtZW50
        IHRoZSBgY29weSgpYCBtZXRob2QgdG8gcmV0dXJuIGEgY29weSBvZiB0aGUK
        ICByZWNlaXZlci4KCiAgTm90ZSB0aGF0IGBmcm96ZW5Db3B5KClgIHdpbGwg
        b25seSB3b3JrIGlmIHlvdSBhbHNvIGltcGxlbWVudAogIGBFbWJlci5GcmVl
        emFibGVgLgoKICBAY2xhc3MgQ29weWFibGUKICBAbmFtZXNwYWNlIEVtYmVy
        CiAgQHNpbmNlIEVtYmVyIDAuOQoqLwpFbWJlci5Db3B5YWJsZSA9IEVtYmVy
        Lk1peGluLmNyZWF0ZSgvKiogQHNjb3BlIEVtYmVyLkNvcHlhYmxlLnByb3Rv
        dHlwZSAqLyB7CgogIC8qKgogICAgT3ZlcnJpZGUgdG8gcmV0dXJuIGEgY29w
        eSBvZiB0aGUgcmVjZWl2ZXIuIERlZmF1bHQgaW1wbGVtZW50YXRpb24gcmFp
        c2VzCiAgICBhbiBleGNlcHRpb24uCgogICAgQG1ldGhvZCBjb3B5CiAgICBA
        cGFyYW0ge0Jvb2xlYW59IGRlZXAgaWYgYHRydWVgLCBhIGRlZXAgY29weSBv
        ZiB0aGUgb2JqZWN0IHNob3VsZCBiZSBtYWRlCiAgICBAcmV0dXJuIHtPYmpl
        Y3R9IGNvcHkgb2YgcmVjZWl2ZXIKICAqLwogIGNvcHk6IEVtYmVyLnJlcXVp
        cmVkKEZ1bmN0aW9uKSwKCiAgLyoqCiAgICBJZiB0aGUgb2JqZWN0IGltcGxl
        bWVudHMgYEVtYmVyLkZyZWV6YWJsZWAsIHRoZW4gdGhpcyB3aWxsIHJldHVy
        biBhIG5ldwogICAgY29weSBpZiB0aGUgb2JqZWN0IGlzIG5vdCBmcm96ZW4g
        YW5kIHRoZSByZWNlaXZlciBpZiB0aGUgb2JqZWN0IGlzIGZyb3plbi4KCiAg
        ICBSYWlzZXMgYW4gZXhjZXB0aW9uIGlmIHlvdSB0cnkgdG8gY2FsbCB0aGlz
        IG1ldGhvZCBvbiBhIG9iamVjdCB0aGF0IGRvZXMKICAgIG5vdCBzdXBwb3J0
        IGZyZWV6aW5nLgoKICAgIFlvdSBzaG91bGQgdXNlIHRoaXMgbWV0aG9kIHdo
        ZW5ldmVyIHlvdSB3YW50IGEgY29weSBvZiBhIGZyZWV6YWJsZSBvYmplY3QK
        ICAgIHNpbmNlIGEgZnJlZXphYmxlIG9iamVjdCBjYW4gc2ltcGx5IHJldHVy
        biBpdHNlbGYgd2l0aG91dCBhY3R1YWxseQogICAgY29uc3VtaW5nIG1vcmUg
        bWVtb3J5LgoKICAgIEBtZXRob2QgZnJvemVuQ29weQogICAgQHJldHVybiB7
        T2JqZWN0fSBjb3B5IG9mIHJlY2VpdmVyIG9yIHJlY2VpdmVyCiAgKi8KICBm
        cm96ZW5Db3B5OiBmdW5jdGlvbigpIHsKICAgIGlmIChFbWJlci5GcmVlemFi
        bGUgJiYgRW1iZXIuRnJlZXphYmxlLmRldGVjdCh0aGlzKSkgewogICAgICBy
        ZXR1cm4gZ2V0KHRoaXMsICdpc0Zyb3plbicpID8gdGhpcyA6IHRoaXMuY29w
        eSgpLmZyZWV6ZSgpOwogICAgfSBlbHNlIHsKICAgICAgdGhyb3cgbmV3IEVt
        YmVyLkVycm9yKEVtYmVyLlN0cmluZy5mbXQoIiVAIGRvZXMgbm90IHN1cHBv
        cnQgZnJlZXppbmciLCBbdGhpc10pKTsKICAgIH0KICB9Cn0pOwoKfSkoKTsK
        CgoKKGZ1bmN0aW9uKCkgewovKioKQG1vZHVsZSBlbWJlcgpAc3VibW9kdWxl
        IGVtYmVyLXJ1bnRpbWUKKi8KCgp2YXIgZ2V0ID0gRW1iZXIuZ2V0LCBzZXQg
        PSBFbWJlci5zZXQ7CgovKioKICBUaGUgYEVtYmVyLkZyZWV6YWJsZWAgbWl4
        aW4gaW1wbGVtZW50cyBzb21lIGJhc2ljIG1ldGhvZHMgZm9yIG1hcmtpbmcg
        YW4KICBvYmplY3QgYXMgZnJvemVuLiBPbmNlIGFuIG9iamVjdCBpcyBmcm96
        ZW4gaXQgc2hvdWxkIGJlIHJlYWQgb25seS4gTm8gY2hhbmdlcwogIG1heSBi
        ZSBtYWRlIHRoZSBpbnRlcm5hbCBzdGF0ZSBvZiB0aGUgb2JqZWN0LgoKICAj
        IyBFbmZvcmNlbWVudAoKICBUbyBmdWxseSBzdXBwb3J0IGZyZWV6aW5nIGlu
        IHlvdXIgc3ViY2xhc3MsIHlvdSBtdXN0IGluY2x1ZGUgdGhpcyBtaXhpbiBh
        bmQKICBvdmVycmlkZSBhbnkgbWV0aG9kIHRoYXQgbWlnaHQgYWx0ZXIgYW55
        IHByb3BlcnR5IG9uIHRoZSBvYmplY3QgdG8gaW5zdGVhZAogIHJhaXNlIGFu
        IGV4Y2VwdGlvbi4gWW91IGNhbiBjaGVjayB0aGUgc3RhdGUgb2YgYW4gb2Jq
        ZWN0IGJ5IGNoZWNraW5nIHRoZQogIGBpc0Zyb3plbmAgcHJvcGVydHkuCgog
        IEFsdGhvdWdoIGZ1dHVyZSB2ZXJzaW9ucyBvZiBKYXZhU2NyaXB0IG1heSBz
        dXBwb3J0IGxhbmd1YWdlLWxldmVsIGZyZWV6aW5nCiAgb2JqZWN0IG9iamVj
        dHMsIHRoYXQgaXMgbm90IHRoZSBjYXNlIHRvZGF5LiBFdmVuIGlmIGFuIG9i
        amVjdCBpcyBmcmVlemFibGUsCiAgaXQgaXMgc3RpbGwgdGVjaG5pY2FsbHkg
        cG9zc2libGUgdG8gbW9kaWZ5IHRoZSBvYmplY3QsIGV2ZW4gdGhvdWdoIGl0
        IGNvdWxkCiAgYnJlYWsgb3RoZXIgcGFydHMgb2YgeW91ciBhcHBsaWNhdGlv
        biB0aGF0IGRvIG5vdCBleHBlY3QgYSBmcm96ZW4gb2JqZWN0IHRvCiAgY2hh
        bmdlLiBJdCBpcywgdGhlcmVmb3JlLCB2ZXJ5IGltcG9ydGFudCB0aGF0IHlv
        dSBhbHdheXMgcmVzcGVjdCB0aGUKICBgaXNGcm96ZW5gIHByb3BlcnR5IG9u
        IGFsbCBmcmVlemFibGUgb2JqZWN0cy4KCiAgIyMgRXhhbXBsZSBVc2FnZQoK
        ICBUaGUgZXhhbXBsZSBiZWxvdyBzaG93cyBhIHNpbXBsZSBvYmplY3QgdGhh
        dCBpbXBsZW1lbnQgdGhlIGBFbWJlci5GcmVlemFibGVgCiAgcHJvdG9jb2wu
        CgogIGBgYGphdmFzY3JpcHQKICBDb250YWN0ID0gRW1iZXIuT2JqZWN0LmV4
        dGVuZChFbWJlci5GcmVlemFibGUsIHsKICAgIGZpcnN0TmFtZTogbnVsbCwK
        ICAgIGxhc3ROYW1lOiBudWxsLAoKICAgIC8vIHN3YXBzIHRoZSBuYW1lcwog
        ICAgc3dhcE5hbWVzOiBmdW5jdGlvbigpIHsKICAgICAgaWYgKHRoaXMuZ2V0
        KCdpc0Zyb3plbicpKSB0aHJvdyBFbWJlci5GUk9aRU5fRVJST1I7CiAgICAg
        IHZhciB0bXAgPSB0aGlzLmdldCgnZmlyc3ROYW1lJyk7CiAgICAgIHRoaXMu
        c2V0KCdmaXJzdE5hbWUnLCB0aGlzLmdldCgnbGFzdE5hbWUnKSk7CiAgICAg
        IHRoaXMuc2V0KCdsYXN0TmFtZScsIHRtcCk7CiAgICAgIHJldHVybiB0aGlz
        OwogICAgfQoKICB9KTsKCiAgYyA9IENvbnRleHQuY3JlYXRlKHsgZmlyc3RO
        YW1lOiAiSm9obiIsIGxhc3ROYW1lOiAiRG9lIiB9KTsKICBjLnN3YXBOYW1l
        cygpOyAgLy8gcmV0dXJucyBjCiAgYy5mcmVlemUoKTsKICBjLnN3YXBOYW1l
        cygpOyAgLy8gRVhDRVBUSU9OCiAgYGBgCgogICMjIENvcHlpbmcKCiAgVXN1
        YWxseSB0aGUgYEVtYmVyLkZyZWV6YWJsZWAgcHJvdG9jb2wgaXMgaW1wbGVt
        ZW50ZWQgaW4gY29vcGVyYXRpb24gd2l0aCB0aGUKICBgRW1iZXIuQ29weWFi
        bGVgIHByb3RvY29sLCB3aGljaCBkZWZpbmVzIGEgYGZyb3plbkNvcHkoKWAg
        bWV0aG9kIHRoYXQgd2lsbAogIHJldHVybiBhIGZyb3plbiBvYmplY3QsIGlm
        IHRoZSBvYmplY3QgaW1wbGVtZW50cyB0aGlzIG1ldGhvZCBhcyB3ZWxsLgoK
        ICBAY2xhc3MgRnJlZXphYmxlCiAgQG5hbWVzcGFjZSBFbWJlcgogIEBzaW5j
        ZSBFbWJlciAwLjkKKi8KRW1iZXIuRnJlZXphYmxlID0gRW1iZXIuTWl4aW4u
        Y3JlYXRlKC8qKiBAc2NvcGUgRW1iZXIuRnJlZXphYmxlLnByb3RvdHlwZSAq
        LyB7CgogIC8qKgogICAgU2V0IHRvIGB0cnVlYCB3aGVuIHRoZSBvYmplY3Qg
        aXMgZnJvemVuLiBVc2UgdGhpcyBwcm9wZXJ0eSB0byBkZXRlY3QKICAgIHdo
        ZXRoZXIgeW91ciBvYmplY3QgaXMgZnJvemVuIG9yIG5vdC4KCiAgICBAcHJv
        cGVydHkgaXNGcm96ZW4KICAgIEB0eXBlIEJvb2xlYW4KICAqLwogIGlzRnJv
        emVuOiBmYWxzZSwKCiAgLyoqCiAgICBGcmVlemVzIHRoZSBvYmplY3QuIE9u
        Y2UgdGhpcyBtZXRob2QgaGFzIGJlZW4gY2FsbGVkIHRoZSBvYmplY3Qgc2hv
        dWxkCiAgICBubyBsb25nZXIgYWxsb3cgYW55IHByb3BlcnRpZXMgdG8gYmUg
        ZWRpdGVkLgoKICAgIEBtZXRob2QgZnJlZXplCiAgICBAcmV0dXJuIHtPYmpl
        Y3R9IHJlY2VpdmVyCiAgKi8KICBmcmVlemU6IGZ1bmN0aW9uKCkgewogICAg
        aWYgKGdldCh0aGlzLCAnaXNGcm96ZW4nKSkgcmV0dXJuIHRoaXM7CiAgICBz
        ZXQodGhpcywgJ2lzRnJvemVuJywgdHJ1ZSk7CiAgICByZXR1cm4gdGhpczsK
        ICB9Cgp9KTsKCkVtYmVyLkZST1pFTl9FUlJPUiA9ICJGcm96ZW4gb2JqZWN0
        IGNhbm5vdCBiZSBtb2RpZmllZC4iOwoKfSkoKTsKCgoKKGZ1bmN0aW9uKCkg
        ewovKioKQG1vZHVsZSBlbWJlcgpAc3VibW9kdWxlIGVtYmVyLXJ1bnRpbWUK
        Ki8KCnZhciBmb3JFYWNoID0gRW1iZXIuRW51bWVyYWJsZVV0aWxzLmZvckVh
        Y2g7CgovKioKICBUaGlzIG1peGluIGRlZmluZXMgdGhlIEFQSSBmb3IgbW9k
        aWZ5aW5nIGdlbmVyaWMgZW51bWVyYWJsZXMuIFRoZXNlIG1ldGhvZHMKICBj
        YW4gYmUgYXBwbGllZCB0byBhbiBvYmplY3QgcmVnYXJkbGVzcyBvZiB3aGV0
        aGVyIGl0IGlzIG9yZGVyZWQgb3IKICB1bm9yZGVyZWQuCgogIE5vdGUgdGhh
        dCBhbiBFbnVtZXJhYmxlIGNhbiBjaGFuZ2UgZXZlbiBpZiBpdCBkb2VzIG5v
        dCBpbXBsZW1lbnQgdGhpcyBtaXhpbi4KICBGb3IgZXhhbXBsZSwgYSBNYXBw
        ZWRFbnVtZXJhYmxlIGNhbm5vdCBiZSBkaXJlY3RseSBtb2RpZmllZCBidXQg
        aWYgaXRzCiAgdW5kZXJseWluZyBlbnVtZXJhYmxlIGNoYW5nZXMsIGl0IHdp
        bGwgY2hhbmdlIGFsc28uCgogICMjIEFkZGluZyBPYmplY3RzCgogIFRvIGFk
        ZCBhbiBvYmplY3QgdG8gYW4gZW51bWVyYWJsZSwgdXNlIHRoZSBgYWRkT2Jq
        ZWN0KClgIG1ldGhvZC4gVGhpcwogIG1ldGhvZCB3aWxsIG9ubHkgYWRkIHRo
        ZSBvYmplY3QgdG8gdGhlIGVudW1lcmFibGUgaWYgdGhlIG9iamVjdCBpcyBu
        b3QKICBhbHJlYWR5IHByZXNlbnQgYW5kIGlzIG9mIGEgdHlwZSBzdXBwb3J0
        ZWQgYnkgdGhlIGVudW1lcmFibGUuCgogIGBgYGphdmFzY3JpcHQKICBzZXQu
        YWRkT2JqZWN0KGNvbnRhY3QpOwogIGBgYAoKICAjIyBSZW1vdmluZyBPYmpl
        Y3RzCgogIFRvIHJlbW92ZSBhbiBvYmplY3QgZnJvbSBhbiBlbnVtZXJhYmxl
        LCB1c2UgdGhlIGByZW1vdmVPYmplY3QoKWAgbWV0aG9kLiBUaGlzCiAgd2ls
        bCBvbmx5IHJlbW92ZSB0aGUgb2JqZWN0IGlmIGl0IGlzIHByZXNlbnQgaW4g
        dGhlIGVudW1lcmFibGUsIG90aGVyd2lzZQogIHRoaXMgbWV0aG9kIGhhcyBu
        byBlZmZlY3QuCgogIGBgYGphdmFzY3JpcHQKICBzZXQucmVtb3ZlT2JqZWN0
        KGNvbnRhY3QpOwogIGBgYAoKICAjIyBJbXBsZW1lbnRpbmcgSW4gWW91ciBP
        d24gQ29kZQoKICBJZiB5b3UgYXJlIGltcGxlbWVudGluZyBhbiBvYmplY3Qg
        YW5kIHdhbnQgdG8gc3VwcG9ydCB0aGlzIEFQSSwganVzdCBpbmNsdWRlCiAg
        dGhpcyBtaXhpbiBpbiB5b3VyIGNsYXNzIGFuZCBpbXBsZW1lbnQgdGhlIHJl
        cXVpcmVkIG1ldGhvZHMuIEluIHlvdXIgdW5pdAogIHRlc3RzLCBiZSBzdXJl
        IHRvIGFwcGx5IHRoZSBFbWJlci5NdXRhYmxlRW51bWVyYWJsZVRlc3RzIHRv
        IHlvdXIgb2JqZWN0LgoKICBAY2xhc3MgTXV0YWJsZUVudW1lcmFibGUKICBA
        bmFtZXNwYWNlIEVtYmVyCiAgQHVzZXMgRW1iZXIuRW51bWVyYWJsZQoqLwpF
        bWJlci5NdXRhYmxlRW51bWVyYWJsZSA9IEVtYmVyLk1peGluLmNyZWF0ZShF
        bWJlci5FbnVtZXJhYmxlLCB7CgogIC8qKgogICAgX19SZXF1aXJlZC5fXyBZ
        b3UgbXVzdCBpbXBsZW1lbnQgdGhpcyBtZXRob2QgdG8gYXBwbHkgdGhpcyBt
        aXhpbi4KCiAgICBBdHRlbXB0cyB0byBhZGQgdGhlIHBhc3NlZCBvYmplY3Qg
        dG8gdGhlIHJlY2VpdmVyIGlmIHRoZSBvYmplY3QgaXMgbm90CiAgICBhbHJl
        YWR5IHByZXNlbnQgaW4gdGhlIGNvbGxlY3Rpb24uIElmIHRoZSBvYmplY3Qg
        aXMgcHJlc2VudCwgdGhpcyBtZXRob2QKICAgIGhhcyBubyBlZmZlY3QuCgog
        ICAgSWYgdGhlIHBhc3NlZCBvYmplY3QgaXMgb2YgYSB0eXBlIG5vdCBzdXBw
        b3J0ZWQgYnkgdGhlIHJlY2VpdmVyLAogICAgdGhlbiB0aGlzIG1ldGhvZCBz
        aG91bGQgcmFpc2UgYW4gZXhjZXB0aW9uLgoKICAgIEBtZXRob2QgYWRkT2Jq
        ZWN0CiAgICBAcGFyYW0ge09iamVjdH0gb2JqZWN0IFRoZSBvYmplY3QgdG8g
        YWRkIHRvIHRoZSBlbnVtZXJhYmxlLgogICAgQHJldHVybiB7T2JqZWN0fSB0
        aGUgcGFzc2VkIG9iamVjdAogICovCiAgYWRkT2JqZWN0OiBFbWJlci5yZXF1
        aXJlZChGdW5jdGlvbiksCgogIC8qKgogICAgQWRkcyBlYWNoIG9iamVjdCBp
        biB0aGUgcGFzc2VkIGVudW1lcmFibGUgdG8gdGhlIHJlY2VpdmVyLgoKICAg
        IEBtZXRob2QgYWRkT2JqZWN0cwogICAgQHBhcmFtIHtFbWJlci5FbnVtZXJh
        YmxlfSBvYmplY3RzIHRoZSBvYmplY3RzIHRvIGFkZC4KICAgIEByZXR1cm4g
        e09iamVjdH0gcmVjZWl2ZXIKICAqLwogIGFkZE9iamVjdHM6IGZ1bmN0aW9u
        KG9iamVjdHMpIHsKICAgIEVtYmVyLmJlZ2luUHJvcGVydHlDaGFuZ2VzKHRo
        aXMpOwogICAgZm9yRWFjaChvYmplY3RzLCBmdW5jdGlvbihvYmopIHsgdGhp
        cy5hZGRPYmplY3Qob2JqKTsgfSwgdGhpcyk7CiAgICBFbWJlci5lbmRQcm9w
        ZXJ0eUNoYW5nZXModGhpcyk7CiAgICByZXR1cm4gdGhpczsKICB9LAoKICAv
        KioKICAgIF9fUmVxdWlyZWQuX18gWW91IG11c3QgaW1wbGVtZW50IHRoaXMg
        bWV0aG9kIHRvIGFwcGx5IHRoaXMgbWl4aW4uCgogICAgQXR0ZW1wdHMgdG8g
        cmVtb3ZlIHRoZSBwYXNzZWQgb2JqZWN0IGZyb20gdGhlIHJlY2VpdmVyIGNv
        bGxlY3Rpb24gaWYgdGhlCiAgICBvYmplY3QgaXMgcHJlc2VudCBpbiB0aGUg
        Y29sbGVjdGlvbi4gSWYgdGhlIG9iamVjdCBpcyBub3QgcHJlc2VudCwKICAg
        IHRoaXMgbWV0aG9kIGhhcyBubyBlZmZlY3QuCgogICAgSWYgdGhlIHBhc3Nl
        ZCBvYmplY3QgaXMgb2YgYSB0eXBlIG5vdCBzdXBwb3J0ZWQgYnkgdGhlIHJl
        Y2VpdmVyLAogICAgdGhlbiB0aGlzIG1ldGhvZCBzaG91bGQgcmFpc2UgYW4g
        ZXhjZXB0aW9uLgoKICAgIEBtZXRob2QgcmVtb3ZlT2JqZWN0CiAgICBAcGFy
        YW0ge09iamVjdH0gb2JqZWN0IFRoZSBvYmplY3QgdG8gcmVtb3ZlIGZyb20g
        dGhlIGVudW1lcmFibGUuCiAgICBAcmV0dXJuIHtPYmplY3R9IHRoZSBwYXNz
        ZWQgb2JqZWN0CiAgKi8KICByZW1vdmVPYmplY3Q6IEVtYmVyLnJlcXVpcmVk
        KEZ1bmN0aW9uKSwKCgogIC8qKgogICAgUmVtb3ZlcyBlYWNoIG9iamVjdCBp
        biB0aGUgcGFzc2VkIGVudW1lcmFibGUgZnJvbSB0aGUgcmVjZWl2ZXIuCgog
        ICAgQG1ldGhvZCByZW1vdmVPYmplY3RzCiAgICBAcGFyYW0ge0VtYmVyLkVu
        dW1lcmFibGV9IG9iamVjdHMgdGhlIG9iamVjdHMgdG8gcmVtb3ZlCiAgICBA
        cmV0dXJuIHtPYmplY3R9IHJlY2VpdmVyCiAgKi8KICByZW1vdmVPYmplY3Rz
        OiBmdW5jdGlvbihvYmplY3RzKSB7CiAgICBFbWJlci5iZWdpblByb3BlcnR5
        Q2hhbmdlcyh0aGlzKTsKICAgIGZvckVhY2gob2JqZWN0cywgZnVuY3Rpb24o
        b2JqKSB7IHRoaXMucmVtb3ZlT2JqZWN0KG9iaik7IH0sIHRoaXMpOwogICAg
        RW1iZXIuZW5kUHJvcGVydHlDaGFuZ2VzKHRoaXMpOwogICAgcmV0dXJuIHRo
        aXM7CiAgfQoKfSk7Cgp9KSgpOwoKCgooZnVuY3Rpb24oKSB7Ci8qKgpAbW9k
        dWxlIGVtYmVyCkBzdWJtb2R1bGUgZW1iZXItcnVudGltZQoqLwovLyAuLi4u
        Li4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4u
        Li4uLi4uLi4uCi8vIENPTlNUQU5UUwovLwoKdmFyIE9VVF9PRl9SQU5HRV9F
        WENFUFRJT04gPSAiSW5kZXggb3V0IG9mIHJhbmdlIiA7CnZhciBFTVBUWSA9
        IFtdOwoKLy8gLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4u
        Li4uLi4uLi4uLi4uLi4uLi4uLi4uLgovLyBIRUxQRVJTCi8vCgp2YXIgZ2V0
        ID0gRW1iZXIuZ2V0LCBzZXQgPSBFbWJlci5zZXQ7CgovKioKICBUaGlzIG1p
        eGluIGRlZmluZXMgdGhlIEFQSSBmb3IgbW9kaWZ5aW5nIGFycmF5LWxpa2Ug
        b2JqZWN0cy4gVGhlc2UgbWV0aG9kcwogIGNhbiBiZSBhcHBsaWVkIG9ubHkg
        dG8gYSBjb2xsZWN0aW9uIHRoYXQga2VlcHMgaXRzIGl0ZW1zIGluIGFuIG9y
        ZGVyZWQgc2V0LgoKICBOb3RlIHRoYXQgYW4gQXJyYXkgY2FuIGNoYW5nZSBl
        dmVuIGlmIGl0IGRvZXMgbm90IGltcGxlbWVudCB0aGlzIG1peGluLgogIEZv
        ciBleGFtcGxlLCBvbmUgbWlnaHQgaW1wbGVtZW50IGEgU3BhcnNlQXJyYXkg
        dGhhdCBjYW5ub3QgYmUgZGlyZWN0bHkKICBtb2RpZmllZCwgYnV0IGlmIGl0
        cyB1bmRlcmx5aW5nIGVudW1lcmFibGUgY2hhbmdlcywgaXQgd2lsbCBjaGFu
        Z2UgYWxzby4KCiAgQGNsYXNzIE11dGFibGVBcnJheQogIEBuYW1lc3BhY2Ug
        RW1iZXIKICBAdXNlcyBFbWJlci5BcnJheQogIEB1c2VzIEVtYmVyLk11dGFi
        bGVFbnVtZXJhYmxlCiovCkVtYmVyLk11dGFibGVBcnJheSA9IEVtYmVyLk1p
        eGluLmNyZWF0ZShFbWJlci5BcnJheSwgRW1iZXIuTXV0YWJsZUVudW1lcmFi
        bGUsLyoqIEBzY29wZSBFbWJlci5NdXRhYmxlQXJyYXkucHJvdG90eXBlICov
        IHsKCiAgLyoqCiAgICBfX1JlcXVpcmVkLl9fIFlvdSBtdXN0IGltcGxlbWVu
        dCB0aGlzIG1ldGhvZCB0byBhcHBseSB0aGlzIG1peGluLgoKICAgIFRoaXMg
        aXMgb25lIG9mIHRoZSBwcmltaXRpdmVzIHlvdSBtdXN0IGltcGxlbWVudCB0
        byBzdXBwb3J0IGBFbWJlci5BcnJheWAuCiAgICBZb3Ugc2hvdWxkIHJlcGxh
        Y2UgYW10IG9iamVjdHMgc3RhcnRlZCBhdCBpZHggd2l0aCB0aGUgb2JqZWN0
        cyBpbiB0aGUKICAgIHBhc3NlZCBhcnJheS4gWW91IHNob3VsZCBhbHNvIGNh
        bGwgYHRoaXMuZW51bWVyYWJsZUNvbnRlbnREaWRDaGFuZ2UoKWAKCiAgICBA
        bWV0aG9kIHJlcGxhY2UKICAgIEBwYXJhbSB7TnVtYmVyfSBpZHggU3RhcnRp
        bmcgaW5kZXggaW4gdGhlIGFycmF5IHRvIHJlcGxhY2UuIElmCiAgICAgIGlk
        eCA+PSBsZW5ndGgsIHRoZW4gYXBwZW5kIHRvIHRoZSBlbmQgb2YgdGhlIGFy
        cmF5LgogICAgQHBhcmFtIHtOdW1iZXJ9IGFtdCBOdW1iZXIgb2YgZWxlbWVu
        dHMgdGhhdCBzaG91bGQgYmUgcmVtb3ZlZCBmcm9tCiAgICAgIHRoZSBhcnJh
        eSwgc3RhcnRpbmcgYXQgKmlkeCouCiAgICBAcGFyYW0ge0FycmF5fSBvYmpl
        Y3RzIEFuIGFycmF5IG9mIHplcm8gb3IgbW9yZSBvYmplY3RzIHRoYXQgc2hv
        dWxkIGJlCiAgICAgIGluc2VydGVkIGludG8gdGhlIGFycmF5IGF0ICppZHgq
        CiAgKi8KICByZXBsYWNlOiBFbWJlci5yZXF1aXJlZCgpLAoKICAvKioKICAg
        IFJlbW92ZSBhbGwgZWxlbWVudHMgZnJvbSBzZWxmLiBUaGlzIGlzIHVzZWZ1
        bCBpZiB5b3UKICAgIHdhbnQgdG8gcmV1c2UgYW4gZXhpc3RpbmcgYXJyYXkg
        d2l0aG91dCBoYXZpbmcgdG8gcmVjcmVhdGUgaXQuCgogICAgYGBgamF2YXNj
        cmlwdAogICAgdmFyIGNvbG9ycyA9IFsicmVkIiwgImdyZWVuIiwgImJsdWUi
        XTsKICAgIGNvbG9yLmxlbmd0aCgpOyAgIC8vICAzCiAgICBjb2xvcnMuY2xl
        YXIoKTsgICAvLyAgW10KICAgIGNvbG9ycy5sZW5ndGgoKTsgIC8vICAwCiAg
        ICBgYGAKCiAgICBAbWV0aG9kIGNsZWFyCiAgICBAcmV0dXJuIHtFbWJlci5B
        cnJheX0gQW4gZW1wdHkgQXJyYXkuCiAgKi8KICBjbGVhcjogZnVuY3Rpb24g
        KCkgewogICAgdmFyIGxlbiA9IGdldCh0aGlzLCAnbGVuZ3RoJyk7CiAgICBp
        ZiAobGVuID09PSAwKSByZXR1cm4gdGhpczsKICAgIHRoaXMucmVwbGFjZSgw
        LCBsZW4sIEVNUFRZKTsKICAgIHJldHVybiB0aGlzOwogIH0sCgogIC8qKgog
        ICAgVGhpcyB3aWxsIHVzZSB0aGUgcHJpbWl0aXZlIGByZXBsYWNlKClgIG1l
        dGhvZCB0byBpbnNlcnQgYW4gb2JqZWN0IGF0IHRoZQogICAgc3BlY2lmaWVk
        IGluZGV4LgoKICAgIGBgYGphdmFzY3JpcHQKICAgIHZhciBjb2xvcnMgPSBb
        InJlZCIsICJncmVlbiIsICJibHVlIl07CiAgICBjb2xvcnMuaW5zZXJ0QXQo
        MiwgInllbGxvdyIpOyAgLy8gWyJyZWQiLCAiZ3JlZW4iLCAieWVsbG93Iiwg
        ImJsdWUiXQogICAgY29sb3JzLmluc2VydEF0KDUsICJvcmFuZ2UiKTsgIC8v
        IEVycm9yOiBJbmRleCBvdXQgb2YgcmFuZ2UKICAgIGBgYAoKICAgIEBtZXRo
        b2QgaW5zZXJ0QXQKICAgIEBwYXJhbSB7TnVtYmVyfSBpZHggaW5kZXggb2Yg
        aW5zZXJ0IHRoZSBvYmplY3QgYXQuCiAgICBAcGFyYW0ge09iamVjdH0gb2Jq
        ZWN0IG9iamVjdCB0byBpbnNlcnQKICAgIEByZXR1cm4gdGhpcwogICovCiAg
        aW5zZXJ0QXQ6IGZ1bmN0aW9uKGlkeCwgb2JqZWN0KSB7CiAgICBpZiAoaWR4
        ID4gZ2V0KHRoaXMsICdsZW5ndGgnKSkgdGhyb3cgbmV3IEVtYmVyLkVycm9y
        KE9VVF9PRl9SQU5HRV9FWENFUFRJT04pIDsKICAgIHRoaXMucmVwbGFjZShp
        ZHgsIDAsIFtvYmplY3RdKSA7CiAgICByZXR1cm4gdGhpcyA7CiAgfSwKCiAg
        LyoqCiAgICBSZW1vdmUgYW4gb2JqZWN0IGF0IHRoZSBzcGVjaWZpZWQgaW5k
        ZXggdXNpbmcgdGhlIGByZXBsYWNlKClgIHByaW1pdGl2ZQogICAgbWV0aG9k
        LiBZb3UgY2FuIHBhc3MgZWl0aGVyIGEgc2luZ2xlIGluZGV4LCBvciBhIHN0
        YXJ0IGFuZCBhIGxlbmd0aC4KCiAgICBJZiB5b3UgcGFzcyBhIHN0YXJ0IGFu
        ZCBsZW5ndGggdGhhdCBpcyBiZXlvbmQgdGhlCiAgICBsZW5ndGggdGhpcyBt
        ZXRob2Qgd2lsbCB0aHJvdyBhbiBgT1VUX09GX1JBTkdFX0VYQ0VQVElPTmAK
        CiAgICBgYGBqYXZhc2NyaXB0CiAgICB2YXIgY29sb3JzID0gWyJyZWQiLCAi
        Z3JlZW4iLCAiYmx1ZSIsICJ5ZWxsb3ciLCAib3JhbmdlIl07CiAgICBjb2xv
        cnMucmVtb3ZlQXQoMCk7ICAgICAvLyBbImdyZWVuIiwgImJsdWUiLCAieWVs
        bG93IiwgIm9yYW5nZSJdCiAgICBjb2xvcnMucmVtb3ZlQXQoMiwgMik7ICAv
        LyBbImdyZWVuIiwgImJsdWUiXQogICAgY29sb3JzLnJlbW92ZUF0KDQsIDIp
        OyAgLy8gRXJyb3I6IEluZGV4IG91dCBvZiByYW5nZQogICAgYGBgCgogICAg
        QG1ldGhvZCByZW1vdmVBdAogICAgQHBhcmFtIHtOdW1iZXJ9IHN0YXJ0IGlu
        ZGV4LCBzdGFydCBvZiByYW5nZQogICAgQHBhcmFtIHtOdW1iZXJ9IGxlbiBs
        ZW5ndGggb2YgcGFzc2luZyByYW5nZQogICAgQHJldHVybiB7T2JqZWN0fSBy
        ZWNlaXZlcgogICovCiAgcmVtb3ZlQXQ6IGZ1bmN0aW9uKHN0YXJ0LCBsZW4p
        IHsKICAgIGlmICgnbnVtYmVyJyA9PT0gdHlwZW9mIHN0YXJ0KSB7CgogICAg
        ICBpZiAoKHN0YXJ0IDwgMCkgfHwgKHN0YXJ0ID49IGdldCh0aGlzLCAnbGVu
        Z3RoJykpKSB7CiAgICAgICAgdGhyb3cgbmV3IEVtYmVyLkVycm9yKE9VVF9P
        Rl9SQU5HRV9FWENFUFRJT04pOwogICAgICB9CgogICAgICAvLyBmYXN0IGNh
        c2UKICAgICAgaWYgKGxlbiA9PT0gdW5kZWZpbmVkKSBsZW4gPSAxOwogICAg
        ICB0aGlzLnJlcGxhY2Uoc3RhcnQsIGxlbiwgRU1QVFkpOwogICAgfQoKICAg
        IHJldHVybiB0aGlzIDsKICB9LAoKICAvKioKICAgIFB1c2ggdGhlIG9iamVj
        dCBvbnRvIHRoZSBlbmQgb2YgdGhlIGFycmF5LiBXb3JrcyBqdXN0IGxpa2Ug
        YHB1c2goKWAgYnV0IGl0CiAgICBpcyBLVk8tY29tcGxpYW50LgoKICAgIGBg
        YGphdmFzY3JpcHQKICAgIHZhciBjb2xvcnMgPSBbInJlZCIsICJncmVlbiIs
        ICJibHVlIl07CiAgICBjb2xvcnMucHVzaE9iamVjdCgiYmxhY2siKTsgICAg
        ICAgICAgICAgICAvLyBbInJlZCIsICJncmVlbiIsICJibHVlIiwgImJsYWNr
        Il0KICAgIGNvbG9ycy5wdXNoT2JqZWN0KFsieWVsbG93IiwgIm9yYW5nZSJd
        KTsgIC8vIFsicmVkIiwgImdyZWVuIiwgImJsdWUiLCAiYmxhY2siLCBbInll
        bGxvdyIsICJvcmFuZ2UiXV0KICAgIGBgYAoKICAgIEBtZXRob2QgcHVzaE9i
        amVjdAogICAgQHBhcmFtIHsqfSBvYmogb2JqZWN0IHRvIHB1c2gKICAgIEBy
        ZXR1cm4geyp9IHRoZSBzYW1lIG9iaiBwYXNzZWQgYXMgcGFyYW0KICAqLwog
        IHB1c2hPYmplY3Q6IGZ1bmN0aW9uKG9iaikgewogICAgdGhpcy5pbnNlcnRB
        dChnZXQodGhpcywgJ2xlbmd0aCcpLCBvYmopIDsKICAgIHJldHVybiBvYmog
        OwogIH0sCgogIC8qKgogICAgQWRkIHRoZSBvYmplY3RzIGluIHRoZSBwYXNz
        ZWQgbnVtZXJhYmxlIHRvIHRoZSBlbmQgb2YgdGhlIGFycmF5LiBEZWZlcnMK
        ICAgIG5vdGlmeWluZyBvYnNlcnZlcnMgb2YgdGhlIGNoYW5nZSB1bnRpbCBh
        bGwgb2JqZWN0cyBhcmUgYWRkZWQuCgogICAgYGBgamF2YXNjcmlwdAogICAg
        dmFyIGNvbG9ycyA9IFsicmVkIiwgImdyZWVuIiwgImJsdWUiXTsKICAgIGNv
        bG9ycy5wdXNoT2JqZWN0cyhbImJsYWNrIl0pOyAgICAgICAgICAgICAgIC8v
        IFsicmVkIiwgImdyZWVuIiwgImJsdWUiLCAiYmxhY2siXQogICAgY29sb3Jz
        LnB1c2hPYmplY3RzKFsieWVsbG93IiwgIm9yYW5nZSJdKTsgIC8vIFsicmVk
        IiwgImdyZWVuIiwgImJsdWUiLCAiYmxhY2siLCAieWVsbG93IiwgIm9yYW5n
        ZSJdCiAgICBgYGAKCiAgICBAbWV0aG9kIHB1c2hPYmplY3RzCiAgICBAcGFy
        YW0ge0VtYmVyLkVudW1lcmFibGV9IG9iamVjdHMgdGhlIG9iamVjdHMgdG8g
        YWRkCiAgICBAcmV0dXJuIHtFbWJlci5BcnJheX0gcmVjZWl2ZXIKICAqLwog
        IHB1c2hPYmplY3RzOiBmdW5jdGlvbihvYmplY3RzKSB7CiAgICBpZiAoIShF
        bWJlci5FbnVtZXJhYmxlLmRldGVjdChvYmplY3RzKSB8fCBFbWJlci5pc0Fy
        cmF5KG9iamVjdHMpKSkgewogICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCJN
        dXN0IHBhc3MgRW1iZXIuRW51bWVyYWJsZSB0byBFbWJlci5NdXRhYmxlQXJy
        YXkjcHVzaE9iamVjdHMiKTsKICAgIH0KICAgIHRoaXMucmVwbGFjZShnZXQo
        dGhpcywgJ2xlbmd0aCcpLCAwLCBvYmplY3RzKTsKICAgIHJldHVybiB0aGlz
        OwogIH0sCgogIC8qKgogICAgUG9wIG9iamVjdCBmcm9tIGFycmF5IG9yIG5p
        bCBpZiBub25lIGFyZSBsZWZ0LiBXb3JrcyBqdXN0IGxpa2UgYHBvcCgpYCBi
        dXQKICAgIGl0IGlzIEtWTy1jb21wbGlhbnQuCgogICAgYGBgamF2YXNjcmlw
        dAogICAgdmFyIGNvbG9ycyA9IFsicmVkIiwgImdyZWVuIiwgImJsdWUiXTsK
        ICAgIGNvbG9ycy5wb3BPYmplY3QoKTsgICAvLyAiYmx1ZSIKICAgIGNvbnNv
        bGUubG9nKGNvbG9ycyk7ICAvLyBbInJlZCIsICJncmVlbiJdCiAgICBgYGAK
        CiAgICBAbWV0aG9kIHBvcE9iamVjdAogICAgQHJldHVybiBvYmplY3QKICAq
        LwogIHBvcE9iamVjdDogZnVuY3Rpb24oKSB7CiAgICB2YXIgbGVuID0gZ2V0
        KHRoaXMsICdsZW5ndGgnKSA7CiAgICBpZiAobGVuID09PSAwKSByZXR1cm4g
        bnVsbCA7CgogICAgdmFyIHJldCA9IHRoaXMub2JqZWN0QXQobGVuLTEpIDsK
        ICAgIHRoaXMucmVtb3ZlQXQobGVuLTEsIDEpIDsKICAgIHJldHVybiByZXQg
        OwogIH0sCgogIC8qKgogICAgU2hpZnQgYW4gb2JqZWN0IGZyb20gc3RhcnQg
        b2YgYXJyYXkgb3IgbmlsIGlmIG5vbmUgYXJlIGxlZnQuIFdvcmtzIGp1c3QK
        ICAgIGxpa2UgYHNoaWZ0KClgIGJ1dCBpdCBpcyBLVk8tY29tcGxpYW50LgoK
        ICAgIGBgYGphdmFzY3JpcHQKICAgIHZhciBjb2xvcnMgPSBbInJlZCIsICJn
        cmVlbiIsICJibHVlIl07CiAgICBjb2xvcnMuc2hpZnRPYmplY3QoKTsgIC8v
        ICJyZWQiCiAgICBjb25zb2xlLmxvZyhjb2xvcnMpOyAgIC8vIFsiZ3JlZW4i
        LCAiYmx1ZSJdCiAgICBgYGAKCiAgICBAbWV0aG9kIHNoaWZ0T2JqZWN0CiAg
        ICBAcmV0dXJuIG9iamVjdAogICovCiAgc2hpZnRPYmplY3Q6IGZ1bmN0aW9u
        KCkgewogICAgaWYgKGdldCh0aGlzLCAnbGVuZ3RoJykgPT09IDApIHJldHVy
        biBudWxsIDsKICAgIHZhciByZXQgPSB0aGlzLm9iamVjdEF0KDApIDsKICAg
        IHRoaXMucmVtb3ZlQXQoMCkgOwogICAgcmV0dXJuIHJldCA7CiAgfSwKCiAg
        LyoqCiAgICBVbnNoaWZ0IGFuIG9iamVjdCB0byBzdGFydCBvZiBhcnJheS4g
        V29ya3MganVzdCBsaWtlIGB1bnNoaWZ0KClgIGJ1dCBpdCBpcwogICAgS1ZP
        LWNvbXBsaWFudC4KCiAgICBgYGBqYXZhc2NyaXB0CiAgICB2YXIgY29sb3Jz
        ID0gWyJyZWQiLCAiZ3JlZW4iLCAiYmx1ZSJdOwogICAgY29sb3JzLnVuc2hp
        ZnRPYmplY3QoInllbGxvdyIpOyAgICAgICAgICAgICAvLyBbInllbGxvdyIs
        ICJyZWQiLCAiZ3JlZW4iLCAiYmx1ZSJdCiAgICBjb2xvcnMudW5zaGlmdE9i
        amVjdChbImJsYWNrIiwgIndoaXRlIl0pOyAgIC8vIFtbImJsYWNrIiwgIndo
        aXRlIl0sICJ5ZWxsb3ciLCAicmVkIiwgImdyZWVuIiwgImJsdWUiXQogICAg
        YGBgCgogICAgQG1ldGhvZCB1bnNoaWZ0T2JqZWN0CiAgICBAcGFyYW0geyp9
        IG9iaiBvYmplY3QgdG8gdW5zaGlmdAogICAgQHJldHVybiB7Kn0gdGhlIHNh
        bWUgb2JqIHBhc3NlZCBhcyBwYXJhbQogICovCiAgdW5zaGlmdE9iamVjdDog
        ZnVuY3Rpb24ob2JqKSB7CiAgICB0aGlzLmluc2VydEF0KDAsIG9iaikgOwog
        ICAgcmV0dXJuIG9iaiA7CiAgfSwKCiAgLyoqCiAgICBBZGRzIHRoZSBuYW1l
        ZCBvYmplY3RzIHRvIHRoZSBiZWdpbm5pbmcgb2YgdGhlIGFycmF5LiBEZWZl
        cnMgbm90aWZ5aW5nCiAgICBvYnNlcnZlcnMgdW50aWwgYWxsIG9iamVjdHMg
        aGF2ZSBiZWVuIGFkZGVkLgoKICAgIGBgYGphdmFzY3JpcHQKICAgIHZhciBj
        b2xvcnMgPSBbInJlZCIsICJncmVlbiIsICJibHVlIl07CiAgICBjb2xvcnMu
        dW5zaGlmdE9iamVjdHMoWyJibGFjayIsICJ3aGl0ZSJdKTsgICAvLyBbImJs
        YWNrIiwgIndoaXRlIiwgInJlZCIsICJncmVlbiIsICJibHVlIl0KICAgIGNv
        bG9ycy51bnNoaWZ0T2JqZWN0cygieWVsbG93Iik7ICAgICAgICAgICAgIC8v
        IFR5cGUgRXJyb3I6ICd1bmRlZmluZWQnIGlzIG5vdCBhIGZ1bmN0aW9uCiAg
        ICBgYGAKCiAgICBAbWV0aG9kIHVuc2hpZnRPYmplY3RzCiAgICBAcGFyYW0g
        e0VtYmVyLkVudW1lcmFibGV9IG9iamVjdHMgdGhlIG9iamVjdHMgdG8gYWRk
        CiAgICBAcmV0dXJuIHtFbWJlci5BcnJheX0gcmVjZWl2ZXIKICAqLwogIHVu
        c2hpZnRPYmplY3RzOiBmdW5jdGlvbihvYmplY3RzKSB7CiAgICB0aGlzLnJl
        cGxhY2UoMCwgMCwgb2JqZWN0cyk7CiAgICByZXR1cm4gdGhpczsKICB9LAoK
        ICAvKioKICAgIFJldmVyc2Ugb2JqZWN0cyBpbiB0aGUgYXJyYXkuIFdvcmtz
        IGp1c3QgbGlrZSBgcmV2ZXJzZSgpYCBidXQgaXQgaXMKICAgIEtWTy1jb21w
        bGlhbnQuCgogICAgQG1ldGhvZCByZXZlcnNlT2JqZWN0cwogICAgQHJldHVy
        biB7RW1iZXIuQXJyYXl9IHJlY2VpdmVyCiAgICovCiAgcmV2ZXJzZU9iamVj
        dHM6IGZ1bmN0aW9uKCkgewogICAgdmFyIGxlbiA9IGdldCh0aGlzLCAnbGVu
        Z3RoJyk7CiAgICBpZiAobGVuID09PSAwKSByZXR1cm4gdGhpczsKICAgIHZh
        ciBvYmplY3RzID0gdGhpcy50b0FycmF5KCkucmV2ZXJzZSgpOwogICAgdGhp
        cy5yZXBsYWNlKDAsIGxlbiwgb2JqZWN0cyk7CiAgICByZXR1cm4gdGhpczsK
        ICB9LAoKICAvKioKICAgIFJlcGxhY2UgYWxsIHRoZSB0aGUgcmVjZWl2ZXIn
        cyBjb250ZW50IHdpdGggY29udGVudCBvZiB0aGUgYXJndW1lbnQuCiAgICBJ
        ZiBhcmd1bWVudCBpcyBhbiBlbXB0eSBhcnJheSByZWNlaXZlciB3aWxsIGJl
        IGNsZWFyZWQuCgogICAgYGBgamF2YXNjcmlwdAogICAgdmFyIGNvbG9ycyA9
        IFsicmVkIiwgImdyZWVuIiwgImJsdWUiXTsKICAgIGNvbG9ycy5zZXRPYmpl
        Y3RzKFsiYmxhY2siLCAid2hpdGUiXSk7ICAvLyBbImJsYWNrIiwgIndoaXRl
        Il0KICAgIGNvbG9ycy5zZXRPYmplY3RzKFtdKTsgICAgICAgICAgICAgICAg
        ICAvLyBbXQogICAgYGBgCgogICAgQG1ldGhvZCBzZXRPYmplY3RzCiAgICBA
        cGFyYW0ge0VtYmVyLkFycmF5fSBvYmplY3RzIGFycmF5IHdob3NlIGNvbnRl
        bnQgd2lsbCBiZSB1c2VkIGZvciByZXBsYWNpbmcKICAgICAgICB0aGUgY29u
        dGVudCBvZiB0aGUgcmVjZWl2ZXIKICAgIEByZXR1cm4ge0VtYmVyLkFycmF5
        fSByZWNlaXZlciB3aXRoIHRoZSBuZXcgY29udGVudAogICAqLwogIHNldE9i
        amVjdHM6IGZ1bmN0aW9uKG9iamVjdHMpIHsKICAgIGlmIChvYmplY3RzLmxl
        bmd0aCA9PT0gMCkgcmV0dXJuIHRoaXMuY2xlYXIoKTsKCiAgICB2YXIgbGVu
        ID0gZ2V0KHRoaXMsICdsZW5ndGgnKTsKICAgIHRoaXMucmVwbGFjZSgwLCBs
        ZW4sIG9iamVjdHMpOwogICAgcmV0dXJuIHRoaXM7CiAgfSwKCiAgLy8gLi4u
        Li4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4u
        Li4uLi4uLi4uLgogIC8vIElNUExFTUVOVCBFbWJlci5NdXRhYmxlRW51bWVy
        YWJsZQogIC8vCgogIHJlbW92ZU9iamVjdDogZnVuY3Rpb24ob2JqKSB7CiAg
        ICB2YXIgbG9jID0gZ2V0KHRoaXMsICdsZW5ndGgnKSB8fCAwOwogICAgd2hp
        bGUoLS1sb2MgPj0gMCkgewogICAgICB2YXIgY3VyT2JqZWN0ID0gdGhpcy5v
        YmplY3RBdChsb2MpIDsKICAgICAgaWYgKGN1ck9iamVjdCA9PT0gb2JqKSB0
        aGlzLnJlbW92ZUF0KGxvYykgOwogICAgfQogICAgcmV0dXJuIHRoaXMgOwog
        IH0sCgogIGFkZE9iamVjdDogZnVuY3Rpb24ob2JqKSB7CiAgICBpZiAoIXRo
        aXMuY29udGFpbnMob2JqKSkgdGhpcy5wdXNoT2JqZWN0KG9iaik7CiAgICBy
        ZXR1cm4gdGhpcyA7CiAgfQoKfSk7Cgp9KSgpOwoKCgooZnVuY3Rpb24oKSB7
        Ci8qKgpAbW9kdWxlIGVtYmVyCkBzdWJtb2R1bGUgZW1iZXItcnVudGltZQoq
        LwoKdmFyIGdldCA9IEVtYmVyLmdldCwKICAgIHNldCA9IEVtYmVyLnNldCwK
        ICAgIHNsaWNlID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLAogICAgZ2V0UHJv
        cGVydGllcyA9IEVtYmVyLmdldFByb3BlcnRpZXM7CgovKioKICAjIyBPdmVy
        dmlldwoKICBUaGlzIG1peGluIHByb3ZpZGVzIHByb3BlcnRpZXMgYW5kIHBy
        b3BlcnR5IG9ic2VydmluZyBmdW5jdGlvbmFsaXR5LCBjb3JlCiAgZmVhdHVy
        ZXMgb2YgdGhlIEVtYmVyIG9iamVjdCBtb2RlbC4KCiAgUHJvcGVydGllcyBh
        bmQgb2JzZXJ2ZXJzIGFsbG93IG9uZSBvYmplY3QgdG8gb2JzZXJ2ZSBjaGFu
        Z2VzIHRvIGEKICBwcm9wZXJ0eSBvbiBhbm90aGVyIG9iamVjdC4gVGhpcyBp
        cyBvbmUgb2YgdGhlIGZ1bmRhbWVudGFsIHdheXMgdGhhdAogIG1vZGVscywg
        Y29udHJvbGxlcnMgYW5kIHZpZXdzIGNvbW11bmljYXRlIHdpdGggZWFjaCBv
        dGhlciBpbiBhbiBFbWJlcgogIGFwcGxpY2F0aW9uLgoKICBBbnkgb2JqZWN0
        IHRoYXQgaGFzIHRoaXMgbWl4aW4gYXBwbGllZCBjYW4gYmUgdXNlZCBpbiBv
        YnNlcnZlcgogIG9wZXJhdGlvbnMuIFRoYXQgaW5jbHVkZXMgYEVtYmVyLk9i
        amVjdGAgYW5kIG1vc3Qgb2JqZWN0cyB5b3Ugd2lsbAogIGludGVyYWN0IHdp
        dGggYXMgeW91IHdyaXRlIHlvdXIgRW1iZXIgYXBwbGljYXRpb24uCgogIE5v
        dGUgdGhhdCB5b3Ugd2lsbCBub3QgZ2VuZXJhbGx5IGFwcGx5IHRoaXMgbWl4
        aW4gdG8gY2xhc3NlcyB5b3Vyc2VsZiwKICBidXQgeW91IHdpbGwgdXNlIHRo
        ZSBmZWF0dXJlcyBwcm92aWRlZCBieSB0aGlzIG1vZHVsZSBmcmVxdWVudGx5
        LCBzbyBpdAogIGlzIGltcG9ydGFudCB0byB1bmRlcnN0YW5kIGhvdyB0byB1
        c2UgaXQuCgogICMjIFVzaW5nIGBnZXQoKWAgYW5kIGBzZXQoKWAKCiAgQmVj
        YXVzZSBvZiBFbWJlcidzIHN1cHBvcnQgZm9yIGJpbmRpbmdzIGFuZCBvYnNl
        cnZlcnMsIHlvdSB3aWxsIGFsd2F5cwogIGFjY2VzcyBwcm9wZXJ0aWVzIHVz
        aW5nIHRoZSBnZXQgbWV0aG9kLCBhbmQgc2V0IHByb3BlcnRpZXMgdXNpbmcg
        dGhlCiAgc2V0IG1ldGhvZC4gVGhpcyBhbGxvd3MgdGhlIG9ic2VydmluZyBv
        YmplY3RzIHRvIGJlIG5vdGlmaWVkIGFuZAogIGNvbXB1dGVkIHByb3BlcnRp
        ZXMgdG8gYmUgaGFuZGxlZCBwcm9wZXJseS4KCiAgTW9yZSBkb2N1bWVudGF0
        aW9uIGFib3V0IGBnZXRgIGFuZCBgc2V0YCBhcmUgYmVsb3cuCgogICMjIE9i
        c2VydmluZyBQcm9wZXJ0eSBDaGFuZ2VzCgogIFlvdSB0eXBpY2FsbHkgb2Jz
        ZXJ2ZSBwcm9wZXJ0eSBjaGFuZ2VzIHNpbXBseSBieSBhZGRpbmcgdGhlIGBv
        YnNlcnZlc2AKICBjYWxsIHRvIHRoZSBlbmQgb2YgeW91ciBtZXRob2QgZGVj
        bGFyYXRpb25zIGluIGNsYXNzZXMgdGhhdCB5b3Ugd3JpdGUuCiAgRm9yIGV4
        YW1wbGU6CgogIGBgYGphdmFzY3JpcHQKICBFbWJlci5PYmplY3QuZXh0ZW5k
        KHsKICAgIHZhbHVlT2JzZXJ2ZXI6IGZ1bmN0aW9uKCkgewogICAgICAvLyBF
        eGVjdXRlcyB3aGVuZXZlciB0aGUgInZhbHVlIiBwcm9wZXJ0eSBjaGFuZ2Vz
        CiAgICB9Lm9ic2VydmVzKCd2YWx1ZScpCiAgfSk7CiAgYGBgCgogIEFsdGhv
        dWdoIHRoaXMgaXMgdGhlIG1vc3QgY29tbW9uIHdheSB0byBhZGQgYW4gb2Jz
        ZXJ2ZXIsIHRoaXMgY2FwYWJpbGl0eQogIGlzIGFjdHVhbGx5IGJ1aWx0IGlu
        dG8gdGhlIGBFbWJlci5PYmplY3RgIGNsYXNzIG9uIHRvcCBvZiB0d28gbWV0
        aG9kcwogIGRlZmluZWQgaW4gdGhpcyBtaXhpbjogYGFkZE9ic2VydmVyYCBh
        bmQgYHJlbW92ZU9ic2VydmVyYC4gWW91IGNhbiB1c2UKICB0aGVzZSB0d28g
        bWV0aG9kcyB0byBhZGQgYW5kIHJlbW92ZSBvYnNlcnZlcnMgeW91cnNlbGYg
        aWYgeW91IG5lZWQgdG8KICBkbyBzbyBhdCBydW50aW1lLgoKICBUbyBhZGQg
        YW4gb2JzZXJ2ZXIgZm9yIGEgcHJvcGVydHksIGNhbGw6CgogIGBgYGphdmFz
        Y3JpcHQKICBvYmplY3QuYWRkT2JzZXJ2ZXIoJ3Byb3BlcnR5S2V5JywgdGFy
        Z2V0T2JqZWN0LCB0YXJnZXRBY3Rpb24pCiAgYGBgCgogIFRoaXMgd2lsbCBj
        YWxsIHRoZSBgdGFyZ2V0QWN0aW9uYCBtZXRob2Qgb24gdGhlIGB0YXJnZXRP
        YmplY3RgIHdoZW5ldmVyCiAgdGhlIHZhbHVlIG9mIHRoZSBgcHJvcGVydHlL
        ZXlgIGNoYW5nZXMuCgogIE5vdGUgdGhhdCBpZiBgcHJvcGVydHlLZXlgIGlz
        IGEgY29tcHV0ZWQgcHJvcGVydHksIHRoZSBvYnNlcnZlciB3aWxsIGJlCiAg
        Y2FsbGVkIHdoZW4gYW55IG9mIHRoZSBwcm9wZXJ0eSBkZXBlbmRlbmNpZXMg
        YXJlIGNoYW5nZWQsIGV2ZW4gaWYgdGhlCiAgcmVzdWx0aW5nIHZhbHVlIG9m
        IHRoZSBjb21wdXRlZCBwcm9wZXJ0eSBpcyB1bmNoYW5nZWQuIFRoaXMgaXMg
        bmVjZXNzYXJ5CiAgYmVjYXVzZSBjb21wdXRlZCBwcm9wZXJ0aWVzIGFyZSBu
        b3QgY29tcHV0ZWQgdW50aWwgYGdldGAgaXMgY2FsbGVkLgoKICBAY2xhc3Mg
        T2JzZXJ2YWJsZQogIEBuYW1lc3BhY2UgRW1iZXIKKi8KRW1iZXIuT2JzZXJ2
        YWJsZSA9IEVtYmVyLk1peGluLmNyZWF0ZSh7CgogIC8qKgogICAgUmV0cmll
        dmVzIHRoZSB2YWx1ZSBvZiBhIHByb3BlcnR5IGZyb20gdGhlIG9iamVjdC4K
        CiAgICBUaGlzIG1ldGhvZCBpcyB1c3VhbGx5IHNpbWlsYXIgdG8gdXNpbmcg
        YG9iamVjdFtrZXlOYW1lXWAgb3IgYG9iamVjdC5rZXlOYW1lYCwKICAgIGhv
        d2V2ZXIgaXQgc3VwcG9ydHMgYm90aCBjb21wdXRlZCBwcm9wZXJ0aWVzIGFu
        ZCB0aGUgdW5rbm93blByb3BlcnR5CiAgICBoYW5kbGVyLgoKICAgIEJlY2F1
        c2UgYGdldGAgdW5pZmllcyB0aGUgc3ludGF4IGZvciBhY2Nlc3NpbmcgYWxs
        IHRoZXNlIGtpbmRzCiAgICBvZiBwcm9wZXJ0aWVzLCBpdCBjYW4gbWFrZSBt
        YW55IHJlZmFjdG9yaW5ncyBlYXNpZXIsIHN1Y2ggYXMgcmVwbGFjaW5nIGEK
        ICAgIHNpbXBsZSBwcm9wZXJ0eSB3aXRoIGEgY29tcHV0ZWQgcHJvcGVydHks
        IG9yIHZpY2UgdmVyc2EuCgogICAgIyMjIENvbXB1dGVkIFByb3BlcnRpZXMK
        CiAgICBDb21wdXRlZCBwcm9wZXJ0aWVzIGFyZSBtZXRob2RzIGRlZmluZWQg
        d2l0aCB0aGUgYHByb3BlcnR5YCBtb2RpZmllcgogICAgZGVjbGFyZWQgYXQg
        dGhlIGVuZCwgc3VjaCBhczoKCiAgICBgYGBqYXZhc2NyaXB0CiAgICBmdWxs
        TmFtZTogZnVuY3Rpb24oKSB7CiAgICAgIHJldHVybiB0aGlzLmdldEVhY2go
        J2ZpcnN0TmFtZScsICdsYXN0TmFtZScpLmNvbXBhY3QoKS5qb2luKCcgJyk7
        CiAgICB9LnByb3BlcnR5KCdmaXJzdE5hbWUnLCAnbGFzdE5hbWUnKQogICAg
        YGBgCgogICAgV2hlbiB5b3UgY2FsbCBgZ2V0YCBvbiBhIGNvbXB1dGVkIHBy
        b3BlcnR5LCB0aGUgZnVuY3Rpb24gd2lsbCBiZQogICAgY2FsbGVkIGFuZCB0
        aGUgcmV0dXJuIHZhbHVlIHdpbGwgYmUgcmV0dXJuZWQgaW5zdGVhZCBvZiB0
        aGUgZnVuY3Rpb24KICAgIGl0c2VsZi4KCiAgICAjIyMgVW5rbm93biBQcm9w
        ZXJ0aWVzCgogICAgTGlrZXdpc2UsIGlmIHlvdSB0cnkgdG8gY2FsbCBgZ2V0
        YCBvbiBhIHByb3BlcnR5IHdob3NlIHZhbHVlIGlzCiAgICBgdW5kZWZpbmVk
        YCwgdGhlIGB1bmtub3duUHJvcGVydHkoKWAgbWV0aG9kIHdpbGwgYmUgY2Fs
        bGVkIG9uIHRoZSBvYmplY3QuCiAgICBJZiB0aGlzIG1ldGhvZCByZXR1cm5z
        IGFueSB2YWx1ZSBvdGhlciB0aGFuIGB1bmRlZmluZWRgLCBpdCB3aWxsIGJl
        IHJldHVybmVkCiAgICBpbnN0ZWFkLiBUaGlzIGFsbG93cyB5b3UgdG8gaW1w
        bGVtZW50ICJ2aXJ0dWFsIiBwcm9wZXJ0aWVzIHRoYXQgYXJlCiAgICBub3Qg
        ZGVmaW5lZCB1cGZyb250LgoKICAgIEBtZXRob2QgZ2V0CiAgICBAcGFyYW0g
        e1N0cmluZ30ga2V5TmFtZSBUaGUgcHJvcGVydHkgdG8gcmV0cmlldmUKICAg
        IEByZXR1cm4ge09iamVjdH0gVGhlIHByb3BlcnR5IHZhbHVlIG9yIHVuZGVm
        aW5lZC4KICAqLwogIGdldDogZnVuY3Rpb24oa2V5TmFtZSkgewogICAgcmV0
        dXJuIGdldCh0aGlzLCBrZXlOYW1lKTsKICB9LAoKICAvKioKICAgIFRvIGdl
        dCBtdWx0aXBsZSBwcm9wZXJ0aWVzIGF0IG9uY2UsIGNhbGwgYGdldFByb3Bl
        cnRpZXNgCiAgICB3aXRoIGEgbGlzdCBvZiBzdHJpbmdzIG9yIGFuIGFycmF5
        OgoKICAgIGBgYGphdmFzY3JpcHQKICAgIHJlY29yZC5nZXRQcm9wZXJ0aWVz
        KCdmaXJzdE5hbWUnLCAnbGFzdE5hbWUnLCAnemlwQ29kZScpOyAgLy8geyBm
        aXJzdE5hbWU6ICdKb2huJywgbGFzdE5hbWU6ICdEb2UnLCB6aXBDb2RlOiAn
        MTAwMTEnIH0KICAgIGBgYAoKICAgIGlzIGVxdWl2YWxlbnQgdG86CgogICAg
        YGBgamF2YXNjcmlwdAogICAgcmVjb3JkLmdldFByb3BlcnRpZXMoWydmaXJz
        dE5hbWUnLCAnbGFzdE5hbWUnLCAnemlwQ29kZSddKTsgIC8vIHsgZmlyc3RO
        YW1lOiAnSm9obicsIGxhc3ROYW1lOiAnRG9lJywgemlwQ29kZTogJzEwMDEx
        JyB9CiAgICBgYGAKCiAgICBAbWV0aG9kIGdldFByb3BlcnRpZXMKICAgIEBw
        YXJhbSB7U3RyaW5nLi4ufEFycmF5fSBsaXN0IG9mIGtleXMgdG8gZ2V0CiAg
        ICBAcmV0dXJuIHtIYXNofQogICovCiAgZ2V0UHJvcGVydGllczogZnVuY3Rp
        b24oKSB7CiAgICByZXR1cm4gZ2V0UHJvcGVydGllcy5hcHBseShudWxsLCBb
        dGhpc10uY29uY2F0KHNsaWNlLmNhbGwoYXJndW1lbnRzKSkpOwogIH0sCgog
        IC8qKgogICAgU2V0cyB0aGUgcHJvdmlkZWQga2V5IG9yIHBhdGggdG8gdGhl
        IHZhbHVlLgoKICAgIFRoaXMgbWV0aG9kIGlzIGdlbmVyYWxseSB2ZXJ5IHNp
        bWlsYXIgdG8gY2FsbGluZyBgb2JqZWN0W2tleV0gPSB2YWx1ZWAgb3IKICAg
        IGBvYmplY3Qua2V5ID0gdmFsdWVgLCBleGNlcHQgdGhhdCBpdCBwcm92aWRl
        cyBzdXBwb3J0IGZvciBjb21wdXRlZAogICAgcHJvcGVydGllcywgdGhlIGBz
        ZXRVbmtub3duUHJvcGVydHkoKWAgbWV0aG9kIGFuZCBwcm9wZXJ0eSBvYnNl
        cnZlcnMuCgogICAgIyMjIENvbXB1dGVkIFByb3BlcnRpZXMKCiAgICBJZiB5
        b3UgdHJ5IHRvIHNldCBhIHZhbHVlIG9uIGEga2V5IHRoYXQgaGFzIGEgY29t
        cHV0ZWQgcHJvcGVydHkgaGFuZGxlcgogICAgZGVmaW5lZCAoc2VlIHRoZSBg
        Z2V0KClgIG1ldGhvZCBmb3IgYW4gZXhhbXBsZSksIHRoZW4gYHNldCgpYCB3
        aWxsIGNhbGwKICAgIHRoYXQgbWV0aG9kLCBwYXNzaW5nIGJvdGggdGhlIHZh
        bHVlIGFuZCBrZXkgaW5zdGVhZCBvZiBzaW1wbHkgY2hhbmdpbmcKICAgIHRo
        ZSB2YWx1ZSBpdHNlbGYuIFRoaXMgaXMgdXNlZnVsIGZvciB0aG9zZSB0aW1l
        cyB3aGVuIHlvdSBuZWVkIHRvCiAgICBpbXBsZW1lbnQgYSBwcm9wZXJ0eSB0
        aGF0IGlzIGNvbXBvc2VkIG9mIG9uZSBvciBtb3JlIG1lbWJlcgogICAgcHJv
        cGVydGllcy4KCiAgICAjIyMgVW5rbm93biBQcm9wZXJ0aWVzCgogICAgSWYg
        eW91IHRyeSB0byBzZXQgYSB2YWx1ZSBvbiBhIGtleSB0aGF0IGlzIHVuZGVm
        aW5lZCBpbiB0aGUgdGFyZ2V0CiAgICBvYmplY3QsIHRoZW4gdGhlIGBzZXRV
        bmtub3duUHJvcGVydHkoKWAgaGFuZGxlciB3aWxsIGJlIGNhbGxlZCBpbnN0
        ZWFkLiBUaGlzCiAgICBnaXZlcyB5b3UgYW4gb3Bwb3J0dW5pdHkgdG8gaW1w
        bGVtZW50IGNvbXBsZXggInZpcnR1YWwiIHByb3BlcnRpZXMgdGhhdAogICAg
        YXJlIG5vdCBwcmVkZWZpbmVkIG9uIHRoZSBvYmplY3QuIElmIGBzZXRVbmtu
        b3duUHJvcGVydHkoKWAgcmV0dXJucwogICAgdW5kZWZpbmVkLCB0aGVuIGBz
        ZXQoKWAgd2lsbCBzaW1wbHkgc2V0IHRoZSB2YWx1ZSBvbiB0aGUgb2JqZWN0
        LgoKICAgICMjIyBQcm9wZXJ0eSBPYnNlcnZlcnMKCiAgICBJbiBhZGRpdGlv
        biB0byBjaGFuZ2luZyB0aGUgcHJvcGVydHksIGBzZXQoKWAgd2lsbCBhbHNv
        IHJlZ2lzdGVyIGEgcHJvcGVydHkKICAgIGNoYW5nZSB3aXRoIHRoZSBvYmpl
        Y3QuIFVubGVzcyB5b3UgaGF2ZSBwbGFjZWQgdGhpcyBjYWxsIGluc2lkZSBv
        ZiBhCiAgICBgYmVnaW5Qcm9wZXJ0eUNoYW5nZXMoKWAgYW5kIGBlbmRQcm9w
        ZXJ0eUNoYW5nZXMoKSxgIGFueSAibG9jYWwiIG9ic2VydmVycwogICAgKGku
        ZS4gb2JzZXJ2ZXIgbWV0aG9kcyBkZWNsYXJlZCBvbiB0aGUgc2FtZSBvYmpl
        Y3QpLCB3aWxsIGJlIGNhbGxlZAogICAgaW1tZWRpYXRlbHkuIEFueSAicmVt
        b3RlIiBvYnNlcnZlcnMgKGkuZS4gb2JzZXJ2ZXIgbWV0aG9kcyBkZWNsYXJl
        ZCBvbgogICAgYW5vdGhlciBvYmplY3QpIHdpbGwgYmUgcGxhY2VkIGluIGEg
        cXVldWUgYW5kIGNhbGxlZCBhdCBhIGxhdGVyIHRpbWUgaW4gYQogICAgY29h
        bGVzY2VkIG1hbm5lci4KCiAgICAjIyMgQ2hhaW5pbmcKCiAgICBJbiBhZGRp
        dGlvbiB0byBwcm9wZXJ0eSBjaGFuZ2VzLCBgc2V0KClgIHJldHVybnMgdGhl
        IHZhbHVlIG9mIHRoZSBvYmplY3QKICAgIGl0c2VsZiBzbyB5b3UgY2FuIGRv
        IGNoYWluaW5nIGxpa2UgdGhpczoKCiAgICBgYGBqYXZhc2NyaXB0CiAgICBy
        ZWNvcmQuc2V0KCdmaXJzdE5hbWUnLCAnQ2hhcmxlcycpLnNldCgnbGFzdE5h
        bWUnLCAnSm9sbGV5Jyk7CiAgICBgYGAKCiAgICBAbWV0aG9kIHNldAogICAg
        QHBhcmFtIHtTdHJpbmd9IGtleU5hbWUgVGhlIHByb3BlcnR5IHRvIHNldAog
        ICAgQHBhcmFtIHtPYmplY3R9IHZhbHVlIFRoZSB2YWx1ZSB0byBzZXQgb3Ig
        YG51bGxgLgogICAgQHJldHVybiB7RW1iZXIuT2JzZXJ2YWJsZX0KICAqLwog
        IHNldDogZnVuY3Rpb24oa2V5TmFtZSwgdmFsdWUpIHsKICAgIHNldCh0aGlz
        LCBrZXlOYW1lLCB2YWx1ZSk7CiAgICByZXR1cm4gdGhpczsKICB9LAoKICAv
        KioKICAgIFRvIHNldCBtdWx0aXBsZSBwcm9wZXJ0aWVzIGF0IG9uY2UsIGNh
        bGwgYHNldFByb3BlcnRpZXNgCiAgICB3aXRoIGEgSGFzaDoKCiAgICBgYGBq
        YXZhc2NyaXB0CiAgICByZWNvcmQuc2V0UHJvcGVydGllcyh7IGZpcnN0TmFt
        ZTogJ0NoYXJsZXMnLCBsYXN0TmFtZTogJ0pvbGxleScgfSk7CiAgICBgYGAK
        CiAgICBAbWV0aG9kIHNldFByb3BlcnRpZXMKICAgIEBwYXJhbSB7SGFzaH0g
        aGFzaCB0aGUgaGFzaCBvZiBrZXlzIGFuZCB2YWx1ZXMgdG8gc2V0CiAgICBA
        cmV0dXJuIHtFbWJlci5PYnNlcnZhYmxlfQogICovCiAgc2V0UHJvcGVydGll
        czogZnVuY3Rpb24oaGFzaCkgewogICAgcmV0dXJuIEVtYmVyLnNldFByb3Bl
        cnRpZXModGhpcywgaGFzaCk7CiAgfSwKCiAgLyoqCiAgICBCZWdpbnMgYSBn
        cm91cGluZyBvZiBwcm9wZXJ0eSBjaGFuZ2VzLgoKICAgIFlvdSBjYW4gdXNl
        IHRoaXMgbWV0aG9kIHRvIGdyb3VwIHByb3BlcnR5IGNoYW5nZXMgc28gdGhh
        dCBub3RpZmljYXRpb25zCiAgICB3aWxsIG5vdCBiZSBzZW50IHVudGlsIHRo
        ZSBjaGFuZ2VzIGFyZSBmaW5pc2hlZC4gSWYgeW91IHBsYW4gdG8gbWFrZSBh
        CiAgICBsYXJnZSBudW1iZXIgb2YgY2hhbmdlcyB0byBhbiBvYmplY3QgYXQg
        b25lIHRpbWUsIHlvdSBzaG91bGQgY2FsbCB0aGlzCiAgICBtZXRob2QgYXQg
        dGhlIGJlZ2lubmluZyBvZiB0aGUgY2hhbmdlcyB0byBiZWdpbiBkZWZlcnJp
        bmcgY2hhbmdlCiAgICBub3RpZmljYXRpb25zLiBXaGVuIHlvdSBhcmUgZG9u
        ZSBtYWtpbmcgY2hhbmdlcywgY2FsbAogICAgYGVuZFByb3BlcnR5Q2hhbmdl
        cygpYCB0byBkZWxpdmVyIHRoZSBkZWZlcnJlZCBjaGFuZ2Ugbm90aWZpY2F0
        aW9ucyBhbmQgZW5kCiAgICBkZWZlcnJpbmcuCgogICAgQG1ldGhvZCBiZWdp
        blByb3BlcnR5Q2hhbmdlcwogICAgQHJldHVybiB7RW1iZXIuT2JzZXJ2YWJs
        ZX0KICAqLwogIGJlZ2luUHJvcGVydHlDaGFuZ2VzOiBmdW5jdGlvbigpIHsK
        ICAgIEVtYmVyLmJlZ2luUHJvcGVydHlDaGFuZ2VzKCk7CiAgICByZXR1cm4g
        dGhpczsKICB9LAoKICAvKioKICAgIEVuZHMgYSBncm91cGluZyBvZiBwcm9w
        ZXJ0eSBjaGFuZ2VzLgoKICAgIFlvdSBjYW4gdXNlIHRoaXMgbWV0aG9kIHRv
        IGdyb3VwIHByb3BlcnR5IGNoYW5nZXMgc28gdGhhdCBub3RpZmljYXRpb25z
        CiAgICB3aWxsIG5vdCBiZSBzZW50IHVudGlsIHRoZSBjaGFuZ2VzIGFyZSBm
        aW5pc2hlZC4gSWYgeW91IHBsYW4gdG8gbWFrZSBhCiAgICBsYXJnZSBudW1i
        ZXIgb2YgY2hhbmdlcyB0byBhbiBvYmplY3QgYXQgb25lIHRpbWUsIHlvdSBz
        aG91bGQgY2FsbAogICAgYGJlZ2luUHJvcGVydHlDaGFuZ2VzKClgIGF0IHRo
        ZSBiZWdpbm5pbmcgb2YgdGhlIGNoYW5nZXMgdG8gZGVmZXIgY2hhbmdlCiAg
        ICBub3RpZmljYXRpb25zLiBXaGVuIHlvdSBhcmUgZG9uZSBtYWtpbmcgY2hh
        bmdlcywgY2FsbCB0aGlzIG1ldGhvZCB0bwogICAgZGVsaXZlciB0aGUgZGVm
        ZXJyZWQgY2hhbmdlIG5vdGlmaWNhdGlvbnMgYW5kIGVuZCBkZWZlcnJpbmcu
        CgogICAgQG1ldGhvZCBlbmRQcm9wZXJ0eUNoYW5nZXMKICAgIEByZXR1cm4g
        e0VtYmVyLk9ic2VydmFibGV9CiAgKi8KICBlbmRQcm9wZXJ0eUNoYW5nZXM6
        IGZ1bmN0aW9uKCkgewogICAgRW1iZXIuZW5kUHJvcGVydHlDaGFuZ2VzKCk7
        CiAgICByZXR1cm4gdGhpczsKICB9LAoKICAvKioKICAgIE5vdGlmeSB0aGUg
        b2JzZXJ2ZXIgc3lzdGVtIHRoYXQgYSBwcm9wZXJ0eSBpcyBhYm91dCB0byBj
        aGFuZ2UuCgogICAgU29tZXRpbWVzIHlvdSBuZWVkIHRvIGNoYW5nZSBhIHZh
        bHVlIGRpcmVjdGx5IG9yIGluZGlyZWN0bHkgd2l0aG91dAogICAgYWN0dWFs
        bHkgY2FsbGluZyBgZ2V0KClgIG9yIGBzZXQoKWAgb24gaXQuIEluIHRoaXMg
        Y2FzZSwgeW91IGNhbiB1c2UgdGhpcwogICAgbWV0aG9kIGFuZCBgcHJvcGVy
        dHlEaWRDaGFuZ2UoKWAgaW5zdGVhZC4gQ2FsbGluZyB0aGVzZSB0d28gbWV0
        aG9kcwogICAgdG9nZXRoZXIgd2lsbCBub3RpZnkgYWxsIG9ic2VydmVycyB0
        aGF0IHRoZSBwcm9wZXJ0eSBoYXMgcG90ZW50aWFsbHkKICAgIGNoYW5nZWQg
        dmFsdWUuCgogICAgTm90ZSB0aGF0IHlvdSBtdXN0IGFsd2F5cyBjYWxsIGBw
        cm9wZXJ0eVdpbGxDaGFuZ2VgIGFuZCBgcHJvcGVydHlEaWRDaGFuZ2VgCiAg
        ICBhcyBhIHBhaXIuIElmIHlvdSBkbyBub3QsIGl0IG1heSBnZXQgdGhlIHBy
        b3BlcnR5IGNoYW5nZSBncm91cHMgb3V0IG9mCiAgICBvcmRlciBhbmQgY2F1
        c2Ugbm90aWZpY2F0aW9ucyB0byBiZSBkZWxpdmVyZWQgbW9yZSBvZnRlbiB0
        aGFuIHlvdSB3b3VsZAogICAgbGlrZS4KCiAgICBAbWV0aG9kIHByb3BlcnR5
        V2lsbENoYW5nZQogICAgQHBhcmFtIHtTdHJpbmd9IGtleU5hbWUgVGhlIHBy
        b3BlcnR5IGtleSB0aGF0IGlzIGFib3V0IHRvIGNoYW5nZS4KICAgIEByZXR1
        cm4ge0VtYmVyLk9ic2VydmFibGV9CiAgKi8KICBwcm9wZXJ0eVdpbGxDaGFu
        Z2U6IGZ1bmN0aW9uKGtleU5hbWUpIHsKICAgIEVtYmVyLnByb3BlcnR5V2ls
        bENoYW5nZSh0aGlzLCBrZXlOYW1lKTsKICAgIHJldHVybiB0aGlzOwogIH0s
        CgogIC8qKgogICAgTm90aWZ5IHRoZSBvYnNlcnZlciBzeXN0ZW0gdGhhdCBh
        IHByb3BlcnR5IGhhcyBqdXN0IGNoYW5nZWQuCgogICAgU29tZXRpbWVzIHlv
        dSBuZWVkIHRvIGNoYW5nZSBhIHZhbHVlIGRpcmVjdGx5IG9yIGluZGlyZWN0
        bHkgd2l0aG91dAogICAgYWN0dWFsbHkgY2FsbGluZyBgZ2V0KClgIG9yIGBz
        ZXQoKWAgb24gaXQuIEluIHRoaXMgY2FzZSwgeW91IGNhbiB1c2UgdGhpcwog
        ICAgbWV0aG9kIGFuZCBgcHJvcGVydHlXaWxsQ2hhbmdlKClgIGluc3RlYWQu
        IENhbGxpbmcgdGhlc2UgdHdvIG1ldGhvZHMKICAgIHRvZ2V0aGVyIHdpbGwg
        bm90aWZ5IGFsbCBvYnNlcnZlcnMgdGhhdCB0aGUgcHJvcGVydHkgaGFzIHBv
        dGVudGlhbGx5CiAgICBjaGFuZ2VkIHZhbHVlLgoKICAgIE5vdGUgdGhhdCB5
        b3UgbXVzdCBhbHdheXMgY2FsbCBgcHJvcGVydHlXaWxsQ2hhbmdlYCBhbmQg
        YHByb3BlcnR5RGlkQ2hhbmdlYAogICAgYXMgYSBwYWlyLiBJZiB5b3UgZG8g
        bm90LCBpdCBtYXkgZ2V0IHRoZSBwcm9wZXJ0eSBjaGFuZ2UgZ3JvdXBzIG91
        dCBvZgogICAgb3JkZXIgYW5kIGNhdXNlIG5vdGlmaWNhdGlvbnMgdG8gYmUg
        ZGVsaXZlcmVkIG1vcmUgb2Z0ZW4gdGhhbiB5b3Ugd291bGQKICAgIGxpa2Uu
        CgogICAgQG1ldGhvZCBwcm9wZXJ0eURpZENoYW5nZQogICAgQHBhcmFtIHtT
        dHJpbmd9IGtleU5hbWUgVGhlIHByb3BlcnR5IGtleSB0aGF0IGhhcyBqdXN0
        IGNoYW5nZWQuCiAgICBAcmV0dXJuIHtFbWJlci5PYnNlcnZhYmxlfQogICov
        CiAgcHJvcGVydHlEaWRDaGFuZ2U6IGZ1bmN0aW9uKGtleU5hbWUpIHsKICAg
        IEVtYmVyLnByb3BlcnR5RGlkQ2hhbmdlKHRoaXMsIGtleU5hbWUpOwogICAg
        cmV0dXJuIHRoaXM7CiAgfSwKCiAgLyoqCiAgICBDb252ZW5pZW5jZSBtZXRo
        b2QgdG8gY2FsbCBgcHJvcGVydHlXaWxsQ2hhbmdlYCBhbmQgYHByb3BlcnR5
        RGlkQ2hhbmdlYCBpbgogICAgc3VjY2Vzc2lvbi4KCiAgICBAbWV0aG9kIG5v
        dGlmeVByb3BlcnR5Q2hhbmdlCiAgICBAcGFyYW0ge1N0cmluZ30ga2V5TmFt
        ZSBUaGUgcHJvcGVydHkga2V5IHRvIGJlIG5vdGlmaWVkIGFib3V0LgogICAg
        QHJldHVybiB7RW1iZXIuT2JzZXJ2YWJsZX0KICAqLwogIG5vdGlmeVByb3Bl
        cnR5Q2hhbmdlOiBmdW5jdGlvbihrZXlOYW1lKSB7CiAgICB0aGlzLnByb3Bl
        cnR5V2lsbENoYW5nZShrZXlOYW1lKTsKICAgIHRoaXMucHJvcGVydHlEaWRD
        aGFuZ2Uoa2V5TmFtZSk7CiAgICByZXR1cm4gdGhpczsKICB9LAoKICBhZGRC
        ZWZvcmVPYnNlcnZlcjogZnVuY3Rpb24oa2V5LCB0YXJnZXQsIG1ldGhvZCkg
        ewogICAgRW1iZXIuYWRkQmVmb3JlT2JzZXJ2ZXIodGhpcywga2V5LCB0YXJn
        ZXQsIG1ldGhvZCk7CiAgfSwKCiAgLyoqCiAgICBBZGRzIGFuIG9ic2VydmVy
        IG9uIGEgcHJvcGVydHkuCgogICAgVGhpcyBpcyB0aGUgY29yZSBtZXRob2Qg
        dXNlZCB0byByZWdpc3RlciBhbiBvYnNlcnZlciBmb3IgYSBwcm9wZXJ0eS4K
        CiAgICBPbmNlIHlvdSBjYWxsIHRoaXMgbWV0aG9kLCBhbnkgdGltZSB0aGUg
        a2V5J3MgdmFsdWUgaXMgc2V0LCB5b3VyIG9ic2VydmVyCiAgICB3aWxsIGJl
        IG5vdGlmaWVkLiBOb3RlIHRoYXQgdGhlIG9ic2VydmVycyBhcmUgdHJpZ2dl
        cmVkIGFueSB0aW1lIHRoZQogICAgdmFsdWUgaXMgc2V0LCByZWdhcmRsZXNz
        IG9mIHdoZXRoZXIgaXQgaGFzIGFjdHVhbGx5IGNoYW5nZWQuIFlvdXIKICAg
        IG9ic2VydmVyIHNob3VsZCBiZSBwcmVwYXJlZCB0byBoYW5kbGUgdGhhdC4K
        CiAgICBZb3UgY2FuIGFsc28gcGFzcyBhbiBvcHRpb25hbCBjb250ZXh0IHBh
        cmFtZXRlciB0byB0aGlzIG1ldGhvZC4gVGhlCiAgICBjb250ZXh0IHdpbGwg
        YmUgcGFzc2VkIHRvIHlvdXIgb2JzZXJ2ZXIgbWV0aG9kIHdoZW5ldmVyIGl0
        IGlzIHRyaWdnZXJlZC4KICAgIE5vdGUgdGhhdCBpZiB5b3UgYWRkIHRoZSBz
        YW1lIHRhcmdldC9tZXRob2QgcGFpciBvbiBhIGtleSBtdWx0aXBsZSB0aW1l
        cwogICAgd2l0aCBkaWZmZXJlbnQgY29udGV4dCBwYXJhbWV0ZXJzLCB5b3Vy
        IG9ic2VydmVyIHdpbGwgb25seSBiZSBjYWxsZWQgb25jZQogICAgd2l0aCB0
        aGUgbGFzdCBjb250ZXh0IHlvdSBwYXNzZWQuCgogICAgIyMjIE9ic2VydmVy
        IE1ldGhvZHMKCiAgICBPYnNlcnZlciBtZXRob2RzIHlvdSBwYXNzIHNob3Vs
        ZCBnZW5lcmFsbHkgaGF2ZSB0aGUgZm9sbG93aW5nIHNpZ25hdHVyZSBpZgog
        ICAgeW91IGRvIG5vdCBwYXNzIGEgYGNvbnRleHRgIHBhcmFtZXRlcjoKCiAg
        ICBgYGBqYXZhc2NyaXB0CiAgICBmb29EaWRDaGFuZ2U6IGZ1bmN0aW9uKHNl
        bmRlciwga2V5LCB2YWx1ZSwgcmV2KSB7IH07CiAgICBgYGAKCiAgICBUaGUg
        c2VuZGVyIGlzIHRoZSBvYmplY3QgdGhhdCBjaGFuZ2VkLiBUaGUga2V5IGlz
        IHRoZSBwcm9wZXJ0eSB0aGF0CiAgICBjaGFuZ2VzLiBUaGUgdmFsdWUgcHJv
        cGVydHkgaXMgY3VycmVudGx5IHJlc2VydmVkIGFuZCB1bnVzZWQuIFRoZSBy
        ZXYKICAgIGlzIHRoZSBsYXN0IHByb3BlcnR5IHJldmlzaW9uIG9mIHRoZSBv
        YmplY3Qgd2hlbiBpdCBjaGFuZ2VkLCB3aGljaCB5b3UgY2FuCiAgICB1c2Ug
        dG8gZGV0ZWN0IGlmIHRoZSBrZXkgdmFsdWUgaGFzIHJlYWxseSBjaGFuZ2Vk
        IG9yIG5vdC4KCiAgICBJZiB5b3UgcGFzcyBhIGBjb250ZXh0YCBwYXJhbWV0
        ZXIsIHRoZSBjb250ZXh0IHdpbGwgYmUgcGFzc2VkIGJlZm9yZSB0aGUKICAg
        IHJldmlzaW9uIGxpa2Ugc286CgogICAgYGBgamF2YXNjcmlwdAogICAgZm9v
        RGlkQ2hhbmdlOiBmdW5jdGlvbihzZW5kZXIsIGtleSwgdmFsdWUsIGNvbnRl
        eHQsIHJldikgeyB9OwogICAgYGBgCgogICAgVXN1YWxseSB5b3Ugd2lsbCBu
        b3QgbmVlZCB0aGUgdmFsdWUsIGNvbnRleHQgb3IgcmV2aXNpb24gcGFyYW1l
        dGVycyBhdAogICAgdGhlIGVuZC4gSW4gdGhpcyBjYXNlLCBpdCBpcyBjb21t
        b24gdG8gd3JpdGUgb2JzZXJ2ZXIgbWV0aG9kcyB0aGF0IHRha2UKICAgIG9u
        bHkgYSBzZW5kZXIgYW5kIGtleSB2YWx1ZSBhcyBwYXJhbWV0ZXJzIG9yLCBp
        ZiB5b3UgYXJlbid0IGludGVyZXN0ZWQgaW4KICAgIGFueSBvZiB0aGVzZSB2
        YWx1ZXMsIHRvIHdyaXRlIGFuIG9ic2VydmVyIHRoYXQgaGFzIG5vIHBhcmFt
        ZXRlcnMgYXQgYWxsLgoKICAgIEBtZXRob2QgYWRkT2JzZXJ2ZXIKICAgIEBw
        YXJhbSB7U3RyaW5nfSBrZXkgVGhlIGtleSB0byBvYnNlcnZlcgogICAgQHBh
        cmFtIHtPYmplY3R9IHRhcmdldCBUaGUgdGFyZ2V0IG9iamVjdCB0byBpbnZv
        a2UKICAgIEBwYXJhbSB7U3RyaW5nfEZ1bmN0aW9ufSBtZXRob2QgVGhlIG1l
        dGhvZCB0byBpbnZva2UuCiAgICBAcmV0dXJuIHtFbWJlci5PYmplY3R9IHNl
        bGYKICAqLwogIGFkZE9ic2VydmVyOiBmdW5jdGlvbihrZXksIHRhcmdldCwg
        bWV0aG9kKSB7CiAgICBFbWJlci5hZGRPYnNlcnZlcih0aGlzLCBrZXksIHRh
        cmdldCwgbWV0aG9kKTsKICB9LAoKICAvKioKICAgIFJlbW92ZSBhbiBvYnNl
        cnZlciB5b3UgaGF2ZSBwcmV2aW91c2x5IHJlZ2lzdGVyZWQgb24gdGhpcyBv
        YmplY3QuIFBhc3MKICAgIHRoZSBzYW1lIGtleSwgdGFyZ2V0LCBhbmQgbWV0
        aG9kIHlvdSBwYXNzZWQgdG8gYGFkZE9ic2VydmVyKClgIGFuZCB5b3VyCiAg
        ICB0YXJnZXQgd2lsbCBubyBsb25nZXIgcmVjZWl2ZSBub3RpZmljYXRpb25z
        LgoKICAgIEBtZXRob2QgcmVtb3ZlT2JzZXJ2ZXIKICAgIEBwYXJhbSB7U3Ry
        aW5nfSBrZXkgVGhlIGtleSB0byBvYnNlcnZlcgogICAgQHBhcmFtIHtPYmpl
        Y3R9IHRhcmdldCBUaGUgdGFyZ2V0IG9iamVjdCB0byBpbnZva2UKICAgIEBw
        YXJhbSB7U3RyaW5nfEZ1bmN0aW9ufSBtZXRob2QgVGhlIG1ldGhvZCB0byBp
        bnZva2UuCiAgICBAcmV0dXJuIHtFbWJlci5PYnNlcnZhYmxlfSByZWNlaXZl
        cgogICovCiAgcmVtb3ZlT2JzZXJ2ZXI6IGZ1bmN0aW9uKGtleSwgdGFyZ2V0
        LCBtZXRob2QpIHsKICAgIEVtYmVyLnJlbW92ZU9ic2VydmVyKHRoaXMsIGtl
        eSwgdGFyZ2V0LCBtZXRob2QpOwogIH0sCgogIC8qKgogICAgUmV0dXJucyBg
        dHJ1ZWAgaWYgdGhlIG9iamVjdCBjdXJyZW50bHkgaGFzIG9ic2VydmVycyBy
        ZWdpc3RlcmVkIGZvciBhCiAgICBwYXJ0aWN1bGFyIGtleS4gWW91IGNhbiB1
        c2UgdGhpcyBtZXRob2QgdG8gcG90ZW50aWFsbHkgZGVmZXIgcGVyZm9ybWlu
        ZwogICAgYW4gZXhwZW5zaXZlIGFjdGlvbiB1bnRpbCBzb21lb25lIGJlZ2lu
        cyBvYnNlcnZpbmcgYSBwYXJ0aWN1bGFyIHByb3BlcnR5CiAgICBvbiB0aGUg
        b2JqZWN0LgoKICAgIEBtZXRob2QgaGFzT2JzZXJ2ZXJGb3IKICAgIEBwYXJh
        bSB7U3RyaW5nfSBrZXkgS2V5IHRvIGNoZWNrCiAgICBAcmV0dXJuIHtCb29s
        ZWFufQogICovCiAgaGFzT2JzZXJ2ZXJGb3I6IGZ1bmN0aW9uKGtleSkgewog
        ICAgcmV0dXJuIEVtYmVyLmhhc0xpc3RlbmVycyh0aGlzLCBrZXkrJzpjaGFu
        Z2UnKTsKICB9LAoKICAvKioKICAgIEBkZXByZWNhdGVkCiAgICBAbWV0aG9k
        IGdldFBhdGgKICAgIEBwYXJhbSB7U3RyaW5nfSBwYXRoIFRoZSBwcm9wZXJ0
        eSBwYXRoIHRvIHJldHJpZXZlCiAgICBAcmV0dXJuIHtPYmplY3R9IFRoZSBw
        cm9wZXJ0eSB2YWx1ZSBvciB1bmRlZmluZWQuCiAgKi8KICBnZXRQYXRoOiBm
        dW5jdGlvbihwYXRoKSB7CiAgICBFbWJlci5kZXByZWNhdGUoImdldFBhdGgg
        aXMgZGVwcmVjYXRlZCBzaW5jZSBnZXQgbm93IHN1cHBvcnRzIHBhdGhzIik7
        CiAgICByZXR1cm4gdGhpcy5nZXQocGF0aCk7CiAgfSwKCiAgLyoqCiAgICBA
        ZGVwcmVjYXRlZAogICAgQG1ldGhvZCBzZXRQYXRoCiAgICBAcGFyYW0ge1N0
        cmluZ30gcGF0aCBUaGUgcGF0aCB0byB0aGUgcHJvcGVydHkgdGhhdCB3aWxs
        IGJlIHNldAogICAgQHBhcmFtIHtPYmplY3R9IHZhbHVlIFRoZSB2YWx1ZSB0
        byBzZXQgb3IgYG51bGxgLgogICAgQHJldHVybiB7RW1iZXIuT2JzZXJ2YWJs
        ZX0KICAqLwogIHNldFBhdGg6IGZ1bmN0aW9uKHBhdGgsIHZhbHVlKSB7CiAg
        ICBFbWJlci5kZXByZWNhdGUoInNldFBhdGggaXMgZGVwcmVjYXRlZCBzaW5j
        ZSBzZXQgbm93IHN1cHBvcnRzIHBhdGhzIik7CiAgICByZXR1cm4gdGhpcy5z
        ZXQocGF0aCwgdmFsdWUpOwogIH0sCgogIC8qKgogICAgUmV0cmlldmVzIHRo
        ZSB2YWx1ZSBvZiBhIHByb3BlcnR5LCBvciBhIGRlZmF1bHQgdmFsdWUgaW4g
        dGhlIGNhc2UgdGhhdCB0aGUKICAgIHByb3BlcnR5IHJldHVybnMgYHVuZGVm
        aW5lZGAuCgogICAgYGBgamF2YXNjcmlwdAogICAgcGVyc29uLmdldFdpdGhE
        ZWZhdWx0KCdsYXN0TmFtZScsICdEb2UnKTsKICAgIGBgYAoKICAgIEBtZXRo
        b2QgZ2V0V2l0aERlZmF1bHQKICAgIEBwYXJhbSB7U3RyaW5nfSBrZXlOYW1l
        IFRoZSBuYW1lIG9mIHRoZSBwcm9wZXJ0eSB0byByZXRyaWV2ZQogICAgQHBh
        cmFtIHtPYmplY3R9IGRlZmF1bHRWYWx1ZSBUaGUgdmFsdWUgdG8gcmV0dXJu
        IGlmIHRoZSBwcm9wZXJ0eSB2YWx1ZSBpcyB1bmRlZmluZWQKICAgIEByZXR1
        cm4ge09iamVjdH0gVGhlIHByb3BlcnR5IHZhbHVlIG9yIHRoZSBkZWZhdWx0
        VmFsdWUuCiAgKi8KICBnZXRXaXRoRGVmYXVsdDogZnVuY3Rpb24oa2V5TmFt
        ZSwgZGVmYXVsdFZhbHVlKSB7CiAgICByZXR1cm4gRW1iZXIuZ2V0V2l0aERl
        ZmF1bHQodGhpcywga2V5TmFtZSwgZGVmYXVsdFZhbHVlKTsKICB9LAoKICAv
        KioKICAgIFNldCB0aGUgdmFsdWUgb2YgYSBwcm9wZXJ0eSB0byB0aGUgY3Vy
        cmVudCB2YWx1ZSBwbHVzIHNvbWUgYW1vdW50LgoKICAgIGBgYGphdmFzY3Jp
        cHQKICAgIHBlcnNvbi5pbmNyZW1lbnRQcm9wZXJ0eSgnYWdlJyk7CiAgICB0
        ZWFtLmluY3JlbWVudFByb3BlcnR5KCdzY29yZScsIDIpOwogICAgYGBgCgog
        ICAgQG1ldGhvZCBpbmNyZW1lbnRQcm9wZXJ0eQogICAgQHBhcmFtIHtTdHJp
        bmd9IGtleU5hbWUgVGhlIG5hbWUgb2YgdGhlIHByb3BlcnR5IHRvIGluY3Jl
        bWVudAogICAgQHBhcmFtIHtOdW1iZXJ9IGluY3JlbWVudCBUaGUgYW1vdW50
        IHRvIGluY3JlbWVudCBieS4gRGVmYXVsdHMgdG8gMQogICAgQHJldHVybiB7
        TnVtYmVyfSBUaGUgbmV3IHByb3BlcnR5IHZhbHVlCiAgKi8KICBpbmNyZW1l
        bnRQcm9wZXJ0eTogZnVuY3Rpb24oa2V5TmFtZSwgaW5jcmVtZW50KSB7CiAg
        ICBpZiAoRW1iZXIuaXNOb25lKGluY3JlbWVudCkpIHsgaW5jcmVtZW50ID0g
        MTsgfQogICAgRW1iZXIuYXNzZXJ0KCJNdXN0IHBhc3MgYSBudW1lcmljIHZh
        bHVlIHRvIGluY3JlbWVudFByb3BlcnR5IiwgKCFpc05hTihwYXJzZUZsb2F0
        KGluY3JlbWVudCkpICYmIGlzRmluaXRlKGluY3JlbWVudCkpKTsKICAgIHNl
        dCh0aGlzLCBrZXlOYW1lLCAoZ2V0KHRoaXMsIGtleU5hbWUpIHx8IDApICsg
        aW5jcmVtZW50KTsKICAgIHJldHVybiBnZXQodGhpcywga2V5TmFtZSk7CiAg
        fSwKCiAgLyoqCiAgICBTZXQgdGhlIHZhbHVlIG9mIGEgcHJvcGVydHkgdG8g
        dGhlIGN1cnJlbnQgdmFsdWUgbWludXMgc29tZSBhbW91bnQuCgogICAgYGBg
        amF2YXNjcmlwdAogICAgcGxheWVyLmRlY3JlbWVudFByb3BlcnR5KCdsaXZl
        cycpOwogICAgb3JjLmRlY3JlbWVudFByb3BlcnR5KCdoZWFsdGgnLCA1KTsK
        ICAgIGBgYAoKICAgIEBtZXRob2QgZGVjcmVtZW50UHJvcGVydHkKICAgIEBw
        YXJhbSB7U3RyaW5nfSBrZXlOYW1lIFRoZSBuYW1lIG9mIHRoZSBwcm9wZXJ0
        eSB0byBkZWNyZW1lbnQKICAgIEBwYXJhbSB7TnVtYmVyfSBkZWNyZW1lbnQg
        VGhlIGFtb3VudCB0byBkZWNyZW1lbnQgYnkuIERlZmF1bHRzIHRvIDEKICAg
        IEByZXR1cm4ge051bWJlcn0gVGhlIG5ldyBwcm9wZXJ0eSB2YWx1ZQogICov
        CiAgZGVjcmVtZW50UHJvcGVydHk6IGZ1bmN0aW9uKGtleU5hbWUsIGRlY3Jl
        bWVudCkgewogICAgaWYgKEVtYmVyLmlzTm9uZShkZWNyZW1lbnQpKSB7IGRl
        Y3JlbWVudCA9IDE7IH0KICAgIEVtYmVyLmFzc2VydCgiTXVzdCBwYXNzIGEg
        bnVtZXJpYyB2YWx1ZSB0byBkZWNyZW1lbnRQcm9wZXJ0eSIsICghaXNOYU4o
        cGFyc2VGbG9hdChkZWNyZW1lbnQpKSAmJiBpc0Zpbml0ZShkZWNyZW1lbnQp
        KSk7CiAgICBzZXQodGhpcywga2V5TmFtZSwgKGdldCh0aGlzLCBrZXlOYW1l
        KSB8fCAwKSAtIGRlY3JlbWVudCk7CiAgICByZXR1cm4gZ2V0KHRoaXMsIGtl
        eU5hbWUpOwogIH0sCgogIC8qKgogICAgU2V0IHRoZSB2YWx1ZSBvZiBhIGJv
        b2xlYW4gcHJvcGVydHkgdG8gdGhlIG9wcG9zaXRlIG9mIGl0J3MKICAgIGN1
        cnJlbnQgdmFsdWUuCgogICAgYGBgamF2YXNjcmlwdAogICAgc3RhcnNoaXAu
        dG9nZ2xlUHJvcGVydHkoJ3dhcnBEcml2ZUVuZ2FnZWQnKTsKICAgIGBgYAoK
        ICAgIEBtZXRob2QgdG9nZ2xlUHJvcGVydHkKICAgIEBwYXJhbSB7U3RyaW5n
        fSBrZXlOYW1lIFRoZSBuYW1lIG9mIHRoZSBwcm9wZXJ0eSB0byB0b2dnbGUK
        ICAgIEByZXR1cm4ge09iamVjdH0gVGhlIG5ldyBwcm9wZXJ0eSB2YWx1ZQog
        ICovCiAgdG9nZ2xlUHJvcGVydHk6IGZ1bmN0aW9uKGtleU5hbWUpIHsKICAg
        IHNldCh0aGlzLCBrZXlOYW1lLCAhZ2V0KHRoaXMsIGtleU5hbWUpKTsKICAg
        IHJldHVybiBnZXQodGhpcywga2V5TmFtZSk7CiAgfSwKCiAgLyoqCiAgICBS
        ZXR1cm5zIHRoZSBjYWNoZWQgdmFsdWUgb2YgYSBjb21wdXRlZCBwcm9wZXJ0
        eSwgaWYgaXQgZXhpc3RzLgogICAgVGhpcyBhbGxvd3MgeW91IHRvIGluc3Bl
        Y3QgdGhlIHZhbHVlIG9mIGEgY29tcHV0ZWQgcHJvcGVydHkKICAgIHdpdGhv
        dXQgYWNjaWRlbnRhbGx5IGludm9raW5nIGl0IGlmIGl0IGlzIGludGVuZGVk
        IHRvIGJlCiAgICBnZW5lcmF0ZWQgbGF6aWx5LgoKICAgIEBtZXRob2QgY2Fj
        aGVGb3IKICAgIEBwYXJhbSB7U3RyaW5nfSBrZXlOYW1lCiAgICBAcmV0dXJu
        IHtPYmplY3R9IFRoZSBjYWNoZWQgdmFsdWUgb2YgdGhlIGNvbXB1dGVkIHBy
        b3BlcnR5LCBpZiBhbnkKICAqLwogIGNhY2hlRm9yOiBmdW5jdGlvbihrZXlO
        YW1lKSB7CiAgICByZXR1cm4gRW1iZXIuY2FjaGVGb3IodGhpcywga2V5TmFt
        ZSk7CiAgfSwKCiAgLy8gaW50ZW5kZWQgZm9yIGRlYnVnZ2luZyBwdXJwb3Nl
        cwogIG9ic2VydmVyc0ZvcktleTogZnVuY3Rpb24oa2V5TmFtZSkgewogICAg
        cmV0dXJuIEVtYmVyLm9ic2VydmVyc0Zvcih0aGlzLCBrZXlOYW1lKTsKICB9
        Cn0pOwoKfSkoKTsKCgoKKGZ1bmN0aW9uKCkgewovKioKQG1vZHVsZSBlbWJl
        cgpAc3VibW9kdWxlIGVtYmVyLXJ1bnRpbWUKKi8KCnZhciBnZXQgPSBFbWJl
        ci5nZXQsIHNldCA9IEVtYmVyLnNldDsKCi8qKgpgRW1iZXIuVGFyZ2V0QWN0
        aW9uU3VwcG9ydGAgaXMgYSBtaXhpbiB0aGF0IGNhbiBiZSBpbmNsdWRlZCBp
        biBhIGNsYXNzCnRvIGFkZCBhIGB0cmlnZ2VyQWN0aW9uYCBtZXRob2Qgd2l0
        aCBzZW1hbnRpY3Mgc2ltaWxhciB0byB0aGUgSGFuZGxlYmFycwpge3thY3Rp
        b259fWAgaGVscGVyLiBJbiBub3JtYWwgRW1iZXIgdXNhZ2UsIHRoZSBge3th
        Y3Rpb259fWAgaGVscGVyIGlzCnVzdWFsbHkgdGhlIGJlc3QgY2hvaWNlLiBU
        aGlzIG1peGluIGlzIG1vc3Qgb2Z0ZW4gdXNlZnVsIHdoZW4geW91IGFyZQpk
        b2luZyBtb3JlIGNvbXBsZXggZXZlbnQgaGFuZGxpbmcgaW4gVmlldyBvYmpl
        Y3RzLgoKU2VlIGFsc28gYEVtYmVyLlZpZXdUYXJnZXRBY3Rpb25TdXBwb3J0
        YCwgd2hpY2ggaGFzCnZpZXctYXdhcmUgZGVmYXVsdHMgZm9yIHRhcmdldCBh
        bmQgYWN0aW9uQ29udGV4dC4KCkBjbGFzcyBUYXJnZXRBY3Rpb25TdXBwb3J0
        CkBuYW1lc3BhY2UgRW1iZXIKQGV4dGVuZHMgRW1iZXIuTWl4aW4KKi8KRW1i
        ZXIuVGFyZ2V0QWN0aW9uU3VwcG9ydCA9IEVtYmVyLk1peGluLmNyZWF0ZSh7
        CiAgdGFyZ2V0OiBudWxsLAogIGFjdGlvbjogbnVsbCwKICBhY3Rpb25Db250
        ZXh0OiBudWxsLAoKICB0YXJnZXRPYmplY3Q6IEVtYmVyLmNvbXB1dGVkKGZ1
        bmN0aW9uKCkgewogICAgdmFyIHRhcmdldCA9IGdldCh0aGlzLCAndGFyZ2V0
        Jyk7CgogICAgaWYgKEVtYmVyLnR5cGVPZih0YXJnZXQpID09PSAic3RyaW5n
        IikgewogICAgICB2YXIgdmFsdWUgPSBnZXQodGhpcywgdGFyZ2V0KTsKICAg
        ICAgaWYgKHZhbHVlID09PSB1bmRlZmluZWQpIHsgdmFsdWUgPSBnZXQoRW1i
        ZXIubG9va3VwLCB0YXJnZXQpOyB9CiAgICAgIHJldHVybiB2YWx1ZTsKICAg
        IH0gZWxzZSB7CiAgICAgIHJldHVybiB0YXJnZXQ7CiAgICB9CiAgfSkucHJv
        cGVydHkoJ3RhcmdldCcpLAoKICBhY3Rpb25Db250ZXh0T2JqZWN0OiBFbWJl
        ci5jb21wdXRlZChmdW5jdGlvbigpIHsKICAgIHZhciBhY3Rpb25Db250ZXh0
        ID0gZ2V0KHRoaXMsICdhY3Rpb25Db250ZXh0Jyk7CgogICAgaWYgKEVtYmVy
        LnR5cGVPZihhY3Rpb25Db250ZXh0KSA9PT0gInN0cmluZyIpIHsKICAgICAg
        dmFyIHZhbHVlID0gZ2V0KHRoaXMsIGFjdGlvbkNvbnRleHQpOwogICAgICBp
        ZiAodmFsdWUgPT09IHVuZGVmaW5lZCkgeyB2YWx1ZSA9IGdldChFbWJlci5s
        b29rdXAsIGFjdGlvbkNvbnRleHQpOyB9CiAgICAgIHJldHVybiB2YWx1ZTsK
        ICAgIH0gZWxzZSB7CiAgICAgIHJldHVybiBhY3Rpb25Db250ZXh0OwogICAg
        fQogIH0pLnByb3BlcnR5KCdhY3Rpb25Db250ZXh0JyksCgogIC8qKgogIFNl
        bmQgYW4gImFjdGlvbiIgd2l0aCBhbiAiYWN0aW9uQ29udGV4dCIgdG8gYSAi
        dGFyZ2V0Ii4gVGhlIGFjdGlvbiwgYWN0aW9uQ29udGV4dAogIGFuZCB0YXJn
        ZXQgd2lsbCBiZSByZXRyaWV2ZWQgZnJvbSBwcm9wZXJ0aWVzIG9mIHRoZSBv
        YmplY3QuIEZvciBleGFtcGxlOgoKICBgYGBqYXZhc2NyaXB0CiAgQXBwLlNh
        dmVCdXR0b25WaWV3ID0gRW1iZXIuVmlldy5leHRlbmQoRW1iZXIuVGFyZ2V0
        QWN0aW9uU3VwcG9ydCwgewogICAgdGFyZ2V0OiBFbWJlci5jb21wdXRlZC5h
        bGlhcygnY29udHJvbGxlcicpLAogICAgYWN0aW9uOiAnc2F2ZScsCiAgICBh
        Y3Rpb25Db250ZXh0OiBFbWJlci5jb21wdXRlZC5hbGlhcygnY29udGV4dCcp
        LAogICAgY2xpY2s6IGZ1bmN0aW9uKCkgewogICAgICB0aGlzLnRyaWdnZXJB
        Y3Rpb24oKTsgLy8gU2VuZHMgdGhlIGBzYXZlYCBhY3Rpb24sIGFsb25nIHdp
        dGggdGhlIGN1cnJlbnQgY29udGV4dAogICAgICAgICAgICAgICAgICAgICAg
        ICAgICAgLy8gdG8gdGhlIGN1cnJlbnQgY29udHJvbGxlcgogICAgfQogIH0p
        OwogIGBgYAoKICBUaGUgYHRhcmdldGAsIGBhY3Rpb25gLCBhbmQgYGFjdGlv
        bkNvbnRleHRgIGNhbiBiZSBwcm92aWRlZCBhcyBwcm9wZXJ0aWVzIG9mCiAg
        YW4gb3B0aW9uYWwgb2JqZWN0IGFyZ3VtZW50IHRvIGB0cmlnZ2VyQWN0aW9u
        YCBhcyB3ZWxsLgoKICBgYGBqYXZhc2NyaXB0CiAgQXBwLlNhdmVCdXR0b25W
        aWV3ID0gRW1iZXIuVmlldy5leHRlbmQoRW1iZXIuVGFyZ2V0QWN0aW9uU3Vw
        cG9ydCwgewogICAgY2xpY2s6IGZ1bmN0aW9uKCkgewogICAgICB0aGlzLnRy
        aWdnZXJBY3Rpb24oewogICAgICAgIGFjdGlvbjogJ3NhdmUnLAogICAgICAg
        IHRhcmdldDogdGhpcy5nZXQoJ2NvbnRyb2xsZXInKSwKICAgICAgICBhY3Rp
        b25Db250ZXh0OiB0aGlzLmdldCgnY29udGV4dCcpLAogICAgICB9KTsgLy8g
        U2VuZHMgdGhlIGBzYXZlYCBhY3Rpb24sIGFsb25nIHdpdGggdGhlIGN1cnJl
        bnQgY29udGV4dAogICAgICAgICAgLy8gdG8gdGhlIGN1cnJlbnQgY29udHJv
        bGxlcgogICAgfQogIH0pOwogIGBgYAoKICBUaGUgYGFjdGlvbkNvbnRleHRg
        IGRlZmF1bHRzIHRvIHRoZSBvYmplY3QgeW91IG1peGluZyBgVGFyZ2V0QWN0
        aW9uU3VwcG9ydGAgaW50by4KICBCdXQgYHRhcmdldGAgYW5kIGBhY3Rpb25g
        IG11c3QgYmUgc3BlY2lmaWVkIGVpdGhlciBhcyBwcm9wZXJ0aWVzIG9yIHdp
        dGggdGhlIGFyZ3VtZW50CiAgdG8gYHRyaWdnZXJBY3Rpb25gLCBvciBhIGNv
        bWJpbmF0aW9uOgoKICBgYGBqYXZhc2NyaXB0CiAgQXBwLlNhdmVCdXR0b25W
        aWV3ID0gRW1iZXIuVmlldy5leHRlbmQoRW1iZXIuVGFyZ2V0QWN0aW9uU3Vw
        cG9ydCwgewogICAgdGFyZ2V0OiBFbWJlci5jb21wdXRlZC5hbGlhcygnY29u
        dHJvbGxlcicpLAogICAgY2xpY2s6IGZ1bmN0aW9uKCkgewogICAgICB0aGlz
        LnRyaWdnZXJBY3Rpb24oewogICAgICAgIGFjdGlvbjogJ3NhdmUnCiAgICAg
        IH0pOyAvLyBTZW5kcyB0aGUgYHNhdmVgIGFjdGlvbiwgYWxvbmcgd2l0aCBh
        IHJlZmVyZW5jZSB0byBgdGhpc2AsCiAgICAgICAgICAvLyB0byB0aGUgY3Vy
        cmVudCBjb250cm9sbGVyCiAgICB9CiAgfSk7CiAgYGBgCgogIEBtZXRob2Qg
        dHJpZ2dlckFjdGlvbgogIEBwYXJhbSBvcHRzIHtIYXNofSAob3B0aW9uYWws
        IHdpdGggdGhlIG9wdGlvbmFsIGtleXMgYWN0aW9uLCB0YXJnZXQgYW5kL29y
        IGFjdGlvbkNvbnRleHQpCiAgQHJldHVybiB7Qm9vbGVhbn0gdHJ1ZSBpZiB0
        aGUgYWN0aW9uIHdhcyBzZW50IHN1Y2Nlc3NmdWxseSBhbmQgZGlkIG5vdCBy
        ZXR1cm4gZmFsc2UKICAqLwogIHRyaWdnZXJBY3Rpb246IGZ1bmN0aW9uKG9w
        dHMpIHsKICAgIG9wdHMgPSBvcHRzIHx8IHt9OwogICAgdmFyIGFjdGlvbiA9
        IG9wdHMuYWN0aW9uIHx8IGdldCh0aGlzLCAnYWN0aW9uJyksCiAgICAgICAg
        dGFyZ2V0ID0gb3B0cy50YXJnZXQgfHwgZ2V0KHRoaXMsICd0YXJnZXRPYmpl
        Y3QnKSwKICAgICAgICBhY3Rpb25Db250ZXh0ID0gb3B0cy5hY3Rpb25Db250
        ZXh0OwoKICAgIGZ1bmN0aW9uIGFyZ3Mob3B0aW9ucywgYWN0aW9uTmFtZSkg
        ewogICAgICB2YXIgcmV0ID0gW107CiAgICAgIGlmIChhY3Rpb25OYW1lKSB7
        IHJldC5wdXNoKGFjdGlvbk5hbWUpOyB9CgogICAgICByZXR1cm4gcmV0LmNv
        bmNhdChvcHRpb25zKTsKICAgIH0KCiAgICBpZiAodHlwZW9mIGFjdGlvbkNv
        bnRleHQgPT09ICd1bmRlZmluZWQnKSB7CiAgICAgIGFjdGlvbkNvbnRleHQg
        PSBnZXQodGhpcywgJ2FjdGlvbkNvbnRleHRPYmplY3QnKSB8fCB0aGlzOwog
        ICAgfQoKICAgIGlmICh0YXJnZXQgJiYgYWN0aW9uKSB7CiAgICAgIHZhciBy
        ZXQ7CgogICAgICBpZiAodGFyZ2V0LnNlbmQpIHsKICAgICAgICByZXQgPSB0
        YXJnZXQuc2VuZC5hcHBseSh0YXJnZXQsIGFyZ3MoYWN0aW9uQ29udGV4dCwg
        YWN0aW9uKSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgRW1iZXIuYXNzZXJ0
        KCJUaGUgYWN0aW9uICciICsgYWN0aW9uICsgIicgZGlkIG5vdCBleGlzdCBv
        biAiICsgdGFyZ2V0LCB0eXBlb2YgdGFyZ2V0W2FjdGlvbl0gPT09ICdmdW5j
        dGlvbicpOwogICAgICAgIHJldCA9IHRhcmdldFthY3Rpb25dLmFwcGx5KHRh
        cmdldCwgYXJncyhhY3Rpb25Db250ZXh0KSk7CiAgICAgIH0KCiAgICAgIGlm
        IChyZXQgIT09IGZhbHNlKSByZXQgPSB0cnVlOwoKICAgICAgcmV0dXJuIHJl
        dDsKICAgIH0gZWxzZSB7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KICB9
        Cn0pOwoKfSkoKTsKCgoKKGZ1bmN0aW9uKCkgewovKioKQG1vZHVsZSBlbWJl
        cgpAc3VibW9kdWxlIGVtYmVyLXJ1bnRpbWUKKi8KCi8qKgogIFRoaXMgbWl4
        aW4gYWxsb3dzIGZvciBFbWJlciBvYmplY3RzIHRvIHN1YnNjcmliZSB0byBh
        bmQgZW1pdCBldmVudHMuCgogIGBgYGphdmFzY3JpcHQKICBBcHAuUGVyc29u
        ID0gRW1iZXIuT2JqZWN0LmV4dGVuZChFbWJlci5FdmVudGVkLCB7CiAgICBn
        cmVldDogZnVuY3Rpb24oKSB7CiAgICAgIC8vIC4uLgogICAgICB0aGlzLnRy
        aWdnZXIoJ2dyZWV0Jyk7CiAgICB9CiAgfSk7CgogIHZhciBwZXJzb24gPSBB
        cHAuUGVyc29uLmNyZWF0ZSgpOwoKICBwZXJzb24ub24oJ2dyZWV0JywgZnVu
        Y3Rpb24oKSB7CiAgICBjb25zb2xlLmxvZygnT3VyIHBlcnNvbiBoYXMgZ3Jl
        ZXRlZCcpOwogIH0pOwoKICBwZXJzb24uZ3JlZXQoKTsKCiAgLy8gb3V0cHV0
        czogJ091ciBwZXJzb24gaGFzIGdyZWV0ZWQnCiAgYGBgCgogIFlvdSBjYW4g
        YWxzbyBjaGFpbiBtdWx0aXBsZSBldmVudCBzdWJzY3JpcHRpb25zOgoKICBg
        YGBqYXZhc2NyaXB0CiAgcGVyc29uLm9uKCdncmVldCcsIGZ1bmN0aW9uKCkg
        ewogICAgY29uc29sZS5sb2coJ091ciBwZXJzb24gaGFzIGdyZWV0ZWQnKTsK
        ICB9KS5vbmUoJ2dyZWV0JywgZnVuY3Rpb24oKSB7CiAgICBjb25zb2xlLmxv
        ZygnT2ZmZXIgb25lLXRpbWUgc3BlY2lhbCcpOwogIH0pLm9mZignZXZlbnQn
        LCB0aGlzLCBmb3JnZXRUaGlzKTsKICBgYGAKCiAgQGNsYXNzIEV2ZW50ZWQK
        ICBAbmFtZXNwYWNlIEVtYmVyCiAqLwpFbWJlci5FdmVudGVkID0gRW1iZXIu
        TWl4aW4uY3JlYXRlKHsKCiAgLyoqCiAgIFN1YnNjcmliZXMgdG8gYSBuYW1l
        ZCBldmVudCB3aXRoIGdpdmVuIGZ1bmN0aW9uLgoKICAgYGBgamF2YXNjcmlw
        dAogICBwZXJzb24ub24oJ2RpZExvYWQnLCBmdW5jdGlvbigpIHsKICAgICAv
        LyBmaXJlZCBvbmNlIHRoZSBwZXJzb24gaGFzIGxvYWRlZAogICB9KTsKICAg
        YGBgCgogICBBbiBvcHRpb25hbCB0YXJnZXQgY2FuIGJlIHBhc3NlZCBpbiBh
        cyB0aGUgMm5kIGFyZ3VtZW50IHRoYXQgd2lsbAogICBiZSBzZXQgYXMgdGhl
        ICJ0aGlzIiBmb3IgdGhlIGNhbGxiYWNrLiBUaGlzIGlzIGEgZ29vZCB3YXkg
        dG8gZ2l2ZSB5b3VyCiAgIGZ1bmN0aW9uIGFjY2VzcyB0byB0aGUgb2JqZWN0
        IHRyaWdnZXJpbmcgdGhlIGV2ZW50LiBXaGVuIHRoZSB0YXJnZXQKICAgcGFy
        YW1ldGVyIGlzIHVzZWQgdGhlIGNhbGxiYWNrIGJlY29tZXMgdGhlIHRoaXJk
        IGFyZ3VtZW50LgoKICAgQG1ldGhvZCBvbgogICBAcGFyYW0ge1N0cmluZ30g
        bmFtZSBUaGUgbmFtZSBvZiB0aGUgZXZlbnQKICAgQHBhcmFtIHtPYmplY3R9
        IFt0YXJnZXRdIFRoZSAidGhpcyIgYmluZGluZyBmb3IgdGhlIGNhbGxiYWNr
        CiAgIEBwYXJhbSB7RnVuY3Rpb259IG1ldGhvZCBUaGUgY2FsbGJhY2sgdG8g
        ZXhlY3V0ZQogICBAcmV0dXJuIHRoaXMKICAqLwogIG9uOiBmdW5jdGlvbihu
        YW1lLCB0YXJnZXQsIG1ldGhvZCkgewogICAgRW1iZXIuYWRkTGlzdGVuZXIo
        dGhpcywgbmFtZSwgdGFyZ2V0LCBtZXRob2QpOwogICAgcmV0dXJuIHRoaXM7
        CiAgfSwKCiAgLyoqCiAgICBTdWJzY3JpYmVzIGEgZnVuY3Rpb24gdG8gYSBu
        YW1lZCBldmVudCBhbmQgdGhlbiBjYW5jZWxzIHRoZSBzdWJzY3JpcHRpb24K
        ICAgIGFmdGVyIHRoZSBmaXJzdCB0aW1lIHRoZSBldmVudCBpcyB0cmlnZ2Vy
        ZWQuIEl0IGlzIGdvb2QgdG8gdXNlIGBgb25lYGAgd2hlbgogICAgeW91IG9u
        bHkgY2FyZSBhYm91dCB0aGUgZmlyc3QgdGltZSBhbiBldmVudCBoYXMgdGFr
        ZW4gcGxhY2UuCgogICAgVGhpcyBmdW5jdGlvbiB0YWtlcyBhbiBvcHRpb25h
        bCAybmQgYXJndW1lbnQgdGhhdCB3aWxsIGJlY29tZSB0aGUgInRoaXMiCiAg
        ICB2YWx1ZSBmb3IgdGhlIGNhbGxiYWNrLiBJZiB0aGlzIGFyZ3VtZW50IGlz
        IHBhc3NlZCB0aGVuIHRoZSAzcmQgYXJndW1lbnQKICAgIGJlY29tZXMgdGhl
        IGZ1bmN0aW9uLgoKICAgIEBtZXRob2Qgb25lCiAgICBAcGFyYW0ge1N0cmlu
        Z30gbmFtZSBUaGUgbmFtZSBvZiB0aGUgZXZlbnQKICAgIEBwYXJhbSB7T2Jq
        ZWN0fSBbdGFyZ2V0XSBUaGUgInRoaXMiIGJpbmRpbmcgZm9yIHRoZSBjYWxs
        YmFjawogICAgQHBhcmFtIHtGdW5jdGlvbn0gbWV0aG9kIFRoZSBjYWxsYmFj
        ayB0byBleGVjdXRlCiAgICBAcmV0dXJuIHRoaXMKICAqLwogIG9uZTogZnVu
        Y3Rpb24obmFtZSwgdGFyZ2V0LCBtZXRob2QpIHsKICAgIGlmICghbWV0aG9k
        KSB7CiAgICAgIG1ldGhvZCA9IHRhcmdldDsKICAgICAgdGFyZ2V0ID0gbnVs
        bDsKICAgIH0KCiAgICBFbWJlci5hZGRMaXN0ZW5lcih0aGlzLCBuYW1lLCB0
        YXJnZXQsIG1ldGhvZCwgdHJ1ZSk7CiAgICByZXR1cm4gdGhpczsKICB9LAoK
        ICAvKioKICAgIFRyaWdnZXJzIGEgbmFtZWQgZXZlbnQgZm9yIHRoZSBvYmpl
        Y3QuIEFueSBhZGRpdGlvbmFsIGFyZ3VtZW50cwogICAgd2lsbCBiZSBwYXNz
        ZWQgYXMgcGFyYW1ldGVycyB0byB0aGUgZnVuY3Rpb25zIHRoYXQgYXJlIHN1
        YnNjcmliZWQgdG8gdGhlCiAgICBldmVudC4KCiAgICBgYGBqYXZhc2NyaXB0
        CiAgICBwZXJzb24ub24oJ2RpZEVhdCcsIGZ1bmN0aW9uKGZvb2QpIHsKICAg
        ICAgY29uc29sZS5sb2coJ3BlcnNvbiBhdGUgc29tZSAnICsgZm9vZCk7CiAg
        ICB9KTsKCiAgICBwZXJzb24udHJpZ2dlcignZGlkRWF0JywgJ2Jyb2Njb2xp
        Jyk7CgogICAgLy8gb3V0cHV0czogcGVyc29uIGF0ZSBzb21lIGJyb2Njb2xp
        CiAgICBgYGAKICAgIEBtZXRob2QgdHJpZ2dlcgogICAgQHBhcmFtIHtTdHJp
        bmd9IG5hbWUgVGhlIG5hbWUgb2YgdGhlIGV2ZW50CiAgICBAcGFyYW0ge09i
        amVjdC4uLn0gYXJncyBPcHRpb25hbCBhcmd1bWVudHMgdG8gcGFzcyBvbgog
        ICovCiAgdHJpZ2dlcjogZnVuY3Rpb24obmFtZSkgewogICAgdmFyIGFyZ3Mg
        PSBbXSwgaSwgbDsKICAgIGZvciAoaSA9IDEsIGwgPSBhcmd1bWVudHMubGVu
        Z3RoOyBpIDwgbDsgaSsrKSB7CiAgICAgIGFyZ3MucHVzaChhcmd1bWVudHNb
        aV0pOwogICAgfQogICAgRW1iZXIuc2VuZEV2ZW50KHRoaXMsIG5hbWUsIGFy
        Z3MpOwogIH0sCgogIC8qKgogICAgQ2FuY2VscyBzdWJzY3JpcHRpb24gZm9y
        IGdpdmVuIG5hbWUsIHRhcmdldCwgYW5kIG1ldGhvZC4KCiAgICBAbWV0aG9k
        IG9mZgogICAgQHBhcmFtIHtTdHJpbmd9IG5hbWUgVGhlIG5hbWUgb2YgdGhl
        IGV2ZW50CiAgICBAcGFyYW0ge09iamVjdH0gdGFyZ2V0IFRoZSB0YXJnZXQg
        b2YgdGhlIHN1YnNjcmlwdGlvbgogICAgQHBhcmFtIHtGdW5jdGlvbn0gbWV0
        aG9kIFRoZSBmdW5jdGlvbiBvZiB0aGUgc3Vic2NyaXB0aW9uCiAgICBAcmV0
        dXJuIHRoaXMKICAqLwogIG9mZjogZnVuY3Rpb24obmFtZSwgdGFyZ2V0LCBt
        ZXRob2QpIHsKICAgIEVtYmVyLnJlbW92ZUxpc3RlbmVyKHRoaXMsIG5hbWUs
        IHRhcmdldCwgbWV0aG9kKTsKICAgIHJldHVybiB0aGlzOwogIH0sCgogIC8q
        KgogICAgQ2hlY2tzIHRvIHNlZSBpZiBvYmplY3QgaGFzIGFueSBzdWJzY3Jp
        cHRpb25zIGZvciBuYW1lZCBldmVudC4KCiAgICBAbWV0aG9kIGhhcwogICAg
        QHBhcmFtIHtTdHJpbmd9IG5hbWUgVGhlIG5hbWUgb2YgdGhlIGV2ZW50CiAg
        ICBAcmV0dXJuIHtCb29sZWFufSBkb2VzIHRoZSBvYmplY3QgaGF2ZSBhIHN1
        YnNjcmlwdGlvbiBmb3IgZXZlbnQKICAgKi8KICBoYXM6IGZ1bmN0aW9uKG5h
        bWUpIHsKICAgIHJldHVybiBFbWJlci5oYXNMaXN0ZW5lcnModGhpcywgbmFt
        ZSk7CiAgfQp9KTsKCn0pKCk7CgoKCihmdW5jdGlvbigpIHsKdmFyIFJTVlAg
        PSByZXF1aXJlTW9kdWxlKCJyc3ZwIik7CgpSU1ZQLmNvbmZpZ3VyZSgnYXN5
        bmMnLCBmdW5jdGlvbihjYWxsYmFjaywgcHJvbWlzZSkgewogIEVtYmVyLnJ1
        bi5zY2hlZHVsZSgnYWN0aW9ucycsIHByb21pc2UsIGNhbGxiYWNrLCBwcm9t
        aXNlKTsKfSk7CgovKioKQG1vZHVsZSBlbWJlcgpAc3VibW9kdWxlIGVtYmVy
        LXJ1bnRpbWUKKi8KCnZhciBnZXQgPSBFbWJlci5nZXQ7CgovKioKICBAY2xh
        c3MgRGVmZXJyZWQKICBAbmFtZXNwYWNlIEVtYmVyCiAqLwpFbWJlci5EZWZl
        cnJlZE1peGluID0gRW1iZXIuTWl4aW4uY3JlYXRlKHsKICAvKioKICAgIEFk
        ZCBoYW5kbGVycyB0byBiZSBjYWxsZWQgd2hlbiB0aGUgRGVmZXJyZWQgb2Jq
        ZWN0IGlzIHJlc29sdmVkIG9yIHJlamVjdGVkLgoKICAgIEBtZXRob2QgdGhl
        bgogICAgQHBhcmFtIHtGdW5jdGlvbn0gcmVzb2x2ZSBhIGNhbGxiYWNrIGZ1
        bmN0aW9uIHRvIGJlIGNhbGxlZCB3aGVuIGRvbmUKICAgIEBwYXJhbSB7RnVu
        Y3Rpb259IHJlamVjdCAgYSBjYWxsYmFjayBmdW5jdGlvbiB0byBiZSBjYWxs
        ZWQgd2hlbiBmYWlsZWQKICAqLwogIHRoZW46IGZ1bmN0aW9uKHJlc29sdmUs
        IHJlamVjdCkgewogICAgdmFyIGRlZmVycmVkLCBwcm9taXNlLCBlbnRpdHk7
        CgogICAgZW50aXR5ID0gdGhpczsKICAgIGRlZmVycmVkID0gZ2V0KHRoaXMs
        ICdfZGVmZXJyZWQnKTsKICAgIHByb21pc2UgPSBkZWZlcnJlZC5wcm9taXNl
        OwoKICAgIGZ1bmN0aW9uIGZ1bGZpbGxtZW50SGFuZGxlcihmdWxmaWxsbWVu
        dCkgewogICAgICBpZiAoZnVsZmlsbG1lbnQgPT09IHByb21pc2UpIHsKICAg
        ICAgICByZXR1cm4gcmVzb2x2ZShlbnRpdHkpOwogICAgICB9IGVsc2Ugewog
        ICAgICAgIHJldHVybiByZXNvbHZlKGZ1bGZpbGxtZW50KTsKICAgICAgfQog
        ICAgfQoKICAgIHJldHVybiBwcm9taXNlLnRoZW4ocmVzb2x2ZSAmJiBmdWxm
        aWxsbWVudEhhbmRsZXIsIHJlamVjdCk7CiAgfSwKCiAgLyoqCiAgICBSZXNv
        bHZlIGEgRGVmZXJyZWQgb2JqZWN0IGFuZCBjYWxsIGFueSBgZG9uZUNhbGxi
        YWNrc2Agd2l0aCB0aGUgZ2l2ZW4gYXJncy4KCiAgICBAbWV0aG9kIHJlc29s
        dmUKICAqLwogIHJlc29sdmU6IGZ1bmN0aW9uKHZhbHVlKSB7CiAgICB2YXIg
        ZGVmZXJyZWQsIHByb21pc2U7CgogICAgZGVmZXJyZWQgPSBnZXQodGhpcywg
        J19kZWZlcnJlZCcpOwogICAgcHJvbWlzZSA9IGRlZmVycmVkLnByb21pc2U7
        CgogICAgaWYgKHZhbHVlID09PSB0aGlzKSB7CiAgICAgIGRlZmVycmVkLnJl
        c29sdmUocHJvbWlzZSk7CiAgICB9IGVsc2UgewogICAgICBkZWZlcnJlZC5y
        ZXNvbHZlKHZhbHVlKTsKICAgIH0KICB9LAoKICAvKioKICAgIFJlamVjdCBh
        IERlZmVycmVkIG9iamVjdCBhbmQgY2FsbCBhbnkgYGZhaWxDYWxsYmFja3Ng
        IHdpdGggdGhlIGdpdmVuIGFyZ3MuCgogICAgQG1ldGhvZCByZWplY3QKICAq
        LwogIHJlamVjdDogZnVuY3Rpb24odmFsdWUpIHsKICAgIGdldCh0aGlzLCAn
        X2RlZmVycmVkJykucmVqZWN0KHZhbHVlKTsKICB9LAoKICBfZGVmZXJyZWQ6
        IEVtYmVyLmNvbXB1dGVkKGZ1bmN0aW9uKCkgewogICAgcmV0dXJuIFJTVlAu
        ZGVmZXIoKTsKICB9KQp9KTsKCgp9KSgpOwoKCgooZnVuY3Rpb24oKSB7Ci8q
        KgpAbW9kdWxlIGVtYmVyCkBzdWJtb2R1bGUgZW1iZXItcnVudGltZQoqLwoK
        dmFyIGdldCA9IEVtYmVyLmdldDsKCi8qKgogIFRoZSBgRW1iZXIuQWN0aW9u
        SGFuZGxlcmAgbWl4aW4gaW1wbGVtZW50cyBzdXBwb3J0IGZvciBtb3Zpbmcg
        YW4gYGFjdGlvbnNgCiAgcHJvcGVydHkgdG8gYW4gYF9hY3Rpb25zYCBwcm9w
        ZXJ0eSBhdCBleHRlbmQgdGltZSwgYW5kIGFkZGluZyBgX2FjdGlvbnNgCiAg
        dG8gdGhlIG9iamVjdCdzIG1lcmdlZFByb3BlcnRpZXMgbGlzdC4KCiAgYEVt
        YmVyLkFjdGlvbkhhbmRsZXJgIGlzIHVzZWQgaW50ZXJuYWxseSBieSBFbWJl
        ciBpbiAgYEVtYmVyLlZpZXdgLAogIGBFbWJlci5Db250cm9sbGVyYCwgYW5k
        IGBFbWJlci5Sb3V0ZWAuCgogIEBjbGFzcyBBY3Rpb25IYW5kbGVyCiAgQG5h
        bWVzcGFjZSBFbWJlcgoqLwpFbWJlci5BY3Rpb25IYW5kbGVyID0gRW1iZXIu
        TWl4aW4uY3JlYXRlKHsKICBtZXJnZWRQcm9wZXJ0aWVzOiBbJ19hY3Rpb25z
        J10sCgogIC8qKgogICAgQHByaXZhdGUKCiAgICBNb3ZlcyBgYWN0aW9uc2Ag
        dG8gYF9hY3Rpb25zYCBhdCBleHRlbmQgdGltZS4gTm90ZSB0aGF0IHRoaXMg
        Y3VycmVudGx5CiAgICBtb2RpZmllcyB0aGUgbWl4aW4gdGhlbXNlbHZlcywg
        d2hpY2ggaXMgdGVjaG5pY2FsbHkgZHViaW91cyBidXQKICAgIGlzIHByYWN0
        aWNhbGx5IG9mIGxpdHRsZSBjb25zZXF1ZW5jZS4gVGhpcyBtYXkgY2hhbmdl
        IGluIHRoZSBmdXR1cmUuCgogICAgQG1ldGhvZCB3aWxsTWVyZ2VNaXhpbgog
        ICovCiAgd2lsbE1lcmdlTWl4aW46IGZ1bmN0aW9uKHByb3BzKSB7CiAgICBp
        ZiAocHJvcHMuYWN0aW9ucyAmJiAhcHJvcHMuX2FjdGlvbnMpIHsKICAgICAg
        cHJvcHMuX2FjdGlvbnMgPSBFbWJlci5tZXJnZShwcm9wcy5fYWN0aW9ucyB8
        fCB7fSwgcHJvcHMuYWN0aW9ucyk7CiAgICAgIGRlbGV0ZSBwcm9wcy5hY3Rp
        b25zOwogICAgfQogIH0sCgogIHNlbmQ6IGZ1bmN0aW9uKGFjdGlvbk5hbWUp
        IHsKICAgIHZhciBhcmdzID0gW10uc2xpY2UuY2FsbChhcmd1bWVudHMsIDEp
        LCB0YXJnZXQ7CgogICAgaWYgKHRoaXMuX2FjdGlvbnMgJiYgdGhpcy5fYWN0
        aW9uc1thY3Rpb25OYW1lXSkgewogICAgICBpZiAodGhpcy5fYWN0aW9uc1th
        Y3Rpb25OYW1lXS5hcHBseSh0aGlzLCBhcmdzKSA9PT0gdHJ1ZSkgewogICAg
        ICAgIC8vIGhhbmRsZXIgcmV0dXJuZWQgdHJ1ZSwgc28gdGhpcyBhY3Rpb24g
        d2lsbCBidWJibGUKICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm47CiAg
        ICAgIH0KICAgIH0gZWxzZSBpZiAodGhpcy5kZXByZWNhdGVkU2VuZCAmJiB0
        aGlzLmRlcHJlY2F0ZWRTZW5kSGFuZGxlcyAmJiB0aGlzLmRlcHJlY2F0ZWRT
        ZW5kSGFuZGxlcyhhY3Rpb25OYW1lKSkgewogICAgICBpZiAodGhpcy5kZXBy
        ZWNhdGVkU2VuZC5hcHBseSh0aGlzLCBbXS5zbGljZS5jYWxsKGFyZ3VtZW50
        cykpID09PSB0cnVlKSB7CiAgICAgICAgLy8gaGFuZGxlciByZXR1cm4gdHJ1
        ZSwgc28gdGhpcyBhY3Rpb24gd2lsbCBidWJibGUKICAgICAgfSBlbHNlIHsK
        ICAgICAgICByZXR1cm47CiAgICAgIH0KICAgIH0KCiAgICBpZiAodGFyZ2V0
        ID0gZ2V0KHRoaXMsICd0YXJnZXQnKSkgewogICAgICBFbWJlci5hc3NlcnQo
        IlRoZSBgdGFyZ2V0YCBmb3IgIiArIHRoaXMgKyAiICgiICsgdGFyZ2V0ICsg
        IikgZG9lcyBub3QgaGF2ZSBhIGBzZW5kYCBtZXRob2QiLCB0eXBlb2YgdGFy
        Z2V0LnNlbmQgPT09ICdmdW5jdGlvbicpOwogICAgICB0YXJnZXQuc2VuZC5h
        cHBseSh0YXJnZXQsIGFyZ3VtZW50cyk7CiAgICB9CiAgfQoKfSk7Cgp9KSgp
        OwoKCgooZnVuY3Rpb24oKSB7CnZhciBzZXQgPSBFbWJlci5zZXQsIGdldCA9
        IEVtYmVyLmdldCwKICAgIHJlc29sdmUgPSBFbWJlci5SU1ZQLnJlc29sdmUs
        CiAgICByZXRocm93ID0gRW1iZXIuUlNWUC5yZXRocm93LAogICAgbm90ID0g
        RW1iZXIuY29tcHV0ZWQubm90LAogICAgb3IgPSBFbWJlci5jb21wdXRlZC5v
        cjsKCi8qKgogIEBtb2R1bGUgZW1iZXIKICBAc3VibW9kdWxlIGVtYmVyLXJ1
        bnRpbWUKICovCgpmdW5jdGlvbiBpbnN0YWxsUHJvbWlzZShwcm94eSwgcHJv
        bWlzZSkgewogIHByb21pc2UudGhlbihmdW5jdGlvbih2YWx1ZSkgewogICAg
        c2V0KHByb3h5LCAnaXNGdWxmaWxsZWQnLCB0cnVlKTsKICAgIHNldChwcm94
        eSwgJ2NvbnRlbnQnLCB2YWx1ZSk7CgogICAgcmV0dXJuIHZhbHVlOwogIH0s
        IGZ1bmN0aW9uKHJlYXNvbikgewogICAgc2V0KHByb3h5LCAnaXNSZWplY3Rl
        ZCcsIHRydWUpOwogICAgc2V0KHByb3h5LCAncmVhc29uJywgcmVhc29uKTsK
        ICB9KS5mYWlsKHJldGhyb3cpOwp9CgovKioKICBBIGxvdyBsZXZlbCBtaXhp
        biBtYWtpbmcgT2JqZWN0UHJveHksIE9iamVjdENvbnRyb2xsZXIgb3IgQXJy
        YXlDb250cm9sbGVyJ3MgcHJvbWlzZSBhd2FyZS4KCiAgYGBgamF2YXNjcmlw
        dAogIHZhciBPYmplY3RQcm9taXNlQ29udHJvbGxlciA9IEVtYmVyLk9iamVj
        dENvbnRyb2xsZXIuZXh0ZW5kKEVtYmVyLlByb21pc2VQcm94eU1peGluKTsK
        CiAgdmFyIGNvbnRyb2xsZXIgPSBPYmplY3RQcm9taXNlQ29udHJvbGxlci5j
        cmVhdGUoewogICAgcHJvbWlzZTogJC5nZXRKU09OKCcvc29tZS9yZW1vdGUv
        ZGF0YS5qc29uJykKICB9KTsKCiAgY29udHJvbGxlci50aGVuKGZ1bmN0aW9u
        KGpzb24pewogICAgIC8vIHRoZSBqc29uCiAgfSwgZnVuY3Rpb24ocmVhc29u
        KSB7CiAgICAgLy8gdGhlIHJlYXNvbiB3aHkgeW91IGhhdmUgbm8ganNvbgog
        IH0pOwogIGBgYAoKICB0aGUgY29udHJvbGxlciBoYXMgYmluZGFibGUgYXR0
        cmlidXRlcyB3aGljaAogIHRyYWNrIHRoZSBwcm9taXNlcyBsaWZlIGN5Y2xl
        CgogIGBgYGphdmFzY3JpcHQKICBjb250cm9sbGVyLmdldCgnaXNQZW5kaW5n
        JykgICAvLz0+IHRydWUKICBjb250cm9sbGVyLmdldCgnaXNTZXR0bGVkJykg
        IC8vPT4gZmFsc2UKICBjb250cm9sbGVyLmdldCgnaXNSZWplY3RlZCcpICAv
        Lz0+IGZhbHNlCiAgY29udHJvbGxlci5nZXQoJ2lzRnVsZmlsbGVkJykgLy89
        PiBmYWxzZQogIGBgYAoKICBXaGVuIHRoZSB0aGUgJC5nZXRKU09OIGNvbXBs
        ZXRlcywgYW5kIHRoZSBwcm9taXNlIGlzIGZ1bGZpbGxlZAogIHdpdGgganNv
        biwgdGhlIGxpZmUgY3ljbGUgYXR0cmlidXRlcyB3aWxsIHVwZGF0ZSBhY2Nv
        cmRpbmdseS4KCiAgYGBgamF2YXNjcmlwdAogIGNvbnRyb2xsZXIuZ2V0KCdp
        c1BlbmRpbmcnKSAgIC8vPT4gZmFsc2UKICBjb250cm9sbGVyLmdldCgnaXNT
        ZXR0bGVkJykgICAvLz0+IHRydWUKICBjb250cm9sbGVyLmdldCgnaXNSZWpl
        Y3RlZCcpICAvLz0+IGZhbHNlCiAgY29udHJvbGxlci5nZXQoJ2lzRnVsZmls
        bGVkJykgLy89PiB0cnVlCiAgYGBgCgogIEFzIHRoZSBjb250cm9sbGVyIGlz
        IGFuIE9iamVjdENvbnRyb2xsZXIsIGFuZCB0aGUganNvbiBub3cgaXRzIGNv
        bnRlbnQsCiAgYWxsIHRoZSBqc29uIHByb3BlcnRpZXMgd2lsbCBiZSBhdmFp
        bGFibGUgZGlyZWN0bHkgZnJvbSB0aGUgY29udHJvbGxlci4KCiAgYGBgamF2
        YXNjcmlwdAogIC8vIEFzc3VtaW5nIHRoZSBmb2xsb3dpbmcganNvbjoKICB7
        CiAgICBmaXJzdE5hbWU6ICdTdGVmYW4nLAogICAgbGFzdE5hbWU6ICdQZW5u
        ZXInCiAgfQoKICAvLyBib3RoIHByb3BlcnRpZXMgd2lsbCBhY2Nlc3NpYmxl
        IG9uIHRoZSBjb250cm9sbGVyCiAgY29udHJvbGxlci5nZXQoJ2ZpcnN0TmFt
        ZScpIC8vPT4gJ1N0ZWZhbicKICBjb250cm9sbGVyLmdldCgnbGFzdE5hbWUn
        KSAgLy89PiAnUGVubmVyJwogIGBgYAoKICBJZiB0aGUgY29udHJvbGxlciBp
        cyBiYWNraW5nIGEgdGVtcGxhdGUsIHRoZSBhdHRyaWJ1dGVzIGFyZSAKICBi
        aW5kYWJsZSBmcm9tIHdpdGhpbiB0aGF0IHRlbXBsYXRlCgogIGBgYGhhbmRs
        ZWJhcnMKICB7eyNpZiBpc1BlbmRpbmd9fQogICAgbG9hZGluZy4uLgogIHt7
        ZWxzZX19CiAgICBmaXJzdE5hbWU6IHt7Zmlyc3ROYW1lfX0KICAgIGxhc3RO
        YW1lOiB7e2xhc3ROYW1lfX0KICB7ey9pZn19CiAgYGBgCiAgQGNsYXNzIEVt
        YmVyLlByb21pc2VQcm94eU1peGluCiovCkVtYmVyLlByb21pc2VQcm94eU1p
        eGluID0gRW1iZXIuTWl4aW4uY3JlYXRlKHsKICByZWFzb246ICAgIG51bGws
        CiAgaXNQZW5kaW5nOiAgbm90KCdpc1NldHRsZWQnKS5yZWFkT25seSgpLAog
        IGlzU2V0dGxlZDogIG9yKCdpc1JlamVjdGVkJywgJ2lzRnVsZmlsbGVkJyku
        cmVhZE9ubHkoKSwKICBpc1JlamVjdGVkOiAgZmFsc2UsCiAgaXNGdWxmaWxs
        ZWQ6IGZhbHNlLAoKICBwcm9taXNlOiBFbWJlci5jb21wdXRlZChmdW5jdGlv
        bihrZXksIHByb21pc2UpIHsKICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID09
        PSAyKSB7CiAgICAgIHByb21pc2UgPSByZXNvbHZlKHByb21pc2UpOwogICAg
        ICBpbnN0YWxsUHJvbWlzZSh0aGlzLCBwcm9taXNlKTsKICAgICAgcmV0dXJu
        IHByb21pc2U7CiAgICB9IGVsc2UgewogICAgICB0aHJvdyBuZXcgRW1iZXIu
        RXJyb3IoIlByb21pc2VQcm94eSdzIHByb21pc2UgbXVzdCBiZSBzZXQiKTsK
        ICAgIH0KICB9KSwKCiAgdGhlbjogZnVuY3Rpb24oZnVsZmlsbCwgcmVqZWN0
        KSB7CiAgICByZXR1cm4gZ2V0KHRoaXMsICdwcm9taXNlJykudGhlbihmdWxm
        aWxsLCByZWplY3QpOwogIH0KfSk7CgoKfSkoKTsKCgoKKGZ1bmN0aW9uKCkg
        ewoKfSkoKTsKCgoKKGZ1bmN0aW9uKCkgewp2YXIgZ2V0ID0gRW1iZXIuZ2V0
        LAogICAgZm9yRWFjaCA9IEVtYmVyLkVudW1lcmFibGVVdGlscy5mb3JFYWNo
        LAogICAgUkVUQUlOID0gJ3InLAogICAgSU5TRVJUID0gJ2knLAogICAgREVM
        RVRFID0gJ2QnOwoKLyoqCiAgQW4gYEVtYmVyLlRyYWNrZWRBcnJheWAgdHJh
        Y2tzIGFycmF5IG9wZXJhdGlvbnMuICBJdCdzIHVzZWZ1bCB3aGVuIHlvdSB3
        YW50IHRvCiAgbGF6aWx5IGNvbXB1dGUgdGhlIGluZGV4ZXMgb2YgaXRlbXMg
        aW4gYW4gYXJyYXkgYWZ0ZXIgdGhleSd2ZSBiZWVuIHNoaWZ0ZWQgYnkKICBz
        dWJzZXF1ZW50IG9wZXJhdGlvbnMuCgogIEBjbGFzcyBUcmFja2VkQXJyYXkK
        ICBAbmFtZXNwYWNlIEVtYmVyCiAgQHBhcmFtIHthcnJheX0gW2l0ZW1zPVtd
        XSBUaGUgYXJyYXkgdG8gYmUgdHJhY2tlZC4gIFRoaXMgaXMgdXNlZCBqdXN0
        IHRvIGdldAogIHRoZSBpbml0aWFsIGl0ZW1zIGZvciB0aGUgc3RhcnRpbmcg
        c3RhdGUgb2YgcmV0YWluOm4uCiovCkVtYmVyLlRyYWNrZWRBcnJheSA9IGZ1
        bmN0aW9uIChpdGVtcykgewogIGlmIChhcmd1bWVudHMubGVuZ3RoIDwgMSkg
        eyBpdGVtcyA9IFtdOyB9CgogIHZhciBsZW5ndGggPSBnZXQoaXRlbXMsICds
        ZW5ndGgnKTsKCiAgaWYgKGxlbmd0aCkgewogICAgdGhpcy5fb3BlcmF0aW9u
        cyA9IFtuZXcgQXJyYXlPcGVyYXRpb24oUkVUQUlOLCBsZW5ndGgsIGl0ZW1z
        KV07CiAgfSBlbHNlIHsKICAgIHRoaXMuX29wZXJhdGlvbnMgPSBbXTsKICB9
        Cn07CgpFbWJlci5UcmFja2VkQXJyYXkuUkVUQUlOID0gUkVUQUlOOwpFbWJl
        ci5UcmFja2VkQXJyYXkuSU5TRVJUID0gSU5TRVJUOwpFbWJlci5UcmFja2Vk
        QXJyYXkuREVMRVRFID0gREVMRVRFOwoKRW1iZXIuVHJhY2tlZEFycmF5LnBy
        b3RvdHlwZSA9IHsKCiAgLyoqCiAgICBUcmFjayB0aGF0IGBuZXdJdGVtc2Ag
        d2VyZSBhZGRlZCB0byB0aGUgdHJhY2tlZCBhcnJheSBhdCBgaW5kZXhgLgoK
        ICAgIEBtZXRob2QgYWRkSXRlbXMKICAgIEBwYXJhbSBpbmRleAogICAgQHBh
        cmFtIG5ld0l0ZW1zCiAgKi8KICBhZGRJdGVtczogZnVuY3Rpb24gKGluZGV4
        LCBuZXdJdGVtcykgewogICAgdmFyIGNvdW50ID0gZ2V0KG5ld0l0ZW1zLCAn
        bGVuZ3RoJyk7CiAgICBpZiAoY291bnQgPCAxKSB7IHJldHVybjsgfQoKICAg
        IHZhciBtYXRjaCA9IHRoaXMuX2ZpbmRBcnJheU9wZXJhdGlvbihpbmRleCks
        CiAgICAgICAgYXJyYXlPcGVyYXRpb24gPSBtYXRjaC5vcGVyYXRpb24sCiAg
        ICAgICAgYXJyYXlPcGVyYXRpb25JbmRleCA9IG1hdGNoLmluZGV4LAogICAg
        ICAgIGFycmF5T3BlcmF0aW9uUmFuZ2VTdGFydCA9IG1hdGNoLnJhbmdlU3Rh
        cnQsCiAgICAgICAgY29tcG9zZUluZGV4LAogICAgICAgIHNwbGl0SW5kZXgs
        CiAgICAgICAgc3BsaXRJdGVtcywKICAgICAgICBzcGxpdEFycmF5T3BlcmF0
        aW9uLAogICAgICAgIG5ld0FycmF5T3BlcmF0aW9uOwoKICAgIG5ld0FycmF5
        T3BlcmF0aW9uID0gbmV3IEFycmF5T3BlcmF0aW9uKElOU0VSVCwgY291bnQs
        IG5ld0l0ZW1zKTsKCiAgICBpZiAoYXJyYXlPcGVyYXRpb24pIHsKICAgICAg
        aWYgKCFtYXRjaC5zcGxpdCkgewogICAgICAgIC8vIGluc2VydCBsZWZ0IG9m
        IGFycmF5T3BlcmF0aW9uCiAgICAgICAgdGhpcy5fb3BlcmF0aW9ucy5zcGxp
        Y2UoYXJyYXlPcGVyYXRpb25JbmRleCwgMCwgbmV3QXJyYXlPcGVyYXRpb24p
        OwogICAgICAgIGNvbXBvc2VJbmRleCA9IGFycmF5T3BlcmF0aW9uSW5kZXg7
        CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5fc3BsaXQoYXJyYXlPcGVy
        YXRpb25JbmRleCwgaW5kZXggLSBhcnJheU9wZXJhdGlvblJhbmdlU3RhcnQs
        IG5ld0FycmF5T3BlcmF0aW9uKTsKICAgICAgICBjb21wb3NlSW5kZXggPSBh
        cnJheU9wZXJhdGlvbkluZGV4ICsgMTsKICAgICAgfQogICAgfSBlbHNlIHsK
        ICAgICAgLy8gaW5zZXJ0IGF0IGVuZAogICAgICB0aGlzLl9vcGVyYXRpb25z
        LnB1c2gobmV3QXJyYXlPcGVyYXRpb24pOwogICAgICBjb21wb3NlSW5kZXgg
        PSBhcnJheU9wZXJhdGlvbkluZGV4OwogICAgfQoKICAgIHRoaXMuX2NvbXBv
        c2VJbnNlcnQoY29tcG9zZUluZGV4KTsKICB9LAoKICAvKioKICAgIFRyYWNr
        IHRoYXQgYGNvdW50YCBpdGVtcyB3ZXJlIHJlbW92ZWQgYXQgYGluZGV4YC4K
        CiAgICBAbWV0aG9kIHJlbW92ZUl0ZW1zCiAgICBAcGFyYW0gaW5kZXgKICAg
        IEBwYXJhbSBjb3VudAogICovCiAgcmVtb3ZlSXRlbXM6IGZ1bmN0aW9uIChp
        bmRleCwgY291bnQpIHsKICAgIGlmIChjb3VudCA8IDEpIHsgcmV0dXJuOyB9
        CgogICAgdmFyIG1hdGNoID0gdGhpcy5fZmluZEFycmF5T3BlcmF0aW9uKGlu
        ZGV4KSwKICAgICAgICBhcnJheU9wZXJhdGlvbiA9IG1hdGNoLm9wZXJhdGlv
        biwKICAgICAgICBhcnJheU9wZXJhdGlvbkluZGV4ID0gbWF0Y2guaW5kZXgs
        CiAgICAgICAgYXJyYXlPcGVyYXRpb25SYW5nZVN0YXJ0ID0gbWF0Y2gucmFu
        Z2VTdGFydCwKICAgICAgICBuZXdBcnJheU9wZXJhdGlvbiwKICAgICAgICBj
        b21wb3NlSW5kZXg7CgogICAgbmV3QXJyYXlPcGVyYXRpb24gPSBuZXcgQXJy
        YXlPcGVyYXRpb24oREVMRVRFLCBjb3VudCk7CiAgICBpZiAoIW1hdGNoLnNw
        bGl0KSB7CiAgICAgIC8vIGluc2VydCBsZWZ0IG9mIGFycmF5T3BlcmF0aW9u
        CiAgICAgIHRoaXMuX29wZXJhdGlvbnMuc3BsaWNlKGFycmF5T3BlcmF0aW9u
        SW5kZXgsIDAsIG5ld0FycmF5T3BlcmF0aW9uKTsKICAgICAgY29tcG9zZUlu
        ZGV4ID0gYXJyYXlPcGVyYXRpb25JbmRleDsKICAgIH0gZWxzZSB7CiAgICAg
        IHRoaXMuX3NwbGl0KGFycmF5T3BlcmF0aW9uSW5kZXgsIGluZGV4IC0gYXJy
        YXlPcGVyYXRpb25SYW5nZVN0YXJ0LCBuZXdBcnJheU9wZXJhdGlvbik7CiAg
        ICAgIGNvbXBvc2VJbmRleCA9IGFycmF5T3BlcmF0aW9uSW5kZXggKyAxOwog
        ICAgfQoKICAgIHJldHVybiB0aGlzLl9jb21wb3NlRGVsZXRlKGNvbXBvc2VJ
        bmRleCk7CiAgfSwKCiAgLyoqCiAgICBBcHBseSBhbGwgb3BlcmF0aW9ucywg
        cmVkdWNpbmcgdGhlbSB0byByZXRhaW46biwgZm9yIGBuYCwgdGhlIG51bWJl
        ciBvZgogICAgaXRlbXMgaW4gdGhlIGFycmF5LgoKICAgIGBjYWxsYmFja2Ag
        d2lsbCBiZSBjYWxsZWQgZm9yIGVhY2ggb3BlcmF0aW9uIGFuZCB3aWxsIGJl
        IHBhc3NlZCB0aGUgZm9sbG93aW5nIGFyZ3VtZW50czoKICAgICAgKiB7YXJy
        YXl9IGl0ZW1zIFRoZSBpdGVtcyBmb3IgdGhlIGdpdmVuIG9wZXJhdGlvbgog
        ICAgICAqIHtudW1iZXJ9IG9mZnNldCBUaGUgY29tcHV0ZWQgb2Zmc2V0IG9m
        IHRoZSBpdGVtcywgaWUgdGhlIGluZGV4IGluIHRoZQogICAgICBhcnJheSBv
        ZiB0aGUgZmlyc3QgaXRlbSBmb3IgdGhpcyBvcGVyYXRpb24uCiAgICAgICog
        e3N0cmluZ30gb3BlcmF0aW9uIFRoZSB0eXBlIG9mIHRoZSBvcGVyYXRpb24u
        ICBPbmUgb2YKICAgICAgYEVtYmVyLlRyYWNrZWRBcnJheS57UkVUQUlOLCBE
        RUxFVEUsIElOU0VSVH1gCgogICAgQG1ldGhvZCBhcHBseQogICAgQHBhcmFt
        IHtmdW5jdGlvbn0gY2FsbGJhY2sKICAqLwogIGFwcGx5OiBmdW5jdGlvbiAo
        Y2FsbGJhY2spIHsKICAgIHZhciBpdGVtcyA9IFtdLAogICAgICAgIG9mZnNl
        dCA9IDA7CgogICAgZm9yRWFjaCh0aGlzLl9vcGVyYXRpb25zLCBmdW5jdGlv
        biAoYXJyYXlPcGVyYXRpb24pIHsKICAgICAgY2FsbGJhY2soYXJyYXlPcGVy
        YXRpb24uaXRlbXMsIG9mZnNldCwgYXJyYXlPcGVyYXRpb24udHlwZSk7Cgog
        ICAgICBpZiAoYXJyYXlPcGVyYXRpb24udHlwZSAhPT0gREVMRVRFKSB7CiAg
        ICAgICAgb2Zmc2V0ICs9IGFycmF5T3BlcmF0aW9uLmNvdW50OwogICAgICAg
        IGl0ZW1zID0gaXRlbXMuY29uY2F0KGFycmF5T3BlcmF0aW9uLml0ZW1zKTsK
        ICAgICAgfQogICAgfSk7CgogICAgdGhpcy5fb3BlcmF0aW9ucyA9IFtuZXcg
        QXJyYXlPcGVyYXRpb24oUkVUQUlOLCBpdGVtcy5sZW5ndGgsIGl0ZW1zKV07
        CiAgfSwKCiAgLyoqCiAgICBSZXR1cm4gYW4gQXJyYXlPcGVyYXRpb25NYXRj
        aCBmb3IgdGhlIG9wZXJhdGlvbiB0aGF0IGNvbnRhaW5zIHRoZSBpdGVtIGF0
        IGBpbmRleGAuCgogICAgQG1ldGhvZCBfZmluZEFycmF5T3BlcmF0aW9uCgog
        ICAgQHBhcmFtIHtudW1iZXJ9IGluZGV4IHRoZSBpbmRleCBvZiB0aGUgaXRl
        bSB3aG9zZSBvcGVyYXRpb24gaW5mb3JtYXRpb24KICAgIHNob3VsZCBiZSBy
        ZXR1cm5lZC4KICAgIEBwcml2YXRlCiAgKi8KICBfZmluZEFycmF5T3BlcmF0
        aW9uOiBmdW5jdGlvbiAoaW5kZXgpIHsKICAgIHZhciBhcnJheU9wZXJhdGlv
        bkluZGV4LAogICAgICAgIGxlbiwKICAgICAgICBzcGxpdCA9IGZhbHNlLAog
        ICAgICAgIGFycmF5T3BlcmF0aW9uLAogICAgICAgIGFycmF5T3BlcmF0aW9u
        UmFuZ2VTdGFydCwKICAgICAgICBhcnJheU9wZXJhdGlvblJhbmdlRW5kOwoK
        ICAgIC8vIE9QVElNSVpFOiB3ZSBjb3VsZCBzZWFyY2ggdGhlc2UgZmFzdGVy
        IGlmIHdlIGtlcHQgYSBiYWxhbmNlZCB0cmVlLgogICAgLy8gZmluZCBsZWZ0
        bW9zdCBhcnJheU9wZXJhdGlvbiB0byB0aGUgcmlnaHQgb2YgYGluZGV4YAog
        ICAgZm9yIChhcnJheU9wZXJhdGlvbkluZGV4ID0gYXJyYXlPcGVyYXRpb25S
        YW5nZVN0YXJ0ID0gMCwgbGVuID0gdGhpcy5fb3BlcmF0aW9ucy5sZW5ndGg7
        IGFycmF5T3BlcmF0aW9uSW5kZXggPCBsZW47ICsrYXJyYXlPcGVyYXRpb25J
        bmRleCkgewogICAgICBhcnJheU9wZXJhdGlvbiA9IHRoaXMuX29wZXJhdGlv
        bnNbYXJyYXlPcGVyYXRpb25JbmRleF07CgogICAgICBpZiAoYXJyYXlPcGVy
        YXRpb24udHlwZSA9PT0gREVMRVRFKSB7IGNvbnRpbnVlOyB9CgogICAgICBh
        cnJheU9wZXJhdGlvblJhbmdlRW5kID0gYXJyYXlPcGVyYXRpb25SYW5nZVN0
        YXJ0ICsgYXJyYXlPcGVyYXRpb24uY291bnQgLSAxOwoKICAgICAgaWYgKGlu
        ZGV4ID09PSBhcnJheU9wZXJhdGlvblJhbmdlU3RhcnQpIHsKICAgICAgICBi
        cmVhazsKICAgICAgfSBlbHNlIGlmIChpbmRleCA+IGFycmF5T3BlcmF0aW9u
        UmFuZ2VTdGFydCAmJiBpbmRleCA8PSBhcnJheU9wZXJhdGlvblJhbmdlRW5k
        KSB7CiAgICAgICAgc3BsaXQgPSB0cnVlOwogICAgICAgIGJyZWFrOwogICAg
        ICB9IGVsc2UgewogICAgICAgIGFycmF5T3BlcmF0aW9uUmFuZ2VTdGFydCA9
        IGFycmF5T3BlcmF0aW9uUmFuZ2VFbmQgKyAxOwogICAgICB9CiAgICB9Cgog
        ICAgcmV0dXJuIG5ldyBBcnJheU9wZXJhdGlvbk1hdGNoKGFycmF5T3BlcmF0
        aW9uLCBhcnJheU9wZXJhdGlvbkluZGV4LCBzcGxpdCwgYXJyYXlPcGVyYXRp
        b25SYW5nZVN0YXJ0KTsKICB9LAoKICBfc3BsaXQ6IGZ1bmN0aW9uIChhcnJh
        eU9wZXJhdGlvbkluZGV4LCBzcGxpdEluZGV4LCBuZXdBcnJheU9wZXJhdGlv
        bikgewogICAgdmFyIGFycmF5T3BlcmF0aW9uID0gdGhpcy5fb3BlcmF0aW9u
        c1thcnJheU9wZXJhdGlvbkluZGV4XSwKICAgICAgICBzcGxpdEl0ZW1zID0g
        YXJyYXlPcGVyYXRpb24uaXRlbXMuc2xpY2Uoc3BsaXRJbmRleCksCiAgICAg
        ICAgc3BsaXRBcnJheU9wZXJhdGlvbiA9IG5ldyBBcnJheU9wZXJhdGlvbihh
        cnJheU9wZXJhdGlvbi50eXBlLCBzcGxpdEl0ZW1zLmxlbmd0aCwgc3BsaXRJ
        dGVtcyk7CgogICAgLy8gdHJ1bmNhdGUgTEhTCiAgICBhcnJheU9wZXJhdGlv
        bi5jb3VudCA9IHNwbGl0SW5kZXg7CiAgICBhcnJheU9wZXJhdGlvbi5pdGVt
        cyA9IGFycmF5T3BlcmF0aW9uLml0ZW1zLnNsaWNlKDAsIHNwbGl0SW5kZXgp
        OwoKICAgIHRoaXMuX29wZXJhdGlvbnMuc3BsaWNlKGFycmF5T3BlcmF0aW9u
        SW5kZXggKyAxLCAwLCBuZXdBcnJheU9wZXJhdGlvbiwgc3BsaXRBcnJheU9w
        ZXJhdGlvbik7CiAgfSwKCiAgLy8gc2VlIFN1YkFycmF5IGZvciBhIGJldHRl
        ciBpbXBsZW1lbnRhdGlvbi4KICBfY29tcG9zZUluc2VydDogZnVuY3Rpb24g
        KGluZGV4KSB7CiAgICB2YXIgbmV3QXJyYXlPcGVyYXRpb24gPSB0aGlzLl9v
        cGVyYXRpb25zW2luZGV4XSwKICAgICAgICBsZWZ0QXJyYXlPcGVyYXRpb24g
        PSB0aGlzLl9vcGVyYXRpb25zW2luZGV4LTFdLCAvLyBtYXkgYmUgdW5kZWZp
        bmVkCiAgICAgICAgcmlnaHRBcnJheU9wZXJhdGlvbiA9IHRoaXMuX29wZXJh
        dGlvbnNbaW5kZXgrMV0sIC8vIG1heSBiZSB1bmRlZmluZWQKICAgICAgICBs
        ZWZ0T3AgPSBsZWZ0QXJyYXlPcGVyYXRpb24gJiYgbGVmdEFycmF5T3BlcmF0
        aW9uLnR5cGUsCiAgICAgICAgcmlnaHRPcCA9IHJpZ2h0QXJyYXlPcGVyYXRp
        b24gJiYgcmlnaHRBcnJheU9wZXJhdGlvbi50eXBlOwoKICAgIGlmIChsZWZ0
        T3AgPT09IElOU0VSVCkgewogICAgICAgIC8vIG1lcmdlIGxlZnQKICAgICAg
        ICBsZWZ0QXJyYXlPcGVyYXRpb24uY291bnQgKz0gbmV3QXJyYXlPcGVyYXRp
        b24uY291bnQ7CiAgICAgICAgbGVmdEFycmF5T3BlcmF0aW9uLml0ZW1zID0g
        bGVmdEFycmF5T3BlcmF0aW9uLml0ZW1zLmNvbmNhdChuZXdBcnJheU9wZXJh
        dGlvbi5pdGVtcyk7CgogICAgICBpZiAocmlnaHRPcCA9PT0gSU5TRVJUKSB7
        CiAgICAgICAgLy8gYWxzbyBtZXJnZSByaWdodCAod2UgaGF2ZSBzcGxpdCBh
        biBpbnNlcnQgd2l0aCBhbiBpbnNlcnQpCiAgICAgICAgbGVmdEFycmF5T3Bl
        cmF0aW9uLmNvdW50ICs9IHJpZ2h0QXJyYXlPcGVyYXRpb24uY291bnQ7CiAg
        ICAgICAgbGVmdEFycmF5T3BlcmF0aW9uLml0ZW1zID0gbGVmdEFycmF5T3Bl
        cmF0aW9uLml0ZW1zLmNvbmNhdChyaWdodEFycmF5T3BlcmF0aW9uLml0ZW1z
        KTsKICAgICAgICB0aGlzLl9vcGVyYXRpb25zLnNwbGljZShpbmRleCwgMik7
        CiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy8gb25seSBtZXJnZSBsZWZ0CiAg
        ICAgICAgdGhpcy5fb3BlcmF0aW9ucy5zcGxpY2UoaW5kZXgsIDEpOwogICAg
        ICB9CiAgICB9IGVsc2UgaWYgKHJpZ2h0T3AgPT09IElOU0VSVCkgewogICAg
        ICAvLyBtZXJnZSByaWdodAogICAgICBuZXdBcnJheU9wZXJhdGlvbi5jb3Vu
        dCArPSByaWdodEFycmF5T3BlcmF0aW9uLmNvdW50OwogICAgICBuZXdBcnJh
        eU9wZXJhdGlvbi5pdGVtcyA9IG5ld0FycmF5T3BlcmF0aW9uLml0ZW1zLmNv
        bmNhdChyaWdodEFycmF5T3BlcmF0aW9uLml0ZW1zKTsKICAgICAgdGhpcy5f
        b3BlcmF0aW9ucy5zcGxpY2UoaW5kZXggKyAxLCAxKTsKICAgIH0KICB9LAoK
        ICBfY29tcG9zZURlbGV0ZTogZnVuY3Rpb24gKGluZGV4KSB7CiAgICB2YXIg
        YXJyYXlPcGVyYXRpb24gPSB0aGlzLl9vcGVyYXRpb25zW2luZGV4XSwKICAg
        ICAgICBkZWxldGVzVG9HbyA9IGFycmF5T3BlcmF0aW9uLmNvdW50LAogICAg
        ICAgIGxlZnRBcnJheU9wZXJhdGlvbiA9IHRoaXMuX29wZXJhdGlvbnNbaW5k
        ZXgtMV0sIC8vIG1heSBiZSB1bmRlZmluZWQKICAgICAgICBsZWZ0T3AgPSBs
        ZWZ0QXJyYXlPcGVyYXRpb24gJiYgbGVmdEFycmF5T3BlcmF0aW9uLnR5cGUs
        CiAgICAgICAgbmV4dEFycmF5T3BlcmF0aW9uLAogICAgICAgIG5leHRPcCwK
        ICAgICAgICBuZXh0Q291bnQsCiAgICAgICAgcmVtb3ZlTmV3QW5kTmV4dE9w
        ID0gZmFsc2UsCiAgICAgICAgcmVtb3ZlZEl0ZW1zID0gW107CgogICAgaWYg
        KGxlZnRPcCA9PT0gREVMRVRFKSB7CiAgICAgIGFycmF5T3BlcmF0aW9uID0g
        bGVmdEFycmF5T3BlcmF0aW9uOwogICAgICBpbmRleCAtPSAxOwogICAgfQoK
        ICAgIGZvciAodmFyIGkgPSBpbmRleCArIDE7IGRlbGV0ZXNUb0dvID4gMDsg
        KytpKSB7CiAgICAgIG5leHRBcnJheU9wZXJhdGlvbiA9IHRoaXMuX29wZXJh
        dGlvbnNbaV07CiAgICAgIG5leHRPcCA9IG5leHRBcnJheU9wZXJhdGlvbi50
        eXBlOwogICAgICBuZXh0Q291bnQgPSBuZXh0QXJyYXlPcGVyYXRpb24uY291
        bnQ7CgogICAgICBpZiAobmV4dE9wID09PSBERUxFVEUpIHsKICAgICAgICBh
        cnJheU9wZXJhdGlvbi5jb3VudCArPSBuZXh0Q291bnQ7CiAgICAgICAgY29u
        dGludWU7CiAgICAgIH0KCiAgICAgIGlmIChuZXh0Q291bnQgPiBkZWxldGVz
        VG9HbykgewogICAgICAgIC8vIGQ6MiB7cixpfTo1ICB3ZSByZWR1Y2UgdGhl
        IHJldGFpbiBvciBpbnNlcnQsIGJ1dCBpdCBzdGF5cwogICAgICAgIHJlbW92
        ZWRJdGVtcyA9IHJlbW92ZWRJdGVtcy5jb25jYXQobmV4dEFycmF5T3BlcmF0
        aW9uLml0ZW1zLnNwbGljZSgwLCBkZWxldGVzVG9HbykpOwogICAgICAgIG5l
        eHRBcnJheU9wZXJhdGlvbi5jb3VudCAtPSBkZWxldGVzVG9HbzsKCiAgICAg
        ICAgLy8gSW4gdGhlIGNhc2Ugd2hlcmUgd2UgdHJ1bmNhdGUgdGhlIGxhc3Qg
        YXJyYXlPcGVyYXRpb24sIHdlIGRvbid0IG5lZWQgdG8KICAgICAgICAvLyBy
        ZW1vdmUgaXQ7IGFsc28gdGhlIGRlbGV0ZXNUb0dvIHJlZHVjdGlvbiBpcyBu
        b3QgdGhlIGVudGlyZXR5IG9mCiAgICAgICAgLy8gbmV4dENvdW50CiAgICAg
        ICAgaSAtPSAxOwogICAgICAgIG5leHRDb3VudCA9IGRlbGV0ZXNUb0dvOwoK
        ICAgICAgICBkZWxldGVzVG9HbyA9IDA7CiAgICAgIH0gZWxzZSB7CiAgICAg
        ICAgaWYgKG5leHRDb3VudCA9PT0gZGVsZXRlc1RvR28pIHsKICAgICAgICAg
        IC8vIEhhbmRsZSBlZGdlIGNhc2Ugb2YgZDoyIGk6MiBpbiB3aGljaCBjYXNl
        IGJvdGggb3BlcmF0aW9ucyBnbyBhd2F5CiAgICAgICAgICAvLyBkdXJpbmcg
        Y29tcG9zaXRpb24uCiAgICAgICAgICByZW1vdmVOZXdBbmROZXh0T3AgPSB0
        cnVlOwogICAgICAgIH0KICAgICAgICByZW1vdmVkSXRlbXMgPSByZW1vdmVk
        SXRlbXMuY29uY2F0KG5leHRBcnJheU9wZXJhdGlvbi5pdGVtcyk7CiAgICAg
        ICAgZGVsZXRlc1RvR28gLT0gbmV4dENvdW50OwogICAgICB9CgogICAgICBp
        ZiAobmV4dE9wID09PSBJTlNFUlQpIHsKICAgICAgICAvLyBkOjIgaTozIHdp
        bGwgcmVzdWx0IGluIGRlbGV0ZSBnb2luZyBhd2F5CiAgICAgICAgYXJyYXlP
        cGVyYXRpb24uY291bnQgLT0gbmV4dENvdW50OwogICAgICB9CiAgICB9Cgog
        ICAgaWYgKGFycmF5T3BlcmF0aW9uLmNvdW50ID4gMCkgewogICAgICAvLyBj
        b21wb3NlIG91ciBuZXcgZGVsZXRlIHdpdGggcG9zc2libHkgc2V2ZXJhbCBv
        cGVyYXRpb25zIHRvIHRoZSByaWdodCBvZgogICAgICAvLyBkaXNwYXJhdGUg
        dHlwZXMKICAgICAgdGhpcy5fb3BlcmF0aW9ucy5zcGxpY2UoaW5kZXgrMSwg
        aS0xLWluZGV4KTsKICAgIH0gZWxzZSB7CiAgICAgIC8vIFRoZSBkZWxldGUg
        b3BlcmF0aW9uIGNhbiBnbyBhd2F5OyBpdCBoYXMgbWVyZWx5IHJlZHVjZWQg
        c29tZSBvdGhlcgogICAgICAvLyBvcGVyYXRpb24sIGFzIGluIGQ6MyBpOjQ7
        IGl0IG1heSBhbHNvIGhhdmUgZWxpbWluYXRlZCB0aGF0IG9wZXJhdGlvbiwK
        ICAgICAgLy8gYXMgaW4gZDozIGk6My4KICAgICAgdGhpcy5fb3BlcmF0aW9u
        cy5zcGxpY2UoaW5kZXgsIHJlbW92ZU5ld0FuZE5leHRPcCA/IDIgOiAxKTsK
        ICAgIH0KCiAgICByZXR1cm4gcmVtb3ZlZEl0ZW1zOwogIH0sCgogIHRvU3Ry
        aW5nOiBmdW5jdGlvbiAoKSB7CiAgICB2YXIgc3RyID0gIiI7CiAgICBmb3JF
        YWNoKHRoaXMuX29wZXJhdGlvbnMsIGZ1bmN0aW9uIChvcGVyYXRpb24pIHsK
        ICAgICAgc3RyICs9ICIgIiArIG9wZXJhdGlvbi50eXBlICsgIjoiICsgb3Bl
        cmF0aW9uLmNvdW50OwogICAgfSk7CiAgICByZXR1cm4gc3RyLnN1YnN0cmlu
        ZygxKTsKICB9Cn07CgovKioKICBJbnRlcm5hbCBkYXRhIHN0cnVjdHVyZSB0
        byByZXByZXNlbnQgYW4gYXJyYXkgb3BlcmF0aW9uLgoKICBAbWV0aG9kIEFy
        cmF5T3BlcmF0aW9uCiAgQHByaXZhdGUKICBAcHJvcGVydHkge3N0cmluZ30g
        dHlwZSBUaGUgdHlwZSBvZiB0aGUgb3BlcmF0aW9uLiAgT25lIG9mCiAgYEVt
        YmVyLlRyYWNrZWRBcnJheS57UkVUQUlOLCBJTlNFUlQsIERFTEVURX1gCiAg
        QHByb3BlcnR5IHtudW1iZXJ9IGNvdW50IFRoZSBudW1iZXIgb2YgaXRlbXMg
        aW4gdGhpcyBvcGVyYXRpb24uCiAgQHByb3BlcnR5IHthcnJheX0gaXRlbXMg
        VGhlIGl0ZW1zIG9mIHRoZSBvcGVyYXRpb24sIGlmIGluY2x1ZGVkLiAgUkVU
        QUlOIGFuZAogIElOU0VSVCBpbmNsdWRlIHRoZWlyIGl0ZW1zLCBERUxFVEUg
        ZG9lcyBub3QuCiovCmZ1bmN0aW9uIEFycmF5T3BlcmF0aW9uIChvcGVyYXRp
        b24sIGNvdW50LCBpdGVtcykgewogIHRoaXMudHlwZSA9IG9wZXJhdGlvbjsg
        Ly8gUkVUQUlOIHwgSU5TRVJUIHwgREVMRVRFCiAgdGhpcy5jb3VudCA9IGNv
        dW50OwogIHRoaXMuaXRlbXMgPSBpdGVtczsKfQoKLyoqCiAgSW50ZXJuYWwg
        ZGF0YSBzdHJ1Y3R1cmUgdXNlZCB0byBpbmNsdWRlIGluZm9ybWF0aW9uIHdo
        ZW4gbG9va2luZyB1cCBvcGVyYXRpb25zCiAgYnkgaXRlbSBpbmRleC4KCiAg
        QG1ldGhvZCBBcnJheU9wZXJhdGlvbk1hdGNoCiAgQHByaXZhdGUKICBAcHJv
        cGVydHkge0FycmF5T3BlcmF0aW9ufSBvcGVyYXRpb24KICBAcHJvcGVydHkg
        e251bWJlcn0gaW5kZXggVGhlIGluZGV4IG9mIGBvcGVyYXRpb25gIGluIHRo
        ZSBhcnJheSBvZiBvcGVyYXRpb25zLgogIEBwcm9wZXJ0eSB7Ym9vbGVhbn0g
        c3BsaXQgV2hldGhlciBvciBub3QgdGhlIGl0ZW0gaW5kZXggc2VhcmNoZWQg
        Zm9yIHdvdWxkCiAgcmVxdWlyZSBhIHNwbGl0IGZvciBhIG5ldyBvcGVyYXRp
        b24gdHlwZS4KICBAcHJvcGVydHkge251bWJlcn0gcmFuZ2VTdGFydCBUaGUg
        aW5kZXggb2YgdGhlIGZpcnN0IGl0ZW0gaW4gdGhlIG9wZXJhdGlvbiwKICB3
        aXRoIHJlc3BlY3QgdG8gdGhlIHRyYWNrZWQgYXJyYXkuICBUaGUgaW5kZXgg
        b2YgdGhlIGxhc3QgaXRlbSBjYW4gYmUgY29tcHV0ZWQKICBmcm9tIGByYW5n
        ZVN0YXJ0YCBhbmQgYG9wZXJhdGlvbi5jb3VudGAuCiovCmZ1bmN0aW9uIEFy
        cmF5T3BlcmF0aW9uTWF0Y2gob3BlcmF0aW9uLCBpbmRleCwgc3BsaXQsIHJh
        bmdlU3RhcnQpIHsKICB0aGlzLm9wZXJhdGlvbiA9IG9wZXJhdGlvbjsKICB0
        aGlzLmluZGV4ID0gaW5kZXg7CiAgdGhpcy5zcGxpdCA9IHNwbGl0OwogIHRo
        aXMucmFuZ2VTdGFydCA9IHJhbmdlU3RhcnQ7Cn0KCn0pKCk7CgoKCihmdW5j
        dGlvbigpIHsKdmFyIGdldCA9IEVtYmVyLmdldCwKICAgIGZvckVhY2ggPSBF
        bWJlci5FbnVtZXJhYmxlVXRpbHMuZm9yRWFjaCwKICAgIFJFVEFJTiA9ICdy
        JywKICAgIEZJTFRFUiA9ICdmJzsKCmZ1bmN0aW9uIE9wZXJhdGlvbiAodHlw
        ZSwgY291bnQpIHsKICB0aGlzLnR5cGUgPSB0eXBlOwogIHRoaXMuY291bnQg
        PSBjb3VudDsKfQoKLyoqCiAgQW4gYEVtYmVyLlN1YkFycmF5YCB0cmFja3Mg
        YW4gYXJyYXkgaW4gYSB3YXkgc2ltaWxhciB0bywgYnV0IG1vcmUgc3BlY2lh
        bGl6ZWQKICB0aGFuLCBgRW1iZXIuVHJhY2tlZEFycmF5YC4gIEl0IGlzIHVz
        ZWZ1bCBmb3Iga2VlcGluZyB0cmFjayBvZiB0aGUgaW5kZXhlcyBvZgogIGl0
        ZW1zIHdpdGhpbiBhIGZpbHRlcmVkIGFycmF5LgoKICBAY2xhc3MgU3ViQXJy
        YXkKICBAbmFtZXNwYWNlIEVtYmVyCiovCkVtYmVyLlN1YkFycmF5ID0gZnVu
        Y3Rpb24gKGxlbmd0aCkgewogIGlmIChhcmd1bWVudHMubGVuZ3RoIDwgMSkg
        eyBsZW5ndGggPSAwOyB9CgogIGlmIChsZW5ndGggPiAwKSB7CiAgICB0aGlz
        Ll9vcGVyYXRpb25zID0gW25ldyBPcGVyYXRpb24oUkVUQUlOLCBsZW5ndGgp
        XTsKICB9IGVsc2UgewogICAgdGhpcy5fb3BlcmF0aW9ucyA9IFtdOwogIH0K
        fTsKCkVtYmVyLlN1YkFycmF5LnByb3RvdHlwZSA9IHsKICAvKioKICAgIFRy
        YWNrIHRoYXQgYW4gaXRlbSB3YXMgYWRkZWQgdG8gdGhlIHRyYWNrZWQgYXJy
        YXkuCgogICAgQG1ldGhvZCBhZGRJdGVtCgogICAgQHBhcmFtIHtudW1iZXJ9
        IGluZGV4IFRoZSBpbmRleCBvZiB0aGUgaXRlbSBpbiB0aGUgdHJhY2tlZCBh
        cnJheS4KICAgIEBwYXJhbSB7Ym9vbGVhbn0gbWF0Y2ggYHRydWVgIGlmZiB0
        aGUgaXRlbSBpcyBpbmNsdWRlZCBpbiB0aGUgc3ViYXJyYXkuCgogICAgQHJl
        dHVybiB7bnVtYmVyfSBUaGUgaW5kZXggb2YgdGhlIGl0ZW0gaW4gdGhlIHN1
        YmFycmF5LgogICovCiAgYWRkSXRlbTogZnVuY3Rpb24oaW5kZXgsIG1hdGNo
        KSB7CiAgICB2YXIgcmV0dXJuVmFsdWUgPSAtMSwKICAgICAgICBpdGVtVHlw
        ZSA9IG1hdGNoID8gUkVUQUlOIDogRklMVEVSLAogICAgICAgIHNlbGYgPSB0
        aGlzOwoKICAgIHRoaXMuX2ZpbmRPcGVyYXRpb24oaW5kZXgsIGZ1bmN0aW9u
        KG9wZXJhdGlvbiwgb3BlcmF0aW9uSW5kZXgsIHJhbmdlU3RhcnQsIHJhbmdl
        RW5kLCBzZWVuSW5TdWJBcnJheSkgewogICAgICB2YXIgbmV3T3BlcmF0aW9u
        LCBzcGxpdE9wZXJhdGlvbjsKCiAgICAgIGlmIChpdGVtVHlwZSA9PT0gb3Bl
        cmF0aW9uLnR5cGUpIHsKICAgICAgICArK29wZXJhdGlvbi5jb3VudDsKICAg
        ICAgfSBlbHNlIGlmIChpbmRleCA9PT0gcmFuZ2VTdGFydCkgewogICAgICAg
        IC8vIGluc2VydCB0byB0aGUgbGVmdCBvZiBgb3BlcmF0aW9uYAogICAgICAg
        IHNlbGYuX29wZXJhdGlvbnMuc3BsaWNlKG9wZXJhdGlvbkluZGV4LCAwLCBu
        ZXcgT3BlcmF0aW9uKGl0ZW1UeXBlLCAxKSk7CiAgICAgIH0gZWxzZSB7CiAg
        ICAgICAgbmV3T3BlcmF0aW9uID0gbmV3IE9wZXJhdGlvbihpdGVtVHlwZSwg
        MSk7CiAgICAgICAgc3BsaXRPcGVyYXRpb24gPSBuZXcgT3BlcmF0aW9uKG9w
        ZXJhdGlvbi50eXBlLCByYW5nZUVuZCAtIGluZGV4ICsgMSk7CiAgICAgICAg
        b3BlcmF0aW9uLmNvdW50ID0gaW5kZXggLSByYW5nZVN0YXJ0OwoKICAgICAg
        ICBzZWxmLl9vcGVyYXRpb25zLnNwbGljZShvcGVyYXRpb25JbmRleCArIDEs
        IDAsIG5ld09wZXJhdGlvbiwgc3BsaXRPcGVyYXRpb24pOwogICAgICB9Cgog
        ICAgICBpZiAobWF0Y2gpIHsKICAgICAgICBpZiAob3BlcmF0aW9uLnR5cGUg
        PT09IFJFVEFJTikgewogICAgICAgICAgcmV0dXJuVmFsdWUgPSBzZWVuSW5T
        dWJBcnJheSArIChpbmRleCAtIHJhbmdlU3RhcnQpOwogICAgICAgIH0gZWxz
        ZSB7CiAgICAgICAgICByZXR1cm5WYWx1ZSA9IHNlZW5JblN1YkFycmF5Owog
        ICAgICAgIH0KICAgICAgfQoKICAgICAgc2VsZi5fY29tcG9zZUF0KG9wZXJh
        dGlvbkluZGV4KTsKICAgIH0sIGZ1bmN0aW9uKHNlZW5JblN1YkFycmF5KSB7
        CiAgICAgIHNlbGYuX29wZXJhdGlvbnMucHVzaChuZXcgT3BlcmF0aW9uKGl0
        ZW1UeXBlLCAxKSk7CgogICAgICBpZiAobWF0Y2gpIHsKICAgICAgICByZXR1
        cm5WYWx1ZSA9IHNlZW5JblN1YkFycmF5OwogICAgICB9CgogICAgICBzZWxm
        Ll9jb21wb3NlQXQoc2VsZi5fb3BlcmF0aW9ucy5sZW5ndGgtMSk7CiAgICB9
        KTsKCiAgICByZXR1cm4gcmV0dXJuVmFsdWU7CiAgfSwKCiAgLyoqCiAgICBU
        cmFjayB0aGF0IGFuIGl0ZW0gd2FzIHJlbW92ZWQgZnJvbSB0aGUgdHJhY2tl
        ZCBhcnJheS4KCiAgICBAbWV0aG9kIHJlbW92ZUl0ZW0KCiAgICBAcGFyYW0g
        e251bWJlcn0gaW5kZXggVGhlIGluZGV4IG9mIHRoZSBpdGVtIGluIHRoZSB0
        cmFja2VkIGFycmF5LgoKICAgIEByZXR1cm4ge251bWJlcn0gVGhlIGluZGV4
        IG9mIHRoZSBpdGVtIGluIHRoZSBzdWJhcnJheSwgb3IgYC0xYCBpZiB0aGUg
        aXRlbQogICAgd2FzIG5vdCBpbiB0aGUgc3ViYXJyYXkuCiAgKi8KICByZW1v
        dmVJdGVtOiBmdW5jdGlvbihpbmRleCkgewogICAgdmFyIHJldHVyblZhbHVl
        ID0gLTEsCiAgICAgICAgc2VsZiA9IHRoaXM7CgogICAgdGhpcy5fZmluZE9w
        ZXJhdGlvbihpbmRleCwgZnVuY3Rpb24gKG9wZXJhdGlvbiwgb3BlcmF0aW9u
        SW5kZXgsIHJhbmdlU3RhcnQsIHJhbmdlRW5kLCBzZWVuSW5TdWJBcnJheSkg
        ewogICAgICBpZiAob3BlcmF0aW9uLnR5cGUgPT09IFJFVEFJTikgewogICAg
        ICAgIHJldHVyblZhbHVlID0gc2VlbkluU3ViQXJyYXkgKyAoaW5kZXggLSBy
        YW5nZVN0YXJ0KTsKICAgICAgfQoKICAgICAgaWYgKG9wZXJhdGlvbi5jb3Vu
        dCA+IDEpIHsKICAgICAgICAtLW9wZXJhdGlvbi5jb3VudDsKICAgICAgfSBl
        bHNlIHsKICAgICAgICBzZWxmLl9vcGVyYXRpb25zLnNwbGljZShvcGVyYXRp
        b25JbmRleCwgMSk7CiAgICAgICAgc2VsZi5fY29tcG9zZUF0KG9wZXJhdGlv
        bkluZGV4KTsKICAgICAgfQogICAgfSwgZnVuY3Rpb24oKSB7CiAgICAgIHRo
        cm93IG5ldyBFbWJlci5FcnJvcigiQ2FuJ3QgcmVtb3ZlIGFuIGl0ZW0gdGhh
        dCBoYXMgbmV2ZXIgYmVlbiBhZGRlZC4iKTsKICAgIH0pOwoKICAgIHJldHVy
        biByZXR1cm5WYWx1ZTsKICB9LAoKCiAgX2ZpbmRPcGVyYXRpb246IGZ1bmN0
        aW9uIChpbmRleCwgZm91bmRDYWxsYmFjaywgbm90Rm91bmRDYWxsYmFjaykg
        ewogICAgdmFyIG9wZXJhdGlvbkluZGV4LAogICAgICAgIGxlbiwKICAgICAg
        ICBvcGVyYXRpb24sCiAgICAgICAgcmFuZ2VTdGFydCwKICAgICAgICByYW5n
        ZUVuZCwKICAgICAgICBzZWVuSW5TdWJBcnJheSA9IDA7CgogICAgLy8gT1BU
        SU1JWkU6IGNoYW5nZSB0byBiYWxhbmNlZCB0cmVlCiAgICAvLyBmaW5kIGxl
        ZnRtb3N0IG9wZXJhdGlvbiB0byB0aGUgcmlnaHQgb2YgYGluZGV4YAogICAg
        Zm9yIChvcGVyYXRpb25JbmRleCA9IHJhbmdlU3RhcnQgPSAwLCBsZW4gPSB0
        aGlzLl9vcGVyYXRpb25zLmxlbmd0aDsgb3BlcmF0aW9uSW5kZXggPCBsZW47
        IHJhbmdlU3RhcnQgPSByYW5nZUVuZCArIDEsICsrb3BlcmF0aW9uSW5kZXgp
        IHsKICAgICAgb3BlcmF0aW9uID0gdGhpcy5fb3BlcmF0aW9uc1tvcGVyYXRp
        b25JbmRleF07CiAgICAgIHJhbmdlRW5kID0gcmFuZ2VTdGFydCArIG9wZXJh
        dGlvbi5jb3VudCAtIDE7CgogICAgICBpZiAoaW5kZXggPj0gcmFuZ2VTdGFy
        dCAmJiBpbmRleCA8PSByYW5nZUVuZCkgewogICAgICAgIGZvdW5kQ2FsbGJh
        Y2sob3BlcmF0aW9uLCBvcGVyYXRpb25JbmRleCwgcmFuZ2VTdGFydCwgcmFu
        Z2VFbmQsIHNlZW5JblN1YkFycmF5KTsKICAgICAgICByZXR1cm47CiAgICAg
        IH0gZWxzZSBpZiAob3BlcmF0aW9uLnR5cGUgPT09IFJFVEFJTikgewogICAg
        ICAgIHNlZW5JblN1YkFycmF5ICs9IG9wZXJhdGlvbi5jb3VudDsKICAgICAg
        fQogICAgfQoKICAgIG5vdEZvdW5kQ2FsbGJhY2soc2VlbkluU3ViQXJyYXkp
        OwogIH0sCgogIF9jb21wb3NlQXQ6IGZ1bmN0aW9uKGluZGV4KSB7CiAgICB2
        YXIgb3AgPSB0aGlzLl9vcGVyYXRpb25zW2luZGV4XSwKICAgICAgICBvdGhl
        ck9wOwoKICAgIGlmICghb3ApIHsKICAgICAgLy8gQ29tcG9zaW5nIG91dCBv
        ZiBib3VuZHMgaXMgYSBuby1vcCwgYXMgd2hlbiByZW1vdmluZyB0aGUgbGFz
        dCBvcGVyYXRpb24KICAgICAgLy8gaW4gdGhlIGxpc3QuCiAgICAgIHJldHVy
        bjsKICAgIH0KCiAgICBpZiAoaW5kZXggPiAwKSB7CiAgICAgIG90aGVyT3Ag
        PSB0aGlzLl9vcGVyYXRpb25zW2luZGV4LTFdOwogICAgICBpZiAob3RoZXJP
        cC50eXBlID09PSBvcC50eXBlKSB7CiAgICAgICAgb3AuY291bnQgKz0gb3Ro
        ZXJPcC5jb3VudDsKICAgICAgICB0aGlzLl9vcGVyYXRpb25zLnNwbGljZShp
        bmRleC0xLCAxKTsKICAgICAgICAtLWluZGV4OwogICAgICB9CiAgICB9Cgog
        ICAgaWYgKGluZGV4IDwgdGhpcy5fb3BlcmF0aW9ucy5sZW5ndGgtMSkgewog
        ICAgICBvdGhlck9wID0gdGhpcy5fb3BlcmF0aW9uc1tpbmRleCsxXTsKICAg
        ICAgaWYgKG90aGVyT3AudHlwZSA9PT0gb3AudHlwZSkgewogICAgICAgIG9w
        LmNvdW50ICs9IG90aGVyT3AuY291bnQ7CiAgICAgICAgdGhpcy5fb3BlcmF0
        aW9ucy5zcGxpY2UoaW5kZXgrMSwgMSk7CiAgICAgIH0KICAgIH0KICB9Cn07
        Cgp9KSgpOwoKCgooZnVuY3Rpb24oKSB7CkVtYmVyLkNvbnRhaW5lciA9IHJl
        cXVpcmVNb2R1bGUoJ2NvbnRhaW5lcicpOwpFbWJlci5Db250YWluZXIuc2V0
        ID0gRW1iZXIuc2V0OwoKfSkoKTsKCgoKKGZ1bmN0aW9uKCkgewovKioKQG1v
        ZHVsZSBlbWJlcgpAc3VibW9kdWxlIGVtYmVyLXJ1bnRpbWUKKi8KCgovLyBO
        T1RFOiB0aGlzIG9iamVjdCBzaG91bGQgbmV2ZXIgYmUgaW5jbHVkZWQgZGly
        ZWN0bHkuIEluc3RlYWQgdXNlIGBFbWJlci5PYmplY3RgLgovLyBXZSBvbmx5
        IGRlZmluZSB0aGlzIHNlcGFyYXRlbHkgc28gdGhhdCBgRW1iZXIuU2V0YCBj
        YW4gZGVwZW5kIG9uIGl0LgoKCnZhciBzZXQgPSBFbWJlci5zZXQsIGdldCA9
        IEVtYmVyLmdldCwKICAgIG9fY3JlYXRlID0gRW1iZXIuY3JlYXRlLAogICAg
        b19kZWZpbmVQcm9wZXJ0eSA9IEVtYmVyLnBsYXRmb3JtLmRlZmluZVByb3Bl
        cnR5LAogICAgR1VJRF9LRVkgPSBFbWJlci5HVUlEX0tFWSwKICAgIGd1aWRG
        b3IgPSBFbWJlci5ndWlkRm9yLAogICAgZ2VuZXJhdGVHdWlkID0gRW1iZXIu
        Z2VuZXJhdGVHdWlkLAogICAgbWV0YSA9IEVtYmVyLm1ldGEsCiAgICByZXdh
        dGNoID0gRW1iZXIucmV3YXRjaCwKICAgIGZpbmlzaENoYWlucyA9IEVtYmVy
        LmZpbmlzaENoYWlucywKICAgIHNlbmRFdmVudCA9IEVtYmVyLnNlbmRFdmVu
        dCwKICAgIGRlc3Ryb3kgPSBFbWJlci5kZXN0cm95LAogICAgc2NoZWR1bGUg
        PSBFbWJlci5ydW4uc2NoZWR1bGUsCiAgICBNaXhpbiA9IEVtYmVyLk1peGlu
        LAogICAgYXBwbHlNaXhpbiA9IE1peGluLl9hcHBseSwKICAgIGZpbmlzaFBh
        cnRpYWwgPSBNaXhpbi5maW5pc2hQYXJ0aWFsLAogICAgcmVvcGVuID0gTWl4
        aW4ucHJvdG90eXBlLnJlb3BlbiwKICAgIE1BTkRBVE9SWV9TRVRURVIgPSBF
        bWJlci5FTlYuTUFOREFUT1JZX1NFVFRFUiwKICAgIGluZGV4T2YgPSBFbWJl
        ci5FbnVtZXJhYmxlVXRpbHMuaW5kZXhPZjsKCnZhciB1bmRlZmluZWREZXNj
        cmlwdG9yID0gewogIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICB3cml0YWJsZTog
        dHJ1ZSwKICBlbnVtZXJhYmxlOiBmYWxzZSwKICB2YWx1ZTogdW5kZWZpbmVk
        Cn07CgpmdW5jdGlvbiBtYWtlQ3RvcigpIHsKCiAgLy8gTm90ZTogYXZvaWQg
        YWNjZXNzaW5nIGFueSBwcm9wZXJ0aWVzIG9uIHRoZSBvYmplY3Qgc2luY2Ug
        aXQgbWFrZXMgdGhlCiAgLy8gbWV0aG9kIGEgbG90IGZhc3Rlci4gVGhpcyBp
        cyBnbHVlIGNvZGUgc28gd2Ugd2FudCBpdCB0byBiZSBhcyBmYXN0IGFzCiAg
        Ly8gcG9zc2libGUuCgogIHZhciB3YXNBcHBsaWVkID0gZmFsc2UsIGluaXRN
        aXhpbnMsIGluaXRQcm9wZXJ0aWVzOwoKICB2YXIgQ2xhc3MgPSBmdW5jdGlv
        bigpIHsKICAgIGlmICghd2FzQXBwbGllZCkgewogICAgICBDbGFzcy5wcm90
        bygpOyAvLyBwcmVwYXJlIHByb3RvdHlwZS4uLgogICAgfQogICAgb19kZWZp
        bmVQcm9wZXJ0eSh0aGlzLCBHVUlEX0tFWSwgdW5kZWZpbmVkRGVzY3JpcHRv
        cik7CiAgICBvX2RlZmluZVByb3BlcnR5KHRoaXMsICdfc3VwZXInLCB1bmRl
        ZmluZWREZXNjcmlwdG9yKTsKICAgIHZhciBtID0gbWV0YSh0aGlzKSwgcHJv
        dG8gPSBtLnByb3RvOwogICAgbS5wcm90byA9IHRoaXM7CiAgICBpZiAoaW5p
        dE1peGlucykgewogICAgICAvLyBjYXB0dXJlIGxvY2FsbHkgc28gd2UgY2Fu
        IGNsZWFyIHRoZSBjbG9zZWQgb3ZlciB2YXJpYWJsZQogICAgICB2YXIgbWl4
        aW5zID0gaW5pdE1peGluczsKICAgICAgaW5pdE1peGlucyA9IG51bGw7CiAg
        ICAgIHRoaXMucmVvcGVuLmFwcGx5KHRoaXMsIG1peGlucyk7CiAgICB9CiAg
        ICBpZiAoaW5pdFByb3BlcnRpZXMpIHsKICAgICAgLy8gY2FwdHVyZSBsb2Nh
        bGx5IHNvIHdlIGNhbiBjbGVhciB0aGUgY2xvc2VkIG92ZXIgdmFyaWFibGUK
        ICAgICAgdmFyIHByb3BzID0gaW5pdFByb3BlcnRpZXM7CiAgICAgIGluaXRQ
        cm9wZXJ0aWVzID0gbnVsbDsKCiAgICAgIHZhciBjb25jYXRlbmF0ZWRQcm9w
        ZXJ0aWVzID0gdGhpcy5jb25jYXRlbmF0ZWRQcm9wZXJ0aWVzOwoKICAgICAg
        Zm9yICh2YXIgaSA9IDAsIGwgPSBwcm9wcy5sZW5ndGg7IGkgPCBsOyBpKysp
        IHsKICAgICAgICB2YXIgcHJvcGVydGllcyA9IHByb3BzW2ldOwoKICAgICAg
        ICBFbWJlci5hc3NlcnQoIkVtYmVyLk9iamVjdC5jcmVhdGUgbm8gbG9uZ2Vy
        IHN1cHBvcnRzIG1peGluZyBpbiBvdGhlciBkZWZpbml0aW9ucywgdXNlIGNy
        ZWF0ZVdpdGhNaXhpbnMgaW5zdGVhZC4iLCAhKHByb3BlcnRpZXMgaW5zdGFu
        Y2VvZiBFbWJlci5NaXhpbikpOwoKICAgICAgICBpZiAocHJvcGVydGllcyA9
        PT0gbnVsbCB8fCB0eXBlb2YgcHJvcGVydGllcyAhPT0gJ29iamVjdCcpIHsK
        ICAgICAgICAgIEVtYmVyLmFzc2VydCgiRW1iZXIuT2JqZWN0LmNyZWF0ZSBv
        bmx5IGFjY2VwdHMgb2JqZWN0cy4iKTsKICAgICAgICAgIGNvbnRpbnVlOwog
        ICAgICAgIH0KCiAgICAgICAgdmFyIGtleU5hbWVzID0gRW1iZXIua2V5cyhw
        cm9wZXJ0aWVzKTsKICAgICAgICBmb3IgKHZhciBqID0gMCwgbGwgPSBrZXlO
        YW1lcy5sZW5ndGg7IGogPCBsbDsgaisrKSB7CiAgICAgICAgICB2YXIga2V5
        TmFtZSA9IGtleU5hbWVzW2pdOwogICAgICAgICAgaWYgKCFwcm9wZXJ0aWVz
        Lmhhc093blByb3BlcnR5KGtleU5hbWUpKSB7IGNvbnRpbnVlOyB9CgogICAg
        ICAgICAgdmFyIHZhbHVlID0gcHJvcGVydGllc1trZXlOYW1lXSwKICAgICAg
        ICAgICAgICBJU19CSU5ESU5HID0gRW1iZXIuSVNfQklORElORzsKCiAgICAg
        ICAgICBpZiAoSVNfQklORElORy50ZXN0KGtleU5hbWUpKSB7CiAgICAgICAg
        ICAgIHZhciBiaW5kaW5ncyA9IG0uYmluZGluZ3M7CiAgICAgICAgICAgIGlm
        ICghYmluZGluZ3MpIHsKICAgICAgICAgICAgICBiaW5kaW5ncyA9IG0uYmlu
        ZGluZ3MgPSB7fTsKICAgICAgICAgICAgfSBlbHNlIGlmICghbS5oYXNPd25Q
        cm9wZXJ0eSgnYmluZGluZ3MnKSkgewogICAgICAgICAgICAgIGJpbmRpbmdz
        ID0gbS5iaW5kaW5ncyA9IG9fY3JlYXRlKG0uYmluZGluZ3MpOwogICAgICAg
        ICAgICB9CiAgICAgICAgICAgIGJpbmRpbmdzW2tleU5hbWVdID0gdmFsdWU7
        CiAgICAgICAgICB9CgogICAgICAgICAgdmFyIGRlc2MgPSBtLmRlc2NzW2tl
        eU5hbWVdOwoKICAgICAgICAgIEVtYmVyLmFzc2VydCgiRW1iZXIuT2JqZWN0
        LmNyZWF0ZSBubyBsb25nZXIgc3VwcG9ydHMgZGVmaW5pbmcgY29tcHV0ZWQg
        cHJvcGVydGllcy4iLCAhKHZhbHVlIGluc3RhbmNlb2YgRW1iZXIuQ29tcHV0
        ZWRQcm9wZXJ0eSkpOwogICAgICAgICAgRW1iZXIuYXNzZXJ0KCJFbWJlci5P
        YmplY3QuY3JlYXRlIG5vIGxvbmdlciBzdXBwb3J0cyBkZWZpbmluZyBtZXRo
        b2RzIHRoYXQgY2FsbCBfc3VwZXIuIiwgISh0eXBlb2YgdmFsdWUgPT09ICdm
        dW5jdGlvbicgJiYgdmFsdWUudG9TdHJpbmcoKS5pbmRleE9mKCcuX3N1cGVy
        JykgIT09IC0xKSk7CiAgICAgICAgICBFbWJlci5hc3NlcnQoImBhY3Rpb25z
        YCBtdXN0IGJlIHByb3ZpZGVkIGF0IGV4dGVuZCB0aW1lLCBub3QgYXQgY3Jl
        YXRlIHRpbWUsIHdoZW4gRW1iZXIuQWN0aW9uSGFuZGxlciBpcyB1c2VkIChp
        LmUuIHZpZXdzLCBjb250cm9sbGVycyAmIHJvdXRlcykuIiwgISgoa2V5TmFt
        ZSA9PT0gJ2FjdGlvbnMnKSAmJiBFbWJlci5BY3Rpb25IYW5kbGVyLmRldGVj
        dCh0aGlzKSkpOwoKICAgICAgICAgIGlmIChjb25jYXRlbmF0ZWRQcm9wZXJ0
        aWVzICYmIGluZGV4T2YoY29uY2F0ZW5hdGVkUHJvcGVydGllcywga2V5TmFt
        ZSkgPj0gMCkgewogICAgICAgICAgICB2YXIgYmFzZVZhbHVlID0gdGhpc1tr
        ZXlOYW1lXTsKCiAgICAgICAgICAgIGlmIChiYXNlVmFsdWUpIHsKICAgICAg
        ICAgICAgICBpZiAoJ2Z1bmN0aW9uJyA9PT0gdHlwZW9mIGJhc2VWYWx1ZS5j
        b25jYXQpIHsKICAgICAgICAgICAgICAgIHZhbHVlID0gYmFzZVZhbHVlLmNv
        bmNhdCh2YWx1ZSk7CiAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAg
        ICAgICAgIHZhbHVlID0gRW1iZXIubWFrZUFycmF5KGJhc2VWYWx1ZSkuY29u
        Y2F0KHZhbHVlKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gZWxz
        ZSB7CiAgICAgICAgICAgICAgdmFsdWUgPSBFbWJlci5tYWtlQXJyYXkodmFs
        dWUpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CgogICAgICAgICAgaWYg
        KGRlc2MpIHsKICAgICAgICAgICAgZGVzYy5zZXQodGhpcywga2V5TmFtZSwg
        dmFsdWUpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgaWYgKHR5
        cGVvZiB0aGlzLnNldFVua25vd25Qcm9wZXJ0eSA9PT0gJ2Z1bmN0aW9uJyAm
        JiAhKGtleU5hbWUgaW4gdGhpcykpIHsKICAgICAgICAgICAgICB0aGlzLnNl
        dFVua25vd25Qcm9wZXJ0eShrZXlOYW1lLCB2YWx1ZSk7CiAgICAgICAgICAg
        IH0gZWxzZSBpZiAoTUFOREFUT1JZX1NFVFRFUikgewogICAgICAgICAgICAg
        IEVtYmVyLmRlZmluZVByb3BlcnR5KHRoaXMsIGtleU5hbWUsIG51bGwsIHZh
        bHVlKTsgLy8gc2V0dXAgbWFuZGF0b3J5IHNldHRlcgogICAgICAgICAgICB9
        IGVsc2UgewogICAgICAgICAgICAgIHRoaXNba2V5TmFtZV0gPSB2YWx1ZTsK
        ICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQog
        ICAgfQogICAgZmluaXNoUGFydGlhbCh0aGlzLCBtKTsKICAgIHRoaXMuaW5p
        dC5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgbS5wcm90byA9IHByb3Rv
        OwogICAgZmluaXNoQ2hhaW5zKHRoaXMpOwogICAgc2VuZEV2ZW50KHRoaXMs
        ICJpbml0Iik7CiAgfTsKCiAgQ2xhc3MudG9TdHJpbmcgPSBNaXhpbi5wcm90
        b3R5cGUudG9TdHJpbmc7CiAgQ2xhc3Mud2lsbFJlb3BlbiA9IGZ1bmN0aW9u
        KCkgewogICAgaWYgKHdhc0FwcGxpZWQpIHsKICAgICAgQ2xhc3MuUHJvdG90
        eXBlTWl4aW4gPSBNaXhpbi5jcmVhdGUoQ2xhc3MuUHJvdG90eXBlTWl4aW4p
        OwogICAgfQoKICAgIHdhc0FwcGxpZWQgPSBmYWxzZTsKICB9OwogIENsYXNz
        Ll9pbml0TWl4aW5zID0gZnVuY3Rpb24oYXJncykgeyBpbml0TWl4aW5zID0g
        YXJnczsgfTsKICBDbGFzcy5faW5pdFByb3BlcnRpZXMgPSBmdW5jdGlvbihh
        cmdzKSB7IGluaXRQcm9wZXJ0aWVzID0gYXJnczsgfTsKCiAgQ2xhc3MucHJv
        dG8gPSBmdW5jdGlvbigpIHsKICAgIHZhciBzdXBlcmNsYXNzID0gQ2xhc3Mu
        c3VwZXJjbGFzczsKICAgIGlmIChzdXBlcmNsYXNzKSB7IHN1cGVyY2xhc3Mu
        cHJvdG8oKTsgfQoKICAgIGlmICghd2FzQXBwbGllZCkgewogICAgICB3YXNB
        cHBsaWVkID0gdHJ1ZTsKICAgICAgQ2xhc3MuUHJvdG90eXBlTWl4aW4uYXBw
        bHlQYXJ0aWFsKENsYXNzLnByb3RvdHlwZSk7CiAgICAgIHJld2F0Y2goQ2xh
        c3MucHJvdG90eXBlKTsKICAgIH0KCiAgICByZXR1cm4gdGhpcy5wcm90b3R5
        cGU7CiAgfTsKCiAgcmV0dXJuIENsYXNzOwoKfQoKLyoqCiAgQGNsYXNzIENv
        cmVPYmplY3QKICBAbmFtZXNwYWNlIEVtYmVyCiovCnZhciBDb3JlT2JqZWN0
        ID0gbWFrZUN0b3IoKTsKQ29yZU9iamVjdC50b1N0cmluZyA9IGZ1bmN0aW9u
        KCkgeyByZXR1cm4gIkVtYmVyLkNvcmVPYmplY3QiOyB9OwoKQ29yZU9iamVj
        dC5Qcm90b3R5cGVNaXhpbiA9IE1peGluLmNyZWF0ZSh7CiAgcmVvcGVuOiBm
        dW5jdGlvbigpIHsKICAgIGFwcGx5TWl4aW4odGhpcywgYXJndW1lbnRzLCB0
        cnVlKTsKICAgIHJldHVybiB0aGlzOwogIH0sCgogIC8qKgogICAgQW4gb3Zl
        cnJpZGFibGUgbWV0aG9kIGNhbGxlZCB3aGVuIG9iamVjdHMgYXJlIGluc3Rh
        bnRpYXRlZC4gQnkgZGVmYXVsdCwKICAgIGRvZXMgbm90aGluZyB1bmxlc3Mg
        aXQgaXMgb3ZlcnJpZGRlbiBkdXJpbmcgY2xhc3MgZGVmaW5pdGlvbi4KCiAg
        ICBFeGFtcGxlOgoKICAgIGBgYGphdmFzY3JpcHQKICAgIEFwcC5QZXJzb24g
        PSBFbWJlci5PYmplY3QuZXh0ZW5kKHsKICAgICAgaW5pdDogZnVuY3Rpb24o
        KSB7CiAgICAgICAgdGhpcy5fc3VwZXIoKTsKICAgICAgICBhbGVydCgnTmFt
        ZSBpcyAnICsgdGhpcy5nZXQoJ25hbWUnKSk7CiAgICAgIH0KICAgIH0pOwoK
        ICAgIHZhciBzdGV2ZSA9IEFwcC5QZXJzb24uY3JlYXRlKHsKICAgICAgbmFt
        ZTogIlN0ZXZlIgogICAgfSk7CgogICAgLy8gYWxlcnRzICdOYW1lIGlzIFN0
        ZXZlJy4KICAgIGBgYAoKICAgIE5PVEU6IElmIHlvdSBkbyBvdmVycmlkZSBg
        aW5pdGAgZm9yIGEgZnJhbWV3b3JrIGNsYXNzIGxpa2UgYEVtYmVyLlZpZXdg
        IG9yCiAgICBgRW1iZXIuQXJyYXlDb250cm9sbGVyYCwgYmUgc3VyZSB0byBj
        YWxsIGB0aGlzLl9zdXBlcigpYCBpbiB5b3VyCiAgICBgaW5pdGAgZGVjbGFy
        YXRpb24hIElmIHlvdSBkb24ndCwgRW1iZXIgbWF5IG5vdCBoYXZlIGFuIG9w
        cG9ydHVuaXR5IHRvCiAgICBkbyBpbXBvcnRhbnQgc2V0dXAgd29yaywgYW5k
        IHlvdSdsbCBzZWUgc3RyYW5nZSBiZWhhdmlvciBpbiB5b3VyCiAgICBhcHBs
        aWNhdGlvbi4KCiAgICBAbWV0aG9kIGluaXQKICAqLwogIGluaXQ6IGZ1bmN0
        aW9uKCkge30sCgogIC8qKgogICAgRGVmaW5lcyB0aGUgcHJvcGVydGllcyB0
        aGF0IHdpbGwgYmUgY29uY2F0ZW5hdGVkIGZyb20gdGhlIHN1cGVyY2xhc3MK
        ICAgIChpbnN0ZWFkIG9mIG92ZXJyaWRkZW4pLgoKICAgIEJ5IGRlZmF1bHQs
        IHdoZW4geW91IGV4dGVuZCBhbiBFbWJlciBjbGFzcyBhIHByb3BlcnR5IGRl
        ZmluZWQgaW4KICAgIHRoZSBzdWJjbGFzcyBvdmVycmlkZXMgYSBwcm9wZXJ0
        eSB3aXRoIHRoZSBzYW1lIG5hbWUgdGhhdCBpcyBkZWZpbmVkCiAgICBpbiB0
        aGUgc3VwZXJjbGFzcy4gSG93ZXZlciwgdGhlcmUgYXJlIHNvbWUgY2FzZXMg
        d2hlcmUgaXQgaXMgcHJlZmVyYWJsZQogICAgdG8gYnVpbGQgdXAgYSBwcm9w
        ZXJ0eSdzIHZhbHVlIGJ5IGNvbWJpbmluZyB0aGUgc3VwZXJjbGFzcycgcHJv
        cGVydHkKICAgIHZhbHVlIHdpdGggdGhlIHN1YmNsYXNzJyB2YWx1ZS4gQW4g
        ZXhhbXBsZSBvZiB0aGlzIGluIHVzZSB3aXRoaW4gRW1iZXIKICAgIGlzIHRo
        ZSBgY2xhc3NOYW1lc2AgcHJvcGVydHkgb2YgYEVtYmVyLlZpZXdgLgoKICAg
        IEhlcmUgaXMgc29tZSBzYW1wbGUgY29kZSBzaG93aW5nIHRoZSBkaWZmZXJl
        bmNlIGJldHdlZW4gYSBjb25jYXRlbmF0ZWQKICAgIHByb3BlcnR5IGFuZCBh
        IG5vcm1hbCBvbmU6CgogICAgYGBgamF2YXNjcmlwdAogICAgQXBwLkJhclZp
        ZXcgPSBFbWJlci5WaWV3LmV4dGVuZCh7CiAgICAgIHNvbWVOb25Db25jYXRl
        bmF0ZWRQcm9wZXJ0eTogWydiYXInXSwKICAgICAgY2xhc3NOYW1lczogWydi
        YXInXQogICAgfSk7CgogICAgQXBwLkZvb0JhclZpZXcgPSBBcHAuQmFyVmll
        dy5leHRlbmQoewogICAgICBzb21lTm9uQ29uY2F0ZW5hdGVkUHJvcGVydHk6
        IFsnZm9vJ10sCiAgICAgIGNsYXNzTmFtZXM6IFsnZm9vJ10sCiAgICB9KTsK
        CiAgICB2YXIgZm9vQmFyVmlldyA9IEFwcC5Gb29CYXJWaWV3LmNyZWF0ZSgp
        OwogICAgZm9vQmFyVmlldy5nZXQoJ3NvbWVOb25Db25jYXRlbmF0ZWRQcm9w
        ZXJ0eScpOyAvLyBbJ2ZvbyddCiAgICBmb29CYXJWaWV3LmdldCgnY2xhc3NO
        YW1lcycpOyAvLyBbJ2VtYmVyLXZpZXcnLCAnYmFyJywgJ2ZvbyddCiAgICBg
        YGAKCiAgICBUaGlzIGJlaGF2aW9yIGV4dGVuZHMgdG8gb2JqZWN0IGNyZWF0
        aW9uIGFzIHdlbGwuIENvbnRpbnVpbmcgdGhlCiAgICBhYm92ZSBleGFtcGxl
        OgoKICAgIGBgYGphdmFzY3JpcHQKICAgIHZhciB2aWV3ID0gQXBwLkZvb0Jh
        clZpZXcuY3JlYXRlKHsKICAgICAgc29tZU5vbkNvbmNhdGVuYXRlZFByb3Bl
        cnR5OiBbJ2JheiddLAogICAgICBjbGFzc05hbWVzOiBbJ2JheiddCiAgICB9
        KQogICAgdmlldy5nZXQoJ3NvbWVOb25Db25jYXRlbmF0ZWRQcm9wZXJ0eScp
        OyAvLyBbJ2JheiddCiAgICB2aWV3LmdldCgnY2xhc3NOYW1lcycpOyAvLyBb
        J2VtYmVyLXZpZXcnLCAnYmFyJywgJ2ZvbycsICdiYXonXQogICAgYGBgCiAg
        ICBBZGRpbmcgYSBzaW5nbGUgcHJvcGVydHkgdGhhdCBpcyBub3QgYW4gYXJy
        YXkgd2lsbCBqdXN0IGFkZCBpdCBpbiB0aGUgYXJyYXk6CgogICAgYGBgamF2
        YXNjcmlwdAogICAgdmFyIHZpZXcgPSBBcHAuRm9vQmFyVmlldy5jcmVhdGUo
        ewogICAgICBjbGFzc05hbWVzOiAnYmF6JwogICAgfSkKICAgIHZpZXcuZ2V0
        KCdjbGFzc05hbWVzJyk7IC8vIFsnZW1iZXItdmlldycsICdiYXInLCAnZm9v
        JywgJ2JheiddCiAgICBgYGAKCiAgICBVc2luZyB0aGUgYGNvbmNhdGVuYXRl
        ZFByb3BlcnRpZXNgIHByb3BlcnR5LCB3ZSBjYW4gdGVsbCB0byBFbWJlciB0
        aGF0IG1peAogICAgdGhlIGNvbnRlbnQgb2YgdGhlIHByb3BlcnRpZXMuCgog
        ICAgSW4gYEVtYmVyLlZpZXdgIHRoZSBgY2xhc3NOYW1lQmluZGluZ3NgIGFu
        ZCBgYXR0cmlidXRlQmluZGluZ3NgIHByb3BlcnRpZXMKICAgIGFyZSBhbHNv
        IGNvbmNhdGVuYXRlZCwgaW4gYWRkaXRpb24gdG8gYGNsYXNzTmFtZXNgLgoK
        ICAgIFRoaXMgZmVhdHVyZSBpcyBhdmFpbGFibGUgZm9yIHlvdSB0byB1c2Ug
        dGhyb3VnaG91dCB0aGUgRW1iZXIgb2JqZWN0IG1vZGVsLAogICAgYWx0aG91
        Z2ggdHlwaWNhbCBhcHAgZGV2ZWxvcGVycyBhcmUgbGlrZWx5IHRvIHVzZSBp
        dCBpbmZyZXF1ZW50bHkuIFNpbmNlCiAgICBpdCBjaGFuZ2VzIGV4cGVjdGF0
        aW9ucyBhYm91dCBiZWhhdmlvciBvZiBwcm9wZXJ0aWVzLCB5b3Ugc2hvdWxk
        IHByb3Blcmx5CiAgICBkb2N1bWVudCBpdHMgdXNhZ2UgaW4gZWFjaCBpbmRp
        dmlkdWFsIGNvbmNhdGVuYXRlZCBwcm9wZXJ0eSAodG8gbm90CiAgICBtaXNs
        ZWFkIHlvdXIgdXNlcnMgdG8gdGhpbmsgdGhleSBjYW4gb3ZlcnJpZGUgdGhl
        IHByb3BlcnR5IGluIGEgc3ViY2xhc3MpLgoKICAgIEBwcm9wZXJ0eSBjb25j
        YXRlbmF0ZWRQcm9wZXJ0aWVzCiAgICBAdHlwZSBBcnJheQogICAgQGRlZmF1
        bHQgbnVsbAogICovCiAgY29uY2F0ZW5hdGVkUHJvcGVydGllczogbnVsbCwK
        CiAgLyoqCiAgICBEZXN0cm95ZWQgb2JqZWN0IHByb3BlcnR5IGZsYWcuCgog
        ICAgaWYgdGhpcyBwcm9wZXJ0eSBpcyBgdHJ1ZWAgdGhlIG9ic2VydmVycyBh
        bmQgYmluZGluZ3Mgd2VyZSBhbHJlYWR5CiAgICByZW1vdmVkIGJ5IHRoZSBl
        ZmZlY3Qgb2YgY2FsbGluZyB0aGUgYGRlc3Ryb3koKWAgbWV0aG9kLgoKICAg
        IEBwcm9wZXJ0eSBpc0Rlc3Ryb3llZAogICAgQGRlZmF1bHQgZmFsc2UKICAq
        LwogIGlzRGVzdHJveWVkOiBmYWxzZSwKCiAgLyoqCiAgICBEZXN0cnVjdGlv
        biBzY2hlZHVsZWQgZmxhZy4gVGhlIGBkZXN0cm95KClgIG1ldGhvZCBoYXMg
        YmVlbiBjYWxsZWQuCgogICAgVGhlIG9iamVjdCBzdGF5cyBpbnRhY3QgdW50
        aWwgdGhlIGVuZCBvZiB0aGUgcnVuIGxvb3AgYXQgd2hpY2ggcG9pbnQKICAg
        IHRoZSBgaXNEZXN0cm95ZWRgIGZsYWcgaXMgc2V0LgoKICAgIEBwcm9wZXJ0
        eSBpc0Rlc3Ryb3lpbmcKICAgIEBkZWZhdWx0IGZhbHNlCiAgKi8KICBpc0Rl
        c3Ryb3lpbmc6IGZhbHNlLAoKICAvKioKICAgIERlc3Ryb3lzIGFuIG9iamVj
        dCBieSBzZXR0aW5nIHRoZSBgaXNEZXN0cm95ZWRgIGZsYWcgYW5kIHJlbW92
        aW5nIGl0cwogICAgbWV0YWRhdGEsIHdoaWNoIGVmZmVjdGl2ZWx5IGRlc3Ry
        b3lzIG9ic2VydmVycyBhbmQgYmluZGluZ3MuCgogICAgSWYgeW91IHRyeSB0
        byBzZXQgYSBwcm9wZXJ0eSBvbiBhIGRlc3Ryb3llZCBvYmplY3QsIGFuIGV4
        Y2VwdGlvbiB3aWxsIGJlCiAgICByYWlzZWQuCgogICAgTm90ZSB0aGF0IGRl
        c3RydWN0aW9uIGlzIHNjaGVkdWxlZCBmb3IgdGhlIGVuZCBvZiB0aGUgcnVu
        IGxvb3AgYW5kIGRvZXMgbm90CiAgICBoYXBwZW4gaW1tZWRpYXRlbHkuICBJ
        dCB3aWxsIHNldCBhbiBpc0Rlc3Ryb3lpbmcgZmxhZyBpbW1lZGlhdGVseS4K
        CiAgICBAbWV0aG9kIGRlc3Ryb3kKICAgIEByZXR1cm4ge0VtYmVyLk9iamVj
        dH0gcmVjZWl2ZXIKICAqLwogIGRlc3Ryb3k6IGZ1bmN0aW9uKCkgewogICAg
        aWYgKHRoaXMuaXNEZXN0cm95aW5nKSB7IHJldHVybjsgfQogICAgdGhpcy5p
        c0Rlc3Ryb3lpbmcgPSB0cnVlOwoKICAgIHNjaGVkdWxlKCdhY3Rpb25zJywg
        dGhpcywgdGhpcy53aWxsRGVzdHJveSk7CiAgICBzY2hlZHVsZSgnZGVzdHJv
        eScsIHRoaXMsIHRoaXMuX3NjaGVkdWxlZERlc3Ryb3kpOwogICAgcmV0dXJu
        IHRoaXM7CiAgfSwKCiAgLyoqCiAgICBPdmVycmlkZSB0byBpbXBsZW1lbnQg
        dGVhcmRvd24uCgogICAgQG1ldGhvZCB3aWxsRGVzdHJveQogICAqLwogIHdp
        bGxEZXN0cm95OiBFbWJlci5LLAoKICAvKioKICAgIEBwcml2YXRlCgogICAg
        SW52b2tlZCBieSB0aGUgcnVuIGxvb3AgdG8gYWN0dWFsbHkgZGVzdHJveSB0
        aGUgb2JqZWN0LiBUaGlzIGlzCiAgICBzY2hlZHVsZWQgZm9yIGV4ZWN1dGlv
        biBieSB0aGUgYGRlc3Ryb3lgIG1ldGhvZC4KCiAgICBAbWV0aG9kIF9zY2hl
        ZHVsZWREZXN0cm95CiAgKi8KICBfc2NoZWR1bGVkRGVzdHJveTogZnVuY3Rp
        b24oKSB7CiAgICBpZiAodGhpcy5pc0Rlc3Ryb3llZCkgeyByZXR1cm47IH0K
        ICAgIGRlc3Ryb3kodGhpcyk7CiAgICB0aGlzLmlzRGVzdHJveWVkID0gdHJ1
        ZTsKICB9LAoKICBiaW5kOiBmdW5jdGlvbih0bywgZnJvbSkgewogICAgaWYg
        KCEoZnJvbSBpbnN0YW5jZW9mIEVtYmVyLkJpbmRpbmcpKSB7IGZyb20gPSBF
        bWJlci5CaW5kaW5nLmZyb20oZnJvbSk7IH0KICAgIGZyb20udG8odG8pLmNv
        bm5lY3QodGhpcyk7CiAgICByZXR1cm4gZnJvbTsKICB9LAoKICAvKioKICAg
        IFJldHVybnMgYSBzdHJpbmcgcmVwcmVzZW50YXRpb24gd2hpY2ggYXR0ZW1w
        dHMgdG8gcHJvdmlkZSBtb3JlIGluZm9ybWF0aW9uCiAgICB0aGFuIEphdmFz
        Y3JpcHQncyBgdG9TdHJpbmdgIHR5cGljYWxseSBkb2VzLCBpbiBhIGdlbmVy
        aWMgd2F5IGZvciBhbGwgRW1iZXIKICAgIG9iamVjdHMuCgogICAgICAgIEFw
        cC5QZXJzb24gPSBFbS5PYmplY3QuZXh0ZW5kKCkKICAgICAgICBwZXJzb24g
        PSBBcHAuUGVyc29uLmNyZWF0ZSgpCiAgICAgICAgcGVyc29uLnRvU3RyaW5n
        KCkgLy89PiAiPEFwcC5QZXJzb246ZW1iZXIxMDI0PiIKCiAgICBJZiB0aGUg
        b2JqZWN0J3MgY2xhc3MgaXMgbm90IGRlZmluZWQgb24gYW4gRW1iZXIgbmFt
        ZXNwYWNlLCBpdCB3aWxsCiAgICBpbmRpY2F0ZSBpdCBpcyBhIHN1YmNsYXNz
        IG9mIHRoZSByZWdpc3RlcmVkIHN1cGVyY2xhc3M6CgogICAgICAgIFN0dWRl
        bnQgPSBBcHAuUGVyc29uLmV4dGVuZCgpCiAgICAgICAgc3R1ZGVudCA9IFN0
        dWRlbnQuY3JlYXRlKCkKICAgICAgICBzdHVkZW50LnRvU3RyaW5nKCkgLy89
        PiAiPChzdWJjbGFzcyBvZiBBcHAuUGVyc29uKTplbWJlcjEwMjU+IgoKICAg
        IElmIHRoZSBtZXRob2QgYHRvU3RyaW5nRXh0ZW5zaW9uYCBpcyBkZWZpbmVk
        LCBpdHMgcmV0dXJuIHZhbHVlIHdpbGwgYmUKICAgIGluY2x1ZGVkIGluIHRo
        ZSBvdXRwdXQuCgogICAgICAgIEFwcC5UZWFjaGVyID0gQXBwLlBlcnNvbi5l
        eHRlbmQoewogICAgICAgICAgdG9TdHJpbmdFeHRlbnNpb246IGZ1bmN0aW9u
        KCkgewogICAgICAgICAgICByZXR1cm4gdGhpcy5nZXQoJ2Z1bGxOYW1lJyk7
        CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgICAgdGVhY2hlciA9IEFw
        cC5UZWFjaGVyLmNyZWF0ZSgpCiAgICAgICAgdGVhY2hlci50b1N0cmluZygp
        OyAvLz0+ICI8QXBwLlRlYWNoZXI6ZW1iZXIxMDI2OlRvbSBEYWxlPiIKCiAg
        ICBAbWV0aG9kIHRvU3RyaW5nCiAgICBAcmV0dXJuIHtTdHJpbmd9IHN0cmlu
        ZyByZXByZXNlbnRhdGlvbgogICovCiAgdG9TdHJpbmc6IGZ1bmN0aW9uIHRv
        U3RyaW5nKCkgewogICAgdmFyIGhhc1RvU3RyaW5nRXh0ZW5zaW9uID0gdHlw
        ZW9mIHRoaXMudG9TdHJpbmdFeHRlbnNpb24gPT09ICdmdW5jdGlvbicsCiAg
        ICAgICAgZXh0ZW5zaW9uID0gaGFzVG9TdHJpbmdFeHRlbnNpb24gPyAiOiIg
        KyB0aGlzLnRvU3RyaW5nRXh0ZW5zaW9uKCkgOiAnJzsKICAgIHZhciByZXQg
        PSAnPCcrdGhpcy5jb25zdHJ1Y3Rvci50b1N0cmluZygpKyc6JytndWlkRm9y
        KHRoaXMpK2V4dGVuc2lvbisnPic7CiAgICB0aGlzLnRvU3RyaW5nID0gbWFr
        ZVRvU3RyaW5nKHJldCk7CiAgICByZXR1cm4gcmV0OwogIH0KfSk7CgpDb3Jl
        T2JqZWN0LlByb3RvdHlwZU1peGluLm93bmVyQ29uc3RydWN0b3IgPSBDb3Jl
        T2JqZWN0OwoKZnVuY3Rpb24gbWFrZVRvU3RyaW5nKHJldCkgewogIHJldHVy
        biBmdW5jdGlvbigpIHsgcmV0dXJuIHJldDsgfTsKfQoKaWYgKEVtYmVyLmNv
        bmZpZy5vdmVycmlkZVByb3RvdHlwZU1peGluKSB7CiAgRW1iZXIuY29uZmln
        Lm92ZXJyaWRlUHJvdG90eXBlTWl4aW4oQ29yZU9iamVjdC5Qcm90b3R5cGVN
        aXhpbik7Cn0KCkNvcmVPYmplY3QuX19zdXBlcl9fID0gbnVsbDsKCnZhciBD
        bGFzc01peGluID0gTWl4aW4uY3JlYXRlKHsKCiAgQ2xhc3NNaXhpbjogRW1i
        ZXIucmVxdWlyZWQoKSwKCiAgUHJvdG90eXBlTWl4aW46IEVtYmVyLnJlcXVp
        cmVkKCksCgogIGlzQ2xhc3M6IHRydWUsCgogIGlzTWV0aG9kOiBmYWxzZSwK
        CiAgLyoqCiAgICBDcmVhdGVzIGEgbmV3IHN1YmNsYXNzLgoKICAgIGBgYGph
        dmFzY3JpcHQKICAgIEFwcC5QZXJzb24gPSBFbWJlci5PYmplY3QuZXh0ZW5k
        KHsKICAgICAgc2F5OiBmdW5jdGlvbih0aGluZykgewogICAgICAgIGFsZXJ0
        KHRoaW5nKTsKICAgICAgIH0KICAgIH0pOwogICAgYGBgCgogICAgVGhpcyBk
        ZWZpbmVzIGEgbmV3IHN1YmNsYXNzIG9mIEVtYmVyLk9iamVjdDogYEFwcC5Q
        ZXJzb25gLiBJdCBjb250YWlucyBvbmUgbWV0aG9kOiBgc2F5KClgLgoKICAg
        IFlvdSBjYW4gYWxzbyBjcmVhdGUgYSBzdWJjbGFzcyBmcm9tIGFueSBleGlz
        dGluZyBjbGFzcyBieSBjYWxsaW5nIGl0cyBgZXh0ZW5kKClgICBtZXRob2Qu
        IEZvciBleGFtcGxlLCB5b3UgbWlnaHQgd2FudCB0byBjcmVhdGUgYSBzdWJj
        bGFzcyBvZiBFbWJlcidzIGJ1aWx0LWluIGBFbWJlci5WaWV3YCBjbGFzczoK
        CiAgICBgYGBqYXZhc2NyaXB0CiAgICBBcHAuUGVyc29uVmlldyA9IEVtYmVy
        LlZpZXcuZXh0ZW5kKHsKICAgICAgdGFnTmFtZTogJ2xpJywKICAgICAgY2xh
        c3NOYW1lQmluZGluZ3M6IFsnaXNBZG1pbmlzdHJhdG9yJ10KICAgIH0pOwog
        ICAgYGBgCgogICAgV2hlbiBkZWZpbmluZyBhIHN1YmNsYXNzLCB5b3UgY2Fu
        IG92ZXJyaWRlIG1ldGhvZHMgYnV0IHN0aWxsIGFjY2VzcyB0aGUgaW1wbGVt
        ZW50YXRpb24gb2YgeW91ciBwYXJlbnQgY2xhc3MgYnkgY2FsbGluZyB0aGUg
        c3BlY2lhbCBgX3N1cGVyKClgIG1ldGhvZDoKCiAgICBgYGBqYXZhc2NyaXB0
        CiAgICBBcHAuUGVyc29uID0gRW1iZXIuT2JqZWN0LmV4dGVuZCh7CiAgICAg
        IHNheTogZnVuY3Rpb24odGhpbmcpIHsKICAgICAgICB2YXIgbmFtZSA9IHRo
        aXMuZ2V0KCduYW1lJyk7CiAgICAgICAgYWxlcnQobmFtZSArICcgc2F5czog
        JyArIHRoaW5nKTsKICAgICAgfQogICAgfSk7CgogICAgQXBwLlNvbGRpZXIg
        PSBBcHAuUGVyc29uLmV4dGVuZCh7CiAgICAgIHNheTogZnVuY3Rpb24odGhp
        bmcpIHsKICAgICAgICB0aGlzLl9zdXBlcih0aGluZyArICIsIHNpciEiKTsK
        ICAgICAgfSwKICAgICAgbWFyY2g6IGZ1bmN0aW9uKG51bWJlck9mSG91cnMp
        IHsKICAgICAgICBhbGVydCh0aGlzLmdldCgnbmFtZScpICsgJyBtYXJjaGVz
        IGZvciAnICsgbnVtYmVyT2ZIb3VycyArICcgaG91cnMuJykKICAgICAgfQog
        ICAgfSk7CgogICAgdmFyIHllaHVkYSA9IEFwcC5Tb2xkaWVyLmNyZWF0ZSh7
        CiAgICAgIG5hbWU6ICJZZWh1ZGEgS2F0eiIKICAgIH0pOwoKICAgIHllaHVk
        YS5zYXkoIlllcyIpOyAgLy8gYWxlcnRzICJZZWh1ZGEgS2F0eiBzYXlzOiBZ
        ZXMsIHNpciEiCiAgICBgYGAKCiAgICBUaGUgYGNyZWF0ZSgpYCBvbiBsaW5l
        ICMxNyBjcmVhdGVzIGFuICppbnN0YW5jZSogb2YgdGhlIGBBcHAuU29sZGll
        cmAgY2xhc3MuIFRoZSBgZXh0ZW5kKClgIG9uIGxpbmUgIzggY3JlYXRlcyBh
        ICpzdWJjbGFzcyogb2YgYEFwcC5QZXJzb25gLiBBbnkgaW5zdGFuY2Ugb2Yg
        dGhlIGBBcHAuUGVyc29uYCBjbGFzcyB3aWxsICpub3QqIGhhdmUgdGhlIGBt
        YXJjaCgpYCBtZXRob2QuCgogICAgWW91IGNhbiBhbHNvIHBhc3MgYEVtYmVy
        Lk1peGluYCBjbGFzc2VzIHRvIGFkZCBhZGRpdGlvbmFsIHByb3BlcnRpZXMg
        dG8gdGhlIHN1YmNsYXNzLgoKICAgIGBgYGphdmFzY3JpcHQKICAgIEFwcC5Q
        ZXJzb24gPSBFbWJlci5PYmplY3QuZXh0ZW5kKHsKICAgICAgc2F5OiBmdW5j
        dGlvbih0aGluZykgewogICAgICAgIGFsZXJ0KHRoaXMuZ2V0KCduYW1lJykg
        KyAnIHNheXM6ICcgKyB0aGluZyk7CiAgICAgIH0KICAgIH0pOwoKICAgIEFw
        cC5TaW5naW5nTWl4aW4gPSBFbWJlci5NaXhpbi5jcmVhdGUoewogICAgICBz
        aW5nOiBmdW5jdGlvbih0aGluZyl7CiAgICAgICAgYWxlcnQodGhpcy5nZXQo
        J25hbWUnKSArICcgc2luZ3M6IGxhIGxhIGxhICcgKyB0aGluZyk7CiAgICAg
        IH0KICAgIH0pOwoKICAgIEFwcC5Ccm9hZHdheVN0YXIgPSBBcHAuUGVyc29u
        LmV4dGVuZChBcHAuU2luZ2luZ01peGluLCB7CiAgICAgIGRhbmNlOiBmdW5j
        dGlvbigpIHsKICAgICAgICBhbGVydCh0aGlzLmdldCgnbmFtZScpICsgJyBk
        YW5jZXM6IHRhcCB0YXAgdGFwIHRhcCAnKTsKICAgICAgfQogICAgfSk7CiAg
        ICBgYGAKCiAgICBUaGUgYEFwcC5Ccm9hZHdheVN0YXJgIGNsYXNzIGNvbnRh
        aW5zIHRocmVlIG1ldGhvZHM6IGBzYXkoKWAsIGBzaW5nKClgLCBhbmQgYGRh
        bmNlKClgLgoKICAgIEBtZXRob2QgZXh0ZW5kCiAgICBAc3RhdGljCgogICAg
        QHBhcmFtIHtFbWJlci5NaXhpbn0gW21peGluc10qIE9uZSBvciBtb3JlIEVt
        YmVyLk1peGluIGNsYXNzZXMKICAgIEBwYXJhbSB7T2JqZWN0fSBbYXJndW1l
        bnRzXSogT2JqZWN0IGNvbnRhaW5pbmcgdmFsdWVzIHRvIHVzZSB3aXRoaW4g
        dGhlIG5ldyBjbGFzcwogICovCiAgZXh0ZW5kOiBmdW5jdGlvbigpIHsKICAg
        IHZhciBDbGFzcyA9IG1ha2VDdG9yKCksIHByb3RvOwogICAgQ2xhc3MuQ2xh
        c3NNaXhpbiA9IE1peGluLmNyZWF0ZSh0aGlzLkNsYXNzTWl4aW4pOwogICAg
        Q2xhc3MuUHJvdG90eXBlTWl4aW4gPSBNaXhpbi5jcmVhdGUodGhpcy5Qcm90
        b3R5cGVNaXhpbik7CgogICAgQ2xhc3MuQ2xhc3NNaXhpbi5vd25lckNvbnN0
        cnVjdG9yID0gQ2xhc3M7CiAgICBDbGFzcy5Qcm90b3R5cGVNaXhpbi5vd25l
        ckNvbnN0cnVjdG9yID0gQ2xhc3M7CgogICAgcmVvcGVuLmFwcGx5KENsYXNz
        LlByb3RvdHlwZU1peGluLCBhcmd1bWVudHMpOwoKICAgIENsYXNzLnN1cGVy
        Y2xhc3MgPSB0aGlzOwogICAgQ2xhc3MuX19zdXBlcl9fICA9IHRoaXMucHJv
        dG90eXBlOwoKICAgIHByb3RvID0gQ2xhc3MucHJvdG90eXBlID0gb19jcmVh
        dGUodGhpcy5wcm90b3R5cGUpOwogICAgcHJvdG8uY29uc3RydWN0b3IgPSBD
        bGFzczsKICAgIGdlbmVyYXRlR3VpZChwcm90bywgJ2VtYmVyJyk7CiAgICBt
        ZXRhKHByb3RvKS5wcm90byA9IHByb3RvOyAvLyB0aGlzIHdpbGwgZGlzYWJs
        ZSBvYnNlcnZlcnMgb24gcHJvdG90eXBlCgogICAgQ2xhc3MuQ2xhc3NNaXhp
        bi5hcHBseShDbGFzcyk7CiAgICByZXR1cm4gQ2xhc3M7CiAgfSwKCiAgLyoq
        CiAgICBFcXVpdmFsZW50IHRvIGRvaW5nIGBleHRlbmQoYXJndW1lbnRzKS5j
        cmVhdGUoKWAuCiAgICBJZiBwb3NzaWJsZSB1c2UgdGhlIG5vcm1hbCBgY3Jl
        YXRlYCBtZXRob2QgaW5zdGVhZC4KCiAgICBAbWV0aG9kIGNyZWF0ZVdpdGhN
        aXhpbnMKICAgIEBzdGF0aWMKICAgIEBwYXJhbSBbYXJndW1lbnRzXSoKICAq
        LwogIGNyZWF0ZVdpdGhNaXhpbnM6IGZ1bmN0aW9uKCkgewogICAgdmFyIEMg
        PSB0aGlzOwogICAgaWYgKGFyZ3VtZW50cy5sZW5ndGg+MCkgeyB0aGlzLl9p
        bml0TWl4aW5zKGFyZ3VtZW50cyk7IH0KICAgIHJldHVybiBuZXcgQygpOwog
        IH0sCgogIC8qKgogICAgQ3JlYXRlcyBhbiBpbnN0YW5jZSBvZiBhIGNsYXNz
        LiBBY2NlcHRzIGVpdGhlciBubyBhcmd1bWVudHMsIG9yIGFuIG9iamVjdAog
        ICAgY29udGFpbmluZyB2YWx1ZXMgdG8gaW5pdGlhbGl6ZSB0aGUgbmV3bHkg
        aW5zdGFudGlhdGVkIG9iamVjdCB3aXRoLgoKICAgIGBgYGphdmFzY3JpcHQK
        ICAgIEFwcC5QZXJzb24gPSBFbWJlci5PYmplY3QuZXh0ZW5kKHsKICAgICAg
        aGVsbG9Xb3JsZDogZnVuY3Rpb24oKSB7CiAgICAgICAgYWxlcnQoIkhpLCBt
        eSBuYW1lIGlzICIgKyB0aGlzLmdldCgnbmFtZScpKTsKICAgICAgfQogICAg
        fSk7CgogICAgdmFyIHRvbSA9IEFwcC5QZXJzb24uY3JlYXRlKHsKICAgICAg
        bmFtZTogJ1RvbSBEYWxlJwogICAgfSk7CgogICAgdG9tLmhlbGxvV29ybGQo
        KTsgLy8gYWxlcnRzICJIaSwgbXkgbmFtZSBpcyBUb20gRGFsZSIuCiAgICBg
        YGAKCiAgICBgY3JlYXRlYCB3aWxsIGNhbGwgdGhlIGBpbml0YCBmdW5jdGlv
        biBpZiBkZWZpbmVkIGR1cmluZwogICAgYEVtYmVyLkFueU9iamVjdC5leHRl
        bmRgCgogICAgSWYgbm8gYXJndW1lbnRzIGFyZSBwYXNzZWQgdG8gYGNyZWF0
        ZWAsIGl0IHdpbGwgbm90IHNldCB2YWx1ZXMgdG8gdGhlIG5ldwogICAgaW5z
        dGFuY2UgZHVyaW5nIGluaXRpYWxpemF0aW9uOgoKICAgIGBgYGphdmFzY3Jp
        cHQKICAgIHZhciBub05hbWUgPSBBcHAuUGVyc29uLmNyZWF0ZSgpOwogICAg
        bm9OYW1lLmhlbGxvV29ybGQoKTsgLy8gYWxlcnRzIHVuZGVmaW5lZAogICAg
        YGBgCgogICAgTk9URTogRm9yIHBlcmZvcm1hbmNlIHJlYXNvbnMsIHlvdSBj
        YW5ub3QgZGVjbGFyZSBtZXRob2RzIG9yIGNvbXB1dGVkCiAgICBwcm9wZXJ0
        aWVzIGR1cmluZyBgY3JlYXRlYC4gWW91IHNob3VsZCBpbnN0ZWFkIGRlY2xh
        cmUgbWV0aG9kcyBhbmQgY29tcHV0ZWQKICAgIHByb3BlcnRpZXMgd2hlbiB1
        c2luZyBgZXh0ZW5kYCBvciB1c2UgdGhlIGBjcmVhdGVXaXRoTWl4aW5zYCBz
        aG9ydGhhbmQuCgogICAgQG1ldGhvZCBjcmVhdGUKICAgIEBzdGF0aWMKICAg
        IEBwYXJhbSBbYXJndW1lbnRzXSoKICAqLwogIGNyZWF0ZTogZnVuY3Rpb24o
        KSB7CiAgICB2YXIgQyA9IHRoaXM7CiAgICBpZiAoYXJndW1lbnRzLmxlbmd0
        aD4wKSB7IHRoaXMuX2luaXRQcm9wZXJ0aWVzKGFyZ3VtZW50cyk7IH0KICAg
        IHJldHVybiBuZXcgQygpOwogIH0sCgogIC8qKgoKICAgIEF1Z21lbnRzIGEg
        Y29uc3RydWN0b3IncyBwcm90b3R5cGUgd2l0aCBhZGRpdGlvbmFsCiAgICBw
        cm9wZXJ0aWVzIGFuZCBmdW5jdGlvbnM6CgogICAgYGBgamF2YXNjcmlwdAog
        ICAgTXlPYmplY3QgPSBFbWJlci5PYmplY3QuZXh0ZW5kKHsKICAgICAgbmFt
        ZTogJ2FuIG9iamVjdCcKICAgIH0pOwoKICAgIG8gPSBNeU9iamVjdC5jcmVh
        dGUoKTsKICAgIG8uZ2V0KCduYW1lJyk7IC8vICdhbiBvYmplY3QnCgogICAg
        TXlPYmplY3QucmVvcGVuKHsKICAgICAgc2F5OiBmdW5jdGlvbihtc2cpewog
        ICAgICAgIGNvbnNvbGUubG9nKG1zZyk7CiAgICAgIH0KICAgIH0pCgogICAg
        bzIgPSBNeU9iamVjdC5jcmVhdGUoKTsKICAgIG8yLnNheSgiaGVsbG8iKTsg
        Ly8gbG9ncyAiaGVsbG8iCgogICAgby5zYXkoImdvb2RieWUiKTsgLy8gbG9n
        cyAiZ29vZGJ5ZSIKICAgIGBgYAoKICAgIFRvIGFkZCBmdW5jdGlvbnMgYW5k
        IHByb3BlcnRpZXMgdG8gdGhlIGNvbnN0cnVjdG9yIGl0c2VsZiwKICAgIHNl
        ZSBgcmVvcGVuQ2xhc3NgCgogICAgQG1ldGhvZCByZW9wZW4KICAqLwogIHJl
        b3BlbjogZnVuY3Rpb24oKSB7CiAgICB0aGlzLndpbGxSZW9wZW4oKTsKICAg
        IHJlb3Blbi5hcHBseSh0aGlzLlByb3RvdHlwZU1peGluLCBhcmd1bWVudHMp
        OwogICAgcmV0dXJuIHRoaXM7CiAgfSwKCiAgLyoqCiAgICBBdWdtZW50cyBh
        IGNvbnN0cnVjdG9yJ3Mgb3duIHByb3BlcnRpZXMgYW5kIGZ1bmN0aW9uczoK
        CiAgICBgYGBqYXZhc2NyaXB0CiAgICBNeU9iamVjdCA9IEVtYmVyLk9iamVj
        dC5leHRlbmQoewogICAgICBuYW1lOiAnYW4gb2JqZWN0JwogICAgfSk7CgoK
        ICAgIE15T2JqZWN0LnJlb3BlbkNsYXNzKHsKICAgICAgY2FuQnVpbGQ6IGZh
        bHNlCiAgICB9KTsKCiAgICBNeU9iamVjdC5jYW5CdWlsZDsgLy8gZmFsc2UK
        ICAgIG8gPSBNeU9iamVjdC5jcmVhdGUoKTsKICAgIGBgYAoKICAgIEluIG90
        aGVyIHdvcmRzLCB0aGlzIGNyZWF0ZXMgc3RhdGljIHByb3BlcnRpZXMgYW5k
        IGZ1bmN0aW9ucyBmb3IgdGhlIGNsYXNzLiBUaGVzZSBhcmUgb25seSBhdmFp
        bGFibGUgb24gdGhlIGNsYXNzCiAgICBhbmQgbm90IG9uIGFueSBpbnN0YW5j
        ZSBvZiB0aGF0IGNsYXNzLgoKICAgIGBgYGphdmFzY3JpcHQKICAgIEFwcC5Q
        ZXJzb24gPSBFbWJlci5PYmplY3QuZXh0ZW5kKHsKICAgICAgbmFtZSA6ICIi
        LAogICAgICBzYXlIZWxsbyA6IGZ1bmN0aW9uKCl7CiAgICAgICAgYWxlcnQo
        IkhlbGxvLiBNeSBuYW1lIGlzICIgKyB0aGlzLmdldCgnbmFtZScpKTsKICAg
        ICAgfQogICAgfSk7CgogICAgQXBwLlBlcnNvbi5yZW9wZW5DbGFzcyh7CiAg
        ICAgIHNwZWNpZXMgOiAiSG9tbyBzYXBpZW5zIiwKICAgICAgY3JlYXRlUGVy
        c29uOiBmdW5jdGlvbihuZXdQZXJzb25zTmFtZSl7CiAgICAgICAgcmV0dXJu
        IEFwcC5QZXJzb24uY3JlYXRlKHsKICAgICAgICAgIG5hbWU6bmV3UGVyc29u
        c05hbWUKICAgICAgICB9KTsKICAgICAgfQogICAgfSk7CgogICAgdmFyIHRv
        bSA9IEFwcC5QZXJzb24uY3JlYXRlKHsKICAgICAgbmFtZSA6ICJUb20gRGFs
        ZSIKICAgIH0pOwogICAgdmFyIHllaHVkYSA9IEFwcC5QZXJzb24uY3JlYXRl
        UGVyc29uKCJZZWh1ZGEgS2F0eiIpOwoKICAgIHRvbS5zYXlIZWxsbygpOyAv
        LyAiSGVsbG8uIE15IG5hbWUgaXMgVG9tIERhbGUiCiAgICB5ZWh1ZGEuc2F5
        SGVsbG8oKTsgLy8gIkhlbGxvLiBNeSBuYW1lIGlzIFllaHVkYSBLYXR6Igog
        ICAgYWxlcnQoQXBwLlBlcnNvbi5zcGVjaWVzKTsgLy8gIkhvbW8gc2FwaWVu
        cyIKICAgIGBgYAoKICAgIE5vdGUgdGhhdCBgc3BlY2llc2AgYW5kIGBjcmVh
        dGVQZXJzb25gIGFyZSAqbm90KiB2YWxpZCBvbiB0aGUgYHRvbWAgYW5kIGB5
        ZWh1ZGFgCiAgICB2YXJpYWJsZXMuIFRoZXkgYXJlIG9ubHkgdmFsaWQgb24g
        YEFwcC5QZXJzb25gLgoKICAgIFRvIGFkZCBmdW5jdGlvbnMgYW5kIHByb3Bl
        cnRpZXMgdG8gaW5zdGFuY2VzIG9mCiAgICBhIGNvbnN0cnVjdG9yIGJ5IGV4
        dGVuZGluZyB0aGUgY29uc3RydWN0b3IncyBwcm90b3R5cGUKICAgIHNlZSBg
        cmVvcGVuYAoKICAgIEBtZXRob2QgcmVvcGVuQ2xhc3MKICAqLwogIHJlb3Bl
        bkNsYXNzOiBmdW5jdGlvbigpIHsKICAgIHJlb3Blbi5hcHBseSh0aGlzLkNs
        YXNzTWl4aW4sIGFyZ3VtZW50cyk7CiAgICBhcHBseU1peGluKHRoaXMsIGFy
        Z3VtZW50cywgZmFsc2UpOwogICAgcmV0dXJuIHRoaXM7CiAgfSwKCiAgZGV0
        ZWN0OiBmdW5jdGlvbihvYmopIHsKICAgIGlmICgnZnVuY3Rpb24nICE9PSB0
        eXBlb2Ygb2JqKSB7IHJldHVybiBmYWxzZTsgfQogICAgd2hpbGUob2JqKSB7
        CiAgICAgIGlmIChvYmo9PT10aGlzKSB7IHJldHVybiB0cnVlOyB9CiAgICAg
        IG9iaiA9IG9iai5zdXBlcmNsYXNzOwogICAgfQogICAgcmV0dXJuIGZhbHNl
        OwogIH0sCgogIGRldGVjdEluc3RhbmNlOiBmdW5jdGlvbihvYmopIHsKICAg
        IHJldHVybiBvYmogaW5zdGFuY2VvZiB0aGlzOwogIH0sCgogIC8qKgogICAg
        SW4gc29tZSBjYXNlcywgeW91IG1heSB3YW50IHRvIGFubm90YXRlIGNvbXB1
        dGVkIHByb3BlcnRpZXMgd2l0aCBhZGRpdGlvbmFsCiAgICBtZXRhZGF0YSBh
        Ym91dCBob3cgdGhleSBmdW5jdGlvbiBvciB3aGF0IHZhbHVlcyB0aGV5IG9w
        ZXJhdGUgb24uIEZvcgogICAgZXhhbXBsZSwgY29tcHV0ZWQgcHJvcGVydHkg
        ZnVuY3Rpb25zIG1heSBjbG9zZSBvdmVyIHZhcmlhYmxlcyB0aGF0IGFyZSB0
        aGVuCiAgICBubyBsb25nZXIgYXZhaWxhYmxlIGZvciBpbnRyb3NwZWN0aW9u
        LgoKICAgIFlvdSBjYW4gcGFzcyBhIGhhc2ggb2YgdGhlc2UgdmFsdWVzIHRv
        IGEgY29tcHV0ZWQgcHJvcGVydHkgbGlrZSB0aGlzOgoKICAgIGBgYGphdmFz
        Y3JpcHQKICAgIHBlcnNvbjogZnVuY3Rpb24oKSB7CiAgICAgIHZhciBwZXJz
        b25JZCA9IHRoaXMuZ2V0KCdwZXJzb25JZCcpOwogICAgICByZXR1cm4gQXBw
        LlBlcnNvbi5jcmVhdGUoeyBpZDogcGVyc29uSWQgfSk7CiAgICB9LnByb3Bl
        cnR5KCkubWV0YSh7IHR5cGU6IEFwcC5QZXJzb24gfSkKICAgIGBgYAoKICAg
        IE9uY2UgeW91J3ZlIGRvbmUgdGhpcywgeW91IGNhbiByZXRyaWV2ZSB0aGUg
        dmFsdWVzIHNhdmVkIHRvIHRoZSBjb21wdXRlZAogICAgcHJvcGVydHkgZnJv
        bSB5b3VyIGNsYXNzIGxpa2UgdGhpczoKCiAgICBgYGBqYXZhc2NyaXB0CiAg
        ICBNeUNsYXNzLm1ldGFGb3JQcm9wZXJ0eSgncGVyc29uJyk7CiAgICBgYGAK
        CiAgICBUaGlzIHdpbGwgcmV0dXJuIHRoZSBvcmlnaW5hbCBoYXNoIHRoYXQg
        d2FzIHBhc3NlZCB0byBgbWV0YSgpYC4KCiAgICBAbWV0aG9kIG1ldGFGb3JQ
        cm9wZXJ0eQogICAgQHBhcmFtIGtleSB7U3RyaW5nfSBwcm9wZXJ0eSBuYW1l
        CiAgKi8KICBtZXRhRm9yUHJvcGVydHk6IGZ1bmN0aW9uKGtleSkgewogICAg
        dmFyIGRlc2MgPSBtZXRhKHRoaXMucHJvdG8oKSwgZmFsc2UpLmRlc2NzW2tl
        eV07CgogICAgRW1iZXIuYXNzZXJ0KCJtZXRhRm9yUHJvcGVydHkoKSBjb3Vs
        ZCBub3QgZmluZCBhIGNvbXB1dGVkIHByb3BlcnR5IHdpdGgga2V5ICciK2tl
        eSsiJy4iLCAhIWRlc2MgJiYgZGVzYyBpbnN0YW5jZW9mIEVtYmVyLkNvbXB1
        dGVkUHJvcGVydHkpOwogICAgcmV0dXJuIGRlc2MuX21ldGEgfHwge307CiAg
        fSwKCiAgLyoqCiAgICBJdGVyYXRlIG92ZXIgZWFjaCBjb21wdXRlZCBwcm9w
        ZXJ0eSBmb3IgdGhlIGNsYXNzLCBwYXNzaW5nIGl0cyBuYW1lCiAgICBhbmQg
        YW55IGFzc29jaWF0ZWQgbWV0YWRhdGEgKHNlZSBgbWV0YUZvclByb3BlcnR5
        YCkgdG8gdGhlIGNhbGxiYWNrLgoKICAgIEBtZXRob2QgZWFjaENvbXB1dGVk
        UHJvcGVydHkKICAgIEBwYXJhbSB7RnVuY3Rpb259IGNhbGxiYWNrCiAgICBA
        cGFyYW0ge09iamVjdH0gYmluZGluZwogICovCiAgZWFjaENvbXB1dGVkUHJv
        cGVydHk6IGZ1bmN0aW9uKGNhbGxiYWNrLCBiaW5kaW5nKSB7CiAgICB2YXIg
        cHJvdG8gPSB0aGlzLnByb3RvKCksCiAgICAgICAgZGVzY3MgPSBtZXRhKHBy
        b3RvKS5kZXNjcywKICAgICAgICBlbXB0eSA9IHt9LAogICAgICAgIHByb3Bl
        cnR5OwoKICAgIGZvciAodmFyIG5hbWUgaW4gZGVzY3MpIHsKICAgICAgcHJv
        cGVydHkgPSBkZXNjc1tuYW1lXTsKCiAgICAgIGlmIChwcm9wZXJ0eSBpbnN0
        YW5jZW9mIEVtYmVyLkNvbXB1dGVkUHJvcGVydHkpIHsKICAgICAgICBjYWxs
        YmFjay5jYWxsKGJpbmRpbmcgfHwgdGhpcywgbmFtZSwgcHJvcGVydHkuX21l
        dGEgfHwgZW1wdHkpOwogICAgICB9CiAgICB9CiAgfQoKfSk7CgpDbGFzc01p
        eGluLm93bmVyQ29uc3RydWN0b3IgPSBDb3JlT2JqZWN0OwoKaWYgKEVtYmVy
        LmNvbmZpZy5vdmVycmlkZUNsYXNzTWl4aW4pIHsKICBFbWJlci5jb25maWcu
        b3ZlcnJpZGVDbGFzc01peGluKENsYXNzTWl4aW4pOwp9CgpDb3JlT2JqZWN0
        LkNsYXNzTWl4aW4gPSBDbGFzc01peGluOwpDbGFzc01peGluLmFwcGx5KENv
        cmVPYmplY3QpOwoKRW1iZXIuQ29yZU9iamVjdCA9IENvcmVPYmplY3Q7Cgp9
        KSgpOwoKCgooZnVuY3Rpb24oKSB7Ci8qKgpAbW9kdWxlIGVtYmVyCkBzdWJt
        b2R1bGUgZW1iZXItcnVudGltZQoqLwoKLyoqCiAgYEVtYmVyLk9iamVjdGAg
        aXMgdGhlIG1haW4gYmFzZSBjbGFzcyBmb3IgYWxsIEVtYmVyIG9iamVjdHMu
        IEl0IGlzIGEgc3ViY2xhc3MKICBvZiBgRW1iZXIuQ29yZU9iamVjdGAgd2l0
        aCB0aGUgYEVtYmVyLk9ic2VydmFibGVgIG1peGluIGFwcGxpZWQuIEZvciBk
        ZXRhaWxzLAogIHNlZSB0aGUgZG9jdW1lbnRhdGlvbiBmb3IgZWFjaCBvZiB0
        aGVzZS4KCiAgQGNsYXNzIE9iamVjdAogIEBuYW1lc3BhY2UgRW1iZXIKICBA
        ZXh0ZW5kcyBFbWJlci5Db3JlT2JqZWN0CiAgQHVzZXMgRW1iZXIuT2JzZXJ2
        YWJsZQoqLwpFbWJlci5PYmplY3QgPSBFbWJlci5Db3JlT2JqZWN0LmV4dGVu
        ZChFbWJlci5PYnNlcnZhYmxlKTsKRW1iZXIuT2JqZWN0LnRvU3RyaW5nID0g
        ZnVuY3Rpb24oKSB7IHJldHVybiAiRW1iZXIuT2JqZWN0IjsgfTsKCn0pKCk7
        CgoKCihmdW5jdGlvbigpIHsKLyoqCkBtb2R1bGUgZW1iZXIKQHN1Ym1vZHVs
        ZSBlbWJlci1ydW50aW1lCiovCgp2YXIgZ2V0ID0gRW1iZXIuZ2V0LCBpbmRl
        eE9mID0gRW1iZXIuQXJyYXlQb2x5ZmlsbHMuaW5kZXhPZjsKCi8qKgogIEEg
        TmFtZXNwYWNlIGlzIGFuIG9iamVjdCB1c3VhbGx5IHVzZWQgdG8gY29udGFp
        biBvdGhlciBvYmplY3RzIG9yIG1ldGhvZHMKICBzdWNoIGFzIGFuIGFwcGxp
        Y2F0aW9uIG9yIGZyYW1ld29yay4gQ3JlYXRlIGEgbmFtZXNwYWNlIGFueXRp
        bWUgeW91IHdhbnQKICB0byBkZWZpbmUgb25lIG9mIHRoZXNlIG5ldyBjb250
        YWluZXJzLgoKICAjIEV4YW1wbGUgVXNhZ2UKCiAgYGBgamF2YXNjcmlwdAog
        IE15RnJhbWV3b3JrID0gRW1iZXIuTmFtZXNwYWNlLmNyZWF0ZSh7CiAgICBW
        RVJTSU9OOiAnMS4wLjAnCiAgfSk7CiAgYGBgCgogIEBjbGFzcyBOYW1lc3Bh
        Y2UKICBAbmFtZXNwYWNlIEVtYmVyCiAgQGV4dGVuZHMgRW1iZXIuT2JqZWN0
        CiovCnZhciBOYW1lc3BhY2UgPSBFbWJlci5OYW1lc3BhY2UgPSBFbWJlci5P
        YmplY3QuZXh0ZW5kKHsKICBpc05hbWVzcGFjZTogdHJ1ZSwKCiAgaW5pdDog
        ZnVuY3Rpb24oKSB7CiAgICBFbWJlci5OYW1lc3BhY2UuTkFNRVNQQUNFUy5w
        dXNoKHRoaXMpOwogICAgRW1iZXIuTmFtZXNwYWNlLlBST0NFU1NFRCA9IGZh
        bHNlOwogIH0sCgogIHRvU3RyaW5nOiBmdW5jdGlvbigpIHsKICAgIHZhciBu
        YW1lID0gZ2V0KHRoaXMsICduYW1lJyk7CiAgICBpZiAobmFtZSkgeyByZXR1
        cm4gbmFtZTsgfQoKICAgIGZpbmROYW1lc3BhY2VzKCk7CiAgICByZXR1cm4g
        dGhpc1tFbWJlci5HVUlEX0tFWSsnX25hbWUnXTsKICB9LAoKICBuYW1lQ2xh
        c3NlczogZnVuY3Rpb24oKSB7CiAgICBwcm9jZXNzTmFtZXNwYWNlKFt0aGlz
        LnRvU3RyaW5nKCldLCB0aGlzLCB7fSk7CiAgfSwKCiAgZGVzdHJveTogZnVu
        Y3Rpb24oKSB7CiAgICB2YXIgbmFtZXNwYWNlcyA9IEVtYmVyLk5hbWVzcGFj
        ZS5OQU1FU1BBQ0VTOwogICAgRW1iZXIubG9va3VwW3RoaXMudG9TdHJpbmco
        KV0gPSB1bmRlZmluZWQ7CiAgICBuYW1lc3BhY2VzLnNwbGljZShpbmRleE9m
        LmNhbGwobmFtZXNwYWNlcywgdGhpcyksIDEpOwogICAgdGhpcy5fc3VwZXIo
        KTsKICB9Cn0pOwoKTmFtZXNwYWNlLnJlb3BlbkNsYXNzKHsKICBOQU1FU1BB
        Q0VTOiBbRW1iZXJdLAogIE5BTUVTUEFDRVNfQllfSUQ6IHt9LAogIFBST0NF
        U1NFRDogZmFsc2UsCiAgcHJvY2Vzc0FsbDogcHJvY2Vzc0FsbE5hbWVzcGFj
        ZXMsCiAgYnlOYW1lOiBmdW5jdGlvbihuYW1lKSB7CiAgICBpZiAoIUVtYmVy
        LkJPT1RFRCkgewogICAgICBwcm9jZXNzQWxsTmFtZXNwYWNlcygpOwogICAg
        fQoKICAgIHJldHVybiBOQU1FU1BBQ0VTX0JZX0lEW25hbWVdOwogIH0KfSk7
        Cgp2YXIgTkFNRVNQQUNFU19CWV9JRCA9IE5hbWVzcGFjZS5OQU1FU1BBQ0VT
        X0JZX0lEOwoKdmFyIGhhc093blByb3AgPSAoe30pLmhhc093blByb3BlcnR5
        LAogICAgZ3VpZEZvciA9IEVtYmVyLmd1aWRGb3I7CgpmdW5jdGlvbiBwcm9j
        ZXNzTmFtZXNwYWNlKHBhdGhzLCByb290LCBzZWVuKSB7CiAgdmFyIGlkeCA9
        IHBhdGhzLmxlbmd0aDsKCiAgTkFNRVNQQUNFU19CWV9JRFtwYXRocy5qb2lu
        KCcuJyldID0gcm9vdDsKCiAgLy8gTG9vcCBvdmVyIGFsbCBvZiB0aGUga2V5
        cyBpbiB0aGUgbmFtZXNwYWNlLCBsb29raW5nIGZvciBjbGFzc2VzCiAgZm9y
        KHZhciBrZXkgaW4gcm9vdCkgewogICAgaWYgKCFoYXNPd25Qcm9wLmNhbGwo
        cm9vdCwga2V5KSkgeyBjb250aW51ZTsgfQogICAgdmFyIG9iaiA9IHJvb3Rb
        a2V5XTsKCiAgICAvLyBJZiB3ZSBhcmUgcHJvY2Vzc2luZyB0aGUgYEVtYmVy
        YCBuYW1lc3BhY2UsIGZvciBleGFtcGxlLCB0aGUKICAgIC8vIGBwYXRoc2Ag
        d2lsbCBzdGFydCB3aXRoIGBbIkVtYmVyIl1gLiBFdmVyeSBpdGVyYXRpb24g
        dGhyb3VnaAogICAgLy8gdGhlIGxvb3Agd2lsbCB1cGRhdGUgdGhlICoqc2Vj
        b25kKiogZWxlbWVudCBvZiB0aGlzIGxpc3Qgd2l0aAogICAgLy8gdGhlIGtl
        eSwgc28gcHJvY2Vzc2luZyBgRW1iZXIuVmlld2Agd2lsbCBtYWtlIHRoZSBB
        cnJheQogICAgLy8gYFsnRW1iZXInLCAnVmlldyddYC4KICAgIHBhdGhzW2lk
        eF0gPSBrZXk7CgogICAgLy8gSWYgd2UgaGF2ZSBmb3VuZCBhbiB1bnByb2Nl
        c3NlZCBjbGFzcwogICAgaWYgKG9iaiAmJiBvYmoudG9TdHJpbmcgPT09IGNs
        YXNzVG9TdHJpbmcpIHsKICAgICAgLy8gUmVwbGFjZSB0aGUgY2xhc3MnIGB0
        b1N0cmluZ2Agd2l0aCB0aGUgZG90LXNlcGFyYXRlZCBwYXRoCiAgICAgIC8v
        IGFuZCBzZXQgaXRzIGBOQU1FX0tFWWAKICAgICAgb2JqLnRvU3RyaW5nID0g
        bWFrZVRvU3RyaW5nKHBhdGhzLmpvaW4oJy4nKSk7CiAgICAgIG9ialtOQU1F
        X0tFWV0gPSBwYXRocy5qb2luKCcuJyk7CgogICAgLy8gU3VwcG9ydCBuZXN0
        ZWQgbmFtZXNwYWNlcwogICAgfSBlbHNlIGlmIChvYmogJiYgb2JqLmlzTmFt
        ZXNwYWNlKSB7CiAgICAgIC8vIFNraXAgYWxpYXNlZCBuYW1lc3BhY2VzCiAg
        ICAgIGlmIChzZWVuW2d1aWRGb3Iob2JqKV0pIHsgY29udGludWU7IH0KICAg
        ICAgc2VlbltndWlkRm9yKG9iaildID0gdHJ1ZTsKCiAgICAgIC8vIFByb2Nl
        c3MgdGhlIGNoaWxkIG5hbWVzcGFjZQogICAgICBwcm9jZXNzTmFtZXNwYWNl
        KHBhdGhzLCBvYmosIHNlZW4pOwogICAgfQogIH0KCiAgcGF0aHMubGVuZ3Ro
        ID0gaWR4OyAvLyBjdXQgb3V0IGxhc3QgaXRlbQp9CgpmdW5jdGlvbiBmaW5k
        TmFtZXNwYWNlcygpIHsKICB2YXIgTmFtZXNwYWNlID0gRW1iZXIuTmFtZXNw
        YWNlLCBsb29rdXAgPSBFbWJlci5sb29rdXAsIG9iaiwgaXNOYW1lc3BhY2U7
        CgogIGlmIChOYW1lc3BhY2UuUFJPQ0VTU0VEKSB7IHJldHVybjsgfQoKICBm
        b3IgKHZhciBwcm9wIGluIGxvb2t1cCkgewogICAgLy8gVGhlc2UgZG9uJ3Qg
        cmFpc2UgZXhjZXB0aW9ucyBidXQgY2FuIGNhdXNlIHdhcm5pbmdzCiAgICBp
        ZiAocHJvcCA9PT0gInBhcmVudCIgfHwgcHJvcCA9PT0gInRvcCIgfHwgcHJv
        cCA9PT0gImZyYW1lRWxlbWVudCIgfHwgcHJvcCA9PT0gIndlYmtpdFN0b3Jh
        Z2VJbmZvIikgeyBjb250aW51ZTsgfQoKICAgIC8vICBnZXQod2luZG93Lmds
        b2JhbFN0b3JhZ2UsICdpc05hbWVzcGFjZScpIHdvdWxkIHRyeSB0byByZWFk
        IHRoZSBzdG9yYWdlIGZvciBkb21haW4gaXNOYW1lc3BhY2UgYW5kIGNhdXNl
        IGV4Y2VwdGlvbiBpbiBGaXJlZm94LgogICAgLy8gZ2xvYmFsU3RvcmFnZSBp
        cyBhIHN0b3JhZ2Ugb2Jzb2xldGVkIGJ5IHRoZSBXaGF0V0cgc3RvcmFnZSBz
        cGVjaWZpY2F0aW9uLiBTZWUgaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5v
        cmcvZW4vRE9NL1N0b3JhZ2UjZ2xvYmFsU3RvcmFnZQogICAgaWYgKHByb3Ag
        PT09ICJnbG9iYWxTdG9yYWdlIiAmJiBsb29rdXAuU3RvcmFnZUxpc3QgJiYg
        bG9va3VwLmdsb2JhbFN0b3JhZ2UgaW5zdGFuY2VvZiBsb29rdXAuU3RvcmFn
        ZUxpc3QpIHsgY29udGludWU7IH0KICAgIC8vIFVuZm9ydHVuYXRlbHksIHNv
        bWUgdmVyc2lvbnMgb2YgSUUgZG9uJ3Qgc3VwcG9ydCB3aW5kb3cuaGFzT3du
        UHJvcGVydHkKICAgIGlmIChsb29rdXAuaGFzT3duUHJvcGVydHkgJiYgIWxv
        b2t1cC5oYXNPd25Qcm9wZXJ0eShwcm9wKSkgeyBjb250aW51ZTsgfQoKICAg
        IC8vIEF0IHRpbWVzIHdlIGFyZSBub3QgYWxsb3dlZCB0byBhY2Nlc3MgY2Vy
        dGFpbiBwcm9wZXJ0aWVzIGZvciBzZWN1cml0eSByZWFzb25zLgogICAgLy8g
        VGhlcmUgYXJlIGFsc28gdGltZXMgd2hlcmUgZXZlbiBpZiB3ZSBjYW4gYWNj
        ZXNzIHRoZW0sIHdlIGFyZSBub3QgYWxsb3dlZCB0byBhY2Nlc3MgdGhlaXIg
        cHJvcGVydGllcy4KICAgIHRyeSB7CiAgICAgIG9iaiA9IEVtYmVyLmxvb2t1
        cFtwcm9wXTsKICAgICAgaXNOYW1lc3BhY2UgPSBvYmogJiYgb2JqLmlzTmFt
        ZXNwYWNlOwogICAgfSBjYXRjaCAoZSkgewogICAgICBjb250aW51ZTsKICAg
        IH0KCiAgICBpZiAoaXNOYW1lc3BhY2UpIHsKICAgICAgRW1iZXIuZGVwcmVj
        YXRlKCJOYW1lc3BhY2VzIHNob3VsZCBub3QgYmVnaW4gd2l0aCBsb3dlcmNh
        c2UuIiwgL15bQS1aXS8udGVzdChwcm9wKSk7CiAgICAgIG9ialtOQU1FX0tF
        WV0gPSBwcm9wOwogICAgfQogIH0KfQoKdmFyIE5BTUVfS0VZID0gRW1iZXIu
        TkFNRV9LRVkgPSBFbWJlci5HVUlEX0tFWSArICdfbmFtZSc7CgpmdW5jdGlv
        biBzdXBlckNsYXNzU3RyaW5nKG1peGluKSB7CiAgdmFyIHN1cGVyY2xhc3Mg
        PSBtaXhpbi5zdXBlcmNsYXNzOwogIGlmIChzdXBlcmNsYXNzKSB7CiAgICBp
        ZiAoc3VwZXJjbGFzc1tOQU1FX0tFWV0pIHsgcmV0dXJuIHN1cGVyY2xhc3Nb
        TkFNRV9LRVldOyB9CiAgICBlbHNlIHsgcmV0dXJuIHN1cGVyQ2xhc3NTdHJp
        bmcoc3VwZXJjbGFzcyk7IH0KICB9IGVsc2UgewogICAgcmV0dXJuOwogIH0K
        fQoKZnVuY3Rpb24gY2xhc3NUb1N0cmluZygpIHsKICBpZiAoIUVtYmVyLkJP
        T1RFRCAmJiAhdGhpc1tOQU1FX0tFWV0pIHsKICAgIHByb2Nlc3NBbGxOYW1l
        c3BhY2VzKCk7CiAgfQoKICB2YXIgcmV0OwoKICBpZiAodGhpc1tOQU1FX0tF
        WV0pIHsKICAgIHJldCA9IHRoaXNbTkFNRV9LRVldOwogIH0gZWxzZSBpZiAo
        dGhpcy5fdG9TdHJpbmcpIHsKICAgIHJldCA9IHRoaXMuX3RvU3RyaW5nOyAK
        ICB9IGVsc2UgewogICAgdmFyIHN0ciA9IHN1cGVyQ2xhc3NTdHJpbmcodGhp
        cyk7CiAgICBpZiAoc3RyKSB7CiAgICAgIHJldCA9ICIoc3ViY2xhc3Mgb2Yg
        IiArIHN0ciArICIpIjsKICAgIH0gZWxzZSB7CiAgICAgIHJldCA9ICIodW5r
        bm93biBtaXhpbikiOwogICAgfQogICAgdGhpcy50b1N0cmluZyA9IG1ha2VU
        b1N0cmluZyhyZXQpOwogIH0KCiAgcmV0dXJuIHJldDsKfQoKZnVuY3Rpb24g
        cHJvY2Vzc0FsbE5hbWVzcGFjZXMoKSB7CiAgdmFyIHVucHJvY2Vzc2VkTmFt
        ZXNwYWNlcyA9ICFOYW1lc3BhY2UuUFJPQ0VTU0VELAogICAgICB1bnByb2Nl
        c3NlZE1peGlucyA9IEVtYmVyLmFueVVucHJvY2Vzc2VkTWl4aW5zOwoKICBp
        ZiAodW5wcm9jZXNzZWROYW1lc3BhY2VzKSB7CiAgICBmaW5kTmFtZXNwYWNl
        cygpOwogICAgTmFtZXNwYWNlLlBST0NFU1NFRCA9IHRydWU7CiAgfQoKICBp
        ZiAodW5wcm9jZXNzZWROYW1lc3BhY2VzIHx8IHVucHJvY2Vzc2VkTWl4aW5z
        KSB7CiAgICB2YXIgbmFtZXNwYWNlcyA9IE5hbWVzcGFjZS5OQU1FU1BBQ0VT
        LCBuYW1lc3BhY2U7CiAgICBmb3IgKHZhciBpPTAsIGw9bmFtZXNwYWNlcy5s
        ZW5ndGg7IGk8bDsgaSsrKSB7CiAgICAgIG5hbWVzcGFjZSA9IG5hbWVzcGFj
        ZXNbaV07CiAgICAgIHByb2Nlc3NOYW1lc3BhY2UoW25hbWVzcGFjZS50b1N0
        cmluZygpXSwgbmFtZXNwYWNlLCB7fSk7CiAgICB9CgogICAgRW1iZXIuYW55
        VW5wcm9jZXNzZWRNaXhpbnMgPSBmYWxzZTsKICB9Cn0KCmZ1bmN0aW9uIG1h
        a2VUb1N0cmluZyhyZXQpIHsKICByZXR1cm4gZnVuY3Rpb24oKSB7IHJldHVy
        biByZXQ7IH07Cn0KCkVtYmVyLk1peGluLnByb3RvdHlwZS50b1N0cmluZyA9
        IGNsYXNzVG9TdHJpbmc7Cgp9KSgpOwoKCgooZnVuY3Rpb24oKSB7CkVtYmVy
        LkFwcGxpY2F0aW9uID0gRW1iZXIuTmFtZXNwYWNlLmV4dGVuZCgpOwoKfSko
        KTsKCgoKKGZ1bmN0aW9uKCkgewovKioKQG1vZHVsZSBlbWJlcgpAc3VibW9k
        dWxlIGVtYmVyLXJ1bnRpbWUKKi8KCnZhciBPVVRfT0ZfUkFOR0VfRVhDRVBU
        SU9OID0gIkluZGV4IG91dCBvZiByYW5nZSI7CnZhciBFTVBUWSA9IFtdOwoK
        dmFyIGdldCA9IEVtYmVyLmdldCwgc2V0ID0gRW1iZXIuc2V0OwoKLyoqCiAg
        QW4gQXJyYXlQcm94eSB3cmFwcyBhbnkgb3RoZXIgb2JqZWN0IHRoYXQgaW1w
        bGVtZW50cyBgRW1iZXIuQXJyYXlgIGFuZC9vcgogIGBFbWJlci5NdXRhYmxl
        QXJyYXksYCBmb3J3YXJkaW5nIGFsbCByZXF1ZXN0cy4gVGhpcyBtYWtlcyBp
        dCB2ZXJ5IHVzZWZ1bCBmb3IKICBhIG51bWJlciBvZiBiaW5kaW5nIHVzZSBj
        YXNlcyBvciBvdGhlciBjYXNlcyB3aGVyZSBiZWluZyBhYmxlIHRvIHN3YXAK
        ICBvdXQgdGhlIHVuZGVybHlpbmcgYXJyYXkgaXMgdXNlZnVsLgoKICBBIHNp
        bXBsZSBleGFtcGxlIG9mIHVzYWdlOgoKICBgYGBqYXZhc2NyaXB0CiAgdmFy
        IHBldHMgPSBbJ2RvZycsICdjYXQnLCAnZmlzaCddOwogIHZhciBhcCA9IEVt
        YmVyLkFycmF5UHJveHkuY3JlYXRlKHsgY29udGVudDogRW1iZXIuQShwZXRz
        KSB9KTsKCiAgYXAuZ2V0KCdmaXJzdE9iamVjdCcpOyAgICAgICAgICAgICAg
        ICAgICAgICAgIC8vICdkb2cnCiAgYXAuc2V0KCdjb250ZW50JywgWydhbW9l
        YmEnLCAncGFyYW1lY2l1bSddKTsKICBhcC5nZXQoJ2ZpcnN0T2JqZWN0Jyk7
        ICAgICAgICAgICAgICAgICAgICAgICAgLy8gJ2Ftb2ViYScKICBgYGAKCiAg
        VGhpcyBjbGFzcyBjYW4gYWxzbyBiZSB1c2VmdWwgYXMgYSBsYXllciB0byB0
        cmFuc2Zvcm0gdGhlIGNvbnRlbnRzIG9mCiAgYW4gYXJyYXksIGFzIHRoZXkg
        YXJlIGFjY2Vzc2VkLiBUaGlzIGNhbiBiZSBkb25lIGJ5IG92ZXJyaWRpbmcK
        ICBgb2JqZWN0QXRDb250ZW50YDoKCiAgYGBgamF2YXNjcmlwdAogIHZhciBw
        ZXRzID0gWydkb2cnLCAnY2F0JywgJ2Zpc2gnXTsKICB2YXIgYXAgPSBFbWJl
        ci5BcnJheVByb3h5LmNyZWF0ZSh7CiAgICAgIGNvbnRlbnQ6IEVtYmVyLkEo
        cGV0cyksCiAgICAgIG9iamVjdEF0Q29udGVudDogZnVuY3Rpb24oaWR4KSB7
        CiAgICAgICAgICByZXR1cm4gdGhpcy5nZXQoJ2NvbnRlbnQnKS5vYmplY3RB
        dChpZHgpLnRvVXBwZXJDYXNlKCk7CiAgICAgIH0KICB9KTsKCiAgYXAuZ2V0
        KCdmaXJzdE9iamVjdCcpOyAvLyAuICdET0cnCiAgYGBgCgogIEBjbGFzcyBB
        cnJheVByb3h5CiAgQG5hbWVzcGFjZSBFbWJlcgogIEBleHRlbmRzIEVtYmVy
        Lk9iamVjdAogIEB1c2VzIEVtYmVyLk11dGFibGVBcnJheQoqLwpFbWJlci5B
        cnJheVByb3h5ID0gRW1iZXIuT2JqZWN0LmV4dGVuZChFbWJlci5NdXRhYmxl
        QXJyYXksLyoqIEBzY29wZSBFbWJlci5BcnJheVByb3h5LnByb3RvdHlwZSAq
        LyB7CgogIC8qKgogICAgVGhlIGNvbnRlbnQgYXJyYXkuIE11c3QgYmUgYW4g
        b2JqZWN0IHRoYXQgaW1wbGVtZW50cyBgRW1iZXIuQXJyYXlgIGFuZC9vcgog
        ICAgYEVtYmVyLk11dGFibGVBcnJheS5gCgogICAgQHByb3BlcnR5IGNvbnRl
        bnQKICAgIEB0eXBlIEVtYmVyLkFycmF5CiAgKi8KICBjb250ZW50OiBudWxs
        LAoKICAvKioKICAgVGhlIGFycmF5IHRoYXQgdGhlIHByb3h5IHByZXRlbmRz
        IHRvIGJlLiBJbiB0aGUgZGVmYXVsdCBgQXJyYXlQcm94eWAKICAgaW1wbGVt
        ZW50YXRpb24sIHRoaXMgYW5kIGBjb250ZW50YCBhcmUgdGhlIHNhbWUuIFN1
        YmNsYXNzZXMgb2YgYEFycmF5UHJveHlgCiAgIGNhbiBvdmVycmlkZSB0aGlz
        IHByb3BlcnR5IHRvIHByb3ZpZGUgdGhpbmdzIGxpa2Ugc29ydGluZyBhbmQg
        ZmlsdGVyaW5nLgoKICAgQHByb3BlcnR5IGFycmFuZ2VkQ29udGVudAogICov
        CiAgYXJyYW5nZWRDb250ZW50OiBFbWJlci5jb21wdXRlZC5hbGlhcygnY29u
        dGVudCcpLAoKICAvKioKICAgIFNob3VsZCBhY3R1YWxseSByZXRyaWV2ZSB0
        aGUgb2JqZWN0IGF0IHRoZSBzcGVjaWZpZWQgaW5kZXggZnJvbSB0aGUKICAg
        IGNvbnRlbnQuIFlvdSBjYW4gb3ZlcnJpZGUgdGhpcyBtZXRob2QgaW4gc3Vi
        Y2xhc3NlcyB0byB0cmFuc2Zvcm0gdGhlCiAgICBjb250ZW50IGl0ZW0gdG8g
        c29tZXRoaW5nIG5ldy4KCiAgICBUaGlzIG1ldGhvZCB3aWxsIG9ubHkgYmUg
        Y2FsbGVkIGlmIGNvbnRlbnQgaXMgbm9uLWBudWxsYC4KCiAgICBAbWV0aG9k
        IG9iamVjdEF0Q29udGVudAogICAgQHBhcmFtIHtOdW1iZXJ9IGlkeCBUaGUg
        aW5kZXggdG8gcmV0cmlldmUuCiAgICBAcmV0dXJuIHtPYmplY3R9IHRoZSB2
        YWx1ZSBvciB1bmRlZmluZWQgaWYgbm9uZSBmb3VuZAogICovCiAgb2JqZWN0
        QXRDb250ZW50OiBmdW5jdGlvbihpZHgpIHsKICAgIHJldHVybiBnZXQodGhp
        cywgJ2FycmFuZ2VkQ29udGVudCcpLm9iamVjdEF0KGlkeCk7CiAgfSwKCiAg
        LyoqCiAgICBTaG91bGQgYWN0dWFsbHkgcmVwbGFjZSB0aGUgc3BlY2lmaWVk
        IG9iamVjdHMgb24gdGhlIGNvbnRlbnQgYXJyYXkuCiAgICBZb3UgY2FuIG92
        ZXJyaWRlIHRoaXMgbWV0aG9kIGluIHN1YmNsYXNzZXMgdG8gdHJhbnNmb3Jt
        IHRoZSBjb250ZW50IGl0ZW0KICAgIGludG8gc29tZXRoaW5nIG5ldy4KCiAg
        ICBUaGlzIG1ldGhvZCB3aWxsIG9ubHkgYmUgY2FsbGVkIGlmIGNvbnRlbnQg
        aXMgbm9uLWBudWxsYC4KCiAgICBAbWV0aG9kIHJlcGxhY2VDb250ZW50CiAg
        ICBAcGFyYW0ge051bWJlcn0gaWR4IFRoZSBzdGFydGluZyBpbmRleAogICAg
        QHBhcmFtIHtOdW1iZXJ9IGFtdCBUaGUgbnVtYmVyIG9mIGl0ZW1zIHRvIHJl
        bW92ZSBmcm9tIHRoZSBjb250ZW50LgogICAgQHBhcmFtIHtBcnJheX0gb2Jq
        ZWN0cyBPcHRpb25hbCBhcnJheSBvZiBvYmplY3RzIHRvIGluc2VydCBvciBu
        dWxsIGlmIG5vCiAgICAgIG9iamVjdHMuCiAgICBAcmV0dXJuIHt2b2lkfQog
        ICovCiAgcmVwbGFjZUNvbnRlbnQ6IGZ1bmN0aW9uKGlkeCwgYW10LCBvYmpl
        Y3RzKSB7CiAgICBnZXQodGhpcywgJ2NvbnRlbnQnKS5yZXBsYWNlKGlkeCwg
        YW10LCBvYmplY3RzKTsKICB9LAoKICAvKioKICAgIEBwcml2YXRlCgogICAg
        SW52b2tlZCB3aGVuIHRoZSBjb250ZW50IHByb3BlcnR5IGlzIGFib3V0IHRv
        IGNoYW5nZS4gTm90aWZpZXMgb2JzZXJ2ZXJzIHRoYXQgdGhlCiAgICBlbnRp
        cmUgYXJyYXkgY29udGVudCB3aWxsIGNoYW5nZS4KCiAgICBAbWV0aG9kIF9j
        b250ZW50V2lsbENoYW5nZQogICovCiAgX2NvbnRlbnRXaWxsQ2hhbmdlOiBF
        bWJlci5iZWZvcmVPYnNlcnZlcihmdW5jdGlvbigpIHsKICAgIHRoaXMuX3Rl
        YXJkb3duQ29udGVudCgpOwogIH0sICdjb250ZW50JyksCgogIF90ZWFyZG93
        bkNvbnRlbnQ6IGZ1bmN0aW9uKCkgewogICAgdmFyIGNvbnRlbnQgPSBnZXQo
        dGhpcywgJ2NvbnRlbnQnKTsKCiAgICBpZiAoY29udGVudCkgewogICAgICBj
        b250ZW50LnJlbW92ZUFycmF5T2JzZXJ2ZXIodGhpcywgewogICAgICAgIHdp
        bGxDaGFuZ2U6ICdjb250ZW50QXJyYXlXaWxsQ2hhbmdlJywKICAgICAgICBk
        aWRDaGFuZ2U6ICdjb250ZW50QXJyYXlEaWRDaGFuZ2UnCiAgICAgIH0pOwog
        ICAgfQogIH0sCgogIGNvbnRlbnRBcnJheVdpbGxDaGFuZ2U6IEVtYmVyLkss
        CiAgY29udGVudEFycmF5RGlkQ2hhbmdlOiBFbWJlci5LLAoKICAvKioKICAg
        IEBwcml2YXRlCgogICAgSW52b2tlZCB3aGVuIHRoZSBjb250ZW50IHByb3Bl
        cnR5IGNoYW5nZXMuIE5vdGlmaWVzIG9ic2VydmVycyB0aGF0IHRoZQogICAg
        ZW50aXJlIGFycmF5IGNvbnRlbnQgaGFzIGNoYW5nZWQuCgogICAgQG1ldGhv
        ZCBfY29udGVudERpZENoYW5nZQogICovCiAgX2NvbnRlbnREaWRDaGFuZ2U6
        IEVtYmVyLm9ic2VydmVyKGZ1bmN0aW9uKCkgewogICAgdmFyIGNvbnRlbnQg
        PSBnZXQodGhpcywgJ2NvbnRlbnQnKTsKCiAgICBFbWJlci5hc3NlcnQoIkNh
        bid0IHNldCBBcnJheVByb3h5J3MgY29udGVudCB0byBpdHNlbGYiLCBjb250
        ZW50ICE9PSB0aGlzKTsKCiAgICB0aGlzLl9zZXR1cENvbnRlbnQoKTsKICB9
        LCAnY29udGVudCcpLAoKICBfc2V0dXBDb250ZW50OiBmdW5jdGlvbigpIHsK
        ICAgIHZhciBjb250ZW50ID0gZ2V0KHRoaXMsICdjb250ZW50Jyk7CgogICAg
        aWYgKGNvbnRlbnQpIHsKICAgICAgY29udGVudC5hZGRBcnJheU9ic2VydmVy
        KHRoaXMsIHsKICAgICAgICB3aWxsQ2hhbmdlOiAnY29udGVudEFycmF5V2ls
        bENoYW5nZScsCiAgICAgICAgZGlkQ2hhbmdlOiAnY29udGVudEFycmF5RGlk
        Q2hhbmdlJwogICAgICB9KTsKICAgIH0KICB9LAoKICBfYXJyYW5nZWRDb250
        ZW50V2lsbENoYW5nZTogRW1iZXIuYmVmb3JlT2JzZXJ2ZXIoZnVuY3Rpb24o
        KSB7CiAgICB2YXIgYXJyYW5nZWRDb250ZW50ID0gZ2V0KHRoaXMsICdhcnJh
        bmdlZENvbnRlbnQnKSwKICAgICAgICBsZW4gPSBhcnJhbmdlZENvbnRlbnQg
        PyBnZXQoYXJyYW5nZWRDb250ZW50LCAnbGVuZ3RoJykgOiAwOwoKICAgIHRo
        aXMuYXJyYW5nZWRDb250ZW50QXJyYXlXaWxsQ2hhbmdlKHRoaXMsIDAsIGxl
        biwgdW5kZWZpbmVkKTsKICAgIHRoaXMuYXJyYW5nZWRDb250ZW50V2lsbENo
        YW5nZSh0aGlzKTsKCiAgICB0aGlzLl90ZWFyZG93bkFycmFuZ2VkQ29udGVu
        dChhcnJhbmdlZENvbnRlbnQpOwogIH0sICdhcnJhbmdlZENvbnRlbnQnKSwK
        CiAgX2FycmFuZ2VkQ29udGVudERpZENoYW5nZTogRW1iZXIub2JzZXJ2ZXIo
        ZnVuY3Rpb24oKSB7CiAgICB2YXIgYXJyYW5nZWRDb250ZW50ID0gZ2V0KHRo
        aXMsICdhcnJhbmdlZENvbnRlbnQnKSwKICAgICAgICBsZW4gPSBhcnJhbmdl
        ZENvbnRlbnQgPyBnZXQoYXJyYW5nZWRDb250ZW50LCAnbGVuZ3RoJykgOiAw
        OwoKICAgIEVtYmVyLmFzc2VydCgiQ2FuJ3Qgc2V0IEFycmF5UHJveHkncyBj
        b250ZW50IHRvIGl0c2VsZiIsIGFycmFuZ2VkQ29udGVudCAhPT0gdGhpcyk7
        CgogICAgdGhpcy5fc2V0dXBBcnJhbmdlZENvbnRlbnQoKTsKCiAgICB0aGlz
        LmFycmFuZ2VkQ29udGVudERpZENoYW5nZSh0aGlzKTsKICAgIHRoaXMuYXJy
        YW5nZWRDb250ZW50QXJyYXlEaWRDaGFuZ2UodGhpcywgMCwgdW5kZWZpbmVk
        LCBsZW4pOwogIH0sICdhcnJhbmdlZENvbnRlbnQnKSwKCiAgX3NldHVwQXJy
        YW5nZWRDb250ZW50OiBmdW5jdGlvbigpIHsKICAgIHZhciBhcnJhbmdlZENv
        bnRlbnQgPSBnZXQodGhpcywgJ2FycmFuZ2VkQ29udGVudCcpOwoKICAgIGlm
        IChhcnJhbmdlZENvbnRlbnQpIHsKICAgICAgYXJyYW5nZWRDb250ZW50LmFk
        ZEFycmF5T2JzZXJ2ZXIodGhpcywgewogICAgICAgIHdpbGxDaGFuZ2U6ICdh
        cnJhbmdlZENvbnRlbnRBcnJheVdpbGxDaGFuZ2UnLAogICAgICAgIGRpZENo
        YW5nZTogJ2FycmFuZ2VkQ29udGVudEFycmF5RGlkQ2hhbmdlJwogICAgICB9
        KTsKICAgIH0KICB9LAoKICBfdGVhcmRvd25BcnJhbmdlZENvbnRlbnQ6IGZ1
        bmN0aW9uKCkgewogICAgdmFyIGFycmFuZ2VkQ29udGVudCA9IGdldCh0aGlz
        LCAnYXJyYW5nZWRDb250ZW50Jyk7CgogICAgaWYgKGFycmFuZ2VkQ29udGVu
        dCkgewogICAgICBhcnJhbmdlZENvbnRlbnQucmVtb3ZlQXJyYXlPYnNlcnZl
        cih0aGlzLCB7CiAgICAgICAgd2lsbENoYW5nZTogJ2FycmFuZ2VkQ29udGVu
        dEFycmF5V2lsbENoYW5nZScsCiAgICAgICAgZGlkQ2hhbmdlOiAnYXJyYW5n
        ZWRDb250ZW50QXJyYXlEaWRDaGFuZ2UnCiAgICAgIH0pOwogICAgfQogIH0s
        CgogIGFycmFuZ2VkQ29udGVudFdpbGxDaGFuZ2U6IEVtYmVyLkssCiAgYXJy
        YW5nZWRDb250ZW50RGlkQ2hhbmdlOiBFbWJlci5LLAoKICBvYmplY3RBdDog
        ZnVuY3Rpb24oaWR4KSB7CiAgICByZXR1cm4gZ2V0KHRoaXMsICdjb250ZW50
        JykgJiYgdGhpcy5vYmplY3RBdENvbnRlbnQoaWR4KTsKICB9LAoKICBsZW5n
        dGg6IEVtYmVyLmNvbXB1dGVkKGZ1bmN0aW9uKCkgewogICAgdmFyIGFycmFu
        Z2VkQ29udGVudCA9IGdldCh0aGlzLCAnYXJyYW5nZWRDb250ZW50Jyk7CiAg
        ICByZXR1cm4gYXJyYW5nZWRDb250ZW50ID8gZ2V0KGFycmFuZ2VkQ29udGVu
        dCwgJ2xlbmd0aCcpIDogMDsKICAgIC8vIE5vIGRlcGVuZGVuY2llcyBzaW5j
        ZSBFbnVtZXJhYmxlIG5vdGlmaWVzIGxlbmd0aCBvZiBjaGFuZ2UKICB9KSwK
        CiAgX3JlcGxhY2U6IGZ1bmN0aW9uKGlkeCwgYW10LCBvYmplY3RzKSB7CiAg
        ICB2YXIgY29udGVudCA9IGdldCh0aGlzLCAnY29udGVudCcpOwogICAgRW1i
        ZXIuYXNzZXJ0KCdUaGUgY29udGVudCBwcm9wZXJ0eSBvZiAnKyB0aGlzLmNv
        bnN0cnVjdG9yICsgJyBzaG91bGQgYmUgc2V0IGJlZm9yZSBtb2RpZnlpbmcg
        aXQnLCBjb250ZW50KTsKICAgIGlmIChjb250ZW50KSB0aGlzLnJlcGxhY2VD
        b250ZW50KGlkeCwgYW10LCBvYmplY3RzKTsKICAgIHJldHVybiB0aGlzOwog
        IH0sCgogIHJlcGxhY2U6IGZ1bmN0aW9uKCkgewogICAgaWYgKGdldCh0aGlz
        LCAnYXJyYW5nZWRDb250ZW50JykgPT09IGdldCh0aGlzLCAnY29udGVudCcp
        KSB7CiAgICAgIHRoaXMuX3JlcGxhY2UuYXBwbHkodGhpcywgYXJndW1lbnRz
        KTsKICAgIH0gZWxzZSB7CiAgICAgIHRocm93IG5ldyBFbWJlci5FcnJvcigi
        VXNpbmcgcmVwbGFjZSBvbiBhbiBhcnJhbmdlZCBBcnJheVByb3h5IGlzIG5v
        dCBhbGxvd2VkLiIpOwogICAgfQogIH0sCgogIF9pbnNlcnRBdDogZnVuY3Rp
        b24oaWR4LCBvYmplY3QpIHsKICAgIGlmIChpZHggPiBnZXQodGhpcywgJ2Nv
        bnRlbnQubGVuZ3RoJykpIHRocm93IG5ldyBFbWJlci5FcnJvcihPVVRfT0Zf
        UkFOR0VfRVhDRVBUSU9OKTsKICAgIHRoaXMuX3JlcGxhY2UoaWR4LCAwLCBb
        b2JqZWN0XSk7CiAgICByZXR1cm4gdGhpczsKICB9LAoKICBpbnNlcnRBdDog
        ZnVuY3Rpb24oaWR4LCBvYmplY3QpIHsKICAgIGlmIChnZXQodGhpcywgJ2Fy
        cmFuZ2VkQ29udGVudCcpID09PSBnZXQodGhpcywgJ2NvbnRlbnQnKSkgewog
        ICAgICByZXR1cm4gdGhpcy5faW5zZXJ0QXQoaWR4LCBvYmplY3QpOwogICAg
        fSBlbHNlIHsKICAgICAgdGhyb3cgbmV3IEVtYmVyLkVycm9yKCJVc2luZyBp
        bnNlcnRBdCBvbiBhbiBhcnJhbmdlZCBBcnJheVByb3h5IGlzIG5vdCBhbGxv
        d2VkLiIpOwogICAgfQogIH0sCgogIHJlbW92ZUF0OiBmdW5jdGlvbihzdGFy
        dCwgbGVuKSB7CiAgICBpZiAoJ251bWJlcicgPT09IHR5cGVvZiBzdGFydCkg
        ewogICAgICB2YXIgY29udGVudCA9IGdldCh0aGlzLCAnY29udGVudCcpLAog
        ICAgICAgICAgYXJyYW5nZWRDb250ZW50ID0gZ2V0KHRoaXMsICdhcnJhbmdl
        ZENvbnRlbnQnKSwKICAgICAgICAgIGluZGljZXMgPSBbXSwgaTsKCiAgICAg
        IGlmICgoc3RhcnQgPCAwKSB8fCAoc3RhcnQgPj0gZ2V0KHRoaXMsICdsZW5n
        dGgnKSkpIHsKICAgICAgICB0aHJvdyBuZXcgRW1iZXIuRXJyb3IoT1VUX09G
        X1JBTkdFX0VYQ0VQVElPTik7CiAgICAgIH0KCiAgICAgIGlmIChsZW4gPT09
        IHVuZGVmaW5lZCkgbGVuID0gMTsKCiAgICAgIC8vIEdldCBhIGxpc3Qgb2Yg
        aW5kaWNlcyBpbiBvcmlnaW5hbCBjb250ZW50IHRvIHJlbW92ZQogICAgICBm
        b3IgKGk9c3RhcnQ7IGk8c3RhcnQrbGVuOyBpKyspIHsKICAgICAgICAvLyBV
        c2UgYXJyYW5nZWRDb250ZW50IGhlcmUgc28gd2UgYXZvaWQgY29uZnVzaW9u
        IHdpdGggb2JqZWN0cyB0cmFuc2Zvcm1lZCBieSBvYmplY3RBdENvbnRlbnQK
        ICAgICAgICBpbmRpY2VzLnB1c2goY29udGVudC5pbmRleE9mKGFycmFuZ2Vk
        Q29udGVudC5vYmplY3RBdChpKSkpOwogICAgICB9CgogICAgICAvLyBSZXBs
        YWNlIGluIHJldmVyc2Ugb3JkZXIgc2luY2UgaW5kaWNlcyB3aWxsIGNoYW5n
        ZQogICAgICBpbmRpY2VzLnNvcnQoZnVuY3Rpb24oYSxiKSB7IHJldHVybiBi
        IC0gYTsgfSk7CgogICAgICBFbWJlci5iZWdpblByb3BlcnR5Q2hhbmdlcygp
        OwogICAgICBmb3IgKGk9MDsgaTxpbmRpY2VzLmxlbmd0aDsgaSsrKSB7CiAg
        ICAgICAgdGhpcy5fcmVwbGFjZShpbmRpY2VzW2ldLCAxLCBFTVBUWSk7CiAg
        ICAgIH0KICAgICAgRW1iZXIuZW5kUHJvcGVydHlDaGFuZ2VzKCk7CiAgICB9
        CgogICAgcmV0dXJuIHRoaXMgOwogIH0sCgogIHB1c2hPYmplY3Q6IGZ1bmN0
        aW9uKG9iaikgewogICAgdGhpcy5faW5zZXJ0QXQoZ2V0KHRoaXMsICdjb250
        ZW50Lmxlbmd0aCcpLCBvYmopIDsKICAgIHJldHVybiBvYmogOwogIH0sCgog
        IHB1c2hPYmplY3RzOiBmdW5jdGlvbihvYmplY3RzKSB7CiAgICBpZiAoIShF
        bWJlci5FbnVtZXJhYmxlLmRldGVjdChvYmplY3RzKSB8fCBFbWJlci5pc0Fy
        cmF5KG9iamVjdHMpKSkgewogICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCJN
        dXN0IHBhc3MgRW1iZXIuRW51bWVyYWJsZSB0byBFbWJlci5NdXRhYmxlQXJy
        YXkjcHVzaE9iamVjdHMiKTsKICAgIH0KICAgIHRoaXMuX3JlcGxhY2UoZ2V0
        KHRoaXMsICdsZW5ndGgnKSwgMCwgb2JqZWN0cyk7CiAgICByZXR1cm4gdGhp
        czsKICB9LAoKICBzZXRPYmplY3RzOiBmdW5jdGlvbihvYmplY3RzKSB7CiAg
        ICBpZiAob2JqZWN0cy5sZW5ndGggPT09IDApIHJldHVybiB0aGlzLmNsZWFy
        KCk7CgogICAgdmFyIGxlbiA9IGdldCh0aGlzLCAnbGVuZ3RoJyk7CiAgICB0
        aGlzLl9yZXBsYWNlKDAsIGxlbiwgb2JqZWN0cyk7CiAgICByZXR1cm4gdGhp
        czsKICB9LAoKICB1bnNoaWZ0T2JqZWN0OiBmdW5jdGlvbihvYmopIHsKICAg
        IHRoaXMuX2luc2VydEF0KDAsIG9iaikgOwogICAgcmV0dXJuIG9iaiA7CiAg
        fSwKCiAgdW5zaGlmdE9iamVjdHM6IGZ1bmN0aW9uKG9iamVjdHMpIHsKICAg
        IHRoaXMuX3JlcGxhY2UoMCwgMCwgb2JqZWN0cyk7CiAgICByZXR1cm4gdGhp
        czsKICB9LAoKICBzbGljZTogZnVuY3Rpb24oKSB7CiAgICB2YXIgYXJyID0g
        dGhpcy50b0FycmF5KCk7CiAgICByZXR1cm4gYXJyLnNsaWNlLmFwcGx5KGFy
        ciwgYXJndW1lbnRzKTsKICB9LAoKICBhcnJhbmdlZENvbnRlbnRBcnJheVdp
        bGxDaGFuZ2U6IGZ1bmN0aW9uKGl0ZW0sIGlkeCwgcmVtb3ZlZENudCwgYWRk
        ZWRDbnQpIHsKICAgIHRoaXMuYXJyYXlDb250ZW50V2lsbENoYW5nZShpZHgs
        IHJlbW92ZWRDbnQsIGFkZGVkQ250KTsKICB9LAoKICBhcnJhbmdlZENvbnRl
        bnRBcnJheURpZENoYW5nZTogZnVuY3Rpb24oaXRlbSwgaWR4LCByZW1vdmVk
        Q250LCBhZGRlZENudCkgewogICAgdGhpcy5hcnJheUNvbnRlbnREaWRDaGFu
        Z2UoaWR4LCByZW1vdmVkQ250LCBhZGRlZENudCk7CiAgfSwKCiAgaW5pdDog
        ZnVuY3Rpb24oKSB7CiAgICB0aGlzLl9zdXBlcigpOwogICAgdGhpcy5fc2V0
        dXBDb250ZW50KCk7CiAgICB0aGlzLl9zZXR1cEFycmFuZ2VkQ29udGVudCgp
        OwogIH0sCgogIHdpbGxEZXN0cm95OiBmdW5jdGlvbigpIHsKICAgIHRoaXMu
        X3RlYXJkb3duQXJyYW5nZWRDb250ZW50KCk7CiAgICB0aGlzLl90ZWFyZG93
        bkNvbnRlbnQoKTsKICB9Cn0pOwoKfSkoKTsKCgoKKGZ1bmN0aW9uKCkgewov
        KioKQG1vZHVsZSBlbWJlcgpAc3VibW9kdWxlIGVtYmVyLXJ1bnRpbWUKKi8K
        CnZhciBnZXQgPSBFbWJlci5nZXQsCiAgICBzZXQgPSBFbWJlci5zZXQsCiAg
        ICBmbXQgPSBFbWJlci5TdHJpbmcuZm10LAogICAgYWRkQmVmb3JlT2JzZXJ2
        ZXIgPSBFbWJlci5hZGRCZWZvcmVPYnNlcnZlciwKICAgIGFkZE9ic2VydmVy
        ID0gRW1iZXIuYWRkT2JzZXJ2ZXIsCiAgICByZW1vdmVCZWZvcmVPYnNlcnZl
        ciA9IEVtYmVyLnJlbW92ZUJlZm9yZU9ic2VydmVyLAogICAgcmVtb3ZlT2Jz
        ZXJ2ZXIgPSBFbWJlci5yZW1vdmVPYnNlcnZlciwKICAgIHByb3BlcnR5V2ls
        bENoYW5nZSA9IEVtYmVyLnByb3BlcnR5V2lsbENoYW5nZSwKICAgIHByb3Bl
        cnR5RGlkQ2hhbmdlID0gRW1iZXIucHJvcGVydHlEaWRDaGFuZ2UsCiAgICBt
        ZXRhID0gRW1iZXIubWV0YSwKICAgIGRlZmluZVByb3BlcnR5ID0gRW1iZXIu
        ZGVmaW5lUHJvcGVydHk7CgpmdW5jdGlvbiBjb250ZW50UHJvcGVydHlXaWxs
        Q2hhbmdlKGNvbnRlbnQsIGNvbnRlbnRLZXkpIHsKICB2YXIga2V5ID0gY29u
        dGVudEtleS5zbGljZSg4KTsgLy8gcmVtb3ZlICJjb250ZW50LiIKICBpZiAo
        a2V5IGluIHRoaXMpIHsgcmV0dXJuOyB9ICAvLyBpZiBzaGFkb3dlZCBpbiBw
        cm94eQogIHByb3BlcnR5V2lsbENoYW5nZSh0aGlzLCBrZXkpOwp9CgpmdW5j
        dGlvbiBjb250ZW50UHJvcGVydHlEaWRDaGFuZ2UoY29udGVudCwgY29udGVu
        dEtleSkgewogIHZhciBrZXkgPSBjb250ZW50S2V5LnNsaWNlKDgpOyAvLyBy
        ZW1vdmUgImNvbnRlbnQuIgogIGlmIChrZXkgaW4gdGhpcykgeyByZXR1cm47
        IH0gLy8gaWYgc2hhZG93ZWQgaW4gcHJveHkKICBwcm9wZXJ0eURpZENoYW5n
        ZSh0aGlzLCBrZXkpOwp9CgovKioKICBgRW1iZXIuT2JqZWN0UHJveHlgIGZv
        cndhcmRzIGFsbCBwcm9wZXJ0aWVzIG5vdCBkZWZpbmVkIGJ5IHRoZSBwcm94
        eSBpdHNlbGYKICB0byBhIHByb3hpZWQgYGNvbnRlbnRgIG9iamVjdC4KCiAg
        YGBgamF2YXNjcmlwdAogIG9iamVjdCA9IEVtYmVyLk9iamVjdC5jcmVhdGUo
        ewogICAgbmFtZTogJ0ZvbycKICB9KTsKCiAgcHJveHkgPSBFbWJlci5PYmpl
        Y3RQcm94eS5jcmVhdGUoewogICAgY29udGVudDogb2JqZWN0CiAgfSk7Cgog
        IC8vIEFjY2VzcyBhbmQgY2hhbmdlIGV4aXN0aW5nIHByb3BlcnRpZXMKICBw
        cm94eS5nZXQoJ25hbWUnKSAgICAgICAgICAvLyAnRm9vJwogIHByb3h5LnNl
        dCgnbmFtZScsICdCYXInKTsKICBvYmplY3QuZ2V0KCduYW1lJykgICAgICAg
        ICAvLyAnQmFyJwoKICAvLyBDcmVhdGUgbmV3ICdkZXNjcmlwdGlvbicgcHJv
        cGVydHkgb24gYG9iamVjdGAKICBwcm94eS5zZXQoJ2Rlc2NyaXB0aW9uJywg
        J0ZvbyBpcyBhIHdoaXpib28gYmF6Jyk7CiAgb2JqZWN0LmdldCgnZGVzY3Jp
        cHRpb24nKSAgLy8gJ0ZvbyBpcyBhIHdoaXpib28gYmF6JwogIGBgYAoKICBX
        aGlsZSBgY29udGVudGAgaXMgdW5zZXQsIHNldHRpbmcgYSBwcm9wZXJ0eSB0
        byBiZSBkZWxlZ2F0ZWQgd2lsbCB0aHJvdyBhbgogIEVycm9yLgoKICBgYGBq
        YXZhc2NyaXB0CiAgcHJveHkgPSBFbWJlci5PYmplY3RQcm94eS5jcmVhdGUo
        ewogICAgY29udGVudDogbnVsbCwKICAgIGZsYWc6IG51bGwKICB9KTsKICBw
        cm94eS5zZXQoJ2ZsYWcnLCB0cnVlKTsKICBwcm94eS5nZXQoJ2ZsYWcnKTsg
        ICAgICAgICAvLyB0cnVlCiAgcHJveHkuZ2V0KCdmb28nKTsgICAgICAgICAg
        Ly8gdW5kZWZpbmVkCiAgcHJveHkuc2V0KCdmb28nLCAnZGF0YScpOyAgLy8g
        dGhyb3dzIEVycm9yCiAgYGBgCgogIERlbGVnYXRlZCBwcm9wZXJ0aWVzIGNh
        biBiZSBib3VuZCB0byBhbmQgd2lsbCBjaGFuZ2Ugd2hlbiBjb250ZW50IGlz
        IHVwZGF0ZWQuCgogIENvbXB1dGVkIHByb3BlcnRpZXMgb24gdGhlIHByb3h5
        IGl0c2VsZiBjYW4gZGVwZW5kIG9uIGRlbGVnYXRlZCBwcm9wZXJ0aWVzLgoK
        ICBgYGBqYXZhc2NyaXB0CiAgUHJveHlXaXRoQ29tcHV0ZWRQcm9wZXJ0eSA9
        IEVtYmVyLk9iamVjdFByb3h5LmV4dGVuZCh7CiAgICBmdWxsTmFtZTogZnVu
        Y3Rpb24gKCkgewogICAgICB2YXIgZmlyc3ROYW1lID0gdGhpcy5nZXQoJ2Zp
        cnN0TmFtZScpLAogICAgICAgICAgbGFzdE5hbWUgPSB0aGlzLmdldCgnbGFz
        dE5hbWUnKTsKICAgICAgaWYgKGZpcnN0TmFtZSAmJiBsYXN0TmFtZSkgewog
        ICAgICAgIHJldHVybiBmaXJzdE5hbWUgKyAnICcgKyBsYXN0TmFtZTsKICAg
        ICAgfQogICAgICByZXR1cm4gZmlyc3ROYW1lIHx8IGxhc3ROYW1lOwogICAg
        fS5wcm9wZXJ0eSgnZmlyc3ROYW1lJywgJ2xhc3ROYW1lJykKICB9KTsKCiAg
        cHJveHkgPSBQcm94eVdpdGhDb21wdXRlZFByb3BlcnR5LmNyZWF0ZSgpOwoK
        ICBwcm94eS5nZXQoJ2Z1bGxOYW1lJyk7ICAvLyB1bmRlZmluZWQKICBwcm94
        eS5zZXQoJ2NvbnRlbnQnLCB7CiAgICBmaXJzdE5hbWU6ICdUb20nLCBsYXN0
        TmFtZTogJ0RhbGUnCiAgfSk7IC8vIHRyaWdnZXJzIHByb3BlcnR5IGNoYW5n
        ZSBmb3IgZnVsbE5hbWUgb24gcHJveHkKCiAgcHJveHkuZ2V0KCdmdWxsTmFt
        ZScpOyAgLy8gJ1RvbSBEYWxlJwogIGBgYAoKICBAY2xhc3MgT2JqZWN0UHJv
        eHkKICBAbmFtZXNwYWNlIEVtYmVyCiAgQGV4dGVuZHMgRW1iZXIuT2JqZWN0
        CiovCkVtYmVyLk9iamVjdFByb3h5ID0gRW1iZXIuT2JqZWN0LmV4dGVuZCgv
        KiogQHNjb3BlIEVtYmVyLk9iamVjdFByb3h5LnByb3RvdHlwZSAqLyB7CiAg
        LyoqCiAgICBUaGUgb2JqZWN0IHdob3NlIHByb3BlcnRpZXMgd2lsbCBiZSBm
        b3J3YXJkZWQuCgogICAgQHByb3BlcnR5IGNvbnRlbnQKICAgIEB0eXBlIEVt
        YmVyLk9iamVjdAogICAgQGRlZmF1bHQgbnVsbAogICovCiAgY29udGVudDog
        bnVsbCwKICBfY29udGVudERpZENoYW5nZTogRW1iZXIub2JzZXJ2ZXIoZnVu
        Y3Rpb24oKSB7CiAgICBFbWJlci5hc3NlcnQoIkNhbid0IHNldCBPYmplY3RQ
        cm94eSdzIGNvbnRlbnQgdG8gaXRzZWxmIiwgdGhpcy5nZXQoJ2NvbnRlbnQn
        KSAhPT0gdGhpcyk7CiAgfSwgJ2NvbnRlbnQnKSwKCiAgaXNUcnV0aHk6IEVt
        YmVyLmNvbXB1dGVkLmJvb2woJ2NvbnRlbnQnKSwKCiAgX2RlYnVnQ29udGFp
        bmVyS2V5OiBudWxsLAoKICB3aWxsV2F0Y2hQcm9wZXJ0eTogZnVuY3Rpb24g
        KGtleSkgewogICAgdmFyIGNvbnRlbnRLZXkgPSAnY29udGVudC4nICsga2V5
        OwogICAgYWRkQmVmb3JlT2JzZXJ2ZXIodGhpcywgY29udGVudEtleSwgbnVs
        bCwgY29udGVudFByb3BlcnR5V2lsbENoYW5nZSk7CiAgICBhZGRPYnNlcnZl
        cih0aGlzLCBjb250ZW50S2V5LCBudWxsLCBjb250ZW50UHJvcGVydHlEaWRD
        aGFuZ2UpOwogIH0sCgogIGRpZFVud2F0Y2hQcm9wZXJ0eTogZnVuY3Rpb24g
        KGtleSkgewogICAgdmFyIGNvbnRlbnRLZXkgPSAnY29udGVudC4nICsga2V5
        OwogICAgcmVtb3ZlQmVmb3JlT2JzZXJ2ZXIodGhpcywgY29udGVudEtleSwg
        bnVsbCwgY29udGVudFByb3BlcnR5V2lsbENoYW5nZSk7CiAgICByZW1vdmVP
        YnNlcnZlcih0aGlzLCBjb250ZW50S2V5LCBudWxsLCBjb250ZW50UHJvcGVy
        dHlEaWRDaGFuZ2UpOwogIH0sCgogIHVua25vd25Qcm9wZXJ0eTogZnVuY3Rp
        b24gKGtleSkgewogICAgdmFyIGNvbnRlbnQgPSBnZXQodGhpcywgJ2NvbnRl
        bnQnKTsKICAgIGlmIChjb250ZW50KSB7CiAgICAgIHJldHVybiBnZXQoY29u
        dGVudCwga2V5KTsKICAgIH0KICB9LAoKICBzZXRVbmtub3duUHJvcGVydHk6
        IGZ1bmN0aW9uIChrZXksIHZhbHVlKSB7CiAgICB2YXIgbSA9IG1ldGEodGhp
        cyk7CiAgICBpZiAobS5wcm90byA9PT0gdGhpcykgewogICAgICAvLyBpZiBt
        YXJrZWQgYXMgcHJvdG90eXBlIHRoZW4ganVzdCBkZWZpbmVQcm9wZXJ0eQog
        ICAgICAvLyByYXRoZXIgdGhhbiBkZWxlZ2F0ZQogICAgICBkZWZpbmVQcm9w
        ZXJ0eSh0aGlzLCBrZXksIG51bGwsIHZhbHVlKTsKICAgICAgcmV0dXJuIHZh
        bHVlOwogICAgfQoKICAgIHZhciBjb250ZW50ID0gZ2V0KHRoaXMsICdjb250
        ZW50Jyk7CiAgICBFbWJlci5hc3NlcnQoZm10KCJDYW5ub3QgZGVsZWdhdGUg
        c2V0KCclQCcsICVAKSB0byB0aGUgJ2NvbnRlbnQnIHByb3BlcnR5IG9mIG9i
        amVjdCBwcm94eSAlQDogaXRzICdjb250ZW50JyBpcyB1bmRlZmluZWQuIiwg
        W2tleSwgdmFsdWUsIHRoaXNdKSwgY29udGVudCk7CiAgICByZXR1cm4gc2V0
        KGNvbnRlbnQsIGtleSwgdmFsdWUpOwogIH0KCn0pOwoKfSkoKTsKCgoKKGZ1
        bmN0aW9uKCkgewovKioKQG1vZHVsZSBlbWJlcgpAc3VibW9kdWxlIGVtYmVy
        LXJ1bnRpbWUKKi8KCgp2YXIgc2V0ID0gRW1iZXIuc2V0LCBnZXQgPSBFbWJl
        ci5nZXQsIGd1aWRGb3IgPSBFbWJlci5ndWlkRm9yOwp2YXIgZm9yRWFjaCA9
        IEVtYmVyLkVudW1lcmFibGVVdGlscy5mb3JFYWNoLAogICAgaW5kZXhPZiA9
        IEVtYmVyLkFycmF5UG9seWZpbGxzLmluZGV4T2Y7Cgp2YXIgRWFjaEFycmF5
        ID0gRW1iZXIuT2JqZWN0LmV4dGVuZChFbWJlci5BcnJheSwgewoKICBpbml0
        OiBmdW5jdGlvbihjb250ZW50LCBrZXlOYW1lLCBvd25lcikgewogICAgdGhp
        cy5fc3VwZXIoKTsKICAgIHRoaXMuX2tleU5hbWUgPSBrZXlOYW1lOwogICAg
        dGhpcy5fb3duZXIgICA9IG93bmVyOwogICAgdGhpcy5fY29udGVudCA9IGNv
        bnRlbnQ7CiAgfSwKCiAgb2JqZWN0QXQ6IGZ1bmN0aW9uKGlkeCkgewogICAg
        dmFyIGl0ZW0gPSB0aGlzLl9jb250ZW50Lm9iamVjdEF0KGlkeCk7CiAgICBy
        ZXR1cm4gaXRlbSAmJiBnZXQoaXRlbSwgdGhpcy5fa2V5TmFtZSk7CiAgfSwK
        CiAgbGVuZ3RoOiBFbWJlci5jb21wdXRlZChmdW5jdGlvbigpIHsKICAgIHZh
        ciBjb250ZW50ID0gdGhpcy5fY29udGVudDsKICAgIHJldHVybiBjb250ZW50
        ID8gZ2V0KGNvbnRlbnQsICdsZW5ndGgnKSA6IDA7CiAgfSkKCn0pOwoKdmFy
        IElTX09CU0VSVkVSID0gL14uKzooYmVmb3JlfGNoYW5nZSkkLzsKCmZ1bmN0
        aW9uIGFkZE9ic2VydmVyRm9yQ29udGVudEtleShjb250ZW50LCBrZXlOYW1l
        LCBwcm94eSwgaWR4LCBsb2MpIHsKICB2YXIgb2JqZWN0cyA9IHByb3h5Ll9v
        YmplY3RzLCBndWlkOwogIGlmICghb2JqZWN0cykgb2JqZWN0cyA9IHByb3h5
        Ll9vYmplY3RzID0ge307CgogIHdoaWxlKC0tbG9jPj1pZHgpIHsKICAgIHZh
        ciBpdGVtID0gY29udGVudC5vYmplY3RBdChsb2MpOwogICAgaWYgKGl0ZW0p
        IHsKICAgICAgRW1iZXIuYXNzZXJ0KCdXaGVuIHVzaW5nIEBlYWNoIHRvIG9i
        c2VydmUgdGhlIGFycmF5ICcgKyBjb250ZW50ICsgJywgdGhlIGFycmF5IG11
        c3QgcmV0dXJuIGFuIG9iamVjdCcsIEVtYmVyLnR5cGVPZihpdGVtKSA9PT0g
        J2luc3RhbmNlJyB8fCBFbWJlci50eXBlT2YoaXRlbSkgPT09ICdvYmplY3Qn
        KTsKICAgICAgRW1iZXIuYWRkQmVmb3JlT2JzZXJ2ZXIoaXRlbSwga2V5TmFt
        ZSwgcHJveHksICdjb250ZW50S2V5V2lsbENoYW5nZScpOwogICAgICBFbWJl
        ci5hZGRPYnNlcnZlcihpdGVtLCBrZXlOYW1lLCBwcm94eSwgJ2NvbnRlbnRL
        ZXlEaWRDaGFuZ2UnKTsKCiAgICAgIC8vIGtlZXAgdHJhY2sgb2YgdGhlIGlu
        ZGV4IGVhY2ggaXRlbSB3YXMgZm91bmQgYXQgc28gd2UgY2FuIG1hcAogICAg
        ICAvLyBpdCBiYWNrIHdoZW4gdGhlIG9iaiBjaGFuZ2VzLgogICAgICBndWlk
        ID0gZ3VpZEZvcihpdGVtKTsKICAgICAgaWYgKCFvYmplY3RzW2d1aWRdKSBv
        YmplY3RzW2d1aWRdID0gW107CiAgICAgIG9iamVjdHNbZ3VpZF0ucHVzaChs
        b2MpOwogICAgfQogIH0KfQoKZnVuY3Rpb24gcmVtb3ZlT2JzZXJ2ZXJGb3JD
        b250ZW50S2V5KGNvbnRlbnQsIGtleU5hbWUsIHByb3h5LCBpZHgsIGxvYykg
        ewogIHZhciBvYmplY3RzID0gcHJveHkuX29iamVjdHM7CiAgaWYgKCFvYmpl
        Y3RzKSBvYmplY3RzID0gcHJveHkuX29iamVjdHMgPSB7fTsKICB2YXIgaW5k
        aWNpZXMsIGd1aWQ7CgogIHdoaWxlKC0tbG9jPj1pZHgpIHsKICAgIHZhciBp
        dGVtID0gY29udGVudC5vYmplY3RBdChsb2MpOwogICAgaWYgKGl0ZW0pIHsK
        ICAgICAgRW1iZXIucmVtb3ZlQmVmb3JlT2JzZXJ2ZXIoaXRlbSwga2V5TmFt
        ZSwgcHJveHksICdjb250ZW50S2V5V2lsbENoYW5nZScpOwogICAgICBFbWJl
        ci5yZW1vdmVPYnNlcnZlcihpdGVtLCBrZXlOYW1lLCBwcm94eSwgJ2NvbnRl
        bnRLZXlEaWRDaGFuZ2UnKTsKCiAgICAgIGd1aWQgPSBndWlkRm9yKGl0ZW0p
        OwogICAgICBpbmRpY2llcyA9IG9iamVjdHNbZ3VpZF07CiAgICAgIGluZGlj
        aWVzW2luZGV4T2YuY2FsbChpbmRpY2llcywgbG9jKV0gPSBudWxsOwogICAg
        fQogIH0KfQoKLyoqCiAgVGhpcyBpcyB0aGUgb2JqZWN0IGluc3RhbmNlIHJl
        dHVybmVkIHdoZW4geW91IGdldCB0aGUgYEBlYWNoYCBwcm9wZXJ0eSBvbiBh
        bgogIGFycmF5LiBJdCB1c2VzIHRoZSB1bmtub3duUHJvcGVydHkgaGFuZGxl
        ciB0byBhdXRvbWF0aWNhbGx5IGNyZWF0ZQogIEVhY2hBcnJheSBpbnN0YW5j
        ZXMgZm9yIHByb3BlcnR5IG5hbWVzLgoKICBAcHJpdmF0ZQogIEBjbGFzcyBF
        YWNoUHJveHkKICBAbmFtZXNwYWNlIEVtYmVyCiAgQGV4dGVuZHMgRW1iZXIu
        T2JqZWN0CiovCkVtYmVyLkVhY2hQcm94eSA9IEVtYmVyLk9iamVjdC5leHRl
        bmQoewoKICBpbml0OiBmdW5jdGlvbihjb250ZW50KSB7CiAgICB0aGlzLl9z
        dXBlcigpOwogICAgdGhpcy5fY29udGVudCA9IGNvbnRlbnQ7CiAgICBjb250
        ZW50LmFkZEFycmF5T2JzZXJ2ZXIodGhpcyk7CgogICAgLy8gaW4gY2FzZSBz
        b21lb25lIGlzIGFscmVhZHkgb2JzZXJ2aW5nIHNvbWUga2V5cyBtYWtlIHN1
        cmUgdGhleSBhcmUKICAgIC8vIGFkZGVkCiAgICBmb3JFYWNoKEVtYmVyLndh
        dGNoZWRFdmVudHModGhpcyksIGZ1bmN0aW9uKGV2ZW50TmFtZSkgewogICAg
        ICB0aGlzLmRpZEFkZExpc3RlbmVyKGV2ZW50TmFtZSk7CiAgICB9LCB0aGlz
        KTsKICB9LAoKICAvKioKICAgIFlvdSBjYW4gZGlyZWN0bHkgYWNjZXNzIG1h
        cHBlZCBwcm9wZXJ0aWVzIGJ5IHNpbXBseSByZXF1ZXN0aW5nIHRoZW0uCiAg
        ICBUaGUgYHVua25vd25Qcm9wZXJ0eWAgaGFuZGxlciB3aWxsIGdlbmVyYXRl
        IGFuIEVhY2hBcnJheSBvZiBlYWNoIGl0ZW0uCgogICAgQG1ldGhvZCB1bmtu
        b3duUHJvcGVydHkKICAgIEBwYXJhbSBrZXlOYW1lIHtTdHJpbmd9CiAgICBA
        cGFyYW0gdmFsdWUgeyp9CiAgKi8KICB1bmtub3duUHJvcGVydHk6IGZ1bmN0
        aW9uKGtleU5hbWUsIHZhbHVlKSB7CiAgICB2YXIgcmV0OwogICAgcmV0ID0g
        bmV3IEVhY2hBcnJheSh0aGlzLl9jb250ZW50LCBrZXlOYW1lLCB0aGlzKTsK
        ICAgIEVtYmVyLmRlZmluZVByb3BlcnR5KHRoaXMsIGtleU5hbWUsIG51bGws
        IHJldCk7CiAgICB0aGlzLmJlZ2luT2JzZXJ2aW5nQ29udGVudEtleShrZXlO
        YW1lKTsKICAgIHJldHVybiByZXQ7CiAgfSwKCiAgLy8gLi4uLi4uLi4uLi4u
        Li4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4u
        LgogIC8vIEFSUkFZIENIQU5HRVMKICAvLyBJbnZva2VzIHdoZW5ldmVyIHRo
        ZSBjb250ZW50IGFycmF5IGl0c2VsZiBjaGFuZ2VzLgoKICBhcnJheVdpbGxD
        aGFuZ2U6IGZ1bmN0aW9uKGNvbnRlbnQsIGlkeCwgcmVtb3ZlZENudCwgYWRk
        ZWRDbnQpIHsKICAgIHZhciBrZXlzID0gdGhpcy5fa2V5cywga2V5LCBsaW07
        CgogICAgbGltID0gcmVtb3ZlZENudD4wID8gaWR4K3JlbW92ZWRDbnQgOiAt
        MTsKICAgIEVtYmVyLmJlZ2luUHJvcGVydHlDaGFuZ2VzKHRoaXMpOwoKICAg
        IGZvcihrZXkgaW4ga2V5cykgewogICAgICBpZiAoIWtleXMuaGFzT3duUHJv
        cGVydHkoa2V5KSkgeyBjb250aW51ZTsgfQoKICAgICAgaWYgKGxpbT4wKSB7
        IHJlbW92ZU9ic2VydmVyRm9yQ29udGVudEtleShjb250ZW50LCBrZXksIHRo
        aXMsIGlkeCwgbGltKTsgfQoKICAgICAgRW1iZXIucHJvcGVydHlXaWxsQ2hh
        bmdlKHRoaXMsIGtleSk7CiAgICB9CgogICAgRW1iZXIucHJvcGVydHlXaWxs
        Q2hhbmdlKHRoaXMuX2NvbnRlbnQsICdAZWFjaCcpOwogICAgRW1iZXIuZW5k
        UHJvcGVydHlDaGFuZ2VzKHRoaXMpOwogIH0sCgogIGFycmF5RGlkQ2hhbmdl
        OiBmdW5jdGlvbihjb250ZW50LCBpZHgsIHJlbW92ZWRDbnQsIGFkZGVkQ250
        KSB7CiAgICB2YXIga2V5cyA9IHRoaXMuX2tleXMsIGxpbTsKCiAgICBsaW0g
        PSBhZGRlZENudD4wID8gaWR4K2FkZGVkQ250IDogLTE7CiAgICBFbWJlci5j
        aGFuZ2VQcm9wZXJ0aWVzKGZ1bmN0aW9uKCkgewogICAgICBmb3IodmFyIGtl
        eSBpbiBrZXlzKSB7CiAgICAgICAgaWYgKCFrZXlzLmhhc093blByb3BlcnR5
        KGtleSkpIHsgY29udGludWU7IH0KCiAgICAgICAgaWYgKGxpbT4wKSB7IGFk
        ZE9ic2VydmVyRm9yQ29udGVudEtleShjb250ZW50LCBrZXksIHRoaXMsIGlk
        eCwgbGltKTsgfQoKICAgICAgICBFbWJlci5wcm9wZXJ0eURpZENoYW5nZSh0
        aGlzLCBrZXkpOwogICAgICB9CgogICAgICBFbWJlci5wcm9wZXJ0eURpZENo
        YW5nZSh0aGlzLl9jb250ZW50LCAnQGVhY2gnKTsKICAgIH0sIHRoaXMpOwog
        IH0sCgogIC8vIC4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4u
        Li4uLi4uLi4uLi4uLi4uLi4uLi4uLi4KICAvLyBMSVNURU4gRk9SIE5FVyBP
        QlNFUlZFUlMgQU5EIE9USEVSIEVWRU5UIExJU1RFTkVSUwogIC8vIFN0YXJ0
        IG1vbml0b3Jpbmcga2V5cyBiYXNlZCBvbiB3aG8gaXMgbGlzdGVuaW5nLi4u
        CgogIGRpZEFkZExpc3RlbmVyOiBmdW5jdGlvbihldmVudE5hbWUpIHsKICAg
        IGlmIChJU19PQlNFUlZFUi50ZXN0KGV2ZW50TmFtZSkpIHsKICAgICAgdGhp
        cy5iZWdpbk9ic2VydmluZ0NvbnRlbnRLZXkoZXZlbnROYW1lLnNsaWNlKDAs
        IC03KSk7CiAgICB9CiAgfSwKCiAgZGlkUmVtb3ZlTGlzdGVuZXI6IGZ1bmN0
        aW9uKGV2ZW50TmFtZSkgewogICAgaWYgKElTX09CU0VSVkVSLnRlc3QoZXZl
        bnROYW1lKSkgewogICAgICB0aGlzLnN0b3BPYnNlcnZpbmdDb250ZW50S2V5
        KGV2ZW50TmFtZS5zbGljZSgwLCAtNykpOwogICAgfQogIH0sCgogIC8vIC4u
        Li4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4u
        Li4uLi4uLi4uLi4KICAvLyBDT05URU5UIEtFWSBPQlNFUlZJTkcKICAvLyBB
        Y3R1YWwgd2F0Y2gga2V5cyBvbiB0aGUgc291cmNlIGNvbnRlbnQuCgogIGJl
        Z2luT2JzZXJ2aW5nQ29udGVudEtleTogZnVuY3Rpb24oa2V5TmFtZSkgewog
        ICAgdmFyIGtleXMgPSB0aGlzLl9rZXlzOwogICAgaWYgKCFrZXlzKSBrZXlz
        ID0gdGhpcy5fa2V5cyA9IHt9OwogICAgaWYgKCFrZXlzW2tleU5hbWVdKSB7
        CiAgICAgIGtleXNba2V5TmFtZV0gPSAxOwogICAgICB2YXIgY29udGVudCA9
        IHRoaXMuX2NvbnRlbnQsCiAgICAgICAgICBsZW4gPSBnZXQoY29udGVudCwg
        J2xlbmd0aCcpOwogICAgICBhZGRPYnNlcnZlckZvckNvbnRlbnRLZXkoY29u
        dGVudCwga2V5TmFtZSwgdGhpcywgMCwgbGVuKTsKICAgIH0gZWxzZSB7CiAg
        ICAgIGtleXNba2V5TmFtZV0rKzsKICAgIH0KICB9LAoKICBzdG9wT2JzZXJ2
        aW5nQ29udGVudEtleTogZnVuY3Rpb24oa2V5TmFtZSkgewogICAgdmFyIGtl
        eXMgPSB0aGlzLl9rZXlzOwogICAgaWYgKGtleXMgJiYgKGtleXNba2V5TmFt
        ZV0+MCkgJiYgKC0ta2V5c1trZXlOYW1lXTw9MCkpIHsKICAgICAgdmFyIGNv
        bnRlbnQgPSB0aGlzLl9jb250ZW50LAogICAgICAgICAgbGVuICAgICA9IGdl
        dChjb250ZW50LCAnbGVuZ3RoJyk7CiAgICAgIHJlbW92ZU9ic2VydmVyRm9y
        Q29udGVudEtleShjb250ZW50LCBrZXlOYW1lLCB0aGlzLCAwLCBsZW4pOwog
        ICAgfQogIH0sCgogIGNvbnRlbnRLZXlXaWxsQ2hhbmdlOiBmdW5jdGlvbihv
        YmosIGtleU5hbWUpIHsKICAgIEVtYmVyLnByb3BlcnR5V2lsbENoYW5nZSh0
        aGlzLCBrZXlOYW1lKTsKICB9LAoKICBjb250ZW50S2V5RGlkQ2hhbmdlOiBm
        dW5jdGlvbihvYmosIGtleU5hbWUpIHsKICAgIEVtYmVyLnByb3BlcnR5RGlk
        Q2hhbmdlKHRoaXMsIGtleU5hbWUpOwogIH0KCn0pOwoKCgp9KSgpOwoKCgoo
        ZnVuY3Rpb24oKSB7Ci8qKgpAbW9kdWxlIGVtYmVyCkBzdWJtb2R1bGUgZW1i
        ZXItcnVudGltZQoqLwoKCnZhciBnZXQgPSBFbWJlci5nZXQsIHNldCA9IEVt
        YmVyLnNldCwgcmVwbGFjZSA9IEVtYmVyLkVudW1lcmFibGVVdGlscy5fcmVw
        bGFjZTsKCi8vIEFkZCBFbWJlci5BcnJheSB0byBBcnJheS5wcm90b3R5cGUu
        IFJlbW92ZSBtZXRob2RzIHdpdGggbmF0aXZlCi8vIGltcGxlbWVudGF0aW9u
        cyBhbmQgc3VwcGx5IHNvbWUgbW9yZSBvcHRpbWl6ZWQgdmVyc2lvbnMgb2Yg
        Z2VuZXJpYyBtZXRob2RzCi8vIGJlY2F1c2UgdGhleSBhcmUgc28gY29tbW9u
        Lgp2YXIgTmF0aXZlQXJyYXkgPSBFbWJlci5NaXhpbi5jcmVhdGUoRW1iZXIu
        TXV0YWJsZUFycmF5LCBFbWJlci5PYnNlcnZhYmxlLCBFbWJlci5Db3B5YWJs
        ZSwgewoKICAvLyBiZWNhdXNlIGxlbmd0aCBpcyBhIGJ1aWx0LWluIHByb3Bl
        cnR5IHdlIG5lZWQgdG8ga25vdyB0byBqdXN0IGdldCB0aGUKICAvLyBvcmln
        aW5hbCBwcm9wZXJ0eS4KICBnZXQ6IGZ1bmN0aW9uKGtleSkgewogICAgaWYg
        KGtleT09PSdsZW5ndGgnKSByZXR1cm4gdGhpcy5sZW5ndGg7CiAgICBlbHNl
        IGlmICgnbnVtYmVyJyA9PT0gdHlwZW9mIGtleSkgcmV0dXJuIHRoaXNba2V5
        XTsKICAgIGVsc2UgcmV0dXJuIHRoaXMuX3N1cGVyKGtleSk7CiAgfSwKCiAg
        b2JqZWN0QXQ6IGZ1bmN0aW9uKGlkeCkgewogICAgcmV0dXJuIHRoaXNbaWR4
        XTsKICB9LAoKICAvLyBwcmltaXRpdmUgZm9yIGFycmF5IHN1cHBvcnQuCiAg
        cmVwbGFjZTogZnVuY3Rpb24oaWR4LCBhbXQsIG9iamVjdHMpIHsKCiAgICBp
        ZiAodGhpcy5pc0Zyb3plbikgdGhyb3cgRW1iZXIuRlJPWkVOX0VSUk9SOwoK
        ICAgIC8vIGlmIHdlIHJlcGxhY2VkIGV4YWN0bHkgdGhlIHNhbWUgbnVtYmVy
        IG9mIGl0ZW1zLCB0aGVuIHBhc3Mgb25seSB0aGUKICAgIC8vIHJlcGxhY2Vk
        IHJhbmdlLiBPdGhlcndpc2UsIHBhc3MgdGhlIGZ1bGwgcmVtYWluaW5nIGFy
        cmF5IGxlbmd0aAogICAgLy8gc2luY2UgZXZlcnl0aGluZyBoYXMgc2hpZnRl
        ZAogICAgdmFyIGxlbiA9IG9iamVjdHMgPyBnZXQob2JqZWN0cywgJ2xlbmd0
        aCcpIDogMDsKICAgIHRoaXMuYXJyYXlDb250ZW50V2lsbENoYW5nZShpZHgs
        IGFtdCwgbGVuKTsKCiAgICBpZiAoIW9iamVjdHMgfHwgb2JqZWN0cy5sZW5n
        dGggPT09IDApIHsKICAgICAgdGhpcy5zcGxpY2UoaWR4LCBhbXQpOwogICAg
        fSBlbHNlIHsKICAgICAgcmVwbGFjZSh0aGlzLCBpZHgsIGFtdCwgb2JqZWN0
        cyk7CiAgICB9CgogICAgdGhpcy5hcnJheUNvbnRlbnREaWRDaGFuZ2UoaWR4
        LCBhbXQsIGxlbik7CiAgICByZXR1cm4gdGhpczsKICB9LAoKICAvLyBJZiB5
        b3UgYXNrIGZvciBhbiB1bmtub3duIHByb3BlcnR5LCB0aGVuIHRyeSB0byBj
        b2xsZWN0IHRoZSB2YWx1ZQogIC8vIGZyb20gbWVtYmVyIGl0ZW1zLgogIHVu
        a25vd25Qcm9wZXJ0eTogZnVuY3Rpb24oa2V5LCB2YWx1ZSkgewogICAgdmFy
        IHJldDsvLyA9IHRoaXMucmVkdWNlZFByb3BlcnR5KGtleSwgdmFsdWUpIDsK
        ICAgIGlmICgodmFsdWUgIT09IHVuZGVmaW5lZCkgJiYgcmV0ID09PSB1bmRl
        ZmluZWQpIHsKICAgICAgcmV0ID0gdGhpc1trZXldID0gdmFsdWU7CiAgICB9
        CiAgICByZXR1cm4gcmV0IDsKICB9LAoKICAvLyBJZiBicm93c2VyIGRpZCBu
        b3QgaW1wbGVtZW50IGluZGV4T2YgbmF0aXZlbHksIHRoZW4gb3ZlcnJpZGUg
        d2l0aAogIC8vIHNwZWNpYWxpemVkIHZlcnNpb24KICBpbmRleE9mOiBmdW5j
        dGlvbihvYmplY3QsIHN0YXJ0QXQpIHsKICAgIHZhciBpZHgsIGxlbiA9IHRo
        aXMubGVuZ3RoOwoKICAgIGlmIChzdGFydEF0ID09PSB1bmRlZmluZWQpIHN0
        YXJ0QXQgPSAwOwogICAgZWxzZSBzdGFydEF0ID0gKHN0YXJ0QXQgPCAwKSA/
        IE1hdGguY2VpbChzdGFydEF0KSA6IE1hdGguZmxvb3Ioc3RhcnRBdCk7CiAg
        ICBpZiAoc3RhcnRBdCA8IDApIHN0YXJ0QXQgKz0gbGVuOwoKICAgIGZvcihp
        ZHg9c3RhcnRBdDtpZHg8bGVuO2lkeCsrKSB7CiAgICAgIGlmICh0aGlzW2lk
        eF0gPT09IG9iamVjdCkgcmV0dXJuIGlkeCA7CiAgICB9CiAgICByZXR1cm4g
        LTE7CiAgfSwKCiAgbGFzdEluZGV4T2Y6IGZ1bmN0aW9uKG9iamVjdCwgc3Rh
        cnRBdCkgewogICAgdmFyIGlkeCwgbGVuID0gdGhpcy5sZW5ndGg7CgogICAg
        aWYgKHN0YXJ0QXQgPT09IHVuZGVmaW5lZCkgc3RhcnRBdCA9IGxlbi0xOwog
        ICAgZWxzZSBzdGFydEF0ID0gKHN0YXJ0QXQgPCAwKSA/IE1hdGguY2VpbChz
        dGFydEF0KSA6IE1hdGguZmxvb3Ioc3RhcnRBdCk7CiAgICBpZiAoc3RhcnRB
        dCA8IDApIHN0YXJ0QXQgKz0gbGVuOwoKICAgIGZvcihpZHg9c3RhcnRBdDtp
        ZHg+PTA7aWR4LS0pIHsKICAgICAgaWYgKHRoaXNbaWR4XSA9PT0gb2JqZWN0
        KSByZXR1cm4gaWR4IDsKICAgIH0KICAgIHJldHVybiAtMTsKICB9LAoKICBj
        b3B5OiBmdW5jdGlvbihkZWVwKSB7CiAgICBpZiAoZGVlcCkgewogICAgICBy
        ZXR1cm4gdGhpcy5tYXAoZnVuY3Rpb24oaXRlbSkgeyByZXR1cm4gRW1iZXIu
        Y29weShpdGVtLCB0cnVlKTsgfSk7CiAgICB9CgogICAgcmV0dXJuIHRoaXMu
        c2xpY2UoKTsKICB9Cn0pOwoKLy8gUmVtb3ZlIGFueSBtZXRob2RzIGltcGxl
        bWVudGVkIG5hdGl2ZWx5IHNvIHdlIGRvbid0IG92ZXJyaWRlIHRoZW0KdmFy
        IGlnbm9yZSA9IFsnbGVuZ3RoJ107CkVtYmVyLkVudW1lcmFibGVVdGlscy5m
        b3JFYWNoKE5hdGl2ZUFycmF5LmtleXMoKSwgZnVuY3Rpb24obWV0aG9kTmFt
        ZSkgewogIGlmIChBcnJheS5wcm90b3R5cGVbbWV0aG9kTmFtZV0pIGlnbm9y
        ZS5wdXNoKG1ldGhvZE5hbWUpOwp9KTsKCmlmIChpZ25vcmUubGVuZ3RoPjAp
        IHsKICBOYXRpdmVBcnJheSA9IE5hdGl2ZUFycmF5LndpdGhvdXQuYXBwbHko
        TmF0aXZlQXJyYXksIGlnbm9yZSk7Cn0KCi8qKgogIFRoZSBOYXRpdmVBcnJh
        eSBtaXhpbiBjb250YWlucyB0aGUgcHJvcGVydGllcyBuZWVkZWQgdG8gdG8g
        bWFrZSB0aGUgbmF0aXZlCiAgQXJyYXkgc3VwcG9ydCBFbWJlci5NdXRhYmxl
        QXJyYXkgYW5kIGFsbCBvZiBpdHMgZGVwZW5kZW50IEFQSXMuIFVubGVzcyB5
        b3UKICBoYXZlIGBFbWJlci5FWFRFTkRfUFJPVE9UWVBFU2Agb3IgYEVtYmVy
        LkVYVEVORF9QUk9UT1RZUEVTLkFycmF5YCBzZXQgdG8KICBmYWxzZSwgdGhp
        cyB3aWxsIGJlIGFwcGxpZWQgYXV0b21hdGljYWxseS4gT3RoZXJ3aXNlIHlv
        dSBjYW4gYXBwbHkgdGhlIG1peGluCiAgYXQgYW55dGltZSBieSBjYWxsaW5n
        IGBFbWJlci5OYXRpdmVBcnJheS5hY3RpdmF0ZWAuCgogIEBjbGFzcyBOYXRp
        dmVBcnJheQogIEBuYW1lc3BhY2UgRW1iZXIKICBAdXNlcyBFbWJlci5NdXRh
        YmxlQXJyYXkKICBAdXNlcyBFbWJlci5PYnNlcnZhYmxlCiAgQHVzZXMgRW1i
        ZXIuQ29weWFibGUKKi8KRW1iZXIuTmF0aXZlQXJyYXkgPSBOYXRpdmVBcnJh
        eTsKCi8qKgogIENyZWF0ZXMgYW4gYEVtYmVyLk5hdGl2ZUFycmF5YCBmcm9t
        IGFuIEFycmF5IGxpa2Ugb2JqZWN0LgogIERvZXMgbm90IG1vZGlmeSB0aGUg
        b3JpZ2luYWwgb2JqZWN0LiBFbWJlci5BIGlzIG5vdCBuZWVkZWQgaWYKICBg
        RW1iZXIuRVhURU5EX1BST1RPVFlQRVNgIGlzIGB0cnVlYCAodGhlIGRlZmF1
        bHQgdmFsdWUpLiBIb3dldmVyLAogIGl0IGlzIHJlY29tbWVuZGVkIHRoYXQg
        eW91IHVzZSBFbWJlci5BIHdoZW4gY3JlYXRpbmcgYWRkb25zIGZvcgogIGVt
        YmVyIG9yIHdoZW4geW91IGNhbiBub3QgZ2FyZW50ZWUgdGhhdCBgRW1iZXIu
        RVhURU5EX1BST1RPVFlQRVNgCiAgd2lsbCBiZSBgdHJ1ZWAuCgogIEV4YW1w
        bGUKCiAgYGBganMKICB2YXIgUGFnaW5hdGlvbiA9IEVtYmVyLkNvbGxlY3Rp
        b25WaWV3LmV4dGVuZCh7CiAgICB0YWdOYW1lOiAndWwnLAogICAgY2xhc3NO
        YW1lczogWydwYWdpbmF0aW9uJ10sCiAgICBpbml0OiBmdW5jdGlvbigpIHsK
        ICAgICAgdGhpcy5fc3VwZXIoKTsKICAgICAgaWYgKCF0aGlzLmdldCgnY29u
        dGVudCcpKSB7CiAgICAgICAgdGhpcy5zZXQoJ2NvbnRlbnQnLCBFbWJlci5B
        KFtdKSk7CiAgICAgIH0KICAgIH0KICB9KTsKICBgYGAKCiAgQG1ldGhvZCBB
        CiAgQGZvciBFbWJlcgogIEByZXR1cm4ge0VtYmVyLk5hdGl2ZUFycmF5fQoq
        LwpFbWJlci5BID0gZnVuY3Rpb24oYXJyKSB7CiAgaWYgKGFyciA9PT0gdW5k
        ZWZpbmVkKSB7IGFyciA9IFtdOyB9CiAgcmV0dXJuIEVtYmVyLkFycmF5LmRl
        dGVjdChhcnIpID8gYXJyIDogRW1iZXIuTmF0aXZlQXJyYXkuYXBwbHkoYXJy
        KTsKfTsKCi8qKgogIEFjdGl2YXRlcyB0aGUgbWl4aW4gb24gdGhlIEFycmF5
        LnByb3RvdHlwZSBpZiBub3QgYWxyZWFkeSBhcHBsaWVkLiBDYWxsaW5nCiAg
        dGhpcyBtZXRob2QgbW9yZSB0aGFuIG9uY2UgaXMgc2FmZS4gVGhpcyB3aWxs
        IGJlIGNhbGxlZCB3aGVuIGVtYmVyIGlzIGxvYWRlZAogIHVubGVzcyB5b3Ug
        aGF2ZSBgRW1iZXIuRVhURU5EX1BST1RPVFlQRVNgIG9yIGBFbWJlci5FWFRF
        TkRfUFJPVE9UWVBFUy5BcnJheWAKICBzZXQgdG8gYGZhbHNlYC4KCiAgRXhh
        bXBsZQoKICBgYGBqcwogIGlmIChFbWJlci5FWFRFTkRfUFJPVE9UWVBFUyA9
        PT0gdHJ1ZSB8fCBFbWJlci5FWFRFTkRfUFJPVE9UWVBFUy5BcnJheSkgewog
        ICAgRW1iZXIuTmF0aXZlQXJyYXkuYWN0aXZhdGUoKTsKICB9CiAgYGBgCgog
        IEBtZXRob2QgYWN0aXZhdGUKICBAZm9yIEVtYmVyLk5hdGl2ZUFycmF5CiAg
        QHN0YXRpYwogIEByZXR1cm4ge3ZvaWR9CiovCkVtYmVyLk5hdGl2ZUFycmF5
        LmFjdGl2YXRlID0gZnVuY3Rpb24oKSB7CiAgTmF0aXZlQXJyYXkuYXBwbHko
        QXJyYXkucHJvdG90eXBlKTsKCiAgRW1iZXIuQSA9IGZ1bmN0aW9uKGFycikg
        eyByZXR1cm4gYXJyIHx8IFtdOyB9Owp9OwoKaWYgKEVtYmVyLkVYVEVORF9Q
        Uk9UT1RZUEVTID09PSB0cnVlIHx8IEVtYmVyLkVYVEVORF9QUk9UT1RZUEVT
        LkFycmF5KSB7CiAgRW1iZXIuTmF0aXZlQXJyYXkuYWN0aXZhdGUoKTsKfQoK
        Cn0pKCk7CgoKCihmdW5jdGlvbigpIHsKLyoqCkBtb2R1bGUgZW1iZXIKQHN1
        Ym1vZHVsZSBlbWJlci1ydW50aW1lCiovCgp2YXIgZ2V0ID0gRW1iZXIuZ2V0
        LCBzZXQgPSBFbWJlci5zZXQsIGd1aWRGb3IgPSBFbWJlci5ndWlkRm9yLCBp
        c05vbmUgPSBFbWJlci5pc05vbmUsIGZtdCA9IEVtYmVyLlN0cmluZy5mbXQ7
        CgovKioKICBBbiB1bm9yZGVyZWQgY29sbGVjdGlvbiBvZiBvYmplY3RzLgoK
        ICBBIFNldCB3b3JrcyBhIGJpdCBsaWtlIGFuIGFycmF5IGV4Y2VwdCB0aGF0
        IGl0cyBpdGVtcyBhcmUgbm90IG9yZGVyZWQuIFlvdQogIGNhbiBjcmVhdGUg
        YSBzZXQgdG8gZWZmaWNpZW50bHkgdGVzdCBmb3IgbWVtYmVyc2hpcCBmb3Ig
        YW4gb2JqZWN0LiBZb3UgY2FuCiAgYWxzbyBpdGVyYXRlIHRocm91Z2ggYSBz
        ZXQganVzdCBsaWtlIGFuIGFycmF5LCBldmVuIGFjY2Vzc2luZyBvYmplY3Rz
        IGJ5CiAgaW5kZXgsIGhvd2V2ZXIgdGhlcmUgaXMgbm8gZ3VhcmFudGVlIGFz
        IHRvIHRoZWlyIG9yZGVyLgoKICBBbGwgU2V0cyBhcmUgb2JzZXJ2YWJsZSB2
        aWEgdGhlIEVudW1lcmFibGUgT2JzZXJ2ZXIgQVBJIC0gd2hpY2ggd29ya3MK
        ICBvbiBhbnkgZW51bWVyYWJsZSBvYmplY3QgaW5jbHVkaW5nIGJvdGggU2V0
        cyBhbmQgQXJyYXlzLgoKICAjIyBDcmVhdGluZyBhIFNldAoKICBZb3UgY2Fu
        IGNyZWF0ZSBhIHNldCBsaWtlIHlvdSB3b3VsZCBtb3N0IG9iamVjdHMgdXNp
        bmcKICBgbmV3IEVtYmVyLlNldCgpYC4gTW9zdCBuZXcgc2V0cyB5b3UgY3Jl
        YXRlIHdpbGwgYmUgZW1wdHksIGJ1dCB5b3UgY2FuCiAgYWxzbyBpbml0aWFs
        aXplIHRoZSBzZXQgd2l0aCBzb21lIGNvbnRlbnQgYnkgcGFzc2luZyBhbiBh
        cnJheSBvciBvdGhlcgogIGVudW1lcmFibGUgb2Ygb2JqZWN0cyB0byB0aGUg
        Y29uc3RydWN0b3IuCgogIEZpbmFsbHksIHlvdSBjYW4gcGFzcyBpbiBhbiBl
        eGlzdGluZyBzZXQgYW5kIHRoZSBzZXQgd2lsbCBiZSBjb3BpZWQuIFlvdQog
        IGNhbiBhbHNvIGNyZWF0ZSBhIGNvcHkgb2YgYSBzZXQgYnkgY2FsbGluZyBg
        RW1iZXIuU2V0I2NvcHkoKWAuCgogIGBgYGphdmFzY3JpcHQKICAvLyBjcmVh
        dGVzIGEgbmV3IGVtcHR5IHNldAogIHZhciBmb3VuZE5hbWVzID0gbmV3IEVt
        YmVyLlNldCgpOwoKICAvLyBjcmVhdGVzIGEgc2V0IHdpdGggZm91ciBuYW1l
        cyBpbiBpdC4KICB2YXIgbmFtZXMgPSBuZXcgRW1iZXIuU2V0KFsiQ2hhcmxl
        cyIsICJUb20iLCAiSnVhbiIsICJBbGV4Il0pOyAvLyA6UAoKICAvLyBjcmVh
        dGVzIGEgY29weSBvZiB0aGUgbmFtZXMgc2V0LgogIHZhciBuYW1lc0NvcHkg
        PSBuZXcgRW1iZXIuU2V0KG5hbWVzKTsKCiAgLy8gc2FtZSBhcyBhYm92ZS4K
        ICB2YXIgYW5vdGhlck5hbWVzQ29weSA9IG5hbWVzLmNvcHkoKTsKICBgYGAK
        CiAgIyMgQWRkaW5nL1JlbW92aW5nIE9iamVjdHMKCiAgWW91IGdlbmVyYWxs
        eSBhZGQgb3IgcmVtb3ZlIG9iamVjdHMgZnJvbSBhIHNldCB1c2luZyBgYWRk
        KClgIG9yCiAgYHJlbW92ZSgpYC4gWW91IGNhbiBhZGQgYW55IHR5cGUgb2Yg
        b2JqZWN0IGluY2x1ZGluZyBwcmltaXRpdmVzIHN1Y2ggYXMKICBudW1iZXJz
        LCBzdHJpbmdzLCBhbmQgYm9vbGVhbnMuCgogIFVubGlrZSBhcnJheXMsIG9i
        amVjdHMgY2FuIG9ubHkgZXhpc3Qgb25lIHRpbWUgaW4gYSBzZXQuIElmIHlv
        dSBjYWxsIGBhZGQoKWAKICBvbiBhIHNldCB3aXRoIHRoZSBzYW1lIG9iamVj
        dCBtdWx0aXBsZSB0aW1lcywgdGhlIG9iamVjdCB3aWxsIG9ubHkgYmUgYWRk
        ZWQKICBvbmNlLiBMaWtld2lzZSwgY2FsbGluZyBgcmVtb3ZlKClgIHdpdGgg
        dGhlIHNhbWUgb2JqZWN0IG11bHRpcGxlIHRpbWVzIHdpbGwKICByZW1vdmUg
        dGhlIG9iamVjdCB0aGUgZmlyc3QgdGltZSBhbmQgaGF2ZSBubyBlZmZlY3Qg
        b24gZnV0dXJlIGNhbGxzIHVudGlsCiAgeW91IGFkZCB0aGUgb2JqZWN0IHRv
        IHRoZSBzZXQgYWdhaW4uCgogIE5PVEU6IFlvdSBjYW5ub3QgYWRkL3JlbW92
        ZSBgbnVsbGAgb3IgYHVuZGVmaW5lZGAgdG8gYSBzZXQuIEFueSBhdHRlbXB0
        IHRvIGRvCiAgc28gd2lsbCBiZSBpZ25vcmVkLgoKICBJbiBhZGRpdGlvbiB0
        byBhZGQvcmVtb3ZlIHlvdSBjYW4gYWxzbyBjYWxsIGBwdXNoKClgL2Bwb3Ao
        KWAuIFB1c2ggYmVoYXZlcwogIGp1c3QgbGlrZSBgYWRkKClgIGJ1dCBgcG9w
        KClgLCB1bmxpa2UgYHJlbW92ZSgpYCB3aWxsIHBpY2sgYW4gYXJiaXRyYXJ5
        CiAgb2JqZWN0LCByZW1vdmUgaXQgYW5kIHJldHVybiBpdC4gVGhpcyBpcyBh
        IGdvb2Qgd2F5IHRvIHVzZSBhIHNldCBhcyBhIGpvYgogIHF1ZXVlIHdoZW4g
        eW91IGRvbid0IGNhcmUgd2hpY2ggb3JkZXIgdGhlIGpvYnMgYXJlIGV4ZWN1
        dGVkIGluLgoKICAjIyBUZXN0aW5nIGZvciBhbiBPYmplY3QKCiAgVG8gdGVz
        dCBmb3IgYW4gb2JqZWN0J3MgcHJlc2VuY2UgaW4gYSBzZXQgeW91IHNpbXBs
        eSBjYWxsCiAgYEVtYmVyLlNldCNjb250YWlucygpYC4KCiAgIyMgT2JzZXJ2
        aW5nIGNoYW5nZXMKCiAgV2hlbiB1c2luZyBgRW1iZXIuU2V0YCwgeW91IGNh
        biBvYnNlcnZlIHRoZSBgIltdImAgcHJvcGVydHkgdG8gYmUKICBhbGVydGVk
        IHdoZW5ldmVyIHRoZSBjb250ZW50IGNoYW5nZXMuIFlvdSBjYW4gYWxzbyBh
        ZGQgYW4gZW51bWVyYWJsZQogIG9ic2VydmVyIHRvIHRoZSBzZXQgdG8gYmUg
        bm90aWZpZWQgb2Ygc3BlY2lmaWMgb2JqZWN0cyB0aGF0IGFyZSBhZGRlZCBh
        bmQKICByZW1vdmVkIGZyb20gdGhlIHNldC4gU2VlIFtFbWJlci5FbnVtZXJh
        YmxlXSgvYXBpL2NsYXNzZXMvRW1iZXIuRW51bWVyYWJsZS5odG1sKQogIGZv
        ciBtb3JlIGluZm9ybWF0aW9uIG9uIGVudW1lcmFibGVzLgoKICBUaGlzIGlz
        IG9mdGVuIHVuaGVscGZ1bC4gSWYgeW91IGFyZSBmaWx0ZXJpbmcgc2V0cyBv
        ZiBvYmplY3RzLCBmb3IgaW5zdGFuY2UsCiAgaXQgaXMgdmVyeSBpbmVmZmlj
        aWVudCB0byByZS1maWx0ZXIgYWxsIG9mIHRoZSBpdGVtcyBlYWNoIHRpbWUg
        dGhlIHNldAogIGNoYW5nZXMuIEl0IHdvdWxkIGJlIGJldHRlciBpZiB5b3Ug
        Y291bGQganVzdCBhZGp1c3QgdGhlIGZpbHRlcmVkIHNldCBiYXNlZAogIG9u
        IHdoYXQgd2FzIGNoYW5nZWQgb24gdGhlIG9yaWdpbmFsIHNldC4gVGhlIHNh
        bWUgaXNzdWUgYXBwbGllcyB0byBtZXJnaW5nCiAgc2V0cywgYXMgd2VsbC4K
        CiAgIyMgT3RoZXIgTWV0aG9kcwoKICBgRW1iZXIuU2V0YCBwcmltYXJ5IGlt
        cGxlbWVudHMgb3RoZXIgbWl4aW4gQVBJcy4gRm9yIGEgY29tcGxldGUgcmVm
        ZXJlbmNlCiAgb24gdGhlIG1ldGhvZHMgeW91IHdpbGwgdXNlIHdpdGggYEVt
        YmVyLlNldGAsIHBsZWFzZSBjb25zdWx0IHRoZXNlIG1peGlucy4KICBUaGUg
        bW9zdCB1c2VmdWwgb25lcyB3aWxsIGJlIGBFbWJlci5FbnVtZXJhYmxlYCBh
        bmQKICBgRW1iZXIuTXV0YWJsZUVudW1lcmFibGVgIHdoaWNoIGltcGxlbWVu
        dCBtb3N0IG9mIHRoZSBjb21tb24gaXRlcmF0b3IKICBtZXRob2RzIHlvdSBh
        cmUgdXNlZCB0byBvbiBBcnJheS4KCiAgTm90ZSB0aGF0IHlvdSBjYW4gYWxz
        byB1c2UgdGhlIGBFbWJlci5Db3B5YWJsZWAgYW5kIGBFbWJlci5GcmVlemFi
        bGVgCiAgQVBJcyBvbiBgRW1iZXIuU2V0YCBhcyB3ZWxsLiBPbmNlIGEgc2V0
        IGlzIGZyb3plbiBpdCBjYW4gbm8gbG9uZ2VyIGJlCiAgbW9kaWZpZWQuIFRo
        ZSBiZW5lZml0IG9mIHRoaXMgaXMgdGhhdCB3aGVuIHlvdSBjYWxsIGBmcm96
        ZW5Db3B5KClgIG9uIGl0LAogIEVtYmVyIHdpbGwgYXZvaWQgbWFraW5nIGNv
        cGllcyBvZiB0aGUgc2V0LiBUaGlzIGFsbG93cyB5b3UgdG8gd3JpdGUKICBj
        b2RlIHRoYXQgY2FuIGtub3cgd2l0aCBjZXJ0YWludHkgd2hlbiB0aGUgdW5k
        ZXJseWluZyBzZXQgZGF0YSB3aWxsIG9yCiAgd2lsbCBub3QgYmUgbW9kaWZp
        ZWQuCgogIEBjbGFzcyBTZXQKICBAbmFtZXNwYWNlIEVtYmVyCiAgQGV4dGVu
        ZHMgRW1iZXIuQ29yZU9iamVjdAogIEB1c2VzIEVtYmVyLk11dGFibGVFbnVt
        ZXJhYmxlCiAgQHVzZXMgRW1iZXIuQ29weWFibGUKICBAdXNlcyBFbWJlci5G
        cmVlemFibGUKICBAc2luY2UgRW1iZXIgMC45CiovCkVtYmVyLlNldCA9IEVt
        YmVyLkNvcmVPYmplY3QuZXh0ZW5kKEVtYmVyLk11dGFibGVFbnVtZXJhYmxl
        LCBFbWJlci5Db3B5YWJsZSwgRW1iZXIuRnJlZXphYmxlLAogIC8qKiBAc2Nv
        cGUgRW1iZXIuU2V0LnByb3RvdHlwZSAqLyB7CgogIC8vIC4uLi4uLi4uLi4u
        Li4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4u
        Li4KICAvLyBJTVBMRU1FTlQgRU5VTUVSQUJMRSBBUElTCiAgLy8KCiAgLyoq
        CiAgICBUaGlzIHByb3BlcnR5IHdpbGwgY2hhbmdlIGFzIHRoZSBudW1iZXIg
        b2Ygb2JqZWN0cyBpbiB0aGUgc2V0IGNoYW5nZXMuCgogICAgQHByb3BlcnR5
        IGxlbmd0aAogICAgQHR5cGUgbnVtYmVyCiAgICBAZGVmYXVsdCAwCiAgKi8K
        ICBsZW5ndGg6IDAsCgogIC8qKgogICAgQ2xlYXJzIHRoZSBzZXQuIFRoaXMg
        aXMgdXNlZnVsIGlmIHlvdSB3YW50IHRvIHJldXNlIGFuIGV4aXN0aW5nIHNl
        dAogICAgd2l0aG91dCBoYXZpbmcgdG8gcmVjcmVhdGUgaXQuCgogICAgYGBg
        amF2YXNjcmlwdAogICAgdmFyIGNvbG9ycyA9IG5ldyBFbWJlci5TZXQoWyJy
        ZWQiLCAiZ3JlZW4iLCAiYmx1ZSJdKTsKICAgIGNvbG9ycy5sZW5ndGg7ICAv
        LyAzCiAgICBjb2xvcnMuY2xlYXIoKTsKICAgIGNvbG9ycy5sZW5ndGg7ICAv
        LyAwCiAgICBgYGAKCiAgICBAbWV0aG9kIGNsZWFyCiAgICBAcmV0dXJuIHtF
        bWJlci5TZXR9IEFuIGVtcHR5IFNldAogICovCiAgY2xlYXI6IGZ1bmN0aW9u
        KCkgewogICAgaWYgKHRoaXMuaXNGcm96ZW4pIHsgdGhyb3cgbmV3IEVtYmVy
        LkVycm9yKEVtYmVyLkZST1pFTl9FUlJPUik7IH0KCiAgICB2YXIgbGVuID0g
        Z2V0KHRoaXMsICdsZW5ndGgnKTsKICAgIGlmIChsZW4gPT09IDApIHsgcmV0
        dXJuIHRoaXM7IH0KCiAgICB2YXIgZ3VpZDsKCiAgICB0aGlzLmVudW1lcmFi
        bGVDb250ZW50V2lsbENoYW5nZShsZW4sIDApOwogICAgRW1iZXIucHJvcGVy
        dHlXaWxsQ2hhbmdlKHRoaXMsICdmaXJzdE9iamVjdCcpOwogICAgRW1iZXIu
        cHJvcGVydHlXaWxsQ2hhbmdlKHRoaXMsICdsYXN0T2JqZWN0Jyk7CgogICAg
        Zm9yICh2YXIgaT0wOyBpIDwgbGVuOyBpKyspIHsKICAgICAgZ3VpZCA9IGd1
        aWRGb3IodGhpc1tpXSk7CiAgICAgIGRlbGV0ZSB0aGlzW2d1aWRdOwogICAg
        ICBkZWxldGUgdGhpc1tpXTsKICAgIH0KCiAgICBzZXQodGhpcywgJ2xlbmd0
        aCcsIDApOwoKICAgIEVtYmVyLnByb3BlcnR5RGlkQ2hhbmdlKHRoaXMsICdm
        aXJzdE9iamVjdCcpOwogICAgRW1iZXIucHJvcGVydHlEaWRDaGFuZ2UodGhp
        cywgJ2xhc3RPYmplY3QnKTsKICAgIHRoaXMuZW51bWVyYWJsZUNvbnRlbnRE
        aWRDaGFuZ2UobGVuLCAwKTsKCiAgICByZXR1cm4gdGhpczsKICB9LAoKICAv
        KioKICAgIFJldHVybnMgdHJ1ZSBpZiB0aGUgcGFzc2VkIG9iamVjdCBpcyBh
        bHNvIGFuIGVudW1lcmFibGUgdGhhdCBjb250YWlucyB0aGUKICAgIHNhbWUg
        b2JqZWN0cyBhcyB0aGUgcmVjZWl2ZXIuCgogICAgYGBgamF2YXNjcmlwdAog
        ICAgdmFyIGNvbG9ycyA9IFsicmVkIiwgImdyZWVuIiwgImJsdWUiXSwKICAg
        ICAgICBzYW1lX2NvbG9ycyA9IG5ldyBFbWJlci5TZXQoY29sb3JzKTsKCiAg
        ICBzYW1lX2NvbG9ycy5pc0VxdWFsKGNvbG9ycyk7ICAgICAgICAgICAgICAg
        Ly8gdHJ1ZQogICAgc2FtZV9jb2xvcnMuaXNFcXVhbChbInB1cnBsZSIsICJi
        cm93biJdKTsgIC8vIGZhbHNlCiAgICBgYGAKCiAgICBAbWV0aG9kIGlzRXF1
        YWwKICAgIEBwYXJhbSB7RW1iZXIuU2V0fSBvYmogdGhlIG90aGVyIG9iamVj
        dC4KICAgIEByZXR1cm4ge0Jvb2xlYW59CiAgKi8KICBpc0VxdWFsOiBmdW5j
        dGlvbihvYmopIHsKICAgIC8vIGZhaWwgZmFzdAogICAgaWYgKCFFbWJlci5F
        bnVtZXJhYmxlLmRldGVjdChvYmopKSByZXR1cm4gZmFsc2U7CgogICAgdmFy
        IGxvYyA9IGdldCh0aGlzLCAnbGVuZ3RoJyk7CiAgICBpZiAoZ2V0KG9iaiwg
        J2xlbmd0aCcpICE9PSBsb2MpIHJldHVybiBmYWxzZTsKCiAgICB3aGlsZSgt
        LWxvYyA+PSAwKSB7CiAgICAgIGlmICghb2JqLmNvbnRhaW5zKHRoaXNbbG9j
        XSkpIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICByZXR1cm4gdHJ1ZTsKICB9
        LAoKICAvKioKICAgIEFkZHMgYW4gb2JqZWN0IHRvIHRoZSBzZXQuIE9ubHkg
        bm9uLWBudWxsYCBvYmplY3RzIGNhbiBiZSBhZGRlZCB0byBhIHNldAogICAg
        YW5kIHRob3NlIGNhbiBvbmx5IGJlIGFkZGVkIG9uY2UuIElmIHRoZSBvYmpl
        Y3QgaXMgYWxyZWFkeSBpbiB0aGUgc2V0IG9yCiAgICB0aGUgcGFzc2VkIHZh
        bHVlIGlzIG51bGwgdGhpcyBtZXRob2Qgd2lsbCBoYXZlIG5vIGVmZmVjdC4K
        CiAgICBUaGlzIGlzIGFuIGFsaWFzIGZvciBgRW1iZXIuTXV0YWJsZUVudW1l
        cmFibGUuYWRkT2JqZWN0KClgLgoKICAgIGBgYGphdmFzY3JpcHQKICAgIHZh
        ciBjb2xvcnMgPSBuZXcgRW1iZXIuU2V0KCk7CiAgICBjb2xvcnMuYWRkKCJi
        bHVlIik7ICAgICAvLyBbImJsdWUiXQogICAgY29sb3JzLmFkZCgiYmx1ZSIp
        OyAgICAgLy8gWyJibHVlIl0KICAgIGNvbG9ycy5hZGQoInJlZCIpOyAgICAg
        IC8vIFsiYmx1ZSIsICJyZWQiXQogICAgY29sb3JzLmFkZChudWxsKTsgICAg
        ICAgLy8gWyJibHVlIiwgInJlZCJdCiAgICBjb2xvcnMuYWRkKHVuZGVmaW5l
        ZCk7ICAvLyBbImJsdWUiLCAicmVkIl0KICAgIGBgYAoKICAgIEBtZXRob2Qg
        YWRkCiAgICBAcGFyYW0ge09iamVjdH0gb2JqIFRoZSBvYmplY3QgdG8gYWRk
        LgogICAgQHJldHVybiB7RW1iZXIuU2V0fSBUaGUgc2V0IGl0c2VsZi4KICAq
        LwogIGFkZDogRW1iZXIuYWxpYXNNZXRob2QoJ2FkZE9iamVjdCcpLAoKICAv
        KioKICAgIFJlbW92ZXMgdGhlIG9iamVjdCBmcm9tIHRoZSBzZXQgaWYgaXQg
        aXMgZm91bmQuIElmIHlvdSBwYXNzIGEgYG51bGxgIHZhbHVlCiAgICBvciBh
        biBvYmplY3QgdGhhdCBpcyBhbHJlYWR5IG5vdCBpbiB0aGUgc2V0LCB0aGlz
        IG1ldGhvZCB3aWxsIGhhdmUgbm8KICAgIGVmZmVjdC4gVGhpcyBpcyBhbiBh
        bGlhcyBmb3IgYEVtYmVyLk11dGFibGVFbnVtZXJhYmxlLnJlbW92ZU9iamVj
        dCgpYC4KCiAgICBgYGBqYXZhc2NyaXB0CiAgICB2YXIgY29sb3JzID0gbmV3
        IEVtYmVyLlNldChbInJlZCIsICJncmVlbiIsICJibHVlIl0pOwogICAgY29s
        b3JzLnJlbW92ZSgicmVkIik7ICAgICAvLyBbImJsdWUiLCAiZ3JlZW4iXQog
        ICAgY29sb3JzLnJlbW92ZSgicHVycGxlIik7ICAvLyBbImJsdWUiLCAiZ3Jl
        ZW4iXQogICAgY29sb3JzLnJlbW92ZShudWxsKTsgICAgICAvLyBbImJsdWUi
        LCAiZ3JlZW4iXQogICAgYGBgCgogICAgQG1ldGhvZCByZW1vdmUKICAgIEBw
        YXJhbSB7T2JqZWN0fSBvYmogVGhlIG9iamVjdCB0byByZW1vdmUKICAgIEBy
        ZXR1cm4ge0VtYmVyLlNldH0gVGhlIHNldCBpdHNlbGYuCiAgKi8KICByZW1v
        dmU6IEVtYmVyLmFsaWFzTWV0aG9kKCdyZW1vdmVPYmplY3QnKSwKCiAgLyoq
        CiAgICBSZW1vdmVzIHRoZSBsYXN0IGVsZW1lbnQgZnJvbSB0aGUgc2V0IGFu
        ZCByZXR1cm5zIGl0LCBvciBgbnVsbGAgaWYgaXQncyBlbXB0eS4KCiAgICBg
        YGBqYXZhc2NyaXB0CiAgICB2YXIgY29sb3JzID0gbmV3IEVtYmVyLlNldChb
        ImdyZWVuIiwgImJsdWUiXSk7CiAgICBjb2xvcnMucG9wKCk7ICAvLyAiYmx1
        ZSIKICAgIGNvbG9ycy5wb3AoKTsgIC8vICJncmVlbiIKICAgIGNvbG9ycy5w
        b3AoKTsgIC8vIG51bGwKICAgIGBgYAoKICAgIEBtZXRob2QgcG9wCiAgICBA
        cmV0dXJuIHtPYmplY3R9IFRoZSByZW1vdmVkIG9iamVjdCBmcm9tIHRoZSBz
        ZXQgb3IgbnVsbC4KICAqLwogIHBvcDogZnVuY3Rpb24oKSB7CiAgICBpZiAo
        Z2V0KHRoaXMsICdpc0Zyb3plbicpKSB0aHJvdyBuZXcgRW1iZXIuRXJyb3Io
        RW1iZXIuRlJPWkVOX0VSUk9SKTsKICAgIHZhciBvYmogPSB0aGlzLmxlbmd0
        aCA+IDAgPyB0aGlzW3RoaXMubGVuZ3RoLTFdIDogbnVsbDsKICAgIHRoaXMu
        cmVtb3ZlKG9iaik7CiAgICByZXR1cm4gb2JqOwogIH0sCgogIC8qKgogICAg
        SW5zZXJ0cyB0aGUgZ2l2ZW4gb2JqZWN0IG9uIHRvIHRoZSBlbmQgb2YgdGhl
        IHNldC4gSXQgcmV0dXJucwogICAgdGhlIHNldCBpdHNlbGYuCgogICAgVGhp
        cyBpcyBhbiBhbGlhcyBmb3IgYEVtYmVyLk11dGFibGVFbnVtZXJhYmxlLmFk
        ZE9iamVjdCgpYC4KCiAgICBgYGBqYXZhc2NyaXB0CiAgICB2YXIgY29sb3Jz
        ID0gbmV3IEVtYmVyLlNldCgpOwogICAgY29sb3JzLnB1c2goInJlZCIpOyAg
        IC8vIFsicmVkIl0KICAgIGNvbG9ycy5wdXNoKCJncmVlbiIpOyAvLyBbInJl
        ZCIsICJncmVlbiJdCiAgICBjb2xvcnMucHVzaCgiYmx1ZSIpOyAgLy8gWyJy
        ZWQiLCAiZ3JlZW4iLCAiYmx1ZSJdCiAgICBgYGAKCiAgICBAbWV0aG9kIHB1
        c2gKICAgIEByZXR1cm4ge0VtYmVyLlNldH0gVGhlIHNldCBpdHNlbGYuCiAg
        Ki8KICBwdXNoOiBFbWJlci5hbGlhc01ldGhvZCgnYWRkT2JqZWN0JyksCgog
        IC8qKgogICAgUmVtb3ZlcyB0aGUgbGFzdCBlbGVtZW50IGZyb20gdGhlIHNl
        dCBhbmQgcmV0dXJucyBpdCwgb3IgYG51bGxgIGlmIGl0J3MgZW1wdHkuCgog
        ICAgVGhpcyBpcyBhbiBhbGlhcyBmb3IgYEVtYmVyLlNldC5wb3AoKWAuCgog
        ICAgYGBgamF2YXNjcmlwdAogICAgdmFyIGNvbG9ycyA9IG5ldyBFbWJlci5T
        ZXQoWyJncmVlbiIsICJibHVlIl0pOwogICAgY29sb3JzLnNoaWZ0KCk7ICAv
        LyAiYmx1ZSIKICAgIGNvbG9ycy5zaGlmdCgpOyAgLy8gImdyZWVuIgogICAg
        Y29sb3JzLnNoaWZ0KCk7ICAvLyBudWxsCiAgICBgYGAKCiAgICBAbWV0aG9k
        IHNoaWZ0CiAgICBAcmV0dXJuIHtPYmplY3R9IFRoZSByZW1vdmVkIG9iamVj
        dCBmcm9tIHRoZSBzZXQgb3IgbnVsbC4KICAqLwogIHNoaWZ0OiBFbWJlci5h
        bGlhc01ldGhvZCgncG9wJyksCgogIC8qKgogICAgSW5zZXJ0cyB0aGUgZ2l2
        ZW4gb2JqZWN0IG9uIHRvIHRoZSBlbmQgb2YgdGhlIHNldC4gSXQgcmV0dXJu
        cwogICAgdGhlIHNldCBpdHNlbGYuCgogICAgVGhpcyBpcyBhbiBhbGlhcyBv
        ZiBgRW1iZXIuU2V0LnB1c2goKWAKCiAgICBgYGBqYXZhc2NyaXB0CiAgICB2
        YXIgY29sb3JzID0gbmV3IEVtYmVyLlNldCgpOwogICAgY29sb3JzLnVuc2hp
        ZnQoInJlZCIpOyAgICAvLyBbInJlZCJdCiAgICBjb2xvcnMudW5zaGlmdCgi
        Z3JlZW4iKTsgIC8vIFsicmVkIiwgImdyZWVuIl0KICAgIGNvbG9ycy51bnNo
        aWZ0KCJibHVlIik7ICAgLy8gWyJyZWQiLCAiZ3JlZW4iLCAiYmx1ZSJdCiAg
        ICBgYGAKCiAgICBAbWV0aG9kIHVuc2hpZnQKICAgIEByZXR1cm4ge0VtYmVy
        LlNldH0gVGhlIHNldCBpdHNlbGYuCiAgKi8KICB1bnNoaWZ0OiBFbWJlci5h
        bGlhc01ldGhvZCgncHVzaCcpLAoKICAvKioKICAgIEFkZHMgZWFjaCBvYmpl
        Y3QgaW4gdGhlIHBhc3NlZCBlbnVtZXJhYmxlIHRvIHRoZSBzZXQuCgogICAg
        VGhpcyBpcyBhbiBhbGlhcyBvZiBgRW1iZXIuTXV0YWJsZUVudW1lcmFibGUu
        YWRkT2JqZWN0cygpYAoKICAgIGBgYGphdmFzY3JpcHQKICAgIHZhciBjb2xv
        cnMgPSBuZXcgRW1iZXIuU2V0KCk7CiAgICBjb2xvcnMuYWRkRWFjaChbInJl
        ZCIsICJncmVlbiIsICJibHVlIl0pOyAgLy8gWyJyZWQiLCAiZ3JlZW4iLCAi
        Ymx1ZSJdCiAgICBgYGAKCiAgICBAbWV0aG9kIGFkZEVhY2gKICAgIEBwYXJh
        bSB7RW1iZXIuRW51bWVyYWJsZX0gb2JqZWN0cyB0aGUgb2JqZWN0cyB0byBh
        ZGQuCiAgICBAcmV0dXJuIHtFbWJlci5TZXR9IFRoZSBzZXQgaXRzZWxmLgog
        ICovCiAgYWRkRWFjaDogRW1iZXIuYWxpYXNNZXRob2QoJ2FkZE9iamVjdHMn
        KSwKCiAgLyoqCiAgICBSZW1vdmVzIGVhY2ggb2JqZWN0IGluIHRoZSBwYXNz
        ZWQgZW51bWVyYWJsZSB0byB0aGUgc2V0LgoKICAgIFRoaXMgaXMgYW4gYWxp
        YXMgb2YgYEVtYmVyLk11dGFibGVFbnVtZXJhYmxlLnJlbW92ZU9iamVjdHMo
        KWAKCiAgICBgYGBqYXZhc2NyaXB0CiAgICB2YXIgY29sb3JzID0gbmV3IEVt
        YmVyLlNldChbInJlZCIsICJncmVlbiIsICJibHVlIl0pOwogICAgY29sb3Jz
        LnJlbW92ZUVhY2goWyJyZWQiLCAiYmx1ZSJdKTsgIC8vICBbImdyZWVuIl0K
        ICAgIGBgYAoKICAgIEBtZXRob2QgcmVtb3ZlRWFjaAogICAgQHBhcmFtIHtF
        bWJlci5FbnVtZXJhYmxlfSBvYmplY3RzIHRoZSBvYmplY3RzIHRvIHJlbW92
        ZS4KICAgIEByZXR1cm4ge0VtYmVyLlNldH0gVGhlIHNldCBpdHNlbGYuCiAg
        Ki8KICByZW1vdmVFYWNoOiBFbWJlci5hbGlhc01ldGhvZCgncmVtb3ZlT2Jq
        ZWN0cycpLAoKICAvLyAuLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4u
        Li4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uCiAgLy8gUFJJVkFURSBFTlVN
        RVJBQkxFIFNVUFBPUlQKICAvLwoKICBpbml0OiBmdW5jdGlvbihpdGVtcykg
        ewogICAgdGhpcy5fc3VwZXIoKTsKICAgIGlmIChpdGVtcykgdGhpcy5hZGRP
        YmplY3RzKGl0ZW1zKTsKICB9LAoKICAvLyBpbXBsZW1lbnQgRW1iZXIuRW51
        bWVyYWJsZQogIG5leHRPYmplY3Q6IGZ1bmN0aW9uKGlkeCkgewogICAgcmV0
        dXJuIHRoaXNbaWR4XTsKICB9LAoKICAvLyBtb3JlIG9wdGltaXplZCB2ZXJz
        aW9uCiAgZmlyc3RPYmplY3Q6IEVtYmVyLmNvbXB1dGVkKGZ1bmN0aW9uKCkg
        ewogICAgcmV0dXJuIHRoaXMubGVuZ3RoID4gMCA/IHRoaXNbMF0gOiB1bmRl
        ZmluZWQ7CiAgfSksCgogIC8vIG1vcmUgb3B0aW1pemVkIHZlcnNpb24KICBs
        YXN0T2JqZWN0OiBFbWJlci5jb21wdXRlZChmdW5jdGlvbigpIHsKICAgIHJl
        dHVybiB0aGlzLmxlbmd0aCA+IDAgPyB0aGlzW3RoaXMubGVuZ3RoLTFdIDog
        dW5kZWZpbmVkOwogIH0pLAoKICAvLyBpbXBsZW1lbnRzIEVtYmVyLk11dGFi
        bGVFbnVtZXJhYmxlCiAgYWRkT2JqZWN0OiBmdW5jdGlvbihvYmopIHsKICAg
        IGlmIChnZXQodGhpcywgJ2lzRnJvemVuJykpIHRocm93IG5ldyBFbWJlci5F
        cnJvcihFbWJlci5GUk9aRU5fRVJST1IpOwogICAgaWYgKGlzTm9uZShvYmop
        KSByZXR1cm4gdGhpczsgLy8gbm90aGluZyB0byBkbwoKICAgIHZhciBndWlk
        ID0gZ3VpZEZvcihvYmopLAogICAgICAgIGlkeCAgPSB0aGlzW2d1aWRdLAog
        ICAgICAgIGxlbiAgPSBnZXQodGhpcywgJ2xlbmd0aCcpLAogICAgICAgIGFk
        ZGVkIDsKCiAgICBpZiAoaWR4Pj0wICYmIGlkeDxsZW4gJiYgKHRoaXNbaWR4
        XSA9PT0gb2JqKSkgcmV0dXJuIHRoaXM7IC8vIGFkZGVkCgogICAgYWRkZWQg
        PSBbb2JqXTsKCiAgICB0aGlzLmVudW1lcmFibGVDb250ZW50V2lsbENoYW5n
        ZShudWxsLCBhZGRlZCk7CiAgICBFbWJlci5wcm9wZXJ0eVdpbGxDaGFuZ2Uo
        dGhpcywgJ2xhc3RPYmplY3QnKTsKCiAgICBsZW4gPSBnZXQodGhpcywgJ2xl
        bmd0aCcpOwogICAgdGhpc1tndWlkXSA9IGxlbjsKICAgIHRoaXNbbGVuXSA9
        IG9iajsKICAgIHNldCh0aGlzLCAnbGVuZ3RoJywgbGVuKzEpOwoKICAgIEVt
        YmVyLnByb3BlcnR5RGlkQ2hhbmdlKHRoaXMsICdsYXN0T2JqZWN0Jyk7CiAg
        ICB0aGlzLmVudW1lcmFibGVDb250ZW50RGlkQ2hhbmdlKG51bGwsIGFkZGVk
        KTsKCiAgICByZXR1cm4gdGhpczsKICB9LAoKICAvLyBpbXBsZW1lbnRzIEVt
        YmVyLk11dGFibGVFbnVtZXJhYmxlCiAgcmVtb3ZlT2JqZWN0OiBmdW5jdGlv
        bihvYmopIHsKICAgIGlmIChnZXQodGhpcywgJ2lzRnJvemVuJykpIHRocm93
        IG5ldyBFbWJlci5FcnJvcihFbWJlci5GUk9aRU5fRVJST1IpOwogICAgaWYg
        KGlzTm9uZShvYmopKSByZXR1cm4gdGhpczsgLy8gbm90aGluZyB0byBkbwoK
        ICAgIHZhciBndWlkID0gZ3VpZEZvcihvYmopLAogICAgICAgIGlkeCAgPSB0
        aGlzW2d1aWRdLAogICAgICAgIGxlbiA9IGdldCh0aGlzLCAnbGVuZ3RoJyks
        CiAgICAgICAgaXNGaXJzdCA9IGlkeCA9PT0gMCwKICAgICAgICBpc0xhc3Qg
        PSBpZHggPT09IGxlbi0xLAogICAgICAgIGxhc3QsIHJlbW92ZWQ7CgoKICAg
        IGlmIChpZHg+PTAgJiYgaWR4PGxlbiAmJiAodGhpc1tpZHhdID09PSBvYmop
        KSB7CiAgICAgIHJlbW92ZWQgPSBbb2JqXTsKCiAgICAgIHRoaXMuZW51bWVy
        YWJsZUNvbnRlbnRXaWxsQ2hhbmdlKHJlbW92ZWQsIG51bGwpOwogICAgICBp
        ZiAoaXNGaXJzdCkgeyBFbWJlci5wcm9wZXJ0eVdpbGxDaGFuZ2UodGhpcywg
        J2ZpcnN0T2JqZWN0Jyk7IH0KICAgICAgaWYgKGlzTGFzdCkgIHsgRW1iZXIu
        cHJvcGVydHlXaWxsQ2hhbmdlKHRoaXMsICdsYXN0T2JqZWN0Jyk7IH0KCiAg
        ICAgIC8vIHN3YXAgaXRlbXMgLSBiYXNpY2FsbHkgbW92ZSB0aGUgaXRlbSB0
        byB0aGUgZW5kIHNvIGl0IGNhbiBiZSByZW1vdmVkCiAgICAgIGlmIChpZHgg
        PCBsZW4tMSkgewogICAgICAgIGxhc3QgPSB0aGlzW2xlbi0xXTsKICAgICAg
        ICB0aGlzW2lkeF0gPSBsYXN0OwogICAgICAgIHRoaXNbZ3VpZEZvcihsYXN0
        KV0gPSBpZHg7CiAgICAgIH0KCiAgICAgIGRlbGV0ZSB0aGlzW2d1aWRdOwog
        ICAgICBkZWxldGUgdGhpc1tsZW4tMV07CiAgICAgIHNldCh0aGlzLCAnbGVu
        Z3RoJywgbGVuLTEpOwoKICAgICAgaWYgKGlzRmlyc3QpIHsgRW1iZXIucHJv
        cGVydHlEaWRDaGFuZ2UodGhpcywgJ2ZpcnN0T2JqZWN0Jyk7IH0KICAgICAg
        aWYgKGlzTGFzdCkgIHsgRW1iZXIucHJvcGVydHlEaWRDaGFuZ2UodGhpcywg
        J2xhc3RPYmplY3QnKTsgfQogICAgICB0aGlzLmVudW1lcmFibGVDb250ZW50
        RGlkQ2hhbmdlKHJlbW92ZWQsIG51bGwpOwogICAgfQoKICAgIHJldHVybiB0
        aGlzOwogIH0sCgogIC8vIG9wdGltaXplZCB2ZXJzaW9uCiAgY29udGFpbnM6
        IGZ1bmN0aW9uKG9iaikgewogICAgcmV0dXJuIHRoaXNbZ3VpZEZvcihvYmop
        XT49MDsKICB9LAoKICBjb3B5OiBmdW5jdGlvbigpIHsKICAgIHZhciBDID0g
        dGhpcy5jb25zdHJ1Y3RvciwgcmV0ID0gbmV3IEMoKSwgbG9jID0gZ2V0KHRo
        aXMsICdsZW5ndGgnKTsKICAgIHNldChyZXQsICdsZW5ndGgnLCBsb2MpOwog
        ICAgd2hpbGUoLS1sb2M+PTApIHsKICAgICAgcmV0W2xvY10gPSB0aGlzW2xv
        Y107CiAgICAgIHJldFtndWlkRm9yKHRoaXNbbG9jXSldID0gbG9jOwogICAg
        fQogICAgcmV0dXJuIHJldDsKICB9LAoKICB0b1N0cmluZzogZnVuY3Rpb24o
        KSB7CiAgICB2YXIgbGVuID0gdGhpcy5sZW5ndGgsIGlkeCwgYXJyYXkgPSBb
        XTsKICAgIGZvcihpZHggPSAwOyBpZHggPCBsZW47IGlkeCsrKSB7CiAgICAg
        IGFycmF5W2lkeF0gPSB0aGlzW2lkeF07CiAgICB9CiAgICByZXR1cm4gZm10
        KCJFbWJlci5TZXQ8JUA+IiwgW2FycmF5LmpvaW4oJywnKV0pOwogIH0KCn0p
        OwoKfSkoKTsKCgoKKGZ1bmN0aW9uKCkgewp2YXIgRGVmZXJyZWRNaXhpbiA9
        IEVtYmVyLkRlZmVycmVkTWl4aW4sIC8vIG1peGlucy9kZWZlcnJlZAogICAg
        Z2V0ID0gRW1iZXIuZ2V0OwoKdmFyIERlZmVycmVkID0gRW1iZXIuT2JqZWN0
        LmV4dGVuZChEZWZlcnJlZE1peGluKTsKCkRlZmVycmVkLnJlb3BlbkNsYXNz
        KHsKICBwcm9taXNlOiBmdW5jdGlvbihjYWxsYmFjaywgYmluZGluZykgewog
        ICAgdmFyIGRlZmVycmVkID0gRGVmZXJyZWQuY3JlYXRlKCk7CiAgICBjYWxs
        YmFjay5jYWxsKGJpbmRpbmcsIGRlZmVycmVkKTsKICAgIHJldHVybiBkZWZl
        cnJlZDsKICB9Cn0pOwoKRW1iZXIuRGVmZXJyZWQgPSBEZWZlcnJlZDsKCn0p
        KCk7CgoKCihmdW5jdGlvbigpIHsKdmFyIGZvckVhY2ggPSBFbWJlci5BcnJh
        eVBvbHlmaWxscy5mb3JFYWNoOwoKLyoqCkBtb2R1bGUgZW1iZXIKQHN1Ym1v
        ZHVsZSBlbWJlci1ydW50aW1lCiovCgp2YXIgbG9hZEhvb2tzID0gRW1iZXIu
        RU5WLkVNQkVSX0xPQURfSE9PS1MgfHwge307CnZhciBsb2FkZWQgPSB7fTsK
        Ci8qKgoKRGV0ZWN0cyB3aGVuIGEgc3BlY2lmaWMgcGFja2FnZSBvZiBFbWJl
        ciAoZS5nLiAnRW1iZXIuSGFuZGxlYmFycycpCmhhcyBmdWxseSBsb2FkZWQg
        YW5kIGlzIGF2YWlsYWJsZSBmb3IgZXh0ZW5zaW9uLgoKVGhlIHByb3ZpZGVk
        IGBjYWxsYmFja2Agd2lsbCBiZSBjYWxsZWQgd2l0aCB0aGUgYG5hbWVgIHBh
        c3NlZApyZXNvbHZlZCBmcm9tIGEgc3RyaW5nIGludG8gdGhlIG9iamVjdDoK
        CmBgYGphdmFzY3JpcHQKRW1iZXIub25Mb2FkKCdFbWJlci5IYW5kbGViYXJz
        JyBmdW5jdGlvbihoYmFycyl7CiAgaGJhcnMucmVnaXN0ZXJIZWxwZXIoLi4u
        KTsKfSk7CmBgYAoKCkBtZXRob2Qgb25Mb2FkCkBmb3IgRW1iZXIKQHBhcmFt
        IG5hbWUge1N0cmluZ30gbmFtZSBvZiBob29rCkBwYXJhbSBjYWxsYmFjayB7
        RnVuY3Rpb259IGNhbGxiYWNrIHRvIGJlIGNhbGxlZAoqLwpFbWJlci5vbkxv
        YWQgPSBmdW5jdGlvbihuYW1lLCBjYWxsYmFjaykgewogIHZhciBvYmplY3Q7
        CgogIGxvYWRIb29rc1tuYW1lXSA9IGxvYWRIb29rc1tuYW1lXSB8fCBFbWJl
        ci5BKCk7CiAgbG9hZEhvb2tzW25hbWVdLnB1c2hPYmplY3QoY2FsbGJhY2sp
        OwoKICBpZiAob2JqZWN0ID0gbG9hZGVkW25hbWVdKSB7CiAgICBjYWxsYmFj
        ayhvYmplY3QpOwogIH0KfTsKCi8qKgoKQ2FsbGVkIHdoZW4gYW4gRW1iZXIu
        anMgcGFja2FnZSAoZS5nIEVtYmVyLkhhbmRsZWJhcnMpIGhhcyBmaW5pc2hl
        ZApsb2FkaW5nLiBUcmlnZ2VycyBhbnkgY2FsbGJhY2tzIHJlZ2lzdGVyZWQg
        Zm9yIHRoaXMgZXZlbnQuCgpAbWV0aG9kIHJ1bkxvYWRIb29rcwpAZm9yIEVt
        YmVyCkBwYXJhbSBuYW1lIHtTdHJpbmd9IG5hbWUgb2YgaG9vawpAcGFyYW0g
        b2JqZWN0IHtPYmplY3R9IG9iamVjdCB0byBwYXNzIHRvIGNhbGxiYWNrcwoq
        LwpFbWJlci5ydW5Mb2FkSG9va3MgPSBmdW5jdGlvbihuYW1lLCBvYmplY3Qp
        IHsKICBsb2FkZWRbbmFtZV0gPSBvYmplY3Q7CgogIGlmIChsb2FkSG9va3Nb
        bmFtZV0pIHsKICAgIGZvckVhY2guY2FsbChsb2FkSG9va3NbbmFtZV0sIGZ1
        bmN0aW9uKGNhbGxiYWNrKSB7CiAgICAgIGNhbGxiYWNrKG9iamVjdCk7CiAg
        ICB9KTsKICB9Cn07Cgp9KSgpOwoKCgooZnVuY3Rpb24oKSB7Cgp9KSgpOwoK
        CgooZnVuY3Rpb24oKSB7CnZhciBnZXQgPSBFbWJlci5nZXQ7CgovKioKQG1v
        ZHVsZSBlbWJlcgpAc3VibW9kdWxlIGVtYmVyLXJ1bnRpbWUKKi8KCi8qKgog
        IGBFbWJlci5Db250cm9sbGVyTWl4aW5gIHByb3ZpZGVzIGEgc3RhbmRhcmQg
        aW50ZXJmYWNlIGZvciBhbGwgY2xhc3NlcyB0aGF0CiAgY29tcG9zZSBFbWJl
        cidzIGNvbnRyb2xsZXIgbGF5ZXI6IGBFbWJlci5Db250cm9sbGVyYCwKICBg
        RW1iZXIuQXJyYXlDb250cm9sbGVyYCwgYW5kIGBFbWJlci5PYmplY3RDb250
        cm9sbGVyYC4KCiAgQGNsYXNzIENvbnRyb2xsZXJNaXhpbgogIEBuYW1lc3Bh
        Y2UgRW1iZXIKKi8KRW1iZXIuQ29udHJvbGxlck1peGluID0gRW1iZXIuTWl4
        aW4uY3JlYXRlKEVtYmVyLkFjdGlvbkhhbmRsZXIsIHsKICAvKiBkdWNrdHlw
        ZSBhcyBhIGNvbnRyb2xsZXIgKi8KICBpc0NvbnRyb2xsZXI6IHRydWUsCgog
        IC8qKgogICAgVGhlIG9iamVjdCB0byB3aGljaCBhY3Rpb25zIGZyb20gdGhl
        IHZpZXcgc2hvdWxkIGJlIHNlbnQuCgogICAgRm9yIGV4YW1wbGUsIHdoZW4g
        YSBIYW5kbGViYXJzIHRlbXBsYXRlIHVzZXMgdGhlIGB7e2FjdGlvbn19YCBo
        ZWxwZXIsCiAgICBpdCB3aWxsIGF0dGVtcHQgdG8gc2VuZCB0aGUgYWN0aW9u
        IHRvIHRoZSB2aWV3J3MgY29udHJvbGxlcidzIGB0YXJnZXRgLgoKICAgIEJ5
        IGRlZmF1bHQsIGEgY29udHJvbGxlcidzIGB0YXJnZXRgIGlzIHNldCB0byB0
        aGUgcm91dGVyIGFmdGVyIGl0IGlzCiAgICBpbnN0YW50aWF0ZWQgYnkgYEVt
        YmVyLkFwcGxpY2F0aW9uI2luaXRpYWxpemVgLgoKICAgIEBwcm9wZXJ0eSB0
        YXJnZXQKICAgIEBkZWZhdWx0IG51bGwKICAqLwogIHRhcmdldDogbnVsbCwK
        CiAgY29udGFpbmVyOiBudWxsLAoKICBwYXJlbnRDb250cm9sbGVyOiBudWxs
        LAoKICBzdG9yZTogbnVsbCwKCiAgbW9kZWw6IEVtYmVyLmNvbXB1dGVkLmFs
        aWFzKCdjb250ZW50JyksCgogIGRlcHJlY2F0ZWRTZW5kSGFuZGxlczogZnVu
        Y3Rpb24oYWN0aW9uTmFtZSkgewogICAgcmV0dXJuICEhdGhpc1thY3Rpb25O
        YW1lXTsKICB9LAoKICBkZXByZWNhdGVkU2VuZDogZnVuY3Rpb24oYWN0aW9u
        TmFtZSkgewogICAgdmFyIGFyZ3MgPSBbXS5zbGljZS5jYWxsKGFyZ3VtZW50
        cywgMSk7CiAgICBFbWJlci5hc3NlcnQoJycgKyB0aGlzICsgIiBoYXMgdGhl
        IGFjdGlvbiAiICsgYWN0aW9uTmFtZSArICIgYnV0IGl0IGlzIG5vdCBhIGZ1
        bmN0aW9uIiwgdHlwZW9mIHRoaXNbYWN0aW9uTmFtZV0gPT09ICdmdW5jdGlv
        bicpOwogICAgRW1iZXIuZGVwcmVjYXRlKCdBY3Rpb24gaGFuZGxlcnMgaW1w
        bGVtZW50ZWQgZGlyZWN0bHkgb24gY29udHJvbGxlcnMgYXJlIGRlcHJlY2F0
        ZWQgaW4gZmF2b3Igb2YgYWN0aW9uIGhhbmRsZXJzIG9uIGFuIGBhY3Rpb25z
        YCBvYmplY3QgKCcgKyBhY3Rpb25OYW1lICsgJyBvbiAnICsgdGhpcyArICcp
        JywgZmFsc2UpOwogICAgdGhpc1thY3Rpb25OYW1lXS5hcHBseSh0aGlzLCBh
        cmdzKTsKICAgIHJldHVybjsKICB9Cn0pOwoKLyoqCiAgQGNsYXNzIENvbnRy
        b2xsZXIKICBAbmFtZXNwYWNlIEVtYmVyCiAgQGV4dGVuZHMgRW1iZXIuT2Jq
        ZWN0CiAgQHVzZXMgRW1iZXIuQ29udHJvbGxlck1peGluCiovCkVtYmVyLkNv
        bnRyb2xsZXIgPSBFbWJlci5PYmplY3QuZXh0ZW5kKEVtYmVyLkNvbnRyb2xs
        ZXJNaXhpbik7Cgp9KSgpOwoKCgooZnVuY3Rpb24oKSB7Ci8qKgpAbW9kdWxl
        IGVtYmVyCkBzdWJtb2R1bGUgZW1iZXItcnVudGltZQoqLwoKdmFyIGdldCA9
        IEVtYmVyLmdldCwgc2V0ID0gRW1iZXIuc2V0LCBmb3JFYWNoID0gRW1iZXIu
        RW51bWVyYWJsZVV0aWxzLmZvckVhY2g7CgovKioKICBgRW1iZXIuU29ydGFi
        bGVNaXhpbmAgcHJvdmlkZXMgYSBzdGFuZGFyZCBpbnRlcmZhY2UgZm9yIGFy
        cmF5IHByb3hpZXMKICB0byBzcGVjaWZ5IGEgc29ydCBvcmRlciBhbmQgbWFp
        bnRhaW4gdGhpcyBzb3J0aW5nIHdoZW4gb2JqZWN0cyBhcmUgYWRkZWQsCiAg
        cmVtb3ZlZCwgb3IgdXBkYXRlZCB3aXRob3V0IGNoYW5naW5nIHRoZSBpbXBs
        aWNpdCBvcmRlciBvZiB0aGVpciB1bmRlcmx5aW5nCiAgY29udGVudCBhcnJh
        eToKCiAgYGBgamF2YXNjcmlwdAogIHNvbmdzID0gWwogICAge3RyYWNrTnVt
        YmVyOiA0LCB0aXRsZTogJ09iLUxhLURpLCBPYi1MYS1EYSd9LAogICAge3Ry
        YWNrTnVtYmVyOiAyLCB0aXRsZTogJ0JhY2sgaW4gdGhlIFUuUy5TLlIuJ30s
        CiAgICB7dHJhY2tOdW1iZXI6IDMsIHRpdGxlOiAnR2xhc3MgT25pb24nfSwK
        ICBdOwoKICBzb25nc0NvbnRyb2xsZXIgPSBFbWJlci5BcnJheUNvbnRyb2xs
        ZXIuY3JlYXRlKHsKICAgIGNvbnRlbnQ6IHNvbmdzLAogICAgc29ydFByb3Bl
        cnRpZXM6IFsndHJhY2tOdW1iZXInXSwKICAgIHNvcnRBc2NlbmRpbmc6IHRy
        dWUKICB9KTsKCiAgc29uZ3NDb250cm9sbGVyLmdldCgnZmlyc3RPYmplY3Qn
        KTsgIC8vIHt0cmFja051bWJlcjogMiwgdGl0bGU6ICdCYWNrIGluIHRoZSBV
        LlMuUy5SLid9CgogIHNvbmdzQ29udHJvbGxlci5hZGRPYmplY3Qoe3RyYWNr
        TnVtYmVyOiAxLCB0aXRsZTogJ0RlYXIgUHJ1ZGVuY2UnfSk7CiAgc29uZ3ND
        b250cm9sbGVyLmdldCgnZmlyc3RPYmplY3QnKTsgIC8vIHt0cmFja051bWJl
        cjogMSwgdGl0bGU6ICdEZWFyIFBydWRlbmNlJ30KICBgYGAKCiAgSWYgeW91
        IGFkZCBvciByZW1vdmUgdGhlIHByb3BlcnRpZXMgdG8gc29ydCBieSBvciBj
        aGFuZ2UgdGhlIHNvcnQgZGlyZWN0aW9uIHRoZSBjb250ZW50CiAgc29ydCBv
        cmRlciB3aWxsIGJlIGF1dG9tYXRpY2FsbHkgdXBkYXRlZC4KCiAgYGBgamF2
        YXNjcmlwdAogIHNvbmdzQ29udHJvbGxlci5zZXQoJ3NvcnRQcm9wZXJ0aWVz
        JywgWyd0aXRsZSddKTsKICBzb25nc0NvbnRyb2xsZXIuZ2V0KCdmaXJzdE9i
        amVjdCcpOyAvLyB7dHJhY2tOdW1iZXI6IDIsIHRpdGxlOiAnQmFjayBpbiB0
        aGUgVS5TLlMuUi4nfQoKICBzb25nc0NvbnRyb2xsZXIudG9nZ2xlUHJvcGVy
        dHkoJ3NvcnRBc2NlbmRpbmcnKTsKICBzb25nc0NvbnRyb2xsZXIuZ2V0KCdm
        aXJzdE9iamVjdCcpOyAvLyB7dHJhY2tOdW1iZXI6IDQsIHRpdGxlOiAnT2It
        TGEtRGksIE9iLUxhLURhJ30KICBgYGAKCiAgU29ydGFibGVNaXhpbiB3b3Jr
        cyBieSBzb3J0aW5nIHRoZSBhcnJhbmdlZENvbnRlbnQgYXJyYXksIHdoaWNo
        IGlzIHRoZSBhcnJheSB0aGF0CiAgYXJyYXlQcm94eSBkaXNwbGF5cy4gRHVl
        IHRvIHRoZSBmYWN0IHRoYXQgdGhlIHVuZGVybHlpbmcgJ2NvbnRlbnQnIGFy
        cmF5IGlzIG5vdCBjaGFuZ2VkLCB0aGF0CiAgYXJyYXkgd2lsbCBub3QgZGlz
        cGxheSB0aGUgc29ydGVkIGxpc3Q6CgogICBgYGBqYXZhc2NyaXB0CiAgc29u
        Z3NDb250cm9sbGVyLmdldCgnY29udGVudCcpLmdldCgnZmlyc3RPYmplY3Qn
        KTsgLy8gUmV0dXJucyB0aGUgdW5zb3J0ZWQgb3JpZ2luYWwgY29udGVudAog
        IHNvbmdzQ29udHJvbGxlci5nZXQoJ2ZpcnN0T2JqZWN0Jyk7IC8vIFJldHVy
        bnMgdGhlIHNvcnRlZCBjb250ZW50LgogIGBgYCAKICAKICBBbHRob3VnaCB0
        aGUgc29ydGVkIGNvbnRlbnQgY2FuIGFsc28gYmUgYWNjZXNzZWQgdGhyb3Vn
        aCB0aGUgYXJyYW5nZWRDb250ZW50IHByb3BlcnR5LAogIGl0IGlzIHByZWZl
        cmFibGUgdG8gdXNlIHRoZSBwcm94aWVkIGNsYXNzIGFuZCBub3QgdGhlIGFy
        cmFuZ2VkQ29udGVudCBhcnJheSBkaXJlY3RseS4KCiAgQGNsYXNzIFNvcnRh
        YmxlTWl4aW4KICBAbmFtZXNwYWNlIEVtYmVyCiAgQHVzZXMgRW1iZXIuTXV0
        YWJsZUVudW1lcmFibGUKKi8KRW1iZXIuU29ydGFibGVNaXhpbiA9IEVtYmVy
        Lk1peGluLmNyZWF0ZShFbWJlci5NdXRhYmxlRW51bWVyYWJsZSwgewoKICAv
        KioKICAgIFNwZWNpZmllcyB3aGljaCBwcm9wZXJ0aWVzIGRpY3RhdGUgdGhl
        IGFycmFuZ2VkQ29udGVudCdzIHNvcnQgb3JkZXIuCgogICAgV2hlbiBzcGVj
        aWZ5aW5nIG11bHRpcGxlIHByb3BlcnRpZXMgdGhlIHNvcnRpbmcgd2lsbCB1
        c2UgcHJvcGVydGllcwogICAgZnJvbSB0aGUgYHNvcnRQcm9wZXJ0aWVzYCBh
        cnJheSBwcmlvcml0aXplZCBmcm9tIGZpcnN0IHRvIGxhc3QuCgogICAgQHBy
        b3BlcnR5IHtBcnJheX0gc29ydFByb3BlcnRpZXMKICAqLwogIHNvcnRQcm9w
        ZXJ0aWVzOiBudWxsLAoKICAvKioKICAgIFNwZWNpZmllcyB0aGUgYXJyYW5n
        ZWRDb250ZW50J3Mgc29ydCBkaXJlY3Rpb24KCiAgICBAcHJvcGVydHkge0Jv
        b2xlYW59IHNvcnRBc2NlbmRpbmcKICAqLwogIHNvcnRBc2NlbmRpbmc6IHRy
        dWUsCgogIC8qKgogICAgVGhlIGZ1bmN0aW9uIHVzZWQgdG8gY29tcGFyZSB0
        d28gdmFsdWVzLiBZb3UgY2FuIG92ZXJyaWRlIHRoaXMgaWYgeW91CiAgICB3
        YW50IHRvIGRvIGN1c3RvbSBjb21wYXJpc29ucy4gRnVuY3Rpb25zIG11c3Qg
        YmUgb2YgdGhlIHR5cGUgZXhwZWN0ZWQgYnkKICAgIEFycmF5I3NvcnQsIGku
        ZS4KICAgICAgcmV0dXJuIDAgaWYgdGhlIHR3byBwYXJhbWV0ZXJzIGFyZSBl
        cXVhbCwKICAgICAgcmV0dXJuIGEgbmVnYXRpdmUgdmFsdWUgaWYgdGhlIGZp
        cnN0IHBhcmFtZXRlciBpcyBzbWFsbGVyIHRoYW4gdGhlIHNlY29uZCBvcgog
        ICAgICByZXR1cm4gYSBwb3NpdGl2ZSB2YWx1ZSBvdGhlcndpc2U6CgogICAg
        YGBgamF2YXNjcmlwdAogICAgZnVuY3Rpb24oeCx5KSB7IC8vIFRoZXNlIGFy
        ZSBhc3N1bWVkIHRvIGJlIGludGVnZXJzCiAgICAgIGlmICh4ID09PSB5KQog
        ICAgICAgIHJldHVybiAwOwogICAgICByZXR1cm4geCA8IHkgPyAtMSA6IDE7
        CiAgICB9CiAgICBgYGAKCiAgICBAcHJvcGVydHkgc29ydEZ1bmN0aW9uCiAg
        ICBAdHlwZSB7RnVuY3Rpb259CiAgICBAZGVmYXVsdCBFbWJlci5jb21wYXJl
        CiAgKi8KICBzb3J0RnVuY3Rpb246IEVtYmVyLmNvbXBhcmUsCgogIG9yZGVy
        Qnk6IGZ1bmN0aW9uKGl0ZW0xLCBpdGVtMikgewogICAgdmFyIHJlc3VsdCA9
        IDAsCiAgICAgICAgc29ydFByb3BlcnRpZXMgPSBnZXQodGhpcywgJ3NvcnRQ
        cm9wZXJ0aWVzJyksCiAgICAgICAgc29ydEFzY2VuZGluZyA9IGdldCh0aGlz
        LCAnc29ydEFzY2VuZGluZycpLAogICAgICAgIHNvcnRGdW5jdGlvbiA9IGdl
        dCh0aGlzLCAnc29ydEZ1bmN0aW9uJyk7CgogICAgRW1iZXIuYXNzZXJ0KCJ5
        b3UgbmVlZCB0byBkZWZpbmUgYHNvcnRQcm9wZXJ0aWVzYCIsICEhc29ydFBy
        b3BlcnRpZXMpOwoKICAgIGZvckVhY2goc29ydFByb3BlcnRpZXMsIGZ1bmN0
        aW9uKHByb3BlcnR5TmFtZSkgewogICAgICBpZiAocmVzdWx0ID09PSAwKSB7
        CiAgICAgICAgcmVzdWx0ID0gc29ydEZ1bmN0aW9uKGdldChpdGVtMSwgcHJv
        cGVydHlOYW1lKSwgZ2V0KGl0ZW0yLCBwcm9wZXJ0eU5hbWUpKTsKICAgICAg
        ICBpZiAoKHJlc3VsdCAhPT0gMCkgJiYgIXNvcnRBc2NlbmRpbmcpIHsKICAg
        ICAgICAgIHJlc3VsdCA9ICgtMSkgKiByZXN1bHQ7CiAgICAgICAgfQogICAg
        ICB9CiAgICB9KTsKCiAgICByZXR1cm4gcmVzdWx0OwogIH0sCgogIGRlc3Ry
        b3k6IGZ1bmN0aW9uKCkgewogICAgdmFyIGNvbnRlbnQgPSBnZXQodGhpcywg
        J2NvbnRlbnQnKSwKICAgICAgICBzb3J0UHJvcGVydGllcyA9IGdldCh0aGlz
        LCAnc29ydFByb3BlcnRpZXMnKTsKCiAgICBpZiAoY29udGVudCAmJiBzb3J0
        UHJvcGVydGllcykgewogICAgICBmb3JFYWNoKGNvbnRlbnQsIGZ1bmN0aW9u
        KGl0ZW0pIHsKICAgICAgICBmb3JFYWNoKHNvcnRQcm9wZXJ0aWVzLCBmdW5j
        dGlvbihzb3J0UHJvcGVydHkpIHsKICAgICAgICAgIEVtYmVyLnJlbW92ZU9i
        c2VydmVyKGl0ZW0sIHNvcnRQcm9wZXJ0eSwgdGhpcywgJ2NvbnRlbnRJdGVt
        U29ydFByb3BlcnR5RGlkQ2hhbmdlJyk7CiAgICAgICAgfSwgdGhpcyk7CiAg
        ICAgIH0sIHRoaXMpOwogICAgfQoKICAgIHJldHVybiB0aGlzLl9zdXBlcigp
        OwogIH0sCgogIGlzU29ydGVkOiBFbWJlci5jb21wdXRlZC5ib29sKCdzb3J0
        UHJvcGVydGllcycpLAoKICAvKioKICAgIE92ZXJyaWRlcyB0aGUgZGVmYXVs
        dCBhcnJhbmdlZENvbnRlbnQgZnJvbSBhcnJheVByb3h5IGluIG9yZGVyIHRv
        IHNvcnQgYnkgc29ydEZ1bmN0aW9uLgogICAgQWxzbyBzZXRzIHVwIG9ic2Vy
        dmVycyBmb3IgZWFjaCBzb3J0UHJvcGVydHkgb24gZWFjaCBpdGVtIGluIHRo
        ZSBjb250ZW50IEFycmF5LgogICAgCiAgICBAcHJvcGVydHkgYXJyYW5nZWRD
        b250ZW50CiAgKi8KCiAgYXJyYW5nZWRDb250ZW50OiBFbWJlci5jb21wdXRl
        ZCgnY29udGVudCcsICdzb3J0UHJvcGVydGllcy5AZWFjaCcsIGZ1bmN0aW9u
        KGtleSwgdmFsdWUpIHsKICAgIHZhciBjb250ZW50ID0gZ2V0KHRoaXMsICdj
        b250ZW50JyksCiAgICAgICAgaXNTb3J0ZWQgPSBnZXQodGhpcywgJ2lzU29y
        dGVkJyksCiAgICAgICAgc29ydFByb3BlcnRpZXMgPSBnZXQodGhpcywgJ3Nv
        cnRQcm9wZXJ0aWVzJyksCiAgICAgICAgc2VsZiA9IHRoaXM7CgogICAgaWYg
        KGNvbnRlbnQgJiYgaXNTb3J0ZWQpIHsKICAgICAgY29udGVudCA9IGNvbnRl
        bnQuc2xpY2UoKTsKICAgICAgY29udGVudC5zb3J0KGZ1bmN0aW9uKGl0ZW0x
        LCBpdGVtMikgewogICAgICAgIHJldHVybiBzZWxmLm9yZGVyQnkoaXRlbTEs
        IGl0ZW0yKTsKICAgICAgfSk7CiAgICAgIGZvckVhY2goY29udGVudCwgZnVu
        Y3Rpb24oaXRlbSkgewogICAgICAgIGZvckVhY2goc29ydFByb3BlcnRpZXMs
        IGZ1bmN0aW9uKHNvcnRQcm9wZXJ0eSkgewogICAgICAgICAgRW1iZXIuYWRk
        T2JzZXJ2ZXIoaXRlbSwgc29ydFByb3BlcnR5LCB0aGlzLCAnY29udGVudEl0
        ZW1Tb3J0UHJvcGVydHlEaWRDaGFuZ2UnKTsKICAgICAgICB9LCB0aGlzKTsK
        ICAgICAgfSwgdGhpcyk7CiAgICAgIHJldHVybiBFbWJlci5BKGNvbnRlbnQp
        OwogICAgfQoKICAgIHJldHVybiBjb250ZW50OwogIH0pLAoKICBfY29udGVu
        dFdpbGxDaGFuZ2U6IEVtYmVyLmJlZm9yZU9ic2VydmVyKGZ1bmN0aW9uKCkg
        ewogICAgdmFyIGNvbnRlbnQgPSBnZXQodGhpcywgJ2NvbnRlbnQnKSwKICAg
        ICAgICBzb3J0UHJvcGVydGllcyA9IGdldCh0aGlzLCAnc29ydFByb3BlcnRp
        ZXMnKTsKCiAgICBpZiAoY29udGVudCAmJiBzb3J0UHJvcGVydGllcykgewog
        ICAgICBmb3JFYWNoKGNvbnRlbnQsIGZ1bmN0aW9uKGl0ZW0pIHsKICAgICAg
        ICBmb3JFYWNoKHNvcnRQcm9wZXJ0aWVzLCBmdW5jdGlvbihzb3J0UHJvcGVy
        dHkpIHsKICAgICAgICAgIEVtYmVyLnJlbW92ZU9ic2VydmVyKGl0ZW0sIHNv
        cnRQcm9wZXJ0eSwgdGhpcywgJ2NvbnRlbnRJdGVtU29ydFByb3BlcnR5RGlk
        Q2hhbmdlJyk7CiAgICAgICAgfSwgdGhpcyk7CiAgICAgIH0sIHRoaXMpOwog
        ICAgfQoKICAgIHRoaXMuX3N1cGVyKCk7CiAgfSwgJ2NvbnRlbnQnKSwKCiAg
        c29ydEFzY2VuZGluZ1dpbGxDaGFuZ2U6IEVtYmVyLmJlZm9yZU9ic2VydmVy
        KGZ1bmN0aW9uKCkgewogICAgdGhpcy5fbGFzdFNvcnRBc2NlbmRpbmcgPSBn
        ZXQodGhpcywgJ3NvcnRBc2NlbmRpbmcnKTsKICB9LCAnc29ydEFzY2VuZGlu
        ZycpLAoKICBzb3J0QXNjZW5kaW5nRGlkQ2hhbmdlOiBFbWJlci5vYnNlcnZl
        cihmdW5jdGlvbigpIHsKICAgIGlmIChnZXQodGhpcywgJ3NvcnRBc2NlbmRp
        bmcnKSAhPT0gdGhpcy5fbGFzdFNvcnRBc2NlbmRpbmcpIHsKICAgICAgdmFy
        IGFycmFuZ2VkQ29udGVudCA9IGdldCh0aGlzLCAnYXJyYW5nZWRDb250ZW50
        Jyk7CiAgICAgIGFycmFuZ2VkQ29udGVudC5yZXZlcnNlT2JqZWN0cygpOwog
        ICAgfQogIH0sICdzb3J0QXNjZW5kaW5nJyksCgogIGNvbnRlbnRBcnJheVdp
        bGxDaGFuZ2U6IGZ1bmN0aW9uKGFycmF5LCBpZHgsIHJlbW92ZWRDb3VudCwg
        YWRkZWRDb3VudCkgewogICAgdmFyIGlzU29ydGVkID0gZ2V0KHRoaXMsICdp
        c1NvcnRlZCcpOwoKICAgIGlmIChpc1NvcnRlZCkgewogICAgICB2YXIgYXJy
        YW5nZWRDb250ZW50ID0gZ2V0KHRoaXMsICdhcnJhbmdlZENvbnRlbnQnKTsK
        ICAgICAgdmFyIHJlbW92ZWRPYmplY3RzID0gYXJyYXkuc2xpY2UoaWR4LCBp
        ZHgrcmVtb3ZlZENvdW50KTsKICAgICAgdmFyIHNvcnRQcm9wZXJ0aWVzID0g
        Z2V0KHRoaXMsICdzb3J0UHJvcGVydGllcycpOwoKICAgICAgZm9yRWFjaChy
        ZW1vdmVkT2JqZWN0cywgZnVuY3Rpb24oaXRlbSkgewogICAgICAgIGFycmFu
        Z2VkQ29udGVudC5yZW1vdmVPYmplY3QoaXRlbSk7CgogICAgICAgIGZvckVh
        Y2goc29ydFByb3BlcnRpZXMsIGZ1bmN0aW9uKHNvcnRQcm9wZXJ0eSkgewog
        ICAgICAgICAgRW1iZXIucmVtb3ZlT2JzZXJ2ZXIoaXRlbSwgc29ydFByb3Bl
        cnR5LCB0aGlzLCAnY29udGVudEl0ZW1Tb3J0UHJvcGVydHlEaWRDaGFuZ2Un
        KTsKICAgICAgICB9LCB0aGlzKTsKICAgICAgfSwgdGhpcyk7CiAgICB9Cgog
        ICAgcmV0dXJuIHRoaXMuX3N1cGVyKGFycmF5LCBpZHgsIHJlbW92ZWRDb3Vu
        dCwgYWRkZWRDb3VudCk7CiAgfSwKCiAgY29udGVudEFycmF5RGlkQ2hhbmdl
        OiBmdW5jdGlvbihhcnJheSwgaWR4LCByZW1vdmVkQ291bnQsIGFkZGVkQ291
        bnQpIHsKICAgIHZhciBpc1NvcnRlZCA9IGdldCh0aGlzLCAnaXNTb3J0ZWQn
        KSwKICAgICAgICBzb3J0UHJvcGVydGllcyA9IGdldCh0aGlzLCAnc29ydFBy
        b3BlcnRpZXMnKTsKCiAgICBpZiAoaXNTb3J0ZWQpIHsKICAgICAgdmFyIGFk
        ZGVkT2JqZWN0cyA9IGFycmF5LnNsaWNlKGlkeCwgaWR4K2FkZGVkQ291bnQp
        OwoKICAgICAgZm9yRWFjaChhZGRlZE9iamVjdHMsIGZ1bmN0aW9uKGl0ZW0p
        IHsKICAgICAgICB0aGlzLmluc2VydEl0ZW1Tb3J0ZWQoaXRlbSk7CgogICAg
        ICAgIGZvckVhY2goc29ydFByb3BlcnRpZXMsIGZ1bmN0aW9uKHNvcnRQcm9w
        ZXJ0eSkgewogICAgICAgICAgRW1iZXIuYWRkT2JzZXJ2ZXIoaXRlbSwgc29y
        dFByb3BlcnR5LCB0aGlzLCAnY29udGVudEl0ZW1Tb3J0UHJvcGVydHlEaWRD
        aGFuZ2UnKTsKICAgICAgICB9LCB0aGlzKTsKICAgICAgfSwgdGhpcyk7CiAg
        ICB9CgogICAgcmV0dXJuIHRoaXMuX3N1cGVyKGFycmF5LCBpZHgsIHJlbW92
        ZWRDb3VudCwgYWRkZWRDb3VudCk7CiAgfSwKCiAgaW5zZXJ0SXRlbVNvcnRl
        ZDogZnVuY3Rpb24oaXRlbSkgewogICAgdmFyIGFycmFuZ2VkQ29udGVudCA9
        IGdldCh0aGlzLCAnYXJyYW5nZWRDb250ZW50Jyk7CiAgICB2YXIgbGVuZ3Ro
        ID0gZ2V0KGFycmFuZ2VkQ29udGVudCwgJ2xlbmd0aCcpOwoKICAgIHZhciBp
        ZHggPSB0aGlzLl9iaW5hcnlTZWFyY2goaXRlbSwgMCwgbGVuZ3RoKTsKICAg
        IGFycmFuZ2VkQ29udGVudC5pbnNlcnRBdChpZHgsIGl0ZW0pOwogIH0sCgog
        IGNvbnRlbnRJdGVtU29ydFByb3BlcnR5RGlkQ2hhbmdlOiBmdW5jdGlvbihp
        dGVtKSB7CiAgICB2YXIgYXJyYW5nZWRDb250ZW50ID0gZ2V0KHRoaXMsICdh
        cnJhbmdlZENvbnRlbnQnKSwKICAgICAgICBvbGRJbmRleCA9IGFycmFuZ2Vk
        Q29udGVudC5pbmRleE9mKGl0ZW0pLAogICAgICAgIGxlZnRJdGVtID0gYXJy
        YW5nZWRDb250ZW50Lm9iamVjdEF0KG9sZEluZGV4IC0gMSksCiAgICAgICAg
        cmlnaHRJdGVtID0gYXJyYW5nZWRDb250ZW50Lm9iamVjdEF0KG9sZEluZGV4
        ICsgMSksCiAgICAgICAgbGVmdFJlc3VsdCA9IGxlZnRJdGVtICYmIHRoaXMu
        b3JkZXJCeShpdGVtLCBsZWZ0SXRlbSksCiAgICAgICAgcmlnaHRSZXN1bHQg
        PSByaWdodEl0ZW0gJiYgdGhpcy5vcmRlckJ5KGl0ZW0sIHJpZ2h0SXRlbSk7
        CgogICAgaWYgKGxlZnRSZXN1bHQgPCAwIHx8IHJpZ2h0UmVzdWx0ID4gMCkg
        ewogICAgICBhcnJhbmdlZENvbnRlbnQucmVtb3ZlT2JqZWN0KGl0ZW0pOwog
        ICAgICB0aGlzLmluc2VydEl0ZW1Tb3J0ZWQoaXRlbSk7CiAgICB9CiAgfSwK
        CiAgX2JpbmFyeVNlYXJjaDogZnVuY3Rpb24oaXRlbSwgbG93LCBoaWdoKSB7
        CiAgICB2YXIgbWlkLCBtaWRJdGVtLCByZXMsIGFycmFuZ2VkQ29udGVudDsK
        CiAgICBpZiAobG93ID09PSBoaWdoKSB7CiAgICAgIHJldHVybiBsb3c7CiAg
        ICB9CgogICAgYXJyYW5nZWRDb250ZW50ID0gZ2V0KHRoaXMsICdhcnJhbmdl
        ZENvbnRlbnQnKTsKCiAgICBtaWQgPSBsb3cgKyBNYXRoLmZsb29yKChoaWdo
        IC0gbG93KSAvIDIpOwogICAgbWlkSXRlbSA9IGFycmFuZ2VkQ29udGVudC5v
        YmplY3RBdChtaWQpOwoKICAgIHJlcyA9IHRoaXMub3JkZXJCeShtaWRJdGVt
        LCBpdGVtKTsKCiAgICBpZiAocmVzIDwgMCkgewogICAgICByZXR1cm4gdGhp
        cy5fYmluYXJ5U2VhcmNoKGl0ZW0sIG1pZCsxLCBoaWdoKTsKICAgIH0gZWxz
        ZSBpZiAocmVzID4gMCkgewogICAgICByZXR1cm4gdGhpcy5fYmluYXJ5U2Vh
        cmNoKGl0ZW0sIGxvdywgbWlkKTsKICAgIH0KCiAgICByZXR1cm4gbWlkOwog
        IH0KfSk7Cgp9KSgpOwoKCgooZnVuY3Rpb24oKSB7Ci8qKgpAbW9kdWxlIGVt
        YmVyCkBzdWJtb2R1bGUgZW1iZXItcnVudGltZQoqLwoKdmFyIGdldCA9IEVt
        YmVyLmdldCwgc2V0ID0gRW1iZXIuc2V0LCBmb3JFYWNoID0gRW1iZXIuRW51
        bWVyYWJsZVV0aWxzLmZvckVhY2gsCiAgICByZXBsYWNlID0gRW1iZXIuRW51
        bWVyYWJsZVV0aWxzLnJlcGxhY2U7CgovKioKICBgRW1iZXIuQXJyYXlDb250
        cm9sbGVyYCBwcm92aWRlcyBhIHdheSBmb3IgeW91IHRvIHB1Ymxpc2ggYSBj
        b2xsZWN0aW9uIG9mCiAgb2JqZWN0cyBzbyB0aGF0IHlvdSBjYW4gZWFzaWx5
        IGJpbmQgdG8gdGhlIGNvbGxlY3Rpb24gZnJvbSBhIEhhbmRsZWJhcnMKICBg
        I2VhY2hgIGhlbHBlciwgYW4gYEVtYmVyLkNvbGxlY3Rpb25WaWV3YCwgb3Ig
        b3RoZXIgY29udHJvbGxlcnMuCgogIFRoZSBhZHZhbnRhZ2Ugb2YgdXNpbmcg
        YW4gYEFycmF5Q29udHJvbGxlcmAgaXMgdGhhdCB5b3Ugb25seSBoYXZlIHRv
        IHNldCB1cAogIHlvdXIgdmlldyBiaW5kaW5ncyBvbmNlOyB0byBjaGFuZ2Ug
        d2hhdCdzIGRpc3BsYXllZCwgc2ltcGx5IHN3YXAgb3V0IHRoZQogIGBjb250
        ZW50YCBwcm9wZXJ0eSBvbiB0aGUgY29udHJvbGxlci4KCiAgRm9yIGV4YW1w
        bGUsIGltYWdpbmUgeW91IHdhbnRlZCB0byBkaXNwbGF5IGEgbGlzdCBvZiBp
        dGVtcyBmZXRjaGVkIHZpYSBhbiBYSFIKICByZXF1ZXN0LiBDcmVhdGUgYW4g
        YEVtYmVyLkFycmF5Q29udHJvbGxlcmAgYW5kIHNldCBpdHMgYGNvbnRlbnRg
        IHByb3BlcnR5OgoKICBgYGBqYXZhc2NyaXB0CiAgTXlBcHAubGlzdENvbnRy
        b2xsZXIgPSBFbWJlci5BcnJheUNvbnRyb2xsZXIuY3JlYXRlKCk7CgogICQu
        Z2V0KCdwZW9wbGUuanNvbicsIGZ1bmN0aW9uKGRhdGEpIHsKICAgIE15QXBw
        Lmxpc3RDb250cm9sbGVyLnNldCgnY29udGVudCcsIGRhdGEpOwogIH0pOwog
        IGBgYAoKICBUaGVuLCBjcmVhdGUgYSB2aWV3IHRoYXQgYmluZHMgdG8geW91
        ciBuZXcgY29udHJvbGxlcjoKCiAgYGBgaGFuZGxlYmFycwogIHt7I2VhY2gg
        TXlBcHAubGlzdENvbnRyb2xsZXJ9fQogICAge3tmaXJzdE5hbWV9fSB7e2xh
        c3ROYW1lfX0KICB7ey9lYWNofX0KICBgYGAKCiAgQWx0aG91Z2ggeW91IGFy
        ZSBiaW5kaW5nIHRvIHRoZSBjb250cm9sbGVyLCB0aGUgYmVoYXZpb3Igb2Yg
        dGhpcyBjb250cm9sbGVyCiAgaXMgdG8gcGFzcyB0aHJvdWdoIGFueSBtZXRo
        b2RzIG9yIHByb3BlcnRpZXMgdG8gdGhlIHVuZGVybHlpbmcgYXJyYXkuIFRo
        aXMKICBjYXBhYmlsaXR5IGNvbWVzIGZyb20gYEVtYmVyLkFycmF5UHJveHlg
        LCB3aGljaCB0aGlzIGNsYXNzIGluaGVyaXRzIGZyb20uCgogIFNvbWV0aW1l
        cyB5b3Ugd2FudCB0byBkaXNwbGF5IGNvbXB1dGVkIHByb3BlcnRpZXMgd2l0
        aGluIHRoZSBib2R5IG9mIGFuCiAgYCNlYWNoYCBoZWxwZXIgdGhhdCBkZXBl
        bmQgb24gdGhlIHVuZGVybHlpbmcgaXRlbXMgaW4gYGNvbnRlbnRgLCBidXQg
        YXJlIG5vdAogIHByZXNlbnQgb24gdGhvc2UgaXRlbXMuICAgVG8gZG8gdGhp
        cywgc2V0IGBpdGVtQ29udHJvbGxlcmAgdG8gdGhlIG5hbWUgb2YgYQogIGNv
        bnRyb2xsZXIgKHByb2JhYmx5IGFuIGBPYmplY3RDb250cm9sbGVyYCkgdGhh
        dCB3aWxsIHdyYXAgZWFjaCBpbmRpdmlkdWFsIGl0ZW0uCgogIEZvciBleGFt
        cGxlOgoKICBgYGBoYW5kbGViYXJzCiAgICB7eyNlYWNoIHBvc3QgaW4gY29u
        dHJvbGxlcn19CiAgICAgIDxsaT57e3RpdGxlfX0gKHt7dGl0bGVMZW5ndGh9
        fSBjaGFyYWN0ZXJzKTwvbGk+CiAgICB7ey9lYWNofX0KICBgYGAKCiAgYGBg
        amF2YXNjcmlwdAogIEFwcC5Qb3N0c0NvbnRyb2xsZXIgPSBFbWJlci5BcnJh
        eUNvbnRyb2xsZXIuZXh0ZW5kKHsKICAgIGl0ZW1Db250cm9sbGVyOiAncG9z
        dCcKICB9KTsKCiAgQXBwLlBvc3RDb250cm9sbGVyID0gRW1iZXIuT2JqZWN0
        Q29udHJvbGxlci5leHRlbmQoewogICAgLy8gdGhlIGB0aXRsZWAgcHJvcGVy
        dHkgd2lsbCBiZSBwcm94aWVkIHRvIHRoZSB1bmRlcmx5aW5nIHBvc3QuCgog
        ICAgdGl0bGVMZW5ndGg6IGZ1bmN0aW9uKCkgewogICAgICByZXR1cm4gdGhp
        cy5nZXQoJ3RpdGxlJykubGVuZ3RoOwogICAgfS5wcm9wZXJ0eSgndGl0bGUn
        KQogIH0pOwogIGBgYAoKICBJbiBzb21lIGNhc2VzIGl0IGlzIGhlbHBmdWwg
        dG8gcmV0dXJuIGEgZGlmZmVyZW50IGBpdGVtQ29udHJvbGxlcmAgZGVwZW5k
        aW5nCiAgb24gdGhlIHBhcnRpY3VsYXIgaXRlbS4gIFN1YmNsYXNzZXMgY2Fu
        IGRvIHRoaXMgYnkgb3ZlcnJpZGluZwogIGBsb29rdXBJdGVtQ29udHJvbGxl
        cmAuCgogIEZvciBleGFtcGxlOgoKICBgYGBqYXZhc2NyaXB0CiAgQXBwLk15
        QXJyYXlDb250cm9sbGVyID0gRW1iZXIuQXJyYXlDb250cm9sbGVyLmV4dGVu
        ZCh7CiAgICBsb29rdXBJdGVtQ29udHJvbGxlcjogZnVuY3Rpb24oIG9iamVj
        dCApIHsKICAgICAgaWYgKG9iamVjdC5nZXQoJ2lzU3BlY2lhbCcpKSB7CiAg
        ICAgICAgcmV0dXJuICJzcGVjaWFsIjsgLy8gdXNlIEFwcC5TcGVjaWFsQ29u
        dHJvbGxlcgogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiAicmVndWxh
        ciI7IC8vIHVzZSBBcHAuUmVndWxhckNvbnRyb2xsZXIKICAgICAgfQogICAg
        fQogIH0pOwogIGBgYAoKICBUaGUgaXRlbUNvbnRyb2xsZXIgaW5zdGFuY2Vz
        IHdpbGwgaGF2ZSBhIGBwYXJlbnRDb250cm9sbGVyYCBwcm9wZXJ0eSBzZXQg
        dG8KICBlaXRoZXIgdGhlIHRoZSBgcGFyZW50Q29udHJvbGxlcmAgcHJvcGVy
        dHkgb2YgdGhlIGBBcnJheUNvbnRyb2xsZXJgCiAgb3IgdG8gdGhlIGBBcnJh
        eUNvbnRyb2xsZXJgIGluc3RhbmNlIGl0c2VsZi4KCiAgQGNsYXNzIEFycmF5
        Q29udHJvbGxlcgogIEBuYW1lc3BhY2UgRW1iZXIKICBAZXh0ZW5kcyBFbWJl
        ci5BcnJheVByb3h5CiAgQHVzZXMgRW1iZXIuU29ydGFibGVNaXhpbgogIEB1
        c2VzIEVtYmVyLkNvbnRyb2xsZXJNaXhpbgoqLwoKRW1iZXIuQXJyYXlDb250
        cm9sbGVyID0gRW1iZXIuQXJyYXlQcm94eS5leHRlbmQoRW1iZXIuQ29udHJv
        bGxlck1peGluLAogIEVtYmVyLlNvcnRhYmxlTWl4aW4sIHsKCiAgLyoqCiAg
        ICBUaGUgY29udHJvbGxlciB1c2VkIHRvIHdyYXAgaXRlbXMsIGlmIGFueS4K
        CiAgICBAcHJvcGVydHkgaXRlbUNvbnRyb2xsZXIKICAgIEB0eXBlIFN0cmlu
        ZwogICAgQGRlZmF1bHQgbnVsbAogICovCiAgaXRlbUNvbnRyb2xsZXI6IG51
        bGwsCgogIC8qKgogICAgUmV0dXJuIHRoZSBuYW1lIG9mIHRoZSBjb250cm9s
        bGVyIHRvIHdyYXAgaXRlbXMsIG9yIGBudWxsYCBpZiBpdGVtcyBzaG91bGQK
        ICAgIGJlIHJldHVybmVkIGRpcmVjdGx5LiAgVGhlIGRlZmF1bHQgaW1wbGVt
        ZW50YXRpb24gc2ltcGx5IHJldHVybnMgdGhlCiAgICBgaXRlbUNvbnRyb2xs
        ZXJgIHByb3BlcnR5LCBidXQgc3ViY2xhc3NlcyBjYW4gb3ZlcnJpZGUgdGhp
        cyBtZXRob2QgdG8gcmV0dXJuCiAgICBkaWZmZXJlbnQgY29udHJvbGxlcnMg
        Zm9yIGRpZmZlcmVudCBvYmplY3RzLgoKICAgIEZvciBleGFtcGxlOgoKICAg
        IGBgYGphdmFzY3JpcHQKICAgIEFwcC5NeUFycmF5Q29udHJvbGxlciA9IEVt
        YmVyLkFycmF5Q29udHJvbGxlci5leHRlbmQoewogICAgICBsb29rdXBJdGVt
        Q29udHJvbGxlcjogZnVuY3Rpb24oIG9iamVjdCApIHsKICAgICAgICBpZiAo
        b2JqZWN0LmdldCgnaXNTcGVjaWFsJykpIHsKICAgICAgICAgIHJldHVybiAi
        c3BlY2lhbCI7IC8vIHVzZSBBcHAuU3BlY2lhbENvbnRyb2xsZXIKICAgICAg
        ICB9IGVsc2UgewogICAgICAgICAgcmV0dXJuICJyZWd1bGFyIjsgLy8gdXNl
        IEFwcC5SZWd1bGFyQ29udHJvbGxlcgogICAgICAgIH0KICAgICAgfQogICAg
        fSk7CiAgICBgYGAKCiAgICBAbWV0aG9kIGxvb2t1cEl0ZW1Db250cm9sbGVy
        CiAgICBAcGFyYW0ge09iamVjdH0gb2JqZWN0CiAgICBAcmV0dXJuIHtTdHJp
        bmd9CiAgKi8KICBsb29rdXBJdGVtQ29udHJvbGxlcjogZnVuY3Rpb24ob2Jq
        ZWN0KSB7CiAgICByZXR1cm4gZ2V0KHRoaXMsICdpdGVtQ29udHJvbGxlcicp
        OwogIH0sCgogIG9iamVjdEF0Q29udGVudDogZnVuY3Rpb24oaWR4KSB7CiAg
        ICB2YXIgbGVuZ3RoID0gZ2V0KHRoaXMsICdsZW5ndGgnKSwKICAgICAgICBh
        cnJhbmdlZENvbnRlbnQgPSBnZXQodGhpcywnYXJyYW5nZWRDb250ZW50Jyks
        CiAgICAgICAgb2JqZWN0ID0gYXJyYW5nZWRDb250ZW50ICYmIGFycmFuZ2Vk
        Q29udGVudC5vYmplY3RBdChpZHgpOwoKICAgIGlmIChpZHggPj0gMCAmJiBp
        ZHggPCBsZW5ndGgpIHsKICAgICAgdmFyIGNvbnRyb2xsZXJDbGFzcyA9IHRo
        aXMubG9va3VwSXRlbUNvbnRyb2xsZXIob2JqZWN0KTsKICAgICAgaWYgKGNv
        bnRyb2xsZXJDbGFzcykgewogICAgICAgIHJldHVybiB0aGlzLmNvbnRyb2xs
        ZXJBdChpZHgsIG9iamVjdCwgY29udHJvbGxlckNsYXNzKTsKICAgICAgfQog
        ICAgfQoKICAgIC8vIFdoZW4gYGNvbnRyb2xsZXJDbGFzc2AgaXMgZmFsc3ks
        IHdlIGhhdmUgbm90IG9wdGVkIGluIHRvIHVzaW5nIGl0ZW0KICAgIC8vIGNv
        bnRyb2xsZXJzLCBzbyByZXR1cm4gdGhlIG9iamVjdCBkaXJlY3RseS4KCiAg
        ICAvLyBXaGVuIHRoZSBpbmRleCBpcyBvdXQgb2YgcmFuZ2UsIHdlIHdhbnQg
        dG8gcmV0dXJuIHRoZSAib3V0IG9mIHJhbmdlIgogICAgLy8gdmFsdWUsIHdo
        YXRldmVyIHRoYXQgbWlnaHQgYmUuICBSYXRoZXIgdGhhbiBtYWtlIGFzc3Vt
        cHRpb25zCiAgICAvLyAoZS5nLiBndWVzc2luZyBgbnVsbGAgb3IgYHVuZGVm
        aW5lZGApIHdlIGRlZmVyIHRoaXMgdG8gYGFycmFuZ2VkQ29udGVudGAuCiAg
        ICByZXR1cm4gb2JqZWN0OwogIH0sCgogIGFycmFuZ2VkQ29udGVudERpZENo
        YW5nZTogZnVuY3Rpb24oKSB7CiAgICB0aGlzLl9zdXBlcigpOwogICAgdGhp
        cy5fcmVzZXRTdWJDb250cm9sbGVycygpOwogIH0sCgogIGFycmF5Q29udGVu
        dERpZENoYW5nZTogZnVuY3Rpb24oaWR4LCByZW1vdmVkQ250LCBhZGRlZENu
        dCkgewogICAgdmFyIHN1YkNvbnRyb2xsZXJzID0gZ2V0KHRoaXMsICdfc3Vi
        Q29udHJvbGxlcnMnKSwKICAgICAgICBzdWJDb250cm9sbGVyc1RvUmVtb3Zl
        ID0gc3ViQ29udHJvbGxlcnMuc2xpY2UoaWR4LCBpZHgrcmVtb3ZlZENudCk7
        CgogICAgZm9yRWFjaChzdWJDb250cm9sbGVyc1RvUmVtb3ZlLCBmdW5jdGlv
        bihzdWJDb250cm9sbGVyKSB7CiAgICAgIGlmIChzdWJDb250cm9sbGVyKSB7
        IHN1YkNvbnRyb2xsZXIuZGVzdHJveSgpOyB9CiAgICB9KTsKCiAgICByZXBs
        YWNlKHN1YkNvbnRyb2xsZXJzLCBpZHgsIHJlbW92ZWRDbnQsIG5ldyBBcnJh
        eShhZGRlZENudCkpOwoKICAgIC8vIFRoZSBzaGFkb3cgYXJyYXkgb2Ygc3Vi
        Y29udHJvbGxlcnMgbXVzdCBiZSB1cGRhdGVkIGJlZm9yZSB3ZSB0cmlnZ2Vy
        CiAgICAvLyBvYnNlcnZlcnMsIG90aGVyd2lzZSBvYnNlcnZlcnMgd2lsbCBn
        ZXQgdGhlIHdyb25nIHN1YmNvbnRhaW5lciB3aGVuCiAgICAvLyBjYWxsaW5n
        IGBvYmplY3RBdGAKICAgIHRoaXMuX3N1cGVyKGlkeCwgcmVtb3ZlZENudCwg
        YWRkZWRDbnQpOwogIH0sCgogIGluaXQ6IGZ1bmN0aW9uKCkgewogICAgdGhp
        cy5fc3VwZXIoKTsKCiAgICB0aGlzLnNldCgnX3N1YkNvbnRyb2xsZXJzJywg
        RW1iZXIuQSgpKTsKICB9LAoKICBjb250ZW50OiBFbWJlci5jb21wdXRlZChm
        dW5jdGlvbiAoKSB7CiAgICByZXR1cm4gRW1iZXIuQSgpOwogIH0pLAoKICBj
        b250cm9sbGVyQXQ6IGZ1bmN0aW9uKGlkeCwgb2JqZWN0LCBjb250cm9sbGVy
        Q2xhc3MpIHsKICAgIHZhciBjb250YWluZXIgPSBnZXQodGhpcywgJ2NvbnRh
        aW5lcicpLAogICAgICAgIHN1YkNvbnRyb2xsZXJzID0gZ2V0KHRoaXMsICdf
        c3ViQ29udHJvbGxlcnMnKSwKICAgICAgICBzdWJDb250cm9sbGVyID0gc3Vi
        Q29udHJvbGxlcnNbaWR4XSwKICAgICAgICBmYWN0b3J5LCBmdWxsTmFtZTsK
        CiAgICBpZiAoc3ViQ29udHJvbGxlcikgeyByZXR1cm4gc3ViQ29udHJvbGxl
        cjsgfQoKICAgIGZ1bGxOYW1lID0gImNvbnRyb2xsZXI6IiArIGNvbnRyb2xs
        ZXJDbGFzczsKCiAgICBpZiAoIWNvbnRhaW5lci5oYXMoZnVsbE5hbWUpKSB7
        CiAgICAgIHRocm93IG5ldyBFbWJlci5FcnJvcignQ291bGQgbm90IHJlc29s
        dmUgaXRlbUNvbnRyb2xsZXI6ICInICsgY29udHJvbGxlckNsYXNzICsgJyIn
        KTsKICAgIH0KCiAgICBzdWJDb250cm9sbGVyID0gY29udGFpbmVyLmxvb2t1
        cEZhY3RvcnkoZnVsbE5hbWUpLmNyZWF0ZSh7CiAgICAgIHRhcmdldDogdGhp
        cywKICAgICAgcGFyZW50Q29udHJvbGxlcjogZ2V0KHRoaXMsICdwYXJlbnRD
        b250cm9sbGVyJykgfHwgdGhpcywKICAgICAgY29udGVudDogb2JqZWN0CiAg
        ICB9KTsKCiAgICBzdWJDb250cm9sbGVyc1tpZHhdID0gc3ViQ29udHJvbGxl
        cjsKCiAgICByZXR1cm4gc3ViQ29udHJvbGxlcjsKICB9LAoKICBfc3ViQ29u
        dHJvbGxlcnM6IG51bGwsCgogIF9yZXNldFN1YkNvbnRyb2xsZXJzOiBmdW5j
        dGlvbigpIHsKICAgIHZhciBzdWJDb250cm9sbGVycyA9IGdldCh0aGlzLCAn
        X3N1YkNvbnRyb2xsZXJzJyk7CiAgICBpZiAoc3ViQ29udHJvbGxlcnMpIHsK
        ICAgICAgZm9yRWFjaChzdWJDb250cm9sbGVycywgZnVuY3Rpb24oc3ViQ29u
        dHJvbGxlcikgewogICAgICAgIGlmIChzdWJDb250cm9sbGVyKSB7IHN1YkNv
        bnRyb2xsZXIuZGVzdHJveSgpOyB9CiAgICAgIH0pOwogICAgfQoKICAgIHRo
        aXMuc2V0KCdfc3ViQ29udHJvbGxlcnMnLCBFbWJlci5BKCkpOwogIH0KfSk7
        Cgp9KSgpOwoKCgooZnVuY3Rpb24oKSB7Ci8qKgpAbW9kdWxlIGVtYmVyCkBz
        dWJtb2R1bGUgZW1iZXItcnVudGltZQoqLwoKLyoqCiAgYEVtYmVyLk9iamVj
        dENvbnRyb2xsZXJgIGlzIHBhcnQgb2YgRW1iZXIncyBDb250cm9sbGVyIGxh
        eWVyLiBJdCBpcyBpbnRlbmRlZAogIHRvIHdyYXAgYSBzaW5nbGUgb2JqZWN0
        LCBwcm94eWluZyB1bmhhbmRsZWQgYXR0ZW1wdHMgdG8gYGdldGAgYW5kIGBz
        ZXRgIHRvIHRoZSB1bmRlcmx5aW5nCiAgY29udGVudCBvYmplY3QsIGFuZCB0
        byBmb3J3YXJkIHVuaGFuZGxlZCBhY3Rpb24gYXR0ZW1wdHMgdG8gaXRzIGB0
        YXJnZXRgLgoKICBgRW1iZXIuT2JqZWN0Q29udHJvbGxlcmAgZGVyaXZlcyB0
        aGlzIGZ1bmN0aW9uYWxpdHkgZnJvbSBpdHMgc3VwZXJjbGFzcwogIGBFbWJl
        ci5PYmplY3RQcm94eWAgYW5kIHRoZSBgRW1iZXIuQ29udHJvbGxlck1peGlu
        YCBtaXhpbi4KCiAgQGNsYXNzIE9iamVjdENvbnRyb2xsZXIKICBAbmFtZXNw
        YWNlIEVtYmVyCiAgQGV4dGVuZHMgRW1iZXIuT2JqZWN0UHJveHkKICBAdXNl
        cyBFbWJlci5Db250cm9sbGVyTWl4aW4KKiovCkVtYmVyLk9iamVjdENvbnRy
        b2xsZXIgPSBFbWJlci5PYmplY3RQcm94eS5leHRlbmQoRW1iZXIuQ29udHJv
        bGxlck1peGluKTsKCn0pKCk7CgoKCihmdW5jdGlvbigpIHsKCn0pKCk7CgoK
        CihmdW5jdGlvbigpIHsKLyoqCkVtYmVyIFJ1bnRpbWUKCkBtb2R1bGUgZW1i
        ZXIKQHN1Ym1vZHVsZSBlbWJlci1ydW50aW1lCkByZXF1aXJlcyBlbWJlci1t
        ZXRhbAoqLwoKfSkoKTsKCihmdW5jdGlvbigpIHsKLyoqCkBtb2R1bGUgZW1i
        ZXIKQHN1Ym1vZHVsZSBlbWJlci12aWV3cwoqLwoKdmFyIGpRdWVyeSA9IEVt
        YmVyLmltcG9ydHMualF1ZXJ5OwpFbWJlci5hc3NlcnQoIkVtYmVyIFZpZXdz
        IHJlcXVpcmUgalF1ZXJ5IDEuNywgMS44LCAxLjksIDEuMTAsIG9yIDIuMCIs
        IGpRdWVyeSAmJiAoalF1ZXJ5KCkuanF1ZXJ5Lm1hdGNoKC9eKCgxXC4oN3w4
        fDl8MTApKXwyLjApKFwuXGQrKT8ocHJlfHJjXGQ/KT8vKSB8fCBFbWJlci5F
        TlYuRk9SQ0VfSlFVRVJZKSk7CgovKioKICBBbGlhcyBmb3IgalF1ZXJ5Cgog
        IEBtZXRob2QgJAogIEBmb3IgRW1iZXIKKi8KRW1iZXIuJCA9IGpRdWVyeTsK
        Cn0pKCk7CgoKCihmdW5jdGlvbigpIHsKLyoqCkBtb2R1bGUgZW1iZXIKQHN1
        Ym1vZHVsZSBlbWJlci12aWV3cwoqLwppZiAoRW1iZXIuJCkgewogIC8vIGh0
        dHA6Ly93d3cud2hhdHdnLm9yZy9zcGVjcy93ZWItYXBwcy9jdXJyZW50LXdv
        cmsvbXVsdGlwYWdlL2RuZC5odG1sI2RuZGV2ZW50cwogIHZhciBkcmFnRXZl
        bnRzID0gRW1iZXIuU3RyaW5nLncoJ2RyYWdzdGFydCBkcmFnIGRyYWdlbnRl
        ciBkcmFnbGVhdmUgZHJhZ292ZXIgZHJvcCBkcmFnZW5kJyk7CgogIC8vIENv
        cGllcyB0aGUgYGRhdGFUcmFuc2ZlcmAgcHJvcGVydHkgZnJvbSBhIGJyb3dz
        ZXIgZXZlbnQgb2JqZWN0IG9udG8gdGhlCiAgLy8galF1ZXJ5IGV2ZW50IG9i
        amVjdCBmb3IgdGhlIHNwZWNpZmllZCBldmVudHMKICBFbWJlci5FbnVtZXJh
        YmxlVXRpbHMuZm9yRWFjaChkcmFnRXZlbnRzLCBmdW5jdGlvbihldmVudE5h
        bWUpIHsKICAgIEVtYmVyLiQuZXZlbnQuZml4SG9va3NbZXZlbnROYW1lXSA9
        IHsgcHJvcHM6IFsnZGF0YVRyYW5zZmVyJ10gfTsKICB9KTsKfQoKfSkoKTsK
        CgoKKGZ1bmN0aW9uKCkgewovKioKQG1vZHVsZSBlbWJlcgpAc3VibW9kdWxl
        IGVtYmVyLXZpZXdzCiovCgovKiBCRUdJTiBNRVRBTU9SUEggSEVMUEVSUyAq
        LwoKLy8gSW50ZXJuZXQgRXhwbG9yZXIgcHJpb3IgdG8gOSBkb2VzIG5vdCBh
        bGxvdyBzZXR0aW5nIGlubmVySFRNTCBpZiB0aGUgZmlyc3QgZWxlbWVudAov
        LyBpcyBhICJ6ZXJvLXNjb3BlIiBlbGVtZW50LiBUaGlzIHByb2JsZW0gY2Fu
        IGJlIHdvcmtlZCBhcm91bmQgYnkgbWFraW5nCi8vIHRoZSBmaXJzdCBub2Rl
        IGFuIGludmlzaWJsZSB0ZXh0IG5vZGUuIFdlLCBsaWtlIE1vZGVybml6ciwg
        dXNlICZzaHk7Cgp2YXIgbmVlZHNTaHkgPSB0aGlzLmRvY3VtZW50ICYmIChm
        dW5jdGlvbigpIHsKICB2YXIgdGVzdEVsID0gZG9jdW1lbnQuY3JlYXRlRWxl
        bWVudCgnZGl2Jyk7CiAgdGVzdEVsLmlubmVySFRNTCA9ICI8ZGl2PjwvZGl2
        PiI7CiAgdGVzdEVsLmZpcnN0Q2hpbGQuaW5uZXJIVE1MID0gIjxzY3JpcHQ+
        PC9zY3JpcHQ+IjsKICByZXR1cm4gdGVzdEVsLmZpcnN0Q2hpbGQuaW5uZXJI
        VE1MID09PSAnJzsKfSkoKTsKCi8vIElFIDggKGFuZCBsaWtlbHkgZWFybGll
        cikgbGlrZXMgdG8gbW92ZSB3aGl0ZXNwYWNlIHByZWNlZWRpbmcKLy8gYSBz
        Y3JpcHQgdGFnIHRvIGFwcGVhciBhZnRlciBpdC4gVGhpcyBtZWFucyB0aGF0
        IHdlIGNhbgovLyBhY2NpZGVudGFsbHkgcmVtb3ZlIHdoaXRlc3BhY2Ugd2hl
        biB1cGRhdGluZyBhIG1vcnBoLgp2YXIgbW92ZXNXaGl0ZXNwYWNlID0gdGhp
        cy5kb2N1bWVudCAmJiAoZnVuY3Rpb24oKSB7CiAgdmFyIHRlc3RFbCA9IGRv
        Y3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwogIHRlc3RFbC5pbm5lckhU
        TUwgPSAiVGVzdDogPHNjcmlwdCB0eXBlPSd0ZXh0L3gtcGxhY2Vob2xkZXIn
        Pjwvc2NyaXB0PlZhbHVlIjsKICByZXR1cm4gdGVzdEVsLmNoaWxkTm9kZXNb
        MF0ubm9kZVZhbHVlID09PSAnVGVzdDonICYmCiAgICAgICAgICB0ZXN0RWwu
        Y2hpbGROb2Rlc1syXS5ub2RlVmFsdWUgPT09ICcgVmFsdWUnOwp9KSgpOwoK
        Ly8gVXNlIHRoaXMgdG8gZmluZCBjaGlsZHJlbiBieSBJRCBpbnN0ZWFkIG9m
        IHVzaW5nIGpRdWVyeQp2YXIgZmluZENoaWxkQnlJZCA9IGZ1bmN0aW9uKGVs
        ZW1lbnQsIGlkKSB7CiAgaWYgKGVsZW1lbnQuZ2V0QXR0cmlidXRlKCdpZCcp
        ID09PSBpZCkgeyByZXR1cm4gZWxlbWVudDsgfQoKICB2YXIgbGVuID0gZWxl
        bWVudC5jaGlsZE5vZGVzLmxlbmd0aCwgaWR4LCBub2RlLCBmb3VuZDsKICBm
        b3IgKGlkeD0wOyBpZHg8bGVuOyBpZHgrKykgewogICAgbm9kZSA9IGVsZW1l
        bnQuY2hpbGROb2Rlc1tpZHhdOwogICAgZm91bmQgPSBub2RlLm5vZGVUeXBl
        ID09PSAxICYmIGZpbmRDaGlsZEJ5SWQobm9kZSwgaWQpOwogICAgaWYgKGZv
        dW5kKSB7IHJldHVybiBmb3VuZDsgfQogIH0KfTsKCnZhciBzZXRJbm5lckhU
        TUxXaXRob3V0Rml4ID0gZnVuY3Rpb24oZWxlbWVudCwgaHRtbCkgewogIGlm
        IChuZWVkc1NoeSkgewogICAgaHRtbCA9ICcmc2h5OycgKyBodG1sOwogIH0K
        CiAgdmFyIG1hdGNoZXMgPSBbXTsKICBpZiAobW92ZXNXaGl0ZXNwYWNlKSB7
        CiAgICAvLyBSaWdodCBub3cgd2Ugb25seSBjaGVjayBmb3Igc2NyaXB0IHRh
        Z3Mgd2l0aCBpZHMgd2l0aCB0aGUKICAgIC8vIGdvYWwgb2YgdGFyZ2V0aW5n
        IG1vcnBocy4KICAgIGh0bWwgPSBodG1sLnJlcGxhY2UoLyhccyspKDxzY3Jp
        cHQgaWQ9JyhbXiddKyknKS9nLCBmdW5jdGlvbihtYXRjaCwgc3BhY2VzLCB0
        YWcsIGlkKSB7CiAgICAgIG1hdGNoZXMucHVzaChbaWQsIHNwYWNlc10pOwog
        ICAgICByZXR1cm4gdGFnOwogICAgfSk7CiAgfQoKICBlbGVtZW50LmlubmVy
        SFRNTCA9IGh0bWw7CgogIC8vIElmIHdlIGhhdmUgdG8gZG8gYW55IHdoaXRl
        c3BhY2UgYWRqdXN0bWVudHMgZG8gdGhlbSBub3cKICBpZiAobWF0Y2hlcy5s
        ZW5ndGggPiAwKSB7CiAgICB2YXIgbGVuID0gbWF0Y2hlcy5sZW5ndGgsIGlk
        eDsKICAgIGZvciAoaWR4PTA7IGlkeDxsZW47IGlkeCsrKSB7CiAgICAgIHZh
        ciBzY3JpcHQgPSBmaW5kQ2hpbGRCeUlkKGVsZW1lbnQsIG1hdGNoZXNbaWR4
        XVswXSksCiAgICAgICAgICBub2RlID0gZG9jdW1lbnQuY3JlYXRlVGV4dE5v
        ZGUobWF0Y2hlc1tpZHhdWzFdKTsKICAgICAgc2NyaXB0LnBhcmVudE5vZGUu
        aW5zZXJ0QmVmb3JlKG5vZGUsIHNjcmlwdCk7CiAgICB9CiAgfQoKICBpZiAo
        bmVlZHNTaHkpIHsKICAgIHZhciBzaHlFbGVtZW50ID0gZWxlbWVudC5maXJz
        dENoaWxkOwogICAgd2hpbGUgKHNoeUVsZW1lbnQubm9kZVR5cGUgPT09IDEg
        JiYgIXNoeUVsZW1lbnQubm9kZU5hbWUpIHsKICAgICAgc2h5RWxlbWVudCA9
        IHNoeUVsZW1lbnQuZmlyc3RDaGlsZDsKICAgIH0KICAgIGlmIChzaHlFbGVt
        ZW50Lm5vZGVUeXBlID09PSAzICYmIHNoeUVsZW1lbnQubm9kZVZhbHVlLmNo
        YXJBdCgwKSA9PT0gIlx1MDBBRCIpIHsKICAgICAgc2h5RWxlbWVudC5ub2Rl
        VmFsdWUgPSBzaHlFbGVtZW50Lm5vZGVWYWx1ZS5zbGljZSgxKTsKICAgIH0K
        ICB9Cn07CgovKiBFTkQgTUVUQU1PUlBIIEhFTFBFUlMgKi8KCgp2YXIgaW5u
        ZXJIVE1MVGFncyA9IHt9Owp2YXIgY2FuU2V0SW5uZXJIVE1MID0gZnVuY3Rp
        b24odGFnTmFtZSkgewogIGlmIChpbm5lckhUTUxUYWdzW3RhZ05hbWVdICE9
        PSB1bmRlZmluZWQpIHsKICAgIHJldHVybiBpbm5lckhUTUxUYWdzW3RhZ05h
        bWVdOwogIH0KCiAgdmFyIGNhblNldCA9IHRydWU7CgogIC8vIElFIDggYW5k
        IGVhcmxpZXIgZG9uJ3QgYWxsb3cgdXMgdG8gZG8gaW5uZXJIVE1MIG9uIHNl
        bGVjdAogIGlmICh0YWdOYW1lLnRvTG93ZXJDYXNlKCkgPT09ICdzZWxlY3Qn
        KSB7CiAgICB2YXIgZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzZWxl
        Y3QnKTsKICAgIHNldElubmVySFRNTFdpdGhvdXRGaXgoZWwsICc8b3B0aW9u
        IHZhbHVlPSJ0ZXN0Ij5UZXN0PC9vcHRpb24+Jyk7CiAgICBjYW5TZXQgPSBl
        bC5vcHRpb25zLmxlbmd0aCA9PT0gMTsKICB9CgogIGlubmVySFRNTFRhZ3Nb
        dGFnTmFtZV0gPSBjYW5TZXQ7CgogIHJldHVybiBjYW5TZXQ7Cn07Cgp2YXIg
        c2V0SW5uZXJIVE1MID0gZnVuY3Rpb24oZWxlbWVudCwgaHRtbCkgewogIHZh
        ciB0YWdOYW1lID0gZWxlbWVudC50YWdOYW1lOwoKICBpZiAoY2FuU2V0SW5u
        ZXJIVE1MKHRhZ05hbWUpKSB7CiAgICBzZXRJbm5lckhUTUxXaXRob3V0Rml4
        KGVsZW1lbnQsIGh0bWwpOwogIH0gZWxzZSB7CiAgICAvLyBGaXJlZm94IHZl
        cnNpb25zIDwgMTEgZG8gbm90IGhhdmUgc3VwcG9ydCBmb3IgZWxlbWVudC5v
        dXRlckhUTUwuCiAgICB2YXIgb3V0ZXJIVE1MID0gZWxlbWVudC5vdXRlckhU
        TUwgfHwgbmV3IFhNTFNlcmlhbGl6ZXIoKS5zZXJpYWxpemVUb1N0cmluZyhl
        bGVtZW50KTsKICAgIEVtYmVyLmFzc2VydCgiQ2FuJ3Qgc2V0IGlubmVySFRN
        TCBvbiAiK2VsZW1lbnQudGFnTmFtZSsiIGluIHRoaXMgYnJvd3NlciIsIG91
        dGVySFRNTCk7CgogICAgdmFyIHN0YXJ0VGFnID0gb3V0ZXJIVE1MLm1hdGNo
        KG5ldyBSZWdFeHAoIjwiK3RhZ05hbWUrIihbXj5dKik+IiwgJ2knKSlbMF0s
        CiAgICAgICAgZW5kVGFnID0gJzwvJyt0YWdOYW1lKyc+JzsKCiAgICB2YXIg
        d3JhcHBlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwogICAg
        c2V0SW5uZXJIVE1MV2l0aG91dEZpeCh3cmFwcGVyLCBzdGFydFRhZyArIGh0
        bWwgKyBlbmRUYWcpOwogICAgZWxlbWVudCA9IHdyYXBwZXIuZmlyc3RDaGls
        ZDsKICAgIHdoaWxlIChlbGVtZW50LnRhZ05hbWUgIT09IHRhZ05hbWUpIHsK
        ICAgICAgZWxlbWVudCA9IGVsZW1lbnQubmV4dFNpYmxpbmc7CiAgICB9CiAg
        fQoKICByZXR1cm4gZWxlbWVudDsKfTsKCmZ1bmN0aW9uIGlzU2ltcGxlQ2xp
        Y2soZXZlbnQpIHsKICB2YXIgbW9kaWZpZXIgPSBldmVudC5zaGlmdEtleSB8
        fCBldmVudC5tZXRhS2V5IHx8IGV2ZW50LmFsdEtleSB8fCBldmVudC5jdHJs
        S2V5LAogICAgICBzZWNvbmRhcnlDbGljayA9IGV2ZW50LndoaWNoID4gMTsg
        Ly8gSUU5IG1heSByZXR1cm4gdW5kZWZpbmVkCgogIHJldHVybiAhbW9kaWZp
        ZXIgJiYgIXNlY29uZGFyeUNsaWNrOwp9CgpFbWJlci5WaWV3VXRpbHMgPSB7
        CiAgc2V0SW5uZXJIVE1MOiBzZXRJbm5lckhUTUwsCiAgaXNTaW1wbGVDbGlj
        azogaXNTaW1wbGVDbGljawp9OwoKfSkoKTsKCgoKKGZ1bmN0aW9uKCkgewov
        KioKQG1vZHVsZSBlbWJlcgpAc3VibW9kdWxlIGVtYmVyLXZpZXdzCiovCgp2
        YXIgZ2V0ID0gRW1iZXIuZ2V0LCBzZXQgPSBFbWJlci5zZXQ7Cgp2YXIgQ2xh
        c3NTZXQgPSBmdW5jdGlvbigpIHsKICB0aGlzLnNlZW4gPSB7fTsKICB0aGlz
        Lmxpc3QgPSBbXTsKfTsKCkNsYXNzU2V0LnByb3RvdHlwZSA9IHsKICBhZGQ6
        IGZ1bmN0aW9uKHN0cmluZykgewogICAgaWYgKHN0cmluZyBpbiB0aGlzLnNl
        ZW4pIHsgcmV0dXJuOyB9CiAgICB0aGlzLnNlZW5bc3RyaW5nXSA9IHRydWU7
        CgogICAgdGhpcy5saXN0LnB1c2goc3RyaW5nKTsKICB9LAoKICB0b0RPTTog
        ZnVuY3Rpb24oKSB7CiAgICByZXR1cm4gdGhpcy5saXN0LmpvaW4oIiAiKTsK
        ICB9Cn07Cgp2YXIgQkFEX1RBR19OQU1FX1RFU1RfUkVHRVhQID0gL1teYS16
        QS1aMC05XC1dLzsKdmFyIEJBRF9UQUdfTkFNRV9SRVBMQUNFX1JFR0VYUCA9
        IC9bXmEtekEtWjAtOVwtXS9nOwoKZnVuY3Rpb24gc3RyaXBUYWdOYW1lKHRh
        Z05hbWUpIHsKICBpZiAoIXRhZ05hbWUpIHsKICAgIHJldHVybiB0YWdOYW1l
        OwogIH0KCiAgaWYgKCFCQURfVEFHX05BTUVfVEVTVF9SRUdFWFAudGVzdCh0
        YWdOYW1lKSkgewogICAgcmV0dXJuIHRhZ05hbWU7CiAgfQoKICByZXR1cm4g
        dGFnTmFtZS5yZXBsYWNlKEJBRF9UQUdfTkFNRV9SRVBMQUNFX1JFR0VYUCwg
        JycpOwp9Cgp2YXIgQkFEX0NIQVJTX1JFR0VYUCA9IC8mKD8hXHcrOyl8Wzw+
        IidgXS9nOwp2YXIgUE9TU0lCTEVfQ0hBUlNfUkVHRVhQID0gL1smPD4iJ2Bd
        LzsKCmZ1bmN0aW9uIGVzY2FwZUF0dHJpYnV0ZSh2YWx1ZSkgewogIC8vIFN0
        b2xlbiBzaGFtZWxlc3NseSBmcm9tIEhhbmRsZWJhcnMKCiAgdmFyIGVzY2Fw
        ZSA9IHsKICAgICI8IjogIiZsdDsiLAogICAgIj4iOiAiJmd0OyIsCiAgICAn
        Iic6ICImcXVvdDsiLAogICAgIiciOiAiJiN4Mjc7IiwKICAgICJgIjogIiYj
        eDYwOyIKICB9OwoKICB2YXIgZXNjYXBlQ2hhciA9IGZ1bmN0aW9uKGNocikg
        ewogICAgcmV0dXJuIGVzY2FwZVtjaHJdIHx8ICImYW1wOyI7CiAgfTsKCiAg
        dmFyIHN0cmluZyA9IHZhbHVlLnRvU3RyaW5nKCk7CgogIGlmKCFQT1NTSUJM
        RV9DSEFSU19SRUdFWFAudGVzdChzdHJpbmcpKSB7IHJldHVybiBzdHJpbmc7
        IH0KICByZXR1cm4gc3RyaW5nLnJlcGxhY2UoQkFEX0NIQVJTX1JFR0VYUCwg
        ZXNjYXBlQ2hhcik7Cn0KCi8vIElFIDYvNyBoYXZlIGJ1Z3MgYXJvbmQgc2V0
        dGluZyBuYW1lcyBvbiBpbnB1dHMgZHVyaW5nIGNyZWF0aW9uLgovLyBGcm9t
        IGh0dHA6Ly9tc2RuLm1pY3Jvc29mdC5jb20vZW4tdXMvbGlicmFyeS9pZS9t
        czUzNjM4OSh2PXZzLjg1KS5hc3B4OgovLyAiVG8gaW5jbHVkZSB0aGUgTkFN
        RSBhdHRyaWJ1dGUgYXQgcnVuIHRpbWUgb24gb2JqZWN0cyBjcmVhdGVkIHdp
        dGggdGhlIGNyZWF0ZUVsZW1lbnQgbWV0aG9kLCB1c2UgdGhlIGVUYWcuIgp2
        YXIgY2FuU2V0TmFtZU9uSW5wdXRzID0gKGZ1bmN0aW9uKCkgewogIHZhciBk
        aXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKSwKICAgICAgZWwg
        PSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcpOwoKICBlbC5zZXRB
        dHRyaWJ1dGUoJ25hbWUnLCAnZm9vJyk7CiAgZGl2LmFwcGVuZENoaWxkKGVs
        KTsKCiAgcmV0dXJuICEhZGl2LmlubmVySFRNTC5tYXRjaCgnZm9vJyk7Cn0p
        KCk7CgovKioKICBgRW1iZXIuUmVuZGVyQnVmZmVyYCBnYXRoZXJzIGluZm9y
        bWF0aW9uIHJlZ2FyZGluZyB0aGUgYSB2aWV3IGFuZCBnZW5lcmF0ZXMgdGhl
        CiAgZmluYWwgcmVwcmVzZW50YXRpb24uIGBFbWJlci5SZW5kZXJCdWZmZXJg
        IHdpbGwgZ2VuZXJhdGUgSFRNTCB3aGljaCBjYW4gYmUgcHVzaGVkCiAgdG8g
        dGhlIERPTS4KCiAgIGBgYGphdmFzY3JpcHQKICAgdmFyIGJ1ZmZlciA9IEVt
        YmVyLlJlbmRlckJ1ZmZlcignZGl2Jyk7CiAgYGBgCgogIEBjbGFzcyBSZW5k
        ZXJCdWZmZXIKICBAbmFtZXNwYWNlIEVtYmVyCiAgQGNvbnN0cnVjdG9yCiAg
        QHBhcmFtIHtTdHJpbmd9IHRhZ05hbWUgdGFnIG5hbWUgKHN1Y2ggYXMgJ2Rp
        dicgb3IgJ3AnKSB1c2VkIGZvciB0aGUgYnVmZmVyCiovCkVtYmVyLlJlbmRl
        ckJ1ZmZlciA9IGZ1bmN0aW9uKHRhZ05hbWUpIHsKICByZXR1cm4gbmV3IEVt
        YmVyLl9SZW5kZXJCdWZmZXIodGFnTmFtZSk7Cn07CgpFbWJlci5fUmVuZGVy
        QnVmZmVyID0gZnVuY3Rpb24odGFnTmFtZSkgewogIHRoaXMudGFnTmFtZXMg
        PSBbdGFnTmFtZSB8fCBudWxsXTsKICB0aGlzLmJ1ZmZlciA9ICIiOwp9OwoK
        RW1iZXIuX1JlbmRlckJ1ZmZlci5wcm90b3R5cGUgPQovKiogQHNjb3BlIEVt
        YmVyLlJlbmRlckJ1ZmZlci5wcm90b3R5cGUgKi8gewoKICAvLyBUaGUgcm9v
        dCB2aWV3J3MgZWxlbWVudAogIF9lbGVtZW50OiBudWxsLAoKICBfaGFzRWxl
        bWVudDogdHJ1ZSwKCiAgLyoqCiAgICBAcHJpdmF0ZQoKICAgIEFuIGludGVy
        bmFsIHNldCB1c2VkIHRvIGRlLWR1cGUgY2xhc3MgbmFtZXMgd2hlbiBgYWRk
        Q2xhc3MoKWAgaXMKICAgIHVzZWQuIEFmdGVyIGVhY2ggY2FsbCB0byBgYWRk
        Q2xhc3MoKWAsIHRoZSBgY2xhc3Nlc2AgcHJvcGVydHkKICAgIHdpbGwgYmUg
        dXBkYXRlZC4KCiAgICBAcHJvcGVydHkgZWxlbWVudENsYXNzZXMKICAgIEB0
        eXBlIEFycmF5CiAgICBAZGVmYXVsdCBbXQogICovCiAgZWxlbWVudENsYXNz
        ZXM6IG51bGwsCgogIC8qKgogICAgQXJyYXkgb2YgY2xhc3MgbmFtZXMgd2hp
        Y2ggd2lsbCBiZSBhcHBsaWVkIGluIHRoZSBjbGFzcyBhdHRyaWJ1dGUuCgog
        ICAgWW91IGNhbiB1c2UgYHNldENsYXNzZXMoKWAgdG8gc2V0IHRoaXMgcHJv
        cGVydHkgZGlyZWN0bHkuIElmIHlvdQogICAgdXNlIGBhZGRDbGFzcygpYCwg
        aXQgd2lsbCBiZSBtYWludGFpbmVkIGZvciB5b3UuCgogICAgQHByb3BlcnR5
        IGNsYXNzZXMKICAgIEB0eXBlIEFycmF5CiAgICBAZGVmYXVsdCBbXQogICov
        CiAgY2xhc3NlczogbnVsbCwKCiAgLyoqCiAgICBUaGUgaWQgaW4gb2YgdGhl
        IGVsZW1lbnQsIHRvIGJlIGFwcGxpZWQgaW4gdGhlIGlkIGF0dHJpYnV0ZS4K
        CiAgICBZb3Ugc2hvdWxkIG5vdCBzZXQgdGhpcyBwcm9wZXJ0eSB5b3Vyc2Vs
        ZiwgcmF0aGVyLCB5b3Ugc2hvdWxkIHVzZQogICAgdGhlIGBpZCgpYCBtZXRo
        b2Qgb2YgYEVtYmVyLlJlbmRlckJ1ZmZlcmAuCgogICAgQHByb3BlcnR5IGVs
        ZW1lbnRJZAogICAgQHR5cGUgU3RyaW5nCiAgICBAZGVmYXVsdCBudWxsCiAg
        Ki8KICBlbGVtZW50SWQ6IG51bGwsCgogIC8qKgogICAgQSBoYXNoIGtleWVk
        IG9uIHRoZSBuYW1lIG9mIHRoZSBhdHRyaWJ1dGUgYW5kIHdob3NlIHZhbHVl
        IHdpbGwgYmUKICAgIGFwcGxpZWQgdG8gdGhhdCBhdHRyaWJ1dGUuIEZvciBl
        eGFtcGxlLCBpZiB5b3Ugd2FudGVkIHRvIGFwcGx5IGEKICAgIGBkYXRhLXZp
        ZXc9IkZvby5iYXIiYCBwcm9wZXJ0eSB0byBhbiBlbGVtZW50LCB5b3Ugd291
        bGQgc2V0IHRoZQogICAgZWxlbWVudEF0dHJpYnV0ZXMgaGFzaCB0byBgeydk
        YXRhLXZpZXcnOidGb28uYmFyJ31gLgoKICAgIFlvdSBzaG91bGQgbm90IG1h
        aW50YWluIHRoaXMgaGFzaCB5b3Vyc2VsZiwgcmF0aGVyLCB5b3Ugc2hvdWxk
        IHVzZQogICAgdGhlIGBhdHRyKClgIG1ldGhvZCBvZiBgRW1iZXIuUmVuZGVy
        QnVmZmVyYC4KCiAgICBAcHJvcGVydHkgZWxlbWVudEF0dHJpYnV0ZXMKICAg
        IEB0eXBlIEhhc2gKICAgIEBkZWZhdWx0IHt9CiAgKi8KICBlbGVtZW50QXR0
        cmlidXRlczogbnVsbCwKCiAgLyoqCiAgICBBIGhhc2gga2V5ZWQgb24gdGhl
        IG5hbWUgb2YgdGhlIHByb3BlcnRpZXMgYW5kIHdob3NlIHZhbHVlIHdpbGwg
        YmUKICAgIGFwcGxpZWQgdG8gdGhhdCBwcm9wZXJ0eS4gRm9yIGV4YW1wbGUs
        IGlmIHlvdSB3YW50ZWQgdG8gYXBwbHkgYQogICAgYGNoZWNrZWQ9dHJ1ZWAg
        cHJvcGVydHkgdG8gYW4gZWxlbWVudCwgeW91IHdvdWxkIHNldCB0aGUKICAg
        IGVsZW1lbnRQcm9wZXJ0aWVzIGhhc2ggdG8gYHsnY2hlY2tlZCc6dHJ1ZX1g
        LgoKICAgIFlvdSBzaG91bGQgbm90IG1haW50YWluIHRoaXMgaGFzaCB5b3Vy
        c2VsZiwgcmF0aGVyLCB5b3Ugc2hvdWxkIHVzZQogICAgdGhlIGBwcm9wKClg
        IG1ldGhvZCBvZiBgRW1iZXIuUmVuZGVyQnVmZmVyYC4KCiAgICBAcHJvcGVy
        dHkgZWxlbWVudFByb3BlcnRpZXMKICAgIEB0eXBlIEhhc2gKICAgIEBkZWZh
        dWx0IHt9CiAgKi8KICBlbGVtZW50UHJvcGVydGllczogbnVsbCwKCiAgLyoq
        CiAgICBUaGUgdGFnbmFtZSBvZiB0aGUgZWxlbWVudCBhbiBpbnN0YW5jZSBv
        ZiBgRW1iZXIuUmVuZGVyQnVmZmVyYCByZXByZXNlbnRzLgoKICAgIFVzdWFs
        bHksIHRoaXMgZ2V0cyBzZXQgYXMgdGhlIGZpcnN0IHBhcmFtZXRlciB0byBg
        RW1iZXIuUmVuZGVyQnVmZmVyYC4gRm9yCiAgICBleGFtcGxlLCBpZiB5b3Ug
        d2FudGVkIHRvIGNyZWF0ZSBhIGBwYCB0YWcsIHRoZW4geW91IHdvdWxkIGNh
        bGwKCiAgICBgYGBqYXZhc2NyaXB0CiAgICBFbWJlci5SZW5kZXJCdWZmZXIo
        J3AnKQogICAgYGBgCgogICAgQHByb3BlcnR5IGVsZW1lbnRUYWcKICAgIEB0
        eXBlIFN0cmluZwogICAgQGRlZmF1bHQgbnVsbAogICovCiAgZWxlbWVudFRh
        ZzogbnVsbCwKCiAgLyoqCiAgICBBIGhhc2gga2V5ZWQgb24gdGhlIG5hbWUg
        b2YgdGhlIHN0eWxlIGF0dHJpYnV0ZSBhbmQgd2hvc2UgdmFsdWUgd2lsbAog
        ICAgYmUgYXBwbGllZCB0byB0aGF0IGF0dHJpYnV0ZS4gRm9yIGV4YW1wbGUs
        IGlmIHlvdSB3YW50ZWQgdG8gYXBwbHkgYQogICAgYGJhY2tncm91bmQtY29s
        b3I6YmxhY2s7YCBzdHlsZSB0byBhbiBlbGVtZW50LCB5b3Ugd291bGQgc2V0
        IHRoZQogICAgZWxlbWVudFN0eWxlIGhhc2ggdG8gYHsnYmFja2dyb3VuZC1j
        b2xvcic6J2JsYWNrJ31gLgoKICAgIFlvdSBzaG91bGQgbm90IG1haW50YWlu
        IHRoaXMgaGFzaCB5b3Vyc2VsZiwgcmF0aGVyLCB5b3Ugc2hvdWxkIHVzZQog
        ICAgdGhlIGBzdHlsZSgpYCBtZXRob2Qgb2YgYEVtYmVyLlJlbmRlckJ1ZmZl
        cmAuCgogICAgQHByb3BlcnR5IGVsZW1lbnRTdHlsZQogICAgQHR5cGUgSGFz
        aAogICAgQGRlZmF1bHQge30KICAqLwogIGVsZW1lbnRTdHlsZTogbnVsbCwK
        CiAgLyoqCiAgICBOZXN0ZWQgYFJlbmRlckJ1ZmZlcnNgIHdpbGwgc2V0IHRo
        aXMgdG8gdGhlaXIgcGFyZW50IGBSZW5kZXJCdWZmZXJgCiAgICBpbnN0YW5j
        ZS4KCiAgICBAcHJvcGVydHkgcGFyZW50QnVmZmVyCiAgICBAdHlwZSBFbWJl
        ci5fUmVuZGVyQnVmZmVyCiAgKi8KICBwYXJlbnRCdWZmZXI6IG51bGwsCgog
        IC8qKgogICAgQWRkcyBhIHN0cmluZyBvZiBIVE1MIHRvIHRoZSBgUmVuZGVy
        QnVmZmVyYC4KCiAgICBAbWV0aG9kIHB1c2gKICAgIEBwYXJhbSB7U3RyaW5n
        fSBzdHJpbmcgSFRNTCB0byBwdXNoIGludG8gdGhlIGJ1ZmZlcgogICAgQGNo
        YWluYWJsZQogICovCiAgcHVzaDogZnVuY3Rpb24oc3RyaW5nKSB7CiAgICB0
        aGlzLmJ1ZmZlciArPSBzdHJpbmc7CiAgICByZXR1cm4gdGhpczsKICB9LAoK
        ICAvKioKICAgIEFkZHMgYSBjbGFzcyB0byB0aGUgYnVmZmVyLCB3aGljaCB3
        aWxsIGJlIHJlbmRlcmVkIHRvIHRoZSBjbGFzcyBhdHRyaWJ1dGUuCgogICAg
        QG1ldGhvZCBhZGRDbGFzcwogICAgQHBhcmFtIHtTdHJpbmd9IGNsYXNzTmFt
        ZSBDbGFzcyBuYW1lIHRvIGFkZCB0byB0aGUgYnVmZmVyCiAgICBAY2hhaW5h
        YmxlCiAgKi8KICBhZGRDbGFzczogZnVuY3Rpb24oY2xhc3NOYW1lKSB7CiAg
        ICAvLyBsYXppbHkgY3JlYXRlIGVsZW1lbnRDbGFzc2VzCiAgICB0aGlzLmVs
        ZW1lbnRDbGFzc2VzID0gKHRoaXMuZWxlbWVudENsYXNzZXMgfHwgbmV3IENs
        YXNzU2V0KCkpOwogICAgdGhpcy5lbGVtZW50Q2xhc3Nlcy5hZGQoY2xhc3NO
        YW1lKTsKICAgIHRoaXMuY2xhc3NlcyA9IHRoaXMuZWxlbWVudENsYXNzZXMu
        bGlzdDsKCiAgICByZXR1cm4gdGhpczsKICB9LAoKICBzZXRDbGFzc2VzOiBm
        dW5jdGlvbihjbGFzc05hbWVzKSB7CiAgICB0aGlzLmNsYXNzZXMgPSBjbGFz
        c05hbWVzOwogIH0sCgogIC8qKgogICAgU2V0cyB0aGUgZWxlbWVudElEIHRv
        IGJlIHVzZWQgZm9yIHRoZSBlbGVtZW50LgoKICAgIEBtZXRob2QgaWQKICAg
        IEBwYXJhbSB7U3RyaW5nfSBpZAogICAgQGNoYWluYWJsZQogICovCiAgaWQ6
        IGZ1bmN0aW9uKGlkKSB7CiAgICB0aGlzLmVsZW1lbnRJZCA9IGlkOwogICAg
        cmV0dXJuIHRoaXM7CiAgfSwKCiAgLy8gZHVjayB0eXBlIGF0dHJpYnV0ZSBm
        dW5jdGlvbmFsaXR5IGxpa2UgalF1ZXJ5IHNvIGEgcmVuZGVyIGJ1ZmZlcgog
        IC8vIGNhbiBiZSB1c2VkIGxpa2UgYSBqUXVlcnkgb2JqZWN0IGluIGF0dHJp
        YnV0ZSBiaW5kaW5nIHNjZW5hcmlvcy4KCiAgLyoqCiAgICBBZGRzIGFuIGF0
        dHJpYnV0ZSB3aGljaCB3aWxsIGJlIHJlbmRlcmVkIHRvIHRoZSBlbGVtZW50
        LgoKICAgIEBtZXRob2QgYXR0cgogICAgQHBhcmFtIHtTdHJpbmd9IG5hbWUg
        VGhlIG5hbWUgb2YgdGhlIGF0dHJpYnV0ZQogICAgQHBhcmFtIHtTdHJpbmd9
        IHZhbHVlIFRoZSB2YWx1ZSB0byBhZGQgdG8gdGhlIGF0dHJpYnV0ZQogICAg
        QGNoYWluYWJsZQogICAgQHJldHVybiB7RW1iZXIuUmVuZGVyQnVmZmVyfFN0
        cmluZ30gdGhpcyBvciB0aGUgY3VycmVudCBhdHRyaWJ1dGUgdmFsdWUKICAq
        LwogIGF0dHI6IGZ1bmN0aW9uKG5hbWUsIHZhbHVlKSB7CiAgICB2YXIgYXR0
        cmlidXRlcyA9IHRoaXMuZWxlbWVudEF0dHJpYnV0ZXMgPSAodGhpcy5lbGVt
        ZW50QXR0cmlidXRlcyB8fCB7fSk7CgogICAgaWYgKGFyZ3VtZW50cy5sZW5n
        dGggPT09IDEpIHsKICAgICAgcmV0dXJuIGF0dHJpYnV0ZXNbbmFtZV07CiAg
        ICB9IGVsc2UgewogICAgICBhdHRyaWJ1dGVzW25hbWVdID0gdmFsdWU7CiAg
        ICB9CgogICAgcmV0dXJuIHRoaXM7CiAgfSwKCiAgLyoqCiAgICBSZW1vdmUg
        YW4gYXR0cmlidXRlIGZyb20gdGhlIGxpc3Qgb2YgYXR0cmlidXRlcyB0byBy
        ZW5kZXIuCgogICAgQG1ldGhvZCByZW1vdmVBdHRyCiAgICBAcGFyYW0ge1N0
        cmluZ30gbmFtZSBUaGUgbmFtZSBvZiB0aGUgYXR0cmlidXRlCiAgICBAY2hh
        aW5hYmxlCiAgKi8KICByZW1vdmVBdHRyOiBmdW5jdGlvbihuYW1lKSB7CiAg
        ICB2YXIgYXR0cmlidXRlcyA9IHRoaXMuZWxlbWVudEF0dHJpYnV0ZXM7CiAg
        ICBpZiAoYXR0cmlidXRlcykgeyBkZWxldGUgYXR0cmlidXRlc1tuYW1lXTsg
        fQoKICAgIHJldHVybiB0aGlzOwogIH0sCgogIC8qKgogICAgQWRkcyBhbiBw
        cm9wZXJ0eSB3aGljaCB3aWxsIGJlIHJlbmRlcmVkIHRvIHRoZSBlbGVtZW50
        LgoKICAgIEBtZXRob2QgcHJvcAogICAgQHBhcmFtIHtTdHJpbmd9IG5hbWUg
        VGhlIG5hbWUgb2YgdGhlIHByb3BlcnR5CiAgICBAcGFyYW0ge1N0cmluZ30g
        dmFsdWUgVGhlIHZhbHVlIHRvIGFkZCB0byB0aGUgcHJvcGVydHkKICAgIEBj
        aGFpbmFibGUKICAgIEByZXR1cm4ge0VtYmVyLlJlbmRlckJ1ZmZlcnxTdHJp
        bmd9IHRoaXMgb3IgdGhlIGN1cnJlbnQgcHJvcGVydHkgdmFsdWUKICAqLwog
        IHByb3A6IGZ1bmN0aW9uKG5hbWUsIHZhbHVlKSB7CiAgICB2YXIgcHJvcGVy
        dGllcyA9IHRoaXMuZWxlbWVudFByb3BlcnRpZXMgPSAodGhpcy5lbGVtZW50
        UHJvcGVydGllcyB8fCB7fSk7CgogICAgaWYgKGFyZ3VtZW50cy5sZW5ndGgg
        PT09IDEpIHsKICAgICAgcmV0dXJuIHByb3BlcnRpZXNbbmFtZV07CiAgICB9
        IGVsc2UgewogICAgICBwcm9wZXJ0aWVzW25hbWVdID0gdmFsdWU7CiAgICB9
        CgogICAgcmV0dXJuIHRoaXM7CiAgfSwKCiAgLyoqCiAgICBSZW1vdmUgYW4g
        cHJvcGVydHkgZnJvbSB0aGUgbGlzdCBvZiBwcm9wZXJ0aWVzIHRvIHJlbmRl
        ci4KCiAgICBAbWV0aG9kIHJlbW92ZVByb3AKICAgIEBwYXJhbSB7U3RyaW5n
        fSBuYW1lIFRoZSBuYW1lIG9mIHRoZSBwcm9wZXJ0eQogICAgQGNoYWluYWJs
        ZQogICovCiAgcmVtb3ZlUHJvcDogZnVuY3Rpb24obmFtZSkgewogICAgdmFy
        IHByb3BlcnRpZXMgPSB0aGlzLmVsZW1lbnRQcm9wZXJ0aWVzOwogICAgaWYg
        KHByb3BlcnRpZXMpIHsgZGVsZXRlIHByb3BlcnRpZXNbbmFtZV07IH0KCiAg
        ICByZXR1cm4gdGhpczsKICB9LAoKICAvKioKICAgIEFkZHMgYSBzdHlsZSB0
        byB0aGUgc3R5bGUgYXR0cmlidXRlIHdoaWNoIHdpbGwgYmUgcmVuZGVyZWQg
        dG8gdGhlIGVsZW1lbnQuCgogICAgQG1ldGhvZCBzdHlsZQogICAgQHBhcmFt
        IHtTdHJpbmd9IG5hbWUgTmFtZSBvZiB0aGUgc3R5bGUKICAgIEBwYXJhbSB7
        U3RyaW5nfSB2YWx1ZQogICAgQGNoYWluYWJsZQogICovCiAgc3R5bGU6IGZ1
        bmN0aW9uKG5hbWUsIHZhbHVlKSB7CiAgICB0aGlzLmVsZW1lbnRTdHlsZSA9
        ICh0aGlzLmVsZW1lbnRTdHlsZSB8fCB7fSk7CgogICAgdGhpcy5lbGVtZW50
        U3R5bGVbbmFtZV0gPSB2YWx1ZTsKICAgIHJldHVybiB0aGlzOwogIH0sCgog
        IGJlZ2luOiBmdW5jdGlvbih0YWdOYW1lKSB7CiAgICB0aGlzLnRhZ05hbWVz
        LnB1c2godGFnTmFtZSB8fCBudWxsKTsKICAgIHJldHVybiB0aGlzOwogIH0s
        CgogIHB1c2hPcGVuaW5nVGFnOiBmdW5jdGlvbigpIHsKICAgIHZhciB0YWdO
        YW1lID0gdGhpcy5jdXJyZW50VGFnTmFtZSgpOwogICAgaWYgKCF0YWdOYW1l
        KSB7IHJldHVybjsgfQoKICAgIGlmICh0aGlzLl9oYXNFbGVtZW50ICYmICF0
        aGlzLl9lbGVtZW50ICYmIHRoaXMuYnVmZmVyLmxlbmd0aCA9PT0gMCkgewog
        ICAgICB0aGlzLl9lbGVtZW50ID0gdGhpcy5nZW5lcmF0ZUVsZW1lbnQoKTsK
        ICAgICAgcmV0dXJuOwogICAgfQoKICAgIHZhciBidWZmZXIgPSB0aGlzLmJ1
        ZmZlciwKICAgICAgICBpZCA9IHRoaXMuZWxlbWVudElkLAogICAgICAgIGNs
        YXNzZXMgPSB0aGlzLmNsYXNzZXMsCiAgICAgICAgYXR0cnMgPSB0aGlzLmVs
        ZW1lbnRBdHRyaWJ1dGVzLAogICAgICAgIHByb3BzID0gdGhpcy5lbGVtZW50
        UHJvcGVydGllcywKICAgICAgICBzdHlsZSA9IHRoaXMuZWxlbWVudFN0eWxl
        LAogICAgICAgIGF0dHIsIHByb3A7CgogICAgYnVmZmVyICs9ICc8JyArIHN0
        cmlwVGFnTmFtZSh0YWdOYW1lKTsKCiAgICBpZiAoaWQpIHsKICAgICAgYnVm
        ZmVyICs9ICcgaWQ9IicgKyBlc2NhcGVBdHRyaWJ1dGUoaWQpICsgJyInOwog
        ICAgICB0aGlzLmVsZW1lbnRJZCA9IG51bGw7CiAgICB9CiAgICBpZiAoY2xh
        c3NlcykgewogICAgICBidWZmZXIgKz0gJyBjbGFzcz0iJyArIGVzY2FwZUF0
        dHJpYnV0ZShjbGFzc2VzLmpvaW4oJyAnKSkgKyAnIic7CiAgICAgIHRoaXMu
        Y2xhc3NlcyA9IG51bGw7CiAgICB9CgogICAgaWYgKHN0eWxlKSB7CiAgICAg
        IGJ1ZmZlciArPSAnIHN0eWxlPSInOwoKICAgICAgZm9yIChwcm9wIGluIHN0
        eWxlKSB7CiAgICAgICAgaWYgKHN0eWxlLmhhc093blByb3BlcnR5KHByb3Ap
        KSB7CiAgICAgICAgICBidWZmZXIgKz0gcHJvcCArICc6JyArIGVzY2FwZUF0
        dHJpYnV0ZShzdHlsZVtwcm9wXSkgKyAnOyc7CiAgICAgICAgfQogICAgICB9
        CgogICAgICBidWZmZXIgKz0gJyInOwoKICAgICAgdGhpcy5lbGVtZW50U3R5
        bGUgPSBudWxsOwogICAgfQoKICAgIGlmIChhdHRycykgewogICAgICBmb3Ig
        KGF0dHIgaW4gYXR0cnMpIHsKICAgICAgICBpZiAoYXR0cnMuaGFzT3duUHJv
        cGVydHkoYXR0cikpIHsKICAgICAgICAgIGJ1ZmZlciArPSAnICcgKyBhdHRy
        ICsgJz0iJyArIGVzY2FwZUF0dHJpYnV0ZShhdHRyc1thdHRyXSkgKyAnIic7
        CiAgICAgICAgfQogICAgICB9CgogICAgICB0aGlzLmVsZW1lbnRBdHRyaWJ1
        dGVzID0gbnVsbDsKICAgIH0KCiAgICBpZiAocHJvcHMpIHsKICAgICAgZm9y
        IChwcm9wIGluIHByb3BzKSB7CiAgICAgICAgaWYgKHByb3BzLmhhc093blBy
        b3BlcnR5KHByb3ApKSB7CiAgICAgICAgICB2YXIgdmFsdWUgPSBwcm9wc1tw
        cm9wXTsKICAgICAgICAgIGlmICh2YWx1ZSB8fCB0eXBlb2YodmFsdWUpID09
        PSAnbnVtYmVyJykgewogICAgICAgICAgICBpZiAodmFsdWUgPT09IHRydWUp
        IHsKICAgICAgICAgICAgICBidWZmZXIgKz0gJyAnICsgcHJvcCArICc9Iicg
        KyBwcm9wICsgJyInOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAg
        ICAgIGJ1ZmZlciArPSAnICcgKyBwcm9wICsgJz0iJyArIGVzY2FwZUF0dHJp
        YnV0ZShwcm9wc1twcm9wXSkgKyAnIic7CiAgICAgICAgICAgIH0KICAgICAg
        ICAgIH0KICAgICAgICB9CiAgICAgIH0KCiAgICAgIHRoaXMuZWxlbWVudFBy
        b3BlcnRpZXMgPSBudWxsOwogICAgfQoKICAgIGJ1ZmZlciArPSAnPic7CiAg
        ICB0aGlzLmJ1ZmZlciA9IGJ1ZmZlcjsKICB9LAoKICBwdXNoQ2xvc2luZ1Rh
        ZzogZnVuY3Rpb24oKSB7CiAgICB2YXIgdGFnTmFtZSA9IHRoaXMudGFnTmFt
        ZXMucG9wKCk7CiAgICBpZiAodGFnTmFtZSkgeyB0aGlzLmJ1ZmZlciArPSAn
        PC8nICsgc3RyaXBUYWdOYW1lKHRhZ05hbWUpICsgJz4nOyB9CiAgfSwKCiAg
        Y3VycmVudFRhZ05hbWU6IGZ1bmN0aW9uKCkgewogICAgcmV0dXJuIHRoaXMu
        dGFnTmFtZXNbdGhpcy50YWdOYW1lcy5sZW5ndGgtMV07CiAgfSwKCiAgZ2Vu
        ZXJhdGVFbGVtZW50OiBmdW5jdGlvbigpIHsKICAgIHZhciB0YWdOYW1lID0g
        dGhpcy50YWdOYW1lcy5wb3AoKSwgLy8gcG9wIHNpbmNlIHdlIGRvbid0IG5l
        ZWQgdG8gY2xvc2UKICAgICAgICBpZCA9IHRoaXMuZWxlbWVudElkLAogICAg
        ICAgIGNsYXNzZXMgPSB0aGlzLmNsYXNzZXMsCiAgICAgICAgYXR0cnMgPSB0
        aGlzLmVsZW1lbnRBdHRyaWJ1dGVzLAogICAgICAgIHByb3BzID0gdGhpcy5l
        bGVtZW50UHJvcGVydGllcywKICAgICAgICBzdHlsZSA9IHRoaXMuZWxlbWVu
        dFN0eWxlLAogICAgICAgIHN0eWxlQnVmZmVyID0gJycsIGF0dHIsIHByb3As
        IHRhZ1N0cmluZzsKCiAgICBpZiAoYXR0cnMgJiYgYXR0cnMubmFtZSAmJiAh
        Y2FuU2V0TmFtZU9uSW5wdXRzKSB7CiAgICAgIC8vIElFIGFsbG93cyBwYXNz
        aW5nIGEgdGFnIHRvIGNyZWF0ZUVsZW1lbnQuIFNlZSBub3RlIG9uIGBjYW5T
        ZXROYW1lT25JbnB1dHNgIGFib3ZlIGFzIHdlbGwuCiAgICAgIHRhZ1N0cmlu
        ZyA9ICc8JytzdHJpcFRhZ05hbWUodGFnTmFtZSkrJyBuYW1lPSInK2VzY2Fw
        ZUF0dHJpYnV0ZShhdHRycy5uYW1lKSsnIj4nOwogICAgfSBlbHNlIHsKICAg
        ICAgdGFnU3RyaW5nID0gdGFnTmFtZTsKICAgIH0KCiAgICB2YXIgZWxlbWVu
        dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQodGFnU3RyaW5nKSwKICAgICAg
        ICAkZWxlbWVudCA9IEVtYmVyLiQoZWxlbWVudCk7CgogICAgaWYgKGlkKSB7
        CiAgICAgICRlbGVtZW50LmF0dHIoJ2lkJywgaWQpOwogICAgICB0aGlzLmVs
        ZW1lbnRJZCA9IG51bGw7CiAgICB9CiAgICBpZiAoY2xhc3NlcykgewogICAg
        ICAkZWxlbWVudC5hdHRyKCdjbGFzcycsIGNsYXNzZXMuam9pbignICcpKTsK
        ICAgICAgdGhpcy5jbGFzc2VzID0gbnVsbDsKICAgIH0KCiAgICBpZiAoc3R5
        bGUpIHsKICAgICAgZm9yIChwcm9wIGluIHN0eWxlKSB7CiAgICAgICAgaWYg
        KHN0eWxlLmhhc093blByb3BlcnR5KHByb3ApKSB7CiAgICAgICAgICBzdHls
        ZUJ1ZmZlciArPSAocHJvcCArICc6JyArIHN0eWxlW3Byb3BdICsgJzsnKTsK
        ICAgICAgICB9CiAgICAgIH0KCiAgICAgICRlbGVtZW50LmF0dHIoJ3N0eWxl
        Jywgc3R5bGVCdWZmZXIpOwoKICAgICAgdGhpcy5lbGVtZW50U3R5bGUgPSBu
        dWxsOwogICAgfQoKICAgIGlmIChhdHRycykgewogICAgICBmb3IgKGF0dHIg
        aW4gYXR0cnMpIHsKICAgICAgICBpZiAoYXR0cnMuaGFzT3duUHJvcGVydHko
        YXR0cikpIHsKICAgICAgICAgICRlbGVtZW50LmF0dHIoYXR0ciwgYXR0cnNb
        YXR0cl0pOwogICAgICAgIH0KICAgICAgfQoKICAgICAgdGhpcy5lbGVtZW50
        QXR0cmlidXRlcyA9IG51bGw7CiAgICB9CgogICAgaWYgKHByb3BzKSB7CiAg
        ICAgIGZvciAocHJvcCBpbiBwcm9wcykgewogICAgICAgIGlmIChwcm9wcy5o
        YXNPd25Qcm9wZXJ0eShwcm9wKSkgewogICAgICAgICAgJGVsZW1lbnQucHJv
        cChwcm9wLCBwcm9wc1twcm9wXSk7CiAgICAgICAgfQogICAgICB9CgogICAg
        ICB0aGlzLmVsZW1lbnRQcm9wZXJ0aWVzID0gbnVsbDsKICAgIH0KCiAgICBy
        ZXR1cm4gZWxlbWVudDsKICB9LAoKICAvKioKICAgIEBtZXRob2QgZWxlbWVu
        dAogICAgQHJldHVybiB7RE9NRWxlbWVudH0gVGhlIGVsZW1lbnQgY29ycmVz
        cG9uZGluZyB0byB0aGUgZ2VuZXJhdGVkIEhUTUwKICAgICAgb2YgdGhpcyBi
        dWZmZXIKICAqLwogIGVsZW1lbnQ6IGZ1bmN0aW9uKCkgewogICAgdmFyIGh0
        bWwgPSB0aGlzLmlubmVyU3RyaW5nKCk7CgogICAgaWYgKGh0bWwpIHsKICAg
        ICAgdGhpcy5fZWxlbWVudCA9IEVtYmVyLlZpZXdVdGlscy5zZXRJbm5lckhU
        TUwodGhpcy5fZWxlbWVudCwgaHRtbCk7CiAgICB9CgogICAgcmV0dXJuIHRo
        aXMuX2VsZW1lbnQ7CiAgfSwKCiAgLyoqCiAgICBHZW5lcmF0ZXMgdGhlIEhU
        TUwgY29udGVudCBmb3IgdGhpcyBidWZmZXIuCgogICAgQG1ldGhvZCBzdHJp
        bmcKICAgIEByZXR1cm4ge1N0cmluZ30gVGhlIGdlbmVyYXRlZCBIVE1MCiAg
        Ki8KICBzdHJpbmc6IGZ1bmN0aW9uKCkgewogICAgaWYgKHRoaXMuX2hhc0Vs
        ZW1lbnQgJiYgdGhpcy5fZWxlbWVudCkgewogICAgICAvLyBGaXJlZm94IHZl
        cnNpb25zIDwgMTEgZG8gbm90IGhhdmUgc3VwcG9ydCBmb3IgZWxlbWVudC5v
        dXRlckhUTUwuCiAgICAgIHZhciB0aGlzRWxlbWVudCA9IHRoaXMuZWxlbWVu
        dCgpLCBvdXRlckhUTUwgPSB0aGlzRWxlbWVudC5vdXRlckhUTUw7CiAgICAg
        IGlmICh0eXBlb2Ygb3V0ZXJIVE1MID09PSAndW5kZWZpbmVkJykgewogICAg
        ICAgIHJldHVybiBFbWJlci4kKCc8ZGl2Lz4nKS5hcHBlbmQodGhpc0VsZW1l
        bnQpLmh0bWwoKTsKICAgICAgfQogICAgICByZXR1cm4gb3V0ZXJIVE1MOwog
        ICAgfSBlbHNlIHsKICAgICAgcmV0dXJuIHRoaXMuaW5uZXJTdHJpbmcoKTsK
        ICAgIH0KICB9LAoKICBpbm5lclN0cmluZzogZnVuY3Rpb24oKSB7CiAgICBy
        ZXR1cm4gdGhpcy5idWZmZXI7CiAgfQp9OwoKfSkoKTsKCgoKKGZ1bmN0aW9u
        KCkgewovKioKQG1vZHVsZSBlbWJlcgpAc3VibW9kdWxlIGVtYmVyLXZpZXdz
        CiovCgp2YXIgZ2V0ID0gRW1iZXIuZ2V0LCBzZXQgPSBFbWJlci5zZXQsIGZt
        dCA9IEVtYmVyLlN0cmluZy5mbXQ7CgovKioKICBgRW1iZXIuRXZlbnREaXNw
        YXRjaGVyYCBoYW5kbGVzIGRlbGVnYXRpbmcgYnJvd3NlciBldmVudHMgdG8g
        dGhlaXIKICBjb3JyZXNwb25kaW5nIGBFbWJlci5WaWV3cy5gIEZvciBleGFt
        cGxlLCB3aGVuIHlvdSBjbGljayBvbiBhIHZpZXcsCiAgYEVtYmVyLkV2ZW50
        RGlzcGF0Y2hlcmAgZW5zdXJlcyB0aGF0IHRoYXQgdmlldydzIGBtb3VzZURv
        d25gIG1ldGhvZCBnZXRzCiAgY2FsbGVkLgoKICBAY2xhc3MgRXZlbnREaXNw
        YXRjaGVyCiAgQG5hbWVzcGFjZSBFbWJlcgogIEBwcml2YXRlCiAgQGV4dGVu
        ZHMgRW1iZXIuT2JqZWN0CiovCkVtYmVyLkV2ZW50RGlzcGF0Y2hlciA9IEVt
        YmVyLk9iamVjdC5leHRlbmQoLyoqIEBzY29wZSBFbWJlci5FdmVudERpc3Bh
        dGNoZXIucHJvdG90eXBlICovewoKICAvKioKICAgIFRoZSBzZXQgb2YgZXZl
        bnRzIG5hbWVzIChhbmQgYXNzb2NpYXRlZCBoYW5kbGVyIGZ1bmN0aW9uIG5h
        bWVzKSB0byBiZSBzZXR1cAogICAgYW5kIGRpc3BhdGNoZWQgYnkgdGhlIGBF
        dmVudERpc3BhdGNoZXJgLiBDdXN0b20gZXZlbnRzIGNhbiBhZGRlZCB0byB0
        aGlzIGxpc3QgYXQgc2V0dXAKICAgIHRpbWUsIGdlbmVyYWxseSB2aWEgdGhl
        IGBFbWJlci5BcHBsaWNhdGlvbi5jdXN0b21FdmVudHNgIGhhc2guIE9ubHkg
        b3ZlcnJpZGUgdGhpcwogICAgZGVmYXVsdCBzZXQgdG8gcHJldmVudCB0aGUg
        RXZlbnREaXNwYXRjaGVyIGZyb20gbGlzdGVuaW5nIG9uIHNvbWUgZXZlbnRz
        IGFsbCB0b2dldGhlci4KCiAgICBUaGlzIHNldCB3aWxsIGJlIG1vZGlmaWVk
        IGJ5IGBzZXR1cGAgdG8gYWxzbyBpbmNsdWRlIGFueSBldmVudHMgYWRkZWQg
        YXQgdGhhdCB0aW1lLgoKICAgIEBwcm9wZXJ0eSBldmVudHMKICAgIEB0eXBl
        IE9iamVjdAogICovCiAgZXZlbnRzOiB7CiAgICB0b3VjaHN0YXJ0ICA6ICd0
        b3VjaFN0YXJ0JywKICAgIHRvdWNobW92ZSAgIDogJ3RvdWNoTW92ZScsCiAg
        ICB0b3VjaGVuZCAgICA6ICd0b3VjaEVuZCcsCiAgICB0b3VjaGNhbmNlbCA6
        ICd0b3VjaENhbmNlbCcsCiAgICBrZXlkb3duICAgICA6ICdrZXlEb3duJywK
        ICAgIGtleXVwICAgICAgIDogJ2tleVVwJywKICAgIGtleXByZXNzICAgIDog
        J2tleVByZXNzJywKICAgIG1vdXNlZG93biAgIDogJ21vdXNlRG93bicsCiAg
        ICBtb3VzZXVwICAgICA6ICdtb3VzZVVwJywKICAgIGNvbnRleHRtZW51IDog
        J2NvbnRleHRNZW51JywKICAgIGNsaWNrICAgICAgIDogJ2NsaWNrJywKICAg
        IGRibGNsaWNrICAgIDogJ2RvdWJsZUNsaWNrJywKICAgIG1vdXNlbW92ZSAg
        IDogJ21vdXNlTW92ZScsCiAgICBmb2N1c2luICAgICA6ICdmb2N1c0luJywK
        ICAgIGZvY3Vzb3V0ICAgIDogJ2ZvY3VzT3V0JywKICAgIG1vdXNlZW50ZXIg
        IDogJ21vdXNlRW50ZXInLAogICAgbW91c2VsZWF2ZSAgOiAnbW91c2VMZWF2
        ZScsCiAgICBzdWJtaXQgICAgICA6ICdzdWJtaXQnLAogICAgaW5wdXQgICAg
        ICAgOiAnaW5wdXQnLAogICAgY2hhbmdlICAgICAgOiAnY2hhbmdlJywKICAg
        IGRyYWdzdGFydCAgIDogJ2RyYWdTdGFydCcsCiAgICBkcmFnICAgICAgICA6
        ICdkcmFnJywKICAgIGRyYWdlbnRlciAgIDogJ2RyYWdFbnRlcicsCiAgICBk
        cmFnbGVhdmUgICA6ICdkcmFnTGVhdmUnLAogICAgZHJhZ292ZXIgICAgOiAn
        ZHJhZ092ZXInLAogICAgZHJvcCAgICAgICAgOiAnZHJvcCcsCiAgICBkcmFn
        ZW5kICAgICA6ICdkcmFnRW5kJwogIH0sCgogIC8qKgogICAgQHByaXZhdGUK
        CiAgICBUaGUgcm9vdCBET00gZWxlbWVudCB0byB3aGljaCBldmVudCBsaXN0
        ZW5lcnMgc2hvdWxkIGJlIGF0dGFjaGVkLiBFdmVudAogICAgbGlzdGVuZXJz
        IHdpbGwgYmUgYXR0YWNoZWQgdG8gdGhlIGRvY3VtZW50IHVubGVzcyB0aGlz
        IGlzIG92ZXJyaWRkZW4uCgogICAgQ2FuIGJlIHNwZWNpZmllZCBhcyBhIERP
        TUVsZW1lbnQgb3IgYSBzZWxlY3RvciBzdHJpbmcuCgogICAgVGhlIGRlZmF1
        bHQgYm9keSBpcyBhIHN0cmluZyBzaW5jZSB0aGlzIG1heSBiZSBldmFsdWF0
        ZWQgYmVmb3JlIGRvY3VtZW50LmJvZHkKICAgIGV4aXN0cyBpbiB0aGUgRE9N
        LgoKICAgIEBwcm9wZXJ0eSByb290RWxlbWVudAogICAgQHR5cGUgRE9NRWxl
        bWVudAogICAgQGRlZmF1bHQgJ2JvZHknCiAgKi8KICByb290RWxlbWVudDog
        J2JvZHknLAoKICAvKioKICAgIEBwcml2YXRlCgogICAgU2V0cyB1cCBldmVu
        dCBsaXN0ZW5lcnMgZm9yIHN0YW5kYXJkIGJyb3dzZXIgZXZlbnRzLgoKICAg
        IFRoaXMgd2lsbCBiZSBjYWxsZWQgYWZ0ZXIgdGhlIGJyb3dzZXIgc2VuZHMg
        YSBgRE9NQ29udGVudFJlYWR5YCBldmVudC4gQnkKICAgIGRlZmF1bHQsIGl0
        IHdpbGwgc2V0IHVwIGFsbCBvZiB0aGUgbGlzdGVuZXJzIG9uIHRoZSBkb2N1
        bWVudCBib2R5LiBJZiB5b3UKICAgIHdvdWxkIGxpa2UgdG8gcmVnaXN0ZXIg
        dGhlIGxpc3RlbmVycyBvbiBhIGRpZmZlcmVudCBlbGVtZW50LCBzZXQgdGhl
        IGV2ZW50CiAgICBkaXNwYXRjaGVyJ3MgYHJvb3RgIHByb3BlcnR5LgoKICAg
        IEBtZXRob2Qgc2V0dXAKICAgIEBwYXJhbSBhZGRlZEV2ZW50cyB7SGFzaH0K
        ICAqLwogIHNldHVwOiBmdW5jdGlvbihhZGRlZEV2ZW50cywgcm9vdEVsZW1l
        bnQpIHsKICAgIHZhciBldmVudCwgZXZlbnRzID0gZ2V0KHRoaXMsICdldmVu
        dHMnKTsKCiAgICBFbWJlci4kLmV4dGVuZChldmVudHMsIGFkZGVkRXZlbnRz
        IHx8IHt9KTsKCgogICAgaWYgKCFFbWJlci5pc05vbmUocm9vdEVsZW1lbnQp
        KSB7CiAgICAgIHNldCh0aGlzLCAncm9vdEVsZW1lbnQnLCByb290RWxlbWVu
        dCk7CiAgICB9CgogICAgcm9vdEVsZW1lbnQgPSBFbWJlci4kKGdldCh0aGlz
        LCAncm9vdEVsZW1lbnQnKSk7CgogICAgRW1iZXIuYXNzZXJ0KGZtdCgnWW91
        IGNhbm5vdCB1c2UgdGhlIHNhbWUgcm9vdCBlbGVtZW50ICglQCkgbXVsdGlw
        bGUgdGltZXMgaW4gYW4gRW1iZXIuQXBwbGljYXRpb24nLCBbcm9vdEVsZW1l
        bnQuc2VsZWN0b3IgfHwgcm9vdEVsZW1lbnRbMF0udGFnTmFtZV0pLCAhcm9v
        dEVsZW1lbnQuaXMoJy5lbWJlci1hcHBsaWNhdGlvbicpKTsKICAgIEVtYmVy
        LmFzc2VydCgnWW91IGNhbm5vdCBtYWtlIGEgbmV3IEVtYmVyLkFwcGxpY2F0
        aW9uIHVzaW5nIGEgcm9vdCBlbGVtZW50IHRoYXQgaXMgYSBkZXNjZW5kZW50
        IG9mIGFuIGV4aXN0aW5nIEVtYmVyLkFwcGxpY2F0aW9uJywgIXJvb3RFbGVt
        ZW50LmNsb3Nlc3QoJy5lbWJlci1hcHBsaWNhdGlvbicpLmxlbmd0aCk7CiAg
        ICBFbWJlci5hc3NlcnQoJ1lvdSBjYW5ub3QgbWFrZSBhIG5ldyBFbWJlci5B
        cHBsaWNhdGlvbiB1c2luZyBhIHJvb3QgZWxlbWVudCB0aGF0IGlzIGFuIGFu
        Y2VzdG9yIG9mIGFuIGV4aXN0aW5nIEVtYmVyLkFwcGxpY2F0aW9uJywgIXJv
        b3RFbGVtZW50LmZpbmQoJy5lbWJlci1hcHBsaWNhdGlvbicpLmxlbmd0aCk7
        CgogICAgcm9vdEVsZW1lbnQuYWRkQ2xhc3MoJ2VtYmVyLWFwcGxpY2F0aW9u
        Jyk7CgogICAgRW1iZXIuYXNzZXJ0KCdVbmFibGUgdG8gYWRkICJlbWJlci1h
        cHBsaWNhdGlvbiIgY2xhc3MgdG8gcm9vdEVsZW1lbnQuIE1ha2Ugc3VyZSB5
        b3Ugc2V0IHJvb3RFbGVtZW50IHRvIHRoZSBib2R5IG9yIGFuIGVsZW1lbnQg
        aW4gdGhlIGJvZHkuJywgcm9vdEVsZW1lbnQuaXMoJy5lbWJlci1hcHBsaWNh
        dGlvbicpKTsKCiAgICBmb3IgKGV2ZW50IGluIGV2ZW50cykgewogICAgICBp
        ZiAoZXZlbnRzLmhhc093blByb3BlcnR5KGV2ZW50KSkgewogICAgICAgIHRo
        aXMuc2V0dXBIYW5kbGVyKHJvb3RFbGVtZW50LCBldmVudCwgZXZlbnRzW2V2
        ZW50XSk7CiAgICAgIH0KICAgIH0KICB9LAoKICAvKioKICAgIEBwcml2YXRl
        CgogICAgUmVnaXN0ZXJzIGFuIGV2ZW50IGxpc3RlbmVyIG9uIHRoZSBkb2N1
        bWVudC4gSWYgdGhlIGdpdmVuIGV2ZW50IGlzCiAgICB0cmlnZ2VyZWQsIHRo
        ZSBwcm92aWRlZCBldmVudCBoYW5kbGVyIHdpbGwgYmUgdHJpZ2dlcmVkIG9u
        IHRoZSB0YXJnZXQgdmlldy4KCiAgICBJZiB0aGUgdGFyZ2V0IHZpZXcgZG9l
        cyBub3QgaW1wbGVtZW50IHRoZSBldmVudCBoYW5kbGVyLCBvciBpZiB0aGUg
        aGFuZGxlcgogICAgcmV0dXJucyBgZmFsc2VgLCB0aGUgcGFyZW50IHZpZXcg
        d2lsbCBiZSBjYWxsZWQuIFRoZSBldmVudCB3aWxsIGNvbnRpbnVlIHRvCiAg
        ICBidWJibGUgdG8gZWFjaCBzdWNjZXNzaXZlIHBhcmVudCB2aWV3IHVudGls
        IGl0IHJlYWNoZXMgdGhlIHRvcC4KCiAgICBGb3IgZXhhbXBsZSwgdG8gaGF2
        ZSB0aGUgYG1vdXNlRG93bmAgbWV0aG9kIGNhbGxlZCBvbiB0aGUgdGFyZ2V0
        IHZpZXcgd2hlbgogICAgYSBgbW91c2Vkb3duYCBldmVudCBpcyByZWNlaXZl
        ZCBmcm9tIHRoZSBicm93c2VyLCBkbyB0aGUgZm9sbG93aW5nOgoKICAgIGBg
        YGphdmFzY3JpcHQKICAgIHNldHVwSGFuZGxlcignbW91c2Vkb3duJywgJ21v
        dXNlRG93bicpOwogICAgYGBgCgogICAgQG1ldGhvZCBzZXR1cEhhbmRsZXIK
        ICAgIEBwYXJhbSB7RWxlbWVudH0gcm9vdEVsZW1lbnQKICAgIEBwYXJhbSB7
        U3RyaW5nfSBldmVudCB0aGUgYnJvd3Nlci1vcmlnaW5hdGVkIGV2ZW50IHRv
        IGxpc3RlbiB0bwogICAgQHBhcmFtIHtTdHJpbmd9IGV2ZW50TmFtZSB0aGUg
        bmFtZSBvZiB0aGUgbWV0aG9kIHRvIGNhbGwgb24gdGhlIHZpZXcKICAqLwog
        IHNldHVwSGFuZGxlcjogZnVuY3Rpb24ocm9vdEVsZW1lbnQsIGV2ZW50LCBl
        dmVudE5hbWUpIHsKICAgIHZhciBzZWxmID0gdGhpczsKCiAgICByb290RWxl
        bWVudC5vbihldmVudCArICcuZW1iZXInLCAnLmVtYmVyLXZpZXcnLCBmdW5j
        dGlvbihldnQsIHRyaWdnZXJpbmdNYW5hZ2VyKSB7CiAgICAgIHJldHVybiBF
        bWJlci5oYW5kbGVFcnJvcnMoZnVuY3Rpb24oKSB7CiAgICAgICAgdmFyIHZp
        ZXcgPSBFbWJlci5WaWV3LnZpZXdzW3RoaXMuaWRdLAogICAgICAgICAgICBy
        ZXN1bHQgPSB0cnVlLCBtYW5hZ2VyID0gbnVsbDsKCiAgICAgICAgbWFuYWdl
        ciA9IHNlbGYuX2ZpbmROZWFyZXN0RXZlbnRNYW5hZ2VyKHZpZXcsZXZlbnRO
        YW1lKTsKCiAgICAgICAgaWYgKG1hbmFnZXIgJiYgbWFuYWdlciAhPT0gdHJp
        Z2dlcmluZ01hbmFnZXIpIHsKICAgICAgICAgIHJlc3VsdCA9IHNlbGYuX2Rp
        c3BhdGNoRXZlbnQobWFuYWdlciwgZXZ0LCBldmVudE5hbWUsIHZpZXcpOwog
        ICAgICAgIH0gZWxzZSBpZiAodmlldykgewogICAgICAgICAgcmVzdWx0ID0g
        c2VsZi5fYnViYmxlRXZlbnQodmlldyxldnQsZXZlbnROYW1lKTsKICAgICAg
        ICB9IGVsc2UgewogICAgICAgICAgZXZ0LnN0b3BQcm9wYWdhdGlvbigpOwog
        ICAgICAgIH0KCiAgICAgICAgcmV0dXJuIHJlc3VsdDsKICAgICAgfSwgdGhp
        cyk7CiAgICB9KTsKCiAgICByb290RWxlbWVudC5vbihldmVudCArICcuZW1i
        ZXInLCAnW2RhdGEtZW1iZXItYWN0aW9uXScsIGZ1bmN0aW9uKGV2dCkgewog
        ICAgICByZXR1cm4gRW1iZXIuaGFuZGxlRXJyb3JzKGZ1bmN0aW9uKCkgewog
        ICAgICAgIHZhciBhY3Rpb25JZCA9IEVtYmVyLiQoZXZ0LmN1cnJlbnRUYXJn
        ZXQpLmF0dHIoJ2RhdGEtZW1iZXItYWN0aW9uJyksCiAgICAgICAgICAgIGFj
        dGlvbiAgID0gRW1iZXIuSGFuZGxlYmFycy5BY3Rpb25IZWxwZXIucmVnaXN0
        ZXJlZEFjdGlvbnNbYWN0aW9uSWRdOwoKICAgICAgICAvLyBXZSBoYXZlIHRv
        IGNoZWNrIGZvciBhY3Rpb24gaGVyZSBzaW5jZSBpbiBzb21lIGNhc2VzLCBq
        UXVlcnkgd2lsbCB0cmlnZ2VyCiAgICAgICAgLy8gYW4gZXZlbnQgb24gYHJl
        bW92ZUNoaWxkYCAoaS5lLiBmb2N1c291dCkgYWZ0ZXIgd2UndmUgYWxyZWFk
        eSB0b3JuIGRvd24gdGhlCiAgICAgICAgLy8gYWN0aW9uIGhhbmRsZXJzIGZv
        ciB0aGUgdmlldy4KICAgICAgICBpZiAoYWN0aW9uICYmIGFjdGlvbi5ldmVu
        dE5hbWUgPT09IGV2ZW50TmFtZSkgewogICAgICAgICAgcmV0dXJuIGFjdGlv
        bi5oYW5kbGVyKGV2dCk7CiAgICAgICAgfQogICAgICB9LCB0aGlzKTsKICAg
        IH0pOwogIH0sCgogIF9maW5kTmVhcmVzdEV2ZW50TWFuYWdlcjogZnVuY3Rp
        b24odmlldywgZXZlbnROYW1lKSB7CiAgICB2YXIgbWFuYWdlciA9IG51bGw7
        CgogICAgd2hpbGUgKHZpZXcpIHsKICAgICAgbWFuYWdlciA9IGdldCh2aWV3
        LCAnZXZlbnRNYW5hZ2VyJyk7CiAgICAgIGlmIChtYW5hZ2VyICYmIG1hbmFn
        ZXJbZXZlbnROYW1lXSkgeyBicmVhazsgfQoKICAgICAgdmlldyA9IGdldCh2
        aWV3LCAncGFyZW50VmlldycpOwogICAgfQoKICAgIHJldHVybiBtYW5hZ2Vy
        OwogIH0sCgogIF9kaXNwYXRjaEV2ZW50OiBmdW5jdGlvbihvYmplY3QsIGV2
        dCwgZXZlbnROYW1lLCB2aWV3KSB7CiAgICB2YXIgcmVzdWx0ID0gdHJ1ZTsK
        CiAgICB2YXIgaGFuZGxlciA9IG9iamVjdFtldmVudE5hbWVdOwogICAgaWYg
        KEVtYmVyLnR5cGVPZihoYW5kbGVyKSA9PT0gJ2Z1bmN0aW9uJykgewogICAg
        ICByZXN1bHQgPSBFbWJlci5ydW4oZnVuY3Rpb24oKSB7CiAgICAgICAgcmV0
        dXJuIGhhbmRsZXIuY2FsbChvYmplY3QsIGV2dCwgdmlldyk7CiAgICAgIH0p
        OwogICAgICAvLyBEbyBub3QgcHJldmVudERlZmF1bHQgaW4gZXZlbnRNYW5h
        Z2Vycy4KICAgICAgZXZ0LnN0b3BQcm9wYWdhdGlvbigpOwogICAgfQogICAg
        ZWxzZSB7CiAgICAgIHJlc3VsdCA9IHRoaXMuX2J1YmJsZUV2ZW50KHZpZXcs
        IGV2dCwgZXZlbnROYW1lKTsKICAgIH0KCiAgICByZXR1cm4gcmVzdWx0Owog
        IH0sCgogIF9idWJibGVFdmVudDogZnVuY3Rpb24odmlldywgZXZ0LCBldmVu
        dE5hbWUpIHsKICAgIHJldHVybiBFbWJlci5ydW4oZnVuY3Rpb24oKSB7CiAg
        ICAgIHJldHVybiB2aWV3LmhhbmRsZUV2ZW50KGV2ZW50TmFtZSwgZXZ0KTsK
        ICAgIH0pOwogIH0sCgogIGRlc3Ryb3k6IGZ1bmN0aW9uKCkgewogICAgdmFy
        IHJvb3RFbGVtZW50ID0gZ2V0KHRoaXMsICdyb290RWxlbWVudCcpOwogICAg
        RW1iZXIuJChyb290RWxlbWVudCkub2ZmKCcuZW1iZXInLCAnKionKS5yZW1v
        dmVDbGFzcygnZW1iZXItYXBwbGljYXRpb24nKTsKICAgIHJldHVybiB0aGlz
        Ll9zdXBlcigpOwogIH0KfSk7Cgp9KSgpOwoKCgooZnVuY3Rpb24oKSB7Ci8q
        KgpAbW9kdWxlIGVtYmVyCkBzdWJtb2R1bGUgZW1iZXItdmlld3MKKi8KCi8v
        IEFkZCBhIG5ldyBuYW1lZCBxdWV1ZSBmb3IgcmVuZGVyaW5nIHZpZXdzIHRo
        YXQgaGFwcGVucwovLyBhZnRlciBiaW5kaW5ncyBoYXZlIHN5bmNlZCwgYW5k
        IGEgcXVldWUgZm9yIHNjaGVkdWxpbmcgYWN0aW9ucwovLyB0aGF0IHRoYXQg
        c2hvdWxkIG9jY3VyIGFmdGVyIHZpZXcgcmVuZGVyaW5nLgp2YXIgcXVldWVz
        ID0gRW1iZXIucnVuLnF1ZXVlcywKICAgIGluZGV4T2YgPSBFbWJlci5BcnJh
        eVBvbHlmaWxscy5pbmRleE9mOwpxdWV1ZXMuc3BsaWNlKGluZGV4T2YuY2Fs
        bChxdWV1ZXMsICdhY3Rpb25zJykrMSwgMCwgJ3JlbmRlcicsICdhZnRlclJl
        bmRlcicpOwoKfSkoKTsKCgoKKGZ1bmN0aW9uKCkgewovKioKQG1vZHVsZSBl
        bWJlcgpAc3VibW9kdWxlIGVtYmVyLXZpZXdzCiovCgp2YXIgZ2V0ID0gRW1i
        ZXIuZ2V0LCBzZXQgPSBFbWJlci5zZXQ7CgovLyBPcmlnaW5hbCBjbGFzcyBk
        ZWNsYXJhdGlvbiBhbmQgZG9jdW1lbnRhdGlvbiBpbiBydW50aW1lL2xpYi9j
        b250cm9sbGVycy9jb250cm9sbGVyLmpzCi8vIE5PVEU6IEl0IG1heSBiZSBw
        b3NzaWJsZSB3aXRoIFlVSURvYyB0byBjb21iaW5lIGRvY3MgaW4gdHdvIGxv
        Y2F0aW9ucwoKLyoqCkFkZGl0aW9uYWwgbWV0aG9kcyBmb3IgdGhlIENvbnRy
        b2xsZXJNaXhpbgoKQGNsYXNzIENvbnRyb2xsZXJNaXhpbgpAbmFtZXNwYWNl
        IEVtYmVyCiovCkVtYmVyLkNvbnRyb2xsZXJNaXhpbi5yZW9wZW4oewogIHRh
        cmdldDogbnVsbCwKICBuYW1lc3BhY2U6IG51bGwsCiAgdmlldzogbnVsbCwK
        ICBjb250YWluZXI6IG51bGwsCiAgX2NoaWxkQ29udGFpbmVyczogbnVsbCwK
        CiAgaW5pdDogZnVuY3Rpb24oKSB7CiAgICB0aGlzLl9zdXBlcigpOwogICAg
        c2V0KHRoaXMsICdfY2hpbGRDb250YWluZXJzJywge30pOwogIH0sCgogIF9t
        b2RlbERpZENoYW5nZTogRW1iZXIub2JzZXJ2ZXIoZnVuY3Rpb24oKSB7CiAg
        ICB2YXIgY29udGFpbmVycyA9IGdldCh0aGlzLCAnX2NoaWxkQ29udGFpbmVy
        cycpOwoKICAgIGZvciAodmFyIHByb3AgaW4gY29udGFpbmVycykgewogICAg
        ICBpZiAoIWNvbnRhaW5lcnMuaGFzT3duUHJvcGVydHkocHJvcCkpIHsgY29u
        dGludWU7IH0KICAgICAgY29udGFpbmVyc1twcm9wXS5kZXN0cm95KCk7CiAg
        ICB9CgogICAgc2V0KHRoaXMsICdfY2hpbGRDb250YWluZXJzJywge30pOwog
        IH0sICdtb2RlbCcpCn0pOwoKfSkoKTsKCgoKKGZ1bmN0aW9uKCkgewoKfSko
        KTsKCgoKKGZ1bmN0aW9uKCkgewp2YXIgc3RhdGVzID0ge307CgovKioKQG1v
        ZHVsZSBlbWJlcgpAc3VibW9kdWxlIGVtYmVyLXZpZXdzCiovCgp2YXIgZ2V0
        ID0gRW1iZXIuZ2V0LCBzZXQgPSBFbWJlci5zZXQ7CnZhciBndWlkRm9yID0g
        RW1iZXIuZ3VpZEZvcjsKdmFyIGFfZm9yRWFjaCA9IEVtYmVyLkVudW1lcmFi
        bGVVdGlscy5mb3JFYWNoOwp2YXIgYV9hZGRPYmplY3QgPSBFbWJlci5FbnVt
        ZXJhYmxlVXRpbHMuYWRkT2JqZWN0Owp2YXIgbWV0YSA9IEVtYmVyLm1ldGE7
        Cgp2YXIgY2hpbGRWaWV3c1Byb3BlcnR5ID0gRW1iZXIuY29tcHV0ZWQoZnVu
        Y3Rpb24oKSB7CiAgdmFyIGNoaWxkVmlld3MgPSB0aGlzLl9jaGlsZFZpZXdz
        LCByZXQgPSBFbWJlci5BKCksIHZpZXcgPSB0aGlzOwoKICBhX2ZvckVhY2go
        Y2hpbGRWaWV3cywgZnVuY3Rpb24odmlldykgewogICAgdmFyIGN1cnJlbnRD
        aGlsZFZpZXdzOwogICAgaWYgKHZpZXcuaXNWaXJ0dWFsKSB7CiAgICAgIGlm
        IChjdXJyZW50Q2hpbGRWaWV3cyA9IGdldCh2aWV3LCAnY2hpbGRWaWV3cycp
        KSB7CiAgICAgICAgcmV0LnB1c2hPYmplY3RzKGN1cnJlbnRDaGlsZFZpZXdz
        KTsKICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgcmV0LnB1c2godmlldyk7
        CiAgICB9CiAgfSk7CgogIHJldC5yZXBsYWNlID0gZnVuY3Rpb24gKGlkeCwg
        cmVtb3ZlZENvdW50LCBhZGRlZFZpZXdzKSB7CiAgICBpZiAodmlldyBpbnN0
        YW5jZW9mIEVtYmVyLkNvbnRhaW5lclZpZXcpIHsKICAgICAgRW1iZXIuZGVw
        cmVjYXRlKCJNYW5pcHVsYXRpbmcgYW4gRW1iZXIuQ29udGFpbmVyVmlldyB0
        aHJvdWdoIGl0cyBjaGlsZFZpZXdzIHByb3BlcnR5IGlzIGRlcHJlY2F0ZWQu
        IFBsZWFzZSB1c2UgdGhlIENvbnRhaW5lclZpZXcgaW5zdGFuY2UgaXRzZWxm
        IGFzIGFuIEVtYmVyLk11dGFibGVBcnJheS4iKTsKICAgICAgcmV0dXJuIHZp
        ZXcucmVwbGFjZShpZHgsIHJlbW92ZWRDb3VudCwgYWRkZWRWaWV3cyk7CiAg
        ICB9CiAgICB0aHJvdyBuZXcgRW1iZXIuRXJyb3IoImNoaWxkVmlld3MgaXMg
        aW1tdXRhYmxlIik7CiAgfTsKCiAgcmV0dXJuIHJldDsKfSk7CgpFbWJlci53
        YXJuKCJUaGUgVklFV19QUkVTRVJWRVNfQ09OVEVYVCBmbGFnIGhhcyBiZWVu
        IHJlbW92ZWQgYW5kIHRoZSBmdW5jdGlvbmFsaXR5IGNhbiBubyBsb25nZXIg
        YmUgZGlzYWJsZWQuIiwgRW1iZXIuRU5WLlZJRVdfUFJFU0VSVkVTX0NPTlRF
        WFQgIT09IGZhbHNlKTsKCi8qKgogIEdsb2JhbCBoYXNoIG9mIHNoYXJlZCB0
        ZW1wbGF0ZXMuIFRoaXMgd2lsbCBhdXRvbWF0aWNhbGx5IGJlIHBvcHVsYXRl
        ZAogIGJ5IHRoZSBidWlsZCB0b29scyBzbyB0aGF0IHlvdSBjYW4gc3RvcmUg
        eW91ciBIYW5kbGViYXJzIHRlbXBsYXRlcyBpbgogIHNlcGFyYXRlIGZpbGVz
        IHRoYXQgZ2V0IGxvYWRlZCBpbnRvIEphdmFTY3JpcHQgYXQgYnVpbGR0aW1l
        LgoKICBAcHJvcGVydHkgVEVNUExBVEVTCiAgQGZvciBFbWJlcgogIEB0eXBl
        IEhhc2gKKi8KRW1iZXIuVEVNUExBVEVTID0ge307CgovKioKICBgRW1iZXIu
        Q29yZVZpZXdgIGlzIGFuIGFic3RyYWN0IGNsYXNzIHRoYXQgZXhpc3RzIHRv
        IGdpdmUgdmlldy1saWtlIGJlaGF2aW9yCiAgdG8gYm90aCBFbWJlcidzIG1h
        aW4gdmlldyBjbGFzcyBgRW1iZXIuVmlld2AgYW5kIG90aGVyIGNsYXNzZXMg
        bGlrZQogIGBFbWJlci5fU2ltcGxlTWV0YW1vcnBoVmlld2AgdGhhdCBkb24n
        dCBuZWVkIHRoZSBmdWxseSBmdW5jdGlvbmFsdGl5IG9mCiAgYEVtYmVyLlZp
        ZXdgLgoKICBVbmxlc3MgeW91IGhhdmUgc3BlY2lmaWMgbmVlZHMgZm9yIGBD
        b3JlVmlld2AsIHlvdSB3aWxsIHVzZSBgRW1iZXIuVmlld2AKICBpbiB5b3Vy
        IGFwcGxpY2F0aW9ucy4KCiAgQGNsYXNzIENvcmVWaWV3CiAgQG5hbWVzcGFj
        ZSBFbWJlcgogIEBleHRlbmRzIEVtYmVyLk9iamVjdAogIEB1c2VzIEVtYmVy
        LkV2ZW50ZWQKKi8KCkVtYmVyLkNvcmVWaWV3ID0gRW1iZXIuT2JqZWN0LmV4
        dGVuZChFbWJlci5FdmVudGVkLCBFbWJlci5BY3Rpb25IYW5kbGVyLCB7CiAg
        aXNWaWV3OiB0cnVlLAoKICBzdGF0ZXM6IHN0YXRlcywKCiAgaW5pdDogZnVu
        Y3Rpb24oKSB7CiAgICB0aGlzLl9zdXBlcigpOwogICAgdGhpcy50cmFuc2l0
        aW9uVG8oJ3ByZVJlbmRlcicpOwogIH0sCgogIC8qKgogICAgSWYgdGhlIHZp
        ZXcgaXMgY3VycmVudGx5IGluc2VydGVkIGludG8gdGhlIERPTSBvZiBhIHBh
        cmVudCB2aWV3LCB0aGlzCiAgICBwcm9wZXJ0eSB3aWxsIHBvaW50IHRvIHRo
        ZSBwYXJlbnQgb2YgdGhlIHZpZXcuCgogICAgQHByb3BlcnR5IHBhcmVudFZp
        ZXcKICAgIEB0eXBlIEVtYmVyLlZpZXcKICAgIEBkZWZhdWx0IG51bGwKICAq
        LwogIHBhcmVudFZpZXc6IEVtYmVyLmNvbXB1dGVkKGZ1bmN0aW9uKCkgewog
        ICAgdmFyIHBhcmVudCA9IHRoaXMuX3BhcmVudFZpZXc7CgogICAgaWYgKHBh
        cmVudCAmJiBwYXJlbnQuaXNWaXJ0dWFsKSB7CiAgICAgIHJldHVybiBnZXQo
        cGFyZW50LCAncGFyZW50VmlldycpOwogICAgfSBlbHNlIHsKICAgICAgcmV0
        dXJuIHBhcmVudDsKICAgIH0KICB9KS5wcm9wZXJ0eSgnX3BhcmVudFZpZXcn
        KSwKCiAgc3RhdGU6IG51bGwsCgogIF9wYXJlbnRWaWV3OiBudWxsLAoKICAv
        LyByZXR1cm4gdGhlIGN1cnJlbnQgdmlldywgbm90IGluY2x1ZGluZyB2aXJ0
        dWFsIHZpZXdzCiAgY29uY3JldGVWaWV3OiBFbWJlci5jb21wdXRlZChmdW5j
        dGlvbigpIHsKICAgIGlmICghdGhpcy5pc1ZpcnR1YWwpIHsgcmV0dXJuIHRo
        aXM7IH0KICAgIGVsc2UgeyByZXR1cm4gZ2V0KHRoaXMsICdwYXJlbnRWaWV3
        Jyk7IH0KICB9KS5wcm9wZXJ0eSgncGFyZW50VmlldycpLAoKICBpbnN0cnVt
        ZW50TmFtZTogJ2NvcmVfdmlldycsCgogIGluc3RydW1lbnREZXRhaWxzOiBm
        dW5jdGlvbihoYXNoKSB7CiAgICBoYXNoLm9iamVjdCA9IHRoaXMudG9TdHJp
        bmcoKTsKICB9LAoKICAvKioKICAgIEBwcml2YXRlCgogICAgSW52b2tlZCBi
        eSB0aGUgdmlldyBzeXN0ZW0gd2hlbiB0aGlzIHZpZXcgbmVlZHMgdG8gcHJv
        ZHVjZSBhbiBIVE1MCiAgICByZXByZXNlbnRhdGlvbi4gVGhpcyBtZXRob2Qg
        d2lsbCBjcmVhdGUgYSBuZXcgcmVuZGVyIGJ1ZmZlciwgaWYgbmVlZGVkLAog
        ICAgdGhlbiBhcHBseSBhbnkgZGVmYXVsdCBhdHRyaWJ1dGVzLCBzdWNoIGFz
        IGNsYXNzIG5hbWVzIGFuZCB2aXNpYmlsaXR5LgogICAgRmluYWxseSwgdGhl
        IGByZW5kZXIoKWAgbWV0aG9kIGlzIGludm9rZWQsIHdoaWNoIGlzIHJlc3Bv
        bnNpYmxlIGZvcgogICAgZG9pbmcgdGhlIGJ1bGsgb2YgdGhlIHJlbmRlcmlu
        Zy4KCiAgICBZb3Ugc2hvdWxkIG5vdCBuZWVkIHRvIG92ZXJyaWRlIHRoaXMg
        bWV0aG9kOyBpbnN0ZWFkLCBpbXBsZW1lbnQgdGhlCiAgICBgdGVtcGxhdGVg
        IHByb3BlcnR5LCBvciBpZiB5b3UgbmVlZCBtb3JlIGNvbnRyb2wsIG92ZXJy
        aWRlIHRoZSBgcmVuZGVyYAogICAgbWV0aG9kLgoKICAgIEBtZXRob2QgcmVu
        ZGVyVG9CdWZmZXIKICAgIEBwYXJhbSB7RW1iZXIuUmVuZGVyQnVmZmVyfSBi
        dWZmZXIgdGhlIHJlbmRlciBidWZmZXIuIElmIG5vIGJ1ZmZlciBpcwogICAg
        ICBwYXNzZWQsIGEgZGVmYXVsdCBidWZmZXIsIHVzaW5nIHRoZSBjdXJyZW50
        IHZpZXcncyBgdGFnTmFtZWAsIHdpbGwKICAgICAgYmUgdXNlZC4KICAqLwog
        IHJlbmRlclRvQnVmZmVyOiBmdW5jdGlvbihwYXJlbnRCdWZmZXIsIGJ1ZmZl
        ck9wZXJhdGlvbikgewogICAgdmFyIG5hbWUgPSAncmVuZGVyLicgKyB0aGlz
        Lmluc3RydW1lbnROYW1lLAogICAgICAgIGRldGFpbHMgPSB7fTsKCiAgICB0
        aGlzLmluc3RydW1lbnREZXRhaWxzKGRldGFpbHMpOwoKICAgIHJldHVybiBF
        bWJlci5pbnN0cnVtZW50KG5hbWUsIGRldGFpbHMsIGZ1bmN0aW9uKCkgewog
        ICAgICByZXR1cm4gdGhpcy5fcmVuZGVyVG9CdWZmZXIocGFyZW50QnVmZmVy
        LCBidWZmZXJPcGVyYXRpb24pOwogICAgfSwgdGhpcyk7CiAgfSwKCiAgX3Jl
        bmRlclRvQnVmZmVyOiBmdW5jdGlvbihwYXJlbnRCdWZmZXIsIGJ1ZmZlck9w
        ZXJhdGlvbikgewogICAgLy8gSWYgdGhpcyBpcyB0aGUgdG9wLW1vc3Qgdmll
        dywgc3RhcnQgYSBuZXcgYnVmZmVyLiBPdGhlcndpc2UsCiAgICAvLyBjcmVh
        dGUgYSBuZXcgYnVmZmVyIHJlbGF0aXZlIHRvIHRoZSBvcmlnaW5hbCB1c2lu
        ZyB0aGUKICAgIC8vIHByb3ZpZGVkIGJ1ZmZlciBvcGVyYXRpb24gKGZvciBl
        eGFtcGxlLCBgaW5zZXJ0QWZ0ZXJgIHdpbGwKICAgIC8vIGluc2VydCBhIG5l
        dyBidWZmZXIgYWZ0ZXIgdGhlICJwYXJlbnQgYnVmZmVyIikuCiAgICB2YXIg
        dGFnTmFtZSA9IHRoaXMudGFnTmFtZTsKCiAgICBpZiAodGFnTmFtZSA9PT0g
        bnVsbCB8fCB0YWdOYW1lID09PSB1bmRlZmluZWQpIHsKICAgICAgdGFnTmFt
        ZSA9ICdkaXYnOwogICAgfQoKICAgIHZhciBidWZmZXIgPSB0aGlzLmJ1ZmZl
        ciA9IHBhcmVudEJ1ZmZlciAmJiBwYXJlbnRCdWZmZXIuYmVnaW4odGFnTmFt
        ZSkgfHwgRW1iZXIuUmVuZGVyQnVmZmVyKHRhZ05hbWUpOwogICAgdGhpcy50
        cmFuc2l0aW9uVG8oJ2luQnVmZmVyJywgZmFsc2UpOwoKICAgIHRoaXMuYmVm
        b3JlUmVuZGVyKGJ1ZmZlcik7CiAgICB0aGlzLnJlbmRlcihidWZmZXIpOwog
        ICAgdGhpcy5hZnRlclJlbmRlcihidWZmZXIpOwoKICAgIHJldHVybiBidWZm
        ZXI7CiAgfSwKCiAgLyoqCiAgICBAcHJpdmF0ZQoKICAgIE92ZXJyaWRlIHRo
        ZSBkZWZhdWx0IGV2ZW50IGZpcmluZyBmcm9tIGBFbWJlci5FdmVudGVkYCB0
        bwogICAgYWxzbyBjYWxsIG1ldGhvZHMgd2l0aCB0aGUgZ2l2ZW4gbmFtZS4K
        CiAgICBAbWV0aG9kIHRyaWdnZXIKICAgIEBwYXJhbSBuYW1lIHtTdHJpbmd9
        CiAgKi8KICB0cmlnZ2VyOiBmdW5jdGlvbihuYW1lKSB7CiAgICB0aGlzLl9z
        dXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgdmFyIG1ldGhvZCA9
        IHRoaXNbbmFtZV07CiAgICBpZiAobWV0aG9kKSB7CiAgICAgIHZhciBhcmdz
        ID0gW10sIGksIGw7CiAgICAgIGZvciAoaSA9IDEsIGwgPSBhcmd1bWVudHMu
        bGVuZ3RoOyBpIDwgbDsgaSsrKSB7CiAgICAgICAgYXJncy5wdXNoKGFyZ3Vt
        ZW50c1tpXSk7CiAgICAgIH0KICAgICAgcmV0dXJuIG1ldGhvZC5hcHBseSh0
        aGlzLCBhcmdzKTsKICAgIH0KICB9LAoKICBkZXByZWNhdGVkU2VuZEhhbmRs
        ZXM6IGZ1bmN0aW9uKGFjdGlvbk5hbWUpIHsKICAgIHJldHVybiAhIXRoaXNb
        YWN0aW9uTmFtZV07CiAgfSwKCiAgZGVwcmVjYXRlZFNlbmQ6IGZ1bmN0aW9u
        KGFjdGlvbk5hbWUpIHsKICAgIHZhciBhcmdzID0gW10uc2xpY2UuY2FsbChh
        cmd1bWVudHMsIDEpOwogICAgRW1iZXIuYXNzZXJ0KCcnICsgdGhpcyArICIg
        aGFzIHRoZSBhY3Rpb24gIiArIGFjdGlvbk5hbWUgKyAiIGJ1dCBpdCBpcyBu
        b3QgYSBmdW5jdGlvbiIsIHR5cGVvZiB0aGlzW2FjdGlvbk5hbWVdID09PSAn
        ZnVuY3Rpb24nKTsKICAgIEVtYmVyLmRlcHJlY2F0ZSgnQWN0aW9uIGhhbmRs
        ZXJzIGltcGxlbWVudGVkIGRpcmVjdGx5IG9uIHZpZXdzIGFyZSBkZXByZWNh
        dGVkIGluIGZhdm9yIG9mIGFjdGlvbiBoYW5kbGVycyBvbiBhbiBgYWN0aW9u
        c2Agb2JqZWN0ICgnICsgYWN0aW9uTmFtZSArICcgb24gJyArIHRoaXMgKyAn
        KScsIGZhbHNlKTsKICAgIHRoaXNbYWN0aW9uTmFtZV0uYXBwbHkodGhpcywg
        YXJncyk7CiAgICByZXR1cm47CiAgfSwKCiAgaGFzOiBmdW5jdGlvbihuYW1l
        KSB7CiAgICByZXR1cm4gRW1iZXIudHlwZU9mKHRoaXNbbmFtZV0pID09PSAn
        ZnVuY3Rpb24nIHx8IHRoaXMuX3N1cGVyKG5hbWUpOwogIH0sCgogIGRlc3Ry
        b3k6IGZ1bmN0aW9uKCkgewogICAgdmFyIHBhcmVudCA9IHRoaXMuX3BhcmVu
        dFZpZXc7CgogICAgaWYgKCF0aGlzLl9zdXBlcigpKSB7IHJldHVybjsgfQoK
        ICAgIC8vIGRlc3Ryb3kgdGhlIGVsZW1lbnQgLS0gdGhpcyB3aWxsIGF2b2lk
        IGVhY2ggY2hpbGQgdmlldyBkZXN0cm95aW5nCiAgICAvLyB0aGUgZWxlbWVu
        dCBvdmVyIGFuZCBvdmVyIGFnYWluLi4uCiAgICBpZiAoIXRoaXMucmVtb3Zl
        ZEZyb21ET00pIHsgdGhpcy5kZXN0cm95RWxlbWVudCgpOyB9CgogICAgLy8g
        cmVtb3ZlIGZyb20gcGFyZW50IGlmIGZvdW5kLiBEb24ndCBjYWxsIHJlbW92
        ZUZyb21QYXJlbnQsCiAgICAvLyBhcyByZW1vdmVGcm9tUGFyZW50IHdpbGwg
        dHJ5IHRvIHJlbW92ZSB0aGUgZWxlbWVudCBmcm9tCiAgICAvLyB0aGUgRE9N
        IGFnYWluLgogICAgaWYgKHBhcmVudCkgeyBwYXJlbnQucmVtb3ZlQ2hpbGQo
        dGhpcyk7IH0KCiAgICB0aGlzLnRyYW5zaXRpb25UbygnZGVzdHJveWluZycs
        IGZhbHNlKTsKCiAgICByZXR1cm4gdGhpczsKICB9LAoKICBjbGVhclJlbmRl
        cmVkQ2hpbGRyZW46IEVtYmVyLkssCiAgdHJpZ2dlclJlY3Vyc2l2ZWx5OiBF
        bWJlci5LLAogIGludm9rZVJlY3Vyc2l2ZWx5OiBFbWJlci5LLAogIHRyYW5z
        aXRpb25UbzogRW1iZXIuSywKICBkZXN0cm95RWxlbWVudDogRW1iZXIuSwp9
        KTsKCnZhciBWaWV3Q29sbGVjdGlvbiA9IEVtYmVyLl9WaWV3Q29sbGVjdGlv
        biA9IGZ1bmN0aW9uKGluaXRpYWxWaWV3cykgewogIHZhciB2aWV3cyA9IHRo
        aXMudmlld3MgPSBpbml0aWFsVmlld3MgfHwgW107CiAgdGhpcy5sZW5ndGgg
        PSB2aWV3cy5sZW5ndGg7Cn07CgpWaWV3Q29sbGVjdGlvbi5wcm90b3R5cGUg
        PSB7CiAgbGVuZ3RoOiAwLAoKICB0cmlnZ2VyOiBmdW5jdGlvbihldmVudE5h
        bWUpIHsKICAgIHZhciB2aWV3cyA9IHRoaXMudmlld3MsIHZpZXc7CiAgICBm
        b3IgKHZhciBpID0gMCwgbCA9IHZpZXdzLmxlbmd0aDsgaSA8IGw7IGkrKykg
        ewogICAgICB2aWV3ID0gdmlld3NbaV07CiAgICAgIGlmICh2aWV3LnRyaWdn
        ZXIpIHsgdmlldy50cmlnZ2VyKGV2ZW50TmFtZSk7IH0KICAgIH0KICB9LAoK
        ICB0cmlnZ2VyUmVjdXJzaXZlbHk6IGZ1bmN0aW9uKGV2ZW50TmFtZSkgewog
        ICAgdmFyIHZpZXdzID0gdGhpcy52aWV3czsKICAgIGZvciAodmFyIGkgPSAw
        LCBsID0gdmlld3MubGVuZ3RoOyBpIDwgbDsgaSsrKSB7CiAgICAgIHZpZXdz
        W2ldLnRyaWdnZXJSZWN1cnNpdmVseShldmVudE5hbWUpOwogICAgfQogIH0s
        CgogIGludm9rZVJlY3Vyc2l2ZWx5OiBmdW5jdGlvbihmbikgewogICAgdmFy
        IHZpZXdzID0gdGhpcy52aWV3cywgdmlldzsKCiAgICBmb3IgKHZhciBpID0g
        MCwgbCA9IHZpZXdzLmxlbmd0aDsgaSA8IGw7IGkrKykgewogICAgICB2aWV3
        ID0gdmlld3NbaV07CiAgICAgIGZuKHZpZXcpOwogICAgfQogIH0sCgogIHRy
        YW5zaXRpb25UbzogZnVuY3Rpb24oc3RhdGUsIGNoaWxkcmVuKSB7CiAgICB2
        YXIgdmlld3MgPSB0aGlzLnZpZXdzOwogICAgZm9yICh2YXIgaSA9IDAsIGwg
        PSB2aWV3cy5sZW5ndGg7IGkgPCBsOyBpKyspIHsKICAgICAgdmlld3NbaV0u
        dHJhbnNpdGlvblRvKHN0YXRlLCBjaGlsZHJlbik7CiAgICB9CiAgfSwKCiAg
        cHVzaDogZnVuY3Rpb24oKSB7CiAgICB0aGlzLmxlbmd0aCArPSBhcmd1bWVu
        dHMubGVuZ3RoOwogICAgdmFyIHZpZXdzID0gdGhpcy52aWV3czsKICAgIHJl
        dHVybiB2aWV3cy5wdXNoLmFwcGx5KHZpZXdzLCBhcmd1bWVudHMpOwogIH0s
        CgogIG9iamVjdEF0OiBmdW5jdGlvbihpZHgpIHsKICAgIHJldHVybiB0aGlz
        LnZpZXdzW2lkeF07CiAgfSwKCiAgZm9yRWFjaDogZnVuY3Rpb24oY2FsbGJh
        Y2spIHsKICAgIHZhciB2aWV3cyA9IHRoaXMudmlld3M7CiAgICByZXR1cm4g
        YV9mb3JFYWNoKHZpZXdzLCBjYWxsYmFjayk7CiAgfSwKCiAgY2xlYXI6IGZ1
        bmN0aW9uKCkgewogICAgdGhpcy5sZW5ndGggPSAwOwogICAgdGhpcy52aWV3
        cy5sZW5ndGggPSAwOwogIH0KfTsKCnZhciBFTVBUWV9BUlJBWSA9IFtdOwoK
        LyoqCiAgYEVtYmVyLlZpZXdgIGlzIHRoZSBjbGFzcyBpbiBFbWJlciByZXNw
        b25zaWJsZSBmb3IgZW5jYXBzdWxhdGluZyB0ZW1wbGF0ZXMgb2YKICBIVE1M
        IGNvbnRlbnQsIGNvbWJpbmluZyB0ZW1wbGF0ZXMgd2l0aCBkYXRhIHRvIHJl
        bmRlciBhcyBzZWN0aW9ucyBvZiBhIHBhZ2UncwogIERPTSwgYW5kIHJlZ2lz
        dGVyaW5nIGFuZCByZXNwb25kaW5nIHRvIHVzZXItaW5pdGlhdGVkIGV2ZW50
        cy4KCiAgIyMgSFRNTCBUYWcKCiAgVGhlIGRlZmF1bHQgSFRNTCB0YWcgbmFt
        ZSB1c2VkIGZvciBhIHZpZXcncyBET00gcmVwcmVzZW50YXRpb24gaXMgYGRp
        dmAuIFRoaXMKICBjYW4gYmUgY3VzdG9taXplZCBieSBzZXR0aW5nIHRoZSBg
        dGFnTmFtZWAgcHJvcGVydHkuIFRoZSBmb2xsb3dpbmcgdmlldwogIGNsYXNz
        OgoKICBgYGBqYXZhc2NyaXB0CiAgUGFyYWdyYXBoVmlldyA9IEVtYmVyLlZp
        ZXcuZXh0ZW5kKHsKICAgIHRhZ05hbWU6ICdlbScKICB9KTsKICBgYGAKCiAg
        V291bGQgcmVzdWx0IGluIGluc3RhbmNlcyB3aXRoIHRoZSBmb2xsb3dpbmcg
        SFRNTDoKCiAgYGBgaHRtbAogIDxlbSBpZD0iZW1iZXIxIiBjbGFzcz0iZW1i
        ZXItdmlldyI+PC9lbT4KICBgYGAKCiAgIyMgSFRNTCBgY2xhc3NgIEF0dHJp
        YnV0ZQoKICBUaGUgSFRNTCBgY2xhc3NgIGF0dHJpYnV0ZSBvZiBhIHZpZXcn
        cyB0YWcgY2FuIGJlIHNldCBieSBwcm92aWRpbmcgYQogIGBjbGFzc05hbWVz
        YCBwcm9wZXJ0eSB0aGF0IGlzIHNldCB0byBhbiBhcnJheSBvZiBzdHJpbmdz
        OgoKICBgYGBqYXZhc2NyaXB0CiAgTXlWaWV3ID0gRW1iZXIuVmlldy5leHRl
        bmQoewogICAgY2xhc3NOYW1lczogWydteS1jbGFzcycsICdteS1vdGhlci1j
        bGFzcyddCiAgfSk7CiAgYGBgCgogIFdpbGwgcmVzdWx0IGluIHZpZXcgaW5z
        dGFuY2VzIHdpdGggYW4gSFRNTCByZXByZXNlbnRhdGlvbiBvZjoKCiAgYGBg
        aHRtbAogIDxkaXYgaWQ9ImVtYmVyMSIgY2xhc3M9ImVtYmVyLXZpZXcgbXkt
        Y2xhc3MgbXktb3RoZXItY2xhc3MiPjwvZGl2PgogIGBgYAoKICBgY2xhc3Ng
        IGF0dHJpYnV0ZSB2YWx1ZXMgY2FuIGFsc28gYmUgc2V0IGJ5IHByb3ZpZGlu
        ZyBhIGBjbGFzc05hbWVCaW5kaW5nc2AKICBwcm9wZXJ0eSBzZXQgdG8gYW4g
        YXJyYXkgb2YgcHJvcGVydGllcyBuYW1lcyBmb3IgdGhlIHZpZXcuIFRoZSBy
        ZXR1cm4gdmFsdWUKICBvZiB0aGVzZSBwcm9wZXJ0aWVzIHdpbGwgYmUgYWRk
        ZWQgYXMgcGFydCBvZiB0aGUgdmFsdWUgZm9yIHRoZSB2aWV3J3MgYGNsYXNz
        YAogIGF0dHJpYnV0ZS4gVGhlc2UgcHJvcGVydGllcyBjYW4gYmUgY29tcHV0
        ZWQgcHJvcGVydGllczoKCiAgYGBgamF2YXNjcmlwdAogIE15VmlldyA9IEVt
        YmVyLlZpZXcuZXh0ZW5kKHsKICAgIGNsYXNzTmFtZUJpbmRpbmdzOiBbJ3By
        b3BlcnR5QScsICdwcm9wZXJ0eUInXSwKICAgIHByb3BlcnR5QTogJ2Zyb20t
        YScsCiAgICBwcm9wZXJ0eUI6IGZ1bmN0aW9uKCkgewogICAgICBpZiAoc29t
        ZUxvZ2ljKSB7IHJldHVybiAnZnJvbS1iJzsgfQogICAgfS5wcm9wZXJ0eSgp
        CiAgfSk7CiAgYGBgCgogIFdpbGwgcmVzdWx0IGluIHZpZXcgaW5zdGFuY2Vz
        IHdpdGggYW4gSFRNTCByZXByZXNlbnRhdGlvbiBvZjoKCiAgYGBgaHRtbAog
        IDxkaXYgaWQ9ImVtYmVyMSIgY2xhc3M9ImVtYmVyLXZpZXcgZnJvbS1hIGZy
        b20tYiI+PC9kaXY+CiAgYGBgCgogIElmIHRoZSB2YWx1ZSBvZiBhIGNsYXNz
        IG5hbWUgYmluZGluZyByZXR1cm5zIGEgYm9vbGVhbiB0aGUgcHJvcGVydHkg
        bmFtZQogIGl0c2VsZiB3aWxsIGJlIHVzZWQgYXMgdGhlIGNsYXNzIG5hbWUg
        aWYgdGhlIHByb3BlcnR5IGlzIHRydWUuIFRoZSBjbGFzcyBuYW1lCiAgd2ls
        bCBub3QgYmUgYWRkZWQgaWYgdGhlIHZhbHVlIGlzIGBmYWxzZWAgb3IgYHVu
        ZGVmaW5lZGAuCgogIGBgYGphdmFzY3JpcHQKICBNeVZpZXcgPSBFbWJlci5W
        aWV3LmV4dGVuZCh7CiAgICBjbGFzc05hbWVCaW5kaW5nczogWydob3ZlcmVk
        J10sCiAgICBob3ZlcmVkOiB0cnVlCiAgfSk7CiAgYGBgCgogIFdpbGwgcmVz
        dWx0IGluIHZpZXcgaW5zdGFuY2VzIHdpdGggYW4gSFRNTCByZXByZXNlbnRh
        dGlvbiBvZjoKCiAgYGBgaHRtbAogIDxkaXYgaWQ9ImVtYmVyMSIgY2xhc3M9
        ImVtYmVyLXZpZXcgaG92ZXJlZCI+PC9kaXY+CiAgYGBgCgogIFdoZW4gdXNp
        bmcgYm9vbGVhbiBjbGFzcyBuYW1lIGJpbmRpbmdzIHlvdSBjYW4gc3VwcGx5
        IGEgc3RyaW5nIHZhbHVlIG90aGVyCiAgdGhhbiB0aGUgcHJvcGVydHkgbmFt
        ZSBmb3IgdXNlIGFzIHRoZSBgY2xhc3NgIEhUTUwgYXR0cmlidXRlIGJ5IGFw
        cGVuZGluZyB0aGUKICBwcmVmZXJyZWQgdmFsdWUgYWZ0ZXIgYSAiOiIgY2hh
        cmFjdGVyIHdoZW4gZGVmaW5pbmcgdGhlIGJpbmRpbmc6CgogIGBgYGphdmFz
        Y3JpcHQKICBNeVZpZXcgPSBFbWJlci5WaWV3LmV4dGVuZCh7CiAgICBjbGFz
        c05hbWVCaW5kaW5nczogWydhd2Vzb21lOnNvLXZlcnktY29vbCddLAogICAg
        YXdlc29tZTogdHJ1ZQogIH0pOwogIGBgYAoKICBXaWxsIHJlc3VsdCBpbiB2
        aWV3IGluc3RhbmNlcyB3aXRoIGFuIEhUTUwgcmVwcmVzZW50YXRpb24gb2Y6
        CgogIGBgYGh0bWwKICA8ZGl2IGlkPSJlbWJlcjEiIGNsYXNzPSJlbWJlci12
        aWV3IHNvLXZlcnktY29vbCI+PC9kaXY+CiAgYGBgCgogIEJvb2xlYW4gdmFs
        dWUgY2xhc3MgbmFtZSBiaW5kaW5ncyB3aG9zZSBwcm9wZXJ0eSBuYW1lcyBh
        cmUgaW4gYQogIGNhbWVsQ2FzZS1zdHlsZSBmb3JtYXQgd2lsbCBiZSBjb252
        ZXJ0ZWQgdG8gYSBkYXNoZXJpemVkIGZvcm1hdDoKCiAgYGBgamF2YXNjcmlw
        dAogIE15VmlldyA9IEVtYmVyLlZpZXcuZXh0ZW5kKHsKICAgIGNsYXNzTmFt
        ZUJpbmRpbmdzOiBbJ2lzVXJnZW50J10sCiAgICBpc1VyZ2VudDogdHJ1ZQog
        IH0pOwogIGBgYAoKICBXaWxsIHJlc3VsdCBpbiB2aWV3IGluc3RhbmNlcyB3
        aXRoIGFuIEhUTUwgcmVwcmVzZW50YXRpb24gb2Y6CgogIGBgYGh0bWwKICA8
        ZGl2IGlkPSJlbWJlcjEiIGNsYXNzPSJlbWJlci12aWV3IGlzLXVyZ2VudCI+
        PC9kaXY+CiAgYGBgCgogIENsYXNzIG5hbWUgYmluZGluZ3MgY2FuIGFsc28g
        cmVmZXIgdG8gb2JqZWN0IHZhbHVlcyB0aGF0IGFyZSBmb3VuZCBieQogIHRy
        YXZlcnNpbmcgYSBwYXRoIHJlbGF0aXZlIHRvIHRoZSB2aWV3IGl0c2VsZjoK
        CiAgYGBgamF2YXNjcmlwdAogIE15VmlldyA9IEVtYmVyLlZpZXcuZXh0ZW5k
        KHsKICAgIGNsYXNzTmFtZUJpbmRpbmdzOiBbJ21lc3NhZ2VzLmVtcHR5J10K
        ICAgIG1lc3NhZ2VzOiBFbWJlci5PYmplY3QuY3JlYXRlKHsKICAgICAgZW1w
        dHk6IHRydWUKICAgIH0pCiAgfSk7CiAgYGBgCgogIFdpbGwgcmVzdWx0IGlu
        IHZpZXcgaW5zdGFuY2VzIHdpdGggYW4gSFRNTCByZXByZXNlbnRhdGlvbiBv
        ZjoKCiAgYGBgaHRtbAogIDxkaXYgaWQ9ImVtYmVyMSIgY2xhc3M9ImVtYmVy
        LXZpZXcgZW1wdHkiPjwvZGl2PgogIGBgYAoKICBJZiB5b3Ugd2FudCB0byBh
        ZGQgYSBjbGFzcyBuYW1lIGZvciBhIHByb3BlcnR5IHdoaWNoIGV2YWx1YXRl
        cyB0byB0cnVlIGFuZAogIGFuZCBhIGRpZmZlcmVudCBjbGFzcyBuYW1lIGlm
        IGl0IGV2YWx1YXRlcyB0byBmYWxzZSwgeW91IGNhbiBwYXNzIGEgYmluZGlu
        ZwogIGxpa2UgdGhpczoKCiAgYGBgamF2YXNjcmlwdAogIC8vIEFwcGxpZXMg
        J2VuYWJsZWQnIGNsYXNzIHdoZW4gaXNFbmFibGVkIGlzIHRydWUgYW5kICdk
        aXNhYmxlZCcgd2hlbiBpc0VuYWJsZWQgaXMgZmFsc2UKICBFbWJlci5WaWV3
        LmV4dGVuZCh7CiAgICBjbGFzc05hbWVCaW5kaW5nczogWydpc0VuYWJsZWQ6
        ZW5hYmxlZDpkaXNhYmxlZCddCiAgICBpc0VuYWJsZWQ6IHRydWUKICB9KTsK
        ICBgYGAKCiAgV2lsbCByZXN1bHQgaW4gdmlldyBpbnN0YW5jZXMgd2l0aCBh
        biBIVE1MIHJlcHJlc2VudGF0aW9uIG9mOgoKICBgYGBodG1sCiAgPGRpdiBp
        ZD0iZW1iZXIxIiBjbGFzcz0iZW1iZXItdmlldyBlbmFibGVkIj48L2Rpdj4K
        ICBgYGAKCiAgV2hlbiBpc0VuYWJsZWQgaXMgYGZhbHNlYCwgdGhlIHJlc3Vs
        dGluZyBIVE1MIHJlcHJlbnNlbnRhdGlvbiBsb29rcyBsaWtlCiAgdGhpczoK
        CiAgYGBgaHRtbAogIDxkaXYgaWQ9ImVtYmVyMSIgY2xhc3M9ImVtYmVyLXZp
        ZXcgZGlzYWJsZWQiPjwvZGl2PgogIGBgYAoKICBUaGlzIHN5bnRheCBvZmZl
        cnMgdGhlIGNvbnZlbmllbmNlIHRvIGFkZCBhIGNsYXNzIGlmIGEgcHJvcGVy
        dHkgaXMgYGZhbHNlYDoKCiAgYGBgamF2YXNjcmlwdAogIC8vIEFwcGxpZXMg
        bm8gY2xhc3Mgd2hlbiBpc0VuYWJsZWQgaXMgdHJ1ZSBhbmQgY2xhc3MgJ2Rp
        c2FibGVkJyB3aGVuIGlzRW5hYmxlZCBpcyBmYWxzZQogIEVtYmVyLlZpZXcu
        ZXh0ZW5kKHsKICAgIGNsYXNzTmFtZUJpbmRpbmdzOiBbJ2lzRW5hYmxlZDo6
        ZGlzYWJsZWQnXQogICAgaXNFbmFibGVkOiB0cnVlCiAgfSk7CiAgYGBgCgog
        IFdpbGwgcmVzdWx0IGluIHZpZXcgaW5zdGFuY2VzIHdpdGggYW4gSFRNTCBy
        ZXByZXNlbnRhdGlvbiBvZjoKCiAgYGBgaHRtbAogIDxkaXYgaWQ9ImVtYmVy
        MSIgY2xhc3M9ImVtYmVyLXZpZXciPjwvZGl2PgogIGBgYAoKICBXaGVuIHRo
        ZSBgaXNFbmFibGVkYCBwcm9wZXJ0eSBvbiB0aGUgdmlldyBpcyBzZXQgdG8g
        YGZhbHNlYCwgaXQgd2lsbCByZXN1bHQKICBpbiB2aWV3IGluc3RhbmNlcyB3
        aXRoIGFuIEhUTUwgcmVwcmVzZW50YXRpb24gb2Y6CgogIGBgYGh0bWwKICA8
        ZGl2IGlkPSJlbWJlcjEiIGNsYXNzPSJlbWJlci12aWV3IGRpc2FibGVkIj48
        L2Rpdj4KICBgYGAKCiAgVXBkYXRlcyB0byB0aGUgdGhlIHZhbHVlIG9mIGEg
        Y2xhc3MgbmFtZSBiaW5kaW5nIHdpbGwgcmVzdWx0IGluIGF1dG9tYXRpYwog
        IHVwZGF0ZSBvZiB0aGUgIEhUTUwgYGNsYXNzYCBhdHRyaWJ1dGUgaW4gdGhl
        IHZpZXcncyByZW5kZXJlZCBIVE1MCiAgcmVwcmVzZW50YXRpb24uIElmIHRo
        ZSB2YWx1ZSBiZWNvbWVzIGBmYWxzZWAgb3IgYHVuZGVmaW5lZGAgdGhlIGNs
        YXNzIG5hbWUKICB3aWxsIGJlIHJlbW92ZWQuCgogIEJvdGggYGNsYXNzTmFt
        ZXNgIGFuZCBgY2xhc3NOYW1lQmluZGluZ3NgIGFyZSBjb25jYXRlbmF0ZWQg
        cHJvcGVydGllcy4gU2VlCiAgW0VtYmVyLk9iamVjdF0oL2FwaS9jbGFzc2Vz
        L0VtYmVyLk9iamVjdC5odG1sKSBkb2N1bWVudGF0aW9uIGZvciBtb3JlCiAg
        aW5mb3JtYXRpb24gYWJvdXQgY29uY2F0ZW5hdGVkIHByb3BlcnRpZXMuCgog
        ICMjIEhUTUwgQXR0cmlidXRlcwoKICBUaGUgSFRNTCBhdHRyaWJ1dGUgc2Vj
        dGlvbiBvZiBhIHZpZXcncyB0YWcgY2FuIGJlIHNldCBieSBwcm92aWRpbmcg
        YW4KICBgYXR0cmlidXRlQmluZGluZ3NgIHByb3BlcnR5IHNldCB0byBhbiBh
        cnJheSBvZiBwcm9wZXJ0eSBuYW1lcyBvbiB0aGUgdmlldy4KICBUaGUgcmV0
        dXJuIHZhbHVlIG9mIHRoZXNlIHByb3BlcnRpZXMgd2lsbCBiZSB1c2VkIGFz
        IHRoZSB2YWx1ZSBvZiB0aGUgdmlldydzCiAgSFRNTCBhc3NvY2lhdGVkIGF0
        dHJpYnV0ZToKCiAgYGBgamF2YXNjcmlwdAogIEFuY2hvclZpZXcgPSBFbWJl
        ci5WaWV3LmV4dGVuZCh7CiAgICB0YWdOYW1lOiAnYScsCiAgICBhdHRyaWJ1
        dGVCaW5kaW5nczogWydocmVmJ10sCiAgICBocmVmOiAnaHR0cDovL2dvb2ds
        ZS5jb20nCiAgfSk7CiAgYGBgCgogIFdpbGwgcmVzdWx0IGluIHZpZXcgaW5z
        dGFuY2VzIHdpdGggYW4gSFRNTCByZXByZXNlbnRhdGlvbiBvZjoKCiAgYGBg
        aHRtbAogIDxhIGlkPSJlbWJlcjEiIGNsYXNzPSJlbWJlci12aWV3IiBocmVm
        PSJodHRwOi8vZ29vZ2xlLmNvbSI+PC9hPgogIGBgYAoKICBJZiB0aGUgcmV0
        dXJuIHZhbHVlIG9mIGFuIGBhdHRyaWJ1dGVCaW5kaW5nc2AgbW9uaXRvcmVk
        IHByb3BlcnR5IGlzIGEgYm9vbGVhbgogIHRoZSBwcm9wZXJ0eSB3aWxsIGZv
        bGxvdyBIVE1MJ3MgcGF0dGVybiBvZiByZXBlYXRpbmcgdGhlIGF0dHJpYnV0
        ZSdzIG5hbWUgYXMKICBpdHMgdmFsdWU6CgogIGBgYGphdmFzY3JpcHQKICBN
        eVRleHRJbnB1dCA9IEVtYmVyLlZpZXcuZXh0ZW5kKHsKICAgIHRhZ05hbWU6
        ICdpbnB1dCcsCiAgICBhdHRyaWJ1dGVCaW5kaW5nczogWydkaXNhYmxlZCdd
        LAogICAgZGlzYWJsZWQ6IHRydWUKICB9KTsKICBgYGAKCiAgV2lsbCByZXN1
        bHQgaW4gdmlldyBpbnN0YW5jZXMgd2l0aCBhbiBIVE1MIHJlcHJlc2VudGF0
        aW9uIG9mOgoKICBgYGBodG1sCiAgPGlucHV0IGlkPSJlbWJlcjEiIGNsYXNz
        PSJlbWJlci12aWV3IiBkaXNhYmxlZD0iZGlzYWJsZWQiIC8+CiAgYGBgCgog
        IGBhdHRyaWJ1dGVCaW5kaW5nc2AgY2FuIHJlZmVyIHRvIGNvbXB1dGVkIHBy
        b3BlcnRpZXM6CgogIGBgYGphdmFzY3JpcHQKICBNeVRleHRJbnB1dCA9IEVt
        YmVyLlZpZXcuZXh0ZW5kKHsKICAgIHRhZ05hbWU6ICdpbnB1dCcsCiAgICBh
        dHRyaWJ1dGVCaW5kaW5nczogWydkaXNhYmxlZCddLAogICAgZGlzYWJsZWQ6
        IGZ1bmN0aW9uKCkgewogICAgICBpZiAoc29tZUxvZ2ljKSB7CiAgICAgICAg
        cmV0dXJuIHRydWU7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIGZh
        bHNlOwogICAgICB9CiAgICB9LnByb3BlcnR5KCkKICB9KTsKICBgYGAKCiAg
        VXBkYXRlcyB0byB0aGUgdGhlIHByb3BlcnR5IG9mIGFuIGF0dHJpYnV0ZSBi
        aW5kaW5nIHdpbGwgcmVzdWx0IGluIGF1dG9tYXRpYwogIHVwZGF0ZSBvZiB0
        aGUgIEhUTUwgYXR0cmlidXRlIGluIHRoZSB2aWV3J3MgcmVuZGVyZWQgSFRN
        TCByZXByZXNlbnRhdGlvbi4KCiAgYGF0dHJpYnV0ZUJpbmRpbmdzYCBpcyBh
        IGNvbmNhdGVuYXRlZCBwcm9wZXJ0eS4gU2VlIFtFbWJlci5PYmplY3RdKC9h
        cGkvY2xhc3Nlcy9FbWJlci5PYmplY3QuaHRtbCkKICBkb2N1bWVudGF0aW9u
        IGZvciBtb3JlIGluZm9ybWF0aW9uIGFib3V0IGNvbmNhdGVuYXRlZCBwcm9w
        ZXJ0aWVzLgoKICAjIyBUZW1wbGF0ZXMKCiAgVGhlIEhUTUwgY29udGVudHMg
        b2YgYSB2aWV3J3MgcmVuZGVyZWQgcmVwcmVzZW50YXRpb24gYXJlIGRldGVy
        bWluZWQgYnkgaXRzCiAgdGVtcGxhdGUuIFRlbXBsYXRlcyBjYW4gYmUgYW55
        IGZ1bmN0aW9uIHRoYXQgYWNjZXB0cyBhbiBvcHRpb25hbCBjb250ZXh0CiAg
        cGFyYW1ldGVyIGFuZCByZXR1cm5zIGEgc3RyaW5nIG9mIEhUTUwgdGhhdCB3
        aWxsIGJlIGluc2VydGVkIHdpdGhpbiB0aGUKICB2aWV3J3MgdGFnLiBNb3N0
        IHR5cGljYWxseSBpbiBFbWJlciB0aGlzIGZ1bmN0aW9uIHdpbGwgYmUgYSBj
        b21waWxlZAogIGBFbWJlci5IYW5kbGViYXJzYCB0ZW1wbGF0ZS4KCiAgYGBg
        amF2YXNjcmlwdAogIEFWaWV3ID0gRW1iZXIuVmlldy5leHRlbmQoewogICAg
        dGVtcGxhdGU6IEVtYmVyLkhhbmRsZWJhcnMuY29tcGlsZSgnSSBhbSB0aGUg
        dGVtcGxhdGUnKQogIH0pOwogIGBgYAoKICBXaWxsIHJlc3VsdCBpbiB2aWV3
        IGluc3RhbmNlcyB3aXRoIGFuIEhUTUwgcmVwcmVzZW50YXRpb24gb2Y6Cgog
        IGBgYGh0bWwKICA8ZGl2IGlkPSJlbWJlcjEiIGNsYXNzPSJlbWJlci12aWV3
        Ij5JIGFtIHRoZSB0ZW1wbGF0ZTwvZGl2PgogIGBgYAoKICBXaXRoaW4gYW4g
        RW1iZXIgYXBwbGljYXRpb24gaXMgbW9yZSBjb21tb24gdG8gZGVmaW5lIGEg
        SGFuZGxlYmFycyB0ZW1wbGF0ZXMgYXMKICBwYXJ0IG9mIGEgcGFnZToKCiAg
        YGBgaHRtbAogIDxzY3JpcHQgdHlwZT0ndGV4dC94LWhhbmRsZWJhcnMnIGRh
        dGEtdGVtcGxhdGUtbmFtZT0nc29tZS10ZW1wbGF0ZSc+CiAgICBIZWxsbwog
        IDwvc2NyaXB0PgogIGBgYAoKICBBbmQgYXNzb2NpYXRlIGl0IGJ5IG5hbWUg
        dXNpbmcgYSB2aWV3J3MgYHRlbXBsYXRlTmFtZWAgcHJvcGVydHk6CgogIGBg
        YGphdmFzY3JpcHQKICBBVmlldyA9IEVtYmVyLlZpZXcuZXh0ZW5kKHsKICAg
        IHRlbXBsYXRlTmFtZTogJ3NvbWUtdGVtcGxhdGUnCiAgfSk7CiAgYGBgCgog
        IFVzaW5nIGEgdmFsdWUgZm9yIGB0ZW1wbGF0ZU5hbWVgIHRoYXQgZG9lcyBu
        b3QgaGF2ZSBhIEhhbmRsZWJhcnMgdGVtcGxhdGUKICB3aXRoIGEgbWF0Y2hp
        bmcgYGRhdGEtdGVtcGxhdGUtbmFtZWAgYXR0cmlidXRlIHdpbGwgdGhyb3cg
        YW4gZXJyb3IuCgogIEZvciB2aWV3cyBjbGFzc2VzIHRoYXQgbWF5IGhhdmUg
        YSB0ZW1wbGF0ZSBsYXRlciBkZWZpbmVkIChlLmcuIGFzIHRoZSBibG9jawog
        IHBvcnRpb24gb2YgYSBge3t2aWV3fX1gIEhhbmRsZWJhcnMgaGVscGVyIGNh
        bGwgaW4gYW5vdGhlciB0ZW1wbGF0ZSBvciBpbgogIGEgc3ViY2xhc3MpLCB5
        b3UgY2FuIHByb3ZpZGUgYSBgZGVmYXVsdFRlbXBsYXRlYCBwcm9wZXJ0eSBz
        ZXQgdG8gY29tcGlsZWQKICB0ZW1wbGF0ZSBmdW5jdGlvbi4gSWYgYSB0ZW1w
        bGF0ZSBpcyBub3QgbGF0ZXIgcHJvdmlkZWQgZm9yIHRoZSB2aWV3IGluc3Rh
        bmNlCiAgdGhlIGBkZWZhdWx0VGVtcGxhdGVgIHZhbHVlIHdpbGwgYmUgdXNl
        ZDoKCiAgYGBgamF2YXNjcmlwdAogIEFWaWV3ID0gRW1iZXIuVmlldy5leHRl
        bmQoewogICAgZGVmYXVsdFRlbXBsYXRlOiBFbWJlci5IYW5kbGViYXJzLmNv
        bXBpbGUoJ0kgd2FzIHRoZSBkZWZhdWx0JyksCiAgICB0ZW1wbGF0ZTogbnVs
        bCwKICAgIHRlbXBsYXRlTmFtZTogbnVsbAogIH0pOwogIGBgYAoKICBXaWxs
        IHJlc3VsdCBpbiBpbnN0YW5jZXMgd2l0aCBhbiBIVE1MIHJlcHJlc2VudGF0
        aW9uIG9mOgoKICBgYGBodG1sCiAgPGRpdiBpZD0iZW1iZXIxIiBjbGFzcz0i
        ZW1iZXItdmlldyI+SSB3YXMgdGhlIGRlZmF1bHQ8L2Rpdj4KICBgYGAKCiAg
        SWYgYSBgdGVtcGxhdGVgIG9yIGB0ZW1wbGF0ZU5hbWVgIGlzIHByb3ZpZGVk
        IGl0IHdpbGwgdGFrZSBwcmVjZWRlbmNlIG92ZXIKICBgZGVmYXVsdFRlbXBs
        YXRlYDoKCiAgYGBgamF2YXNjcmlwdAogIEFWaWV3ID0gRW1iZXIuVmlldy5l
        eHRlbmQoewogICAgZGVmYXVsdFRlbXBsYXRlOiBFbWJlci5IYW5kbGViYXJz
        LmNvbXBpbGUoJ0kgd2FzIHRoZSBkZWZhdWx0JykKICB9KTsKCiAgYVZpZXcg
        PSBBVmlldy5jcmVhdGUoewogICAgdGVtcGxhdGU6IEVtYmVyLkhhbmRsZWJh
        cnMuY29tcGlsZSgnSSB3YXMgdGhlIHRlbXBsYXRlLCBub3QgZGVmYXVsdCcp
        CiAgfSk7CiAgYGBgCgogIFdpbGwgcmVzdWx0IGluIHRoZSBmb2xsb3dpbmcg
        SFRNTCByZXByZXNlbnRhdGlvbiB3aGVuIHJlbmRlcmVkOgoKICBgYGBodG1s
        CiAgPGRpdiBpZD0iZW1iZXIxIiBjbGFzcz0iZW1iZXItdmlldyI+SSB3YXMg
        dGhlIHRlbXBsYXRlLCBub3QgZGVmYXVsdDwvZGl2PgogIGBgYAoKICAjIyBW
        aWV3IENvbnRleHQKCiAgVGhlIGRlZmF1bHQgY29udGV4dCBvZiB0aGUgY29t
        cGlsZWQgdGVtcGxhdGUgaXMgdGhlIHZpZXcncyBjb250cm9sbGVyOgoKICBg
        YGBqYXZhc2NyaXB0CiAgQVZpZXcgPSBFbWJlci5WaWV3LmV4dGVuZCh7CiAg
        ICB0ZW1wbGF0ZTogRW1iZXIuSGFuZGxlYmFycy5jb21waWxlKCdIZWxsbyB7
        e2V4Y2l0ZWRHcmVldGluZ319JykKICB9KTsKCiAgYUNvbnRyb2xsZXIgPSBF
        bWJlci5PYmplY3QuY3JlYXRlKHsKICAgIGZpcnN0TmFtZTogJ0JhcnJ5JywK
        ICAgIGV4Y2l0ZWRHcmVldGluZzogZnVuY3Rpb24oKSB7CiAgICAgIHJldHVy
        biB0aGlzLmdldCgiY29udGVudC5maXJzdE5hbWUiKSArICIhISEiCiAgICB9
        LnByb3BlcnR5KCkKICB9KTsKCiAgYVZpZXcgPSBBVmlldy5jcmVhdGUoewog
        ICAgY29udHJvbGxlcjogYUNvbnRyb2xsZXIsCiAgfSk7CiAgYGBgCgogIFdp
        bGwgcmVzdWx0IGluIGFuIEhUTUwgcmVwcmVzZW50YXRpb24gb2Y6CgogIGBg
        YGh0bWwKICA8ZGl2IGlkPSJlbWJlcjEiIGNsYXNzPSJlbWJlci12aWV3Ij5I
        ZWxsbyBCYXJyeSEhITwvZGl2PgogIGBgYAoKICBBIGNvbnRleHQgY2FuIGFs
        c28gYmUgZXhwbGljaXRseSBzdXBwbGllZCB0aHJvdWdoIHRoZSB2aWV3J3Mg
        YGNvbnRleHRgCiAgcHJvcGVydHkuIElmIHRoZSB2aWV3IGhhcyBuZWl0aGVy
        IGBjb250ZXh0YCBub3IgYGNvbnRyb2xsZXJgIHByb3BlcnRpZXMsIHRoZQog
        IGBwYXJlbnRWaWV3YCdzIGNvbnRleHQgd2lsbCBiZSB1c2VkLgoKICAjIyBM
        YXlvdXRzCgogIFZpZXdzIGNhbiBoYXZlIGEgc2Vjb25kYXJ5IHRlbXBsYXRl
        IHRoYXQgd3JhcHMgdGhlaXIgbWFpbiB0ZW1wbGF0ZS4gTGlrZQogIHByaW1h
        cnkgdGVtcGxhdGVzLCBsYXlvdXRzIGNhbiBiZSBhbnkgZnVuY3Rpb24gdGhh
        dCAgYWNjZXB0cyBhbiBvcHRpb25hbAogIGNvbnRleHQgcGFyYW1ldGVyIGFu
        ZCByZXR1cm5zIGEgc3RyaW5nIG9mIEhUTUwgdGhhdCB3aWxsIGJlIGluc2Vy
        dGVkIGluc2lkZQogIHZpZXcncyB0YWcuIFZpZXdzIHdob3NlIEhUTUwgZWxl
        bWVudCBpcyBzZWxmIGNsb3NpbmcgKGUuZy4gYDxpbnB1dCAvPmApCiAgY2Fu
        bm90IGhhdmUgYSBsYXlvdXQgYW5kIHRoaXMgcHJvcGVydHkgd2lsbCBiZSBp
        Z25vcmVkLgoKICBNb3N0IHR5cGljYWxseSBpbiBFbWJlciBhIGxheW91dCB3
        aWxsIGJlIGEgY29tcGlsZWQgYEVtYmVyLkhhbmRsZWJhcnNgCiAgdGVtcGxh
        dGUuCgogIEEgdmlldydzIGxheW91dCBjYW4gYmUgc2V0IGRpcmVjdGx5IHdp
        dGggdGhlIGBsYXlvdXRgIHByb3BlcnR5IG9yIHJlZmVyZW5jZQogIGFuIGV4
        aXN0aW5nIEhhbmRsZWJhcnMgdGVtcGxhdGUgYnkgbmFtZSB3aXRoIHRoZSBg
        bGF5b3V0TmFtZWAgcHJvcGVydHkuCgogIEEgdGVtcGxhdGUgdXNlZCBhcyBh
        IGxheW91dCBtdXN0IGNvbnRhaW4gYSBzaW5nbGUgdXNlIG9mIHRoZSBIYW5k
        bGViYXJzCiAgYHt7eWllbGR9fWAgaGVscGVyLiBUaGUgSFRNTCBjb250ZW50
        cyBvZiBhIHZpZXcncyByZW5kZXJlZCBgdGVtcGxhdGVgIHdpbGwgYmUKICBp
        bnNlcnRlZCBhdCB0aGlzIGxvY2F0aW9uOgoKICBgYGBqYXZhc2NyaXB0CiAg
        QVZpZXdXaXRoTGF5b3V0ID0gRW1iZXIuVmlldy5leHRlbmQoewogICAgbGF5
        b3V0OiBFbWJlci5IYW5kbGViYXJzLmNvbXBpbGUoIjxkaXYgY2xhc3M9J215
        LWRlY29yYXRpdmUtY2xhc3MnPnt7eWllbGR9fTwvZGl2PiIpCiAgICB0ZW1w
        bGF0ZTogRW1iZXIuSGFuZGxlYmFycy5jb21waWxlKCJJIGdvdCB3cmFwcGVk
        IiksCiAgfSk7CiAgYGBgCgogIFdpbGwgcmVzdWx0IGluIHZpZXcgaW5zdGFu
        Y2VzIHdpdGggYW4gSFRNTCByZXByZXNlbnRhdGlvbiBvZjoKCiAgYGBgaHRt
        bAogIDxkaXYgaWQ9ImVtYmVyMSIgY2xhc3M9ImVtYmVyLXZpZXciPgogICAg
        PGRpdiBjbGFzcz0ibXktZGVjb3JhdGl2ZS1jbGFzcyI+CiAgICAgIEkgZ290
        IHdyYXBwZWQKICAgIDwvZGl2PgogIDwvZGl2PgogIGBgYAoKICBTZWUgW0Vt
        YmVyLkhhbmRsZWJhcnMuaGVscGVycy55aWVsZF0oL2FwaS9jbGFzc2VzL0Vt
        YmVyLkhhbmRsZWJhcnMuaGVscGVycy5odG1sI21ldGhvZF95aWVsZCkKICBm
        b3IgbW9yZSBpbmZvcm1hdGlvbi4KCiAgIyMgUmVzcG9uZGluZyB0byBCcm93
        c2VyIEV2ZW50cwoKICBWaWV3cyBjYW4gcmVzcG9uZCB0byB1c2VyLWluaXRp
        YXRlZCBldmVudHMgaW4gb25lIG9mIHRocmVlIHdheXM6IG1ldGhvZAogIGlt
        cGxlbWVudGF0aW9uLCB0aHJvdWdoIGFuIGV2ZW50IG1hbmFnZXIsIGFuZCB0
        aHJvdWdoIGB7e2FjdGlvbn19YCBoZWxwZXIgdXNlCiAgaW4gdGhlaXIgdGVt
        cGxhdGUgb3IgbGF5b3V0LgoKICAjIyMgTWV0aG9kIEltcGxlbWVudGF0aW9u
        CgogIFZpZXdzIGNhbiByZXNwb25kIHRvIHVzZXItaW5pdGlhdGVkIGV2ZW50
        cyBieSBpbXBsZW1lbnRpbmcgYSBtZXRob2QgdGhhdAogIG1hdGNoZXMgdGhl
        IGV2ZW50IG5hbWUuIEEgYGpRdWVyeS5FdmVudGAgb2JqZWN0IHdpbGwgYmUg
        cGFzc2VkIGFzIHRoZQogIGFyZ3VtZW50IHRvIHRoaXMgbWV0aG9kLgoKICBg
        YGBqYXZhc2NyaXB0CiAgQVZpZXcgPSBFbWJlci5WaWV3LmV4dGVuZCh7CiAg
        ICBjbGljazogZnVuY3Rpb24oZXZlbnQpIHsKICAgICAgLy8gd2lsbCBiZSBj
        YWxsZWQgd2hlbiB3aGVuIGFuIGluc3RhbmNlJ3MKICAgICAgLy8gcmVuZGVy
        ZWQgZWxlbWVudCBpcyBjbGlja2VkCiAgICB9CiAgfSk7CiAgYGBgCgogICMj
        IyBFdmVudCBNYW5hZ2VycwoKICBWaWV3cyBjYW4gZGVmaW5lIGFuIG9iamVj
        dCBhcyB0aGVpciBgZXZlbnRNYW5hZ2VyYCBwcm9wZXJ0eS4gVGhpcyBvYmpl
        Y3QgY2FuCiAgdGhlbiBpbXBsZW1lbnQgbWV0aG9kcyB0aGF0IG1hdGNoIHRo
        ZSBkZXNpcmVkIGV2ZW50IG5hbWVzLiBNYXRjaGluZyBldmVudHMKICB0aGF0
        IG9jY3VyIG9uIHRoZSB2aWV3J3MgcmVuZGVyZWQgSFRNTCBvciB0aGUgcmVu
        ZGVyZWQgSFRNTCBvZiBhbnkgb2YgaXRzIERPTQogIGRlc2NlbmRhbnRzIHdp
        bGwgdHJpZ2dlciB0aGlzIG1ldGhvZC4gQSBgalF1ZXJ5LkV2ZW50YCBvYmpl
        Y3Qgd2lsbCBiZSBwYXNzZWQKICBhcyB0aGUgZmlyc3QgYXJndW1lbnQgdG8g
        dGhlIG1ldGhvZCBhbmQgYW4gIGBFbWJlci5WaWV3YCBvYmplY3QgYXMgdGhl
        CiAgc2Vjb25kLiBUaGUgYEVtYmVyLlZpZXdgIHdpbGwgYmUgdGhlIHZpZXcg
        d2hvc2UgcmVuZGVyZWQgSFRNTCB3YXMgaW50ZXJhY3RlZAogIHdpdGguIFRo
        aXMgbWF5IGJlIHRoZSB2aWV3IHdpdGggdGhlIGBldmVudE1hbmFnZXJgIHBy
        b3BlcnR5IG9yIG9uZSBvZiBpdHMKICBkZXNjZW5kZW50IHZpZXdzLgoKICBg
        YGBqYXZhc2NyaXB0CiAgQVZpZXcgPSBFbWJlci5WaWV3LmV4dGVuZCh7CiAg
        ICBldmVudE1hbmFnZXI6IEVtYmVyLk9iamVjdC5jcmVhdGUoewogICAgICBk
        b3VibGVDbGljazogZnVuY3Rpb24oZXZlbnQsIHZpZXcpIHsKICAgICAgICAv
        LyB3aWxsIGJlIGNhbGxlZCB3aGVuIHdoZW4gYW4gaW5zdGFuY2UncwogICAg
        ICAgIC8vIHJlbmRlcmVkIGVsZW1lbnQgb3IgYW55IHJlbmRlcmluZwogICAg
        ICAgIC8vIG9mIHRoaXMgdmlld3MncyBkZXNjZW5kZW50CiAgICAgICAgLy8g
        ZWxlbWVudHMgaXMgY2xpY2tlZAogICAgICB9CiAgICB9KQogIH0pOwogIGBg
        YAoKICBBbiBldmVudCBkZWZpbmVkIGZvciBhbiBldmVudCBtYW5hZ2VyIHRh
        a2VzIHByZWNlZGVuY2Ugb3ZlciBldmVudHMgb2YgdGhlCiAgc2FtZSBuYW1l
        IGhhbmRsZWQgdGhyb3VnaCBtZXRob2RzIG9uIHRoZSB2aWV3LgoKICBgYGBq
        YXZhc2NyaXB0CiAgQVZpZXcgPSBFbWJlci5WaWV3LmV4dGVuZCh7CiAgICBt
        b3VzZUVudGVyOiBmdW5jdGlvbihldmVudCkgewogICAgICAvLyB3aWxsIG5l
        dmVyIHRyaWdnZXIuCiAgICB9LAogICAgZXZlbnRNYW5hZ2VyOiBFbWJlci5P
        YmplY3QuY3JlYXRlKHsKICAgICAgbW91c2VFbnRlcjogZnVuY3Rpb24oZXZl
        bnQsIHZpZXcpIHsKICAgICAgICAvLyB0YWtlcyBwcmVjZWRlbmNlIG92ZXIg
        QVZpZXcjbW91c2VFbnRlcgogICAgICB9CiAgICB9KQogIH0pOwogIGBgYAoK
        ICBTaW1pbGFybHkgYSB2aWV3J3MgZXZlbnQgbWFuYWdlciB3aWxsIHRha2Ug
        cHJlY2VkZW5jZSBmb3IgZXZlbnRzIG9mIGFueSB2aWV3cwogIHJlbmRlcmVk
        IGFzIGEgZGVzY2VuZGVudC4gQSBtZXRob2QgbmFtZSB0aGF0IG1hdGNoZXMg
        YW4gZXZlbnQgbmFtZSB3aWxsIG5vdAogIGJlIGNhbGxlZCBpZiB0aGUgdmll
        dyBpbnN0YW5jZSB3YXMgcmVuZGVyZWQgaW5zaWRlIHRoZSBIVE1MIHJlcHJl
        c2VudGF0aW9uIG9mCiAgYSB2aWV3IHRoYXQgaGFzIGFuIGBldmVudE1hbmFn
        ZXJgIHByb3BlcnR5IGRlZmluZWQgdGhhdCBoYW5kbGVzIGV2ZW50cyBvZiB0
        aGUKICBuYW1lLiBFdmVudHMgbm90IGhhbmRsZWQgYnkgdGhlIGV2ZW50IG1h
        bmFnZXIgd2lsbCBzdGlsbCB0cmlnZ2VyIG1ldGhvZCBjYWxscwogIG9uIHRo
        ZSBkZXNjZW5kZW50LgoKICBgYGBqYXZhc2NyaXB0CiAgT3V0ZXJWaWV3ID0g
        RW1iZXIuVmlldy5leHRlbmQoewogICAgdGVtcGxhdGU6IEVtYmVyLkhhbmRs
        ZWJhcnMuY29tcGlsZSgib3V0ZXIge3sjdmlldyBJbm5lclZpZXd9fWlubmVy
        e3svdmlld319IG91dGVyIiksCiAgICBldmVudE1hbmFnZXI6IEVtYmVyLk9i
        amVjdC5jcmVhdGUoewogICAgICBtb3VzZUVudGVyOiBmdW5jdGlvbihldmVu
        dCwgdmlldykgewogICAgICAgIC8vIHZpZXcgbWlnaHQgYmUgaW5zdGFuY2Ug
        b2YgZWl0aGVyCiAgICAgICAgLy8gT3V0ZXJWaWV3IG9yIElubmVyVmlldyBk
        ZXBlbmRpbmcgb24KICAgICAgICAvLyB3aGVyZSBvbiB0aGUgcGFnZSB0aGUg
        dXNlciBpbnRlcmFjdGlvbiBvY2N1cmVkCiAgICAgIH0KICAgIH0pCiAgfSk7
        CgogIElubmVyVmlldyA9IEVtYmVyLlZpZXcuZXh0ZW5kKHsKICAgIGNsaWNr
        OiBmdW5jdGlvbihldmVudCkgewogICAgICAvLyB3aWxsIGJlIGNhbGxlZCBp
        ZiByZW5kZXJlZCBpbnNpZGUKICAgICAgLy8gYW4gT3V0ZXJWaWV3IGJlY2F1
        c2UgT3V0ZXJWaWV3J3MKICAgICAgLy8gZXZlbnRNYW5hZ2VyIGRvZXNuJ3Qg
        aGFuZGxlIGNsaWNrIGV2ZW50cwogICAgfSwKICAgIG1vdXNlRW50ZXI6IGZ1
        bmN0aW9uKGV2ZW50KSB7CiAgICAgIC8vIHdpbGwgbmV2ZXIgYmUgY2FsbGVk
        IGlmIHJlbmRlcmVkIGluc2lkZQogICAgICAvLyBhbiBPdXRlclZpZXcuCiAg
        ICB9CiAgfSk7CiAgYGBgCgogICMjIyBIYW5kbGViYXJzIGB7e2FjdGlvbn19
        YCBIZWxwZXIKCiAgU2VlIFtIYW5kbGViYXJzLmhlbHBlcnMuYWN0aW9uXSgv
        YXBpL2NsYXNzZXMvRW1iZXIuSGFuZGxlYmFycy5oZWxwZXJzLmh0bWwjbWV0
        aG9kX2FjdGlvbikuCgogICMjIyBFdmVudCBOYW1lcwoKICBBbGwgb2YgdGhl
        IGV2ZW50IGhhbmRsaW5nIGFwcHJvYWNoZXMgZGVzY3JpYmVkIGFib3ZlIHJl
        c3BvbmQgdG8gdGhlIHNhbWUgc2V0CiAgb2YgZXZlbnRzLiBUaGUgbmFtZXMg
        b2YgdGhlIGJ1aWx0LWluIGV2ZW50cyBhcmUgbGlzdGVkIGJlbG93LiAoVGhl
        IGhhc2ggb2YKICBidWlsdC1pbiBldmVudHMgZXhpc3RzIGluIGBFbWJlci5F
        dmVudERpc3BhdGNoZXJgLikgQWRkaXRpb25hbCwgY3VzdG9tIGV2ZW50cwog
        IGNhbiBiZSByZWdpc3RlcmVkIGJ5IHVzaW5nIGBFbWJlci5BcHBsaWNhdGlv
        bi5jdXN0b21FdmVudHNgLgoKICBUb3VjaCBldmVudHM6CgogICogYHRvdWNo
        U3RhcnRgCiAgKiBgdG91Y2hNb3ZlYAogICogYHRvdWNoRW5kYAogICogYHRv
        dWNoQ2FuY2VsYAoKICBLZXlib2FyZCBldmVudHMKCiAgKiBga2V5RG93bmAK
        ICAqIGBrZXlVcGAKICAqIGBrZXlQcmVzc2AKCiAgTW91c2UgZXZlbnRzCgog
        ICogYG1vdXNlRG93bmAKICAqIGBtb3VzZVVwYAogICogYGNvbnRleHRNZW51
        YAogICogYGNsaWNrYAogICogYGRvdWJsZUNsaWNrYAogICogYG1vdXNlTW92
        ZWAKICAqIGBmb2N1c0luYAogICogYGZvY3VzT3V0YAogICogYG1vdXNlRW50
        ZXJgCiAgKiBgbW91c2VMZWF2ZWAKCiAgRm9ybSBldmVudHM6CgogICogYHN1
        Ym1pdGAKICAqIGBjaGFuZ2VgCiAgKiBgZm9jdXNJbmAKICAqIGBmb2N1c091
        dGAKICAqIGBpbnB1dGAKCiAgSFRNTDUgZHJhZyBhbmQgZHJvcCBldmVudHM6
        CgogICogYGRyYWdTdGFydGAKICAqIGBkcmFnYAogICogYGRyYWdFbnRlcmAK
        ICAqIGBkcmFnTGVhdmVgCiAgKiBgZHJvcGAKICAqIGBkcmFnRW5kYAoKICAj
        IyBIYW5kbGViYXJzIGB7e3ZpZXd9fWAgSGVscGVyCgogIE90aGVyIGBFbWJl
        ci5WaWV3YCBpbnN0YW5jZXMgY2FuIGJlIGluY2x1ZGVkIGFzIHBhcnQgb2Yg
        YSB2aWV3J3MgdGVtcGxhdGUgYnkKICB1c2luZyB0aGUgYHt7dmlld319YCBI
        YW5kbGViYXJzIGhlbHBlci4gU2VlIFtFbWJlci5IYW5kbGViYXJzLmhlbHBl
        cnMudmlld10oL2FwaS9jbGFzc2VzL0VtYmVyLkhhbmRsZWJhcnMuaGVscGVy
        cy5odG1sI21ldGhvZF92aWV3KQogIGZvciBhZGRpdGlvbmFsIGluZm9ybWF0
        aW9uLgoKICBAY2xhc3MgVmlldwogIEBuYW1lc3BhY2UgRW1iZXIKICBAZXh0
        ZW5kcyBFbWJlci5Db3JlVmlldwoqLwpFbWJlci5WaWV3ID0gRW1iZXIuQ29y
        ZVZpZXcuZXh0ZW5kKAovKiogQHNjb3BlIEVtYmVyLlZpZXcucHJvdG90eXBl
        ICovIHsKCiAgY29uY2F0ZW5hdGVkUHJvcGVydGllczogWydjbGFzc05hbWVz
        JywgJ2NsYXNzTmFtZUJpbmRpbmdzJywgJ2F0dHJpYnV0ZUJpbmRpbmdzJ10s
        CgogIC8qKgogICAgQHByb3BlcnR5IGlzVmlldwogICAgQHR5cGUgQm9vbGVh
        bgogICAgQGRlZmF1bHQgdHJ1ZQogICAgQGZpbmFsCiAgKi8KICBpc1ZpZXc6
        IHRydWUsCgogIC8vIC4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4u
        Li4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4KICAvLyBURU1QTEFURSBTVVBQ
        T1JUCiAgLy8KCiAgLyoqCiAgICBUaGUgbmFtZSBvZiB0aGUgdGVtcGxhdGUg
        dG8gbG9va3VwIGlmIG5vIHRlbXBsYXRlIGlzIHByb3ZpZGVkLgoKICAgIGBF
        bWJlci5WaWV3YCB3aWxsIGxvb2sgZm9yIGEgdGVtcGxhdGUgd2l0aCB0aGlz
        IG5hbWUgaW4gdGhpcyB2aWV3J3MKICAgIGB0ZW1wbGF0ZXNgIG9iamVjdC4g
        QnkgZGVmYXVsdCwgdGhpcyB3aWxsIGJlIGEgZ2xvYmFsIG9iamVjdAogICAg
        c2hhcmVkIGluIGBFbWJlci5URU1QTEFURVNgLgoKICAgIEBwcm9wZXJ0eSB0
        ZW1wbGF0ZU5hbWUKICAgIEB0eXBlIFN0cmluZwogICAgQGRlZmF1bHQgbnVs
        bAogICovCiAgdGVtcGxhdGVOYW1lOiBudWxsLAoKICAvKioKICAgIFRoZSBu
        YW1lIG9mIHRoZSBsYXlvdXQgdG8gbG9va3VwIGlmIG5vIGxheW91dCBpcyBw
        cm92aWRlZC4KCiAgICBgRW1iZXIuVmlld2Agd2lsbCBsb29rIGZvciBhIHRl
        bXBsYXRlIHdpdGggdGhpcyBuYW1lIGluIHRoaXMgdmlldydzCiAgICBgdGVt
        cGxhdGVzYCBvYmplY3QuIEJ5IGRlZmF1bHQsIHRoaXMgd2lsbCBiZSBhIGds
        b2JhbCBvYmplY3QKICAgIHNoYXJlZCBpbiBgRW1iZXIuVEVNUExBVEVTYC4K
        CiAgICBAcHJvcGVydHkgbGF5b3V0TmFtZQogICAgQHR5cGUgU3RyaW5nCiAg
        ICBAZGVmYXVsdCBudWxsCiAgKi8KICBsYXlvdXROYW1lOiBudWxsLAoKICAv
        KioKICAgIFRoZSBoYXNoIGluIHdoaWNoIHRvIGxvb2sgZm9yIGB0ZW1wbGF0
        ZU5hbWVgLgoKICAgIEBwcm9wZXJ0eSB0ZW1wbGF0ZXMKICAgIEB0eXBlIEVt
        YmVyLk9iamVjdAogICAgQGRlZmF1bHQgRW1iZXIuVEVNUExBVEVTCiAgKi8K
        ICB0ZW1wbGF0ZXM6IEVtYmVyLlRFTVBMQVRFUywKCiAgLyoqCiAgICBUaGUg
        dGVtcGxhdGUgdXNlZCB0byByZW5kZXIgdGhlIHZpZXcuIFRoaXMgc2hvdWxk
        IGJlIGEgZnVuY3Rpb24gdGhhdAogICAgYWNjZXB0cyBhbiBvcHRpb25hbCBj
        b250ZXh0IHBhcmFtZXRlciBhbmQgcmV0dXJucyBhIHN0cmluZyBvZiBIVE1M
        IHRoYXQKICAgIHdpbGwgYmUgaW5zZXJ0ZWQgaW50byB0aGUgRE9NIHJlbGF0
        aXZlIHRvIGl0cyBwYXJlbnQgdmlldy4KCiAgICBJbiBnZW5lcmFsLCB5b3Ug
        c2hvdWxkIHNldCB0aGUgYHRlbXBsYXRlTmFtZWAgcHJvcGVydHkgaW5zdGVh
        ZCBvZiBzZXR0aW5nCiAgICB0aGUgdGVtcGxhdGUgeW91cnNlbGYuCgogICAg
        QHByb3BlcnR5IHRlbXBsYXRlCiAgICBAdHlwZSBGdW5jdGlvbgogICovCiAg
        dGVtcGxhdGU6IEVtYmVyLmNvbXB1dGVkKGZ1bmN0aW9uKGtleSwgdmFsdWUp
        IHsKICAgIGlmICh2YWx1ZSAhPT0gdW5kZWZpbmVkKSB7IHJldHVybiB2YWx1
        ZTsgfQoKICAgIHZhciB0ZW1wbGF0ZU5hbWUgPSBnZXQodGhpcywgJ3RlbXBs
        YXRlTmFtZScpLAogICAgICAgIHRlbXBsYXRlID0gdGhpcy50ZW1wbGF0ZUZv
        ck5hbWUodGVtcGxhdGVOYW1lLCAndGVtcGxhdGUnKTsKCiAgICBFbWJlci5h
        c3NlcnQoIllvdSBzcGVjaWZpZWQgdGhlIHRlbXBsYXRlTmFtZSAiICsgdGVt
        cGxhdGVOYW1lICsgIiBmb3IgIiArIHRoaXMgKyAiLCBidXQgaXQgZGlkIG5v
        dCBleGlzdC4iLCAhdGVtcGxhdGVOYW1lIHx8IHRlbXBsYXRlKTsKCiAgICBy
        ZXR1cm4gdGVtcGxhdGUgfHwgZ2V0KHRoaXMsICdkZWZhdWx0VGVtcGxhdGUn
        KTsKICB9KS5wcm9wZXJ0eSgndGVtcGxhdGVOYW1lJyksCgogIC8qKgogICAg
        VGhlIGNvbnRyb2xsZXIgbWFuYWdpbmcgdGhpcyB2aWV3LiBJZiB0aGlzIHBy
        b3BlcnR5IGlzIHNldCwgaXQgd2lsbCBiZQogICAgbWFkZSBhdmFpbGFibGUg
        Zm9yIHVzZSBieSB0aGUgdGVtcGxhdGUuCgogICAgQHByb3BlcnR5IGNvbnRy
        b2xsZXIKICAgIEB0eXBlIE9iamVjdAogICovCiAgY29udHJvbGxlcjogRW1i
        ZXIuY29tcHV0ZWQoZnVuY3Rpb24oa2V5KSB7CiAgICB2YXIgcGFyZW50Vmll
        dyA9IGdldCh0aGlzLCAnX3BhcmVudFZpZXcnKTsKICAgIHJldHVybiBwYXJl
        bnRWaWV3ID8gZ2V0KHBhcmVudFZpZXcsICdjb250cm9sbGVyJykgOiBudWxs
        OwogIH0pLnByb3BlcnR5KCdfcGFyZW50VmlldycpLAoKICAvKioKICAgIEEg
        dmlldyBtYXkgY29udGFpbiBhIGxheW91dC4gQSBsYXlvdXQgaXMgYSByZWd1
        bGFyIHRlbXBsYXRlIGJ1dAogICAgc3VwZXJzZWRlcyB0aGUgYHRlbXBsYXRl
        YCBwcm9wZXJ0eSBkdXJpbmcgcmVuZGVyaW5nLiBJdCBpcyB0aGUKICAgIHJl
        c3BvbnNpYmlsaXR5IG9mIHRoZSBsYXlvdXQgdGVtcGxhdGUgdG8gcmV0cmll
        dmUgdGhlIGB0ZW1wbGF0ZWAKICAgIHByb3BlcnR5IGZyb20gdGhlIHZpZXcg
        KG9yIGFsdGVybmF0aXZlbHksIGNhbGwgYEhhbmRsZWJhcnMuaGVscGVycy55
        aWVsZGAsCiAgICBge3t5aWVsZH19YCkgdG8gcmVuZGVyIGl0IGluIHRoZSBj
        b3JyZWN0IGxvY2F0aW9uLgoKICAgIFRoaXMgaXMgdXNlZnVsIGZvciBhIHZp
        ZXcgdGhhdCBoYXMgYSBzaGFyZWQgd3JhcHBlciwgYnV0IHdoaWNoIGRlbGVn
        YXRlcwogICAgdGhlIHJlbmRlcmluZyBvZiB0aGUgY29udGVudHMgb2YgdGhl
        IHdyYXBwZXIgdG8gdGhlIGB0ZW1wbGF0ZWAgcHJvcGVydHkKICAgIG9uIGEg
        c3ViY2xhc3MuCgogICAgQHByb3BlcnR5IGxheW91dAogICAgQHR5cGUgRnVu
        Y3Rpb24KICAqLwogIGxheW91dDogRW1iZXIuY29tcHV0ZWQoZnVuY3Rpb24o
        a2V5KSB7CiAgICB2YXIgbGF5b3V0TmFtZSA9IGdldCh0aGlzLCAnbGF5b3V0
        TmFtZScpLAogICAgICAgIGxheW91dCA9IHRoaXMudGVtcGxhdGVGb3JOYW1l
        KGxheW91dE5hbWUsICdsYXlvdXQnKTsKCiAgICBFbWJlci5hc3NlcnQoIllv
        dSBzcGVjaWZpZWQgdGhlIGxheW91dE5hbWUgIiArIGxheW91dE5hbWUgKyAi
        IGZvciAiICsgdGhpcyArICIsIGJ1dCBpdCBkaWQgbm90IGV4aXN0LiIsICFs
        YXlvdXROYW1lIHx8IGxheW91dCk7CgogICAgcmV0dXJuIGxheW91dCB8fCBn
        ZXQodGhpcywgJ2RlZmF1bHRMYXlvdXQnKTsKICB9KS5wcm9wZXJ0eSgnbGF5
        b3V0TmFtZScpLAoKICBfeWllbGQ6IGZ1bmN0aW9uKGNvbnRleHQsIG9wdGlv
        bnMpIHsKICAgIHZhciB0ZW1wbGF0ZSA9IGdldCh0aGlzLCAndGVtcGxhdGUn
        KTsKICAgIGlmICh0ZW1wbGF0ZSkgeyB0ZW1wbGF0ZShjb250ZXh0LCBvcHRp
        b25zKTsgfQogIH0sCgogIHRlbXBsYXRlRm9yTmFtZTogZnVuY3Rpb24obmFt
        ZSwgdHlwZSkgewogICAgaWYgKCFuYW1lKSB7IHJldHVybjsgfQogICAgRW1i
        ZXIuYXNzZXJ0KCJ0ZW1wbGF0ZU5hbWVzIGFyZSBub3QgYWxsb3dlZCB0byBj
        b250YWluIHBlcmlvZHM6ICIrbmFtZSwgbmFtZS5pbmRleE9mKCcuJykgPT09
        IC0xKTsKCiAgICAvLyB0aGUgZGVmYXVsdENvbnRhaW5lciBpcyBkZXByZWNh
        dGVkCiAgICB2YXIgY29udGFpbmVyID0gdGhpcy5jb250YWluZXIgfHwgKEVt
        YmVyLkNvbnRhaW5lciAmJiBFbWJlci5Db250YWluZXIuZGVmYXVsdENvbnRh
        aW5lcik7CiAgICByZXR1cm4gY29udGFpbmVyICYmIGNvbnRhaW5lci5sb29r
        dXAoJ3RlbXBsYXRlOicgKyBuYW1lKTsKICB9LAoKICAvKioKICAgIFRoZSBv
        YmplY3QgZnJvbSB3aGljaCB0ZW1wbGF0ZXMgc2hvdWxkIGFjY2VzcyBwcm9w
        ZXJ0aWVzLgoKICAgIFRoaXMgb2JqZWN0IHdpbGwgYmUgcGFzc2VkIHRvIHRo
        ZSB0ZW1wbGF0ZSBmdW5jdGlvbiBlYWNoIHRpbWUgdGhlIHJlbmRlcgogICAg
        bWV0aG9kIGlzIGNhbGxlZCwgYnV0IGl0IGlzIHVwIHRvIHRoZSBpbmRpdmlk
        dWFsIGZ1bmN0aW9uIHRvIGRlY2lkZSB3aGF0CiAgICB0byBkbyB3aXRoIGl0
        LgoKICAgIEJ5IGRlZmF1bHQsIHRoaXMgd2lsbCBiZSB0aGUgdmlldydzIGNv
        bnRyb2xsZXIuCgogICAgQHByb3BlcnR5IGNvbnRleHQKICAgIEB0eXBlIE9i
        amVjdAogICovCiAgY29udGV4dDogRW1iZXIuY29tcHV0ZWQoZnVuY3Rpb24o
        a2V5LCB2YWx1ZSkgewogICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDIp
        IHsKICAgICAgc2V0KHRoaXMsICdfY29udGV4dCcsIHZhbHVlKTsKICAgICAg
        cmV0dXJuIHZhbHVlOwogICAgfSBlbHNlIHsKICAgICAgcmV0dXJuIGdldCh0
        aGlzLCAnX2NvbnRleHQnKTsKICAgIH0KICB9KS52b2xhdGlsZSgpLAoKICAv
        KioKICAgIEBwcml2YXRlCgogICAgUHJpdmF0ZSBjb3B5IG9mIHRoZSB2aWV3
        J3MgdGVtcGxhdGUgY29udGV4dC4gVGhpcyBjYW4gYmUgc2V0IGRpcmVjdGx5
        CiAgICBieSBIYW5kbGViYXJzIHdpdGhvdXQgdHJpZ2dlcmluZyB0aGUgb2Jz
        ZXJ2ZXIgdGhhdCBjYXVzZXMgdGhlIHZpZXcKICAgIHRvIGJlIHJlLXJlbmRl
        cmVkLgoKICAgIFRoZSBjb250ZXh0IG9mIGEgdmlldyBpcyBsb29rZWQgdXAg
        YXMgZm9sbG93czoKCiAgICAxLiBTdXBwbGllZCBjb250ZXh0ICh1c3VhbGx5
        IGJ5IEhhbmRsZWJhcnMpCiAgICAyLiBTcGVjaWZpZWQgY29udHJvbGxlcgog
        ICAgMy4gYHBhcmVudFZpZXdgJ3MgY29udGV4dCAoZm9yIGEgY2hpbGQgb2Yg
        YSBDb250YWluZXJWaWV3KQoKICAgIFRoZSBjb2RlIGluIEhhbmRsZWJhcnMg
        dGhhdCBvdmVycmlkZXMgdGhlIGBfY29udGV4dGAgcHJvcGVydHkgZmlyc3QK
        ICAgIGNoZWNrcyB0byBzZWUgd2hldGhlciB0aGUgdmlldyBoYXMgYSBzcGVj
        aWZpZWQgY29udHJvbGxlci4gVGhpcyBpcwogICAgc29tZXRoaW5nIG9mIGEg
        aGFjayBhbmQgc2hvdWxkIGJlIHJldmlzaXRlZC4KCiAgICBAcHJvcGVydHkg
        X2NvbnRleHQKICAqLwogIF9jb250ZXh0OiBFbWJlci5jb21wdXRlZChmdW5j
        dGlvbihrZXkpIHsKICAgIHZhciBwYXJlbnRWaWV3LCBjb250cm9sbGVyOwoK
        ICAgIGlmIChjb250cm9sbGVyID0gZ2V0KHRoaXMsICdjb250cm9sbGVyJykp
        IHsKICAgICAgcmV0dXJuIGNvbnRyb2xsZXI7CiAgICB9CgogICAgcGFyZW50
        VmlldyA9IHRoaXMuX3BhcmVudFZpZXc7CiAgICBpZiAocGFyZW50Vmlldykg
        ewogICAgICByZXR1cm4gZ2V0KHBhcmVudFZpZXcsICdfY29udGV4dCcpOwog
        ICAgfQoKICAgIHJldHVybiBudWxsOwogIH0pLAoKICAvKioKICAgIEBwcml2
        YXRlCgogICAgSWYgYSB2YWx1ZSB0aGF0IGFmZmVjdHMgdGVtcGxhdGUgcmVu
        ZGVyaW5nIGNoYW5nZXMsIHRoZSB2aWV3IHNob3VsZCBiZQogICAgcmUtcmVu
        ZGVyZWQgdG8gcmVmbGVjdCB0aGUgbmV3IHZhbHVlLgoKICAgIEBtZXRob2Qg
        X2NvbnRleHREaWRDaGFuZ2UKICAqLwogIF9jb250ZXh0RGlkQ2hhbmdlOiBF
        bWJlci5vYnNlcnZlcihmdW5jdGlvbigpIHsKICAgIHRoaXMucmVyZW5kZXIo
        KTsKICB9LCAnY29udGV4dCcpLAoKICAvKioKICAgIElmIGBmYWxzZWAsIHRo
        ZSB2aWV3IHdpbGwgYXBwZWFyIGhpZGRlbiBpbiBET00uCgogICAgQHByb3Bl
        cnR5IGlzVmlzaWJsZQogICAgQHR5cGUgQm9vbGVhbgogICAgQGRlZmF1bHQg
        bnVsbAogICovCiAgaXNWaXNpYmxlOiB0cnVlLAoKICAvKioKICAgIEBwcml2
        YXRlCgogICAgQXJyYXkgb2YgY2hpbGQgdmlld3MuIFlvdSBzaG91bGQgbmV2
        ZXIgZWRpdCB0aGlzIGFycmF5IGRpcmVjdGx5LgogICAgSW5zdGVhZCwgdXNl
        IGBhcHBlbmRDaGlsZGAgYW5kIGByZW1vdmVGcm9tUGFyZW50YC4KCiAgICBA
        cHJvcGVydHkgY2hpbGRWaWV3cwogICAgQHR5cGUgQXJyYXkKICAgIEBkZWZh
        dWx0IFtdCiAgKi8KICBjaGlsZFZpZXdzOiBjaGlsZFZpZXdzUHJvcGVydHks
        CgogIF9jaGlsZFZpZXdzOiBFTVBUWV9BUlJBWSwKCiAgLy8gV2hlbiBpdCdz
        IGEgdmlydHVhbCB2aWV3LCB3ZSBuZWVkIHRvIG5vdGlmeSB0aGUgcGFyZW50
        IHRoYXQgdGhlaXIKICAvLyBjaGlsZFZpZXdzIHdpbGwgY2hhbmdlLgogIF9j
        aGlsZFZpZXdzV2lsbENoYW5nZTogRW1iZXIuYmVmb3JlT2JzZXJ2ZXIoZnVu
        Y3Rpb24oKSB7CiAgICBpZiAodGhpcy5pc1ZpcnR1YWwpIHsKICAgICAgdmFy
        IHBhcmVudFZpZXcgPSBnZXQodGhpcywgJ3BhcmVudFZpZXcnKTsKICAgICAg
        aWYgKHBhcmVudFZpZXcpIHsgRW1iZXIucHJvcGVydHlXaWxsQ2hhbmdlKHBh
        cmVudFZpZXcsICdjaGlsZFZpZXdzJyk7IH0KICAgIH0KICB9LCAnY2hpbGRW
        aWV3cycpLAoKICAvLyBXaGVuIGl0J3MgYSB2aXJ0dWFsIHZpZXcsIHdlIG5l
        ZWQgdG8gbm90aWZ5IHRoZSBwYXJlbnQgdGhhdCB0aGVpcgogIC8vIGNoaWxk
        Vmlld3MgZGlkIGNoYW5nZS4KICBfY2hpbGRWaWV3c0RpZENoYW5nZTogRW1i
        ZXIub2JzZXJ2ZXIoZnVuY3Rpb24oKSB7CiAgICBpZiAodGhpcy5pc1ZpcnR1
        YWwpIHsKICAgICAgdmFyIHBhcmVudFZpZXcgPSBnZXQodGhpcywgJ3BhcmVu
        dFZpZXcnKTsKICAgICAgaWYgKHBhcmVudFZpZXcpIHsgRW1iZXIucHJvcGVy
        dHlEaWRDaGFuZ2UocGFyZW50VmlldywgJ2NoaWxkVmlld3MnKTsgfQogICAg
        fQogIH0sICdjaGlsZFZpZXdzJyksCgogIC8qKgogICAgUmV0dXJuIHRoZSBu
        ZWFyZXN0IGFuY2VzdG9yIHRoYXQgaXMgYW4gaW5zdGFuY2Ugb2YgdGhlIHBy
        b3ZpZGVkCiAgICBjbGFzcy4KCiAgICBAcHJvcGVydHkgbmVhcmVzdEluc3Rh
        bmNlT2YKICAgIEBwYXJhbSB7Q2xhc3N9IGtsYXNzIFN1YmNsYXNzIG9mIEVt
        YmVyLlZpZXcgKG9yIEVtYmVyLlZpZXcgaXRzZWxmKQogICAgQHJldHVybiBF
        bWJlci5WaWV3CiAgICBAZGVwcmVjYXRlZAogICovCiAgbmVhcmVzdEluc3Rh
        bmNlT2Y6IGZ1bmN0aW9uKGtsYXNzKSB7CiAgICBFbWJlci5kZXByZWNhdGUo
        Im5lYXJlc3RJbnN0YW5jZU9mIGlzIGRlcHJlY2F0ZWQgYW5kIHdpbGwgYmUg
        cmVtb3ZlZCBmcm9tIGZ1dHVyZSByZWxlYXNlcy4gVXNlIG5lYXJlc3RPZlR5
        cGUuIik7CiAgICB2YXIgdmlldyA9IGdldCh0aGlzLCAncGFyZW50Vmlldycp
        OwoKICAgIHdoaWxlICh2aWV3KSB7CiAgICAgIGlmICh2aWV3IGluc3RhbmNl
        b2Yga2xhc3MpIHsgcmV0dXJuIHZpZXc7IH0KICAgICAgdmlldyA9IGdldCh2
        aWV3LCAncGFyZW50VmlldycpOwogICAgfQogIH0sCgogIC8qKgogICAgUmV0
        dXJuIHRoZSBuZWFyZXN0IGFuY2VzdG9yIHRoYXQgaXMgYW4gaW5zdGFuY2Ug
        b2YgdGhlIHByb3ZpZGVkCiAgICBjbGFzcyBvciBtaXhpbi4KCiAgICBAcHJv
        cGVydHkgbmVhcmVzdE9mVHlwZQogICAgQHBhcmFtIHtDbGFzcyxNaXhpbn0g
        a2xhc3MgU3ViY2xhc3Mgb2YgRW1iZXIuVmlldyAob3IgRW1iZXIuVmlldyBp
        dHNlbGYpLAogICAgICAgICAgIG9yIGFuIGluc3RhbmNlIG9mIEVtYmVyLk1p
        eGluLgogICAgQHJldHVybiBFbWJlci5WaWV3CiAgKi8KICBuZWFyZXN0T2ZU
        eXBlOiBmdW5jdGlvbihrbGFzcykgewogICAgdmFyIHZpZXcgPSBnZXQodGhp
        cywgJ3BhcmVudFZpZXcnKSwKICAgICAgICBpc09mVHlwZSA9IGtsYXNzIGlu
        c3RhbmNlb2YgRW1iZXIuTWl4aW4gPwogICAgICAgICAgICAgICAgICAgZnVu
        Y3Rpb24odmlldykgeyByZXR1cm4ga2xhc3MuZGV0ZWN0KHZpZXcpOyB9IDoK
        ICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uKHZpZXcpIHsgcmV0dXJuIGts
        YXNzLmRldGVjdCh2aWV3LmNvbnN0cnVjdG9yKTsgfTsKCiAgICB3aGlsZSAo
        dmlldykgewogICAgICBpZiAoaXNPZlR5cGUodmlldykpIHsgcmV0dXJuIHZp
        ZXc7IH0KICAgICAgdmlldyA9IGdldCh2aWV3LCAncGFyZW50VmlldycpOwog
        ICAgfQogIH0sCgogIC8qKgogICAgUmV0dXJuIHRoZSBuZWFyZXN0IGFuY2Vz
        dG9yIHRoYXQgaGFzIGEgZ2l2ZW4gcHJvcGVydHkuCgogICAgQHByb3BlcnR5
        IG5lYXJlc3RXaXRoUHJvcGVydHkKICAgIEBwYXJhbSB7U3RyaW5nfSBwcm9w
        ZXJ0eSBBIHByb3BlcnR5IG5hbWUKICAgIEByZXR1cm4gRW1iZXIuVmlldwog
        ICovCiAgbmVhcmVzdFdpdGhQcm9wZXJ0eTogZnVuY3Rpb24ocHJvcGVydHkp
        IHsKICAgIHZhciB2aWV3ID0gZ2V0KHRoaXMsICdwYXJlbnRWaWV3Jyk7Cgog
        ICAgd2hpbGUgKHZpZXcpIHsKICAgICAgaWYgKHByb3BlcnR5IGluIHZpZXcp
        IHsgcmV0dXJuIHZpZXc7IH0KICAgICAgdmlldyA9IGdldCh2aWV3LCAncGFy
        ZW50VmlldycpOwogICAgfQogIH0sCgogIC8qKgogICAgUmV0dXJuIHRoZSBu
        ZWFyZXN0IGFuY2VzdG9yIHdob3NlIHBhcmVudCBpcyBhbiBpbnN0YW5jZSBv
        ZgogICAgYGtsYXNzYC4KCiAgICBAcHJvcGVydHkgbmVhcmVzdENoaWxkT2YK
        ICAgIEBwYXJhbSB7Q2xhc3N9IGtsYXNzIFN1YmNsYXNzIG9mIEVtYmVyLlZp
        ZXcgKG9yIEVtYmVyLlZpZXcgaXRzZWxmKQogICAgQHJldHVybiBFbWJlci5W
        aWV3CiAgKi8KICBuZWFyZXN0Q2hpbGRPZjogZnVuY3Rpb24oa2xhc3MpIHsK
        ICAgIHZhciB2aWV3ID0gZ2V0KHRoaXMsICdwYXJlbnRWaWV3Jyk7CgogICAg
        d2hpbGUgKHZpZXcpIHsKICAgICAgaWYgKGdldCh2aWV3LCAncGFyZW50Vmll
        dycpIGluc3RhbmNlb2Yga2xhc3MpIHsgcmV0dXJuIHZpZXc7IH0KICAgICAg
        dmlldyA9IGdldCh2aWV3LCAncGFyZW50VmlldycpOwogICAgfQogIH0sCgog
        IC8qKgogICAgQHByaXZhdGUKCiAgICBXaGVuIHRoZSBwYXJlbnQgdmlldyBj
        aGFuZ2VzLCByZWN1cnNpdmVseSBpbnZhbGlkYXRlIGBjb250cm9sbGVyYAoK
        ICAgIEBtZXRob2QgX3BhcmVudFZpZXdEaWRDaGFuZ2UKICAqLwogIF9wYXJl
        bnRWaWV3RGlkQ2hhbmdlOiBFbWJlci5vYnNlcnZlcihmdW5jdGlvbigpIHsK
        ICAgIGlmICh0aGlzLmlzRGVzdHJveWluZykgeyByZXR1cm47IH0KCiAgICB0
        aGlzLnRyaWdnZXIoJ3BhcmVudFZpZXdEaWRDaGFuZ2UnKTsKCiAgICBpZiAo
        Z2V0KHRoaXMsICdwYXJlbnRWaWV3LmNvbnRyb2xsZXInKSAmJiAhZ2V0KHRo
        aXMsICdjb250cm9sbGVyJykpIHsKICAgICAgdGhpcy5ub3RpZnlQcm9wZXJ0
        eUNoYW5nZSgnY29udHJvbGxlcicpOwogICAgfQogIH0sICdfcGFyZW50Vmll
        dycpLAoKICBfY29udHJvbGxlckRpZENoYW5nZTogRW1iZXIub2JzZXJ2ZXIo
        ZnVuY3Rpb24oKSB7CiAgICBpZiAodGhpcy5pc0Rlc3Ryb3lpbmcpIHsgcmV0
        dXJuOyB9CgogICAgdGhpcy5yZXJlbmRlcigpOwoKICAgIHRoaXMuZm9yRWFj
        aENoaWxkVmlldyhmdW5jdGlvbih2aWV3KSB7CiAgICAgIHZpZXcucHJvcGVy
        dHlEaWRDaGFuZ2UoJ2NvbnRyb2xsZXInKTsKICAgIH0pOwogIH0sICdjb250
        cm9sbGVyJyksCgogIGNsb25lS2V5d29yZHM6IGZ1bmN0aW9uKCkgewogICAg
        dmFyIHRlbXBsYXRlRGF0YSA9IGdldCh0aGlzLCAndGVtcGxhdGVEYXRhJyk7
        CgogICAgdmFyIGtleXdvcmRzID0gdGVtcGxhdGVEYXRhID8gRW1iZXIuY29w
        eSh0ZW1wbGF0ZURhdGEua2V5d29yZHMpIDoge307CiAgICBzZXQoa2V5d29y
        ZHMsICd2aWV3JywgZ2V0KHRoaXMsICdjb25jcmV0ZVZpZXcnKSk7CiAgICBz
        ZXQoa2V5d29yZHMsICdfdmlldycsIHRoaXMpOwogICAgc2V0KGtleXdvcmRz
        LCAnY29udHJvbGxlcicsIGdldCh0aGlzLCAnY29udHJvbGxlcicpKTsKCiAg
        ICByZXR1cm4ga2V5d29yZHM7CiAgfSwKCiAgLyoqCiAgICBDYWxsZWQgb24g
        eW91ciB2aWV3IHdoZW4gaXQgc2hvdWxkIHB1c2ggc3RyaW5ncyBvZiBIVE1M
        IGludG8gYQogICAgYEVtYmVyLlJlbmRlckJ1ZmZlcmAuIE1vc3QgdXNlcnMg
        d2lsbCB3YW50IHRvIG92ZXJyaWRlIHRoZSBgdGVtcGxhdGVgCiAgICBvciBg
        dGVtcGxhdGVOYW1lYCBwcm9wZXJ0aWVzIGluc3RlYWQgb2YgdGhpcyBtZXRo
        b2QuCgogICAgQnkgZGVmYXVsdCwgYEVtYmVyLlZpZXdgIHdpbGwgbG9vayBm
        b3IgYSBmdW5jdGlvbiBpbiB0aGUgYHRlbXBsYXRlYAogICAgcHJvcGVydHkg
        YW5kIGludm9rZSBpdCB3aXRoIHRoZSB2YWx1ZSBvZiBgY29udGV4dGAuIFRo
        ZSB2YWx1ZSBvZgogICAgYGNvbnRleHRgIHdpbGwgYmUgdGhlIHZpZXcncyBj
        b250cm9sbGVyIHVubGVzcyB5b3Ugb3ZlcnJpZGUgaXQuCgogICAgQG1ldGhv
        ZCByZW5kZXIKICAgIEBwYXJhbSB7RW1iZXIuUmVuZGVyQnVmZmVyfSBidWZm
        ZXIgVGhlIHJlbmRlciBidWZmZXIKICAqLwogIHJlbmRlcjogZnVuY3Rpb24o
        YnVmZmVyKSB7CiAgICAvLyBJZiB0aGlzIHZpZXcgaGFzIGEgbGF5b3V0LCBp
        dCBpcyB0aGUgcmVzcG9uc2liaWxpdHkgb2YgdGhlCiAgICAvLyB0aGUgbGF5
        b3V0IHRvIHJlbmRlciB0aGUgdmlldydzIHRlbXBsYXRlLiBPdGhlcndpc2Us
        IHJlbmRlciB0aGUgdGVtcGxhdGUKICAgIC8vIGRpcmVjdGx5LgogICAgdmFy
        IHRlbXBsYXRlID0gZ2V0KHRoaXMsICdsYXlvdXQnKSB8fCBnZXQodGhpcywg
        J3RlbXBsYXRlJyk7CgogICAgaWYgKHRlbXBsYXRlKSB7CiAgICAgIHZhciBj
        b250ZXh0ID0gZ2V0KHRoaXMsICdjb250ZXh0Jyk7CiAgICAgIHZhciBrZXl3
        b3JkcyA9IHRoaXMuY2xvbmVLZXl3b3JkcygpOwogICAgICB2YXIgb3V0cHV0
        OwoKICAgICAgdmFyIGRhdGEgPSB7CiAgICAgICAgdmlldzogdGhpcywKICAg
        ICAgICBidWZmZXI6IGJ1ZmZlciwKICAgICAgICBpc1JlbmRlckRhdGE6IHRy
        dWUsCiAgICAgICAga2V5d29yZHM6IGtleXdvcmRzLAogICAgICAgIGluc2lk
        ZUdyb3VwOiBnZXQodGhpcywgJ3RlbXBsYXRlRGF0YS5pbnNpZGVHcm91cCcp
        CiAgICAgIH07CgogICAgICAvLyBJbnZva2UgdGhlIHRlbXBsYXRlIHdpdGgg
        dGhlIHByb3ZpZGVkIHRlbXBsYXRlIGNvbnRleHQsIHdoaWNoCiAgICAgIC8v
        IGlzIHRoZSB2aWV3J3MgY29udHJvbGxlciBieSBkZWZhdWx0LiBBIGhhc2gg
        b2YgZGF0YSBpcyBhbHNvIHBhc3NlZCB0aGF0IHByb3ZpZGVzCiAgICAgIC8v
        IHRoZSB0ZW1wbGF0ZSB3aXRoIGFjY2VzcyB0byB0aGUgdmlldyBhbmQgcmVu
        ZGVyIGJ1ZmZlci4KCiAgICAgIEVtYmVyLmFzc2VydCgndGVtcGxhdGUgbXVz
        dCBiZSBhIGZ1bmN0aW9uLiBEaWQgeW91IG1lYW4gdG8gY2FsbCBFbWJlci5I
        YW5kbGViYXJzLmNvbXBpbGUoIi4uLiIpIG9yIHNwZWNpZnkgdGVtcGxhdGVO
        YW1lIGluc3RlYWQ/JywgdHlwZW9mIHRlbXBsYXRlID09PSAnZnVuY3Rpb24n
        KTsKICAgICAgLy8gVGhlIHRlbXBsYXRlIHNob3VsZCB3cml0ZSBkaXJlY3Rs
        eSB0byB0aGUgcmVuZGVyIGJ1ZmZlciBpbnN0ZWFkCiAgICAgIC8vIG9mIHJl
        dHVybmluZyBhIHN0cmluZy4KICAgICAgb3V0cHV0ID0gdGVtcGxhdGUoY29u
        dGV4dCwgeyBkYXRhOiBkYXRhIH0pOwoKICAgICAgLy8gSWYgdGhlIHRlbXBs
        YXRlIHJldHVybmVkIGEgc3RyaW5nIGluc3RlYWQgb2Ygd3JpdGluZyB0byB0
        aGUgYnVmZmVyLAogICAgICAvLyBwdXNoIHRoZSBzdHJpbmcgb250byB0aGUg
        YnVmZmVyLgogICAgICBpZiAob3V0cHV0ICE9PSB1bmRlZmluZWQpIHsgYnVm
        ZmVyLnB1c2gob3V0cHV0KTsgfQogICAgfQogIH0sCgogIC8qKgogICAgUmVu
        ZGVycyB0aGUgdmlldyBhZ2Fpbi4gVGhpcyB3aWxsIHdvcmsgcmVnYXJkbGVz
        cyBvZiB3aGV0aGVyIHRoZQogICAgdmlldyBpcyBhbHJlYWR5IGluIHRoZSBE
        T00gb3Igbm90LiBJZiB0aGUgdmlldyBpcyBpbiB0aGUgRE9NLCB0aGUKICAg
        IHJlbmRlcmluZyBwcm9jZXNzIHdpbGwgYmUgZGVmZXJyZWQgdG8gZ2l2ZSBi
        aW5kaW5ncyBhIGNoYW5jZQogICAgdG8gc3luY2hyb25pemUuCgogICAgSWYg
        Y2hpbGRyZW4gd2VyZSBhZGRlZCBkdXJpbmcgdGhlIHJlbmRlcmluZyBwcm9j
        ZXNzIHVzaW5nIGBhcHBlbmRDaGlsZGAsCiAgICBgcmVyZW5kZXJgIHdpbGwg
        cmVtb3ZlIHRoZW0sIGJlY2F1c2UgdGhleSB3aWxsIGJlIGFkZGVkIGFnYWlu
        CiAgICBpZiBuZWVkZWQgYnkgdGhlIG5leHQgYHJlbmRlcmAuCgogICAgSW4g
        Z2VuZXJhbCwgaWYgdGhlIGRpc3BsYXkgb2YgeW91ciB2aWV3IGNoYW5nZXMs
        IHlvdSBzaG91bGQgbW9kaWZ5CiAgICB0aGUgRE9NIGVsZW1lbnQgZGlyZWN0
        bHkgaW5zdGVhZCBvZiBtYW51YWxseSBjYWxsaW5nIGByZXJlbmRlcmAsIHdo
        aWNoIGNhbgogICAgYmUgc2xvdy4KCiAgICBAbWV0aG9kIHJlcmVuZGVyCiAg
        Ki8KICByZXJlbmRlcjogZnVuY3Rpb24oKSB7CiAgICByZXR1cm4gdGhpcy5j
        dXJyZW50U3RhdGUucmVyZW5kZXIodGhpcyk7CiAgfSwKCiAgY2xlYXJSZW5k
        ZXJlZENoaWxkcmVuOiBmdW5jdGlvbigpIHsKICAgIHZhciBsZW5ndGhCZWZv
        cmUgPSB0aGlzLmxlbmd0aEJlZm9yZVJlbmRlciwKICAgICAgICBsZW5ndGhB
        ZnRlciAgPSB0aGlzLmxlbmd0aEFmdGVyUmVuZGVyOwoKICAgIC8vIElmIHRo
        ZXJlIHdlcmUgY2hpbGQgdmlld3MgY3JlYXRlZCBkdXJpbmcgdGhlIGxhc3Qg
        Y2FsbCB0byByZW5kZXIoKSwKICAgIC8vIHJlbW92ZSB0aGVtIHVuZGVyIHRo
        ZSBhc3N1bXB0aW9uIHRoYXQgdGhleSB3aWxsIGJlIHJlLWNyZWF0ZWQgd2hl
        bgogICAgLy8gd2UgcmUtcmVuZGVyLgoKICAgIC8vIFZJRVctVE9ETzogVW5p
        dCB0ZXN0IHRoaXMgcGF0aC4KICAgIHZhciBjaGlsZFZpZXdzID0gdGhpcy5f
        Y2hpbGRWaWV3czsKICAgIGZvciAodmFyIGk9bGVuZ3RoQWZ0ZXItMTsgaT49
        bGVuZ3RoQmVmb3JlOyBpLS0pIHsKICAgICAgaWYgKGNoaWxkVmlld3NbaV0p
        IHsgY2hpbGRWaWV3c1tpXS5kZXN0cm95KCk7IH0KICAgIH0KICB9LAoKICAv
        KioKICAgIEBwcml2YXRlCgogICAgSXRlcmF0ZXMgb3ZlciB0aGUgdmlldydz
        IGBjbGFzc05hbWVCaW5kaW5nc2AgYXJyYXksIGluc2VydHMgdGhlIHZhbHVl
        CiAgICBvZiB0aGUgc3BlY2lmaWVkIHByb3BlcnR5IGludG8gdGhlIGBjbGFz
        c05hbWVzYCBhcnJheSwgdGhlbiBjcmVhdGVzIGFuCiAgICBvYnNlcnZlciB0
        byB1cGRhdGUgdGhlIHZpZXcncyBlbGVtZW50IGlmIHRoZSBib3VuZCBwcm9w
        ZXJ0eSBldmVyIGNoYW5nZXMKICAgIGluIHRoZSBmdXR1cmUuCgogICAgQG1l
        dGhvZCBfYXBwbHlDbGFzc05hbWVCaW5kaW5ncwogICovCiAgX2FwcGx5Q2xh
        c3NOYW1lQmluZGluZ3M6IGZ1bmN0aW9uKGNsYXNzQmluZGluZ3MpIHsKICAg
        IHZhciBjbGFzc05hbWVzID0gdGhpcy5jbGFzc05hbWVzLAogICAgZWxlbSwg
        bmV3Q2xhc3MsIGRhc2hlcml6ZWRDbGFzczsKCiAgICAvLyBMb29wIHRocm91
        Z2ggYWxsIG9mIHRoZSBjb25maWd1cmVkIGJpbmRpbmdzLiBUaGVzZSB3aWxs
        IGJlIGVpdGhlcgogICAgLy8gcHJvcGVydHkgbmFtZXMgKCdpc1VyZ2VudCcp
        IG9yIHByb3BlcnR5IHBhdGhzIHJlbGF0aXZlIHRvIHRoZSB2aWV3CiAgICAv
        LyAoJ2NvbnRlbnQuaXNVcmdlbnQnKQogICAgYV9mb3JFYWNoKGNsYXNzQmlu
        ZGluZ3MsIGZ1bmN0aW9uKGJpbmRpbmcpIHsKCiAgICAgIC8vIFZhcmlhYmxl
        IGluIHdoaWNoIHRoZSBvbGQgY2xhc3MgdmFsdWUgaXMgc2F2ZWQuIFRoZSBv
        YnNlcnZlciBmdW5jdGlvbgogICAgICAvLyBjbG9zZXMgb3ZlciB0aGlzIHZh
        cmlhYmxlLCBzbyBpdCBrbm93cyB3aGljaCBzdHJpbmcgdG8gcmVtb3ZlIHdo
        ZW4KICAgICAgLy8gdGhlIHByb3BlcnR5IGNoYW5nZXMuCiAgICAgIHZhciBv
        bGRDbGFzczsKICAgICAgLy8gRXh0cmFjdCBqdXN0IHRoZSBwcm9wZXJ0eSBu
        YW1lIGZyb20gYmluZGluZ3MgbGlrZSAnZm9vOmJhcicKICAgICAgdmFyIHBh
        cnNlZFBhdGggPSBFbWJlci5WaWV3Ll9wYXJzZVByb3BlcnR5UGF0aChiaW5k
        aW5nKTsKCiAgICAgIC8vIFNldCB1cCBhbiBvYnNlcnZlciBvbiB0aGUgY29u
        dGV4dC4gSWYgdGhlIHByb3BlcnR5IGNoYW5nZXMsIHRvZ2dsZSB0aGUKICAg
        ICAgLy8gY2xhc3MgbmFtZS4KICAgICAgdmFyIG9ic2VydmVyID0gZnVuY3Rp
        b24oKSB7CiAgICAgICAgLy8gR2V0IHRoZSBjdXJyZW50IHZhbHVlIG9mIHRo
        ZSBwcm9wZXJ0eQogICAgICAgIG5ld0NsYXNzID0gdGhpcy5fY2xhc3NTdHJp
        bmdGb3JQcm9wZXJ0eShiaW5kaW5nKTsKICAgICAgICBlbGVtID0gdGhpcy4k
        KCk7CgogICAgICAgIC8vIElmIHdlIGhhZCBwcmV2aW91c2x5IGFkZGVkIGEg
        Y2xhc3MgdG8gdGhlIGVsZW1lbnQsIHJlbW92ZSBpdC4KICAgICAgICBpZiAo
        b2xkQ2xhc3MpIHsKICAgICAgICAgIGVsZW0ucmVtb3ZlQ2xhc3Mob2xkQ2xh
        c3MpOwogICAgICAgICAgLy8gQWxzbyByZW1vdmUgZnJvbSBjbGFzc05hbWVz
        IHNvIHRoYXQgaWYgdGhlIHZpZXcgZ2V0cyByZXJlbmRlcmVkLAogICAgICAg
        ICAgLy8gdGhlIGNsYXNzIGRvZXNuJ3QgZ2V0IGFkZGVkIGJhY2sgdG8gdGhl
        IERPTS4KICAgICAgICAgIGNsYXNzTmFtZXMucmVtb3ZlT2JqZWN0KG9sZENs
        YXNzKTsKICAgICAgICB9CgogICAgICAgIC8vIElmIG5lY2Vzc2FyeSwgYWRk
        IGEgbmV3IGNsYXNzLiBNYWtlIHN1cmUgd2Uga2VlcCB0cmFjayBvZiBpdCBz
        bwogICAgICAgIC8vIGl0IGNhbiBiZSByZW1vdmVkIGluIHRoZSBmdXR1cmUu
        CiAgICAgICAgaWYgKG5ld0NsYXNzKSB7CiAgICAgICAgICBlbGVtLmFkZENs
        YXNzKG5ld0NsYXNzKTsKICAgICAgICAgIG9sZENsYXNzID0gbmV3Q2xhc3M7
        CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIG9sZENsYXNzID0gbnVsbDsK
        ICAgICAgICB9CiAgICAgIH07CgogICAgICAvLyBHZXQgdGhlIGNsYXNzIG5h
        bWUgZm9yIHRoZSBwcm9wZXJ0eSBhdCBpdHMgY3VycmVudCB2YWx1ZQogICAg
        ICBkYXNoZXJpemVkQ2xhc3MgPSB0aGlzLl9jbGFzc1N0cmluZ0ZvclByb3Bl
        cnR5KGJpbmRpbmcpOwoKICAgICAgaWYgKGRhc2hlcml6ZWRDbGFzcykgewog
        ICAgICAgIC8vIEVuc3VyZSB0aGF0IGl0IGdldHMgaW50byB0aGUgY2xhc3NO
        YW1lcyBhcnJheQogICAgICAgIC8vIHNvIGl0IGlzIGRpc3BsYXllZCB3aGVu
        IHdlIHJlbmRlci4KICAgICAgICBhX2FkZE9iamVjdChjbGFzc05hbWVzLCBk
        YXNoZXJpemVkQ2xhc3MpOwoKICAgICAgICAvLyBTYXZlIGEgcmVmZXJlbmNl
        IHRvIHRoZSBjbGFzcyBuYW1lIHNvIHdlIGNhbiByZW1vdmUgaXQKICAgICAg
        ICAvLyBpZiB0aGUgb2JzZXJ2ZXIgZmlyZXMuIFJlbWVtYmVyIHRoYXQgdGhp
        cyB2YXJpYWJsZSBoYXMKICAgICAgICAvLyBiZWVuIGNsb3NlZCBvdmVyIGJ5
        IHRoZSBvYnNlcnZlci4KICAgICAgICBvbGRDbGFzcyA9IGRhc2hlcml6ZWRD
        bGFzczsKICAgICAgfQoKICAgICAgdGhpcy5yZWdpc3Rlck9ic2VydmVyKHRo
        aXMsIHBhcnNlZFBhdGgucGF0aCwgb2JzZXJ2ZXIpOwogICAgICAvLyBSZW1v
        dmUgY2xhc3NOYW1lIHNvIHdoZW4gdGhlIHZpZXcgaXMgcmVyZW5kZXJlZCwK
        ICAgICAgLy8gdGhlIGNsYXNzTmFtZSBpcyBhZGRlZCBiYXNlZCBvbiBiaW5k
        aW5nIHJlZXZhbHVhdGlvbgogICAgICB0aGlzLm9uZSgnd2lsbENsZWFyUmVu
        ZGVyJywgZnVuY3Rpb24oKSB7CiAgICAgICAgaWYgKG9sZENsYXNzKSB7CiAg
        ICAgICAgICBjbGFzc05hbWVzLnJlbW92ZU9iamVjdChvbGRDbGFzcyk7CiAg
        ICAgICAgICBvbGRDbGFzcyA9IG51bGw7CiAgICAgICAgfQogICAgICB9KTsK
        CiAgICB9LCB0aGlzKTsKICB9LAoKICAvKioKICAgIEBwcml2YXRlCgogICAg
        SXRlcmF0ZXMgdGhyb3VnaCB0aGUgdmlldydzIGF0dHJpYnV0ZSBiaW5kaW5n
        cywgc2V0cyB1cCBvYnNlcnZlcnMgZm9yIGVhY2gsCiAgICB0aGVuIGFwcGxp
        ZXMgdGhlIGN1cnJlbnQgdmFsdWUgb2YgdGhlIGF0dHJpYnV0ZXMgdG8gdGhl
        IHBhc3NlZCByZW5kZXIgYnVmZmVyLgoKICAgIEBtZXRob2QgX2FwcGx5QXR0
        cmlidXRlQmluZGluZ3MKICAgIEBwYXJhbSB7RW1iZXIuUmVuZGVyQnVmZmVy
        fSBidWZmZXIKICAqLwogIF9hcHBseUF0dHJpYnV0ZUJpbmRpbmdzOiBmdW5j
        dGlvbihidWZmZXIsIGF0dHJpYnV0ZUJpbmRpbmdzKSB7CiAgICB2YXIgYXR0
        cmlidXRlVmFsdWUsIGVsZW07CgogICAgYV9mb3JFYWNoKGF0dHJpYnV0ZUJp
        bmRpbmdzLCBmdW5jdGlvbihiaW5kaW5nKSB7CiAgICAgIHZhciBzcGxpdCA9
        IGJpbmRpbmcuc3BsaXQoJzonKSwKICAgICAgICAgIHByb3BlcnR5ID0gc3Bs
        aXRbMF0sCiAgICAgICAgICBhdHRyaWJ1dGVOYW1lID0gc3BsaXRbMV0gfHwg
        cHJvcGVydHk7CgogICAgICAvLyBDcmVhdGUgYW4gb2JzZXJ2ZXIgdG8gYWRk
        L3JlbW92ZS9jaGFuZ2UgdGhlIGF0dHJpYnV0ZSBpZiB0aGUKICAgICAgLy8g
        SmF2YVNjcmlwdCBwcm9wZXJ0eSBjaGFuZ2VzLgogICAgICB2YXIgb2JzZXJ2
        ZXIgPSBmdW5jdGlvbigpIHsKICAgICAgICBlbGVtID0gdGhpcy4kKCk7Cgog
        ICAgICAgIGF0dHJpYnV0ZVZhbHVlID0gZ2V0KHRoaXMsIHByb3BlcnR5KTsK
        CiAgICAgICAgRW1iZXIuVmlldy5hcHBseUF0dHJpYnV0ZUJpbmRpbmdzKGVs
        ZW0sIGF0dHJpYnV0ZU5hbWUsIGF0dHJpYnV0ZVZhbHVlKTsKICAgICAgfTsK
        CiAgICAgIHRoaXMucmVnaXN0ZXJPYnNlcnZlcih0aGlzLCBwcm9wZXJ0eSwg
        b2JzZXJ2ZXIpOwoKICAgICAgLy8gRGV0ZXJtaW5lIHRoZSBjdXJyZW50IHZh
        bHVlIGFuZCBhZGQgaXQgdG8gdGhlIHJlbmRlciBidWZmZXIKICAgICAgLy8g
        aWYgbmVjZXNzYXJ5LgogICAgICBhdHRyaWJ1dGVWYWx1ZSA9IGdldCh0aGlz
        LCBwcm9wZXJ0eSk7CiAgICAgIEVtYmVyLlZpZXcuYXBwbHlBdHRyaWJ1dGVC
        aW5kaW5ncyhidWZmZXIsIGF0dHJpYnV0ZU5hbWUsIGF0dHJpYnV0ZVZhbHVl
        KTsKICAgIH0sIHRoaXMpOwogIH0sCgogIC8qKgogICAgQHByaXZhdGUKCiAg
        ICBHaXZlbiBhIHByb3BlcnR5IG5hbWUsIHJldHVybnMgYSBkYXNoZXJpemVk
        IHZlcnNpb24gb2YgdGhhdAogICAgcHJvcGVydHkgbmFtZSBpZiB0aGUgcHJv
        cGVydHkgZXZhbHVhdGVzIHRvIGEgbm9uLWZhbHN5IHZhbHVlLgoKICAgIEZv
        ciBleGFtcGxlLCBpZiB0aGUgdmlldyBoYXMgcHJvcGVydHkgYGlzVXJnZW50
        YCB0aGF0IGV2YWx1YXRlcyB0byB0cnVlLAogICAgcGFzc2luZyBgaXNVcmdl
        bnRgIHRvIHRoaXMgbWV0aG9kIHdpbGwgcmV0dXJuIGAiaXMtdXJnZW50ImAu
        CgogICAgQG1ldGhvZCBfY2xhc3NTdHJpbmdGb3JQcm9wZXJ0eQogICAgQHBh
        cmFtIHByb3BlcnR5CiAgKi8KICBfY2xhc3NTdHJpbmdGb3JQcm9wZXJ0eTog
        ZnVuY3Rpb24ocHJvcGVydHkpIHsKICAgIHZhciBwYXJzZWRQYXRoID0gRW1i
        ZXIuVmlldy5fcGFyc2VQcm9wZXJ0eVBhdGgocHJvcGVydHkpOwogICAgdmFy
        IHBhdGggPSBwYXJzZWRQYXRoLnBhdGg7CgogICAgdmFyIHZhbCA9IGdldCh0
        aGlzLCBwYXRoKTsKICAgIGlmICh2YWwgPT09IHVuZGVmaW5lZCAmJiBFbWJl
        ci5pc0dsb2JhbFBhdGgocGF0aCkpIHsKICAgICAgdmFsID0gZ2V0KEVtYmVy
        Lmxvb2t1cCwgcGF0aCk7CiAgICB9CgogICAgcmV0dXJuIEVtYmVyLlZpZXcu
        X2NsYXNzU3RyaW5nRm9yVmFsdWUocGF0aCwgdmFsLCBwYXJzZWRQYXRoLmNs
        YXNzTmFtZSwgcGFyc2VkUGF0aC5mYWxzeUNsYXNzTmFtZSk7CiAgfSwKCiAg
        Ly8gLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4u
        Li4uLi4uLi4uLi4uLi4uLgogIC8vIEVMRU1FTlQgU1VQUE9SVAogIC8vCgog
        IC8qKgogICAgUmV0dXJucyB0aGUgY3VycmVudCBET00gZWxlbWVudCBmb3Ig
        dGhlIHZpZXcuCgogICAgQHByb3BlcnR5IGVsZW1lbnQKICAgIEB0eXBlIERP
        TUVsZW1lbnQKICAqLwogIGVsZW1lbnQ6IEVtYmVyLmNvbXB1dGVkKGZ1bmN0
        aW9uKGtleSwgdmFsdWUpIHsKICAgIGlmICh2YWx1ZSAhPT0gdW5kZWZpbmVk
        KSB7CiAgICAgIHJldHVybiB0aGlzLmN1cnJlbnRTdGF0ZS5zZXRFbGVtZW50
        KHRoaXMsIHZhbHVlKTsKICAgIH0gZWxzZSB7CiAgICAgIHJldHVybiB0aGlz
        LmN1cnJlbnRTdGF0ZS5nZXRFbGVtZW50KHRoaXMpOwogICAgfQogIH0pLnBy
        b3BlcnR5KCdfcGFyZW50VmlldycpLAoKICAvKioKICAgIFJldHVybnMgYSBq
        UXVlcnkgb2JqZWN0IGZvciB0aGlzIHZpZXcncyBlbGVtZW50LiBJZiB5b3Ug
        cGFzcyBpbiBhIHNlbGVjdG9yCiAgICBzdHJpbmcsIHRoaXMgbWV0aG9kIHdp
        bGwgcmV0dXJuIGEgalF1ZXJ5IG9iamVjdCwgdXNpbmcgdGhlIGN1cnJlbnQg
        ZWxlbWVudAogICAgYXMgaXRzIGJ1ZmZlci4KCiAgICBGb3IgZXhhbXBsZSwg
        Y2FsbGluZyBgdmlldy4kKCdsaScpYCB3aWxsIHJldHVybiBhIGpRdWVyeSBv
        YmplY3QgY29udGFpbmluZwogICAgYWxsIG9mIHRoZSBgbGlgIGVsZW1lbnRz
        IGluc2lkZSB0aGUgRE9NIGVsZW1lbnQgb2YgdGhpcyB2aWV3LgoKICAgIEBt
        ZXRob2QgJAogICAgQHBhcmFtIHtTdHJpbmd9IFtzZWxlY3Rvcl0gYSBqUXVl
        cnktY29tcGF0aWJsZSBzZWxlY3RvciBzdHJpbmcKICAgIEByZXR1cm4ge2pR
        dWVyeX0gdGhlIGpRdWVyeSBvYmplY3QgZm9yIHRoZSBET00gbm9kZQogICov
        CiAgJDogZnVuY3Rpb24oc2VsKSB7CiAgICByZXR1cm4gdGhpcy5jdXJyZW50
        U3RhdGUuJCh0aGlzLCBzZWwpOwogIH0sCgogIG11dGF0ZUNoaWxkVmlld3M6
        IGZ1bmN0aW9uKGNhbGxiYWNrKSB7CiAgICB2YXIgY2hpbGRWaWV3cyA9IHRo
        aXMuX2NoaWxkVmlld3MsCiAgICAgICAgaWR4ID0gY2hpbGRWaWV3cy5sZW5n
        dGgsCiAgICAgICAgdmlldzsKCiAgICB3aGlsZSgtLWlkeCA+PSAwKSB7CiAg
        ICAgIHZpZXcgPSBjaGlsZFZpZXdzW2lkeF07CiAgICAgIGNhbGxiYWNrKHRo
        aXMsIHZpZXcsIGlkeCk7CiAgICB9CgogICAgcmV0dXJuIHRoaXM7CiAgfSwK
        CiAgZm9yRWFjaENoaWxkVmlldzogZnVuY3Rpb24oY2FsbGJhY2spIHsKICAg
        IHZhciBjaGlsZFZpZXdzID0gdGhpcy5fY2hpbGRWaWV3czsKCiAgICBpZiAo
        IWNoaWxkVmlld3MpIHsgcmV0dXJuIHRoaXM7IH0KCiAgICB2YXIgbGVuID0g
        Y2hpbGRWaWV3cy5sZW5ndGgsCiAgICAgICAgdmlldywgaWR4OwoKICAgIGZv
        ciAoaWR4ID0gMDsgaWR4IDwgbGVuOyBpZHgrKykgewogICAgICB2aWV3ID0g
        Y2hpbGRWaWV3c1tpZHhdOwogICAgICBjYWxsYmFjayh2aWV3KTsKICAgIH0K
        CiAgICByZXR1cm4gdGhpczsKICB9LAoKICAvKioKICAgIEFwcGVuZHMgdGhl
        IHZpZXcncyBlbGVtZW50IHRvIHRoZSBzcGVjaWZpZWQgcGFyZW50IGVsZW1l
        bnQuCgogICAgSWYgdGhlIHZpZXcgZG9lcyBub3QgaGF2ZSBhbiBIVE1MIHJl
        cHJlc2VudGF0aW9uIHlldCwgYGNyZWF0ZUVsZW1lbnQoKWAKICAgIHdpbGwg
        YmUgY2FsbGVkIGF1dG9tYXRpY2FsbHkuCgogICAgTm90ZSB0aGF0IHRoaXMg
        bWV0aG9kIGp1c3Qgc2NoZWR1bGVzIHRoZSB2aWV3IHRvIGJlIGFwcGVuZGVk
        OyB0aGUgRE9NCiAgICBlbGVtZW50IHdpbGwgbm90IGJlIGFwcGVuZGVkIHRv
        IHRoZSBnaXZlbiBlbGVtZW50IHVudGlsIGFsbCBiaW5kaW5ncyBoYXZlCiAg
        ICBmaW5pc2hlZCBzeW5jaHJvbml6aW5nLgoKICAgIFRoaXMgaXMgbm90IHR5
        cGljYWxseSBhIGZ1bmN0aW9uIHRoYXQgeW91IHdpbGwgbmVlZCB0byBjYWxs
        IGRpcmVjdGx5IHdoZW4KICAgIGJ1aWxkaW5nIHlvdXIgYXBwbGljYXRpb24u
        IFlvdSBtaWdodCBjb25zaWRlciB1c2luZyBgRW1iZXIuQ29udGFpbmVyVmll
        d2AKICAgIGluc3RlYWQuIElmIHlvdSBkbyBuZWVkIHRvIHVzZSBgYXBwZW5k
        VG9gLCBiZSBzdXJlIHRoYXQgdGhlIHRhcmdldCBlbGVtZW50CiAgICB5b3Ug
        YXJlIHByb3ZpZGluZyBpcyBhc3NvY2lhdGVkIHdpdGggYW4gYEVtYmVyLkFw
        cGxpY2F0aW9uYCBhbmQgZG9lcyBub3QKICAgIGhhdmUgYW4gYW5jZXN0b3Ig
        ZWxlbWVudCB0aGF0IGlzIGFzc29jaWF0ZWQgd2l0aCBhbiBFbWJlciB2aWV3
        LgoKICAgIEBtZXRob2QgYXBwZW5kVG8KICAgIEBwYXJhbSB7U3RyaW5nfERP
        TUVsZW1lbnR8alF1ZXJ5fSBBIHNlbGVjdG9yLCBlbGVtZW50LCBIVE1MIHN0
        cmluZywgb3IgalF1ZXJ5IG9iamVjdAogICAgQHJldHVybiB7RW1iZXIuVmll
        d30gcmVjZWl2ZXIKICAqLwogIGFwcGVuZFRvOiBmdW5jdGlvbih0YXJnZXQp
        IHsKICAgIC8vIFNjaGVkdWxlIHRoZSBET00gZWxlbWVudCB0byBiZSBjcmVh
        dGVkIGFuZCBhcHBlbmRlZCB0byB0aGUgZ2l2ZW4KICAgIC8vIGVsZW1lbnQg
        YWZ0ZXIgYmluZGluZ3MgaGF2ZSBzeW5jaHJvbml6ZWQuCiAgICB0aGlzLl9p
        bnNlcnRFbGVtZW50TGF0ZXIoZnVuY3Rpb24oKSB7CiAgICAgIEVtYmVyLmFz
        c2VydCgiWW91IHRyaWVkIHRvIGFwcGVuZCB0byAoIiArIHRhcmdldCArICIp
        IGJ1dCB0aGF0IGlzbid0IGluIHRoZSBET00iLCBFbWJlci4kKHRhcmdldCku
        bGVuZ3RoID4gMCk7CiAgICAgIEVtYmVyLmFzc2VydCgiWW91IGNhbm5vdCBh
        cHBlbmQgdG8gYW4gZXhpc3RpbmcgRW1iZXIuVmlldy4gQ29uc2lkZXIgdXNp
        bmcgRW1iZXIuQ29udGFpbmVyVmlldyBpbnN0ZWFkLiIsICFFbWJlci4kKHRh
        cmdldCkuaXMoJy5lbWJlci12aWV3JykgJiYgIUVtYmVyLiQodGFyZ2V0KS5w
        YXJlbnRzKCkuaXMoJy5lbWJlci12aWV3JykpOwogICAgICB0aGlzLiQoKS5h
        cHBlbmRUbyh0YXJnZXQpOwogICAgfSk7CgogICAgcmV0dXJuIHRoaXM7CiAg
        fSwKCiAgLyoqCiAgICBSZXBsYWNlcyB0aGUgY29udGVudCBvZiB0aGUgc3Bl
        Y2lmaWVkIHBhcmVudCBlbGVtZW50IHdpdGggdGhpcyB2aWV3J3MKICAgIGVs
        ZW1lbnQuIElmIHRoZSB2aWV3IGRvZXMgbm90IGhhdmUgYW4gSFRNTCByZXBy
        ZXNlbnRhdGlvbiB5ZXQsCiAgICBgY3JlYXRlRWxlbWVudCgpYCB3aWxsIGJl
        IGNhbGxlZCBhdXRvbWF0aWNhbGx5LgoKICAgIE5vdGUgdGhhdCB0aGlzIG1l
        dGhvZCBqdXN0IHNjaGVkdWxlcyB0aGUgdmlldyB0byBiZSBhcHBlbmRlZDsg
        dGhlIERPTQogICAgZWxlbWVudCB3aWxsIG5vdCBiZSBhcHBlbmRlZCB0byB0
        aGUgZ2l2ZW4gZWxlbWVudCB1bnRpbCBhbGwgYmluZGluZ3MgaGF2ZQogICAg
        ZmluaXNoZWQgc3luY2hyb25pemluZwoKICAgIEBtZXRob2QgcmVwbGFjZUlu
        CiAgICBAcGFyYW0ge1N0cmluZ3xET01FbGVtZW50fGpRdWVyeX0gQSBzZWxl
        Y3RvciwgZWxlbWVudCwgSFRNTCBzdHJpbmcsIG9yIGpRdWVyeSBvYmplY3QK
        ICAgIEByZXR1cm4ge0VtYmVyLlZpZXd9IHJlY2VpdmVkCiAgKi8KICByZXBs
        YWNlSW46IGZ1bmN0aW9uKHRhcmdldCkgewogICAgRW1iZXIuYXNzZXJ0KCJZ
        b3UgdHJpZWQgdG8gcmVwbGFjZSBpbiAoIiArIHRhcmdldCArICIpIGJ1dCB0
        aGF0IGlzbid0IGluIHRoZSBET00iLCBFbWJlci4kKHRhcmdldCkubGVuZ3Ro
        ID4gMCk7CiAgICBFbWJlci5hc3NlcnQoIllvdSBjYW5ub3QgcmVwbGFjZSBh
        biBleGlzdGluZyBFbWJlci5WaWV3LiBDb25zaWRlciB1c2luZyBFbWJlci5D
        b250YWluZXJWaWV3IGluc3RlYWQuIiwgIUVtYmVyLiQodGFyZ2V0KS5pcygn
        LmVtYmVyLXZpZXcnKSAmJiAhRW1iZXIuJCh0YXJnZXQpLnBhcmVudHMoKS5p
        cygnLmVtYmVyLXZpZXcnKSk7CgogICAgdGhpcy5faW5zZXJ0RWxlbWVudExh
        dGVyKGZ1bmN0aW9uKCkgewogICAgICBFbWJlci4kKHRhcmdldCkuZW1wdHko
        KTsKICAgICAgdGhpcy4kKCkuYXBwZW5kVG8odGFyZ2V0KTsKICAgIH0pOwoK
        ICAgIHJldHVybiB0aGlzOwogIH0sCgogIC8qKgogICAgQHByaXZhdGUKCiAg
        ICBTY2hlZHVsZXMgYSBET00gb3BlcmF0aW9uIHRvIG9jY3VyIGR1cmluZyB0
        aGUgbmV4dCByZW5kZXIgcGhhc2UuIFRoaXMKICAgIGVuc3VyZXMgdGhhdCBh
        bGwgYmluZGluZ3MgaGF2ZSBmaW5pc2hlZCBzeW5jaHJvbml6aW5nIGJlZm9y
        ZSB0aGUgdmlldyBpcwogICAgcmVuZGVyZWQuCgogICAgVG8gdXNlLCBwYXNz
        IGEgZnVuY3Rpb24gdGhhdCBwZXJmb3JtcyBhIERPTSBvcGVyYXRpb24uCgog
        ICAgQmVmb3JlIHlvdXIgZnVuY3Rpb24gaXMgY2FsbGVkLCB0aGlzIHZpZXcg
        YW5kIGFsbCBjaGlsZCB2aWV3cyB3aWxsIHJlY2VpdmUKICAgIHRoZSBgd2ls
        bEluc2VydEVsZW1lbnRgIGV2ZW50LiBBZnRlciB5b3VyIGZ1bmN0aW9uIGlz
        IGludm9rZWQsIHRoaXMgdmlldwogICAgYW5kIGFsbCBvZiBpdHMgY2hpbGQg
        dmlld3Mgd2lsbCByZWNlaXZlIHRoZSBgZGlkSW5zZXJ0RWxlbWVudGAgZXZl
        bnQuCgogICAgYGBgamF2YXNjcmlwdAogICAgdmlldy5faW5zZXJ0RWxlbWVu
        dExhdGVyKGZ1bmN0aW9uKCkgewogICAgICB0aGlzLmNyZWF0ZUVsZW1lbnQo
        KTsKICAgICAgdGhpcy4kKCkuYXBwZW5kVG8oJ2JvZHknKTsKICAgIH0pOwog
        ICAgYGBgCgogICAgQG1ldGhvZCBfaW5zZXJ0RWxlbWVudExhdGVyCiAgICBA
        cGFyYW0ge0Z1bmN0aW9ufSBmbiB0aGUgZnVuY3Rpb24gdGhhdCBpbnNlcnRz
        IHRoZSBlbGVtZW50IGludG8gdGhlIERPTQogICovCiAgX2luc2VydEVsZW1l
        bnRMYXRlcjogZnVuY3Rpb24oZm4pIHsKICAgIHRoaXMuX3NjaGVkdWxlZElu
        c2VydCA9IEVtYmVyLnJ1bi5zY2hlZHVsZU9uY2UoJ3JlbmRlcicsIHRoaXMs
        ICdfaW5zZXJ0RWxlbWVudCcsIGZuKTsKICB9LAoKICBfaW5zZXJ0RWxlbWVu
        dDogZnVuY3Rpb24gKGZuKSB7CiAgICB0aGlzLl9zY2hlZHVsZWRJbnNlcnQg
        PSBudWxsOwogICAgdGhpcy5jdXJyZW50U3RhdGUuaW5zZXJ0RWxlbWVudCh0
        aGlzLCBmbik7CiAgfSwKCiAgLyoqCiAgICBBcHBlbmRzIHRoZSB2aWV3J3Mg
        ZWxlbWVudCB0byB0aGUgZG9jdW1lbnQgYm9keS4gSWYgdGhlIHZpZXcgZG9l
        cwogICAgbm90IGhhdmUgYW4gSFRNTCByZXByZXNlbnRhdGlvbiB5ZXQsIGBj
        cmVhdGVFbGVtZW50KClgIHdpbGwgYmUgY2FsbGVkCiAgICBhdXRvbWF0aWNh
        bGx5LgoKICAgIElmIHlvdXIgYXBwbGljYXRpb24gdXNlcyB0aGUgYHJvb3RF
        bGVtZW50YCBwcm9wZXJ0eSwgeW91IG11c3QgYXBwZW5kCiAgICB0aGUgdmll
        dyB3aXRoaW4gdGhhdCBlbGVtZW50LiBSZW5kZXJpbmcgdmlld3Mgb3V0c2lk
        ZSBvZiB0aGUgYHJvb3RFbGVtZW50YAogICAgaXMgbm90IHN1cHBvcnRlZC4K
        CiAgICBOb3RlIHRoYXQgdGhpcyBtZXRob2QganVzdCBzY2hlZHVsZXMgdGhl
        IHZpZXcgdG8gYmUgYXBwZW5kZWQ7IHRoZSBET00KICAgIGVsZW1lbnQgd2ls
        bCBub3QgYmUgYXBwZW5kZWQgdG8gdGhlIGRvY3VtZW50IGJvZHkgdW50aWwg
        YWxsIGJpbmRpbmdzIGhhdmUKICAgIGZpbmlzaGVkIHN5bmNocm9uaXppbmcu
        CgogICAgQG1ldGhvZCBhcHBlbmQKICAgIEByZXR1cm4ge0VtYmVyLlZpZXd9
        IHJlY2VpdmVyCiAgKi8KICBhcHBlbmQ6IGZ1bmN0aW9uKCkgewogICAgcmV0
        dXJuIHRoaXMuYXBwZW5kVG8oZG9jdW1lbnQuYm9keSk7CiAgfSwKCiAgLyoq
        CiAgICBSZW1vdmVzIHRoZSB2aWV3J3MgZWxlbWVudCBmcm9tIHRoZSBlbGVt
        ZW50IHRvIHdoaWNoIGl0IGlzIGF0dGFjaGVkLgoKICAgIEBtZXRob2QgcmVt
        b3ZlCiAgICBAcmV0dXJuIHtFbWJlci5WaWV3fSByZWNlaXZlcgogICovCiAg
        cmVtb3ZlOiBmdW5jdGlvbigpIHsKICAgIC8vIFdoYXQgd2Ugc2hvdWxkIHJl
        YWxseSBkbyBoZXJlIGlzIHdhaXQgdW50aWwgdGhlIGVuZCBvZiB0aGUgcnVu
        IGxvb3AKICAgIC8vIHRvIGRldGVybWluZSBpZiB0aGUgZWxlbWVudCBoYXMg
        YmVlbiByZS1hcHBlbmRlZCB0byBhIGRpZmZlcmVudAogICAgLy8gZWxlbWVu
        dC4KICAgIC8vIEluIHRoZSBpbnRlcmltLCB3ZSB3aWxsIGp1c3QgcmUtcmVu
        ZGVyIGlmIHRoYXQgaGFwcGVucy4gSXQgaXMgbW9yZQogICAgLy8gaW1wb3J0
        YW50IHRoYW4gZWxlbWVudHMgZ2V0IGdhcmJhZ2UgY29sbGVjdGVkLgogICAg
        aWYgKCF0aGlzLnJlbW92ZWRGcm9tRE9NKSB7IHRoaXMuZGVzdHJveUVsZW1l
        bnQoKTsgfQogICAgdGhpcy5pbnZva2VSZWN1cnNpdmVseShmdW5jdGlvbih2
        aWV3KSB7CiAgICAgIGlmICh2aWV3LmNsZWFyUmVuZGVyZWRDaGlsZHJlbikg
        eyB2aWV3LmNsZWFyUmVuZGVyZWRDaGlsZHJlbigpOyB9CiAgICB9KTsKICB9
        LAoKICBlbGVtZW50SWQ6IG51bGwsCgogIC8qKgogICAgQXR0ZW1wdHMgdG8g
        ZGlzY292ZXIgdGhlIGVsZW1lbnQgaW4gdGhlIHBhcmVudCBlbGVtZW50LiBU
        aGUgZGVmYXVsdAogICAgaW1wbGVtZW50YXRpb24gbG9va3MgZm9yIGFuIGVs
        ZW1lbnQgd2l0aCBhbiBJRCBvZiBgZWxlbWVudElkYCAob3IgdGhlCiAgICB2
        aWV3J3MgZ3VpZCBpZiBgZWxlbWVudElkYCBpcyBudWxsKS4gWW91IGNhbiBv
        dmVycmlkZSB0aGlzIG1ldGhvZCB0bwogICAgcHJvdmlkZSB5b3VyIG93biBm
        b3JtIG9mIGxvb2t1cC4gRm9yIGV4YW1wbGUsIGlmIHlvdSB3YW50IHRvIGRp
        c2NvdmVyIHlvdXIKICAgIGVsZW1lbnQgdXNpbmcgYSBDU1MgY2xhc3MgbmFt
        ZSBpbnN0ZWFkIG9mIGFuIElELgoKICAgIEBtZXRob2QgZmluZEVsZW1lbnRJ
        blBhcmVudEVsZW1lbnQKICAgIEBwYXJhbSB7RE9NRWxlbWVudH0gcGFyZW50
        RWxlbWVudCBUaGUgcGFyZW50J3MgRE9NIGVsZW1lbnQKICAgIEByZXR1cm4g
        e0RPTUVsZW1lbnR9IFRoZSBkaXNjb3ZlcmVkIGVsZW1lbnQKICAqLwogIGZp
        bmRFbGVtZW50SW5QYXJlbnRFbGVtZW50OiBmdW5jdGlvbihwYXJlbnRFbGVt
        KSB7CiAgICB2YXIgaWQgPSAiIyIgKyB0aGlzLmVsZW1lbnRJZDsKICAgIHJl
        dHVybiBFbWJlci4kKGlkKVswXSB8fCBFbWJlci4kKGlkLCBwYXJlbnRFbGVt
        KVswXTsKICB9LAoKICAvKioKICAgIENyZWF0ZXMgYSBET00gcmVwcmVzZW50
        YXRpb24gb2YgdGhlIHZpZXcgYW5kIGFsbCBvZiBpdHMKICAgIGNoaWxkIHZp
        ZXdzIGJ5IHJlY3Vyc2l2ZWx5IGNhbGxpbmcgdGhlIGByZW5kZXIoKWAgbWV0
        aG9kLgoKICAgIEFmdGVyIHRoZSBlbGVtZW50IGhhcyBiZWVuIGNyZWF0ZWQs
        IGBkaWRJbnNlcnRFbGVtZW50YCB3aWxsCiAgICBiZSBjYWxsZWQgb24gdGhp
        cyB2aWV3IGFuZCBhbGwgb2YgaXRzIGNoaWxkIHZpZXdzLgoKICAgIEBtZXRo
        b2QgY3JlYXRlRWxlbWVudAogICAgQHJldHVybiB7RW1iZXIuVmlld30gcmVj
        ZWl2ZXIKICAqLwogIGNyZWF0ZUVsZW1lbnQ6IGZ1bmN0aW9uKCkgewogICAg
        aWYgKGdldCh0aGlzLCAnZWxlbWVudCcpKSB7IHJldHVybiB0aGlzOyB9Cgog
        ICAgdmFyIGJ1ZmZlciA9IHRoaXMucmVuZGVyVG9CdWZmZXIoKTsKICAgIHNl
        dCh0aGlzLCAnZWxlbWVudCcsIGJ1ZmZlci5lbGVtZW50KCkpOwoKICAgIHJl
        dHVybiB0aGlzOwogIH0sCgogIC8qKgogICAgQ2FsbGVkIHdoZW4gYSB2aWV3
        IGlzIGdvaW5nIHRvIGluc2VydCBhbiBlbGVtZW50IGludG8gdGhlIERPTS4K
        CiAgICBAZXZlbnQgd2lsbEluc2VydEVsZW1lbnQKICAqLwogIHdpbGxJbnNl
        cnRFbGVtZW50OiBFbWJlci5LLAoKICAvKioKICAgIENhbGxlZCB3aGVuIHRo
        ZSBlbGVtZW50IG9mIHRoZSB2aWV3IGhhcyBiZWVuIGluc2VydGVkIGludG8g
        dGhlIERPTQogICAgb3IgYWZ0ZXIgdGhlIHZpZXcgd2FzIHJlLXJlbmRlcmVk
        LiBPdmVycmlkZSB0aGlzIGZ1bmN0aW9uIHRvIGRvIGFueQogICAgc2V0IHVw
        IHRoYXQgcmVxdWlyZXMgYW4gZWxlbWVudCBpbiB0aGUgZG9jdW1lbnQgYm9k
        eS4KCiAgICBAZXZlbnQgZGlkSW5zZXJ0RWxlbWVudAogICovCiAgZGlkSW5z
        ZXJ0RWxlbWVudDogRW1iZXIuSywKCiAgLyoqCiAgICBDYWxsZWQgd2hlbiB0
        aGUgdmlldyBpcyBhYm91dCB0byByZXJlbmRlciwgYnV0IGJlZm9yZSBhbnl0
        aGluZyBoYXMKICAgIGJlZW4gdG9ybiBkb3duLiBUaGlzIGlzIGEgZ29vZCBv
        cHBvcnR1bml0eSB0byB0ZWFyIGRvd24gYW55IG1hbnVhbAogICAgb2JzZXJ2
        ZXJzIHlvdSBoYXZlIGluc3RhbGxlZCBiYXNlZCBvbiB0aGUgRE9NIHN0YXRl
        CgogICAgQGV2ZW50IHdpbGxDbGVhclJlbmRlcgogICovCiAgd2lsbENsZWFy
        UmVuZGVyOiBFbWJlci5LLAoKICAvKioKICAgIEBwcml2YXRlCgogICAgUnVu
        IHRoaXMgY2FsbGJhY2sgb24gdGhlIGN1cnJlbnQgdmlldyAodW5sZXNzIGlu
        Y2x1ZGVTZWxmIGlzIGZhbHNlKSBhbmQgcmVjdXJzaXZlbHkgb24gY2hpbGQg
        dmlld3MuCgogICAgQG1ldGhvZCBpbnZva2VSZWN1cnNpdmVseQogICAgQHBh
        cmFtIGZuIHtGdW5jdGlvbn0KICAgIEBwYXJhbSBpbmNsdWRlU2VsZiAob3B0
        aW9uYWwsIGRlZmF1bHQgdHJ1ZSkKICAqLwogIGludm9rZVJlY3Vyc2l2ZWx5
        OiBmdW5jdGlvbihmbiwgaW5jbHVkZVNlbGYpIHsKICAgIHZhciBjaGlsZFZp
        ZXdzID0gKGluY2x1ZGVTZWxmID09PSBmYWxzZSkgPyB0aGlzLl9jaGlsZFZp
        ZXdzIDogW3RoaXNdOwogICAgdmFyIGN1cnJlbnRWaWV3cywgdmlldywgY3Vy
        cmVudENoaWxkVmlld3M7CgogICAgd2hpbGUgKGNoaWxkVmlld3MubGVuZ3Ro
        KSB7CiAgICAgIGN1cnJlbnRWaWV3cyA9IGNoaWxkVmlld3Muc2xpY2UoKTsK
        ICAgICAgY2hpbGRWaWV3cyA9IFtdOwoKICAgICAgZm9yICh2YXIgaT0wLCBs
        PWN1cnJlbnRWaWV3cy5sZW5ndGg7IGk8bDsgaSsrKSB7CiAgICAgICAgdmll
        dyA9IGN1cnJlbnRWaWV3c1tpXTsKICAgICAgICBjdXJyZW50Q2hpbGRWaWV3
        cyA9IHZpZXcuX2NoaWxkVmlld3MgPyB2aWV3Ll9jaGlsZFZpZXdzLnNsaWNl
        KDApIDogbnVsbDsKICAgICAgICBmbih2aWV3KTsKICAgICAgICBpZiAoY3Vy
        cmVudENoaWxkVmlld3MpIHsKICAgICAgICAgIGNoaWxkVmlld3MucHVzaC5h
        cHBseShjaGlsZFZpZXdzLCBjdXJyZW50Q2hpbGRWaWV3cyk7CiAgICAgICAg
        fQogICAgICB9CiAgICB9CiAgfSwKCiAgdHJpZ2dlclJlY3Vyc2l2ZWx5OiBm
        dW5jdGlvbihldmVudE5hbWUpIHsKICAgIHZhciBjaGlsZFZpZXdzID0gW3Ro
        aXNdLCBjdXJyZW50Vmlld3MsIHZpZXcsIGN1cnJlbnRDaGlsZFZpZXdzOwoK
        ICAgIHdoaWxlIChjaGlsZFZpZXdzLmxlbmd0aCkgewogICAgICBjdXJyZW50
        Vmlld3MgPSBjaGlsZFZpZXdzLnNsaWNlKCk7CiAgICAgIGNoaWxkVmlld3Mg
        PSBbXTsKCiAgICAgIGZvciAodmFyIGk9MCwgbD1jdXJyZW50Vmlld3MubGVu
        Z3RoOyBpPGw7IGkrKykgewogICAgICAgIHZpZXcgPSBjdXJyZW50Vmlld3Nb
        aV07CiAgICAgICAgY3VycmVudENoaWxkVmlld3MgPSB2aWV3Ll9jaGlsZFZp
        ZXdzID8gdmlldy5fY2hpbGRWaWV3cy5zbGljZSgwKSA6IG51bGw7CiAgICAg
        ICAgaWYgKHZpZXcudHJpZ2dlcikgeyB2aWV3LnRyaWdnZXIoZXZlbnROYW1l
        KTsgfQogICAgICAgIGlmIChjdXJyZW50Q2hpbGRWaWV3cykgewogICAgICAg
        ICAgY2hpbGRWaWV3cy5wdXNoLmFwcGx5KGNoaWxkVmlld3MsIGN1cnJlbnRD
        aGlsZFZpZXdzKTsKICAgICAgICB9CgogICAgICB9CiAgICB9CiAgfSwKCiAg
        dmlld0hpZXJhcmNoeUNvbGxlY3Rpb246IGZ1bmN0aW9uKCkgewogICAgdmFy
        IGN1cnJlbnRWaWV3LCB2aWV3Q29sbGVjdGlvbiA9IG5ldyBWaWV3Q29sbGVj
        dGlvbihbdGhpc10pOwoKICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdmlld0Nv
        bGxlY3Rpb24ubGVuZ3RoOyBpKyspIHsKICAgICAgY3VycmVudFZpZXcgPSB2
        aWV3Q29sbGVjdGlvbi5vYmplY3RBdChpKTsKICAgICAgaWYgKGN1cnJlbnRW
        aWV3Ll9jaGlsZFZpZXdzKSB7CiAgICAgICAgdmlld0NvbGxlY3Rpb24ucHVz
        aC5hcHBseSh2aWV3Q29sbGVjdGlvbiwgY3VycmVudFZpZXcuX2NoaWxkVmll
        d3MpOwogICAgICB9CiAgICB9CgogICAgcmV0dXJuIHZpZXdDb2xsZWN0aW9u
        OwogIH0sCgogIC8qKgogICAgRGVzdHJveXMgYW55IGV4aXN0aW5nIGVsZW1l
        bnQgYWxvbmcgd2l0aCB0aGUgZWxlbWVudCBmb3IgYW55IGNoaWxkIHZpZXdz
        CiAgICBhcyB3ZWxsLiBJZiB0aGUgdmlldyBkb2VzIG5vdCBjdXJyZW50bHkg
        aGF2ZSBhIGVsZW1lbnQsIHRoZW4gdGhpcyBtZXRob2QKICAgIHdpbGwgZG8g
        bm90aGluZy4KCiAgICBJZiB5b3UgaW1wbGVtZW50IGB3aWxsRGVzdHJveUVs
        ZW1lbnQoKWAgb24geW91ciB2aWV3LCB0aGVuIHRoaXMgbWV0aG9kIHdpbGwK
        ICAgIGJlIGludm9rZWQgb24geW91ciB2aWV3IGJlZm9yZSB5b3VyIGVsZW1l
        bnQgaXMgZGVzdHJveWVkIHRvIGdpdmUgeW91IGEKICAgIGNoYW5jZSB0byBj
        bGVhbiB1cCBhbnkgZXZlbnQgaGFuZGxlcnMsIGV0Yy4KCiAgICBJZiB5b3Ug
        d3JpdGUgYSBgd2lsbERlc3Ryb3lFbGVtZW50KClgIGhhbmRsZXIsIHlvdSBj
        YW4gYXNzdW1lIHRoYXQgeW91cgogICAgYGRpZEluc2VydEVsZW1lbnQoKWAg
        aGFuZGxlciB3YXMgY2FsbGVkIGVhcmxpZXIgZm9yIHRoZSBzYW1lIGVsZW1l
        bnQuCgogICAgWW91IHNob3VsZCBub3QgY2FsbCBvciBvdmVycmlkZSB0aGlz
        IG1ldGhvZCB5b3Vyc2VsZiwgYnV0IHlvdSBtYXkKICAgIHdhbnQgdG8gaW1w
        bGVtZW50IHRoZSBhYm92ZSBjYWxsYmFja3MuCgogICAgQG1ldGhvZCBkZXN0
        cm95RWxlbWVudAogICAgQHJldHVybiB7RW1iZXIuVmlld30gcmVjZWl2ZXIK
        ICAqLwogIGRlc3Ryb3lFbGVtZW50OiBmdW5jdGlvbigpIHsKICAgIHJldHVy
        biB0aGlzLmN1cnJlbnRTdGF0ZS5kZXN0cm95RWxlbWVudCh0aGlzKTsKICB9
        LAoKICAvKioKICAgIENhbGxlZCB3aGVuIHRoZSBlbGVtZW50IG9mIHRoZSB2
        aWV3IGlzIGdvaW5nIHRvIGJlIGRlc3Ryb3llZC4gT3ZlcnJpZGUKICAgIHRo
        aXMgZnVuY3Rpb24gdG8gZG8gYW55IHRlYXJkb3duIHRoYXQgcmVxdWlyZXMg
        YW4gZWxlbWVudCwgbGlrZSByZW1vdmluZwogICAgZXZlbnQgbGlzdGVuZXJz
        LgoKICAgIEBldmVudCB3aWxsRGVzdHJveUVsZW1lbnQKICAqLwogIHdpbGxE
        ZXN0cm95RWxlbWVudDogRW1iZXIuSywKCiAgLyoqCiAgICBAcHJpdmF0ZQoK
        ICAgIFRyaWdnZXJzIHRoZSBgd2lsbERlc3Ryb3lFbGVtZW50YCBldmVudCAo
        d2hpY2ggaW52b2tlcyB0aGUKICAgIGB3aWxsRGVzdHJveUVsZW1lbnQoKWAg
        bWV0aG9kIGlmIGl0IGV4aXN0cykgb24gdGhpcyB2aWV3IGFuZCBhbGwgY2hp
        bGQKICAgIHZpZXdzLgoKICAgIEJlZm9yZSB0cmlnZ2VyaW5nIGB3aWxsRGVz
        dHJveUVsZW1lbnRgLCBpdCBmaXJzdCB0cmlnZ2VycyB0aGUKICAgIGB3aWxs
        Q2xlYXJSZW5kZXJgIGV2ZW50IHJlY3Vyc2l2ZWx5LgoKICAgIEBtZXRob2Qg
        X25vdGlmeVdpbGxEZXN0cm95RWxlbWVudAogICovCiAgX25vdGlmeVdpbGxE
        ZXN0cm95RWxlbWVudDogZnVuY3Rpb24oKSB7CiAgICB2YXIgdmlld0NvbGxl
        Y3Rpb24gPSB0aGlzLnZpZXdIaWVyYXJjaHlDb2xsZWN0aW9uKCk7CiAgICB2
        aWV3Q29sbGVjdGlvbi50cmlnZ2VyKCd3aWxsQ2xlYXJSZW5kZXInKTsKICAg
        IHZpZXdDb2xsZWN0aW9uLnRyaWdnZXIoJ3dpbGxEZXN0cm95RWxlbWVudCcp
        OwogICAgcmV0dXJuIHZpZXdDb2xsZWN0aW9uOwogIH0sCgogIC8qKgogICAg
        QHByaXZhdGUKCiAgICBJZiB0aGlzIHZpZXcncyBlbGVtZW50IGNoYW5nZXMs
        IHdlIG5lZWQgdG8gaW52YWxpZGF0ZSB0aGUgY2FjaGVzIG9mIG91cgogICAg
        Y2hpbGQgdmlld3Mgc28gdGhhdCB3ZSBkbyBub3QgcmV0YWluIHJlZmVyZW5j
        ZXMgdG8gRE9NIGVsZW1lbnRzIHRoYXQgYXJlCiAgICBubyBsb25nZXIgbmVl
        ZGVkLgoKICAgIEBtZXRob2QgX2VsZW1lbnREaWRDaGFuZ2UKICAqLwogIF9l
        bGVtZW50RGlkQ2hhbmdlOiBFbWJlci5vYnNlcnZlcihmdW5jdGlvbigpIHsK
        ICAgIHRoaXMuZm9yRWFjaENoaWxkVmlldyhmdW5jdGlvbih2aWV3KSB7CiAg
        ICAgIGRlbGV0ZSBtZXRhKHZpZXcpLmNhY2hlLmVsZW1lbnQ7CiAgICB9KTsK
        ICB9LCAnZWxlbWVudCcpLAoKICAvKioKICAgIENhbGxlZCB3aGVuIHRoZSBw
        YXJlbnRWaWV3IHByb3BlcnR5IGhhcyBjaGFuZ2VkLgoKICAgIEBldmVudCBw
        YXJlbnRWaWV3RGlkQ2hhbmdlCiAgKi8KICBwYXJlbnRWaWV3RGlkQ2hhbmdl
        OiBFbWJlci5LLAoKICBpbnN0cnVtZW50TmFtZTogJ3ZpZXcnLAoKICBpbnN0
        cnVtZW50RGV0YWlsczogZnVuY3Rpb24oaGFzaCkgewogICAgaGFzaC50ZW1w
        bGF0ZSA9IGdldCh0aGlzLCAndGVtcGxhdGVOYW1lJyk7CiAgICB0aGlzLl9z
        dXBlcihoYXNoKTsKICB9LAoKICBfcmVuZGVyVG9CdWZmZXI6IGZ1bmN0aW9u
        KHBhcmVudEJ1ZmZlciwgYnVmZmVyT3BlcmF0aW9uKSB7CiAgICB0aGlzLmxl
        bmd0aEJlZm9yZVJlbmRlciA9IHRoaXMuX2NoaWxkVmlld3MubGVuZ3RoOwog
        ICAgdmFyIGJ1ZmZlciA9IHRoaXMuX3N1cGVyKHBhcmVudEJ1ZmZlciwgYnVm
        ZmVyT3BlcmF0aW9uKTsKICAgIHRoaXMubGVuZ3RoQWZ0ZXJSZW5kZXIgPSB0
        aGlzLl9jaGlsZFZpZXdzLmxlbmd0aDsKCiAgICByZXR1cm4gYnVmZmVyOwog
        IH0sCgogIHJlbmRlclRvQnVmZmVySWZOZWVkZWQ6IGZ1bmN0aW9uIChidWZm
        ZXIpIHsKICAgIHJldHVybiB0aGlzLmN1cnJlbnRTdGF0ZS5yZW5kZXJUb0J1
        ZmZlcklmTmVlZGVkKHRoaXMsIGJ1ZmZlcik7CiAgfSwKCiAgYmVmb3JlUmVu
        ZGVyOiBmdW5jdGlvbihidWZmZXIpIHsKICAgIHRoaXMuYXBwbHlBdHRyaWJ1
        dGVzVG9CdWZmZXIoYnVmZmVyKTsKICAgIGJ1ZmZlci5wdXNoT3BlbmluZ1Rh
        ZygpOwogIH0sCgogIGFmdGVyUmVuZGVyOiBmdW5jdGlvbihidWZmZXIpIHsK
        ICAgIGJ1ZmZlci5wdXNoQ2xvc2luZ1RhZygpOwogIH0sCgogIGFwcGx5QXR0
        cmlidXRlc1RvQnVmZmVyOiBmdW5jdGlvbihidWZmZXIpIHsKICAgIC8vIENy
        ZWF0ZXMgb2JzZXJ2ZXJzIGZvciBhbGwgcmVnaXN0ZXJlZCBjbGFzcyBuYW1l
        IGFuZCBhdHRyaWJ1dGUgYmluZGluZ3MsCiAgICAvLyB0aGVuIGFkZHMgdGhl
        bSB0byB0aGUgZWxlbWVudC4KICAgIHZhciBjbGFzc05hbWVCaW5kaW5ncyA9
        IGdldCh0aGlzLCAnY2xhc3NOYW1lQmluZGluZ3MnKTsKICAgIGlmIChjbGFz
        c05hbWVCaW5kaW5ncy5sZW5ndGgpIHsKICAgICAgdGhpcy5fYXBwbHlDbGFz
        c05hbWVCaW5kaW5ncyhjbGFzc05hbWVCaW5kaW5ncyk7CiAgICB9CgogICAg
        Ly8gUGFzcyB0aGUgcmVuZGVyIGJ1ZmZlciBzbyB0aGUgbWV0aG9kIGNhbiBh
        cHBseSBhdHRyaWJ1dGVzIGRpcmVjdGx5LgogICAgLy8gVGhpcyBpc24ndCBu
        ZWVkZWQgZm9yIGNsYXNzIG5hbWUgYmluZGluZ3MgYmVjYXVzZSB0aGV5IHVz
        ZSB0aGUKICAgIC8vIGV4aXN0aW5nIGNsYXNzTmFtZXMgaW5mcmFzdHJ1Y3R1
        cmUuCiAgICB2YXIgYXR0cmlidXRlQmluZGluZ3MgPSBnZXQodGhpcywgJ2F0
        dHJpYnV0ZUJpbmRpbmdzJyk7CiAgICBpZiAoYXR0cmlidXRlQmluZGluZ3Mu
        bGVuZ3RoKSB7CiAgICAgIHRoaXMuX2FwcGx5QXR0cmlidXRlQmluZGluZ3Mo
        YnVmZmVyLCBhdHRyaWJ1dGVCaW5kaW5ncyk7CiAgICB9CgogICAgYnVmZmVy
        LnNldENsYXNzZXModGhpcy5jbGFzc05hbWVzKTsKICAgIGJ1ZmZlci5pZCh0
        aGlzLmVsZW1lbnRJZCk7CgogICAgdmFyIHJvbGUgPSBnZXQodGhpcywgJ2Fy
        aWFSb2xlJyk7CiAgICBpZiAocm9sZSkgewogICAgICBidWZmZXIuYXR0cign
        cm9sZScsIHJvbGUpOwogICAgfQoKICAgIGlmIChnZXQodGhpcywgJ2lzVmlz
        aWJsZScpID09PSBmYWxzZSkgewogICAgICBidWZmZXIuc3R5bGUoJ2Rpc3Bs
        YXknLCAnbm9uZScpOwogICAgfQogIH0sCgogIC8vIC4uLi4uLi4uLi4uLi4u
        Li4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4K
        ICAvLyBTVEFOREFSRCBSRU5ERVIgUFJPUEVSVElFUwogIC8vCgogIC8qKgog
        ICAgVGFnIG5hbWUgZm9yIHRoZSB2aWV3J3Mgb3V0ZXIgZWxlbWVudC4gVGhl
        IHRhZyBuYW1lIGlzIG9ubHkgdXNlZCB3aGVuIGFuCiAgICBlbGVtZW50IGlz
        IGZpcnN0IGNyZWF0ZWQuIElmIHlvdSBjaGFuZ2UgdGhlIGB0YWdOYW1lYCBm
        b3IgYW4gZWxlbWVudCwgeW91CiAgICBtdXN0IGRlc3Ryb3kgYW5kIHJlY3Jl
        YXRlIHRoZSB2aWV3IGVsZW1lbnQuCgogICAgQnkgZGVmYXVsdCwgdGhlIHJl
        bmRlciBidWZmZXIgd2lsbCB1c2UgYSBgPGRpdj5gIHRhZyBmb3Igdmlld3Mu
        CgogICAgQHByb3BlcnR5IHRhZ05hbWUKICAgIEB0eXBlIFN0cmluZwogICAg
        QGRlZmF1bHQgbnVsbAogICovCgogIC8vIFdlIGxlYXZlIHRoaXMgbnVsbCBi
        eSBkZWZhdWx0IHNvIHdlIGNhbiB0ZWxsIHRoZSBkaWZmZXJlbmNlIGJldHdl
        ZW4KICAvLyB0aGUgZGVmYXVsdCBjYXNlIGFuZCBhIHVzZXItc3BlY2lmaWVk
        IHRhZy4KICB0YWdOYW1lOiBudWxsLAoKICAvKioKICAgIFRoZSBXQUktQVJJ
        QSByb2xlIG9mIHRoZSBjb250cm9sIHJlcHJlc2VudGVkIGJ5IHRoaXMgdmll
        dy4gRm9yIGV4YW1wbGUsIGEKICAgIGJ1dHRvbiBtYXkgaGF2ZSBhIHJvbGUg
        b2YgdHlwZSAnYnV0dG9uJywgb3IgYSBwYW5lIG1heSBoYXZlIGEgcm9sZSBv
        ZgogICAgdHlwZSAnYWxlcnRkaWFsb2cnLiBUaGlzIHByb3BlcnR5IGlzIHVz
        ZWQgYnkgYXNzaXN0aXZlIHNvZnR3YXJlIHRvIGhlbHAKICAgIHZpc3VhbGx5
        IGNoYWxsZW5nZWQgdXNlcnMgbmF2aWdhdGUgcmljaCB3ZWIgYXBwbGljYXRp
        b25zLgoKICAgIFRoZSBmdWxsIGxpc3Qgb2YgdmFsaWQgV0FJLUFSSUEgcm9s
        ZXMgaXMgYXZhaWxhYmxlIGF0OgogICAgW2h0dHA6Ly93d3cudzMub3JnL1RS
        L3dhaS1hcmlhL3JvbGVzI3JvbGVzX2NhdGVnb3JpemF0aW9uXShodHRwOi8v
        d3d3LnczLm9yZy9UUi93YWktYXJpYS9yb2xlcyNyb2xlc19jYXRlZ29yaXph
        dGlvbikKCiAgICBAcHJvcGVydHkgYXJpYVJvbGUKICAgIEB0eXBlIFN0cmlu
        ZwogICAgQGRlZmF1bHQgbnVsbAogICovCiAgYXJpYVJvbGU6IG51bGwsCgog
        IC8qKgogICAgU3RhbmRhcmQgQ1NTIGNsYXNzIG5hbWVzIHRvIGFwcGx5IHRv
        IHRoZSB2aWV3J3Mgb3V0ZXIgZWxlbWVudC4gVGhpcwogICAgcHJvcGVydHkg
        YXV0b21hdGljYWxseSBpbmhlcml0cyBhbnkgY2xhc3MgbmFtZXMgZGVmaW5l
        ZCBieSB0aGUgdmlldydzCiAgICBzdXBlcmNsYXNzZXMgYXMgd2VsbC4KCiAg
        ICBAcHJvcGVydHkgY2xhc3NOYW1lcwogICAgQHR5cGUgQXJyYXkKICAgIEBk
        ZWZhdWx0IFsnZW1iZXItdmlldyddCiAgKi8KICBjbGFzc05hbWVzOiBbJ2Vt
        YmVyLXZpZXcnXSwKCiAgLyoqCiAgICBBIGxpc3Qgb2YgcHJvcGVydGllcyBv
        ZiB0aGUgdmlldyB0byBhcHBseSBhcyBjbGFzcyBuYW1lcy4gSWYgdGhlIHBy
        b3BlcnR5CiAgICBpcyBhIHN0cmluZyB2YWx1ZSwgdGhlIHZhbHVlIG9mIHRo
        YXQgc3RyaW5nIHdpbGwgYmUgYXBwbGllZCBhcyBhIGNsYXNzCiAgICBuYW1l
        LgoKICAgIGBgYGphdmFzY3JpcHQKICAgIC8vIEFwcGxpZXMgdGhlICdoaWdo
        JyBjbGFzcyB0byB0aGUgdmlldyBlbGVtZW50CiAgICBFbWJlci5WaWV3LmV4
        dGVuZCh7CiAgICAgIGNsYXNzTmFtZUJpbmRpbmdzOiBbJ3ByaW9yaXR5J10K
        ICAgICAgcHJpb3JpdHk6ICdoaWdoJwogICAgfSk7CiAgICBgYGAKCiAgICBJ
        ZiB0aGUgdmFsdWUgb2YgdGhlIHByb3BlcnR5IGlzIGEgQm9vbGVhbiwgdGhl
        IG5hbWUgb2YgdGhhdCBwcm9wZXJ0eSBpcwogICAgYWRkZWQgYXMgYSBkYXNo
        ZXJpemVkIGNsYXNzIG5hbWUuCgogICAgYGBgamF2YXNjcmlwdAogICAgLy8g
        QXBwbGllcyB0aGUgJ2lzLXVyZ2VudCcgY2xhc3MgdG8gdGhlIHZpZXcgZWxl
        bWVudAogICAgRW1iZXIuVmlldy5leHRlbmQoewogICAgICBjbGFzc05hbWVC
        aW5kaW5nczogWydpc1VyZ2VudCddCiAgICAgIGlzVXJnZW50OiB0cnVlCiAg
        ICB9KTsKICAgIGBgYAoKICAgIElmIHlvdSB3b3VsZCBwcmVmZXIgdG8gdXNl
        IGEgY3VzdG9tIHZhbHVlIGluc3RlYWQgb2YgdGhlIGRhc2hlcml6ZWQKICAg
        IHByb3BlcnR5IG5hbWUsIHlvdSBjYW4gcGFzcyBhIGJpbmRpbmcgbGlrZSB0
        aGlzOgoKICAgIGBgYGphdmFzY3JpcHQKICAgIC8vIEFwcGxpZXMgdGhlICd1
        cmdlbnQnIGNsYXNzIHRvIHRoZSB2aWV3IGVsZW1lbnQKICAgIEVtYmVyLlZp
        ZXcuZXh0ZW5kKHsKICAgICAgY2xhc3NOYW1lQmluZGluZ3M6IFsnaXNVcmdl
        bnQ6dXJnZW50J10KICAgICAgaXNVcmdlbnQ6IHRydWUKICAgIH0pOwogICAg
        YGBgCgogICAgVGhpcyBsaXN0IG9mIHByb3BlcnRpZXMgaXMgaW5oZXJpdGVk
        IGZyb20gdGhlIHZpZXcncyBzdXBlcmNsYXNzZXMgYXMgd2VsbC4KCiAgICBA
        cHJvcGVydHkgY2xhc3NOYW1lQmluZGluZ3MKICAgIEB0eXBlIEFycmF5CiAg
        ICBAZGVmYXVsdCBbXQogICovCiAgY2xhc3NOYW1lQmluZGluZ3M6IEVNUFRZ
        X0FSUkFZLAoKICAvKioKICAgIEEgbGlzdCBvZiBwcm9wZXJ0aWVzIG9mIHRo
        ZSB2aWV3IHRvIGFwcGx5IGFzIGF0dHJpYnV0ZXMuIElmIHRoZSBwcm9wZXJ0
        eSBpcwogICAgYSBzdHJpbmcgdmFsdWUsIHRoZSB2YWx1ZSBvZiB0aGF0IHN0
        cmluZyB3aWxsIGJlIGFwcGxpZWQgYXMgdGhlIGF0dHJpYnV0ZS4KCiAgICBg
        YGBqYXZhc2NyaXB0CiAgICAvLyBBcHBsaWVzIHRoZSB0eXBlIGF0dHJpYnV0
        ZSB0byB0aGUgZWxlbWVudAogICAgLy8gd2l0aCB0aGUgdmFsdWUgImJ1dHRv
        biIsIGxpa2UgPGRpdiB0eXBlPSJidXR0b24iPgogICAgRW1iZXIuVmlldy5l
        eHRlbmQoewogICAgICBhdHRyaWJ1dGVCaW5kaW5nczogWyd0eXBlJ10sCiAg
        ICAgIHR5cGU6ICdidXR0b24nCiAgICB9KTsKICAgIGBgYAoKICAgIElmIHRo
        ZSB2YWx1ZSBvZiB0aGUgcHJvcGVydHkgaXMgYSBCb29sZWFuLCB0aGUgbmFt
        ZSBvZiB0aGF0IHByb3BlcnR5IGlzCiAgICBhZGRlZCBhcyBhbiBhdHRyaWJ1
        dGUuCgogICAgYGBgamF2YXNjcmlwdAogICAgLy8gUmVuZGVycyBzb21ldGhp
        bmcgbGlrZSA8ZGl2IGVuYWJsZWQ9ImVuYWJsZWQiPgogICAgRW1iZXIuVmll
        dy5leHRlbmQoewogICAgICBhdHRyaWJ1dGVCaW5kaW5nczogWydlbmFibGVk
        J10sCiAgICAgIGVuYWJsZWQ6IHRydWUKICAgIH0pOwogICAgYGBgCgogICAg
        QHByb3BlcnR5IGF0dHJpYnV0ZUJpbmRpbmdzCiAgKi8KICBhdHRyaWJ1dGVC
        aW5kaW5nczogRU1QVFlfQVJSQVksCgogIC8vIC4uLi4uLi4uLi4uLi4uLi4u
        Li4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4KICAvLyBD
        T1JFIERJU1BMQVkgTUVUSE9EUwogIC8vCgogIC8qKgogICAgQHByaXZhdGUK
        CiAgICBTZXR1cCBhIHZpZXcsIGJ1dCBkbyBub3QgZmluaXNoIHdha2luZyBp
        dCB1cC4KICAgIC0gY29uZmlndXJlIGBjaGlsZFZpZXdzYAogICAgLSByZWdp
        c3RlciB0aGUgdmlldyB3aXRoIHRoZSBnbG9iYWwgdmlld3MgaGFzaCwgd2hp
        Y2ggaXMgdXNlZCBmb3IgZXZlbnQKICAgICAgZGlzcGF0Y2gKCiAgICBAbWV0
        aG9kIGluaXQKICAqLwogIGluaXQ6IGZ1bmN0aW9uKCkgewogICAgdGhpcy5l
        bGVtZW50SWQgPSB0aGlzLmVsZW1lbnRJZCB8fCBndWlkRm9yKHRoaXMpOwoK
        ICAgIHRoaXMuX3N1cGVyKCk7CgogICAgLy8gc2V0dXAgY2hpbGQgdmlld3Mu
        IGJlIHN1cmUgdG8gY2xvbmUgdGhlIGNoaWxkIHZpZXdzIGFycmF5IGZpcnN0
        CiAgICB0aGlzLl9jaGlsZFZpZXdzID0gdGhpcy5fY2hpbGRWaWV3cy5zbGlj
        ZSgpOwoKICAgIEVtYmVyLmFzc2VydCgiT25seSBhcnJheXMgYXJlIGFsbG93
        ZWQgZm9yICdjbGFzc05hbWVCaW5kaW5ncyciLCBFbWJlci50eXBlT2YodGhp
        cy5jbGFzc05hbWVCaW5kaW5ncykgPT09ICdhcnJheScpOwogICAgdGhpcy5j
        bGFzc05hbWVCaW5kaW5ncyA9IEVtYmVyLkEodGhpcy5jbGFzc05hbWVCaW5k
        aW5ncy5zbGljZSgpKTsKCiAgICBFbWJlci5hc3NlcnQoIk9ubHkgYXJyYXlz
        IGFyZSBhbGxvd2VkIGZvciAnY2xhc3NOYW1lcyciLCBFbWJlci50eXBlT2Yo
        dGhpcy5jbGFzc05hbWVzKSA9PT0gJ2FycmF5Jyk7CiAgICB0aGlzLmNsYXNz
        TmFtZXMgPSBFbWJlci5BKHRoaXMuY2xhc3NOYW1lcy5zbGljZSgpKTsKICB9
        LAoKICBhcHBlbmRDaGlsZDogZnVuY3Rpb24odmlldywgb3B0aW9ucykgewog
        ICAgcmV0dXJuIHRoaXMuY3VycmVudFN0YXRlLmFwcGVuZENoaWxkKHRoaXMs
        IHZpZXcsIG9wdGlvbnMpOwogIH0sCgogIC8qKgogICAgUmVtb3ZlcyB0aGUg
        Y2hpbGQgdmlldyBmcm9tIHRoZSBwYXJlbnQgdmlldy4KCiAgICBAbWV0aG9k
        IHJlbW92ZUNoaWxkCiAgICBAcGFyYW0ge0VtYmVyLlZpZXd9IHZpZXcKICAg
        IEByZXR1cm4ge0VtYmVyLlZpZXd9IHJlY2VpdmVyCiAgKi8KICByZW1vdmVD
        aGlsZDogZnVuY3Rpb24odmlldykgewogICAgLy8gSWYgd2UncmUgZGVzdHJv
        eWluZywgdGhlIGVudGlyZSBzdWJ0cmVlIHdpbGwgYmUKICAgIC8vIGZyZWVk
        LCBhbmQgdGhlIERPTSB3aWxsIGJlIGhhbmRsZWQgc2VwYXJhdGVseSwKICAg
        IC8vIHNvIG5vIG5lZWQgdG8gbWVzcyB3aXRoIGNoaWxkVmlld3MuCiAgICBp
        ZiAodGhpcy5pc0Rlc3Ryb3lpbmcpIHsgcmV0dXJuOyB9CgogICAgLy8gdXBk
        YXRlIHBhcmVudCBub2RlCiAgICBzZXQodmlldywgJ19wYXJlbnRWaWV3Jywg
        bnVsbCk7CgogICAgLy8gcmVtb3ZlIHZpZXcgZnJvbSBjaGlsZFZpZXdzIGFy
        cmF5LgogICAgdmFyIGNoaWxkVmlld3MgPSB0aGlzLl9jaGlsZFZpZXdzOwoK
        ICAgIEVtYmVyLkVudW1lcmFibGVVdGlscy5yZW1vdmVPYmplY3QoY2hpbGRW
        aWV3cywgdmlldyk7CgogICAgdGhpcy5wcm9wZXJ0eURpZENoYW5nZSgnY2hp
        bGRWaWV3cycpOyAvLyBIVUg/ISB3aGF0IGhhcHBlbmVkIHRvIHdpbGwgY2hh
        bmdlPwoKICAgIHJldHVybiB0aGlzOwogIH0sCgogIC8qKgogICAgUmVtb3Zl
        cyBhbGwgY2hpbGRyZW4gZnJvbSB0aGUgYHBhcmVudFZpZXdgLgoKICAgIEBt
        ZXRob2QgcmVtb3ZlQWxsQ2hpbGRyZW4KICAgIEByZXR1cm4ge0VtYmVyLlZp
        ZXd9IHJlY2VpdmVyCiAgKi8KICByZW1vdmVBbGxDaGlsZHJlbjogZnVuY3Rp
        b24oKSB7CiAgICByZXR1cm4gdGhpcy5tdXRhdGVDaGlsZFZpZXdzKGZ1bmN0
        aW9uKHBhcmVudFZpZXcsIHZpZXcpIHsKICAgICAgcGFyZW50Vmlldy5yZW1v
        dmVDaGlsZCh2aWV3KTsKICAgIH0pOwogIH0sCgogIGRlc3Ryb3lBbGxDaGls
        ZHJlbjogZnVuY3Rpb24oKSB7CiAgICByZXR1cm4gdGhpcy5tdXRhdGVDaGls
        ZFZpZXdzKGZ1bmN0aW9uKHBhcmVudFZpZXcsIHZpZXcpIHsKICAgICAgdmll
        dy5kZXN0cm95KCk7CiAgICB9KTsKICB9LAoKICAvKioKICAgIFJlbW92ZXMg
        dGhlIHZpZXcgZnJvbSBpdHMgYHBhcmVudFZpZXdgLCBpZiBvbmUgaXMgZm91
        bmQuIE90aGVyd2lzZQogICAgZG9lcyBub3RoaW5nLgoKICAgIEBtZXRob2Qg
        cmVtb3ZlRnJvbVBhcmVudAogICAgQHJldHVybiB7RW1iZXIuVmlld30gcmVj
        ZWl2ZXIKICAqLwogIHJlbW92ZUZyb21QYXJlbnQ6IGZ1bmN0aW9uKCkgewog
        ICAgdmFyIHBhcmVudCA9IHRoaXMuX3BhcmVudFZpZXc7CgogICAgLy8gUmVt
        b3ZlIERPTSBlbGVtZW50IGZyb20gcGFyZW50CiAgICB0aGlzLnJlbW92ZSgp
        OwoKICAgIGlmIChwYXJlbnQpIHsgcGFyZW50LnJlbW92ZUNoaWxkKHRoaXMp
        OyB9CiAgICByZXR1cm4gdGhpczsKICB9LAoKICAvKioKICAgIFlvdSBtdXN0
        IGNhbGwgYGRlc3Ryb3lgIG9uIGEgdmlldyB0byBkZXN0cm95IHRoZSB2aWV3
        IChhbmQgYWxsIG9mIGl0cwogICAgY2hpbGQgdmlld3MpLiBUaGlzIHdpbGwg
        cmVtb3ZlIHRoZSB2aWV3IGZyb20gYW55IHBhcmVudCBub2RlLCB0aGVuIG1h
        a2UKICAgIHN1cmUgdGhhdCB0aGUgRE9NIGVsZW1lbnQgbWFuYWdlZCBieSB0
        aGUgdmlldyBjYW4gYmUgcmVsZWFzZWQgYnkgdGhlCiAgICBtZW1vcnkgbWFu
        YWdlci4KCiAgICBAbWV0aG9kIGRlc3Ryb3kKICAqLwogIGRlc3Ryb3k6IGZ1
        bmN0aW9uKCkgewogICAgdmFyIGNoaWxkVmlld3MgPSB0aGlzLl9jaGlsZFZp
        ZXdzLAogICAgICAgIC8vIGdldCBwYXJlbnRWaWV3IGJlZm9yZSBjYWxsaW5n
        IHN1cGVyIGJlY2F1c2UgaXQnbGwgYmUgZGVzdHJveWVkCiAgICAgICAgbm9u
        VmlydHVhbFBhcmVudFZpZXcgPSBnZXQodGhpcywgJ3BhcmVudFZpZXcnKSwK
        ICAgICAgICB2aWV3TmFtZSA9IHRoaXMudmlld05hbWUsCiAgICAgICAgY2hp
        bGRMZW4sIGk7CgogICAgaWYgKCF0aGlzLl9zdXBlcigpKSB7IHJldHVybjsg
        fQoKICAgIGNoaWxkTGVuID0gY2hpbGRWaWV3cy5sZW5ndGg7CiAgICBmb3Ig
        KGk9Y2hpbGRMZW4tMTsgaT49MDsgaS0tKSB7CiAgICAgIGNoaWxkVmlld3Nb
        aV0ucmVtb3ZlZEZyb21ET00gPSB0cnVlOwogICAgfQoKICAgIC8vIHJlbW92
        ZSBmcm9tIG5vbi12aXJ0dWFsIHBhcmVudCB2aWV3IGlmIHZpZXdOYW1lIHdh
        cyBzcGVjaWZpZWQKICAgIGlmICh2aWV3TmFtZSAmJiBub25WaXJ0dWFsUGFy
        ZW50VmlldykgewogICAgICBub25WaXJ0dWFsUGFyZW50Vmlldy5zZXQodmll
        d05hbWUsIG51bGwpOwogICAgfQoKICAgIGNoaWxkTGVuID0gY2hpbGRWaWV3
        cy5sZW5ndGg7CiAgICBmb3IgKGk9Y2hpbGRMZW4tMTsgaT49MDsgaS0tKSB7
        CiAgICAgIGNoaWxkVmlld3NbaV0uZGVzdHJveSgpOwogICAgfQoKICAgIHJl
        dHVybiB0aGlzOwogIH0sCgogIC8qKgogICAgSW5zdGFudGlhdGVzIGEgdmll
        dyB0byBiZSBhZGRlZCB0byB0aGUgY2hpbGRWaWV3cyBhcnJheSBkdXJpbmcg
        dmlldwogICAgaW5pdGlhbGl6YXRpb24uIFlvdSBnZW5lcmFsbHkgd2lsbCBu
        b3QgY2FsbCB0aGlzIG1ldGhvZCBkaXJlY3RseSB1bmxlc3MKICAgIHlvdSBh
        cmUgb3ZlcnJpZGluZyBgY3JlYXRlQ2hpbGRWaWV3cygpYC4gTm90ZSB0aGF0
        IHRoaXMgbWV0aG9kIHdpbGwKICAgIGF1dG9tYXRpY2FsbHkgY29uZmlndXJl
        IHRoZSBjb3JyZWN0IHNldHRpbmdzIG9uIHRoZSBuZXcgdmlldyBpbnN0YW5j
        ZSB0bwogICAgYWN0IGFzIGEgY2hpbGQgb2YgdGhlIHBhcmVudC4KCiAgICBA
        bWV0aG9kIGNyZWF0ZUNoaWxkVmlldwogICAgQHBhcmFtIHtDbGFzc3xTdHJp
        bmd9IHZpZXdDbGFzcwogICAgQHBhcmFtIHtIYXNofSBbYXR0cnNdIEF0dHJp
        YnV0ZXMgdG8gYWRkCiAgICBAcmV0dXJuIHtFbWJlci5WaWV3fSBuZXcgaW5z
        dGFuY2UKICAqLwogIGNyZWF0ZUNoaWxkVmlldzogZnVuY3Rpb24odmlldywg
        YXR0cnMpIHsKICAgIGlmICghdmlldykgewogICAgICB0aHJvdyBuZXcgVHlw
        ZUVycm9yKCJjcmVhdGVDaGlsZFZpZXdzIGZpcnN0IGFyZ3VtZW50IG11c3Qg
        ZXhpc3QiKTsKICAgIH0KCiAgICBpZiAodmlldy5pc1ZpZXcgJiYgdmlldy5f
        cGFyZW50VmlldyA9PT0gdGhpcyAmJiB2aWV3LmNvbnRhaW5lciA9PT0gdGhp
        cy5jb250YWluZXIpIHsKICAgICAgcmV0dXJuIHZpZXc7CiAgICB9CgogICAg
        YXR0cnMgPSBhdHRycyB8fCB7fTsKICAgIGF0dHJzLl9wYXJlbnRWaWV3ID0g
        dGhpczsKCiAgICBpZiAoRW1iZXIuQ29yZVZpZXcuZGV0ZWN0KHZpZXcpKSB7
        CiAgICAgIGF0dHJzLnRlbXBsYXRlRGF0YSA9IGF0dHJzLnRlbXBsYXRlRGF0
        YSB8fCBnZXQodGhpcywgJ3RlbXBsYXRlRGF0YScpOwoKICAgICAgYXR0cnMu
        Y29udGFpbmVyID0gdGhpcy5jb250YWluZXI7CiAgICAgIHZpZXcgPSB2aWV3
        LmNyZWF0ZShhdHRycyk7CgogICAgICAvLyBkb24ndCBzZXQgdGhlIHByb3Bl
        cnR5IG9uIGEgdmlydHVhbCB2aWV3LCBhcyB0aGV5IGFyZSBpbnZpc2libGUg
        dG8KICAgICAgLy8gY29uc3VtZXJzIG9mIHRoZSB2aWV3IEFQSQogICAgICBp
        ZiAodmlldy52aWV3TmFtZSkgewogICAgICAgIHNldChnZXQodGhpcywgJ2Nv
        bmNyZXRlVmlldycpLCB2aWV3LnZpZXdOYW1lLCB2aWV3KTsKICAgICAgfQog
        ICAgfSBlbHNlIGlmICgnc3RyaW5nJyA9PT0gdHlwZW9mIHZpZXcpIHsKICAg
        ICAgdmFyIGZ1bGxOYW1lID0gJ3ZpZXc6JyArIHZpZXc7CiAgICAgIHZhciBW
        aWV3ID0gdGhpcy5jb250YWluZXIubG9va3VwRmFjdG9yeShmdWxsTmFtZSk7
        CgogICAgICBFbWJlci5hc3NlcnQoIkNvdWxkIG5vdCBmaW5kIHZpZXc6ICci
        ICsgZnVsbE5hbWUgKyAiJyIsICEhVmlldyk7CgogICAgICBhdHRycy50ZW1w
        bGF0ZURhdGEgPSBnZXQodGhpcywgJ3RlbXBsYXRlRGF0YScpOwogICAgICB2
        aWV3ID0gVmlldy5jcmVhdGUoYXR0cnMpOwogICAgfSBlbHNlIHsKICAgICAg
        RW1iZXIuYXNzZXJ0KCdZb3UgbXVzdCBwYXNzIGluc3RhbmNlIG9yIHN1YmNs
        YXNzIG9mIFZpZXcnLCB2aWV3LmlzVmlldyk7CiAgICAgIGF0dHJzLmNvbnRh
        aW5lciA9IHRoaXMuY29udGFpbmVyOwoKICAgICAgaWYgKCFnZXQodmlldywg
        J3RlbXBsYXRlRGF0YScpKSB7CiAgICAgICAgYXR0cnMudGVtcGxhdGVEYXRh
        ID0gZ2V0KHRoaXMsICd0ZW1wbGF0ZURhdGEnKTsKICAgICAgfQoKICAgICAg
        RW1iZXIuc2V0UHJvcGVydGllcyh2aWV3LCBhdHRycyk7CgogICAgfQoKICAg
        IHJldHVybiB2aWV3OwogIH0sCgogIGJlY2FtZVZpc2libGU6IEVtYmVyLkss
        CiAgYmVjYW1lSGlkZGVuOiBFbWJlci5LLAoKICAvKioKICAgIEBwcml2YXRl
        CgogICAgV2hlbiB0aGUgdmlldydzIGBpc1Zpc2libGVgIHByb3BlcnR5IGNo
        YW5nZXMsIHRvZ2dsZSB0aGUgdmlzaWJpbGl0eQogICAgZWxlbWVudCBvZiB0
        aGUgYWN0dWFsIERPTSBlbGVtZW50LgoKICAgIEBtZXRob2QgX2lzVmlzaWJs
        ZURpZENoYW5nZQogICovCiAgX2lzVmlzaWJsZURpZENoYW5nZTogRW1iZXIu
        b2JzZXJ2ZXIoZnVuY3Rpb24oKSB7CiAgICB2YXIgJGVsID0gdGhpcy4kKCk7
        CiAgICBpZiAoISRlbCkgeyByZXR1cm47IH0KCiAgICB2YXIgaXNWaXNpYmxl
        ID0gZ2V0KHRoaXMsICdpc1Zpc2libGUnKTsKCiAgICAkZWwudG9nZ2xlKGlz
        VmlzaWJsZSk7CgogICAgaWYgKHRoaXMuX2lzQW5jZXN0b3JIaWRkZW4oKSkg
        eyByZXR1cm47IH0KCiAgICBpZiAoaXNWaXNpYmxlKSB7CiAgICAgIHRoaXMu
        X25vdGlmeUJlY2FtZVZpc2libGUoKTsKICAgIH0gZWxzZSB7CiAgICAgIHRo
        aXMuX25vdGlmeUJlY2FtZUhpZGRlbigpOwogICAgfQogIH0sICdpc1Zpc2li
        bGUnKSwKCiAgX25vdGlmeUJlY2FtZVZpc2libGU6IGZ1bmN0aW9uKCkgewog
        ICAgdGhpcy50cmlnZ2VyKCdiZWNhbWVWaXNpYmxlJyk7CgogICAgdGhpcy5m
        b3JFYWNoQ2hpbGRWaWV3KGZ1bmN0aW9uKHZpZXcpIHsKICAgICAgdmFyIGlz
        VmlzaWJsZSA9IGdldCh2aWV3LCAnaXNWaXNpYmxlJyk7CgogICAgICBpZiAo
        aXNWaXNpYmxlIHx8IGlzVmlzaWJsZSA9PT0gbnVsbCkgewogICAgICAgIHZp
        ZXcuX25vdGlmeUJlY2FtZVZpc2libGUoKTsKICAgICAgfQogICAgfSk7CiAg
        fSwKCiAgX25vdGlmeUJlY2FtZUhpZGRlbjogZnVuY3Rpb24oKSB7CiAgICB0
        aGlzLnRyaWdnZXIoJ2JlY2FtZUhpZGRlbicpOwogICAgdGhpcy5mb3JFYWNo
        Q2hpbGRWaWV3KGZ1bmN0aW9uKHZpZXcpIHsKICAgICAgdmFyIGlzVmlzaWJs
        ZSA9IGdldCh2aWV3LCAnaXNWaXNpYmxlJyk7CgogICAgICBpZiAoaXNWaXNp
        YmxlIHx8IGlzVmlzaWJsZSA9PT0gbnVsbCkgewogICAgICAgIHZpZXcuX25v
        dGlmeUJlY2FtZUhpZGRlbigpOwogICAgICB9CiAgICB9KTsKICB9LAoKICBf
        aXNBbmNlc3RvckhpZGRlbjogZnVuY3Rpb24oKSB7CiAgICB2YXIgcGFyZW50
        ID0gZ2V0KHRoaXMsICdwYXJlbnRWaWV3Jyk7CgogICAgd2hpbGUgKHBhcmVu
        dCkgewogICAgICBpZiAoZ2V0KHBhcmVudCwgJ2lzVmlzaWJsZScpID09PSBm
        YWxzZSkgeyByZXR1cm4gdHJ1ZTsgfQoKICAgICAgcGFyZW50ID0gZ2V0KHBh
        cmVudCwgJ3BhcmVudFZpZXcnKTsKICAgIH0KCiAgICByZXR1cm4gZmFsc2U7
        CiAgfSwKCiAgY2xlYXJCdWZmZXI6IGZ1bmN0aW9uKCkgewogICAgdGhpcy5p
        bnZva2VSZWN1cnNpdmVseShmdW5jdGlvbih2aWV3KSB7CiAgICAgIHZpZXcu
        YnVmZmVyID0gbnVsbDsKICAgIH0pOwogIH0sCgogIHRyYW5zaXRpb25Ubzog
        ZnVuY3Rpb24oc3RhdGUsIGNoaWxkcmVuKSB7CiAgICB2YXIgcHJpb3JTdGF0
        ZSA9IHRoaXMuY3VycmVudFN0YXRlLAogICAgICAgIGN1cnJlbnRTdGF0ZSA9
        IHRoaXMuY3VycmVudFN0YXRlID0gdGhpcy5zdGF0ZXNbc3RhdGVdOwogICAg
        dGhpcy5zdGF0ZSA9IHN0YXRlOwoKICAgIGlmIChwcmlvclN0YXRlICYmIHBy
        aW9yU3RhdGUuZXhpdCkgeyBwcmlvclN0YXRlLmV4aXQodGhpcyk7IH0KICAg
        IGlmIChjdXJyZW50U3RhdGUuZW50ZXIpIHsgY3VycmVudFN0YXRlLmVudGVy
        KHRoaXMpOyB9CiAgICBpZiAoc3RhdGUgPT09ICdpbkRPTScpIHsgZGVsZXRl
        IEVtYmVyLm1ldGEodGhpcykuY2FjaGUuZWxlbWVudDsgfQoKICAgIGlmIChj
        aGlsZHJlbiAhPT0gZmFsc2UpIHsKICAgICAgdGhpcy5mb3JFYWNoQ2hpbGRW
        aWV3KGZ1bmN0aW9uKHZpZXcpIHsKICAgICAgICB2aWV3LnRyYW5zaXRpb25U
        byhzdGF0ZSk7CiAgICAgIH0pOwogICAgfQogIH0sCgogIC8vIC4uLi4uLi4u
        Li4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4u
        Li4KICAvLyBFVkVOVCBIQU5ETElORwogIC8vCgogIC8qKgogICAgQHByaXZh
        dGUKCiAgICBIYW5kbGUgZXZlbnRzIGZyb20gYEVtYmVyLkV2ZW50RGlzcGF0
        Y2hlcmAKCiAgICBAbWV0aG9kIGhhbmRsZUV2ZW50CiAgICBAcGFyYW0gZXZl
        bnROYW1lIHtTdHJpbmd9CiAgICBAcGFyYW0gZXZ0IHtFdmVudH0KICAqLwog
        IGhhbmRsZUV2ZW50OiBmdW5jdGlvbihldmVudE5hbWUsIGV2dCkgewogICAg
        cmV0dXJuIHRoaXMuY3VycmVudFN0YXRlLmhhbmRsZUV2ZW50KHRoaXMsIGV2
        ZW50TmFtZSwgZXZ0KTsKICB9LAoKICByZWdpc3Rlck9ic2VydmVyOiBmdW5j
        dGlvbihyb290LCBwYXRoLCB0YXJnZXQsIG9ic2VydmVyKSB7CiAgICBpZiAo
        IW9ic2VydmVyICYmICdmdW5jdGlvbicgPT09IHR5cGVvZiB0YXJnZXQpIHsK
        ICAgICAgb2JzZXJ2ZXIgPSB0YXJnZXQ7CiAgICAgIHRhcmdldCA9IG51bGw7
        CiAgICB9CgogICAgaWYgKCFyb290IHx8IHR5cGVvZiByb290ICE9PSAnb2Jq
        ZWN0JykgewogICAgICByZXR1cm47CiAgICB9CgogICAgdmFyIHZpZXcgPSB0
        aGlzLAogICAgICAgIHN0YXRlQ2hlY2tlZE9ic2VydmVyID0gZnVuY3Rpb24o
        KSB7CiAgICAgICAgICB2aWV3LmN1cnJlbnRTdGF0ZS5pbnZva2VPYnNlcnZl
        cih0aGlzLCBvYnNlcnZlcik7CiAgICAgICAgfSwKICAgICAgICBzY2hlZHVs
        ZWRPYnNlcnZlciA9IGZ1bmN0aW9uKCkgewogICAgICAgICAgRW1iZXIucnVu
        LnNjaGVkdWxlT25jZSgncmVuZGVyJywgdGhpcywgc3RhdGVDaGVja2VkT2Jz
        ZXJ2ZXIpOwogICAgICAgIH07CgogICAgRW1iZXIuYWRkT2JzZXJ2ZXIocm9v
        dCwgcGF0aCwgdGFyZ2V0LCBzY2hlZHVsZWRPYnNlcnZlcik7CgogICAgdGhp
        cy5vbmUoJ3dpbGxDbGVhclJlbmRlcicsIGZ1bmN0aW9uKCkgewogICAgICBF
        bWJlci5yZW1vdmVPYnNlcnZlcihyb290LCBwYXRoLCB0YXJnZXQsIHNjaGVk
        dWxlZE9ic2VydmVyKTsKICAgIH0pOwogIH0KCn0pOwoKLyoKICBEZXNjcmli
        ZSBob3cgdGhlIHNwZWNpZmllZCBhY3Rpb25zIHNob3VsZCBiZWhhdmUgaW4g
        dGhlIHZhcmlvdXMKICBzdGF0ZXMgdGhhdCBhIHZpZXcgY2FuIGV4aXN0IGlu
        LiBQb3NzaWJsZSBzdGF0ZXM6CgogICogcHJlUmVuZGVyOiB3aGVuIGEgdmll
        dyBpcyBmaXJzdCBpbnN0YW50aWF0ZWQsIGFuZCBhZnRlciBpdHMKICAgIGVs
        ZW1lbnQgd2FzIGRlc3Ryb3llZCwgaXQgaXMgaW4gdGhlIHByZVJlbmRlciBz
        dGF0ZQogICogaW5CdWZmZXI6IG9uY2UgYSB2aWV3IGhhcyBiZWVuIHJlbmRl
        cmVkLCBidXQgYmVmb3JlIGl0IGhhcwogICAgYmVlbiBpbnNlcnRlZCBpbnRv
        IHRoZSBET00sIGl0IGlzIGluIHRoZSBpbkJ1ZmZlciBzdGF0ZQogICogaW5E
        T006IG9uY2UgYSB2aWV3IGhhcyBiZWVuIGluc2VydGVkIGludG8gdGhlIERP
        TSBpdCBpcyBpbgogICAgdGhlIGluRE9NIHN0YXRlLiBBIHZpZXcgc3BlbmRz
        IHRoZSB2YXN0IG1ham9yaXR5IG9mIGl0cwogICAgZXhpc3RlbmNlIGluIHRo
        aXMgc3RhdGUuCiAgKiBkZXN0cm95ZWQ6IG9uY2UgYSB2aWV3IGhhcyBiZWVu
        IGRlc3Ryb3llZCAodXNpbmcgdGhlIGRlc3Ryb3kKICAgIG1ldGhvZCksIGl0
        IGlzIGluIHRoaXMgc3RhdGUuIE5vIGZ1cnRoZXIgYWN0aW9ucyBjYW4gYmUg
        aW52b2tlZAogICAgb24gYSBkZXN0cm95ZWQgdmlldy4KKi8KCiAgLy8gaW4g
        dGhlIGRlc3Ryb3llZCBzdGF0ZSwgZXZlcnl0aGluZyBpcyBpbGxlZ2FsCgog
        IC8vIGJlZm9yZSByZW5kZXJpbmcgaGFzIGJlZ3VuLCBhbGwgbGVnYWwgbWFu
        aXB1bGF0aW9ucyBhcmUgbm9vcHMuCgogIC8vIGluc2lkZSB0aGUgYnVmZmVy
        LCBsZWdhbCBtYW5pcHVsYXRpb25zIGFyZSBkb25lIG9uIHRoZSBidWZmZXIK
        CiAgLy8gb25jZSB0aGUgdmlldyBoYXMgYmVlbiBpbnNlcnRlZCBpbnRvIHRo
        ZSBET00sIGxlZ2FsIG1hbmlwdWxhdGlvbnMKICAvLyBhcmUgZG9uZSBvbiB0
        aGUgRE9NIGVsZW1lbnQuCgpmdW5jdGlvbiBub3RpZnlNdXRhdGlvbkxpc3Rl
        bmVycygpIHsKICBFbWJlci5ydW4ub25jZShFbWJlci5WaWV3LCAnbm90aWZ5
        TXV0YXRpb25MaXN0ZW5lcnMnKTsKfQoKdmFyIERPTU1hbmFnZXIgPSB7CiAg
        cHJlcGVuZDogZnVuY3Rpb24odmlldywgaHRtbCkgewogICAgdmlldy4kKCku
        cHJlcGVuZChodG1sKTsKICAgIG5vdGlmeU11dGF0aW9uTGlzdGVuZXJzKCk7
        CiAgfSwKCiAgYWZ0ZXI6IGZ1bmN0aW9uKHZpZXcsIGh0bWwpIHsKICAgIHZp
        ZXcuJCgpLmFmdGVyKGh0bWwpOwogICAgbm90aWZ5TXV0YXRpb25MaXN0ZW5l
        cnMoKTsKICB9LAoKICBodG1sOiBmdW5jdGlvbih2aWV3LCBodG1sKSB7CiAg
        ICB2aWV3LiQoKS5odG1sKGh0bWwpOwogICAgbm90aWZ5TXV0YXRpb25MaXN0
        ZW5lcnMoKTsKICB9LAoKICByZXBsYWNlOiBmdW5jdGlvbih2aWV3KSB7CiAg
        ICB2YXIgZWxlbWVudCA9IGdldCh2aWV3LCAnZWxlbWVudCcpOwoKICAgIHNl
        dCh2aWV3LCAnZWxlbWVudCcsIG51bGwpOwoKICAgIHZpZXcuX2luc2VydEVs
        ZW1lbnRMYXRlcihmdW5jdGlvbigpIHsKICAgICAgRW1iZXIuJChlbGVtZW50
        KS5yZXBsYWNlV2l0aChnZXQodmlldywgJ2VsZW1lbnQnKSk7CiAgICAgIG5v
        dGlmeU11dGF0aW9uTGlzdGVuZXJzKCk7CiAgICB9KTsKICB9LAoKICByZW1v
        dmU6IGZ1bmN0aW9uKHZpZXcpIHsKICAgIHZpZXcuJCgpLnJlbW92ZSgpOwog
        ICAgbm90aWZ5TXV0YXRpb25MaXN0ZW5lcnMoKTsKICB9LAoKICBlbXB0eTog
        ZnVuY3Rpb24odmlldykgewogICAgdmlldy4kKCkuZW1wdHkoKTsKICAgIG5v
        dGlmeU11dGF0aW9uTGlzdGVuZXJzKCk7CiAgfQp9OwoKRW1iZXIuVmlldy5y
        ZW9wZW4oewogIGRvbU1hbmFnZXI6IERPTU1hbmFnZXIKfSk7CgpFbWJlci5W
        aWV3LnJlb3BlbkNsYXNzKHsKCiAgLyoqCiAgICBAcHJpdmF0ZQoKICAgIFBh
        cnNlIGEgcGF0aCBhbmQgcmV0dXJuIGFuIG9iamVjdCB3aGljaCBob2xkcyB0
        aGUgcGFyc2VkIHByb3BlcnRpZXMuCgogICAgRm9yIGV4YW1wbGUgYSBwYXRo
        IGxpa2UgImNvbnRlbnQuaXNFbmFibGVkOmVuYWJsZWQ6ZGlzYWJsZWQiIHdp
        bGwgcmV0dXJuIHRoZQogICAgZm9sbG93aW5nIG9iamVjdDoKCiAgICBgYGBq
        YXZhc2NyaXB0CiAgICB7CiAgICAgIHBhdGg6ICJjb250ZW50LmlzRW5hYmxl
        ZCIsCiAgICAgIGNsYXNzTmFtZTogImVuYWJsZWQiLAogICAgICBmYWxzeUNs
        YXNzTmFtZTogImRpc2FibGVkIiwKICAgICAgY2xhc3NOYW1lczogIjplbmFi
        bGVkOmRpc2FibGVkIgogICAgfQogICAgYGBgCgogICAgQG1ldGhvZCBfcGFy
        c2VQcm9wZXJ0eVBhdGgKICAgIEBzdGF0aWMKICAqLwogIF9wYXJzZVByb3Bl
        cnR5UGF0aDogZnVuY3Rpb24ocGF0aCkgewogICAgdmFyIHNwbGl0ID0gcGF0
        aC5zcGxpdCgnOicpLAogICAgICAgIHByb3BlcnR5UGF0aCA9IHNwbGl0WzBd
        LAogICAgICAgIGNsYXNzTmFtZXMgPSAiIiwKICAgICAgICBjbGFzc05hbWUs
        CiAgICAgICAgZmFsc3lDbGFzc05hbWU7CgogICAgLy8gY2hlY2sgaWYgdGhl
        IHByb3BlcnR5IGlzIGRlZmluZWQgYXMgcHJvcDpjbGFzcyBvciBwcm9wOnRy
        dWVDbGFzczpmYWxzZUNsYXNzCiAgICBpZiAoc3BsaXQubGVuZ3RoID4gMSkg
        ewogICAgICBjbGFzc05hbWUgPSBzcGxpdFsxXTsKICAgICAgaWYgKHNwbGl0
        Lmxlbmd0aCA9PT0gMykgeyBmYWxzeUNsYXNzTmFtZSA9IHNwbGl0WzJdOyB9
        CgogICAgICBjbGFzc05hbWVzID0gJzonICsgY2xhc3NOYW1lOwogICAgICBp
        ZiAoZmFsc3lDbGFzc05hbWUpIHsgY2xhc3NOYW1lcyArPSAiOiIgKyBmYWxz
        eUNsYXNzTmFtZTsgfQogICAgfQoKICAgIHJldHVybiB7CiAgICAgIHBhdGg6
        IHByb3BlcnR5UGF0aCwKICAgICAgY2xhc3NOYW1lczogY2xhc3NOYW1lcywK
        ICAgICAgY2xhc3NOYW1lOiAoY2xhc3NOYW1lID09PSAnJykgPyB1bmRlZmlu
        ZWQgOiBjbGFzc05hbWUsCiAgICAgIGZhbHN5Q2xhc3NOYW1lOiBmYWxzeUNs
        YXNzTmFtZQogICAgfTsKICB9LAoKICAvKioKICAgIEBwcml2YXRlCgogICAg
        R2V0IHRoZSBjbGFzcyBuYW1lIGZvciBhIGdpdmVuIHZhbHVlLCBiYXNlZCBv
        biB0aGUgcGF0aCwgb3B0aW9uYWwKICAgIGBjbGFzc05hbWVgIGFuZCBvcHRp
        b25hbCBgZmFsc3lDbGFzc05hbWVgLgoKICAgIC0gaWYgYSBgY2xhc3NOYW1l
        YCBvciBgZmFsc3lDbGFzc05hbWVgIGhhcyBiZWVuIHNwZWNpZmllZDoKICAg
        ICAgLSBpZiB0aGUgdmFsdWUgaXMgdHJ1dGh5IGFuZCBgY2xhc3NOYW1lYCBo
        YXMgYmVlbiBzcGVjaWZpZWQsCiAgICAgICAgYGNsYXNzTmFtZWAgaXMgcmV0
        dXJuZWQKICAgICAgLSBpZiB0aGUgdmFsdWUgaXMgZmFsc3kgYW5kIGBmYWxz
        eUNsYXNzTmFtZWAgaGFzIGJlZW4gc3BlY2lmaWVkLAogICAgICAgIGBmYWxz
        eUNsYXNzTmFtZWAgaXMgcmV0dXJuZWQKICAgICAgLSBvdGhlcndpc2UgYG51
        bGxgIGlzIHJldHVybmVkCiAgICAtIGlmIHRoZSB2YWx1ZSBpcyBgdHJ1ZWAs
        IHRoZSBkYXNoZXJpemVkIGxhc3QgcGFydCBvZiB0aGUgc3VwcGxpZWQgcGF0
        aAogICAgICBpcyByZXR1cm5lZAogICAgLSBpZiB0aGUgdmFsdWUgaXMgbm90
        IGBmYWxzZWAsIGB1bmRlZmluZWRgIG9yIGBudWxsYCwgdGhlIGB2YWx1ZWAK
        ICAgICAgaXMgcmV0dXJuZWQKICAgIC0gaWYgbm9uZSBvZiB0aGUgYWJvdmUg
        cnVsZXMgYXBwbHksIGBudWxsYCBpcyByZXR1cm5lZAoKICAgIEBtZXRob2Qg
        X2NsYXNzU3RyaW5nRm9yVmFsdWUKICAgIEBwYXJhbSBwYXRoCiAgICBAcGFy
        YW0gdmFsCiAgICBAcGFyYW0gY2xhc3NOYW1lCiAgICBAcGFyYW0gZmFsc3lD
        bGFzc05hbWUKICAgIEBzdGF0aWMKICAqLwogIF9jbGFzc1N0cmluZ0ZvclZh
        bHVlOiBmdW5jdGlvbihwYXRoLCB2YWwsIGNsYXNzTmFtZSwgZmFsc3lDbGFz
        c05hbWUpIHsKICAgIC8vIFdoZW4gdXNpbmcgdGhlIGNvbG9uIHN5bnRheCwg
        ZXZhbHVhdGUgdGhlIHRydXRoaW5lc3Mgb3IgZmFsc2luZXNzCiAgICAvLyBv
        ZiB0aGUgdmFsdWUgdG8gZGV0ZXJtaW5lIHdoaWNoIGNsYXNzTmFtZSB0byBy
        ZXR1cm4KICAgIGlmIChjbGFzc05hbWUgfHwgZmFsc3lDbGFzc05hbWUpIHsK
        ICAgICAgaWYgKGNsYXNzTmFtZSAmJiAhIXZhbCkgewogICAgICAgIHJldHVy
        biBjbGFzc05hbWU7CgogICAgICB9IGVsc2UgaWYgKGZhbHN5Q2xhc3NOYW1l
        ICYmICF2YWwpIHsKICAgICAgICByZXR1cm4gZmFsc3lDbGFzc05hbWU7Cgog
        ICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiBudWxsOwogICAgICB9Cgog
        ICAgLy8gSWYgdmFsdWUgaXMgYSBCb29sZWFuIGFuZCB0cnVlLCByZXR1cm4g
        dGhlIGRhc2hlcml6ZWQgcHJvcGVydHkKICAgIC8vIG5hbWUuCiAgICB9IGVs
        c2UgaWYgKHZhbCA9PT0gdHJ1ZSkgewogICAgICAvLyBOb3JtYWxpemUgcHJv
        cGVydHkgcGF0aCB0byBiZSBzdWl0YWJsZSBmb3IgdXNlCiAgICAgIC8vIGFz
        IGEgY2xhc3MgbmFtZS4gRm9yIGV4YXBsZSwgY29udGVudC5mb28uYmFyQmF6
        CiAgICAgIC8vIGJlY29tZXMgYmFyLWJhei4KICAgICAgdmFyIHBhcnRzID0g
        cGF0aC5zcGxpdCgnLicpOwogICAgICByZXR1cm4gRW1iZXIuU3RyaW5nLmRh
        c2hlcml6ZShwYXJ0c1twYXJ0cy5sZW5ndGgtMV0pOwoKICAgIC8vIElmIHRo
        ZSB2YWx1ZSBpcyBub3QgZmFsc2UsIHVuZGVmaW5lZCwgb3IgbnVsbCwgcmV0
        dXJuIHRoZSBjdXJyZW50CiAgICAvLyB2YWx1ZSBvZiB0aGUgcHJvcGVydHku
        CiAgICB9IGVsc2UgaWYgKHZhbCAhPT0gZmFsc2UgJiYgdmFsICE9IG51bGwp
        IHsKICAgICAgcmV0dXJuIHZhbDsKCiAgICAvLyBOb3RoaW5nIHRvIGRpc3Bs
        YXkuIFJldHVybiBudWxsIHNvIHRoYXQgdGhlIG9sZCBjbGFzcyBpcyByZW1v
        dmVkCiAgICAvLyBidXQgbm8gbmV3IGNsYXNzIGlzIGFkZGVkLgogICAgfSBl
        bHNlIHsKICAgICAgcmV0dXJuIG51bGw7CiAgICB9CiAgfQp9KTsKCnZhciBt
        dXRhdGlvbiA9IEVtYmVyLk9iamVjdC5leHRlbmQoRW1iZXIuRXZlbnRlZCku
        Y3JlYXRlKCk7CgpFbWJlci5WaWV3LmFkZE11dGF0aW9uTGlzdGVuZXIgPSBm
        dW5jdGlvbihjYWxsYmFjaykgewogIG11dGF0aW9uLm9uKCdjaGFuZ2UnLCBj
        YWxsYmFjayk7Cn07CgpFbWJlci5WaWV3LnJlbW92ZU11dGF0aW9uTGlzdGVu
        ZXIgPSBmdW5jdGlvbihjYWxsYmFjaykgewogIG11dGF0aW9uLm9mZignY2hh
        bmdlJywgY2FsbGJhY2spOwp9OwoKRW1iZXIuVmlldy5ub3RpZnlNdXRhdGlv
        bkxpc3RlbmVycyA9IGZ1bmN0aW9uKCkgewogIG11dGF0aW9uLnRyaWdnZXIo
        J2NoYW5nZScpOwp9OwoKLyoqCiAgR2xvYmFsIHZpZXdzIGhhc2gKCiAgQHBy
        b3BlcnR5IHZpZXdzCiAgQHN0YXRpYwogIEB0eXBlIEhhc2gKKi8KRW1iZXIu
        Vmlldy52aWV3cyA9IHt9OwoKLy8gSWYgc29tZW9uZSBvdmVycmlkZXMgdGhl
        IGNoaWxkIHZpZXdzIGNvbXB1dGVkIHByb3BlcnR5IHdoZW4KLy8gZGVmaW5p
        bmcgdGhlaXIgY2xhc3MsIHdlIHdhbnQgdG8gYmUgYWJsZSB0byBwcm9jZXNz
        IHRoZSB1c2VyJ3MKLy8gc3VwcGxpZWQgY2hpbGRWaWV3cyBhbmQgdGhlbiBy
        ZXN0b3JlIHRoZSBvcmlnaW5hbCBjb21wdXRlZCBwcm9wZXJ0eQovLyBhdCB2
        aWV3IGluaXRpYWxpemF0aW9uIHRpbWUuIFRoaXMgaGFwcGVucyBpbiBFbWJl
        ci5Db250YWluZXJWaWV3J3MgaW5pdAovLyBtZXRob2QuCkVtYmVyLlZpZXcu
        Y2hpbGRWaWV3c1Byb3BlcnR5ID0gY2hpbGRWaWV3c1Byb3BlcnR5OwoKRW1i
        ZXIuVmlldy5hcHBseUF0dHJpYnV0ZUJpbmRpbmdzID0gZnVuY3Rpb24oZWxl
        bSwgbmFtZSwgdmFsdWUpIHsKICB2YXIgdHlwZSA9IEVtYmVyLnR5cGVPZih2
        YWx1ZSk7CgogIC8vIGlmIHRoaXMgY2hhbmdlcywgYWxzbyBjaGFuZ2UgdGhl
        IGxvZ2ljIGluIGVtYmVyLWhhbmRsZWJhcnMvbGliL2hlbHBlcnMvYmluZGlu
        Zy5qcwogIGlmIChuYW1lICE9PSAndmFsdWUnICYmICh0eXBlID09PSAnc3Ry
        aW5nJyB8fCAodHlwZSA9PT0gJ251bWJlcicgJiYgIWlzTmFOKHZhbHVlKSkp
        KSB7CiAgICBpZiAodmFsdWUgIT09IGVsZW0uYXR0cihuYW1lKSkgewogICAg
        ICBlbGVtLmF0dHIobmFtZSwgdmFsdWUpOwogICAgfQogIH0gZWxzZSBpZiAo
        bmFtZSA9PT0gJ3ZhbHVlJyB8fCB0eXBlID09PSAnYm9vbGVhbicpIHsKICAg
        IC8vIFdlIGNhbid0IHNldCBwcm9wZXJ0aWVzIHRvIHVuZGVmaW5lZCBvciBu
        dWxsCiAgICBpZiAoRW1iZXIuaXNOb25lKHZhbHVlKSkgeyB2YWx1ZSA9ICcn
        OyB9CgogICAgaWYgKHZhbHVlICE9PSBlbGVtLnByb3AobmFtZSkpIHsKICAg
        ICAgLy8gdmFsdWUgYW5kIGJvb2xlYW5zIHNob3VsZCBhbHdheXMgYmUgcHJv
        cGVydGllcwogICAgICBlbGVtLnByb3AobmFtZSwgdmFsdWUpOwogICAgfQog
        IH0gZWxzZSBpZiAoIXZhbHVlKSB7CiAgICBlbGVtLnJlbW92ZUF0dHIobmFt
        ZSk7CiAgfQp9OwoKRW1iZXIuVmlldy5zdGF0ZXMgPSBzdGF0ZXM7Cgp9KSgp
        OwoKCgooZnVuY3Rpb24oKSB7Ci8qKgpAbW9kdWxlIGVtYmVyCkBzdWJtb2R1
        bGUgZW1iZXItdmlld3MKKi8KCnZhciBnZXQgPSBFbWJlci5nZXQsIHNldCA9
        IEVtYmVyLnNldDsKCkVtYmVyLlZpZXcuc3RhdGVzLl9kZWZhdWx0ID0gewog
        IC8vIGFwcGVuZENoaWxkIGlzIG9ubHkgbGVnYWwgd2hpbGUgcmVuZGVyaW5n
        IHRoZSBidWZmZXIuCiAgYXBwZW5kQ2hpbGQ6IGZ1bmN0aW9uKCkgewogICAg
        dGhyb3cgIllvdSBjYW4ndCB1c2UgYXBwZW5kQ2hpbGQgb3V0c2lkZSBvZiB0
        aGUgcmVuZGVyaW5nIHByb2Nlc3MiOwogIH0sCgogICQ6IGZ1bmN0aW9uKCkg
        ewogICAgcmV0dXJuIHVuZGVmaW5lZDsKICB9LAoKICBnZXRFbGVtZW50OiBm
        dW5jdGlvbigpIHsKICAgIHJldHVybiBudWxsOwogIH0sCgogIC8vIEhhbmRs
        ZSBldmVudHMgZnJvbSBgRW1iZXIuRXZlbnREaXNwYXRjaGVyYAogIGhhbmRs
        ZUV2ZW50OiBmdW5jdGlvbigpIHsKICAgIHJldHVybiB0cnVlOyAvLyBjb250
        aW51ZSBldmVudCBwcm9wYWdhdGlvbgogIH0sCgogIGRlc3Ryb3lFbGVtZW50
        OiBmdW5jdGlvbih2aWV3KSB7CiAgICBzZXQodmlldywgJ2VsZW1lbnQnLCBu
        dWxsKTsKICAgIGlmICh2aWV3Ll9zY2hlZHVsZWRJbnNlcnQpIHsKICAgICAg
        RW1iZXIucnVuLmNhbmNlbCh2aWV3Ll9zY2hlZHVsZWRJbnNlcnQpOwogICAg
        ICB2aWV3Ll9zY2hlZHVsZWRJbnNlcnQgPSBudWxsOwogICAgfQogICAgcmV0
        dXJuIHZpZXc7CiAgfSwKCiAgcmVuZGVyVG9CdWZmZXJJZk5lZWRlZDogZnVu
        Y3Rpb24gKCkgewogICAgcmV0dXJuIGZhbHNlOwogIH0sCgogIHJlcmVuZGVy
        OiBFbWJlci5LLAogIGludm9rZU9ic2VydmVyOiBFbWJlci5LCn07Cgp9KSgp
        OwoKCgooZnVuY3Rpb24oKSB7Ci8qKgpAbW9kdWxlIGVtYmVyCkBzdWJtb2R1
        bGUgZW1iZXItdmlld3MKKi8KCnZhciBwcmVSZW5kZXIgPSBFbWJlci5WaWV3
        LnN0YXRlcy5wcmVSZW5kZXIgPSBFbWJlci5jcmVhdGUoRW1iZXIuVmlldy5z
        dGF0ZXMuX2RlZmF1bHQpOwoKRW1iZXIubWVyZ2UocHJlUmVuZGVyLCB7CiAg
        Ly8gYSB2aWV3IGxlYXZlcyB0aGUgcHJlUmVuZGVyIHN0YXRlIG9uY2UgaXRz
        IGVsZW1lbnQgaGFzIGJlZW4KICAvLyBjcmVhdGVkIChjcmVhdGVFbGVtZW50
        KS4KICBpbnNlcnRFbGVtZW50OiBmdW5jdGlvbih2aWV3LCBmbikgewogICAg
        dmlldy5jcmVhdGVFbGVtZW50KCk7CiAgICB2YXIgdmlld0NvbGxlY3Rpb24g
        PSB2aWV3LnZpZXdIaWVyYXJjaHlDb2xsZWN0aW9uKCk7CgogICAgdmlld0Nv
        bGxlY3Rpb24udHJpZ2dlcignd2lsbEluc2VydEVsZW1lbnQnKTsKCiAgICBm
        bi5jYWxsKHZpZXcpOwoKICAgIC8vIFdlIHRyYW5zaXRpb24gdG8gYGluRE9N
        YCBpZiB0aGUgZWxlbWVudCBleGlzdHMgaW4gdGhlIERPTQogICAgdmFyIGVs
        ZW1lbnQgPSB2aWV3LmdldCgnZWxlbWVudCcpOwogICAgd2hpbGUgKGVsZW1l
        bnQgPSBlbGVtZW50LnBhcmVudE5vZGUpIHsKICAgICAgaWYgKGVsZW1lbnQg
        PT09IGRvY3VtZW50KSB7CiAgICAgICAgdmlld0NvbGxlY3Rpb24udHJhbnNp
        dGlvblRvKCdpbkRPTScsIGZhbHNlKTsKICAgICAgICB2aWV3Q29sbGVjdGlv
        bi50cmlnZ2VyKCdkaWRJbnNlcnRFbGVtZW50Jyk7CiAgICAgIH0KICAgIH0K
        CiAgfSwKCiAgcmVuZGVyVG9CdWZmZXJJZk5lZWRlZDogZnVuY3Rpb24odmll
        dywgYnVmZmVyKSB7CiAgICB2aWV3LnJlbmRlclRvQnVmZmVyKGJ1ZmZlcik7
        CiAgICByZXR1cm4gdHJ1ZTsKICB9LAoKICBlbXB0eTogRW1iZXIuSywKCiAg
        c2V0RWxlbWVudDogZnVuY3Rpb24odmlldywgdmFsdWUpIHsKICAgIGlmICh2
        YWx1ZSAhPT0gbnVsbCkgewogICAgICB2aWV3LnRyYW5zaXRpb25UbygnaGFz
        RWxlbWVudCcpOwogICAgfQogICAgcmV0dXJuIHZhbHVlOwogIH0KfSk7Cgp9
        KSgpOwoKCgooZnVuY3Rpb24oKSB7Ci8qKgpAbW9kdWxlIGVtYmVyCkBzdWJt
        b2R1bGUgZW1iZXItdmlld3MKKi8KCnZhciBnZXQgPSBFbWJlci5nZXQsIHNl
        dCA9IEVtYmVyLnNldDsKCnZhciBpbkJ1ZmZlciA9IEVtYmVyLlZpZXcuc3Rh
        dGVzLmluQnVmZmVyID0gRW1iZXIuY3JlYXRlKEVtYmVyLlZpZXcuc3RhdGVz
        Ll9kZWZhdWx0KTsKCkVtYmVyLm1lcmdlKGluQnVmZmVyLCB7CiAgJDogZnVu
        Y3Rpb24odmlldywgc2VsKSB7CiAgICAvLyBpZiB3ZSBkb24ndCBoYXZlIGFu
        IGVsZW1lbnQgeWV0LCBzb21lb25lIGNhbGxpbmcgdGhpcy4kKCkgaXMKICAg
        IC8vIHRyeWluZyB0byB1cGRhdGUgYW4gZWxlbWVudCB0aGF0IGlzbid0IGlu
        IHRoZSBET00uIEluc3RlYWQsCiAgICAvLyByZXJlbmRlciB0aGUgdmlldyB0
        byBhbGxvdyB0aGUgcmVuZGVyIG1ldGhvZCB0byByZWZsZWN0IHRoZQogICAg
        Ly8gY2hhbmdlcy4KICAgIHZpZXcucmVyZW5kZXIoKTsKICAgIHJldHVybiBF
        bWJlci4kKCk7CiAgfSwKCiAgLy8gd2hlbiBhIHZpZXcgaXMgcmVuZGVyZWQg
        aW4gYSBidWZmZXIsIHJlcmVuZGVyaW5nIGl0IHNpbXBseQogIC8vIHJlcGxh
        Y2VzIHRoZSBleGlzdGluZyBidWZmZXIgd2l0aCBhIG5ldyBvbmUKICByZXJl
        bmRlcjogZnVuY3Rpb24odmlldykgewogICAgdGhyb3cgbmV3IEVtYmVyLkVy
        cm9yKCJTb21ldGhpbmcgeW91IGRpZCBjYXVzZWQgYSB2aWV3IHRvIHJlLXJl
        bmRlciBhZnRlciBpdCByZW5kZXJlZCBidXQgYmVmb3JlIGl0IHdhcyBpbnNl
        cnRlZCBpbnRvIHRoZSBET00uIik7CiAgfSwKCiAgLy8gd2hlbiBhIHZpZXcg
        aXMgcmVuZGVyZWQgaW4gYSBidWZmZXIsIGFwcGVuZGluZyBhIGNoaWxkCiAg
        Ly8gdmlldyB3aWxsIHJlbmRlciB0aGF0IHZpZXcgYW5kIGFwcGVuZCB0aGUg
        cmVzdWx0aW5nCiAgLy8gYnVmZmVyIGludG8gaXRzIGJ1ZmZlci4KICBhcHBl
        bmRDaGlsZDogZnVuY3Rpb24odmlldywgY2hpbGRWaWV3LCBvcHRpb25zKSB7
        CiAgICB2YXIgYnVmZmVyID0gdmlldy5idWZmZXIsIF9jaGlsZFZpZXdzID0g
        dmlldy5fY2hpbGRWaWV3czsKCiAgICBjaGlsZFZpZXcgPSB2aWV3LmNyZWF0
        ZUNoaWxkVmlldyhjaGlsZFZpZXcsIG9wdGlvbnMpOwogICAgaWYgKCFfY2hp
        bGRWaWV3cy5sZW5ndGgpIHsgX2NoaWxkVmlld3MgPSB2aWV3Ll9jaGlsZFZp
        ZXdzID0gX2NoaWxkVmlld3Muc2xpY2UoKTsgfQogICAgX2NoaWxkVmlld3Mu
        cHVzaChjaGlsZFZpZXcpOwoKICAgIGNoaWxkVmlldy5yZW5kZXJUb0J1ZmZl
        cihidWZmZXIpOwoKICAgIHZpZXcucHJvcGVydHlEaWRDaGFuZ2UoJ2NoaWxk
        Vmlld3MnKTsKCiAgICByZXR1cm4gY2hpbGRWaWV3OwogIH0sCgogIC8vIHdo
        ZW4gYSB2aWV3IGlzIHJlbmRlcmVkIGluIGEgYnVmZmVyLCBkZXN0cm95aW5n
        IHRoZQogIC8vIGVsZW1lbnQgd2lsbCBzaW1wbHkgZGVzdHJveSB0aGUgYnVm
        ZmVyIGFuZCBwdXQgdGhlCiAgLy8gc3RhdGUgYmFjayBpbnRvIHRoZSBwcmVS
        ZW5kZXIgc3RhdGUuCiAgZGVzdHJveUVsZW1lbnQ6IGZ1bmN0aW9uKHZpZXcp
        IHsKICAgIHZpZXcuY2xlYXJCdWZmZXIoKTsKICAgIHZhciB2aWV3Q29sbGVj
        dGlvbiA9IHZpZXcuX25vdGlmeVdpbGxEZXN0cm95RWxlbWVudCgpOwogICAg
        dmlld0NvbGxlY3Rpb24udHJhbnNpdGlvblRvKCdwcmVSZW5kZXInLCBmYWxz
        ZSk7CgogICAgcmV0dXJuIHZpZXc7CiAgfSwKCiAgZW1wdHk6IGZ1bmN0aW9u
        KCkgewogICAgRW1iZXIuYXNzZXJ0KCJFbXB0eWluZyBhIHZpZXcgaW4gdGhl
        IGluQnVmZmVyIHN0YXRlIGlzIG5vdCBhbGxvd2VkIGFuZCBzaG91bGQgbm90
        IGhhcHBlbiB1bmRlciBub3JtYWwgY2lyY3Vtc3RhbmNlcy4gTW9zdCBsaWtl
        bHkgdGhlcmUgaXMgYSBidWcgaW4geW91ciBhcHBsaWNhdGlvbi4gVGhpcyBt
        YXkgYmUgZHVlIHRvIGV4Y2Vzc2l2ZSBwcm9wZXJ0eSBjaGFuZ2Ugbm90aWZp
        Y2F0aW9ucy4iKTsKICB9LAoKICByZW5kZXJUb0J1ZmZlcklmTmVlZGVkOiBm
        dW5jdGlvbiAodmlldywgYnVmZmVyKSB7CiAgICByZXR1cm4gZmFsc2U7CiAg
        fSwKCiAgLy8gSXQgc2hvdWxkIGJlIGltcG9zc2libGUgZm9yIGEgcmVuZGVy
        ZWQgdmlldyB0byBiZSBzY2hlZHVsZWQgZm9yCiAgLy8gaW5zZXJ0aW9uLgog
        IGluc2VydEVsZW1lbnQ6IGZ1bmN0aW9uKCkgewogICAgdGhyb3cgIllvdSBj
        YW4ndCBpbnNlcnQgYW4gZWxlbWVudCB0aGF0IGhhcyBhbHJlYWR5IGJlZW4g
        cmVuZGVyZWQiOwogIH0sCgogIHNldEVsZW1lbnQ6IGZ1bmN0aW9uKHZpZXcs
        IHZhbHVlKSB7CiAgICBpZiAodmFsdWUgPT09IG51bGwpIHsKICAgICAgdmll
        dy50cmFuc2l0aW9uVG8oJ3ByZVJlbmRlcicpOwogICAgfSBlbHNlIHsKICAg
        ICAgdmlldy5jbGVhckJ1ZmZlcigpOwogICAgICB2aWV3LnRyYW5zaXRpb25U
        bygnaGFzRWxlbWVudCcpOwogICAgfQoKICAgIHJldHVybiB2YWx1ZTsKICB9
        LAoKICBpbnZva2VPYnNlcnZlcjogZnVuY3Rpb24odGFyZ2V0LCBvYnNlcnZl
        cikgewogICAgb2JzZXJ2ZXIuY2FsbCh0YXJnZXQpOwogIH0KfSk7CgoKfSko
        KTsKCgoKKGZ1bmN0aW9uKCkgewovKioKQG1vZHVsZSBlbWJlcgpAc3VibW9k
        dWxlIGVtYmVyLXZpZXdzCiovCgp2YXIgZ2V0ID0gRW1iZXIuZ2V0LCBzZXQg
        PSBFbWJlci5zZXQ7Cgp2YXIgaGFzRWxlbWVudCA9IEVtYmVyLlZpZXcuc3Rh
        dGVzLmhhc0VsZW1lbnQgPSBFbWJlci5jcmVhdGUoRW1iZXIuVmlldy5zdGF0
        ZXMuX2RlZmF1bHQpOwoKRW1iZXIubWVyZ2UoaGFzRWxlbWVudCwgewogICQ6
        IGZ1bmN0aW9uKHZpZXcsIHNlbCkgewogICAgdmFyIGVsZW0gPSBnZXQodmll
        dywgJ2VsZW1lbnQnKTsKICAgIHJldHVybiBzZWwgPyBFbWJlci4kKHNlbCwg
        ZWxlbSkgOiBFbWJlci4kKGVsZW0pOwogIH0sCgogIGdldEVsZW1lbnQ6IGZ1
        bmN0aW9uKHZpZXcpIHsKICAgIHZhciBwYXJlbnQgPSBnZXQodmlldywgJ3Bh
        cmVudFZpZXcnKTsKICAgIGlmIChwYXJlbnQpIHsgcGFyZW50ID0gZ2V0KHBh
        cmVudCwgJ2VsZW1lbnQnKTsgfQogICAgaWYgKHBhcmVudCkgeyByZXR1cm4g
        dmlldy5maW5kRWxlbWVudEluUGFyZW50RWxlbWVudChwYXJlbnQpOyB9CiAg
        ICByZXR1cm4gRW1iZXIuJCgiIyIgKyBnZXQodmlldywgJ2VsZW1lbnRJZCcp
        KVswXTsKICB9LAoKICBzZXRFbGVtZW50OiBmdW5jdGlvbih2aWV3LCB2YWx1
        ZSkgewogICAgaWYgKHZhbHVlID09PSBudWxsKSB7CiAgICAgIHZpZXcudHJh
        bnNpdGlvblRvKCdwcmVSZW5kZXInKTsKICAgIH0gZWxzZSB7CiAgICAgIHRo
        cm93ICJZb3UgY2Fubm90IHNldCBhbiBlbGVtZW50IHRvIGEgbm9uLW51bGwg
        dmFsdWUgd2hlbiB0aGUgZWxlbWVudCBpcyBhbHJlYWR5IGluIHRoZSBET00u
        IjsKICAgIH0KCiAgICByZXR1cm4gdmFsdWU7CiAgfSwKCiAgLy8gb25jZSB0
        aGUgdmlldyBoYXMgYmVlbiBpbnNlcnRlZCBpbnRvIHRoZSBET00sIHJlcmVu
        ZGVyaW5nIGlzCiAgLy8gZGVmZXJyZWQgdG8gYWxsb3cgYmluZGluZ3MgdG8g
        c3luY2hyb25pemUuCiAgcmVyZW5kZXI6IGZ1bmN0aW9uKHZpZXcpIHsKICAg
        IHZpZXcudHJpZ2dlclJlY3Vyc2l2ZWx5KCd3aWxsQ2xlYXJSZW5kZXInKTsK
        CiAgICB2aWV3LmNsZWFyUmVuZGVyZWRDaGlsZHJlbigpOwoKICAgIHZpZXcu
        ZG9tTWFuYWdlci5yZXBsYWNlKHZpZXcpOwogICAgcmV0dXJuIHZpZXc7CiAg
        fSwKCiAgLy8gb25jZSB0aGUgdmlldyBpcyBhbHJlYWR5IGluIHRoZSBET00s
        IGRlc3Ryb3lpbmcgaXQgcmVtb3ZlcyBpdAogIC8vIGZyb20gdGhlIERPTSwg
        bnVrZXMgaXRzIGVsZW1lbnQsIGFuZCBwdXRzIGl0IGJhY2sgaW50byB0aGUK
        ICAvLyBwcmVSZW5kZXIgc3RhdGUgaWYgaW5ET00uCgogIGRlc3Ryb3lFbGVt
        ZW50OiBmdW5jdGlvbih2aWV3KSB7CiAgICB2aWV3Ll9ub3RpZnlXaWxsRGVz
        dHJveUVsZW1lbnQoKTsKICAgIHZpZXcuZG9tTWFuYWdlci5yZW1vdmUodmll
        dyk7CiAgICBzZXQodmlldywgJ2VsZW1lbnQnLCBudWxsKTsKICAgIGlmICh2
        aWV3Ll9zY2hlZHVsZWRJbnNlcnQpIHsKICAgICAgRW1iZXIucnVuLmNhbmNl
        bCh2aWV3Ll9zY2hlZHVsZWRJbnNlcnQpOwogICAgICB2aWV3Ll9zY2hlZHVs
        ZWRJbnNlcnQgPSBudWxsOwogICAgfQogICAgcmV0dXJuIHZpZXc7CiAgfSwK
        CiAgZW1wdHk6IGZ1bmN0aW9uKHZpZXcpIHsKICAgIHZhciBfY2hpbGRWaWV3
        cyA9IHZpZXcuX2NoaWxkVmlld3MsIGxlbiwgaWR4OwogICAgaWYgKF9jaGls
        ZFZpZXdzKSB7CiAgICAgIGxlbiA9IF9jaGlsZFZpZXdzLmxlbmd0aDsKICAg
        ICAgZm9yIChpZHggPSAwOyBpZHggPCBsZW47IGlkeCsrKSB7CiAgICAgICAg
        X2NoaWxkVmlld3NbaWR4XS5fbm90aWZ5V2lsbERlc3Ryb3lFbGVtZW50KCk7
        CiAgICAgIH0KICAgIH0KICAgIHZpZXcuZG9tTWFuYWdlci5lbXB0eSh2aWV3
        KTsKICB9LAoKICAvLyBIYW5kbGUgZXZlbnRzIGZyb20gYEVtYmVyLkV2ZW50
        RGlzcGF0Y2hlcmAKICBoYW5kbGVFdmVudDogZnVuY3Rpb24odmlldywgZXZl
        bnROYW1lLCBldnQpIHsKICAgIGlmICh2aWV3LmhhcyhldmVudE5hbWUpKSB7
        CiAgICAgIC8vIEhhbmRsZXIgc2hvdWxkIGJlIGFibGUgdG8gcmUtZGlzcGF0
        Y2ggZXZlbnRzLCBzbyB3ZSBkb24ndAogICAgICAvLyBwcmV2ZW50RGVmYXVs
        dCBvciBzdG9wUHJvcGFnYXRpb24uCiAgICAgIHJldHVybiB2aWV3LnRyaWdn
        ZXIoZXZlbnROYW1lLCBldnQpOwogICAgfSBlbHNlIHsKICAgICAgcmV0dXJu
        IHRydWU7IC8vIGNvbnRpbnVlIGV2ZW50IHByb3BhZ2F0aW9uCiAgICB9CiAg
        fSwKCiAgaW52b2tlT2JzZXJ2ZXI6IGZ1bmN0aW9uKHRhcmdldCwgb2JzZXJ2
        ZXIpIHsKICAgIG9ic2VydmVyLmNhbGwodGFyZ2V0KTsKICB9Cn0pOwoKdmFy
        IGluRE9NID0gRW1iZXIuVmlldy5zdGF0ZXMuaW5ET00gPSBFbWJlci5jcmVh
        dGUoaGFzRWxlbWVudCk7CgpFbWJlci5tZXJnZShpbkRPTSwgewogIGVudGVy
        OiBmdW5jdGlvbih2aWV3KSB7CiAgICAvLyBSZWdpc3RlciB0aGUgdmlldyBm
        b3IgZXZlbnQgaGFuZGxpbmcuIFRoaXMgaGFzaCBpcyB1c2VkIGJ5CiAgICAv
        LyBFbWJlci5FdmVudERpc3BhdGNoZXIgdG8gZGlzcGF0Y2ggaW5jb21pbmcg
        ZXZlbnRzLgogICAgaWYgKCF2aWV3LmlzVmlydHVhbCkgewogICAgICBFbWJl
        ci5hc3NlcnQoIkF0dGVtcHRlZCB0byByZWdpc3RlciBhIHZpZXcgd2l0aCBh
        biBpZCBhbHJlYWR5IGluIHVzZTogIit2aWV3LmVsZW1lbnRJZCwgIUVtYmVy
        LlZpZXcudmlld3Nbdmlldy5lbGVtZW50SWRdKTsKICAgICAgRW1iZXIuVmll
        dy52aWV3c1t2aWV3LmVsZW1lbnRJZF0gPSB2aWV3OwogICAgfQoKICAgIHZp
        ZXcuYWRkQmVmb3JlT2JzZXJ2ZXIoJ2VsZW1lbnRJZCcsIGZ1bmN0aW9uKCkg
        ewogICAgICB0aHJvdyBuZXcgRW1iZXIuRXJyb3IoIkNoYW5naW5nIGEgdmll
        dydzIGVsZW1lbnRJZCBhZnRlciBjcmVhdGlvbiBpcyBub3QgYWxsb3dlZCIp
        OwogICAgfSk7CiAgfSwKCiAgZXhpdDogZnVuY3Rpb24odmlldykgewogICAg
        aWYgKCF0aGlzLmlzVmlydHVhbCkgZGVsZXRlIEVtYmVyLlZpZXcudmlld3Nb
        dmlldy5lbGVtZW50SWRdOwogIH0sCgogIGluc2VydEVsZW1lbnQ6IGZ1bmN0
        aW9uKHZpZXcsIGZuKSB7CiAgICB0aHJvdyAiWW91IGNhbid0IGluc2VydCBh
        biBlbGVtZW50IGludG8gdGhlIERPTSB0aGF0IGhhcyBhbHJlYWR5IGJlZW4g
        aW5zZXJ0ZWQiOwogIH0KfSk7Cgp9KSgpOwoKCgooZnVuY3Rpb24oKSB7Ci8q
        KgpAbW9kdWxlIGVtYmVyCkBzdWJtb2R1bGUgZW1iZXItdmlld3MKKi8KCnZh
        ciBkZXN0cm95aW5nRXJyb3IgPSAiWW91IGNhbid0IGNhbGwgJUAgb24gYSB2
        aWV3IGJlaW5nIGRlc3Ryb3llZCIsIGZtdCA9IEVtYmVyLlN0cmluZy5mbXQ7
        Cgp2YXIgZGVzdHJveWluZyA9IEVtYmVyLlZpZXcuc3RhdGVzLmRlc3Ryb3lp
        bmcgPSBFbWJlci5jcmVhdGUoRW1iZXIuVmlldy5zdGF0ZXMuX2RlZmF1bHQp
        OwoKRW1iZXIubWVyZ2UoZGVzdHJveWluZywgewogIGFwcGVuZENoaWxkOiBm
        dW5jdGlvbigpIHsKICAgIHRocm93IGZtdChkZXN0cm95aW5nRXJyb3IsIFsn
        YXBwZW5kQ2hpbGQnXSk7CiAgfSwKICByZXJlbmRlcjogZnVuY3Rpb24oKSB7
        CiAgICB0aHJvdyBmbXQoZGVzdHJveWluZ0Vycm9yLCBbJ3JlcmVuZGVyJ10p
        OwogIH0sCiAgZGVzdHJveUVsZW1lbnQ6IGZ1bmN0aW9uKCkgewogICAgdGhy
        b3cgZm10KGRlc3Ryb3lpbmdFcnJvciwgWydkZXN0cm95RWxlbWVudCddKTsK
        ICB9LAogIGVtcHR5OiBmdW5jdGlvbigpIHsKICAgIHRocm93IGZtdChkZXN0
        cm95aW5nRXJyb3IsIFsnZW1wdHknXSk7CiAgfSwKCiAgc2V0RWxlbWVudDog
        ZnVuY3Rpb24oKSB7CiAgICB0aHJvdyBmbXQoZGVzdHJveWluZ0Vycm9yLCBb
        InNldCgnZWxlbWVudCcsIC4uLikiXSk7CiAgfSwKCiAgcmVuZGVyVG9CdWZm
        ZXJJZk5lZWRlZDogZnVuY3Rpb24oKSB7CiAgICByZXR1cm4gZmFsc2U7CiAg
        fSwKCiAgLy8gU2luY2UgZWxlbWVudCBpbnNlcnRpb24gaXMgc2NoZWR1bGVk
        LCBkb24ndCBkbyBhbnl0aGluZyBpZgogIC8vIHRoZSB2aWV3IGhhcyBiZWVu
        IGRlc3Ryb3llZCBiZXR3ZWVuIHNjaGVkdWxpbmcgYW5kIGV4ZWN1dGlvbgog
        IGluc2VydEVsZW1lbnQ6IEVtYmVyLksKfSk7CgoKfSkoKTsKCgoKKGZ1bmN0
        aW9uKCkgewpFbWJlci5WaWV3LmNsb25lU3RhdGVzID0gZnVuY3Rpb24oZnJv
        bSkgewogIHZhciBpbnRvID0ge307CgogIGludG8uX2RlZmF1bHQgPSB7fTsK
        ICBpbnRvLnByZVJlbmRlciA9IEVtYmVyLmNyZWF0ZShpbnRvLl9kZWZhdWx0
        KTsKICBpbnRvLmRlc3Ryb3lpbmcgPSBFbWJlci5jcmVhdGUoaW50by5fZGVm
        YXVsdCk7CiAgaW50by5pbkJ1ZmZlciA9IEVtYmVyLmNyZWF0ZShpbnRvLl9k
        ZWZhdWx0KTsKICBpbnRvLmhhc0VsZW1lbnQgPSBFbWJlci5jcmVhdGUoaW50
        by5fZGVmYXVsdCk7CiAgaW50by5pbkRPTSA9IEVtYmVyLmNyZWF0ZShpbnRv
        Lmhhc0VsZW1lbnQpOwoKICBmb3IgKHZhciBzdGF0ZU5hbWUgaW4gZnJvbSkg
        ewogICAgaWYgKCFmcm9tLmhhc093blByb3BlcnR5KHN0YXRlTmFtZSkpIHsg
        Y29udGludWU7IH0KICAgIEVtYmVyLm1lcmdlKGludG9bc3RhdGVOYW1lXSwg
        ZnJvbVtzdGF0ZU5hbWVdKTsKICB9CgogIHJldHVybiBpbnRvOwp9OwoKfSko
        KTsKCgoKKGZ1bmN0aW9uKCkgewp2YXIgc3RhdGVzID0gRW1iZXIuVmlldy5j
        bG9uZVN0YXRlcyhFbWJlci5WaWV3LnN0YXRlcyk7CgovKioKQG1vZHVsZSBl
        bWJlcgpAc3VibW9kdWxlIGVtYmVyLXZpZXdzCiovCgp2YXIgZ2V0ID0gRW1i
        ZXIuZ2V0LCBzZXQgPSBFbWJlci5zZXQ7CnZhciBmb3JFYWNoID0gRW1iZXIu
        RW51bWVyYWJsZVV0aWxzLmZvckVhY2g7CnZhciBWaWV3Q29sbGVjdGlvbiA9
        IEVtYmVyLl9WaWV3Q29sbGVjdGlvbjsKCi8qKgogIEEgYENvbnRhaW5lclZp
        ZXdgIGlzIGFuIGBFbWJlci5WaWV3YCBzdWJjbGFzcyB0aGF0IGltcGxlbWVu
        dHMgYEVtYmVyLk11dGFibGVBcnJheWAKICBhbGxvd2luZyBwcm9ncmFtYXRp
        YyBtYW5hZ2VtZW50IG9mIGl0cyBjaGlsZCB2aWV3cy4KCiAgIyMgU2V0dGlu
        ZyBJbml0aWFsIENoaWxkIFZpZXdzCgogIFRoZSBpbml0aWFsIGFycmF5IG9m
        IGNoaWxkIHZpZXdzIGNhbiBiZSBzZXQgaW4gb25lIG9mIHR3byB3YXlzLiBZ
        b3UgY2FuCiAgcHJvdmlkZSBhIGBjaGlsZFZpZXdzYCBwcm9wZXJ0eSBhdCBj
        cmVhdGlvbiB0aW1lIHRoYXQgY29udGFpbnMgaW5zdGFuY2Ugb2YKICBgRW1i
        ZXIuVmlld2A6CgogIGBgYGphdmFzY3JpcHQKICBhQ29udGFpbmVyID0gRW1i
        ZXIuQ29udGFpbmVyVmlldy5jcmVhdGUoewogICAgY2hpbGRWaWV3czogW0Vt
        YmVyLlZpZXcuY3JlYXRlKCksIEVtYmVyLlZpZXcuY3JlYXRlKCldCiAgfSk7
        CiAgYGBgCgogIFlvdSBjYW4gYWxzbyBwcm92aWRlIGEgbGlzdCBvZiBwcm9w
        ZXJ0eSBuYW1lcyB3aG9zZSB2YWx1ZXMgYXJlIGluc3RhbmNlcyBvZgogIGBF
        bWJlci5WaWV3YDoKCiAgYGBgamF2YXNjcmlwdAogIGFDb250YWluZXIgPSBF
        bWJlci5Db250YWluZXJWaWV3LmNyZWF0ZSh7CiAgICBjaGlsZFZpZXdzOiBb
        J2FWaWV3JywgJ2JWaWV3JywgJ2NWaWV3J10sCiAgICBhVmlldzogRW1iZXIu
        Vmlldy5jcmVhdGUoKSwKICAgIGJWaWV3OiBFbWJlci5WaWV3LmNyZWF0ZSgp
        LAogICAgY1ZpZXc6IEVtYmVyLlZpZXcuY3JlYXRlKCkKICB9KTsKICBgYGAK
        CiAgVGhlIHR3byBzdHJhdGVnaWVzIGNhbiBiZSBjb21iaW5lZDoKCiAgYGBg
        amF2YXNjcmlwdAogIGFDb250YWluZXIgPSBFbWJlci5Db250YWluZXJWaWV3
        LmNyZWF0ZSh7CiAgICBjaGlsZFZpZXdzOiBbJ2FWaWV3JywgRW1iZXIuVmll
        dy5jcmVhdGUoKV0sCiAgICBhVmlldzogRW1iZXIuVmlldy5jcmVhdGUoKQog
        IH0pOwogIGBgYAoKICBFYWNoIGNoaWxkIHZpZXcncyByZW5kZXJpbmcgd2ls
        bCBiZSBpbnNlcnRlZCBpbnRvIHRoZSBjb250YWluZXIncyByZW5kZXJlZAog
        IEhUTUwgaW4gdGhlIHNhbWUgb3JkZXIgYXMgaXRzIHBvc2l0aW9uIGluIHRo
        ZSBgY2hpbGRWaWV3c2AgcHJvcGVydHkuCgogICMjIEFkZGluZyBhbmQgUmVt
        b3ZpbmcgQ2hpbGQgVmlld3MKCiAgVGhlIGNvbnRhaW5lciB2aWV3IGltcGxl
        bWVudHMgYEVtYmVyLk11dGFibGVBcnJheWAgYWxsb3dpbmcgcHJvZ3JhbWF0
        aWMgbWFuYWdlbWVudCBvZiBpdHMgY2hpbGQgdmlld3MuCgogIFRvIHJlbW92
        ZSBhIHZpZXcsIHBhc3MgdGhhdCB2aWV3IGludG8gYSBgcmVtb3ZlT2JqZWN0
        YCBjYWxsIG9uIHRoZSBjb250YWluZXIgdmlldy4KCiAgR2l2ZW4gYW4gZW1w
        dHkgYDxib2R5PmAgdGhlIGZvbGxvd2luZyBjb2RlCgogIGBgYGphdmFzY3Jp
        cHQKICBhQ29udGFpbmVyID0gRW1iZXIuQ29udGFpbmVyVmlldy5jcmVhdGUo
        ewogICAgY2xhc3NOYW1lczogWyd0aGUtY29udGFpbmVyJ10sCiAgICBjaGls
        ZFZpZXdzOiBbJ2FWaWV3JywgJ2JWaWV3J10sCiAgICBhVmlldzogRW1iZXIu
        Vmlldy5jcmVhdGUoewogICAgICB0ZW1wbGF0ZTogRW1iZXIuSGFuZGxlYmFy
        cy5jb21waWxlKCJBIikKICAgIH0pLAogICAgYlZpZXc6IEVtYmVyLlZpZXcu
        Y3JlYXRlKHsKICAgICAgdGVtcGxhdGU6IEVtYmVyLkhhbmRsZWJhcnMuY29t
        cGlsZSgiQiIpCiAgICB9KQogIH0pOwoKICBhQ29udGFpbmVyLmFwcGVuZFRv
        KCdib2R5Jyk7CiAgYGBgCgogIFJlc3VsdHMgaW4gdGhlIEhUTUwKCiAgYGBg
        aHRtbAogIDxkaXYgY2xhc3M9ImVtYmVyLXZpZXcgdGhlLWNvbnRhaW5lciI+
        CiAgICA8ZGl2IGNsYXNzPSJlbWJlci12aWV3Ij5BPC9kaXY+CiAgICA8ZGl2
        IGNsYXNzPSJlbWJlci12aWV3Ij5CPC9kaXY+CiAgPC9kaXY+CiAgYGBgCgog
        IFJlbW92aW5nIGEgdmlldwoKICBgYGBqYXZhc2NyaXB0CiAgYUNvbnRhaW5l
        ci50b0FycmF5KCk7ICAvLyBbYUNvbnRhaW5lci5hVmlldywgYUNvbnRhaW5l
        ci5iVmlld10KICBhQ29udGFpbmVyLnJlbW92ZU9iamVjdChhQ29udGFpbmVy
        LmdldCgnYlZpZXcnKSk7CiAgYUNvbnRhaW5lci50b0FycmF5KCk7ICAvLyBb
        YUNvbnRhaW5lci5hVmlld10KICBgYGAKCiAgV2lsbCByZXN1bHQgaW4gdGhl
        IGZvbGxvd2luZyBIVE1MCgogIGBgYGh0bWwKICA8ZGl2IGNsYXNzPSJlbWJl
        ci12aWV3IHRoZS1jb250YWluZXIiPgogICAgPGRpdiBjbGFzcz0iZW1iZXIt
        dmlldyI+QTwvZGl2PgogIDwvZGl2PgogIGBgYAoKICBTaW1pbGFybHksIGFk
        ZGluZyBhIGNoaWxkIHZpZXcgaXMgYWNjb21wbGlzaGVkIGJ5IGFkZGluZyBg
        RW1iZXIuVmlld2AgaW5zdGFuY2VzIHRvIHRoZQogIGNvbnRhaW5lciB2aWV3
        LgoKICBHaXZlbiBhbiBlbXB0eSBgPGJvZHk+YCB0aGUgZm9sbG93aW5nIGNv
        ZGUKCiAgYGBgamF2YXNjcmlwdAogIGFDb250YWluZXIgPSBFbWJlci5Db250
        YWluZXJWaWV3LmNyZWF0ZSh7CiAgICBjbGFzc05hbWVzOiBbJ3RoZS1jb250
        YWluZXInXSwKICAgIGNoaWxkVmlld3M6IFsnYVZpZXcnLCAnYlZpZXcnXSwK
        ICAgIGFWaWV3OiBFbWJlci5WaWV3LmNyZWF0ZSh7CiAgICAgIHRlbXBsYXRl
        OiBFbWJlci5IYW5kbGViYXJzLmNvbXBpbGUoIkEiKQogICAgfSksCiAgICBi
        VmlldzogRW1iZXIuVmlldy5jcmVhdGUoewogICAgICB0ZW1wbGF0ZTogRW1i
        ZXIuSGFuZGxlYmFycy5jb21waWxlKCJCIikKICAgIH0pCiAgfSk7CgogIGFD
        b250YWluZXIuYXBwZW5kVG8oJ2JvZHknKTsKICBgYGAKCiAgUmVzdWx0cyBp
        biB0aGUgSFRNTAoKICBgYGBodG1sCiAgPGRpdiBjbGFzcz0iZW1iZXItdmll
        dyB0aGUtY29udGFpbmVyIj4KICAgIDxkaXYgY2xhc3M9ImVtYmVyLXZpZXci
        PkE8L2Rpdj4KICAgIDxkaXYgY2xhc3M9ImVtYmVyLXZpZXciPkI8L2Rpdj4K
        ICA8L2Rpdj4KICBgYGAKCiAgQWRkaW5nIGEgdmlldwoKICBgYGBqYXZhc2Ny
        aXB0CiAgQW5vdGhlclZpZXdDbGFzcyA9IEVtYmVyLlZpZXcuZXh0ZW5kKHsK
        ICAgIHRlbXBsYXRlOiBFbWJlci5IYW5kbGViYXJzLmNvbXBpbGUoIkFub3Ro
        ZXIgdmlldyIpCiAgfSk7CgogIGFDb250YWluZXIudG9BcnJheSgpOyAgLy8g
        W2FDb250YWluZXIuYVZpZXcsIGFDb250YWluZXIuYlZpZXddCiAgYUNvbnRh
        aW5lci5wdXNoT2JqZWN0KEFub3RoZXJWaWV3Q2xhc3MuY3JlYXRlKCkpOwog
        IGFDb250YWluZXIudG9BcnJheSgpOyAvLyBbYUNvbnRhaW5lci5hVmlldywg
        YUNvbnRhaW5lci5iVmlldywgPEFub3RoZXJWaWV3Q2xhc3MgaW5zdGFuY2U+
        XQogIGBgYAoKICBXaWxsIHJlc3VsdCBpbiB0aGUgZm9sbG93aW5nIEhUTUwK
        CiAgYGBgaHRtbAogIDxkaXYgY2xhc3M9ImVtYmVyLXZpZXcgdGhlLWNvbnRh
        aW5lciI+CiAgICA8ZGl2IGNsYXNzPSJlbWJlci12aWV3Ij5BPC9kaXY+CiAg
        ICA8ZGl2IGNsYXNzPSJlbWJlci12aWV3Ij5CPC9kaXY+CiAgICA8ZGl2IGNs
        YXNzPSJlbWJlci12aWV3Ij5Bbm90aGVyIHZpZXc8L2Rpdj4KICA8L2Rpdj4K
        ICBgYGAKCiAgIyMgVGVtcGxhdGVzIGFuZCBMYXlvdXQKCiAgQSBgdGVtcGxh
        dGVgLCBgdGVtcGxhdGVOYW1lYCwgYGRlZmF1bHRUZW1wbGF0ZWAsIGBsYXlv
        dXRgLCBgbGF5b3V0TmFtZWAgb3IKICBgZGVmYXVsdExheW91dGAgcHJvcGVy
        dHkgb24gYSBjb250YWluZXIgdmlldyB3aWxsIG5vdCByZXN1bHQgaW4gdGhl
        IHRlbXBsYXRlCiAgb3IgbGF5b3V0IGJlaW5nIHJlbmRlcmVkLiBUaGUgSFRN
        TCBjb250ZW50cyBvZiBhIGBFbWJlci5Db250YWluZXJWaWV3YCdzIERPTQog
        IHJlcHJlc2VudGF0aW9uIHdpbGwgb25seSBiZSB0aGUgcmVuZGVyZWQgSFRN
        TCBvZiBpdHMgY2hpbGQgdmlld3MuCgogIEBjbGFzcyBDb250YWluZXJWaWV3
        CiAgQG5hbWVzcGFjZSBFbWJlcgogIEBleHRlbmRzIEVtYmVyLlZpZXcKKi8K
        RW1iZXIuQ29udGFpbmVyVmlldyA9IEVtYmVyLlZpZXcuZXh0ZW5kKEVtYmVy
        Lk11dGFibGVBcnJheSwgewogIHN0YXRlczogc3RhdGVzLAoKICBpbml0OiBm
        dW5jdGlvbigpIHsKICAgIHRoaXMuX3N1cGVyKCk7CgogICAgdmFyIGNoaWxk
        Vmlld3MgPSBnZXQodGhpcywgJ2NoaWxkVmlld3MnKTsKCiAgICAvLyByZWRl
        ZmluZSB2aWV3J3MgY2hpbGRWaWV3cyBwcm9wZXJ0eSB0aGF0IHdhcyBvYmxp
        dGVyYXRlZAogICAgRW1iZXIuZGVmaW5lUHJvcGVydHkodGhpcywgJ2NoaWxk
        Vmlld3MnLCBFbWJlci5WaWV3LmNoaWxkVmlld3NQcm9wZXJ0eSk7CgogICAg
        dmFyIF9jaGlsZFZpZXdzID0gdGhpcy5fY2hpbGRWaWV3czsKCiAgICBmb3JF
        YWNoKGNoaWxkVmlld3MsIGZ1bmN0aW9uKHZpZXdOYW1lLCBpZHgpIHsKICAg
        ICAgdmFyIHZpZXc7CgogICAgICBpZiAoJ3N0cmluZycgPT09IHR5cGVvZiB2
        aWV3TmFtZSkgewogICAgICAgIHZpZXcgPSBnZXQodGhpcywgdmlld05hbWUp
        OwogICAgICAgIHZpZXcgPSB0aGlzLmNyZWF0ZUNoaWxkVmlldyh2aWV3KTsK
        ICAgICAgICBzZXQodGhpcywgdmlld05hbWUsIHZpZXcpOwogICAgICB9IGVs
        c2UgewogICAgICAgIHZpZXcgPSB0aGlzLmNyZWF0ZUNoaWxkVmlldyh2aWV3
        TmFtZSk7CiAgICAgIH0KCiAgICAgIF9jaGlsZFZpZXdzW2lkeF0gPSB2aWV3
        OwogICAgfSwgdGhpcyk7CgogICAgdmFyIGN1cnJlbnRWaWV3ID0gZ2V0KHRo
        aXMsICdjdXJyZW50VmlldycpOwogICAgaWYgKGN1cnJlbnRWaWV3KSB7CiAg
        ICAgIGlmICghX2NoaWxkVmlld3MubGVuZ3RoKSB7IF9jaGlsZFZpZXdzID0g
        dGhpcy5fY2hpbGRWaWV3cyA9IHRoaXMuX2NoaWxkVmlld3Muc2xpY2UoKTsg
        fQogICAgICBfY2hpbGRWaWV3cy5wdXNoKHRoaXMuY3JlYXRlQ2hpbGRWaWV3
        KGN1cnJlbnRWaWV3KSk7CiAgICB9CiAgfSwKCiAgcmVwbGFjZTogZnVuY3Rp
        b24oaWR4LCByZW1vdmVkQ291bnQsIGFkZGVkVmlld3MpIHsKICAgIHZhciBh
        ZGRlZENvdW50ID0gYWRkZWRWaWV3cyA/IGdldChhZGRlZFZpZXdzLCAnbGVu
        Z3RoJykgOiAwOwogICAgdmFyIHNlbGYgPSB0aGlzOwogICAgRW1iZXIuYXNz
        ZXJ0KCJZb3UgY2FuJ3QgYWRkIGEgY2hpbGQgdG8gYSBjb250YWluZXIgdGhh
        dCBpcyBhbHJlYWR5IGEgY2hpbGQgb2YgYW5vdGhlciB2aWV3IiwgRW1iZXIu
        QShhZGRlZFZpZXdzKS5ldmVyeShmdW5jdGlvbihpdGVtKSB7IHJldHVybiAh
        Z2V0KGl0ZW0sICdfcGFyZW50VmlldycpIHx8IGdldChpdGVtLCAnX3BhcmVu
        dFZpZXcnKSA9PT0gc2VsZjsgfSkpOwoKICAgIHRoaXMuYXJyYXlDb250ZW50
        V2lsbENoYW5nZShpZHgsIHJlbW92ZWRDb3VudCwgYWRkZWRDb3VudCk7CiAg
        ICB0aGlzLmNoaWxkVmlld3NXaWxsQ2hhbmdlKHRoaXMuX2NoaWxkVmlld3Ms
        IGlkeCwgcmVtb3ZlZENvdW50KTsKCiAgICBpZiAoYWRkZWRDb3VudCA9PT0g
        MCkgewogICAgICB0aGlzLl9jaGlsZFZpZXdzLnNwbGljZShpZHgsIHJlbW92
        ZWRDb3VudCkgOwogICAgfSBlbHNlIHsKICAgICAgdmFyIGFyZ3MgPSBbaWR4
        LCByZW1vdmVkQ291bnRdLmNvbmNhdChhZGRlZFZpZXdzKTsKICAgICAgaWYg
        KGFkZGVkVmlld3MubGVuZ3RoICYmICF0aGlzLl9jaGlsZFZpZXdzLmxlbmd0
        aCkgeyB0aGlzLl9jaGlsZFZpZXdzID0gdGhpcy5fY2hpbGRWaWV3cy5zbGlj
        ZSgpOyB9CiAgICAgIHRoaXMuX2NoaWxkVmlld3Muc3BsaWNlLmFwcGx5KHRo
        aXMuX2NoaWxkVmlld3MsIGFyZ3MpOwogICAgfQoKICAgIHRoaXMuYXJyYXlD
        b250ZW50RGlkQ2hhbmdlKGlkeCwgcmVtb3ZlZENvdW50LCBhZGRlZENvdW50
        KTsKICAgIHRoaXMuY2hpbGRWaWV3c0RpZENoYW5nZSh0aGlzLl9jaGlsZFZp
        ZXdzLCBpZHgsIHJlbW92ZWRDb3VudCwgYWRkZWRDb3VudCk7CgogICAgcmV0
        dXJuIHRoaXM7CiAgfSwKCiAgb2JqZWN0QXQ6IGZ1bmN0aW9uKGlkeCkgewog
        ICAgcmV0dXJuIHRoaXMuX2NoaWxkVmlld3NbaWR4XTsKICB9LAoKICBsZW5n
        dGg6IEVtYmVyLmNvbXB1dGVkKGZ1bmN0aW9uICgpIHsKICAgIHJldHVybiB0
        aGlzLl9jaGlsZFZpZXdzLmxlbmd0aDsKICB9KS52b2xhdGlsZSgpLAoKICAv
        KioKICAgIEBwcml2YXRlCgogICAgSW5zdHJ1Y3RzIGVhY2ggY2hpbGQgdmll
        dyB0byByZW5kZXIgdG8gdGhlIHBhc3NlZCByZW5kZXIgYnVmZmVyLgoKICAg
        IEBtZXRob2QgcmVuZGVyCiAgICBAcGFyYW0ge0VtYmVyLlJlbmRlckJ1ZmZl
        cn0gYnVmZmVyIHRoZSBidWZmZXIgdG8gcmVuZGVyIHRvCiAgKi8KICByZW5k
        ZXI6IGZ1bmN0aW9uKGJ1ZmZlcikgewogICAgdGhpcy5mb3JFYWNoQ2hpbGRW
        aWV3KGZ1bmN0aW9uKHZpZXcpIHsKICAgICAgdmlldy5yZW5kZXJUb0J1ZmZl
        cihidWZmZXIpOwogICAgfSk7CiAgfSwKCiAgaW5zdHJ1bWVudE5hbWU6ICdj
        b250YWluZXInLAoKICAvKioKICAgIEBwcml2YXRlCgogICAgV2hlbiBhIGNo
        aWxkIHZpZXcgaXMgcmVtb3ZlZCwgZGVzdHJveSBpdHMgZWxlbWVudCBzbyB0
        aGF0CiAgICBpdCBpcyByZW1vdmVkIGZyb20gdGhlIERPTS4KCiAgICBUaGUg
        YXJyYXkgb2JzZXJ2ZXIgdGhhdCB0cmlnZ2VycyB0aGlzIGFjdGlvbiBpcyBz
        ZXQgdXAgaW4gdGhlCiAgICBgcmVuZGVyVG9CdWZmZXJgIG1ldGhvZC4KCiAg
        ICBAbWV0aG9kIGNoaWxkVmlld3NXaWxsQ2hhbmdlCiAgICBAcGFyYW0ge0Vt
        YmVyLkFycmF5fSB2aWV3cyB0aGUgY2hpbGQgdmlld3MgYXJyYXkgYmVmb3Jl
        IG11dGF0aW9uCiAgICBAcGFyYW0ge051bWJlcn0gc3RhcnQgdGhlIHN0YXJ0
        IHBvc2l0aW9uIG9mIHRoZSBtdXRhdGlvbgogICAgQHBhcmFtIHtOdW1iZXJ9
        IHJlbW92ZWQgdGhlIG51bWJlciBvZiBjaGlsZCB2aWV3cyByZW1vdmVkCiAg
        KiovCiAgY2hpbGRWaWV3c1dpbGxDaGFuZ2U6IGZ1bmN0aW9uKHZpZXdzLCBz
        dGFydCwgcmVtb3ZlZCkgewogICAgdGhpcy5wcm9wZXJ0eVdpbGxDaGFuZ2Uo
        J2NoaWxkVmlld3MnKTsKCiAgICBpZiAocmVtb3ZlZCA+IDApIHsKICAgICAg
        dmFyIGNoYW5nZWRWaWV3cyA9IHZpZXdzLnNsaWNlKHN0YXJ0LCBzdGFydCty
        ZW1vdmVkKTsKICAgICAgLy8gdHJhbnNpdGlvbiB0byBwcmVSZW5kZXIgYmVm
        b3JlIGNsZWFyaW5nIHBhcmVudFZpZXcKICAgICAgdGhpcy5jdXJyZW50U3Rh
        dGUuY2hpbGRWaWV3c1dpbGxDaGFuZ2UodGhpcywgdmlld3MsIHN0YXJ0LCBy
        ZW1vdmVkKTsKICAgICAgdGhpcy5pbml0aWFsaXplVmlld3MoY2hhbmdlZFZp
        ZXdzLCBudWxsLCBudWxsKTsKICAgIH0KICB9LAoKICByZW1vdmVDaGlsZDog
        ZnVuY3Rpb24oY2hpbGQpIHsKICAgIHRoaXMucmVtb3ZlT2JqZWN0KGNoaWxk
        KTsKICAgIHJldHVybiB0aGlzOwogIH0sCgogIC8qKgogICAgQHByaXZhdGUK
        CiAgICBXaGVuIGEgY2hpbGQgdmlldyBpcyBhZGRlZCwgbWFrZSBzdXJlIHRo
        ZSBET00gZ2V0cyB1cGRhdGVkIGFwcHJvcHJpYXRlbHkuCgogICAgSWYgdGhl
        IHZpZXcgaGFzIGFscmVhZHkgcmVuZGVyZWQgYW4gZWxlbWVudCwgd2UgdGVs
        bCB0aGUgY2hpbGQgdmlldyB0bwogICAgY3JlYXRlIGFuIGVsZW1lbnQgYW5k
        IGluc2VydCBpdCBpbnRvIHRoZSBET00uIElmIHRoZSBlbmNsb3NpbmcgY29u
        dGFpbmVyCiAgICB2aWV3IGhhcyBhbHJlYWR5IHdyaXR0ZW4gdG8gYSBidWZm
        ZXIsIGJ1dCBub3QgeWV0IGNvbnZlcnRlZCB0aGF0IGJ1ZmZlcgogICAgaW50
        byBhbiBlbGVtZW50LCB3ZSBpbnNlcnQgdGhlIHN0cmluZyByZXByZXNlbnRh
        dGlvbiBvZiB0aGUgY2hpbGQgaW50byB0aGUKICAgIGFwcHJvcHJpYXRlIHBs
        YWNlIGluIHRoZSBidWZmZXIuCgogICAgQG1ldGhvZCBjaGlsZFZpZXdzRGlk
        Q2hhbmdlCiAgICBAcGFyYW0ge0VtYmVyLkFycmF5fSB2aWV3cyB0aGUgYXJy
        YXkgb2YgY2hpbGQgdmlld3MgYWZ0ZSB0aGUgbXV0YXRpb24gaGFzIG9jY3Vy
        cmVkCiAgICBAcGFyYW0ge051bWJlcn0gc3RhcnQgdGhlIHN0YXJ0IHBvc2l0
        aW9uIG9mIHRoZSBtdXRhdGlvbgogICAgQHBhcmFtIHtOdW1iZXJ9IHJlbW92
        ZWQgdGhlIG51bWJlciBvZiBjaGlsZCB2aWV3cyByZW1vdmVkCiAgICBAcGFy
        YW0ge051bWJlcn0gdGhlIG51bWJlciBvZiBjaGlsZCB2aWV3cyBhZGRlZAog
        ICovCiAgY2hpbGRWaWV3c0RpZENoYW5nZTogZnVuY3Rpb24odmlld3MsIHN0
        YXJ0LCByZW1vdmVkLCBhZGRlZCkgewogICAgaWYgKGFkZGVkID4gMCkgewog
        ICAgICB2YXIgY2hhbmdlZFZpZXdzID0gdmlld3Muc2xpY2Uoc3RhcnQsIHN0
        YXJ0K2FkZGVkKTsKICAgICAgdGhpcy5pbml0aWFsaXplVmlld3MoY2hhbmdl
        ZFZpZXdzLCB0aGlzLCBnZXQodGhpcywgJ3RlbXBsYXRlRGF0YScpKTsKICAg
        ICAgdGhpcy5jdXJyZW50U3RhdGUuY2hpbGRWaWV3c0RpZENoYW5nZSh0aGlz
        LCB2aWV3cywgc3RhcnQsIGFkZGVkKTsKICAgIH0KICAgIHRoaXMucHJvcGVy
        dHlEaWRDaGFuZ2UoJ2NoaWxkVmlld3MnKTsKICB9LAoKICBpbml0aWFsaXpl
        Vmlld3M6IGZ1bmN0aW9uKHZpZXdzLCBwYXJlbnRWaWV3LCB0ZW1wbGF0ZURh
        dGEpIHsKICAgIGZvckVhY2godmlld3MsIGZ1bmN0aW9uKHZpZXcpIHsKICAg
        ICAgc2V0KHZpZXcsICdfcGFyZW50VmlldycsIHBhcmVudFZpZXcpOwoKICAg
        ICAgaWYgKCF2aWV3LmNvbnRhaW5lciAmJiBwYXJlbnRWaWV3KSB7CiAgICAg
        ICAgc2V0KHZpZXcsICdjb250YWluZXInLCBwYXJlbnRWaWV3LmNvbnRhaW5l
        cik7CiAgICAgIH0KCiAgICAgIGlmICghZ2V0KHZpZXcsICd0ZW1wbGF0ZURh
        dGEnKSkgewogICAgICAgIHNldCh2aWV3LCAndGVtcGxhdGVEYXRhJywgdGVt
        cGxhdGVEYXRhKTsKICAgICAgfQogICAgfSk7CiAgfSwKCiAgY3VycmVudFZp
        ZXc6IG51bGwsCgogIF9jdXJyZW50Vmlld1dpbGxDaGFuZ2U6IEVtYmVyLmJl
        Zm9yZU9ic2VydmVyKGZ1bmN0aW9uKCkgewogICAgdmFyIGN1cnJlbnRWaWV3
        ID0gZ2V0KHRoaXMsICdjdXJyZW50VmlldycpOwogICAgaWYgKGN1cnJlbnRW
        aWV3KSB7CiAgICAgIGN1cnJlbnRWaWV3LmRlc3Ryb3koKTsKICAgIH0KICB9
        LCAnY3VycmVudFZpZXcnKSwKCiAgX2N1cnJlbnRWaWV3RGlkQ2hhbmdlOiBF
        bWJlci5vYnNlcnZlcihmdW5jdGlvbigpIHsKICAgIHZhciBjdXJyZW50Vmll
        dyA9IGdldCh0aGlzLCAnY3VycmVudFZpZXcnKTsKICAgIGlmIChjdXJyZW50
        VmlldykgewogICAgICBFbWJlci5hc3NlcnQoIllvdSB0cmllZCB0byBzZXQg
        YSBjdXJyZW50IHZpZXcgdGhhdCBhbHJlYWR5IGhhcyBhIHBhcmVudC4gTWFr
        ZSBzdXJlIHlvdSBkb24ndCBoYXZlIG11bHRpcGxlIG91dGxldHMgaW4gdGhl
        IHNhbWUgdmlldy4iLCAhZ2V0KGN1cnJlbnRWaWV3LCAnX3BhcmVudFZpZXcn
        KSk7CiAgICAgIHRoaXMucHVzaE9iamVjdChjdXJyZW50Vmlldyk7CiAgICB9
        CiAgfSwgJ2N1cnJlbnRWaWV3JyksCgogIF9lbnN1cmVDaGlsZHJlbkFyZUlu
        RE9NOiBmdW5jdGlvbiAoKSB7CiAgICB0aGlzLmN1cnJlbnRTdGF0ZS5lbnN1
        cmVDaGlsZHJlbkFyZUluRE9NKHRoaXMpOwogIH0KfSk7CgpFbWJlci5tZXJn
        ZShzdGF0ZXMuX2RlZmF1bHQsIHsKICBjaGlsZFZpZXdzV2lsbENoYW5nZTog
        RW1iZXIuSywKICBjaGlsZFZpZXdzRGlkQ2hhbmdlOiBFbWJlci5LLAogIGVu
        c3VyZUNoaWxkcmVuQXJlSW5ET006IEVtYmVyLksKfSk7CgpFbWJlci5tZXJn
        ZShzdGF0ZXMuaW5CdWZmZXIsIHsKICBjaGlsZFZpZXdzRGlkQ2hhbmdlOiBm
        dW5jdGlvbihwYXJlbnRWaWV3LCB2aWV3cywgc3RhcnQsIGFkZGVkKSB7CiAg
        ICB0aHJvdyBuZXcgRW1iZXIuRXJyb3IoJ1lvdSBjYW5ub3QgbW9kaWZ5IGNo
        aWxkIHZpZXdzIHdoaWxlIGluIHRoZSBpbkJ1ZmZlciBzdGF0ZScpOwogIH0K
        fSk7CgpFbWJlci5tZXJnZShzdGF0ZXMuaGFzRWxlbWVudCwgewogIGNoaWxk
        Vmlld3NXaWxsQ2hhbmdlOiBmdW5jdGlvbih2aWV3LCB2aWV3cywgc3RhcnQs
        IHJlbW92ZWQpIHsKICAgIGZvciAodmFyIGk9c3RhcnQ7IGk8c3RhcnQrcmVt
        b3ZlZDsgaSsrKSB7CiAgICAgIHZpZXdzW2ldLnJlbW92ZSgpOwogICAgfQog
        IH0sCgogIGNoaWxkVmlld3NEaWRDaGFuZ2U6IGZ1bmN0aW9uKHZpZXcsIHZp
        ZXdzLCBzdGFydCwgYWRkZWQpIHsKICAgIEVtYmVyLnJ1bi5zY2hlZHVsZU9u
        Y2UoJ3JlbmRlcicsIHZpZXcsICdfZW5zdXJlQ2hpbGRyZW5BcmVJbkRPTScp
        OwogIH0sCgogIGVuc3VyZUNoaWxkcmVuQXJlSW5ET006IGZ1bmN0aW9uKHZp
        ZXcpIHsKICAgIHZhciBjaGlsZFZpZXdzID0gdmlldy5fY2hpbGRWaWV3cywg
        aSwgbGVuLCBjaGlsZFZpZXcsIHByZXZpb3VzLCBidWZmZXIsIHZpZXdDb2xs
        ZWN0aW9uID0gbmV3IFZpZXdDb2xsZWN0aW9uKCk7CgogICAgZm9yIChpID0g
        MCwgbGVuID0gY2hpbGRWaWV3cy5sZW5ndGg7IGkgPCBsZW47IGkrKykgewog
        ICAgICBjaGlsZFZpZXcgPSBjaGlsZFZpZXdzW2ldOwoKICAgICAgaWYgKCFi
        dWZmZXIpIHsgYnVmZmVyID0gRW1iZXIuUmVuZGVyQnVmZmVyKCk7IGJ1ZmZl
        ci5faGFzRWxlbWVudCA9IGZhbHNlOyB9CgogICAgICBpZiAoY2hpbGRWaWV3
        LnJlbmRlclRvQnVmZmVySWZOZWVkZWQoYnVmZmVyKSkgewogICAgICAgIHZp
        ZXdDb2xsZWN0aW9uLnB1c2goY2hpbGRWaWV3KTsKICAgICAgfSBlbHNlIGlm
        ICh2aWV3Q29sbGVjdGlvbi5sZW5ndGgpIHsKICAgICAgICBpbnNlcnRWaWV3
        Q29sbGVjdGlvbih2aWV3LCB2aWV3Q29sbGVjdGlvbiwgcHJldmlvdXMsIGJ1
        ZmZlcik7CiAgICAgICAgYnVmZmVyID0gbnVsbDsKICAgICAgICBwcmV2aW91
        cyA9IGNoaWxkVmlldzsKICAgICAgICB2aWV3Q29sbGVjdGlvbi5jbGVhcigp
        OwogICAgICB9IGVsc2UgewogICAgICAgIHByZXZpb3VzID0gY2hpbGRWaWV3
        OwogICAgICB9CiAgICB9CgogICAgaWYgKHZpZXdDb2xsZWN0aW9uLmxlbmd0
        aCkgewogICAgICBpbnNlcnRWaWV3Q29sbGVjdGlvbih2aWV3LCB2aWV3Q29s
        bGVjdGlvbiwgcHJldmlvdXMsIGJ1ZmZlcik7CiAgICB9CiAgfQp9KTsKCmZ1
        bmN0aW9uIGluc2VydFZpZXdDb2xsZWN0aW9uKHZpZXcsIHZpZXdDb2xsZWN0
        aW9uLCBwcmV2aW91cywgYnVmZmVyKSB7CiAgdmlld0NvbGxlY3Rpb24udHJp
        Z2dlclJlY3Vyc2l2ZWx5KCd3aWxsSW5zZXJ0RWxlbWVudCcpOwoKICBpZiAo
        cHJldmlvdXMpIHsKICAgIHByZXZpb3VzLmRvbU1hbmFnZXIuYWZ0ZXIocHJl
        dmlvdXMsIGJ1ZmZlci5zdHJpbmcoKSk7CiAgfSBlbHNlIHsKICAgIHZpZXcu
        ZG9tTWFuYWdlci5wcmVwZW5kKHZpZXcsIGJ1ZmZlci5zdHJpbmcoKSk7CiAg
        fQoKICB2aWV3Q29sbGVjdGlvbi5mb3JFYWNoKGZ1bmN0aW9uKHYpIHsKICAg
        IHYudHJhbnNpdGlvblRvKCdpbkRPTScpOwogICAgdi5wcm9wZXJ0eURpZENo
        YW5nZSgnZWxlbWVudCcpOwogICAgdi50cmlnZ2VyUmVjdXJzaXZlbHkoJ2Rp
        ZEluc2VydEVsZW1lbnQnKTsKICB9KTsKfQoKCn0pKCk7CgoKCihmdW5jdGlv
        bigpIHsKLyoqCkBtb2R1bGUgZW1iZXIKQHN1Ym1vZHVsZSBlbWJlci12aWV3
        cwoqLwoKdmFyIGdldCA9IEVtYmVyLmdldCwgc2V0ID0gRW1iZXIuc2V0LCBm
        bXQgPSBFbWJlci5TdHJpbmcuZm10OwoKLyoqCiAgYEVtYmVyLkNvbGxlY3Rp
        b25WaWV3YCBpcyBhbiBgRW1iZXIuVmlld2AgZGVzY2VuZGVudCByZXNwb25z
        aWJsZSBmb3IgbWFuYWdpbmcKICBhIGNvbGxlY3Rpb24gKGFuIGFycmF5IG9y
        IGFycmF5LWxpa2Ugb2JqZWN0KSBieSBtYWludGFpbmluZyBhIGNoaWxkIHZp
        ZXcgb2JqZWN0CiAgYW5kIGFzc29jaWF0ZWQgRE9NIHJlcHJlc2VudGF0aW9u
        IGZvciBlYWNoIGl0ZW0gaW4gdGhlIGFycmF5IGFuZCBlbnN1cmluZwogIHRo
        YXQgY2hpbGQgdmlld3MgYW5kIHRoZWlyIGFzc29jaWF0ZWQgcmVuZGVyZWQg
        SFRNTCBhcmUgdXBkYXRlZCB3aGVuIGl0ZW1zIGluCiAgdGhlIGFycmF5IGFy
        ZSBhZGRlZCwgcmVtb3ZlZCwgb3IgcmVwbGFjZWQuCgogICMjIFNldHRpbmcg
        Y29udGVudAoKICBUaGUgbWFuYWdlZCBjb2xsZWN0aW9uIG9mIG9iamVjdHMg
        aXMgcmVmZXJlbmNlZCBhcyB0aGUgYEVtYmVyLkNvbGxlY3Rpb25WaWV3YAog
        IGluc3RhbmNlJ3MgYGNvbnRlbnRgIHByb3BlcnR5LgoKICBgYGBqYXZhc2Ny
        aXB0CiAgc29tZUl0ZW1zVmlldyA9IEVtYmVyLkNvbGxlY3Rpb25WaWV3LmNy
        ZWF0ZSh7CiAgICBjb250ZW50OiBbJ0EnLCAnQicsJ0MnXQogIH0pCiAgYGBg
        CgogIFRoZSB2aWV3IGZvciBlYWNoIGl0ZW0gaW4gdGhlIGNvbGxlY3Rpb24g
        d2lsbCBoYXZlIGl0cyBgY29udGVudGAgcHJvcGVydHkgc2V0CiAgdG8gdGhl
        IGl0ZW0uCgogICMjIFNwZWNpZnlpbmcgaXRlbVZpZXdDbGFzcwoKICBCeSBk
        ZWZhdWx0IHRoZSB2aWV3IGNsYXNzIGZvciBlYWNoIGl0ZW0gaW4gdGhlIG1h
        bmFnZWQgY29sbGVjdGlvbiB3aWxsIGJlIGFuCiAgaW5zdGFuY2Ugb2YgYEVt
        YmVyLlZpZXdgLiBZb3UgY2FuIHN1cHBseSBhIGRpZmZlcmVudCBjbGFzcyBi
        eSBzZXR0aW5nIHRoZQogIGBDb2xsZWN0aW9uVmlld2AncyBgaXRlbVZpZXdD
        bGFzc2AgcHJvcGVydHkuCgogIEdpdmVuIGFuIGVtcHR5IGA8Ym9keT5gIGFu
        ZCB0aGUgZm9sbG93aW5nIGNvZGU6CgogIGBgYGphdmFzY3JpcHQKICBzb21l
        SXRlbXNWaWV3ID0gRW1iZXIuQ29sbGVjdGlvblZpZXcuY3JlYXRlKHsKICAg
        IGNsYXNzTmFtZXM6IFsnYS1jb2xsZWN0aW9uJ10sCiAgICBjb250ZW50OiBb
        J0EnLCdCJywnQyddLAogICAgaXRlbVZpZXdDbGFzczogRW1iZXIuVmlldy5l
        eHRlbmQoewogICAgICB0ZW1wbGF0ZTogRW1iZXIuSGFuZGxlYmFycy5jb21w
        aWxlKCJ0aGUgbGV0dGVyOiB7e3ZpZXcuY29udGVudH19IikKICAgIH0pCiAg
        fSk7CgogIHNvbWVJdGVtc1ZpZXcuYXBwZW5kVG8oJ2JvZHknKTsKICBgYGAK
        CiAgV2lsbCByZXN1bHQgaW4gdGhlIGZvbGxvd2luZyBIVE1MIHN0cnVjdHVy
        ZQoKICBgYGBodG1sCiAgPGRpdiBjbGFzcz0iZW1iZXItdmlldyBhLWNvbGxl
        Y3Rpb24iPgogICAgPGRpdiBjbGFzcz0iZW1iZXItdmlldyI+dGhlIGxldHRl
        cjogQTwvZGl2PgogICAgPGRpdiBjbGFzcz0iZW1iZXItdmlldyI+dGhlIGxl
        dHRlcjogQjwvZGl2PgogICAgPGRpdiBjbGFzcz0iZW1iZXItdmlldyI+dGhl
        IGxldHRlcjogQzwvZGl2PgogIDwvZGl2PgogIGBgYAoKICAjIyBBdXRvbWF0
        aWMgbWF0Y2hpbmcgb2YgcGFyZW50L2NoaWxkIHRhZ05hbWVzCgogIFNldHRp
        bmcgdGhlIGB0YWdOYW1lYCBwcm9wZXJ0eSBvZiBhIGBDb2xsZWN0aW9uVmll
        d2AgdG8gYW55IG9mCiAgInVsIiwgIm9sIiwgInRhYmxlIiwgInRoZWFkIiwg
        InRib2R5IiwgInRmb290IiwgInRyIiwgb3IgInNlbGVjdCIgd2lsbCByZXN1
        bHQKICBpbiB0aGUgaXRlbSB2aWV3cyByZWNlaXZpbmcgYW4gYXBwcm9wcmlh
        dGVseSBtYXRjaGVkIGB0YWdOYW1lYCBwcm9wZXJ0eS4KCiAgR2l2ZW4gYW4g
        ZW1wdHkgYDxib2R5PmAgYW5kIHRoZSBmb2xsb3dpbmcgY29kZToKCiAgYGBg
        amF2YXNjcmlwdAogIGFuVW5kb3JkZXJlZExpc3RWaWV3ID0gRW1iZXIuQ29s
        bGVjdGlvblZpZXcuY3JlYXRlKHsKICAgIHRhZ05hbWU6ICd1bCcsCiAgICBj
        b250ZW50OiBbJ0EnLCdCJywnQyddLAogICAgaXRlbVZpZXdDbGFzczogRW1i
        ZXIuVmlldy5leHRlbmQoewogICAgICB0ZW1wbGF0ZTogRW1iZXIuSGFuZGxl
        YmFycy5jb21waWxlKCJ0aGUgbGV0dGVyOiB7e3ZpZXcuY29udGVudH19IikK
        ICAgIH0pCiAgfSk7CgogIGFuVW5kb3JkZXJlZExpc3RWaWV3LmFwcGVuZFRv
        KCdib2R5Jyk7CiAgYGBgCgogIFdpbGwgcmVzdWx0IGluIHRoZSBmb2xsb3dp
        bmcgSFRNTCBzdHJ1Y3R1cmUKCiAgYGBgaHRtbAogIDx1bCBjbGFzcz0iZW1i
        ZXItdmlldyBhLWNvbGxlY3Rpb24iPgogICAgPGxpIGNsYXNzPSJlbWJlci12
        aWV3Ij50aGUgbGV0dGVyOiBBPC9saT4KICAgIDxsaSBjbGFzcz0iZW1iZXIt
        dmlldyI+dGhlIGxldHRlcjogQjwvbGk+CiAgICA8bGkgY2xhc3M9ImVtYmVy
        LXZpZXciPnRoZSBsZXR0ZXI6IEM8L2xpPgogIDwvdWw+CiAgYGBgCgogIEFk
        ZGl0aW9uYWwgYHRhZ05hbWVgIHBhaXJzIGNhbiBiZSBwcm92aWRlZCBieSBh
        ZGRpbmcgdG8KICBgRW1iZXIuQ29sbGVjdGlvblZpZXcuQ09OVEFJTkVSX01B
        UCBgCgogIGBgYGphdmFzY3JpcHQKICBFbWJlci5Db2xsZWN0aW9uVmlldy5D
        T05UQUlORVJfTUFQWydhcnRpY2xlJ10gPSAnc2VjdGlvbicKICBgYGAKCiAg
        IyMgUHJvZ3JhbWF0aWMgY3JlYXRpb24gb2YgY2hpbGQgdmlld3MKCiAgRm9y
        IGNhc2VzIHdoZXJlIGFkZGl0aW9uYWwgY3VzdG9taXphdGlvbiBiZXlvbmQg
        dGhlIHVzZSBvZiBhIHNpbmdsZQogIGBpdGVtVmlld0NsYXNzYCBvciBgdGFn
        TmFtZWAgbWF0Y2hpbmcgaXMgcmVxdWlyZWQgQ29sbGVjdGlvblZpZXcncwog
        IGBjcmVhdGVDaGlsZFZpZXdgIG1ldGhvZCBjYW4gYmUgb3ZlcmlkZGVuOgoK
        ICBgYGBqYXZhc2NyaXB0CiAgQ3VzdG9tQ29sbGVjdGlvblZpZXcgPSBFbWJl
        ci5Db2xsZWN0aW9uVmlldy5leHRlbmQoewogICAgY3JlYXRlQ2hpbGRWaWV3
        OiBmdW5jdGlvbih2aWV3Q2xhc3MsIGF0dHJzKSB7CiAgICAgIGlmIChhdHRy
        cy5jb250ZW50LmtpbmQgPT0gJ2FsYnVtJykgewogICAgICAgIHZpZXdDbGFz
        cyA9IEFwcC5BbGJ1bVZpZXc7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdmll
        d0NsYXNzID0gQXBwLlNvbmdWaWV3OwogICAgICB9CiAgICAgIHJldHVybiB0
        aGlzLl9zdXBlcih2aWV3Q2xhc3MsIGF0dHJzKTsKICAgIH0KICB9KTsKICBg
        YGAKCiAgIyMgRW1wdHkgVmlldwoKICBZb3UgY2FuIHByb3ZpZGUgYW4gYEVt
        YmVyLlZpZXdgIHN1YmNsYXNzIHRvIHRoZSBgRW1iZXIuQ29sbGVjdGlvblZp
        ZXdgCiAgaW5zdGFuY2UgYXMgaXRzIGBlbXB0eVZpZXdgIHByb3BlcnR5LiBJ
        ZiB0aGUgYGNvbnRlbnRgIHByb3BlcnR5IG9mIGEKICBgQ29sbGVjdGlvblZp
        ZXdgIGlzIHNldCB0byBgbnVsbGAgb3IgYW4gZW1wdHkgYXJyYXksIGFuIGlu
        c3RhbmNlIG9mIHRoaXMgdmlldwogIHdpbGwgYmUgdGhlIGBDb2xsZWN0aW9u
        Vmlld2BzIG9ubHkgY2hpbGQuCgogIGBgYGphdmFzY3JpcHQKICBhTGlzdFdp
        dGhOb3RoaW5nID0gRW1iZXIuQ29sbGVjdGlvblZpZXcuY3JlYXRlKHsKICAg
        IGNsYXNzTmFtZXM6IFsnbm90aGluZyddCiAgICBjb250ZW50OiBudWxsLAog
        ICAgZW1wdHlWaWV3OiBFbWJlci5WaWV3LmV4dGVuZCh7CiAgICAgIHRlbXBs
        YXRlOiBFbWJlci5IYW5kbGViYXJzLmNvbXBpbGUoIlRoZSBjb2xsZWN0aW9u
        IGlzIGVtcHR5IikKICAgIH0pCiAgfSk7CgogIGFMaXN0V2l0aE5vdGhpbmcu
        YXBwZW5kVG8oJ2JvZHknKTsKICBgYGAKCiAgV2lsbCByZXN1bHQgaW4gdGhl
        IGZvbGxvd2luZyBIVE1MIHN0cnVjdHVyZQoKICBgYGBodG1sCiAgPGRpdiBj
        bGFzcz0iZW1iZXItdmlldyBub3RoaW5nIj4KICAgIDxkaXYgY2xhc3M9ImVt
        YmVyLXZpZXciPgogICAgICBUaGUgY29sbGVjdGlvbiBpcyBlbXB0eQogICAg
        PC9kaXY+CiAgPC9kaXY+CiAgYGBgCgogICMjIEFkZGluZyBhbmQgUmVtb3Zp
        bmcgaXRlbXMKCiAgVGhlIGBjaGlsZFZpZXdzYCBwcm9wZXJ0eSBvZiBhIGBD
        b2xsZWN0aW9uVmlld2Agc2hvdWxkIG5vdCBiZSBkaXJlY3RseQogIG1hbmlw
        dWxhdGVkLiBJbnN0ZWFkLCBhZGQsIHJlbW92ZSwgcmVwbGFjZSBpdGVtcyBm
        cm9tIGl0cyBgY29udGVudGAgcHJvcGVydHkuCiAgVGhpcyB3aWxsIHRyaWdn
        ZXIgYXBwcm9wcmlhdGUgY2hhbmdlcyB0byBpdHMgcmVuZGVyZWQgSFRNTC4K
        CgogIEBjbGFzcyBDb2xsZWN0aW9uVmlldwogIEBuYW1lc3BhY2UgRW1iZXIK
        ICBAZXh0ZW5kcyBFbWJlci5Db250YWluZXJWaWV3CiAgQHNpbmNlIEVtYmVy
        IDAuOQoqLwpFbWJlci5Db2xsZWN0aW9uVmlldyA9IEVtYmVyLkNvbnRhaW5l
        clZpZXcuZXh0ZW5kKC8qKiBAc2NvcGUgRW1iZXIuQ29sbGVjdGlvblZpZXcu
        cHJvdG90eXBlICovIHsKCiAgLyoqCiAgICBBIGxpc3Qgb2YgaXRlbXMgdG8g
        YmUgZGlzcGxheWVkIGJ5IHRoZSBgRW1iZXIuQ29sbGVjdGlvblZpZXdgLgoK
        ICAgIEBwcm9wZXJ0eSBjb250ZW50CiAgICBAdHlwZSBFbWJlci5BcnJheQog
        ICAgQGRlZmF1bHQgbnVsbAogICovCiAgY29udGVudDogbnVsbCwKCiAgLyoq
        CiAgICBAcHJpdmF0ZQoKICAgIFRoaXMgcHJvdmlkZXMgbWV0YWRhdGEgYWJv
        dXQgd2hhdCBraW5kIG9mIGVtcHR5IHZpZXcgY2xhc3MgdGhpcwogICAgY29s
        bGVjdGlvbiB3b3VsZCBsaWtlIGlmIGl0IGlzIGJlaW5nIGluc3RhbnRpYXRl
        ZCBmcm9tIGFub3RoZXIKICAgIHN5c3RlbSAobGlrZSBIYW5kbGViYXJzKQoK
        ICAgIEBwcm9wZXJ0eSBlbXB0eVZpZXdDbGFzcwogICovCiAgZW1wdHlWaWV3
        Q2xhc3M6IEVtYmVyLlZpZXcsCgogIC8qKgogICAgQW4gb3B0aW9uYWwgdmll
        dyB0byBkaXNwbGF5IGlmIGNvbnRlbnQgaXMgc2V0IHRvIGFuIGVtcHR5IGFy
        cmF5LgoKICAgIEBwcm9wZXJ0eSBlbXB0eVZpZXcKICAgIEB0eXBlIEVtYmVy
        LlZpZXcKICAgIEBkZWZhdWx0IG51bGwKICAqLwogIGVtcHR5VmlldzogbnVs
        bCwKCiAgLyoqCiAgICBAcHJvcGVydHkgaXRlbVZpZXdDbGFzcwogICAgQHR5
        cGUgRW1iZXIuVmlldwogICAgQGRlZmF1bHQgRW1iZXIuVmlldwogICovCiAg
        aXRlbVZpZXdDbGFzczogRW1iZXIuVmlldywKCiAgLyoqCiAgICBTZXR1cCBh
        IENvbGxlY3Rpb25WaWV3CgogICAgQG1ldGhvZCBpbml0CiAgKi8KICBpbml0
        OiBmdW5jdGlvbigpIHsKICAgIHZhciByZXQgPSB0aGlzLl9zdXBlcigpOwog
        ICAgdGhpcy5fY29udGVudERpZENoYW5nZSgpOwogICAgcmV0dXJuIHJldDsK
        ICB9LAoKICAvKioKICAgIEBwcml2YXRlCgogICAgSW52b2tlZCB3aGVuIHRo
        ZSBjb250ZW50IHByb3BlcnR5IGlzIGFib3V0IHRvIGNoYW5nZS4gTm90aWZp
        ZXMgb2JzZXJ2ZXJzIHRoYXQgdGhlCiAgICBlbnRpcmUgYXJyYXkgY29udGVu
        dCB3aWxsIGNoYW5nZS4KCiAgICBAbWV0aG9kIF9jb250ZW50V2lsbENoYW5n
        ZQogICovCiAgX2NvbnRlbnRXaWxsQ2hhbmdlOiBFbWJlci5iZWZvcmVPYnNl
        cnZlcihmdW5jdGlvbigpIHsKICAgIHZhciBjb250ZW50ID0gdGhpcy5nZXQo
        J2NvbnRlbnQnKTsKCiAgICBpZiAoY29udGVudCkgeyBjb250ZW50LnJlbW92
        ZUFycmF5T2JzZXJ2ZXIodGhpcyk7IH0KICAgIHZhciBsZW4gPSBjb250ZW50
        ID8gZ2V0KGNvbnRlbnQsICdsZW5ndGgnKSA6IDA7CiAgICB0aGlzLmFycmF5
        V2lsbENoYW5nZShjb250ZW50LCAwLCBsZW4pOwogIH0sICdjb250ZW50Jyks
        CgogIC8qKgogICAgQHByaXZhdGUKCiAgICBDaGVjayB0byBtYWtlIHN1cmUg
        dGhhdCB0aGUgY29udGVudCBoYXMgY2hhbmdlZCwgYW5kIGlmIHNvLAogICAg
        dXBkYXRlIHRoZSBjaGlsZHJlbiBkaXJlY3RseS4gVGhpcyBpcyBhbHdheXMg
        c2NoZWR1bGVkCiAgICBhc3luY2hyb25vdXNseSwgdG8gYWxsb3cgdGhlIGVs
        ZW1lbnQgdG8gYmUgY3JlYXRlZCBiZWZvcmUKICAgIGJpbmRpbmdzIGhhdmUg
        c3luY2hyb25pemVkIGFuZCB2aWNlIHZlcnNhLgoKICAgIEBtZXRob2QgX2Nv
        bnRlbnREaWRDaGFuZ2UKICAqLwogIF9jb250ZW50RGlkQ2hhbmdlOiBFbWJl
        ci5vYnNlcnZlcihmdW5jdGlvbigpIHsKICAgIHZhciBjb250ZW50ID0gZ2V0
        KHRoaXMsICdjb250ZW50Jyk7CgogICAgaWYgKGNvbnRlbnQpIHsKICAgICAg
        dGhpcy5fYXNzZXJ0QXJyYXlMaWtlKGNvbnRlbnQpOwogICAgICBjb250ZW50
        LmFkZEFycmF5T2JzZXJ2ZXIodGhpcyk7CiAgICB9CgogICAgdmFyIGxlbiA9
        IGNvbnRlbnQgPyBnZXQoY29udGVudCwgJ2xlbmd0aCcpIDogMDsKICAgIHRo
        aXMuYXJyYXlEaWRDaGFuZ2UoY29udGVudCwgMCwgbnVsbCwgbGVuKTsKICB9
        LCAnY29udGVudCcpLAoKICAvKioKICAgIEBwcml2YXRlCgogICAgRW5zdXJl
        IHRoYXQgdGhlIGNvbnRlbnQgaW1wbGVtZW50cyBFbWJlci5BcnJheQoKICAg
        IEBtZXRob2QgX2Fzc2VydEFycmF5TGlrZQogICovCiAgX2Fzc2VydEFycmF5
        TGlrZTogZnVuY3Rpb24oY29udGVudCkgewogICAgRW1iZXIuYXNzZXJ0KGZt
        dCgiYW4gRW1iZXIuQ29sbGVjdGlvblZpZXcncyBjb250ZW50IG11c3QgaW1w
        bGVtZW50IEVtYmVyLkFycmF5LiBZb3UgcGFzc2VkICVAIiwgW2NvbnRlbnRd
        KSwgRW1iZXIuQXJyYXkuZGV0ZWN0KGNvbnRlbnQpKTsKICB9LAoKICAvKioK
        ICAgIFJlbW92ZXMgdGhlIGNvbnRlbnQgYW5kIGNvbnRlbnQgb2JzZXJ2ZXJz
        LgoKICAgIEBtZXRob2QgZGVzdHJveQogICovCiAgZGVzdHJveTogZnVuY3Rp
        b24oKSB7CiAgICBpZiAoIXRoaXMuX3N1cGVyKCkpIHsgcmV0dXJuOyB9Cgog
        ICAgdmFyIGNvbnRlbnQgPSBnZXQodGhpcywgJ2NvbnRlbnQnKTsKICAgIGlm
        IChjb250ZW50KSB7IGNvbnRlbnQucmVtb3ZlQXJyYXlPYnNlcnZlcih0aGlz
        KTsgfQoKICAgIGlmICh0aGlzLl9jcmVhdGVkRW1wdHlWaWV3KSB7CiAgICAg
        IHRoaXMuX2NyZWF0ZWRFbXB0eVZpZXcuZGVzdHJveSgpOwogICAgfQoKICAg
        IHJldHVybiB0aGlzOwogIH0sCgogIC8qKgogICAgQ2FsbGVkIHdoZW4gYSBt
        dXRhdGlvbiB0byB0aGUgdW5kZXJseWluZyBjb250ZW50IGFycmF5IHdpbGwg
        b2NjdXIuCgogICAgVGhpcyBtZXRob2Qgd2lsbCByZW1vdmUgYW55IHZpZXdz
        IHRoYXQgYXJlIG5vIGxvbmdlciBpbiB0aGUgdW5kZXJseWluZwogICAgY29u
        dGVudCBhcnJheS4KCiAgICBJbnZva2VzIHdoZW5ldmVyIHRoZSBjb250ZW50
        IGFycmF5IGl0c2VsZiB3aWxsIGNoYW5nZS4KCiAgICBAbWV0aG9kIGFycmF5
        V2lsbENoYW5nZQogICAgQHBhcmFtIHtBcnJheX0gY29udGVudCB0aGUgbWFu
        YWdlZCBjb2xsZWN0aW9uIG9mIG9iamVjdHMKICAgIEBwYXJhbSB7TnVtYmVy
        fSBzdGFydCB0aGUgaW5kZXggYXQgd2hpY2ggdGhlIGNoYW5nZXMgd2lsbCBv
        Y2N1cnIKICAgIEBwYXJhbSB7TnVtYmVyfSByZW1vdmVkIG51bWJlciBvZiBv
        YmplY3QgdG8gYmUgcmVtb3ZlZCBmcm9tIGNvbnRlbnQKICAqLwogIGFycmF5
        V2lsbENoYW5nZTogZnVuY3Rpb24oY29udGVudCwgc3RhcnQsIHJlbW92ZWRD
        b3VudCkgewogICAgLy8gSWYgdGhlIGNvbnRlbnRzIHdlcmUgZW1wdHkgYmVm
        b3JlIGFuZCB0aGlzIHRlbXBsYXRlIGNvbGxlY3Rpb24gaGFzIGFuCiAgICAv
        LyBlbXB0eSB2aWV3IHJlbW92ZSBpdCBub3cuCiAgICB2YXIgZW1wdHlWaWV3
        ID0gZ2V0KHRoaXMsICdlbXB0eVZpZXcnKTsKICAgIGlmIChlbXB0eVZpZXcg
        JiYgZW1wdHlWaWV3IGluc3RhbmNlb2YgRW1iZXIuVmlldykgewogICAgICBl
        bXB0eVZpZXcucmVtb3ZlRnJvbVBhcmVudCgpOwogICAgfQoKICAgIC8vIExv
        b3AgdGhyb3VnaCBjaGlsZCB2aWV3cyB0aGF0IGNvcnJlc3BvbmQgd2l0aCB0
        aGUgcmVtb3ZlZCBpdGVtcy4KICAgIC8vIE5vdGUgdGhhdCB3ZSBsb29wIGZy
        b20gdGhlIGVuZCBvZiB0aGUgYXJyYXkgdG8gdGhlIGJlZ2lubmluZyBiZWNh
        dXNlCiAgICAvLyB3ZSBhcmUgbXV0YXRpbmcgaXQgYXMgd2UgZ28uCiAgICB2
        YXIgY2hpbGRWaWV3cyA9IHRoaXMuX2NoaWxkVmlld3MsIGNoaWxkVmlldywg
        aWR4LCBsZW47CgogICAgbGVuID0gdGhpcy5fY2hpbGRWaWV3cy5sZW5ndGg7
        CgogICAgdmFyIHJlbW92aW5nQWxsID0gcmVtb3ZlZENvdW50ID09PSBsZW47
        CgogICAgaWYgKHJlbW92aW5nQWxsKSB7CiAgICAgIHRoaXMuY3VycmVudFN0
        YXRlLmVtcHR5KHRoaXMpOwogICAgICB0aGlzLmludm9rZVJlY3Vyc2l2ZWx5
        KGZ1bmN0aW9uKHZpZXcpIHsKICAgICAgICB2aWV3LnJlbW92ZWRGcm9tRE9N
        ID0gdHJ1ZTsKICAgICAgfSwgZmFsc2UpOwogICAgfQoKICAgIGZvciAoaWR4
        ID0gc3RhcnQgKyByZW1vdmVkQ291bnQgLSAxOyBpZHggPj0gc3RhcnQ7IGlk
        eC0tKSB7CiAgICAgIGNoaWxkVmlldyA9IGNoaWxkVmlld3NbaWR4XTsKICAg
        ICAgY2hpbGRWaWV3LmRlc3Ryb3koKTsKICAgIH0KICB9LAoKICAvKioKICAg
        IENhbGxlZCB3aGVuIGEgbXV0YXRpb24gdG8gdGhlIHVuZGVybHlpbmcgY29u
        dGVudCBhcnJheSBvY2N1cnMuCgogICAgVGhpcyBtZXRob2Qgd2lsbCByZXBs
        YXkgdGhhdCBtdXRhdGlvbiBhZ2FpbnN0IHRoZSB2aWV3cyB0aGF0IGNvbXBv
        c2UgdGhlCiAgICBgRW1iZXIuQ29sbGVjdGlvblZpZXdgLCBlbnN1cmluZyB0
        aGF0IHRoZSB2aWV3IHJlZmxlY3RzIHRoZSBtb2RlbC4KCiAgICBUaGlzIGFy
        cmF5IG9ic2VydmVyIGlzIGFkZGVkIGluIGBjb250ZW50RGlkQ2hhbmdlYC4K
        CiAgICBAbWV0aG9kIGFycmF5RGlkQ2hhbmdlCiAgICBAcGFyYW0ge0FycmF5
        fSBjb250ZW50IHRoZSBtYW5hZ2VkIGNvbGxlY3Rpb24gb2Ygb2JqZWN0cwog
        ICAgQHBhcmFtIHtOdW1iZXJ9IHN0YXJ0IHRoZSBpbmRleCBhdCB3aGljaCB0
        aGUgY2hhbmdlcyBvY2N1cnJlZAogICAgQHBhcmFtIHtOdW1iZXJ9IHJlbW92
        ZWQgbnVtYmVyIG9mIG9iamVjdCByZW1vdmVkIGZyb20gY29udGVudAogICAg
        QHBhcmFtIHtOdW1iZXJ9IGFkZGVkIG51bWJlciBvZiBvYmplY3QgYWRkZWQg
        dG8gY29udGVudAogICovCiAgYXJyYXlEaWRDaGFuZ2U6IGZ1bmN0aW9uKGNv
        bnRlbnQsIHN0YXJ0LCByZW1vdmVkLCBhZGRlZCkgewogICAgdmFyIGFkZGVk
        Vmlld3MgPSBbXSwgdmlldywgaXRlbSwgaWR4LCBsZW4sIGl0ZW1WaWV3Q2xh
        c3MsCiAgICAgIGVtcHR5VmlldzsKCiAgICBsZW4gPSBjb250ZW50ID8gZ2V0
        KGNvbnRlbnQsICdsZW5ndGgnKSA6IDA7CgogICAgaWYgKGxlbikgewogICAg
        ICBpdGVtVmlld0NsYXNzID0gZ2V0KHRoaXMsICdpdGVtVmlld0NsYXNzJyk7
        CgogICAgICBpZiAoJ3N0cmluZycgPT09IHR5cGVvZiBpdGVtVmlld0NsYXNz
        KSB7CiAgICAgICAgaXRlbVZpZXdDbGFzcyA9IGdldChpdGVtVmlld0NsYXNz
        KSB8fCBpdGVtVmlld0NsYXNzOwogICAgICB9CgogICAgICBFbWJlci5hc3Nl
        cnQoZm10KCJpdGVtVmlld0NsYXNzIG11c3QgYmUgYSBzdWJjbGFzcyBvZiBF
        bWJlci5WaWV3LCBub3QgJUAiLCBbaXRlbVZpZXdDbGFzc10pLCAnc3RyaW5n
        JyA9PT0gdHlwZW9mIGl0ZW1WaWV3Q2xhc3MgfHwgRW1iZXIuVmlldy5kZXRl
        Y3QoaXRlbVZpZXdDbGFzcykpOwoKICAgICAgZm9yIChpZHggPSBzdGFydDsg
        aWR4IDwgc3RhcnQrYWRkZWQ7IGlkeCsrKSB7CiAgICAgICAgaXRlbSA9IGNv
        bnRlbnQub2JqZWN0QXQoaWR4KTsKCiAgICAgICAgdmlldyA9IHRoaXMuY3Jl
        YXRlQ2hpbGRWaWV3KGl0ZW1WaWV3Q2xhc3MsIHsKICAgICAgICAgIGNvbnRl
        bnQ6IGl0ZW0sCiAgICAgICAgICBjb250ZW50SW5kZXg6IGlkeAogICAgICAg
        IH0pOwoKICAgICAgICBhZGRlZFZpZXdzLnB1c2godmlldyk7CiAgICAgIH0K
        ICAgIH0gZWxzZSB7CiAgICAgIGVtcHR5VmlldyA9IGdldCh0aGlzLCAnZW1w
        dHlWaWV3Jyk7CgogICAgICBpZiAoIWVtcHR5VmlldykgeyByZXR1cm47IH0K
        CiAgICAgIGlmICgnc3RyaW5nJyA9PT0gdHlwZW9mIGVtcHR5Vmlldykgewog
        ICAgICAgIGVtcHR5VmlldyA9IGdldChlbXB0eVZpZXcpIHx8IGVtcHR5Vmll
        dzsKICAgICAgfQoKICAgICAgZW1wdHlWaWV3ID0gdGhpcy5jcmVhdGVDaGls
        ZFZpZXcoZW1wdHlWaWV3KTsKICAgICAgYWRkZWRWaWV3cy5wdXNoKGVtcHR5
        Vmlldyk7CiAgICAgIHNldCh0aGlzLCAnZW1wdHlWaWV3JywgZW1wdHlWaWV3
        KTsKCiAgICAgIGlmIChFbWJlci5Db3JlVmlldy5kZXRlY3QoZW1wdHlWaWV3
        KSkgewogICAgICAgIHRoaXMuX2NyZWF0ZWRFbXB0eVZpZXcgPSBlbXB0eVZp
        ZXc7CiAgICAgIH0KICAgIH0KCiAgICB0aGlzLnJlcGxhY2Uoc3RhcnQsIDAs
        IGFkZGVkVmlld3MpOwogIH0sCgogIC8qKgogICAgSW5zdGFudGlhdGVzIGEg
        dmlldyB0byBiZSBhZGRlZCB0byB0aGUgY2hpbGRWaWV3cyBhcnJheSBkdXJp
        bmcgdmlldwogICAgaW5pdGlhbGl6YXRpb24uIFlvdSBnZW5lcmFsbHkgd2ls
        bCBub3QgY2FsbCB0aGlzIG1ldGhvZCBkaXJlY3RseSB1bmxlc3MKICAgIHlv
        dSBhcmUgb3ZlcnJpZGluZyBgY3JlYXRlQ2hpbGRWaWV3cygpYC4gTm90ZSB0
        aGF0IHRoaXMgbWV0aG9kIHdpbGwKICAgIGF1dG9tYXRpY2FsbHkgY29uZmln
        dXJlIHRoZSBjb3JyZWN0IHNldHRpbmdzIG9uIHRoZSBuZXcgdmlldyBpbnN0
        YW5jZSB0bwogICAgYWN0IGFzIGEgY2hpbGQgb2YgdGhlIHBhcmVudC4KCiAg
        ICBUaGUgdGFnIG5hbWUgZm9yIHRoZSB2aWV3IHdpbGwgYmUgc2V0IHRvIHRo
        ZSB0YWdOYW1lIG9mIHRoZSB2aWV3Q2xhc3MKICAgIHBhc3NlZCBpbi4KCiAg
        ICBAbWV0aG9kIGNyZWF0ZUNoaWxkVmlldwogICAgQHBhcmFtIHtDbGFzc30g
        dmlld0NsYXNzCiAgICBAcGFyYW0ge0hhc2h9IFthdHRyc10gQXR0cmlidXRl
        cyB0byBhZGQKICAgIEByZXR1cm4ge0VtYmVyLlZpZXd9IG5ldyBpbnN0YW5j
        ZQogICovCiAgY3JlYXRlQ2hpbGRWaWV3OiBmdW5jdGlvbih2aWV3LCBhdHRy
        cykgewogICAgdmlldyA9IHRoaXMuX3N1cGVyKHZpZXcsIGF0dHJzKTsKCiAg
        ICB2YXIgaXRlbVRhZ05hbWUgPSBnZXQodmlldywgJ3RhZ05hbWUnKTsKCiAg
        ICBpZiAoaXRlbVRhZ05hbWUgPT09IG51bGwgfHwgaXRlbVRhZ05hbWUgPT09
        IHVuZGVmaW5lZCkgewogICAgICBpdGVtVGFnTmFtZSA9IEVtYmVyLkNvbGxl
        Y3Rpb25WaWV3LkNPTlRBSU5FUl9NQVBbZ2V0KHRoaXMsICd0YWdOYW1lJyld
        OwogICAgICBzZXQodmlldywgJ3RhZ05hbWUnLCBpdGVtVGFnTmFtZSk7CiAg
        ICB9CgogICAgcmV0dXJuIHZpZXc7CiAgfQp9KTsKCi8qKgogIEEgbWFwIG9m
        IHBhcmVudCB0YWdzIHRvIHRoZWlyIGRlZmF1bHQgY2hpbGQgdGFncy4gWW91
        IGNhbiBhZGQKICBhZGRpdGlvbmFsIHBhcmVudCB0YWdzIGlmIHlvdSB3YW50
        IGNvbGxlY3Rpb24gdmlld3MgdGhhdCB1c2UKICBhIHBhcnRpY3VsYXIgcGFy
        ZW50IHRhZyB0byBkZWZhdWx0IHRvIGEgY2hpbGQgdGFnLgoKICBAcHJvcGVy
        dHkgQ09OVEFJTkVSX01BUAogIEB0eXBlIEhhc2gKICBAc3RhdGljCiAgQGZp
        bmFsCiovCkVtYmVyLkNvbGxlY3Rpb25WaWV3LkNPTlRBSU5FUl9NQVAgPSB7
        CiAgdWw6ICdsaScsCiAgb2w6ICdsaScsCiAgdGFibGU6ICd0cicsCiAgdGhl
        YWQ6ICd0cicsCiAgdGJvZHk6ICd0cicsCiAgdGZvb3Q6ICd0cicsCiAgdHI6
        ICd0ZCcsCiAgc2VsZWN0OiAnb3B0aW9uJwp9OwoKfSkoKTsKCgoKKGZ1bmN0
        aW9uKCkgewp2YXIgZ2V0ID0gRW1iZXIuZ2V0LCBzZXQgPSBFbWJlci5zZXQs
        IGlzTm9uZSA9IEVtYmVyLmlzTm9uZSwKICAgIGFfc2xpY2UgPSBBcnJheS5w
        cm90b3R5cGUuc2xpY2U7CgoKLyoqCkBtb2R1bGUgZW1iZXIKQHN1Ym1vZHVs
        ZSBlbWJlci12aWV3cwoqLwoKLyoqCiAgQW4gYEVtYmVyLkNvbXBvbmVudGAg
        aXMgYSB2aWV3IHRoYXQgaXMgY29tcGxldGVseQogIGlzb2xhdGVkLiBQcm9w
        ZXJ0eSBhY2Nlc3MgaW4gaXRzIHRlbXBsYXRlcyBnbwogIHRvIHRoZSB2aWV3
        IG9iamVjdCBhbmQgYWN0aW9ucyBhcmUgdGFyZ2V0ZWQgYXQKICB0aGUgdmll
        dyBvYmplY3QuIFRoZXJlIGlzIG5vIGFjY2VzcyB0byB0aGUKICBzdXJyb3Vu
        ZGluZyBjb250ZXh0IG9yIG91dGVyIGNvbnRyb2xsZXI7IGFsbAogIGNvbnRl
        eHR1YWwgaW5mb3JtYXRpb24gaXMgcGFzc2VkIGluLgoKICBUaGUgZWFzaWVz
        dCB3YXkgdG8gY3JlYXRlIGFuIGBFbWJlci5Db21wb25lbnRgIGlzIHZpYQog
        IGEgdGVtcGxhdGUuIElmIHlvdSBuYW1lIGEgdGVtcGxhdGUKICBgY29tcG9u
        ZW50cy9teS1mb29gLCB5b3Ugd2lsbCBiZSBhYmxlIHRvIHVzZQogIGB7e215
        LWZvb319YCBpbiBvdGhlciB0ZW1wbGF0ZXMsIHdoaWNoIHdpbGwgbWFrZQog
        IGFuIGluc3RhbmNlIG9mIHRoZSBpc29sYXRlZCBjb21wb25lbnQuCgogIGBg
        YGh0bWwKICB7e2FwcC1wcm9maWxlIHBlcnNvbj1jdXJyZW50VXNlcn19CiAg
        YGBgCgogIGBgYGh0bWwKICA8IS0tIGFwcC1wcm9maWxlIHRlbXBsYXRlIC0t
        PgogIDxoMT57e3BlcnNvbi50aXRsZX19PC9oMT4KICA8aW1nIHt7YmluZC1h
        dHRyIHNyYz1wZXJzb24uYXZhdGFyfX0+CiAgPHAgY2xhc3M9J3NpZ25hdHVy
        ZSc+e3twZXJzb24uc2lnbmF0dXJlfX08L3A+CiAgYGBgCgogIFlvdSBjYW4g
        YWxzbyB1c2UgYHlpZWxkYCBpbnNpZGUgYSB0ZW1wbGF0ZSB0bwogIGluY2x1
        ZGUgdGhlICoqY29udGVudHMqKiBvZiB0aGUgY3VzdG9tIHRhZzoKCiAgYGBg
        aHRtbAogIHt7I2FwcC1wcm9maWxlIHBlcnNvbj1jdXJyZW50VXNlcn19CiAg
        ICA8cD5BZG1pbiBtb2RlPC9wPgogIHt7L2FwcC1wcm9maWxlfX0KICBgYGAK
        CiAgYGBgaHRtbAogIDwhLS0gYXBwLXByb2ZpbGUgdGVtcGxhdGUgLS0+CiAg
        PGgxPnt7cGVyc29uLnRpdGxlfX08L2gxPgogIHt7eWllbGR9fSA8IS0tIGJs
        b2NrIGNvbnRlbnRzIC0tPgogIGBgYAoKICBJZiB5b3Ugd2FudCB0byBjdXN0
        b21pemUgdGhlIGNvbXBvbmVudCwgaW4gb3JkZXIgdG8KICBoYW5kbGUgZXZl
        bnRzIG9yIGFjdGlvbnMsIHlvdSBpbXBsZW1lbnQgYSBzdWJjbGFzcwogIG9m
        IGBFbWJlci5Db21wb25lbnRgIG5hbWVkIGFmdGVyIHRoZSBuYW1lIG9mIHRo
        ZQogIGNvbXBvbmVudC4gTm90ZSB0aGF0IGBDb21wb25lbnRgIG5lZWRzIHRv
        IGJlIGFwcGVuZGVkIHRvIHRoZSBuYW1lIG9mCiAgeW91ciBzdWJjbGFzcyBs
        aWtlIGBBcHBQcm9maWxlQ29tcG9uZW50YC4KCiAgRm9yIGV4YW1wbGUsIHlv
        dSBjb3VsZCBpbXBsZW1lbnQgdGhlIGFjdGlvbgogIGBoZWxsb2AgZm9yIHRo
        ZSBgYXBwLXByb2ZpbGVgIGNvbXBvbmVudDoKCiAgYGBgamF2YXNjcmlwdAog
        IEFwcC5BcHBQcm9maWxlQ29tcG9uZW50ID0gRW1iZXIuQ29tcG9uZW50LmV4
        dGVuZCh7CiAgICBhY3Rpb25zOiB7CiAgICAgIGhlbGxvOiBmdW5jdGlvbihu
        YW1lKSB7CiAgICAgICAgY29uc29sZS5sb2coIkhlbGxvIiwgbmFtZSk7CiAg
        ICAgIH0KICAgIH0KICB9KTsKICBgYGAKCiAgQW5kIHRoZW4gdXNlIGl0IGlu
        IHRoZSBjb21wb25lbnQncyB0ZW1wbGF0ZToKCiAgYGBgaHRtbAogIDwhLS0g
        YXBwLXByb2ZpbGUgdGVtcGxhdGUgLS0+CgogIDxoMT57e3BlcnNvbi50aXRs
        ZX19PC9oMT4KICB7e3lpZWxkfX0gPCEtLSBibG9jayBjb250ZW50cyAtLT4K
        CiAgPGJ1dHRvbiB7e2FjdGlvbiAnaGVsbG8nIHBlcnNvbi5uYW1lfX0+CiAg
        ICBTYXkgSGVsbG8gdG8ge3twZXJzb24ubmFtZX19CiAgPC9idXR0b24+CiAg
        YGBgCgogIENvbXBvbmVudHMgbXVzdCBoYXZlIGEgYC1gIGluIHRoZWlyIG5h
        bWUgdG8gYXZvaWQKICBjb25mbGljdHMgd2l0aCBidWlsdC1pbiBjb250cm9s
        cyB0aGF0IHdyYXAgSFRNTAogIGVsZW1lbnRzLiBUaGlzIGlzIGNvbnNpc3Rl
        bnQgd2l0aCB0aGUgc2FtZQogIHJlcXVpcmVtZW50IGluIHdlYiBjb21wb25l
        bnRzLgoKICBAY2xhc3MgQ29tcG9uZW50CiAgQG5hbWVzcGFjZSBFbWJlcgog
        IEBleHRlbmRzIEVtYmVyLlZpZXcKKi8KRW1iZXIuQ29tcG9uZW50ID0gRW1i
        ZXIuVmlldy5leHRlbmQoRW1iZXIuVGFyZ2V0QWN0aW9uU3VwcG9ydCwgewog
        IGluaXQ6IGZ1bmN0aW9uKCkgewogICAgdGhpcy5fc3VwZXIoKTsKICAgIHNl
        dCh0aGlzLCAnY29udGV4dCcsIHRoaXMpOwogICAgc2V0KHRoaXMsICdjb250
        cm9sbGVyJywgdGhpcyk7CiAgfSwKCiAgLy8gZHVyaW5nIHJlbmRlciwgaXNv
        bGF0ZSBrZXl3b3JkcwogIGNsb25lS2V5d29yZHM6IGZ1bmN0aW9uKCkgewog
        ICAgcmV0dXJuIHsKICAgICAgdmlldzogdGhpcywKICAgICAgY29udHJvbGxl
        cjogdGhpcwogICAgfTsKICB9LAoKICBfeWllbGQ6IGZ1bmN0aW9uKGNvbnRl
        eHQsIG9wdGlvbnMpIHsKICAgIHZhciB2aWV3ID0gb3B0aW9ucy5kYXRhLnZp
        ZXcsCiAgICAgICAgcGFyZW50VmlldyA9IHRoaXMuX3BhcmVudFZpZXcsCiAg
        ICAgICAgdGVtcGxhdGUgPSBnZXQodGhpcywgJ3RlbXBsYXRlJyk7CgogICAg
        aWYgKHRlbXBsYXRlKSB7CiAgICAgIEVtYmVyLmFzc2VydCgiQSBDb21wb25l
        bnQgbXVzdCBoYXZlIGEgcGFyZW50IHZpZXcgaW4gb3JkZXIgdG8geWllbGQu
        IiwgcGFyZW50Vmlldyk7CgogICAgICB2aWV3LmFwcGVuZENoaWxkKEVtYmVy
        LlZpZXcsIHsKICAgICAgICBpc1ZpcnR1YWw6IHRydWUsCiAgICAgICAgdGFn
        TmFtZTogJycsCiAgICAgICAgX2NvbnRleHRWaWV3OiBwYXJlbnRWaWV3LAog
        ICAgICAgIHRlbXBsYXRlOiB0ZW1wbGF0ZSwKICAgICAgICBjb250ZXh0OiBn
        ZXQocGFyZW50VmlldywgJ2NvbnRleHQnKSwKICAgICAgICBjb250cm9sbGVy
        OiBnZXQocGFyZW50VmlldywgJ2NvbnRyb2xsZXInKSwKICAgICAgICB0ZW1w
        bGF0ZURhdGE6IHsga2V5d29yZHM6IHBhcmVudFZpZXcuY2xvbmVLZXl3b3Jk
        cygpIH0KICAgICAgfSk7CiAgICB9CiAgfSwKCiAgLyoqCiAgICBJZiB0aGUg
        Y29tcG9uZW50IGlzIGN1cnJlbnRseSBpbnNlcnRlZCBpbnRvIHRoZSBET00g
        b2YgYSBwYXJlbnQgdmlldywgdGhpcwogICAgcHJvcGVydHkgd2lsbCBwb2lu
        dCB0byB0aGUgY29udHJvbGxlciBvZiB0aGUgcGFyZW50IHZpZXcuCgogICAg
        QHByb3BlcnR5IHRhcmdldE9iamVjdAogICAgQHR5cGUgRW1iZXIuQ29udHJv
        bGxlcgogICAgQGRlZmF1bHQgbnVsbAogICovCiAgdGFyZ2V0T2JqZWN0OiBF
        bWJlci5jb21wdXRlZChmdW5jdGlvbihrZXkpIHsKICAgIHZhciBwYXJlbnRW
        aWV3ID0gZ2V0KHRoaXMsICdfcGFyZW50VmlldycpOwogICAgcmV0dXJuIHBh
        cmVudFZpZXcgPyBnZXQocGFyZW50VmlldywgJ2NvbnRyb2xsZXInKSA6IG51
        bGw7CiAgfSkucHJvcGVydHkoJ19wYXJlbnRWaWV3JyksCgogIC8qKgogICAg
        U2VuZHMgYW4gYWN0aW9uIHRvIGNvbXBvbmVudCdzIGNvbnRyb2xsZXIuIEEg
        Y29tcG9uZW50IGluaGVyaXRzIGl0cwogICAgY29udHJvbGxlciBmcm9tIHRo
        ZSBjb250ZXh0IGluIHdoaWNoIGl0IGlzIHVzZWQuCgogICAgQnkgZGVmYXVs
        dCwgY2FsbGluZyBgc2VuZEFjdGlvbigpYCB3aWxsIHNlbmQgYW4gYWN0aW9u
        IHdpdGggdGhlIG5hbWUKICAgIG9mIHRoZSBjb21wb25lbnQncyBgYWN0aW9u
        YCBwcm9wZXJ0eS4KCiAgICBGb3IgZXhhbXBsZSwgaWYgdGhlIGNvbXBvbmVu
        dCBoYWQgYSBwcm9wZXJ0eSBgYWN0aW9uYCB3aXRoIHRoZSB2YWx1ZQogICAg
        YCJhZGRJdGVtImAsIGNhbGxpbmcgYHNlbmRBY3Rpb24oKWAgd291bGQgc2Vu
        ZCB0aGUgYGFkZEl0ZW1gIGFjdGlvbgogICAgdG8gdGhlIGNvbXBvbmVudCdz
        IGNvbnRyb2xsZXIuCgogICAgSWYgeW91IHByb3ZpZGUgdGhlIGBhY3Rpb25g
        IGFyZ3VtZW50IHRvIGBzZW5kQWN0aW9uKClgLCB0aGF0IGtleSB3aWxsCiAg
        ICBiZSB1c2VkIHRvIGxvb2sgdXAgdGhlIGFjdGlvbiBuYW1lLgoKICAgIEZv
        ciBleGFtcGxlLCBpZiB0aGUgY29tcG9uZW50IGhhZCBhIHByb3BlcnR5IGBw
        bGF5aW5nYCB3aXRoIHRoZSB2YWx1ZQogICAgYGRpZFN0YXJ0UGxheWluZ2As
        IGNhbGxpbmcgYHNlbmRBY3Rpb24oJ3BsYXlpbmcnKWAgd291bGQgc2VuZCB0
        aGUKICAgIGBkaWRTdGFydFBsYXlpbmdgIGFjdGlvbiB0byB0aGUgY29tcG9u
        ZW50J3MgY29udHJvbGxlci4KCiAgICBXaGV0aGVyIG9yIG5vdCB5b3UgYXJl
        IHVzaW5nIHRoZSBkZWZhdWx0IGFjdGlvbiBvciBhIG5hbWVkIGFjdGlvbiwg
        aWYKICAgIHRoZSBhY3Rpb24gbmFtZSBpcyBub3QgZGVmaW5lZCBvbiB0aGUg
        Y29tcG9uZW50LCBjYWxsaW5nIGBzZW5kQWN0aW9uKClgCiAgICBkb2VzIG5v
        dCBoYXZlIGFueSBlZmZlY3QuCgogICAgRm9yIGV4YW1wbGUsIGlmIHlvdSBj
        YWxsIGBzZW5kQWN0aW9uKClgIG9uIGEgY29tcG9uZW50IHRoYXQgZG9lcyBu
        b3QgaGF2ZQogICAgYW4gYGFjdGlvbmAgcHJvcGVydHkgZGVmaW5lZCwgbm8g
        YWN0aW9uIHdpbGwgYmUgc2VudCB0byB0aGUgY29udHJvbGxlciwKICAgIG5v
        ciB3aWxsIGFuIGV4Y2VwdGlvbiBiZSByYWlzZWQuCgogICAgWW91IGNhbiBz
        ZW5kIGEgY29udGV4dCBvYmplY3Qgd2l0aCB0aGUgYWN0aW9uIGJ5IHN1cHBs
        eWluZyB0aGUgYGNvbnRleHRgCiAgICBhcmd1bWVudC4gVGhlIGNvbnRleHQg
        d2lsbCBiZSBzdXBwbGllZCBhcyB0aGUgZmlyc3QgYXJndW1lbnQgaW4gdGhl
        CiAgICB0YXJnZXQncyBhY3Rpb24gbWV0aG9kLiBFeGFtcGxlOgoKICAgIGBg
        YGphdmFzY3JpcHQKICAgIEFwcC5NeVRyZWVDb21wb25lbnQgPSBFbWJlci5D
        b21wb25lbnQuZXh0ZW5kKHsKICAgICAgY2xpY2s6IGZ1bmN0aW9uKCkgewog
        ICAgICAgIHRoaXMuc2VuZEFjdGlvbignZGlkQ2xpY2tUcmVlTm9kZScsIHRo
        aXMuZ2V0KCdub2RlJykpOwogICAgICB9CiAgICB9KTsKCiAgICBBcHAuQ2F0
        ZWdvcmllc0NvbnRyb2xsZXIgPSBFbWJlci5Db250cm9sbGVyLmV4dGVuZCh7
        CiAgICAgIGFjdGlvbnM6IHsKICAgICAgICBkaWRDbGlja0NhdGVnb3J5OiBm
        dW5jdGlvbihjYXRlZ29yeSkgewogICAgICAgICAgLy9EbyBzb21ldGhpbmcg
        d2l0aCB0aGUgbm9kZS9jYXRlZ29yeSB0aGF0IHdhcyBjbGlja2VkCiAgICAg
        ICAgfQogICAgICB9CiAgICB9KTsKICAgIGBgYAoKICAgIGBgYGhhbmRsZWJh
        cnMKICAgIHt7ISBjYXRlZ29yaWVzLmhic319CiAgICB7e215LXRyZWUgZGlk
        Q2xpY2tUcmVlTm9kZT0nZGlkQ2xpY2tDYXRlZ29yeSd9fQogICAgYGBgCgog
        ICAgQG1ldGhvZCBzZW5kQWN0aW9uCiAgICBAcGFyYW0gW2FjdGlvbl0ge1N0
        cmluZ30gdGhlIGFjdGlvbiB0byB0cmlnZ2VyCiAgICBAcGFyYW0gW2NvbnRl
        eHRdIHsqfSBhIGNvbnRleHQgdG8gc2VuZCB3aXRoIHRoZSBhY3Rpb24KICAq
        LwogIHNlbmRBY3Rpb246IGZ1bmN0aW9uKGFjdGlvbikgewogICAgdmFyIGFj
        dGlvbk5hbWUsCiAgICAgICAgY29udGV4dHMgPSBhX3NsaWNlLmNhbGwoYXJn
        dW1lbnRzLCAxKTsKCiAgICAvLyBTZW5kIHRoZSBkZWZhdWx0IGFjdGlvbgog
        ICAgaWYgKGFjdGlvbiA9PT0gdW5kZWZpbmVkKSB7CiAgICAgIGFjdGlvbk5h
        bWUgPSBnZXQodGhpcywgJ2FjdGlvbicpOwogICAgICBFbWJlci5hc3NlcnQo
        IlRoZSBkZWZhdWx0IGFjdGlvbiB3YXMgdHJpZ2dlcmVkIG9uIHRoZSBjb21w
        b25lbnQgIiArIHRoaXMudG9TdHJpbmcoKSArICIsIGJ1dCB0aGUgYWN0aW9u
        IG5hbWUgKCIgKyBhY3Rpb25OYW1lICsgIikgd2FzIG5vdCBhIHN0cmluZy4i
        LCBpc05vbmUoYWN0aW9uTmFtZSkgfHwgdHlwZW9mIGFjdGlvbk5hbWUgPT09
        ICdzdHJpbmcnKTsKICAgIH0gZWxzZSB7CiAgICAgIGFjdGlvbk5hbWUgPSBn
        ZXQodGhpcywgYWN0aW9uKTsKICAgICAgRW1iZXIuYXNzZXJ0KCJUaGUgIiAr
        IGFjdGlvbiArICIgYWN0aW9uIHdhcyB0cmlnZ2VyZWQgb24gdGhlIGNvbXBv
        bmVudCAiICsgdGhpcy50b1N0cmluZygpICsgIiwgYnV0IHRoZSBhY3Rpb24g
        bmFtZSAoIiArIGFjdGlvbk5hbWUgKyAiKSB3YXMgbm90IGEgc3RyaW5nLiIs
        IGlzTm9uZShhY3Rpb25OYW1lKSB8fCB0eXBlb2YgYWN0aW9uTmFtZSA9PT0g
        J3N0cmluZycpOwogICAgfQoKICAgIC8vIElmIG5vIGFjdGlvbiBuYW1lIGZv
        ciB0aGF0IGFjdGlvbiBjb3VsZCBiZSBmb3VuZCwganVzdCBhYm9ydC4KICAg
        IGlmIChhY3Rpb25OYW1lID09PSB1bmRlZmluZWQpIHsgcmV0dXJuOyB9Cgog
        ICAgdGhpcy50cmlnZ2VyQWN0aW9uKHsKICAgICAgYWN0aW9uOiBhY3Rpb25O
        YW1lLAogICAgICBhY3Rpb25Db250ZXh0OiBjb250ZXh0cwogICAgfSk7CiAg
        fQp9KTsKCn0pKCk7CgoKCihmdW5jdGlvbigpIHsKCn0pKCk7CgoKCihmdW5j
        dGlvbigpIHsKLyoqCmBFbWJlci5WaWV3VGFyZ2V0QWN0aW9uU3VwcG9ydGAg
        aXMgYSBtaXhpbiB0aGF0IGNhbiBiZSBpbmNsdWRlZCBpbiBhCnZpZXcgY2xh
        c3MgdG8gYWRkIGEgYHRyaWdnZXJBY3Rpb25gIG1ldGhvZCB3aXRoIHNlbWFu
        dGljcyBzaW1pbGFyIHRvCnRoZSBIYW5kbGViYXJzIGB7e2FjdGlvbn19YCBo
        ZWxwZXIuIEl0IHByb3ZpZGVzIGludGVsbGlnZW50IGRlZmF1bHRzCmZvciB0
        aGUgYWN0aW9uJ3MgdGFyZ2V0OiB0aGUgdmlldydzIGNvbnRyb2xsZXI7IGFu
        ZCB0aGUgY29udGV4dCB0aGF0IGlzCnNlbnQgd2l0aCB0aGUgYWN0aW9uOiB0
        aGUgdmlldydzIGNvbnRleHQuCgpOb3RlOiBJbiBub3JtYWwgRW1iZXIgdXNh
        Z2UsIHRoZSBge3thY3Rpb259fWAgaGVscGVyIGlzIHVzdWFsbHkgdGhlIGJl
        c3QKY2hvaWNlLiBUaGlzIG1peGluIGlzIG1vc3Qgb2Z0ZW4gdXNlZnVsIHdo
        ZW4geW91IGFyZSBkb2luZyBtb3JlIGNvbXBsZXgKZXZlbnQgaGFuZGxpbmcg
        aW4gY3VzdG9tIFZpZXcgc3ViY2xhc3Nlcy4KCkZvciBleGFtcGxlOgoKYGBg
        amF2YXNjcmlwdApBcHAuU2F2ZUJ1dHRvblZpZXcgPSBFbWJlci5WaWV3LmV4
        dGVuZChFbWJlci5WaWV3VGFyZ2V0QWN0aW9uU3VwcG9ydCwgewogIGFjdGlv
        bjogJ3NhdmUnLAogIGNsaWNrOiBmdW5jdGlvbigpIHsKICAgIHRoaXMudHJp
        Z2dlckFjdGlvbigpOyAvLyBTZW5kcyB0aGUgYHNhdmVgIGFjdGlvbiwgYWxv
        bmcgd2l0aCB0aGUgY3VycmVudCBjb250ZXh0CiAgICAgICAgICAgICAgICAg
        ICAgICAgICAgLy8gdG8gdGhlIGN1cnJlbnQgY29udHJvbGxlcgogIH0KfSk7
        CmBgYAoKVGhlIGBhY3Rpb25gIGNhbiBiZSBwcm92aWRlZCBhcyBwcm9wZXJ0
        aWVzIG9mIGFuIG9wdGlvbmFsIG9iamVjdCBhcmd1bWVudAp0byBgdHJpZ2dl
        ckFjdGlvbmAgYXMgd2VsbC4KCmBgYGphdmFzY3JpcHQKQXBwLlNhdmVCdXR0
        b25WaWV3ID0gRW1iZXIuVmlldy5leHRlbmQoRW1iZXIuVmlld1RhcmdldEFj
        dGlvblN1cHBvcnQsIHsKICBjbGljazogZnVuY3Rpb24oKSB7CiAgICB0aGlz
        LnRyaWdnZXJBY3Rpb24oewogICAgICBhY3Rpb246ICdzYXZlJwogICAgfSk7
        IC8vIFNlbmRzIHRoZSBgc2F2ZWAgYWN0aW9uLCBhbG9uZyB3aXRoIHRoZSBj
        dXJyZW50IGNvbnRleHQKICAgICAgICAvLyB0byB0aGUgY3VycmVudCBjb250
        cm9sbGVyCiAgfQp9KTsKYGBgCgpAY2xhc3MgVmlld1RhcmdldEFjdGlvblN1
        cHBvcnQKQG5hbWVzcGFjZSBFbWJlcgpAZXh0ZW5kcyBFbWJlci5UYXJnZXRB
        Y3Rpb25TdXBwb3J0CiovCkVtYmVyLlZpZXdUYXJnZXRBY3Rpb25TdXBwb3J0
        ID0gRW1iZXIuTWl4aW4uY3JlYXRlKEVtYmVyLlRhcmdldEFjdGlvblN1cHBv
        cnQsIHsKICAvKioKICBAcHJvcGVydHkgdGFyZ2V0CiAgKi8KICB0YXJnZXQ6
        IEVtYmVyLmNvbXB1dGVkLmFsaWFzKCdjb250cm9sbGVyJyksCiAgLyoqCiAg
        QHByb3BlcnR5IGFjdGlvbkNvbnRleHQKICAqLwogIGFjdGlvbkNvbnRleHQ6
        IEVtYmVyLmNvbXB1dGVkLmFsaWFzKCdjb250ZXh0JykKfSk7Cgp9KSgpOwoK
        CgooZnVuY3Rpb24oKSB7Cgp9KSgpOwoKCgooZnVuY3Rpb24oKSB7Ci8qKgpF
        bWJlciBWaWV3cwoKQG1vZHVsZSBlbWJlcgpAc3VibW9kdWxlIGVtYmVyLXZp
        ZXdzCkByZXF1aXJlcyBlbWJlci1ydW50aW1lCkBtYWluIGVtYmVyLXZpZXdz
        CiovCgp9KSgpOwoKKGZ1bmN0aW9uKCkgewpkZWZpbmUoIm1ldGFtb3JwaCIs
        CiAgW10sCiAgZnVuY3Rpb24oKSB7CiAgICAidXNlIHN0cmljdCI7CiAgICAv
        LyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
        PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQogICAgLy8gUHJvamVj
        dDogICBtZXRhbW9ycGgKICAgIC8vIENvcHlyaWdodDogwqkyMDExIE15IENv
        bXBhbnkgSW5jLiBBbGwgcmlnaHRzIHJlc2VydmVkLgogICAgLy8gPT09PT09
        PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
        PT09PT09PT09PT09PT09PT09PT09PT0KCiAgICB2YXIgSyA9IGZ1bmN0aW9u
        KCkge30sCiAgICAgICAgZ3VpZCA9IDAsCiAgICAgICAgZG9jdW1lbnQgPSB0
        aGlzLmRvY3VtZW50LAogICAgICAgIGRpc2FibGVSYW5nZSA9ICgndW5kZWZp
        bmVkJyA9PT0gdHlwZW9mIEVOViA/IHt9IDogRU5WKS5ESVNBQkxFX1JBTkdF
        X0FQSSwKCiAgICAgICAgLy8gRmVhdHVyZS1kZXRlY3QgdGhlIFczQyByYW5n
        ZSBBUEksIHRoZSBleHRlbmRlZCBjaGVjayBpcyBmb3IgSUU5IHdoaWNoIG9u
        bHkgcGFydGlhbGx5IHN1cHBvcnRzIHJhbmdlcwogICAgICAgIHN1cHBvcnRz
        UmFuZ2UgPSAoIWRpc2FibGVSYW5nZSkgJiYgZG9jdW1lbnQgJiYgKCdjcmVh
        dGVSYW5nZScgaW4gZG9jdW1lbnQpICYmICh0eXBlb2YgUmFuZ2UgIT09ICd1
        bmRlZmluZWQnKSAmJiBSYW5nZS5wcm90b3R5cGUuY3JlYXRlQ29udGV4dHVh
        bEZyYWdtZW50LAoKICAgICAgICAvLyBJbnRlcm5ldCBFeHBsb3JlciBwcmlv
        ciB0byA5IGRvZXMgbm90IGFsbG93IHNldHRpbmcgaW5uZXJIVE1MIGlmIHRo
        ZSBmaXJzdCBlbGVtZW50CiAgICAgICAgLy8gaXMgYSAiemVyby1zY29wZSIg
        ZWxlbWVudC4gVGhpcyBwcm9ibGVtIGNhbiBiZSB3b3JrZWQgYXJvdW5kIGJ5
        IG1ha2luZwogICAgICAgIC8vIHRoZSBmaXJzdCBub2RlIGFuIGludmlzaWJs
        ZSB0ZXh0IG5vZGUuIFdlLCBsaWtlIE1vZGVybml6ciwgdXNlICZzaHk7CiAg
        ICAgICAgbmVlZHNTaHkgPSBkb2N1bWVudCAmJiAoZnVuY3Rpb24oKSB7CiAg
        ICAgICAgICB2YXIgdGVzdEVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgn
        ZGl2Jyk7CiAgICAgICAgICB0ZXN0RWwuaW5uZXJIVE1MID0gIjxkaXY+PC9k
        aXY+IjsKICAgICAgICAgIHRlc3RFbC5maXJzdENoaWxkLmlubmVySFRNTCA9
        ICI8c2NyaXB0Pjwvc2NyaXB0PiI7CiAgICAgICAgICByZXR1cm4gdGVzdEVs
        LmZpcnN0Q2hpbGQuaW5uZXJIVE1MID09PSAnJzsKICAgICAgICB9KSgpLAoK
        CiAgICAgICAgLy8gSUUgOCAoYW5kIGxpa2VseSBlYXJsaWVyKSBsaWtlcyB0
        byBtb3ZlIHdoaXRlc3BhY2UgcHJlY2VlZGluZwogICAgICAgIC8vIGEgc2Ny
        aXB0IHRhZyB0byBhcHBlYXIgYWZ0ZXIgaXQuIFRoaXMgbWVhbnMgdGhhdCB3
        ZSBjYW4KICAgICAgICAvLyBhY2NpZGVudGFsbHkgcmVtb3ZlIHdoaXRlc3Bh
        Y2Ugd2hlbiB1cGRhdGluZyBhIG1vcnBoLgogICAgICAgIG1vdmVzV2hpdGVz
        cGFjZSA9IGRvY3VtZW50ICYmIChmdW5jdGlvbigpIHsKICAgICAgICAgIHZh
        ciB0ZXN0RWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKICAg
        ICAgICAgIHRlc3RFbC5pbm5lckhUTUwgPSAiVGVzdDogPHNjcmlwdCB0eXBl
        PSd0ZXh0L3gtcGxhY2Vob2xkZXInPjwvc2NyaXB0PlZhbHVlIjsKICAgICAg
        ICAgIHJldHVybiB0ZXN0RWwuY2hpbGROb2Rlc1swXS5ub2RlVmFsdWUgPT09
        ICdUZXN0OicgJiYKICAgICAgICAgICAgICAgICAgdGVzdEVsLmNoaWxkTm9k
        ZXNbMl0ubm9kZVZhbHVlID09PSAnIFZhbHVlJzsKICAgICAgICB9KSgpOwoK
        ICAgIC8vIENvbnN0cnVjdG9yIHRoYXQgc3VwcG9ydHMgZWl0aGVyIE1ldGFt
        b3JwaCgnZm9vJykgb3IgbmV3CiAgICAvLyBNZXRhbW9ycGgoJ2ZvbycpOwog
        ICAgLy8KICAgIC8vIFRha2VzIGEgc3RyaW5nIG9mIEhUTUwgYXMgdGhlIGFy
        Z3VtZW50LgoKICAgIHZhciBNZXRhbW9ycGggPSBmdW5jdGlvbihodG1sKSB7
        CiAgICAgIHZhciBzZWxmOwoKICAgICAgaWYgKHRoaXMgaW5zdGFuY2VvZiBN
        ZXRhbW9ycGgpIHsKICAgICAgICBzZWxmID0gdGhpczsKICAgICAgfSBlbHNl
        IHsKICAgICAgICBzZWxmID0gbmV3IEsoKTsKICAgICAgfQoKICAgICAgc2Vs
        Zi5pbm5lckhUTUwgPSBodG1sOwogICAgICB2YXIgbXlHdWlkID0gJ21ldGFt
        b3JwaC0nKyhndWlkKyspOwogICAgICBzZWxmLnN0YXJ0ID0gbXlHdWlkICsg
        Jy1zdGFydCc7CiAgICAgIHNlbGYuZW5kID0gbXlHdWlkICsgJy1lbmQnOwoK
        ICAgICAgcmV0dXJuIHNlbGY7CiAgICB9OwoKICAgIEsucHJvdG90eXBlID0g
        TWV0YW1vcnBoLnByb3RvdHlwZTsKCiAgICB2YXIgcmFuZ2VGb3IsIGh0bWxG
        dW5jLCByZW1vdmVGdW5jLCBvdXRlckhUTUxGdW5jLCBhcHBlbmRUb0Z1bmMs
        IGFmdGVyRnVuYywgcHJlcGVuZEZ1bmMsIHN0YXJ0VGFnRnVuYywgZW5kVGFn
        RnVuYzsKCiAgICBvdXRlckhUTUxGdW5jID0gZnVuY3Rpb24oKSB7CiAgICAg
        IHJldHVybiB0aGlzLnN0YXJ0VGFnKCkgKyB0aGlzLmlubmVySFRNTCArIHRo
        aXMuZW5kVGFnKCk7CiAgICB9OwoKICAgIHN0YXJ0VGFnRnVuYyA9IGZ1bmN0
        aW9uKCkgewogICAgICAvKgogICAgICAgKiBXZSByZXBsYWNlIGNoZXZyb24g
        YnkgaXRzIGhleCBjb2RlIGluIG9yZGVyIHRvIHByZXZlbnQgZXNjYXBpbmcg
        cHJvYmxlbXMuCiAgICAgICAqIENoZWNrIHRoaXMgdGhyZWFkIGZvciBtb3Jl
        IGV4cGxhaW5hdGlvbjoKICAgICAgICogaHR0cDovL3N0YWNrb3ZlcmZsb3cu
        Y29tL3F1ZXN0aW9ucy84MjMxMDQ4L3doeS11c2UteDNjLWluc3RlYWQtb2Yt
        d2hlbi1nZW5lcmF0aW5nLWh0bWwtZnJvbS1qYXZhc2NyaXB0CiAgICAgICAq
        LwogICAgICByZXR1cm4gIjxzY3JpcHQgaWQ9JyIgKyB0aGlzLnN0YXJ0ICsg
        IicgdHlwZT0ndGV4dC94LXBsYWNlaG9sZGVyJz5ceDNDL3NjcmlwdD4iOwog
        ICAgfTsKCiAgICBlbmRUYWdGdW5jID0gZnVuY3Rpb24oKSB7CiAgICAgIC8q
        CiAgICAgICAqIFdlIHJlcGxhY2UgY2hldnJvbiBieSBpdHMgaGV4IGNvZGUg
        aW4gb3JkZXIgdG8gcHJldmVudCBlc2NhcGluZyBwcm9ibGVtcy4KICAgICAg
        ICogQ2hlY2sgdGhpcyB0aHJlYWQgZm9yIG1vcmUgZXhwbGFpbmF0aW9uOgog
        ICAgICAgKiBodHRwOi8vc3RhY2tvdmVyZmxvdy5jb20vcXVlc3Rpb25zLzgy
        MzEwNDgvd2h5LXVzZS14M2MtaW5zdGVhZC1vZi13aGVuLWdlbmVyYXRpbmct
        aHRtbC1mcm9tLWphdmFzY3JpcHQKICAgICAgICovCiAgICAgIHJldHVybiAi
        PHNjcmlwdCBpZD0nIiArIHRoaXMuZW5kICsgIicgdHlwZT0ndGV4dC94LXBs
        YWNlaG9sZGVyJz5ceDNDL3NjcmlwdD4iOwogICAgfTsKCiAgICAvLyBJZiB3
        ZSBoYXZlIHRoZSBXM0MgcmFuZ2UgQVBJLCB0aGlzIHByb2Nlc3MgaXMgcmVs
        YXRpdmVseSBzdHJhaWdodCBmb3J3YXJkLgogICAgaWYgKHN1cHBvcnRzUmFu
        Z2UpIHsKCiAgICAgIC8vIEdldCBhIHJhbmdlIGZvciB0aGUgY3VycmVudCBt
        b3JwaC4gT3B0aW9uYWxseSBpbmNsdWRlIHRoZSBzdGFydGluZyBhbmQKICAg
        ICAgLy8gZW5kaW5nIHBsYWNlaG9sZGVycy4KICAgICAgcmFuZ2VGb3IgPSBm
        dW5jdGlvbihtb3JwaCwgb3V0ZXJUb28pIHsKICAgICAgICB2YXIgcmFuZ2Ug
        PSBkb2N1bWVudC5jcmVhdGVSYW5nZSgpOwogICAgICAgIHZhciBiZWZvcmUg
        PSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChtb3JwaC5zdGFydCk7CiAgICAg
        ICAgdmFyIGFmdGVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQobW9ycGgu
        ZW5kKTsKCiAgICAgICAgaWYgKG91dGVyVG9vKSB7CiAgICAgICAgICByYW5n
        ZS5zZXRTdGFydEJlZm9yZShiZWZvcmUpOwogICAgICAgICAgcmFuZ2Uuc2V0
        RW5kQWZ0ZXIoYWZ0ZXIpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBy
        YW5nZS5zZXRTdGFydEFmdGVyKGJlZm9yZSk7CiAgICAgICAgICByYW5nZS5z
        ZXRFbmRCZWZvcmUoYWZ0ZXIpOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJu
        IHJhbmdlOwogICAgICB9OwoKICAgICAgaHRtbEZ1bmMgPSBmdW5jdGlvbiho
        dG1sLCBvdXRlclRvbykgewogICAgICAgIC8vIGdldCBhIHJhbmdlIGZvciB0
        aGUgY3VycmVudCBtZXRhbW9ycGggb2JqZWN0CiAgICAgICAgdmFyIHJhbmdl
        ID0gcmFuZ2VGb3IodGhpcywgb3V0ZXJUb28pOwoKICAgICAgICAvLyBkZWxl
        dGUgdGhlIGNvbnRlbnRzIG9mIHRoZSByYW5nZSwgd2hpY2ggd2lsbCBiZSB0
        aGUKICAgICAgICAvLyBub2RlcyBiZXR3ZWVuIHRoZSBzdGFydGluZyBhbmQg
        ZW5kaW5nIHBsYWNlaG9sZGVyLgogICAgICAgIHJhbmdlLmRlbGV0ZUNvbnRl
        bnRzKCk7CgogICAgICAgIC8vIGNyZWF0ZSBhIG5ldyBkb2N1bWVudCBmcmFn
        bWVudCBmb3IgdGhlIEhUTUwKICAgICAgICB2YXIgZnJhZ21lbnQgPSByYW5n
        ZS5jcmVhdGVDb250ZXh0dWFsRnJhZ21lbnQoaHRtbCk7CgogICAgICAgIC8v
        IGluc2VydCB0aGUgZnJhZ21lbnQgaW50byB0aGUgcmFuZ2UKICAgICAgICBy
        YW5nZS5pbnNlcnROb2RlKGZyYWdtZW50KTsKICAgICAgfTsKCiAgICAgIC8q
        KgogICAgICAqIEBwdWJsaWMKICAgICAgKiAKICAgICAgKiBSZW1vdmUgdGhp
        cyBvYmplY3QgKGluY2x1ZGluZyBzdGFydGluZyBhbmQgZW5kaW5nCiAgICAg
        ICogcGxhY2Vob2xkZXJzKS4KICAgICAgKgogICAgICAqIEBtZXRob2QgcmVt
        b3ZlCiAgICAgICovCiAgICAgIHJlbW92ZUZ1bmMgPSBmdW5jdGlvbigpIHsK
        ICAgICAgICAvLyBnZXQgYSByYW5nZSBmb3IgdGhlIGN1cnJlbnQgbWV0YW1v
        cnBoIG9iamVjdCBpbmNsdWRpbmcKICAgICAgICAvLyB0aGUgc3RhcnRpbmcg
        YW5kIGVuZGluZyBwbGFjZWhvbGRlcnMuCiAgICAgICAgdmFyIHJhbmdlID0g
        cmFuZ2VGb3IodGhpcywgdHJ1ZSk7CgogICAgICAgIC8vIGRlbGV0ZSB0aGUg
        ZW50aXJlIHJhbmdlLgogICAgICAgIHJhbmdlLmRlbGV0ZUNvbnRlbnRzKCk7
        CiAgICAgIH07CgogICAgICBhcHBlbmRUb0Z1bmMgPSBmdW5jdGlvbihub2Rl
        KSB7CiAgICAgICAgdmFyIHJhbmdlID0gZG9jdW1lbnQuY3JlYXRlUmFuZ2Uo
        KTsKICAgICAgICByYW5nZS5zZXRTdGFydChub2RlKTsKICAgICAgICByYW5n
        ZS5jb2xsYXBzZShmYWxzZSk7CiAgICAgICAgdmFyIGZyYWcgPSByYW5nZS5j
        cmVhdGVDb250ZXh0dWFsRnJhZ21lbnQodGhpcy5vdXRlckhUTUwoKSk7CiAg
        ICAgICAgbm9kZS5hcHBlbmRDaGlsZChmcmFnKTsKICAgICAgfTsKCiAgICAg
        IGFmdGVyRnVuYyA9IGZ1bmN0aW9uKGh0bWwpIHsKICAgICAgICB2YXIgcmFu
        Z2UgPSBkb2N1bWVudC5jcmVhdGVSYW5nZSgpOwogICAgICAgIHZhciBhZnRl
        ciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHRoaXMuZW5kKTsKCiAgICAg
        ICAgcmFuZ2Uuc2V0U3RhcnRBZnRlcihhZnRlcik7CiAgICAgICAgcmFuZ2Uu
        c2V0RW5kQWZ0ZXIoYWZ0ZXIpOwoKICAgICAgICB2YXIgZnJhZ21lbnQgPSBy
        YW5nZS5jcmVhdGVDb250ZXh0dWFsRnJhZ21lbnQoaHRtbCk7CiAgICAgICAg
        cmFuZ2UuaW5zZXJ0Tm9kZShmcmFnbWVudCk7CiAgICAgIH07CgogICAgICBw
        cmVwZW5kRnVuYyA9IGZ1bmN0aW9uKGh0bWwpIHsKICAgICAgICB2YXIgcmFu
        Z2UgPSBkb2N1bWVudC5jcmVhdGVSYW5nZSgpOwogICAgICAgIHZhciBzdGFy
        dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHRoaXMuc3RhcnQpOwoKICAg
        ICAgICByYW5nZS5zZXRTdGFydEFmdGVyKHN0YXJ0KTsKICAgICAgICByYW5n
        ZS5zZXRFbmRBZnRlcihzdGFydCk7CgogICAgICAgIHZhciBmcmFnbWVudCA9
        IHJhbmdlLmNyZWF0ZUNvbnRleHR1YWxGcmFnbWVudChodG1sKTsKICAgICAg
        ICByYW5nZS5pbnNlcnROb2RlKGZyYWdtZW50KTsKICAgICAgfTsKCiAgICB9
        IGVsc2UgewogICAgICAvKgogICAgICAgKiBUaGlzIGNvZGUgaXMgbW9zdGx5
        IHRha2VuIGZyb20galF1ZXJ5LCB3aXRoIG9uZSBleGNlcHRpb24uIEluIGpR
        dWVyeSdzIGNhc2UsIHdlCiAgICAgICAqIGhhdmUgc29tZSBIVE1MIGFuZCB3
        ZSBuZWVkIHRvIGZpZ3VyZSBvdXQgaG93IHRvIGNvbnZlcnQgaXQgaW50byBz
        b21lIG5vZGVzLgogICAgICAgKgogICAgICAgKiBJbiB0aGlzIGNhc2UsIGpR
        dWVyeSBuZWVkcyB0byBzY2FuIHRoZSBIVE1MIGxvb2tpbmcgZm9yIGFuIG9w
        ZW5pbmcgdGFnIGFuZCB1c2UKICAgICAgICogdGhhdCBhcyB0aGUga2V5IGZv
        ciB0aGUgd3JhcCBtYXAuIEluIG91ciBjYXNlLCB3ZSBrbm93IHRoZSBwYXJl
        bnQgbm9kZSwgYW5kCiAgICAgICAqIGNhbiB1c2UgaXRzIHR5cGUgYXMgdGhl
        IGtleSBmb3IgdGhlIHdyYXAgbWFwLgogICAgICAgKiovCiAgICAgIHZhciB3
        cmFwTWFwID0gewogICAgICAgIHNlbGVjdDogWyAxLCAiPHNlbGVjdCBtdWx0
        aXBsZT0nbXVsdGlwbGUnPiIsICI8L3NlbGVjdD4iIF0sCiAgICAgICAgZmll
        bGRzZXQ6IFsgMSwgIjxmaWVsZHNldD4iLCAiPC9maWVsZHNldD4iIF0sCiAg
        ICAgICAgdGFibGU6IFsgMSwgIjx0YWJsZT4iLCAiPC90YWJsZT4iIF0sCiAg
        ICAgICAgdGJvZHk6IFsgMiwgIjx0YWJsZT48dGJvZHk+IiwgIjwvdGJvZHk+
        PC90YWJsZT4iIF0sCiAgICAgICAgdHI6IFsgMywgIjx0YWJsZT48dGJvZHk+
        PHRyPiIsICI8L3RyPjwvdGJvZHk+PC90YWJsZT4iIF0sCiAgICAgICAgY29s
        Z3JvdXA6IFsgMiwgIjx0YWJsZT48dGJvZHk+PC90Ym9keT48Y29sZ3JvdXA+
        IiwgIjwvY29sZ3JvdXA+PC90YWJsZT4iIF0sCiAgICAgICAgbWFwOiBbIDEs
        ICI8bWFwPiIsICI8L21hcD4iIF0sCiAgICAgICAgX2RlZmF1bHQ6IFsgMCwg
        IiIsICIiIF0KICAgICAgfTsKCiAgICAgIHZhciBmaW5kQ2hpbGRCeUlkID0g
        ZnVuY3Rpb24oZWxlbWVudCwgaWQpIHsKICAgICAgICBpZiAoZWxlbWVudC5n
        ZXRBdHRyaWJ1dGUoJ2lkJykgPT09IGlkKSB7IHJldHVybiBlbGVtZW50OyB9
        CgogICAgICAgIHZhciBsZW4gPSBlbGVtZW50LmNoaWxkTm9kZXMubGVuZ3Ro
        LCBpZHgsIG5vZGUsIGZvdW5kOwogICAgICAgIGZvciAoaWR4PTA7IGlkeDxs
        ZW47IGlkeCsrKSB7CiAgICAgICAgICBub2RlID0gZWxlbWVudC5jaGlsZE5v
        ZGVzW2lkeF07CiAgICAgICAgICBmb3VuZCA9IG5vZGUubm9kZVR5cGUgPT09
        IDEgJiYgZmluZENoaWxkQnlJZChub2RlLCBpZCk7CiAgICAgICAgICBpZiAo
        Zm91bmQpIHsgcmV0dXJuIGZvdW5kOyB9CiAgICAgICAgfQogICAgICB9OwoK
        ICAgICAgdmFyIHNldElubmVySFRNTCA9IGZ1bmN0aW9uKGVsZW1lbnQsIGh0
        bWwpIHsKICAgICAgICB2YXIgbWF0Y2hlcyA9IFtdOwogICAgICAgIGlmICht
        b3Zlc1doaXRlc3BhY2UpIHsKICAgICAgICAgIC8vIFJpZ2h0IG5vdyB3ZSBv
        bmx5IGNoZWNrIGZvciBzY3JpcHQgdGFncyB3aXRoIGlkcyB3aXRoIHRoZQog
        ICAgICAgICAgLy8gZ29hbCBvZiB0YXJnZXRpbmcgbW9ycGhzLgogICAgICAg
        ICAgaHRtbCA9IGh0bWwucmVwbGFjZSgvKFxzKykoPHNjcmlwdCBpZD0nKFte
        J10rKScpL2csIGZ1bmN0aW9uKG1hdGNoLCBzcGFjZXMsIHRhZywgaWQpIHsK
        ICAgICAgICAgICAgbWF0Y2hlcy5wdXNoKFtpZCwgc3BhY2VzXSk7CiAgICAg
        ICAgICAgIHJldHVybiB0YWc7CiAgICAgICAgICB9KTsKICAgICAgICB9Cgog
        ICAgICAgIGVsZW1lbnQuaW5uZXJIVE1MID0gaHRtbDsKCiAgICAgICAgLy8g
        SWYgd2UgaGF2ZSB0byBkbyBhbnkgd2hpdGVzcGFjZSBhZGp1c3RtZW50cyBk
        byB0aGVtIG5vdwogICAgICAgIGlmIChtYXRjaGVzLmxlbmd0aCA+IDApIHsK
        ICAgICAgICAgIHZhciBsZW4gPSBtYXRjaGVzLmxlbmd0aCwgaWR4OwogICAg
        ICAgICAgZm9yIChpZHg9MDsgaWR4PGxlbjsgaWR4KyspIHsKICAgICAgICAg
        ICAgdmFyIHNjcmlwdCA9IGZpbmRDaGlsZEJ5SWQoZWxlbWVudCwgbWF0Y2hl
        c1tpZHhdWzBdKSwKICAgICAgICAgICAgICAgIG5vZGUgPSBkb2N1bWVudC5j
        cmVhdGVUZXh0Tm9kZShtYXRjaGVzW2lkeF1bMV0pOwogICAgICAgICAgICBz
        Y3JpcHQucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUobm9kZSwgc2NyaXB0KTsK
        ICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH07CgogICAgICAvKgogICAg
        ICAgKiBHaXZlbiBhIHBhcmVudCBub2RlIGFuZCBzb21lIEhUTUwsIGdlbmVy
        YXRlIGEgc2V0IG9mIG5vZGVzLiBSZXR1cm4gdGhlIGZpcnN0CiAgICAgICAq
        IG5vZGUsIHdoaWNoIHdpbGwgYWxsb3cgdXMgdG8gdHJhdmVyc2UgdGhlIHJl
        c3QgdXNpbmcgbmV4dFNpYmxpbmcuCiAgICAgICAqCiAgICAgICAqIFdlIG5l
        ZWQgdG8gZG8gdGhpcyBiZWNhdXNlIGlubmVySFRNTCBpbiBJRSBkb2VzIG5v
        dCByZWFsbHkgcGFyc2UgdGhlIG5vZGVzLgogICAgICAgKi8KICAgICAgdmFy
        IGZpcnN0Tm9kZUZvciA9IGZ1bmN0aW9uKHBhcmVudE5vZGUsIGh0bWwpIHsK
        ICAgICAgICB2YXIgYXJyID0gd3JhcE1hcFtwYXJlbnROb2RlLnRhZ05hbWUu
        dG9Mb3dlckNhc2UoKV0gfHwgd3JhcE1hcC5fZGVmYXVsdDsKICAgICAgICB2
        YXIgZGVwdGggPSBhcnJbMF0sIHN0YXJ0ID0gYXJyWzFdLCBlbmQgPSBhcnJb
        Ml07CgogICAgICAgIGlmIChuZWVkc1NoeSkgeyBodG1sID0gJyZzaHk7Jyto
        dG1sOyB9CgogICAgICAgIHZhciBlbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRl
        RWxlbWVudCgnZGl2Jyk7CgogICAgICAgIHNldElubmVySFRNTChlbGVtZW50
        LCBzdGFydCArIGh0bWwgKyBlbmQpOwoKICAgICAgICBmb3IgKHZhciBpPTA7
        IGk8PWRlcHRoOyBpKyspIHsKICAgICAgICAgIGVsZW1lbnQgPSBlbGVtZW50
        LmZpcnN0Q2hpbGQ7CiAgICAgICAgfQoKICAgICAgICAvLyBMb29rIGZvciAm
        c2h5OyB0byByZW1vdmUgaXQuCiAgICAgICAgaWYgKG5lZWRzU2h5KSB7CiAg
        ICAgICAgICB2YXIgc2h5RWxlbWVudCA9IGVsZW1lbnQ7CgogICAgICAgICAg
        Ly8gU29tZXRpbWVzIHdlIGdldCBuYW1lbGVzcyBlbGVtZW50cyB3aXRoIHRo
        ZSBzaHkgaW5zaWRlCiAgICAgICAgICB3aGlsZSAoc2h5RWxlbWVudC5ub2Rl
        VHlwZSA9PT0gMSAmJiAhc2h5RWxlbWVudC5ub2RlTmFtZSkgewogICAgICAg
        ICAgICBzaHlFbGVtZW50ID0gc2h5RWxlbWVudC5maXJzdENoaWxkOwogICAg
        ICAgICAgfQoKICAgICAgICAgIC8vIEF0IHRoaXMgcG9pbnQgaXQncyB0aGUg
        YWN0dWFsIHVuaWNvZGUgY2hhcmFjdGVyLgogICAgICAgICAgaWYgKHNoeUVs
        ZW1lbnQubm9kZVR5cGUgPT09IDMgJiYgc2h5RWxlbWVudC5ub2RlVmFsdWUu
        Y2hhckF0KDApID09PSAiXHUwMEFEIikgewogICAgICAgICAgICBzaHlFbGVt
        ZW50Lm5vZGVWYWx1ZSA9IHNoeUVsZW1lbnQubm9kZVZhbHVlLnNsaWNlKDEp
        OwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIGVsZW1l
        bnQ7CiAgICAgIH07CgogICAgICAvKgogICAgICAgKiBJbiBzb21lIGNhc2Vz
        LCBJbnRlcm5ldCBFeHBsb3JlciBjYW4gY3JlYXRlIGFuIGFub255bW91cyBu
        b2RlIGluCiAgICAgICAqIHRoZSBoaWVyYXJjaHkgd2l0aCBubyB0YWdOYW1l
        LiBZb3UgY2FuIGNyZWF0ZSB0aGlzIHNjZW5hcmlvIHZpYToKICAgICAgICoK
        ICAgICAgICogICAgIGRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRp
        diIpOwogICAgICAgKiAgICAgZGl2LmlubmVySFRNTCA9ICI8dGFibGU+JnNo
        eTxzY3JpcHQ+PC9zY3JpcHQ+PHRyPjx0ZD5oaTwvdGQ+PC90cj48L3RhYmxl
        PiI7CiAgICAgICAqICAgICBkaXYuZmlyc3RDaGlsZC5maXJzdENoaWxkLnRh
        Z05hbWUgLy89PiAiIgogICAgICAgKgogICAgICAgKiBJZiBvdXIgc2NyaXB0
        IG1hcmtlcnMgYXJlIGluc2lkZSBzdWNoIGEgbm9kZSwgd2UgbmVlZCB0byBm
        aW5kIHRoYXQKICAgICAgICogbm9kZSBhbmQgdXNlICppdCogYXMgdGhlIG1h
        cmtlci4KICAgICAgICovCiAgICAgIHZhciByZWFsTm9kZSA9IGZ1bmN0aW9u
        KHN0YXJ0KSB7CiAgICAgICAgd2hpbGUgKHN0YXJ0LnBhcmVudE5vZGUudGFn
        TmFtZSA9PT0gIiIpIHsKICAgICAgICAgIHN0YXJ0ID0gc3RhcnQucGFyZW50
        Tm9kZTsKICAgICAgICB9CgogICAgICAgIHJldHVybiBzdGFydDsKICAgICAg
        fTsKCiAgICAgIC8qCiAgICAgICAqIFdoZW4gYXV0b21hdGljYWxseSBhZGRp
        bmcgYSB0Ym9keSwgSW50ZXJuZXQgRXhwbG9yZXIgaW5zZXJ0cyB0aGUKICAg
        ICAgICogdGJvZHkgaW1tZWRpYXRlbHkgYmVmb3JlIHRoZSBmaXJzdCA8dHI+
        LiBPdGhlciBicm93c2VycyBjcmVhdGUgaXQKICAgICAgICogYmVmb3JlIHRo
        ZSBmaXJzdCBub2RlLCBubyBtYXR0ZXIgd2hhdC4KICAgICAgICoKICAgICAg
        ICogVGhpcyBtZWFucyB0aGUgdGhlIGZvbGxvd2luZyBjb2RlOgogICAgICAg
        KgogICAgICAgKiAgICAgZGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgi
        ZGl2Iik7CiAgICAgICAqICAgICBkaXYuaW5uZXJIVE1MID0gIjx0YWJsZT48
        c2NyaXB0IGlkPSdmaXJzdCc+PC9zY3JpcHQ+PHRyPjx0ZD5oaTwvdGQ+PC90
        cj48c2NyaXB0IGlkPSdsYXN0Jz48L3NjcmlwdD48L3RhYmxlPgogICAgICAg
        KgogICAgICAgKiBHZW5lcmF0ZXMgdGhlIGZvbGxvd2luZyBET00gaW4gSUU6
        CiAgICAgICAqCiAgICAgICAqICAgICArIGRpdgogICAgICAgKiAgICAgICAr
        IHRhYmxlCiAgICAgICAqICAgICAgICAgLSBzY3JpcHQgaWQ9J2ZpcnN0Jwog
        ICAgICAgKiAgICAgICAgICsgdGJvZHkKICAgICAgICogICAgICAgICAgICsg
        dHIKICAgICAgICogICAgICAgICAgICAgKyB0ZAogICAgICAgKiAgICAgICAg
        ICAgICAgIC0gImhpIgogICAgICAgKiAgICAgICAgICAgLSBzY3JpcHQgaWQ9
        J2xhc3QnCiAgICAgICAqCiAgICAgICAqIFdoaWNoIG1lYW5zIHRoYXQgdGhl
        IHR3byBzY3JpcHQgdGFncywgZXZlbiB0aG91Z2ggdGhleSB3ZXJlCiAgICAg
        ICAqIGluc2VydGVkIGF0IHRoZSBzYW1lIHBvaW50IGluIHRoZSBoaWVyYXJj
        aHkgaW4gdGhlIG9yaWdpbmFsCiAgICAgICAqIEhUTUwsIG5vdyBoYXZlIGRp
        ZmZlcmVudCBwYXJlbnRzLgogICAgICAgKgogICAgICAgKiBUaGlzIGNvZGUg
        cmVwYXJlbnRzIHRoZSBmaXJzdCBzY3JpcHQgdGFnIGJ5IG1ha2luZyBpdCB0
        aGUgdGJvZHkncwogICAgICAgKiBmaXJzdCBjaGlsZC4KICAgICAgICoKICAg
        ICAgICovCiAgICAgIHZhciBmaXhQYXJlbnRhZ2UgPSBmdW5jdGlvbihzdGFy
        dCwgZW5kKSB7CiAgICAgICAgaWYgKHN0YXJ0LnBhcmVudE5vZGUgIT09IGVu
        ZC5wYXJlbnROb2RlKSB7CiAgICAgICAgICBlbmQucGFyZW50Tm9kZS5pbnNl
        cnRCZWZvcmUoc3RhcnQsIGVuZC5wYXJlbnROb2RlLmZpcnN0Q2hpbGQpOwog
        ICAgICAgIH0KICAgICAgfTsKCiAgICAgIGh0bWxGdW5jID0gZnVuY3Rpb24o
        aHRtbCwgb3V0ZXJUb28pIHsKICAgICAgICAvLyBnZXQgdGhlIHJlYWwgc3Rh
        cnRpbmcgbm9kZS4gc2VlIHJlYWxOb2RlIGZvciBkZXRhaWxzLgogICAgICAg
        IHZhciBzdGFydCA9IHJlYWxOb2RlKGRvY3VtZW50LmdldEVsZW1lbnRCeUlk
        KHRoaXMuc3RhcnQpKTsKICAgICAgICB2YXIgZW5kID0gZG9jdW1lbnQuZ2V0
        RWxlbWVudEJ5SWQodGhpcy5lbmQpOwogICAgICAgIHZhciBwYXJlbnROb2Rl
        ID0gZW5kLnBhcmVudE5vZGU7CiAgICAgICAgdmFyIG5vZGUsIG5leHRTaWJs
        aW5nLCBsYXN0OwoKICAgICAgICAvLyBtYWtlIHN1cmUgdGhhdCB0aGUgc3Rh
        cnQgYW5kIGVuZCBub2RlcyBzaGFyZSB0aGUgc2FtZQogICAgICAgIC8vIHBh
        cmVudC4gSWYgbm90LCBmaXggaXQuCiAgICAgICAgZml4UGFyZW50YWdlKHN0
        YXJ0LCBlbmQpOwoKICAgICAgICAvLyByZW1vdmUgYWxsIG9mIHRoZSBub2Rl
        cyBhZnRlciB0aGUgc3RhcnRpbmcgcGxhY2Vob2xkZXIgYW5kCiAgICAgICAg
        Ly8gYmVmb3JlIHRoZSBlbmRpbmcgcGxhY2Vob2xkZXIuCiAgICAgICAgbm9k
        ZSA9IHN0YXJ0Lm5leHRTaWJsaW5nOwogICAgICAgIHdoaWxlIChub2RlKSB7
        CiAgICAgICAgICBuZXh0U2libGluZyA9IG5vZGUubmV4dFNpYmxpbmc7CiAg
        ICAgICAgICBsYXN0ID0gbm9kZSA9PT0gZW5kOwoKICAgICAgICAgIC8vIGlm
        IHRoaXMgaXMgdGhlIGxhc3Qgbm9kZSwgYW5kIHdlIHdhbnQgdG8gcmVtb3Zl
        IGl0IGFzIHdlbGwsCiAgICAgICAgICAvLyBzZXQgdGhlIGBlbmRgIG5vZGUg
        dG8gdGhlIG5leHQgc2libGluZy4gVGhpcyBpcyBiZWNhdXNlCiAgICAgICAg
        ICAvLyBmb3IgdGhlIHJlc3Qgb2YgdGhlIGZ1bmN0aW9uLCB3ZSBpbnNlcnQg
        dGhlIG5ldyBub2RlcwogICAgICAgICAgLy8gYmVmb3JlIHRoZSBlbmQgKG5v
        dGUgdGhhdCBpbnNlcnRCZWZvcmUobm9kZSwgbnVsbCkgaXMKICAgICAgICAg
        IC8vIHRoZSBzYW1lIGFzIGFwcGVuZENoaWxkKG5vZGUpKS4KICAgICAgICAg
        IC8vCiAgICAgICAgICAvLyBpZiB3ZSBkbyBub3Qgd2FudCB0byByZW1vdmUg
        aXQsIGp1c3QgYnJlYWsuCiAgICAgICAgICBpZiAobGFzdCkgewogICAgICAg
        ICAgICBpZiAob3V0ZXJUb28pIHsgZW5kID0gbm9kZS5uZXh0U2libGluZzsg
        fSBlbHNlIHsgYnJlYWs7IH0KICAgICAgICAgIH0KCiAgICAgICAgICBub2Rl
        LnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQobm9kZSk7CgogICAgICAgICAgLy8g
        aWYgdGhpcyBpcyB0aGUgbGFzdCBub2RlIGFuZCB3ZSBkaWRuJ3QgYnJlYWsg
        YmVmb3JlCiAgICAgICAgICAvLyAoYmVjYXVzZSB3ZSB3YW50ZWQgdG8gcmVt
        b3ZlIHRoZSBvdXRlciBub2RlcyksIGJyZWFrCiAgICAgICAgICAvLyBub3cu
        CiAgICAgICAgICBpZiAobGFzdCkgeyBicmVhazsgfQoKICAgICAgICAgIG5v
        ZGUgPSBuZXh0U2libGluZzsKICAgICAgICB9CgogICAgICAgIC8vIGdldCB0
        aGUgZmlyc3Qgbm9kZSBmb3IgdGhlIEhUTUwgc3RyaW5nLCBldmVuIGluIGNh
        c2VzIGxpa2UKICAgICAgICAvLyB0YWJsZXMgYW5kIGxpc3RzIHdoZXJlIGEg
        c2ltcGxlIGlubmVySFRNTCBvbiBhIGRpdiB3b3VsZAogICAgICAgIC8vIHN3
        YWxsb3cgc29tZSBvZiB0aGUgY29udGVudC4KICAgICAgICBub2RlID0gZmly
        c3ROb2RlRm9yKHN0YXJ0LnBhcmVudE5vZGUsIGh0bWwpOwoKICAgICAgICAv
        LyBjb3B5IHRoZSBub2RlcyBmb3IgdGhlIEhUTUwgYmV0d2VlbiB0aGUgc3Rh
        cnRpbmcgYW5kIGVuZGluZwogICAgICAgIC8vIHBsYWNlaG9sZGVyLgogICAg
        ICAgIHdoaWxlIChub2RlKSB7CiAgICAgICAgICBuZXh0U2libGluZyA9IG5v
        ZGUubmV4dFNpYmxpbmc7CiAgICAgICAgICBwYXJlbnROb2RlLmluc2VydEJl
        Zm9yZShub2RlLCBlbmQpOwogICAgICAgICAgbm9kZSA9IG5leHRTaWJsaW5n
        OwogICAgICAgIH0KICAgICAgfTsKCiAgICAgIC8vIHJlbW92ZSB0aGUgbm9k
        ZXMgaW4gdGhlIERPTSByZXByZXNlbnRpbmcgdGhpcyBtZXRhbW9ycGguCiAg
        ICAgIC8vCiAgICAgIC8vIHRoaXMgaW5jbHVkZXMgdGhlIHN0YXJ0aW5nIGFu
        ZCBlbmRpbmcgcGxhY2Vob2xkZXJzLgogICAgICByZW1vdmVGdW5jID0gZnVu
        Y3Rpb24oKSB7CiAgICAgICAgdmFyIHN0YXJ0ID0gcmVhbE5vZGUoZG9jdW1l
        bnQuZ2V0RWxlbWVudEJ5SWQodGhpcy5zdGFydCkpOwogICAgICAgIHZhciBl
        bmQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0aGlzLmVuZCk7CgogICAg
        ICAgIHRoaXMuaHRtbCgnJyk7CiAgICAgICAgc3RhcnQucGFyZW50Tm9kZS5y
        ZW1vdmVDaGlsZChzdGFydCk7CiAgICAgICAgZW5kLnBhcmVudE5vZGUucmVt
        b3ZlQ2hpbGQoZW5kKTsKICAgICAgfTsKCiAgICAgIGFwcGVuZFRvRnVuYyA9
        IGZ1bmN0aW9uKHBhcmVudE5vZGUpIHsKICAgICAgICB2YXIgbm9kZSA9IGZp
        cnN0Tm9kZUZvcihwYXJlbnROb2RlLCB0aGlzLm91dGVySFRNTCgpKTsKICAg
        ICAgICB2YXIgbmV4dFNpYmxpbmc7CgogICAgICAgIHdoaWxlIChub2RlKSB7
        CiAgICAgICAgICBuZXh0U2libGluZyA9IG5vZGUubmV4dFNpYmxpbmc7CiAg
        ICAgICAgICBwYXJlbnROb2RlLmFwcGVuZENoaWxkKG5vZGUpOwogICAgICAg
        ICAgbm9kZSA9IG5leHRTaWJsaW5nOwogICAgICAgIH0KICAgICAgfTsKCiAg
        ICAgIGFmdGVyRnVuYyA9IGZ1bmN0aW9uKGh0bWwpIHsKICAgICAgICAvLyBn
        ZXQgdGhlIHJlYWwgc3RhcnRpbmcgbm9kZS4gc2VlIHJlYWxOb2RlIGZvciBk
        ZXRhaWxzLgogICAgICAgIHZhciBlbmQgPSBkb2N1bWVudC5nZXRFbGVtZW50
        QnlJZCh0aGlzLmVuZCk7CiAgICAgICAgdmFyIGluc2VydEJlZm9yZSA9IGVu
        ZC5uZXh0U2libGluZzsKICAgICAgICB2YXIgcGFyZW50Tm9kZSA9IGVuZC5w
        YXJlbnROb2RlOwogICAgICAgIHZhciBuZXh0U2libGluZzsKICAgICAgICB2
        YXIgbm9kZTsKCiAgICAgICAgLy8gZ2V0IHRoZSBmaXJzdCBub2RlIGZvciB0
        aGUgSFRNTCBzdHJpbmcsIGV2ZW4gaW4gY2FzZXMgbGlrZQogICAgICAgIC8v
        IHRhYmxlcyBhbmQgbGlzdHMgd2hlcmUgYSBzaW1wbGUgaW5uZXJIVE1MIG9u
        IGEgZGl2IHdvdWxkCiAgICAgICAgLy8gc3dhbGxvdyBzb21lIG9mIHRoZSBj
        b250ZW50LgogICAgICAgIG5vZGUgPSBmaXJzdE5vZGVGb3IocGFyZW50Tm9k
        ZSwgaHRtbCk7CgogICAgICAgIC8vIGNvcHkgdGhlIG5vZGVzIGZvciB0aGUg
        SFRNTCBiZXR3ZWVuIHRoZSBzdGFydGluZyBhbmQgZW5kaW5nCiAgICAgICAg
        Ly8gcGxhY2Vob2xkZXIuCiAgICAgICAgd2hpbGUgKG5vZGUpIHsKICAgICAg
        ICAgIG5leHRTaWJsaW5nID0gbm9kZS5uZXh0U2libGluZzsKICAgICAgICAg
        IHBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKG5vZGUsIGluc2VydEJlZm9yZSk7
        CiAgICAgICAgICBub2RlID0gbmV4dFNpYmxpbmc7CiAgICAgICAgfQogICAg
        ICB9OwoKICAgICAgcHJlcGVuZEZ1bmMgPSBmdW5jdGlvbihodG1sKSB7CiAg
        ICAgICAgdmFyIHN0YXJ0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodGhp
        cy5zdGFydCk7CiAgICAgICAgdmFyIHBhcmVudE5vZGUgPSBzdGFydC5wYXJl
        bnROb2RlOwogICAgICAgIHZhciBuZXh0U2libGluZzsKICAgICAgICB2YXIg
        bm9kZTsKCiAgICAgICAgbm9kZSA9IGZpcnN0Tm9kZUZvcihwYXJlbnROb2Rl
        LCBodG1sKTsKICAgICAgICB2YXIgaW5zZXJ0QmVmb3JlID0gc3RhcnQubmV4
        dFNpYmxpbmc7CgogICAgICAgIHdoaWxlIChub2RlKSB7CiAgICAgICAgICBu
        ZXh0U2libGluZyA9IG5vZGUubmV4dFNpYmxpbmc7CiAgICAgICAgICBwYXJl
        bnROb2RlLmluc2VydEJlZm9yZShub2RlLCBpbnNlcnRCZWZvcmUpOwogICAg
        ICAgICAgbm9kZSA9IG5leHRTaWJsaW5nOwogICAgICAgIH0KICAgICAgfTsK
        ICAgIH0KCiAgICBNZXRhbW9ycGgucHJvdG90eXBlLmh0bWwgPSBmdW5jdGlv
        bihodG1sKSB7CiAgICAgIHRoaXMuY2hlY2tSZW1vdmVkKCk7CiAgICAgIGlm
        IChodG1sID09PSB1bmRlZmluZWQpIHsgcmV0dXJuIHRoaXMuaW5uZXJIVE1M
        OyB9CgogICAgICBodG1sRnVuYy5jYWxsKHRoaXMsIGh0bWwpOwoKICAgICAg
        dGhpcy5pbm5lckhUTUwgPSBodG1sOwogICAgfTsKCiAgICBNZXRhbW9ycGgu
        cHJvdG90eXBlLnJlcGxhY2VXaXRoID0gZnVuY3Rpb24oaHRtbCkgewogICAg
        ICB0aGlzLmNoZWNrUmVtb3ZlZCgpOwogICAgICBodG1sRnVuYy5jYWxsKHRo
        aXMsIGh0bWwsIHRydWUpOwogICAgfTsKCiAgICBNZXRhbW9ycGgucHJvdG90
        eXBlLnJlbW92ZSA9IHJlbW92ZUZ1bmM7CiAgICBNZXRhbW9ycGgucHJvdG90
        eXBlLm91dGVySFRNTCA9IG91dGVySFRNTEZ1bmM7CiAgICBNZXRhbW9ycGgu
        cHJvdG90eXBlLmFwcGVuZFRvID0gYXBwZW5kVG9GdW5jOwogICAgTWV0YW1v
        cnBoLnByb3RvdHlwZS5hZnRlciA9IGFmdGVyRnVuYzsKICAgIE1ldGFtb3Jw
        aC5wcm90b3R5cGUucHJlcGVuZCA9IHByZXBlbmRGdW5jOwogICAgTWV0YW1v
        cnBoLnByb3RvdHlwZS5zdGFydFRhZyA9IHN0YXJ0VGFnRnVuYzsKICAgIE1l
        dGFtb3JwaC5wcm90b3R5cGUuZW5kVGFnID0gZW5kVGFnRnVuYzsKCiAgICBN
        ZXRhbW9ycGgucHJvdG90eXBlLmlzUmVtb3ZlZCA9IGZ1bmN0aW9uKCkgewog
        ICAgICB2YXIgYmVmb3JlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodGhp
        cy5zdGFydCk7CiAgICAgIHZhciBhZnRlciA9IGRvY3VtZW50LmdldEVsZW1l
        bnRCeUlkKHRoaXMuZW5kKTsKCiAgICAgIHJldHVybiAhYmVmb3JlIHx8ICFh
        ZnRlcjsKICAgIH07CgogICAgTWV0YW1vcnBoLnByb3RvdHlwZS5jaGVja1Jl
        bW92ZWQgPSBmdW5jdGlvbigpIHsKICAgICAgaWYgKHRoaXMuaXNSZW1vdmVk
        KCkpIHsKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoIkNhbm5vdCBwZXJmb3Jt
        IG9wZXJhdGlvbnMgb24gYSBNZXRhbW9ycGggdGhhdCBpcyBub3QgaW4gdGhl
        IERPTS4iKTsKICAgICAgfQogICAgfTsKCiAgICByZXR1cm4gTWV0YW1vcnBo
        OwogIH0pOwoKfSkoKTsKCihmdW5jdGlvbigpIHsKLyoqCkBtb2R1bGUgZW1i
        ZXIKQHN1Ym1vZHVsZSBlbWJlci1oYW5kbGViYXJzLWNvbXBpbGVyCiovCgov
        LyBFbGltaW5hdGUgZGVwZW5kZW5jeSBvbiBhbnkgRW1iZXIgdG8gc2ltcGxp
        ZnkgcHJlY29tcGlsYXRpb24gd29ya2Zsb3cKdmFyIG9iamVjdENyZWF0ZSA9
        IE9iamVjdC5jcmVhdGUgfHwgZnVuY3Rpb24ocGFyZW50KSB7CiAgZnVuY3Rp
        b24gRigpIHt9CiAgRi5wcm90b3R5cGUgPSBwYXJlbnQ7CiAgcmV0dXJuIG5l
        dyBGKCk7Cn07Cgp2YXIgSGFuZGxlYmFycyA9IHRoaXMuSGFuZGxlYmFycyB8
        fCAoRW1iZXIuaW1wb3J0cyAmJiBFbWJlci5pbXBvcnRzLkhhbmRsZWJhcnMp
        OwppZiAoIUhhbmRsZWJhcnMgJiYgdHlwZW9mIHJlcXVpcmUgPT09ICdmdW5j
        dGlvbicpIHsKICBIYW5kbGViYXJzID0gcmVxdWlyZSgnaGFuZGxlYmFycycp
        Owp9CgpFbWJlci5hc3NlcnQoIkVtYmVyIEhhbmRsZWJhcnMgcmVxdWlyZXMg
        SGFuZGxlYmFycyB2ZXJzaW9uIDEuMC4wLiBJbmNsdWRlIGEgU0NSSVBUIHRh
        ZyBpbiB0aGUgSFRNTCBIRUFEIGxpbmtpbmcgdG8gdGhlIEhhbmRsZWJhcnMg
        ZmlsZSBiZWZvcmUgeW91IGxpbmsgdG8gRW1iZXIuIiwgSGFuZGxlYmFycyk7
        CkVtYmVyLmFzc2VydCgiRW1iZXIgSGFuZGxlYmFycyByZXF1aXJlcyBIYW5k
        bGViYXJzIHZlcnNpb24gMS4wLjAsIENPTVBJTEVSX1JFVklTSU9OIGV4cGVj
        dGVkOiA0LCBnb3Q6ICIgKyAgSGFuZGxlYmFycy5DT01QSUxFUl9SRVZJU0lP
        TiArICIgLSBQbGVhc2Ugbm90ZTogQnVpbGRzIG9mIG1hc3RlciBtYXkgaGF2
        ZSBvdGhlciBDT01QSUxFUl9SRVZJU0lPTiB2YWx1ZXMuIiwgSGFuZGxlYmFy
        cy5DT01QSUxFUl9SRVZJU0lPTiA9PT0gNCk7CgovKioKICBQcmVwYXJlcyB0
        aGUgSGFuZGxlYmFycyB0ZW1wbGF0aW5nIGxpYnJhcnkgZm9yIHVzZSBpbnNp
        ZGUgRW1iZXIncyB2aWV3CiAgc3lzdGVtLgoKICBUaGUgYEVtYmVyLkhhbmRs
        ZWJhcnNgIG9iamVjdCBpcyB0aGUgc3RhbmRhcmQgSGFuZGxlYmFycyBsaWJy
        YXJ5LCBleHRlbmRlZCB0bwogIHVzZSBFbWJlcidzIGBnZXQoKWAgbWV0aG9k
        IGluc3RlYWQgb2YgZGlyZWN0IHByb3BlcnR5IGFjY2Vzcywgd2hpY2ggYWxs
        b3dzCiAgY29tcHV0ZWQgcHJvcGVydGllcyB0byBiZSB1c2VkIGluc2lkZSB0
        ZW1wbGF0ZXMuCgogIFRvIGNyZWF0ZSBhbiBgRW1iZXIuSGFuZGxlYmFyc2Ag
        dGVtcGxhdGUsIGNhbGwgYEVtYmVyLkhhbmRsZWJhcnMuY29tcGlsZSgpYC4K
        ICBUaGlzIHdpbGwgcmV0dXJuIGEgZnVuY3Rpb24gdGhhdCBjYW4gYmUgdXNl
        ZCBieSBgRW1iZXIuVmlld2AgZm9yIHJlbmRlcmluZy4KCiAgQGNsYXNzIEhh
        bmRsZWJhcnMKICBAbmFtZXNwYWNlIEVtYmVyCiovCkVtYmVyLkhhbmRsZWJh
        cnMgPSBvYmplY3RDcmVhdGUoSGFuZGxlYmFycyk7CgovKioKICBSZWdpc3Rl
        ciBhIGJvdW5kIGhlbHBlciBvciBjdXN0b20gdmlldyBoZWxwZXIuCgogICMj
        IFNpbXBsZSBib3VuZCBoZWxwZXIgZXhhbXBsZQoKICBgYGBqYXZhc2NyaXB0
        CiAgRW1iZXIuSGFuZGxlYmFycy5oZWxwZXIoJ2NhcGl0YWxpemUnLCBmdW5j
        dGlvbih2YWx1ZSkgewogICAgcmV0dXJuIHZhbHVlLnRvVXBwZXJDYXNlKCk7
        CiAgfSk7CiAgYGBgCgogIFRoZSBhYm92ZSBib3VuZCBoZWxwZXIgY2FuIGJl
        IHVzZWQgaW5zaWRlIG9mIHRlbXBsYXRlcyBhcyBmb2xsb3dzOgoKICBgYGBo
        YW5kbGViYXJzCiAge3tjYXBpdGFsaXplIG5hbWV9fQogIGBgYAoKICBJbiB0
        aGlzIGNhc2UsIHdoZW4gdGhlIGBuYW1lYCBwcm9wZXJ0eSBvZiB0aGUgdGVt
        cGxhdGUncyBjb250ZXh0IGNoYW5nZXMsCiAgdGhlIHJlbmRlcmVkIHZhbHVl
        IG9mIHRoZSBoZWxwZXIgd2lsbCB1cGRhdGUgdG8gcmVmbGVjdCB0aGlzIGNo
        YW5nZS4KCiAgRm9yIG1vcmUgZXhhbXBsZXMgb2YgYm91bmQgaGVscGVycywg
        c2VlIGRvY3VtZW50YXRpb24gZm9yCiAgYEVtYmVyLkhhbmRsZWJhcnMucmVn
        aXN0ZXJCb3VuZEhlbHBlcmAuCgogICMjIEN1c3RvbSB2aWV3IGhlbHBlciBl
        eGFtcGxlCgogIEFzc3VtaW5nIGEgdmlldyBzdWJjbGFzcyBuYW1lZCBgQXBw
        LkNhbGVuZGFyVmlld2Agd2VyZSBkZWZpbmVkLCBhIGhlbHBlcgogIGZvciBy
        ZW5kZXJpbmcgaW5zdGFuY2VzIG9mIHRoaXMgdmlldyBjb3VsZCBiZSByZWdp
        c3RlcmVkIGFzIGZvbGxvd3M6CgogIGBgYGphdmFzY3JpcHQKICBFbWJlci5I
        YW5kbGViYXJzLmhlbHBlcignY2FsZW5kYXInLCBBcHAuQ2FsZW5kYXJWaWV3
        KToKICBgYGAKCiAgVGhlIGFib3ZlIGJvdW5kIGhlbHBlciBjYW4gYmUgdXNl
        ZCBpbnNpZGUgb2YgdGVtcGxhdGVzIGFzIGZvbGxvd3M6CgogIGBgYGhhbmRs
        ZWJhcnMKICB7e2NhbGVuZGFyfX0KICBgYGAKCiAgV2hpY2ggaXMgZnVuY3Rp
        b25hbGx5IGVxdWl2YWxlbnQgdG86CgogIGBgYGhhbmRsZWJhcnMKICB7e3Zp
        ZXcgQXBwLkNhbGVuZGFyVmlld319CiAgYGBgCgogIE9wdGlvbnMgaW4gdGhl
        IGhlbHBlciB3aWxsIGJlIHBhc3NlZCB0byB0aGUgdmlldyBpbiBleGFjdGx5
        IHRoZSBzYW1lCiAgbWFubmVyIGFzIHdpdGggdGhlIGB2aWV3YCBoZWxwZXIu
        CgogIEBtZXRob2QgaGVscGVyCiAgQGZvciBFbWJlci5IYW5kbGViYXJzCiAg
        QHBhcmFtIHtTdHJpbmd9IG5hbWUKICBAcGFyYW0ge0Z1bmN0aW9ufEVtYmVy
        LlZpZXd9IGZ1bmN0aW9uIG9yIHZpZXcgY2xhc3MgY29uc3RydWN0b3IKICBA
        cGFyYW0ge1N0cmluZ30gZGVwZW5kZW50S2V5cyoKKi8KRW1iZXIuSGFuZGxl
        YmFycy5oZWxwZXIgPSBmdW5jdGlvbihuYW1lLCB2YWx1ZSkgewogIEVtYmVy
        LmFzc2VydCgiWW91IHRyaWVkIHRvIHJlZ2lzdGVyIGEgY29tcG9uZW50IG5h
        bWVkICciICsgbmFtZSArICInLCBidXQgY29tcG9uZW50IG5hbWVzIG11c3Qg
        aW5jbHVkZSBhICctJyIsICFFbWJlci5Db21wb25lbnQuZGV0ZWN0KHZhbHVl
        KSB8fCBuYW1lLm1hdGNoKC8tLykpOwoKICBpZiAoRW1iZXIuVmlldy5kZXRl
        Y3QodmFsdWUpKSB7CiAgICBFbWJlci5IYW5kbGViYXJzLnJlZ2lzdGVySGVs
        cGVyKG5hbWUsIGZ1bmN0aW9uKG9wdGlvbnMpIHsKICAgICAgRW1iZXIuYXNz
        ZXJ0KCJZb3UgY2FuIG9ubHkgcGFzcyBhdHRyaWJ1dGVzIChzdWNoIGFzIG5h
        bWU9dmFsdWUpIG5vdCBiYXJlIHZhbHVlcyB0byBhIGhlbHBlciBmb3IgYSBW
        aWV3IiwgYXJndW1lbnRzLmxlbmd0aCA8IDIpOwogICAgICByZXR1cm4gRW1i
        ZXIuSGFuZGxlYmFycy5oZWxwZXJzLnZpZXcuY2FsbCh0aGlzLCB2YWx1ZSwg
        b3B0aW9ucyk7CiAgICB9KTsKICB9IGVsc2UgewogICAgRW1iZXIuSGFuZGxl
        YmFycy5yZWdpc3RlckJvdW5kSGVscGVyLmFwcGx5KG51bGwsIGFyZ3VtZW50
        cyk7CiAgfQp9OwoKLyoqCkBjbGFzcyBoZWxwZXJzCkBuYW1lc3BhY2UgRW1i
        ZXIuSGFuZGxlYmFycwoqLwpFbWJlci5IYW5kbGViYXJzLmhlbHBlcnMgPSBv
        YmplY3RDcmVhdGUoSGFuZGxlYmFycy5oZWxwZXJzKTsKCi8qKgogIE92ZXJy
        aWRlIHRoZSB0aGUgb3Bjb2RlIGNvbXBpbGVyIGFuZCBKYXZhU2NyaXB0IGNv
        bXBpbGVyIGZvciBIYW5kbGViYXJzLgoKICBAY2xhc3MgQ29tcGlsZXIKICBA
        bmFtZXNwYWNlIEVtYmVyLkhhbmRsZWJhcnMKICBAcHJpdmF0ZQogIEBjb25z
        dHJ1Y3RvcgoqLwpFbWJlci5IYW5kbGViYXJzLkNvbXBpbGVyID0gZnVuY3Rp
        b24oKSB7fTsKCi8vIEhhbmRsZWJhcnMuQ29tcGlsZXIgZG9lc24ndCBleGlz
        dCBpbiBydW50aW1lLW9ubHkKaWYgKEhhbmRsZWJhcnMuQ29tcGlsZXIpIHsK
        ICBFbWJlci5IYW5kbGViYXJzLkNvbXBpbGVyLnByb3RvdHlwZSA9IG9iamVj
        dENyZWF0ZShIYW5kbGViYXJzLkNvbXBpbGVyLnByb3RvdHlwZSk7Cn0KCkVt
        YmVyLkhhbmRsZWJhcnMuQ29tcGlsZXIucHJvdG90eXBlLmNvbXBpbGVyID0g
        RW1iZXIuSGFuZGxlYmFycy5Db21waWxlcjsKCi8qKgogIEBjbGFzcyBKYXZh
        U2NyaXB0Q29tcGlsZXIKICBAbmFtZXNwYWNlIEVtYmVyLkhhbmRsZWJhcnMK
        ICBAcHJpdmF0ZQogIEBjb25zdHJ1Y3RvcgoqLwpFbWJlci5IYW5kbGViYXJz
        LkphdmFTY3JpcHRDb21waWxlciA9IGZ1bmN0aW9uKCkge307CgovLyBIYW5k
        bGViYXJzLkphdmFTY3JpcHRDb21waWxlciBkb2Vzbid0IGV4aXN0IGluIHJ1
        bnRpbWUtb25seQppZiAoSGFuZGxlYmFycy5KYXZhU2NyaXB0Q29tcGlsZXIp
        IHsKICBFbWJlci5IYW5kbGViYXJzLkphdmFTY3JpcHRDb21waWxlci5wcm90
        b3R5cGUgPSBvYmplY3RDcmVhdGUoSGFuZGxlYmFycy5KYXZhU2NyaXB0Q29t
        cGlsZXIucHJvdG90eXBlKTsKICBFbWJlci5IYW5kbGViYXJzLkphdmFTY3Jp
        cHRDb21waWxlci5wcm90b3R5cGUuY29tcGlsZXIgPSBFbWJlci5IYW5kbGVi
        YXJzLkphdmFTY3JpcHRDb21waWxlcjsKfQoKCkVtYmVyLkhhbmRsZWJhcnMu
        SmF2YVNjcmlwdENvbXBpbGVyLnByb3RvdHlwZS5uYW1lc3BhY2UgPSAiRW1i
        ZXIuSGFuZGxlYmFycyI7CgpFbWJlci5IYW5kbGViYXJzLkphdmFTY3JpcHRD
        b21waWxlci5wcm90b3R5cGUuaW5pdGlhbGl6ZUJ1ZmZlciA9IGZ1bmN0aW9u
        KCkgewogIHJldHVybiAiJyciOwp9OwoKLyoqCiAgQHByaXZhdGUKCiAgT3Zl
        cnJpZGUgdGhlIGRlZmF1bHQgYnVmZmVyIGZvciBFbWJlciBIYW5kbGViYXJz
        LiBCeSBkZWZhdWx0LCBIYW5kbGViYXJzCiAgY3JlYXRlcyBhbiBlbXB0eSBT
        dHJpbmcgYXQgdGhlIGJlZ2lubmluZyBvZiBlYWNoIGludm9jYXRpb24gYW5k
        IGFwcGVuZHMgdG8KICBpdC4gRW1iZXIncyBIYW5kbGViYXJzIG92ZXJyaWRl
        cyB0aGlzIHRvIGFwcGVuZCB0byBhIHNpbmdsZSBzaGFyZWQgYnVmZmVyLgoK
        ICBAbWV0aG9kIGFwcGVuZFRvQnVmZmVyCiAgQHBhcmFtIHN0cmluZyB7U3Ry
        aW5nfQoqLwpFbWJlci5IYW5kbGViYXJzLkphdmFTY3JpcHRDb21waWxlci5w
        cm90b3R5cGUuYXBwZW5kVG9CdWZmZXIgPSBmdW5jdGlvbihzdHJpbmcpIHsK
        ICByZXR1cm4gImRhdGEuYnVmZmVyLnB1c2goIitzdHJpbmcrIik7IjsKfTsK
        CnZhciBwcmVmaXggPSAiZW1iZXIiICsgKCtuZXcgRGF0ZSgpKSwgaW5jciA9
        IDE7CgovKioKICBAcHJpdmF0ZQoKICBSZXdyaXRlIHNpbXBsZSBtdXN0YWNo
        ZXMgZnJvbSBge3tmb299fWAgdG8gYHt7YmluZCAiZm9vIn19YC4gVGhpcyBt
        ZWFucyB0aGF0CiAgYWxsIHNpbXBsZSBtdXN0YWNoZXMgaW4gRW1iZXIncyBI
        YW5kbGViYXJzIHdpbGwgYWxzbyBzZXQgdXAgYW4gb2JzZXJ2ZXIgdG8KICBr
        ZWVwIHRoZSBET00gdXAgdG8gZGF0ZSB3aGVuIHRoZSB1bmRlcmx5aW5nIHBy
        b3BlcnR5IGNoYW5nZXMuCgogIEBtZXRob2QgbXVzdGFjaGUKICBAZm9yIEVt
        YmVyLkhhbmRsZWJhcnMuQ29tcGlsZXIKICBAcGFyYW0gbXVzdGFjaGUKKi8K
        RW1iZXIuSGFuZGxlYmFycy5Db21waWxlci5wcm90b3R5cGUubXVzdGFjaGUg
        PSBmdW5jdGlvbihtdXN0YWNoZSkgewogIGlmIChtdXN0YWNoZS5pc0hlbHBl
        ciAmJiBtdXN0YWNoZS5pZC5zdHJpbmcgPT09ICdjb250cm9sJykgewogICAg
        bXVzdGFjaGUuaGFzaCA9IG11c3RhY2hlLmhhc2ggfHwgbmV3IEhhbmRsZWJh
        cnMuQVNULkhhc2hOb2RlKFtdKTsKICAgIG11c3RhY2hlLmhhc2gucGFpcnMu
        cHVzaChbImNvbnRyb2xJRCIsIG5ldyBIYW5kbGViYXJzLkFTVC5TdHJpbmdO
        b2RlKHByZWZpeCArIGluY3IrKyldKTsKICB9IGVsc2UgaWYgKG11c3RhY2hl
        LnBhcmFtcy5sZW5ndGggfHwgbXVzdGFjaGUuaGFzaCkgewogICAgLy8gbm8g
        Y2hhbmdlcyByZXF1aXJlZAogIH0gZWxzZSB7CiAgICB2YXIgaWQgPSBuZXcg
        SGFuZGxlYmFycy5BU1QuSWROb2RlKFt7IHBhcnQ6ICdfdHJpYWdlTXVzdGFj
        aGUnIH1dKTsKCiAgICAvLyBVcGRhdGUgdGhlIG11c3RhY2hlIG5vZGUgdG8g
        aW5jbHVkZSBhIGhhc2ggdmFsdWUgaW5kaWNhdGluZyB3aGV0aGVyIHRoZSBv
        cmlnaW5hbCBub2RlCiAgICAvLyB3YXMgZXNjYXBlZC4gVGhpcyB3aWxsIGFs
        bG93IHVzIHRvIHByb3Blcmx5IGVzY2FwZSB2YWx1ZXMgd2hlbiB0aGUgdW5k
        ZXJseWluZyB2YWx1ZQogICAgLy8gY2hhbmdlcyBhbmQgd2UgbmVlZCB0byBy
        ZS1yZW5kZXIgdGhlIHZhbHVlLgogICAgaWYgKCFtdXN0YWNoZS5lc2NhcGVk
        KSB7CiAgICAgIG11c3RhY2hlLmhhc2ggPSBtdXN0YWNoZS5oYXNoIHx8IG5l
        dyBIYW5kbGViYXJzLkFTVC5IYXNoTm9kZShbXSk7CiAgICAgIG11c3RhY2hl
        Lmhhc2gucGFpcnMucHVzaChbInVuZXNjYXBlZCIsIG5ldyBIYW5kbGViYXJz
        LkFTVC5TdHJpbmdOb2RlKCJ0cnVlIildKTsKICAgIH0KICAgIG11c3RhY2hl
        ID0gbmV3IEhhbmRsZWJhcnMuQVNULk11c3RhY2hlTm9kZShbaWRdLmNvbmNh
        dChbbXVzdGFjaGUuaWRdKSwgbXVzdGFjaGUuaGFzaCwgIW11c3RhY2hlLmVz
        Y2FwZWQpOwogIH0KCiAgcmV0dXJuIEhhbmRsZWJhcnMuQ29tcGlsZXIucHJv
        dG90eXBlLm11c3RhY2hlLmNhbGwodGhpcywgbXVzdGFjaGUpOwp9OwoKLyoq
        CiAgVXNlZCBmb3IgcHJlY29tcGlsYXRpb24gb2YgRW1iZXIgSGFuZGxlYmFy
        cyB0ZW1wbGF0ZXMuIFRoaXMgd2lsbCBub3QgYmUgdXNlZAogIGR1cmluZyBu
        b3JtYWwgYXBwIGV4ZWN1dGlvbi4KCiAgQG1ldGhvZCBwcmVjb21waWxlCiAg
        QGZvciBFbWJlci5IYW5kbGViYXJzCiAgQHN0YXRpYwogIEBwYXJhbSB7U3Ry
        aW5nfSBzdHJpbmcgVGhlIHRlbXBsYXRlIHRvIHByZWNvbXBpbGUKKi8KRW1i
        ZXIuSGFuZGxlYmFycy5wcmVjb21waWxlID0gZnVuY3Rpb24oc3RyaW5nKSB7
        CiAgdmFyIGFzdCA9IEhhbmRsZWJhcnMucGFyc2Uoc3RyaW5nKTsKCiAgdmFy
        IG9wdGlvbnMgPSB7CiAgICBrbm93bkhlbHBlcnM6IHsKICAgICAgYWN0aW9u
        OiB0cnVlLAogICAgICB1bmJvdW5kOiB0cnVlLAogICAgICBiaW5kQXR0cjog
        dHJ1ZSwKICAgICAgdGVtcGxhdGU6IHRydWUsCiAgICAgIHZpZXc6IHRydWUs
        CiAgICAgIF90cmlhZ2VNdXN0YWNoZTogdHJ1ZQogICAgfSwKICAgIGRhdGE6
        IHRydWUsCiAgICBzdHJpbmdQYXJhbXM6IHRydWUKICB9OwoKICB2YXIgZW52
        aXJvbm1lbnQgPSBuZXcgRW1iZXIuSGFuZGxlYmFycy5Db21waWxlcigpLmNv
        bXBpbGUoYXN0LCBvcHRpb25zKTsKICByZXR1cm4gbmV3IEVtYmVyLkhhbmRs
        ZWJhcnMuSmF2YVNjcmlwdENvbXBpbGVyKCkuY29tcGlsZShlbnZpcm9ubWVu
        dCwgb3B0aW9ucywgdW5kZWZpbmVkLCB0cnVlKTsKfTsKCi8vIFdlIGRvbid0
        IHN1cHBvcnQgdGhpcyBmb3IgSGFuZGxlYmFycyBydW50aW1lLW9ubHkKaWYg
        KEhhbmRsZWJhcnMuY29tcGlsZSkgewogIC8qKgogICAgVGhlIGVudHJ5IHBv
        aW50IGZvciBFbWJlciBIYW5kbGViYXJzLiBUaGlzIHJlcGxhY2VzIHRoZSBk
        ZWZhdWx0CiAgICBgSGFuZGxlYmFycy5jb21waWxlYCBhbmQgdHVybnMgb24g
        dGVtcGxhdGUtbG9jYWwgZGF0YSBhbmQgU3RyaW5nCiAgICBwYXJhbWV0ZXJz
        LgoKICAgIEBtZXRob2QgY29tcGlsZQogICAgQGZvciBFbWJlci5IYW5kbGVi
        YXJzCiAgICBAc3RhdGljCiAgICBAcGFyYW0ge1N0cmluZ30gc3RyaW5nIFRo
        ZSB0ZW1wbGF0ZSB0byBjb21waWxlCiAgICBAcmV0dXJuIHtGdW5jdGlvbn0K
        ICAqLwogIEVtYmVyLkhhbmRsZWJhcnMuY29tcGlsZSA9IGZ1bmN0aW9uKHN0
        cmluZykgewogICAgdmFyIGFzdCA9IEhhbmRsZWJhcnMucGFyc2Uoc3RyaW5n
        KTsKICAgIHZhciBvcHRpb25zID0geyBkYXRhOiB0cnVlLCBzdHJpbmdQYXJh
        bXM6IHRydWUgfTsKICAgIHZhciBlbnZpcm9ubWVudCA9IG5ldyBFbWJlci5I
        YW5kbGViYXJzLkNvbXBpbGVyKCkuY29tcGlsZShhc3QsIG9wdGlvbnMpOwog
        ICAgdmFyIHRlbXBsYXRlU3BlYyA9IG5ldyBFbWJlci5IYW5kbGViYXJzLkph
        dmFTY3JpcHRDb21waWxlcigpLmNvbXBpbGUoZW52aXJvbm1lbnQsIG9wdGlv
        bnMsIHVuZGVmaW5lZCwgdHJ1ZSk7CgogICAgdmFyIHRlbXBsYXRlID0gRW1i
        ZXIuSGFuZGxlYmFycy50ZW1wbGF0ZSh0ZW1wbGF0ZVNwZWMpOwogICAgdGVt
        cGxhdGUuaXNNZXRob2QgPSBmYWxzZTsgLy9NYWtlIHN1cmUgd2UgZG9uJ3Qg
        d3JhcCB0ZW1wbGF0ZXMgd2l0aCAuX3N1cGVyCgogICAgcmV0dXJuIHRlbXBs
        YXRlOwogIH07Cn0KCgp9KSgpOwoKKGZ1bmN0aW9uKCkgewp2YXIgc2xpY2Ug
        PSBBcnJheS5wcm90b3R5cGUuc2xpY2U7CgovKioKICBAcHJpdmF0ZQoKICBJ
        ZiBhIHBhdGggc3RhcnRzIHdpdGggYSByZXNlcnZlZCBrZXl3b3JkLCByZXR1
        cm5zIHRoZSByb290CiAgdGhhdCBzaG91bGQgYmUgdXNlZC4KCiAgQG1ldGhv
        ZCBub3JtYWxpemVQYXRoCiAgQGZvciBFbWJlcgogIEBwYXJhbSByb290IHtP
        YmplY3R9CiAgQHBhcmFtIHBhdGgge1N0cmluZ30KICBAcGFyYW0gZGF0YSB7
        SGFzaH0KKi8KdmFyIG5vcm1hbGl6ZVBhdGggPSBFbWJlci5IYW5kbGViYXJz
        Lm5vcm1hbGl6ZVBhdGggPSBmdW5jdGlvbihyb290LCBwYXRoLCBkYXRhKSB7
        CiAgdmFyIGtleXdvcmRzID0gKGRhdGEgJiYgZGF0YS5rZXl3b3JkcykgfHwg
        e30sCiAgICAgIGtleXdvcmQsIGlzS2V5d29yZDsKCiAgLy8gR2V0IHRoZSBm
        aXJzdCBzZWdtZW50IG9mIHRoZSBwYXRoLiBGb3IgZXhhbXBsZSwgaWYgdGhl
        CiAgLy8gcGF0aCBpcyAiZm9vLmJhci5iYXoiLCByZXR1cm5zICJmb28iLgog
        IGtleXdvcmQgPSBwYXRoLnNwbGl0KCcuJywgMSlbMF07CgogIC8vIFRlc3Qg
        dG8gc2VlIGlmIHRoZSBmaXJzdCBwYXRoIGlzIGEga2V5d29yZCB0aGF0IGhh
        cyBiZWVuCiAgLy8gcGFzc2VkIGFsb25nIGluIHRoZSB2aWV3J3MgZGF0YSBo
        YXNoLiBJZiBzbywgd2Ugd2lsbCB0cmVhdAogIC8vIHRoYXQgb2JqZWN0IGFz
        IHRoZSBuZXcgcm9vdC4KICBpZiAoa2V5d29yZHMuaGFzT3duUHJvcGVydHko
        a2V5d29yZCkpIHsKICAgIC8vIExvb2sgdXAgdGhlIHZhbHVlIGluIHRoZSB0
        ZW1wbGF0ZSdzIGRhdGEgaGFzaC4KICAgIHJvb3QgPSBrZXl3b3Jkc1trZXl3
        b3JkXTsKICAgIGlzS2V5d29yZCA9IHRydWU7CgogICAgLy8gSGFuZGxlIGNh
        c2VzIHdoZXJlIHRoZSBlbnRpcmUgcGF0aCBpcyB0aGUgcmVzZXJ2ZWQKICAg
        IC8vIHdvcmQuIEluIHRoYXQgY2FzZSwgcmV0dXJuIHRoZSBvYmplY3QgaXRz
        ZWxmLgogICAgaWYgKHBhdGggPT09IGtleXdvcmQpIHsKICAgICAgcGF0aCA9
        ICcnOwogICAgfSBlbHNlIHsKICAgICAgLy8gU3RyaXAgdGhlIGtleXdvcmQg
        ZnJvbSB0aGUgcGF0aCBhbmQgbG9vayB1cAogICAgICAvLyB0aGUgcmVtYWlu
        ZGVyIGZyb20gdGhlIG5ld2x5IGZvdW5kIHJvb3QuCiAgICAgIHBhdGggPSBw
        YXRoLnN1YnN0cihrZXl3b3JkLmxlbmd0aCsxKTsKICAgIH0KICB9CgogIHJl
        dHVybiB7IHJvb3Q6IHJvb3QsIHBhdGg6IHBhdGgsIGlzS2V5d29yZDogaXNL
        ZXl3b3JkIH07Cn07CgoKLyoqCiAgTG9va3VwIGJvdGggb24gcm9vdCBhbmQg
        b24gd2luZG93LiBJZiB0aGUgcGF0aCBzdGFydHMgd2l0aAogIGEga2V5d29y
        ZCwgdGhlIGNvcnJlc3BvbmRpbmcgb2JqZWN0IHdpbGwgYmUgbG9va2VkIHVw
        IGluIHRoZQogIHRlbXBsYXRlJ3MgZGF0YSBoYXNoIGFuZCB1c2VkIHRvIHJl
        c29sdmUgdGhlIHBhdGguCgogIEBtZXRob2QgZ2V0CiAgQGZvciBFbWJlci5I
        YW5kbGViYXJzCiAgQHBhcmFtIHtPYmplY3R9IHJvb3QgVGhlIG9iamVjdCB0
        byBsb29rIHVwIHRoZSBwcm9wZXJ0eSBvbgogIEBwYXJhbSB7U3RyaW5nfSBw
        YXRoIFRoZSBwYXRoIHRvIGJlIGxvb2tlZHVwCiAgQHBhcmFtIHtPYmplY3R9
        IG9wdGlvbnMgVGhlIHRlbXBsYXRlJ3Mgb3B0aW9uIGhhc2gKKi8KdmFyIGhh
        bmRsZWJhcnNHZXQgPSBFbWJlci5IYW5kbGViYXJzLmdldCA9IGZ1bmN0aW9u
        KHJvb3QsIHBhdGgsIG9wdGlvbnMpIHsKICB2YXIgZGF0YSA9IG9wdGlvbnMg
        JiYgb3B0aW9ucy5kYXRhLAogICAgICBub3JtYWxpemVkUGF0aCA9IG5vcm1h
        bGl6ZVBhdGgocm9vdCwgcGF0aCwgZGF0YSksCiAgICAgIHZhbHVlOwoKICAv
        LyBJbiBjYXNlcyB3aGVyZSB0aGUgcGF0aCBiZWdpbnMgd2l0aCBhIGtleXdv
        cmQsIGNoYW5nZSB0aGUKICAvLyByb290IHRvIHRoZSB2YWx1ZSByZXByZXNl
        bnRlZCBieSB0aGF0IGtleXdvcmQsIGFuZCBlbnN1cmUKICAvLyB0aGUgcGF0
        aCBpcyByZWxhdGl2ZSB0byBpdC4KICByb290ID0gbm9ybWFsaXplZFBhdGgu
        cm9vdDsKICBwYXRoID0gbm9ybWFsaXplZFBhdGgucGF0aDsKCiAgdmFsdWUg
        PSBFbWJlci5nZXQocm9vdCwgcGF0aCk7CgogIC8vIElmIHRoZSBwYXRoIHN0
        YXJ0cyB3aXRoIGEgY2FwaXRhbCBsZXR0ZXIsIGxvb2sgaXQgdXAgb24gRW1i
        ZXIubG9va3VwLAogIC8vIHdoaWNoIGRlZmF1bHRzIHRvIHRoZSBgd2luZG93
        YCBvYmplY3QgaW4gYnJvd3NlcnMuCiAgaWYgKHZhbHVlID09PSB1bmRlZmlu
        ZWQgJiYgcm9vdCAhPT0gRW1iZXIubG9va3VwICYmIEVtYmVyLmlzR2xvYmFs
        UGF0aChwYXRoKSkgewogICAgdmFsdWUgPSBFbWJlci5nZXQoRW1iZXIubG9v
        a3VwLCBwYXRoKTsKICB9CiAgcmV0dXJuIHZhbHVlOwp9OwpFbWJlci5IYW5k
        bGViYXJzLmdldFBhdGggPSBFbWJlci5kZXByZWNhdGVGdW5jKCdgRW1iZXIu
        SGFuZGxlYmFycy5nZXRQYXRoYCBoYXMgYmVlbiBjaGFuZ2VkIHRvIGBFbWJl
        ci5IYW5kbGViYXJzLmdldGAgZm9yIGNvbnNpc3RlbmN5LicsIEVtYmVyLkhh
        bmRsZWJhcnMuZ2V0KTsKCkVtYmVyLkhhbmRsZWJhcnMucmVzb2x2ZVBhcmFt
        cyA9IGZ1bmN0aW9uKGNvbnRleHQsIHBhcmFtcywgb3B0aW9ucykgewogIHZh
        ciByZXNvbHZlZFBhcmFtcyA9IFtdLCB0eXBlcyA9IG9wdGlvbnMudHlwZXMs
        IHBhcmFtLCB0eXBlOwoKICBmb3IgKHZhciBpPTAsIGw9cGFyYW1zLmxlbmd0
        aDsgaTxsOyBpKyspIHsKICAgIHBhcmFtID0gcGFyYW1zW2ldOwogICAgdHlw
        ZSA9IHR5cGVzW2ldOwoKICAgIGlmICh0eXBlID09PSAnSUQnKSB7CiAgICAg
        IHJlc29sdmVkUGFyYW1zLnB1c2goaGFuZGxlYmFyc0dldChjb250ZXh0LCBw
        YXJhbSwgb3B0aW9ucykpOwogICAgfSBlbHNlIHsKICAgICAgcmVzb2x2ZWRQ
        YXJhbXMucHVzaChwYXJhbSk7CiAgICB9CiAgfQoKICByZXR1cm4gcmVzb2x2
        ZWRQYXJhbXM7Cn07CgpFbWJlci5IYW5kbGViYXJzLnJlc29sdmVIYXNoID0g
        ZnVuY3Rpb24oY29udGV4dCwgaGFzaCwgb3B0aW9ucykgewogIHZhciByZXNv
        bHZlZEhhc2ggPSB7fSwgdHlwZXMgPSBvcHRpb25zLmhhc2hUeXBlcywgdHlw
        ZTsKCiAgZm9yICh2YXIga2V5IGluIGhhc2gpIHsKICAgIGlmICghaGFzaC5o
        YXNPd25Qcm9wZXJ0eShrZXkpKSB7IGNvbnRpbnVlOyB9CgogICAgdHlwZSA9
        IHR5cGVzW2tleV07CgogICAgaWYgKHR5cGUgPT09ICdJRCcpIHsKICAgICAg
        cmVzb2x2ZWRIYXNoW2tleV0gPSBoYW5kbGViYXJzR2V0KGNvbnRleHQsIGhh
        c2hba2V5XSwgb3B0aW9ucyk7CiAgICB9IGVsc2UgewogICAgICByZXNvbHZl
        ZEhhc2hba2V5XSA9IGhhc2hba2V5XTsKICAgIH0KICB9CgogIHJldHVybiBy
        ZXNvbHZlZEhhc2g7Cn07CgovKioKICBAcHJpdmF0ZQoKICBSZWdpc3RlcnMg
        YSBoZWxwZXIgaW4gSGFuZGxlYmFycyB0aGF0IHdpbGwgYmUgY2FsbGVkIGlm
        IG5vIHByb3BlcnR5IHdpdGggdGhlCiAgZ2l2ZW4gbmFtZSBjYW4gYmUgZm91
        bmQgb24gdGhlIGN1cnJlbnQgY29udGV4dCBvYmplY3QsIGFuZCBubyBoZWxw
        ZXIgd2l0aAogIHRoYXQgbmFtZSBpcyByZWdpc3RlcmVkLgoKICBUaGlzIHRo
        cm93cyBhbiBleGNlcHRpb24gd2l0aCBhIG1vcmUgaGVscGZ1bCBlcnJvciBt
        ZXNzYWdlIHNvIHRoZSB1c2VyIGNhbgogIHRyYWNrIGRvd24gd2hlcmUgdGhl
        IHByb2JsZW0gaXMgaGFwcGVuaW5nLgoKICBAbWV0aG9kIGhlbHBlck1pc3Np
        bmcKICBAZm9yIEVtYmVyLkhhbmRsZWJhcnMuaGVscGVycwogIEBwYXJhbSB7
        U3RyaW5nfSBwYXRoCiAgQHBhcmFtIHtIYXNofSBvcHRpb25zCiovCkVtYmVy
        LkhhbmRsZWJhcnMucmVnaXN0ZXJIZWxwZXIoJ2hlbHBlck1pc3NpbmcnLCBm
        dW5jdGlvbihwYXRoLCBvcHRpb25zKSB7CiAgdmFyIGVycm9yLCB2aWV3ID0g
        IiI7CgogIGVycm9yID0gIiVAIEhhbmRsZWJhcnMgZXJyb3I6IENvdWxkIG5v
        dCBmaW5kIHByb3BlcnR5ICclQCcgb24gb2JqZWN0ICVALiI7CiAgaWYgKG9w
        dGlvbnMuZGF0YSkgewogICAgdmlldyA9IG9wdGlvbnMuZGF0YS52aWV3Owog
        IH0KICB0aHJvdyBuZXcgRW1iZXIuRXJyb3IoRW1iZXIuU3RyaW5nLmZtdChl
        cnJvciwgW3ZpZXcsIHBhdGgsIHRoaXNdKSk7Cn0pOwoKLyoqCiAgUmVnaXN0
        ZXIgYSBib3VuZCBoYW5kbGViYXJzIGhlbHBlci4gQm91bmQgaGVscGVycyBi
        ZWhhdmUgc2ltaWxhcmx5IHRvIHJlZ3VsYXIKICBoYW5kbGViYXJzIGhlbHBl
        cnMsIHdpdGggdGhlIGFkZGVkIGFiaWxpdHkgdG8gcmUtcmVuZGVyIHdoZW4g
        dGhlIHVuZGVybHlpbmcgZGF0YQogIGNoYW5nZXMuCgogICMjIFNpbXBsZSBl
        eGFtcGxlCgogIGBgYGphdmFzY3JpcHQKICBFbWJlci5IYW5kbGViYXJzLnJl
        Z2lzdGVyQm91bmRIZWxwZXIoJ2NhcGl0YWxpemUnLCBmdW5jdGlvbih2YWx1
        ZSkgewogICAgcmV0dXJuIHZhbHVlLnRvVXBwZXJDYXNlKCk7CiAgfSk7CiAg
        YGBgCgogIFRoZSBhYm92ZSBib3VuZCBoZWxwZXIgY2FuIGJlIHVzZWQgaW5z
        aWRlIG9mIHRlbXBsYXRlcyBhcyBmb2xsb3dzOgoKICBgYGBoYW5kbGViYXJz
        CiAge3tjYXBpdGFsaXplIG5hbWV9fQogIGBgYAoKICBJbiB0aGlzIGNhc2Us
        IHdoZW4gdGhlIGBuYW1lYCBwcm9wZXJ0eSBvZiB0aGUgdGVtcGxhdGUncyBj
        b250ZXh0IGNoYW5nZXMsCiAgdGhlIHJlbmRlcmVkIHZhbHVlIG9mIHRoZSBo
        ZWxwZXIgd2lsbCB1cGRhdGUgdG8gcmVmbGVjdCB0aGlzIGNoYW5nZS4KCiAg
        IyMgRXhhbXBsZSB3aXRoIG9wdGlvbnMKCiAgTGlrZSBub3JtYWwgaGFuZGxl
        YmFycyBoZWxwZXJzLCBib3VuZCBoZWxwZXJzIGhhdmUgYWNjZXNzIHRvIHRo
        ZSBvcHRpb25zCiAgcGFzc2VkIGludG8gdGhlIGhlbHBlciBjYWxsLgoKICBg
        YGBqYXZhc2NyaXB0CiAgRW1iZXIuSGFuZGxlYmFycy5yZWdpc3RlckJvdW5k
        SGVscGVyKCdyZXBlYXQnLCBmdW5jdGlvbih2YWx1ZSwgb3B0aW9ucykgewog
        ICAgdmFyIGNvdW50ID0gb3B0aW9ucy5oYXNoLmNvdW50OwogICAgdmFyIGEg
        PSBbXTsKICAgIHdoaWxlKGEubGVuZ3RoIDwgY291bnQpIHsKICAgICAgICBh
        LnB1c2godmFsdWUpOwogICAgfQogICAgcmV0dXJuIGEuam9pbignJyk7CiAg
        fSk7CiAgYGBgCgogIFRoaXMgaGVscGVyIGNvdWxkIGJlIHVzZWQgaW4gYSB0
        ZW1wbGF0ZSBhcyBmb2xsb3dzOgoKICBgYGBoYW5kbGViYXJzCiAge3tyZXBl
        YXQgdGV4dCBjb3VudD0zfX0KICBgYGAKCiAgIyMgRXhhbXBsZSB3aXRoIGJv
        dW5kIG9wdGlvbnMKCiAgQm91bmQgaGFzaCBvcHRpb25zIGFyZSBhbHNvIHN1
        cHBvcnRlZC4gRXhhbXBsZToKCiAgYGBgaGFuZGxlYmFycwogIHt7cmVwZWF0
        IHRleHQgY291bnRCaW5kaW5nPSJudW1SZXBlYXRzIn19CiAgYGBgCgogIElu
        IHRoaXMgZXhhbXBsZSwgY291bnQgd2lsbCBiZSBib3VuZCB0byB0aGUgdmFs
        dWUgb2YKICB0aGUgYG51bVJlcGVhdHNgIHByb3BlcnR5IG9uIHRoZSBjb250
        ZXh0LiBJZiB0aGF0IHByb3BlcnR5CiAgY2hhbmdlcywgdGhlIGhlbHBlciB3
        aWxsIGJlIHJlLXJlbmRlcmVkLgoKICAjIyBFeGFtcGxlIHdpdGggZXh0cmEg
        ZGVwZW5kZW5jaWVzCgogIFRoZSBgRW1iZXIuSGFuZGxlYmFycy5yZWdpc3Rl
        ckJvdW5kSGVscGVyYCBtZXRob2QgdGFrZXMgYSB2YXJpYWJsZSBsZW5ndGgK
        ICB0aGlyZCBwYXJhbWV0ZXIgd2hpY2ggaW5kaWNhdGVzIGV4dHJhIGRlcGVu
        ZGVuY2llcyBvbiB0aGUgcGFzc2VkIGluIHZhbHVlLgogIFRoaXMgYWxsb3dz
        IHRoZSBoYW5kbGViYXJzIGhlbHBlciB0byB1cGRhdGUgd2hlbiB0aGVzZSBk
        ZXBlbmRlbmNpZXMgY2hhbmdlLgoKICBgYGBqYXZhc2NyaXB0CiAgRW1iZXIu
        SGFuZGxlYmFycy5yZWdpc3RlckJvdW5kSGVscGVyKCdjYXBpdGFsaXplTmFt
        ZScsIGZ1bmN0aW9uKHZhbHVlKSB7CiAgICByZXR1cm4gdmFsdWUuZ2V0KCdu
        YW1lJykudG9VcHBlckNhc2UoKTsKICB9LCAnbmFtZScpOwogIGBgYAoKICAj
        IyBFeGFtcGxlIHdpdGggbXVsdGlwbGUgYm91bmQgcHJvcGVydGllcwoKICBg
        RW1iZXIuSGFuZGxlYmFycy5yZWdpc3RlckJvdW5kSGVscGVyYCBzdXBwb3J0
        cyBiaW5kaW5nIHRvCiAgbXVsdGlwbGUgcHJvcGVydGllcywgZS5nLjoKCiAg
        YGBgamF2YXNjcmlwdAogIEVtYmVyLkhhbmRsZWJhcnMucmVnaXN0ZXJCb3Vu
        ZEhlbHBlcignY29uY2F0ZW5hdGUnLCBmdW5jdGlvbigpIHsKICAgIHZhciB2
        YWx1ZXMgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMs
        IDAsIC0xKTsKICAgIHJldHVybiB2YWx1ZXMuam9pbignfHwnKTsKICB9KTsK
        ICBgYGAKCiAgV2hpY2ggYWxsb3dzIGZvciB0ZW1wbGF0ZSBzeW50YXggc3Vj
        aCBhcyBge3tjb25jYXRlbmF0ZSBwcm9wMSBwcm9wMn19YCBvcgogIGB7e2Nv
        bmNhdGVuYXRlIHByb3AxIHByb3AyIHByb3AzfX1gLiBJZiBhbnkgb2YgdGhl
        IHByb3BlcnRpZXMgY2hhbmdlLAogIHRoZSBoZWxwciB3aWxsIHJlLXJlbmRl
        ci4gIE5vdGUgdGhhdCBkZXBlbmRlbmN5IGtleXMgY2Fubm90IGJlCiAgdXNp
        bmcgaW4gY29uanVuY3Rpb24gd2l0aCBtdWx0aS1wcm9wZXJ0eSBoZWxwZXJz
        LCBzaW5jZSBpdCBpcyBhbWJpZ3VvdXMKICB3aGljaCBwcm9wZXJ0eSB0aGUg
        ZGVwZW5kZW50IGtleXMgd291bGQgYmVsb25nIHRvLgoKICAjIyBVc2Ugd2l0
        aCB1bmJvdW5kIGhlbHBlcgoKICBUaGUgYHt7dW5ib3VuZH19YCBoZWxwZXIg
        Y2FuIGJlIHVzZWQgd2l0aCBib3VuZCBoZWxwZXIgaW52b2NhdGlvbnMKICB0
        byByZW5kZXIgdGhlbSBpbiB0aGVpciB1bmJvdW5kIGZvcm0sIGUuZy4KCiAg
        YGBgaGFuZGxlYmFycwogIHt7dW5ib3VuZCBjYXBpdGFsaXplIG5hbWV9fQog
        IGBgYAoKICBJbiB0aGlzIGV4YW1wbGUsIGlmIHRoZSBuYW1lIHByb3BlcnR5
        IGNoYW5nZXMsIHRoZSBoZWxwZXIKICB3aWxsIG5vdCByZS1yZW5kZXIuCgog
        ICMjIFVzZSB3aXRoIGJsb2NrcyBub3Qgc3VwcG9ydGVkCgogIEJvdW5kIGhl
        bHBlcnMgZG8gbm90IHN1cHBvcnQgdXNlIHdpdGggSGFuZGxlYmFycyBibG9j
        a3Mgb3IKICB0aGUgYWRkaXRpb24gb2YgY2hpbGQgdmlld3Mgb2YgYW55IGtp
        bmQuCgogIEBtZXRob2QgcmVnaXN0ZXJCb3VuZEhlbHBlcgogIEBmb3IgRW1i
        ZXIuSGFuZGxlYmFycwogIEBwYXJhbSB7U3RyaW5nfSBuYW1lCiAgQHBhcmFt
        IHtGdW5jdGlvbn0gZnVuY3Rpb24KICBAcGFyYW0ge1N0cmluZ30gZGVwZW5k
        ZW50S2V5cyoKKi8KRW1iZXIuSGFuZGxlYmFycy5yZWdpc3RlckJvdW5kSGVs
        cGVyID0gZnVuY3Rpb24obmFtZSwgZm4pIHsKICB2YXIgZGVwZW5kZW50S2V5
        cyA9IHNsaWNlLmNhbGwoYXJndW1lbnRzLCAyKTsKCiAgZnVuY3Rpb24gaGVs
        cGVyKCkgewogICAgdmFyIHByb3BlcnRpZXMgPSBzbGljZS5jYWxsKGFyZ3Vt
        ZW50cywgMCwgLTEpLAogICAgICBudW1Qcm9wZXJ0aWVzID0gcHJvcGVydGll
        cy5sZW5ndGgsCiAgICAgIG9wdGlvbnMgPSBhcmd1bWVudHNbYXJndW1lbnRz
        Lmxlbmd0aCAtIDFdLAogICAgICBub3JtYWxpemVkUHJvcGVydGllcyA9IFtd
        LAogICAgICB0eXBlcyA9IG9wdGlvbnMudHlwZXMsCiAgICAgIGRhdGEgPSBv
        cHRpb25zLmRhdGEsCiAgICAgIGhhc2ggPSBvcHRpb25zLmhhc2gsCiAgICAg
        IHZpZXcgPSBkYXRhLnZpZXcsCiAgICAgIGNvbnRleHRzID0gb3B0aW9ucy5j
        b250ZXh0cywKICAgICAgY3VycmVudENvbnRleHQgPSAoY29udGV4dHMgJiYg
        Y29udGV4dHMubGVuZ3RoKSA/IGNvbnRleHRzWzBdIDogdGhpcywKICAgICAg
        cHJlZml4UGF0aEZvckRlcGVuZGVudEtleXMgPSAnJywKICAgICAgbG9jLCBs
        ZW4sIGhhc2hPcHRpb24sCiAgICAgIGJvdW5kT3B0aW9uLCBwcm9wZXJ0eSwK
        ICAgICAgbm9ybWFsaXplZFZhbHVlID0gRW1iZXIuX1NpbXBsZUhhbmRsZWJh
        cnNWaWV3LnByb3RvdHlwZS5ub3JtYWxpemVkVmFsdWU7CgogICAgRW1iZXIu
        YXNzZXJ0KCJyZWdpc3RlckJvdW5kSGVscGVyLWdlbmVyYXRlZCBoZWxwZXJz
        IGRvIG5vdCBzdXBwb3J0IHVzZSB3aXRoIEhhbmRsZWJhcnMgYmxvY2tzLiIs
        ICFvcHRpb25zLmZuKTsKCiAgICAvLyBEZXRlY3QgYm91bmQgb3B0aW9ucyAo
        ZS5nLiBjb3VudEJpbmRpbmc9Im90aGVyQ291bnQiKQogICAgdmFyIGJvdW5k
        T3B0aW9ucyA9IGhhc2guYm91bmRPcHRpb25zID0ge307CiAgICBmb3IgKGhh
        c2hPcHRpb24gaW4gaGFzaCkgewogICAgICBpZiAoRW1iZXIuSVNfQklORElO
        Ry50ZXN0KGhhc2hPcHRpb24pKSB7CiAgICAgICAgLy8gTG9wIG9mZiAnQmlu
        ZGluZycgc3VmZml4LgogICAgICAgIGJvdW5kT3B0aW9uc1toYXNoT3B0aW9u
        LnNsaWNlKDAsIC03KV0gPSBoYXNoW2hhc2hPcHRpb25dOwogICAgICB9CiAg
        ICB9CgogICAgLy8gRXhwb3NlIHByb3BlcnR5IG5hbWVzIG9uIGRhdGEucHJv
        cGVydGllcyBvYmplY3QuCiAgICB2YXIgd2F0Y2hlZFByb3BlcnRpZXMgPSBb
        XTsKICAgIGRhdGEucHJvcGVydGllcyA9IFtdOwogICAgZm9yIChsb2MgPSAw
        OyBsb2MgPCBudW1Qcm9wZXJ0aWVzOyArK2xvYykgewogICAgICBkYXRhLnBy
        b3BlcnRpZXMucHVzaChwcm9wZXJ0aWVzW2xvY10pOwogICAgICBpZiAodHlw
        ZXNbbG9jXSA9PT0gJ0lEJykgewogICAgICAgIHZhciBub3JtYWxpemVkUHJv
        cCA9IG5vcm1hbGl6ZVBhdGgoY3VycmVudENvbnRleHQsIHByb3BlcnRpZXNb
        bG9jXSwgZGF0YSk7CiAgICAgICAgbm9ybWFsaXplZFByb3BlcnRpZXMucHVz
        aChub3JtYWxpemVkUHJvcCk7CiAgICAgICAgd2F0Y2hlZFByb3BlcnRpZXMu
        cHVzaChub3JtYWxpemVkUHJvcCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAg
        bm9ybWFsaXplZFByb3BlcnRpZXMucHVzaChudWxsKTsKICAgICAgfQogICAg
        fQoKICAgIC8vIEhhbmRsZSBjYXNlIHdoZW4gaGVscGVyIGludm9jYXRpb24g
        aXMgcHJlY2VkZWQgYnkgYHVuYm91bmRgLCBlLmcuCiAgICAvLyB7e3VuYm91
        bmQgbXlIZWxwZXIgZm9vfX0KICAgIGlmIChkYXRhLmlzVW5ib3VuZCkgewog
        ICAgICByZXR1cm4gZXZhbHVhdGVVbmJvdW5kSGVscGVyKHRoaXMsIGZuLCBu
        b3JtYWxpemVkUHJvcGVydGllcywgb3B0aW9ucyk7CiAgICB9CgogICAgdmFy
        IGJpbmRWaWV3ID0gbmV3IEVtYmVyLl9TaW1wbGVIYW5kbGViYXJzVmlldyhu
        dWxsLCBudWxsLCAhb3B0aW9ucy5oYXNoLnVuZXNjYXBlZCwgb3B0aW9ucy5k
        YXRhKTsKCiAgICAvLyBPdmVycmlkZSBTaW1wbGVIYW5kbGViYXJzVmlldydz
        IG1ldGhvZCBmb3IgZ2VuZXJhdGluZyB0aGUgdmlldydzIGNvbnRlbnQuCiAg
        ICBiaW5kVmlldy5ub3JtYWxpemVkVmFsdWUgPSBmdW5jdGlvbigpIHsKICAg
        ICAgdmFyIGFyZ3MgPSBbXSwgYm91bmRPcHRpb247CgogICAgICAvLyBDb3B5
        IG92ZXIgYm91bmQgaGFzaCBvcHRpb25zLgogICAgICBmb3IgKGJvdW5kT3B0
        aW9uIGluIGJvdW5kT3B0aW9ucykgewogICAgICAgIGlmICghYm91bmRPcHRp
        b25zLmhhc093blByb3BlcnR5KGJvdW5kT3B0aW9uKSkgeyBjb250aW51ZTsg
        fQogICAgICAgIHByb3BlcnR5ID0gbm9ybWFsaXplUGF0aChjdXJyZW50Q29u
        dGV4dCwgYm91bmRPcHRpb25zW2JvdW5kT3B0aW9uXSwgZGF0YSk7CiAgICAg
        ICAgYmluZFZpZXcucGF0aCA9IHByb3BlcnR5LnBhdGg7CiAgICAgICAgYmlu
        ZFZpZXcucGF0aFJvb3QgPSBwcm9wZXJ0eS5yb290OwogICAgICAgIGhhc2hb
        Ym91bmRPcHRpb25dID0gbm9ybWFsaXplZFZhbHVlLmNhbGwoYmluZFZpZXcp
        OwogICAgICB9CgogICAgICBmb3IgKGxvYyA9IDA7IGxvYyA8IG51bVByb3Bl
        cnRpZXM7ICsrbG9jKSB7CiAgICAgICAgcHJvcGVydHkgPSBub3JtYWxpemVk
        UHJvcGVydGllc1tsb2NdOwogICAgICAgIGlmIChwcm9wZXJ0eSkgewogICAg
        ICAgICAgYmluZFZpZXcucGF0aCA9IHByb3BlcnR5LnBhdGg7CiAgICAgICAg
        ICBiaW5kVmlldy5wYXRoUm9vdCA9IHByb3BlcnR5LnJvb3Q7CiAgICAgICAg
        ICBhcmdzLnB1c2gobm9ybWFsaXplZFZhbHVlLmNhbGwoYmluZFZpZXcpKTsK
        ICAgICAgICB9IGVsc2UgewogICAgICAgICAgYXJncy5wdXNoKHByb3BlcnRp
        ZXNbbG9jXSk7CiAgICAgICAgfQogICAgICB9CiAgICAgIGFyZ3MucHVzaChv
        cHRpb25zKTsKCiAgICAgIC8vIFJ1biB0aGUgc3VwcGxpZWQgaGVscGVyIGZ1
        bmN0aW9uLgogICAgICByZXR1cm4gZm4uYXBwbHkoY3VycmVudENvbnRleHQs
        IGFyZ3MpOwogICAgfTsKCiAgICB2aWV3LmFwcGVuZENoaWxkKGJpbmRWaWV3
        KTsKCiAgICAvLyBBc3NlbWJsZSBsaXN0IG9mIHdhdGNoZWQgcHJvcGVydGll
        cyB0aGF0J2xsIHJlLXJlbmRlciB0aGlzIGhlbHBlci4KICAgIGZvciAoYm91
        bmRPcHRpb24gaW4gYm91bmRPcHRpb25zKSB7CiAgICAgIGlmIChib3VuZE9w
        dGlvbnMuaGFzT3duUHJvcGVydHkoYm91bmRPcHRpb24pKSB7CiAgICAgICAg
        d2F0Y2hlZFByb3BlcnRpZXMucHVzaChub3JtYWxpemVQYXRoKGN1cnJlbnRD
        b250ZXh0LCBib3VuZE9wdGlvbnNbYm91bmRPcHRpb25dLCBkYXRhKSk7CiAg
        ICAgIH0KICAgIH0KCiAgICAvLyBPYnNlcnZlIGVhY2ggcHJvcGVydHkuCiAg
        ICBmb3IgKGxvYyA9IDAsIGxlbiA9IHdhdGNoZWRQcm9wZXJ0aWVzLmxlbmd0
        aDsgbG9jIDwgbGVuOyArK2xvYykgewogICAgICBwcm9wZXJ0eSA9IHdhdGNo
        ZWRQcm9wZXJ0aWVzW2xvY107CiAgICAgIHZpZXcucmVnaXN0ZXJPYnNlcnZl
        cihwcm9wZXJ0eS5yb290LCBwcm9wZXJ0eS5wYXRoLCBiaW5kVmlldywgYmlu
        ZFZpZXcucmVyZW5kZXIpOwogICAgfQoKICAgIGlmICh0eXBlc1swXSAhPT0g
        J0lEJyB8fCBub3JtYWxpemVkUHJvcGVydGllcy5sZW5ndGggPT09IDApIHsK
        ICAgICAgcmV0dXJuOwogICAgfQoKICAgIC8vIEFkZCBkZXBlbmRlbnQga2V5
        IG9ic2VydmVycyB0byB0aGUgZmlyc3QgcGFyYW0KICAgIHZhciBub3JtYWxp
        emVkID0gbm9ybWFsaXplZFByb3BlcnRpZXNbMF0sCiAgICAgICAgcGF0aFJv
        b3QgPSBub3JtYWxpemVkLnJvb3QsCiAgICAgICAgcGF0aCA9IG5vcm1hbGl6
        ZWQucGF0aDsKCiAgICBpZighRW1iZXIuaXNFbXB0eShwYXRoKSkgewogICAg
        ICBwcmVmaXhQYXRoRm9yRGVwZW5kZW50S2V5cyA9IHBhdGggKyAnLic7CiAg
        ICB9CiAgICBmb3IgKHZhciBpPTAsIGw9ZGVwZW5kZW50S2V5cy5sZW5ndGg7
        IGk8bDsgaSsrKSB7CiAgICAgIHZpZXcucmVnaXN0ZXJPYnNlcnZlcihwYXRo
        Um9vdCwgcHJlZml4UGF0aEZvckRlcGVuZGVudEtleXMgKyBkZXBlbmRlbnRL
        ZXlzW2ldLCBiaW5kVmlldywgYmluZFZpZXcucmVyZW5kZXIpOwogICAgfQog
        IH0KCiAgaGVscGVyLl9yYXdGdW5jdGlvbiA9IGZuOwogIEVtYmVyLkhhbmRs
        ZWJhcnMucmVnaXN0ZXJIZWxwZXIobmFtZSwgaGVscGVyKTsKfTsKCi8qKgog
        IEBwcml2YXRlCgogIFJlbmRlcnMgdGhlIHVuYm91bmQgZm9ybSBvZiBhbiBv
        dGhlcndpc2UgYm91bmQgaGVscGVyIGZ1bmN0aW9uLgoKICBAbWV0aG9kIGV2
        YWx1YXRlVW5ib3VuZEhlbHBlcgogIEBwYXJhbSB7RnVuY3Rpb259IGZuCiAg
        QHBhcmFtIHtPYmplY3R9IGNvbnRleHQKICBAcGFyYW0ge0FycmF5fSBub3Jt
        YWxpemVkUHJvcGVydGllcwogIEBwYXJhbSB7U3RyaW5nfSBvcHRpb25zCiov
        CmZ1bmN0aW9uIGV2YWx1YXRlVW5ib3VuZEhlbHBlcihjb250ZXh0LCBmbiwg
        bm9ybWFsaXplZFByb3BlcnRpZXMsIG9wdGlvbnMpIHsKICB2YXIgYXJncyA9
        IFtdLCBoYXNoID0gb3B0aW9ucy5oYXNoLCBib3VuZE9wdGlvbnMgPSBoYXNo
        LmJvdW5kT3B0aW9ucywgbG9jLCBsZW4sIHByb3BlcnR5LCBib3VuZE9wdGlv
        bjsKCiAgZm9yIChib3VuZE9wdGlvbiBpbiBib3VuZE9wdGlvbnMpIHsKICAg
        IGlmICghYm91bmRPcHRpb25zLmhhc093blByb3BlcnR5KGJvdW5kT3B0aW9u
        KSkgeyBjb250aW51ZTsgfQogICAgaGFzaFtib3VuZE9wdGlvbl0gPSBFbWJl
        ci5IYW5kbGViYXJzLmdldChjb250ZXh0LCBib3VuZE9wdGlvbnNbYm91bmRP
        cHRpb25dLCBvcHRpb25zKTsKICB9CgogIGZvcihsb2MgPSAwLCBsZW4gPSBu
        b3JtYWxpemVkUHJvcGVydGllcy5sZW5ndGg7IGxvYyA8IGxlbjsgKytsb2Mp
        IHsKICAgIHByb3BlcnR5ID0gbm9ybWFsaXplZFByb3BlcnRpZXNbbG9jXTsK
        ICAgIGFyZ3MucHVzaChFbWJlci5IYW5kbGViYXJzLmdldChwcm9wZXJ0eS5y
        b290LCBwcm9wZXJ0eS5wYXRoLCBvcHRpb25zKSk7CiAgfQogIGFyZ3MucHVz
        aChvcHRpb25zKTsKICByZXR1cm4gZm4uYXBwbHkoY29udGV4dCwgYXJncyk7
        Cn0KCi8qKgogIEBwcml2YXRlCgogIE92ZXJyaWRlcyBIYW5kbGViYXJzLnRl
        bXBsYXRlIHNvIHRoYXQgd2UgY2FuIGRpc3Rpbmd1aXNoCiAgdXNlci1jcmVh
        dGVkLCB0b3AtbGV2ZWwgdGVtcGxhdGVzIGZyb20gaW5uZXIgY29udGV4dHMu
        CgogIEBtZXRob2QgdGVtcGxhdGUKICBAZm9yIEVtYmVyLkhhbmRsZWJhcnMK
        ICBAcGFyYW0ge1N0cmluZ30gdGVtcGxhdGUgc3BlYwoqLwpFbWJlci5IYW5k
        bGViYXJzLnRlbXBsYXRlID0gZnVuY3Rpb24oc3BlYykgewogIHZhciB0ID0g
        SGFuZGxlYmFycy50ZW1wbGF0ZShzcGVjKTsKICB0LmlzVG9wID0gdHJ1ZTsK
        ICByZXR1cm4gdDsKfTsKCn0pKCk7CgoKCihmdW5jdGlvbigpIHsKLyoqCiAg
        TWFyayBhIHN0cmluZyBhcyBzYWZlIGZvciB1bmVzY2FwZWQgb3V0cHV0IHdp
        dGggSGFuZGxlYmFycy4gSWYgeW91CiAgcmV0dXJuIEhUTUwgZnJvbSBhIEhh
        bmRsZWJhcnMgaGVscGVyLCB1c2UgdGhpcyBmdW5jdGlvbiB0bwogIGVuc3Vy
        ZSBIYW5kbGViYXJzIGRvZXMgbm90IGVzY2FwZSB0aGUgSFRNTC4KCiAgYGBg
        amF2YXNjcmlwdAogIEVtYmVyLlN0cmluZy5odG1sU2FmZSgnPGRpdj5zb21l
        U3RyaW5nPC9kaXY+JykKICBgYGAKCiAgQG1ldGhvZCBodG1sU2FmZQogIEBm
        b3IgRW1iZXIuU3RyaW5nCiAgQHN0YXRpYwogIEByZXR1cm4ge0hhbmRsZWJh
        cnMuU2FmZVN0cmluZ30gYSBzdHJpbmcgdGhhdCB3aWxsIG5vdCBiZSBodG1s
        IGVzY2FwZWQgYnkgSGFuZGxlYmFycwoqLwpFbWJlci5TdHJpbmcuaHRtbFNh
        ZmUgPSBmdW5jdGlvbihzdHIpIHsKICByZXR1cm4gbmV3IEhhbmRsZWJhcnMu
        U2FmZVN0cmluZyhzdHIpOwp9OwoKdmFyIGh0bWxTYWZlID0gRW1iZXIuU3Ry
        aW5nLmh0bWxTYWZlOwoKaWYgKEVtYmVyLkVYVEVORF9QUk9UT1RZUEVTID09
        PSB0cnVlIHx8IEVtYmVyLkVYVEVORF9QUk9UT1RZUEVTLlN0cmluZykgewoK
        ICAvKioKICAgIE1hcmsgYSBzdHJpbmcgYXMgYmVpbmcgc2FmZSBmb3IgdW5l
        c2NhcGVkIG91dHB1dCB3aXRoIEhhbmRsZWJhcnMuCgogICAgYGBgamF2YXNj
        cmlwdAogICAgJzxkaXY+c29tZVN0cmluZzwvZGl2PicuaHRtbFNhZmUoKQog
        ICAgYGBgCgogICAgU2VlIFtFbWJlci5TdHJpbmcuaHRtbFNhZmVdKC9hcGkv
        Y2xhc3Nlcy9FbWJlci5TdHJpbmcuaHRtbCNtZXRob2RfaHRtbFNhZmUpLgoK
        ICAgIEBtZXRob2QgaHRtbFNhZmUKICAgIEBmb3IgU3RyaW5nCiAgICBAcmV0
        dXJuIHtIYW5kbGViYXJzLlNhZmVTdHJpbmd9IGEgc3RyaW5nIHRoYXQgd2ls
        bCBub3QgYmUgaHRtbCBlc2NhcGVkIGJ5IEhhbmRsZWJhcnMKICAqLwogIFN0
        cmluZy5wcm90b3R5cGUuaHRtbFNhZmUgPSBmdW5jdGlvbigpIHsKICAgIHJl
        dHVybiBodG1sU2FmZSh0aGlzKTsKICB9Owp9Cgp9KSgpOwoKCgooZnVuY3Rp
        b24oKSB7CkVtYmVyLkhhbmRsZWJhcnMucmVzb2x2ZVBhdGhzID0gZnVuY3Rp
        b24ob3B0aW9ucykgewogIHZhciByZXQgPSBbXSwKICAgICAgY29udGV4dHMg
        PSBvcHRpb25zLmNvbnRleHRzLAogICAgICByb290cyA9IG9wdGlvbnMucm9v
        dHMsCiAgICAgIGRhdGEgPSBvcHRpb25zLmRhdGE7CgogIGZvciAodmFyIGk9
        MCwgbD1jb250ZXh0cy5sZW5ndGg7IGk8bDsgaSsrKSB7CiAgICByZXQucHVz
        aCggRW1iZXIuSGFuZGxlYmFycy5nZXQocm9vdHNbaV0sIGNvbnRleHRzW2ld
        LCB7IGRhdGE6IGRhdGEgfSkgKTsKICB9CgogIHJldHVybiByZXQ7Cn07Cgp9
        KSgpOwoKCgooZnVuY3Rpb24oKSB7Ci8qanNoaW50IG5ld2NhcDpmYWxzZSov
        Ci8qKgpAbW9kdWxlIGVtYmVyCkBzdWJtb2R1bGUgZW1iZXItaGFuZGxlYmFy
        cwoqLwoKdmFyIHNldCA9IEVtYmVyLnNldCwgZ2V0ID0gRW1iZXIuZ2V0Owp2
        YXIgTWV0YW1vcnBoID0gcmVxdWlyZU1vZHVsZSgnbWV0YW1vcnBoJyk7Cgpm
        dW5jdGlvbiBub3RpZnlNdXRhdGlvbkxpc3RlbmVycygpIHsKICBFbWJlci5y
        dW4ub25jZShFbWJlci5WaWV3LCAnbm90aWZ5TXV0YXRpb25MaXN0ZW5lcnMn
        KTsKfQoKLy8gRE9NTWFuYWdlciBzaG91bGQganVzdCBhYnN0cmFjdCBkb20g
        bWFuaXB1bGF0aW9uIGJldHdlZW4ganF1ZXJ5IGFuZCBtZXRhbW9ycGgKdmFy
        IERPTU1hbmFnZXIgPSB7CiAgcmVtb3ZlOiBmdW5jdGlvbih2aWV3KSB7CiAg
        ICB2aWV3Lm1vcnBoLnJlbW92ZSgpOwogICAgbm90aWZ5TXV0YXRpb25MaXN0
        ZW5lcnMoKTsKICB9LAoKICBwcmVwZW5kOiBmdW5jdGlvbih2aWV3LCBodG1s
        KSB7CiAgICB2aWV3Lm1vcnBoLnByZXBlbmQoaHRtbCk7CiAgICBub3RpZnlN
        dXRhdGlvbkxpc3RlbmVycygpOwogIH0sCgogIGFmdGVyOiBmdW5jdGlvbih2
        aWV3LCBodG1sKSB7CiAgICB2aWV3Lm1vcnBoLmFmdGVyKGh0bWwpOwogICAg
        bm90aWZ5TXV0YXRpb25MaXN0ZW5lcnMoKTsKICB9LAoKICBodG1sOiBmdW5j
        dGlvbih2aWV3LCBodG1sKSB7CiAgICB2aWV3Lm1vcnBoLmh0bWwoaHRtbCk7
        CiAgICBub3RpZnlNdXRhdGlvbkxpc3RlbmVycygpOwogIH0sCgogIC8vIFRo
        aXMgaXMgbWVzc2VkIHVwLgogIHJlcGxhY2U6IGZ1bmN0aW9uKHZpZXcpIHsK
        ICAgIHZhciBtb3JwaCA9IHZpZXcubW9ycGg7CgogICAgdmlldy50cmFuc2l0
        aW9uVG8oJ3ByZVJlbmRlcicpOwoKICAgIEVtYmVyLnJ1bi5zY2hlZHVsZSgn
        cmVuZGVyJywgdGhpcywgZnVuY3Rpb24oKSB7CiAgICAgIGlmICh2aWV3Lmlz
        RGVzdHJveWluZykgeyByZXR1cm47IH0KCiAgICAgIHZpZXcuY2xlYXJSZW5k
        ZXJlZENoaWxkcmVuKCk7CiAgICAgIHZhciBidWZmZXIgPSB2aWV3LnJlbmRl
        clRvQnVmZmVyKCk7CgogICAgICB2aWV3Lmludm9rZVJlY3Vyc2l2ZWx5KGZ1
        bmN0aW9uKHZpZXcpIHsKICAgICAgICB2aWV3LnByb3BlcnR5V2lsbENoYW5n
        ZSgnZWxlbWVudCcpOwogICAgICB9KTsKICAgICAgdmlldy50cmlnZ2VyUmVj
        dXJzaXZlbHkoJ3dpbGxJbnNlcnRFbGVtZW50Jyk7CgogICAgICBtb3JwaC5y
        ZXBsYWNlV2l0aChidWZmZXIuc3RyaW5nKCkpOwogICAgICB2aWV3LnRyYW5z
        aXRpb25UbygnaW5ET00nKTsKCiAgICAgIHZpZXcuaW52b2tlUmVjdXJzaXZl
        bHkoZnVuY3Rpb24odmlldykgewogICAgICAgIHZpZXcucHJvcGVydHlEaWRD
        aGFuZ2UoJ2VsZW1lbnQnKTsKICAgICAgfSk7CiAgICAgIHZpZXcudHJpZ2dl
        clJlY3Vyc2l2ZWx5KCdkaWRJbnNlcnRFbGVtZW50Jyk7CgogICAgICBub3Rp
        ZnlNdXRhdGlvbkxpc3RlbmVycygpOwogICAgfSk7CiAgfSwKCiAgZW1wdHk6
        IGZ1bmN0aW9uKHZpZXcpIHsKICAgIHZpZXcubW9ycGguaHRtbCgiIik7CiAg
        ICBub3RpZnlNdXRhdGlvbkxpc3RlbmVycygpOwogIH0KfTsKCi8vIFRoZSBg
        bW9ycGhgIGFuZCBgb3V0ZXJIVE1MYCBwcm9wZXJ0aWVzIGFyZSBpbnRlcm5h
        bCBvbmx5Ci8vIGFuZCBub3Qgb2JzZXJ2YWJsZS4KCi8qKgogIEBjbGFzcyBf
        TWV0YW1vcnBoCiAgQG5hbWVzcGFjZSBFbWJlcgogIEBwcml2YXRlCiovCkVt
        YmVyLl9NZXRhbW9ycGggPSBFbWJlci5NaXhpbi5jcmVhdGUoewogIGlzVmly
        dHVhbDogdHJ1ZSwKICB0YWdOYW1lOiAnJywKCiAgaW5zdHJ1bWVudE5hbWU6
        ICdtZXRhbW9ycGgnLAoKICBpbml0OiBmdW5jdGlvbigpIHsKICAgIHRoaXMu
        X3N1cGVyKCk7CiAgICB0aGlzLm1vcnBoID0gTWV0YW1vcnBoKCk7CiAgICBF
        bWJlci5kZXByZWNhdGUoJ1N1cHBseWluZyBhIHRhZ05hbWUgdG8gTWV0YW1v
        cnBoIHZpZXdzIGlzIHVucmVsaWFibGUgYW5kIGlzIGRlcHJlY2F0ZWQuIFlv
        dSBtYXkgYmUgc2V0dGluZyB0aGUgdGFnTmFtZSBvbiBhIEhhbmRsZWJhcnMg
        aGVscGVyIHRoYXQgY3JlYXRlcyBhIE1ldGFtb3JwaC4nLCAhdGhpcy50YWdO
        YW1lKTsKICB9LAoKICBiZWZvcmVSZW5kZXI6IGZ1bmN0aW9uKGJ1ZmZlcikg
        ewogICAgYnVmZmVyLnB1c2godGhpcy5tb3JwaC5zdGFydFRhZygpKTsKICAg
        IGJ1ZmZlci5wdXNoT3BlbmluZ1RhZygpOwogIH0sCgogIGFmdGVyUmVuZGVy
        OiBmdW5jdGlvbihidWZmZXIpIHsKICAgIGJ1ZmZlci5wdXNoQ2xvc2luZ1Rh
        ZygpOwogICAgYnVmZmVyLnB1c2godGhpcy5tb3JwaC5lbmRUYWcoKSk7CiAg
        fSwKCiAgY3JlYXRlRWxlbWVudDogZnVuY3Rpb24oKSB7CiAgICB2YXIgYnVm
        ZmVyID0gdGhpcy5yZW5kZXJUb0J1ZmZlcigpOwogICAgdGhpcy5vdXRlckhU
        TUwgPSBidWZmZXIuc3RyaW5nKCk7CiAgICB0aGlzLmNsZWFyQnVmZmVyKCk7
        CiAgfSwKCiAgZG9tTWFuYWdlcjogRE9NTWFuYWdlcgp9KTsKCi8qKgogIEBj
        bGFzcyBfTWV0YW1vcnBoVmlldwogIEBuYW1lc3BhY2UgRW1iZXIKICBAZXh0
        ZW5kcyBFbWJlci5WaWV3CiAgQHVzZXMgRW1iZXIuX01ldGFtb3JwaAogIEBw
        cml2YXRlCiovCkVtYmVyLl9NZXRhbW9ycGhWaWV3ID0gRW1iZXIuVmlldy5l
        eHRlbmQoRW1iZXIuX01ldGFtb3JwaCk7CgovKioKICBAY2xhc3MgX1NpbXBs
        ZU1ldGFtb3JwaFZpZXcKICBAbmFtZXNwYWNlIEVtYmVyCiAgQGV4dGVuZHMg
        RW1iZXIuQ29yZVZpZXcKICBAdXNlcyBFbWJlci5fTWV0YW1vcnBoCiAgQHBy
        aXZhdGUKKi8KRW1iZXIuX1NpbXBsZU1ldGFtb3JwaFZpZXcgPSBFbWJlci5D
        b3JlVmlldy5leHRlbmQoRW1iZXIuX01ldGFtb3JwaCk7CgoKfSkoKTsKCgoK
        KGZ1bmN0aW9uKCkgewovKmdsb2JhbHMgSGFuZGxlYmFycyAqLwovKmpzaGlu
        dCBuZXdjYXA6ZmFsc2UqLwovKioKQG1vZHVsZSBlbWJlcgpAc3VibW9kdWxl
        IGVtYmVyLWhhbmRsZWJhcnMKKi8KCnZhciBnZXQgPSBFbWJlci5nZXQsIHNl
        dCA9IEVtYmVyLnNldCwgaGFuZGxlYmFyc0dldCA9IEVtYmVyLkhhbmRsZWJh
        cnMuZ2V0Owp2YXIgTWV0YW1vcnBoID0gcmVxdWlyZU1vZHVsZSgnbWV0YW1v
        cnBoJyk7CmZ1bmN0aW9uIFNpbXBsZUhhbmRsZWJhcnNWaWV3KHBhdGgsIHBh
        dGhSb290LCBpc0VzY2FwZWQsIHRlbXBsYXRlRGF0YSkgewogIHRoaXMucGF0
        aCA9IHBhdGg7CiAgdGhpcy5wYXRoUm9vdCA9IHBhdGhSb290OwogIHRoaXMu
        aXNFc2NhcGVkID0gaXNFc2NhcGVkOwogIHRoaXMudGVtcGxhdGVEYXRhID0g
        dGVtcGxhdGVEYXRhOwoKICB0aGlzLm1vcnBoID0gTWV0YW1vcnBoKCk7CiAg
        dGhpcy5zdGF0ZSA9ICdwcmVSZW5kZXInOwogIHRoaXMudXBkYXRlSWQgPSBu
        dWxsOwogIHRoaXMuX3BhcmVudFZpZXcgPSBudWxsOwogIHRoaXMuYnVmZmVy
        ID0gbnVsbDsKfQoKRW1iZXIuX1NpbXBsZUhhbmRsZWJhcnNWaWV3ID0gU2lt
        cGxlSGFuZGxlYmFyc1ZpZXc7CgpTaW1wbGVIYW5kbGViYXJzVmlldy5wcm90
        b3R5cGUgPSB7CiAgaXNWaXJ0dWFsOiB0cnVlLAogIGlzVmlldzogdHJ1ZSwK
        CiAgZGVzdHJveTogZnVuY3Rpb24gKCkgewogICAgaWYgKHRoaXMudXBkYXRl
        SWQpIHsKICAgICAgRW1iZXIucnVuLmNhbmNlbCh0aGlzLnVwZGF0ZUlkKTsK
        ICAgICAgdGhpcy51cGRhdGVJZCA9IG51bGw7CiAgICB9CiAgICBpZiAodGhp
        cy5fcGFyZW50VmlldykgewogICAgICB0aGlzLl9wYXJlbnRWaWV3LnJlbW92
        ZUNoaWxkKHRoaXMpOwogICAgfQogICAgdGhpcy5tb3JwaCA9IG51bGw7CiAg
        ICB0aGlzLnN0YXRlID0gJ2Rlc3Ryb3llZCc7CiAgfSwKCiAgcHJvcGVydHlX
        aWxsQ2hhbmdlOiBFbWJlci5LLAoKICBwcm9wZXJ0eURpZENoYW5nZTogRW1i
        ZXIuSywKCiAgbm9ybWFsaXplZFZhbHVlOiBmdW5jdGlvbigpIHsKICAgIHZh
        ciBwYXRoID0gdGhpcy5wYXRoLAogICAgICAgIHBhdGhSb290ID0gdGhpcy5w
        YXRoUm9vdCwKICAgICAgICByZXN1bHQsIHRlbXBsYXRlRGF0YTsKCiAgICAv
        LyBVc2UgdGhlIHBhdGhSb290IGFzIHRoZSByZXN1bHQgaWYgbm8gcGF0aCBp
        cyBwcm92aWRlZC4gVGhpcwogICAgLy8gaGFwcGVucyBpZiB0aGUgcGF0aCBp
        cyBgdGhpc2AsIHdoaWNoIGdldHMgbm9ybWFsaXplZCBpbnRvCiAgICAvLyBh
        IGBwYXRoUm9vdGAgb2YgdGhlIGN1cnJlbnQgSGFuZGxlYmFycyBjb250ZXh0
        IGFuZCBhIHBhdGgKICAgIC8vIG9mIGAnJ2AuCiAgICBpZiAocGF0aCA9PT0g
        JycpIHsKICAgICAgcmVzdWx0ID0gcGF0aFJvb3Q7CiAgICB9IGVsc2Ugewog
        ICAgICB0ZW1wbGF0ZURhdGEgPSB0aGlzLnRlbXBsYXRlRGF0YTsKICAgICAg
        cmVzdWx0ID0gaGFuZGxlYmFyc0dldChwYXRoUm9vdCwgcGF0aCwgeyBkYXRh
        OiB0ZW1wbGF0ZURhdGEgfSk7CiAgICB9CgogICAgcmV0dXJuIHJlc3VsdDsK
        ICB9LAoKICByZW5kZXJUb0J1ZmZlcjogZnVuY3Rpb24oYnVmZmVyKSB7CiAg
        ICB2YXIgc3RyaW5nID0gJyc7CgogICAgc3RyaW5nICs9IHRoaXMubW9ycGgu
        c3RhcnRUYWcoKTsKICAgIHN0cmluZyArPSB0aGlzLnJlbmRlcigpOwogICAg
        c3RyaW5nICs9IHRoaXMubW9ycGguZW5kVGFnKCk7CgogICAgYnVmZmVyLnB1
        c2goc3RyaW5nKTsKICB9LAoKICByZW5kZXI6IGZ1bmN0aW9uKCkgewogICAg
        Ly8gSWYgbm90IGludm9rZWQgdmlhIGEgdHJpcGxlLW11c3RhY2hlICh7e3tm
        b299fX0pLCBlc2NhcGUKICAgIC8vIHRoZSBjb250ZW50IG9mIHRoZSB0ZW1w
        bGF0ZS4KICAgIHZhciBlc2NhcGUgPSB0aGlzLmlzRXNjYXBlZDsKICAgIHZh
        ciByZXN1bHQgPSB0aGlzLm5vcm1hbGl6ZWRWYWx1ZSgpOwoKICAgIGlmIChy
        ZXN1bHQgPT09IG51bGwgfHwgcmVzdWx0ID09PSB1bmRlZmluZWQpIHsKICAg
        ICAgcmVzdWx0ID0gIiI7CiAgICB9IGVsc2UgaWYgKCEocmVzdWx0IGluc3Rh
        bmNlb2YgSGFuZGxlYmFycy5TYWZlU3RyaW5nKSkgewogICAgICByZXN1bHQg
        PSBTdHJpbmcocmVzdWx0KTsKICAgIH0KCiAgICBpZiAoZXNjYXBlKSB7IHJl
        c3VsdCA9IEhhbmRsZWJhcnMuVXRpbHMuZXNjYXBlRXhwcmVzc2lvbihyZXN1
        bHQpOyB9CiAgICByZXR1cm4gcmVzdWx0OwogIH0sCgogIHJlcmVuZGVyOiBm
        dW5jdGlvbigpIHsKICAgIHN3aXRjaCh0aGlzLnN0YXRlKSB7CiAgICAgIGNh
        c2UgJ3ByZVJlbmRlcic6CiAgICAgIGNhc2UgJ2Rlc3Ryb3llZCc6CiAgICAg
        ICAgYnJlYWs7CiAgICAgIGNhc2UgJ2luQnVmZmVyJzoKICAgICAgICB0aHJv
        dyBuZXcgRW1iZXIuRXJyb3IoIlNvbWV0aGluZyB5b3UgZGlkIHRyaWVkIHRv
        IHJlcGxhY2UgYW4ge3tleHByZXNzaW9ufX0gYmVmb3JlIGl0IHdhcyBpbnNl
        cnRlZCBpbnRvIHRoZSBET00uIik7CiAgICAgIGNhc2UgJ2hhc0VsZW1lbnQn
        OgogICAgICBjYXNlICdpbkRPTSc6CiAgICAgICAgdGhpcy51cGRhdGVJZCA9
        IEVtYmVyLnJ1bi5zY2hlZHVsZU9uY2UoJ3JlbmRlcicsIHRoaXMsICd1cGRh
        dGUnKTsKICAgICAgICBicmVhazsKICAgIH0KCiAgICByZXR1cm4gdGhpczsK
        ICB9LAoKICB1cGRhdGU6IGZ1bmN0aW9uICgpIHsKICAgIHRoaXMudXBkYXRl
        SWQgPSBudWxsOwogICAgdGhpcy5tb3JwaC5odG1sKHRoaXMucmVuZGVyKCkp
        OwogIH0sCgogIHRyYW5zaXRpb25UbzogZnVuY3Rpb24oc3RhdGUpIHsKICAg
        IHRoaXMuc3RhdGUgPSBzdGF0ZTsKICB9Cn07Cgp2YXIgc3RhdGVzID0gRW1i
        ZXIuVmlldy5jbG9uZVN0YXRlcyhFbWJlci5WaWV3LnN0YXRlcyksIG1lcmdl
        ID0gRW1iZXIubWVyZ2U7CgptZXJnZShzdGF0ZXMuX2RlZmF1bHQsIHsKICBy
        ZXJlbmRlcklmTmVlZGVkOiBFbWJlci5LCn0pOwoKbWVyZ2Uoc3RhdGVzLmlu
        RE9NLCB7CiAgcmVyZW5kZXJJZk5lZWRlZDogZnVuY3Rpb24odmlldykgewog
        ICAgaWYgKHZpZXcubm9ybWFsaXplZFZhbHVlKCkgIT09IHZpZXcuX2xhc3RO
        b3JtYWxpemVkVmFsdWUpIHsKICAgICAgdmlldy5yZXJlbmRlcigpOwogICAg
        fQogIH0KfSk7CgovKioKICBgRW1iZXIuX0hhbmRsZWJhcnNCb3VuZFZpZXdg
        IGlzIGEgcHJpdmF0ZSB2aWV3IGNyZWF0ZWQgYnkgdGhlIEhhbmRsZWJhcnMK
        ICBge3tiaW5kfX1gIGhlbHBlcnMgdGhhdCBpcyB1c2VkIHRvIGtlZXAgdHJh
        Y2sgb2YgYm91bmQgcHJvcGVydGllcy4KCiAgRXZlcnkgdGltZSBhIHByb3Bl
        cnR5IGlzIGJvdW5kIHVzaW5nIGEgYHt7bXVzdGFjaGV9fWAsIGFuIGFub255
        bW91cyBzdWJjbGFzcwogIG9mIGBFbWJlci5fSGFuZGxlYmFyc0JvdW5kVmll
        d2AgaXMgY3JlYXRlZCB3aXRoIHRoZSBhcHByb3ByaWF0ZSBzdWItdGVtcGxh
        dGUKICBhbmQgY29udGV4dCBzZXQgdXAuIFdoZW4gdGhlIGFzc29jaWF0ZWQg
        cHJvcGVydHkgY2hhbmdlcywganVzdCB0aGUgdGVtcGxhdGUKICBmb3IgdGhp
        cyB2aWV3IHdpbGwgcmUtcmVuZGVyLgoKICBAY2xhc3MgX0hhbmRsZWJhcnNC
        b3VuZFZpZXcKICBAbmFtZXNwYWNlIEVtYmVyCiAgQGV4dGVuZHMgRW1iZXIu
        X01ldGFtb3JwaFZpZXcKICBAcHJpdmF0ZQoqLwpFbWJlci5fSGFuZGxlYmFy
        c0JvdW5kVmlldyA9IEVtYmVyLl9NZXRhbW9ycGhWaWV3LmV4dGVuZCh7CiAg
        aW5zdHJ1bWVudE5hbWU6ICdib3VuZEhhbmRsZWJhcnMnLAogIHN0YXRlczog
        c3RhdGVzLAoKICAvKioKICAgIFRoZSBmdW5jdGlvbiB1c2VkIHRvIGRldGVy
        bWluZSBpZiB0aGUgYGRpc3BsYXlUZW1wbGF0ZWAgb3IKICAgIGBpbnZlcnNl
        VGVtcGxhdGVgIHNob3VsZCBiZSByZW5kZXJlZC4gVGhpcyBzaG91bGQgYmUg
        YSBmdW5jdGlvbiB0aGF0IHRha2VzCiAgICBhIHZhbHVlIGFuZCByZXR1cm5z
        IGEgQm9vbGVhbi4KCiAgICBAcHJvcGVydHkgc2hvdWxkRGlzcGxheUZ1bmMK
        ICAgIEB0eXBlIEZ1bmN0aW9uCiAgICBAZGVmYXVsdCBudWxsCiAgKi8KICBz
        aG91bGREaXNwbGF5RnVuYzogbnVsbCwKCiAgLyoqCiAgICBXaGV0aGVyIHRo
        ZSB0ZW1wbGF0ZSByZW5kZXJlZCBieSB0aGlzIHZpZXcgZ2V0cyBwYXNzZWQg
        dGhlIGNvbnRleHQgb2JqZWN0CiAgICBvZiBpdHMgcGFyZW50IHRlbXBsYXRl
        LCBvciBnZXRzIHBhc3NlZCB0aGUgdmFsdWUgb2YgcmV0cmlldmluZyBgcGF0
        aGAKICAgIGZyb20gdGhlIGBwYXRoUm9vdGAuCgogICAgRm9yIGV4YW1wbGUs
        IHRoaXMgaXMgdHJ1ZSB3aGVuIHVzaW5nIHRoZSBge3sjaWZ9fWAgaGVscGVy
        LCBiZWNhdXNlIHRoZQogICAgdGVtcGxhdGUgaW5zaWRlIHRoZSBoZWxwZXIg
        c2hvdWxkIGxvb2sgdXAgcHJvcGVydGllcyByZWxhdGl2ZSB0byB0aGUgc2Ft
        ZQogICAgb2JqZWN0IGFzIG91dHNpZGUgdGhlIGJsb2NrLiBUaGlzIHdvdWxk
        IGJlIGBmYWxzZWAgd2hlbiB1c2VkIHdpdGggYHt7I3dpdGgKICAgIGZvb319
        YCBiZWNhdXNlIHRoZSB0ZW1wbGF0ZSBzaG91bGQgcmVjZWl2ZSB0aGUgb2Jq
        ZWN0IGZvdW5kIGJ5IGV2YWx1YXRpbmcKICAgIGBmb29gLgoKICAgIEBwcm9w
        ZXJ0eSBwcmVzZXJ2ZUNvbnRleHQKICAgIEB0eXBlIEJvb2xlYW4KICAgIEBk
        ZWZhdWx0IGZhbHNlCiAgKi8KICBwcmVzZXJ2ZUNvbnRleHQ6IGZhbHNlLAoK
        ICAvKioKICAgIElmIGBwcmVzZXJ2ZUNvbnRleHRgIGlzIHRydWUsIHRoaXMg
        aXMgdGhlIG9iamVjdCB0aGF0IHdpbGwgYmUgdXNlZAogICAgdG8gcmVuZGVy
        IHRoZSB0ZW1wbGF0ZS4KCiAgICBAcHJvcGVydHkgcHJldmlvdXNDb250ZXh0
        CiAgICBAdHlwZSBPYmplY3QKICAqLwogIHByZXZpb3VzQ29udGV4dDogbnVs
        bCwKCiAgLyoqCiAgICBUaGUgdGVtcGxhdGUgdG8gcmVuZGVyIHdoZW4gYHNo
        b3VsZERpc3BsYXlGdW5jYCBldmFsdWF0ZXMgdG8gYHRydWVgLgoKICAgIEBw
        cm9wZXJ0eSBkaXNwbGF5VGVtcGxhdGUKICAgIEB0eXBlIEZ1bmN0aW9uCiAg
        ICBAZGVmYXVsdCBudWxsCiAgKi8KICBkaXNwbGF5VGVtcGxhdGU6IG51bGws
        CgogIC8qKgogICAgVGhlIHRlbXBsYXRlIHRvIHJlbmRlciB3aGVuIGBzaG91
        bGREaXNwbGF5RnVuY2AgZXZhbHVhdGVzIHRvIGBmYWxzZWAuCgogICAgQHBy
        b3BlcnR5IGludmVyc2VUZW1wbGF0ZQogICAgQHR5cGUgRnVuY3Rpb24KICAg
        IEBkZWZhdWx0IG51bGwKICAqLwogIGludmVyc2VUZW1wbGF0ZTogbnVsbCwK
        CgogIC8qKgogICAgVGhlIHBhdGggdG8gbG9vayB1cCBvbiBgcGF0aFJvb3Rg
        IHRoYXQgaXMgcGFzc2VkIHRvCiAgICBgc2hvdWxkRGlzcGxheUZ1bmNgIHRv
        IGRldGVybWluZSB3aGljaCB0ZW1wbGF0ZSB0byByZW5kZXIuCgogICAgSW4g
        YWRkaXRpb24sIGlmIGBwcmVzZXJ2ZUNvbnRleHRgIGlzIGBmYWxzZSxgIHRo
        ZSBvYmplY3QgYXQgdGhpcyBwYXRoIHdpbGwKICAgIGJlIHBhc3NlZCB0byB0
        aGUgdGVtcGxhdGUgd2hlbiByZW5kZXJpbmcuCgogICAgQHByb3BlcnR5IHBh
        dGgKICAgIEB0eXBlIFN0cmluZwogICAgQGRlZmF1bHQgbnVsbAogICovCiAg
        cGF0aDogbnVsbCwKCiAgLyoqCiAgICBUaGUgb2JqZWN0IGZyb20gd2hpY2gg
        dGhlIGBwYXRoYCB3aWxsIGJlIGxvb2tlZCB1cC4gU29tZXRpbWVzIHRoaXMg
        aXMgdGhlCiAgICBzYW1lIGFzIHRoZSBgcHJldmlvdXNDb250ZXh0YCwgYnV0
        IGluIGNhc2VzIHdoZXJlIHRoaXMgdmlldyBoYXMgYmVlbgogICAgZ2VuZXJh
        dGVkIGZvciBwYXRocyB0aGF0IHN0YXJ0IHdpdGggYSBrZXl3b3JkIHN1Y2gg
        YXMgYHZpZXdgIG9yCiAgICBgY29udHJvbGxlcmAsIHRoZSBwYXRoIHJvb3Qg
        d2lsbCBiZSB0aGF0IHJlc29sdmVkIG9iamVjdC4KCiAgICBAcHJvcGVydHkg
        cGF0aFJvb3QKICAgIEB0eXBlIE9iamVjdAogICovCiAgcGF0aFJvb3Q6IG51
        bGwsCgogIG5vcm1hbGl6ZWRWYWx1ZTogZnVuY3Rpb24oKSB7CiAgICB2YXIg
        cGF0aCA9IGdldCh0aGlzLCAncGF0aCcpLAogICAgICAgIHBhdGhSb290ICA9
        IGdldCh0aGlzLCAncGF0aFJvb3QnKSwKICAgICAgICB2YWx1ZU5vcm1hbGl6
        ZXIgPSBnZXQodGhpcywgJ3ZhbHVlTm9ybWFsaXplckZ1bmMnKSwKICAgICAg
        ICByZXN1bHQsIHRlbXBsYXRlRGF0YTsKCiAgICAvLyBVc2UgdGhlIHBhdGhS
        b290IGFzIHRoZSByZXN1bHQgaWYgbm8gcGF0aCBpcyBwcm92aWRlZC4gVGhp
        cwogICAgLy8gaGFwcGVucyBpZiB0aGUgcGF0aCBpcyBgdGhpc2AsIHdoaWNo
        IGdldHMgbm9ybWFsaXplZCBpbnRvCiAgICAvLyBhIGBwYXRoUm9vdGAgb2Yg
        dGhlIGN1cnJlbnQgSGFuZGxlYmFycyBjb250ZXh0IGFuZCBhIHBhdGgKICAg
        IC8vIG9mIGAnJ2AuCiAgICBpZiAocGF0aCA9PT0gJycpIHsKICAgICAgcmVz
        dWx0ID0gcGF0aFJvb3Q7CiAgICB9IGVsc2UgewogICAgICB0ZW1wbGF0ZURh
        dGEgPSBnZXQodGhpcywgJ3RlbXBsYXRlRGF0YScpOwogICAgICByZXN1bHQg
        PSBoYW5kbGViYXJzR2V0KHBhdGhSb290LCBwYXRoLCB7IGRhdGE6IHRlbXBs
        YXRlRGF0YSB9KTsKICAgIH0KCiAgICByZXR1cm4gdmFsdWVOb3JtYWxpemVy
        ID8gdmFsdWVOb3JtYWxpemVyKHJlc3VsdCkgOiByZXN1bHQ7CiAgfSwKCiAg
        cmVyZW5kZXJJZk5lZWRlZDogZnVuY3Rpb24oKSB7CiAgICB0aGlzLmN1cnJl
        bnRTdGF0ZS5yZXJlbmRlcklmTmVlZGVkKHRoaXMpOwogIH0sCgogIC8qKgog
        ICAgRGV0ZXJtaW5lcyB3aGljaCB0ZW1wbGF0ZSB0byBpbnZva2UsIHNldHMg
        dXAgdGhlIGNvcnJlY3Qgc3RhdGUgYmFzZWQgb24KICAgIHRoYXQgbG9naWMs
        IHRoZW4gaW52b2tlcyB0aGUgZGVmYXVsdCBgRW1iZXIuVmlld2AgYHJlbmRl
        cmAgaW1wbGVtZW50YXRpb24uCgogICAgVGhpcyBtZXRob2Qgd2lsbCBmaXJz
        dCBsb29rIHVwIHRoZSBgcGF0aGAga2V5IG9uIGBwYXRoUm9vdGAsCiAgICB0
        aGVuIHBhc3MgdGhhdCB2YWx1ZSB0byB0aGUgYHNob3VsZERpc3BsYXlGdW5j
        YCBmdW5jdGlvbi4gSWYgdGhhdCByZXR1cm5zCiAgICBgdHJ1ZSxgIHRoZSBg
        ZGlzcGxheVRlbXBsYXRlYCBmdW5jdGlvbiB3aWxsIGJlIHJlbmRlcmVkIHRv
        IERPTS4gT3RoZXJ3aXNlLAogICAgYGludmVyc2VUZW1wbGF0ZWAsIGlmIHNw
        ZWNpZmllZCwgd2lsbCBiZSByZW5kZXJlZC4KCiAgICBGb3IgZXhhbXBsZSwg
        aWYgdGhpcyBgRW1iZXIuX0hhbmRsZWJhcnNCb3VuZFZpZXdgIHJlcHJlc2Vu
        dGVkIHRoZSBge3sjd2l0aAogICAgZm9vfX1gIGhlbHBlciwgaXQgd291bGQg
        bG9vayB1cCB0aGUgYGZvb2AgcHJvcGVydHkgb2YgaXRzIGNvbnRleHQsIGFu
        ZAogICAgYHNob3VsZERpc3BsYXlGdW5jYCB3b3VsZCBhbHdheXMgcmV0dXJu
        IHRydWUuIFRoZSBvYmplY3QgZm91bmQgYnkgbG9va2luZwogICAgdXAgYGZv
        b2Agd291bGQgYmUgcGFzc2VkIHRvIGBkaXNwbGF5VGVtcGxhdGVgLgoKICAg
        IEBtZXRob2QgcmVuZGVyCiAgICBAcGFyYW0ge0VtYmVyLlJlbmRlckJ1ZmZl
        cn0gYnVmZmVyCiAgKi8KICByZW5kZXI6IGZ1bmN0aW9uKGJ1ZmZlcikgewog
        ICAgLy8gSWYgbm90IGludm9rZWQgdmlhIGEgdHJpcGxlLW11c3RhY2hlICh7
        e3tmb299fX0pLCBlc2NhcGUKICAgIC8vIHRoZSBjb250ZW50IG9mIHRoZSB0
        ZW1wbGF0ZS4KICAgIHZhciBlc2NhcGUgPSBnZXQodGhpcywgJ2lzRXNjYXBl
        ZCcpOwoKICAgIHZhciBzaG91bGREaXNwbGF5ID0gZ2V0KHRoaXMsICdzaG91
        bGREaXNwbGF5RnVuYycpLAogICAgICAgIHByZXNlcnZlQ29udGV4dCA9IGdl
        dCh0aGlzLCAncHJlc2VydmVDb250ZXh0JyksCiAgICAgICAgY29udGV4dCA9
        IGdldCh0aGlzLCAncHJldmlvdXNDb250ZXh0Jyk7CgogICAgdmFyIGludmVy
        c2VUZW1wbGF0ZSA9IGdldCh0aGlzLCAnaW52ZXJzZVRlbXBsYXRlJyksCiAg
        ICAgICAgZGlzcGxheVRlbXBsYXRlID0gZ2V0KHRoaXMsICdkaXNwbGF5VGVt
        cGxhdGUnKTsKCiAgICB2YXIgcmVzdWx0ID0gdGhpcy5ub3JtYWxpemVkVmFs
        dWUoKTsKICAgIHRoaXMuX2xhc3ROb3JtYWxpemVkVmFsdWUgPSByZXN1bHQ7
        CgogICAgLy8gRmlyc3QsIHRlc3QgdGhlIGNvbmRpdGlvbmFsIHRvIHNlZSBp
        ZiB3ZSBzaG91bGQKICAgIC8vIHJlbmRlciB0aGUgdGVtcGxhdGUgb3Igbm90
        LgogICAgaWYgKHNob3VsZERpc3BsYXkocmVzdWx0KSkgewogICAgICBzZXQo
        dGhpcywgJ3RlbXBsYXRlJywgZGlzcGxheVRlbXBsYXRlKTsKCiAgICAgIC8v
        IElmIHdlIGFyZSBwcmVzZXJ2aW5nIHRoZSBjb250ZXh0IChmb3IgZXhhbXBs
        ZSwgaWYgdGhpcwogICAgICAvLyBpcyBhbiAjaWYgYmxvY2ssIGNhbGwgdGhl
        IHRlbXBsYXRlIHdpdGggdGhlIHNhbWUgb2JqZWN0LgogICAgICBpZiAocHJl
        c2VydmVDb250ZXh0KSB7CiAgICAgICAgc2V0KHRoaXMsICdfY29udGV4dCcs
        IGNvbnRleHQpOwogICAgICB9IGVsc2UgewogICAgICAvLyBPdGhlcndpc2Us
        IGRldGVybWluZSBpZiB0aGlzIGlzIGEgYmxvY2sgYmluZCBvciBub3QuCiAg
        ICAgIC8vIElmIHNvLCBwYXNzIHRoZSBzcGVjaWZpZWQgb2JqZWN0IHRvIHRo
        ZSB0ZW1wbGF0ZQogICAgICAgIGlmIChkaXNwbGF5VGVtcGxhdGUpIHsKICAg
        ICAgICAgIHNldCh0aGlzLCAnX2NvbnRleHQnLCByZXN1bHQpOwogICAgICAg
        IH0gZWxzZSB7CiAgICAgICAgLy8gVGhpcyBpcyBub3QgYSBiaW5kIGJsb2Nr
        LCBqdXN0IHB1c2ggdGhlIHJlc3VsdCBvZiB0aGUKICAgICAgICAvLyBleHBy
        ZXNzaW9uIHRvIHRoZSByZW5kZXIgY29udGV4dCBhbmQgcmV0dXJuLgogICAg
        ICAgICAgaWYgKHJlc3VsdCA9PT0gbnVsbCB8fCByZXN1bHQgPT09IHVuZGVm
        aW5lZCkgewogICAgICAgICAgICByZXN1bHQgPSAiIjsKICAgICAgICAgIH0g
        ZWxzZSBpZiAoIShyZXN1bHQgaW5zdGFuY2VvZiBIYW5kbGViYXJzLlNhZmVT
        dHJpbmcpKSB7CiAgICAgICAgICAgIHJlc3VsdCA9IFN0cmluZyhyZXN1bHQp
        OwogICAgICAgICAgfQoKICAgICAgICAgIGlmIChlc2NhcGUpIHsgcmVzdWx0
        ID0gSGFuZGxlYmFycy5VdGlscy5lc2NhcGVFeHByZXNzaW9uKHJlc3VsdCk7
        IH0KICAgICAgICAgIGJ1ZmZlci5wdXNoKHJlc3VsdCk7CiAgICAgICAgICBy
        ZXR1cm47CiAgICAgICAgfQogICAgICB9CiAgICB9IGVsc2UgaWYgKGludmVy
        c2VUZW1wbGF0ZSkgewogICAgICBzZXQodGhpcywgJ3RlbXBsYXRlJywgaW52
        ZXJzZVRlbXBsYXRlKTsKCiAgICAgIGlmIChwcmVzZXJ2ZUNvbnRleHQpIHsK
        ICAgICAgICBzZXQodGhpcywgJ19jb250ZXh0JywgY29udGV4dCk7CiAgICAg
        IH0gZWxzZSB7CiAgICAgICAgc2V0KHRoaXMsICdfY29udGV4dCcsIHJlc3Vs
        dCk7CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIHNldCh0aGlzLCAndGVt
        cGxhdGUnLCBmdW5jdGlvbigpIHsgcmV0dXJuICcnOyB9KTsKICAgIH0KCiAg
        ICByZXR1cm4gdGhpcy5fc3VwZXIoYnVmZmVyKTsKICB9Cn0pOwoKfSkoKTsK
        CgoKKGZ1bmN0aW9uKCkgewovKioKQG1vZHVsZSBlbWJlcgpAc3VibW9kdWxl
        IGVtYmVyLWhhbmRsZWJhcnMKKi8KCnZhciBnZXQgPSBFbWJlci5nZXQsIHNl
        dCA9IEVtYmVyLnNldCwgZm10ID0gRW1iZXIuU3RyaW5nLmZtdDsKdmFyIGhh
        bmRsZWJhcnNHZXQgPSBFbWJlci5IYW5kbGViYXJzLmdldCwgbm9ybWFsaXpl
        UGF0aCA9IEVtYmVyLkhhbmRsZWJhcnMubm9ybWFsaXplUGF0aDsKdmFyIGZv
        ckVhY2ggPSBFbWJlci5BcnJheVBvbHlmaWxscy5mb3JFYWNoOwoKdmFyIEVt
        YmVySGFuZGxlYmFycyA9IEVtYmVyLkhhbmRsZWJhcnMsIGhlbHBlcnMgPSBF
        bWJlckhhbmRsZWJhcnMuaGVscGVyczsKCmZ1bmN0aW9uIGV4aXN0cyh2YWx1
        ZSkgewogIHJldHVybiAhRW1iZXIuaXNOb25lKHZhbHVlKTsKfQoKLy8gQmlu
        ZHMgYSBwcm9wZXJ0eSBpbnRvIHRoZSBET00uIFRoaXMgd2lsbCBjcmVhdGUg
        YSBob29rIGluIERPTSB0aGF0IHRoZQovLyBLVk8gc3lzdGVtIHdpbGwgbG9v
        ayBmb3IgYW5kIHVwZGF0ZSBpZiB0aGUgcHJvcGVydHkgY2hhbmdlcy4KZnVu
        Y3Rpb24gYmluZChwcm9wZXJ0eSwgb3B0aW9ucywgcHJlc2VydmVDb250ZXh0
        LCBzaG91bGREaXNwbGF5LCB2YWx1ZU5vcm1hbGl6ZXIsIGNoaWxkUHJvcGVy
        dGllcykgewogIHZhciBkYXRhID0gb3B0aW9ucy5kYXRhLAogICAgICBmbiA9
        IG9wdGlvbnMuZm4sCiAgICAgIGludmVyc2UgPSBvcHRpb25zLmludmVyc2Us
        CiAgICAgIHZpZXcgPSBkYXRhLnZpZXcsCiAgICAgIGN1cnJlbnRDb250ZXh0
        ID0gdGhpcywKICAgICAgbm9ybWFsaXplZCwgb2JzZXJ2ZXIsIGk7CgogIG5v
        cm1hbGl6ZWQgPSBub3JtYWxpemVQYXRoKGN1cnJlbnRDb250ZXh0LCBwcm9w
        ZXJ0eSwgZGF0YSk7CgogIC8vIFNldCB1cCBvYnNlcnZlcnMgZm9yIG9ic2Vy
        dmFibGUgb2JqZWN0cwogIGlmICgnb2JqZWN0JyA9PT0gdHlwZW9mIHRoaXMp
        IHsKICAgIGlmIChkYXRhLmluc2lkZUdyb3VwKSB7CiAgICAgIG9ic2VydmVy
        ID0gZnVuY3Rpb24oKSB7CiAgICAgICAgRW1iZXIucnVuLm9uY2Uodmlldywg
        J3JlcmVuZGVyJyk7CiAgICAgIH07CgogICAgICB2YXIgdGVtcGxhdGUsIGNv
        bnRleHQsIHJlc3VsdCA9IGhhbmRsZWJhcnNHZXQoY3VycmVudENvbnRleHQs
        IHByb3BlcnR5LCBvcHRpb25zKTsKCiAgICAgIHJlc3VsdCA9IHZhbHVlTm9y
        bWFsaXplciA/IHZhbHVlTm9ybWFsaXplcihyZXN1bHQpIDogcmVzdWx0OwoK
        ICAgICAgY29udGV4dCA9IHByZXNlcnZlQ29udGV4dCA/IGN1cnJlbnRDb250
        ZXh0IDogcmVzdWx0OwogICAgICBpZiAoc2hvdWxkRGlzcGxheShyZXN1bHQp
        KSB7CiAgICAgICAgdGVtcGxhdGUgPSBmbjsKICAgICAgfSBlbHNlIGlmIChp
        bnZlcnNlKSB7CiAgICAgICAgdGVtcGxhdGUgPSBpbnZlcnNlOwogICAgICB9
        CgogICAgICB0ZW1wbGF0ZShjb250ZXh0LCB7IGRhdGE6IG9wdGlvbnMuZGF0
        YSB9KTsKICAgIH0gZWxzZSB7CiAgICAgIC8vIENyZWF0ZSB0aGUgdmlldyB0
        aGF0IHdpbGwgd3JhcCB0aGUgb3V0cHV0IG9mIHRoaXMgdGVtcGxhdGUvcHJv
        cGVydHkKICAgICAgLy8gYW5kIGFkZCBpdCB0byB0aGUgbmVhcmVzdCB2aWV3
        J3MgY2hpbGRWaWV3cyBhcnJheS4KICAgICAgLy8gU2VlIHRoZSBkb2N1bWVu
        dGF0aW9uIG9mIEVtYmVyLl9IYW5kbGViYXJzQm91bmRWaWV3IGZvciBtb3Jl
        LgogICAgICB2YXIgYmluZFZpZXcgPSB2aWV3LmNyZWF0ZUNoaWxkVmlldyhF
        bWJlci5fSGFuZGxlYmFyc0JvdW5kVmlldywgewogICAgICAgIHByZXNlcnZl
        Q29udGV4dDogcHJlc2VydmVDb250ZXh0LAogICAgICAgIHNob3VsZERpc3Bs
        YXlGdW5jOiBzaG91bGREaXNwbGF5LAogICAgICAgIHZhbHVlTm9ybWFsaXpl
        ckZ1bmM6IHZhbHVlTm9ybWFsaXplciwKICAgICAgICBkaXNwbGF5VGVtcGxh
        dGU6IGZuLAogICAgICAgIGludmVyc2VUZW1wbGF0ZTogaW52ZXJzZSwKICAg
        ICAgICBwYXRoOiBwcm9wZXJ0eSwKICAgICAgICBwYXRoUm9vdDogY3VycmVu
        dENvbnRleHQsCiAgICAgICAgcHJldmlvdXNDb250ZXh0OiBjdXJyZW50Q29u
        dGV4dCwKICAgICAgICBpc0VzY2FwZWQ6ICFvcHRpb25zLmhhc2gudW5lc2Nh
        cGVkLAogICAgICAgIHRlbXBsYXRlRGF0YTogb3B0aW9ucy5kYXRhCiAgICAg
        IH0pOwoKICAgICAgdmlldy5hcHBlbmRDaGlsZChiaW5kVmlldyk7CgogICAg
        ICBvYnNlcnZlciA9IGZ1bmN0aW9uKCkgewogICAgICAgIEVtYmVyLnJ1bi5z
        Y2hlZHVsZU9uY2UoJ3JlbmRlcicsIGJpbmRWaWV3LCAncmVyZW5kZXJJZk5l
        ZWRlZCcpOwogICAgICB9OwogICAgfQoKICAgIC8vIE9ic2VydmVzIHRoZSBn
        aXZlbiBwcm9wZXJ0eSBvbiB0aGUgY29udGV4dCBhbmQKICAgIC8vIHRlbGxz
        IHRoZSBFbWJlci5fSGFuZGxlYmFyc0JvdW5kVmlldyB0byByZS1yZW5kZXIu
        IElmIHByb3BlcnR5CiAgICAvLyBpcyBhbiBlbXB0eSBzdHJpbmcsIHdlIGFy
        ZSBwcmludGluZyB0aGUgY3VycmVudCBjb250ZXh0CiAgICAvLyBvYmplY3Qg
        KHt7dGhpc319KSBzbyB1cGRhdGluZyBpdCBpcyBub3Qgb3VyIHJlc3BvbnNp
        YmlsaXR5LgogICAgaWYgKG5vcm1hbGl6ZWQucGF0aCAhPT0gJycpIHsKICAg
        ICAgdmlldy5yZWdpc3Rlck9ic2VydmVyKG5vcm1hbGl6ZWQucm9vdCwgbm9y
        bWFsaXplZC5wYXRoLCBvYnNlcnZlcik7CiAgICAgIGlmIChjaGlsZFByb3Bl
        cnRpZXMpIHsKICAgICAgICBmb3IgKGk9MDsgaTxjaGlsZFByb3BlcnRpZXMu
        bGVuZ3RoOyBpKyspIHsKICAgICAgICAgIHZpZXcucmVnaXN0ZXJPYnNlcnZl
        cihub3JtYWxpemVkLnJvb3QsIG5vcm1hbGl6ZWQucGF0aCsnLicrY2hpbGRQ
        cm9wZXJ0aWVzW2ldLCBvYnNlcnZlcik7CiAgICAgICAgfQogICAgICB9CiAg
        ICB9CiAgfSBlbHNlIHsKICAgIC8vIFRoZSBvYmplY3QgaXMgbm90IG9ic2Vy
        dmFibGUsIHNvIGp1c3QgcmVuZGVyIGl0IG91dCBhbmQKICAgIC8vIGJlIGRv
        bmUgd2l0aCBpdC4KICAgIGRhdGEuYnVmZmVyLnB1c2goaGFuZGxlYmFyc0dl
        dChjdXJyZW50Q29udGV4dCwgcHJvcGVydHksIG9wdGlvbnMpKTsKICB9Cn0K
        CmZ1bmN0aW9uIHNpbXBsZUJpbmQoY3VycmVudENvbnRleHQsIHByb3BlcnR5
        LCBvcHRpb25zKSB7CiAgdmFyIGRhdGEgPSBvcHRpb25zLmRhdGEsCiAgICAg
        IHZpZXcgPSBkYXRhLnZpZXcsCiAgICAgIG5vcm1hbGl6ZWQsIG9ic2VydmVy
        LCBwYXRoUm9vdCwgb3V0cHV0OwoKICBub3JtYWxpemVkID0gbm9ybWFsaXpl
        UGF0aChjdXJyZW50Q29udGV4dCwgcHJvcGVydHksIGRhdGEpOwogIHBhdGhS
        b290ID0gbm9ybWFsaXplZC5yb290OwoKICAvLyBTZXQgdXAgb2JzZXJ2ZXJz
        IGZvciBvYnNlcnZhYmxlIG9iamVjdHMKICBpZiAocGF0aFJvb3QgJiYgKCdv
        YmplY3QnID09PSB0eXBlb2YgcGF0aFJvb3QpKSB7CiAgICBpZiAoZGF0YS5p
        bnNpZGVHcm91cCkgewogICAgICBvYnNlcnZlciA9IGZ1bmN0aW9uKCkgewog
        ICAgICAgIEVtYmVyLnJ1bi5vbmNlKHZpZXcsICdyZXJlbmRlcicpOwogICAg
        ICB9OwoKICAgICAgdmFyIHJlc3VsdCA9IGhhbmRsZWJhcnNHZXQoY3VycmVu
        dENvbnRleHQsIHByb3BlcnR5LCBvcHRpb25zKTsKICAgICAgaWYgKHJlc3Vs
        dCA9PT0gbnVsbCB8fCByZXN1bHQgPT09IHVuZGVmaW5lZCkgeyByZXN1bHQg
        PSAiIjsgfQogICAgICBkYXRhLmJ1ZmZlci5wdXNoKHJlc3VsdCk7CiAgICB9
        IGVsc2UgewogICAgICB2YXIgYmluZFZpZXcgPSBuZXcgRW1iZXIuX1NpbXBs
        ZUhhbmRsZWJhcnNWaWV3KAogICAgICAgIHByb3BlcnR5LCBjdXJyZW50Q29u
        dGV4dCwgIW9wdGlvbnMuaGFzaC51bmVzY2FwZWQsIG9wdGlvbnMuZGF0YQog
        ICAgICApOwoKICAgICAgYmluZFZpZXcuX3BhcmVudFZpZXcgPSB2aWV3Owog
        ICAgICB2aWV3LmFwcGVuZENoaWxkKGJpbmRWaWV3KTsKCiAgICAgIG9ic2Vy
        dmVyID0gZnVuY3Rpb24oKSB7CiAgICAgICAgRW1iZXIucnVuLnNjaGVkdWxl
        T25jZSgncmVuZGVyJywgYmluZFZpZXcsICdyZXJlbmRlcicpOwogICAgICB9
        OwogICAgfQoKICAgIC8vIE9ic2VydmVzIHRoZSBnaXZlbiBwcm9wZXJ0eSBv
        biB0aGUgY29udGV4dCBhbmQKICAgIC8vIHRlbGxzIHRoZSBFbWJlci5fSGFu
        ZGxlYmFyc0JvdW5kVmlldyB0byByZS1yZW5kZXIuIElmIHByb3BlcnR5CiAg
        ICAvLyBpcyBhbiBlbXB0eSBzdHJpbmcsIHdlIGFyZSBwcmludGluZyB0aGUg
        Y3VycmVudCBjb250ZXh0CiAgICAvLyBvYmplY3QgKHt7dGhpc319KSBzbyB1
        cGRhdGluZyBpdCBpcyBub3Qgb3VyIHJlc3BvbnNpYmlsaXR5LgogICAgaWYg
        KG5vcm1hbGl6ZWQucGF0aCAhPT0gJycpIHsKICAgICAgdmlldy5yZWdpc3Rl
        ck9ic2VydmVyKG5vcm1hbGl6ZWQucm9vdCwgbm9ybWFsaXplZC5wYXRoLCBv
        YnNlcnZlcik7CiAgICB9CiAgfSBlbHNlIHsKICAgIC8vIFRoZSBvYmplY3Qg
        aXMgbm90IG9ic2VydmFibGUsIHNvIGp1c3QgcmVuZGVyIGl0IG91dCBhbmQK
        ICAgIC8vIGJlIGRvbmUgd2l0aCBpdC4KICAgIG91dHB1dCA9IGhhbmRsZWJh
        cnNHZXQoY3VycmVudENvbnRleHQsIHByb3BlcnR5LCBvcHRpb25zKTsKICAg
        IGRhdGEuYnVmZmVyLnB1c2goKG91dHB1dCA9PT0gbnVsbCB8fCB0eXBlb2Yg
        b3V0cHV0ID09PSAndW5kZWZpbmVkJykgPyAnJyA6IG91dHB1dCk7CiAgfQp9
        CgovKioKICBAcHJpdmF0ZQoKICAnX3RyaWFnZU11c3RhY2hlJyBpcyB1c2Vk
        IGludGVybmFsbHkgc2VsZWN0IGJldHdlZW4gYSBiaW5kaW5nIGFuZCBoZWxw
        ZXIgZm9yCiAgdGhlIGdpdmVuIGNvbnRleHQuIFVudGlsIHRoaXMgcG9pbnQs
        IGl0IHdvdWxkIGJlIGhhcmQgdG8gZGV0ZXJtaW5lIGlmIHRoZQogIG11c3Rh
        Y2hlIGlzIGEgcHJvcGVydHkgcmVmZXJlbmNlIG9yIGEgcmVndWxhciBoZWxw
        ZXIgcmVmZXJlbmNlLiBUaGlzIHRyaWFnZQogIGhlbHBlciByZXNvbHZlcyB0
        aGF0LgoKICBUaGlzIHdvdWxkIG5vdCBiZSB0eXBpY2FsbHkgaW52b2tlZCBi
        eSBkaXJlY3RseS4KCiAgQG1ldGhvZCBfdHJpYWdlTXVzdGFjaGUKICBAZm9y
        IEVtYmVyLkhhbmRsZWJhcnMuaGVscGVycwogIEBwYXJhbSB7U3RyaW5nfSBw
        cm9wZXJ0eSBQcm9wZXJ0eS9oZWxwZXJJRCB0byB0cmlhZ2UKICBAcGFyYW0g
        e0Z1bmN0aW9ufSBmbiBDb250ZXh0IHRvIHByb3ZpZGUgZm9yIHJlbmRlcmlu
        ZwogIEByZXR1cm4ge1N0cmluZ30gSFRNTCBzdHJpbmcKKi8KRW1iZXJIYW5k
        bGViYXJzLnJlZ2lzdGVySGVscGVyKCdfdHJpYWdlTXVzdGFjaGUnLCBmdW5j
        dGlvbihwcm9wZXJ0eSwgZm4pIHsKICBFbWJlci5hc3NlcnQoIllvdSBjYW5u
        b3QgcGFzcyBtb3JlIHRoYW4gb25lIGFyZ3VtZW50IHRvIHRoZSBfdHJpYWdl
        TXVzdGFjaGUgaGVscGVyIiwgYXJndW1lbnRzLmxlbmd0aCA8PSAyKTsKICBp
        ZiAoaGVscGVyc1twcm9wZXJ0eV0pIHsKICAgIHJldHVybiBoZWxwZXJzW3By
        b3BlcnR5XS5jYWxsKHRoaXMsIGZuKTsKICB9CiAgZWxzZSB7CiAgICByZXR1
        cm4gaGVscGVycy5iaW5kLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgfQp9
        KTsKCi8qKgogIEBwcml2YXRlCgogIGBiaW5kYCBjYW4gYmUgdXNlZCB0byBk
        aXNwbGF5IGEgdmFsdWUsIHRoZW4gdXBkYXRlIHRoYXQgdmFsdWUgaWYgaXQK
        ICBjaGFuZ2VzLiBGb3IgZXhhbXBsZSwgaWYgeW91IHdhbnRlZCB0byBwcmlu
        dCB0aGUgYHRpdGxlYCBwcm9wZXJ0eSBvZgogIGBjb250ZW50YDoKCiAgYGBg
        aGFuZGxlYmFycwogIHt7YmluZCAiY29udGVudC50aXRsZSJ9fQogIGBgYAoK
        ICBUaGlzIHdpbGwgcmV0dXJuIHRoZSBgdGl0bGVgIHByb3BlcnR5IGFzIGEg
        c3RyaW5nLCB0aGVuIGNyZWF0ZSBhIG5ldyBvYnNlcnZlcgogIGF0IHRoZSBz
        cGVjaWZpZWQgcGF0aC4gSWYgaXQgY2hhbmdlcywgaXQgd2lsbCB1cGRhdGUg
        dGhlIHZhbHVlIGluIERPTS4gTm90ZQogIHRoYXQgaWYgeW91IG5lZWQgdG8g
        c3VwcG9ydCBJRTcgYW5kIElFOCB5b3UgbXVzdCBtb2RpZnkgdGhlIG1vZGVs
        IG9iamVjdHMKICBwcm9wZXJ0aWVzIHVzaW5nIGBFbWJlci5nZXQoKWAgYW5k
        IGBFbWJlci5zZXQoKWAgZm9yIHRoaXMgdG8gd29yayBhcyBpdAogIHJlbGll
        cyBvbiBFbWJlcidzIEtWTyBzeXN0ZW0uIEZvciBhbGwgb3RoZXIgYnJvd3Nl
        cnMgdGhpcyB3aWxsIGJlIGhhbmRsZWQgZm9yCiAgeW91IGF1dG9tYXRpY2Fs
        bHkuCgogIEBtZXRob2QgYmluZAogIEBmb3IgRW1iZXIuSGFuZGxlYmFycy5o
        ZWxwZXJzCiAgQHBhcmFtIHtTdHJpbmd9IHByb3BlcnR5IFByb3BlcnR5IHRv
        IGJpbmQKICBAcGFyYW0ge0Z1bmN0aW9ufSBmbiBDb250ZXh0IHRvIHByb3Zp
        ZGUgZm9yIHJlbmRlcmluZwogIEByZXR1cm4ge1N0cmluZ30gSFRNTCBzdHJp
        bmcKKi8KRW1iZXJIYW5kbGViYXJzLnJlZ2lzdGVySGVscGVyKCdiaW5kJywg
        ZnVuY3Rpb24ocHJvcGVydHksIG9wdGlvbnMpIHsKICBFbWJlci5hc3NlcnQo
        IllvdSBjYW5ub3QgcGFzcyBtb3JlIHRoYW4gb25lIGFyZ3VtZW50IHRvIHRo
        ZSBiaW5kIGhlbHBlciIsIGFyZ3VtZW50cy5sZW5ndGggPD0gMik7CgogIHZh
        ciBjb250ZXh0ID0gKG9wdGlvbnMuY29udGV4dHMgJiYgb3B0aW9ucy5jb250
        ZXh0cy5sZW5ndGgpID8gb3B0aW9ucy5jb250ZXh0c1swXSA6IHRoaXM7Cgog
        IGlmICghb3B0aW9ucy5mbikgewogICAgcmV0dXJuIHNpbXBsZUJpbmQoY29u
        dGV4dCwgcHJvcGVydHksIG9wdGlvbnMpOwogIH0KCiAgcmV0dXJuIGJpbmQu
        Y2FsbChjb250ZXh0LCBwcm9wZXJ0eSwgb3B0aW9ucywgZmFsc2UsIGV4aXN0
        cyk7Cn0pOwoKLyoqCiAgQHByaXZhdGUKCiAgVXNlIHRoZSBgYm91bmRJZmAg
        aGVscGVyIHRvIGNyZWF0ZSBhIGNvbmRpdGlvbmFsIHRoYXQgcmUtZXZhbHVh
        dGVzCiAgd2hlbmV2ZXIgdGhlIHRydXRoaW5lc3Mgb2YgdGhlIGJvdW5kIHZh
        bHVlIGNoYW5nZXMuCgogIGBgYGhhbmRsZWJhcnMKICB7eyNib3VuZElmICJj
        b250ZW50LnNob3VsZERpc3BsYXlUaXRsZSJ9fQogICAge3tjb250ZW50LnRp
        dGxlfX0KICB7ey9ib3VuZElmfX0KICBgYGAKCiAgQG1ldGhvZCBib3VuZElm
        CiAgQGZvciBFbWJlci5IYW5kbGViYXJzLmhlbHBlcnMKICBAcGFyYW0ge1N0
        cmluZ30gcHJvcGVydHkgUHJvcGVydHkgdG8gYmluZAogIEBwYXJhbSB7RnVu
        Y3Rpb259IGZuIENvbnRleHQgdG8gcHJvdmlkZSBmb3IgcmVuZGVyaW5nCiAg
        QHJldHVybiB7U3RyaW5nfSBIVE1MIHN0cmluZwoqLwpFbWJlckhhbmRsZWJh
        cnMucmVnaXN0ZXJIZWxwZXIoJ2JvdW5kSWYnLCBmdW5jdGlvbihwcm9wZXJ0
        eSwgZm4pIHsKICB2YXIgY29udGV4dCA9IChmbi5jb250ZXh0cyAmJiBmbi5j
        b250ZXh0cy5sZW5ndGgpID8gZm4uY29udGV4dHNbMF0gOiB0aGlzOwogIHZh
        ciBmdW5jID0gZnVuY3Rpb24ocmVzdWx0KSB7CiAgICB2YXIgdHJ1dGh5ID0g
        cmVzdWx0ICYmIGdldChyZXN1bHQsICdpc1RydXRoeScpOwogICAgaWYgKHR5
        cGVvZiB0cnV0aHkgPT09ICdib29sZWFuJykgeyByZXR1cm4gdHJ1dGh5OyB9
        CgogICAgaWYgKEVtYmVyLmlzQXJyYXkocmVzdWx0KSkgewogICAgICByZXR1
        cm4gZ2V0KHJlc3VsdCwgJ2xlbmd0aCcpICE9PSAwOwogICAgfSBlbHNlIHsK
        ICAgICAgcmV0dXJuICEhcmVzdWx0OwogICAgfQogIH07CgogIHJldHVybiBi
        aW5kLmNhbGwoY29udGV4dCwgcHJvcGVydHksIGZuLCB0cnVlLCBmdW5jLCBm
        dW5jLCBbJ2lzVHJ1dGh5JywgJ2xlbmd0aCddKTsKfSk7CgovKioKICBAbWV0
        aG9kIHdpdGgKICBAZm9yIEVtYmVyLkhhbmRsZWJhcnMuaGVscGVycwogIEBw
        YXJhbSB7RnVuY3Rpb259IGNvbnRleHQKICBAcGFyYW0ge0hhc2h9IG9wdGlv
        bnMKICBAcmV0dXJuIHtTdHJpbmd9IEhUTUwgc3RyaW5nCiovCkVtYmVySGFu
        ZGxlYmFycy5yZWdpc3RlckhlbHBlcignd2l0aCcsIGZ1bmN0aW9uKGNvbnRl
        eHQsIG9wdGlvbnMpIHsKICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gNCkg
        ewogICAgdmFyIGtleXdvcmROYW1lLCBwYXRoLCByb290UGF0aCwgbm9ybWFs
        aXplZDsKCiAgICBFbWJlci5hc3NlcnQoIklmIHlvdSBwYXNzIG1vcmUgdGhh
        biBvbmUgYXJndW1lbnQgdG8gdGhlIHdpdGggaGVscGVyLCBpdCBtdXN0IGJl
        IGluIHRoZSBmb3JtICN3aXRoIGZvbyBhcyBiYXIiLCBhcmd1bWVudHNbMV0g
        PT09ICJhcyIpOwogICAgb3B0aW9ucyA9IGFyZ3VtZW50c1szXTsKICAgIGtl
        eXdvcmROYW1lID0gYXJndW1lbnRzWzJdOwogICAgcGF0aCA9IGFyZ3VtZW50
        c1swXTsKCiAgICBFbWJlci5hc3NlcnQoIllvdSBtdXN0IHBhc3MgYSBibG9j
        ayB0byB0aGUgd2l0aCBoZWxwZXIiLCBvcHRpb25zLmZuICYmIG9wdGlvbnMu
        Zm4gIT09IEhhbmRsZWJhcnMuVk0ubm9vcCk7CgogICAgaWYgKEVtYmVyLmlz
        R2xvYmFsUGF0aChwYXRoKSkgewogICAgICBFbWJlci5iaW5kKG9wdGlvbnMu
        ZGF0YS5rZXl3b3Jkcywga2V5d29yZE5hbWUsIHBhdGgpOwogICAgfSBlbHNl
        IHsKICAgICAgbm9ybWFsaXplZCA9IG5vcm1hbGl6ZVBhdGgodGhpcywgcGF0
        aCwgb3B0aW9ucy5kYXRhKTsKICAgICAgcGF0aCA9IG5vcm1hbGl6ZWQucGF0
        aDsKICAgICAgcm9vdFBhdGggPSBub3JtYWxpemVkLnJvb3Q7CgogICAgICAv
        LyBUaGlzIGlzIGEgd29ya2Fyb3VuZCBmb3IgdGhlIGZhY3QgdGhhdCB5b3Ug
        Y2Fubm90IGJpbmQgc2VwYXJhdGUgb2JqZWN0cwogICAgICAvLyB0b2dldGhl
        ci4gV2hlbiB3ZSBpbXBsZW1lbnQgdGhhdCBmdW5jdGlvbmFsaXR5LCB3ZSBz
        aG91bGQgdXNlIGl0IGhlcmUuCiAgICAgIHZhciBjb250ZXh0S2V5ID0gRW1i
        ZXIuJC5leHBhbmRvICsgRW1iZXIuZ3VpZEZvcihyb290UGF0aCk7CiAgICAg
        IG9wdGlvbnMuZGF0YS5rZXl3b3Jkc1tjb250ZXh0S2V5XSA9IHJvb3RQYXRo
        OwoKICAgICAgLy8gaWYgdGhlIHBhdGggaXMgJycgKCJ0aGlzIiksIGp1c3Qg
        YmluZCBkaXJlY3RseSB0byB0aGUgY3VycmVudCBjb250ZXh0CiAgICAgIHZh
        ciBjb250ZXh0UGF0aCA9IHBhdGggPyBjb250ZXh0S2V5ICsgJy4nICsgcGF0
        aCA6IGNvbnRleHRLZXk7CiAgICAgIEVtYmVyLmJpbmQob3B0aW9ucy5kYXRh
        LmtleXdvcmRzLCBrZXl3b3JkTmFtZSwgY29udGV4dFBhdGgpOwogICAgfQoK
        ICAgIHJldHVybiBiaW5kLmNhbGwodGhpcywgcGF0aCwgb3B0aW9ucywgdHJ1
        ZSwgZXhpc3RzKTsKICB9IGVsc2UgewogICAgRW1iZXIuYXNzZXJ0KCJZb3Ug
        bXVzdCBwYXNzIGV4YWN0bHkgb25lIGFyZ3VtZW50IHRvIHRoZSB3aXRoIGhl
        bHBlciIsIGFyZ3VtZW50cy5sZW5ndGggPT09IDIpOwogICAgRW1iZXIuYXNz
        ZXJ0KCJZb3UgbXVzdCBwYXNzIGEgYmxvY2sgdG8gdGhlIHdpdGggaGVscGVy
        Iiwgb3B0aW9ucy5mbiAmJiBvcHRpb25zLmZuICE9PSBIYW5kbGViYXJzLlZN
        Lm5vb3ApOwogICAgcmV0dXJuIGhlbHBlcnMuYmluZC5jYWxsKG9wdGlvbnMu
        Y29udGV4dHNbMF0sIGNvbnRleHQsIG9wdGlvbnMpOwogIH0KfSk7CgoKLyoq
        CiAgU2VlIFtib3VuZElmXSgvYXBpL2NsYXNzZXMvRW1iZXIuSGFuZGxlYmFy
        cy5oZWxwZXJzLmh0bWwjbWV0aG9kX2JvdW5kSWYpCgogIEBtZXRob2QgaWYK
        ICBAZm9yIEVtYmVyLkhhbmRsZWJhcnMuaGVscGVycwogIEBwYXJhbSB7RnVu
        Y3Rpb259IGNvbnRleHQKICBAcGFyYW0ge0hhc2h9IG9wdGlvbnMKICBAcmV0
        dXJuIHtTdHJpbmd9IEhUTUwgc3RyaW5nCiovCkVtYmVySGFuZGxlYmFycy5y
        ZWdpc3RlckhlbHBlcignaWYnLCBmdW5jdGlvbihjb250ZXh0LCBvcHRpb25z
        KSB7CiAgRW1iZXIuYXNzZXJ0KCJZb3UgbXVzdCBwYXNzIGV4YWN0bHkgb25l
        IGFyZ3VtZW50IHRvIHRoZSBpZiBoZWxwZXIiLCBhcmd1bWVudHMubGVuZ3Ro
        ID09PSAyKTsKICBFbWJlci5hc3NlcnQoIllvdSBtdXN0IHBhc3MgYSBibG9j
        ayB0byB0aGUgaWYgaGVscGVyIiwgb3B0aW9ucy5mbiAmJiBvcHRpb25zLmZu
        ICE9PSBIYW5kbGViYXJzLlZNLm5vb3ApOwoKICByZXR1cm4gaGVscGVycy5i
        b3VuZElmLmNhbGwob3B0aW9ucy5jb250ZXh0c1swXSwgY29udGV4dCwgb3B0
        aW9ucyk7Cn0pOwoKLyoqCiAgQG1ldGhvZCB1bmxlc3MKICBAZm9yIEVtYmVy
        LkhhbmRsZWJhcnMuaGVscGVycwogIEBwYXJhbSB7RnVuY3Rpb259IGNvbnRl
        eHQKICBAcGFyYW0ge0hhc2h9IG9wdGlvbnMKICBAcmV0dXJuIHtTdHJpbmd9
        IEhUTUwgc3RyaW5nCiovCkVtYmVySGFuZGxlYmFycy5yZWdpc3RlckhlbHBl
        cigndW5sZXNzJywgZnVuY3Rpb24oY29udGV4dCwgb3B0aW9ucykgewogIEVt
        YmVyLmFzc2VydCgiWW91IG11c3QgcGFzcyBleGFjdGx5IG9uZSBhcmd1bWVu
        dCB0byB0aGUgdW5sZXNzIGhlbHBlciIsIGFyZ3VtZW50cy5sZW5ndGggPT09
        IDIpOwogIEVtYmVyLmFzc2VydCgiWW91IG11c3QgcGFzcyBhIGJsb2NrIHRv
        IHRoZSB1bmxlc3MgaGVscGVyIiwgb3B0aW9ucy5mbiAmJiBvcHRpb25zLmZu
        ICE9PSBIYW5kbGViYXJzLlZNLm5vb3ApOwoKICB2YXIgZm4gPSBvcHRpb25z
        LmZuLCBpbnZlcnNlID0gb3B0aW9ucy5pbnZlcnNlOwoKICBvcHRpb25zLmZu
        ID0gaW52ZXJzZTsKICBvcHRpb25zLmludmVyc2UgPSBmbjsKCiAgcmV0dXJu
        IGhlbHBlcnMuYm91bmRJZi5jYWxsKG9wdGlvbnMuY29udGV4dHNbMF0sIGNv
        bnRleHQsIG9wdGlvbnMpOwp9KTsKCi8qKgogIGBiaW5kLWF0dHJgIGFsbG93
        cyB5b3UgdG8gY3JlYXRlIGEgYmluZGluZyBiZXR3ZWVuIERPTSBlbGVtZW50
        IGF0dHJpYnV0ZXMgYW5kCiAgRW1iZXIgb2JqZWN0cy4gRm9yIGV4YW1wbGU6
        CgogIGBgYGhhbmRsZWJhcnMKICA8aW1nIHt7YmluZC1hdHRyIHNyYz0iaW1h
        Z2VVcmwiIGFsdD0iaW1hZ2VUaXRsZSJ9fT4KICBgYGAKCiAgVGhlIGFib3Zl
        IGhhbmRsZWJhcnMgdGVtcGxhdGUgd2lsbCBmaWxsIHRoZSBgPGltZz5gJ3Mg
        YHNyY2AgYXR0cmlidXRlIHdpbGwKICB0aGUgdmFsdWUgb2YgdGhlIHByb3Bl
        cnR5IHJlZmVyZW5jZWQgd2l0aCBgImltYWdlVXJsImAgYW5kIGl0cyBgYWx0
        YAogIGF0dHJpYnV0ZSB3aXRoIHRoZSB2YWx1ZSBvZiB0aGUgcHJvcGVydHkg
        cmVmZXJlbmNlZCB3aXRoIGAiaW1hZ2VUaXRsZSJgLgoKICBJZiB0aGUgcmVu
        ZGVyaW5nIGNvbnRleHQgb2YgdGhpcyB0ZW1wbGF0ZSBpcyB0aGUgZm9sbG93
        aW5nIG9iamVjdDoKCiAgYGBgamF2YXNjcmlwdAogIHsKICAgIGltYWdlVXJs
        OiAnaHR0cDovL2xvbGNhdHMuaW5mby9oYXotYS1mdW5ueScsCiAgICBpbWFn
        ZVRpdGxlOiAnQSBodW1vcm91cyBpbWFnZSBvZiBhIGNhdCcKICB9CiAgYGBg
        CgogIFRoZSByZXN1bHRpbmcgSFRNTCBvdXRwdXQgd2lsbCBiZToKCiAgYGBg
        aHRtbAogIDxpbWcgc3JjPSJodHRwOi8vbG9sY2F0cy5pbmZvL2hhei1hLWZ1
        bm55IiBhbHQ9IkEgaHVtb3JvdXMgaW1hZ2Ugb2YgYSBjYXQiPgogIGBgYAoK
        ICBgYmluZC1hdHRyYCBjYW5ub3QgcmVkZWNsYXJlIGV4aXN0aW5nIERPTSBl
        bGVtZW50IGF0dHJpYnV0ZXMuIFRoZSB1c2Ugb2YgYHNyY2AKICBpbiB0aGUg
        Zm9sbG93aW5nIGBiaW5kLWF0dHJgIGV4YW1wbGUgd2lsbCBiZSBpZ25vcmVk
        IGFuZCB0aGUgaGFyZCBjb2RlZCB2YWx1ZQogIG9mIGBzcmM9Ii9mYWlsd2hh
        bGUuZ2lmImAgd2lsbCB0YWtlIHByZWNlZGVuY2U6CgogIGBgYGhhbmRsZWJh
        cnMKICA8aW1nIHNyYz0iL2ZhaWx3aGFsZS5naWYiIHt7YmluZC1hdHRyIHNy
        Yz0iaW1hZ2VVcmwiIGFsdD0iaW1hZ2VUaXRsZSJ9fT4KICBgYGAKCiAgIyMj
        IGBiaW5kLWF0dHJgIGFuZCB0aGUgYGNsYXNzYCBhdHRyaWJ1dGUKCiAgYGJp
        bmQtYXR0cmAgc3VwcG9ydHMgYSBzcGVjaWFsIHN5bnRheCBmb3IgaGFuZGxp
        bmcgYSBudW1iZXIgb2YgY2FzZXMgdW5pcXVlCiAgdG8gdGhlIGBjbGFzc2Ag
        RE9NIGVsZW1lbnQgYXR0cmlidXRlLiBUaGUgYGNsYXNzYCBhdHRyaWJ1dGUg
        Y29tYmluZXMKICBtdWx0aXBsZSBkaXNjcmVldCB2YWx1ZXMgaW50byBhIHNp
        bmdsZSBhdHRyaWJ1dGUgYXMgYSBzcGFjZS1kZWxpbWl0ZWQKICBsaXN0IG9m
        IHN0cmluZ3MuIEVhY2ggc3RyaW5nIGNhbiBiZToKCiAgKiBhIHN0cmluZyBy
        ZXR1cm4gdmFsdWUgb2YgYW4gb2JqZWN0J3MgcHJvcGVydHkuCiAgKiBhIGJv
        b2xlYW4gcmV0dXJuIHZhbHVlIG9mIGFuIG9iamVjdCdzIHByb3BlcnR5CiAg
        KiBhIGhhcmQtY29kZWQgdmFsdWUKCiAgQSBzdHJpbmcgcmV0dXJuIHZhbHVl
        IHdvcmtzIGlkZW50aWNhbGx5IHRvIG90aGVyIHVzZXMgb2YgYGJpbmQtYXR0
        cmAuIFRoZQogIHJldHVybiB2YWx1ZSBvZiB0aGUgcHJvcGVydHkgd2lsbCBi
        ZWNvbWUgdGhlIHZhbHVlIG9mIHRoZSBhdHRyaWJ1dGUuIEZvcgogIGV4YW1w
        bGUsIHRoZSBmb2xsb3dpbmcgdmlldyBhbmQgdGVtcGxhdGU6CgogIGBgYGph
        dmFzY3JpcHQKICAgIEFWaWV3ID0gRW1iZXIuVmlldy5leHRlbmQoewogICAg
        ICBzb21lUHJvcGVydHk6IGZ1bmN0aW9uKCkgewogICAgICAgIHJldHVybiAi
        YVZhbHVlIjsKICAgICAgfS5wcm9wZXJ0eSgpCiAgICB9KQogIGBgYAoKICBg
        YGBoYW5kbGViYXJzCiAgPGltZyB7e2JpbmQtYXR0ciBjbGFzcz0idmlldy5z
        b21lUHJvcGVydHl9fT4KICBgYGAKCiAgUmVzdWx0IGluIHRoZSBmb2xsb3dp
        bmcgcmVuZGVyZWQgb3V0cHV0OgoKICBgYGBodG1sCiAgPGltZyBjbGFzcz0i
        YVZhbHVlIj4KICBgYGAKCiAgQSBib29sZWFuIHJldHVybiB2YWx1ZSB3aWxs
        IGluc2VydCBhIHNwZWNpZmllZCBjbGFzcyBuYW1lIGlmIHRoZSBwcm9wZXJ0
        eQogIHJldHVybnMgYHRydWVgIGFuZCByZW1vdmUgdGhlIGNsYXNzIG5hbWUg
        aWYgdGhlIHByb3BlcnR5IHJldHVybnMgYGZhbHNlYC4KCiAgQSBjbGFzcyBu
        YW1lIGlzIHByb3ZpZGVkIHZpYSB0aGUgc3ludGF4CiAgYHNvbWVQcm9wZXJ0
        eU5hbWU6Y2xhc3MtbmFtZS1pZi10cnVlYC4KCiAgYGBgamF2YXNjcmlwdAog
        IEFWaWV3ID0gRW1iZXIuVmlldy5leHRlbmQoewogICAgc29tZUJvb2w6IHRy
        dWUKICB9KQogIGBgYAoKICBgYGBoYW5kbGViYXJzCiAgPGltZyB7e2JpbmQt
        YXR0ciBjbGFzcz0idmlldy5zb21lQm9vbDpjbGFzcy1uYW1lLWlmLXRydWUi
        fX0+CiAgYGBgCgogIFJlc3VsdCBpbiB0aGUgZm9sbG93aW5nIHJlbmRlcmVk
        IG91dHB1dDoKCiAgYGBgaHRtbAogIDxpbWcgY2xhc3M9ImNsYXNzLW5hbWUt
        aWYtdHJ1ZSI+CiAgYGBgCgogIEFuIGFkZGl0aW9uYWwgc2VjdGlvbiBvZiB0
        aGUgYmluZGluZyBjYW4gYmUgcHJvdmlkZWQgaWYgeW91IHdhbnQgdG8KICBy
        ZXBsYWNlIHRoZSBleGlzdGluZyBjbGFzcyBpbnN0ZWFkIG9mIHJlbW92aW5n
        IGl0IHdoZW4gdGhlIGJvb2xlYW4KICB2YWx1ZSBjaGFuZ2VzOgoKICBgYGBo
        YW5kbGViYXJzCiAgPGltZyB7e2JpbmQtYXR0ciBjbGFzcz0idmlldy5zb21l
        Qm9vbDpjbGFzcy1uYW1lLWlmLXRydWU6Y2xhc3MtbmFtZS1pZi1mYWxzZSJ9
        fT4KICBgYGAKCiAgQSBoYXJkLWNvZGVkIHZhbHVlIGNhbiBiZSB1c2VkIGJ5
        IHByZXBlbmRpbmcgYDpgIHRvIHRoZSBkZXNpcmVkCiAgY2xhc3MgbmFtZTog
        YDpjbGFzcy1uYW1lLXRvLWFsd2F5cy1hcHBseWAuCgogIGBgYGhhbmRsZWJh
        cnMKICA8aW1nIHt7YmluZC1hdHRyIGNsYXNzPSI6Y2xhc3MtbmFtZS10by1h
        bHdheXMtYXBwbHkifX0+CiAgYGBgCgogIFJlc3VsdHMgaW4gdGhlIGZvbGxv
        d2luZyByZW5kZXJlZCBvdXRwdXQ6CgogIGBgYGh0bWwKICA8aW1nIGNsYXNz
        PSJjbGFzcy1uYW1lLXRvLWFsd2F5cy1hcHBseSI+CiAgYGBgCgogIEFsbCB0
        aHJlZSBzdHJhdGVnaWVzIC0gc3RyaW5nIHJldHVybiB2YWx1ZSwgYm9vbGVh
        biByZXR1cm4gdmFsdWUsIGFuZAogIGhhcmQtY29kZWQgdmFsdWUg4oCTIGNh
        biBiZSBjb21iaW5lZCBpbiBhIHNpbmdsZSBkZWNsYXJhdGlvbjoKCiAgYGBg
        aGFuZGxlYmFycwogIDxpbWcge3tiaW5kLWF0dHIgY2xhc3M9IjpjbGFzcy1u
        YW1lLXRvLWFsd2F5cy1hcHBseSB2aWV3LnNvbWVCb29sOmNsYXNzLW5hbWUt
        aWYtdHJ1ZSB2aWV3LnNvbWVQcm9wZXJ0eSJ9fT4KICBgYGAKCiAgQG1ldGhv
        ZCBiaW5kLWF0dHIKICBAZm9yIEVtYmVyLkhhbmRsZWJhcnMuaGVscGVycwog
        IEBwYXJhbSB7SGFzaH0gb3B0aW9ucwogIEByZXR1cm4ge1N0cmluZ30gSFRN
        TCBzdHJpbmcKKi8KRW1iZXJIYW5kbGViYXJzLnJlZ2lzdGVySGVscGVyKCdi
        aW5kLWF0dHInLCBmdW5jdGlvbihvcHRpb25zKSB7CgogIHZhciBhdHRycyA9
        IG9wdGlvbnMuaGFzaDsKCiAgRW1iZXIuYXNzZXJ0KCJZb3UgbXVzdCBzcGVj
        aWZ5IGF0IGxlYXN0IG9uZSBoYXNoIGFyZ3VtZW50IHRvIGJpbmQtYXR0ciIs
        ICEhRW1iZXIua2V5cyhhdHRycykubGVuZ3RoKTsKCiAgdmFyIHZpZXcgPSBv
        cHRpb25zLmRhdGEudmlldzsKICB2YXIgcmV0ID0gW107CiAgdmFyIGN0eCA9
        IHRoaXM7CgogIC8vIEdlbmVyYXRlIGEgdW5pcXVlIGlkIGZvciB0aGlzIGVs
        ZW1lbnQuIFRoaXMgd2lsbCBiZSBhZGRlZCBhcyBhCiAgLy8gZGF0YSBhdHRy
        aWJ1dGUgdG8gdGhlIGVsZW1lbnQgc28gaXQgY2FuIGJlIGxvb2tlZCB1cCB3
        aGVuCiAgLy8gdGhlIGJvdW5kIHByb3BlcnR5IGNoYW5nZXMuCiAgdmFyIGRh
        dGFJZCA9ICsrRW1iZXIudXVpZDsKCiAgLy8gSGFuZGxlIGNsYXNzZXMgZGlm
        ZmVyZW50bHksIGFzIHdlIGNhbiBiaW5kIG11bHRpcGxlIGNsYXNzZXMKICB2
        YXIgY2xhc3NCaW5kaW5ncyA9IGF0dHJzWydjbGFzcyddOwogIGlmIChjbGFz
        c0JpbmRpbmdzICE9IG51bGwpIHsKICAgIHZhciBjbGFzc1Jlc3VsdHMgPSBF
        bWJlckhhbmRsZWJhcnMuYmluZENsYXNzZXModGhpcywgY2xhc3NCaW5kaW5n
        cywgdmlldywgZGF0YUlkLCBvcHRpb25zKTsKCiAgICByZXQucHVzaCgnY2xh
        c3M9IicgKyBIYW5kbGViYXJzLlV0aWxzLmVzY2FwZUV4cHJlc3Npb24oY2xh
        c3NSZXN1bHRzLmpvaW4oJyAnKSkgKyAnIicpOwogICAgZGVsZXRlIGF0dHJz
        WydjbGFzcyddOwogIH0KCiAgdmFyIGF0dHJLZXlzID0gRW1iZXIua2V5cyhh
        dHRycyk7CgogIC8vIEZvciBlYWNoIGF0dHJpYnV0ZSBwYXNzZWQsIGNyZWF0
        ZSBhbiBvYnNlcnZlciBhbmQgZW1pdCB0aGUKICAvLyBjdXJyZW50IHZhbHVl
        IG9mIHRoZSBwcm9wZXJ0eSBhcyBhbiBhdHRyaWJ1dGUuCiAgZm9yRWFjaC5j
        YWxsKGF0dHJLZXlzLCBmdW5jdGlvbihhdHRyKSB7CiAgICB2YXIgcGF0aCA9
        IGF0dHJzW2F0dHJdLAogICAgICAgIG5vcm1hbGl6ZWQ7CgogICAgRW1iZXIu
        YXNzZXJ0KGZtdCgiWW91IG11c3QgcHJvdmlkZSBhbiBleHByZXNzaW9uIGFz
        IHRoZSB2YWx1ZSBvZiBib3VuZCBhdHRyaWJ1dGUuIFlvdSBzcGVjaWZpZWQ6
        ICVAPSVAIiwgW2F0dHIsIHBhdGhdKSwgdHlwZW9mIHBhdGggPT09ICdzdHJp
        bmcnKTsKCiAgICBub3JtYWxpemVkID0gbm9ybWFsaXplUGF0aChjdHgsIHBh
        dGgsIG9wdGlvbnMuZGF0YSk7CgogICAgdmFyIHZhbHVlID0gKHBhdGggPT09
        ICd0aGlzJykgPyBub3JtYWxpemVkLnJvb3QgOiBoYW5kbGViYXJzR2V0KGN0
        eCwgcGF0aCwgb3B0aW9ucyksCiAgICAgICAgdHlwZSA9IEVtYmVyLnR5cGVP
        Zih2YWx1ZSk7CgogICAgRW1iZXIuYXNzZXJ0KGZtdCgiQXR0cmlidXRlcyBt
        dXN0IGJlIG51bWJlcnMsIHN0cmluZ3Mgb3IgYm9vbGVhbnMsIG5vdCAlQCIs
        IFt2YWx1ZV0pLCB2YWx1ZSA9PT0gbnVsbCB8fCB2YWx1ZSA9PT0gdW5kZWZp
        bmVkIHx8IHR5cGUgPT09ICdudW1iZXInIHx8IHR5cGUgPT09ICdzdHJpbmcn
        IHx8IHR5cGUgPT09ICdib29sZWFuJyk7CgogICAgdmFyIG9ic2VydmVyLCBp
        bnZva2VyOwoKICAgIG9ic2VydmVyID0gZnVuY3Rpb24gb2JzZXJ2ZXIoKSB7
        CiAgICAgIHZhciByZXN1bHQgPSBoYW5kbGViYXJzR2V0KGN0eCwgcGF0aCwg
        b3B0aW9ucyk7CgogICAgICBFbWJlci5hc3NlcnQoZm10KCJBdHRyaWJ1dGVz
        IG11c3QgYmUgbnVtYmVycywgc3RyaW5ncyBvciBib29sZWFucywgbm90ICVA
        IiwgW3Jlc3VsdF0pLCByZXN1bHQgPT09IG51bGwgfHwgcmVzdWx0ID09PSB1
        bmRlZmluZWQgfHwgdHlwZW9mIHJlc3VsdCA9PT0gJ251bWJlcicgfHwgdHlw
        ZW9mIHJlc3VsdCA9PT0gJ3N0cmluZycgfHwgdHlwZW9mIHJlc3VsdCA9PT0g
        J2Jvb2xlYW4nKTsKCiAgICAgIHZhciBlbGVtID0gdmlldy4kKCJbZGF0YS1i
        aW5kYXR0ci0iICsgZGF0YUlkICsgIj0nIiArIGRhdGFJZCArICInXSIpOwoK
        ICAgICAgLy8gSWYgd2UgYXJlbid0IGFibGUgdG8gZmluZCB0aGUgZWxlbWVu
        dCwgaXQgbWVhbnMgdGhlIGVsZW1lbnQKICAgICAgLy8gdG8gd2hpY2ggd2Ug
        d2VyZSBib3VuZCBoYXMgYmVlbiByZW1vdmVkIGZyb20gdGhlIHZpZXcuCiAg
        ICAgIC8vIEluIHRoYXQgY2FzZSwgd2UgY2FuIGFzc3VtZSB0aGUgdGVtcGxh
        dGUgaGFzIGJlZW4gcmUtcmVuZGVyZWQKICAgICAgLy8gYW5kIHdlIG5lZWQg
        dG8gY2xlYW4gdXAgdGhlIG9ic2VydmVyLgogICAgICBpZiAoIWVsZW0gfHwg
        ZWxlbS5sZW5ndGggPT09IDApIHsKICAgICAgICBFbWJlci5yZW1vdmVPYnNl
        cnZlcihub3JtYWxpemVkLnJvb3QsIG5vcm1hbGl6ZWQucGF0aCwgaW52b2tl
        cik7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBFbWJlci5WaWV3
        LmFwcGx5QXR0cmlidXRlQmluZGluZ3MoZWxlbSwgYXR0ciwgcmVzdWx0KTsK
        ICAgIH07CgogICAgLy8gQWRkIGFuIG9ic2VydmVyIHRvIHRoZSB2aWV3IGZv
        ciB3aGVuIHRoZSBwcm9wZXJ0eSBjaGFuZ2VzLgogICAgLy8gV2hlbiB0aGUg
        b2JzZXJ2ZXIgZmlyZXMsIGZpbmQgdGhlIGVsZW1lbnQgdXNpbmcgdGhlCiAg
        ICAvLyB1bmlxdWUgZGF0YSBpZCBhbmQgdXBkYXRlIHRoZSBhdHRyaWJ1dGUg
        dG8gdGhlIG5ldyB2YWx1ZS4KICAgIC8vIE5vdGU6IGRvbid0IGFkZCBvYnNl
        cnZlciB3aGVuIHBhdGggaXMgJ3RoaXMnIG9yIHBhdGgKICAgIC8vIGlzIHdo
        b2xlIGtleXdvcmQgZS5nLiB7eyNlYWNoIHggaW4gbGlzdH19IC4uLiB7e2Jp
        bmQtYXR0ciBhdHRyPSJ4In19CiAgICBpZiAocGF0aCAhPT0gJ3RoaXMnICYm
        ICEobm9ybWFsaXplZC5pc0tleXdvcmQgJiYgbm9ybWFsaXplZC5wYXRoID09
        PSAnJyApKSB7CiAgICAgIHZpZXcucmVnaXN0ZXJPYnNlcnZlcihub3JtYWxp
        emVkLnJvb3QsIG5vcm1hbGl6ZWQucGF0aCwgb2JzZXJ2ZXIpOwogICAgfQoK
        ICAgIC8vIGlmIHRoaXMgY2hhbmdlcywgYWxzbyBjaGFuZ2UgdGhlIGxvZ2lj
        IGluIGVtYmVyLXZpZXdzL2xpYi92aWV3cy92aWV3LmpzCiAgICBpZiAoKHR5
        cGUgPT09ICdzdHJpbmcnIHx8ICh0eXBlID09PSAnbnVtYmVyJyAmJiAhaXNO
        YU4odmFsdWUpKSkpIHsKICAgICAgcmV0LnB1c2goYXR0ciArICc9IicgKyBI
        YW5kbGViYXJzLlV0aWxzLmVzY2FwZUV4cHJlc3Npb24odmFsdWUpICsgJyIn
        KTsKICAgIH0gZWxzZSBpZiAodmFsdWUgJiYgdHlwZSA9PT0gJ2Jvb2xlYW4n
        KSB7CiAgICAgIC8vIFRoZSBkZXZlbG9wZXIgY29udHJvbHMgdGhlIGF0dHIg
        bmFtZSwgc28gaXQgc2hvdWxkIGFsd2F5cyBiZSBzYWZlCiAgICAgIHJldC5w
        dXNoKGF0dHIgKyAnPSInICsgYXR0ciArICciJyk7CiAgICB9CiAgfSwgdGhp
        cyk7CgogIC8vIEFkZCB0aGUgdW5pcXVlIGlkZW50aWZpZXIKICAvLyBOT1RF
        OiBXZSB1c2UgYWxsIGxvd2VyLWNhc2Ugc2luY2UgRmlyZWZveCBoYXMgcHJv
        YmxlbXMgd2l0aCBtaXhlZCBjYXNlIGluIFNWRwogIHJldC5wdXNoKCdkYXRh
        LWJpbmRhdHRyLScgKyBkYXRhSWQgKyAnPSInICsgZGF0YUlkICsgJyInKTsK
        ICByZXR1cm4gbmV3IEVtYmVySGFuZGxlYmFycy5TYWZlU3RyaW5nKHJldC5q
        b2luKCcgJykpOwp9KTsKCi8qKgogIFNlZSBgYmluZC1hdHRyYAoKICBAbWV0
        aG9kIGJpbmRBdHRyCiAgQGZvciBFbWJlci5IYW5kbGViYXJzLmhlbHBlcnMK
        ICBAZGVwcmVjYXRlZAogIEBwYXJhbSB7RnVuY3Rpb259IGNvbnRleHQKICBA
        cGFyYW0ge0hhc2h9IG9wdGlvbnMKICBAcmV0dXJuIHtTdHJpbmd9IEhUTUwg
        c3RyaW5nCiovCkVtYmVySGFuZGxlYmFycy5yZWdpc3RlckhlbHBlcignYmlu
        ZEF0dHInLCBFbWJlckhhbmRsZWJhcnMuaGVscGVyc1snYmluZC1hdHRyJ10p
        OwoKLyoqCiAgQHByaXZhdGUKCiAgSGVscGVyIHRoYXQsIGdpdmVuIGEgc3Bh
        Y2Utc2VwYXJhdGVkIHN0cmluZyBvZiBwcm9wZXJ0eSBwYXRocyBhbmQgYSBj
        b250ZXh0LAogIHJldHVybnMgYW4gYXJyYXkgb2YgY2xhc3MgbmFtZXMuIENh
        bGxpbmcgdGhpcyBtZXRob2QgYWxzbyBoYXMgdGhlIHNpZGUKICBlZmZlY3Qg
        b2Ygc2V0dGluZyB1cCBvYnNlcnZlcnMgYXQgdGhvc2UgcHJvcGVydHkgcGF0
        aHMsIHN1Y2ggdGhhdCBpZiB0aGV5CiAgY2hhbmdlLCB0aGUgY29ycmVjdCBj
        bGFzcyBuYW1lIHdpbGwgYmUgcmVhcHBsaWVkIHRvIHRoZSBET00gZWxlbWVu
        dC4KCiAgRm9yIGV4YW1wbGUsIGlmIHlvdSBwYXNzIHRoZSBzdHJpbmcgImZv
        b0JhciIsIGl0IHdpbGwgZmlyc3QgbG9vayB1cCB0aGUKICAiZm9vQmFyIiB2
        YWx1ZSBvZiB0aGUgY29udGV4dC4gSWYgdGhhdCB2YWx1ZSBpcyB0cnVlLCBp
        dCB3aWxsIGFkZCB0aGUKICAiZm9vLWJhciIgY2xhc3MgdG8gdGhlIGN1cnJl
        bnQgZWxlbWVudCAoaS5lLiwgdGhlIGRhc2hlcml6ZWQgZm9ybSBvZgogICJm
        b29CYXIiKS4gSWYgdGhlIHZhbHVlIGlzIGEgc3RyaW5nLCBpdCB3aWxsIGFk
        ZCB0aGF0IHN0cmluZyBhcyB0aGUgY2xhc3MuCiAgT3RoZXJ3aXNlLCBpdCB3
        aWxsIG5vdCBhZGQgYW55IG5ldyBjbGFzcyBuYW1lLgoKICBAbWV0aG9kIGJp
        bmRDbGFzc2VzCiAgQGZvciBFbWJlci5IYW5kbGViYXJzCiAgQHBhcmFtIHtF
        bWJlci5PYmplY3R9IGNvbnRleHQgVGhlIGNvbnRleHQgZnJvbSB3aGljaCB0
        byBsb29rdXAgcHJvcGVydGllcwogIEBwYXJhbSB7U3RyaW5nfSBjbGFzc0Jp
        bmRpbmdzIEEgc3RyaW5nLCBzcGFjZS1zZXBhcmF0ZWQsIG9mIGNsYXNzIGJp
        bmRpbmdzCiAgICB0byB1c2UKICBAcGFyYW0ge0VtYmVyLlZpZXd9IHZpZXcg
        VGhlIHZpZXcgaW4gd2hpY2ggb2JzZXJ2ZXJzIHNob3VsZCBsb29rIGZvciB0
        aGUKICAgIGVsZW1lbnQgdG8gdXBkYXRlCiAgQHBhcmFtIHtTcnRpbmd9IGJp
        bmRBdHRySWQgT3B0aW9uYWwgYmluZEF0dHIgaWQgdXNlZCB0byBsb29rdXAg
        ZWxlbWVudHMKICBAcmV0dXJuIHtBcnJheX0gQW4gYXJyYXkgb2YgY2xhc3Mg
        bmFtZXMgdG8gYWRkCiovCkVtYmVySGFuZGxlYmFycy5iaW5kQ2xhc3NlcyA9
        IGZ1bmN0aW9uKGNvbnRleHQsIGNsYXNzQmluZGluZ3MsIHZpZXcsIGJpbmRB
        dHRySWQsIG9wdGlvbnMpIHsKICB2YXIgcmV0ID0gW10sIG5ld0NsYXNzLCB2
        YWx1ZSwgZWxlbTsKCiAgLy8gSGVscGVyIG1ldGhvZCB0byByZXRyaWV2ZSB0
        aGUgcHJvcGVydHkgZnJvbSB0aGUgY29udGV4dCBhbmQKICAvLyBkZXRlcm1p
        bmUgd2hpY2ggY2xhc3Mgc3RyaW5nIHRvIHJldHVybiwgYmFzZWQgb24gd2hl
        dGhlciBpdCBpcwogIC8vIGEgQm9vbGVhbiBvciBub3QuCiAgdmFyIGNsYXNz
        U3RyaW5nRm9yUGF0aCA9IGZ1bmN0aW9uKHJvb3QsIHBhcnNlZFBhdGgsIG9w
        dGlvbnMpIHsKICAgIHZhciB2YWwsCiAgICAgICAgcGF0aCA9IHBhcnNlZFBh
        dGgucGF0aDsKCiAgICBpZiAocGF0aCA9PT0gJ3RoaXMnKSB7CiAgICAgIHZh
        bCA9IHJvb3Q7CiAgICB9IGVsc2UgaWYgKHBhdGggPT09ICcnKSB7CiAgICAg
        IHZhbCA9IHRydWU7CiAgICB9IGVsc2UgewogICAgICB2YWwgPSBoYW5kbGVi
        YXJzR2V0KHJvb3QsIHBhdGgsIG9wdGlvbnMpOwogICAgfQoKICAgIHJldHVy
        biBFbWJlci5WaWV3Ll9jbGFzc1N0cmluZ0ZvclZhbHVlKHBhdGgsIHZhbCwg
        cGFyc2VkUGF0aC5jbGFzc05hbWUsIHBhcnNlZFBhdGguZmFsc3lDbGFzc05h
        bWUpOwogIH07CgogIC8vIEZvciBlYWNoIHByb3BlcnR5IHBhc3NlZCwgbG9v
        cCB0aHJvdWdoIGFuZCBzZXR1cAogIC8vIGFuIG9ic2VydmVyLgogIGZvckVh
        Y2guY2FsbChjbGFzc0JpbmRpbmdzLnNwbGl0KCcgJyksIGZ1bmN0aW9uKGJp
        bmRpbmcpIHsKCiAgICAvLyBWYXJpYWJsZSBpbiB3aGljaCB0aGUgb2xkIGNs
        YXNzIHZhbHVlIGlzIHNhdmVkLiBUaGUgb2JzZXJ2ZXIgZnVuY3Rpb24KICAg
        IC8vIGNsb3NlcyBvdmVyIHRoaXMgdmFyaWFibGUsIHNvIGl0IGtub3dzIHdo
        aWNoIHN0cmluZyB0byByZW1vdmUgd2hlbgogICAgLy8gdGhlIHByb3BlcnR5
        IGNoYW5nZXMuCiAgICB2YXIgb2xkQ2xhc3M7CgogICAgdmFyIG9ic2VydmVy
        LCBpbnZva2VyOwoKICAgIHZhciBwYXJzZWRQYXRoID0gRW1iZXIuVmlldy5f
        cGFyc2VQcm9wZXJ0eVBhdGgoYmluZGluZyksCiAgICAgICAgcGF0aCA9IHBh
        cnNlZFBhdGgucGF0aCwKICAgICAgICBwYXRoUm9vdCA9IGNvbnRleHQsCiAg
        ICAgICAgbm9ybWFsaXplZDsKCiAgICBpZiAocGF0aCAhPT0gJycgJiYgcGF0
        aCAhPT0gJ3RoaXMnKSB7CiAgICAgIG5vcm1hbGl6ZWQgPSBub3JtYWxpemVQ
        YXRoKGNvbnRleHQsIHBhdGgsIG9wdGlvbnMuZGF0YSk7CgogICAgICBwYXRo
        Um9vdCA9IG5vcm1hbGl6ZWQucm9vdDsKICAgICAgcGF0aCA9IG5vcm1hbGl6
        ZWQucGF0aDsKICAgIH0KCiAgICAvLyBTZXQgdXAgYW4gb2JzZXJ2ZXIgb24g
        dGhlIGNvbnRleHQuIElmIHRoZSBwcm9wZXJ0eSBjaGFuZ2VzLCB0b2dnbGUg
        dGhlCiAgICAvLyBjbGFzcyBuYW1lLgogICAgb2JzZXJ2ZXIgPSBmdW5jdGlv
        bigpIHsKICAgICAgLy8gR2V0IHRoZSBjdXJyZW50IHZhbHVlIG9mIHRoZSBw
        cm9wZXJ0eQogICAgICBuZXdDbGFzcyA9IGNsYXNzU3RyaW5nRm9yUGF0aChj
        b250ZXh0LCBwYXJzZWRQYXRoLCBvcHRpb25zKTsKICAgICAgZWxlbSA9IGJp
        bmRBdHRySWQgPyB2aWV3LiQoIltkYXRhLWJpbmRhdHRyLSIgKyBiaW5kQXR0
        cklkICsgIj0nIiArIGJpbmRBdHRySWQgKyAiJ10iKSA6IHZpZXcuJCgpOwoK
        ICAgICAgLy8gSWYgd2UgY2FuJ3QgZmluZCB0aGUgZWxlbWVudCBhbnltb3Jl
        LCBhIHBhcmVudCB0ZW1wbGF0ZSBoYXMgYmVlbgogICAgICAvLyByZS1yZW5k
        ZXJlZCBhbmQgd2UndmUgYmVlbiBudWtlZC4gUmVtb3ZlIHRoZSBvYnNlcnZl
        ci4KICAgICAgaWYgKCFlbGVtIHx8IGVsZW0ubGVuZ3RoID09PSAwKSB7CiAg
        ICAgICAgRW1iZXIucmVtb3ZlT2JzZXJ2ZXIocGF0aFJvb3QsIHBhdGgsIGlu
        dm9rZXIpOwogICAgICB9IGVsc2UgewogICAgICAgIC8vIElmIHdlIGhhZCBw
        cmV2aW91c2x5IGFkZGVkIGEgY2xhc3MgdG8gdGhlIGVsZW1lbnQsIHJlbW92
        ZSBpdC4KICAgICAgICBpZiAob2xkQ2xhc3MpIHsKICAgICAgICAgIGVsZW0u
        cmVtb3ZlQ2xhc3Mob2xkQ2xhc3MpOwogICAgICAgIH0KCiAgICAgICAgLy8g
        SWYgbmVjZXNzYXJ5LCBhZGQgYSBuZXcgY2xhc3MuIE1ha2Ugc3VyZSB3ZSBr
        ZWVwIHRyYWNrIG9mIGl0IHNvCiAgICAgICAgLy8gaXQgY2FuIGJlIHJlbW92
        ZWQgaW4gdGhlIGZ1dHVyZS4KICAgICAgICBpZiAobmV3Q2xhc3MpIHsKICAg
        ICAgICAgIGVsZW0uYWRkQ2xhc3MobmV3Q2xhc3MpOwogICAgICAgICAgb2xk
        Q2xhc3MgPSBuZXdDbGFzczsKICAgICAgICB9IGVsc2UgewogICAgICAgICAg
        b2xkQ2xhc3MgPSBudWxsOwogICAgICAgIH0KICAgICAgfQogICAgfTsKCiAg
        ICBpZiAocGF0aCAhPT0gJycgJiYgcGF0aCAhPT0gJ3RoaXMnKSB7CiAgICAg
        IHZpZXcucmVnaXN0ZXJPYnNlcnZlcihwYXRoUm9vdCwgcGF0aCwgb2JzZXJ2
        ZXIpOwogICAgfQoKICAgIC8vIFdlJ3ZlIGFscmVhZHkgc2V0dXAgdGhlIG9i
        c2VydmVyOyBub3cgd2UganVzdCBuZWVkIHRvIGZpZ3VyZSBvdXQgdGhlCiAg
        ICAvLyBjb3JyZWN0IGJlaGF2aW9yIHJpZ2h0IG5vdyBvbiB0aGUgZmlyc3Qg
        cGFzcyB0aHJvdWdoLgogICAgdmFsdWUgPSBjbGFzc1N0cmluZ0ZvclBhdGgo
        Y29udGV4dCwgcGFyc2VkUGF0aCwgb3B0aW9ucyk7CgogICAgaWYgKHZhbHVl
        KSB7CiAgICAgIHJldC5wdXNoKHZhbHVlKTsKCiAgICAgIC8vIE1ha2Ugc3Vy
        ZSB3ZSBzYXZlIHRoZSBjdXJyZW50IHZhbHVlIHNvIHRoYXQgaXQgY2FuIGJl
        IHJlbW92ZWQgaWYgdGhlCiAgICAgIC8vIG9ic2VydmVyIGZpcmVzLgogICAg
        ICBvbGRDbGFzcyA9IHZhbHVlOwogICAgfQogIH0pOwoKICByZXR1cm4gcmV0
        Owp9OwoKCn0pKCk7CgoKCihmdW5jdGlvbigpIHsKLypnbG9iYWxzIEhhbmRs
        ZWJhcnMgKi8KCi8vIFRPRE86IERvbid0IHJlcXVpcmUgdGhlIGVudGlyZSBt
        b2R1bGUKLyoqCkBtb2R1bGUgZW1iZXIKQHN1Ym1vZHVsZSBlbWJlci1oYW5k
        bGViYXJzCiovCgp2YXIgZ2V0ID0gRW1iZXIuZ2V0LCBzZXQgPSBFbWJlci5z
        ZXQ7CnZhciBFbWJlckhhbmRsZWJhcnMgPSBFbWJlci5IYW5kbGViYXJzOwp2
        YXIgTE9XRVJDQVNFX0FfWiA9IC9eW2Etel0vOwp2YXIgVklFV19QUkVGSVgg
        PSAvXnZpZXdcLi87CgpmdW5jdGlvbiBtYWtlQmluZGluZ3ModGhpc0NvbnRl
        eHQsIG9wdGlvbnMpIHsKICB2YXIgaGFzaCA9IG9wdGlvbnMuaGFzaCwKICAg
        ICAgaGFzaFR5cGUgPSBvcHRpb25zLmhhc2hUeXBlczsKCiAgZm9yICh2YXIg
        cHJvcCBpbiBoYXNoKSB7CiAgICBpZiAoaGFzaFR5cGVbcHJvcF0gPT09ICdJ
        RCcpIHsKCiAgICAgIHZhciB2YWx1ZSA9IGhhc2hbcHJvcF07CgogICAgICBp
        ZiAoRW1iZXIuSVNfQklORElORy50ZXN0KHByb3ApKSB7CiAgICAgICAgRW1i
        ZXIud2FybigiWW91J3JlIGF0dGVtcHRpbmcgdG8gcmVuZGVyIGEgdmlldyBi
        eSBwYXNzaW5nICIgKyBwcm9wICsgIj0iICsgdmFsdWUgKyAiIHRvIGEgdmll
        dyBoZWxwZXIsIGJ1dCB0aGlzIHN5bnRheCBpcyBhbWJpZ3VvdXMuIFlvdSBz
        aG91bGQgZWl0aGVyIHN1cnJvdW5kICIgKyB2YWx1ZSArICIgaW4gcXVvdGVz
        IG9yIHJlbW92ZSBgQmluZGluZ2AgZnJvbSAiICsgcHJvcCArICIuIik7CiAg
        ICAgIH0gZWxzZSB7CiAgICAgICAgaGFzaFtwcm9wICsgJ0JpbmRpbmcnXSA9
        IHZhbHVlOwogICAgICAgIGhhc2hUeXBlW3Byb3AgKyAnQmluZGluZyddID0g
        J1NUUklORyc7CiAgICAgICAgZGVsZXRlIGhhc2hbcHJvcF07CiAgICAgICAg
        ZGVsZXRlIGhhc2hUeXBlW3Byb3BdOwogICAgICB9CiAgICB9CiAgfQoKICBp
        ZiAoaGFzaC5oYXNPd25Qcm9wZXJ0eSgnaWRCaW5kaW5nJykpIHsKICAgIC8v
        IGlkIGNhbid0IGJlIGJvdW5kLCBzbyBqdXN0IHBlcmZvcm0gb25lLXRpbWUg
        bG9va3VwLgogICAgaGFzaC5pZCA9IEVtYmVySGFuZGxlYmFycy5nZXQodGhp
        c0NvbnRleHQsIGhhc2guaWRCaW5kaW5nLCBvcHRpb25zKTsKICAgIGhhc2hU
        eXBlLmlkID0gJ1NUUklORyc7CiAgICBkZWxldGUgaGFzaC5pZEJpbmRpbmc7
        CiAgICBkZWxldGUgaGFzaFR5cGUuaWRCaW5kaW5nOwogIH0KfQoKRW1iZXJI
        YW5kbGViYXJzLlZpZXdIZWxwZXIgPSBFbWJlci5PYmplY3QuY3JlYXRlKHsK
        CiAgcHJvcGVydGllc0Zyb21IVE1MT3B0aW9uczogZnVuY3Rpb24ob3B0aW9u
        cywgdGhpc0NvbnRleHQpIHsKICAgIHZhciBoYXNoID0gb3B0aW9ucy5oYXNo
        LCBkYXRhID0gb3B0aW9ucy5kYXRhOwogICAgdmFyIGV4dGVuc2lvbnMgPSB7
        fSwKICAgICAgICBjbGFzc2VzID0gaGFzaFsnY2xhc3MnXSwKICAgICAgICBk
        dXAgPSBmYWxzZTsKCiAgICBpZiAoaGFzaC5pZCkgewogICAgICBleHRlbnNp
        b25zLmVsZW1lbnRJZCA9IGhhc2guaWQ7CiAgICAgIGR1cCA9IHRydWU7CiAg
        ICB9CgogICAgaWYgKGhhc2gudGFnKSB7CiAgICAgIGV4dGVuc2lvbnMudGFn
        TmFtZSA9IGhhc2gudGFnOwogICAgICBkdXAgPSB0cnVlOwogICAgfQoKICAg
        IGlmIChjbGFzc2VzKSB7CiAgICAgIGNsYXNzZXMgPSBjbGFzc2VzLnNwbGl0
        KCcgJyk7CiAgICAgIGV4dGVuc2lvbnMuY2xhc3NOYW1lcyA9IGNsYXNzZXM7
        CiAgICAgIGR1cCA9IHRydWU7CiAgICB9CgogICAgaWYgKGhhc2guY2xhc3NC
        aW5kaW5nKSB7CiAgICAgIGV4dGVuc2lvbnMuY2xhc3NOYW1lQmluZGluZ3Mg
        PSBoYXNoLmNsYXNzQmluZGluZy5zcGxpdCgnICcpOwogICAgICBkdXAgPSB0
        cnVlOwogICAgfQoKICAgIGlmIChoYXNoLmNsYXNzTmFtZUJpbmRpbmdzKSB7
        CiAgICAgIGlmIChleHRlbnNpb25zLmNsYXNzTmFtZUJpbmRpbmdzID09PSB1
        bmRlZmluZWQpIGV4dGVuc2lvbnMuY2xhc3NOYW1lQmluZGluZ3MgPSBbXTsK
        ICAgICAgZXh0ZW5zaW9ucy5jbGFzc05hbWVCaW5kaW5ncyA9IGV4dGVuc2lv
        bnMuY2xhc3NOYW1lQmluZGluZ3MuY29uY2F0KGhhc2guY2xhc3NOYW1lQmlu
        ZGluZ3Muc3BsaXQoJyAnKSk7CiAgICAgIGR1cCA9IHRydWU7CiAgICB9Cgog
        ICAgaWYgKGhhc2guYXR0cmlidXRlQmluZGluZ3MpIHsKICAgICAgRW1iZXIu
        YXNzZXJ0KCJTZXR0aW5nICdhdHRyaWJ1dGVCaW5kaW5ncycgdmlhIEhhbmRs
        ZWJhcnMgaXMgbm90IGFsbG93ZWQuIFBsZWFzZSBzdWJjbGFzcyBFbWJlci5W
        aWV3IGFuZCBzZXQgaXQgdGhlcmUgaW5zdGVhZC4iKTsKICAgICAgZXh0ZW5z
        aW9ucy5hdHRyaWJ1dGVCaW5kaW5ncyA9IG51bGw7CiAgICAgIGR1cCA9IHRy
        dWU7CiAgICB9CgogICAgaWYgKGR1cCkgewogICAgICBoYXNoID0gRW1iZXIu
        JC5leHRlbmQoe30sIGhhc2gpOwogICAgICBkZWxldGUgaGFzaC5pZDsKICAg
        ICAgZGVsZXRlIGhhc2gudGFnOwogICAgICBkZWxldGUgaGFzaFsnY2xhc3Mn
        XTsKICAgICAgZGVsZXRlIGhhc2guY2xhc3NCaW5kaW5nOwogICAgfQoKICAg
        IC8vIFNldCB0aGUgcHJvcGVyIGNvbnRleHQgZm9yIGFsbCBiaW5kaW5ncyBw
        YXNzZWQgdG8gdGhlIGhlbHBlci4gVGhpcyBhcHBsaWVzIHRvIHJlZ3VsYXIg
        YXR0cmlidXRlIGJpbmRpbmdzCiAgICAvLyBhcyB3ZWxsIGFzIGNsYXNzIG5h
        bWUgYmluZGluZ3MuIElmIHRoZSBiaW5kaW5ncyBhcmUgbG9jYWwsIG1ha2Ug
        dGhlbSByZWxhdGl2ZSB0byB0aGUgY3VycmVudCBjb250ZXh0CiAgICAvLyBp
        bnN0ZWFkIG9mIHRoZSB2aWV3LgogICAgdmFyIHBhdGg7CgogICAgLy8gRXZh
        bHVhdGUgdGhlIGNvbnRleHQgb2YgcmVndWxhciBhdHRyaWJ1dGUgYmluZGlu
        Z3M6CiAgICBmb3IgKHZhciBwcm9wIGluIGhhc2gpIHsKICAgICAgaWYgKCFo
        YXNoLmhhc093blByb3BlcnR5KHByb3ApKSB7IGNvbnRpbnVlOyB9CgogICAg
        ICAvLyBUZXN0IGlmIHRoZSBwcm9wZXJ0eSBlbmRzIGluICJCaW5kaW5nIgog
        ICAgICBpZiAoRW1iZXIuSVNfQklORElORy50ZXN0KHByb3ApICYmIHR5cGVv
        ZiBoYXNoW3Byb3BdID09PSAnc3RyaW5nJykgewogICAgICAgIHBhdGggPSB0
        aGlzLmNvbnRleHR1YWxpemVCaW5kaW5nUGF0aChoYXNoW3Byb3BdLCBkYXRh
        KTsKICAgICAgICBpZiAocGF0aCkgeyBoYXNoW3Byb3BdID0gcGF0aDsgfQog
        ICAgICB9CiAgICB9CgogICAgLy8gRXZhbHVhdGUgdGhlIGNvbnRleHQgb2Yg
        Y2xhc3MgbmFtZSBiaW5kaW5nczoKICAgIGlmIChleHRlbnNpb25zLmNsYXNz
        TmFtZUJpbmRpbmdzKSB7CiAgICAgIGZvciAodmFyIGIgaW4gZXh0ZW5zaW9u
        cy5jbGFzc05hbWVCaW5kaW5ncykgewogICAgICAgIHZhciBmdWxsID0gZXh0
        ZW5zaW9ucy5jbGFzc05hbWVCaW5kaW5nc1tiXTsKICAgICAgICBpZiAodHlw
        ZW9mIGZ1bGwgPT09ICdzdHJpbmcnKSB7CiAgICAgICAgICAvLyBDb250ZXh0
        dWFsaXplIHRoZSBwYXRoIG9mIGNsYXNzTmFtZUJpbmRpbmcgc28gdGhpczoK
        ICAgICAgICAgIC8vCiAgICAgICAgICAvLyAgICAgY2xhc3NOYW1lQmluZGlu
        Zz0iaXNHcmVlbjpncmVlbiIKICAgICAgICAgIC8vCiAgICAgICAgICAvLyBp
        cyBjb252ZXJ0ZWQgdG8gdGhpczoKICAgICAgICAgIC8vCiAgICAgICAgICAv
        LyAgICAgY2xhc3NOYW1lQmluZGluZz0iX3BhcmVudFZpZXcuY29udGV4dC5p
        c0dyZWVuOmdyZWVuIgogICAgICAgICAgdmFyIHBhcnNlZFBhdGggPSBFbWJl
        ci5WaWV3Ll9wYXJzZVByb3BlcnR5UGF0aChmdWxsKTsKICAgICAgICAgIHBh
        dGggPSB0aGlzLmNvbnRleHR1YWxpemVCaW5kaW5nUGF0aChwYXJzZWRQYXRo
        LnBhdGgsIGRhdGEpOwogICAgICAgICAgaWYgKHBhdGgpIHsgZXh0ZW5zaW9u
        cy5jbGFzc05hbWVCaW5kaW5nc1tiXSA9IHBhdGggKyBwYXJzZWRQYXRoLmNs
        YXNzTmFtZXM7IH0KICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICByZXR1
        cm4gRW1iZXIuJC5leHRlbmQoaGFzaCwgZXh0ZW5zaW9ucyk7CiAgfSwKCiAg
        Ly8gVHJhbnNmb3JtIGJpbmRpbmdzIGZyb20gdGhlIGN1cnJlbnQgY29udGV4
        dCB0byBhIGNvbnRleHQgdGhhdCBjYW4gYmUgZXZhbHVhdGVkIHdpdGhpbiB0
        aGUgdmlldy4KICAvLyBSZXR1cm5zIG51bGwgaWYgdGhlIHBhdGggc2hvdWxk
        bid0IGJlIGNoYW5nZWQuCiAgLy8KICAvLyBUT0RPOiBjb25zaWRlciB0aGUg
        YWRkaXRpb24gb2YgYSBwcmVmaXggdGhhdCB3b3VsZCBhbGxvdyB0aGlzIG1l
        dGhvZCB0byByZXR1cm4gYHBhdGhgLgogIGNvbnRleHR1YWxpemVCaW5kaW5n
        UGF0aDogZnVuY3Rpb24ocGF0aCwgZGF0YSkgewogICAgdmFyIG5vcm1hbGl6
        ZWQgPSBFbWJlci5IYW5kbGViYXJzLm5vcm1hbGl6ZVBhdGgobnVsbCwgcGF0
        aCwgZGF0YSk7CiAgICBpZiAobm9ybWFsaXplZC5pc0tleXdvcmQpIHsKICAg
        ICAgcmV0dXJuICd0ZW1wbGF0ZURhdGEua2V5d29yZHMuJyArIHBhdGg7CiAg
        ICB9IGVsc2UgaWYgKEVtYmVyLmlzR2xvYmFsUGF0aChwYXRoKSkgewogICAg
        ICByZXR1cm4gbnVsbDsKICAgIH0gZWxzZSBpZiAocGF0aCA9PT0gJ3RoaXMn
        KSB7CiAgICAgIHJldHVybiAnX3BhcmVudFZpZXcuY29udGV4dCc7CiAgICB9
        IGVsc2UgewogICAgICByZXR1cm4gJ19wYXJlbnRWaWV3LmNvbnRleHQuJyAr
        IHBhdGg7CiAgICB9CiAgfSwKCiAgaGVscGVyOiBmdW5jdGlvbih0aGlzQ29u
        dGV4dCwgcGF0aCwgb3B0aW9ucykgewogICAgdmFyIGRhdGEgPSBvcHRpb25z
        LmRhdGEsCiAgICAgICAgZm4gPSBvcHRpb25zLmZuLAogICAgICAgIG5ld1Zp
        ZXc7CgogICAgbWFrZUJpbmRpbmdzKHRoaXNDb250ZXh0LCBvcHRpb25zKTsK
        CiAgICBpZiAoJ3N0cmluZycgPT09IHR5cGVvZiBwYXRoKSB7CgogICAgICAv
        LyBUT0RPOiB0aGlzIGlzIGEgbGFtZSBjb25kaXRpb25hbCwgdGhpcyBzaG91
        bGQgbGlrZWx5IGNoYW5nZQogICAgICAvLyBidXQgc29tZXRoaW5nIGFsb25n
        IHRoZXNlIGxpbmVzIHdpbGwgbGlrZWx5IG5lZWQgdG8gYmUgYWRkZWQKICAg
        ICAgLy8gYXMgZGVwcmVjYXRpb24gd2FybmluZ3MKICAgICAgLy8KICAgICAg
        aWYgKG9wdGlvbnMudHlwZXNbMF0gPT09ICdTVFJJTkcnICYmIExPV0VSQ0FT
        RV9BX1oudGVzdChwYXRoKSAmJiAhVklFV19QUkVGSVgudGVzdChwYXRoKSkg
        ewogICAgICAgIEVtYmVyLmFzc2VydCgiVmlldyByZXF1aXJlcyBhIGNvbnRh
        aW5lciIsICEhZGF0YS52aWV3LmNvbnRhaW5lcik7CiAgICAgICAgbmV3Vmll
        dyA9IGRhdGEudmlldy5jb250YWluZXIubG9va3VwRmFjdG9yeSgndmlldzon
        ICsgcGF0aCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgbmV3VmlldyA9IEVt
        YmVySGFuZGxlYmFycy5nZXQodGhpc0NvbnRleHQsIHBhdGgsIG9wdGlvbnMp
        OwogICAgICB9CgogICAgICBFbWJlci5hc3NlcnQoIlVuYWJsZSB0byBmaW5k
        IHZpZXcgYXQgcGF0aCAnIiArIHBhdGggKyAiJyIsICEhbmV3Vmlldyk7CiAg
        ICB9IGVsc2UgewogICAgICBuZXdWaWV3ID0gcGF0aDsKICAgIH0KCiAgICBF
        bWJlci5hc3NlcnQoRW1iZXIuU3RyaW5nLmZtdCgnWW91IG11c3QgcGFzcyBh
        IHZpZXcgdG8gdGhlICN2aWV3IGhlbHBlciwgbm90ICVAICglQCknLCBbcGF0
        aCwgbmV3Vmlld10pLCBFbWJlci5WaWV3LmRldGVjdChuZXdWaWV3KSB8fCBF
        bWJlci5WaWV3LmRldGVjdEluc3RhbmNlKG5ld1ZpZXcpKTsKCiAgICB2YXIg
        dmlld09wdGlvbnMgPSB0aGlzLnByb3BlcnRpZXNGcm9tSFRNTE9wdGlvbnMo
        b3B0aW9ucywgdGhpc0NvbnRleHQpOwogICAgdmFyIGN1cnJlbnRWaWV3ID0g
        ZGF0YS52aWV3OwogICAgdmlld09wdGlvbnMudGVtcGxhdGVEYXRhID0gZGF0
        YTsKICAgIHZhciBuZXdWaWV3UHJvdG8gPSBuZXdWaWV3LnByb3RvID8gbmV3
        Vmlldy5wcm90bygpIDogbmV3VmlldzsKCiAgICBpZiAoZm4pIHsKICAgICAg
        RW1iZXIuYXNzZXJ0KCJZb3UgY2Fubm90IHByb3ZpZGUgYSB0ZW1wbGF0ZSBi
        bG9jayBpZiB5b3UgYWxzbyBzcGVjaWZpZWQgYSB0ZW1wbGF0ZU5hbWUiLCAh
        Z2V0KHZpZXdPcHRpb25zLCAndGVtcGxhdGVOYW1lJykgJiYgIWdldChuZXdW
        aWV3UHJvdG8sICd0ZW1wbGF0ZU5hbWUnKSk7CiAgICAgIHZpZXdPcHRpb25z
        LnRlbXBsYXRlID0gZm47CiAgICB9CgogICAgLy8gV2Ugb25seSB3YW50IHRv
        IG92ZXJyaWRlIHRoZSBgX2NvbnRleHRgIGNvbXB1dGVkIHByb3BlcnR5IGlm
        IHRoZXJlIGlzCiAgICAvLyBubyBzcGVjaWZpZWQgY29udHJvbGxlci4gU2Vl
        IFZpZXcjX2NvbnRleHQgZm9yIG1vcmUgaW5mb3JtYXRpb24uCiAgICBpZiAo
        IW5ld1ZpZXdQcm90by5jb250cm9sbGVyICYmICFuZXdWaWV3UHJvdG8uY29u
        dHJvbGxlckJpbmRpbmcgJiYgIXZpZXdPcHRpb25zLmNvbnRyb2xsZXIgJiYg
        IXZpZXdPcHRpb25zLmNvbnRyb2xsZXJCaW5kaW5nKSB7CiAgICAgIHZpZXdP
        cHRpb25zLl9jb250ZXh0ID0gdGhpc0NvbnRleHQ7CiAgICB9CgogICAgY3Vy
        cmVudFZpZXcuYXBwZW5kQ2hpbGQobmV3Vmlldywgdmlld09wdGlvbnMpOwog
        IH0KfSk7CgovKioKICBge3t2aWV3fX1gIGluc2VydHMgYSBuZXcgaW5zdGFu
        Y2Ugb2YgYEVtYmVyLlZpZXdgIGludG8gYSB0ZW1wbGF0ZSBwYXNzaW5nIGl0
        cwogIG9wdGlvbnMgdG8gdGhlIGBFbWJlci5WaWV3YCdzIGBjcmVhdGVgIG1l
        dGhvZCBhbmQgdXNpbmcgdGhlIHN1cHBsaWVkIGJsb2NrIGFzCiAgdGhlIHZp
        ZXcncyBvd24gdGVtcGxhdGUuCgogIEFuIGVtcHR5IGA8Ym9keT5gIGFuZCB0
        aGUgZm9sbG93aW5nIHRlbXBsYXRlOgoKICBgYGBoYW5kbGViYXJzCiAgQSBz
        cGFuOgogIHt7I3ZpZXcgdGFnTmFtZT0ic3BhbiJ9fQogICAgaGVsbG8uCiAg
        e3svdmlld319CiAgYGBgCgogIFdpbGwgcmVzdWx0IGluIEhUTUwgc3RydWN0
        dXJlOgoKICBgYGBodG1sCiAgPGJvZHk+CiAgICA8IS0tIE5vdGU6IHRoZSBo
        YW5kbGViYXJzIHRlbXBsYXRlIHNjcmlwdAogICAgICAgICBhbHNvIHJlc3Vs
        dHMgaW4gYSByZW5kZXJlZCBFbWJlci5WaWV3CiAgICAgICAgIHdoaWNoIGlz
        IHRoZSBvdXRlciA8ZGl2PiBoZXJlIC0tPgoKICAgIDxkaXYgY2xhc3M9ImVt
        YmVyLXZpZXciPgogICAgICBBIHNwYW46CiAgICAgIDxzcGFuIGlkPSJlbWJl
        cjEiIGNsYXNzPSJlbWJlci12aWV3Ij4KICAgICAgICBIZWxsby4KICAgICAg
        PC9zcGFuPgogICAgPC9kaXY+CiAgPC9ib2R5PgogIGBgYAoKICAjIyMgYHBh
        cmVudFZpZXdgIHNldHRpbmcKCiAgVGhlIGBwYXJlbnRWaWV3YCBwcm9wZXJ0
        eSBvZiB0aGUgbmV3IGBFbWJlci5WaWV3YCBpbnN0YW5jZSBjcmVhdGVkIHRo
        cm91Z2gKICBge3t2aWV3fX1gIHdpbGwgYmUgc2V0IHRvIHRoZSBgRW1iZXIu
        Vmlld2AgaW5zdGFuY2Ugb2YgdGhlIHRlbXBsYXRlIHdoZXJlCiAgYHt7dmll
        d319YCB3YXMgY2FsbGVkLgoKICBgYGBqYXZhc2NyaXB0CiAgYVZpZXcgPSBF
        bWJlci5WaWV3LmNyZWF0ZSh7CiAgICB0ZW1wbGF0ZTogRW1iZXIuSGFuZGxl
        YmFycy5jb21waWxlKCJ7eyN2aWV3fX0gbXkgcGFyZW50OiB7e3BhcmVudFZp
        ZXcuZWxlbWVudElkfX0ge3svdmlld319IikKICB9KTsKCiAgYVZpZXcuYXBw
        ZW5kVG8oJ2JvZHknKTsKICBgYGAKCiAgV2lsbCByZXN1bHQgaW4gSFRNTCBz
        dHJ1Y3R1cmU6CgogIGBgYGh0bWwKICA8ZGl2IGlkPSJlbWJlcjEiIGNsYXNz
        PSJlbWJlci12aWV3Ij4KICAgIDxkaXYgaWQ9ImVtYmVyMiIgY2xhc3M9ImVt
        YmVyLXZpZXciPgogICAgICBteSBwYXJlbnQ6IGVtYmVyMQogICAgPC9kaXY+
        CiAgPC9kaXY+CiAgYGBgCgogICMjIyBTZXR0aW5nIENTUyBpZCBhbmQgY2xh
        c3MgYXR0cmlidXRlcwoKICBUaGUgSFRNTCBgaWRgIGF0dHJpYnV0ZSBjYW4g
        YmUgc2V0IG9uIHRoZSBge3t2aWV3fX1gJ3MgcmVzdWx0aW5nIGVsZW1lbnQg
        d2l0aAogIHRoZSBgaWRgIG9wdGlvbi4gVGhpcyBvcHRpb24gd2lsbCBfbm90
        XyBiZSBwYXNzZWQgdG8gYEVtYmVyLlZpZXcuY3JlYXRlYC4KCiAgYGBgaGFu
        ZGxlYmFycwogIHt7I3ZpZXcgdGFnTmFtZT0ic3BhbiIgaWQ9ImEtY3VzdG9t
        LWlkIn19CiAgICBoZWxsby4KICB7ey92aWV3fX0KICBgYGAKCiAgUmVzdWx0
        cyBpbiB0aGUgZm9sbG93aW5nIEhUTUwgc3RydWN0dXJlOgoKICBgYGBodG1s
        CiAgPGRpdiBjbGFzcz0iZW1iZXItdmlldyI+CiAgICA8c3BhbiBpZD0iYS1j
        dXN0b20taWQiIGNsYXNzPSJlbWJlci12aWV3Ij4KICAgICAgaGVsbG8uCiAg
        ICA8L3NwYW4+CiAgPC9kaXY+CiAgYGBgCgogIFRoZSBIVE1MIGBjbGFzc2Ag
        YXR0cmlidXRlIGNhbiBiZSBzZXQgb24gdGhlIGB7e3ZpZXd9fWAncyByZXN1
        bHRpbmcgZWxlbWVudAogIHdpdGggdGhlIGBjbGFzc2Agb3IgYGNsYXNzTmFt
        ZUJpbmRpbmdzYCBvcHRpb25zLiBUaGUgYGNsYXNzYCBvcHRpb24gd2lsbAog
        IGRpcmVjdGx5IHNldCB0aGUgQ1NTIGBjbGFzc2AgYXR0cmlidXRlIGFuZCB3
        aWxsIG5vdCBiZSBwYXNzZWQgdG8KICBgRW1iZXIuVmlldy5jcmVhdGVgLiBg
        Y2xhc3NOYW1lQmluZGluZ3NgIHdpbGwgYmUgcGFzc2VkIHRvIGBjcmVhdGVg
        IGFuZCB1c2UKICBgRW1iZXIuVmlld2AncyBjbGFzcyBuYW1lIGJpbmRpbmcg
        ZnVuY3Rpb25hbGl0eToKCiAgYGBgaGFuZGxlYmFycwogIHt7I3ZpZXcgdGFn
        TmFtZT0ic3BhbiIgY2xhc3M9ImEtY3VzdG9tLWNsYXNzIn19CiAgICBoZWxs
        by4KICB7ey92aWV3fX0KICBgYGAKCiAgUmVzdWx0cyBpbiB0aGUgZm9sbG93
        aW5nIEhUTUwgc3RydWN0dXJlOgoKICBgYGBodG1sCiAgPGRpdiBjbGFzcz0i
        ZW1iZXItdmlldyI+CiAgICA8c3BhbiBpZD0iZW1iZXIyIiBjbGFzcz0iZW1i
        ZXItdmlldyBhLWN1c3RvbS1jbGFzcyI+CiAgICAgIGhlbGxvLgogICAgPC9z
        cGFuPgogIDwvZGl2PgogIGBgYAoKICAjIyMgU3VwcGx5aW5nIGEgZGlmZmVy
        ZW50IHZpZXcgY2xhc3MKCiAgYHt7dmlld319YCBjYW4gdGFrZSBhbiBvcHRp
        b25hbCBmaXJzdCBhcmd1bWVudCBiZWZvcmUgaXRzIHN1cHBsaWVkIG9wdGlv
        bnMgdG8KICBzcGVjaWZ5IGEgcGF0aCB0byBhIGN1c3RvbSB2aWV3IGNsYXNz
        LgoKICBgYGBoYW5kbGViYXJzCiAge3sjdmlldyAiTXlBcHAuQ3VzdG9tVmll
        dyJ9fQogICAgaGVsbG8uCiAge3svdmlld319CiAgYGBgCgogIFRoZSBmaXJz
        dCBhcmd1bWVudCBjYW4gYWxzbyBiZSBhIHJlbGF0aXZlIHBhdGggYWNjZXNz
        aWJsZSBmcm9tIHRoZSBjdXJyZW50CiAgY29udGV4dC4KCiAgYGBgamF2YXNj
        cmlwdAogIE15QXBwID0gRW1iZXIuQXBwbGljYXRpb24uY3JlYXRlKHt9KTsK
        ICBNeUFwcC5PdXRlclZpZXcgPSBFbWJlci5WaWV3LmV4dGVuZCh7CiAgICBp
        bm5lclZpZXdDbGFzczogRW1iZXIuVmlldy5leHRlbmQoewogICAgICBjbGFz
        c05hbWVzOiBbJ2EtY3VzdG9tLXZpZXctY2xhc3MtYXMtcHJvcGVydHknXQog
        ICAgfSksCiAgICB0ZW1wbGF0ZTogRW1iZXIuSGFuZGxlYmFycy5jb21waWxl
        KCd7eyN2aWV3ICJ2aWV3LmlubmVyVmlld0NsYXNzIn19IGhpIHt7L3ZpZXd9
        fScpCiAgfSk7CgogIE15QXBwLk91dGVyVmlldy5jcmVhdGUoKS5hcHBlbmRU
        bygnYm9keScpOwogIGBgYAoKICBXaWxsIHJlc3VsdCBpbiB0aGUgZm9sbG93
        aW5nIEhUTUw6CgogIGBgYGh0bWwKICA8ZGl2IGlkPSJlbWJlcjEiIGNsYXNz
        PSJlbWJlci12aWV3Ij4KICAgIDxkaXYgaWQ9ImVtYmVyMiIgY2xhc3M9ImVt
        YmVyLXZpZXcgYS1jdXN0b20tdmlldy1jbGFzcy1hcy1wcm9wZXJ0eSI+CiAg
        ICAgIGhpCiAgICA8L2Rpdj4KICA8L2Rpdj4KICBgYGAKCiAgIyMjIEJsb2Nr
        bGVzcyB1c2UKCiAgSWYgeW91IHN1cHBseSBhIGN1c3RvbSBgRW1iZXIuVmll
        d2Agc3ViY2xhc3MgdGhhdCBzcGVjaWZpZXMgaXRzIG93biB0ZW1wbGF0ZQog
        IG9yIHByb3ZpZGUgYSBgdGVtcGxhdGVOYW1lYCBvcHRpb24gdG8gYHt7dmll
        d319YCBpdCBjYW4gYmUgdXNlZCB3aXRob3V0CiAgc3VwcGx5aW5nIGEgYmxv
        Y2suIEF0dGVtcHRzIHRvIHVzZSBib3RoIGEgYHRlbXBsYXRlTmFtZWAgb3B0
        aW9uIGFuZCBzdXBwbHkgYQogIGJsb2NrIHdpbGwgdGhyb3cgYW4gZXJyb3Iu
        CgogIGBgYGhhbmRsZWJhcnMKICB7e3ZpZXcgIk15QXBwLlZpZXdXaXRoQVRl
        bXBsYXRlRGVmaW5lZCJ9fQogIGBgYAoKICAjIyMgYHZpZXdOYW1lYCBwcm9w
        ZXJ0eQoKICBZb3UgY2FuIHN1cHBseSBhIGB2aWV3TmFtZWAgb3B0aW9uIHRv
        IGB7e3ZpZXd9fWAuIFRoZSBgRW1iZXIuVmlld2AgaW5zdGFuY2UKICB3aWxs
        IGJlIHJlZmVyZW5jZWQgYXMgYSBwcm9wZXJ0eSBvZiBpdHMgcGFyZW50IHZp
        ZXcgYnkgdGhpcyBuYW1lLgoKICBgYGBqYXZhc2NyaXB0CiAgYVZpZXcgPSBF
        bWJlci5WaWV3LmNyZWF0ZSh7CiAgICB0ZW1wbGF0ZTogRW1iZXIuSGFuZGxl
        YmFycy5jb21waWxlKCd7eyN2aWV3IHZpZXdOYW1lPSJhQ2hpbGRCeU5hbWUi
        fX0gaGkge3svdmlld319JykKICB9KTsKCiAgYVZpZXcuYXBwZW5kVG8oJ2Jv
        ZHknKTsKICBhVmlldy5nZXQoJ2FDaGlsZEJ5TmFtZScpIC8vIHRoZSBpbnN0
        YW5jZSBvZiBFbWJlci5WaWV3IGNyZWF0ZWQgYnkge3t2aWV3fX0gaGVscGVy
        CiAgYGBgCgogIEBtZXRob2QgdmlldwogIEBmb3IgRW1iZXIuSGFuZGxlYmFy
        cy5oZWxwZXJzCiAgQHBhcmFtIHtTdHJpbmd9IHBhdGgKICBAcGFyYW0ge0hh
        c2h9IG9wdGlvbnMKICBAcmV0dXJuIHtTdHJpbmd9IEhUTUwgc3RyaW5nCiov
        CkVtYmVySGFuZGxlYmFycy5yZWdpc3RlckhlbHBlcigndmlldycsIGZ1bmN0
        aW9uKHBhdGgsIG9wdGlvbnMpIHsKICBFbWJlci5hc3NlcnQoIlRoZSB2aWV3
        IGhlbHBlciBvbmx5IHRha2VzIGEgc2luZ2xlIGFyZ3VtZW50IiwgYXJndW1l
        bnRzLmxlbmd0aCA8PSAyKTsKCiAgLy8gSWYgbm8gcGF0aCBpcyBwcm92aWRl
        ZCwgdHJlYXQgcGF0aCBwYXJhbSBhcyBvcHRpb25zLgogIGlmIChwYXRoICYm
        IHBhdGguZGF0YSAmJiBwYXRoLmRhdGEuaXNSZW5kZXJEYXRhKSB7CiAgICBv
        cHRpb25zID0gcGF0aDsKICAgIHBhdGggPSAiRW1iZXIuVmlldyI7CiAgfQoK
        ICByZXR1cm4gRW1iZXJIYW5kbGViYXJzLlZpZXdIZWxwZXIuaGVscGVyKHRo
        aXMsIHBhdGgsIG9wdGlvbnMpOwp9KTsKCgp9KSgpOwoKCgooZnVuY3Rpb24o
        KSB7Ci8qZ2xvYmFscyBIYW5kbGViYXJzICovCgovLyBUT0RPOiBEb24ndCBy
        ZXF1aXJlIGFsbCBvZiB0aGlzIG1vZHVsZQovKioKQG1vZHVsZSBlbWJlcgpA
        c3VibW9kdWxlIGVtYmVyLWhhbmRsZWJhcnMKKi8KCnZhciBnZXQgPSBFbWJl
        ci5nZXQsIGhhbmRsZWJhcnNHZXQgPSBFbWJlci5IYW5kbGViYXJzLmdldCwg
        Zm10ID0gRW1iZXIuU3RyaW5nLmZtdDsKCi8qKgogIGB7e2NvbGxlY3Rpb259
        fWAgaXMgYSBgRW1iZXIuSGFuZGxlYmFyc2AgaGVscGVyIGZvciBhZGRpbmcg
        aW5zdGFuY2VzIG9mCiAgYEVtYmVyLkNvbGxlY3Rpb25WaWV3YCB0byBhIHRl
        bXBsYXRlLiBTZWUgW0VtYmVyLkNvbGxlY3Rpb25WaWV3XSgvYXBpL2NsYXNz
        ZXMvRW1iZXIuQ29sbGVjdGlvblZpZXcuaHRtbCkKICAgZm9yIGFkZGl0aW9u
        YWwgaW5mb3JtYXRpb24gb24gaG93IGEgYENvbGxlY3Rpb25WaWV3YCBmdW5j
        dGlvbnMuCgogIGB7e2NvbGxlY3Rpb259fWAncyBwcmltYXJ5IHVzZSBpcyBh
        cyBhIGJsb2NrIGhlbHBlciB3aXRoIGEgYGNvbnRlbnRCaW5kaW5nYAogIG9w
        dGlvbiBwb2ludGluZyB0b3dhcmRzIGFuIGBFbWJlci5BcnJheWAtY29tcGF0
        aWJsZSBvYmplY3QuIEFuIGBFbWJlci5WaWV3YAogIGluc3RhbmNlIHdpbGwg
        YmUgY3JlYXRlZCBmb3IgZWFjaCBpdGVtIGluIGl0cyBgY29udGVudGAgcHJv
        cGVydHkuIEVhY2ggdmlldwogIHdpbGwgaGF2ZSBpdHMgb3duIGBjb250ZW50
        YCBwcm9wZXJ0eSBzZXQgdG8gdGhlIGFwcHJvcHJpYXRlIGl0ZW0gaW4gdGhl
        CiAgY29sbGVjdGlvbi4KCiAgVGhlIHByb3ZpZGVkIGJsb2NrIHdpbGwgYmUg
        YXBwbGllZCBhcyB0aGUgdGVtcGxhdGUgZm9yIGVhY2ggaXRlbSdzIHZpZXcu
        CgogIEdpdmVuIGFuIGVtcHR5IGA8Ym9keT5gIHRoZSBmb2xsb3dpbmcgdGVt
        cGxhdGU6CgogIGBgYGhhbmRsZWJhcnMKICB7eyNjb2xsZWN0aW9uIGNvbnRl
        bnRCaW5kaW5nPSJBcHAuaXRlbXMifX0KICAgIEhpIHt7dmlldy5jb250ZW50
        Lm5hbWV9fQogIHt7L2NvbGxlY3Rpb259fQogIGBgYAoKICBBbmQgdGhlIGZv
        bGxvd2luZyBhcHBsaWNhdGlvbiBjb2RlCgogIGBgYGphdmFzY3JpcHQKICBB
        cHAgPSBFbWJlci5BcHBsaWNhdGlvbi5jcmVhdGUoKQogIEFwcC5pdGVtcyA9
        IFsKICAgIEVtYmVyLk9iamVjdC5jcmVhdGUoe25hbWU6ICdEYXZlJ30pLAog
        ICAgRW1iZXIuT2JqZWN0LmNyZWF0ZSh7bmFtZTogJ01hcnknfSksCiAgICBF
        bWJlci5PYmplY3QuY3JlYXRlKHtuYW1lOiAnU2FyYSd9KQogIF0KICBgYGAK
        CiAgV2lsbCByZXN1bHQgaW4gdGhlIEhUTUwgc3RydWN0dXJlIGJlbG93Cgog
        IGBgYGh0bWwKICA8ZGl2IGNsYXNzPSJlbWJlci12aWV3Ij4KICAgIDxkaXYg
        Y2xhc3M9ImVtYmVyLXZpZXciPkhpIERhdmU8L2Rpdj4KICAgIDxkaXYgY2xh
        c3M9ImVtYmVyLXZpZXciPkhpIE1hcnk8L2Rpdj4KICAgIDxkaXYgY2xhc3M9
        ImVtYmVyLXZpZXciPkhpIFNhcmE8L2Rpdj4KICA8L2Rpdj4KICBgYGAKCiAg
        IyMjIEJsb2NrbGVzcyBVc2UKCiAgSWYgeW91IHByb3ZpZGUgYW4gYGl0ZW1W
        aWV3Q2xhc3NgIG9wdGlvbiB0aGF0IGhhcyBpdHMgb3duIGB0ZW1wbGF0ZWAg
        eW91IGNhbgogIG9taXQgdGhlIGJsb2NrLgoKICBUaGUgZm9sbG93aW5nIHRl
        bXBsYXRlOgoKICBgYGBoYW5kbGViYXJzCiAge3tjb2xsZWN0aW9uIGNvbnRl
        bnRCaW5kaW5nPSJBcHAuaXRlbXMiIGl0ZW1WaWV3Q2xhc3M9IkFwcC5Bbkl0
        ZW1WaWV3In19CiAgYGBgCgogIEFuZCBhcHBsaWNhdGlvbiBjb2RlCgogIGBg
        YGphdmFzY3JpcHQKICBBcHAgPSBFbWJlci5BcHBsaWNhdGlvbi5jcmVhdGUo
        KTsKICBBcHAuaXRlbXMgPSBbCiAgICBFbWJlci5PYmplY3QuY3JlYXRlKHtu
        YW1lOiAnRGF2ZSd9KSwKICAgIEVtYmVyLk9iamVjdC5jcmVhdGUoe25hbWU6
        ICdNYXJ5J30pLAogICAgRW1iZXIuT2JqZWN0LmNyZWF0ZSh7bmFtZTogJ1Nh
        cmEnfSkKICBdOwoKICBBcHAuQW5JdGVtVmlldyA9IEVtYmVyLlZpZXcuZXh0
        ZW5kKHsKICAgIHRlbXBsYXRlOiBFbWJlci5IYW5kbGViYXJzLmNvbXBpbGUo
        IkdyZWV0aW5ncyB7e3ZpZXcuY29udGVudC5uYW1lfX0iKQogIH0pOwogIGBg
        YAoKICBXaWxsIHJlc3VsdCBpbiB0aGUgSFRNTCBzdHJ1Y3R1cmUgYmVsb3cK
        CiAgYGBgaHRtbAogIDxkaXYgY2xhc3M9ImVtYmVyLXZpZXciPgogICAgPGRp
        diBjbGFzcz0iZW1iZXItdmlldyI+R3JlZXRpbmdzIERhdmU8L2Rpdj4KICAg
        IDxkaXYgY2xhc3M9ImVtYmVyLXZpZXciPkdyZWV0aW5ncyBNYXJ5PC9kaXY+
        CiAgICA8ZGl2IGNsYXNzPSJlbWJlci12aWV3Ij5HcmVldGluZ3MgU2FyYTwv
        ZGl2PgogIDwvZGl2PgogIGBgYAoKICAjIyMgU3BlY2lmeWluZyBhIENvbGxl
        Y3Rpb25WaWV3IHN1YmNsYXNzCgogIEJ5IGRlZmF1bHQgdGhlIGB7e2NvbGxl
        Y3Rpb259fWAgaGVscGVyIHdpbGwgY3JlYXRlIGFuIGluc3RhbmNlIG9mCiAg
        YEVtYmVyLkNvbGxlY3Rpb25WaWV3YC4gWW91IGNhbiBzdXBwbHkgYSBgRW1i
        ZXIuQ29sbGVjdGlvblZpZXdgIHN1YmNsYXNzIHRvCiAgdGhlIGhlbHBlciBi
        eSBwYXNzaW5nIGl0IGFzIHRoZSBmaXJzdCBhcmd1bWVudDoKCiAgYGBgaGFu
        ZGxlYmFycwogIHt7I2NvbGxlY3Rpb24gQXBwLk15Q3VzdG9tQ29sbGVjdGlv
        bkNsYXNzIGNvbnRlbnRCaW5kaW5nPSJBcHAuaXRlbXMifX0KICAgIEhpIHt7
        dmlldy5jb250ZW50Lm5hbWV9fQogIHt7L2NvbGxlY3Rpb259fQogIGBgYAoK
        ICAjIyMgRm9yd2FyZGVkIGBpdGVtLipgLW5hbWVkIE9wdGlvbnMKCiAgQXMg
        d2l0aCB0aGUgYHt7dmlld319YCwgaGVscGVyIG9wdGlvbnMgcGFzc2VkIHRv
        IHRoZSBge3tjb2xsZWN0aW9ufX1gIHdpbGwgYmUKICBzZXQgb24gdGhlIHJl
        c3VsdGluZyBgRW1iZXIuQ29sbGVjdGlvblZpZXdgIGFzIHByb3BlcnRpZXMu
        IEFkZGl0aW9uYWxseSwKICBvcHRpb25zIHByZWZpeGVkIHdpdGggYGl0ZW1g
        IHdpbGwgYmUgYXBwbGllZCB0byB0aGUgdmlld3MgcmVuZGVyZWQgZm9yIGVh
        Y2gKICBpdGVtIChub3RlIHRoZSBjYW1lbGNhc2luZyk6CgogIGBgYGhhbmRs
        ZWJhcnMKICB7eyNjb2xsZWN0aW9uIGNvbnRlbnRCaW5kaW5nPSJBcHAuaXRl
        bXMiCiAgICAgICAgICAgICAgICBpdGVtVGFnTmFtZT0icCIKICAgICAgICAg
        ICAgICAgIGl0ZW1DbGFzc05hbWVzPSJncmVldGluZyJ9fQogICAgSG93ZHkg
        e3t2aWV3LmNvbnRlbnQubmFtZX19CiAge3svY29sbGVjdGlvbn19CiAgYGBg
        CgogIFdpbGwgcmVzdWx0IGluIHRoZSBmb2xsb3dpbmcgSFRNTCBzdHJ1Y3R1
        cmU6CgogIGBgYGh0bWwKICA8ZGl2IGNsYXNzPSJlbWJlci12aWV3Ij4KICAg
        IDxwIGNsYXNzPSJlbWJlci12aWV3IGdyZWV0aW5nIj5Ib3dkeSBEYXZlPC9w
        PgogICAgPHAgY2xhc3M9ImVtYmVyLXZpZXcgZ3JlZXRpbmciPkhvd2R5IE1h
        cnk8L3A+CiAgICA8cCBjbGFzcz0iZW1iZXItdmlldyBncmVldGluZyI+SG93
        ZHkgU2FyYTwvcD4KICA8L2Rpdj4KICBgYGAKCiAgQG1ldGhvZCBjb2xsZWN0
        aW9uCiAgQGZvciBFbWJlci5IYW5kbGViYXJzLmhlbHBlcnMKICBAcGFyYW0g
        e1N0cmluZ30gcGF0aAogIEBwYXJhbSB7SGFzaH0gb3B0aW9ucwogIEByZXR1
        cm4ge1N0cmluZ30gSFRNTCBzdHJpbmcKICBAZGVwcmVjYXRlZCBVc2UgYHt7
        ZWFjaH19YCBoZWxwZXIgaW5zdGVhZC4KKi8KRW1iZXIuSGFuZGxlYmFycy5y
        ZWdpc3RlckhlbHBlcignY29sbGVjdGlvbicsIGZ1bmN0aW9uKHBhdGgsIG9w
        dGlvbnMpIHsKICBFbWJlci5kZXByZWNhdGUoIlVzaW5nIHRoZSB7e2NvbGxl
        Y3Rpb259fSBoZWxwZXIgd2l0aG91dCBzcGVjaWZ5aW5nIGEgY2xhc3MgaGFz
        IGJlZW4gZGVwcmVjYXRlZCBhcyB0aGUge3tlYWNofX0gaGVscGVyIG5vdyBz
        dXBwb3J0cyB0aGUgc2FtZSBmdW5jdGlvbmFsaXR5LiIsIHBhdGggIT09ICdj
        b2xsZWN0aW9uJyk7CgogIC8vIElmIG5vIHBhdGggaXMgcHJvdmlkZWQsIHRy
        ZWF0IHBhdGggcGFyYW0gYXMgb3B0aW9ucy4KICBpZiAocGF0aCAmJiBwYXRo
        LmRhdGEgJiYgcGF0aC5kYXRhLmlzUmVuZGVyRGF0YSkgewogICAgb3B0aW9u
        cyA9IHBhdGg7CiAgICBwYXRoID0gdW5kZWZpbmVkOwogICAgRW1iZXIuYXNz
        ZXJ0KCJZb3UgY2Fubm90IHBhc3MgbW9yZSB0aGFuIG9uZSBhcmd1bWVudCB0
        byB0aGUgY29sbGVjdGlvbiBoZWxwZXIiLCBhcmd1bWVudHMubGVuZ3RoID09
        PSAxKTsKICB9IGVsc2UgewogICAgRW1iZXIuYXNzZXJ0KCJZb3UgY2Fubm90
        IHBhc3MgbW9yZSB0aGFuIG9uZSBhcmd1bWVudCB0byB0aGUgY29sbGVjdGlv
        biBoZWxwZXIiLCBhcmd1bWVudHMubGVuZ3RoID09PSAyKTsKICB9CgogIHZh
        ciBmbiA9IG9wdGlvbnMuZm47CiAgdmFyIGRhdGEgPSBvcHRpb25zLmRhdGE7
        CiAgdmFyIGludmVyc2UgPSBvcHRpb25zLmludmVyc2U7CiAgdmFyIHZpZXcg
        PSBvcHRpb25zLmRhdGEudmlldzsKCiAgLy8gSWYgcGFzc2VkIGEgcGF0aCBz
        dHJpbmcsIGNvbnZlcnQgdGhhdCBpbnRvIGFuIG9iamVjdC4KICAvLyBPdGhl
        cndpc2UsIGp1c3QgZGVmYXVsdCB0byB0aGUgc3RhbmRhcmQgY2xhc3MuCiAg
        dmFyIGNvbGxlY3Rpb25DbGFzczsKICBjb2xsZWN0aW9uQ2xhc3MgPSBwYXRo
        ID8gaGFuZGxlYmFyc0dldCh0aGlzLCBwYXRoLCBvcHRpb25zKSA6IEVtYmVy
        LkNvbGxlY3Rpb25WaWV3OwogIEVtYmVyLmFzc2VydChmbXQoIiVAICNjb2xs
        ZWN0aW9uOiBDb3VsZCBub3QgZmluZCBjb2xsZWN0aW9uIGNsYXNzICVAIiwg
        W2RhdGEudmlldywgcGF0aF0pLCAhIWNvbGxlY3Rpb25DbGFzcyk7CgogIHZh
        ciBoYXNoID0gb3B0aW9ucy5oYXNoLCBpdGVtSGFzaCA9IHt9LCBtYXRjaDsK
        CiAgLy8gRXh0cmFjdCBpdGVtIHZpZXcgY2xhc3MgaWYgcHJvdmlkZWQgZWxz
        ZSBkZWZhdWx0IHRvIHRoZSBzdGFuZGFyZCBjbGFzcwogIHZhciBjb2xsZWN0
        aW9uUHJvdG90eXBlID0gY29sbGVjdGlvbkNsYXNzLnByb3RvKCksCiAgICAg
        IGl0ZW1WaWV3Q2xhc3M7CgogIGlmIChoYXNoLml0ZW1WaWV3KSB7CiAgICB2
        YXIgY29udHJvbGxlciA9IGRhdGEua2V5d29yZHMuY29udHJvbGxlcjsKICAg
        IEVtYmVyLmFzc2VydCgnWW91IHNwZWNpZmllZCBhbiBpdGVtVmlldywgYnV0
        IHRoZSBjdXJyZW50IGNvbnRleHQgaGFzIG5vIGNvbnRhaW5lciB0byBsb29r
        IHRoZSBpdGVtVmlldyB1cCBpbi4gVGhpcyBwcm9iYWJseSBtZWFucyB0aGF0
        IHlvdSBjcmVhdGVkIGEgdmlldyBtYW51YWxseSwgaW5zdGVhZCBvZiB0aHJv
        dWdoIHRoZSBjb250YWluZXIuIEluc3RlYWQsIHVzZSBjb250YWluZXIubG9v
        a3VwKCJ2aWV3OnZpZXdOYW1lIiksIHdoaWNoIHdpbGwgcHJvcGVybHkgaW5z
        dGFudGlhdGUgeW91ciB2aWV3LicsIGNvbnRyb2xsZXIgJiYgY29udHJvbGxl
        ci5jb250YWluZXIpOwogICAgdmFyIGNvbnRhaW5lciA9IGNvbnRyb2xsZXIu
        Y29udGFpbmVyOwogICAgaXRlbVZpZXdDbGFzcyA9IGNvbnRhaW5lci5yZXNv
        bHZlKCd2aWV3OicgKyBFbWJlci5TdHJpbmcuY2FtZWxpemUoaGFzaC5pdGVt
        VmlldykpOwogICAgRW1iZXIuYXNzZXJ0KCdZb3Ugc3BlY2lmaWVkIHRoZSBp
        dGVtVmlldyAnICsgaGFzaC5pdGVtVmlldyArICIsIGJ1dCBpdCB3YXMgbm90
        IGZvdW5kIGF0ICIgKyBjb250YWluZXIuZGVzY3JpYmUoInZpZXc6IiArIGhh
        c2guaXRlbVZpZXcpICsgIiAoYW5kIGl0IHdhcyBub3QgcmVnaXN0ZXJlZCBp
        biB0aGUgY29udGFpbmVyKSIsICEhaXRlbVZpZXdDbGFzcyk7CiAgfSBlbHNl
        IGlmIChoYXNoLml0ZW1WaWV3Q2xhc3MpIHsKICAgIGl0ZW1WaWV3Q2xhc3Mg
        PSBoYW5kbGViYXJzR2V0KGNvbGxlY3Rpb25Qcm90b3R5cGUsIGhhc2guaXRl
        bVZpZXdDbGFzcywgb3B0aW9ucyk7CiAgfSBlbHNlIHsKICAgIGl0ZW1WaWV3
        Q2xhc3MgPSBjb2xsZWN0aW9uUHJvdG90eXBlLml0ZW1WaWV3Q2xhc3M7CiAg
        fQoKICBFbWJlci5hc3NlcnQoZm10KCIlQCAjY29sbGVjdGlvbjogQ291bGQg
        bm90IGZpbmQgaXRlbVZpZXdDbGFzcyAlQCIsIFtkYXRhLnZpZXcsIGl0ZW1W
        aWV3Q2xhc3NdKSwgISFpdGVtVmlld0NsYXNzKTsKCiAgZGVsZXRlIGhhc2gu
        aXRlbVZpZXdDbGFzczsKICBkZWxldGUgaGFzaC5pdGVtVmlldzsKCiAgLy8g
        R28gdGhyb3VnaCBvcHRpb25zIHBhc3NlZCB0byB0aGUge3tjb2xsZWN0aW9u
        fX0gaGVscGVyIGFuZCBleHRyYWN0IG9wdGlvbnMKICAvLyB0aGF0IGNvbmZp
        Z3VyZSBpdGVtIHZpZXdzIGluc3RlYWQgb2YgdGhlIGNvbGxlY3Rpb24gaXRz
        ZWxmLgogIGZvciAodmFyIHByb3AgaW4gaGFzaCkgewogICAgaWYgKGhhc2gu
        aGFzT3duUHJvcGVydHkocHJvcCkpIHsKICAgICAgbWF0Y2ggPSBwcm9wLm1h
        dGNoKC9eaXRlbSguKSguKikkLyk7CgogICAgICBpZiAobWF0Y2ggJiYgcHJv
        cCAhPT0gJ2l0ZW1Db250cm9sbGVyJykgewogICAgICAgIC8vIENvbnZlcnQg
        aXRlbVNob3VsZEZvbyAtPiBzaG91bGRGb28KICAgICAgICBpdGVtSGFzaFtt
        YXRjaFsxXS50b0xvd2VyQ2FzZSgpICsgbWF0Y2hbMl1dID0gaGFzaFtwcm9w
        XTsKICAgICAgICAvLyBEZWxldGUgZnJvbSBoYXNoIGFzIHRoaXMgd2lsbCBl
        bmQgdXAgZ2V0dGluZyBwYXNzZWQgdG8gdGhlCiAgICAgICAgLy8ge3t2aWV3
        fX0gaGVscGVyIG1ldGhvZC4KICAgICAgICBkZWxldGUgaGFzaFtwcm9wXTsK
        ICAgICAgfQogICAgfQogIH0KCiAgaWYgKGZuKSB7CiAgICBpdGVtSGFzaC50
        ZW1wbGF0ZSA9IGZuOwogICAgZGVsZXRlIG9wdGlvbnMuZm47CiAgfQoKICB2
        YXIgZW1wdHlWaWV3Q2xhc3M7CiAgaWYgKGludmVyc2UgJiYgaW52ZXJzZSAh
        PT0gSGFuZGxlYmFycy5WTS5ub29wKSB7CiAgICBlbXB0eVZpZXdDbGFzcyA9
        IGdldChjb2xsZWN0aW9uUHJvdG90eXBlLCAnZW1wdHlWaWV3Q2xhc3MnKTsK
        ICAgIGVtcHR5Vmlld0NsYXNzID0gZW1wdHlWaWV3Q2xhc3MuZXh0ZW5kKHsK
        ICAgICAgICAgIHRlbXBsYXRlOiBpbnZlcnNlLAogICAgICAgICAgdGFnTmFt
        ZTogaXRlbUhhc2gudGFnTmFtZQogICAgfSk7CiAgfSBlbHNlIGlmIChoYXNo
        LmVtcHR5Vmlld0NsYXNzKSB7CiAgICBlbXB0eVZpZXdDbGFzcyA9IGhhbmRs
        ZWJhcnNHZXQodGhpcywgaGFzaC5lbXB0eVZpZXdDbGFzcywgb3B0aW9ucyk7
        CiAgfQogIGlmIChlbXB0eVZpZXdDbGFzcykgeyBoYXNoLmVtcHR5VmlldyA9
        IGVtcHR5Vmlld0NsYXNzOyB9CgogIGlmICghaGFzaC5rZXl3b3JkKSB7CiAg
        ICBpdGVtSGFzaC5fY29udGV4dCA9IEVtYmVyLmNvbXB1dGVkLmFsaWFzKCdj
        b250ZW50Jyk7CiAgfQoKICB2YXIgdmlld09wdGlvbnMgPSBFbWJlci5IYW5k
        bGViYXJzLlZpZXdIZWxwZXIucHJvcGVydGllc0Zyb21IVE1MT3B0aW9ucyh7
        IGRhdGE6IGRhdGEsIGhhc2g6IGl0ZW1IYXNoIH0sIHRoaXMpOwogIGhhc2gu
        aXRlbVZpZXdDbGFzcyA9IGl0ZW1WaWV3Q2xhc3MuZXh0ZW5kKHZpZXdPcHRp
        b25zKTsKCiAgcmV0dXJuIEVtYmVyLkhhbmRsZWJhcnMuaGVscGVycy52aWV3
        LmNhbGwodGhpcywgY29sbGVjdGlvbkNsYXNzLCBvcHRpb25zKTsKfSk7CgoK
        fSkoKTsKCgoKKGZ1bmN0aW9uKCkgewovKmdsb2JhbHMgSGFuZGxlYmFycyAq
        LwovKioKQG1vZHVsZSBlbWJlcgpAc3VibW9kdWxlIGVtYmVyLWhhbmRsZWJh
        cnMKKi8KCnZhciBoYW5kbGViYXJzR2V0ID0gRW1iZXIuSGFuZGxlYmFycy5n
        ZXQ7CgovKioKICBgdW5ib3VuZGAgYWxsb3dzIHlvdSB0byBvdXRwdXQgYSBw
        cm9wZXJ0eSB3aXRob3V0IGJpbmRpbmcuICpJbXBvcnRhbnQ6KiBUaGUKICBv
        dXRwdXQgd2lsbCBub3QgYmUgdXBkYXRlZCBpZiB0aGUgcHJvcGVydHkgY2hh
        bmdlcy4gVXNlIHdpdGggY2F1dGlvbi4KCiAgYGBgaGFuZGxlYmFycwogIDxk
        aXY+e3t1bmJvdW5kIHNvbWVQcm9wZXJ0eVRoYXREb2VzbnRDaGFuZ2V9fTwv
        ZGl2PgogIGBgYAoKICBgdW5ib3VuZGAgY2FuIGFsc28gYmUgdXNlZCBpbiBj
        b25qdW5jdGlvbiB3aXRoIGEgYm91bmQgaGVscGVyIHRvCiAgcmVuZGVyIGl0
        IGluIGl0cyB1bmJvdW5kIGZvcm06CgogIGBgYGhhbmRsZWJhcnMKICA8ZGl2
        Pnt7dW5ib3VuZCBoZWxwZXJOYW1lIHNvbWVQcm9wZXJ0eVRoYXREb2VzbnRD
        aGFuZ2V9fTwvZGl2PgogIGBgYAoKICBAbWV0aG9kIHVuYm91bmQKICBAZm9y
        IEVtYmVyLkhhbmRsZWJhcnMuaGVscGVycwogIEBwYXJhbSB7U3RyaW5nfSBw
        cm9wZXJ0eQogIEByZXR1cm4ge1N0cmluZ30gSFRNTCBzdHJpbmcKKi8KRW1i
        ZXIuSGFuZGxlYmFycy5yZWdpc3RlckhlbHBlcigndW5ib3VuZCcsIGZ1bmN0
        aW9uKHByb3BlcnR5LCBmbikgewogIHZhciBvcHRpb25zID0gYXJndW1lbnRz
        W2FyZ3VtZW50cy5sZW5ndGggLSAxXSwgaGVscGVyLCBjb250ZXh0LCBvdXQ7
        CgogIGlmIChhcmd1bWVudHMubGVuZ3RoID4gMikgewogICAgLy8gVW5ib3Vu
        ZCBoZWxwZXIgY2FsbC4KICAgIG9wdGlvbnMuZGF0YS5pc1VuYm91bmQgPSB0
        cnVlOwogICAgaGVscGVyID0gRW1iZXIuSGFuZGxlYmFycy5oZWxwZXJzW2Fy
        Z3VtZW50c1swXV0gfHwgRW1iZXIuSGFuZGxlYmFycy5oZWxwZXJNaXNzaW5n
        OwogICAgb3V0ID0gaGVscGVyLmFwcGx5KHRoaXMsIEFycmF5LnByb3RvdHlw
        ZS5zbGljZS5jYWxsKGFyZ3VtZW50cywgMSkpOwogICAgZGVsZXRlIG9wdGlv
        bnMuZGF0YS5pc1VuYm91bmQ7CiAgICByZXR1cm4gb3V0OwogIH0KCiAgY29u
        dGV4dCA9IChmbi5jb250ZXh0cyAmJiBmbi5jb250ZXh0cy5sZW5ndGgpID8g
        Zm4uY29udGV4dHNbMF0gOiB0aGlzOwogIHJldHVybiBoYW5kbGViYXJzR2V0
        KGNvbnRleHQsIHByb3BlcnR5LCBmbik7Cn0pOwoKfSkoKTsKCgoKKGZ1bmN0
        aW9uKCkgewovKmpzaGludCBkZWJ1Zzp0cnVlKi8KLyoqCkBtb2R1bGUgZW1i
        ZXIKQHN1Ym1vZHVsZSBlbWJlci1oYW5kbGViYXJzCiovCgp2YXIgaGFuZGxl
        YmFyc0dldCA9IEVtYmVyLkhhbmRsZWJhcnMuZ2V0LCBub3JtYWxpemVQYXRo
        ID0gRW1iZXIuSGFuZGxlYmFycy5ub3JtYWxpemVQYXRoOwoKLyoqCiAgYGxv
        Z2AgYWxsb3dzIHlvdSB0byBvdXRwdXQgdGhlIHZhbHVlIG9mIGEgdmFyaWFi
        bGUgaW4gdGhlIGN1cnJlbnQgcmVuZGVyaW5nCiAgY29udGV4dC4KCiAgYGBg
        aGFuZGxlYmFycwogIHt7bG9nIG15VmFyaWFibGV9fQogIGBgYAoKICBAbWV0
        aG9kIGxvZwogIEBmb3IgRW1iZXIuSGFuZGxlYmFycy5oZWxwZXJzCiAgQHBh
        cmFtIHtTdHJpbmd9IHByb3BlcnR5CiovCkVtYmVyLkhhbmRsZWJhcnMucmVn
        aXN0ZXJIZWxwZXIoJ2xvZycsIGZ1bmN0aW9uKHByb3BlcnR5LCBvcHRpb25z
        KSB7CiAgdmFyIGNvbnRleHQgPSAob3B0aW9ucy5jb250ZXh0cyAmJiBvcHRp
        b25zLmNvbnRleHRzLmxlbmd0aCkgPyBvcHRpb25zLmNvbnRleHRzWzBdIDog
        dGhpcywKICAgICAgbm9ybWFsaXplZCA9IG5vcm1hbGl6ZVBhdGgoY29udGV4
        dCwgcHJvcGVydHksIG9wdGlvbnMuZGF0YSksCiAgICAgIHBhdGhSb290ID0g
        bm9ybWFsaXplZC5yb290LAogICAgICBwYXRoID0gbm9ybWFsaXplZC5wYXRo
        LAogICAgICB2YWx1ZSA9IChwYXRoID09PSAndGhpcycpID8gcGF0aFJvb3Qg
        OiBoYW5kbGViYXJzR2V0KHBhdGhSb290LCBwYXRoLCBvcHRpb25zKTsKICBF
        bWJlci5Mb2dnZXIubG9nKHZhbHVlKTsKfSk7CgovKioKICBFeGVjdXRlIHRo
        ZSBgZGVidWdnZXJgIHN0YXRlbWVudCBpbiB0aGUgY3VycmVudCBjb250ZXh0
        LgoKICBgYGBoYW5kbGViYXJzCiAge3tkZWJ1Z2dlcn19CiAgYGBgCgogIEBt
        ZXRob2QgZGVidWdnZXIKICBAZm9yIEVtYmVyLkhhbmRsZWJhcnMuaGVscGVy
        cwogIEBwYXJhbSB7U3RyaW5nfSBwcm9wZXJ0eQoqLwpFbWJlci5IYW5kbGVi
        YXJzLnJlZ2lzdGVySGVscGVyKCdkZWJ1Z2dlcicsIGZ1bmN0aW9uKG9wdGlv
        bnMpIHsKICBkZWJ1Z2dlcjsKfSk7Cgp9KSgpOwoKCgooZnVuY3Rpb24oKSB7
        Ci8qKgpAbW9kdWxlIGVtYmVyCkBzdWJtb2R1bGUgZW1iZXItaGFuZGxlYmFy
        cwoqLwoKdmFyIGdldCA9IEVtYmVyLmdldCwgc2V0ID0gRW1iZXIuc2V0OwoK
        RW1iZXIuSGFuZGxlYmFycy5FYWNoVmlldyA9IEVtYmVyLkNvbGxlY3Rpb25W
        aWV3LmV4dGVuZChFbWJlci5fTWV0YW1vcnBoLCB7CiAgaW5pdDogZnVuY3Rp
        b24oKSB7CiAgICB2YXIgaXRlbUNvbnRyb2xsZXIgPSBnZXQodGhpcywgJ2l0
        ZW1Db250cm9sbGVyJyk7CiAgICB2YXIgYmluZGluZzsKCiAgICBpZiAoaXRl
        bUNvbnRyb2xsZXIpIHsKICAgICAgdmFyIGNvbnRyb2xsZXIgPSBnZXQodGhp
        cywgJ2NvbnRyb2xsZXIuY29udGFpbmVyJykubG9va3VwRmFjdG9yeSgnY29u
        dHJvbGxlcjphcnJheScpLmNyZWF0ZSh7CiAgICAgICAgcGFyZW50Q29udHJv
        bGxlcjogZ2V0KHRoaXMsICdjb250cm9sbGVyJyksCiAgICAgICAgaXRlbUNv
        bnRyb2xsZXI6IGl0ZW1Db250cm9sbGVyLAogICAgICAgIHRhcmdldDogZ2V0
        KHRoaXMsICdjb250cm9sbGVyJyksCiAgICAgICAgX2VhY2hWaWV3OiB0aGlz
        CiAgICAgIH0pOwoKICAgICAgdGhpcy5kaXNhYmxlQ29udGVudE9ic2VydmVy
        cyhmdW5jdGlvbigpIHsKICAgICAgICBzZXQodGhpcywgJ2NvbnRlbnQnLCBj
        b250cm9sbGVyKTsKICAgICAgICBiaW5kaW5nID0gbmV3IEVtYmVyLkJpbmRp
        bmcoJ2NvbnRlbnQnLCAnX2VhY2hWaWV3LmRhdGFTb3VyY2UnKS5vbmVXYXko
        KTsKICAgICAgICBiaW5kaW5nLmNvbm5lY3QoY29udHJvbGxlcik7CiAgICAg
        IH0pOwoKICAgICAgc2V0KHRoaXMsICdfYXJyYXlDb250cm9sbGVyJywgY29u
        dHJvbGxlcik7CiAgICB9IGVsc2UgewogICAgICB0aGlzLmRpc2FibGVDb250
        ZW50T2JzZXJ2ZXJzKGZ1bmN0aW9uKCkgewogICAgICAgIGJpbmRpbmcgPSBu
        ZXcgRW1iZXIuQmluZGluZygnY29udGVudCcsICdkYXRhU291cmNlJykub25l
        V2F5KCk7CiAgICAgICAgYmluZGluZy5jb25uZWN0KHRoaXMpOwogICAgICB9
        KTsKICAgIH0KCiAgICByZXR1cm4gdGhpcy5fc3VwZXIoKTsKICB9LAoKICBf
        YXNzZXJ0QXJyYXlMaWtlOiBmdW5jdGlvbihjb250ZW50KSB7CiAgICBFbWJl
        ci5hc3NlcnQoIlRoZSB2YWx1ZSB0aGF0ICNlYWNoIGxvb3BzIG92ZXIgbXVz
        dCBiZSBhbiBBcnJheS4gWW91IHBhc3NlZCAiICsgY29udGVudC5jb25zdHJ1
        Y3RvciArICIsIGJ1dCBpdCBzaG91bGQgaGF2ZSBiZWVuIGFuIEFycmF5Q29u
        dHJvbGxlciIsICFFbWJlci5Db250cm9sbGVyTWl4aW4uZGV0ZWN0KGNvbnRl
        bnQpIHx8IChjb250ZW50ICYmIGNvbnRlbnQuaXNHZW5lcmF0ZWQpIHx8IGNv
        bnRlbnQgaW5zdGFuY2VvZiBFbWJlci5BcnJheUNvbnRyb2xsZXIpOwogICAg
        RW1iZXIuYXNzZXJ0KCJUaGUgdmFsdWUgdGhhdCAjZWFjaCBsb29wcyBvdmVy
        IG11c3QgYmUgYW4gQXJyYXkuIFlvdSBwYXNzZWQgIiArICgoRW1iZXIuQ29u
        dHJvbGxlck1peGluLmRldGVjdChjb250ZW50KSAmJiBjb250ZW50LmdldCgn
        bW9kZWwnKSAhPT0gdW5kZWZpbmVkKSA/ICgiIiArIGNvbnRlbnQuZ2V0KCdt
        b2RlbCcpICsgIiAod3JhcHBlZCBpbiAiICsgY29udGVudCArICIpIikgOiAo
        IiIgKyBjb250ZW50KSksIEVtYmVyLkFycmF5LmRldGVjdChjb250ZW50KSk7
        CiAgfSwKCiAgZGlzYWJsZUNvbnRlbnRPYnNlcnZlcnM6IGZ1bmN0aW9uKGNh
        bGxiYWNrKSB7CiAgICBFbWJlci5yZW1vdmVCZWZvcmVPYnNlcnZlcih0aGlz
        LCAnY29udGVudCcsIG51bGwsICdfY29udGVudFdpbGxDaGFuZ2UnKTsKICAg
        IEVtYmVyLnJlbW92ZU9ic2VydmVyKHRoaXMsICdjb250ZW50JywgbnVsbCwg
        J19jb250ZW50RGlkQ2hhbmdlJyk7CgogICAgY2FsbGJhY2suY2FsbCh0aGlz
        KTsKCiAgICBFbWJlci5hZGRCZWZvcmVPYnNlcnZlcih0aGlzLCAnY29udGVu
        dCcsIG51bGwsICdfY29udGVudFdpbGxDaGFuZ2UnKTsKICAgIEVtYmVyLmFk
        ZE9ic2VydmVyKHRoaXMsICdjb250ZW50JywgbnVsbCwgJ19jb250ZW50RGlk
        Q2hhbmdlJyk7CiAgfSwKCiAgaXRlbVZpZXdDbGFzczogRW1iZXIuX01ldGFt
        b3JwaFZpZXcsCiAgZW1wdHlWaWV3Q2xhc3M6IEVtYmVyLl9NZXRhbW9ycGhW
        aWV3LAoKICBjcmVhdGVDaGlsZFZpZXc6IGZ1bmN0aW9uKHZpZXcsIGF0dHJz
        KSB7CiAgICB2aWV3ID0gdGhpcy5fc3VwZXIodmlldywgYXR0cnMpOwoKICAg
        IC8vIEF0IHRoZSBtb21lbnQsIGlmIGEgY29udGFpbmVyIHZpZXcgc3ViY2xh
        c3Mgd2FudHMKICAgIC8vIHRvIGluc2VydCBrZXl3b3JkcywgaXQgaXMgcmVz
        cG9uc2libGUgZm9yIGNsb25pbmcKICAgIC8vIHRoZSBrZXl3b3JkcyBoYXNo
        LiBUaGlzIHdpbGwgYmUgZml4ZWQgbW9tZW50YXJpbHkuCiAgICB2YXIga2V5
        d29yZCA9IGdldCh0aGlzLCAna2V5d29yZCcpOwogICAgdmFyIGNvbnRlbnQg
        PSBnZXQodmlldywgJ2NvbnRlbnQnKTsKCiAgICBpZiAoa2V5d29yZCkgewog
        ICAgICB2YXIgZGF0YSA9IGdldCh2aWV3LCAndGVtcGxhdGVEYXRhJyk7Cgog
        ICAgICBkYXRhID0gRW1iZXIuY29weShkYXRhKTsKICAgICAgZGF0YS5rZXl3
        b3JkcyA9IHZpZXcuY2xvbmVLZXl3b3JkcygpOwogICAgICBzZXQodmlldywg
        J3RlbXBsYXRlRGF0YScsIGRhdGEpOwoKICAgICAgLy8gSW4gdGhpcyBjYXNl
        LCB3ZSBkbyBub3QgYmluZCwgYmVjYXVzZSB0aGUgYGNvbnRlbnRgIG9mCiAg
        ICAgIC8vIGEgI2VhY2ggaXRlbSBjYW5ub3QgY2hhbmdlLgogICAgICBkYXRh
        LmtleXdvcmRzW2tleXdvcmRdID0gY29udGVudDsKICAgIH0KCiAgICAvLyBJ
        ZiB7eyNlYWNofX0gaXMgbG9vcGluZyBvdmVyIGFuIGFycmF5IG9mIGNvbnRy
        b2xsZXJzLAogICAgLy8gcG9pbnQgZWFjaCBjaGlsZCB2aWV3IGF0IHRoZWly
        IHJlc3BlY3RpdmUgY29udHJvbGxlci4KICAgIGlmIChjb250ZW50ICYmIGdl
        dChjb250ZW50LCAnaXNDb250cm9sbGVyJykpIHsKICAgICAgc2V0KHZpZXcs
        ICdjb250cm9sbGVyJywgY29udGVudCk7CiAgICB9CgogICAgcmV0dXJuIHZp
        ZXc7CiAgfSwKCiAgZGVzdHJveTogZnVuY3Rpb24oKSB7CiAgICBpZiAoIXRo
        aXMuX3N1cGVyKCkpIHsgcmV0dXJuOyB9CgogICAgdmFyIGFycmF5Q29udHJv
        bGxlciA9IGdldCh0aGlzLCAnX2FycmF5Q29udHJvbGxlcicpOwoKICAgIGlm
        IChhcnJheUNvbnRyb2xsZXIpIHsKICAgICAgYXJyYXlDb250cm9sbGVyLmRl
        c3Ryb3koKTsKICAgIH0KCiAgICByZXR1cm4gdGhpczsKICB9Cn0pOwoKdmFy
        IEdyb3VwZWRFYWNoID0gRW1iZXIuSGFuZGxlYmFycy5Hcm91cGVkRWFjaCA9
        IGZ1bmN0aW9uKGNvbnRleHQsIHBhdGgsIG9wdGlvbnMpIHsKICB2YXIgc2Vs
        ZiA9IHRoaXMsCiAgICAgIG5vcm1hbGl6ZWQgPSBFbWJlci5IYW5kbGViYXJz
        Lm5vcm1hbGl6ZVBhdGgoY29udGV4dCwgcGF0aCwgb3B0aW9ucy5kYXRhKTsK
        CiAgdGhpcy5jb250ZXh0ID0gY29udGV4dDsKICB0aGlzLnBhdGggPSBwYXRo
        OwogIHRoaXMub3B0aW9ucyA9IG9wdGlvbnM7CiAgdGhpcy50ZW1wbGF0ZSA9
        IG9wdGlvbnMuZm47CiAgdGhpcy5jb250YWluaW5nVmlldyA9IG9wdGlvbnMu
        ZGF0YS52aWV3OwogIHRoaXMubm9ybWFsaXplZFJvb3QgPSBub3JtYWxpemVk
        LnJvb3Q7CiAgdGhpcy5ub3JtYWxpemVkUGF0aCA9IG5vcm1hbGl6ZWQucGF0
        aDsKICB0aGlzLmNvbnRlbnQgPSB0aGlzLmxvb2t1cENvbnRlbnQoKTsKCiAg
        dGhpcy5hZGRDb250ZW50T2JzZXJ2ZXJzKCk7CiAgdGhpcy5hZGRBcnJheU9i
        c2VydmVycygpOwoKICB0aGlzLmNvbnRhaW5pbmdWaWV3Lm9uKCd3aWxsQ2xl
        YXJSZW5kZXInLCBmdW5jdGlvbigpIHsKICAgIHNlbGYuZGVzdHJveSgpOwog
        IH0pOwp9OwoKR3JvdXBlZEVhY2gucHJvdG90eXBlID0gewogIGNvbnRlbnRX
        aWxsQ2hhbmdlOiBmdW5jdGlvbigpIHsKICAgIHRoaXMucmVtb3ZlQXJyYXlP
        YnNlcnZlcnMoKTsKICB9LAoKICBjb250ZW50RGlkQ2hhbmdlOiBmdW5jdGlv
        bigpIHsKICAgIHRoaXMuY29udGVudCA9IHRoaXMubG9va3VwQ29udGVudCgp
        OwogICAgdGhpcy5hZGRBcnJheU9ic2VydmVycygpOwogICAgdGhpcy5yZXJl
        bmRlckNvbnRhaW5pbmdWaWV3KCk7CiAgfSwKCiAgY29udGVudEFycmF5V2ls
        bENoYW5nZTogRW1iZXIuSywKCiAgY29udGVudEFycmF5RGlkQ2hhbmdlOiBm
        dW5jdGlvbigpIHsKICAgIHRoaXMucmVyZW5kZXJDb250YWluaW5nVmlldygp
        OwogIH0sCgogIGxvb2t1cENvbnRlbnQ6IGZ1bmN0aW9uKCkgewogICAgcmV0
        dXJuIEVtYmVyLkhhbmRsZWJhcnMuZ2V0KHRoaXMubm9ybWFsaXplZFJvb3Qs
        IHRoaXMubm9ybWFsaXplZFBhdGgsIHRoaXMub3B0aW9ucyk7CiAgfSwKCiAg
        YWRkQXJyYXlPYnNlcnZlcnM6IGZ1bmN0aW9uKCkgewogICAgaWYgKCF0aGlz
        LmNvbnRlbnQpIHsgcmV0dXJuOyB9CgogICAgdGhpcy5jb250ZW50LmFkZEFy
        cmF5T2JzZXJ2ZXIodGhpcywgewogICAgICB3aWxsQ2hhbmdlOiAnY29udGVu
        dEFycmF5V2lsbENoYW5nZScsCiAgICAgIGRpZENoYW5nZTogJ2NvbnRlbnRB
        cnJheURpZENoYW5nZScKICAgIH0pOwogIH0sCgogIHJlbW92ZUFycmF5T2Jz
        ZXJ2ZXJzOiBmdW5jdGlvbigpIHsKICAgIGlmICghdGhpcy5jb250ZW50KSB7
        IHJldHVybjsgfQoKICAgIHRoaXMuY29udGVudC5yZW1vdmVBcnJheU9ic2Vy
        dmVyKHRoaXMsIHsKICAgICAgd2lsbENoYW5nZTogJ2NvbnRlbnRBcnJheVdp
        bGxDaGFuZ2UnLAogICAgICBkaWRDaGFuZ2U6ICdjb250ZW50QXJyYXlEaWRD
        aGFuZ2UnCiAgICB9KTsKICB9LAoKICBhZGRDb250ZW50T2JzZXJ2ZXJzOiBm
        dW5jdGlvbigpIHsKICAgIEVtYmVyLmFkZEJlZm9yZU9ic2VydmVyKHRoaXMu
        bm9ybWFsaXplZFJvb3QsIHRoaXMubm9ybWFsaXplZFBhdGgsIHRoaXMsIHRo
        aXMuY29udGVudFdpbGxDaGFuZ2UpOwogICAgRW1iZXIuYWRkT2JzZXJ2ZXIo
        dGhpcy5ub3JtYWxpemVkUm9vdCwgdGhpcy5ub3JtYWxpemVkUGF0aCwgdGhp
        cywgdGhpcy5jb250ZW50RGlkQ2hhbmdlKTsKICB9LAoKICByZW1vdmVDb250
        ZW50T2JzZXJ2ZXJzOiBmdW5jdGlvbigpIHsKICAgIEVtYmVyLnJlbW92ZUJl
        Zm9yZU9ic2VydmVyKHRoaXMubm9ybWFsaXplZFJvb3QsIHRoaXMubm9ybWFs
        aXplZFBhdGgsIHRoaXMuY29udGVudFdpbGxDaGFuZ2UpOwogICAgRW1iZXIu
        cmVtb3ZlT2JzZXJ2ZXIodGhpcy5ub3JtYWxpemVkUm9vdCwgdGhpcy5ub3Jt
        YWxpemVkUGF0aCwgdGhpcy5jb250ZW50RGlkQ2hhbmdlKTsKICB9LAoKICBy
        ZW5kZXI6IGZ1bmN0aW9uKCkgewogICAgaWYgKCF0aGlzLmNvbnRlbnQpIHsg
        cmV0dXJuOyB9CgogICAgdmFyIGNvbnRlbnQgPSB0aGlzLmNvbnRlbnQsCiAg
        ICAgICAgY29udGVudExlbmd0aCA9IGdldChjb250ZW50LCAnbGVuZ3RoJyks
        CiAgICAgICAgZGF0YSA9IHRoaXMub3B0aW9ucy5kYXRhLAogICAgICAgIHRl
        bXBsYXRlID0gdGhpcy50ZW1wbGF0ZTsKCiAgICBkYXRhLmluc2lkZUVhY2gg
        PSB0cnVlOwogICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjb250ZW50TGVuZ3Ro
        OyBpKyspIHsKICAgICAgdGVtcGxhdGUoY29udGVudC5vYmplY3RBdChpKSwg
        eyBkYXRhOiBkYXRhIH0pOwogICAgfQogIH0sCgogIHJlcmVuZGVyQ29udGFp
        bmluZ1ZpZXc6IGZ1bmN0aW9uKCkgewogICAgdmFyIHNlbGYgPSB0aGlzOwog
        ICAgRW1iZXIucnVuLnNjaGVkdWxlT25jZSgncmVuZGVyJywgdGhpcywgZnVu
        Y3Rpb24oKSB7CiAgICAgIC8vIEl0J3MgcG9zc2libGUgaXQncyBiZWVuIGRl
        c3Ryb3llZCBhZnRlciB3ZSBlbnF1ZXVlZCBhIHJlLXJlbmRlciBjYWxsLgog
        ICAgICBpZiAoIXNlbGYuZGVzdHJveWVkKSB7CiAgICAgICAgc2VsZi5jb250
        YWluaW5nVmlldy5yZXJlbmRlcigpOwogICAgICB9CiAgICB9KTsKICB9LAoK
        ICBkZXN0cm95OiBmdW5jdGlvbigpIHsKICAgIHRoaXMucmVtb3ZlQ29udGVu
        dE9ic2VydmVycygpOwogICAgaWYgKHRoaXMuY29udGVudCkgewogICAgICB0
        aGlzLnJlbW92ZUFycmF5T2JzZXJ2ZXJzKCk7CiAgICB9CiAgICB0aGlzLmRl
        c3Ryb3llZCA9IHRydWU7CiAgfQp9OwoKLyoqCiAgVGhlIGB7eyNlYWNofX1g
        IGhlbHBlciBsb29wcyBvdmVyIGVsZW1lbnRzIGluIGEgY29sbGVjdGlvbiwg
        cmVuZGVyaW5nIGl0cwogIGJsb2NrIG9uY2UgZm9yIGVhY2ggaXRlbS4gSXQg
        aXMgYW4gZXh0ZW5zaW9uIG9mIHRoZSBiYXNlIEhhbmRsZWJhcnMgYHt7I2Vh
        Y2h9fWAKICBoZWxwZXI6CgogIGBgYGphdmFzY3JpcHQKICBEZXZlbG9wZXJz
        ID0gW3tuYW1lOiAnWWVodWRhJ30se25hbWU6ICdUb20nfSwge25hbWU6ICdQ
        YXVsJ31dOwogIGBgYAoKICBgYGBoYW5kbGViYXJzCiAge3sjZWFjaCBEZXZl
        bG9wZXJzfX0KICAgIHt7bmFtZX19CiAge3svZWFjaH19CiAgYGBgCgogIGB7
        e2VhY2h9fWAgc3VwcG9ydHMgYW4gYWx0ZXJuYXRpdmUgc3ludGF4IHdpdGgg
        ZWxlbWVudCBuYW1pbmc6CgogIGBgYGhhbmRsZWJhcnMKICB7eyNlYWNoIHBl
        cnNvbiBpbiBEZXZlbG9wZXJzfX0KICAgIHt7cGVyc29uLm5hbWV9fQogIHt7
        L2VhY2h9fQogIGBgYAoKICBXaGVuIGxvb3Bpbmcgb3ZlciBvYmplY3RzIHRo
        YXQgZG8gbm90IGhhdmUgcHJvcGVydGllcywgYHt7dGhpc319YCBjYW4gYmUg
        dXNlZAogIHRvIHJlbmRlciB0aGUgb2JqZWN0OgoKICBgYGBqYXZhc2NyaXB0
        CiAgRGV2ZWxvcGVyTmFtZXMgPSBbJ1llaHVkYScsICdUb20nLCAnUGF1bCdd
        CiAgYGBgCgogIGBgYGhhbmRsZWJhcnMKICB7eyNlYWNoIERldmVsb3Blck5h
        bWVzfX0KICAgIHt7dGhpc319CiAge3svZWFjaH19CiAgYGBgCiAgIyMjIHt7
        ZWxzZX19IGNvbmRpdGlvbgogIGB7eyNlYWNofX1gIGNhbiBoYXZlIGEgbWF0
        Y2hpbmcgYHt7ZWxzZX19YC4gVGhlIGNvbnRlbnRzIG9mIHRoaXMgYmxvY2sg
        d2lsbCByZW5kZXIKICBpZiB0aGUgY29sbGVjdGlvbiBpcyBlbXB0eS4KCiAg
        YGBgCiAge3sjZWFjaCBwZXJzb24gaW4gRGV2ZWxvcGVyc319CiAgICB7e3Bl
        cnNvbi5uYW1lfX0KICB7e2Vsc2V9fQogICAgPHA+U29ycnksIG5vYm9keSBp
        cyBhdmFpbGFibGUgZm9yIHRoaXMgdGFzay48L3A+CiAge3svZWFjaH19CiAg
        YGBgCiAgIyMjIFNwZWNpZnlpbmcgYSBWaWV3IGNsYXNzIGZvciBpdGVtcwog
        IElmIHlvdSBwcm92aWRlIGFuIGBpdGVtVmlld0NsYXNzYCBvcHRpb24gdGhh
        dCByZWZlcmVuY2VzIGEgdmlldyBjbGFzcwogIHdpdGggaXRzIG93biBgdGVt
        cGxhdGVgIHlvdSBjYW4gb21pdCB0aGUgYmxvY2suCgogIFRoZSBmb2xsb3dp
        bmcgdGVtcGxhdGU6CgogIGBgYGhhbmRsZWJhcnMKICB7eyN2aWV3IEFwcC5N
        eVZpZXcgfX0KICAgIHt7ZWFjaCB2aWV3Lml0ZW1zIGl0ZW1WaWV3Q2xhc3M9
        IkFwcC5Bbkl0ZW1WaWV3In19CiAge3svdmlld319CiAgYGBgCgogIEFuZCBh
        cHBsaWNhdGlvbiBjb2RlCgogIGBgYGphdmFzY3JpcHQKICBBcHAgPSBFbWJl
        ci5BcHBsaWNhdGlvbi5jcmVhdGUoewogICAgTXlWaWV3OiBFbWJlci5WaWV3
        LmV4dGVuZCh7CiAgICAgIGl0ZW1zOiBbCiAgICAgICAgRW1iZXIuT2JqZWN0
        LmNyZWF0ZSh7bmFtZTogJ0RhdmUnfSksCiAgICAgICAgRW1iZXIuT2JqZWN0
        LmNyZWF0ZSh7bmFtZTogJ01hcnknfSksCiAgICAgICAgRW1iZXIuT2JqZWN0
        LmNyZWF0ZSh7bmFtZTogJ1NhcmEnfSkKICAgICAgXQogICAgfSkKICB9KTsK
        CiAgQXBwLkFuSXRlbVZpZXcgPSBFbWJlci5WaWV3LmV4dGVuZCh7CiAgICB0
        ZW1wbGF0ZTogRW1iZXIuSGFuZGxlYmFycy5jb21waWxlKCJHcmVldGluZ3Mg
        e3tuYW1lfX0iKQogIH0pOwogIGBgYAoKICBXaWxsIHJlc3VsdCBpbiB0aGUg
        SFRNTCBzdHJ1Y3R1cmUgYmVsb3cKCiAgYGBgaHRtbAogIDxkaXYgY2xhc3M9
        ImVtYmVyLXZpZXciPgogICAgPGRpdiBjbGFzcz0iZW1iZXItdmlldyI+R3Jl
        ZXRpbmdzIERhdmU8L2Rpdj4KICAgIDxkaXYgY2xhc3M9ImVtYmVyLXZpZXci
        PkdyZWV0aW5ncyBNYXJ5PC9kaXY+CiAgICA8ZGl2IGNsYXNzPSJlbWJlci12
        aWV3Ij5HcmVldGluZ3MgU2FyYTwvZGl2PgogIDwvZGl2PgogIGBgYAoKICBJ
        ZiBhbiBgaXRlbVZpZXdDbGFzc2AgaXMgZGVmaW5lZCBvbiB0aGUgaGVscGVy
        LCBhbmQgdGhlcmVmb3JlIHRoZSBoZWxwZXIgaXMgbm90CiAgYmVpbmcgdXNl
        ZCBhcyBhIGJsb2NrLCBhbiBgZW1wdHlWaWV3Q2xhc3NgIGNhbiBhbHNvIGJl
        IHByb3ZpZGVkIG9wdGlvbmFsbHkuCiAgVGhlIGBlbXB0eVZpZXdDbGFzc2Ag
        d2lsbCBtYXRjaCB0aGUgYmVoYXZpb3Igb2YgdGhlIGB7e2Vsc2V9fWAgY29u
        ZGl0aW9uCiAgZGVzY3JpYmVkIGFib3ZlLiBUaGF0IGlzLCB0aGUgYGVtcHR5
        Vmlld0NsYXNzYCB3aWxsIHJlbmRlciBpZiB0aGUgY29sbGVjdGlvbgogIGlz
        IGVtcHR5LgoKICAjIyMgUmVwcmVzZW50aW5nIGVhY2ggaXRlbSB3aXRoIGEg
        Q29udHJvbGxlci4KICBCeSBkZWZhdWx0IHRoZSBjb250cm9sbGVyIGxvb2t1
        cCB3aXRoaW4gYW4gYHt7I2VhY2h9fWAgYmxvY2sgd2lsbCBiZQogIHRoZSBj
        b250cm9sbGVyIG9mIHRoZSB0ZW1wbGF0ZSB3aGVyZSB0aGUgYHt7I2VhY2h9
        fWAgd2FzIHVzZWQuIElmIGVhY2gKICBpdGVtIG5lZWRzIHRvIGJlIHByZXNl
        bnRlZCBieSBhIGN1c3RvbSBjb250cm9sbGVyIHlvdSBjYW4gcHJvdmlkZSBh
        CiAgYGl0ZW1Db250cm9sbGVyYCBvcHRpb24gd2hpY2ggcmVmZXJlbmNlcyBh
        IGNvbnRyb2xsZXIgYnkgbG9va3VwIG5hbWUuCiAgRWFjaCBpdGVtIGluIHRo
        ZSBsb29wIHdpbGwgYmUgd3JhcHBlZCBpbiBhbiBpbnN0YW5jZSBvZiB0aGlz
        IGNvbnRyb2xsZXIKICBhbmQgdGhlIGl0ZW0gaXRzZWxmIHdpbGwgYmUgc2V0
        IHRvIHRoZSBgY29udGVudGAgcHJvcGVydHkgb2YgdGhhdCBjb250cm9sbGVy
        LgoKICBUaGlzIGlzIHVzZWZ1bCBpbiBjYXNlcyB3aGVyZSBwcm9wZXJ0aWVz
        IG9mIG1vZGVsIG9iamVjdHMgbmVlZCB0cmFuc2Zvcm1hdGlvbgogIG9yIHN5
        bnRoZXNpcyBmb3IgZGlzcGxheToKCiAgYGBgamF2YXNjcmlwdAogIEFwcC5E
        ZXZlbG9wZXJDb250cm9sbGVyID0gRW1iZXIuT2JqZWN0Q29udHJvbGxlci5l
        eHRlbmQoewogICAgaXNBdmFpbGFibGVGb3JIaXJlOiBmdW5jdGlvbigpIHsK
        ICAgICAgcmV0dXJuICF0aGlzLmdldCgnY29udGVudC5pc0VtcGxveWVkJykg
        JiYgdGhpcy5nZXQoJ2NvbnRlbnQuaXNTZWVraW5nV29yaycpOwogICAgfS5w
        cm9wZXJ0eSgnaXNFbXBsb3llZCcsICdpc1NlZWtpbmdXb3JrJykKICB9KQog
        IGBgYAoKICBgYGBoYW5kbGViYXJzCiAge3sjZWFjaCBwZXJzb24gaW4gZGV2
        ZWxvcGVycyBpdGVtQ29udHJvbGxlcj0iZGV2ZWxvcGVyIn19CiAgICB7e3Bl
        cnNvbi5uYW1lfX0ge3sjaWYgcGVyc29uLmlzQXZhaWxhYmxlRm9ySGlyZX19
        SGlyZSBtZSF7ey9pZn19CiAge3svZWFjaH19CiAgYGBgCgogIEVhY2ggaXRl
        bUNvbnRyb2xsZXIgd2lsbCByZWNlaXZlIGEgcmVmZXJlbmNlIHRvIHRoZSBj
        dXJyZW50IGNvbnRyb2xsZXIgYXMKICBhIGBwYXJlbnRDb250cm9sbGVyYCBw
        cm9wZXJ0eS4KCiAgIyMjIChFeHBlcmltZW50YWwpIEdyb3VwZWQgRWFjaAoK
        ICBXaGVuIHVzZWQgaW4gY29uanVuY3Rpb24gd2l0aCB0aGUgZXhwZXJpbWVu
        dGFsIFtncm91cCBoZWxwZXJdKGh0dHBzOi8vZ2l0aHViLmNvbS9lbWJlcmpz
        L2dyb3VwLWhlbHBlciksCiAgeW91IGNhbiBpbmZvcm0gSGFuZGxlYmFycyB0
        byByZS1yZW5kZXIgYW4gZW50aXJlIGdyb3VwIG9mIGl0ZW1zIGluc3RlYWQg
        b2YKICByZS1yZW5kZXJpbmcgdGhlbSBvbmUgYXQgYSB0aW1lIChpbiB0aGUg
        ZXZlbnQgdGhhdCB0aGV5IGFyZSBjaGFuZ2VkIGVuIG1hc3NlCiAgb3IgYW4g
        aXRlbSBpcyBhZGRlZC9yZW1vdmVkKS4KCiAgYGBgaGFuZGxlYmFycwogIHt7
        I2dyb3VwfX0KICAgIHt7I2VhY2ggcGVvcGxlfX0KICAgICAge3tmaXJzdE5h
        bWV9fSB7e2xhc3ROYW1lfX0KICAgIHt7L2VhY2h9fQogIHt7L2dyb3VwfX0K
        ICBgYGAKCiAgVGhpcyBjYW4gYmUgZmFzdGVyIHRoYW4gdGhlIG5vcm1hbCB3
        YXkgdGhhdCBIYW5kbGViYXJzIHJlLXJlbmRlcnMgaXRlbXMKICBpbiBzb21l
        IGNhc2VzLgoKICBJZiBmb3Igc29tZSByZWFzb24geW91IGhhdmUgYSBncm91
        cCB3aXRoIG1vcmUgdGhhbiBvbmUgYCNlYWNoYCwgeW91IGNhbiBtYWtlCiAg
        b25lIG9mIHRoZSBjb2xsZWN0aW9ucyBiZSB1cGRhdGVkIGluIG5vcm1hbCAo
        bm9uLWdyb3VwZWQpIGZhc2hpb24gYnkgc2V0dGluZwogIHRoZSBvcHRpb24g
        YGdyb3VwZWRSb3dzPXRydWVgIChjb3VudGVyLWludHVpdGl2ZSwgSSBrbm93
        KS4KCiAgRm9yIGV4YW1wbGUsCgogIGBgYGhhbmRsZWJhcnMKICB7e2RlYWxl
        cnNoaXBOYW1lfX0KCiAge3sjZ3JvdXB9fQogICAge3sjZWFjaCBkZWFsZXJz
        fX0KICAgICAge3tmaXJzdE5hbWV9fSB7e2xhc3ROYW1lfX0KICAgIHt7L2Vh
        Y2h9fQoKICAgIHt7I2VhY2ggY2FyIGluIGNhcnMgZ3JvdXBlZFJvd3M9dHJ1
        ZX19CiAgICAgIHt7Y2FyLm1ha2V9fSB7e2Nhci5tb2RlbH19IHt7Y2FyLmNv
        bG9yfX0KICAgIHt7L2VhY2h9fQogIHt7L2dyb3VwfX0KICBgYGAKICBBbnkg
        Y2hhbmdlIHRvIGBkZWFsZXJzaGlwTmFtZWAgb3IgdGhlIGBkZWFsZXJzYCBj
        b2xsZWN0aW9uIHdpbGwgY2F1c2UgdGhlCiAgZW50aXJlIGdyb3VwIHRvIGJl
        IHJlLXJlbmRlcmVkLiBIb3dldmVyLCBjaGFuZ2VzIHRvIHRoZSBgY2Fyc2Ag
        Y29sbGVjdGlvbgogIHdpbGwgYmUgcmUtcmVuZGVyZWQgaW5kaXZpZHVhbGx5
        IChhcyBub3JtYWwpLgoKICBOb3RlIHRoYXQgYGdyb3VwYCBiZWhhdmlvciBp
        cyBhbHNvIGRpc2FibGVkIGJ5IHNwZWNpZnlpbmcgYW4gYGl0ZW1WaWV3Q2xh
        c3NgLgoKICBAbWV0aG9kIGVhY2gKICBAZm9yIEVtYmVyLkhhbmRsZWJhcnMu
        aGVscGVycwogIEBwYXJhbSBbbmFtZV0ge1N0cmluZ30gbmFtZSBmb3IgaXRl
        bSAodXNlZCB3aXRoIGBpbmApCiAgQHBhcmFtIFtwYXRoXSB7U3RyaW5nfSBw
        YXRoCiAgQHBhcmFtIFtvcHRpb25zXSB7T2JqZWN0fSBIYW5kbGViYXJzIGtl
        eS92YWx1ZSBwYWlycyBvZiBvcHRpb25zCiAgQHBhcmFtIFtvcHRpb25zLml0
        ZW1WaWV3Q2xhc3NdIHtTdHJpbmd9IGEgcGF0aCB0byBhIHZpZXcgY2xhc3Mg
        dXNlZCBmb3IgZWFjaCBpdGVtCiAgQHBhcmFtIFtvcHRpb25zLml0ZW1Db250
        cm9sbGVyXSB7U3RyaW5nfSBuYW1lIG9mIGEgY29udHJvbGxlciB0byBiZSBj
        cmVhdGVkIGZvciBlYWNoIGl0ZW0KICBAcGFyYW0gW29wdGlvbnMuZ3JvdXBl
        ZFJvd3NdIHtib29sZWFufSBlbmFibGUgbm9ybWFsIGl0ZW0tYnktaXRlbSBy
        ZW5kZXJpbmcgd2hlbiBpbnNpZGUgYSBgI2dyb3VwYCBoZWxwZXIKKi8KRW1i
        ZXIuSGFuZGxlYmFycy5yZWdpc3RlckhlbHBlcignZWFjaCcsIGZ1bmN0aW9u
        KHBhdGgsIG9wdGlvbnMpIHsKICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0g
        NCkgewogICAgRW1iZXIuYXNzZXJ0KCJJZiB5b3UgcGFzcyBtb3JlIHRoYW4g
        b25lIGFyZ3VtZW50IHRvIHRoZSBlYWNoIGhlbHBlciwgaXQgbXVzdCBiZSBp
        biB0aGUgZm9ybSAjZWFjaCBmb28gaW4gYmFyIiwgYXJndW1lbnRzWzFdID09
        PSAiaW4iKTsKCiAgICB2YXIga2V5d29yZE5hbWUgPSBhcmd1bWVudHNbMF07
        CgogICAgb3B0aW9ucyA9IGFyZ3VtZW50c1szXTsKICAgIHBhdGggPSBhcmd1
        bWVudHNbMl07CiAgICBpZiAocGF0aCA9PT0gJycpIHsgcGF0aCA9ICJ0aGlz
        IjsgfQoKICAgIG9wdGlvbnMuaGFzaC5rZXl3b3JkID0ga2V5d29yZE5hbWU7
        CiAgfQoKICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMSkgewogICAgb3B0
        aW9ucyA9IHBhdGg7CiAgICBwYXRoID0gJ3RoaXMnOwogIH0KCiAgb3B0aW9u
        cy5oYXNoLmRhdGFTb3VyY2VCaW5kaW5nID0gcGF0aDsKICAvLyBTZXQgdXAg
        ZW1wdHlWaWV3IGFzIGEgbWV0YW1vcnBoIHdpdGggbm8gdGFnCiAgLy9vcHRp
        b25zLmhhc2guZW1wdHlWaWV3Q2xhc3MgPSBFbWJlci5fTWV0YW1vcnBoVmll
        dzsKCiAgaWYgKG9wdGlvbnMuZGF0YS5pbnNpZGVHcm91cCAmJiAhb3B0aW9u
        cy5oYXNoLmdyb3VwZWRSb3dzICYmICFvcHRpb25zLmhhc2guaXRlbVZpZXdD
        bGFzcykgewogICAgbmV3IEVtYmVyLkhhbmRsZWJhcnMuR3JvdXBlZEVhY2go
        dGhpcywgcGF0aCwgb3B0aW9ucykucmVuZGVyKCk7CiAgfSBlbHNlIHsKICAg
        IHJldHVybiBFbWJlci5IYW5kbGViYXJzLmhlbHBlcnMuY29sbGVjdGlvbi5j
        YWxsKHRoaXMsICdFbWJlci5IYW5kbGViYXJzLkVhY2hWaWV3Jywgb3B0aW9u
        cyk7CiAgfQp9KTsKCn0pKCk7CgoKCihmdW5jdGlvbigpIHsKLyoqCkBtb2R1
        bGUgZW1iZXIKQHN1Ym1vZHVsZSBlbWJlci1oYW5kbGViYXJzCiovCgovKioK
        ICBgdGVtcGxhdGVgIGFsbG93cyB5b3UgdG8gcmVuZGVyIGEgdGVtcGxhdGUg
        ZnJvbSBpbnNpZGUgYW5vdGhlciB0ZW1wbGF0ZS4KICBUaGlzIGFsbG93cyB5
        b3UgdG8gcmUtdXNlIHRoZSBzYW1lIHRlbXBsYXRlIGluIG11bHRpcGxlIHBs
        YWNlcy4gRm9yIGV4YW1wbGU6CgogIGBgYGh0bWwKICA8c2NyaXB0IHR5cGU9
        InRleHQveC1oYW5kbGViYXJzIiBkYXRhLXRlbXBsYXRlLW5hbWU9ImxvZ2dl
        ZF9pbl91c2VyIj4KICAgIHt7I3dpdGggbG9nZ2VkSW5Vc2VyfX0KICAgICAg
        TGFzdCBMb2dpbjoge3tsYXN0TG9naW59fQogICAgICBVc2VyIEluZm86IHt7
        dGVtcGxhdGUgInVzZXJfaW5mbyJ9fQogICAge3svd2l0aH19CiAgPC9zY3Jp
        cHQ+CiAgYGBgCgogIGBgYGh0bWwKICA8c2NyaXB0IHR5cGU9InRleHQveC1o
        YW5kbGViYXJzIiBkYXRhLXRlbXBsYXRlLW5hbWU9InVzZXJfaW5mbyI+CiAg
        ICBOYW1lOiA8ZW0+e3tuYW1lfX08L2VtPgogICAgS2FybWE6IDxlbT57e2th
        cm1hfX08L2VtPgogIDwvc2NyaXB0PgogIGBgYAoKICBgYGBoYW5kbGViYXJz
        CiAge3sjaWYgaXNVc2VyfX0KICAgIHt7dGVtcGxhdGUgInVzZXJfaW5mbyJ9
        fQogIHt7ZWxzZX19CiAgICB7e3RlbXBsYXRlICJ1bmxvZ2dlZF91c2VyX2lu
        Zm8ifX0KICB7ey9pZn19CiAgYGBgCgogIFRoaXMgaGVscGVyIGxvb2tzIGZv
        ciB0ZW1wbGF0ZXMgaW4gdGhlIGdsb2JhbCBgRW1iZXIuVEVNUExBVEVTYCBo
        YXNoLiBJZiB5b3UKICBhZGQgYDxzY3JpcHQ+YCB0YWdzIHRvIHlvdXIgcGFn
        ZSB3aXRoIHRoZSBgZGF0YS10ZW1wbGF0ZS1uYW1lYCBhdHRyaWJ1dGUgc2V0
        LAogIHRoZXkgd2lsbCBiZSBjb21waWxlZCBhbmQgcGxhY2VkIGluIHRoaXMg
        aGFzaCBhdXRvbWF0aWNhbGx5LgoKICBZb3UgY2FuIGFsc28gbWFudWFsbHkg
        cmVnaXN0ZXIgdGVtcGxhdGVzIGJ5IGFkZGluZyB0aGVtIHRvIHRoZSBoYXNo
        OgoKICBgYGBqYXZhc2NyaXB0CiAgRW1iZXIuVEVNUExBVEVTWyJteV9jb29s
        X3RlbXBsYXRlIl0gPSBFbWJlci5IYW5kbGViYXJzLmNvbXBpbGUoJzxiPnt7
        dXNlcn19PC9iPicpOwogIGBgYAoKICBAZGVwcmVjYXRlZAogIEBtZXRob2Qg
        dGVtcGxhdGUKICBAZm9yIEVtYmVyLkhhbmRsZWJhcnMuaGVscGVycwogIEBw
        YXJhbSB7U3RyaW5nfSB0ZW1wbGF0ZU5hbWUgdGhlIHRlbXBsYXRlIHRvIHJl
        bmRlcgoqLwoKRW1iZXIuSGFuZGxlYmFycy5yZWdpc3RlckhlbHBlcigndGVt
        cGxhdGUnLCBmdW5jdGlvbihuYW1lLCBvcHRpb25zKSB7CiAgRW1iZXIuZGVw
        cmVjYXRlKCJUaGUgYHRlbXBsYXRlYCBoZWxwZXIgaGFzIGJlZW4gZGVwcmVj
        YXRlZCBpbiBmYXZvciBvZiB0aGUgYHBhcnRpYWxgIGhlbHBlci4gUGxlYXNl
        IHVzZSBgcGFydGlhbGAgaW5zdGVhZCwgd2hpY2ggd2lsbCB3b3JrIHRoZSBz
        YW1lIHdheS4iKTsKICByZXR1cm4gRW1iZXIuSGFuZGxlYmFycy5oZWxwZXJz
        LnBhcnRpYWwuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKfSk7Cgp9KSgpOwoK
        CgooZnVuY3Rpb24oKSB7Ci8qKgpAbW9kdWxlIGVtYmVyCkBzdWJtb2R1bGUg
        ZW1iZXItaGFuZGxlYmFycwoqLwoKLyoqCiAgYHBhcnRpYWxgIHJlbmRlcnMg
        YSB0ZW1wbGF0ZSBkaXJlY3RseSB1c2luZyB0aGUgY3VycmVudCBjb250ZXh0
        LgogIElmIG5lZWRlZCB0aGUgY29udGV4dCBjYW4gYmUgc2V0IHVzaW5nIHRo
        ZSBge3sjd2l0aCBmb299fWAgaGVscGVyLgoKICBgYGBodG1sCiAgPHNjcmlw
        dCB0eXBlPSJ0ZXh0L3gtaGFuZGxlYmFycyIgZGF0YS10ZW1wbGF0ZS1uYW1l
        PSJoZWFkZXJfYmFyIj4KICAgIHt7I3dpdGggY3VycmVudFVzZXJ9fQogICAg
        ICB7e3BhcnRpYWwgdXNlcl9pbmZvfX0KICAgIHt7L3dpdGh9fQogIDwvc2Ny
        aXB0PgogIGBgYAoKICBUaGUgYGRhdGEtdGVtcGxhdGUtbmFtZWAgYXR0cmli
        dXRlIG9mIGEgcGFydGlhbCB0ZW1wbGF0ZQogIGlzIHByZWZpeGVkIHdpdGgg
        YW4gdW5kZXJzY29yZS4KCiAgYGBgaHRtbAogIDxzY3JpcHQgdHlwZT0idGV4
        dC94LWhhbmRsZWJhcnMiIGRhdGEtdGVtcGxhdGUtbmFtZT0iX3VzZXJfaW5m
        byI+CiAgICA8c3Bhbj5IZWxsbyB7e3VzZXJuYW1lfX0hPC9zcGFuPgogIDwv
        c2NyaXB0PgogIGBgYAoKICBAbWV0aG9kIHBhcnRpYWwKICBAZm9yIEVtYmVy
        LkhhbmRsZWJhcnMuaGVscGVycwogIEBwYXJhbSB7U3RyaW5nfSBwYXJ0aWFs
        TmFtZSB0aGUgbmFtZSBvZiB0aGUgdGVtcGxhdGUgdG8gcmVuZGVyIG1pbnVz
        IHRoZSBsZWFkaW5nIHVuZGVyc2NvcmUKKi8KCkVtYmVyLkhhbmRsZWJhcnMu
        cmVnaXN0ZXJIZWxwZXIoJ3BhcnRpYWwnLCBmdW5jdGlvbihuYW1lLCBvcHRp
        b25zKSB7CiAgdmFyIG5hbWVQYXJ0cyA9IG5hbWUuc3BsaXQoIi8iKSwKICAg
        ICAgbGFzdFBhcnQgPSBuYW1lUGFydHNbbmFtZVBhcnRzLmxlbmd0aCAtIDFd
        OwoKICBuYW1lUGFydHNbbmFtZVBhcnRzLmxlbmd0aCAtIDFdID0gIl8iICsg
        bGFzdFBhcnQ7CgogIHZhciB2aWV3ID0gb3B0aW9ucy5kYXRhLnZpZXcsCiAg
        ICAgIHVuZGVyc2NvcmVkTmFtZSA9IG5hbWVQYXJ0cy5qb2luKCIvIiksCiAg
        ICAgIHRlbXBsYXRlID0gdmlldy50ZW1wbGF0ZUZvck5hbWUodW5kZXJzY29y
        ZWROYW1lKSwKICAgICAgZGVwcmVjYXRlZFRlbXBsYXRlID0gIXRlbXBsYXRl
        ICYmIHZpZXcudGVtcGxhdGVGb3JOYW1lKG5hbWUpOwoKICBFbWJlci5hc3Nl
        cnQoIlVuYWJsZSB0byBmaW5kIHBhcnRpYWwgd2l0aCBuYW1lICciK25hbWUr
        IicuIiwgdGVtcGxhdGUgfHwgZGVwcmVjYXRlZFRlbXBsYXRlKTsKCiAgdGVt
        cGxhdGUgPSB0ZW1wbGF0ZSB8fCBkZXByZWNhdGVkVGVtcGxhdGU7CgogIHRl
        bXBsYXRlKHRoaXMsIHsgZGF0YTogb3B0aW9ucy5kYXRhIH0pOwp9KTsKCn0p
        KCk7CgoKCihmdW5jdGlvbigpIHsKLyoqCkBtb2R1bGUgZW1iZXIKQHN1Ym1v
        ZHVsZSBlbWJlci1oYW5kbGViYXJzCiovCgp2YXIgZ2V0ID0gRW1iZXIuZ2V0
        LCBzZXQgPSBFbWJlci5zZXQ7CgovKioKICBge3t5aWVsZH19YCBkZW5vdGVz
        IGFuIGFyZWEgb2YgYSB0ZW1wbGF0ZSB0aGF0IHdpbGwgYmUgcmVuZGVyZWQg
        aW5zaWRlCiAgb2YgYW5vdGhlciB0ZW1wbGF0ZS4gSXQgaGFzIHR3byBtYWlu
        IHVzZXM6CgogICMjIyBVc2Ugd2l0aCBgbGF5b3V0YAogIFdoZW4gdXNlZCBp
        biBhIEhhbmRsZWJhcnMgdGVtcGxhdGUgdGhhdCBpcyBhc3NpZ25lZCB0byBh
        biBgRW1iZXIuVmlld2AKICBpbnN0YW5jZSdzIGBsYXlvdXRgIHByb3BlcnR5
        IEVtYmVyIHdpbGwgcmVuZGVyIHRoZSBsYXlvdXQgdGVtcGxhdGUgZmlyc3Qs
        CiAgaW5zZXJ0aW5nIHRoZSB2aWV3J3Mgb3duIHJlbmRlcmVkIG91dHB1dCBh
        dCB0aGUgYHt7eWllbGR9fWAgbG9jYXRpb24uCgogIEFuIGVtcHR5IGA8Ym9k
        eT5gIGFuZCB0aGUgZm9sbG93aW5nIGFwcGxpY2F0aW9uIGNvZGU6CgogIGBg
        YGphdmFzY3JpcHQKICBBVmlldyA9IEVtYmVyLlZpZXcuZXh0ZW5kKHsKICAg
        IGNsYXNzTmFtZXM6IFsnYS12aWV3LXdpdGgtbGF5b3V0J10sCiAgICBsYXlv
        dXQ6IEVtYmVyLkhhbmRsZWJhcnMuY29tcGlsZSgnPGRpdiBjbGFzcz0id3Jh
        cHBlciI+e3t5aWVsZH19PC9kaXY+JyksCiAgICB0ZW1wbGF0ZTogRW1iZXIu
        SGFuZGxlYmFycy5jb21waWxlKCc8c3Bhbj5JIGFtIHdyYXBwZWQ8L3NwYW4+
        JykKICB9KTsKCiAgYVZpZXcgPSBBVmlldy5jcmVhdGUoKTsKICBhVmlldy5h
        cHBlbmRUbygnYm9keScpOwogIGBgYAoKICBXaWxsIHJlc3VsdCBpbiB0aGUg
        Zm9sbG93aW5nIEhUTUwgb3V0cHV0OgoKICBgYGBodG1sCiAgPGJvZHk+CiAg
        ICA8ZGl2IGNsYXNzPSdlbWJlci12aWV3IGEtdmlldy13aXRoLWxheW91dCc+
        CiAgICAgIDxkaXYgY2xhc3M9IndyYXBwZXIiPgogICAgICAgIDxzcGFuPkkg
        YW0gd3JhcHBlZDwvc3Bhbj4KICAgICAgPC9kaXY+CiAgICA8L2Rpdj4KICA8
        L2JvZHk+CiAgYGBgCgogIFRoZSBgeWllbGRgIGhlbHBlciBjYW5ub3QgYmUg
        dXNlZCBvdXRzaWRlIG9mIGEgdGVtcGxhdGUgYXNzaWduZWQgdG8gYW4KICBg
        RW1iZXIuVmlld2AncyBgbGF5b3V0YCBwcm9wZXJ0eSBhbmQgd2lsbCB0aHJv
        dyBhbiBlcnJvciBpZiBhdHRlbXB0ZWQuCgogIGBgYGphdmFzY3JpcHQKICBC
        VmlldyA9IEVtYmVyLlZpZXcuZXh0ZW5kKHsKICAgIGNsYXNzTmFtZXM6IFsn
        YS12aWV3LXdpdGgtbGF5b3V0J10sCiAgICB0ZW1wbGF0ZTogRW1iZXIuSGFu
        ZGxlYmFycy5jb21waWxlKCd7e3lpZWxkfX0nKQogIH0pOwoKICBiVmlldyA9
        IEJWaWV3LmNyZWF0ZSgpOwogIGJWaWV3LmFwcGVuZFRvKCdib2R5Jyk7Cgog
        IC8vIHRocm93cwogIC8vIFVuY2F1Z2h0IEVycm9yOiBhc3NlcnRpb24gZmFp
        bGVkOgogIC8vIFlvdSBjYWxsZWQgeWllbGQgaW4gYSB0ZW1wbGF0ZSB0aGF0
        IHdhcyBub3QgYSBsYXlvdXQKICBgYGAKCiAgIyMjIFVzZSB3aXRoIEVtYmVy
        LkNvbXBvbmVudAogIFdoZW4gZGVzaWduaW5nIGNvbXBvbmVudHMgYHt7eWll
        bGR9fWAgaXMgdXNlZCB0byBkZW5vdGUgd2hlcmUsIGluc2lkZSB0aGUgY29t
        cG9uZW50J3MKICB0ZW1wbGF0ZSwgYW4gb3B0aW9uYWwgYmxvY2sgcGFzc2Vk
        IHRvIHRoZSBjb21wb25lbnQgc2hvdWxkIHJlbmRlcjoKCiAgYGBgaGFuZGxl
        YmFycwogIDwhLS0gYXBwbGljYXRpb24uaGJzIC0tPgogIHt7I2xhYmVsZWQt
        dGV4dGZpZWxkIHZhbHVlPXNvbWVQcm9wZXJ0eX19CiAgICBGaXJzdCBuYW1l
        OgogIHt7L2xhYmVsZWQtdGV4dGZpZWxkfX0KICBgYGAKCiAgYGBgaGFuZGxl
        YmFycwogIDwhLS0gY29tcG9uZW50cy9sYWJlbGVkLXRleHRmaWVsZC5oYnMg
        LS0+CiAgPGxhYmVsPgogICAge3t5aWVsZH19IHt7aW5wdXQgdmFsdWU9dmFs
        dWV9fQogIDwvbGFiZWw+CiAgYGBgCgogIFJlc3VsdDoKCiAgYGBgaHRtbAog
        IDxsYWJlbD4KICAgIEZpcnN0IG5hbWU6IDxpbnB1dCB0eXBlPSJ0ZXh0IiAv
        PgogIDxsYWJlbD4KICBgYGAKCiAgQG1ldGhvZCB5aWVsZAogIEBmb3IgRW1i
        ZXIuSGFuZGxlYmFycy5oZWxwZXJzCiAgQHBhcmFtIHtIYXNofSBvcHRpb25z
        CiAgQHJldHVybiB7U3RyaW5nfSBIVE1MIHN0cmluZwoqLwpFbWJlci5IYW5k
        bGViYXJzLnJlZ2lzdGVySGVscGVyKCd5aWVsZCcsIGZ1bmN0aW9uKG9wdGlv
        bnMpIHsKICB2YXIgdmlldyA9IG9wdGlvbnMuZGF0YS52aWV3OwoKICB3aGls
        ZSAodmlldyAmJiAhZ2V0KHZpZXcsICdsYXlvdXQnKSkgewogICAgaWYgKHZp
        ZXcuX2NvbnRleHRWaWV3KSB7CiAgICAgIHZpZXcgPSB2aWV3Ll9jb250ZXh0
        VmlldzsKICAgIH0gZWxzZSB7CiAgICAgIHZpZXcgPSBnZXQodmlldywgJ3Bh
        cmVudFZpZXcnKTsKICAgIH0KICB9CgogIEVtYmVyLmFzc2VydCgiWW91IGNh
        bGxlZCB5aWVsZCBpbiBhIHRlbXBsYXRlIHRoYXQgd2FzIG5vdCBhIGxheW91
        dCIsICEhdmlldyk7CgogIHZpZXcuX3lpZWxkKHRoaXMsIG9wdGlvbnMpOwp9
        KTsKCn0pKCk7CgoKCihmdW5jdGlvbigpIHsKLyoqCkBtb2R1bGUgZW1iZXIK
        QHN1Ym1vZHVsZSBlbWJlci1oYW5kbGViYXJzCiovCgovKioKICBgbG9jYCBs
        b29rcyB1cCB0aGUgc3RyaW5nIGluIHRoZSBsb2NhbGl6ZWQgc3RyaW5ncyBo
        YXNoLgogIFRoaXMgaXMgYSBjb252ZW5pZW50IHdheSB0byBsb2NhbGl6ZSB0
        ZXh0LiBGb3IgZXhhbXBsZToKCiAgYGBgaHRtbAogIDxzY3JpcHQgdHlwZT0i
        dGV4dC94LWhhbmRsZWJhcnMiIGRhdGEtdGVtcGxhdGUtbmFtZT0iaG9tZSI+
        CiAgICB7e2xvYyAid2VsY29tZSJ9fQogIDwvc2NyaXB0PgogIGBgYAoKICBU
        YWtlIG5vdGUgdGhhdCBgIndlbGNvbWUiYCBpcyBhIHN0cmluZyBhbmQgbm90
        IGFuIG9iamVjdAogIHJlZmVyZW5jZS4KCiAgQG1ldGhvZCBsb2MKICBAZm9y
        IEVtYmVyLkhhbmRsZWJhcnMuaGVscGVycwogIEBwYXJhbSB7U3RyaW5nfSBz
        dHIgVGhlIHN0cmluZyB0byBmb3JtYXQKKi8KCkVtYmVyLkhhbmRsZWJhcnMu
        cmVnaXN0ZXJIZWxwZXIoJ2xvYycsIGZ1bmN0aW9uKHN0cikgewogIHJldHVy
        biBFbWJlci5TdHJpbmcubG9jKHN0cik7Cn0pOwoKfSkoKTsKCgoKKGZ1bmN0
        aW9uKCkgewoKfSkoKTsKCgoKKGZ1bmN0aW9uKCkgewoKfSkoKTsKCgoKKGZ1
        bmN0aW9uKCkgewovKioKQG1vZHVsZSBlbWJlcgpAc3VibW9kdWxlIGVtYmVy
        LWhhbmRsZWJhcnMKKi8KCnZhciBzZXQgPSBFbWJlci5zZXQsIGdldCA9IEVt
        YmVyLmdldDsKCi8qKgogIFRoZSBpbnRlcm5hbCBjbGFzcyB1c2VkIHRvIGNy
        ZWF0ZSB0ZXh0IGlucHV0cyB3aGVuIHRoZSBge3tpbnB1dH19YAogIGhlbHBl
        ciBpcyB1c2VkIHdpdGggYHR5cGVgIG9mIGBjaGVja2JveGAuCgogIFNlZSBI
        YW5kbGViYXJzLmhlbHBlcnMuaW5wdXQgZm9yIHVzYWdlIGRldGFpbHMuCgog
        ICMjIERpcmVjdCBtYW5pcHVsYXRpb24gb2YgYGNoZWNrZWRgCgogIFRoZSBg
        Y2hlY2tlZGAgYXR0cmlidXRlIG9mIGFuIGBFbWJlci5DaGVja2JveGAgb2Jq
        ZWN0IHNob3VsZCBhbHdheXMgYmUgc2V0CiAgdGhyb3VnaCB0aGUgRW1iZXIg
        b2JqZWN0IG9yIGJ5IGludGVyYWN0aW5nIHdpdGggaXRzIHJlbmRlcmVkIGVs
        ZW1lbnQKICByZXByZXNlbnRhdGlvbiB2aWEgdGhlIG1vdXNlLCBrZXlib2Fy
        ZCwgb3IgdG91Y2guIFVwZGF0aW5nIHRoZSB2YWx1ZSBvZiB0aGUKICBjaGVj
        a2JveCB2aWEgalF1ZXJ5IHdpbGwgcmVzdWx0IGluIHRoZSBjaGVja2VkIHZh
        bHVlIG9mIHRoZSBvYmplY3QgYW5kIGl0cwogIGVsZW1lbnQgbG9zaW5nIHN5
        bmNocm9uaXphdGlvbi4KCiAgIyMgTGF5b3V0IGFuZCBMYXlvdXROYW1lIHBy
        b3BlcnRpZXMKCiAgQmVjYXVzZSBIVE1MIGBpbnB1dGAgZWxlbWVudHMgYXJl
        IHNlbGYgY2xvc2luZyBgbGF5b3V0YCBhbmQgYGxheW91dE5hbWVgCiAgcHJv
        cGVydGllcyB3aWxsIG5vdCBiZSBhcHBsaWVkLiBTZWUgW0VtYmVyLlZpZXdd
        KC9hcGkvY2xhc3Nlcy9FbWJlci5WaWV3Lmh0bWwpJ3MKICBsYXlvdXQgc2Vj
        dGlvbiBmb3IgbW9yZSBpbmZvcm1hdGlvbi4KCiAgQGNsYXNzIENoZWNrYm94
        CiAgQG5hbWVzcGFjZSBFbWJlcgogIEBleHRlbmRzIEVtYmVyLlZpZXcKKi8K
        RW1iZXIuQ2hlY2tib3ggPSBFbWJlci5WaWV3LmV4dGVuZCh7CiAgY2xhc3NO
        YW1lczogWydlbWJlci1jaGVja2JveCddLAoKICB0YWdOYW1lOiAnaW5wdXQn
        LAoKICBhdHRyaWJ1dGVCaW5kaW5nczogWyd0eXBlJywgJ2NoZWNrZWQnLCAn
        aW5kZXRlcm1pbmF0ZScsICdkaXNhYmxlZCcsICd0YWJpbmRleCcsICduYW1l
        J10sCgogIHR5cGU6ICJjaGVja2JveCIsCiAgY2hlY2tlZDogZmFsc2UsCiAg
        ZGlzYWJsZWQ6IGZhbHNlLAogIGluZGV0ZXJtaW5hdGU6IGZhbHNlLAoKICBp
        bml0OiBmdW5jdGlvbigpIHsKICAgIHRoaXMuX3N1cGVyKCk7CiAgICB0aGlz
        Lm9uKCJjaGFuZ2UiLCB0aGlzLCB0aGlzLl91cGRhdGVFbGVtZW50VmFsdWUp
        OwogIH0sCgogIGRpZEluc2VydEVsZW1lbnQ6IGZ1bmN0aW9uKCkgewogICAg
        dGhpcy5fc3VwZXIoKTsKICAgIHRoaXMuZ2V0KCdlbGVtZW50JykuaW5kZXRl
        cm1pbmF0ZSA9ICEhdGhpcy5nZXQoJ2luZGV0ZXJtaW5hdGUnKTsKICB9LAoK
        ICBfdXBkYXRlRWxlbWVudFZhbHVlOiBmdW5jdGlvbigpIHsKICAgIHNldCh0
        aGlzLCAnY2hlY2tlZCcsIHRoaXMuJCgpLnByb3AoJ2NoZWNrZWQnKSk7CiAg
        fQp9KTsKCn0pKCk7CgoKCihmdW5jdGlvbigpIHsKLyoqCkBtb2R1bGUgZW1i
        ZXIKQHN1Ym1vZHVsZSBlbWJlci1oYW5kbGViYXJzCiovCgp2YXIgZ2V0ID0g
        RW1iZXIuZ2V0LCBzZXQgPSBFbWJlci5zZXQ7CgovKioKICBTaGFyZWQgbWl4
        aW4gdXNlZCBieSBgRW1iZXIuVGV4dEZpZWxkYCBhbmQgYEVtYmVyLlRleHRB
        cmVhYC4KCiAgQGNsYXNzIFRleHRTdXBwb3J0CiAgQG5hbWVzcGFjZSBFbWJl
        cgogIEBwcml2YXRlCiovCkVtYmVyLlRleHRTdXBwb3J0ID0gRW1iZXIuTWl4
        aW4uY3JlYXRlKHsKICB2YWx1ZTogIiIsCgogIGF0dHJpYnV0ZUJpbmRpbmdz
        OiBbJ3BsYWNlaG9sZGVyJywgJ2Rpc2FibGVkJywgJ21heGxlbmd0aCcsICd0
        YWJpbmRleCddLAogIHBsYWNlaG9sZGVyOiBudWxsLAogIGRpc2FibGVkOiBm
        YWxzZSwKICBtYXhsZW5ndGg6IG51bGwsCgogIGluaXQ6IGZ1bmN0aW9uKCkg
        ewogICAgdGhpcy5fc3VwZXIoKTsKICAgIHRoaXMub24oImZvY3VzT3V0Iiwg
        dGhpcywgdGhpcy5fZWxlbWVudFZhbHVlRGlkQ2hhbmdlKTsKICAgIHRoaXMu
        b24oImNoYW5nZSIsIHRoaXMsIHRoaXMuX2VsZW1lbnRWYWx1ZURpZENoYW5n
        ZSk7CiAgICB0aGlzLm9uKCJwYXN0ZSIsIHRoaXMsIHRoaXMuX2VsZW1lbnRW
        YWx1ZURpZENoYW5nZSk7CiAgICB0aGlzLm9uKCJjdXQiLCB0aGlzLCB0aGlz
        Ll9lbGVtZW50VmFsdWVEaWRDaGFuZ2UpOwogICAgdGhpcy5vbigiaW5wdXQi
        LCB0aGlzLCB0aGlzLl9lbGVtZW50VmFsdWVEaWRDaGFuZ2UpOwogICAgdGhp
        cy5vbigia2V5VXAiLCB0aGlzLCB0aGlzLmludGVycHJldEtleUV2ZW50cyk7
        CiAgfSwKCiAgLyoqCiAgICBUaGUgYWN0aW9uIHRvIGJlIHNlbnQgd2hlbiB0
        aGUgdXNlciBwcmVzc2VzIHRoZSByZXR1cm4ga2V5LgoKICAgIFRoaXMgaXMg
        c2ltaWxhciB0byB0aGUgYHt7YWN0aW9ufX1gIGhlbHBlciwgYnV0IGlzIGZp
        cmVkIHdoZW4KICAgIHRoZSB1c2VyIHByZXNzZXMgdGhlIHJldHVybiBrZXkg
        d2hlbiBlZGl0aW5nIGEgdGV4dCBmaWVsZCwgYW5kIHNlbmRzCiAgICB0aGUg
        dmFsdWUgb2YgdGhlIGZpZWxkIGFzIHRoZSBjb250ZXh0LgoKICAgIEBwcm9w
        ZXJ0eSBhY3Rpb24KICAgIEB0eXBlIFN0cmluZwogICAgQGRlZmF1bHQgbnVs
        bAogICovCiAgYWN0aW9uOiBudWxsLAoKICAvKioKICAgIFRoZSBldmVudCB0
        aGF0IHNob3VsZCBzZW5kIHRoZSBhY3Rpb24uCgogICAgT3B0aW9ucyBhcmU6
        CgogICAgKiBgZW50ZXJgOiB0aGUgdXNlciBwcmVzc2VkIGVudGVyCiAgICAq
        IGBrZXlQcmVzc2A6IHRoZSB1c2VyIHByZXNzZWQgYSBrZXkKCiAgICBAcHJv
        cGVydHkgb25FdmVudAogICAgQHR5cGUgU3RyaW5nCiAgICBAZGVmYXVsdCBl
        bnRlcgogICovCiAgb25FdmVudDogJ2VudGVyJywKCiAgLyoqCiAgICBXaGV0
        aGVyIHRoZXkgYGtleVVwYCBldmVudCB0aGF0IHRyaWdnZXJzIGFuIGBhY3Rp
        b25gIHRvIGJlIHNlbnQgY29udGludWVzCiAgICBwcm9wYWdhdGluZyB0byBv
        dGhlciB2aWV3cy4KCiAgICBCeSBkZWZhdWx0LCB3aGVuIHRoZSB1c2VyIHBy
        ZXNzZXMgdGhlIHJldHVybiBrZXkgb24gdGhlaXIga2V5Ym9hcmQgYW5kCiAg
        ICB0aGUgdGV4dCBmaWVsZCBoYXMgYW4gYGFjdGlvbmAgc2V0LCB0aGUgYWN0
        aW9uIHdpbGwgYmUgc2VudCB0byB0aGUgdmlldydzCiAgICBjb250cm9sbGVy
        IGFuZCB0aGUga2V5IGV2ZW50IHdpbGwgc3RvcCBwcm9wYWdhdGluZy4KCiAg
        ICBJZiB5b3Ugd291bGQgbGlrZSBwYXJlbnQgdmlld3MgdG8gcmVjZWl2ZSB0
        aGUgYGtleVVwYCBldmVudCBldmVuIGFmdGVyIGFuCiAgICBhY3Rpb24gaGFz
        IGJlZW4gZGlzcGF0Y2hlZCwgc2V0IGBidWJibGVzYCB0byB0cnVlLgoKICAg
        IEBwcm9wZXJ0eSBidWJibGVzCiAgICBAdHlwZSBCb29sZWFuCiAgICBAZGVm
        YXVsdCBmYWxzZQogICovCiAgYnViYmxlczogZmFsc2UsCgogIGludGVycHJl
        dEtleUV2ZW50czogZnVuY3Rpb24oZXZlbnQpIHsKICAgIHZhciBtYXAgPSBF
        bWJlci5UZXh0U3VwcG9ydC5LRVlfRVZFTlRTOwogICAgdmFyIG1ldGhvZCA9
        IG1hcFtldmVudC5rZXlDb2RlXTsKCiAgICB0aGlzLl9lbGVtZW50VmFsdWVE
        aWRDaGFuZ2UoKTsKICAgIGlmIChtZXRob2QpIHsgcmV0dXJuIHRoaXNbbWV0
        aG9kXShldmVudCk7IH0KICB9LAoKICBfZWxlbWVudFZhbHVlRGlkQ2hhbmdl
        OiBmdW5jdGlvbigpIHsKICAgIHNldCh0aGlzLCAndmFsdWUnLCB0aGlzLiQo
        KS52YWwoKSk7CiAgfSwKCiAgLyoqCiAgICBUaGUgYWN0aW9uIHRvIGJlIHNl
        bnQgd2hlbiB0aGUgdXNlciBpbnNlcnRzIGEgbmV3IGxpbmUuCgogICAgQ2Fs
        bGVkIGJ5IHRoZSBgRW1iZXIuVGV4dFN1cHBvcnRgIG1peGluIG9uIGtleVVw
        IGlmIGtleWNvZGUgbWF0Y2hlcyAxMy4KICAgIFVzZXMgc2VuZEFjdGlvbiB0
        byBzZW5kIHRoZSBgZW50ZXJgIGFjdGlvbiB0byB0aGUgY29udHJvbGxlci4K
        CiAgICBAbWV0aG9kIGluc2VydE5ld2xpbmUKICAgIEBwYXJhbSB7RXZlbnR9
        IGV2ZW50CiAgKi8KICBpbnNlcnROZXdsaW5lOiBmdW5jdGlvbihldmVudCkg
        ewogICAgc2VuZEFjdGlvbignZW50ZXInLCB0aGlzLCBldmVudCk7CiAgICBz
        ZW5kQWN0aW9uKCdpbnNlcnQtbmV3bGluZScsIHRoaXMsIGV2ZW50KTsKICB9
        LAoKICAvKioKICAgIENhbGxlZCB3aGVuIHRoZSB1c2VyIGhpdHMgZXNjYXBl
        LgoKICAgIENhbGxlZCBieSB0aGUgYEVtYmVyLlRleHRTdXBwb3J0YCBtaXhp
        biBvbiBrZXlVcCBpZiBrZXljb2RlIG1hdGNoZXMgMjcuCiAgICBVc2VzIHNl
        bmRBY3Rpb24gdG8gc2VuZCB0aGUgYGVzY2FwZS1wcmVzc2AgYWN0aW9uIHRv
        IHRoZSBjb250cm9sbGVyLgoKICAgIEBtZXRob2QgY2FuY2VsCiAgICBAcGFy
        YW0ge0V2ZW50fSBldmVudAogICovCiAgY2FuY2VsOiBmdW5jdGlvbihldmVu
        dCkgewogICAgc2VuZEFjdGlvbignZXNjYXBlLXByZXNzJywgdGhpcywgZXZl
        bnQpOwogIH0sCgogIC8qKgogICAgQ2FsbGVkIHdoZW4gdGhlIHRleHQgYXJl
        YSBpcyBmb2N1c2VkLgoKICAgIEBtZXRob2QgZm9jdXNJbgogICAgQHBhcmFt
        IHtFdmVudH0gZXZlbnQKICAqLwogIGZvY3VzSW46IGZ1bmN0aW9uKGV2ZW50
        KSB7CiAgICBzZW5kQWN0aW9uKCdmb2N1cy1pbicsIHRoaXMsIGV2ZW50KTsK
        ICB9LAoKICAvKioKICAgIENhbGxlZCB3aGVuIHRoZSB0ZXh0IGFyZWEgaXMg
        Ymx1cnJlZC4KCiAgICBAbWV0aG9kIGZvY3VzT3V0CiAgICBAcGFyYW0ge0V2
        ZW50fSBldmVudAogICovCiAgZm9jdXNPdXQ6IGZ1bmN0aW9uKGV2ZW50KSB7
        CiAgICBzZW5kQWN0aW9uKCdmb2N1cy1vdXQnLCB0aGlzLCBldmVudCk7CiAg
        fSwKCiAgLyoqCiAgICBUaGUgYWN0aW9uIHRvIGJlIHNlbnQgd2hlbiB0aGUg
        dXNlciBwcmVzc2VzIGEga2V5LiBFbmFibGVkIGJ5IHNldHRpbmcKICAgIHRo
        ZSBgb25FdmVudGAgcHJvcGVydHkgdG8gYGtleVByZXNzYC4KCiAgICBVc2Vz
        IHNlbmRBY3Rpb24gdG8gc2VuZCB0aGUgYGtleVByZXNzYCBhY3Rpb24gdG8g
        dGhlIGNvbnRyb2xsZXIuCgogICAgQG1ldGhvZCBrZXlQcmVzcwogICAgQHBh
        cmFtIHtFdmVudH0gZXZlbnQKICAqLwogIGtleVByZXNzOiBmdW5jdGlvbihl
        dmVudCkgewogICAgc2VuZEFjdGlvbigna2V5LXByZXNzJywgdGhpcywgZXZl
        bnQpOwogIH0KCn0pOwoKRW1iZXIuVGV4dFN1cHBvcnQuS0VZX0VWRU5UUyA9
        IHsKICAxMzogJ2luc2VydE5ld2xpbmUnLAogIDI3OiAnY2FuY2VsJwp9OwoK
        Ly8gSW4gcHJpbmNpcGxlLCB0aGlzIHNob3VsZG4ndCBiZSBuZWNlc3Nhcnks
        IGJ1dCB0aGUgbGVnYWN5Ci8vIHNlY3Rpb25BY3Rpb24gc2VtYW50aWNzIGZv
        ciBUZXh0RmllbGQgYXJlIGRpZmZlcmVudCBmcm9tCi8vIHRoZSBjb21wb25l
        bnQgc2VtYW50aWNzIHNvIHRoaXMgbWV0aG9kIG5vcm1hbGl6ZXMgdGhlbS4K
        ZnVuY3Rpb24gc2VuZEFjdGlvbihldmVudE5hbWUsIHZpZXcsIGV2ZW50KSB7
        CiAgdmFyIGFjdGlvbiA9IGdldCh2aWV3LCBldmVudE5hbWUpLAogICAgICBv
        biA9IGdldCh2aWV3LCAnb25FdmVudCcpLAogICAgICB2YWx1ZSA9IGdldCh2
        aWV3LCAndmFsdWUnKTsKCiAgLy8gYmFjay1jb21wYXQgc3VwcG9ydCBmb3Ig
        a2V5UHJlc3MgYXMgYW4gZXZlbnQgbmFtZSBldmVuIHRob3VnaAogIC8vIGl0
        J3MgYWxzbyBhIG1ldGhvZCBuYW1lIHRoYXQgY29uc3VtZXMgdGhlIGV2ZW50
        IChhbmQgdGhlcmVmb3JlCiAgLy8gaW5jb21wYXRpYmxlIHdpdGggc2VuZEFj
        dGlvbiBzZW1hbnRpY3MpLgogIGlmIChvbiA9PT0gZXZlbnROYW1lIHx8IChv
        biA9PT0gJ2tleVByZXNzJyAmJiBldmVudE5hbWUgPT09ICdrZXktcHJlc3Mn
        KSkgewogICAgdmlldy5zZW5kQWN0aW9uKCdhY3Rpb24nLCB2YWx1ZSk7CiAg
        fQoKICB2aWV3LnNlbmRBY3Rpb24oZXZlbnROYW1lLCB2YWx1ZSk7CgogIGlm
        IChhY3Rpb24gfHwgb24gPT09IGV2ZW50TmFtZSkgewogICAgaWYoIWdldCh2
        aWV3LCAnYnViYmxlcycpKSB7CiAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlv
        bigpOwogICAgfQogIH0KfQoKfSkoKTsKCgoKKGZ1bmN0aW9uKCkgewovKioK
        QG1vZHVsZSBlbWJlcgpAc3VibW9kdWxlIGVtYmVyLWhhbmRsZWJhcnMKKi8K
        CnZhciBnZXQgPSBFbWJlci5nZXQsIHNldCA9IEVtYmVyLnNldDsKCi8qKgoK
        ICBUaGUgaW50ZXJuYWwgY2xhc3MgdXNlZCB0byBjcmVhdGUgdGV4dCBpbnB1
        dHMgd2hlbiB0aGUgYHt7aW5wdXR9fWAKICBoZWxwZXIgaXMgdXNlZCB3aXRo
        IGB0eXBlYCBvZiBgdGV4dGAuCgogIFNlZSBbaGFuZGxlYmFycy5oZWxwZXJz
        LmlucHV0XShhcGkvY2xhc3Nlcy9FbWJlci5IYW5kbGViYXJzLmhlbHBlcnMu
        aHRtbCNtZXRob2RfaW5wdXQpICBmb3IgdXNhZ2UgZGV0YWlscy4KCiAgIyMg
        TGF5b3V0IGFuZCBMYXlvdXROYW1lIHByb3BlcnRpZXMKCiAgQmVjYXVzZSBI
        VE1MIGBpbnB1dGAgZWxlbWVudHMgYXJlIHNlbGYgY2xvc2luZyBgbGF5b3V0
        YCBhbmQgYGxheW91dE5hbWVgCiAgcHJvcGVydGllcyB3aWxsIG5vdCBiZSBh
        cHBsaWVkLiBTZWUgW0VtYmVyLlZpZXddKC9hcGkvY2xhc3Nlcy9FbWJlci5W
        aWV3Lmh0bWwpJ3MKICBsYXlvdXQgc2VjdGlvbiBmb3IgbW9yZSBpbmZvcm1h
        dGlvbi4KCiAgQGNsYXNzIFRleHRGaWVsZAogIEBuYW1lc3BhY2UgRW1iZXIK
        ICBAZXh0ZW5kcyBFbWJlci5Db21wb25lbnQKICBAdXNlcyBFbWJlci5UZXh0
        U3VwcG9ydAoqLwpFbWJlci5UZXh0RmllbGQgPSBFbWJlci5Db21wb25lbnQu
        ZXh0ZW5kKEVtYmVyLlRleHRTdXBwb3J0LAogIC8qKiBAc2NvcGUgRW1iZXIu
        VGV4dEZpZWxkLnByb3RvdHlwZSAqLyB7CgogIGNsYXNzTmFtZXM6IFsnZW1i
        ZXItdGV4dC1maWVsZCddLAogIHRhZ05hbWU6ICJpbnB1dCIsCiAgYXR0cmli
        dXRlQmluZGluZ3M6IFsndHlwZScsICd2YWx1ZScsICdzaXplJywgJ3BhdHRl
        cm4nLCAnbmFtZSddLAoKICAvKioKICAgIFRoZSBgdmFsdWVgIGF0dHJpYnV0
        ZSBvZiB0aGUgaW5wdXQgZWxlbWVudC4gQXMgdGhlIHVzZXIgaW5wdXRzIHRl
        eHQsIHRoaXMKICAgIHByb3BlcnR5IGlzIHVwZGF0ZWQgbGl2ZS4KCiAgICBA
        cHJvcGVydHkgdmFsdWUKICAgIEB0eXBlIFN0cmluZwogICAgQGRlZmF1bHQg
        IiIKICAqLwogIHZhbHVlOiAiIiwKCiAgLyoqCiAgICBUaGUgYHR5cGVgIGF0
        dHJpYnV0ZSBvZiB0aGUgaW5wdXQgZWxlbWVudC4KCiAgICBAcHJvcGVydHkg
        dHlwZQogICAgQHR5cGUgU3RyaW5nCiAgICBAZGVmYXVsdCAidGV4dCIKICAq
        LwogIHR5cGU6ICJ0ZXh0IiwKCiAgLyoqCiAgICBUaGUgYHNpemVgIG9mIHRo
        ZSB0ZXh0IGZpZWxkIGluIGNoYXJhY3RlcnMuCgogICAgQHByb3BlcnR5IHNp
        emUKICAgIEB0eXBlIFN0cmluZwogICAgQGRlZmF1bHQgbnVsbAogICovCiAg
        c2l6ZTogbnVsbCwKCiAgLyoqCiAgICBUaGUgYHBhdHRlcm5gIHRoZSBwYXR0
        ZXJuIGF0dHJpYnV0ZSBvZiBpbnB1dCBlbGVtZW50LgoKICAgIEBwcm9wZXJ0
        eSBwYXR0ZXJuCiAgICBAdHlwZSBTdHJpbmcKICAgIEBkZWZhdWx0IG51bGwK
        ICAqLwogIHBhdHRlcm46IG51bGwKfSk7Cgp9KSgpOwoKCgooZnVuY3Rpb24o
        KSB7Ci8qCkBtb2R1bGUgZW1iZXIKQHN1Ym1vZHVsZSBlbWJlci1oYW5kbGVi
        YXJzCiovCgp2YXIgZ2V0ID0gRW1iZXIuZ2V0LCBzZXQgPSBFbWJlci5zZXQ7
        CgovKgogIEBjbGFzcyBCdXR0b24KICBAbmFtZXNwYWNlIEVtYmVyCiAgQGV4
        dGVuZHMgRW1iZXIuVmlldwogIEB1c2VzIEVtYmVyLlRhcmdldEFjdGlvblN1
        cHBvcnQKICBAZGVwcmVjYXRlZAoqLwpFbWJlci5CdXR0b24gPSBFbWJlci5W
        aWV3LmV4dGVuZChFbWJlci5UYXJnZXRBY3Rpb25TdXBwb3J0LCB7CiAgY2xh
        c3NOYW1lczogWydlbWJlci1idXR0b24nXSwKICBjbGFzc05hbWVCaW5kaW5n
        czogWydpc0FjdGl2ZSddLAoKICB0YWdOYW1lOiAnYnV0dG9uJywKCiAgcHJv
        cGFnYXRlRXZlbnRzOiBmYWxzZSwKCiAgYXR0cmlidXRlQmluZGluZ3M6IFsn
        dHlwZScsICdkaXNhYmxlZCcsICdocmVmJywgJ3RhYmluZGV4J10sCgogIC8q
        CiAgICBAcHJpdmF0ZQoKICAgIE92ZXJyaWRlcyBgVGFyZ2V0QWN0aW9uU3Vw
        cG9ydGAncyBgdGFyZ2V0T2JqZWN0YCBjb21wdXRlZAogICAgcHJvcGVydHkg
        dG8gdXNlIEhhbmRsZWJhcnMtc3BlY2lmaWMgcGF0aCByZXNvbHV0aW9uLgoK
        ICAgIEBwcm9wZXJ0eSB0YXJnZXRPYmplY3QKICAqLwogIHRhcmdldE9iamVj
        dDogRW1iZXIuY29tcHV0ZWQoZnVuY3Rpb24oKSB7CiAgICB2YXIgdGFyZ2V0
        ID0gZ2V0KHRoaXMsICd0YXJnZXQnKSwKICAgICAgICByb290ID0gZ2V0KHRo
        aXMsICdjb250ZXh0JyksCiAgICAgICAgZGF0YSA9IGdldCh0aGlzLCAndGVt
        cGxhdGVEYXRhJyk7CgogICAgaWYgKHR5cGVvZiB0YXJnZXQgIT09ICdzdHJp
        bmcnKSB7IHJldHVybiB0YXJnZXQ7IH0KCiAgICByZXR1cm4gRW1iZXIuSGFu
        ZGxlYmFycy5nZXQocm9vdCwgdGFyZ2V0LCB7IGRhdGE6IGRhdGEgfSk7CiAg
        fSkucHJvcGVydHkoJ3RhcmdldCcpLAoKICAvLyBEZWZhdWx0cyB0byAnYnV0
        dG9uJyBpZiB0YWdOYW1lIGlzICdpbnB1dCcgb3IgJ2J1dHRvbicKICB0eXBl
        OiBFbWJlci5jb21wdXRlZChmdW5jdGlvbihrZXkpIHsKICAgIHZhciB0YWdO
        YW1lID0gdGhpcy50YWdOYW1lOwogICAgaWYgKHRhZ05hbWUgPT09ICdpbnB1
        dCcgfHwgdGFnTmFtZSA9PT0gJ2J1dHRvbicpIHsgcmV0dXJuICdidXR0b24n
        OyB9CiAgfSksCgogIGRpc2FibGVkOiBmYWxzZSwKCiAgLy8gQWxsb3cgJ2En
        IHRhZ3MgdG8gYWN0IGxpa2UgYnV0dG9ucwogIGhyZWY6IEVtYmVyLmNvbXB1
        dGVkKGZ1bmN0aW9uKCkgewogICAgcmV0dXJuIHRoaXMudGFnTmFtZSA9PT0g
        J2EnID8gJyMnIDogbnVsbDsKICB9KSwKCiAgbW91c2VEb3duOiBmdW5jdGlv
        bigpIHsKICAgIGlmICghZ2V0KHRoaXMsICdkaXNhYmxlZCcpKSB7CiAgICAg
        IHNldCh0aGlzLCAnaXNBY3RpdmUnLCB0cnVlKTsKICAgICAgdGhpcy5fbW91
        c2VEb3duID0gdHJ1ZTsKICAgICAgdGhpcy5fbW91c2VFbnRlcmVkID0gdHJ1
        ZTsKICAgIH0KICAgIHJldHVybiBnZXQodGhpcywgJ3Byb3BhZ2F0ZUV2ZW50
        cycpOwogIH0sCgogIG1vdXNlTGVhdmU6IGZ1bmN0aW9uKCkgewogICAgaWYg
        KHRoaXMuX21vdXNlRG93bikgewogICAgICBzZXQodGhpcywgJ2lzQWN0aXZl
        JywgZmFsc2UpOwogICAgICB0aGlzLl9tb3VzZUVudGVyZWQgPSBmYWxzZTsK
        ICAgIH0KICB9LAoKICBtb3VzZUVudGVyOiBmdW5jdGlvbigpIHsKICAgIGlm
        ICh0aGlzLl9tb3VzZURvd24pIHsKICAgICAgc2V0KHRoaXMsICdpc0FjdGl2
        ZScsIHRydWUpOwogICAgICB0aGlzLl9tb3VzZUVudGVyZWQgPSB0cnVlOwog
        ICAgfQogIH0sCgogIG1vdXNlVXA6IGZ1bmN0aW9uKGV2ZW50KSB7CiAgICBp
        ZiAoZ2V0KHRoaXMsICdpc0FjdGl2ZScpKSB7CiAgICAgIC8vIEFjdHVhbGx5
        IGludm9rZSB0aGUgYnV0dG9uJ3MgdGFyZ2V0IGFuZCBhY3Rpb24uCiAgICAg
        IC8vIFRoaXMgbWV0aG9kIGNvbWVzIGZyb20gdGhlIEVtYmVyLlRhcmdldEFj
        dGlvblN1cHBvcnQgbWl4aW4uCiAgICAgIHRoaXMudHJpZ2dlckFjdGlvbigp
        OwogICAgICBzZXQodGhpcywgJ2lzQWN0aXZlJywgZmFsc2UpOwogICAgfQoK
        ICAgIHRoaXMuX21vdXNlRG93biA9IGZhbHNlOwogICAgdGhpcy5fbW91c2VF
        bnRlcmVkID0gZmFsc2U7CiAgICByZXR1cm4gZ2V0KHRoaXMsICdwcm9wYWdh
        dGVFdmVudHMnKTsKICB9LAoKICBrZXlEb3duOiBmdW5jdGlvbihldmVudCkg
        ewogICAgLy8gSGFuZGxlIHNwYWNlIG9yIGVudGVyCiAgICBpZiAoZXZlbnQu
        a2V5Q29kZSA9PT0gMTMgfHwgZXZlbnQua2V5Q29kZSA9PT0gMzIpIHsKICAg
        ICAgdGhpcy5tb3VzZURvd24oKTsKICAgIH0KICB9LAoKICBrZXlVcDogZnVu
        Y3Rpb24oZXZlbnQpIHsKICAgIC8vIEhhbmRsZSBzcGFjZSBvciBlbnRlcgog
        ICAgaWYgKGV2ZW50LmtleUNvZGUgPT09IDEzIHx8IGV2ZW50LmtleUNvZGUg
        PT09IDMyKSB7CiAgICAgIHRoaXMubW91c2VVcCgpOwogICAgfQogIH0sCgog
        IC8vIFRPRE86IEhhbmRsZSBwcm9wZXIgdG91Y2ggYmVoYXZpb3IuIEluY2x1
        ZGluZyBzaG91bGQgbWFrZSBpbmFjdGl2ZSB3aGVuCiAgLy8gZmluZ2VyIG1v
        dmVzIG1vcmUgdGhhbiAyMHggb3V0c2lkZSBvZiB0aGUgZWRnZSBvZiB0aGUg
        YnV0dG9uICh2cyBtb3VzZQogIC8vIHdoaWNoIGdvZXMgaW5hY3RpdmUgYXMg
        c29vbiBhcyBtb3VzZSBnb2VzIG91dCBvZiBlZGdlcy4pCgogIHRvdWNoU3Rh
        cnQ6IGZ1bmN0aW9uKHRvdWNoKSB7CiAgICByZXR1cm4gdGhpcy5tb3VzZURv
        d24odG91Y2gpOwogIH0sCgogIHRvdWNoRW5kOiBmdW5jdGlvbih0b3VjaCkg
        ewogICAgcmV0dXJuIHRoaXMubW91c2VVcCh0b3VjaCk7CiAgfSwKCiAgaW5p
        dDogZnVuY3Rpb24oKSB7CiAgICBFbWJlci5kZXByZWNhdGUoIkVtYmVyLkJ1
        dHRvbiBpcyBkZXByZWNhdGVkIGFuZCB3aWxsIGJlIHJlbW92ZWQgZnJvbSBm
        dXR1cmUgcmVsZWFzZXMuIENvbnNpZGVyIHVzaW5nIHRoZSBge3thY3Rpb259
        fWAgaGVscGVyLiIpOwogICAgdGhpcy5fc3VwZXIoKTsKICB9Cn0pOwoKfSko
        KTsKCgoKKGZ1bmN0aW9uKCkgewovKioKQG1vZHVsZSBlbWJlcgpAc3VibW9k
        dWxlIGVtYmVyLWhhbmRsZWJhcnMKKi8KCnZhciBnZXQgPSBFbWJlci5nZXQs
        IHNldCA9IEVtYmVyLnNldDsKCi8qKgogIFRoZSBpbnRlcm5hbCBjbGFzcyB1
        c2VkIHRvIGNyZWF0ZSB0ZXh0YXJlYSBlbGVtZW50IHdoZW4gdGhlIGB7e3Rl
        eHRhcmVhfX1gCiAgaGVscGVyIGlzIHVzZWQuCgogIFNlZSBbaGFuZGxlYmFy
        cy5oZWxwZXJzLnRleHRhcmVhXSgvYXBpL2NsYXNzZXMvRW1iZXIuSGFuZGxl
        YmFycy5oZWxwZXJzLmh0bWwjbWV0aG9kX3RleHRhcmVhKSAgZm9yIHVzYWdl
        IGRldGFpbHMuCgogICMjIExheW91dCBhbmQgTGF5b3V0TmFtZSBwcm9wZXJ0
        aWVzCgogIEJlY2F1c2UgSFRNTCBgdGV4dGFyZWFgIGVsZW1lbnRzIGRvIG5v
        dCBjb250YWluIGlubmVyIEhUTUwgdGhlIGBsYXlvdXRgIGFuZAogIGBsYXlv
        dXROYW1lYCBwcm9wZXJ0aWVzIHdpbGwgbm90IGJlIGFwcGxpZWQuIFNlZSBb
        RW1iZXIuVmlld10oL2FwaS9jbGFzc2VzL0VtYmVyLlZpZXcuaHRtbCkncwog
        IGxheW91dCBzZWN0aW9uIGZvciBtb3JlIGluZm9ybWF0aW9uLgoKICBAY2xh
        c3MgVGV4dEFyZWEKICBAbmFtZXNwYWNlIEVtYmVyCiAgQGV4dGVuZHMgRW1i
        ZXIuQ29tcG9uZW50CiAgQHVzZXMgRW1iZXIuVGV4dFN1cHBvcnQKKi8KRW1i
        ZXIuVGV4dEFyZWEgPSBFbWJlci5Db21wb25lbnQuZXh0ZW5kKEVtYmVyLlRl
        eHRTdXBwb3J0LCB7CiAgY2xhc3NOYW1lczogWydlbWJlci10ZXh0LWFyZWEn
        XSwKCiAgdGFnTmFtZTogInRleHRhcmVhIiwKICBhdHRyaWJ1dGVCaW5kaW5n
        czogWydyb3dzJywgJ2NvbHMnLCAnbmFtZSddLAogIHJvd3M6IG51bGwsCiAg
        Y29sczogbnVsbCwKCiAgX3VwZGF0ZUVsZW1lbnRWYWx1ZTogRW1iZXIub2Jz
        ZXJ2ZXIoZnVuY3Rpb24oKSB7CiAgICAvLyBXZSBkbyB0aGlzIGNoZWNrIHNv
        IGN1cnNvciBwb3NpdGlvbiBkb2Vzbid0IGdldCBhZmZlY3RlZCBpbiBJRQog
        ICAgdmFyIHZhbHVlID0gZ2V0KHRoaXMsICd2YWx1ZScpLAogICAgICAgICRl
        bCA9IHRoaXMuJCgpOwogICAgaWYgKCRlbCAmJiB2YWx1ZSAhPT0gJGVsLnZh
        bCgpKSB7CiAgICAgICRlbC52YWwodmFsdWUpOwogICAgfQogIH0sICd2YWx1
        ZScpLAoKICBpbml0OiBmdW5jdGlvbigpIHsKICAgIHRoaXMuX3N1cGVyKCk7
        CiAgICB0aGlzLm9uKCJkaWRJbnNlcnRFbGVtZW50IiwgdGhpcywgdGhpcy5f
        dXBkYXRlRWxlbWVudFZhbHVlKTsKICB9Cgp9KTsKCn0pKCk7CgoKCihmdW5j
        dGlvbigpIHsKLypqc2hpbnQgZXFlcWVxOmZhbHNlICovCgovKioKQG1vZHVs
        ZSBlbWJlcgpAc3VibW9kdWxlIGVtYmVyLWhhbmRsZWJhcnMKKi8KCnZhciBz
        ZXQgPSBFbWJlci5zZXQsCiAgICBnZXQgPSBFbWJlci5nZXQsCiAgICBpbmRl
        eE9mID0gRW1iZXIuRW51bWVyYWJsZVV0aWxzLmluZGV4T2YsCiAgICBpbmRl
        eGVzT2YgPSBFbWJlci5FbnVtZXJhYmxlVXRpbHMuaW5kZXhlc09mLAogICAg
        Zm9yRWFjaCA9IEVtYmVyLkVudW1lcmFibGVVdGlscy5mb3JFYWNoLAogICAg
        cmVwbGFjZSA9IEVtYmVyLkVudW1lcmFibGVVdGlscy5yZXBsYWNlLAogICAg
        aXNBcnJheSA9IEVtYmVyLmlzQXJyYXksCiAgICBwcmVjb21waWxlVGVtcGxh
        dGUgPSBFbWJlci5IYW5kbGViYXJzLmNvbXBpbGU7CgpFbWJlci5TZWxlY3RP
        cHRpb24gPSBFbWJlci5WaWV3LmV4dGVuZCh7CiAgdGFnTmFtZTogJ29wdGlv
        bicsCiAgYXR0cmlidXRlQmluZGluZ3M6IFsndmFsdWUnLCAnc2VsZWN0ZWQn
        XSwKCiAgZGVmYXVsdFRlbXBsYXRlOiBmdW5jdGlvbihjb250ZXh0LCBvcHRp
        b25zKSB7CiAgICBvcHRpb25zID0geyBkYXRhOiBvcHRpb25zLmRhdGEsIGhh
        c2g6IHt9IH07CiAgICBFbWJlci5IYW5kbGViYXJzLmhlbHBlcnMuYmluZC5j
        YWxsKGNvbnRleHQsICJ2aWV3LmxhYmVsIiwgb3B0aW9ucyk7CiAgfSwKCiAg
        aW5pdDogZnVuY3Rpb24oKSB7CiAgICB0aGlzLmxhYmVsUGF0aERpZENoYW5n
        ZSgpOwogICAgdGhpcy52YWx1ZVBhdGhEaWRDaGFuZ2UoKTsKCiAgICB0aGlz
        Ll9zdXBlcigpOwogIH0sCgogIHNlbGVjdGVkOiBFbWJlci5jb21wdXRlZChm
        dW5jdGlvbigpIHsKICAgIHZhciBjb250ZW50ID0gZ2V0KHRoaXMsICdjb250
        ZW50JyksCiAgICAgICAgc2VsZWN0aW9uID0gZ2V0KHRoaXMsICdwYXJlbnRW
        aWV3LnNlbGVjdGlvbicpOwogICAgaWYgKGdldCh0aGlzLCAncGFyZW50Vmll
        dy5tdWx0aXBsZScpKSB7CiAgICAgIHJldHVybiBzZWxlY3Rpb24gJiYgaW5k
        ZXhPZihzZWxlY3Rpb24sIGNvbnRlbnQudmFsdWVPZigpKSA+IC0xOwogICAg
        fSBlbHNlIHsKICAgICAgLy8gUHJpbWl0aXZlcyBnZXQgcGFzc2VkIHRocm91
        Z2ggYmluZGluZ3MgYXMgb2JqZWN0cy4uLiBzaW5jZQogICAgICAvLyBgbmV3
        IE51bWJlcig0KSAhPT0gNGAsIHdlIHVzZSBgPT1gIGJlbG93CiAgICAgIHJl
        dHVybiBjb250ZW50ID09IHNlbGVjdGlvbjsKICAgIH0KICB9KS5wcm9wZXJ0
        eSgnY29udGVudCcsICdwYXJlbnRWaWV3LnNlbGVjdGlvbicpLAoKICBsYWJl
        bFBhdGhEaWRDaGFuZ2U6IEVtYmVyLm9ic2VydmVyKGZ1bmN0aW9uKCkgewog
        ICAgdmFyIGxhYmVsUGF0aCA9IGdldCh0aGlzLCAncGFyZW50Vmlldy5vcHRp
        b25MYWJlbFBhdGgnKTsKCiAgICBpZiAoIWxhYmVsUGF0aCkgeyByZXR1cm47
        IH0KCiAgICBFbWJlci5kZWZpbmVQcm9wZXJ0eSh0aGlzLCAnbGFiZWwnLCBF
        bWJlci5jb21wdXRlZChmdW5jdGlvbigpIHsKICAgICAgcmV0dXJuIGdldCh0
        aGlzLCBsYWJlbFBhdGgpOwogICAgfSkucHJvcGVydHkobGFiZWxQYXRoKSk7
        CiAgfSwgJ3BhcmVudFZpZXcub3B0aW9uTGFiZWxQYXRoJyksCgogIHZhbHVl
        UGF0aERpZENoYW5nZTogRW1iZXIub2JzZXJ2ZXIoZnVuY3Rpb24oKSB7CiAg
        ICB2YXIgdmFsdWVQYXRoID0gZ2V0KHRoaXMsICdwYXJlbnRWaWV3Lm9wdGlv
        blZhbHVlUGF0aCcpOwoKICAgIGlmICghdmFsdWVQYXRoKSB7IHJldHVybjsg
        fQoKICAgIEVtYmVyLmRlZmluZVByb3BlcnR5KHRoaXMsICd2YWx1ZScsIEVt
        YmVyLmNvbXB1dGVkKGZ1bmN0aW9uKCkgewogICAgICByZXR1cm4gZ2V0KHRo
        aXMsIHZhbHVlUGF0aCk7CiAgICB9KS5wcm9wZXJ0eSh2YWx1ZVBhdGgpKTsK
        ICB9LCAncGFyZW50Vmlldy5vcHRpb25WYWx1ZVBhdGgnKQp9KTsKCkVtYmVy
        LlNlbGVjdE9wdGdyb3VwID0gRW1iZXIuQ29sbGVjdGlvblZpZXcuZXh0ZW5k
        KHsKICB0YWdOYW1lOiAnb3B0Z3JvdXAnLAogIGF0dHJpYnV0ZUJpbmRpbmdz
        OiBbJ2xhYmVsJ10sCgogIHNlbGVjdGlvbkJpbmRpbmc6ICdwYXJlbnRWaWV3
        LnNlbGVjdGlvbicsCiAgbXVsdGlwbGVCaW5kaW5nOiAncGFyZW50Vmlldy5t
        dWx0aXBsZScsCiAgb3B0aW9uTGFiZWxQYXRoQmluZGluZzogJ3BhcmVudFZp
        ZXcub3B0aW9uTGFiZWxQYXRoJywKICBvcHRpb25WYWx1ZVBhdGhCaW5kaW5n
        OiAncGFyZW50Vmlldy5vcHRpb25WYWx1ZVBhdGgnLAoKICBpdGVtVmlld0Ns
        YXNzQmluZGluZzogJ3BhcmVudFZpZXcub3B0aW9uVmlldycKfSk7CgovKioK
        ICBUaGUgYEVtYmVyLlNlbGVjdGAgdmlldyBjbGFzcyByZW5kZXJzIGEKICBb
        c2VsZWN0XShodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi9IVE1M
        L0VsZW1lbnQvc2VsZWN0KSBIVE1MIGVsZW1lbnQsCiAgYWxsb3dpbmcgdGhl
        IHVzZXIgdG8gY2hvb3NlIGZyb20gYSBsaXN0IG9mIG9wdGlvbnMuCgogIFRo
        ZSB0ZXh0IGFuZCBgdmFsdWVgIHByb3BlcnR5IG9mIGVhY2ggYDxvcHRpb24+
        YCBlbGVtZW50IHdpdGhpbiB0aGUKICBgPHNlbGVjdD5gIGVsZW1lbnQgYXJl
        IHBvcHVsYXRlZCBmcm9tIHRoZSBvYmplY3RzIGluIHRoZSBgRWxlbWVudC5T
        ZWxlY3RgJ3MKICBgY29udGVudGAgcHJvcGVydHkuIFRoZSB1bmRlcmx5aW5n
        IGRhdGEgb2JqZWN0IG9mIHRoZSBzZWxlY3RlZCBgPG9wdGlvbj5gIGlzCiAg
        c3RvcmVkIGluIHRoZSBgRWxlbWVudC5TZWxlY3RgJ3MgYHZhbHVlYCBwcm9w
        ZXJ0eS4KCiAgIyMgVGhlIENvbnRlbnQgUHJvcGVydHkgKGFycmF5IG9mIHN0
        cmluZ3MpCgogIFRoZSBzaW1wbGVzdCB2ZXJzaW9uIG9mIGFuIGBFbWJlci5T
        ZWxlY3RgIHRha2VzIGFuIGFycmF5IG9mIHN0cmluZ3MgYXMgaXRzCiAgYGNv
        bnRlbnRgIHByb3BlcnR5LiBUaGUgc3RyaW5nIHdpbGwgYmUgdXNlZCBhcyBi
        b3RoIHRoZSBgdmFsdWVgIHByb3BlcnR5IGFuZAogIHRoZSBpbm5lciB0ZXh0
        IG9mIGVhY2ggYDxvcHRpb24+YCBlbGVtZW50IGluc2lkZSB0aGUgcmVuZGVy
        ZWQgYDxzZWxlY3Q+YC4KCiAgRXhhbXBsZToKCiAgYGBgamF2YXNjcmlwdAog
        IEFwcC5BcHBsaWNhdGlvbkNvbnRyb2xsZXIgPSBFbWJlci5Db250cm9sbGVy
        LmV4dGVuZCh7CiAgICBuYW1lczogWyJZZWh1ZGEiLCAiVG9tIl0KICB9KTsK
        ICBgYGAKCiAgYGBgaGFuZGxlYmFycwogIHt7dmlldyBFbWJlci5TZWxlY3Qg
        Y29udGVudD1uYW1lc319CiAgYGBgCgogIFdvdWxkIHJlc3VsdCBpbiB0aGUg
        Zm9sbG93aW5nIEhUTUw6CgogIGBgYGh0bWwKICA8c2VsZWN0IGNsYXNzPSJl
        bWJlci1zZWxlY3QiPgogICAgPG9wdGlvbiB2YWx1ZT0iWWVodWRhIj5ZZWh1
        ZGE8L29wdGlvbj4KICAgIDxvcHRpb24gdmFsdWU9IlRvbSI+VG9tPC9vcHRp
        b24+CiAgPC9zZWxlY3Q+CiAgYGBgCgogIFlvdSBjYW4gY29udHJvbCB3aGlj
        aCBgPG9wdGlvbj5gIGlzIHNlbGVjdGVkIHRocm91Z2ggdGhlIGBFbWJlci5T
        ZWxlY3RgJ3MKICBgdmFsdWVgIHByb3BlcnR5OgoKICBgYGBqYXZhc2NyaXB0
        CiAgQXBwLkFwcGxpY2F0aW9uQ29udHJvbGxlciA9IEVtYmVyLkNvbnRyb2xs
        ZXIuZXh0ZW5kKHsKICAgIHNlbGVjdGVkTmFtZTogJ1RvbScsCiAgICBuYW1l
        czogWyJZZWh1ZGEiLCAiVG9tIl0KICB9KTsKICBgYGAKCiAgYGBgaGFuZGxl
        YmFycwogIHt7dmlldyBFbWJlci5TZWxlY3QKICAgICAgICAgY29udGVudD1u
        YW1lcwogICAgICAgICB2YWx1ZT1zZWxlY3RlZE5hbWUKICB9fQogIGBgYAoK
        ICBXb3VsZCByZXN1bHQgaW4gdGhlIGZvbGxvd2luZyBIVE1MIHdpdGggdGhl
        IGA8b3B0aW9uPmAgZm9yICdUb20nIHNlbGVjdGVkOgoKICBgYGBodG1sCiAg
        PHNlbGVjdCBjbGFzcz0iZW1iZXItc2VsZWN0Ij4KICAgIDxvcHRpb24gdmFs
        dWU9IlllaHVkYSI+WWVodWRhPC9vcHRpb24+CiAgICA8b3B0aW9uIHZhbHVl
        PSJUb20iIHNlbGVjdGVkPSJzZWxlY3RlZCI+VG9tPC9vcHRpb24+CiAgPC9z
        ZWxlY3Q+CiAgYGBgCgogIEEgdXNlciBpbnRlcmFjdGluZyB3aXRoIHRoZSBy
        ZW5kZXJlZCBgPHNlbGVjdD5gIHRvIGNob29zZSAiWWVodWRhIiB3b3VsZAog
        IHVwZGF0ZSB0aGUgdmFsdWUgb2YgYHNlbGVjdGVkTmFtZWAgdG8gIlllaHVk
        YSIuCgogICMjIFRoZSBDb250ZW50IFByb3BlcnR5IChhcnJheSBvZiBPYmpl
        Y3RzKQoKICBBbiBgRW1iZXIuU2VsZWN0YCBjYW4gYWxzbyB0YWtlIGFuIGFy
        cmF5IG9mIEphdmFTY3JpcHQgb3IgRW1iZXIgb2JqZWN0cyBhcwogIGl0cyBg
        Y29udGVudGAgcHJvcGVydHkuCgogIFdoZW4gdXNpbmcgb2JqZWN0cyB5b3Ug
        bmVlZCB0byB0ZWxsIHRoZSBgRW1iZXIuU2VsZWN0YCB3aGljaCBwcm9wZXJ0
        eSBzaG91bGQKICBiZSBhY2Nlc3NlZCBvbiBlYWNoIG9iamVjdCB0byBzdXBw
        bHkgdGhlIGB2YWx1ZWAgYXR0cmlidXRlIG9mIHRoZSBgPG9wdGlvbj5gCiAg
        YW5kIHdoaWNoIHByb3BlcnR5IHNob3VsZCBiZSB1c2VkIHRvIHN1cHBseSB0
        aGUgZWxlbWVudCB0ZXh0LgoKICBUaGUgYG9wdGlvblZhbHVlUGF0aGAgb3B0
        aW9uIGlzIHVzZWQgdG8gc3BlY2lmeSB0aGUgcGF0aCBvbiBlYWNoIG9iamVj
        dCB0bwogIHRoZSBkZXNpcmVkIHByb3BlcnR5IGZvciB0aGUgYHZhbHVlYCBh
        dHRyaWJ1dGUuIFRoZSBgb3B0aW9uTGFiZWxQYXRoYAogIHNwZWNpZmllcyB0
        aGUgcGF0aCBvbiBlYWNoIG9iamVjdCB0byB0aGUgZGVzaXJlZCBwcm9wZXJ0
        eSBmb3IgdGhlCiAgZWxlbWVudCdzIHRleHQuIEJvdGggcGF0aHMgbXVzdCBy
        ZWZlcmVuY2UgZWFjaCBvYmplY3QgaXRzZWxmIGFzIGBjb250ZW50YDoKCiAg
        YGBgamF2YXNjcmlwdAogIEFwcC5BcHBsaWNhdGlvbkNvbnRyb2xsZXIgPSBF
        bWJlci5Db250cm9sbGVyLmV4dGVuZCh7CiAgICBwcm9ncmFtbWVyczogWwog
        ICAgICB7Zmlyc3ROYW1lOiAiWWVodWRhIiwgaWQ6IDF9LAogICAgICB7Zmly
        c3ROYW1lOiAiVG9tIiwgICAgaWQ6IDJ9CiAgICBdCiAgfSk7CiAgYGBgCgog
        IGBgYGhhbmRsZWJhcnMKICB7e3ZpZXcgRW1iZXIuU2VsZWN0CiAgICAgICAg
        IGNvbnRlbnQ9cHJvZ3JhbW1lcnMKICAgICAgICAgb3B0aW9uVmFsdWVQYXRo
        PSJjb250ZW50LmlkIgogICAgICAgICBvcHRpb25MYWJlbFBhdGg9ImNvbnRl
        bnQuZmlyc3ROYW1lIn19CiAgYGBgCgogIFdvdWxkIHJlc3VsdCBpbiB0aGUg
        Zm9sbG93aW5nIEhUTUw6CgogIGBgYGh0bWwKICA8c2VsZWN0IGNsYXNzPSJl
        bWJlci1zZWxlY3QiPgogICAgPG9wdGlvbiB2YWx1ZT0iMSI+WWVodWRhPC9v
        cHRpb24+CiAgICA8b3B0aW9uIHZhbHVlPSIyIj5Ub208L29wdGlvbj4KICA8
        L3NlbGVjdD4KICBgYGAKCiAgVGhlIGB2YWx1ZWAgYXR0cmlidXRlIG9mIHRo
        ZSBzZWxlY3RlZCBgPG9wdGlvbj5gIHdpdGhpbiBhbiBgRW1iZXIuU2VsZWN0
        YAogIGNhbiBiZSBib3VuZCB0byBhIHByb3BlcnR5IG9uIGFub3RoZXIgb2Jq
        ZWN0OgoKICBgYGBqYXZhc2NyaXB0CiAgQXBwLkFwcGxpY2F0aW9uQ29udHJv
        bGxlciA9IEVtYmVyLkNvbnRyb2xsZXIuZXh0ZW5kKHsKICAgIHByb2dyYW1t
        ZXJzOiBbCiAgICAgIHtmaXJzdE5hbWU6ICJZZWh1ZGEiLCBpZDogMX0sCiAg
        ICAgIHtmaXJzdE5hbWU6ICJUb20iLCAgICBpZDogMn0KICAgIF0sCiAgICBj
        dXJyZW50UHJvZ3JhbW1lcjogewogICAgICBpZDogMgogICAgfQogIH0pOwog
        IGBgYAoKICBgYGBoYW5kbGViYXJzCiAge3t2aWV3IEVtYmVyLlNlbGVjdAog
        ICAgICAgICBjb250ZW50PXByb2dyYW1tZXJzCiAgICAgICAgIG9wdGlvblZh
        bHVlUGF0aD0iY29udGVudC5pZCIKICAgICAgICAgb3B0aW9uTGFiZWxQYXRo
        PSJjb250ZW50LmZpcnN0TmFtZSIKICAgICAgICAgdmFsdWU9Y3VycmVudFBy
        b2dyYW1tZXIuaWR9fQogIGBgYAoKICBXb3VsZCByZXN1bHQgaW4gdGhlIGZv
        bGxvd2luZyBIVE1MIHdpdGggYSBzZWxlY3RlZCBvcHRpb246CgogIGBgYGh0
        bWwKICA8c2VsZWN0IGNsYXNzPSJlbWJlci1zZWxlY3QiPgogICAgPG9wdGlv
        biB2YWx1ZT0iMSI+WWVodWRhPC9vcHRpb24+CiAgICA8b3B0aW9uIHZhbHVl
        PSIyIiBzZWxlY3RlZD0ic2VsZWN0ZWQiPlRvbTwvb3B0aW9uPgogIDwvc2Vs
        ZWN0PgogIGBgYAoKICBJbnRlcmFjdGluZyB3aXRoIHRoZSByZW5kZXJlZCBl
        bGVtZW50IGJ5IHNlbGVjdGluZyB0aGUgZmlyc3Qgb3B0aW9uCiAgKCdZZWh1
        ZGEnKSB3aWxsIHVwZGF0ZSB0aGUgYGlkYCBvZiBgY3VycmVudFByb2dyYW1t
        ZXJgCiAgdG8gbWF0Y2ggdGhlIGB2YWx1ZWAgcHJvcGVydHkgb2YgdGhlIG5l
        d2x5IHNlbGVjdGVkIGA8b3B0aW9uPmAuCgogIEFsdGVybmF0aXZlbHksIHlv
        dSBjYW4gY29udHJvbCBzZWxlY3Rpb24gdGhyb3VnaCB0aGUgdW5kZXJseWlu
        ZyBvYmplY3RzCiAgdXNlZCB0byByZW5kZXIgZWFjaCBvYmplY3QgYnkgYmlu
        ZGluZyB0aGUgYHNlbGVjdGlvbmAgb3B0aW9uLiBXaGVuIHRoZSBzZWxlY3Rl
        ZAogIGA8b3B0aW9uPmAgaXMgY2hhbmdlZCwgdGhlIHByb3BlcnR5IHBhdGgg
        cHJvdmlkZWQgdG8gYHNlbGVjdGlvbmAKICB3aWxsIGJlIHVwZGF0ZWQgdG8g
        bWF0Y2ggdGhlIGNvbnRlbnQgb2JqZWN0IG9mIHRoZSByZW5kZXJlZCBgPG9w
        dGlvbj5gCiAgZWxlbWVudDoKCiAgYGBgamF2YXNjcmlwdAogIEFwcC5BcHBs
        aWNhdGlvbkNvbnRyb2xsZXIgPSBFbWJlci5Db250cm9sbGVyLmV4dGVuZCh7
        CiAgICBzZWxlY3RlZFBlcnNvbjogbnVsbCwKICAgIHByb2dyYW1tZXJzOiBb
        CiAgICAgIHtmaXJzdE5hbWU6ICJZZWh1ZGEiLCBpZDogMX0sCiAgICAgIHtm
        aXJzdE5hbWU6ICJUb20iLCAgICBpZDogMn0KICAgIF0KICB9KTsKICBgYGAK
        CiAgYGBgaGFuZGxlYmFycwogIHt7dmlldyBFbWJlci5TZWxlY3QKICAgICAg
        ICAgY29udGVudD1wcm9ncmFtbWVycwogICAgICAgICBvcHRpb25WYWx1ZVBh
        dGg9ImNvbnRlbnQuaWQiCiAgICAgICAgIG9wdGlvbkxhYmVsUGF0aD0iY29u
        dGVudC5maXJzdE5hbWUiCiAgICAgICAgIHNlbGVjdGlvbj1zZWxlY3RlZFBl
        cnNvbn19CiAgYGBgCgogIFdvdWxkIHJlc3VsdCBpbiB0aGUgZm9sbG93aW5n
        IEhUTUwgd2l0aCBhIHNlbGVjdGVkIG9wdGlvbjoKCiAgYGBgaHRtbAogIDxz
        ZWxlY3QgY2xhc3M9ImVtYmVyLXNlbGVjdCI+CiAgICA8b3B0aW9uIHZhbHVl
        PSIxIj5ZZWh1ZGE8L29wdGlvbj4KICAgIDxvcHRpb24gdmFsdWU9IjIiIHNl
        bGVjdGVkPSJzZWxlY3RlZCI+VG9tPC9vcHRpb24+CiAgPC9zZWxlY3Q+CiAg
        YGBgCgogIEludGVyYWN0aW5nIHdpdGggdGhlIHJlbmRlcmVkIGVsZW1lbnQg
        Ynkgc2VsZWN0aW5nIHRoZSBmaXJzdCBvcHRpb24KICAoJ1llaHVkYScpIHdp
        bGwgdXBkYXRlIHRoZSBgc2VsZWN0ZWRQZXJzb25gIHRvIG1hdGNoIHRoZSBv
        YmplY3Qgb2YKICB0aGUgbmV3bHkgc2VsZWN0ZWQgYDxvcHRpb24+YC4gSW4g
        dGhpcyBjYXNlIGl0IGlzIHRoZSBmaXJzdCBvYmplY3QKICBpbiB0aGUgYHBy
        b2dyYW1tZXJzYAoKICAjIyBTdXBwbHlpbmcgYSBQcm9tcHQKCiAgQSBgbnVs
        bGAgdmFsdWUgZm9yIHRoZSBgRW1iZXIuU2VsZWN0YCdzIGB2YWx1ZWAgb3Ig
        YHNlbGVjdGlvbmAgcHJvcGVydHkKICByZXN1bHRzIGluIHRoZXJlIGJlaW5n
        IG5vIGA8b3B0aW9uPmAgd2l0aCBhIGBzZWxlY3RlZGAgYXR0cmlidXRlOgoK
        ICBgYGBqYXZhc2NyaXB0CiAgQXBwLkFwcGxpY2F0aW9uQ29udHJvbGxlciA9
        IEVtYmVyLkNvbnRyb2xsZXIuZXh0ZW5kKHsKICAgIHNlbGVjdGVkUHJvZ3Jh
        bW1lcjogbnVsbCwKICAgIHByb2dyYW1tZXJzOiBbCiAgICAgICJZZWh1ZGEi
        LAogICAgICAiVG9tIgogICAgXQogIH0pOwogIGBgYAoKICBgYGAgaGFuZGxl
        YmFycwogIHt7dmlldyBFbWJlci5TZWxlY3QKICAgICAgICAgY29udGVudD1w
        cm9ncmFtbWVycwogICAgICAgICB2YWx1ZT1zZWxlY3RlZFByb2dyYW1tZXIK
        ICB9fQogIGBgYAoKICBXb3VsZCByZXN1bHQgaW4gdGhlIGZvbGxvd2luZyBI
        VE1MOgoKICBgYGBodG1sCiAgPHNlbGVjdCBjbGFzcz0iZW1iZXItc2VsZWN0
        Ij4KICAgIDxvcHRpb24gdmFsdWU9IlllaHVkYSI+WWVodWRhPC9vcHRpb24+
        CiAgICA8b3B0aW9uIHZhbHVlPSJUb20iPlRvbTwvb3B0aW9uPgogIDwvc2Vs
        ZWN0PgogIGBgYAoKICBBbHRob3VnaCBgc2VsZWN0ZWRQcm9ncmFtbWVyYCBp
        cyBgbnVsbGAgYW5kIG5vIGA8b3B0aW9uPmAKICBoYXMgYSBgc2VsZWN0ZWRg
        IGF0dHJpYnV0ZSB0aGUgcmVuZGVyZWQgSFRNTCB3aWxsIGRpc3BsYXkgdGhl
        CiAgZmlyc3QgaXRlbSBhcyB0aG91Z2ggaXQgd2VyZSBzZWxlY3RlZC4gWW91
        IGNhbiBzdXBwbHkgYSBzdHJpbmcKICB2YWx1ZSBmb3IgdGhlIGBFbWJlci5T
        ZWxlY3RgIHRvIGRpc3BsYXkgd2hlbiB0aGVyZSBpcyBubyBzZWxlY3Rpb24K
        ICB3aXRoIHRoZSBgcHJvbXB0YCBvcHRpb246CgogIGBgYGphdmFzY3JpcHQK
        ICBBcHAuQXBwbGljYXRpb25Db250cm9sbGVyID0gRW1iZXIuQ29udHJvbGxl
        ci5leHRlbmQoewogICAgc2VsZWN0ZWRQcm9ncmFtbWVyOiBudWxsLAogICAg
        cHJvZ3JhbW1lcnM6IFsKICAgICAgIlllaHVkYSIsCiAgICAgICJUb20iCiAg
        ICBdCiAgfSk7CiAgYGBgCgogIGBgYGhhbmRsZWJhcnMKICB7e3ZpZXcgRW1i
        ZXIuU2VsZWN0CiAgICAgICAgIGNvbnRlbnQ9cHJvZ3JhbW1lcnMKICAgICAg
        ICAgdmFsdWU9c2VsZWN0ZWRQcm9ncmFtbWVyCiAgICAgICAgIHByb21wdD0i
        UGxlYXNlIHNlbGVjdCBhIG5hbWUiCiAgfX0KICBgYGAKCiAgV291bGQgcmVz
        dWx0IGluIHRoZSBmb2xsb3dpbmcgSFRNTDoKCiAgYGBgaHRtbAogIDxzZWxl
        Y3QgY2xhc3M9ImVtYmVyLXNlbGVjdCI+CiAgICA8b3B0aW9uPlBsZWFzZSBz
        ZWxlY3QgYSBuYW1lPC9vcHRpb24+CiAgICA8b3B0aW9uIHZhbHVlPSJZZWh1
        ZGEiPlllaHVkYTwvb3B0aW9uPgogICAgPG9wdGlvbiB2YWx1ZT0iVG9tIj5U
        b208L29wdGlvbj4KICA8L3NlbGVjdD4KICBgYGAKCiAgQGNsYXNzIFNlbGVj
        dAogIEBuYW1lc3BhY2UgRW1iZXIKICBAZXh0ZW5kcyBFbWJlci5WaWV3Ciov
        CkVtYmVyLlNlbGVjdCA9IEVtYmVyLlZpZXcuZXh0ZW5kKAogIC8qKiBAc2Nv
        cGUgRW1iZXIuU2VsZWN0LnByb3RvdHlwZSAqLyB7CgogIHRhZ05hbWU6ICdz
        ZWxlY3QnLAogIGNsYXNzTmFtZXM6IFsnZW1iZXItc2VsZWN0J10sCiAgZGVm
        YXVsdFRlbXBsYXRlOiBFbWJlci5IYW5kbGViYXJzLnRlbXBsYXRlKGZ1bmN0
        aW9uIGFub255bW91cyhIYW5kbGViYXJzLGRlcHRoMCxoZWxwZXJzLHBhcnRp
        YWxzLGRhdGEpIHsKdGhpcy5jb21waWxlckluZm8gPSBbNCwnPj0gMS4wLjAn
        XTsKaGVscGVycyA9IHRoaXMubWVyZ2UoaGVscGVycywgRW1iZXIuSGFuZGxl
        YmFycy5oZWxwZXJzKTsgZGF0YSA9IGRhdGEgfHwge307CiAgdmFyIGJ1ZmZl
        ciA9ICcnLCBzdGFjazEsIGhhc2hUeXBlcywgaGFzaENvbnRleHRzLCBlc2Nh
        cGVFeHByZXNzaW9uPXRoaXMuZXNjYXBlRXhwcmVzc2lvbiwgc2VsZj10aGlz
        OwoKZnVuY3Rpb24gcHJvZ3JhbTEoZGVwdGgwLGRhdGEpIHsKICAKICB2YXIg
        YnVmZmVyID0gJycsIGhhc2hUeXBlcywgaGFzaENvbnRleHRzOwogIGRhdGEu
        YnVmZmVyLnB1c2goIjxvcHRpb24gdmFsdWU9XCJcIj4iKTsKICBoYXNoVHlw
        ZXMgPSB7fTsKICBoYXNoQ29udGV4dHMgPSB7fTsKICBkYXRhLmJ1ZmZlci5w
        dXNoKGVzY2FwZUV4cHJlc3Npb24oaGVscGVycy5fdHJpYWdlTXVzdGFjaGUu
        Y2FsbChkZXB0aDAsICJ2aWV3LnByb21wdCIsIHtoYXNoOnt9LGNvbnRleHRz
        OltkZXB0aDBdLHR5cGVzOlsiSUQiXSxoYXNoQ29udGV4dHM6aGFzaENvbnRl
        eHRzLGhhc2hUeXBlczpoYXNoVHlwZXMsZGF0YTpkYXRhfSkpKTsKICBkYXRh
        LmJ1ZmZlci5wdXNoKCI8L29wdGlvbj4iKTsKICByZXR1cm4gYnVmZmVyOwog
        IH0KCmZ1bmN0aW9uIHByb2dyYW0zKGRlcHRoMCxkYXRhKSB7CiAgCiAgdmFy
        IHN0YWNrMSwgaGFzaFR5cGVzLCBoYXNoQ29udGV4dHM7CiAgaGFzaFR5cGVz
        ID0ge307CiAgaGFzaENvbnRleHRzID0ge307CiAgc3RhY2sxID0gaGVscGVy
        cy5lYWNoLmNhbGwoZGVwdGgwLCAidmlldy5ncm91cGVkQ29udGVudCIsIHto
        YXNoOnt9LGludmVyc2U6c2VsZi5ub29wLGZuOnNlbGYucHJvZ3JhbSg0LCBw
        cm9ncmFtNCwgZGF0YSksY29udGV4dHM6W2RlcHRoMF0sdHlwZXM6WyJJRCJd
        LGhhc2hDb250ZXh0czpoYXNoQ29udGV4dHMsaGFzaFR5cGVzOmhhc2hUeXBl
        cyxkYXRhOmRhdGF9KTsKICBpZihzdGFjazEgfHwgc3RhY2sxID09PSAwKSB7
        IGRhdGEuYnVmZmVyLnB1c2goc3RhY2sxKTsgfQogIGVsc2UgeyBkYXRhLmJ1
        ZmZlci5wdXNoKCcnKTsgfQogIH0KZnVuY3Rpb24gcHJvZ3JhbTQoZGVwdGgw
        LGRhdGEpIHsKICAKICB2YXIgaGFzaENvbnRleHRzLCBoYXNoVHlwZXM7CiAg
        aGFzaENvbnRleHRzID0geydjb250ZW50JzogZGVwdGgwLCdsYWJlbCc6IGRl
        cHRoMH07CiAgaGFzaFR5cGVzID0geydjb250ZW50JzogIklEIiwnbGFiZWwn
        OiAiSUQifTsKICBkYXRhLmJ1ZmZlci5wdXNoKGVzY2FwZUV4cHJlc3Npb24o
        aGVscGVycy52aWV3LmNhbGwoZGVwdGgwLCAidmlldy5ncm91cFZpZXciLCB7
        aGFzaDp7CiAgICAnY29udGVudCc6ICgiY29udGVudCIpLAogICAgJ2xhYmVs
        JzogKCJsYWJlbCIpCiAgfSxjb250ZXh0czpbZGVwdGgwXSx0eXBlczpbIklE
        Il0saGFzaENvbnRleHRzOmhhc2hDb250ZXh0cyxoYXNoVHlwZXM6aGFzaFR5
        cGVzLGRhdGE6ZGF0YX0pKSk7CiAgfQoKZnVuY3Rpb24gcHJvZ3JhbTYoZGVw
        dGgwLGRhdGEpIHsKICAKICB2YXIgc3RhY2sxLCBoYXNoVHlwZXMsIGhhc2hD
        b250ZXh0czsKICBoYXNoVHlwZXMgPSB7fTsKICBoYXNoQ29udGV4dHMgPSB7
        fTsKICBzdGFjazEgPSBoZWxwZXJzLmVhY2guY2FsbChkZXB0aDAsICJ2aWV3
        LmNvbnRlbnQiLCB7aGFzaDp7fSxpbnZlcnNlOnNlbGYubm9vcCxmbjpzZWxm
        LnByb2dyYW0oNywgcHJvZ3JhbTcsIGRhdGEpLGNvbnRleHRzOltkZXB0aDBd
        LHR5cGVzOlsiSUQiXSxoYXNoQ29udGV4dHM6aGFzaENvbnRleHRzLGhhc2hU
        eXBlczpoYXNoVHlwZXMsZGF0YTpkYXRhfSk7CiAgaWYoc3RhY2sxIHx8IHN0
        YWNrMSA9PT0gMCkgeyBkYXRhLmJ1ZmZlci5wdXNoKHN0YWNrMSk7IH0KICBl
        bHNlIHsgZGF0YS5idWZmZXIucHVzaCgnJyk7IH0KICB9CmZ1bmN0aW9uIHBy
        b2dyYW03KGRlcHRoMCxkYXRhKSB7CiAgCiAgdmFyIGhhc2hDb250ZXh0cywg
        aGFzaFR5cGVzOwogIGhhc2hDb250ZXh0cyA9IHsnY29udGVudCc6IGRlcHRo
        MH07CiAgaGFzaFR5cGVzID0geydjb250ZW50JzogIklEIn07CiAgZGF0YS5i
        dWZmZXIucHVzaChlc2NhcGVFeHByZXNzaW9uKGhlbHBlcnMudmlldy5jYWxs
        KGRlcHRoMCwgInZpZXcub3B0aW9uVmlldyIsIHtoYXNoOnsKICAgICdjb250
        ZW50JzogKCIiKQogIH0sY29udGV4dHM6W2RlcHRoMF0sdHlwZXM6WyJJRCJd
        LGhhc2hDb250ZXh0czpoYXNoQ29udGV4dHMsaGFzaFR5cGVzOmhhc2hUeXBl
        cyxkYXRhOmRhdGF9KSkpOwogIH0KCiAgaGFzaFR5cGVzID0ge307CiAgaGFz
        aENvbnRleHRzID0ge307CiAgc3RhY2sxID0gaGVscGVyc1snaWYnXS5jYWxs
        KGRlcHRoMCwgInZpZXcucHJvbXB0Iiwge2hhc2g6e30saW52ZXJzZTpzZWxm
        Lm5vb3AsZm46c2VsZi5wcm9ncmFtKDEsIHByb2dyYW0xLCBkYXRhKSxjb250
        ZXh0czpbZGVwdGgwXSx0eXBlczpbIklEIl0saGFzaENvbnRleHRzOmhhc2hD
        b250ZXh0cyxoYXNoVHlwZXM6aGFzaFR5cGVzLGRhdGE6ZGF0YX0pOwogIGlm
        KHN0YWNrMSB8fCBzdGFjazEgPT09IDApIHsgZGF0YS5idWZmZXIucHVzaChz
        dGFjazEpOyB9CiAgaGFzaFR5cGVzID0ge307CiAgaGFzaENvbnRleHRzID0g
        e307CiAgc3RhY2sxID0gaGVscGVyc1snaWYnXS5jYWxsKGRlcHRoMCwgInZp
        ZXcub3B0aW9uR3JvdXBQYXRoIiwge2hhc2g6e30saW52ZXJzZTpzZWxmLnBy
        b2dyYW0oNiwgcHJvZ3JhbTYsIGRhdGEpLGZuOnNlbGYucHJvZ3JhbSgzLCBw
        cm9ncmFtMywgZGF0YSksY29udGV4dHM6W2RlcHRoMF0sdHlwZXM6WyJJRCJd
        LGhhc2hDb250ZXh0czpoYXNoQ29udGV4dHMsaGFzaFR5cGVzOmhhc2hUeXBl
        cyxkYXRhOmRhdGF9KTsKICBpZihzdGFjazEgfHwgc3RhY2sxID09PSAwKSB7
        IGRhdGEuYnVmZmVyLnB1c2goc3RhY2sxKTsgfQogIHJldHVybiBidWZmZXI7
        CiAgCn0pLAogIGF0dHJpYnV0ZUJpbmRpbmdzOiBbJ211bHRpcGxlJywgJ2Rp
        c2FibGVkJywgJ3RhYmluZGV4JywgJ25hbWUnXSwKCiAgLyoqCiAgICBUaGUg
        YG11bHRpcGxlYCBhdHRyaWJ1dGUgb2YgdGhlIHNlbGVjdCBlbGVtZW50LiBJ
        bmRpY2F0ZXMgd2hldGhlciBtdWx0aXBsZQogICAgb3B0aW9ucyBjYW4gYmUg
        c2VsZWN0ZWQuCgogICAgQHByb3BlcnR5IG11bHRpcGxlCiAgICBAdHlwZSBC
        b29sZWFuCiAgICBAZGVmYXVsdCBmYWxzZQogICovCiAgbXVsdGlwbGU6IGZh
        bHNlLAoKICAvKioKICAgIFRoZSBgZGlzYWJsZWRgIGF0dHJpYnV0ZSBvZiB0
        aGUgc2VsZWN0IGVsZW1lbnQuIEluZGljYXRlcyB3aGV0aGVyCiAgICB0aGUg
        ZWxlbWVudCBpcyBkaXNhYmxlZCBmcm9tIGludGVyYWN0aW9ucy4KCiAgICBA
        cHJvcGVydHkgZGlzYWJsZWQKICAgIEB0eXBlIEJvb2xlYW4KICAgIEBkZWZh
        dWx0IGZhbHNlCiAgKi8KICBkaXNhYmxlZDogZmFsc2UsCgogIC8qKgogICAg
        VGhlIGxpc3Qgb2Ygb3B0aW9ucy4KCiAgICBJZiBgb3B0aW9uTGFiZWxQYXRo
        YCBhbmQgYG9wdGlvblZhbHVlUGF0aGAgYXJlIG5vdCBvdmVycmlkZGVuLCB0
        aGlzIHNob3VsZAogICAgYmUgYSBsaXN0IG9mIHN0cmluZ3MsIHdoaWNoIHdp
        bGwgc2VydmUgc2ltdWx0YW5lb3VzbHkgYXMgbGFiZWxzIGFuZCB2YWx1ZXMu
        CgogICAgT3RoZXJ3aXNlLCB0aGlzIHNob3VsZCBiZSBhIGxpc3Qgb2Ygb2Jq
        ZWN0cy4gRm9yIGluc3RhbmNlOgoKICAgIGBgYGphdmFzY3JpcHQKICAgIEVt
        YmVyLlNlbGVjdC5jcmVhdGUoewogICAgICBjb250ZW50OiBFbWJlci5BKFsK
        ICAgICAgICAgIHsgaWQ6IDEsIGZpcnN0TmFtZTogJ1llaHVkYScgfSwKICAg
        ICAgICAgIHsgaWQ6IDIsIGZpcnN0TmFtZTogJ1RvbScgfQogICAgICAgIF0p
        LAogICAgICBvcHRpb25MYWJlbFBhdGg6ICdjb250ZW50LmZpcnN0TmFtZScs
        CiAgICAgIG9wdGlvblZhbHVlUGF0aDogJ2NvbnRlbnQuaWQnCiAgICB9KTsK
        ICAgIGBgYAoKICAgIEBwcm9wZXJ0eSBjb250ZW50CiAgICBAdHlwZSBBcnJh
        eQogICAgQGRlZmF1bHQgbnVsbAogICovCiAgY29udGVudDogbnVsbCwKCiAg
        LyoqCiAgICBXaGVuIGBtdWx0aXBsZWAgaXMgYGZhbHNlYCwgdGhlIGVsZW1l
        bnQgb2YgYGNvbnRlbnRgIHRoYXQgaXMgY3VycmVudGx5CiAgICBzZWxlY3Rl
        ZCwgaWYgYW55LgoKICAgIFdoZW4gYG11bHRpcGxlYCBpcyBgdHJ1ZWAsIGFu
        IGFycmF5IG9mIHN1Y2ggZWxlbWVudHMuCgogICAgQHByb3BlcnR5IHNlbGVj
        dGlvbgogICAgQHR5cGUgT2JqZWN0IG9yIEFycmF5CiAgICBAZGVmYXVsdCBu
        dWxsCiAgKi8KICBzZWxlY3Rpb246IG51bGwsCgogIC8qKgogICAgSW4gc2lu
        Z2xlIHNlbGVjdGlvbiBtb2RlICh3aGVuIGBtdWx0aXBsZWAgaXMgYGZhbHNl
        YCksIHZhbHVlIGNhbiBiZSB1c2VkIHRvCiAgICBnZXQgdGhlIGN1cnJlbnQg
        c2VsZWN0aW9uJ3MgdmFsdWUgb3Igc2V0IHRoZSBzZWxlY3Rpb24gYnkgaXQn
        cyB2YWx1ZS4KCiAgICBJdCBpcyBub3QgY3VycmVudGx5IHN1cHBvcnRlZCBp
        biBtdWx0aXBsZSBzZWxlY3Rpb24gbW9kZS4KCiAgICBAcHJvcGVydHkgdmFs
        dWUKICAgIEB0eXBlIFN0cmluZwogICAgQGRlZmF1bHQgbnVsbAogICovCiAg
        dmFsdWU6IEVtYmVyLmNvbXB1dGVkKGZ1bmN0aW9uKGtleSwgdmFsdWUpIHsK
        ICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAyKSB7IHJldHVybiB2YWx1
        ZTsgfQogICAgdmFyIHZhbHVlUGF0aCA9IGdldCh0aGlzLCAnb3B0aW9uVmFs
        dWVQYXRoJykucmVwbGFjZSgvXmNvbnRlbnRcLj8vLCAnJyk7CiAgICByZXR1
        cm4gdmFsdWVQYXRoID8gZ2V0KHRoaXMsICdzZWxlY3Rpb24uJyArIHZhbHVl
        UGF0aCkgOiBnZXQodGhpcywgJ3NlbGVjdGlvbicpOwogIH0pLnByb3BlcnR5
        KCdzZWxlY3Rpb24nKSwKCiAgLyoqCiAgICBJZiBnaXZlbiwgYSB0b3AtbW9z
        dCBkdW1teSBvcHRpb24gd2lsbCBiZSByZW5kZXJlZCB0byBzZXJ2ZSBhcyBh
        IHVzZXIKICAgIHByb21wdC4KCiAgICBAcHJvcGVydHkgcHJvbXB0CiAgICBA
        dHlwZSBTdHJpbmcKICAgIEBkZWZhdWx0IG51bGwKICAqLwogIHByb21wdDog
        bnVsbCwKCiAgLyoqCiAgICBUaGUgcGF0aCBvZiB0aGUgb3B0aW9uIGxhYmVs
        cy4gU2VlIFtjb250ZW50XSgvYXBpL2NsYXNzZXMvRW1iZXIuU2VsZWN0Lmh0
        bWwjcHJvcGVydHlfY29udGVudCkuCgogICAgQHByb3BlcnR5IG9wdGlvbkxh
        YmVsUGF0aAogICAgQHR5cGUgU3RyaW5nCiAgICBAZGVmYXVsdCAnY29udGVu
        dCcKICAqLwogIG9wdGlvbkxhYmVsUGF0aDogJ2NvbnRlbnQnLAoKICAvKioK
        ICAgIFRoZSBwYXRoIG9mIHRoZSBvcHRpb24gdmFsdWVzLiBTZWUgW2NvbnRl
        bnRdKC9hcGkvY2xhc3Nlcy9FbWJlci5TZWxlY3QuaHRtbCNwcm9wZXJ0eV9j
        b250ZW50KS4KCiAgICBAcHJvcGVydHkgb3B0aW9uVmFsdWVQYXRoCiAgICBA
        dHlwZSBTdHJpbmcKICAgIEBkZWZhdWx0ICdjb250ZW50JwogICovCiAgb3B0
        aW9uVmFsdWVQYXRoOiAnY29udGVudCcsCgogIC8qKgogICAgVGhlIHBhdGgg
        b2YgdGhlIG9wdGlvbiBncm91cC4KICAgIFdoZW4gdGhpcyBwcm9wZXJ0eSBp
        cyB1c2VkLCBgY29udGVudGAgc2hvdWxkIGJlIHNvcnRlZCBieSBgb3B0aW9u
        R3JvdXBQYXRoYC4KCiAgICBAcHJvcGVydHkgb3B0aW9uR3JvdXBQYXRoCiAg
        ICBAdHlwZSBTdHJpbmcKICAgIEBkZWZhdWx0IG51bGwKICAqLwogIG9wdGlv
        bkdyb3VwUGF0aDogbnVsbCwKCiAgLyoqCiAgICBUaGUgdmlldyBjbGFzcyBm
        b3Igb3B0Z3JvdXAuCgogICAgQHByb3BlcnR5IGdyb3VwVmlldwogICAgQHR5
        cGUgRW1iZXIuVmlldwogICAgQGRlZmF1bHQgRW1iZXIuU2VsZWN0T3B0Z3Jv
        dXAKICAqLwogIGdyb3VwVmlldzogRW1iZXIuU2VsZWN0T3B0Z3JvdXAsCgog
        IGdyb3VwZWRDb250ZW50OiBFbWJlci5jb21wdXRlZChmdW5jdGlvbigpIHsK
        ICAgIHZhciBncm91cFBhdGggPSBnZXQodGhpcywgJ29wdGlvbkdyb3VwUGF0
        aCcpOwogICAgdmFyIGdyb3VwZWRDb250ZW50ID0gRW1iZXIuQSgpOwogICAg
        dmFyIGNvbnRlbnQgPSBnZXQodGhpcywgJ2NvbnRlbnQnKSB8fCBbXTsKCiAg
        ICBmb3JFYWNoKGNvbnRlbnQsIGZ1bmN0aW9uKGl0ZW0pIHsKICAgICAgdmFy
        IGxhYmVsID0gZ2V0KGl0ZW0sIGdyb3VwUGF0aCk7CgogICAgICBpZiAoZ2V0
        KGdyb3VwZWRDb250ZW50LCAnbGFzdE9iamVjdC5sYWJlbCcpICE9PSBsYWJl
        bCkgewogICAgICAgIGdyb3VwZWRDb250ZW50LnB1c2hPYmplY3QoewogICAg
        ICAgICAgbGFiZWw6IGxhYmVsLAogICAgICAgICAgY29udGVudDogRW1iZXIu
        QSgpCiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIGdldChncm91cGVkQ29u
        dGVudCwgJ2xhc3RPYmplY3QuY29udGVudCcpLnB1c2goaXRlbSk7CiAgICB9
        KTsKCiAgICByZXR1cm4gZ3JvdXBlZENvbnRlbnQ7CiAgfSkucHJvcGVydHko
        J29wdGlvbkdyb3VwUGF0aCcsICdjb250ZW50LkBlYWNoJyksCgogIC8qKgog
        ICAgVGhlIHZpZXcgY2xhc3MgZm9yIG9wdGlvbi4KCiAgICBAcHJvcGVydHkg
        b3B0aW9uVmlldwogICAgQHR5cGUgRW1iZXIuVmlldwogICAgQGRlZmF1bHQg
        RW1iZXIuU2VsZWN0T3B0aW9uCiAgKi8KICBvcHRpb25WaWV3OiBFbWJlci5T
        ZWxlY3RPcHRpb24sCgogIF9jaGFuZ2U6IGZ1bmN0aW9uKCkgewogICAgaWYg
        KGdldCh0aGlzLCAnbXVsdGlwbGUnKSkgewogICAgICB0aGlzLl9jaGFuZ2VN
        dWx0aXBsZSgpOwogICAgfSBlbHNlIHsKICAgICAgdGhpcy5fY2hhbmdlU2lu
        Z2xlKCk7CiAgICB9CiAgfSwKCiAgc2VsZWN0aW9uRGlkQ2hhbmdlOiBFbWJl
        ci5vYnNlcnZlcihmdW5jdGlvbigpIHsKICAgIHZhciBzZWxlY3Rpb24gPSBn
        ZXQodGhpcywgJ3NlbGVjdGlvbicpOwogICAgaWYgKGdldCh0aGlzLCAnbXVs
        dGlwbGUnKSkgewogICAgICBpZiAoIWlzQXJyYXkoc2VsZWN0aW9uKSkgewog
        ICAgICAgIHNldCh0aGlzLCAnc2VsZWN0aW9uJywgRW1iZXIuQShbc2VsZWN0
        aW9uXSkpOwogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICB0aGlzLl9z
        ZWxlY3Rpb25EaWRDaGFuZ2VNdWx0aXBsZSgpOwogICAgfSBlbHNlIHsKICAg
        ICAgdGhpcy5fc2VsZWN0aW9uRGlkQ2hhbmdlU2luZ2xlKCk7CiAgICB9CiAg
        fSwgJ3NlbGVjdGlvbi5AZWFjaCcpLAoKICB2YWx1ZURpZENoYW5nZTogRW1i
        ZXIub2JzZXJ2ZXIoZnVuY3Rpb24oKSB7CiAgICB2YXIgY29udGVudCA9IGdl
        dCh0aGlzLCAnY29udGVudCcpLAogICAgICAgIHZhbHVlID0gZ2V0KHRoaXMs
        ICd2YWx1ZScpLAogICAgICAgIHZhbHVlUGF0aCA9IGdldCh0aGlzLCAnb3B0
        aW9uVmFsdWVQYXRoJykucmVwbGFjZSgvXmNvbnRlbnRcLj8vLCAnJyksCiAg
        ICAgICAgc2VsZWN0ZWRWYWx1ZSA9ICh2YWx1ZVBhdGggPyBnZXQodGhpcywg
        J3NlbGVjdGlvbi4nICsgdmFsdWVQYXRoKSA6IGdldCh0aGlzLCAnc2VsZWN0
        aW9uJykpLAogICAgICAgIHNlbGVjdGlvbjsKCiAgICBpZiAodmFsdWUgIT09
        IHNlbGVjdGVkVmFsdWUpIHsKICAgICAgc2VsZWN0aW9uID0gY29udGVudCA/
        IGNvbnRlbnQuZmluZChmdW5jdGlvbihvYmopIHsKICAgICAgICByZXR1cm4g
        dmFsdWUgPT09ICh2YWx1ZVBhdGggPyBnZXQob2JqLCB2YWx1ZVBhdGgpIDog
        b2JqKTsKICAgICAgfSkgOiBudWxsOwoKICAgICAgdGhpcy5zZXQoJ3NlbGVj
        dGlvbicsIHNlbGVjdGlvbik7CiAgICB9CiAgfSwgJ3ZhbHVlJyksCgoKICBf
        dHJpZ2dlckNoYW5nZTogZnVuY3Rpb24oKSB7CiAgICB2YXIgc2VsZWN0aW9u
        ID0gZ2V0KHRoaXMsICdzZWxlY3Rpb24nKTsKICAgIHZhciB2YWx1ZSA9IGdl
        dCh0aGlzLCAndmFsdWUnKTsKCiAgICBpZiAoIUVtYmVyLmlzTm9uZShzZWxl
        Y3Rpb24pKSB7IHRoaXMuc2VsZWN0aW9uRGlkQ2hhbmdlKCk7IH0KICAgIGlm
        ICghRW1iZXIuaXNOb25lKHZhbHVlKSkgeyB0aGlzLnZhbHVlRGlkQ2hhbmdl
        KCk7IH0KCiAgICB0aGlzLl9jaGFuZ2UoKTsKICB9LAoKICBfY2hhbmdlU2lu
        Z2xlOiBmdW5jdGlvbigpIHsKICAgIHZhciBzZWxlY3RlZEluZGV4ID0gdGhp
        cy4kKClbMF0uc2VsZWN0ZWRJbmRleCwKICAgICAgICBjb250ZW50ID0gZ2V0
        KHRoaXMsICdjb250ZW50JyksCiAgICAgICAgcHJvbXB0ID0gZ2V0KHRoaXMs
        ICdwcm9tcHQnKTsKCiAgICBpZiAoIWNvbnRlbnQgfHwgIWdldChjb250ZW50
        LCAnbGVuZ3RoJykpIHsgcmV0dXJuOyB9CiAgICBpZiAocHJvbXB0ICYmIHNl
        bGVjdGVkSW5kZXggPT09IDApIHsgc2V0KHRoaXMsICdzZWxlY3Rpb24nLCBu
        dWxsKTsgcmV0dXJuOyB9CgogICAgaWYgKHByb21wdCkgeyBzZWxlY3RlZElu
        ZGV4IC09IDE7IH0KICAgIHNldCh0aGlzLCAnc2VsZWN0aW9uJywgY29udGVu
        dC5vYmplY3RBdChzZWxlY3RlZEluZGV4KSk7CiAgfSwKCgogIF9jaGFuZ2VN
        dWx0aXBsZTogZnVuY3Rpb24oKSB7CiAgICB2YXIgb3B0aW9ucyA9IHRoaXMu
        JCgnb3B0aW9uOnNlbGVjdGVkJyksCiAgICAgICAgcHJvbXB0ID0gZ2V0KHRo
        aXMsICdwcm9tcHQnKSwKICAgICAgICBvZmZzZXQgPSBwcm9tcHQgPyAxIDog
        MCwKICAgICAgICBjb250ZW50ID0gZ2V0KHRoaXMsICdjb250ZW50JyksCiAg
        ICAgICAgc2VsZWN0aW9uID0gZ2V0KHRoaXMsICdzZWxlY3Rpb24nKTsKCiAg
        ICBpZiAoIWNvbnRlbnQpIHsgcmV0dXJuOyB9CiAgICBpZiAob3B0aW9ucykg
        ewogICAgICB2YXIgc2VsZWN0ZWRJbmRleGVzID0gb3B0aW9ucy5tYXAoZnVu
        Y3Rpb24oKSB7CiAgICAgICAgcmV0dXJuIHRoaXMuaW5kZXggLSBvZmZzZXQ7
        CiAgICAgIH0pLnRvQXJyYXkoKTsKICAgICAgdmFyIG5ld1NlbGVjdGlvbiA9
        IGNvbnRlbnQub2JqZWN0c0F0KHNlbGVjdGVkSW5kZXhlcyk7CgogICAgICBp
        ZiAoaXNBcnJheShzZWxlY3Rpb24pKSB7CiAgICAgICAgcmVwbGFjZShzZWxl
        Y3Rpb24sIDAsIGdldChzZWxlY3Rpb24sICdsZW5ndGgnKSwgbmV3U2VsZWN0
        aW9uKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBzZXQodGhpcywgJ3NlbGVj
        dGlvbicsIG5ld1NlbGVjdGlvbik7CiAgICAgIH0KICAgIH0KICB9LAoKICBf
        c2VsZWN0aW9uRGlkQ2hhbmdlU2luZ2xlOiBmdW5jdGlvbigpIHsKICAgIHZh
        ciBlbCA9IHRoaXMuZ2V0KCdlbGVtZW50Jyk7CiAgICBpZiAoIWVsKSB7IHJl
        dHVybjsgfQoKICAgIHZhciBjb250ZW50ID0gZ2V0KHRoaXMsICdjb250ZW50
        JyksCiAgICAgICAgc2VsZWN0aW9uID0gZ2V0KHRoaXMsICdzZWxlY3Rpb24n
        KSwKICAgICAgICBzZWxlY3Rpb25JbmRleCA9IGNvbnRlbnQgPyBpbmRleE9m
        KGNvbnRlbnQsIHNlbGVjdGlvbikgOiAtMSwKICAgICAgICBwcm9tcHQgPSBn
        ZXQodGhpcywgJ3Byb21wdCcpOwoKICAgIGlmIChwcm9tcHQpIHsgc2VsZWN0
        aW9uSW5kZXggKz0gMTsgfQogICAgaWYgKGVsKSB7IGVsLnNlbGVjdGVkSW5k
        ZXggPSBzZWxlY3Rpb25JbmRleDsgfQogIH0sCgogIF9zZWxlY3Rpb25EaWRD
        aGFuZ2VNdWx0aXBsZTogZnVuY3Rpb24oKSB7CiAgICB2YXIgY29udGVudCA9
        IGdldCh0aGlzLCAnY29udGVudCcpLAogICAgICAgIHNlbGVjdGlvbiA9IGdl
        dCh0aGlzLCAnc2VsZWN0aW9uJyksCiAgICAgICAgc2VsZWN0ZWRJbmRleGVz
        ID0gY29udGVudCA/IGluZGV4ZXNPZihjb250ZW50LCBzZWxlY3Rpb24pIDog
        Wy0xXSwKICAgICAgICBwcm9tcHQgPSBnZXQodGhpcywgJ3Byb21wdCcpLAog
        ICAgICAgIG9mZnNldCA9IHByb21wdCA/IDEgOiAwLAogICAgICAgIG9wdGlv
        bnMgPSB0aGlzLiQoJ29wdGlvbicpLAogICAgICAgIGFkanVzdGVkOwoKICAg
        IGlmIChvcHRpb25zKSB7CiAgICAgIG9wdGlvbnMuZWFjaChmdW5jdGlvbigp
        IHsKICAgICAgICBhZGp1c3RlZCA9IHRoaXMuaW5kZXggPiAtMSA/IHRoaXMu
        aW5kZXggLSBvZmZzZXQgOiAtMTsKICAgICAgICB0aGlzLnNlbGVjdGVkID0g
        aW5kZXhPZihzZWxlY3RlZEluZGV4ZXMsIGFkanVzdGVkKSA+IC0xOwogICAg
        ICB9KTsKICAgIH0KICB9LAoKICBpbml0OiBmdW5jdGlvbigpIHsKICAgIHRo
        aXMuX3N1cGVyKCk7CiAgICB0aGlzLm9uKCJkaWRJbnNlcnRFbGVtZW50Iiwg
        dGhpcywgdGhpcy5fdHJpZ2dlckNoYW5nZSk7CiAgICB0aGlzLm9uKCJjaGFu
        Z2UiLCB0aGlzLCB0aGlzLl9jaGFuZ2UpOwogIH0KfSk7Cgp9KSgpOwoKCgoo
        ZnVuY3Rpb24oKSB7Ci8qKgpAbW9kdWxlIGVtYmVyCkBzdWJtb2R1bGUgZW1i
        ZXItaGFuZGxlYmFycy1jb21waWxlcgoqLwoKLyoqCgogIFRoZSBge3tpbnB1
        dH19YCBoZWxwZXIgaW5zZXJ0cyBhbiBIVE1MIGA8aW5wdXQ+YCB0YWcgaW50
        byB0aGUgdGVtcGxhdGUsCiAgd2l0aCBhIGB0eXBlYCB2YWx1ZSBvZiBlaXRo
        ZXIgYHRleHRgIG9yIGBjaGVja2JveGAuIElmIG5vIGB0eXBlYCBpcyBwcm92
        aWRlZCwKICBgdGV4dGAgd2lsbCBiZSB0aGUgZGVmYXVsdCB2YWx1ZSBhcHBs
        aWVkLiBUaGUgYXR0cmlidXRlcyBvZiBge3tpbnB1dH19YAogIG1hdGNoIHRo
        b3NlIG9mIHRoZSBuYXRpdmUgSFRNTCB0YWcgYXMgY2xvc2VseSBhcyBwb3Nz
        aWJsZSBmb3IgdGhlc2UgdHdvIHR5cGVzLgoKICAjIyBVc2UgYXMgdGV4dCBm
        aWVsZAogIEFuIGB7e2lucHV0fX1gIHdpdGggbm8gYHR5cGVgIG9yIGEgYHR5
        cGVgIG9mIGB0ZXh0YCB3aWxsIHJlbmRlciBhbiBIVE1MIHRleHQgaW5wdXQu
        CiAgVGhlIGZvbGxvd2luZyBIVE1MIGF0dHJpYnV0ZXMgY2FuIGJlIHNldCB2
        aWEgdGhlIGhlbHBlcjoKCiogYHZhbHVlYAoqIGBzaXplYAoqIGBuYW1lYAoq
        IGBwYXR0ZXJuYAoqIGBwbGFjZWhvbGRlcmAKKiBgZGlzYWJsZWRgCiogYG1h
        eGxlbmd0aGAKKiBgdGFiaW5kZXhgCgoKICBXaGVuIHNldCB0byBhIHF1b3Rl
        ZCBzdHJpbmcsIHRoZXNlIHZhbHVlcyB3aWxsIGJlIGRpcmVjdGx5IGFwcGxp
        ZWQgdG8gdGhlIEhUTUwKICBlbGVtZW50LiBXaGVuIGxlZnQgdW5xdW90ZWQs
        IHRoZXNlIHZhbHVlcyB3aWxsIGJlIGJvdW5kIHRvIGEgcHJvcGVydHkgb24g
        dGhlCiAgdGVtcGxhdGUncyBjdXJyZW50IHJlbmRlcmluZyBjb250ZXh0ICht
        b3N0IHR5cGljYWxseSBhIGNvbnRyb2xsZXIgaW5zdGFuY2UpLgoKICAjIyBV
        bmJvdW5kOgoKICBgYGBoYW5kbGViYXJzCiAge3tpbnB1dCB2YWx1ZT0iaHR0
        cDovL3d3dy5mYWNlYm9vay5jb20ifX0KICBgYGAKCgogIGBgYGh0bWwKICA8
        aW5wdXQgdHlwZT0idGV4dCIgdmFsdWU9Imh0dHA6Ly93d3cuZmFjZWJvb2su
        Y29tIi8+CiAgYGBgCgogICMjIEJvdW5kOgoKICBgYGBqYXZhc2NyaXB0CiAg
        QXBwLkFwcGxpY2F0aW9uQ29udHJvbGxlciA9IEVtYmVyLkNvbnRyb2xsZXIu
        ZXh0ZW5kKHsKICAgIGZpcnN0TmFtZTogIlN0YW5sZXkiLAogICAgZW50cnlO
        b3RBbGxvd2VkOiB0cnVlCiAgfSk7CiAgYGBgCgoKICBgYGBoYW5kbGViYXJz
        CiAge3tpbnB1dCB0eXBlPSJ0ZXh0IiB2YWx1ZT1maXJzdE5hbWUgZGlzYWJs
        ZWQ9ZW50cnlOb3RBbGxvd2VkIHNpemU9IjUwIn19CiAgYGBgCgoKICBgYGBo
        dG1sCiAgPGlucHV0IHR5cGU9InRleHQiIHZhbHVlPSJTdGFubGV5IiBkaXNh
        YmxlZD0iZGlzYWJsZWQiIHNpemU9IjUwIi8+CiAgYGBgCgogICMjIEV4dGVu
        c2lvbgoKICBJbnRlcm5hbGx5LCBge3tpbnB1dCB0eXBlPSJ0ZXh0In19YCBj
        cmVhdGVzIGFuIGluc3RhbmNlIG9mIGBFbWJlci5UZXh0RmllbGRgLCBwYXNz
        aW5nCiAgYXJndW1lbnRzIGZyb20gdGhlIGhlbHBlciB0byBgRW1iZXIuVGV4
        dEZpZWxkYCdzIGBjcmVhdGVgIG1ldGhvZC4gWW91IGNhbiBleHRlbmQgdGhl
        CiAgY2FwYWJsaWx0aWVzIG9mIHRleHQgaW5wdXRzIGluIHlvdXIgYXBwbGlj
        YXRpb25zIGJ5IHJlb3BlbmluZyB0aGlzIGNsYXNzLiBGb3IgZXhhbXBsZSwK
        ICBpZiB5b3UgYXJlIGRlcGxveWluZyB0byBicm93c2VycyB3aGVyZSB0aGUg
        YHJlcXVpcmVkYCBhdHRyaWJ1dGUgaXMgdXNlZCwgeW91CiAgY2FuIGFkZCB0
        aGlzIHRvIHRoZSBgVGV4dEZpZWxkYCdzIGBhdHRyaWJ1dGVCaW5kaW5nc2Ag
        cHJvcGVydHk6CgogIGBgYGphdmFzY3JpcHQKICBFbWJlci5UZXh0RmllbGQu
        cmVvcGVuKHsKICAgIGF0dHJpYnV0ZUJpbmRpbmdzOiBbJ3JlcXVpcmVkJ10K
        ICB9KTsKICBgYGAKCiAgS2VlcCBpbiBtaW5kIHdoZW4gd3JpdGluZyBgRW1i
        ZXIuVGV4dEZpZWxkYCBzdWJjbGFzc2VzIHRoYXQgYEVtYmVyLlRleHRGaWVs
        ZGAKICBpdHNlbGYgZXh0ZW5kcyBgRW1iZXIuQ29tcG9uZW50YCwgbWVhbmlu
        ZyB0aGF0IGl0IGRvZXMgTk9UIGluaGVyaXQKICB0aGUgYGNvbnRyb2xsZXJg
        IG9mIHRoZSBwYXJlbnQgdmlldy4KCiAgU2VlIG1vcmUgYWJvdXQgW0VtYmVy
        IGNvbXBvbmVudHNdKGFwaS9jbGFzc2VzL0VtYmVyLkNvbXBvbmVudC5odG1s
        KQoKCiAgIyMgVXNlIGFzIGNoZWNrYm94CgogIEFuIGB7e2lucHV0fX1gIHdp
        dGggYSBgdHlwZWAgb2YgYGNoZWNrYm94YCB3aWxsIHJlbmRlciBhbiBIVE1M
        IGNoZWNrYm94IGlucHV0LgogIFRoZSBmb2xsb3dpbmcgSFRNTCBhdHRyaWJ1
        dGVzIGNhbiBiZSBzZXQgdmlhIHRoZSBoZWxwZXI6CgoqIGBjaGVja2VkYAoq
        IGBkaXNhYmxlZGAKKiBgdGFiaW5kZXhgCiogYGluZGV0ZXJtaW5hdGVgCiog
        YG5hbWVgCgogIFdoZW4gc2V0IHRvIGEgcXVvdGVkIHN0cmluZywgdGhlc2Ug
        dmFsdWVzIHdpbGwgYmUgZGlyZWN0bHkgYXBwbGllZCB0byB0aGUgSFRNTAog
        IGVsZW1lbnQuIFdoZW4gbGVmdCB1bnF1b3RlZCwgdGhlc2UgdmFsdWVzIHdp
        bGwgYmUgYm91bmQgdG8gYSBwcm9wZXJ0eSBvbiB0aGUKICB0ZW1wbGF0ZSdz
        IGN1cnJlbnQgcmVuZGVyaW5nIGNvbnRleHQgKG1vc3QgdHlwaWNhbGx5IGEg
        Y29udHJvbGxlciBpbnN0YW5jZSkuCgogICMjIFVuYm91bmQ6CgogIGBgYGhh
        bmRsZWJhcnMKICB7e2lucHV0IHR5cGU9ImNoZWNrYm94IiBuYW1lPSJpc0Fk
        bWluIn19CiAgYGBgCgogIGBgYGh0bWwKICA8aW5wdXQgdHlwZT0iY2hlY2ti
        b3giIG5hbWU9ImlzQWRtaW4iIC8+CiAgYGBgCgogICMjIEJvdW5kOgoKICBg
        YGBqYXZhc2NyaXB0CiAgQXBwLkFwcGxpY2F0aW9uQ29udHJvbGxlciA9IEVt
        YmVyLkNvbnRyb2xsZXIuZXh0ZW5kKHsKICAgIGlzQWRtaW46IHRydWUKICB9
        KTsKICBgYGAKCgogIGBgYGhhbmRsZWJhcnMKICB7e2lucHV0IHR5cGU9ImNo
        ZWNrYm94IiBjaGVja2VkPWlzQWRtaW4gfX0KICBgYGAKCgogIGBgYGh0bWwK
        ICA8aW5wdXQgdHlwZT0iY2hlY2tib3giIGNoZWNrZWQ9ImNoZWNrZWQiIC8+
        CiAgYGBgCgogICMjIEV4dGVuc2lvbgoKICBJbnRlcm5hbGx5LCBge3tpbnB1
        dCB0eXBlPSJjaGVja2JveCJ9fWAgY3JlYXRlcyBhbiBpbnN0YW5jZSBvZiBg
        RW1iZXIuQ2hlY2tib3hgLCBwYXNzaW5nCiAgYXJndW1lbnRzIGZyb20gdGhl
        IGhlbHBlciB0byBgRW1iZXIuQ2hlY2tib3hgJ3MgYGNyZWF0ZWAgbWV0aG9k
        LiBZb3UgY2FuIGV4dGVuZCB0aGUKICBjYXBhYmxpbHRpZXMgb2YgY2hlY2ti
        b3ggaW5wdXRzIGluIHlvdXIgYXBwbGljYXRpb25zIGJ5IHJlb3BlbmluZyB0
        aGlzIGNsYXNzLiBGb3IgZXhhbXBsZSwKICBpZiB5b3Ugd2FudGVkIHRvIGFk
        ZCBhIGNzcyBjbGFzcyB0byBhbGwgY2hlY2tib3hlcyBpbiB5b3VyIGFwcGxp
        Y2F0aW9uOgoKICBgYGBqYXZhc2NyaXB0CiAgRW1iZXIuQ2hlY2tib3gucmVv
        cGVuKHsKICAgIGNsYXNzTmFtZXM6IFsnbXktYXBwLWNoZWNrYm94J10KICB9
        KTsKICBgYGAKCgogIEBtZXRob2QgaW5wdXQKICBAZm9yIEVtYmVyLkhhbmRs
        ZWJhcnMuaGVscGVycwogIEBwYXJhbSB7SGFzaH0gb3B0aW9ucwoqLwpFbWJl
        ci5IYW5kbGViYXJzLnJlZ2lzdGVySGVscGVyKCdpbnB1dCcsIGZ1bmN0aW9u
        KG9wdGlvbnMpIHsKICBFbWJlci5hc3NlcnQoJ1lvdSBjYW4gb25seSBwYXNz
        IGF0dHJpYnV0ZXMgdG8gdGhlIGBpbnB1dGAgaGVscGVyLCBub3QgYXJndW1l
        bnRzJywgYXJndW1lbnRzLmxlbmd0aCA8IDIpOwoKICB2YXIgaGFzaCA9IG9w
        dGlvbnMuaGFzaCwKICAgICAgdHlwZXMgPSBvcHRpb25zLmhhc2hUeXBlcywK
        ICAgICAgaW5wdXRUeXBlID0gaGFzaC50eXBlLAogICAgICBvbkV2ZW50ID0g
        aGFzaC5vbjsKCiAgZGVsZXRlIGhhc2gudHlwZTsKICBkZWxldGUgaGFzaC5v
        bjsKCiAgaWYgKGlucHV0VHlwZSA9PT0gJ2NoZWNrYm94JykgewogICAgcmV0
        dXJuIEVtYmVyLkhhbmRsZWJhcnMuaGVscGVycy52aWV3LmNhbGwodGhpcywg
        RW1iZXIuQ2hlY2tib3gsIG9wdGlvbnMpOwogIH0gZWxzZSB7CiAgICBpZiAo
        aW5wdXRUeXBlKSB7IGhhc2gudHlwZSA9IGlucHV0VHlwZTsgfQogICAgaGFz
        aC5vbkV2ZW50ID0gb25FdmVudCB8fCAnZW50ZXInOwogICAgcmV0dXJuIEVt
        YmVyLkhhbmRsZWJhcnMuaGVscGVycy52aWV3LmNhbGwodGhpcywgRW1iZXIu
        VGV4dEZpZWxkLCBvcHRpb25zKTsKICB9Cn0pOwoKLyoqCiAgYHt7dGV4dGFy
        ZWF9fWAgaW5zZXJ0cyBhIG5ldyBpbnN0YW5jZSBvZiBgPHRleHRhcmVhPmAg
        dGFnIGludG8gdGhlIHRlbXBsYXRlLgogIFRoZSBhdHRyaWJ1dGVzIG9mIGB7
        e3RleHRhcmVhfX1gIG1hdGNoIHRob3NlIG9mIHRoZSBuYXRpdmUgSFRNTCB0
        YWdzIGFzCiAgY2xvc2VseSBhcyBwb3NzaWJsZS4KCiAgVGhlIGZvbGxvd2lu
        ZyBIVE1MIGF0dHJpYnV0ZXMgY2FuIGJlIHNldDoKCiAgICAqIGB2YWx1ZWAK
        ICAgICogYG5hbWVgCiAgICAqIGByb3dzYAogICAgKiBgY29sc2AKICAgICog
        YHBsYWNlaG9sZGVyYAogICAgKiBgZGlzYWJsZWRgCiAgICAqIGBtYXhsZW5n
        dGhgCiAgICAqIGB0YWJpbmRleGAKCiAgV2hlbiBzZXQgdG8gYSBxdW90ZWQg
        c3RyaW5nLCB0aGVzZSB2YWx1ZSB3aWxsIGJlIGRpcmVjdGx5IGFwcGxpZWQg
        dG8gdGhlIEhUTUwKICBlbGVtZW50LiBXaGVuIGxlZnQgdW5xdW90ZWQsIHRo
        ZXNlIHZhbHVlcyB3aWxsIGJlIGJvdW5kIHRvIGEgcHJvcGVydHkgb24gdGhl
        CiAgdGVtcGxhdGUncyBjdXJyZW50IHJlbmRlcmluZyBjb250ZXh0IChtb3N0
        IHR5cGljYWxseSBhIGNvbnRyb2xsZXIgaW5zdGFuY2UpLgoKICBVbmJvdW5k
        OgoKICBgYGBoYW5kbGViYXJzCiAge3t0ZXh0YXJlYSB2YWx1ZT0iTG90cyBv
        ZiBzdGF0aWMgdGV4dCB0aGF0IElTTidUIGJvdW5kIn19CiAgYGBgCgogIFdv
        dWxkIHJlc3VsdCBpbiB0aGUgZm9sbG93aW5nIEhUTUw6CgogIGBgYGh0bWwK
        ICA8dGV4dGFyZWEgY2xhc3M9ImVtYmVyLXRleHQtYXJlYSI+CiAgICBMb3Rz
        IG9mIHN0YXRpYyB0ZXh0IHRoYXQgSVNOJ1QgYm91bmQKICA8L3RleHRhcmVh
        PgogIGBgYAoKICBCb3VuZDoKCiAgSW4gdGhlIGZvbGxvd2luZyBleGFtcGxl
        LCB0aGUgYHdyaXR0ZW5Xb3Jkc2AgcHJvcGVydHkgb24gYEFwcC5BcHBsaWNh
        dGlvbkNvbnRyb2xsZXJgCiAgd2lsbCBiZSB1cGRhdGVkIGxpdmUgYXMgdGhl
        IHVzZXIgdHlwZXMgJ0xvdHMgb2YgdGV4dCB0aGF0IElTIGJvdW5kJyBpbnRv
        CiAgdGhlIHRleHQgYXJlYSBvZiB0aGVpciBicm93c2VyJ3Mgd2luZG93LgoK
        ICBgYGBqYXZhc2NyaXB0CiAgQXBwLkFwcGxpY2F0aW9uQ29udHJvbGxlciA9
        IEVtYmVyLkNvbnRyb2xsZXIuZXh0ZW5kKHsKICAgIHdyaXR0ZW5Xb3Jkczog
        IkxvdHMgb2YgdGV4dCB0aGF0IElTIGJvdW5kIgogIH0pOwogIGBgYAoKICBg
        YGBoYW5kbGViYXJzCiAge3t0ZXh0YXJlYSB2YWx1ZT13cml0dGVuV29yZHN9
        fQogIGBgYAoKICAgV291bGQgcmVzdWx0IGluIHRoZSBmb2xsb3dpbmcgSFRN
        TDoKCiAgYGBgaHRtbAogIDx0ZXh0YXJlYSBjbGFzcz0iZW1iZXItdGV4dC1h
        cmVhIj4KICAgIExvdHMgb2YgdGV4dCB0aGF0IElTIGJvdW5kCiAgPC90ZXh0
        YXJlYT4KICBgYGAKCiAgSWYgeW91IHdhbnRlZCBhIG9uZSB3YXkgYmluZGlu
        ZyBiZXR3ZWVuIHRoZSB0ZXh0IGFyZWEgYW5kIGEgZGl2IHRhZwogIHNvbWV3
        aGVyZSBlbHNlIG9uIHlvdXIgc2NyZWVuLCB5b3UgY291bGQgdXNlIGBFbWJl
        ci5jb21wdXRlZC5vbmVXYXlgOgoKICBgYGBqYXZhc2NyaXB0CiAgQXBwLkFw
        cGxpY2F0aW9uQ29udHJvbGxlciA9IEVtYmVyLkNvbnRyb2xsZXIuZXh0ZW5k
        KHsKICAgIHdyaXR0ZW5Xb3JkczogIkxvdHMgb2YgdGV4dCB0aGF0IElTIGJv
        dW5kIiwKICAgIG91dHB1dFdyaXR0ZW5Xb3JkczogRW1iZXIuY29tcHV0ZWQu
        b25lV2F5KCJ3cml0dGVuV29yZHMiKQogIH0pOwogIGBgYAoKICBgYGBoYW5k
        bGViYXJzCiAge3t0ZXh0YXJlYSB2YWx1ZT13cml0dGVuV29yZHN9fQoKICA8
        ZGl2PgogICAge3tvdXRwdXRXcml0dGVuV29yZHN9fQogIDwvZGl2PgogIGBg
        YAoKICBXb3VsZCByZXN1bHQgaW4gdGhlIGZvbGxvd2luZyBIVE1MOgoKICBg
        YGBodG1sCiAgPHRleHRhcmVhIGNsYXNzPSJlbWJlci10ZXh0LWFyZWEiPgog
        ICAgTG90cyBvZiB0ZXh0IHRoYXQgSVMgYm91bmQKICA8L3RleHRhcmVhPgoK
        ICA8LS0gdGhlIGZvbGxvd2luZyBkaXYgd2lsbCBiZSB1cGRhdGVkIGluIHJl
        YWwgdGltZSBhcyB5b3UgdHlwZSAtLT4KCiAgPGRpdj4KICAgIExvdHMgb2Yg
        dGV4dCB0aGF0IElTIGJvdW5kCiAgPC9kaXY+CiAgYGBgCgogIEZpbmFsbHks
        IHRoaXMgZXhhbXBsZSByZWFsbHkgc2hvd3MgdGhlIHBvd2VyIGFuZCBlYXNl
        IG9mIEVtYmVyIHdoZW4gdHdvCiAgcHJvcGVydGllcyBhcmUgYm91bmQgdG8g
        ZWFjaG90aGVyIHZpYSBgRW1iZXIuY29tcHV0ZWQuYWxpYXNgLiBUeXBlIGlu
        dG8KICBlaXRoZXIgdGV4dCBhcmVhIGJveCBhbmQgdGhleSdsbCBib3RoIHN0
        YXkgaW4gc3luYy4gTm90ZSB0aGF0CiAgYEVtYmVyLmNvbXB1dGVkLmFsaWFz
        YCBjb3N0cyBtb3JlIGluIHRlcm1zIG9mIHBlcmZvcm1hbmNlLCBzbyBvbmx5
        IHVzZSBpdCB3aGVuCiAgeW91ciByZWFsbHkgYmluZGluZyBpbiBib3RoIGRp
        cmVjdGlvbnM6CgogIGBgYGphdmFzY3JpcHQKICBBcHAuQXBwbGljYXRpb25D
        b250cm9sbGVyID0gRW1iZXIuQ29udHJvbGxlci5leHRlbmQoewogICAgd3Jp
        dHRlbldvcmRzOiAiTG90cyBvZiB0ZXh0IHRoYXQgSVMgYm91bmQiLAogICAg
        dHdvV2F5V3JpdHRlbldvcmRzOiBFbWJlci5jb21wdXRlZC5hbGlhcygid3Jp
        dHRlbldvcmRzIikKICB9KTsKICBgYGAKCiAgYGBgaGFuZGxlYmFycwogIHt7
        dGV4dGFyZWEgdmFsdWU9d3JpdHRlbldvcmRzfX0KICB7e3RleHRhcmVhIHZh
        bHVlPXR3b1dheVdyaXR0ZW5Xb3Jkc319CiAgYGBgCgogIGBgYGh0bWwKICA8
        dGV4dGFyZWEgaWQ9ImVtYmVyMSIgY2xhc3M9ImVtYmVyLXRleHQtYXJlYSI+
        CiAgICBMb3RzIG9mIHRleHQgdGhhdCBJUyBib3VuZAogIDwvdGV4dGFyZWE+
        CgogIDwtLSBib3RoIHVwZGF0ZWQgaW4gcmVhbCB0aW1lIC0tPgoKICA8dGV4
        dGFyZWEgaWQ9ImVtYmVyMiIgY2xhc3M9ImVtYmVyLXRleHQtYXJlYSI+CiAg
        ICBMb3RzIG9mIHRleHQgdGhhdCBJUyBib3VuZAogIDwvdGV4dGFyZWE+CiAg
        YGBgCgogICMjIEV4dGVuc2lvbgoKICBJbnRlcm5hbGx5LCBge3t0ZXh0YXJl
        YX19YCBjcmVhdGVzIGFuIGluc3RhbmNlIG9mIGBFbWJlci5UZXh0QXJlYWAs
        IHBhc3NpbmcKICBhcmd1bWVudHMgZnJvbSB0aGUgaGVscGVyIHRvIGBFbWJl
        ci5UZXh0QXJlYWAncyBgY3JlYXRlYCBtZXRob2QuIFlvdSBjYW4KICBleHRl
        bmQgdGhlIGNhcGFiaWxpdGllcyBvZiB0ZXh0IGFyZWFzIGluIHlvdXIgYXBw
        bGljYXRpb24gYnkgcmVvcGVuaW5nIHRoaXMKICBjbGFzcy4gRm9yIGV4YW1w
        bGUsIGlmIHlvdSBhcmUgZGVwbG95aW5nIHRvIGJyb3dzZXJzIHdoZXJlIHRo
        ZSBgcmVxdWlyZWRgCiAgYXR0cmlidXRlIGlzIHVzZWQsIHlvdSBjYW4gZ2xv
        YmFsbHkgYWRkIHN1cHBvcnQgZm9yIHRoZSBgcmVxdWlyZWRgIGF0dHJpYnV0
        ZQogIG9uIGFsbCB7e3RleHRhcmVhfX0ncycgaW4geW91ciBhcHAgYnkgcmVv
        cGVuaW5nIGBFbWJlci5UZXh0QXJlYWAgb3IKICBgRW1iZXIuVGV4dFN1cHBv
        cnRgIGFuZCBhZGRpbmcgaXQgdG8gdGhlIGBhdHRyaWJ1dGVCaW5kaW5nc2Ag
        Y29uY2F0ZW5hdGVkCiAgcHJvcGVydHk6CgogIGBgYGphdmFzY3JpcHQKICBF
        bWJlci5UZXh0QXJlYS5yZW9wZW4oewogICAgYXR0cmlidXRlQmluZGluZ3M6
        IFsncmVxdWlyZWQnXQogIH0pOwogIGBgYAoKICBLZWVwIGluIG1pbmQgd2hl
        biB3cml0aW5nIGBFbWJlci5UZXh0QXJlYWAgc3ViY2xhc3NlcyB0aGF0IGBF
        bWJlci5UZXh0QXJlYWAKICBpdHNlbGYgZXh0ZW5kcyBgRW1iZXIuQ29tcG9u
        ZW50YCwgbWVhbmluZyB0aGF0IGl0IGRvZXMgTk9UIGluaGVyaXQKICB0aGUg
        YGNvbnRyb2xsZXJgIG9mIHRoZSBwYXJlbnQgdmlldy4KCiAgU2VlIG1vcmUg
        YWJvdXQgW0VtYmVyIGNvbXBvbmVudHNdKGFwaS9jbGFzc2VzL0VtYmVyLkNv
        bXBvbmVudC5odG1sKQoKICBAbWV0aG9kIHRleHRhcmVhCiAgQGZvciBFbWJl
        ci5IYW5kbGViYXJzLmhlbHBlcnMKICBAcGFyYW0ge0hhc2h9IG9wdGlvbnMK
        Ki8KRW1iZXIuSGFuZGxlYmFycy5yZWdpc3RlckhlbHBlcigndGV4dGFyZWEn
        LCBmdW5jdGlvbihvcHRpb25zKSB7CiAgRW1iZXIuYXNzZXJ0KCdZb3UgY2Fu
        IG9ubHkgcGFzcyBhdHRyaWJ1dGVzIHRvIHRoZSBgdGV4dGFyZWFgIGhlbHBl
        ciwgbm90IGFyZ3VtZW50cycsIGFyZ3VtZW50cy5sZW5ndGggPCAyKTsKCiAg
        dmFyIGhhc2ggPSBvcHRpb25zLmhhc2gsCiAgICAgIHR5cGVzID0gb3B0aW9u
        cy5oYXNoVHlwZXM7CgogIHJldHVybiBFbWJlci5IYW5kbGViYXJzLmhlbHBl
        cnMudmlldy5jYWxsKHRoaXMsIEVtYmVyLlRleHRBcmVhLCBvcHRpb25zKTsK
        fSk7Cgp9KSgpOwoKCgooZnVuY3Rpb24oKSB7Ci8qZ2xvYmFscyBIYW5kbGVi
        YXJzICovCi8qKgpAbW9kdWxlIGVtYmVyCkBzdWJtb2R1bGUgZW1iZXItaGFu
        ZGxlYmFycwoqLwoKLyoqCiAgQHByaXZhdGUKCiAgRmluZCB0ZW1wbGF0ZXMg
        c3RvcmVkIGluIHRoZSBoZWFkIHRhZyBhcyBzY3JpcHQgdGFncyBhbmQgbWFr
        ZSB0aGVtIGF2YWlsYWJsZQogIHRvIGBFbWJlci5Db3JlVmlld2AgaW4gdGhl
        IGdsb2JhbCBgRW1iZXIuVEVNUExBVEVTYCBvYmplY3QuIFRoaXMgd2lsbCBi
        ZSBydW4KICBhcyBhcyBqUXVlcnkgRE9NLXJlYWR5IGNhbGxiYWNrLgoKICBT
        Y3JpcHQgdGFncyB3aXRoIGB0ZXh0L3gtaGFuZGxlYmFyc2Agd2lsbCBiZSBj
        b21waWxlZAogIHdpdGggRW1iZXIncyBIYW5kbGViYXJzIGFuZCBhcmUgc3Vp
        dGFibGUgZm9yIHVzZSBhcyBhIHZpZXcncyB0ZW1wbGF0ZS4KICBUaG9zZSB3
        aXRoIHR5cGUgYHRleHQveC1yYXctaGFuZGxlYmFyc2Agd2lsbCBiZSBjb21w
        aWxlZCB3aXRoIHJlZ3VsYXIKICBIYW5kbGViYXJzIGFuZCBhcmUgc3VpdGFi
        bGUgZm9yIHVzZSBpbiB2aWV3cycgY29tcHV0ZWQgcHJvcGVydGllcy4KCiAg
        QG1ldGhvZCBib290c3RyYXAKICBAZm9yIEVtYmVyLkhhbmRsZWJhcnMKICBA
        c3RhdGljCiAgQHBhcmFtIGN0eAoqLwpFbWJlci5IYW5kbGViYXJzLmJvb3Rz
        dHJhcCA9IGZ1bmN0aW9uKGN0eCkgewogIHZhciBzZWxlY3RvcnMgPSAnc2Ny
        aXB0W3R5cGU9InRleHQveC1oYW5kbGViYXJzIl0sIHNjcmlwdFt0eXBlPSJ0
        ZXh0L3gtcmF3LWhhbmRsZWJhcnMiXSc7CgogIEVtYmVyLiQoc2VsZWN0b3Jz
        LCBjdHgpCiAgICAuZWFjaChmdW5jdGlvbigpIHsKICAgIC8vIEdldCBhIHJl
        ZmVyZW5jZSB0byB0aGUgc2NyaXB0IHRhZwogICAgdmFyIHNjcmlwdCA9IEVt
        YmVyLiQodGhpcyk7CgogICAgdmFyIGNvbXBpbGUgPSAoc2NyaXB0LmF0dHIo
        J3R5cGUnKSA9PT0gJ3RleHQveC1yYXctaGFuZGxlYmFycycpID8KICAgICAg
        ICAgICAgICAgICAgRW1iZXIuJC5wcm94eShIYW5kbGViYXJzLmNvbXBpbGUs
        IEhhbmRsZWJhcnMpIDoKICAgICAgICAgICAgICAgICAgRW1iZXIuJC5wcm94
        eShFbWJlci5IYW5kbGViYXJzLmNvbXBpbGUsIEVtYmVyLkhhbmRsZWJhcnMp
        LAogICAgICAvLyBHZXQgdGhlIG5hbWUgb2YgdGhlIHNjcmlwdCwgdXNlZCBi
        eSBFbWJlci5WaWV3J3MgdGVtcGxhdGVOYW1lIHByb3BlcnR5LgogICAgICAv
        LyBGaXJzdCBsb29rIGZvciBkYXRhLXRlbXBsYXRlLW5hbWUgYXR0cmlidXRl
        LCB0aGVuIGZhbGwgYmFjayB0byBpdHMKICAgICAgLy8gaWQgaWYgbm8gbmFt
        ZSBpcyBmb3VuZC4KICAgICAgdGVtcGxhdGVOYW1lID0gc2NyaXB0LmF0dHIo
        J2RhdGEtdGVtcGxhdGUtbmFtZScpIHx8IHNjcmlwdC5hdHRyKCdpZCcpIHx8
        ICdhcHBsaWNhdGlvbicsCiAgICAgIHRlbXBsYXRlID0gY29tcGlsZShzY3Jp
        cHQuaHRtbCgpKTsKCiAgICAvLyBDaGVjayBpZiB0ZW1wbGF0ZSBvZiBzYW1l
        IG5hbWUgYWxyZWFkeSBleGlzdHMKICAgIGlmIChFbWJlci5URU1QTEFURVNb
        dGVtcGxhdGVOYW1lXSAhPT0gdW5kZWZpbmVkKSB7CiAgICAgIHRocm93IG5l
        dyBFbWJlci5FcnJvcignVGVtcGxhdGUgbmFtZWQgIicgKyB0ZW1wbGF0ZU5h
        bWUgICsgJyIgYWxyZWFkeSBleGlzdHMuJyk7CiAgICB9CgogICAgLy8gRm9y
        IHRlbXBsYXRlcyB3aGljaCBoYXZlIGEgbmFtZSwgd2Ugc2F2ZSB0aGVtIGFu
        ZCB0aGVuIHJlbW92ZSB0aGVtIGZyb20gdGhlIERPTQogICAgRW1iZXIuVEVN
        UExBVEVTW3RlbXBsYXRlTmFtZV0gPSB0ZW1wbGF0ZTsKCiAgICAvLyBSZW1v
        dmUgc2NyaXB0IHRhZyBmcm9tIERPTQogICAgc2NyaXB0LnJlbW92ZSgpOwog
        IH0pOwp9OwoKZnVuY3Rpb24gYm9vdHN0cmFwKCkgewogIEVtYmVyLkhhbmRs
        ZWJhcnMuYm9vdHN0cmFwKCBFbWJlci4kKGRvY3VtZW50KSApOwp9CgpmdW5j
        dGlvbiByZWdpc3RlckNvbXBvbmVudHMoY29udGFpbmVyKSB7CiAgdmFyIHRl
        bXBsYXRlcyA9IEVtYmVyLlRFTVBMQVRFUywgbWF0Y2g7CiAgaWYgKCF0ZW1w
        bGF0ZXMpIHsgcmV0dXJuOyB9CgogIGZvciAodmFyIHByb3AgaW4gdGVtcGxh
        dGVzKSB7CiAgICBpZiAobWF0Y2ggPSBwcm9wLm1hdGNoKC9eY29tcG9uZW50
        c1wvKC4qKSQvKSkgewogICAgICByZWdpc3RlckNvbXBvbmVudChjb250YWlu
        ZXIsIG1hdGNoWzFdKTsKICAgIH0KICB9Cn0KCgpmdW5jdGlvbiByZWdpc3Rl
        ckNvbXBvbmVudChjb250YWluZXIsIG5hbWUpIHsKICBFbWJlci5hc3NlcnQo
        IllvdSBwcm92aWRlZCBhIHRlbXBsYXRlIG5hbWVkICdjb21wb25lbnRzLyIg
        KyBuYW1lICsgIicsIGJ1dCBjdXN0b20gY29tcG9uZW50cyBtdXN0IGluY2x1
        ZGUgYSAnLSciLCBuYW1lLm1hdGNoKC8tLykpOwoKICB2YXIgZnVsbE5hbWUg
        PSAnY29tcG9uZW50OicgKyBuYW1lOwoKICBjb250YWluZXIuaW5qZWN0aW9u
        KGZ1bGxOYW1lLCAnbGF5b3V0JywgJ3RlbXBsYXRlOmNvbXBvbmVudHMvJyAr
        IG5hbWUpOwoKICB2YXIgQ29tcG9uZW50ID0gY29udGFpbmVyLmxvb2t1cEZh
        Y3RvcnkoZnVsbE5hbWUpOwoKICBpZiAoIUNvbXBvbmVudCkgewogICAgY29u
        dGFpbmVyLnJlZ2lzdGVyKGZ1bGxOYW1lLCBFbWJlci5Db21wb25lbnQpOwog
        ICAgQ29tcG9uZW50ID0gY29udGFpbmVyLmxvb2t1cEZhY3RvcnkoZnVsbE5h
        bWUpOwogIH0KCiAgRW1iZXIuSGFuZGxlYmFycy5oZWxwZXIobmFtZSwgQ29t
        cG9uZW50KTsKfQoKLyoKICBXZSB0aWUgdGhpcyB0byBhcHBsaWNhdGlvbi5s
        b2FkIHRvIGVuc3VyZSB0aGF0IHdlJ3ZlIGF0IGxlYXN0CiAgYXR0ZW1wdGVk
        IHRvIGJvb3RzdHJhcCBhdCB0aGUgcG9pbnQgdGhhdCB0aGUgYXBwbGljYXRp
        b24gaXMgbG9hZGVkLgoKICBXZSBhbHNvIHRpZSB0aGlzIHRvIGRvY3VtZW50
        IHJlYWR5IHNpbmNlIHdlJ3JlIGd1YXJhbnRlZWQgdGhhdCBhbGwKICB0aGUg
        aW5saW5lIHRlbXBsYXRlcyBhcmUgcHJlc2VudCBhdCB0aGlzIHBvaW50LgoK
        ICBUaGVyZSdzIG5vIGhhcm0gdG8gcnVubmluZyB0aGlzIHR3aWNlLCBzaW5j
        ZSB3ZSByZW1vdmUgdGhlIHRlbXBsYXRlcwogIGZyb20gdGhlIERPTSBhZnRl
        ciBwcm9jZXNzaW5nLgoqLwoKRW1iZXIub25Mb2FkKCdFbWJlci5BcHBsaWNh
        dGlvbicsIGZ1bmN0aW9uKEFwcGxpY2F0aW9uKSB7CiAgQXBwbGljYXRpb24u
        aW5pdGlhbGl6ZXIoewogICAgbmFtZTogJ2RvbVRlbXBsYXRlcycsCiAgICBp
        bml0aWFsaXplOiBib290c3RyYXAKICB9KTsKCiAgQXBwbGljYXRpb24uaW5p
        dGlhbGl6ZXIoewogICAgbmFtZTogJ3JlZ2lzdGVyQ29tcG9uZW50cycsCiAg
        ICBhZnRlcjogJ2RvbVRlbXBsYXRlcycsCiAgICBpbml0aWFsaXplOiByZWdp
        c3RlckNvbXBvbmVudHMKICB9KTsKfSk7Cgp9KSgpOwoKCgooZnVuY3Rpb24o
        KSB7Ci8qKgpFbWJlciBIYW5kbGViYXJzCgpAbW9kdWxlIGVtYmVyCkBzdWJt
        b2R1bGUgZW1iZXItaGFuZGxlYmFycwpAcmVxdWlyZXMgZW1iZXItdmlld3MK
        Ki8KCkVtYmVyLnJ1bkxvYWRIb29rcygnRW1iZXIuSGFuZGxlYmFycycsIEVt
        YmVyLkhhbmRsZWJhcnMpOwoKfSkoKTsKCihmdW5jdGlvbigpIHsKZGVmaW5l
        KCJyb3V0ZS1yZWNvZ25pemVyIiwKICBbXSwKICBmdW5jdGlvbigpIHsKICAg
        ICJ1c2Ugc3RyaWN0IjsKICAgIHZhciBzcGVjaWFscyA9IFsKICAgICAgJy8n
        LCAnLicsICcqJywgJysnLCAnPycsICd8JywKICAgICAgJygnLCAnKScsICdb
        JywgJ10nLCAneycsICd9JywgJ1xcJwogICAgXTsKCiAgICB2YXIgZXNjYXBl
        UmVnZXggPSBuZXcgUmVnRXhwKCcoXFwnICsgc3BlY2lhbHMuam9pbignfFxc
        JykgKyAnKScsICdnJyk7CgogICAgLy8gQSBTZWdtZW50IHJlcHJlc2VudHMg
        YSBzZWdtZW50IGluIHRoZSBvcmlnaW5hbCByb3V0ZSBkZXNjcmlwdGlvbi4K
        ICAgIC8vIEVhY2ggU2VnbWVudCB0eXBlIHByb3ZpZGVzIGFuIGBlYWNoQ2hh
        cmAgYW5kIGByZWdleGAgbWV0aG9kLgogICAgLy8KICAgIC8vIFRoZSBgZWFj
        aENoYXJgIG1ldGhvZCBpbnZva2VzIHRoZSBjYWxsYmFjayB3aXRoIG9uZSBv
        ciBtb3JlIGNoYXJhY3RlcgogICAgLy8gc3BlY2lmaWNhdGlvbnMuIEEgY2hh
        cmFjdGVyIHNwZWNpZmljYXRpb24gY29uc3VtZXMgb25lIG9yIG1vcmUgaW5w
        dXQKICAgIC8vIGNoYXJhY3RlcnMuCiAgICAvLwogICAgLy8gVGhlIGByZWdl
        eGAgbWV0aG9kIHJldHVybnMgYSByZWdleCBmcmFnbWVudCBmb3IgdGhlIHNl
        Z21lbnQuIElmIHRoZQogICAgLy8gc2VnbWVudCBpcyBhIGR5bmFtaWMgb2Yg
        c3RhciBzZWdtZW50LCB0aGUgcmVnZXggZnJhZ21lbnQgYWxzbyBpbmNsdWRl
        cwogICAgLy8gYSBjYXB0dXJlLgogICAgLy8KICAgIC8vIEEgY2hhcmFjdGVy
        IHNwZWNpZmljYXRpb24gY29udGFpbnM6CiAgICAvLwogICAgLy8gKiBgdmFs
        aWRDaGFyc2A6IGEgU3RyaW5nIHdpdGggYSBsaXN0IG9mIGFsbCB2YWxpZCBj
        aGFyYWN0ZXJzLCBvcgogICAgLy8gKiBgaW52YWxpZENoYXJzYDogYSBTdHJp
        bmcgd2l0aCBhIGxpc3Qgb2YgYWxsIGludmFsaWQgY2hhcmFjdGVycwogICAg
        Ly8gKiBgcmVwZWF0YDogdHJ1ZSBpZiB0aGUgY2hhcmFjdGVyIHNwZWNpZmlj
        YXRpb24gY2FuIHJlcGVhdAoKICAgIGZ1bmN0aW9uIFN0YXRpY1NlZ21lbnQo
        c3RyaW5nKSB7IHRoaXMuc3RyaW5nID0gc3RyaW5nOyB9CiAgICBTdGF0aWNT
        ZWdtZW50LnByb3RvdHlwZSA9IHsKICAgICAgZWFjaENoYXI6IGZ1bmN0aW9u
        KGNhbGxiYWNrKSB7CiAgICAgICAgdmFyIHN0cmluZyA9IHRoaXMuc3RyaW5n
        LCBjaGFyOwoKICAgICAgICBmb3IgKHZhciBpPTAsIGw9c3RyaW5nLmxlbmd0
        aDsgaTxsOyBpKyspIHsKICAgICAgICAgIGNoYXIgPSBzdHJpbmcuY2hhckF0
        KGkpOwogICAgICAgICAgY2FsbGJhY2soeyB2YWxpZENoYXJzOiBjaGFyIH0p
        OwogICAgICAgIH0KICAgICAgfSwKCiAgICAgIHJlZ2V4OiBmdW5jdGlvbigp
        IHsKICAgICAgICByZXR1cm4gdGhpcy5zdHJpbmcucmVwbGFjZShlc2NhcGVS
        ZWdleCwgJ1xcJDEnKTsKICAgICAgfSwKCiAgICAgIGdlbmVyYXRlOiBmdW5j
        dGlvbigpIHsKICAgICAgICByZXR1cm4gdGhpcy5zdHJpbmc7CiAgICAgIH0K
        ICAgIH07CgogICAgZnVuY3Rpb24gRHluYW1pY1NlZ21lbnQobmFtZSkgeyB0
        aGlzLm5hbWUgPSBuYW1lOyB9CiAgICBEeW5hbWljU2VnbWVudC5wcm90b3R5
        cGUgPSB7CiAgICAgIGVhY2hDaGFyOiBmdW5jdGlvbihjYWxsYmFjaykgewog
        ICAgICAgIGNhbGxiYWNrKHsgaW52YWxpZENoYXJzOiAiLyIsIHJlcGVhdDog
        dHJ1ZSB9KTsKICAgICAgfSwKCiAgICAgIHJlZ2V4OiBmdW5jdGlvbigpIHsK
        ICAgICAgICByZXR1cm4gIihbXi9dKykiOwogICAgICB9LAoKICAgICAgZ2Vu
        ZXJhdGU6IGZ1bmN0aW9uKHBhcmFtcykgewogICAgICAgIHJldHVybiBwYXJh
        bXNbdGhpcy5uYW1lXTsKICAgICAgfQogICAgfTsKCiAgICBmdW5jdGlvbiBT
        dGFyU2VnbWVudChuYW1lKSB7IHRoaXMubmFtZSA9IG5hbWU7IH0KICAgIFN0
        YXJTZWdtZW50LnByb3RvdHlwZSA9IHsKICAgICAgZWFjaENoYXI6IGZ1bmN0
        aW9uKGNhbGxiYWNrKSB7CiAgICAgICAgY2FsbGJhY2soeyBpbnZhbGlkQ2hh
        cnM6ICIiLCByZXBlYXQ6IHRydWUgfSk7CiAgICAgIH0sCgogICAgICByZWdl
        eDogZnVuY3Rpb24oKSB7CiAgICAgICAgcmV0dXJuICIoLispIjsKICAgICAg
        fSwKCiAgICAgIGdlbmVyYXRlOiBmdW5jdGlvbihwYXJhbXMpIHsKICAgICAg
        ICByZXR1cm4gcGFyYW1zW3RoaXMubmFtZV07CiAgICAgIH0KICAgIH07Cgog
        ICAgZnVuY3Rpb24gRXBzaWxvblNlZ21lbnQoKSB7fQogICAgRXBzaWxvblNl
        Z21lbnQucHJvdG90eXBlID0gewogICAgICBlYWNoQ2hhcjogZnVuY3Rpb24o
        KSB7fSwKICAgICAgcmVnZXg6IGZ1bmN0aW9uKCkgeyByZXR1cm4gIiI7IH0s
        CiAgICAgIGdlbmVyYXRlOiBmdW5jdGlvbigpIHsgcmV0dXJuICIiOyB9CiAg
        ICB9OwoKICAgIGZ1bmN0aW9uIHBhcnNlKHJvdXRlLCBuYW1lcywgdHlwZXMp
        IHsKICAgICAgLy8gbm9ybWFsaXplIHJvdXRlIGFzIG5vdCBzdGFydGluZyB3
        aXRoIGEgIi8iLiBSZWNvZ25pdGlvbiB3aWxsCiAgICAgIC8vIGFsc28gbm9y
        bWFsaXplLgogICAgICBpZiAocm91dGUuY2hhckF0KDApID09PSAiLyIpIHsg
        cm91dGUgPSByb3V0ZS5zdWJzdHIoMSk7IH0KCiAgICAgIHZhciBzZWdtZW50
        cyA9IHJvdXRlLnNwbGl0KCIvIiksIHJlc3VsdHMgPSBbXTsKCiAgICAgIGZv
        ciAodmFyIGk9MCwgbD1zZWdtZW50cy5sZW5ndGg7IGk8bDsgaSsrKSB7CiAg
        ICAgICAgdmFyIHNlZ21lbnQgPSBzZWdtZW50c1tpXSwgbWF0Y2g7CgogICAg
        ICAgIGlmIChtYXRjaCA9IHNlZ21lbnQubWF0Y2goL146KFteXC9dKykkLykp
        IHsKICAgICAgICAgIHJlc3VsdHMucHVzaChuZXcgRHluYW1pY1NlZ21lbnQo
        bWF0Y2hbMV0pKTsKICAgICAgICAgIG5hbWVzLnB1c2gobWF0Y2hbMV0pOwog
        ICAgICAgICAgdHlwZXMuZHluYW1pY3MrKzsKICAgICAgICB9IGVsc2UgaWYg
        KG1hdGNoID0gc2VnbWVudC5tYXRjaCgvXlwqKFteXC9dKykkLykpIHsKICAg
        ICAgICAgIHJlc3VsdHMucHVzaChuZXcgU3RhclNlZ21lbnQobWF0Y2hbMV0p
        KTsKICAgICAgICAgIG5hbWVzLnB1c2gobWF0Y2hbMV0pOwogICAgICAgICAg
        dHlwZXMuc3RhcnMrKzsKICAgICAgICB9IGVsc2UgaWYgKHNlZ21lbnQgPT09
        ICIiKSB7CiAgICAgICAgICByZXN1bHRzLnB1c2gobmV3IEVwc2lsb25TZWdt
        ZW50KCkpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICByZXN1bHRzLnB1
        c2gobmV3IFN0YXRpY1NlZ21lbnQoc2VnbWVudCkpOwogICAgICAgICAgdHlw
        ZXMuc3RhdGljcysrOwogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJu
        IHJlc3VsdHM7CiAgICB9CgogICAgLy8gQSBTdGF0ZSBoYXMgYSBjaGFyYWN0
        ZXIgc3BlY2lmaWNhdGlvbiBhbmQgKGBjaGFyU3BlY2ApIGFuZCBhIGxpc3Qg
        b2YgcG9zc2libGUKICAgIC8vIHN1YnNlcXVlbnQgc3RhdGVzIChgbmV4dFN0
        YXRlc2ApLgogICAgLy8KICAgIC8vIElmIGEgU3RhdGUgaXMgYW4gYWNjZXB0
        aW5nIHN0YXRlLCBpdCB3aWxsIGFsc28gaGF2ZSBzZXZlcmFsIGFkZGl0aW9u
        YWwKICAgIC8vIHByb3BlcnRpZXM6CiAgICAvLwogICAgLy8gKiBgcmVnZXhg
        OiBBIHJlZ3VsYXIgZXhwcmVzc2lvbiB0aGF0IGlzIHVzZWQgdG8gZXh0cmFj
        dCBwYXJhbWV0ZXJzIGZyb20gcGF0aHMKICAgIC8vICAgdGhhdCByZWFjaGVk
        IHRoaXMgYWNjZXB0aW5nIHN0YXRlLgogICAgLy8gKiBgaGFuZGxlcnNgOiBJ
        bmZvcm1hdGlvbiBvbiBob3cgdG8gY29udmVydCB0aGUgbGlzdCBvZiBjYXB0
        dXJlcyBpbnRvIGNhbGxzCiAgICAvLyAgIHRvIHJlZ2lzdGVyZWQgaGFuZGxl
        cnMgd2l0aCB0aGUgc3BlY2lmaWVkIHBhcmFtZXRlcnMKICAgIC8vICogYHR5
        cGVzYDogSG93IG1hbnkgc3RhdGljLCBkeW5hbWljIG9yIHN0YXIgc2VnbWVu
        dHMgaW4gdGhpcyByb3V0ZS4gVXNlZCB0bwogICAgLy8gICBkZWNpZGUgd2hp
        Y2ggcm91dGUgdG8gdXNlIGlmIG11bHRpcGxlIHJlZ2lzdGVyZWQgcm91dGVz
        IG1hdGNoIGEgcGF0aC4KICAgIC8vCiAgICAvLyBDdXJyZW50bHksIFN0YXRl
        IGlzIGltcGxlbWVudGVkIG5haXZlbHkgYnkgbG9vcGluZyBvdmVyIGBuZXh0
        U3RhdGVzYCBhbmQKICAgIC8vIGNvbXBhcmluZyBhIGNoYXJhY3RlciBzcGVj
        aWZpY2F0aW9uIGFnYWluc3QgYSBjaGFyYWN0ZXIuIEEgbW9yZSBlZmZpY2ll
        bnQKICAgIC8vIGltcGxlbWVudGF0aW9uIHdvdWxkIHVzZSBhIGhhc2ggb2Yg
        a2V5cyBwb2ludGluZyBhdCBvbmUgb3IgbW9yZSBuZXh0IHN0YXRlcy4KCiAg
        ICBmdW5jdGlvbiBTdGF0ZShjaGFyU3BlYykgewogICAgICB0aGlzLmNoYXJT
        cGVjID0gY2hhclNwZWM7CiAgICAgIHRoaXMubmV4dFN0YXRlcyA9IFtdOwog
        ICAgfQoKICAgIFN0YXRlLnByb3RvdHlwZSA9IHsKICAgICAgZ2V0OiBmdW5j
        dGlvbihjaGFyU3BlYykgewogICAgICAgIHZhciBuZXh0U3RhdGVzID0gdGhp
        cy5uZXh0U3RhdGVzOwoKICAgICAgICBmb3IgKHZhciBpPTAsIGw9bmV4dFN0
        YXRlcy5sZW5ndGg7IGk8bDsgaSsrKSB7CiAgICAgICAgICB2YXIgY2hpbGQg
        PSBuZXh0U3RhdGVzW2ldOwoKICAgICAgICAgIHZhciBpc0VxdWFsID0gY2hp
        bGQuY2hhclNwZWMudmFsaWRDaGFycyA9PT0gY2hhclNwZWMudmFsaWRDaGFy
        czsKICAgICAgICAgIGlzRXF1YWwgPSBpc0VxdWFsICYmIGNoaWxkLmNoYXJT
        cGVjLmludmFsaWRDaGFycyA9PT0gY2hhclNwZWMuaW52YWxpZENoYXJzOwoK
        ICAgICAgICAgIGlmIChpc0VxdWFsKSB7IHJldHVybiBjaGlsZDsgfQogICAg
        ICAgIH0KICAgICAgfSwKCiAgICAgIHB1dDogZnVuY3Rpb24oY2hhclNwZWMp
        IHsKICAgICAgICB2YXIgc3RhdGU7CgogICAgICAgIC8vIElmIHRoZSBjaGFy
        YWN0ZXIgc3BlY2lmaWNhdGlvbiBhbHJlYWR5IGV4aXN0cyBpbiBhIGNoaWxk
        IG9mIHRoZSBjdXJyZW50CiAgICAgICAgLy8gc3RhdGUsIGp1c3QgcmV0dXJu
        IHRoYXQgc3RhdGUuCiAgICAgICAgaWYgKHN0YXRlID0gdGhpcy5nZXQoY2hh
        clNwZWMpKSB7IHJldHVybiBzdGF0ZTsgfQoKICAgICAgICAvLyBNYWtlIGEg
        bmV3IHN0YXRlIGZvciB0aGUgY2hhcmFjdGVyIHNwZWMKICAgICAgICBzdGF0
        ZSA9IG5ldyBTdGF0ZShjaGFyU3BlYyk7CgogICAgICAgIC8vIEluc2VydCB0
        aGUgbmV3IHN0YXRlIGFzIGEgY2hpbGQgb2YgdGhlIGN1cnJlbnQgc3RhdGUK
        ICAgICAgICB0aGlzLm5leHRTdGF0ZXMucHVzaChzdGF0ZSk7CgogICAgICAg
        IC8vIElmIHRoaXMgY2hhcmFjdGVyIHNwZWNpZmljYXRpb24gcmVwZWF0cywg
        aW5zZXJ0IHRoZSBuZXcgc3RhdGUgYXMgYSBjaGlsZAogICAgICAgIC8vIG9m
        IGl0c2VsZi4gTm90ZSB0aGF0IHRoaXMgd2lsbCBub3QgdHJpZ2dlciBhbiBp
        bmZpbml0ZSBsb29wIGJlY2F1c2UgZWFjaAogICAgICAgIC8vIHRyYW5zaXRp
        b24gZHVyaW5nIHJlY29nbml0aW9uIGNvbnN1bWVzIGEgY2hhcmFjdGVyLgog
        ICAgICAgIGlmIChjaGFyU3BlYy5yZXBlYXQpIHsKICAgICAgICAgIHN0YXRl
        Lm5leHRTdGF0ZXMucHVzaChzdGF0ZSk7CiAgICAgICAgfQoKICAgICAgICAv
        LyBSZXR1cm4gdGhlIG5ldyBzdGF0ZQogICAgICAgIHJldHVybiBzdGF0ZTsK
        ICAgICAgfSwKCiAgICAgIC8vIEZpbmQgYSBsaXN0IG9mIGNoaWxkIHN0YXRl
        cyBtYXRjaGluZyB0aGUgbmV4dCBjaGFyYWN0ZXIKICAgICAgbWF0Y2g6IGZ1
        bmN0aW9uKGNoYXIpIHsKICAgICAgICAvLyBERUJVRyAiUHJvY2Vzc2luZyBg
        IiArIGNoYXIgKyAiYDoiCiAgICAgICAgdmFyIG5leHRTdGF0ZXMgPSB0aGlz
        Lm5leHRTdGF0ZXMsCiAgICAgICAgICAgIGNoaWxkLCBjaGFyU3BlYywgY2hh
        cnM7CgogICAgICAgIC8vIERFQlVHICIgICIgKyBkZWJ1Z1N0YXRlKHRoaXMp
        CiAgICAgICAgdmFyIHJldHVybmVkID0gW107CgogICAgICAgIGZvciAodmFy
        IGk9MCwgbD1uZXh0U3RhdGVzLmxlbmd0aDsgaTxsOyBpKyspIHsKICAgICAg
        ICAgIGNoaWxkID0gbmV4dFN0YXRlc1tpXTsKCiAgICAgICAgICBjaGFyU3Bl
        YyA9IGNoaWxkLmNoYXJTcGVjOwoKICAgICAgICAgIGlmICh0eXBlb2YgKGNo
        YXJzID0gY2hhclNwZWMudmFsaWRDaGFycykgIT09ICd1bmRlZmluZWQnKSB7
        CiAgICAgICAgICAgIGlmIChjaGFycy5pbmRleE9mKGNoYXIpICE9PSAtMSkg
        eyByZXR1cm5lZC5wdXNoKGNoaWxkKTsgfQogICAgICAgICAgfSBlbHNlIGlm
        ICh0eXBlb2YgKGNoYXJzID0gY2hhclNwZWMuaW52YWxpZENoYXJzKSAhPT0g
        J3VuZGVmaW5lZCcpIHsKICAgICAgICAgICAgaWYgKGNoYXJzLmluZGV4T2Yo
        Y2hhcikgPT09IC0xKSB7IHJldHVybmVkLnB1c2goY2hpbGQpOyB9CiAgICAg
        ICAgICB9CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gcmV0dXJuZWQ7CiAg
        ICAgIH0KCiAgICAgIC8qKiBJRiBERUJVRwogICAgICAsIGRlYnVnOiBmdW5j
        dGlvbigpIHsKICAgICAgICB2YXIgY2hhclNwZWMgPSB0aGlzLmNoYXJTcGVj
        LAogICAgICAgICAgICBkZWJ1ZyA9ICJbIiwKICAgICAgICAgICAgY2hhcnMg
        PSBjaGFyU3BlYy52YWxpZENoYXJzIHx8IGNoYXJTcGVjLmludmFsaWRDaGFy
        czsKCiAgICAgICAgaWYgKGNoYXJTcGVjLmludmFsaWRDaGFycykgeyBkZWJ1
        ZyArPSAiXiI7IH0KICAgICAgICBkZWJ1ZyArPSBjaGFyczsKICAgICAgICBk
        ZWJ1ZyArPSAiXSI7CgogICAgICAgIGlmIChjaGFyU3BlYy5yZXBlYXQpIHsg
        ZGVidWcgKz0gIisiOyB9CgogICAgICAgIHJldHVybiBkZWJ1ZzsKICAgICAg
        fQogICAgICBFTkQgSUYgKiovCiAgICB9OwoKICAgIC8qKiBJRiBERUJVRwog
        ICAgZnVuY3Rpb24gZGVidWcobG9nKSB7CiAgICAgIGNvbnNvbGUubG9nKGxv
        Zyk7CiAgICB9CgogICAgZnVuY3Rpb24gZGVidWdTdGF0ZShzdGF0ZSkgewog
        ICAgICByZXR1cm4gc3RhdGUubmV4dFN0YXRlcy5tYXAoZnVuY3Rpb24obikg
        ewogICAgICAgIGlmIChuLm5leHRTdGF0ZXMubGVuZ3RoID09PSAwKSB7IHJl
        dHVybiAiKCAiICsgbi5kZWJ1ZygpICsgIiBbYWNjZXB0aW5nXSApIjsgfQog
        ICAgICAgIHJldHVybiAiKCAiICsgbi5kZWJ1ZygpICsgIiA8dGhlbj4gIiAr
        IG4ubmV4dFN0YXRlcy5tYXAoZnVuY3Rpb24ocykgeyByZXR1cm4gcy5kZWJ1
        ZygpIH0pLmpvaW4oIiBvciAiKSArICIgKSI7CiAgICAgIH0pLmpvaW4oIiwg
        IikKICAgIH0KICAgIEVORCBJRiAqKi8KCiAgICAvLyBUaGlzIGlzIGEgc29t
        ZXdoYXQgbmFpdmUgc3RyYXRlZ3ksIGJ1dCBzaG91bGQgd29yayBpbiBhIGxv
        dCBvZiBjYXNlcwogICAgLy8gQSBiZXR0ZXIgc3RyYXRlZ3kgd291bGQgcHJv
        cGVybHkgcmVzb2x2ZSAvcG9zdHMvOmlkL25ldyBhbmQgL3Bvc3RzL2VkaXQv
        OmlkCiAgICBmdW5jdGlvbiBzb3J0U29sdXRpb25zKHN0YXRlcykgewogICAg
        ICByZXR1cm4gc3RhdGVzLnNvcnQoZnVuY3Rpb24oYSwgYikgewogICAgICAg
        IGlmIChhLnR5cGVzLnN0YXJzICE9PSBiLnR5cGVzLnN0YXJzKSB7IHJldHVy
        biBhLnR5cGVzLnN0YXJzIC0gYi50eXBlcy5zdGFyczsgfQogICAgICAgIGlm
        IChhLnR5cGVzLmR5bmFtaWNzICE9PSBiLnR5cGVzLmR5bmFtaWNzKSB7IHJl
        dHVybiBhLnR5cGVzLmR5bmFtaWNzIC0gYi50eXBlcy5keW5hbWljczsgfQog
        ICAgICAgIGlmIChhLnR5cGVzLnN0YXRpY3MgIT09IGIudHlwZXMuc3RhdGlj
        cykgeyByZXR1cm4gYS50eXBlcy5zdGF0aWNzIC0gYi50eXBlcy5zdGF0aWNz
        OyB9CgogICAgICAgIHJldHVybiAwOwogICAgICB9KTsKICAgIH0KCiAgICBm
        dW5jdGlvbiByZWNvZ25pemVDaGFyKHN0YXRlcywgY2hhcikgewogICAgICB2
        YXIgbmV4dFN0YXRlcyA9IFtdOwoKICAgICAgZm9yICh2YXIgaT0wLCBsPXN0
        YXRlcy5sZW5ndGg7IGk8bDsgaSsrKSB7CiAgICAgICAgdmFyIHN0YXRlID0g
        c3RhdGVzW2ldOwoKICAgICAgICBuZXh0U3RhdGVzID0gbmV4dFN0YXRlcy5j
        b25jYXQoc3RhdGUubWF0Y2goY2hhcikpOwogICAgICB9CgogICAgICByZXR1
        cm4gbmV4dFN0YXRlczsKICAgIH0KCiAgICBmdW5jdGlvbiBmaW5kSGFuZGxl
        cihzdGF0ZSwgcGF0aCkgewogICAgICB2YXIgaGFuZGxlcnMgPSBzdGF0ZS5o
        YW5kbGVycywgcmVnZXggPSBzdGF0ZS5yZWdleDsKICAgICAgdmFyIGNhcHR1
        cmVzID0gcGF0aC5tYXRjaChyZWdleCksIGN1cnJlbnRDYXB0dXJlID0gMTsK
        ICAgICAgdmFyIHJlc3VsdCA9IFtdOwoKICAgICAgZm9yICh2YXIgaT0wLCBs
        PWhhbmRsZXJzLmxlbmd0aDsgaTxsOyBpKyspIHsKICAgICAgICB2YXIgaGFu
        ZGxlciA9IGhhbmRsZXJzW2ldLCBuYW1lcyA9IGhhbmRsZXIubmFtZXMsIHBh
        cmFtcyA9IHt9OwoKICAgICAgICBmb3IgKHZhciBqPTAsIG09bmFtZXMubGVu
        Z3RoOyBqPG07IGorKykgewogICAgICAgICAgcGFyYW1zW25hbWVzW2pdXSA9
        IGNhcHR1cmVzW2N1cnJlbnRDYXB0dXJlKytdOwogICAgICAgIH0KCiAgICAg
        ICAgcmVzdWx0LnB1c2goeyBoYW5kbGVyOiBoYW5kbGVyLmhhbmRsZXIsIHBh
        cmFtczogcGFyYW1zLCBpc0R5bmFtaWM6ICEhbmFtZXMubGVuZ3RoIH0pOwog
        ICAgICB9CgogICAgICByZXR1cm4gcmVzdWx0OwogICAgfQoKICAgIGZ1bmN0
        aW9uIGFkZFNlZ21lbnQoY3VycmVudFN0YXRlLCBzZWdtZW50KSB7CiAgICAg
        IHNlZ21lbnQuZWFjaENoYXIoZnVuY3Rpb24oY2hhcikgewogICAgICAgIHZh
        ciBzdGF0ZTsKCiAgICAgICAgY3VycmVudFN0YXRlID0gY3VycmVudFN0YXRl
        LnB1dChjaGFyKTsKICAgICAgfSk7CgogICAgICByZXR1cm4gY3VycmVudFN0
        YXRlOwogICAgfQoKICAgIC8vIFRoZSBtYWluIGludGVyZmFjZQoKICAgIHZh
        ciBSb3V0ZVJlY29nbml6ZXIgPSBmdW5jdGlvbigpIHsKICAgICAgdGhpcy5y
        b290U3RhdGUgPSBuZXcgU3RhdGUoKTsKICAgICAgdGhpcy5uYW1lcyA9IHt9
        OwogICAgfTsKCgogICAgUm91dGVSZWNvZ25pemVyLnByb3RvdHlwZSA9IHsK
        ICAgICAgYWRkOiBmdW5jdGlvbihyb3V0ZXMsIG9wdGlvbnMpIHsKICAgICAg
        ICB2YXIgY3VycmVudFN0YXRlID0gdGhpcy5yb290U3RhdGUsIHJlZ2V4ID0g
        Il4iLAogICAgICAgICAgICB0eXBlcyA9IHsgc3RhdGljczogMCwgZHluYW1p
        Y3M6IDAsIHN0YXJzOiAwIH0sCiAgICAgICAgICAgIGhhbmRsZXJzID0gW10s
        IGFsbFNlZ21lbnRzID0gW10sIG5hbWU7CgogICAgICAgIHZhciBpc0VtcHR5
        ID0gdHJ1ZTsKCiAgICAgICAgZm9yICh2YXIgaT0wLCBsPXJvdXRlcy5sZW5n
        dGg7IGk8bDsgaSsrKSB7CiAgICAgICAgICB2YXIgcm91dGUgPSByb3V0ZXNb
        aV0sIG5hbWVzID0gW107CgogICAgICAgICAgdmFyIHNlZ21lbnRzID0gcGFy
        c2Uocm91dGUucGF0aCwgbmFtZXMsIHR5cGVzKTsKCiAgICAgICAgICBhbGxT
        ZWdtZW50cyA9IGFsbFNlZ21lbnRzLmNvbmNhdChzZWdtZW50cyk7CgogICAg
        ICAgICAgZm9yICh2YXIgaj0wLCBtPXNlZ21lbnRzLmxlbmd0aDsgajxtOyBq
        KyspIHsKICAgICAgICAgICAgdmFyIHNlZ21lbnQgPSBzZWdtZW50c1tqXTsK
        CiAgICAgICAgICAgIGlmIChzZWdtZW50IGluc3RhbmNlb2YgRXBzaWxvblNl
        Z21lbnQpIHsgY29udGludWU7IH0KCiAgICAgICAgICAgIGlzRW1wdHkgPSBm
        YWxzZTsKCiAgICAgICAgICAgIC8vIEFkZCBhICIvIiBmb3IgdGhlIG5ldyBz
        ZWdtZW50CiAgICAgICAgICAgIGN1cnJlbnRTdGF0ZSA9IGN1cnJlbnRTdGF0
        ZS5wdXQoeyB2YWxpZENoYXJzOiAiLyIgfSk7CiAgICAgICAgICAgIHJlZ2V4
        ICs9ICIvIjsKCiAgICAgICAgICAgIC8vIEFkZCBhIHJlcHJlc2VudGF0aW9u
        IG9mIHRoZSBzZWdtZW50IHRvIHRoZSBORkEgYW5kIHJlZ2V4CiAgICAgICAg
        ICAgIGN1cnJlbnRTdGF0ZSA9IGFkZFNlZ21lbnQoY3VycmVudFN0YXRlLCBz
        ZWdtZW50KTsKICAgICAgICAgICAgcmVnZXggKz0gc2VnbWVudC5yZWdleCgp
        OwogICAgICAgICAgfQoKICAgICAgICAgIGhhbmRsZXJzLnB1c2goeyBoYW5k
        bGVyOiByb3V0ZS5oYW5kbGVyLCBuYW1lczogbmFtZXMgfSk7CiAgICAgICAg
        fQoKICAgICAgICBpZiAoaXNFbXB0eSkgewogICAgICAgICAgY3VycmVudFN0
        YXRlID0gY3VycmVudFN0YXRlLnB1dCh7IHZhbGlkQ2hhcnM6ICIvIiB9KTsK
        ICAgICAgICAgIHJlZ2V4ICs9ICIvIjsKICAgICAgICB9CgogICAgICAgIGN1
        cnJlbnRTdGF0ZS5oYW5kbGVycyA9IGhhbmRsZXJzOwogICAgICAgIGN1cnJl
        bnRTdGF0ZS5yZWdleCA9IG5ldyBSZWdFeHAocmVnZXggKyAiJCIpOwogICAg
        ICAgIGN1cnJlbnRTdGF0ZS50eXBlcyA9IHR5cGVzOwoKICAgICAgICBpZiAo
        bmFtZSA9IG9wdGlvbnMgJiYgb3B0aW9ucy5hcykgewogICAgICAgICAgdGhp
        cy5uYW1lc1tuYW1lXSA9IHsKICAgICAgICAgICAgc2VnbWVudHM6IGFsbFNl
        Z21lbnRzLAogICAgICAgICAgICBoYW5kbGVyczogaGFuZGxlcnMKICAgICAg
        ICAgIH07CiAgICAgICAgfQogICAgICB9LAoKICAgICAgaGFuZGxlcnNGb3I6
        IGZ1bmN0aW9uKG5hbWUpIHsKICAgICAgICB2YXIgcm91dGUgPSB0aGlzLm5h
        bWVzW25hbWVdLCByZXN1bHQgPSBbXTsKICAgICAgICBpZiAoIXJvdXRlKSB7
        IHRocm93IG5ldyBFcnJvcigiVGhlcmUgaXMgbm8gcm91dGUgbmFtZWQgIiAr
        IG5hbWUpOyB9CgogICAgICAgIGZvciAodmFyIGk9MCwgbD1yb3V0ZS5oYW5k
        bGVycy5sZW5ndGg7IGk8bDsgaSsrKSB7CiAgICAgICAgICByZXN1bHQucHVz
        aChyb3V0ZS5oYW5kbGVyc1tpXSk7CiAgICAgICAgfQoKICAgICAgICByZXR1
        cm4gcmVzdWx0OwogICAgICB9LAoKICAgICAgaGFzUm91dGU6IGZ1bmN0aW9u
        KG5hbWUpIHsKICAgICAgICByZXR1cm4gISF0aGlzLm5hbWVzW25hbWVdOwog
        ICAgICB9LAoKICAgICAgZ2VuZXJhdGU6IGZ1bmN0aW9uKG5hbWUsIHBhcmFt
        cykgewogICAgICAgIHZhciByb3V0ZSA9IHRoaXMubmFtZXNbbmFtZV0sIG91
        dHB1dCA9ICIiOwogICAgICAgIGlmICghcm91dGUpIHsgdGhyb3cgbmV3IEVy
        cm9yKCJUaGVyZSBpcyBubyByb3V0ZSBuYW1lZCAiICsgbmFtZSk7IH0KCiAg
        ICAgICAgdmFyIHNlZ21lbnRzID0gcm91dGUuc2VnbWVudHM7CgogICAgICAg
        IGZvciAodmFyIGk9MCwgbD1zZWdtZW50cy5sZW5ndGg7IGk8bDsgaSsrKSB7
        CiAgICAgICAgICB2YXIgc2VnbWVudCA9IHNlZ21lbnRzW2ldOwoKICAgICAg
        ICAgIGlmIChzZWdtZW50IGluc3RhbmNlb2YgRXBzaWxvblNlZ21lbnQpIHsg
        Y29udGludWU7IH0KCiAgICAgICAgICBvdXRwdXQgKz0gIi8iOwogICAgICAg
        ICAgb3V0cHV0ICs9IHNlZ21lbnQuZ2VuZXJhdGUocGFyYW1zKTsKICAgICAg
        ICB9CgogICAgICAgIGlmIChvdXRwdXQuY2hhckF0KDApICE9PSAnLycpIHsg
        b3V0cHV0ID0gJy8nICsgb3V0cHV0OyB9CgogICAgICAgIHJldHVybiBvdXRw
        dXQ7CiAgICAgIH0sCgogICAgICByZWNvZ25pemU6IGZ1bmN0aW9uKHBhdGgp
        IHsKICAgICAgICB2YXIgc3RhdGVzID0gWyB0aGlzLnJvb3RTdGF0ZSBdLAog
        ICAgICAgICAgICBwYXRoTGVuLCBpLCBsOwoKICAgICAgICAvLyBERUJVRyBH
        Uk9VUCBwYXRoCgogICAgICAgIGlmIChwYXRoLmNoYXJBdCgwKSAhPT0gIi8i
        KSB7IHBhdGggPSAiLyIgKyBwYXRoOyB9CgogICAgICAgIHBhdGhMZW4gPSBw
        YXRoLmxlbmd0aDsKICAgICAgICBpZiAocGF0aExlbiA+IDEgJiYgcGF0aC5j
        aGFyQXQocGF0aExlbiAtIDEpID09PSAiLyIpIHsKICAgICAgICAgIHBhdGgg
        PSBwYXRoLnN1YnN0cigwLCBwYXRoTGVuIC0gMSk7CiAgICAgICAgfQoKICAg
        ICAgICBmb3IgKGk9MCwgbD1wYXRoLmxlbmd0aDsgaTxsOyBpKyspIHsKICAg
        ICAgICAgIHN0YXRlcyA9IHJlY29nbml6ZUNoYXIoc3RhdGVzLCBwYXRoLmNo
        YXJBdChpKSk7CiAgICAgICAgICBpZiAoIXN0YXRlcy5sZW5ndGgpIHsgYnJl
        YWs7IH0KICAgICAgICB9CgogICAgICAgIC8vIEVORCBERUJVRyBHUk9VUAoK
        ICAgICAgICB2YXIgc29sdXRpb25zID0gW107CiAgICAgICAgZm9yIChpPTAs
        IGw9c3RhdGVzLmxlbmd0aDsgaTxsOyBpKyspIHsKICAgICAgICAgIGlmIChz
        dGF0ZXNbaV0uaGFuZGxlcnMpIHsgc29sdXRpb25zLnB1c2goc3RhdGVzW2ld
        KTsgfQogICAgICAgIH0KCiAgICAgICAgc3RhdGVzID0gc29ydFNvbHV0aW9u
        cyhzb2x1dGlvbnMpOwoKICAgICAgICB2YXIgc3RhdGUgPSBzb2x1dGlvbnNb
        MF07CgogICAgICAgIGlmIChzdGF0ZSAmJiBzdGF0ZS5oYW5kbGVycykgewog
        ICAgICAgICAgcmV0dXJuIGZpbmRIYW5kbGVyKHN0YXRlLCBwYXRoKTsKICAg
        ICAgICB9CiAgICAgIH0KICAgIH07CgogICAgZnVuY3Rpb24gVGFyZ2V0KHBh
        dGgsIG1hdGNoZXIsIGRlbGVnYXRlKSB7CiAgICAgIHRoaXMucGF0aCA9IHBh
        dGg7CiAgICAgIHRoaXMubWF0Y2hlciA9IG1hdGNoZXI7CiAgICAgIHRoaXMu
        ZGVsZWdhdGUgPSBkZWxlZ2F0ZTsKICAgIH0KCiAgICBUYXJnZXQucHJvdG90
        eXBlID0gewogICAgICB0bzogZnVuY3Rpb24odGFyZ2V0LCBjYWxsYmFjaykg
        ewogICAgICAgIHZhciBkZWxlZ2F0ZSA9IHRoaXMuZGVsZWdhdGU7CgogICAg
        ICAgIGlmIChkZWxlZ2F0ZSAmJiBkZWxlZ2F0ZS53aWxsQWRkUm91dGUpIHsK
        ICAgICAgICAgIHRhcmdldCA9IGRlbGVnYXRlLndpbGxBZGRSb3V0ZSh0aGlz
        Lm1hdGNoZXIudGFyZ2V0LCB0YXJnZXQpOwogICAgICAgIH0KCiAgICAgICAg
        dGhpcy5tYXRjaGVyLmFkZCh0aGlzLnBhdGgsIHRhcmdldCk7CgogICAgICAg
        IGlmIChjYWxsYmFjaykgewogICAgICAgICAgaWYgKGNhbGxiYWNrLmxlbmd0
        aCA9PT0gMCkgeyB0aHJvdyBuZXcgRXJyb3IoIllvdSBtdXN0IGhhdmUgYW4g
        YXJndW1lbnQgaW4gdGhlIGZ1bmN0aW9uIHBhc3NlZCB0byBgdG9gIik7IH0K
        ICAgICAgICAgIHRoaXMubWF0Y2hlci5hZGRDaGlsZCh0aGlzLnBhdGgsIHRh
        cmdldCwgY2FsbGJhY2ssIHRoaXMuZGVsZWdhdGUpOwogICAgICAgIH0KICAg
        ICAgfQogICAgfTsKCiAgICBmdW5jdGlvbiBNYXRjaGVyKHRhcmdldCkgewog
        ICAgICB0aGlzLnJvdXRlcyA9IHt9OwogICAgICB0aGlzLmNoaWxkcmVuID0g
        e307CiAgICAgIHRoaXMudGFyZ2V0ID0gdGFyZ2V0OwogICAgfQoKICAgIE1h
        dGNoZXIucHJvdG90eXBlID0gewogICAgICBhZGQ6IGZ1bmN0aW9uKHBhdGgs
        IGhhbmRsZXIpIHsKICAgICAgICB0aGlzLnJvdXRlc1twYXRoXSA9IGhhbmRs
        ZXI7CiAgICAgIH0sCgogICAgICBhZGRDaGlsZDogZnVuY3Rpb24ocGF0aCwg
        dGFyZ2V0LCBjYWxsYmFjaywgZGVsZWdhdGUpIHsKICAgICAgICB2YXIgbWF0
        Y2hlciA9IG5ldyBNYXRjaGVyKHRhcmdldCk7CiAgICAgICAgdGhpcy5jaGls
        ZHJlbltwYXRoXSA9IG1hdGNoZXI7CgogICAgICAgIHZhciBtYXRjaCA9IGdl
        bmVyYXRlTWF0Y2gocGF0aCwgbWF0Y2hlciwgZGVsZWdhdGUpOwoKICAgICAg
        ICBpZiAoZGVsZWdhdGUgJiYgZGVsZWdhdGUuY29udGV4dEVudGVyZWQpIHsK
        ICAgICAgICAgIGRlbGVnYXRlLmNvbnRleHRFbnRlcmVkKHRhcmdldCwgbWF0
        Y2gpOwogICAgICAgIH0KCiAgICAgICAgY2FsbGJhY2sobWF0Y2gpOwogICAg
        ICB9CiAgICB9OwoKICAgIGZ1bmN0aW9uIGdlbmVyYXRlTWF0Y2goc3RhcnRp
        bmdQYXRoLCBtYXRjaGVyLCBkZWxlZ2F0ZSkgewogICAgICByZXR1cm4gZnVu
        Y3Rpb24ocGF0aCwgbmVzdGVkQ2FsbGJhY2spIHsKICAgICAgICB2YXIgZnVs
        bFBhdGggPSBzdGFydGluZ1BhdGggKyBwYXRoOwoKICAgICAgICBpZiAobmVz
        dGVkQ2FsbGJhY2spIHsKICAgICAgICAgIG5lc3RlZENhbGxiYWNrKGdlbmVy
        YXRlTWF0Y2goZnVsbFBhdGgsIG1hdGNoZXIsIGRlbGVnYXRlKSk7CiAgICAg
        ICAgfSBlbHNlIHsKICAgICAgICAgIHJldHVybiBuZXcgVGFyZ2V0KHN0YXJ0
        aW5nUGF0aCArIHBhdGgsIG1hdGNoZXIsIGRlbGVnYXRlKTsKICAgICAgICB9
        CiAgICAgIH07CiAgICB9CgogICAgZnVuY3Rpb24gYWRkUm91dGUocm91dGVB
        cnJheSwgcGF0aCwgaGFuZGxlcikgewogICAgICB2YXIgbGVuID0gMDsKICAg
        ICAgZm9yICh2YXIgaT0wLCBsPXJvdXRlQXJyYXkubGVuZ3RoOyBpPGw7IGkr
        KykgewogICAgICAgIGxlbiArPSByb3V0ZUFycmF5W2ldLnBhdGgubGVuZ3Ro
        OwogICAgICB9CgogICAgICBwYXRoID0gcGF0aC5zdWJzdHIobGVuKTsKICAg
        ICAgcm91dGVBcnJheS5wdXNoKHsgcGF0aDogcGF0aCwgaGFuZGxlcjogaGFu
        ZGxlciB9KTsKICAgIH0KCiAgICBmdW5jdGlvbiBlYWNoUm91dGUoYmFzZVJv
        dXRlLCBtYXRjaGVyLCBjYWxsYmFjaywgYmluZGluZykgewogICAgICB2YXIg
        cm91dGVzID0gbWF0Y2hlci5yb3V0ZXM7CgogICAgICBmb3IgKHZhciBwYXRo
        IGluIHJvdXRlcykgewogICAgICAgIGlmIChyb3V0ZXMuaGFzT3duUHJvcGVy
        dHkocGF0aCkpIHsKICAgICAgICAgIHZhciByb3V0ZUFycmF5ID0gYmFzZVJv
        dXRlLnNsaWNlKCk7CiAgICAgICAgICBhZGRSb3V0ZShyb3V0ZUFycmF5LCBw
        YXRoLCByb3V0ZXNbcGF0aF0pOwoKICAgICAgICAgIGlmIChtYXRjaGVyLmNo
        aWxkcmVuW3BhdGhdKSB7CiAgICAgICAgICAgIGVhY2hSb3V0ZShyb3V0ZUFy
        cmF5LCBtYXRjaGVyLmNoaWxkcmVuW3BhdGhdLCBjYWxsYmFjaywgYmluZGlu
        Zyk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBjYWxsYmFjay5j
        YWxsKGJpbmRpbmcsIHJvdXRlQXJyYXkpOwogICAgICAgICAgfQogICAgICAg
        IH0KICAgICAgfQogICAgfQoKICAgIFJvdXRlUmVjb2duaXplci5wcm90b3R5
        cGUubWFwID0gZnVuY3Rpb24oY2FsbGJhY2ssIGFkZFJvdXRlQ2FsbGJhY2sp
        IHsKICAgICAgdmFyIG1hdGNoZXIgPSBuZXcgTWF0Y2hlcigpOwoKICAgICAg
        Y2FsbGJhY2soZ2VuZXJhdGVNYXRjaCgiIiwgbWF0Y2hlciwgdGhpcy5kZWxl
        Z2F0ZSkpOwoKICAgICAgZWFjaFJvdXRlKFtdLCBtYXRjaGVyLCBmdW5jdGlv
        bihyb3V0ZSkgewogICAgICAgIGlmIChhZGRSb3V0ZUNhbGxiYWNrKSB7IGFk
        ZFJvdXRlQ2FsbGJhY2sodGhpcywgcm91dGUpOyB9CiAgICAgICAgZWxzZSB7
        IHRoaXMuYWRkKHJvdXRlKTsgfQogICAgICB9LCB0aGlzKTsKICAgIH07CiAg
        ICByZXR1cm4gUm91dGVSZWNvZ25pemVyOwogIH0pOwoKfSkoKTsKCgoKKGZ1
        bmN0aW9uKCkgewpkZWZpbmUoInJvdXRlciIsCiAgWyJyb3V0ZS1yZWNvZ25p
        emVyIiwicnN2cCJdLAogIGZ1bmN0aW9uKFJvdXRlUmVjb2duaXplciwgUlNW
        UCkgewogICAgInVzZSBzdHJpY3QiOwogICAgLyoqCiAgICAgIEBwcml2YXRl
        CgogICAgICBUaGlzIGZpbGUgcmVmZXJlbmNlcyBzZXZlcmFsIGludGVybmFs
        IHN0cnVjdHVyZXM6CgogICAgICAjIyBgUmVjb2duaXplZEhhbmRsZXJgCgog
        ICAgICAqIGB7U3RyaW5nfSBoYW5kbGVyYDogQSBoYW5kbGVyIG5hbWUKICAg
        ICAgKiBge09iamVjdH0gcGFyYW1zYDogQSBoYXNoIG9mIHJlY29nbml6ZWQg
        cGFyYW1ldGVycwoKICAgICAgIyMgYEhhbmRsZXJJbmZvYAoKICAgICAgKiBg
        e0Jvb2xlYW59IGlzRHluYW1pY2A6IHdoZXRoZXIgYSBoYW5kbGVyIGhhcyBh
        bnkgZHluYW1pYyBzZWdtZW50cwogICAgICAqIGB7U3RyaW5nfSBuYW1lYDog
        dGhlIG5hbWUgb2YgYSBoYW5kbGVyCiAgICAgICogYHtPYmplY3R9IGhhbmRs
        ZXJgOiBhIGhhbmRsZXIgb2JqZWN0CiAgICAgICogYHtPYmplY3R9IGNvbnRl
        eHRgOiB0aGUgYWN0aXZlIGNvbnRleHQgZm9yIHRoZSBoYW5kbGVyCiAgICAq
        LwoKCiAgICB2YXIgc2xpY2UgPSBBcnJheS5wcm90b3R5cGUuc2xpY2U7CgoK
        CiAgICAvKioKICAgICAgQHByaXZhdGUKCiAgICAgIEEgVHJhbnNpdGlvbiBp
        cyBhIHRoZW5uYWJsZSAoYSBwcm9taXNlLWxpa2Ugb2JqZWN0KSB0aGF0IHJl
        cHJlc2VudHMKICAgICAgYW4gYXR0ZW1wdCB0byB0cmFuc2l0aW9uIHRvIGFu
        b3RoZXIgcm91dGUuIEl0IGNhbiBiZSBhYm9ydGVkLCBlaXRoZXIKICAgICAg
        ZXhwbGljaXRseSB2aWEgYGFib3J0YCBvciBieSBhdHRlbXB0aW5nIGFub3Ro
        ZXIgdHJhbnNpdGlvbiB3aGlsZSBhCiAgICAgIHByZXZpb3VzIG9uZSBpcyBz
        dGlsbCB1bmRlcndheS4gQW4gYWJvcnRlZCB0cmFuc2l0aW9uIGNhbiBhbHNv
        CiAgICAgIGJlIGByZXRyeSgpYGQgbGF0ZXIuCiAgICAgKi8KCiAgICBmdW5j
        dGlvbiBUcmFuc2l0aW9uKHJvdXRlciwgcHJvbWlzZSkgewogICAgICB0aGlz
        LnJvdXRlciA9IHJvdXRlcjsKICAgICAgdGhpcy5wcm9taXNlID0gcHJvbWlz
        ZTsKICAgICAgdGhpcy5kYXRhID0ge307CiAgICAgIHRoaXMucmVzb2x2ZWRN
        b2RlbHMgPSB7fTsKICAgICAgdGhpcy5wcm92aWRlZE1vZGVscyA9IHt9Owog
        ICAgICB0aGlzLnByb3ZpZGVkTW9kZWxzQXJyYXkgPSBbXTsKICAgICAgdGhp
        cy5zZXF1ZW5jZSA9ICsrVHJhbnNpdGlvbi5jdXJyZW50U2VxdWVuY2U7CiAg
        ICAgIHRoaXMucGFyYW1zID0ge307CiAgICB9CgogICAgVHJhbnNpdGlvbi5j
        dXJyZW50U2VxdWVuY2UgPSAwOwoKICAgIFRyYW5zaXRpb24ucHJvdG90eXBl
        ID0gewogICAgICB0YXJnZXROYW1lOiBudWxsLAogICAgICB1cmxNZXRob2Q6
        ICd1cGRhdGUnLAogICAgICBwcm92aWRlZE1vZGVsczogbnVsbCwKICAgICAg
        cmVzb2x2ZWRNb2RlbHM6IG51bGwsCiAgICAgIHBhcmFtczogbnVsbCwKCiAg
        ICAgIC8qKgogICAgICAgIFRoZSBUcmFuc2l0aW9uJ3MgaW50ZXJuYWwgcHJv
        bWlzZS4gQ2FsbGluZyBgLnRoZW5gIG9uIHRoaXMgcHJvcGVydHkKICAgICAg
        ICBpcyB0aGF0IHNhbWUgYXMgY2FsbGluZyBgLnRoZW5gIG9uIHRoZSBUcmFu
        c2l0aW9uIG9iamVjdCBpdHNlbGYsIGJ1dAogICAgICAgIHRoaXMgcHJvcGVy
        dHkgaXMgZXhwb3NlZCBmb3Igd2hlbiB5b3Ugd2FudCB0byBwYXNzIGFyb3Vu
        ZCBhCiAgICAgICAgVHJhbnNpdGlvbidzIHByb21pc2UsIGJ1dCBub3QgdGhl
        IFRyYW5zaXRpb24gb2JqZWN0IGl0c2VsZiwgc2luY2UKICAgICAgICBUcmFu
        c2l0aW9uIG9iamVjdCBjYW4gYmUgZXh0ZXJuYWxseSBgYWJvcnRgZWQsIHdo
        aWxlIHRoZSBwcm9taXNlCiAgICAgICAgY2Fubm90LgogICAgICAgKi8KICAg
        ICAgcHJvbWlzZTogbnVsbCwKCiAgICAgIC8qKgogICAgICAgIEN1c3RvbSBz
        dGF0ZSBjYW4gYmUgc3RvcmVkIG9uIGEgVHJhbnNpdGlvbidzIGBkYXRhYCBv
        YmplY3QuCiAgICAgICAgVGhpcyBjYW4gYmUgdXNlZnVsIGZvciBkZWNvcmF0
        aW5nIGEgVHJhbnNpdGlvbiB3aXRoaW4gYW4gZWFybGllcgogICAgICAgIGhv
        b2sgYW5kIHNoYXJlZCB3aXRoIGEgbGF0ZXIgaG9vay4gUHJvcGVydGllcyBz
        ZXQgb24gYGRhdGFgIHdpbGwKICAgICAgICBiZSBjb3BpZWQgdG8gbmV3IHRy
        YW5zaXRpb25zIGdlbmVyYXRlZCBieSBjYWxsaW5nIGByZXRyeWAgb24gdGhp
        cwogICAgICAgIHRyYW5zaXRpb24uCiAgICAgICAqLwogICAgICBkYXRhOiBu
        dWxsLAoKICAgICAgLyoqCiAgICAgICAgQSBzdGFuZGFyZCBwcm9taXNlIGhv
        b2sgdGhhdCByZXNvbHZlcyBpZiB0aGUgdHJhbnNpdGlvbgogICAgICAgIHN1
        Y2NlZWRzIGFuZCByZWplY3RzIGlmIGl0IGZhaWxzL3JlZGlyZWN0cy9hYm9y
        dHMuCgogICAgICAgIEZvcndhcmRzIHRvIHRoZSBpbnRlcm5hbCBgcHJvbWlz
        ZWAgcHJvcGVydHkgd2hpY2ggeW91IGNhbgogICAgICAgIHVzZSBpbiBzaXR1
        YXRpb25zIHdoZXJlIHlvdSB3YW50IHRvIHBhc3MgYXJvdW5kIGEgdGhlbm5h
        YmxlLAogICAgICAgIGJ1dCBub3QgdGhlIFRyYW5zaXRpb24gaXRzZWxmLgoK
        ICAgICAgICBAcGFyYW0ge0Z1bmN0aW9ufSBzdWNjZXNzCiAgICAgICAgQHBh
        cmFtIHtGdW5jdGlvbn0gZmFpbHVyZQogICAgICAgKi8KICAgICAgdGhlbjog
        ZnVuY3Rpb24oc3VjY2VzcywgZmFpbHVyZSkgewogICAgICAgIHJldHVybiB0
        aGlzLnByb21pc2UudGhlbihzdWNjZXNzLCBmYWlsdXJlKTsKICAgICAgfSwK
        CiAgICAgIC8qKgogICAgICAgIEFib3J0cyB0aGUgVHJhbnNpdGlvbi4gTm90
        ZSB5b3UgY2FuIGFsc28gaW1wbGljaXRseSBhYm9ydCBhIHRyYW5zaXRpb24K
        ICAgICAgICBieSBpbml0aWF0aW5nIGFub3RoZXIgdHJhbnNpdGlvbiB3aGls
        ZSBhIHByZXZpb3VzIG9uZSBpcyB1bmRlcndheS4KICAgICAgICovCiAgICAg
        IGFib3J0OiBmdW5jdGlvbigpIHsKICAgICAgICBpZiAodGhpcy5pc0Fib3J0
        ZWQpIHsgcmV0dXJuIHRoaXM7IH0KICAgICAgICBsb2codGhpcy5yb3V0ZXIs
        IHRoaXMuc2VxdWVuY2UsIHRoaXMudGFyZ2V0TmFtZSArICI6IHRyYW5zaXRp
        b24gd2FzIGFib3J0ZWQiKTsKICAgICAgICB0aGlzLmlzQWJvcnRlZCA9IHRy
        dWU7CiAgICAgICAgdGhpcy5yb3V0ZXIuYWN0aXZlVHJhbnNpdGlvbiA9IG51
        bGw7CiAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAgIH0sCgogICAgICAvKioK
        ICAgICAgICBSZXRyaWVzIGEgcHJldmlvdXNseS1hYm9ydGVkIHRyYW5zaXRp
        b24gKG1ha2luZyBzdXJlIHRvIGFib3J0IHRoZQogICAgICAgIHRyYW5zaXRp
        b24gaWYgaXQncyBzdGlsbCBhY3RpdmUpLiBSZXR1cm5zIGEgbmV3IHRyYW5z
        aXRpb24gdGhhdAogICAgICAgIHJlcHJlc2VudHMgdGhlIG5ldyBhdHRlbXB0
        IHRvIHRyYW5zaXRpb24uCiAgICAgICAqLwogICAgICByZXRyeTogZnVuY3Rp
        b24oKSB7CiAgICAgICAgdGhpcy5hYm9ydCgpOwoKICAgICAgICB2YXIgcmVj
        b2dIYW5kbGVycyA9IHRoaXMucm91dGVyLnJlY29nbml6ZXIuaGFuZGxlcnNG
        b3IodGhpcy50YXJnZXROYW1lKSwKICAgICAgICAgICAgbmV3VHJhbnNpdGlv
        biA9IHBlcmZvcm1UcmFuc2l0aW9uKHRoaXMucm91dGVyLCByZWNvZ0hhbmRs
        ZXJzLCB0aGlzLnByb3ZpZGVkTW9kZWxzQXJyYXksIHRoaXMucGFyYW1zLCB0
        aGlzLmRhdGEpOwoKICAgICAgICByZXR1cm4gbmV3VHJhbnNpdGlvbjsKICAg
        ICAgfSwKCiAgICAgIC8qKgogICAgICAgIFNldHMgdGhlIFVSTC1jaGFuZ2lu
        ZyBtZXRob2QgdG8gYmUgZW1wbG95ZWQgYXQgdGhlIGVuZCBvZiBhCiAgICAg
        ICAgc3VjY2Vzc2Z1bCB0cmFuc2l0aW9uLiBCeSBkZWZhdWx0LCBhIG5ldyBU
        cmFuc2l0aW9uIHdpbGwganVzdAogICAgICAgIHVzZSBgdXBkYXRlVVJMYCwg
        YnV0IHBhc3NpbmcgJ3JlcGxhY2UnIHRvIHRoaXMgbWV0aG9kIHdpbGwKICAg
        ICAgICBjYXVzZSB0aGUgVVJMIHRvIHVwZGF0ZSB1c2luZyAncmVwbGFjZVdp
        dGgnIGluc3RlYWQuIE9taXR0aW5nCiAgICAgICAgYSBwYXJhbWV0ZXIgd2ls
        bCBkaXNhYmxlIHRoZSBVUkwgY2hhbmdlLCBhbGxvd2luZyBmb3IgdHJhbnNp
        dGlvbnMKICAgICAgICB0aGF0IGRvbid0IHVwZGF0ZSB0aGUgVVJMIGF0IGNv
        bXBsZXRpb24gKHRoaXMgaXMgYWxzbyB1c2VkIGZvcgogICAgICAgIGhhbmRs
        ZVVSTCwgc2luY2UgdGhlIFVSTCBoYXMgYWxyZWFkeSBjaGFuZ2VkIGJlZm9y
        ZSB0aGUKICAgICAgICB0cmFuc2l0aW9uIHRvb2sgcGxhY2UpLgoKICAgICAg
        ICBAcGFyYW0ge1N0cmluZ30gbWV0aG9kIHRoZSB0eXBlIG9mIFVSTC1jaGFu
        Z2luZyBtZXRob2QgdG8gdXNlCiAgICAgICAgICBhdCB0aGUgZW5kIG9mIGEg
        dHJhbnNpdGlvbi4gQWNjZXB0ZWQgdmFsdWVzIGFyZSAncmVwbGFjZScsCiAg
        ICAgICAgICBmYWxzeSB2YWx1ZXMsIG9yIGFueSBvdGhlciBub24tZmFsc3kg
        dmFsdWUgKHdoaWNoIGlzCiAgICAgICAgICBpbnRlcnByZXRlZCBhcyBhbiB1
        cGRhdGVVUkwgdHJhbnNpdGlvbikuCgogICAgICAgIEByZXR1cm4ge1RyYW5z
        aXRpb259IHRoaXMgdHJhbnNpdGlvbgogICAgICAgKi8KICAgICAgbWV0aG9k
        OiBmdW5jdGlvbihtZXRob2QpIHsKICAgICAgICB0aGlzLnVybE1ldGhvZCA9
        IG1ldGhvZDsKICAgICAgICByZXR1cm4gdGhpczsKICAgICAgfQogICAgfTsK
        CiAgICBmdW5jdGlvbiBSb3V0ZXIoKSB7CiAgICAgIHRoaXMucmVjb2duaXpl
        ciA9IG5ldyBSb3V0ZVJlY29nbml6ZXIoKTsKICAgIH0KCgoKICAgIC8qKgog
        ICAgICBQcm9taXNlIHJlamVjdCByZWFzb25zIHBhc3NlZCB0byBwcm9taXNl
        IHJlamVjdGlvbgogICAgICBoYW5kbGVycyBmb3IgZmFpbGVkIHRyYW5zaXRp
        b25zLgogICAgICovCiAgICBSb3V0ZXIuVW5yZWNvZ25pemVkVVJMRXJyb3Ig
        PSBmdW5jdGlvbihtZXNzYWdlKSB7CiAgICAgIHRoaXMubWVzc2FnZSA9ICht
        ZXNzYWdlIHx8ICJVbnJlY29nbml6ZWRVUkxFcnJvciIpOwogICAgICB0aGlz
        Lm5hbWUgPSAiVW5yZWNvZ25pemVkVVJMRXJyb3IiOwogICAgfTsKCiAgICBS
        b3V0ZXIuVHJhbnNpdGlvbkFib3J0ZWQgPSBmdW5jdGlvbihtZXNzYWdlKSB7
        CiAgICAgIHRoaXMubWVzc2FnZSA9IChtZXNzYWdlIHx8ICJUcmFuc2l0aW9u
        QWJvcnRlZCIpOwogICAgICB0aGlzLm5hbWUgPSAiVHJhbnNpdGlvbkFib3J0
        ZWQiOwogICAgfTsKCiAgICBmdW5jdGlvbiBlcnJvclRyYW5zaXRpb24ocm91
        dGVyLCByZWFzb24pIHsKICAgICAgcmV0dXJuIG5ldyBUcmFuc2l0aW9uKHJv
        dXRlciwgUlNWUC5yZWplY3QocmVhc29uKSk7CiAgICB9CgoKICAgIFJvdXRl
        ci5wcm90b3R5cGUgPSB7CiAgICAgIC8qKgogICAgICAgIFRoZSBtYWluIGVu
        dHJ5IHBvaW50IGludG8gdGhlIHJvdXRlci4gVGhlIEFQSSBpcyBlc3NlbnRp
        YWxseQogICAgICAgIHRoZSBzYW1lIGFzIHRoZSBgbWFwYCBtZXRob2QgaW4g
        YHJvdXRlLXJlY29nbml6ZXJgLgoKICAgICAgICBUaGlzIG1ldGhvZCBleHRy
        YWN0cyB0aGUgU3RyaW5nIGhhbmRsZXIgYXQgdGhlIGxhc3QgYC50bygpYAog
        ICAgICAgIGNhbGwgYW5kIHVzZXMgaXQgYXMgdGhlIG5hbWUgb2YgdGhlIHdo
        b2xlIHJvdXRlLgoKICAgICAgICBAcGFyYW0ge0Z1bmN0aW9ufSBjYWxsYmFj
        awogICAgICAqLwogICAgICBtYXA6IGZ1bmN0aW9uKGNhbGxiYWNrKSB7CiAg
        ICAgICAgdGhpcy5yZWNvZ25pemVyLmRlbGVnYXRlID0gdGhpcy5kZWxlZ2F0
        ZTsKCiAgICAgICAgdGhpcy5yZWNvZ25pemVyLm1hcChjYWxsYmFjaywgZnVu
        Y3Rpb24ocmVjb2duaXplciwgcm91dGUpIHsKICAgICAgICAgIHZhciBsYXN0
        SGFuZGxlciA9IHJvdXRlW3JvdXRlLmxlbmd0aCAtIDFdLmhhbmRsZXI7CiAg
        ICAgICAgICB2YXIgYXJncyA9IFtyb3V0ZSwgeyBhczogbGFzdEhhbmRsZXIg
        fV07CiAgICAgICAgICByZWNvZ25pemVyLmFkZC5hcHBseShyZWNvZ25pemVy
        LCBhcmdzKTsKICAgICAgICB9KTsKICAgICAgfSwKCiAgICAgIGhhc1JvdXRl
        OiBmdW5jdGlvbihyb3V0ZSkgewogICAgICAgIHJldHVybiB0aGlzLnJlY29n
        bml6ZXIuaGFzUm91dGUocm91dGUpOwogICAgICB9LAoKICAgICAgLyoqCiAg
        ICAgICAgQ2xlYXJzIHRoZSBjdXJyZW50IGFuZCB0YXJnZXQgcm91dGUgaGFu
        ZGxlcnMgYW5kIHRyaWdnZXJzIGV4aXQKICAgICAgICBvbiBlYWNoIG9mIHRo
        ZW0gc3RhcnRpbmcgYXQgdGhlIGxlYWYgYW5kIHRyYXZlcnNpbmcgdXAgdGhy
        b3VnaAogICAgICAgIGl0cyBhbmNlc3RvcnMuCiAgICAgICovCiAgICAgIHJl
        c2V0OiBmdW5jdGlvbigpIHsKICAgICAgICBlYWNoSGFuZGxlcih0aGlzLmN1
        cnJlbnRIYW5kbGVySW5mb3MgfHwgW10sIGZ1bmN0aW9uKGhhbmRsZXJJbmZv
        KSB7CiAgICAgICAgICB2YXIgaGFuZGxlciA9IGhhbmRsZXJJbmZvLmhhbmRs
        ZXI7CiAgICAgICAgICBpZiAoaGFuZGxlci5leGl0KSB7CiAgICAgICAgICAg
        IGhhbmRsZXIuZXhpdCgpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAg
        ICAgIHRoaXMuY3VycmVudEhhbmRsZXJJbmZvcyA9IG51bGw7CiAgICAgICAg
        dGhpcy50YXJnZXRIYW5kbGVySW5mb3MgPSBudWxsOwogICAgICB9LAoKICAg
        ICAgYWN0aXZlVHJhbnNpdGlvbjogbnVsbCwKCiAgICAgIC8qKgogICAgICAg
        IHZhciBoYW5kbGVyID0gaGFuZGxlckluZm8uaGFuZGxlcjsKICAgICAgICBU
        aGUgZW50cnkgcG9pbnQgZm9yIGhhbmRsaW5nIGEgY2hhbmdlIHRvIHRoZSBV
        UkwgKHVzdWFsbHkKICAgICAgICB2aWEgdGhlIGJhY2sgYW5kIGZvcndhcmQg
        YnV0dG9uKS4KCiAgICAgICAgUmV0dXJucyBhbiBBcnJheSBvZiBoYW5kbGVy
        cyBhbmQgdGhlIHBhcmFtZXRlcnMgYXNzb2NpYXRlZAogICAgICAgIHdpdGgg
        dGhvc2UgcGFyYW1ldGVycy4KCiAgICAgICAgQHBhcmFtIHtTdHJpbmd9IHVy
        bCBhIFVSTCB0byBwcm9jZXNzCgogICAgICAgIEByZXR1cm4ge0FycmF5fSBh
        biBBcnJheSBvZiBgW2hhbmRsZXIsIHBhcmFtZXRlcl1gIHR1cGxlcwogICAg
        ICAqLwogICAgICBoYW5kbGVVUkw6IGZ1bmN0aW9uKHVybCkgewogICAgICAg
        IC8vIFBlcmZvcm0gYSBVUkwtYmFzZWQgdHJhbnNpdGlvbiwgYnV0IGRvbid0
        IGNoYW5nZQogICAgICAgIC8vIHRoZSBVUkwgYWZ0ZXJ3YXJkLCBzaW5jZSBp
        dCBhbHJlYWR5IGhhcHBlbmVkLgogICAgICAgIHZhciBhcmdzID0gc2xpY2Uu
        Y2FsbChhcmd1bWVudHMpOwogICAgICAgIGlmICh1cmwuY2hhckF0KDApICE9
        PSAnLycpIHsgYXJnc1swXSA9ICcvJyArIHVybDsgfQogICAgICAgIHJldHVy
        biBkb1RyYW5zaXRpb24odGhpcywgYXJncykubWV0aG9kKG51bGwpOwogICAg
        ICB9LAoKICAgICAgLyoqCiAgICAgICAgSG9vayBwb2ludCBmb3IgdXBkYXRp
        bmcgdGhlIFVSTC4KCiAgICAgICAgQHBhcmFtIHtTdHJpbmd9IHVybCBhIFVS
        TCB0byB1cGRhdGUgdG8KICAgICAgKi8KICAgICAgdXBkYXRlVVJMOiBmdW5j
        dGlvbigpIHsKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoInVwZGF0ZVVSTCBp
        cyBub3QgaW1wbGVtZW50ZWQiKTsKICAgICAgfSwKCiAgICAgIC8qKgogICAg
        ICAgIEhvb2sgcG9pbnQgZm9yIHJlcGxhY2luZyB0aGUgY3VycmVudCBVUkws
        IGkuZS4gd2l0aCByZXBsYWNlU3RhdGUKCiAgICAgICAgQnkgZGVmYXVsdCB0
        aGlzIGJlaGF2ZXMgdGhlIHNhbWUgYXMgYHVwZGF0ZVVSTGAKCiAgICAgICAg
        QHBhcmFtIHtTdHJpbmd9IHVybCBhIFVSTCB0byB1cGRhdGUgdG8KICAgICAg
        Ki8KICAgICAgcmVwbGFjZVVSTDogZnVuY3Rpb24odXJsKSB7CiAgICAgICAg
        dGhpcy51cGRhdGVVUkwodXJsKTsKICAgICAgfSwKCiAgICAgIC8qKgogICAg
        ICAgIFRyYW5zaXRpb24gaW50byB0aGUgc3BlY2lmaWVkIG5hbWVkIHJvdXRl
        LgoKICAgICAgICBJZiBuZWNlc3NhcnksIHRyaWdnZXIgdGhlIGV4aXQgY2Fs
        bGJhY2sgb24gYW55IGhhbmRsZXJzCiAgICAgICAgdGhhdCBhcmUgbm8gbG9u
        Z2VyIHJlcHJlc2VudGVkIGJ5IHRoZSB0YXJnZXQgcm91dGUuCgogICAgICAg
        IEBwYXJhbSB7U3RyaW5nfSBuYW1lIHRoZSBuYW1lIG9mIHRoZSByb3V0ZQog
        ICAgICAqLwogICAgICB0cmFuc2l0aW9uVG86IGZ1bmN0aW9uKG5hbWUpIHsK
        ICAgICAgICByZXR1cm4gZG9UcmFuc2l0aW9uKHRoaXMsIGFyZ3VtZW50cyk7
        CiAgICAgIH0sCgogICAgICAvKioKICAgICAgICBJZGVudGljYWwgdG8gYHRy
        YW5zaXRpb25Ub2AgZXhjZXB0IHRoYXQgdGhlIGN1cnJlbnQgVVJMIHdpbGwg
        YmUgcmVwbGFjZWQKICAgICAgICBpZiBwb3NzaWJsZS4KCiAgICAgICAgVGhp
        cyBtZXRob2QgaXMgaW50ZW5kZWQgcHJpbWFyaWx5IGZvciB1c2Ugd2l0aCBg
        cmVwbGFjZVN0YXRlYC4KCiAgICAgICAgQHBhcmFtIHtTdHJpbmd9IG5hbWUg
        dGhlIG5hbWUgb2YgdGhlIHJvdXRlCiAgICAgICovCiAgICAgIHJlcGxhY2VX
        aXRoOiBmdW5jdGlvbihuYW1lKSB7CiAgICAgICAgcmV0dXJuIGRvVHJhbnNp
        dGlvbih0aGlzLCBhcmd1bWVudHMpLm1ldGhvZCgncmVwbGFjZScpOwogICAg
        ICB9LAoKICAgICAgLyoqCiAgICAgICAgQHByaXZhdGUKCiAgICAgICAgVGhp
        cyBtZXRob2QgdGFrZXMgYSBoYW5kbGVyIG5hbWUgYW5kIGEgbGlzdCBvZiBj
        b250ZXh0cyBhbmQgcmV0dXJucwogICAgICAgIGEgc2VyaWFsaXplZCBwYXJh
        bWV0ZXIgaGFzaCBzdWl0YWJsZSB0byBwYXNzIHRvIGByZWNvZ25pemVyLmdl
        bmVyYXRlKClgLgoKICAgICAgICBAcGFyYW0ge1N0cmluZ30gaGFuZGxlck5h
        bWUKICAgICAgICBAcGFyYW0ge0FycmF5W09iamVjdF19IGNvbnRleHRzCiAg
        ICAgICAgQHJldHVybiB7T2JqZWN0fSBhIHNlcmlhbGl6ZWQgcGFyYW1ldGVy
        IGhhc2gKICAgICAgKi8KICAgICAgcGFyYW1zRm9ySGFuZGxlcjogZnVuY3Rp
        b24oaGFuZGxlck5hbWUsIGNvbnRleHRzKSB7CiAgICAgICAgcmV0dXJuIHBh
        cmFtc0ZvckhhbmRsZXIodGhpcywgaGFuZGxlck5hbWUsIHNsaWNlLmNhbGwo
        YXJndW1lbnRzLCAxKSk7CiAgICAgIH0sCgogICAgICAvKioKICAgICAgICBU
        YWtlIGEgbmFtZWQgcm91dGUgYW5kIGNvbnRleHQgb2JqZWN0cyBhbmQgZ2Vu
        ZXJhdGUgYQogICAgICAgIFVSTC4KCiAgICAgICAgQHBhcmFtIHtTdHJpbmd9
        IG5hbWUgdGhlIG5hbWUgb2YgdGhlIHJvdXRlIHRvIGdlbmVyYXRlCiAgICAg
        ICAgICBhIFVSTCBmb3IKICAgICAgICBAcGFyYW0gey4uLk9iamVjdH0gb2Jq
        ZWN0cyBhIGxpc3Qgb2Ygb2JqZWN0cyB0byBzZXJpYWxpemUKCiAgICAgICAg
        QHJldHVybiB7U3RyaW5nfSBhIFVSTAogICAgICAqLwogICAgICBnZW5lcmF0
        ZTogZnVuY3Rpb24oaGFuZGxlck5hbWUpIHsKICAgICAgICB2YXIgcGFyYW1z
        ID0gcGFyYW1zRm9ySGFuZGxlcih0aGlzLCBoYW5kbGVyTmFtZSwgc2xpY2Uu
        Y2FsbChhcmd1bWVudHMsIDEpKTsKICAgICAgICByZXR1cm4gdGhpcy5yZWNv
        Z25pemVyLmdlbmVyYXRlKGhhbmRsZXJOYW1lLCBwYXJhbXMpOwogICAgICB9
        LAoKICAgICAgaXNBY3RpdmU6IGZ1bmN0aW9uKGhhbmRsZXJOYW1lKSB7CiAg
        ICAgICAgdmFyIGNvbnRleHRzID0gc2xpY2UuY2FsbChhcmd1bWVudHMsIDEp
        OwoKICAgICAgICB2YXIgdGFyZ2V0SGFuZGxlckluZm9zID0gdGhpcy50YXJn
        ZXRIYW5kbGVySW5mb3MsCiAgICAgICAgICAgIGZvdW5kID0gZmFsc2UsIG5h
        bWVzLCBvYmplY3QsIGhhbmRsZXJJbmZvLCBoYW5kbGVyT2JqOwoKICAgICAg
        ICBpZiAoIXRhcmdldEhhbmRsZXJJbmZvcykgeyByZXR1cm4gZmFsc2U7IH0K
        CiAgICAgICAgdmFyIHJlY29nSGFuZGxlcnMgPSB0aGlzLnJlY29nbml6ZXIu
        aGFuZGxlcnNGb3IodGFyZ2V0SGFuZGxlckluZm9zW3RhcmdldEhhbmRsZXJJ
        bmZvcy5sZW5ndGggLSAxXS5uYW1lKTsKCiAgICAgICAgZm9yICh2YXIgaT10
        YXJnZXRIYW5kbGVySW5mb3MubGVuZ3RoLTE7IGk+PTA7IGktLSkgewogICAg
        ICAgICAgaGFuZGxlckluZm8gPSB0YXJnZXRIYW5kbGVySW5mb3NbaV07CiAg
        ICAgICAgICBpZiAoaGFuZGxlckluZm8ubmFtZSA9PT0gaGFuZGxlck5hbWUp
        IHsgZm91bmQgPSB0cnVlOyB9CgogICAgICAgICAgaWYgKGZvdW5kKSB7CiAg
        ICAgICAgICAgIGlmIChjb250ZXh0cy5sZW5ndGggPT09IDApIHsgYnJlYWs7
        IH0KCiAgICAgICAgICAgIGlmIChoYW5kbGVySW5mby5pc0R5bmFtaWMpIHsK
        ICAgICAgICAgICAgICBvYmplY3QgPSBjb250ZXh0cy5wb3AoKTsKCiAgICAg
        ICAgICAgICAgaWYgKGlzUGFyYW0ob2JqZWN0KSkgewogICAgICAgICAgICAg
        ICAgdmFyIHJlY29nSGFuZGxlciA9IHJlY29nSGFuZGxlcnNbaV0sIG5hbWUg
        PSByZWNvZ0hhbmRsZXIubmFtZXNbMF07CiAgICAgICAgICAgICAgICBpZiAo
        IiIgKyBvYmplY3QgIT09IHRoaXMuY3VycmVudFBhcmFtc1tuYW1lXSkgeyBy
        ZXR1cm4gZmFsc2U7IH0KICAgICAgICAgICAgICB9IGVsc2UgaWYgKGhhbmRs
        ZXJJbmZvLmNvbnRleHQgIT09IG9iamVjdCkgewogICAgICAgICAgICAgICAg
        cmV0dXJuIGZhbHNlOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQog
        ICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIGNvbnRleHRz
        Lmxlbmd0aCA9PT0gMCAmJiBmb3VuZDsKICAgICAgfSwKCiAgICAgIHRyaWdn
        ZXI6IGZ1bmN0aW9uKG5hbWUpIHsKICAgICAgICB2YXIgYXJncyA9IHNsaWNl
        LmNhbGwoYXJndW1lbnRzKTsKICAgICAgICB0cmlnZ2VyKHRoaXMsIHRoaXMu
        Y3VycmVudEhhbmRsZXJJbmZvcywgZmFsc2UsIGFyZ3MpOwogICAgICB9LAoK
        ICAgICAgLyoqCiAgICAgICAgSG9vayBwb2ludCBmb3IgbG9nZ2luZyB0cmFu
        c2l0aW9uIHN0YXR1cyB1cGRhdGVzLgoKICAgICAgICBAcGFyYW0ge1N0cmlu
        Z30gbWVzc2FnZSBUaGUgbWVzc2FnZSB0byBsb2cuCiAgICAgICovCiAgICAg
        IGxvZzogbnVsbAogICAgfTsKCiAgICAvKioKICAgICAgQHByaXZhdGUKCiAg
        ICAgIFVzZWQgaW50ZXJuYWxseSBmb3IgYm90aCBVUkwgYW5kIG5hbWVkIHRy
        YW5zaXRpb24gdG8gZGV0ZXJtaW5lCiAgICAgIGEgc2hhcmVkIHBpdm90IHBh
        cmVudCByb3V0ZSBhbmQgb3RoZXIgZGF0YSBuZWNlc3NhcnkgdG8gcGVyZm9y
        bQogICAgICBhIHRyYW5zaXRpb24uCiAgICAgKi8KICAgIGZ1bmN0aW9uIGdl
        dE1hdGNoUG9pbnQocm91dGVyLCBoYW5kbGVycywgb2JqZWN0cywgaW5wdXRQ
        YXJhbXMpIHsKCiAgICAgIHZhciBtYXRjaFBvaW50ID0gaGFuZGxlcnMubGVu
        Z3RoLAogICAgICAgICAgcHJvdmlkZWRNb2RlbHMgPSB7fSwgaSwKICAgICAg
        ICAgIGN1cnJlbnRIYW5kbGVySW5mb3MgPSByb3V0ZXIuY3VycmVudEhhbmRs
        ZXJJbmZvcyB8fCBbXSwKICAgICAgICAgIHBhcmFtcyA9IHt9LAogICAgICAg
        ICAgb2xkUGFyYW1zID0gcm91dGVyLmN1cnJlbnRQYXJhbXMgfHwge30sCiAg
        ICAgICAgICBhY3RpdmVUcmFuc2l0aW9uID0gcm91dGVyLmFjdGl2ZVRyYW5z
        aXRpb24sCiAgICAgICAgICBoYW5kbGVyUGFyYW1zID0ge30sCiAgICAgICAg
        ICBvYmo7CgogICAgICBvYmplY3RzID0gc2xpY2UuY2FsbChvYmplY3RzKTsK
        ICAgICAgbWVyZ2UocGFyYW1zLCBpbnB1dFBhcmFtcyk7CgogICAgICBmb3Ig
        KGkgPSBoYW5kbGVycy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkgewogICAg
        ICAgIHZhciBoYW5kbGVyT2JqID0gaGFuZGxlcnNbaV0sCiAgICAgICAgICAg
        IGhhbmRsZXJOYW1lID0gaGFuZGxlck9iai5oYW5kbGVyLAogICAgICAgICAg
        ICBvbGRIYW5kbGVySW5mbyA9IGN1cnJlbnRIYW5kbGVySW5mb3NbaV0sCiAg
        ICAgICAgICAgIGhhc0NoYW5nZWQgPSBmYWxzZTsKCiAgICAgICAgLy8gQ2hl
        Y2sgaWYgaGFuZGxlciBuYW1lcyBoYXZlIGNoYW5nZWQuCiAgICAgICAgaWYg
        KCFvbGRIYW5kbGVySW5mbyB8fCBvbGRIYW5kbGVySW5mby5uYW1lICE9PSBo
        YW5kbGVyT2JqLmhhbmRsZXIpIHsgaGFzQ2hhbmdlZCA9IHRydWU7IH0KCiAg
        ICAgICAgaWYgKGhhbmRsZXJPYmouaXNEeW5hbWljKSB7CiAgICAgICAgICAv
        LyBVUkwgdHJhbnNpdGlvbi4KCiAgICAgICAgICBpZiAob2JqID0gZ2V0TWF0
        Y2hQb2ludE9iamVjdChvYmplY3RzLCBoYW5kbGVyTmFtZSwgYWN0aXZlVHJh
        bnNpdGlvbiwgdHJ1ZSwgcGFyYW1zKSkgewogICAgICAgICAgICBoYXNDaGFu
        Z2VkID0gdHJ1ZTsKICAgICAgICAgICAgcHJvdmlkZWRNb2RlbHNbaGFuZGxl
        ck5hbWVdID0gb2JqOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAg
        aGFuZGxlclBhcmFtc1toYW5kbGVyTmFtZV0gPSB7fTsKICAgICAgICAgICAg
        Zm9yICh2YXIgcHJvcCBpbiBoYW5kbGVyT2JqLnBhcmFtcykgewogICAgICAg
        ICAgICAgIGlmICghaGFuZGxlck9iai5wYXJhbXMuaGFzT3duUHJvcGVydHko
        cHJvcCkpIHsgY29udGludWU7IH0KICAgICAgICAgICAgICB2YXIgbmV3UGFy
        YW0gPSBoYW5kbGVyT2JqLnBhcmFtc1twcm9wXTsKICAgICAgICAgICAgICBp
        ZiAob2xkUGFyYW1zW3Byb3BdICE9PSBuZXdQYXJhbSkgeyBoYXNDaGFuZ2Vk
        ID0gdHJ1ZTsgfQogICAgICAgICAgICAgIGhhbmRsZXJQYXJhbXNbaGFuZGxl
        ck5hbWVdW3Byb3BdID0gcGFyYW1zW3Byb3BdID0gbmV3UGFyYW07CiAgICAg
        ICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgaWYgKGhhbmRs
        ZXJPYmouaGFzT3duUHJvcGVydHkoJ25hbWVzJykpIHsKICAgICAgICAgIC8v
        IE5hbWVkIHRyYW5zaXRpb24uCgogICAgICAgICAgaWYgKG9iamVjdHMubGVu
        Z3RoKSB7IGhhc0NoYW5nZWQgPSB0cnVlOyB9CgogICAgICAgICAgaWYgKG9i
        aiA9IGdldE1hdGNoUG9pbnRPYmplY3Qob2JqZWN0cywgaGFuZGxlck5hbWUs
        IGFjdGl2ZVRyYW5zaXRpb24sIGhhbmRsZXJPYmoubmFtZXNbMF0sIHBhcmFt
        cykpIHsKICAgICAgICAgICAgcHJvdmlkZWRNb2RlbHNbaGFuZGxlck5hbWVd
        ID0gb2JqOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdmFyIG5h
        bWVzID0gaGFuZGxlck9iai5uYW1lczsKICAgICAgICAgICAgaGFuZGxlclBh
        cmFtc1toYW5kbGVyTmFtZV0gPSB7fTsKICAgICAgICAgICAgZm9yICh2YXIg
        aiA9IDAsIGxlbiA9IG5hbWVzLmxlbmd0aDsgaiA8IGxlbjsgKytqKSB7CiAg
        ICAgICAgICAgICAgdmFyIG5hbWUgPSBuYW1lc1tqXTsKICAgICAgICAgICAg
        ICBoYW5kbGVyUGFyYW1zW2hhbmRsZXJOYW1lXVtuYW1lXSA9IHBhcmFtc1tu
        YW1lXSA9IHBhcmFtc1tuYW1lXSB8fCBvbGRQYXJhbXNbbmFtZV07CiAgICAg
        ICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGlmICho
        YXNDaGFuZ2VkKSB7IG1hdGNoUG9pbnQgPSBpOyB9CiAgICAgIH0KCiAgICAg
        IGlmIChvYmplY3RzLmxlbmd0aCA+IDApIHsKICAgICAgICB0aHJvdyBuZXcg
        RXJyb3IoIk1vcmUgY29udGV4dCBvYmplY3RzIHdlcmUgcGFzc2VkIHRoYW4g
        dGhlcmUgYXJlIGR5bmFtaWMgc2VnbWVudHMgZm9yIHRoZSByb3V0ZTogIiAr
        IGhhbmRsZXJzW2hhbmRsZXJzLmxlbmd0aCAtIDFdLmhhbmRsZXIpOwogICAg
        ICB9CgogICAgICByZXR1cm4geyBtYXRjaFBvaW50OiBtYXRjaFBvaW50LCBw
        cm92aWRlZE1vZGVsczogcHJvdmlkZWRNb2RlbHMsIHBhcmFtczogcGFyYW1z
        LCBoYW5kbGVyUGFyYW1zOiBoYW5kbGVyUGFyYW1zIH07CiAgICB9CgogICAg
        ZnVuY3Rpb24gZ2V0TWF0Y2hQb2ludE9iamVjdChvYmplY3RzLCBoYW5kbGVy
        TmFtZSwgYWN0aXZlVHJhbnNpdGlvbiwgcGFyYW1OYW1lLCBwYXJhbXMpIHsK
        CiAgICAgIGlmIChvYmplY3RzLmxlbmd0aCAmJiBwYXJhbU5hbWUpIHsKCiAg
        ICAgICAgdmFyIG9iamVjdCA9IG9iamVjdHMucG9wKCk7CgogICAgICAgIC8v
        IElmIHByb3ZpZGVkIG9iamVjdCBpcyBzdHJpbmcgb3IgbnVtYmVyLCB0cmVh
        dCBhcyBwYXJhbS4KICAgICAgICBpZiAoaXNQYXJhbShvYmplY3QpKSB7CiAg
        ICAgICAgICBwYXJhbXNbcGFyYW1OYW1lXSA9IG9iamVjdC50b1N0cmluZygp
        OwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICByZXR1cm4gb2JqZWN0Owog
        ICAgICAgIH0KICAgICAgfSBlbHNlIGlmIChhY3RpdmVUcmFuc2l0aW9uKSB7
        CiAgICAgICAgLy8gVXNlIG1vZGVsIGZyb20gcHJldmlvdXMgdHJhbnNpdGlv
        biBhdHRlbXB0LCBwcmVmZXJhYmx5IHRoZSByZXNvbHZlZCBvbmUuCiAgICAg
        ICAgcmV0dXJuIGFjdGl2ZVRyYW5zaXRpb24ucmVzb2x2ZWRNb2RlbHNbaGFu
        ZGxlck5hbWVdIHx8CiAgICAgICAgICAgICAgIChwYXJhbU5hbWUgJiYgYWN0
        aXZlVHJhbnNpdGlvbi5wcm92aWRlZE1vZGVsc1toYW5kbGVyTmFtZV0pOwog
        ICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gaXNQYXJhbShvYmplY3QpIHsK
        ICAgICAgcmV0dXJuICh0eXBlb2Ygb2JqZWN0ID09PSAic3RyaW5nIiB8fCBv
        YmplY3QgaW5zdGFuY2VvZiBTdHJpbmcgfHwgIWlzTmFOKG9iamVjdCkpOwog
        ICAgfQoKICAgIC8qKgogICAgICBAcHJpdmF0ZQoKICAgICAgVGhpcyBtZXRo
        b2QgdGFrZXMgYSBoYW5kbGVyIG5hbWUgYW5kIGEgbGlzdCBvZiBjb250ZXh0
        cyBhbmQgcmV0dXJucwogICAgICBhIHNlcmlhbGl6ZWQgcGFyYW1ldGVyIGhh
        c2ggc3VpdGFibGUgdG8gcGFzcyB0byBgcmVjb2duaXplci5nZW5lcmF0ZSgp
        YC4KCiAgICAgIEBwYXJhbSB7Um91dGVyfSByb3V0ZXIKICAgICAgQHBhcmFt
        IHtTdHJpbmd9IGhhbmRsZXJOYW1lCiAgICAgIEBwYXJhbSB7QXJyYXlbT2Jq
        ZWN0XX0gb2JqZWN0cwogICAgICBAcmV0dXJuIHtPYmplY3R9IGEgc2VyaWFs
        aXplZCBwYXJhbWV0ZXIgaGFzaAogICAgKi8KICAgIGZ1bmN0aW9uIHBhcmFt
        c0ZvckhhbmRsZXIocm91dGVyLCBoYW5kbGVyTmFtZSwgb2JqZWN0cykgewoK
        ICAgICAgdmFyIGhhbmRsZXJzID0gcm91dGVyLnJlY29nbml6ZXIuaGFuZGxl
        cnNGb3IoaGFuZGxlck5hbWUpLAogICAgICAgICAgcGFyYW1zID0ge30sCiAg
        ICAgICAgICBtYXRjaFBvaW50ID0gZ2V0TWF0Y2hQb2ludChyb3V0ZXIsIGhh
        bmRsZXJzLCBvYmplY3RzKS5tYXRjaFBvaW50LAogICAgICAgICAgb2JqZWN0
        LCBoYW5kbGVyT2JqLCBoYW5kbGVyLCBuYW1lcywgaTsKCiAgICAgIGZvciAo
        aT0wOyBpPGhhbmRsZXJzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgaGFuZGxl
        ck9iaiA9IGhhbmRsZXJzW2ldOwogICAgICAgIGhhbmRsZXIgPSByb3V0ZXIu
        Z2V0SGFuZGxlcihoYW5kbGVyT2JqLmhhbmRsZXIpOwogICAgICAgIG5hbWVz
        ID0gaGFuZGxlck9iai5uYW1lczsKCiAgICAgICAgLy8gSWYgaXQncyBhIGR5
        bmFtaWMgc2VnbWVudAogICAgICAgIGlmIChuYW1lcy5sZW5ndGgpIHsKICAg
        ICAgICAgIC8vIElmIHdlIGhhdmUgb2JqZWN0cywgdXNlIHRoZW0KICAgICAg
        ICAgIGlmIChpID49IG1hdGNoUG9pbnQpIHsKICAgICAgICAgICAgb2JqZWN0
        ID0gb2JqZWN0cy5zaGlmdCgpOwogICAgICAgICAgLy8gT3RoZXJ3aXNlIHVz
        ZSBleGlzdGluZyBjb250ZXh0CiAgICAgICAgICB9IGVsc2UgewogICAgICAg
        ICAgICBvYmplY3QgPSBoYW5kbGVyLmNvbnRleHQ7CiAgICAgICAgICB9Cgog
        ICAgICAgICAgLy8gU2VyaWFsaXplIHRvIGdlbmVyYXRlIHBhcmFtcwogICAg
        ICAgICAgbWVyZ2UocGFyYW1zLCBzZXJpYWxpemUoaGFuZGxlciwgb2JqZWN0
        LCBuYW1lcykpOwogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gcGFy
        YW1zOwogICAgfQoKICAgIGZ1bmN0aW9uIG1lcmdlKGhhc2gsIG90aGVyKSB7
        CiAgICAgIGZvciAodmFyIHByb3AgaW4gb3RoZXIpIHsKICAgICAgICBpZiAo
        b3RoZXIuaGFzT3duUHJvcGVydHkocHJvcCkpIHsgaGFzaFtwcm9wXSA9IG90
        aGVyW3Byb3BdOyB9CiAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAgQHBy
        aXZhdGUKICAgICovCiAgICBmdW5jdGlvbiBjcmVhdGVOYW1lZFRyYW5zaXRp
        b24ocm91dGVyLCBhcmdzKSB7CiAgICAgIHZhciBoYW5kbGVycyA9IHJvdXRl
        ci5yZWNvZ25pemVyLmhhbmRsZXJzRm9yKGFyZ3NbMF0pOwoKICAgICAgbG9n
        KHJvdXRlciwgIkF0dGVtcHRpbmcgdHJhbnNpdGlvbiB0byAiICsgYXJnc1sw
        XSk7CgogICAgICByZXR1cm4gcGVyZm9ybVRyYW5zaXRpb24ocm91dGVyLCBo
        YW5kbGVycywgc2xpY2UuY2FsbChhcmdzLCAxKSwgcm91dGVyLmN1cnJlbnRQ
        YXJhbXMpOwogICAgfQoKICAgIC8qKgogICAgICBAcHJpdmF0ZQogICAgKi8K
        ICAgIGZ1bmN0aW9uIGNyZWF0ZVVSTFRyYW5zaXRpb24ocm91dGVyLCB1cmwp
        IHsKCiAgICAgIHZhciByZXN1bHRzID0gcm91dGVyLnJlY29nbml6ZXIucmVj
        b2duaXplKHVybCksCiAgICAgICAgICBjdXJyZW50SGFuZGxlckluZm9zID0g
        cm91dGVyLmN1cnJlbnRIYW5kbGVySW5mb3M7CgogICAgICBsb2cocm91dGVy
        LCAiQXR0ZW1wdGluZyBVUkwgdHJhbnNpdGlvbiB0byAiICsgdXJsKTsKCiAg
        ICAgIGlmICghcmVzdWx0cykgewogICAgICAgIHJldHVybiBlcnJvclRyYW5z
        aXRpb24ocm91dGVyLCBuZXcgUm91dGVyLlVucmVjb2duaXplZFVSTEVycm9y
        KHVybCkpOwogICAgICB9CgogICAgICByZXR1cm4gcGVyZm9ybVRyYW5zaXRp
        b24ocm91dGVyLCByZXN1bHRzLCBbXSwge30pOwogICAgfQoKCiAgICAvKioK
        ICAgICAgQHByaXZhdGUKCiAgICAgIFRha2VzIGFuIEFycmF5IG9mIGBIYW5k
        bGVySW5mb2BzLCBmaWd1cmVzIG91dCB3aGljaCBvbmVzIGFyZQogICAgICBl
        eGl0aW5nLCBlbnRlcmluZywgb3IgY2hhbmdpbmcgY29udGV4dHMsIGFuZCBj
        YWxscyB0aGUKICAgICAgcHJvcGVyIGhhbmRsZXIgaG9va3MuCgogICAgICBG
        b3IgZXhhbXBsZSwgY29uc2lkZXIgdGhlIGZvbGxvd2luZyB0cmVlIG9mIGhh
        bmRsZXJzLiBFYWNoIGhhbmRsZXIgaXMKICAgICAgZm9sbG93ZWQgYnkgdGhl
        IFVSTCBzZWdtZW50IGl0IGhhbmRsZXMuCgogICAgICBgYGAKICAgICAgfH5p
        bmRleCAoIi8iKQogICAgICB8IHx+cG9zdHMgKCIvcG9zdHMiKQogICAgICB8
        IHwgfC1zaG93UG9zdCAoIi86aWQiKQogICAgICB8IHwgfC1uZXdQb3N0ICgi
        L25ldyIpCiAgICAgIHwgfCB8LWVkaXRQb3N0ICgiL2VkaXQiKQogICAgICB8
        IHx+YWJvdXQgKCIvYWJvdXQvOmlkIikKICAgICAgYGBgCgogICAgICBDb25z
        aWRlciB0aGUgZm9sbG93aW5nIHRyYW5zaXRpb25zOgoKICAgICAgMS4gQSBV
        UkwgdHJhbnNpdGlvbiB0byBgL3Bvc3RzLzFgLgogICAgICAgICAxLiBUcmln
        Z2VycyB0aGUgYCptb2RlbGAgY2FsbGJhY2tzIG9uIHRoZQogICAgICAgICAg
        ICBgaW5kZXhgLCBgcG9zdHNgLCBhbmQgYHNob3dQb3N0YCBoYW5kbGVycwog
        ICAgICAgICAyLiBUcmlnZ2VycyB0aGUgYGVudGVyYCBjYWxsYmFjayBvbiB0
        aGUgc2FtZQogICAgICAgICAzLiBUcmlnZ2VycyB0aGUgYHNldHVwYCBjYWxs
        YmFjayBvbiB0aGUgc2FtZQogICAgICAyLiBBIGRpcmVjdCB0cmFuc2l0aW9u
        IHRvIGBuZXdQb3N0YAogICAgICAgICAxLiBUcmlnZ2VycyB0aGUgYGV4aXRg
        IGNhbGxiYWNrIG9uIGBzaG93UG9zdGAKICAgICAgICAgMi4gVHJpZ2dlcnMg
        dGhlIGBlbnRlcmAgY2FsbGJhY2sgb24gYG5ld1Bvc3RgCiAgICAgICAgIDMu
        IFRyaWdnZXJzIHRoZSBgc2V0dXBgIGNhbGxiYWNrIG9uIGBuZXdQb3N0YAog
        ICAgICAzLiBBIGRpcmVjdCB0cmFuc2l0aW9uIHRvIGBhYm91dGAgd2l0aCBh
        IHNwZWNpZmllZAogICAgICAgICBjb250ZXh0IG9iamVjdAogICAgICAgICAx
        LiBUcmlnZ2VycyB0aGUgYGV4aXRgIGNhbGxiYWNrIG9uIGBuZXdQb3N0YAog
        ICAgICAgICAgICBhbmQgYHBvc3RzYAogICAgICAgICAyLiBUcmlnZ2VycyB0
        aGUgYHNlcmlhbGl6ZWAgY2FsbGJhY2sgb24gYGFib3V0YAogICAgICAgICAz
        LiBUcmlnZ2VycyB0aGUgYGVudGVyYCBjYWxsYmFjayBvbiBgYWJvdXRgCiAg
        ICAgICAgIDQuIFRyaWdnZXJzIHRoZSBgc2V0dXBgIGNhbGxiYWNrIG9uIGBh
        Ym91dGAKCiAgICAgIEBwYXJhbSB7VHJhbnNpdGlvbn0gdHJhbnNpdGlvbgog
        ICAgICBAcGFyYW0ge0FycmF5W0hhbmRsZXJJbmZvXX0gaGFuZGxlckluZm9z
        CiAgICAqLwogICAgZnVuY3Rpb24gc2V0dXBDb250ZXh0cyh0cmFuc2l0aW9u
        LCBoYW5kbGVySW5mb3MpIHsKICAgICAgdmFyIHJvdXRlciA9IHRyYW5zaXRp
        b24ucm91dGVyLAogICAgICAgICAgcGFydGl0aW9uID0gcGFydGl0aW9uSGFu
        ZGxlcnMocm91dGVyLmN1cnJlbnRIYW5kbGVySW5mb3MgfHwgW10sIGhhbmRs
        ZXJJbmZvcyk7CgogICAgICByb3V0ZXIudGFyZ2V0SGFuZGxlckluZm9zID0g
        aGFuZGxlckluZm9zOwoKICAgICAgZWFjaEhhbmRsZXIocGFydGl0aW9uLmV4
        aXRlZCwgZnVuY3Rpb24oaGFuZGxlckluZm8pIHsKICAgICAgICB2YXIgaGFu
        ZGxlciA9IGhhbmRsZXJJbmZvLmhhbmRsZXI7CiAgICAgICAgZGVsZXRlIGhh
        bmRsZXIuY29udGV4dDsKICAgICAgICBpZiAoaGFuZGxlci5leGl0KSB7IGhh
        bmRsZXIuZXhpdCgpOyB9CiAgICAgIH0pOwoKICAgICAgdmFyIGN1cnJlbnRI
        YW5kbGVySW5mb3MgPSBwYXJ0aXRpb24udW5jaGFuZ2VkLnNsaWNlKCk7CiAg
        ICAgIHJvdXRlci5jdXJyZW50SGFuZGxlckluZm9zID0gY3VycmVudEhhbmRs
        ZXJJbmZvczsKCiAgICAgIGVhY2hIYW5kbGVyKHBhcnRpdGlvbi51cGRhdGVk
        Q29udGV4dCwgZnVuY3Rpb24oaGFuZGxlckluZm8pIHsKICAgICAgICBoYW5k
        bGVyRW50ZXJlZE9yVXBkYXRlZCh0cmFuc2l0aW9uLCBjdXJyZW50SGFuZGxl
        ckluZm9zLCBoYW5kbGVySW5mbywgZmFsc2UpOwogICAgICB9KTsKCiAgICAg
        IGVhY2hIYW5kbGVyKHBhcnRpdGlvbi5lbnRlcmVkLCBmdW5jdGlvbihoYW5k
        bGVySW5mbykgewogICAgICAgIGhhbmRsZXJFbnRlcmVkT3JVcGRhdGVkKHRy
        YW5zaXRpb24sIGN1cnJlbnRIYW5kbGVySW5mb3MsIGhhbmRsZXJJbmZvLCB0
        cnVlKTsKICAgICAgfSk7CiAgICB9CgogICAgLyoqCiAgICAgIEBwcml2YXRl
        CgogICAgICBIZWxwZXIgbWV0aG9kIHVzZWQgYnkgc2V0dXBDb250ZXh0cy4g
        SGFuZGxlcyBlcnJvcnMgb3IgcmVkaXJlY3RzCiAgICAgIHRoYXQgbWF5IGhh
        cHBlbiBpbiBlbnRlci9zZXR1cC4KICAgICovCiAgICBmdW5jdGlvbiBoYW5k
        bGVyRW50ZXJlZE9yVXBkYXRlZCh0cmFuc2l0aW9uLCBjdXJyZW50SGFuZGxl
        ckluZm9zLCBoYW5kbGVySW5mbywgZW50ZXIpIHsKICAgICAgdmFyIGhhbmRs
        ZXIgPSBoYW5kbGVySW5mby5oYW5kbGVyLAogICAgICAgICAgY29udGV4dCA9
        IGhhbmRsZXJJbmZvLmNvbnRleHQ7CgogICAgICB0cnkgewogICAgICAgIGlm
        IChlbnRlciAmJiBoYW5kbGVyLmVudGVyKSB7IGhhbmRsZXIuZW50ZXIoKTsg
        fQogICAgICAgIGNoZWNrQWJvcnQodHJhbnNpdGlvbik7CgogICAgICAgIHNl
        dENvbnRleHQoaGFuZGxlciwgY29udGV4dCk7CgogICAgICAgIGlmIChoYW5k
        bGVyLnNldHVwKSB7IGhhbmRsZXIuc2V0dXAoY29udGV4dCk7IH0KICAgICAg
        ICBjaGVja0Fib3J0KHRyYW5zaXRpb24pOwogICAgICB9IGNhdGNoKGUpIHsK
        ICAgICAgICBpZiAoIShlIGluc3RhbmNlb2YgUm91dGVyLlRyYW5zaXRpb25B
        Ym9ydGVkKSkgewogICAgICAgICAgLy8gVHJpZ2dlciB0aGUgYGVycm9yYCBl
        dmVudCBzdGFydGluZyBmcm9tIHRoaXMgZmFpbGVkIGhhbmRsZXIuCiAgICAg
        ICAgICB0cmlnZ2VyKHRyYW5zaXRpb24ucm91dGVyLCBjdXJyZW50SGFuZGxl
        ckluZm9zLmNvbmNhdChoYW5kbGVySW5mbyksIHRydWUsIFsnZXJyb3InLCBl
        LCB0cmFuc2l0aW9uXSk7CiAgICAgICAgfQoKICAgICAgICAvLyBQcm9wYWdh
        dGUgdGhlIGVycm9yIHNvIHRoYXQgdGhlIHRyYW5zaXRpb24gcHJvbWlzZSB3
        aWxsIHJlamVjdC4KICAgICAgICB0aHJvdyBlOwogICAgICB9CgogICAgICBj
        dXJyZW50SGFuZGxlckluZm9zLnB1c2goaGFuZGxlckluZm8pOwogICAgfQoK
        CiAgICAvKioKICAgICAgQHByaXZhdGUKCiAgICAgIEl0ZXJhdGVzIG92ZXIg
        YW4gYXJyYXkgb2YgYEhhbmRsZXJJbmZvYHMsIHBhc3NpbmcgdGhlIGhhbmRs
        ZXIKICAgICAgYW5kIGNvbnRleHQgaW50byB0aGUgY2FsbGJhY2suCgogICAg
        ICBAcGFyYW0ge0FycmF5W0hhbmRsZXJJbmZvXX0gaGFuZGxlckluZm9zCiAg
        ICAgIEBwYXJhbSB7RnVuY3Rpb24oT2JqZWN0LCBPYmplY3QpfSBjYWxsYmFj
        awogICAgKi8KICAgIGZ1bmN0aW9uIGVhY2hIYW5kbGVyKGhhbmRsZXJJbmZv
        cywgY2FsbGJhY2spIHsKICAgICAgZm9yICh2YXIgaT0wLCBsPWhhbmRsZXJJ
        bmZvcy5sZW5ndGg7IGk8bDsgaSsrKSB7CiAgICAgICAgY2FsbGJhY2soaGFu
        ZGxlckluZm9zW2ldKTsKICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICBA
        cHJpdmF0ZQoKICAgICAgVGhpcyBmdW5jdGlvbiBpcyBjYWxsZWQgd2hlbiB0
        cmFuc2l0aW9uaW5nIGZyb20gb25lIFVSTCB0bwogICAgICBhbm90aGVyIHRv
        IGRldGVybWluZSB3aGljaCBoYW5kbGVycyBhcmUgbm90IGxvbmdlciBhY3Rp
        dmUsCiAgICAgIHdoaWNoIGhhbmRsZXJzIGFyZSBuZXdseSBhY3RpdmUsIGFu
        ZCB3aGljaCBoYW5kbGVycyByZW1haW4KICAgICAgYWN0aXZlIGJ1dCBoYXZl
        IHRoZWlyIGNvbnRleHQgY2hhbmdlZC4KCiAgICAgIFRha2UgYSBsaXN0IG9m
        IG9sZCBoYW5kbGVycyBhbmQgbmV3IGhhbmRsZXJzIGFuZCBwYXJ0aXRpb24K
        ICAgICAgdGhlbSBpbnRvIGZvdXIgYnVja2V0czoKCiAgICAgICogdW5jaGFu
        Z2VkOiB0aGUgaGFuZGxlciB3YXMgYWN0aXZlIGluIGJvdGggdGhlIG9sZCBh
        bmQKICAgICAgICBuZXcgVVJMLCBhbmQgaXRzIGNvbnRleHQgcmVtYWlucyB0
        aGUgc2FtZQogICAgICAqIHVwZGF0ZWQgY29udGV4dDogdGhlIGhhbmRsZXIg
        d2FzIGFjdGl2ZSBpbiBib3RoIHRoZQogICAgICAgIG9sZCBhbmQgbmV3IFVS
        TCwgYnV0IGl0cyBjb250ZXh0IGNoYW5nZWQuIFRoZSBoYW5kbGVyJ3MKICAg
        ICAgICBgc2V0dXBgIG1ldGhvZCwgaWYgYW55LCB3aWxsIGJlIGNhbGxlZCB3
        aXRoIHRoZSBuZXcKICAgICAgICBjb250ZXh0LgogICAgICAqIGV4aXRlZDog
        dGhlIGhhbmRsZXIgd2FzIGFjdGl2ZSBpbiB0aGUgb2xkIFVSTCwgYnV0IGlz
        CiAgICAgICAgbm8gbG9uZ2VyIGFjdGl2ZS4KICAgICAgKiBlbnRlcmVkOiB0
        aGUgaGFuZGxlciB3YXMgbm90IGFjdGl2ZSBpbiB0aGUgb2xkIFVSTCwgYnV0
        CiAgICAgICAgaXMgbm93IGFjdGl2ZS4KCiAgICAgIFRoZSBQYXJ0aXRpb25l
        ZEhhbmRsZXJzIHN0cnVjdHVyZSBoYXMgZm91ciBmaWVsZHM6CgogICAgICAq
        IGB1cGRhdGVkQ29udGV4dGA6IGEgbGlzdCBvZiBgSGFuZGxlckluZm9gIG9i
        amVjdHMgdGhhdAogICAgICAgIHJlcHJlc2VudCBoYW5kbGVycyB0aGF0IHJl
        bWFpbiBhY3RpdmUgYnV0IGhhdmUgYSBjaGFuZ2VkCiAgICAgICAgY29udGV4
        dAogICAgICAqIGBlbnRlcmVkYDogYSBsaXN0IG9mIGBIYW5kbGVySW5mb2Ag
        b2JqZWN0cyB0aGF0IHJlcHJlc2VudAogICAgICAgIGhhbmRsZXJzIHRoYXQg
        YXJlIG5ld2x5IGFjdGl2ZQogICAgICAqIGBleGl0ZWRgOiBhIGxpc3Qgb2Yg
        YEhhbmRsZXJJbmZvYCBvYmplY3RzIHRoYXQgYXJlIG5vCiAgICAgICAgbG9u
        Z2VyIGFjdGl2ZS4KICAgICAgKiBgdW5jaGFuZ2VkYDogYSBsaXN0IG9mIGBI
        YW5kZXJJbmZvYCBvYmplY3RzIHRoYXQgcmVtYWluIGFjdGl2ZS4KCiAgICAg
        IEBwYXJhbSB7QXJyYXlbSGFuZGxlckluZm9dfSBvbGRIYW5kbGVycyBhIGxp
        c3Qgb2YgdGhlIGhhbmRsZXIKICAgICAgICBpbmZvcm1hdGlvbiBmb3IgdGhl
        IHByZXZpb3VzIFVSTCAob3IgYFtdYCBpZiB0aGlzIGlzIHRoZQogICAgICAg
        IGZpcnN0IGhhbmRsZWQgdHJhbnNpdGlvbikKICAgICAgQHBhcmFtIHtBcnJh
        eVtIYW5kbGVySW5mb119IG5ld0hhbmRsZXJzIGEgbGlzdCBvZiB0aGUgaGFu
        ZGxlcgogICAgICAgIGluZm9ybWF0aW9uIGZvciB0aGUgbmV3IFVSTAoKICAg
        ICAgQHJldHVybiB7UGFydGl0aW9ufQogICAgKi8KICAgIGZ1bmN0aW9uIHBh
        cnRpdGlvbkhhbmRsZXJzKG9sZEhhbmRsZXJzLCBuZXdIYW5kbGVycykgewog
        ICAgICB2YXIgaGFuZGxlcnMgPSB7CiAgICAgICAgICAgIHVwZGF0ZWRDb250
        ZXh0OiBbXSwKICAgICAgICAgICAgZXhpdGVkOiBbXSwKICAgICAgICAgICAg
        ZW50ZXJlZDogW10sCiAgICAgICAgICAgIHVuY2hhbmdlZDogW10KICAgICAg
        ICAgIH07CgogICAgICB2YXIgaGFuZGxlckNoYW5nZWQsIGNvbnRleHRDaGFu
        Z2VkLCBpLCBsOwoKICAgICAgZm9yIChpPTAsIGw9bmV3SGFuZGxlcnMubGVu
        Z3RoOyBpPGw7IGkrKykgewogICAgICAgIHZhciBvbGRIYW5kbGVyID0gb2xk
        SGFuZGxlcnNbaV0sIG5ld0hhbmRsZXIgPSBuZXdIYW5kbGVyc1tpXTsKCiAg
        ICAgICAgaWYgKCFvbGRIYW5kbGVyIHx8IG9sZEhhbmRsZXIuaGFuZGxlciAh
        PT0gbmV3SGFuZGxlci5oYW5kbGVyKSB7CiAgICAgICAgICBoYW5kbGVyQ2hh
        bmdlZCA9IHRydWU7CiAgICAgICAgfQoKICAgICAgICBpZiAoaGFuZGxlckNo
        YW5nZWQpIHsKICAgICAgICAgIGhhbmRsZXJzLmVudGVyZWQucHVzaChuZXdI
        YW5kbGVyKTsKICAgICAgICAgIGlmIChvbGRIYW5kbGVyKSB7IGhhbmRsZXJz
        LmV4aXRlZC51bnNoaWZ0KG9sZEhhbmRsZXIpOyB9CiAgICAgICAgfSBlbHNl
        IGlmIChjb250ZXh0Q2hhbmdlZCB8fCBvbGRIYW5kbGVyLmNvbnRleHQgIT09
        IG5ld0hhbmRsZXIuY29udGV4dCkgewogICAgICAgICAgY29udGV4dENoYW5n
        ZWQgPSB0cnVlOwogICAgICAgICAgaGFuZGxlcnMudXBkYXRlZENvbnRleHQu
        cHVzaChuZXdIYW5kbGVyKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAg
        aGFuZGxlcnMudW5jaGFuZ2VkLnB1c2gob2xkSGFuZGxlcik7CiAgICAgICAg
        fQogICAgICB9CgogICAgICBmb3IgKGk9bmV3SGFuZGxlcnMubGVuZ3RoLCBs
        PW9sZEhhbmRsZXJzLmxlbmd0aDsgaTxsOyBpKyspIHsKICAgICAgICBoYW5k
        bGVycy5leGl0ZWQudW5zaGlmdChvbGRIYW5kbGVyc1tpXSk7CiAgICAgIH0K
        CiAgICAgIHJldHVybiBoYW5kbGVyczsKICAgIH0KCiAgICBmdW5jdGlvbiB0
        cmlnZ2VyKHJvdXRlciwgaGFuZGxlckluZm9zLCBpZ25vcmVGYWlsdXJlLCBh
        cmdzKSB7CiAgICAgIGlmIChyb3V0ZXIudHJpZ2dlckV2ZW50KSB7CiAgICAg
        ICAgcm91dGVyLnRyaWdnZXJFdmVudChoYW5kbGVySW5mb3MsIGlnbm9yZUZh
        aWx1cmUsIGFyZ3MpOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAg
        dmFyIG5hbWUgPSBhcmdzLnNoaWZ0KCk7CgogICAgICBpZiAoIWhhbmRsZXJJ
        bmZvcykgewogICAgICAgIGlmIChpZ25vcmVGYWlsdXJlKSB7IHJldHVybjsg
        fQogICAgICAgIHRocm93IG5ldyBFcnJvcigiQ291bGQgbm90IHRyaWdnZXIg
        ZXZlbnQgJyIgKyBuYW1lICsgIicuIFRoZXJlIGFyZSBubyBhY3RpdmUgaGFu
        ZGxlcnMiKTsKICAgICAgfQoKICAgICAgdmFyIGV2ZW50V2FzSGFuZGxlZCA9
        IGZhbHNlOwoKICAgICAgZm9yICh2YXIgaT1oYW5kbGVySW5mb3MubGVuZ3Ro
        LTE7IGk+PTA7IGktLSkgewogICAgICAgIHZhciBoYW5kbGVySW5mbyA9IGhh
        bmRsZXJJbmZvc1tpXSwKICAgICAgICAgICAgaGFuZGxlciA9IGhhbmRsZXJJ
        bmZvLmhhbmRsZXI7CgogICAgICAgIGlmIChoYW5kbGVyLmV2ZW50cyAmJiBo
        YW5kbGVyLmV2ZW50c1tuYW1lXSkgewogICAgICAgICAgaWYgKGhhbmRsZXIu
        ZXZlbnRzW25hbWVdLmFwcGx5KGhhbmRsZXIsIGFyZ3MpID09PSB0cnVlKSB7
        CiAgICAgICAgICAgIGV2ZW50V2FzSGFuZGxlZCA9IHRydWU7CiAgICAgICAg
        ICB9IGVsc2UgewogICAgICAgICAgICByZXR1cm47CiAgICAgICAgICB9CiAg
        ICAgICAgfQogICAgICB9CgogICAgICBpZiAoIWV2ZW50V2FzSGFuZGxlZCAm
        JiAhaWdub3JlRmFpbHVyZSkgewogICAgICAgIHRocm93IG5ldyBFcnJvcigi
        Tm90aGluZyBoYW5kbGVkIHRoZSBldmVudCAnIiArIG5hbWUgKyAiJy4iKTsK
        ICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIHNldENvbnRleHQoaGFuZGxl
        ciwgY29udGV4dCkgewogICAgICBoYW5kbGVyLmNvbnRleHQgPSBjb250ZXh0
        OwogICAgICBpZiAoaGFuZGxlci5jb250ZXh0RGlkQ2hhbmdlKSB7IGhhbmRs
        ZXIuY29udGV4dERpZENoYW5nZSgpOyB9CiAgICB9CgogICAgLyoqCiAgICAg
        IEBwcml2YXRlCgogICAgICBDcmVhdGVzLCBiZWdpbnMsIGFuZCByZXR1cm5z
        IGEgVHJhbnNpdGlvbi4KICAgICAqLwogICAgZnVuY3Rpb24gcGVyZm9ybVRy
        YW5zaXRpb24ocm91dGVyLCByZWNvZ0hhbmRsZXJzLCBwcm92aWRlZE1vZGVs
        c0FycmF5LCBwYXJhbXMsIGRhdGEpIHsKCiAgICAgIHZhciBtYXRjaFBvaW50
        UmVzdWx0cyA9IGdldE1hdGNoUG9pbnQocm91dGVyLCByZWNvZ0hhbmRsZXJz
        LCBwcm92aWRlZE1vZGVsc0FycmF5LCBwYXJhbXMpLAogICAgICAgICAgdGFy
        Z2V0TmFtZSA9IHJlY29nSGFuZGxlcnNbcmVjb2dIYW5kbGVycy5sZW5ndGgg
        LSAxXS5oYW5kbGVyLAogICAgICAgICAgd2FzVHJhbnNpdGlvbmluZyA9IGZh
        bHNlLAogICAgICAgICAgY3VycmVudEhhbmRsZXJJbmZvcyA9IHJvdXRlci5j
        dXJyZW50SGFuZGxlckluZm9zOwoKICAgICAgLy8gQ2hlY2sgaWYgdGhlcmUn
        cyBhbHJlYWR5IGEgdHJhbnNpdGlvbiB1bmRlcndheS4KICAgICAgaWYgKHJv
        dXRlci5hY3RpdmVUcmFuc2l0aW9uKSB7CiAgICAgICAgaWYgKHRyYW5zaXRp
        b25zSWRlbnRpY2FsKHJvdXRlci5hY3RpdmVUcmFuc2l0aW9uLCB0YXJnZXRO
        YW1lLCBwcm92aWRlZE1vZGVsc0FycmF5KSkgewogICAgICAgICAgcmV0dXJu
        IHJvdXRlci5hY3RpdmVUcmFuc2l0aW9uOwogICAgICAgIH0KICAgICAgICBy
        b3V0ZXIuYWN0aXZlVHJhbnNpdGlvbi5hYm9ydCgpOwogICAgICAgIHdhc1Ry
        YW5zaXRpb25pbmcgPSB0cnVlOwogICAgICB9CgogICAgICB2YXIgZGVmZXJy
        ZWQgPSBSU1ZQLmRlZmVyKCksCiAgICAgICAgICB0cmFuc2l0aW9uID0gbmV3
        IFRyYW5zaXRpb24ocm91dGVyLCBkZWZlcnJlZC5wcm9taXNlKTsKCiAgICAg
        IHRyYW5zaXRpb24udGFyZ2V0TmFtZSA9IHRhcmdldE5hbWU7CiAgICAgIHRy
        YW5zaXRpb24ucHJvdmlkZWRNb2RlbHMgPSBtYXRjaFBvaW50UmVzdWx0cy5w
        cm92aWRlZE1vZGVsczsKICAgICAgdHJhbnNpdGlvbi5wcm92aWRlZE1vZGVs
        c0FycmF5ID0gcHJvdmlkZWRNb2RlbHNBcnJheTsKICAgICAgdHJhbnNpdGlv
        bi5wYXJhbXMgPSBtYXRjaFBvaW50UmVzdWx0cy5wYXJhbXM7CiAgICAgIHRy
        YW5zaXRpb24uZGF0YSA9IGRhdGEgfHwge307CiAgICAgIHJvdXRlci5hY3Rp
        dmVUcmFuc2l0aW9uID0gdHJhbnNpdGlvbjsKCiAgICAgIHZhciBoYW5kbGVy
        SW5mb3MgPSBnZW5lcmF0ZUhhbmRsZXJJbmZvcyhyb3V0ZXIsIHJlY29nSGFu
        ZGxlcnMpOwoKICAgICAgLy8gRmlyZSAnd2lsbFRyYW5zaXRpb24nIGV2ZW50
        IG9uIGN1cnJlbnQgaGFuZGxlcnMsIGJ1dCBkb24ndCBmaXJlIGl0CiAgICAg
        IC8vIGlmIGEgdHJhbnNpdGlvbiB3YXMgYWxyZWFkeSB1bmRlcndheS4KICAg
        ICAgaWYgKCF3YXNUcmFuc2l0aW9uaW5nKSB7CiAgICAgICAgdHJpZ2dlcihy
        b3V0ZXIsIGN1cnJlbnRIYW5kbGVySW5mb3MsIHRydWUsIFsnd2lsbFRyYW5z
        aXRpb24nLCB0cmFuc2l0aW9uXSk7CiAgICAgIH0KCiAgICAgIGxvZyhyb3V0
        ZXIsIHRyYW5zaXRpb24uc2VxdWVuY2UsICJCZWdpbm5pbmcgdmFsaWRhdGlv
        biBmb3IgdHJhbnNpdGlvbiB0byAiICsgdHJhbnNpdGlvbi50YXJnZXROYW1l
        KTsKICAgICAgdmFsaWRhdGVFbnRyeSh0cmFuc2l0aW9uLCBoYW5kbGVySW5m
        b3MsIDAsIG1hdGNoUG9pbnRSZXN1bHRzLm1hdGNoUG9pbnQsIG1hdGNoUG9p
        bnRSZXN1bHRzLmhhbmRsZXJQYXJhbXMpCiAgICAgICAgICAgICAgICAgICAu
        dGhlbih0cmFuc2l0aW9uU3VjY2VzcywgdHJhbnNpdGlvbkZhaWx1cmUpOwoK
        ICAgICAgcmV0dXJuIHRyYW5zaXRpb247CgogICAgICBmdW5jdGlvbiB0cmFu
        c2l0aW9uU3VjY2VzcygpIHsKICAgICAgICBjaGVja0Fib3J0KHRyYW5zaXRp
        b24pOwoKICAgICAgICB0cnkgewogICAgICAgICAgbG9nKHJvdXRlciwgdHJh
        bnNpdGlvbi5zZXF1ZW5jZSwgIlZhbGlkYXRpb24gc3VjY2VlZGVkLCBmaW5h
        bGl6aW5nIHRyYW5zaXRpb247Iik7CgogICAgICAgICAgLy8gRG9uJ3Qgb3Zl
        cndyaXRlIGNvbnRleHRzIC8gdXBkYXRlIFVSTCBpZiB0aGlzIHdhcyBhIG5v
        b3AgdHJhbnNpdGlvbi4KICAgICAgICAgIGlmICghY3VycmVudEhhbmRsZXJJ
        bmZvcyB8fCAhY3VycmVudEhhbmRsZXJJbmZvcy5sZW5ndGggfHwKICAgICAg
        ICAgICAgICAhcm91dGVyLnJlY29nbml6ZXIuaGFzUm91dGUoY3VycmVudEhh
        bmRsZXJJbmZvc1tjdXJyZW50SGFuZGxlckluZm9zLmxlbmd0aCAtIDFdLm5h
        bWUpIHx8CiAgICAgICAgICAgICAgY3VycmVudEhhbmRsZXJJbmZvcy5sZW5n
        dGggIT09IG1hdGNoUG9pbnRSZXN1bHRzLm1hdGNoUG9pbnQpIHsKICAgICAg
        ICAgICAgZmluYWxpemVUcmFuc2l0aW9uKHRyYW5zaXRpb24sIGhhbmRsZXJJ
        bmZvcyk7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKHJvdXRlci5kaWRU
        cmFuc2l0aW9uKSB7CiAgICAgICAgICAgIHJvdXRlci5kaWRUcmFuc2l0aW9u
        KGhhbmRsZXJJbmZvcyk7CiAgICAgICAgICB9CgogICAgICAgICAgbG9nKHJv
        dXRlciwgdHJhbnNpdGlvbi5zZXF1ZW5jZSwgIlRSQU5TSVRJT04gQ09NUExF
        VEUuIik7CgogICAgICAgICAgLy8gUmVzb2x2ZSB3aXRoIHRoZSBmaW5hbCBo
        YW5kbGVyLgogICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShoYW5kbGVySW5m
        b3NbaGFuZGxlckluZm9zLmxlbmd0aCAtIDFdLmhhbmRsZXIpOwogICAgICAg
        IH0gY2F0Y2goZSkgewogICAgICAgICAgZGVmZXJyZWQucmVqZWN0KGUpOwog
        ICAgICAgIH0KCiAgICAgICAgLy8gRG9uJ3QgbnVsbGlmeSBpZiBhbm90aGVy
        IHRyYW5zaXRpb24gaXMgdW5kZXJ3YXkgKG1lYW5pbmcKICAgICAgICAvLyB0
        aGVyZSB3YXMgYSB0cmFuc2l0aW9uIGluaXRpYXRlZCB3aXRoIGVudGVyL3Nl
        dHVwKS4KICAgICAgICBpZiAoIXRyYW5zaXRpb24uaXNBYm9ydGVkKSB7CiAg
        ICAgICAgICByb3V0ZXIuYWN0aXZlVHJhbnNpdGlvbiA9IG51bGw7CiAgICAg
        ICAgfQogICAgICB9CgogICAgICBmdW5jdGlvbiB0cmFuc2l0aW9uRmFpbHVy
        ZShyZWFzb24pIHsKICAgICAgICBkZWZlcnJlZC5yZWplY3QocmVhc29uKTsK
        ICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICBAcHJpdmF0ZQoKICAgICAg
        QWNjZXB0cyBoYW5kbGVycyBpbiBSZWNvZ25pemVyIGZvcm1hdCwgZWl0aGVy
        IHJldHVybmVkIGZyb20KICAgICAgcmVjb2duaXplKCkgb3IgaGFuZGxlcnNG
        b3IoKSwgYW5kIHJldHVybnMgdW5pZmllZAogICAgICBgSGFuZGxlckluZm9g
        cy4KICAgICAqLwogICAgZnVuY3Rpb24gZ2VuZXJhdGVIYW5kbGVySW5mb3Mo
        cm91dGVyLCByZWNvZ0hhbmRsZXJzKSB7CiAgICAgIHZhciBoYW5kbGVySW5m
        b3MgPSBbXTsKICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IHJlY29nSGFu
        ZGxlcnMubGVuZ3RoOyBpIDwgbGVuOyArK2kpIHsKICAgICAgICB2YXIgaGFu
        ZGxlck9iaiA9IHJlY29nSGFuZGxlcnNbaV0sCiAgICAgICAgICAgIGlzRHlu
        YW1pYyA9IGhhbmRsZXJPYmouaXNEeW5hbWljIHx8IChoYW5kbGVyT2JqLm5h
        bWVzICYmIGhhbmRsZXJPYmoubmFtZXMubGVuZ3RoKTsKCiAgICAgICAgaGFu
        ZGxlckluZm9zLnB1c2goewogICAgICAgICAgaXNEeW5hbWljOiAhIWlzRHlu
        YW1pYywKICAgICAgICAgIG5hbWU6IGhhbmRsZXJPYmouaGFuZGxlciwKICAg
        ICAgICAgIGhhbmRsZXI6IHJvdXRlci5nZXRIYW5kbGVyKGhhbmRsZXJPYmou
        aGFuZGxlcikKICAgICAgICB9KTsKICAgICAgfQogICAgICByZXR1cm4gaGFu
        ZGxlckluZm9zOwogICAgfQoKICAgIC8qKgogICAgICBAcHJpdmF0ZQogICAg
        ICovCiAgICBmdW5jdGlvbiB0cmFuc2l0aW9uc0lkZW50aWNhbChvbGRUcmFu
        c2l0aW9uLCB0YXJnZXROYW1lLCBwcm92aWRlZE1vZGVsc0FycmF5KSB7Cgog
        ICAgICBpZiAob2xkVHJhbnNpdGlvbi50YXJnZXROYW1lICE9PSB0YXJnZXRO
        YW1lKSB7IHJldHVybiBmYWxzZTsgfQoKICAgICAgdmFyIG9sZE1vZGVscyA9
        IG9sZFRyYW5zaXRpb24ucHJvdmlkZWRNb2RlbHNBcnJheTsKICAgICAgaWYg
        KG9sZE1vZGVscy5sZW5ndGggIT09IHByb3ZpZGVkTW9kZWxzQXJyYXkubGVu
        Z3RoKSB7IHJldHVybiBmYWxzZTsgfQoKICAgICAgZm9yICh2YXIgaSA9IDAs
        IGxlbiA9IG9sZE1vZGVscy5sZW5ndGg7IGkgPCBsZW47ICsraSkgewogICAg
        ICAgIGlmIChvbGRNb2RlbHNbaV0gIT09IHByb3ZpZGVkTW9kZWxzQXJyYXlb
        aV0pIHsgcmV0dXJuIGZhbHNlOyB9CiAgICAgIH0KICAgICAgcmV0dXJuIHRy
        dWU7CiAgICB9CgogICAgLyoqCiAgICAgIEBwcml2YXRlCgogICAgICBVcGRh
        dGVzIHRoZSBVUkwgKGlmIG5lY2Vzc2FyeSkgYW5kIGNhbGxzIGBzZXR1cENv
        bnRleHRzYAogICAgICB0byB1cGRhdGUgdGhlIHJvdXRlcidzIGFycmF5IG9m
        IGBjdXJyZW50SGFuZGxlckluZm9zYC4KICAgICAqLwogICAgZnVuY3Rpb24g
        ZmluYWxpemVUcmFuc2l0aW9uKHRyYW5zaXRpb24sIGhhbmRsZXJJbmZvcykg
        ewoKICAgICAgdmFyIHJvdXRlciA9IHRyYW5zaXRpb24ucm91dGVyLAogICAg
        ICAgICAgc2VxID0gdHJhbnNpdGlvbi5zZXF1ZW5jZSwKICAgICAgICAgIGhh
        bmRsZXJOYW1lID0gaGFuZGxlckluZm9zW2hhbmRsZXJJbmZvcy5sZW5ndGgg
        LSAxXS5uYW1lOwoKICAgICAgLy8gQ29sbGVjdCBwYXJhbXMgZm9yIFVSTC4K
        ICAgICAgdmFyIG9iamVjdHMgPSBbXSwgcHJvdmlkZWRNb2RlbHMgPSB0cmFu
        c2l0aW9uLnByb3ZpZGVkTW9kZWxzQXJyYXkuc2xpY2UoKTsKICAgICAgZm9y
        ICh2YXIgaSA9IGhhbmRsZXJJbmZvcy5sZW5ndGggLSAxOyBpPj0wOyAtLWkp
        IHsKICAgICAgICB2YXIgaGFuZGxlckluZm8gPSBoYW5kbGVySW5mb3NbaV07
        CiAgICAgICAgaWYgKGhhbmRsZXJJbmZvLmlzRHluYW1pYykgewogICAgICAg
        ICAgdmFyIHByb3ZpZGVkTW9kZWwgPSBwcm92aWRlZE1vZGVscy5wb3AoKTsK
        ICAgICAgICAgIG9iamVjdHMudW5zaGlmdChpc1BhcmFtKHByb3ZpZGVkTW9k
        ZWwpID8gcHJvdmlkZWRNb2RlbC50b1N0cmluZygpIDogaGFuZGxlckluZm8u
        Y29udGV4dCk7CiAgICAgICAgfQogICAgICB9CgogICAgICB2YXIgcGFyYW1z
        ID0gcGFyYW1zRm9ySGFuZGxlcihyb3V0ZXIsIGhhbmRsZXJOYW1lLCBvYmpl
        Y3RzKTsKCiAgICAgIHJvdXRlci5jdXJyZW50UGFyYW1zID0gcGFyYW1zOwoK
        ICAgICAgdmFyIHVybE1ldGhvZCA9IHRyYW5zaXRpb24udXJsTWV0aG9kOwog
        ICAgICBpZiAodXJsTWV0aG9kKSB7CiAgICAgICAgdmFyIHVybCA9IHJvdXRl
        ci5yZWNvZ25pemVyLmdlbmVyYXRlKGhhbmRsZXJOYW1lLCBwYXJhbXMpOwoK
        ICAgICAgICBpZiAodXJsTWV0aG9kID09PSAncmVwbGFjZScpIHsKICAgICAg
        ICAgIHJvdXRlci5yZXBsYWNlVVJMKHVybCk7CiAgICAgICAgfSBlbHNlIHsK
        ICAgICAgICAgIC8vIEFzc3VtZSBldmVyeXRoaW5nIGVsc2UgaXMganVzdCBh
        IFVSTCB1cGRhdGUgZm9yIG5vdy4KICAgICAgICAgIHJvdXRlci51cGRhdGVV
        UkwodXJsKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHNldHVwQ29udGV4
        dHModHJhbnNpdGlvbiwgaGFuZGxlckluZm9zKTsKICAgIH0KCiAgICAvKioK
        ICAgICAgQHByaXZhdGUKCiAgICAgIEludGVybmFsIGZ1bmN0aW9uIHVzZWQg
        dG8gY29uc3RydWN0IHRoZSBjaGFpbiBvZiBwcm9taXNlcyB1c2VkCiAgICAg
        IHRvIHZhbGlkYXRlIGEgdHJhbnNpdGlvbi4gV3JhcHMgY2FsbHMgdG8gYGJl
        Zm9yZU1vZGVsYCwgYG1vZGVsYCwKICAgICAgYW5kIGBhZnRlck1vZGVsYCBp
        biBwcm9taXNlcywgYW5kIGNoZWNrcyBmb3IgcmVkaXJlY3RzL2Fib3J0cwog
        ICAgICBiZXR3ZWVuIGVhY2guCiAgICAgKi8KICAgIGZ1bmN0aW9uIHZhbGlk
        YXRlRW50cnkodHJhbnNpdGlvbiwgaGFuZGxlckluZm9zLCBpbmRleCwgbWF0
        Y2hQb2ludCwgaGFuZGxlclBhcmFtcykgewoKICAgICAgaWYgKGluZGV4ID09
        PSBoYW5kbGVySW5mb3MubGVuZ3RoKSB7CiAgICAgICAgLy8gTm8gbW9yZSBj
        b250ZXh0cyB0byByZXNvbHZlLgogICAgICAgIHJldHVybiBSU1ZQLnJlc29s
        dmUodHJhbnNpdGlvbi5yZXNvbHZlZE1vZGVscyk7CiAgICAgIH0KCiAgICAg
        IHZhciByb3V0ZXIgPSB0cmFuc2l0aW9uLnJvdXRlciwKICAgICAgICAgIGhh
        bmRsZXJJbmZvID0gaGFuZGxlckluZm9zW2luZGV4XSwKICAgICAgICAgIGhh
        bmRsZXIgPSBoYW5kbGVySW5mby5oYW5kbGVyLAogICAgICAgICAgaGFuZGxl
        ck5hbWUgPSBoYW5kbGVySW5mby5uYW1lLAogICAgICAgICAgc2VxID0gdHJh
        bnNpdGlvbi5zZXF1ZW5jZTsKCiAgICAgIGlmIChpbmRleCA8IG1hdGNoUG9p
        bnQpIHsKICAgICAgICBsb2cocm91dGVyLCBzZXEsIGhhbmRsZXJOYW1lICsg
        IjogdXNpbmcgY29udGV4dCBmcm9tIGFscmVhZHktYWN0aXZlIGhhbmRsZXIi
        KTsKCiAgICAgICAgLy8gV2UncmUgYmVmb3JlIHRoZSBtYXRjaCBwb2ludCwg
        c28gZG9uJ3QgcnVuIGFueSBob29rcywKICAgICAgICAvLyBqdXN0IHVzZSB0
        aGUgYWxyZWFkeSByZXNvbHZlZCBjb250ZXh0IGZyb20gdGhlIGhhbmRsZXIu
        CiAgICAgICAgdHJhbnNpdGlvbi5yZXNvbHZlZE1vZGVsc1toYW5kbGVySW5m
        by5uYW1lXSA9CiAgICAgICAgICB0cmFuc2l0aW9uLnByb3ZpZGVkTW9kZWxz
        W2hhbmRsZXJJbmZvLm5hbWVdIHx8CiAgICAgICAgICBoYW5kbGVySW5mby5o
        YW5kbGVyLmNvbnRleHQ7CiAgICAgICAgcmV0dXJuIHByb2NlZWQoKTsKICAg
        ICAgfQoKICAgICAgcmV0dXJuIFJTVlAucmVzb2x2ZSgpLnRoZW4oaGFuZGxl
        QWJvcnQpCiAgICAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGJlZm9y
        ZU1vZGVsKQogICAgICAgICAgICAgICAgICAgICAgICAgICAudGhlbihoYW5k
        bGVBYm9ydCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4obW9k
        ZWwpCiAgICAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGhhbmRsZUFi
        b3J0KQogICAgICAgICAgICAgICAgICAgICAgICAgICAudGhlbihhZnRlck1v
        ZGVsKQogICAgICAgICAgICAgICAgICAgICAgICAgICAudGhlbihoYW5kbGVB
        Ym9ydCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4obnVsbCwg
        aGFuZGxlRXJyb3IpCiAgICAgICAgICAgICAgICAgICAgICAgICAgIC50aGVu
        KHByb2NlZWQpOwoKICAgICAgZnVuY3Rpb24gaGFuZGxlQWJvcnQocmVzdWx0
        KSB7CiAgICAgICAgaWYgKHRyYW5zaXRpb24uaXNBYm9ydGVkKSB7CiAgICAg
        ICAgICBsb2codHJhbnNpdGlvbi5yb3V0ZXIsIHRyYW5zaXRpb24uc2VxdWVu
        Y2UsICJkZXRlY3RlZCBhYm9ydC4iKTsKICAgICAgICAgIHJldHVybiBSU1ZQ
        LnJlamVjdChuZXcgUm91dGVyLlRyYW5zaXRpb25BYm9ydGVkKCkpOwogICAg
        ICAgIH0KCiAgICAgICAgcmV0dXJuIHJlc3VsdDsKICAgICAgfQoKICAgICAg
        ZnVuY3Rpb24gaGFuZGxlRXJyb3IocmVhc29uKSB7CiAgICAgICAgaWYgKHJl
        YXNvbiBpbnN0YW5jZW9mIFJvdXRlci5UcmFuc2l0aW9uQWJvcnRlZCkgewog
        ICAgICAgICAgLy8gaWYgdGhlIHRyYW5zaXRpb24gd2FzIGFib3J0ZWQgYW5k
        ICpubyBhZGRpdGlvbmFsKiBlcnJvciB3YXMgdGhyb3duLAogICAgICAgICAg
        Ly8gcmVqZWN0IHdpdGggdGhlIFJvdXRlci5UcmFuc2l0aW9uQWJvcnRlZCBp
        bnN0YW5jZQogICAgICAgICAgcmV0dXJuIFJTVlAucmVqZWN0KHJlYXNvbik7
        CiAgICAgICAgfQoKICAgICAgICAvLyBvdGhlcndpc2UsIHdlJ3JlIGhlcmUg
        YmVjYXVzZSBvZiBhIGRpZmZlcmVudCBlcnJvcgogICAgICAgIHRyYW5zaXRp
        b24uYWJvcnQoKTsKCiAgICAgICAgbG9nKHJvdXRlciwgc2VxLCBoYW5kbGVy
        TmFtZSArICI6IGhhbmRsaW5nIGVycm9yOiAiICsgcmVhc29uKTsKCiAgICAg
        ICAgLy8gQW4gZXJyb3Igd2FzIHRocm93biAvIHByb21pc2UgcmVqZWN0ZWQs
        IHNvIGZpcmUgYW4KICAgICAgICAvLyBgZXJyb3JgIGV2ZW50IGZyb20gdGhp
        cyBoYW5kbGVyIGluZm8gdXAgdG8gcm9vdC4KICAgICAgICB0cmlnZ2VyKHJv
        dXRlciwgaGFuZGxlckluZm9zLnNsaWNlKDAsIGluZGV4ICsgMSksIHRydWUs
        IFsnZXJyb3InLCByZWFzb24sIHRyYW5zaXRpb25dKTsKCiAgICAgICAgLy8g
        UHJvcGFnYXRlIHRoZSBvcmlnaW5hbCBlcnJvci4KICAgICAgICByZXR1cm4g
        UlNWUC5yZWplY3QocmVhc29uKTsKICAgICAgfQoKICAgICAgZnVuY3Rpb24g
        YmVmb3JlTW9kZWwoKSB7CgogICAgICAgIGxvZyhyb3V0ZXIsIHNlcSwgaGFu
        ZGxlck5hbWUgKyAiOiBjYWxsaW5nIGJlZm9yZU1vZGVsIGhvb2siKTsKCiAg
        ICAgICAgdmFyIHAgPSBoYW5kbGVyLmJlZm9yZU1vZGVsICYmIGhhbmRsZXIu
        YmVmb3JlTW9kZWwodHJhbnNpdGlvbik7CiAgICAgICAgcmV0dXJuIChwIGlu
        c3RhbmNlb2YgVHJhbnNpdGlvbikgPyBudWxsIDogcDsKICAgICAgfQoKICAg
        ICAgZnVuY3Rpb24gbW9kZWwoKSB7CiAgICAgICAgbG9nKHJvdXRlciwgc2Vx
        LCBoYW5kbGVyTmFtZSArICI6IHJlc29sdmluZyBtb2RlbCIpOwoKICAgICAg
        ICB2YXIgcCA9IGdldE1vZGVsKGhhbmRsZXJJbmZvLCB0cmFuc2l0aW9uLCBo
        YW5kbGVyUGFyYW1zW2hhbmRsZXJOYW1lXSwgaW5kZXggPj0gbWF0Y2hQb2lu
        dCk7CiAgICAgICAgcmV0dXJuIChwIGluc3RhbmNlb2YgVHJhbnNpdGlvbikg
        PyBudWxsIDogcDsKICAgICAgfQoKICAgICAgZnVuY3Rpb24gYWZ0ZXJNb2Rl
        bChjb250ZXh0KSB7CgogICAgICAgIGxvZyhyb3V0ZXIsIHNlcSwgaGFuZGxl
        ck5hbWUgKyAiOiBjYWxsaW5nIGFmdGVyTW9kZWwgaG9vayIpOwoKICAgICAg
        ICAvLyBQYXNzIHRoZSBjb250ZXh0IGFuZCByZXNvbHZlZCBwYXJlbnQgY29u
        dGV4dHMgdG8gYWZ0ZXJNb2RlbCwgYnV0IHdlIGRvbid0CiAgICAgICAgLy8g
        d2FudCB0byB1c2UgdGhlIHZhbHVlIHJldHVybmVkIGZyb20gYGFmdGVyTW9k
        ZWxgIGluIGFueSB3YXksIGJ1dCByYXRoZXIKICAgICAgICAvLyBhbHdheXMg
        cmVzb2x2ZSB3aXRoIHRoZSBvcmlnaW5hbCBgY29udGV4dGAgb2JqZWN0LgoK
        ICAgICAgICB0cmFuc2l0aW9uLnJlc29sdmVkTW9kZWxzW2hhbmRsZXJJbmZv
        Lm5hbWVdID0gY29udGV4dDsKCiAgICAgICAgdmFyIHAgPSBoYW5kbGVyLmFm
        dGVyTW9kZWwgJiYgaGFuZGxlci5hZnRlck1vZGVsKGNvbnRleHQsIHRyYW5z
        aXRpb24pOwogICAgICAgIHJldHVybiAocCBpbnN0YW5jZW9mIFRyYW5zaXRp
        b24pID8gbnVsbCA6IHA7CiAgICAgIH0KCiAgICAgIGZ1bmN0aW9uIHByb2Nl
        ZWQoKSB7CiAgICAgICAgbG9nKHJvdXRlciwgc2VxLCBoYW5kbGVyTmFtZSAr
        ICI6IHZhbGlkYXRpb24gc3VjY2VlZGVkLCBwcm9jZWVkaW5nIik7CgogICAg
        ICAgIGhhbmRsZXJJbmZvLmNvbnRleHQgPSB0cmFuc2l0aW9uLnJlc29sdmVk
        TW9kZWxzW2hhbmRsZXJJbmZvLm5hbWVdOwogICAgICAgIHJldHVybiB2YWxp
        ZGF0ZUVudHJ5KHRyYW5zaXRpb24sIGhhbmRsZXJJbmZvcywgaW5kZXggKyAx
        LCBtYXRjaFBvaW50LCBoYW5kbGVyUGFyYW1zKTsKICAgICAgfQogICAgfQoK
        ICAgIC8qKgogICAgICBAcHJpdmF0ZQoKICAgICAgVGhyb3dzIGEgVHJhbnNp
        dGlvbkFib3J0ZWQgaWYgdGhlIHByb3ZpZGVkIHRyYW5zaXRpb24gaGFzIGJl
        ZW4gYWJvcnRlZC4KICAgICAqLwogICAgZnVuY3Rpb24gY2hlY2tBYm9ydCh0
        cmFuc2l0aW9uKSB7CiAgICAgIGlmICh0cmFuc2l0aW9uLmlzQWJvcnRlZCkg
        ewogICAgICAgIGxvZyh0cmFuc2l0aW9uLnJvdXRlciwgdHJhbnNpdGlvbi5z
        ZXF1ZW5jZSwgImRldGVjdGVkIGFib3J0LiIpOwogICAgICAgIHRocm93IG5l
        dyBSb3V0ZXIuVHJhbnNpdGlvbkFib3J0ZWQoKTsKICAgICAgfQogICAgfQoK
        ICAgIC8qKgogICAgICBAcHJpdmF0ZQoKICAgICAgRW5jYXBzdWxhdGVzIHRo
        ZSBsb2dpYyBmb3Igd2hldGhlciB0byBjYWxsIGBtb2RlbGAgb24gYSByb3V0
        ZSwKICAgICAgb3IgdXNlIG9uZSBvZiB0aGUgbW9kZWxzIHByb3ZpZGVkIHRv
        IGB0cmFuc2l0aW9uVG9gLgogICAgICovCiAgICBmdW5jdGlvbiBnZXRNb2Rl
        bChoYW5kbGVySW5mbywgdHJhbnNpdGlvbiwgaGFuZGxlclBhcmFtcywgbmVl
        ZHNVcGRhdGUpIHsKCiAgICAgIHZhciBoYW5kbGVyID0gaGFuZGxlckluZm8u
        aGFuZGxlciwKICAgICAgICAgIGhhbmRsZXJOYW1lID0gaGFuZGxlckluZm8u
        bmFtZTsKCiAgICAgIGlmICghbmVlZHNVcGRhdGUgJiYgaGFuZGxlci5oYXNP
        d25Qcm9wZXJ0eSgnY29udGV4dCcpKSB7CiAgICAgICAgcmV0dXJuIGhhbmRs
        ZXIuY29udGV4dDsKICAgICAgfQoKICAgICAgaWYgKHRyYW5zaXRpb24ucHJv
        dmlkZWRNb2RlbHMuaGFzT3duUHJvcGVydHkoaGFuZGxlck5hbWUpKSB7CiAg
        ICAgICAgdmFyIHByb3ZpZGVkTW9kZWwgPSB0cmFuc2l0aW9uLnByb3ZpZGVk
        TW9kZWxzW2hhbmRsZXJOYW1lXTsKICAgICAgICByZXR1cm4gdHlwZW9mIHBy
        b3ZpZGVkTW9kZWwgPT09ICdmdW5jdGlvbicgPyBwcm92aWRlZE1vZGVsKCkg
        OiBwcm92aWRlZE1vZGVsOwogICAgICB9CgogICAgICByZXR1cm4gaGFuZGxl
        ci5tb2RlbCAmJiBoYW5kbGVyLm1vZGVsKGhhbmRsZXJQYXJhbXMgfHwge30s
        IHRyYW5zaXRpb24pOwogICAgfQoKICAgIC8qKgogICAgICBAcHJpdmF0ZQog
        ICAgICovCiAgICBmdW5jdGlvbiBsb2cocm91dGVyLCBzZXF1ZW5jZSwgbXNn
        KSB7CgogICAgICBpZiAoIXJvdXRlci5sb2cpIHsgcmV0dXJuOyB9CgogICAg
        ICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMykgewogICAgICAgIHJvdXRl
        ci5sb2coIlRyYW5zaXRpb24gIyIgKyBzZXF1ZW5jZSArICI6ICIgKyBtc2cp
        OwogICAgICB9IGVsc2UgewogICAgICAgIG1zZyA9IHNlcXVlbmNlOwogICAg
        ICAgIHJvdXRlci5sb2cobXNnKTsKICAgICAgfQogICAgfQoKICAgIC8qKgog
        ICAgICBAcHJpdmF0ZQoKICAgICAgQmVnaW5zIGFuZCByZXR1cm5zIGEgVHJh
        bnNpdGlvbiBiYXNlZCBvbiB0aGUgcHJvdmlkZWQKICAgICAgYXJndW1lbnRz
        LiBBY2NlcHRzIGFyZ3VtZW50cyBpbiB0aGUgZm9ybSBvZiBib3RoIFVSTAog
        ICAgICB0cmFuc2l0aW9ucyBhbmQgbmFtZWQgdHJhbnNpdGlvbnMuCgogICAg
        ICBAcGFyYW0ge1JvdXRlcn0gcm91dGVyCiAgICAgIEBwYXJhbSB7QXJyYXlb
        T2JqZWN0XX0gYXJncyBhcmd1bWVudHMgcGFzc2VkIHRvIHRyYW5zaXRpb25U
        bywKICAgICAgICByZXBsYWNlV2l0aCwgb3IgaGFuZGxlVVJMCiAgICAqLwog
        ICAgZnVuY3Rpb24gZG9UcmFuc2l0aW9uKHJvdXRlciwgYXJncykgewogICAg
        ICAvLyBOb3JtYWxpemUgYmxhbmsgdHJhbnNpdGlvbnMgdG8gcm9vdCBVUkwg
        dHJhbnNpdGlvbnMuCiAgICAgIHZhciBuYW1lID0gYXJnc1swXSB8fCAnLyc7
        CgogICAgICBpZiAobmFtZS5jaGFyQXQoMCkgPT09ICcvJykgewogICAgICAg
        IHJldHVybiBjcmVhdGVVUkxUcmFuc2l0aW9uKHJvdXRlciwgbmFtZSk7CiAg
        ICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIGNyZWF0ZU5hbWVkVHJhbnNp
        dGlvbihyb3V0ZXIsIGFyZ3MpOwogICAgICB9CiAgICB9CgogICAgLyoqCiAg
        ICAgIEBwcml2YXRlCgogICAgICBTZXJpYWxpemVzIGEgaGFuZGxlciB1c2lu
        ZyBpdHMgY3VzdG9tIGBzZXJpYWxpemVgIG1ldGhvZCBvcgogICAgICBieSBh
        IGRlZmF1bHQgdGhhdCBsb29rcyB1cCB0aGUgZXhwZWN0ZWQgcHJvcGVydHkg
        bmFtZSBmcm9tCiAgICAgIHRoZSBkeW5hbWljIHNlZ21lbnQuCgogICAgICBA
        cGFyYW0ge09iamVjdH0gaGFuZGxlciBhIHJvdXRlciBoYW5kbGVyCiAgICAg
        IEBwYXJhbSB7T2JqZWN0fSBtb2RlbCB0aGUgbW9kZWwgdG8gYmUgc2VyaWFs
        aXplZCBmb3IgdGhpcyBoYW5kbGVyCiAgICAgIEBwYXJhbSB7QXJyYXlbT2Jq
        ZWN0XX0gbmFtZXMgdGhlIG5hbWVzIGFycmF5IGF0dGFjaGVkIHRvIGFuCiAg
        ICAgICAgaGFuZGxlciBvYmplY3QgcmV0dXJuZWQgZnJvbSByb3V0ZXIucmVj
        b2duaXplci5oYW5kbGVyc0ZvcigpCiAgICAqLwogICAgZnVuY3Rpb24gc2Vy
        aWFsaXplKGhhbmRsZXIsIG1vZGVsLCBuYW1lcykgewoKICAgICAgdmFyIG9i
        amVjdCA9IHt9OwogICAgICBpZiAoaXNQYXJhbShtb2RlbCkpIHsKICAgICAg
        ICBvYmplY3RbbmFtZXNbMF1dID0gbW9kZWw7CiAgICAgICAgcmV0dXJuIG9i
        amVjdDsKICAgICAgfQoKICAgICAgLy8gVXNlIGN1c3RvbSBzZXJpYWxpemUg
        aWYgaXQgZXhpc3RzLgogICAgICBpZiAoaGFuZGxlci5zZXJpYWxpemUpIHsK
        ICAgICAgICByZXR1cm4gaGFuZGxlci5zZXJpYWxpemUobW9kZWwsIG5hbWVz
        KTsKICAgICAgfQoKICAgICAgaWYgKG5hbWVzLmxlbmd0aCAhPT0gMSkgeyBy
        ZXR1cm47IH0KCiAgICAgIHZhciBuYW1lID0gbmFtZXNbMF07CgogICAgICBp
        ZiAoL19pZCQvLnRlc3QobmFtZSkpIHsKICAgICAgICBvYmplY3RbbmFtZV0g
        PSBtb2RlbC5pZDsKICAgICAgfSBlbHNlIHsKICAgICAgICBvYmplY3RbbmFt
        ZV0gPSBtb2RlbDsKICAgICAgfQogICAgICByZXR1cm4gb2JqZWN0OwogICAg
        fQoKCiAgICByZXR1cm4gUm91dGVyOwogIH0pOwoKfSkoKTsKCgoKKGZ1bmN0
        aW9uKCkgewovKioKQG1vZHVsZSBlbWJlcgpAc3VibW9kdWxlIGVtYmVyLXJv
        dXRpbmcKKi8KCmZ1bmN0aW9uIERTTChuYW1lKSB7CiAgdGhpcy5wYXJlbnQg
        PSBuYW1lOwogIHRoaXMubWF0Y2hlcyA9IFtdOwp9CgpEU0wucHJvdG90eXBl
        ID0gewogIHJlc291cmNlOiBmdW5jdGlvbihuYW1lLCBvcHRpb25zLCBjYWxs
        YmFjaykgewogICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDIgJiYgdHlw
        ZW9mIG9wdGlvbnMgPT09ICdmdW5jdGlvbicpIHsKICAgICAgY2FsbGJhY2sg
        PSBvcHRpb25zOwogICAgICBvcHRpb25zID0ge307CiAgICB9CgogICAgaWYg
        KGFyZ3VtZW50cy5sZW5ndGggPT09IDEpIHsKICAgICAgb3B0aW9ucyA9IHt9
        OwogICAgfQoKICAgIGlmICh0eXBlb2Ygb3B0aW9ucy5wYXRoICE9PSAnc3Ry
        aW5nJykgewogICAgICBvcHRpb25zLnBhdGggPSAiLyIgKyBuYW1lOwogICAg
        fQoKICAgIGlmIChjYWxsYmFjaykgewogICAgICB2YXIgZHNsID0gbmV3IERT
        TChuYW1lKTsKICAgICAgY2FsbGJhY2suY2FsbChkc2wpOwogICAgICB0aGlz
        LnB1c2gob3B0aW9ucy5wYXRoLCBuYW1lLCBkc2wuZ2VuZXJhdGUoKSk7CiAg
        ICB9IGVsc2UgewogICAgICB0aGlzLnB1c2gob3B0aW9ucy5wYXRoLCBuYW1l
        KTsKICAgIH0KICB9LAoKICBwdXNoOiBmdW5jdGlvbih1cmwsIG5hbWUsIGNh
        bGxiYWNrKSB7CiAgICB2YXIgcGFydHMgPSBuYW1lLnNwbGl0KCcuJyk7CiAg
        ICBpZiAodXJsID09PSAiIiB8fCB1cmwgPT09ICIvIiB8fCBwYXJ0c1twYXJ0
        cy5sZW5ndGgtMV0gPT09ICJpbmRleCIpIHsgdGhpcy5leHBsaWNpdEluZGV4
        ID0gdHJ1ZTsgfQoKICAgIHRoaXMubWF0Y2hlcy5wdXNoKFt1cmwsIG5hbWUs
        IGNhbGxiYWNrXSk7CiAgfSwKCiAgcm91dGU6IGZ1bmN0aW9uKG5hbWUsIG9w
        dGlvbnMpIHsKICAgIEVtYmVyLmFzc2VydCgiWW91IG11c3QgdXNlIGB0aGlz
        LnJlc291cmNlYCB0byBuZXN0IiwgdHlwZW9mIG9wdGlvbnMgIT09ICdmdW5j
        dGlvbicpOwoKICAgIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9OwoKICAgIGlm
        ICh0eXBlb2Ygb3B0aW9ucy5wYXRoICE9PSAnc3RyaW5nJykgewogICAgICBv
        cHRpb25zLnBhdGggPSAiLyIgKyBuYW1lOwogICAgfQoKICAgIGlmICh0aGlz
        LnBhcmVudCAmJiB0aGlzLnBhcmVudCAhPT0gJ2FwcGxpY2F0aW9uJykgewog
        ICAgICBuYW1lID0gdGhpcy5wYXJlbnQgKyAiLiIgKyBuYW1lOwogICAgfQoK
        ICAgIHRoaXMucHVzaChvcHRpb25zLnBhdGgsIG5hbWUpOwogIH0sCgogIGdl
        bmVyYXRlOiBmdW5jdGlvbigpIHsKICAgIHZhciBkc2xNYXRjaGVzID0gdGhp
        cy5tYXRjaGVzOwoKICAgIGlmICghdGhpcy5leHBsaWNpdEluZGV4KSB7CiAg
        ICAgIHRoaXMucm91dGUoImluZGV4IiwgeyBwYXRoOiAiLyIgfSk7CiAgICB9
        CgogICAgcmV0dXJuIGZ1bmN0aW9uKG1hdGNoKSB7CiAgICAgIGZvciAodmFy
        IGk9MCwgbD1kc2xNYXRjaGVzLmxlbmd0aDsgaTxsOyBpKyspIHsKICAgICAg
        ICB2YXIgZHNsTWF0Y2ggPSBkc2xNYXRjaGVzW2ldOwogICAgICAgIG1hdGNo
        KGRzbE1hdGNoWzBdKS50byhkc2xNYXRjaFsxXSwgZHNsTWF0Y2hbMl0pOwog
        ICAgICB9CiAgICB9OwogIH0KfTsKCkRTTC5tYXAgPSBmdW5jdGlvbihjYWxs
        YmFjaykgewogIHZhciBkc2wgPSBuZXcgRFNMKCk7CiAgY2FsbGJhY2suY2Fs
        bChkc2wpOwogIHJldHVybiBkc2w7Cn07CgpFbWJlci5Sb3V0ZXJEU0wgPSBE
        U0w7Cgp9KSgpOwoKCgooZnVuY3Rpb24oKSB7CnZhciBnZXQgPSBFbWJlci5n
        ZXQ7CgovKioKQG1vZHVsZSBlbWJlcgpAc3VibW9kdWxlIGVtYmVyLXJvdXRp
        bmcKKi8KCi8qKgogIAogIEZpbmRzIGEgY29udHJvbGxlciBpbnN0YW5jZS4K
        CiAgQGZvciBFbWJlcgogIEBtZXRob2QgY29udHJvbGxlckZvcgogIEBwcml2
        YXRlCiovCkVtYmVyLmNvbnRyb2xsZXJGb3IgPSBmdW5jdGlvbihjb250YWlu
        ZXIsIGNvbnRyb2xsZXJOYW1lLCBsb29rdXBPcHRpb25zKSB7CiAgcmV0dXJu
        IGNvbnRhaW5lci5sb29rdXAoJ2NvbnRyb2xsZXI6JyArIGNvbnRyb2xsZXJO
        YW1lLCBsb29rdXBPcHRpb25zKTsKfTsKCi8qKgogIEdlbmVyYXRlcyBhIGNv
        bnRyb2xsZXIgYXV0b21hdGljYWxseSBpZiBub25lIHdhcyBwcm92aWRlZC4K
        ICBUaGUgdHlwZSBvZiBnZW5lcmF0ZWQgY29udHJvbGxlciBkZXBlbmRzIG9u
        IHRoZSBjb250ZXh0LgogIFlvdSBjYW4gY3VzdG9taXplIHlvdXIgZ2VuZXJh
        dGVkIGNvbnRyb2xsZXJzIGJ5IGRlZmluaW5nCiAgYEFwcC5PYmplY3RDb250
        cm9sbGVyYCBhbmQgYEFwcC5BcnJheUNvbnRyb2xsZXJgCiAgCiAgQGZvciBF
        bWJlcgogIEBtZXRob2QgZ2VuZXJhdGVDb250cm9sbGVyCiAgQHByaXZhdGUK
        Ki8KRW1iZXIuZ2VuZXJhdGVDb250cm9sbGVyID0gZnVuY3Rpb24oY29udGFp
        bmVyLCBjb250cm9sbGVyTmFtZSwgY29udGV4dCkgewogIHZhciBDb250cm9s
        bGVyRmFjdG9yeSwgZnVsbE5hbWUsIGluc3RhbmNlLCBuYW1lLCBmYWN0b3J5
        TmFtZSwgY29udHJvbGxlclR5cGU7CgogIGlmIChjb250ZXh0ICYmIEVtYmVy
        LmlzQXJyYXkoY29udGV4dCkpIHsKICAgIGNvbnRyb2xsZXJUeXBlID0gJ2Fy
        cmF5JzsKICB9IGVsc2UgaWYgKGNvbnRleHQpIHsKICAgIGNvbnRyb2xsZXJU
        eXBlID0gJ29iamVjdCc7CiAgfSBlbHNlIHsKICAgIGNvbnRyb2xsZXJUeXBl
        ID0gJ2Jhc2ljJzsKICB9CgogIGZhY3RvcnlOYW1lID0gJ2NvbnRyb2xsZXI6
        JyArIGNvbnRyb2xsZXJUeXBlOwoKICBDb250cm9sbGVyRmFjdG9yeSA9IGNv
        bnRhaW5lci5sb29rdXBGYWN0b3J5KGZhY3RvcnlOYW1lKS5leHRlbmQoewog
        ICAgaXNHZW5lcmF0ZWQ6IHRydWUsCiAgICB0b1N0cmluZzogZnVuY3Rpb24o
        KSB7CiAgICAgIHJldHVybiAiKGdlbmVyYXRlZCAiICsgY29udHJvbGxlck5h
        bWUgKyAiIGNvbnRyb2xsZXIpIjsKICAgIH0KICB9KTsKCiAgZnVsbE5hbWUg
        PSAnY29udHJvbGxlcjonICsgY29udHJvbGxlck5hbWU7CgogIGNvbnRhaW5l
        ci5yZWdpc3RlcihmdWxsTmFtZSwgQ29udHJvbGxlckZhY3RvcnkpOwoKICBp
        bnN0YW5jZSA9IGNvbnRhaW5lci5sb29rdXAoZnVsbE5hbWUpOwoKICBpZiAo
        Z2V0KGluc3RhbmNlLCAnbmFtZXNwYWNlLkxPR19BQ1RJVkVfR0VORVJBVElP
        TicpKSB7CiAgICBFbWJlci5Mb2dnZXIuaW5mbygiZ2VuZXJhdGVkIC0+ICIg
        KyBmdWxsTmFtZSwgeyBmdWxsTmFtZTogZnVsbE5hbWUgfSk7CiAgfQoKICBy
        ZXR1cm4gaW5zdGFuY2U7Cn07Cgp9KSgpOwoKCgooZnVuY3Rpb24oKSB7Ci8q
        KgpAbW9kdWxlIGVtYmVyCkBzdWJtb2R1bGUgZW1iZXItcm91dGluZwoqLwoK
        dmFyIFJvdXRlciA9IHJlcXVpcmVNb2R1bGUoInJvdXRlciIpOwp2YXIgZ2V0
        ID0gRW1iZXIuZ2V0LCBzZXQgPSBFbWJlci5zZXQ7CnZhciBkZWZpbmVQcm9w
        ZXJ0eSA9IEVtYmVyLmRlZmluZVByb3BlcnR5OwoKdmFyIERlZmF1bHRWaWV3
        ID0gRW1iZXIuX01ldGFtb3JwaFZpZXc7Ci8qKgogIFRoZSBgRW1iZXIuUm91
        dGVyYCBjbGFzcyBtYW5hZ2VzIHRoZSBhcHBsaWNhdGlvbiBzdGF0ZSBhbmQg
        VVJMcy4gUmVmZXIgdG8KICB0aGUgW3JvdXRpbmcgZ3VpZGVdKGh0dHA6Ly9l
        bWJlcmpzLmNvbS9ndWlkZXMvcm91dGluZy8pIGZvciBkb2N1bWVudGF0aW9u
        LgoKICBAY2xhc3MgUm91dGVyCiAgQG5hbWVzcGFjZSBFbWJlcgogIEBleHRl
        bmRzIEVtYmVyLk9iamVjdAoqLwpFbWJlci5Sb3V0ZXIgPSBFbWJlci5PYmpl
        Y3QuZXh0ZW5kKHsKICBsb2NhdGlvbjogJ2hhc2gnLAoKICBpbml0OiBmdW5j
        dGlvbigpIHsKICAgIHRoaXMucm91dGVyID0gdGhpcy5jb25zdHJ1Y3Rvci5y
        b3V0ZXIgfHwgdGhpcy5jb25zdHJ1Y3Rvci5tYXAoRW1iZXIuSyk7CiAgICB0
        aGlzLl9hY3RpdmVWaWV3cyA9IHt9OwogICAgdGhpcy5fc2V0dXBMb2NhdGlv
        bigpOwogIH0sCgogIHVybDogRW1iZXIuY29tcHV0ZWQoZnVuY3Rpb24oKSB7
        CiAgICByZXR1cm4gZ2V0KHRoaXMsICdsb2NhdGlvbicpLmdldFVSTCgpOwog
        IH0pLAoKICBzdGFydFJvdXRpbmc6IGZ1bmN0aW9uKCkgewogICAgdGhpcy5y
        b3V0ZXIgPSB0aGlzLnJvdXRlciB8fCB0aGlzLmNvbnN0cnVjdG9yLm1hcChF
        bWJlci5LKTsKCiAgICB2YXIgcm91dGVyID0gdGhpcy5yb3V0ZXIsCiAgICAg
        ICAgbG9jYXRpb24gPSBnZXQodGhpcywgJ2xvY2F0aW9uJyksCiAgICAgICAg
        Y29udGFpbmVyID0gdGhpcy5jb250YWluZXIsCiAgICAgICAgc2VsZiA9IHRo
        aXM7CgogICAgdGhpcy5fc2V0dXBSb3V0ZXIocm91dGVyLCBsb2NhdGlvbik7
        CgogICAgY29udGFpbmVyLnJlZ2lzdGVyKCd2aWV3OmRlZmF1bHQnLCBEZWZh
        dWx0Vmlldyk7CiAgICBjb250YWluZXIucmVnaXN0ZXIoJ3ZpZXc6dG9wbGV2
        ZWwnLCBFbWJlci5WaWV3LmV4dGVuZCgpKTsKCiAgICBsb2NhdGlvbi5vblVw
        ZGF0ZVVSTChmdW5jdGlvbih1cmwpIHsKICAgICAgc2VsZi5oYW5kbGVVUkwo
        dXJsKTsKICAgIH0pOwoKICAgIHRoaXMuaGFuZGxlVVJMKGxvY2F0aW9uLmdl
        dFVSTCgpKTsKICB9LAoKICBkaWRUcmFuc2l0aW9uOiBmdW5jdGlvbihpbmZv
        cykgewogICAgdmFyIGFwcENvbnRyb2xsZXIgPSB0aGlzLmNvbnRhaW5lci5s
        b29rdXAoJ2NvbnRyb2xsZXI6YXBwbGljYXRpb24nKSwKICAgICAgICBwYXRo
        ID0gRW1iZXIuUm91dGVyLl9yb3V0ZVBhdGgoaW5mb3MpOwoKICAgIGlmICgh
        KCdjdXJyZW50UGF0aCcgaW4gYXBwQ29udHJvbGxlcikpIHsgZGVmaW5lUHJv
        cGVydHkoYXBwQ29udHJvbGxlciwgJ2N1cnJlbnRQYXRoJyk7IH0KICAgIHNl
        dChhcHBDb250cm9sbGVyLCAnY3VycmVudFBhdGgnLCBwYXRoKTsKCiAgICBp
        ZiAoISgnY3VycmVudFJvdXRlTmFtZScgaW4gYXBwQ29udHJvbGxlcikpIHsg
        ZGVmaW5lUHJvcGVydHkoYXBwQ29udHJvbGxlciwgJ2N1cnJlbnRSb3V0ZU5h
        bWUnKTsgfQogICAgc2V0KGFwcENvbnRyb2xsZXIsICdjdXJyZW50Um91dGVO
        YW1lJywgaW5mb3NbaW5mb3MubGVuZ3RoIC0gMV0ubmFtZSk7CgogICAgdGhp
        cy5ub3RpZnlQcm9wZXJ0eUNoYW5nZSgndXJsJyk7CgogICAgaWYgKGdldCh0
        aGlzLCAnbmFtZXNwYWNlJykuTE9HX1RSQU5TSVRJT05TKSB7CiAgICAgIEVt
        YmVyLkxvZ2dlci5sb2coIlRyYW5zaXRpb25lZCBpbnRvICciICsgcGF0aCAr
        ICInIik7CiAgICB9CiAgfSwKCiAgaGFuZGxlVVJMOiBmdW5jdGlvbih1cmwp
        IHsKICAgIHJldHVybiB0aGlzLl9kb1RyYW5zaXRpb24oJ2hhbmRsZVVSTCcs
        IFt1cmxdKTsKICB9LAoKICB0cmFuc2l0aW9uVG86IGZ1bmN0aW9uKCkgewog
        ICAgcmV0dXJuIHRoaXMuX2RvVHJhbnNpdGlvbigndHJhbnNpdGlvblRvJywg
        YXJndW1lbnRzKTsKICB9LAoKICByZXBsYWNlV2l0aDogZnVuY3Rpb24oKSB7
        CiAgICByZXR1cm4gdGhpcy5fZG9UcmFuc2l0aW9uKCdyZXBsYWNlV2l0aCcs
        IGFyZ3VtZW50cyk7CiAgfSwKCiAgZ2VuZXJhdGU6IGZ1bmN0aW9uKCkgewog
        ICAgdmFyIHVybCA9IHRoaXMucm91dGVyLmdlbmVyYXRlLmFwcGx5KHRoaXMu
        cm91dGVyLCBhcmd1bWVudHMpOwogICAgcmV0dXJuIHRoaXMubG9jYXRpb24u
        Zm9ybWF0VVJMKHVybCk7CiAgfSwKCiAgaXNBY3RpdmU6IGZ1bmN0aW9uKHJv
        dXRlTmFtZSkgewogICAgdmFyIHJvdXRlciA9IHRoaXMucm91dGVyOwogICAg
        cmV0dXJuIHJvdXRlci5pc0FjdGl2ZS5hcHBseShyb3V0ZXIsIGFyZ3VtZW50
        cyk7CiAgfSwKCiAgc2VuZDogZnVuY3Rpb24obmFtZSwgY29udGV4dCkgewog
        ICAgdGhpcy5yb3V0ZXIudHJpZ2dlci5hcHBseSh0aGlzLnJvdXRlciwgYXJn
        dW1lbnRzKTsKICB9LAoKICBoYXNSb3V0ZTogZnVuY3Rpb24ocm91dGUpIHsK
        ICAgIHJldHVybiB0aGlzLnJvdXRlci5oYXNSb3V0ZShyb3V0ZSk7CiAgfSwK
        CiAgLyoqCiAgICBAcHJpdmF0ZQoKICAgIFJlc2V0cyB0aGUgc3RhdGUgb2Yg
        dGhlIHJvdXRlciBieSBjbGVhcmluZyB0aGUgY3VycmVudCByb3V0ZQogICAg
        aGFuZGxlcnMgYW5kIGRlYWN0aXZhdGluZyB0aGVtLgoKICAgIEBtZXRob2Qg
        cmVzZXQKICAgKi8KICByZXNldDogZnVuY3Rpb24oKSB7CiAgICB0aGlzLnJv
        dXRlci5yZXNldCgpOwogIH0sCgogIF9sb29rdXBBY3RpdmVWaWV3OiBmdW5j
        dGlvbih0ZW1wbGF0ZU5hbWUpIHsKICAgIHZhciBhY3RpdmUgPSB0aGlzLl9h
        Y3RpdmVWaWV3c1t0ZW1wbGF0ZU5hbWVdOwogICAgcmV0dXJuIGFjdGl2ZSAm
        JiBhY3RpdmVbMF07CiAgfSwKCiAgX2Nvbm5lY3RBY3RpdmVWaWV3OiBmdW5j
        dGlvbih0ZW1wbGF0ZU5hbWUsIHZpZXcpIHsKICAgIHZhciBleGlzdGluZyA9
        IHRoaXMuX2FjdGl2ZVZpZXdzW3RlbXBsYXRlTmFtZV07CgogICAgaWYgKGV4
        aXN0aW5nKSB7CiAgICAgIGV4aXN0aW5nWzBdLm9mZignd2lsbERlc3Ryb3lF
        bGVtZW50JywgdGhpcywgZXhpc3RpbmdbMV0pOwogICAgfQoKICAgIHZhciBk
        aXNjb25uZWN0ID0gZnVuY3Rpb24oKSB7CiAgICAgIGRlbGV0ZSB0aGlzLl9h
        Y3RpdmVWaWV3c1t0ZW1wbGF0ZU5hbWVdOwogICAgfTsKCiAgICB0aGlzLl9h
        Y3RpdmVWaWV3c1t0ZW1wbGF0ZU5hbWVdID0gW3ZpZXcsIGRpc2Nvbm5lY3Rd
        OwogICAgdmlldy5vbmUoJ3dpbGxEZXN0cm95RWxlbWVudCcsIHRoaXMsIGRp
        c2Nvbm5lY3QpOwogIH0sCgogIF9zZXR1cExvY2F0aW9uOiBmdW5jdGlvbigp
        IHsKICAgIHZhciBsb2NhdGlvbiA9IGdldCh0aGlzLCAnbG9jYXRpb24nKSwK
        ICAgICAgICByb290VVJMID0gZ2V0KHRoaXMsICdyb290VVJMJyksCiAgICAg
        ICAgb3B0aW9ucyA9IHt9OwoKICAgIGlmICh0eXBlb2Ygcm9vdFVSTCA9PT0g
        J3N0cmluZycpIHsKICAgICAgb3B0aW9ucy5yb290VVJMID0gcm9vdFVSTDsK
        ICAgIH0KCiAgICBpZiAoJ3N0cmluZycgPT09IHR5cGVvZiBsb2NhdGlvbikg
        ewogICAgICBvcHRpb25zLmltcGxlbWVudGF0aW9uID0gbG9jYXRpb247CiAg
        ICAgIGxvY2F0aW9uID0gc2V0KHRoaXMsICdsb2NhdGlvbicsIEVtYmVyLkxv
        Y2F0aW9uLmNyZWF0ZShvcHRpb25zKSk7CiAgICB9CiAgfSwKCiAgX2dldEhh
        bmRsZXJGdW5jdGlvbjogZnVuY3Rpb24oKSB7CiAgICB2YXIgc2VlbiA9IHt9
        LCBjb250YWluZXIgPSB0aGlzLmNvbnRhaW5lciwKICAgICAgICBEZWZhdWx0
        Um91dGUgPSBjb250YWluZXIubG9va3VwRmFjdG9yeSgncm91dGU6YmFzaWMn
        KSwKICAgICAgICBzZWxmID0gdGhpczsKCiAgICByZXR1cm4gZnVuY3Rpb24o
        bmFtZSkgewogICAgICB2YXIgcm91dGVOYW1lID0gJ3JvdXRlOicgKyBuYW1l
        LAogICAgICAgICAgaGFuZGxlciA9IGNvbnRhaW5lci5sb29rdXAocm91dGVO
        YW1lKTsKCiAgICAgIGlmIChzZWVuW25hbWVdKSB7IHJldHVybiBoYW5kbGVy
        OyB9CgogICAgICBzZWVuW25hbWVdID0gdHJ1ZTsKCiAgICAgIGlmICghaGFu
        ZGxlcikgewogICAgICAgIGlmIChuYW1lID09PSAnbG9hZGluZycpIHsgcmV0
        dXJuIHt9OyB9CgogICAgICAgIGNvbnRhaW5lci5yZWdpc3Rlcihyb3V0ZU5h
        bWUsIERlZmF1bHRSb3V0ZS5leHRlbmQoKSk7CiAgICAgICAgaGFuZGxlciA9
        IGNvbnRhaW5lci5sb29rdXAocm91dGVOYW1lKTsKCiAgICAgICAgaWYgKGdl
        dChzZWxmLCAnbmFtZXNwYWNlLkxPR19BQ1RJVkVfR0VORVJBVElPTicpKSB7
        CiAgICAgICAgICBFbWJlci5Mb2dnZXIuaW5mbygiZ2VuZXJhdGVkIC0+ICIg
        KyByb3V0ZU5hbWUsIHsgZnVsbE5hbWU6IHJvdXRlTmFtZSB9KTsKICAgICAg
        ICB9CiAgICAgIH0KCiAgICAgIGlmIChuYW1lID09PSAnYXBwbGljYXRpb24n
        KSB7CiAgICAgICAgLy8gSW5qZWN0IGRlZmF1bHQgYGVycm9yYCBoYW5kbGVy
        LgogICAgICAgIC8vIE5vdGU6IGBldmVudHNgIGlzIGRlcHJlY2F0ZWQsIGJ1
        dCB3ZSdsbCBsZXQgdGhlCiAgICAgICAgLy8gZGVwcmVjYXRpb24gd2Fybmlu
        Z3MgYmUgaGFuZGxlZCBhdCBldmVudC1oYW5kbGluZyB0aW1lIHJhdGhlcgog
        ICAgICAgIC8vIHRoYW4gZHVwbGljYXRpbmcgdGhhdCBsb2dpYyBoZXJlLgog
        ICAgICAgIHZhciBhY3Rpb25zID0gaGFuZGxlci5fYWN0aW9ucyB8fCBoYW5k
        bGVyLmV2ZW50czsKICAgICAgICBpZiAoIWFjdGlvbnMpIHsgYWN0aW9ucyA9
        IGhhbmRsZXIuX2FjdGlvbnMgPSB7fTsgfQogICAgICAgIGFjdGlvbnMuZXJy
        b3IgPSBhY3Rpb25zLmVycm9yIHx8IEVtYmVyLlJvdXRlci5fZGVmYXVsdEVy
        cm9ySGFuZGxlcjsKICAgICAgfQoKICAgICAgaGFuZGxlci5yb3V0ZU5hbWUg
        PSBuYW1lOwogICAgICByZXR1cm4gaGFuZGxlcjsKICAgIH07CiAgfSwKCiAg
        X3NldHVwUm91dGVyOiBmdW5jdGlvbihyb3V0ZXIsIGxvY2F0aW9uKSB7CiAg
        ICB2YXIgbGFzdFVSTCwgZW1iZXJSb3V0ZXIgPSB0aGlzOwoKICAgIHJvdXRl
        ci5nZXRIYW5kbGVyID0gdGhpcy5fZ2V0SGFuZGxlckZ1bmN0aW9uKCk7Cgog
        ICAgdmFyIGRvVXBkYXRlVVJMID0gZnVuY3Rpb24oKSB7CiAgICAgIGxvY2F0
        aW9uLnNldFVSTChsYXN0VVJMKTsKICAgIH07CgogICAgcm91dGVyLnVwZGF0
        ZVVSTCA9IGZ1bmN0aW9uKHBhdGgpIHsKICAgICAgbGFzdFVSTCA9IHBhdGg7
        CiAgICAgIEVtYmVyLnJ1bi5vbmNlKGRvVXBkYXRlVVJMKTsKICAgIH07Cgog
        ICAgaWYgKGxvY2F0aW9uLnJlcGxhY2VVUkwpIHsKICAgICAgdmFyIGRvUmVw
        bGFjZVVSTCA9IGZ1bmN0aW9uKCkgewogICAgICAgIGxvY2F0aW9uLnJlcGxh
        Y2VVUkwobGFzdFVSTCk7CiAgICAgIH07CgogICAgICByb3V0ZXIucmVwbGFj
        ZVVSTCA9IGZ1bmN0aW9uKHBhdGgpIHsKICAgICAgICBsYXN0VVJMID0gcGF0
        aDsKICAgICAgICBFbWJlci5ydW4ub25jZShkb1JlcGxhY2VVUkwpOwogICAg
        ICB9OwogICAgfQoKICAgIHJvdXRlci5kaWRUcmFuc2l0aW9uID0gZnVuY3Rp
        b24oaW5mb3MpIHsKICAgICAgZW1iZXJSb3V0ZXIuZGlkVHJhbnNpdGlvbihp
        bmZvcyk7CiAgICB9OwogIH0sCgogIF9kb1RyYW5zaXRpb246IGZ1bmN0aW9u
        KG1ldGhvZCwgYXJncykgewogICAgLy8gTm9ybWFsaXplIGJsYW5rIHJvdXRl
        IHRvIHJvb3QgVVJMLgogICAgYXJncyA9IFtdLnNsaWNlLmNhbGwoYXJncyk7
        CiAgICBhcmdzWzBdID0gYXJnc1swXSB8fCAnLyc7CgogICAgdmFyIHBhc3Nl
        ZE5hbWUgPSBhcmdzWzBdLCBuYW1lLCBzZWxmID0gdGhpczsKCiAgICBpZiAo
        cGFzc2VkTmFtZS5jaGFyQXQoMCkgPT09ICcvJykgewogICAgICBuYW1lID0g
        cGFzc2VkTmFtZTsKICAgIH0gZWxzZSB7CgogICAgICBpZiAoIXRoaXMucm91
        dGVyLmhhc1JvdXRlKHBhc3NlZE5hbWUpKSB7CiAgICAgICAgbmFtZSA9IGFy
        Z3NbMF0gPSBwYXNzZWROYW1lICsgJy5pbmRleCc7CiAgICAgIH0gZWxzZSB7
        CiAgICAgICAgbmFtZSA9IHBhc3NlZE5hbWU7CiAgICAgIH0KCiAgICAgIEVt
        YmVyLmFzc2VydCgiVGhlIHJvdXRlICIgKyBwYXNzZWROYW1lICsgIiB3YXMg
        bm90IGZvdW5kIiwgdGhpcy5yb3V0ZXIuaGFzUm91dGUobmFtZSkpOwogICAg
        fQoKICAgIHZhciB0cmFuc2l0aW9uUHJvbWlzZSA9IHRoaXMucm91dGVyW21l
        dGhvZF0uYXBwbHkodGhpcy5yb3V0ZXIsIGFyZ3MpOwoKICAgIC8vIERvbid0
        IHNjaGVkdWxlIGxvYWRpbmcgc3RhdGUgZW50cnkgaWYgdXNlciBoYXMgYWxy
        ZWFkeSBhYm9ydGVkIHRoZSB0cmFuc2l0aW9uLgogICAgaWYgKHRoaXMucm91
        dGVyLmFjdGl2ZVRyYW5zaXRpb24pIHsKICAgICAgdGhpcy5fc2NoZWR1bGVM
        b2FkaW5nU3RhdGVFbnRyeSgpOwogICAgfQoKICAgIHRyYW5zaXRpb25Qcm9t
        aXNlLnRoZW4oZnVuY3Rpb24ocm91dGUpIHsKICAgICAgc2VsZi5fdHJhbnNp
        dGlvbkNvbXBsZXRlZChyb3V0ZSk7CiAgICB9LCBmdW5jdGlvbihlcnJvcikg
        ewogICAgICBpZiAoZXJyb3IubmFtZSA9PT0gIlVucmVjb2duaXplZFVSTEVy
        cm9yIikgewogICAgICAgIEVtYmVyLmFzc2VydCgiVGhlIFVSTCAnIiArIGVy
        cm9yLm1lc3NhZ2UgKyAiJyBkaWQgbm90IG1hdGNoIGFueSByb3V0ZXMgaW4g
        eW91ciBhcHBsaWNhdGlvbiIpOwogICAgICB9CiAgICB9KTsKCiAgICAvLyBX
        ZSB3YW50IHRvIHJldHVybiB0aGUgY29uZmlndXJhYmxlIHByb21pc2Ugb2Jq
        ZWN0CiAgICAvLyBzbyB0aGF0IGNhbGxlcnMgb2YgdGhpcyBmdW5jdGlvbiBj
        YW4gdXNlIGAubWV0aG9kKClgIG9uIGl0LAogICAgLy8gd2hpY2ggb2J2aW91
        c2x5IGRvZXNuJ3QgZXhpc3QgZm9yIG5vcm1hbCBSU1ZQIHByb21pc2VzLgog
        ICAgcmV0dXJuIHRyYW5zaXRpb25Qcm9taXNlOwogIH0sCgogIF9zY2hlZHVs
        ZUxvYWRpbmdTdGF0ZUVudHJ5OiBmdW5jdGlvbigpIHsKICAgIGlmICh0aGlz
        Ll9sb2FkaW5nU3RhdGVBY3RpdmUpIHsgcmV0dXJuOyB9CiAgICB0aGlzLl9z
        aG91bGRFbnRlckxvYWRpbmdTdGF0ZSA9IHRydWU7CiAgICBFbWJlci5ydW4u
        c2NoZWR1bGVPbmNlKCdyb3V0ZXJUcmFuc2l0aW9ucycsIHRoaXMsIHRoaXMu
        X2VudGVyTG9hZGluZ1N0YXRlKTsKICB9LAoKICBfZW50ZXJMb2FkaW5nU3Rh
        dGU6IGZ1bmN0aW9uKCkgewogICAgaWYgKHRoaXMuX2xvYWRpbmdTdGF0ZUFj
        dGl2ZSB8fCAhdGhpcy5fc2hvdWxkRW50ZXJMb2FkaW5nU3RhdGUpIHsgcmV0
        dXJuOyB9CgogICAgdmFyIGxvYWRpbmdSb3V0ZSA9IHRoaXMucm91dGVyLmdl
        dEhhbmRsZXIoJ2xvYWRpbmcnKTsKICAgIGlmIChsb2FkaW5nUm91dGUpIHsK
        ICAgICAgaWYgKGxvYWRpbmdSb3V0ZS5lbnRlcikgeyBsb2FkaW5nUm91dGUu
        ZW50ZXIoKTsgfQogICAgICBpZiAobG9hZGluZ1JvdXRlLnNldHVwKSB7IGxv
        YWRpbmdSb3V0ZS5zZXR1cCgpOyB9CiAgICAgIHRoaXMuX2xvYWRpbmdTdGF0
        ZUFjdGl2ZSA9IHRydWU7CiAgICB9CiAgfSwKCiAgX2V4aXRMb2FkaW5nU3Rh
        dGU6IGZ1bmN0aW9uICgpIHsKICAgIHRoaXMuX3Nob3VsZEVudGVyTG9hZGlu
        Z1N0YXRlID0gZmFsc2U7CiAgICBpZiAoIXRoaXMuX2xvYWRpbmdTdGF0ZUFj
        dGl2ZSkgeyByZXR1cm47IH0KCiAgICB2YXIgbG9hZGluZ1JvdXRlID0gdGhp
        cy5yb3V0ZXIuZ2V0SGFuZGxlcignbG9hZGluZycpOwogICAgaWYgKGxvYWRp
        bmdSb3V0ZSAmJiBsb2FkaW5nUm91dGUuZXhpdCkgeyBsb2FkaW5nUm91dGUu
        ZXhpdCgpOyB9CiAgICB0aGlzLl9sb2FkaW5nU3RhdGVBY3RpdmUgPSBmYWxz
        ZTsKICB9LAoKICBfdHJhbnNpdGlvbkNvbXBsZXRlZDogZnVuY3Rpb24ocm91
        dGUpIHsKICAgIHRoaXMubm90aWZ5UHJvcGVydHlDaGFuZ2UoJ3VybCcpOwog
        ICAgdGhpcy5fZXhpdExvYWRpbmdTdGF0ZSgpOwogIH0KfSk7CgpmdW5jdGlv
        biB0cmlnZ2VyRXZlbnQoaGFuZGxlckluZm9zLCBpZ25vcmVGYWlsdXJlLCBh
        cmdzKSB7CiAgdmFyIG5hbWUgPSBhcmdzLnNoaWZ0KCk7CgogIGlmICghaGFu
        ZGxlckluZm9zKSB7CiAgICBpZiAoaWdub3JlRmFpbHVyZSkgeyByZXR1cm47
        IH0KICAgIHRocm93IG5ldyBFbWJlci5FcnJvcigiQ291bGQgbm90IHRyaWdn
        ZXIgZXZlbnQgJyIgKyBuYW1lICsgIicuIFRoZXJlIGFyZSBubyBhY3RpdmUg
        aGFuZGxlcnMiKTsKICB9CgogIHZhciBldmVudFdhc0hhbmRsZWQgPSBmYWxz
        ZTsKCiAgZm9yICh2YXIgaT1oYW5kbGVySW5mb3MubGVuZ3RoLTE7IGk+PTA7
        IGktLSkgewogICAgdmFyIGhhbmRsZXJJbmZvID0gaGFuZGxlckluZm9zW2ld
        LAogICAgICAgIGhhbmRsZXIgPSBoYW5kbGVySW5mby5oYW5kbGVyOwoKICAg
        IGlmIChoYW5kbGVyLl9hY3Rpb25zICYmIGhhbmRsZXIuX2FjdGlvbnNbbmFt
        ZV0pIHsKICAgICAgaWYgKGhhbmRsZXIuX2FjdGlvbnNbbmFtZV0uYXBwbHko
        aGFuZGxlciwgYXJncykgPT09IHRydWUpIHsKICAgICAgICBldmVudFdhc0hh
        bmRsZWQgPSB0cnVlOwogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybjsK
        ICAgICAgfQogICAgfSBlbHNlIGlmIChoYW5kbGVyLmV2ZW50cyAmJiBoYW5k
        bGVyLmV2ZW50c1tuYW1lXSkgewogICAgICBFbWJlci5kZXByZWNhdGUoJ0Fj
        dGlvbiBoYW5kbGVycyBjb250YWluZWQgaW4gYW4gYGV2ZW50c2Agb2JqZWN0
        IGFyZSBkZXByZWNhdGVkIGluIGZhdm9yIG9mIHB1dHRpbmcgdGhlbSBpbiBh
        biBgYWN0aW9uc2Agb2JqZWN0ICgnICsgbmFtZSArICcgb24gJyArIGhhbmRs
        ZXIgKyAnKScsIGZhbHNlKTsKICAgICAgaWYgKGhhbmRsZXIuZXZlbnRzW25h
        bWVdLmFwcGx5KGhhbmRsZXIsIGFyZ3MpID09PSB0cnVlKSB7CiAgICAgICAg
        ZXZlbnRXYXNIYW5kbGVkID0gdHJ1ZTsKICAgICAgfSBlbHNlIHsKICAgICAg
        ICByZXR1cm47CiAgICAgIH0KICAgIH0KICB9CgogIGlmICghZXZlbnRXYXNI
        YW5kbGVkICYmICFpZ25vcmVGYWlsdXJlKSB7CiAgICB0aHJvdyBuZXcgRW1i
        ZXIuRXJyb3IoIk5vdGhpbmcgaGFuZGxlZCB0aGUgZXZlbnQgJyIgKyBuYW1l
        ICsgIicuIik7CiAgfQp9CgpFbWJlci5Sb3V0ZXIucmVvcGVuQ2xhc3Moewog
        IHJvdXRlcjogbnVsbCwKICBtYXA6IGZ1bmN0aW9uKGNhbGxiYWNrKSB7CiAg
        ICB2YXIgcm91dGVyID0gdGhpcy5yb3V0ZXI7CiAgICBpZiAoIXJvdXRlcikg
        ewogICAgICByb3V0ZXIgPSBuZXcgUm91dGVyKCk7CiAgICAgIHJvdXRlci5j
        YWxsYmFja3MgPSBbXTsKICAgICAgcm91dGVyLnRyaWdnZXJFdmVudCA9IHRy
        aWdnZXJFdmVudDsKICAgICAgdGhpcy5yZW9wZW5DbGFzcyh7IHJvdXRlcjog
        cm91dGVyIH0pOwogICAgfQoKICAgIGlmIChnZXQodGhpcywgJ25hbWVzcGFj
        ZS5MT0dfVFJBTlNJVElPTlNfSU5URVJOQUwnKSkgewogICAgICByb3V0ZXIu
        bG9nID0gRW1iZXIuTG9nZ2VyLmRlYnVnOwogICAgfQoKICAgIHZhciBkc2wg
        PSBFbWJlci5Sb3V0ZXJEU0wubWFwKGZ1bmN0aW9uKCkgewogICAgICB0aGlz
        LnJlc291cmNlKCdhcHBsaWNhdGlvbicsIHsgcGF0aDogIi8iIH0sIGZ1bmN0
        aW9uKCkgewogICAgICAgIGZvciAodmFyIGk9MDsgaSA8IHJvdXRlci5jYWxs
        YmFja3MubGVuZ3RoOyBpKyspIHsKICAgICAgICAgIHJvdXRlci5jYWxsYmFj
        a3NbaV0uY2FsbCh0aGlzKTsKICAgICAgICB9CiAgICAgICAgY2FsbGJhY2su
        Y2FsbCh0aGlzKTsKICAgICAgfSk7CiAgICB9KTsKCiAgICByb3V0ZXIuY2Fs
        bGJhY2tzLnB1c2goY2FsbGJhY2spOwogICAgcm91dGVyLm1hcChkc2wuZ2Vu
        ZXJhdGUoKSk7CiAgICByZXR1cm4gcm91dGVyOwogIH0sCgogIF9kZWZhdWx0
        RXJyb3JIYW5kbGVyOiBmdW5jdGlvbihlcnJvciwgdHJhbnNpdGlvbikgewog
        ICAgRW1iZXIuTG9nZ2VyLmVycm9yKCdFcnJvciB3aGlsZSBsb2FkaW5nIHJv
        dXRlOicsIGVycm9yKTsKCiAgICAvLyBVc2luZyBzZXRUaW1lb3V0IGFsbG93
        cyB1cyB0byBlc2NhcGUgZnJvbSB0aGUgUHJvbWlzZSdzIHRyeS9jYXRjaCBi
        bG9jawogICAgc2V0VGltZW91dChmdW5jdGlvbigpIHsgdGhyb3cgZXJyb3I7
        IH0pOwogIH0sCgogIF9yb3V0ZVBhdGg6IGZ1bmN0aW9uKGhhbmRsZXJJbmZv
        cykgewogICAgdmFyIHBhdGggPSBbXTsKCiAgICBmb3IgKHZhciBpPTEsIGw9
        aGFuZGxlckluZm9zLmxlbmd0aDsgaTxsOyBpKyspIHsKICAgICAgdmFyIG5h
        bWUgPSBoYW5kbGVySW5mb3NbaV0ubmFtZSwKICAgICAgICAgIG5hbWVQYXJ0
        cyA9IG5hbWUuc3BsaXQoIi4iKTsKCiAgICAgIHBhdGgucHVzaChuYW1lUGFy
        dHNbbmFtZVBhcnRzLmxlbmd0aCAtIDFdKTsKICAgIH0KCiAgICByZXR1cm4g
        cGF0aC5qb2luKCIuIik7CiAgfQp9KTsKCgp9KSgpOwoKCgooZnVuY3Rpb24o
        KSB7Ci8qKgpAbW9kdWxlIGVtYmVyCkBzdWJtb2R1bGUgZW1iZXItcm91dGlu
        ZwoqLwoKdmFyIGdldCA9IEVtYmVyLmdldCwgc2V0ID0gRW1iZXIuc2V0LAog
        ICAgZ2V0UHJvcGVydGllcyA9IEVtYmVyLmdldFByb3BlcnRpZXMsCiAgICBj
        bGFzc2lmeSA9IEVtYmVyLlN0cmluZy5jbGFzc2lmeSwKICAgIGZtdCA9IEVt
        YmVyLlN0cmluZy5mbXQsCiAgICBhX2ZvckVhY2ggPSBFbWJlci5FbnVtZXJh
        YmxlVXRpbHMuZm9yRWFjaCwKICAgIGFfcmVwbGFjZSA9IEVtYmVyLkVudW1l
        cmFibGVVdGlscy5yZXBsYWNlOwoKLyoqCiAgVGhlIGBFbWJlci5Sb3V0ZWAg
        Y2xhc3MgaXMgdXNlZCB0byBkZWZpbmUgaW5kaXZpZHVhbCByb3V0ZXMuIFJl
        ZmVyIHRvCiAgdGhlIFtyb3V0aW5nIGd1aWRlXShodHRwOi8vZW1iZXJqcy5j
        b20vZ3VpZGVzL3JvdXRpbmcvKSBmb3IgZG9jdW1lbnRhdGlvbi4KCiAgQGNs
        YXNzIFJvdXRlCiAgQG5hbWVzcGFjZSBFbWJlcgogIEBleHRlbmRzIEVtYmVy
        Lk9iamVjdAoqLwpFbWJlci5Sb3V0ZSA9IEVtYmVyLk9iamVjdC5leHRlbmQo
        RW1iZXIuQWN0aW9uSGFuZGxlciwgewogIC8qKgogICAgQHByaXZhdGUKCiAg
        ICBAbWV0aG9kIGV4aXQKICAqLwogIGV4aXQ6IGZ1bmN0aW9uKCkgewogICAg
        dGhpcy5kZWFjdGl2YXRlKCk7CiAgICB0aGlzLnRlYXJkb3duVmlld3MoKTsK
        ICB9LAoKICAvKioKICAgIEBwcml2YXRlCgogICAgQG1ldGhvZCBlbnRlcgog
        ICovCiAgZW50ZXI6IGZ1bmN0aW9uKCkgewogICAgdGhpcy5hY3RpdmF0ZSgp
        OwogIH0sCgogIC8qKgogICAgVGhlIGNvbGxlY3Rpb24gb2YgZnVuY3Rpb25z
        LCBrZXllZCBieSBuYW1lLCBhdmFpbGFibGUgb24gdGhpcyByb3V0ZSBhcwog
        ICAgYWN0aW9uIHRhcmdldHMuCgogICAgVGhlc2UgZnVuY3Rpb25zIHdpbGwg
        YmUgaW52b2tlZCB3aGVuIGEgbWF0Y2hpbmcgYHt7YWN0aW9ufX1gIGlzIHRy
        aWdnZXJlZAogICAgZnJvbSB3aXRoaW4gYSB0ZW1wbGF0ZSBhbmQgdGhlIGFw
        cGxpY2F0aW9uJ3MgY3VycmVudCByb3V0ZSBpcyB0aGlzIHJvdXRlLgoKICAg
        IEFjdGlvbnMgY2FuIGFsc28gYmUgaW52b2tlZCBmcm9tIG90aGVyIHBhcnRz
        IG9mIHlvdXIgYXBwbGljYXRpb24gdmlhIGBSb3V0ZSNzZW5kYAogICAgb3Ig
        YENvbnRyb2xsZXIjc2VuZGAuCgogICAgVGhlIGBhY3Rpb25zYCBoYXNoIHdp
        bGwgaW5oZXJpdCBhY3Rpb24gaGFuZGxlcnMgZnJvbQogICAgdGhlIGBhY3Rp
        b25zYCBoYXNoIGRlZmluZWQgb24gZXh0ZW5kZWQgUm91dGUgcGFyZW50IGNs
        YXNzZXMKICAgIG9yIG1peGlucyByYXRoZXIgdGhhbiBqdXN0IHJlcGxhY2Ug
        dGhlIGVudGlyZSBoYXNoLCBlLmcuOgoKICAgIGBgYGpzCiAgICBBcHAuQ2Fu
        RGlzcGxheUJhbm5lciA9IEVtYmVyLk1peGluLmNyZWF0ZSh7CiAgICAgIGFj
        dGlvbnM6IHsKICAgICAgICBkaXNwbGF5QmFubmVyOiBmdW5jdGlvbihtc2cp
        IHsKICAgICAgICAgIC8vIC4uLgogICAgICAgIH0KICAgICAgfQogICAgfSk7
        CgogICAgQXBwLldlbGNvbWVSb3V0ZSA9IEVtYmVyLlJvdXRlLmV4dGVuZChB
        cHAuQ2FuRGlzcGxheUJhbm5lciwgewogICAgICBhY3Rpb25zOiB7CiAgICAg
        ICAgcGxheU11c2ljOiBmdW5jdGlvbigpIHsKICAgICAgICAgIC8vIC4uLgog
        ICAgICAgIH0KICAgICAgfQogICAgfSk7CgogICAgLy8gYFdlbGNvbWVSb3V0
        ZWAsIHdoZW4gYWN0aXZlLCB3aWxsIGJlIGFibGUgdG8gcmVzcG9uZAogICAg
        Ly8gdG8gYm90aCBhY3Rpb25zLCBzaW5jZSB0aGUgYWN0aW9ucyBoYXNoIGlz
        IG1lcmdlZCByYXRoZXIKICAgIC8vIHRoZW4gcmVwbGFjZWQgd2hlbiBleHRl
        bmRpbmcgbWl4aW5zIC8gcGFyZW50IGNsYXNzZXMuCiAgICB0aGlzLnNlbmQo
        J2Rpc3BsYXlCYW5uZXInKTsKICAgIHRoaXMuc2VuZCgncGxheU11c2ljJyk7
        CiAgICBgYGAKCiAgICBXaXRoaW4gYSByb3V0ZSdzIGFjdGlvbiBoYW5kbGVy
        LCB0aGUgdmFsdWUgb2YgdGhlIGB0aGlzYCBjb250ZXh0CiAgICBpcyB0aGUg
        Um91dGUgb2JqZWN0OgoKICAgIGBgYGpzCiAgICBBcHAuU29uZ1JvdXRlID0g
        RW1iZXIuUm91dGUuZXh0ZW5kKHsKICAgICAgYWN0aW9uczogewogICAgICAg
        IG15QWN0aW9uOiBmdW5jdGlvbigpIHsKICAgICAgICAgIHRoaXMuY29udHJv
        bGxlckZvcigic29uZyIpOwogICAgICAgICAgdGhpcy50cmFuc2l0aW9uVG8o
        Im90aGVyLnJvdXRlIik7CiAgICAgICAgICAuLi4KICAgICAgICB9CiAgICAg
        IH0KICAgIH0pOwogICAgYGBgCgogICAgSXQgaXMgYWxzbyBwb3NzaWJsZSB0
        byBjYWxsIGB0aGlzLl9zdXBlcigpYCBmcm9tIHdpdGhpbiBhbgogICAgYWN0
        aW9uIGhhbmRsZXIgaWYgaXQgb3ZlcnJpZGVzIGEgaGFuZGxlciBkZWZpbmVk
        IG9uIGEgcGFyZW50CiAgICBjbGFzcyBvciBtaXhpbjoKCiAgICBUYWtlIGZv
        ciBleGFtcGxlIHRoZSBmb2xsb3dpbmcgcm91dGVzOgoKICAgIGBgYGpzCiAg
        ICBBcHAuRGVidWdSb3V0ZSA9IEVtYmVyLk1peGluLmNyZWF0ZSh7CiAgICAg
        IGFjdGlvbnM6IHsKICAgICAgICBkZWJ1Z1JvdXRlSW5mb3JtYXRpb246IGZ1
        bmN0aW9uKCkgewogICAgICAgICAgY29uc29sZS5kZWJ1ZygidHJvbG9sbyIp
        OwogICAgICAgIH0KICAgICAgfQogICAgfSk7CgogICAgQXBwLkFubm95aW5n
        RGVidWdSb3V0ZSA9IEVtYmVyLlJvdXRlLmV4dGVuZChBcHAuRGVidWdSb3V0
        ZSwgewogICAgICBhY3Rpb25zOiB7CiAgICAgICAgZGVidWdSb3V0ZUluZm9y
        bWF0aW9uOiBmdW5jdGlvbigpIHsKICAgICAgICAgIC8vIGFsc28gY2FsbCB0
        aGUgZGVidWdSb3V0ZUluZm9ybWF0aW9uIG9mIG1peGVkIGluIEFwcC5EZWJ1
        Z1JvdXRlCiAgICAgICAgICB0aGlzLl9zdXBlcigpOwoKICAgICAgICAgIC8v
        IHNob3cgYWRkaXRpb25hbCBhbm5veWFuY2UKICAgICAgICAgIHdpbmRvdy5h
        bGVydCguLi4pOwogICAgICAgIH0KICAgICAgfQogICAgfSk7CiAgICBgYGAK
        CiAgICAjIyBCdWJibGluZwoKICAgIEJ5IGRlZmF1bHQsIGFuIGFjdGlvbiB3
        aWxsIHN0b3AgYnViYmxpbmcgb25jZSBhIGhhbmRsZXIgZGVmaW5lZAogICAg
        b24gdGhlIGBhY3Rpb25zYCBoYXNoIGhhbmRsZXMgaXQuIFRvIGNvbnRpbnVl
        IGJ1YmJsaW5nIHRoZSBhY3Rpb24sCiAgICB5b3UgbXVzdCByZXR1cm4gYHRy
        dWVgIGZyb20gdGhlIGhhbmRsZXI6CgogICAgYGBganMKICAgIEFwcC5Sb3V0
        ZXIubWFwKGZ1bmN0aW9uKCkgewogICAgICB0aGlzLnJlc291cmNlKCJhbGJ1
        bSIsIGZ1bmN0aW9uKCkgewogICAgICAgIHRoaXMucm91dGUoInNvbmciKTsK
        ICAgICAgfSk7CiAgICB9KTsKCiAgICBBcHAuQWxidW1Sb3V0ZSA9IEVtYmVy
        LlJvdXRlLmV4dGVuZCh7CiAgICAgIGFjdGlvbnM6IHsKICAgICAgICBzdGFy
        dFBsYXlpbmc6IGZ1bmN0aW9uKCkgewogICAgICAgIH0KICAgICAgfQogICAg
        fSk7CgogICAgQXBwLkFsYnVtU29uZ1JvdXRlID0gRW1iZXIuUm91dGUuZXh0
        ZW5kKHsKICAgICAgYWN0aW9uczogewogICAgICAgIHN0YXJ0UGxheWluZzog
        ZnVuY3Rpb24oKSB7CiAgICAgICAgICAvLyAuLi4KCiAgICAgICAgICBpZiAo
        YWN0aW9uU2hvdWxkQWxzb0JlVHJpZ2dlcmVkT25QYXJlbnRSb3V0ZSkgewog
        ICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgIH0KICAgICAgICB9
        CiAgICAgIH0KICAgIH0pOwogICAgYGBgCgogICAgIyMgQnVpbHQtaW4gYWN0
        aW9ucwoKICAgIFRoZXJlIGFyZSBhIGZldyBidWlsdC1pbiBhY3Rpb25zIHBl
        cnRhaW5pbmcgdG8gdHJhbnNpdGlvbnMgdGhhdCB5b3UKICAgIGNhbiB1c2Ug
        dG8gY3VzdG9taXplIHRyYW5zaXRpb24gYmVoYXZpb3I6IGB3aWxsVHJhbnNp
        dGlvbmAgYW5kCiAgICBgZXJyb3JgLgoKICAgICMjIyBgd2lsbFRyYW5zaXRp
        b25gCgogICAgVGhlIGB3aWxsVHJhbnNpdGlvbmAgYWN0aW9uIGlzIGZpcmVk
        IGF0IHRoZSBiZWdpbm5pbmcgb2YgYW55CiAgICBhdHRlbXB0ZWQgdHJhbnNp
        dGlvbiB3aXRoIGEgYFRyYW5zaXRpb25gIG9iamVjdCBhcyB0aGUgc29sZQog
        ICAgYXJndW1lbnQuIFRoaXMgYWN0aW9uIGNhbiBiZSB1c2VkIGZvciBhYm9y
        dGluZywgcmVkaXJlY3RpbmcsCiAgICBvciBkZWNvcmF0aW5nIHRoZSB0cmFu
        c2l0aW9uIGZyb20gdGhlIGN1cnJlbnRseSBhY3RpdmUgcm91dGVzLgoKICAg
        IEEgZ29vZCBleGFtcGxlIGlzIHByZXZlbnRpbmcgbmF2aWdhdGlvbiB3aGVu
        IGEgZm9ybSBpcwogICAgaGFsZi1maWxsZWQgb3V0OgoKICAgIGBgYGpzCiAg
        ICBBcHAuQ29udGFjdEZvcm1Sb3V0ZSA9IEVtYmVyLlJvdXRlLmV4dGVuZCh7
        CiAgICAgIGFjdGlvbnM6IHsKICAgICAgICB3aWxsVHJhbnNpdGlvbjogZnVu
        Y3Rpb24odHJhbnNpdGlvbikgewogICAgICAgICAgaWYgKHRoaXMuY29udHJv
        bGxlci5nZXQoJ3VzZXJIYXNFbnRlcmVkRGF0YScpKSB7CiAgICAgICAgICAg
        IHRoaXMuY29udHJvbGxlci5kaXNwbGF5TmF2aWdhdGlvbkNvbmZpcm0oKTsK
        ICAgICAgICAgICAgdHJhbnNpdGlvbi5hYm9ydCgpOwogICAgICAgICAgfQog
        ICAgICAgIH0KICAgICAgfQogICAgfSk7CiAgICBgYGAKCiAgICBZb3UgY2Fu
        IGFsc28gcmVkaXJlY3QgZWxzZXdoZXJlIGJ5IGNhbGxpbmcKICAgIGB0aGlz
        LnRyYW5zaXRpb25UbygnZWxzZXdoZXJlJylgIGZyb20gd2l0aGluIGB3aWxs
        VHJhbnNpdGlvbmAuCiAgICBOb3RlIHRoYXQgYHdpbGxUcmFuc2l0aW9uYCB3
        aWxsIG5vdCBiZSBmaXJlZCBmb3IgdGhlCiAgICByZWRpcmVjdGluZyBgdHJh
        bnNpdGlvblRvYCwgc2luY2UgYHdpbGxUcmFuc2l0aW9uYCBkb2Vzbid0CiAg
        ICBmaXJlIHdoZW4gdGhlcmUgaXMgYWxyZWFkeSBhIHRyYW5zaXRpb24gdW5k
        ZXJ3YXkuIElmIHlvdSB3YW50CiAgICBzdWJzZXF1ZW50IGB3aWxsVHJhbnNp
        dGlvbmAgYWN0aW9ucyB0byBmaXJlIGZvciB0aGUgcmVkaXJlY3RpbmcKICAg
        IHRyYW5zaXRpb24sIHlvdSBtdXN0IGZpcnN0IGV4cGxpY2l0bHkgY2FsbAog
        ICAgYHRyYW5zaXRpb24uYWJvcnQoKWAuCgogICAgIyMjIGBlcnJvcmAKCiAg
        ICBXaGVuIGF0dGVtcHRpbmcgdG8gdHJhbnNpdGlvbiBpbnRvIGEgcm91dGUs
        IGFueSBvZiB0aGUgaG9va3MKICAgIG1heSB0aHJvdyBhbiBlcnJvciwgb3Ig
        cmV0dXJuIGEgcHJvbWlzZSB0aGF0IHJlamVjdHMsIGF0IHdoaWNoCiAgICBw
        b2ludCBhbiBgZXJyb3JgIGFjdGlvbiB3aWxsIGJlIGZpcmVkIG9uIHRoZSBw
        YXJ0aWFsbHktZW50ZXJlZAogICAgcm91dGVzLCBhbGxvd2luZyBmb3IgcGVy
        LXJvdXRlIGVycm9yIGhhbmRsaW5nIGxvZ2ljLCBvciBzaGFyZWQKICAgIGVy
        cm9yIGhhbmRsaW5nIGxvZ2ljIGRlZmluZWQgb24gYSBwYXJlbnQgcm91dGUu
        CgogICAgSGVyZSBpcyBhbiBleGFtcGxlIG9mIGFuIGVycm9yIGhhbmRsZXIg
        dGhhdCB3aWxsIGJlIGludm9rZWQKICAgIGZvciByZWplY3RlZCBwcm9taXNl
        cyAvIHRocm93biBlcnJvcnMgZnJvbSB0aGUgdmFyaW91cyBob29rcwogICAg
        b24gdGhlIHJvdXRlLCBhcyB3ZWxsIGFzIGFueSB1bmhhbmRsZWQgZXJyb3Jz
        IGZyb20gY2hpbGQKICAgIHJvdXRlczoKCiAgICBgYGBqcwogICAgQXBwLkFk
        bWluUm91dGUgPSBFbWJlci5Sb3V0ZS5leHRlbmQoewogICAgICBiZWZvcmVN
        b2RlbDogZnVuY3Rpb24oKSB7CiAgICAgICAgdGhyb3cgImJhZCB0aGluZ3Mh
        IjsKICAgICAgICAvLyAuLi5vciwgZXF1aXZhbGVudGx5OgogICAgICAgIHJl
        dHVybiBFbWJlci5SU1ZQLnJlamVjdCgiYmFkIHRoaW5ncyEiKTsKICAgICAg
        fSwKCiAgICAgIGFjdGlvbnM6IHsKICAgICAgICBlcnJvcjogZnVuY3Rpb24o
        ZXJyb3IsIHRyYW5zaXRpb24pIHsKICAgICAgICAgIC8vIEFzc3VtaW5nIHdl
        IGdvdCBoZXJlIGR1ZSB0byB0aGUgZXJyb3IgaW4gYGJlZm9yZU1vZGVsYCwK
        ICAgICAgICAgIC8vIHdlIGNhbiBleHBlY3QgdGhhdCBlcnJvciA9PT0gImJh
        ZCB0aGluZ3MhIiwKICAgICAgICAgIC8vIGJ1dCBhIHByb21pc2UgbW9kZWwg
        cmVqZWN0aW5nIHdvdWxkIGFsc28KICAgICAgICAgIC8vIGNhbGwgdGhpcyBo
        b29rLCBhcyB3b3VsZCBhbnkgZXJyb3JzIGVuY291bnRlcmVkCiAgICAgICAg
        ICAvLyBpbiBgYWZ0ZXJNb2RlbGAuCgogICAgICAgICAgLy8gVGhlIGBlcnJv
        cmAgaG9vayBpcyBhbHNvIHByb3ZpZGVkIHRoZSBmYWlsZWQKICAgICAgICAg
        IC8vIGB0cmFuc2l0aW9uYCwgd2hpY2ggY2FuIGJlIHN0b3JlZCBhbmQgbGF0
        ZXIKICAgICAgICAgIC8vIGAucmV0cnkoKWBkIGlmIGRlc2lyZWQuCgogICAg
        ICAgICAgdGhpcy50cmFuc2l0aW9uVG8oJ2xvZ2luJyk7CiAgICAgICAgfQog
        ICAgICB9CiAgICB9KTsKICAgIGBgYAoKICAgIGBlcnJvcmAgYWN0aW9ucyB0
        aGF0IGJ1YmJsZSB1cCBhbGwgdGhlIHdheSB0byBgQXBwbGljYXRpb25Sb3V0
        ZWAKICAgIHdpbGwgZmlyZSBhIGRlZmF1bHQgZXJyb3IgaGFuZGxlciB0aGF0
        IGxvZ3MgdGhlIGVycm9yLiBZb3UgY2FuCiAgICBzcGVjaWZ5IHlvdXIgb3du
        IGdsb2JhbCBkZWZhdWx0IGVycm9yIGhhbmRsZXIgYnkgb3ZlcnJpZGluZyB0
        aGUKICAgIGBlcnJvcmAgaGFuZGxlciBvbiBgQXBwbGljYXRpb25Sb3V0ZWA6
        CgogICAgYGBganMKICAgIEFwcC5BcHBsaWNhdGlvblJvdXRlID0gRW1iZXIu
        Um91dGUuZXh0ZW5kKHsKICAgICAgYWN0aW9uczogewogICAgICAgIGVycm9y
        OiBmdW5jdGlvbihlcnJvciwgdHJhbnNpdGlvbikgewogICAgICAgICAgdGhp
        cy5jb250cm9sbGVyRm9yKCdiYW5uZXInKS5kaXNwbGF5RXJyb3IoZXJyb3Iu
        bWVzc2FnZSk7CiAgICAgICAgfQogICAgICB9CiAgICB9KTsKICAgIGBgYAoK
        ICAgIEBzZWUge0VtYmVyLlJvdXRlI3NlbmR9CiAgICBAc2VlIHtIYW5kbGVi
        YXJzLmhlbHBlcnMuYWN0aW9ufQoKICAgIEBwcm9wZXJ0eSBhY3Rpb25zCiAg
        ICBAdHlwZSBIYXNoCiAgICBAZGVmYXVsdCBudWxsCiAgKi8KICBhY3Rpb25z
        OiBudWxsLAoKICAvKioKICAgIEBkZXByZWNhdGVkCgogICAgUGxlYXNlIHVz
        ZSBgYWN0aW9uc2AgaW5zdGVhZC4KICAgIEBtZXRob2QgZXZlbnRzCiAgKi8K
        ICBldmVudHM6IG51bGwsCgogIG1lcmdlZFByb3BlcnRpZXM6IFsnZXZlbnRz
        J10sCgogIC8qKgogICAgVGhpcyBob29rIGlzIGV4ZWN1dGVkIHdoZW4gdGhl
        IHJvdXRlciBjb21wbGV0ZWx5IGV4aXRzIHRoaXMgcm91dGUuIEl0IGlzCiAg
        ICBub3QgZXhlY3V0ZWQgd2hlbiB0aGUgbW9kZWwgZm9yIHRoZSByb3V0ZSBj
        aGFuZ2VzLgoKICAgIEBtZXRob2QgZGVhY3RpdmF0ZQogICovCiAgZGVhY3Rp
        dmF0ZTogRW1iZXIuSywKCiAgLyoqCiAgICBUaGlzIGhvb2sgaXMgZXhlY3V0
        ZWQgd2hlbiB0aGUgcm91dGVyIGVudGVycyB0aGUgcm91dGUgZm9yIHRoZSBm
        aXJzdCB0aW1lLgogICAgSXQgaXMgbm90IGV4ZWN1dGVkIHdoZW4gdGhlIG1v
        ZGVsIGZvciB0aGUgcm91dGUgY2hhbmdlcy4KCiAgICBAbWV0aG9kIGFjdGl2
        YXRlCiAgKi8KICBhY3RpdmF0ZTogRW1iZXIuSywKCiAgLyoqCiAgICBUcmFu
        c2l0aW9uIGludG8gYW5vdGhlciByb3V0ZS4gT3B0aW9uYWxseSBzdXBwbHkg
        bW9kZWwocykgZm9yIHRoZQogICAgcm91dGUgaW4gcXVlc3Rpb24uIElmIG11
        bHRpcGxlIG1vZGVscyBhcmUgc3VwcGxpZWQgdGhleSB3aWxsIGJlIGFwcGxp
        ZWQKICAgIGxhc3QgdG8gZmlyc3QgcmVjdXJzaXZlbHkgdXAgdGhlIHJlc291
        cmNlIHRyZWUgKHNlZSBNdWx0aXBsZSBNb2RlbHMgRXhhbXBsZQogICAgYmVs
        b3cpLiBUaGUgbW9kZWwocykgd2lsbCBiZSBzZXJpYWxpemVkIGludG8gdGhl
        IFVSTCB1c2luZyB0aGUgYXBwcm9wcmlhdGUgCiAgICByb3V0ZSdzIGBzZXJp
        YWxpemVgIGhvb2suIFNlZSBhbHNvICdyZXBsYWNlV2l0aCcuCgogICAgU2lt
        cGxlIFRyYW5zaXRpb24gRXhhbXBsZQoKICAgIGBgYGphdmFzY3JpcHQKICAg
        IEFwcC5Sb3V0ZXIubWFwKGZ1bmN0aW9uKCkgewogICAgICB0aGlzLnJvdXRl
        KCJpbmRleCIpOwogICAgICB0aGlzLnJvdXRlKCJzZWNyZXQiKTsKICAgICAg
        dGhpcy5yb3V0ZSgiZm91ck9oRm91ciIsIHsgcGF0aDogIio6In0pOwogICAg
        fSk7CgogICAgQXBwLkluZGV4Um91dGUgPSBFbWJlci5Sb3V0ZS5leHRlbmQo
        ewogICAgICBhY3Rpb25zOiB7CiAgICAgICAgbW92ZVRvU2VjcmV0OiBmdW5j
        dGlvbihjb250ZXh0KXsKICAgICAgICAgIGlmIChhdXRob3JpemVkKCkpewog
        ICAgICAgICAgICB0aGlzLnRyYW5zaXRpb25Ubygnc2VjcmV0JywgY29udGV4
        dCk7CiAgICAgICAgICB9CiAgICAgICAgICAgIHRoaXMudHJhbnNpdGlvblRv
        KCdmb3VyT2hGb3VyJyk7CiAgICAgICAgfQogICAgICB9CiAgICB9KTsKICAg
        IGBgYAoKICAgIE11bHRpcGxlIE1vZGVscyBFeGFtcGxlCgogICAgYGBgamF2
        YXNjcmlwdAogICAgQXBwLlJvdXRlci5tYXAoZnVuY3Rpb24oKSB7CiAgICAg
        IHRoaXMucm91dGUoImluZGV4Iik7CiAgICAgIHRoaXMucmVzb3VyY2UoJ2Jy
        ZWFrZmFzdCcsIHtwYXRoOic6YnJlYWtmYXN0SWQnfSwgZnVuY3Rpb24oKXsK
        ICAgICAgICB0aGlzLnJlc291cmNlKCdjZXJlYWwnLCB7cGF0aDogJzpjZXJl
        YWxJZCd9KTsKICAgICAgfSk7CiAgICB9KTsKCiAgICBBcHAuSW5kZXhSb3V0
        ZSA9IEVtYmVyLlJvdXRlLmV4dGVuZCh7CiAgICAgIGFjdGlvbnM6IHsKICAg
        ICAgICBtb3ZlVG9DaG9jb2xhdGVDZXJlYWw6IGZ1bmN0aW9uKCl7CiAgICAg
        ICAgICB2YXIgY2VyZWFsID0geyBjZXJlYWxJZDogIkNob2NvbGF0ZVl1bW1p
        bmVzcyJ9LAogICAgICAgICAgICAgIGJyZWFrZmFzdCA9IHticmVha2Zhc3RJ
        ZDogIkNlcmVhbEFuZE1pbGsifTsKCiAgICAgICAgICB0aGlzLnRyYW5zaXRp
        b25UbygnY2VyZWFsJywgYnJlYWtmYXN0LCBjZXJlYWwpOwogICAgICAgIH0K
        ICAgICAgfQogICAgfSk7CgogICAgQG1ldGhvZCB0cmFuc2l0aW9uVG8KICAg
        IEBwYXJhbSB7U3RyaW5nfSBuYW1lIHRoZSBuYW1lIG9mIHRoZSByb3V0ZQog
        ICAgQHBhcmFtIHsuLi5PYmplY3R9IG1vZGVscyB0aGUgbW9kZWwocykgdG8g
        YmUgdXNlZCB3aGlsZSB0cmFuc2l0aW9uaW5nCiAgICB0byB0aGUgcm91dGUu
        CiAgKi8KICB0cmFuc2l0aW9uVG86IGZ1bmN0aW9uKG5hbWUsIGNvbnRleHQp
        IHsKICAgIHZhciByb3V0ZXIgPSB0aGlzLnJvdXRlcjsKICAgIHJldHVybiBy
        b3V0ZXIudHJhbnNpdGlvblRvLmFwcGx5KHJvdXRlciwgYXJndW1lbnRzKTsK
        ICB9LAoKICAvKioKICAgIFRyYW5zaXRpb24gaW50byBhbm90aGVyIHJvdXRl
        IHdoaWxlIHJlcGxhY2luZyB0aGUgY3VycmVudCBVUkwsIGlmIHBvc3NpYmxl
        LgogICAgVGhpcyB3aWxsIHJlcGxhY2UgdGhlIGN1cnJlbnQgaGlzdG9yeSBl
        bnRyeSBpbnN0ZWFkIG9mIGFkZGluZyBhIG5ldyBvbmUuIAogICAgQmVzaWRl
        IHRoYXQsIGl0IGlzIGlkZW50aWNhbCB0byBgdHJhbnNpdGlvblRvYCBpbiBh
        bGwgb3RoZXIgcmVzcGVjdHMuIFNlZQogICAgJ3RyYW5zaXRpb25UbycgZm9y
        IGFkZGl0aW9uYWwgaW5mb3JtYXRpb24gcmVnYXJkaW5nIG11bHRpcGxlIG1v
        ZGVscy4KCiAgICBFeGFtcGxlCgogICAgYGBgamF2YXNjcmlwdAogICAgQXBw
        LlJvdXRlci5tYXAoZnVuY3Rpb24oKSB7CiAgICAgIHRoaXMucm91dGUoImlu
        ZGV4Iik7CiAgICAgIHRoaXMucm91dGUoInNlY3JldCIpOwogICAgfSk7Cgog
        ICAgQXBwLlNlY3JldFJvdXRlID0gRW1iZXIuUm91dGUuZXh0ZW5kKHsKICAg
        ICAgYWZ0ZXJNb2RlbDogZnVuY3Rpb24oKSB7CiAgICAgICAgaWYgKCFhdXRo
        b3JpemVkKCkpewogICAgICAgICAgdGhpcy5yZXBsYWNlV2l0aCgnaW5kZXgn
        KTsKICAgICAgICB9CiAgICAgIH0KICAgIH0pOwogICAgYGBgCgogICAgQG1l
        dGhvZCByZXBsYWNlV2l0aAogICAgQHBhcmFtIHtTdHJpbmd9IG5hbWUgdGhl
        IG5hbWUgb2YgdGhlIHJvdXRlCiAgICBAcGFyYW0gey4uLk9iamVjdH0gbW9k
        ZWxzIHRoZSBtb2RlbChzKSB0byBiZSB1c2VkIHdoaWxlIHRyYW5zaXRpb25p
        bmcKICAgIHRvIHRoZSByb3V0ZS4KICAqLwogIHJlcGxhY2VXaXRoOiBmdW5j
        dGlvbigpIHsKICAgIHZhciByb3V0ZXIgPSB0aGlzLnJvdXRlcjsKICAgIHJl
        dHVybiB0aGlzLnJvdXRlci5yZXBsYWNlV2l0aC5hcHBseSh0aGlzLnJvdXRl
        ciwgYXJndW1lbnRzKTsKICB9LAoKICAvKioKICAgIFNlbmRzIGFuIGFjdGlv
        biB0byB0aGUgcm91dGVyLCB3aGljaCB3aWxsIGRlbGVnYXRlIGl0IHRvIHRo
        ZSBjdXJyZW50bHkKICAgIGFjdGl2ZSByb3V0ZSBoaWVyYXJjaHkgcGVyIHRo
        ZSBidWJibGluZyBydWxlcyBleHBsYWluZWQgdW5kZXIgYGFjdGlvbnNgLgoK
        ICAgIEV4YW1wbGUKCiAgICBgYGBqYXZhc2NyaXB0CiAgICBBcHAuUm91dGVy
        Lm1hcChmdW5jdGlvbigpIHsKICAgICAgdGhpcy5yb3V0ZSgiaW5kZXgiKTsK
        ICAgIH0pOwoKICAgIEFwcC5BcHBsaWNhdGlvblJvdXRlID0gRW1iZXIuUm91
        dGUuZXh0ZW5kKHsKICAgICAgYWN0aW9uczogewogICAgICAgIHRyYWNrOiBm
        dW5jdGlvbihhcmcpIHsKICAgICAgICAgIGNvbnNvbGUubG9nKGFyZywgJ3dh
        cyBjbGlja2VkJyk7CiAgICAgICAgfQogICAgICB9CiAgICB9KTsKCiAgICBB
        cHAuSW5kZXhSb3V0ZSA9IEVtYmVyLlJvdXRlLmV4dGVuZCh7CiAgICAgIGFj
        dGlvbnM6IHsKICAgICAgICB0cmFja0lmRGVidWc6IGZ1bmN0aW9uKGFyZykg
        ewogICAgICAgICAgaWYgKGRlYnVnKSB7CiAgICAgICAgICAgIHRoaXMuc2Vu
        ZCgndHJhY2snLCBhcmcpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAg
        fQogICAgfSk7CiAgICBgYGAKCiAgICBAbWV0aG9kIHNlbmQKICAgIEBwYXJh
        bSB7U3RyaW5nfSBuYW1lIHRoZSBuYW1lIG9mIHRoZSBhY3Rpb24gdG8gdHJp
        Z2dlcgogICAgQHBhcmFtIHsuLi4qfSBhcmdzCiAgKi8KICBzZW5kOiBmdW5j
        dGlvbigpIHsKICAgIHJldHVybiB0aGlzLnJvdXRlci5zZW5kLmFwcGx5KHRo
        aXMucm91dGVyLCBhcmd1bWVudHMpOwogIH0sCgogIC8qKgogICAgQHByaXZh
        dGUKCiAgICBUaGlzIGhvb2sgaXMgdGhlIGVudHJ5IHBvaW50IGZvciByb3V0
        ZXIuanMKCiAgICBAbWV0aG9kIHNldHVwCiAgKi8KICBzZXR1cDogZnVuY3Rp
        b24oY29udGV4dCkgewogICAgdmFyIGNvbnRyb2xsZXJOYW1lID0gdGhpcy5j
        b250cm9sbGVyTmFtZSB8fCB0aGlzLnJvdXRlTmFtZSwKICAgICAgICBjb250
        cm9sbGVyID0gdGhpcy5jb250cm9sbGVyRm9yKGNvbnRyb2xsZXJOYW1lLCB0
        cnVlKTsKICAgIGlmICghY29udHJvbGxlcikgewogICAgICBjb250cm9sbGVy
        ID0gIHRoaXMuZ2VuZXJhdGVDb250cm9sbGVyKGNvbnRyb2xsZXJOYW1lLCBj
        b250ZXh0KTsKICAgIH0KCiAgICAvLyBBc3NpZ24gdGhlIHJvdXRlJ3MgY29u
        dHJvbGxlciBzbyB0aGF0IGl0IGNhbiBtb3JlIGVhc2lseSBiZQogICAgLy8g
        cmVmZXJlbmNlZCBpbiBhY3Rpb24gaGFuZGxlcnMKICAgIHRoaXMuY29udHJv
        bGxlciA9IGNvbnRyb2xsZXI7CgogICAgaWYgKHRoaXMuc2V0dXBDb250cm9s
        bGVycykgewogICAgICBFbWJlci5kZXByZWNhdGUoIkVtYmVyLlJvdXRlLnNl
        dHVwQ29udHJvbGxlcnMgaXMgZGVwcmVjYXRlZC4gUGxlYXNlIHVzZSBFbWJl
        ci5Sb3V0ZS5zZXR1cENvbnRyb2xsZXIoY29udHJvbGxlciwgbW9kZWwpIGlu
        c3RlYWQuIik7CiAgICAgIHRoaXMuc2V0dXBDb250cm9sbGVycyhjb250cm9s
        bGVyLCBjb250ZXh0KTsKICAgIH0gZWxzZSB7CiAgICAgIHRoaXMuc2V0dXBD
        b250cm9sbGVyKGNvbnRyb2xsZXIsIGNvbnRleHQpOwogICAgfQoKICAgIGlm
        ICh0aGlzLnJlbmRlclRlbXBsYXRlcykgewogICAgICBFbWJlci5kZXByZWNh
        dGUoIkVtYmVyLlJvdXRlLnJlbmRlclRlbXBsYXRlcyBpcyBkZXByZWNhdGVk
        LiBQbGVhc2UgdXNlIEVtYmVyLlJvdXRlLnJlbmRlclRlbXBsYXRlKGNvbnRy
        b2xsZXIsIG1vZGVsKSBpbnN0ZWFkLiIpOwogICAgICB0aGlzLnJlbmRlclRl
        bXBsYXRlcyhjb250ZXh0KTsKICAgIH0gZWxzZSB7CiAgICAgIHRoaXMucmVu
        ZGVyVGVtcGxhdGUoY29udHJvbGxlciwgY29udGV4dCk7CiAgICB9CiAgfSwK
        CiAgLyoqCiAgICBBIGhvb2sgeW91IGNhbiBpbXBsZW1lbnQgdG8gb3B0aW9u
        YWxseSByZWRpcmVjdCB0byBhbm90aGVyIHJvdXRlLgoKICAgIElmIHlvdSBj
        YWxsIGB0aGlzLnRyYW5zaXRpb25Ub2AgZnJvbSBpbnNpZGUgb2YgdGhpcyBo
        b29rLCB0aGlzIHJvdXRlCiAgICB3aWxsIG5vdCBiZSBlbnRlcmVkIGluIGZh
        dm9yIG9mIHRoZSBvdGhlciBob29rLgoKICAgIE5vdGUgdGhhdCB0aGlzIGhv
        b2sgaXMgY2FsbGVkIGJ5IHRoZSBkZWZhdWx0IGltcGxlbWVudGF0aW9uIG9m
        CiAgICBgYWZ0ZXJNb2RlbGAsIHNvIGlmIHlvdSBvdmVycmlkZSBgYWZ0ZXJN
        b2RlbGAsIHlvdSBtdXN0IGVpdGhlcgogICAgZXhwbGljaXRseSBjYWxsIGBy
        ZWRpcmVjdGAgb3IganVzdCBwdXQgeW91ciByZWRpcmVjdGluZwogICAgYHRo
        aXMudHJhbnNpdGlvblRvKClgIGNhbGwgd2l0aGluIGBhZnRlck1vZGVsYC4K
        CiAgICBAbWV0aG9kIHJlZGlyZWN0CiAgICBAcGFyYW0ge09iamVjdH0gbW9k
        ZWwgdGhlIG1vZGVsIGZvciB0aGlzIHJvdXRlCiAgKi8KICByZWRpcmVjdDog
        RW1iZXIuSywKCiAgLyoqCiAgICBUaGlzIGhvb2sgaXMgdGhlIGZpcnN0IG9m
        IHRoZSByb3V0ZSBlbnRyeSB2YWxpZGF0aW9uIGhvb2tzCiAgICBjYWxsZWQg
        d2hlbiBhbiBhdHRlbXB0IGlzIG1hZGUgdG8gdHJhbnNpdGlvbiBpbnRvIGEg
        cm91dGUKICAgIG9yIG9uZSBvZiBpdHMgY2hpbGRyZW4uIEl0IGlzIGNhbGxl
        ZCBiZWZvcmUgYG1vZGVsYCBhbmQKICAgIGBhZnRlck1vZGVsYCwgYW5kIGlz
        IGFwcHJvcHJpYXRlIGZvciBjYXNlcyB3aGVuOgoKICAgIDEpIEEgZGVjaXNp
        b24gY2FuIGJlIG1hZGUgdG8gcmVkaXJlY3QgZWxzZXdoZXJlIHdpdGhvdXQK
        ICAgICAgIG5lZWRpbmcgdG8gcmVzb2x2ZSB0aGUgbW9kZWwgZmlyc3QuCiAg
        ICAyKSBBbnkgYXN5bmMgb3BlcmF0aW9ucyBuZWVkIHRvIG9jY3VyIGZpcnN0
        IGJlZm9yZSB0aGUKICAgICAgIG1vZGVsIGlzIGF0dGVtcHRlZCB0byBiZSBy
        ZXNvbHZlZC4KCiAgICBUaGlzIGhvb2sgaXMgcHJvdmlkZWQgdGhlIGN1cnJl
        bnQgYHRyYW5zaXRpb25gIGF0dGVtcHQKICAgIGFzIGEgcGFyYW1ldGVyLCB3
        aGljaCBjYW4gYmUgdXNlZCB0byBgLmFib3J0KClgIHRoZSB0cmFuc2l0aW9u
        LAogICAgc2F2ZSBpdCBmb3IgYSBsYXRlciBgLnJldHJ5KClgLCBvciByZXRy
        aWV2ZSB2YWx1ZXMgc2V0CiAgICBvbiBpdCBmcm9tIGEgcHJldmlvdXMgaG9v
        ay4gWW91IGNhbiBhbHNvIGp1c3QgY2FsbAogICAgYHRoaXMudHJhbnNpdGlv
        blRvYCB0byBhbm90aGVyIHJvdXRlIHRvIGltcGxpY2l0bHkKICAgIGFib3J0
        IHRoZSBgdHJhbnNpdGlvbmAuCgogICAgWW91IGNhbiByZXR1cm4gYSBwcm9t
        aXNlIGZyb20gdGhpcyBob29rIHRvIHBhdXNlIHRoZQogICAgdHJhbnNpdGlv
        biB1bnRpbCB0aGUgcHJvbWlzZSByZXNvbHZlcyAob3IgcmVqZWN0cykuIFRo
        aXMgY291bGQKICAgIGJlIHVzZWZ1bCwgZm9yIGluc3RhbmNlLCBmb3IgcmV0
        cmlldmluZyBhc3luYyBjb2RlIGZyb20KICAgIHRoZSBzZXJ2ZXIgdGhhdCBp
        cyByZXF1aXJlZCB0byBlbnRlciBhIHJvdXRlLgoKICAgIGBgYGpzCiAgICBB
        cHAuUG9zdFJvdXRlID0gRW1iZXIuUm91dGUuZXh0ZW5kKHsKICAgICAgYmVm
        b3JlTW9kZWw6IGZ1bmN0aW9uKHRyYW5zaXRpb24pIHsKICAgICAgICBpZiAo
        IUFwcC5Qb3N0KSB7CiAgICAgICAgICByZXR1cm4gRW1iZXIuJC5nZXRTY3Jp
        cHQoJy9tb2RlbHMvcG9zdC5qcycpOwogICAgICAgIH0KICAgICAgfQogICAg
        fSk7CiAgICBgYGAKCiAgICBJZiBgQXBwLlBvc3RgIGRvZXNuJ3QgZXhpc3Qg
        aW4gdGhlIGFib3ZlIGV4YW1wbGUsCiAgICBgYmVmb3JlTW9kZWxgIHdpbGwg
        dXNlIGpRdWVyeSdzIGBnZXRTY3JpcHRgLCB3aGljaAogICAgcmV0dXJucyBh
        IHByb21pc2UgdGhhdCByZXNvbHZlcyBhZnRlciB0aGUgc2VydmVyIGhhcwog
        ICAgc3VjY2Vzc2Z1bGx5IHJldHJpZXZlZCBhbmQgZXhlY3V0ZWQgdGhlIGNv
        ZGUgZnJvbSB0aGUKICAgIHNlcnZlci4gTm90ZSB0aGF0IGlmIGFuIGVycm9y
        IHdlcmUgdG8gb2NjdXIsIGl0IHdvdWxkCiAgICBiZSBwYXNzZWQgdG8gdGhl
        IGBlcnJvcmAgaG9vayBvbiBgRW1iZXIuUm91dGVgLCBidXQKICAgIGl0J3Mg
        YWxzbyBwb3NzaWJsZSB0byBoYW5kbGUgZXJyb3JzIHNwZWNpZmljIHRvCiAg
        ICBgYmVmb3JlTW9kZWxgIHJpZ2h0IGZyb20gd2l0aGluIHRoZSBob29rICh0
        byBkaXN0aW5ndWlzaAogICAgZnJvbSB0aGUgc2hhcmVkIGVycm9yIGhhbmRs
        aW5nIGJlaGF2aW9yIG9mIHRoZSBgZXJyb3JgCiAgICBob29rKToKCiAgICBg
        YGBqcwogICAgQXBwLlBvc3RSb3V0ZSA9IEVtYmVyLlJvdXRlLmV4dGVuZCh7
        CiAgICAgIGJlZm9yZU1vZGVsOiBmdW5jdGlvbih0cmFuc2l0aW9uKSB7CiAg
        ICAgICAgaWYgKCFBcHAuUG9zdCkgewogICAgICAgICAgdmFyIHNlbGYgPSB0
        aGlzOwogICAgICAgICAgcmV0dXJuIEVtYmVyLiQuZ2V0U2NyaXB0KCdwb3N0
        LmpzJykudGhlbihudWxsLCBmdW5jdGlvbihlKSB7CiAgICAgICAgICAgIHNl
        bGYudHJhbnNpdGlvblRvKCdoZWxwJyk7CgogICAgICAgICAgICAvLyBOb3Rl
        IHRoYXQgdGhlIGFib3ZlIHRyYW5zaXRpb25UbyB3aWxsIGltcGxpY2l0bHkK
        ICAgICAgICAgICAgLy8gaGFsdCB0aGUgdHJhbnNpdGlvbi4gSWYgeW91IHdl
        cmUgdG8gcmV0dXJuCiAgICAgICAgICAgIC8vIG5vdGhpbmcgZnJvbSB0aGlz
        IHByb21pc2UgcmVqZWN0IGhhbmRsZXIsCiAgICAgICAgICAgIC8vIGFjY29y
        ZGluZyB0byBwcm9taXNlIHNlbWFudGljcywgdGhhdCB3b3VsZAogICAgICAg
        ICAgICAvLyBjb252ZXJ0IHRoZSByZWplY3QgaW50byBhIHJlc29sdmUgYW5k
        IHRoZQogICAgICAgICAgICAvLyB0cmFuc2l0aW9uIHdvdWxkIGNvbnRpbnVl
        LiBUbyBwcm9wYWdhdGUgdGhlCiAgICAgICAgICAgIC8vIGVycm9yIHNvIHRo
        YXQgaXQnZCBiZSBoYW5kbGVkIGJ5IHRoZSBgZXJyb3JgCiAgICAgICAgICAg
        IC8vIGhvb2ssIHlvdSB3b3VsZCBoYXZlIHRvIGVpdGhlcgogICAgICAgICAg
        ICByZXR1cm4gRW1iZXIuUlNWUC5yZWplY3QoZSk7CiAgICAgICAgICAgIC8v
        IG9yCiAgICAgICAgICAgIHRocm93IGU7CiAgICAgICAgICB9KTsKICAgICAg
        ICB9CiAgICAgIH0KICAgIH0pOwogICAgYGBgCgogICAgQG1ldGhvZCBiZWZv
        cmVNb2RlbAogICAgQHBhcmFtIHtUcmFuc2l0aW9ufSB0cmFuc2l0aW9uCiAg
        ICBAcmV0dXJuIHtQcm9taXNlfSBpZiB0aGUgdmFsdWUgcmV0dXJuZWQgZnJv
        bSB0aGlzIGhvb2sgaXMKICAgICAgYSBwcm9taXNlLCB0aGUgdHJhbnNpdGlv
        biB3aWxsIHBhdXNlIHVudGlsIHRoZSB0cmFuc2l0aW9uCiAgICAgIHJlc29s
        dmVzLiBPdGhlcndpc2UsIG5vbi1wcm9taXNlIHJldHVybiB2YWx1ZXMgYXJl
        IG5vdAogICAgICB1dGlsaXplZCBpbiBhbnkgd2F5LgogICovCiAgYmVmb3Jl
        TW9kZWw6IEVtYmVyLkssCgogIC8qKgogICAgVGhpcyBob29rIGlzIGNhbGxl
        ZCBhZnRlciB0aGlzIHJvdXRlJ3MgbW9kZWwgaGFzIHJlc29sdmVkLgogICAg
        SXQgZm9sbG93cyBpZGVudGljYWwgYXN5bmMvcHJvbWlzZSBzZW1hbnRpY3Mg
        dG8gYGJlZm9yZU1vZGVsYAogICAgYnV0IGlzIHByb3ZpZGVkIHRoZSByb3V0
        ZSdzIHJlc29sdmVkIG1vZGVsIGluIGFkZGl0aW9uIHRvCiAgICB0aGUgYHRy
        YW5zaXRpb25gLCBhbmQgaXMgdGhlcmVmb3JlIHN1aXRlZCB0byBwZXJmb3Jt
        aW5nCiAgICBsb2dpYyB0aGF0IGNhbiBvbmx5IHRha2UgcGxhY2UgYWZ0ZXIg
        dGhlIG1vZGVsIGhhcyBhbHJlYWR5CiAgICByZXNvbHZlZC4KCiAgICBgYGBq
        cwogICAgQXBwLlBvc3RzUm91dGUgPSBFbWJlci5Sb3V0ZS5leHRlbmQoewog
        ICAgICBhZnRlck1vZGVsOiBmdW5jdGlvbihwb3N0cywgdHJhbnNpdGlvbikg
        ewogICAgICAgIGlmIChwb3N0cy5sZW5ndGggPT09IDEpIHsKICAgICAgICAg
        IHRoaXMudHJhbnNpdGlvblRvKCdwb3N0LnNob3cnLCBwb3N0c1swXSk7CiAg
        ICAgICAgfQogICAgICB9CiAgICB9KTsKICAgIGBgYAoKICAgIFJlZmVyIHRv
        IGRvY3VtZW50YXRpb24gZm9yIGBiZWZvcmVNb2RlbGAgZm9yIGEgZGVzY3Jp
        cHRpb24KICAgIG9mIHRyYW5zaXRpb24tcGF1c2luZyBzZW1hbnRpY3Mgd2hl
        biBhIHByb21pc2UgaXMgcmV0dXJuZWQKICAgIGZyb20gdGhpcyBob29rLgoK
        ICAgIEBtZXRob2QgYWZ0ZXJNb2RlbAogICAgQHBhcmFtIHtPYmplY3R9IHJl
        c29sdmVkTW9kZWwgdGhlIHZhbHVlIHJldHVybmVkIGZyb20gYG1vZGVsYCwK
        ICAgICAgb3IgaXRzIHJlc29sdmVkIHZhbHVlIGlmIGl0IHdhcyBhIHByb21p
        c2UKICAgIEBwYXJhbSB7VHJhbnNpdGlvbn0gdHJhbnNpdGlvbgogICAgQHJl
        dHVybiB7UHJvbWlzZX0gaWYgdGhlIHZhbHVlIHJldHVybmVkIGZyb20gdGhp
        cyBob29rIGlzCiAgICAgIGEgcHJvbWlzZSwgdGhlIHRyYW5zaXRpb24gd2ls
        bCBwYXVzZSB1bnRpbCB0aGUgdHJhbnNpdGlvbgogICAgICByZXNvbHZlcy4g
        T3RoZXJ3aXNlLCBub24tcHJvbWlzZSByZXR1cm4gdmFsdWVzIGFyZSBub3QK
        ICAgICAgdXRpbGl6ZWQgaW4gYW55IHdheS4KICAgKi8KICBhZnRlck1vZGVs
        OiBmdW5jdGlvbihyZXNvbHZlZE1vZGVsLCB0cmFuc2l0aW9uKSB7CiAgICB0
        aGlzLnJlZGlyZWN0KHJlc29sdmVkTW9kZWwsIHRyYW5zaXRpb24pOwogIH0s
        CgoKICAvKioKICAgIEBwcml2YXRlCgogICAgQ2FsbGVkIHdoZW4gdGhlIGNv
        bnRleHQgaXMgY2hhbmdlZCBieSByb3V0ZXIuanMuCgogICAgQG1ldGhvZCBj
        b250ZXh0RGlkQ2hhbmdlCiAgKi8KICBjb250ZXh0RGlkQ2hhbmdlOiBmdW5j
        dGlvbigpIHsKICAgIHRoaXMuY3VycmVudE1vZGVsID0gdGhpcy5jb250ZXh0
        OwogIH0sCgogIC8qKgogICAgQSBob29rIHlvdSBjYW4gaW1wbGVtZW50IHRv
        IGNvbnZlcnQgdGhlIFVSTCBpbnRvIHRoZSBtb2RlbCBmb3IKICAgIHRoaXMg
        cm91dGUuCgogICAgYGBganMKICAgIEFwcC5Sb3V0ZXIubWFwKGZ1bmN0aW9u
        KCkgewogICAgICB0aGlzLnJlc291cmNlKCdwb3N0Jywge3BhdGg6ICcvcG9z
        dHMvOnBvc3RfaWQnfSk7CiAgICB9KTsKICAgIGBgYAoKICAgIFRoZSBtb2Rl
        bCBmb3IgdGhlIGBwb3N0YCByb3V0ZSBpcyBgQXBwLlBvc3QuZmluZChwYXJh
        bXMucG9zdF9pZClgLgoKICAgIEJ5IGRlZmF1bHQsIGlmIHlvdXIgcm91dGUg
        aGFzIGEgZHluYW1pYyBzZWdtZW50IGVuZGluZyBpbiBgX2lkYDoKCiAgICAq
        IFRoZSBtb2RlbCBjbGFzcyBpcyBkZXRlcm1pbmVkIGZyb20gdGhlIHNlZ21l
        bnQgKGBwb3N0X2lkYCdzCiAgICAgIGNsYXNzIGlzIGBBcHAuUG9zdGApCiAg
        ICAqIFRoZSBmaW5kIG1ldGhvZCBpcyBjYWxsZWQgb24gdGhlIG1vZGVsIGNs
        YXNzIHdpdGggdGhlIHZhbHVlIG9mCiAgICAgIHRoZSBkeW5hbWljIHNlZ21l
        bnQuCgogICAgTm90ZSB0aGF0IGZvciByb3V0ZXMgd2l0aCBkeW5hbWljIHNl
        Z21lbnRzLCB0aGlzIGhvb2sgaXMgb25seQogICAgZXhlY3V0ZWQgd2hlbiBl
        bnRlcmVkIHZpYSB0aGUgVVJMLiBJZiB0aGUgcm91dGUgaXMgZW50ZXJlZAog
        ICAgdGhyb3VnaCBhIHRyYW5zaXRpb24gKGUuZy4gd2hlbiB1c2luZyB0aGUg
        YGxpbmtUb2AgSGFuZGxlYmFycwogICAgaGVscGVyKSwgdGhlbiBhIG1vZGVs
        IGNvbnRleHQgaXMgYWxyZWFkeSBwcm92aWRlZCBhbmQgdGhpcyBob29rCiAg
        ICBpcyBub3QgY2FsbGVkLiBSb3V0ZXMgd2l0aG91dCBkeW5hbWljIHNlZ21l
        bnRzIHdpbGwgYWx3YXlzCiAgICBleGVjdXRlIHRoZSBtb2RlbCBob29rLgoK
        ICAgIFRoaXMgaG9vayBmb2xsb3dzIHRoZSBhc3luY2hyb25vdXMvcHJvbWlz
        ZSBzZW1hbnRpY3MKICAgIGRlc2NyaWJlZCBpbiB0aGUgZG9jdW1lbnRhdGlv
        biBmb3IgYGJlZm9yZU1vZGVsYC4gSW4gcGFydGljdWxhciwKICAgIGlmIGEg
        cHJvbWlzZSByZXR1cm5lZCBmcm9tIGBtb2RlbGAgZmFpbHMsIHRoZSBlcnJv
        ciB3aWxsIGJlCiAgICBoYW5kbGVkIGJ5IHRoZSBgZXJyb3JgIGhvb2sgb24g
        YEVtYmVyLlJvdXRlYC4KCiAgICBFeGFtcGxlCgogICAgYGBganMKICAgIEFw
        cC5Qb3N0Um91dGUgPSBFbWJlci5Sb3V0ZS5leHRlbmQoewogICAgICBtb2Rl
        bDogZnVuY3Rpb24ocGFyYW1zKSB7CiAgICAgICAgcmV0dXJuIEFwcC5Qb3N0
        LmZpbmQocGFyYW1zLnBvc3RfaWQpOwogICAgICB9CiAgICB9KTsKICAgIGBg
        YAoKICAgIEBtZXRob2QgbW9kZWwKICAgIEBwYXJhbSB7T2JqZWN0fSBwYXJh
        bXMgdGhlIHBhcmFtZXRlcnMgZXh0cmFjdGVkIGZyb20gdGhlIFVSTAogICAg
        QHBhcmFtIHtUcmFuc2l0aW9ufSB0cmFuc2l0aW9uCiAgICBAcmV0dXJuIHtP
        YmplY3R8UHJvbWlzZX0gdGhlIG1vZGVsIGZvciB0aGlzIHJvdXRlLiBJZgog
        ICAgICBhIHByb21pc2UgaXMgcmV0dXJuZWQsIHRoZSB0cmFuc2l0aW9uIHdp
        bGwgcGF1c2UgdW50aWwKICAgICAgdGhlIHByb21pc2UgcmVzb2x2ZXMsIGFu
        ZCB0aGUgcmVzb2x2ZWQgdmFsdWUgb2YgdGhlIHByb21pc2UKICAgICAgd2ls
        bCBiZSB1c2VkIGFzIHRoZSBtb2RlbCBmb3IgdGhpcyByb3V0ZS4KICAqLwog
        IG1vZGVsOiBmdW5jdGlvbihwYXJhbXMsIHRyYW5zaXRpb24pIHsKICAgIHZh
        ciBtYXRjaCwgbmFtZSwgc2F3UGFyYW1zLCB2YWx1ZTsKCiAgICBmb3IgKHZh
        ciBwcm9wIGluIHBhcmFtcykgewogICAgICBpZiAobWF0Y2ggPSBwcm9wLm1h
        dGNoKC9eKC4qKV9pZCQvKSkgewogICAgICAgIG5hbWUgPSBtYXRjaFsxXTsK
        ICAgICAgICB2YWx1ZSA9IHBhcmFtc1twcm9wXTsKICAgICAgfQogICAgICBz
        YXdQYXJhbXMgPSB0cnVlOwogICAgfQoKICAgIGlmICghbmFtZSAmJiBzYXdQ
        YXJhbXMpIHsgcmV0dXJuIHBhcmFtczsgfQogICAgZWxzZSBpZiAoIW5hbWUp
        IHsgcmV0dXJuOyB9CgogICAgcmV0dXJuIHRoaXMuZmluZE1vZGVsKG5hbWUs
        IHZhbHVlKTsKICB9LAoKICAvKioKCiAgICBAbWV0aG9kIGZpbmRNb2RlbAog
        ICAgQHBhcmFtIHtTdHJpbmd9IHR5cGUgdGhlIG1vZGVsIHR5cGUKICAgIEBw
        YXJhbSB7T2JqZWN0fSB2YWx1ZSB0aGUgdmFsdWUgcGFzc2VkIHRvIGZpbmQK
        ICAqLwogIGZpbmRNb2RlbDogZnVuY3Rpb24oKXsKICAgIHZhciBzdG9yZSA9
        IGdldCh0aGlzLCAnc3RvcmUnKTsKICAgIHJldHVybiBzdG9yZS5maW5kLmFw
        cGx5KHN0b3JlLCBhcmd1bWVudHMpOwogIH0sCgogIC8qKgogICAgU3RvcmUg
        cHJvcGVydHkgcHJvdmlkZXMgYSBob29rIGZvciBkYXRhIHBlcnNpc3RlbmNl
        IGxpYnJhcmllcyB0byBpbmplY3QgdGhlbXNlbHZlcy4KCiAgICBCeSBkZWZh
        dWx0LCB0aGlzIHN0b3JlIHByb3BlcnR5IHByb3ZpZGVzIHRoZSBleGFjdCBz
        YW1lIGZ1bmN0aW9uYWxpdHkgcHJldmlvdXNseQogICAgaW4gdGhlIG1vZGVs
        IGhvb2suCgogICAgQ3VycmVudGx5LCB0aGUgcmVxdWlyZWQgaW50ZXJmYWNl
        IGlzOgoKICAgIGBzdG9yZS5maW5kKG1vZGVsTmFtZSwgZmluZEFyZ3VtZW50
        cylgCgogICAgQG1ldGhvZCBzdG9yZQogICAgQHBhcmFtIHtPYmplY3R9IHN0
        b3JlCiAgKi8KICBzdG9yZTogRW1iZXIuY29tcHV0ZWQoZnVuY3Rpb24oKXsK
        ICAgIHZhciBjb250YWluZXIgPSB0aGlzLmNvbnRhaW5lcjsKICAgIHZhciBy
        b3V0ZU5hbWUgPSB0aGlzLnJvdXRlTmFtZTsKICAgIHZhciBuYW1lc3BhY2Ug
        PSBnZXQodGhpcywgJ3JvdXRlci5uYW1lc3BhY2UnKTsKCiAgICByZXR1cm4g
        ewogICAgICBmaW5kOiBmdW5jdGlvbihuYW1lLCB2YWx1ZSkgewogICAgICAg
        IHZhciBtb2RlbENsYXNzID0gY29udGFpbmVyLmxvb2t1cEZhY3RvcnkoJ21v
        ZGVsOicgKyBuYW1lKTsKCiAgICAgICAgRW1iZXIuYXNzZXJ0KCJZb3UgdXNl
        ZCB0aGUgZHluYW1pYyBzZWdtZW50ICIgKyBuYW1lICsgIl9pZCBpbiB5b3Vy
        IHJvdXRlICIrIHJvdXRlTmFtZSArICIsIGJ1dCAiICsgbmFtZXNwYWNlICsg
        Ii4iICsgY2xhc3NpZnkobmFtZSkgKyAiIGRpZCBub3QgZXhpc3QgYW5kIHlv
        dSBkaWQgbm90IG92ZXJyaWRlIHlvdXIgcm91dGUncyBgbW9kZWxgIGhvb2su
        IiwgbW9kZWxDbGFzcyk7CgogICAgICAgIHJldHVybiBtb2RlbENsYXNzLmZp
        bmQodmFsdWUpOwogICAgICB9CiAgICB9OwogIH0pLAoKICAvKioKICAgIEEg
        aG9vayB5b3UgY2FuIGltcGxlbWVudCB0byBjb252ZXJ0IHRoZSByb3V0ZSdz
        IG1vZGVsIGludG8gcGFyYW1ldGVycwogICAgZm9yIHRoZSBVUkwuCgogICAg
        YGBganMKICAgIEFwcC5Sb3V0ZXIubWFwKGZ1bmN0aW9uKCkgewogICAgICB0
        aGlzLnJlc291cmNlKCdwb3N0Jywge3BhdGg6ICcvcG9zdHMvOnBvc3RfaWQn
        fSk7CiAgICB9KTsKCiAgICBBcHAuUG9zdFJvdXRlID0gRW1iZXIuUm91dGUu
        ZXh0ZW5kKHsKICAgICAgbW9kZWw6IGZ1bmN0aW9uKHBhcmFtcykgewogICAg
        ICAgIC8vIHRoZSBzZXJ2ZXIgcmV0dXJucyBgeyBpZDogMTIgfWAKICAgICAg
        ICByZXR1cm4galF1ZXJ5LmdldEpTT04oIi9wb3N0cy8iICsgcGFyYW1zLnBv
        c3RfaWQpOwogICAgICB9LAoKICAgICAgc2VyaWFsaXplOiBmdW5jdGlvbiht
        b2RlbCkgewogICAgICAgIC8vIHRoaXMgd2lsbCBtYWtlIHRoZSBVUkwgYC9w
        b3N0cy8xMmAKICAgICAgICByZXR1cm4geyBwb3N0X2lkOiBtb2RlbC5pZCB9
        OwogICAgICB9CiAgICB9KTsKICAgIGBgYAoKICAgIFRoZSBkZWZhdWx0IGBz
        ZXJpYWxpemVgIG1ldGhvZCB3aWxsIGluc2VydCB0aGUgbW9kZWwncyBgaWRg
        IGludG8gdGhlCiAgICByb3V0ZSdzIGR5bmFtaWMgc2VnbWVudCAoaW4gdGhp
        cyBjYXNlLCBgOnBvc3RfaWRgKSBpZiB0aGUgc2VnbWVudCBjb250YWlucyAn
        X2lkJy4KICAgIElmIHRoZSByb3V0ZSBoYXMgbXVsdGlwbGUgZHluYW1pYyBz
        ZWdtZW50cyBvciBkb2VzIG5vdCBjb250YWluICdfaWQnLCBgc2VyaWFsaXpl
        YAogICAgd2lsbCByZXR1cm4gYEVtYmVyLmdldFByb3BlcnRpZXMobW9kZWws
        IHBhcmFtcylgCgogICAgVGhpcyBtZXRob2QgaXMgY2FsbGVkIHdoZW4gYHRy
        YW5zaXRpb25Ub2AgaXMgY2FsbGVkIHdpdGggYSBjb250ZXh0CiAgICBpbiBv
        cmRlciB0byBwb3B1bGF0ZSB0aGUgVVJMLgoKICAgIEBtZXRob2Qgc2VyaWFs
        aXplCiAgICBAcGFyYW0ge09iamVjdH0gbW9kZWwgdGhlIHJvdXRlJ3MgbW9k
        ZWwKICAgIEBwYXJhbSB7QXJyYXl9IHBhcmFtcyBhbiBBcnJheSBvZiBwYXJh
        bWV0ZXIgbmFtZXMgZm9yIHRoZSBjdXJyZW50CiAgICAgIHJvdXRlIChpbiB0
        aGUgZXhhbXBsZSwgYFsncG9zdF9pZCddYC4KICAgIEByZXR1cm4ge09iamVj
        dH0gdGhlIHNlcmlhbGl6ZWQgcGFyYW1ldGVycwogICovCiAgc2VyaWFsaXpl
        OiBmdW5jdGlvbihtb2RlbCwgcGFyYW1zKSB7CiAgICBpZiAocGFyYW1zLmxl
        bmd0aCA8IDEpIHsgcmV0dXJuOyB9CgogICAgdmFyIG5hbWUgPSBwYXJhbXNb
        MF0sIG9iamVjdCA9IHt9OwoKICAgIGlmICgvX2lkJC8udGVzdChuYW1lKSAm
        JiBwYXJhbXMubGVuZ3RoID09PSAxKSB7CiAgICAgIG9iamVjdFtuYW1lXSA9
        IGdldChtb2RlbCwgImlkIik7CiAgICB9IGVsc2UgewogICAgICBvYmplY3Qg
        PSBnZXRQcm9wZXJ0aWVzKG1vZGVsLCBwYXJhbXMpOwogICAgfQoKICAgIHJl
        dHVybiBvYmplY3Q7CiAgfSwKCiAgLyoqCiAgICBBIGhvb2sgeW91IGNhbiB1
        c2UgdG8gc2V0dXAgdGhlIGNvbnRyb2xsZXIgZm9yIHRoZSBjdXJyZW50IHJv
        dXRlLgoKICAgIFRoaXMgbWV0aG9kIGlzIGNhbGxlZCB3aXRoIHRoZSBjb250
        cm9sbGVyIGZvciB0aGUgY3VycmVudCByb3V0ZSBhbmQgdGhlCiAgICBtb2Rl
        bCBzdXBwbGllZCBieSB0aGUgYG1vZGVsYCBob29rLgoKICAgIEJ5IGRlZmF1
        bHQsIHRoZSBgc2V0dXBDb250cm9sbGVyYCBob29rIHNldHMgdGhlIGBjb250
        ZW50YCBwcm9wZXJ0eSBvZgogICAgdGhlIGNvbnRyb2xsZXIgdG8gdGhlIGBt
        b2RlbGAuCgogICAgVGhpcyBtZWFucyB0aGF0IHlvdXIgdGVtcGxhdGUgd2ls
        bCBnZXQgYSBwcm94eSBmb3IgdGhlIG1vZGVsIGFzIGl0cwogICAgY29udGV4
        dCwgYW5kIHlvdSBjYW4gYWN0IGFzIHRob3VnaCB0aGUgbW9kZWwgaXRzZWxm
        IHdhcyB0aGUgY29udGV4dC4KCiAgICBUaGUgcHJvdmlkZWQgY29udHJvbGxl
        ciB3aWxsIGJlIG9uZSByZXNvbHZlZCBiYXNlZCBvbiB0aGUgbmFtZQogICAg
        b2YgdGhpcyByb3V0ZS4KCiAgICBJZiBubyBleHBsaWNpdCBjb250cm9sbGVy
        IGlzIGRlZmluZWQsIEVtYmVyIHdpbGwgYXV0b21hdGljYWxseSBjcmVhdGUK
        ICAgIGFuIGFwcHJvcHJpYXRlIGNvbnRyb2xsZXIgZm9yIHRoZSBtb2RlbC4K
        CiAgICAqIGlmIHRoZSBtb2RlbCBpcyBhbiBgRW1iZXIuQXJyYXlgIChpbmNs
        dWRpbmcgcmVjb3JkIGFycmF5cyBmcm9tIEVtYmVyCiAgICAgIERhdGEpLCB0
        aGUgY29udHJvbGxlciBpcyBhbiBgRW1iZXIuQXJyYXlDb250cm9sbGVyYC4K
        ICAgICogb3RoZXJ3aXNlLCB0aGUgY29udHJvbGxlciBpcyBhbiBgRW1iZXIu
        T2JqZWN0Q29udHJvbGxlcmAuCgogICAgQXMgYW4gZXhhbXBsZSwgY29uc2lk
        ZXIgdGhlIHJvdXRlcjoKCiAgICBgYGBqcwogICAgQXBwLlJvdXRlci5tYXAo
        ZnVuY3Rpb24oKSB7CiAgICAgIHRoaXMucmVzb3VyY2UoJ3Bvc3QnLCB7cGF0
        aDogJy9wb3N0cy86cG9zdF9pZCd9KTsKICAgIH0pOwogICAgYGBgCgogICAg
        Rm9yIHRoZSBgcG9zdGAgcm91dGUsIGEgY29udHJvbGxlciBuYW1lZCBgQXBw
        LlBvc3RDb250cm9sbGVyYCB3b3VsZAogICAgYmUgdXNlZCBpZiBpdCBpcyBk
        ZWZpbmVkLiBJZiBpdCBpcyBub3QgZGVmaW5lZCwgYW4gYEVtYmVyLk9iamVj
        dENvbnRyb2xsZXJgCiAgICBpbnN0YW5jZSB3b3VsZCBiZSB1c2VkLgoKICAg
        IEV4YW1wbGUKICAgIGBgYGpzCiAgICBBcHAuUG9zdFJvdXRlID0gRW1iZXIu
        Um91dGUuZXh0ZW5kKHsKICAgICAgc2V0dXBDb250cm9sbGVyOiBmdW5jdGlv
        bihjb250cm9sbGVyLCBtb2RlbCkgewogICAgICAgIGNvbnRyb2xsZXIuc2V0
        KCdtb2RlbCcsIG1vZGVsKTsKICAgICAgfQogICAgfSk7CiAgICBgYGAKCiAg
        ICBAbWV0aG9kIHNldHVwQ29udHJvbGxlcgogICAgQHBhcmFtIHtDb250cm9s
        bGVyfSBjb250cm9sbGVyIGluc3RhbmNlCiAgICBAcGFyYW0ge09iamVjdH0g
        bW9kZWwKICAqLwogIHNldHVwQ29udHJvbGxlcjogZnVuY3Rpb24oY29udHJv
        bGxlciwgY29udGV4dCkgewogICAgaWYgKGNvbnRyb2xsZXIgJiYgKGNvbnRl
        eHQgIT09IHVuZGVmaW5lZCkpIHsKICAgICAgc2V0KGNvbnRyb2xsZXIsICdt
        b2RlbCcsIGNvbnRleHQpOwogICAgfQogIH0sCgogIC8qKgogICAgUmV0dXJu
        cyB0aGUgY29udHJvbGxlciBmb3IgYSBwYXJ0aWN1bGFyIHJvdXRlIG9yIG5h
        bWUuCgogICAgVGhlIGNvbnRyb2xsZXIgaW5zdGFuY2UgbXVzdCBhbHJlYWR5
        IGhhdmUgYmVlbiBjcmVhdGVkLCBlaXRoZXIgdGhyb3VnaCBlbnRlcmluZyB0
        aGUKICAgIGFzc29jaWF0ZWQgcm91dGUgb3IgdXNpbmcgYGdlbmVyYXRlQ29u
        dHJvbGxlcmAuCgogICAgYGBganMKICAgIEFwcC5Qb3N0Um91dGUgPSBFbWJl
        ci5Sb3V0ZS5leHRlbmQoewogICAgICBzZXR1cENvbnRyb2xsZXI6IGZ1bmN0
        aW9uKGNvbnRyb2xsZXIsIHBvc3QpIHsKICAgICAgICB0aGlzLl9zdXBlcihj
        b250cm9sbGVyLCBwb3N0KTsKICAgICAgICB0aGlzLmNvbnRyb2xsZXJGb3Io
        J3Bvc3RzJykuc2V0KCdjdXJyZW50UG9zdCcsIHBvc3QpOwogICAgICB9CiAg
        ICB9KTsKICAgIGBgYAoKICAgIEBtZXRob2QgY29udHJvbGxlckZvcgogICAg
        QHBhcmFtIHtTdHJpbmd9IG5hbWUgdGhlIG5hbWUgb2YgdGhlIHJvdXRlIG9y
        IGNvbnRyb2xsZXIKICAgIEByZXR1cm4ge0VtYmVyLkNvbnRyb2xsZXJ9CiAg
        Ki8KICBjb250cm9sbGVyRm9yOiBmdW5jdGlvbihuYW1lLCBfc2tpcEFzc2Vy
        dCkgewogICAgdmFyIGNvbnRhaW5lciA9IHRoaXMuY29udGFpbmVyLAogICAg
        ICAgIHJvdXRlID0gY29udGFpbmVyLmxvb2t1cCgncm91dGU6JytuYW1lKSwK
        ICAgICAgICBjb250cm9sbGVyOwoKICAgIGlmIChyb3V0ZSAmJiByb3V0ZS5j
        b250cm9sbGVyTmFtZSkgewogICAgICBuYW1lID0gcm91dGUuY29udHJvbGxl
        ck5hbWU7CiAgICB9CgogICAgY29udHJvbGxlciA9IGNvbnRhaW5lci5sb29r
        dXAoJ2NvbnRyb2xsZXI6JyArIG5hbWUpOwoKICAgIC8vIE5PVEU6IFdlJ3Jl
        IHNwZWNpZmljYWxseSBjaGVja2luZyB0aGF0IHNraXBBc3NlcnQgaXMgdHJ1
        ZSwgYmVjYXVzZSBhY2NvcmRpbmcKICAgIC8vICAgdG8gdGhlIG9sZCBBUEkg
        dGhlIHNlY29uZCBwYXJhbWV0ZXIgd2FzIG1vZGVsLiBXZSBkbyBub3Qgd2Fu
        dCBwZW9wbGUgd2hvCiAgICAvLyAgIHBhc3NlZCBhIG1vZGVsIHRvIHNraXAg
        dGhlIGFzc2VydGlvbi4KICAgIEVtYmVyLmFzc2VydCgiVGhlIGNvbnRyb2xs
        ZXIgbmFtZWQgJyIrbmFtZSsiJyBjb3VsZCBub3QgYmUgZm91bmQuIE1ha2Ug
        c3VyZSB0aGF0IHRoaXMgcm91dGUgZXhpc3RzIGFuZCBoYXMgYWxyZWFkeSBi
        ZWVuIGVudGVyZWQgYXQgbGVhc3Qgb25jZS4gSWYgeW91IGFyZSBhY2Nlc3Np
        bmcgYSBjb250cm9sbGVyIG5vdCBhc3NvY2lhdGVkIHdpdGggYSByb3V0ZSwg
        bWFrZSBzdXJlIHRoZSBjb250cm9sbGVyIGNsYXNzIGlzIGV4cGxpY2l0bHkg
        ZGVmaW5lZC4iLCBjb250cm9sbGVyIHx8IF9za2lwQXNzZXJ0ID09PSB0cnVl
        KTsKCiAgICByZXR1cm4gY29udHJvbGxlcjsKICB9LAoKICAvKioKICAgIEdl
        bmVyYXRlcyBhIGNvbnRyb2xsZXIgZm9yIGEgcm91dGUuCgogICAgSWYgdGhl
        IG9wdGlvbmFsIG1vZGVsIGlzIHBhc3NlZCB0aGVuIHRoZSBjb250cm9sbGVy
        IHR5cGUgaXMgZGV0ZXJtaW5lZCBhdXRvbWF0aWNhbGx5LAogICAgZS5nLiwg
        YW4gQXJyYXlDb250cm9sbGVyIGZvciBhcnJheXMuCgogICAgRXhhbXBsZQoK
        ICAgIGBgYGpzCiAgICBBcHAuUG9zdFJvdXRlID0gRW1iZXIuUm91dGUuZXh0
        ZW5kKHsKICAgICAgc2V0dXBDb250cm9sbGVyOiBmdW5jdGlvbihjb250cm9s
        bGVyLCBwb3N0KSB7CiAgICAgICAgdGhpcy5fc3VwZXIoY29udHJvbGxlciwg
        cG9zdCk7CiAgICAgICAgdGhpcy5nZW5lcmF0ZUNvbnRyb2xsZXIoJ3Bvc3Rz
        JywgcG9zdCk7CiAgICAgIH0KICAgIH0pOwogICAgYGBgCgogICAgQG1ldGhv
        ZCBnZW5lcmF0ZUNvbnRyb2xsZXIKICAgIEBwYXJhbSB7U3RyaW5nfSBuYW1l
        IHRoZSBuYW1lIG9mIHRoZSBjb250cm9sbGVyCiAgICBAcGFyYW0ge09iamVj
        dH0gbW9kZWwgdGhlIG1vZGVsIHRvIGluZmVyIHRoZSB0eXBlIG9mIHRoZSBj
        b250cm9sbGVyIChvcHRpb25hbCkKICAqLwogIGdlbmVyYXRlQ29udHJvbGxl
        cjogZnVuY3Rpb24obmFtZSwgbW9kZWwpIHsKICAgIHZhciBjb250YWluZXIg
        PSB0aGlzLmNvbnRhaW5lcjsKCiAgICBtb2RlbCA9IG1vZGVsIHx8IHRoaXMu
        bW9kZWxGb3IobmFtZSk7CgogICAgcmV0dXJuIEVtYmVyLmdlbmVyYXRlQ29u
        dHJvbGxlcihjb250YWluZXIsIG5hbWUsIG1vZGVsKTsKICB9LAoKICAvKioK
        ICAgIFJldHVybnMgdGhlIGN1cnJlbnQgbW9kZWwgZm9yIGEgZ2l2ZW4gcm91
        dGUuCgogICAgVGhpcyBpcyB0aGUgb2JqZWN0IHJldHVybmVkIGJ5IHRoZSBg
        bW9kZWxgIGhvb2sgb2YgdGhlIHJvdXRlCiAgICBpbiBxdWVzdGlvbi4KCiAg
        ICBFeGFtcGxlCgogICAgYGBganMKICAgIEFwcC5Sb3V0ZXIubWFwKGZ1bmN0
        aW9uKCkgewogICAgICAgIHRoaXMucmVzb3VyY2UoJ3Bvc3QnLCB7IHBhdGg6
        ICcvcG9zdC86cG9zdF9pZCcgfSwgZnVuY3Rpb24oKSB7CiAgICAgICAgICAg
        IHRoaXMucmVzb3VyY2UoJ2NvbW1lbnRzJyk7CiAgICAgICAgfSk7CiAgICB9
        KTsKCiAgICBBcHAuQ29tbWVudHNSb3V0ZSA9IEVtYmVyLlJvdXRlLmV4dGVu
        ZCh7CiAgICAgICAgYWZ0ZXJNb2RlbDogZnVuY3Rpb24oKSB7CiAgICAgICAg
        ICAgIHRoaXMuc2V0KCdwb3N0JywgdGhpcy5tb2RlbEZvcigncG9zdCcpKTsK
        ICAgICAgICB9CiAgICB9KTsKICAgIGBgYAoKICAgIEBtZXRob2QgbW9kZWxG
        b3IKICAgIEBwYXJhbSB7U3RyaW5nfSBuYW1lIHRoZSBuYW1lIG9mIHRoZSBy
        b3V0ZQogICAgQHJldHVybiB7T2JqZWN0fSB0aGUgbW9kZWwgb2JqZWN0CiAg
        Ki8KICBtb2RlbEZvcjogZnVuY3Rpb24obmFtZSkgewoKICAgIHZhciByb3V0
        ZSA9IHRoaXMuY29udGFpbmVyLmxvb2t1cCgncm91dGU6JyArIG5hbWUpLAog
        ICAgICAgIHRyYW5zaXRpb24gPSB0aGlzLnJvdXRlci5yb3V0ZXIuYWN0aXZl
        VHJhbnNpdGlvbjsKCiAgICAvLyBJZiB3ZSBhcmUgbWlkLXRyYW5zaXRpb24s
        IHdlIHdhbnQgdG8gdHJ5IGFuZCBsb29rIHVwCiAgICAvLyByZXNvbHZlZCBw
        YXJlbnQgY29udGV4dHMgb24gdGhlIGN1cnJlbnQgdHJhbnNpdGlvbkV2ZW50
        LgogICAgaWYgKHRyYW5zaXRpb24pIHsKICAgICAgdmFyIG1vZGVsTG9va3Vw
        TmFtZSA9IChyb3V0ZSAmJiByb3V0ZS5yb3V0ZU5hbWUpIHx8IG5hbWU7CiAg
        ICAgIGlmICh0cmFuc2l0aW9uLnJlc29sdmVkTW9kZWxzLmhhc093blByb3Bl
        cnR5KG1vZGVsTG9va3VwTmFtZSkpIHsKICAgICAgICByZXR1cm4gdHJhbnNp
        dGlvbi5yZXNvbHZlZE1vZGVsc1ttb2RlbExvb2t1cE5hbWVdOwogICAgICB9
        CiAgICB9CgogICAgcmV0dXJuIHJvdXRlICYmIHJvdXRlLmN1cnJlbnRNb2Rl
        bDsKICB9LAoKICAvKioKICAgIEEgaG9vayB5b3UgY2FuIHVzZSB0byByZW5k
        ZXIgdGhlIHRlbXBsYXRlIGZvciB0aGUgY3VycmVudCByb3V0ZS4KCiAgICBU
        aGlzIG1ldGhvZCBpcyBjYWxsZWQgd2l0aCB0aGUgY29udHJvbGxlciBmb3Ig
        dGhlIGN1cnJlbnQgcm91dGUgYW5kIHRoZQogICAgbW9kZWwgc3VwcGxpZWQg
        YnkgdGhlIGBtb2RlbGAgaG9vay4gQnkgZGVmYXVsdCwgaXQgcmVuZGVycyB0
        aGUgcm91dGUncwogICAgdGVtcGxhdGUsIGNvbmZpZ3VyZWQgd2l0aCB0aGUg
        Y29udHJvbGxlciBmb3IgdGhlIHJvdXRlLgoKICAgIFRoaXMgbWV0aG9kIGNh
        biBiZSBvdmVycmlkZGVuIHRvIHNldCB1cCBhbmQgcmVuZGVyIGFkZGl0aW9u
        YWwgb3IKICAgIGFsdGVybmF0aXZlIHRlbXBsYXRlcy4KCiAgICBgYGBqcwog
        ICAgQXBwLlBvc3RzUm91dGUgPSBFbWJlci5Sb3V0ZS5leHRlbmQoewogICAg
        ICByZW5kZXJUZW1wbGF0ZTogZnVuY3Rpb24oY29udHJvbGxlciwgbW9kZWwp
        IHsKICAgICAgICB2YXIgZmF2Q29udHJvbGxlciA9IHRoaXMuY29udHJvbGxl
        ckZvcignZmF2b3JpdGVQb3N0Jyk7CgogICAgICAgIC8vIFJlbmRlciB0aGUg
        YGZhdm9yaXRlUG9zdGAgdGVtcGxhdGUgaW50bwogICAgICAgIC8vIHRoZSBv
        dXRsZXQgYHBvc3RzYCwgYW5kIGRpc3BsYXkgdGhlIGBmYXZvcml0ZVBvc3Rg
        CiAgICAgICAgLy8gY29udHJvbGxlci4KICAgICAgICB0aGlzLnJlbmRlcign
        ZmF2b3JpdGVQb3N0JywgewogICAgICAgICAgb3V0bGV0OiAncG9zdHMnLAog
        ICAgICAgICAgY29udHJvbGxlcjogZmF2Q29udHJvbGxlcgogICAgICAgIH0p
        OwogICAgICB9CiAgICB9KTsKICAgIGBgYAoKICAgIEBtZXRob2QgcmVuZGVy
        VGVtcGxhdGUKICAgIEBwYXJhbSB7T2JqZWN0fSBjb250cm9sbGVyIHRoZSBy
        b3V0ZSdzIGNvbnRyb2xsZXIKICAgIEBwYXJhbSB7T2JqZWN0fSBtb2RlbCB0
        aGUgcm91dGUncyBtb2RlbAogICovCiAgcmVuZGVyVGVtcGxhdGU6IGZ1bmN0
        aW9uKGNvbnRyb2xsZXIsIG1vZGVsKSB7CiAgICB0aGlzLnJlbmRlcigpOwog
        IH0sCgogIC8qKgogICAgUmVuZGVycyBhIHRlbXBsYXRlIGludG8gYW4gb3V0
        bGV0LgoKICAgIFRoaXMgbWV0aG9kIGhhcyBhIG51bWJlciBvZiBkZWZhdWx0
        cywgYmFzZWQgb24gdGhlIG5hbWUgb2YgdGhlCiAgICByb3V0ZSBzcGVjaWZp
        ZWQgaW4gdGhlIHJvdXRlci4KCiAgICBGb3IgZXhhbXBsZToKCiAgICBgYGBq
        cwogICAgQXBwLlJvdXRlci5tYXAoZnVuY3Rpb24oKSB7CiAgICAgIHRoaXMu
        cm91dGUoJ2luZGV4Jyk7CiAgICAgIHRoaXMucmVzb3VyY2UoJ3Bvc3QnLCB7
        cGF0aDogJy9wb3N0cy86cG9zdF9pZCd9KTsKICAgIH0pOwoKICAgIEFwcC5Q
        b3N0Um91dGUgPSBBcHAuUm91dGUuZXh0ZW5kKHsKICAgICAgcmVuZGVyVGVt
        cGxhdGU6IGZ1bmN0aW9uKCkgewogICAgICAgIHRoaXMucmVuZGVyKCk7CiAg
        ICAgIH0KICAgIH0pOwogICAgYGBgCgogICAgVGhlIG5hbWUgb2YgdGhlIGBQ
        b3N0Um91dGVgLCBhcyBkZWZpbmVkIGJ5IHRoZSByb3V0ZXIsIGlzIGBwb3N0
        YC4KCiAgICBCeSBkZWZhdWx0LCByZW5kZXIgd2lsbDoKCiAgICAqIHJlbmRl
        ciB0aGUgYHBvc3RgIHRlbXBsYXRlCiAgICAqIHdpdGggdGhlIGBwb3N0YCB2
        aWV3IChgUG9zdFZpZXdgKSBmb3IgZXZlbnQgaGFuZGxpbmcsIGlmIG9uZSBl
        eGlzdHMKICAgICogYW5kIHRoZSBgcG9zdGAgY29udHJvbGxlciAoYFBvc3RD
        b250cm9sbGVyYCksIGlmIG9uZSBleGlzdHMKICAgICogaW50byB0aGUgYG1h
        aW5gIG91dGxldCBvZiB0aGUgYGFwcGxpY2F0aW9uYCB0ZW1wbGF0ZQoKICAg
        IFlvdSBjYW4gb3ZlcnJpZGUgdGhpcyBiZWhhdmlvcjoKCiAgICBgYGBqcwog
        ICAgQXBwLlBvc3RSb3V0ZSA9IEFwcC5Sb3V0ZS5leHRlbmQoewogICAgICBy
        ZW5kZXJUZW1wbGF0ZTogZnVuY3Rpb24oKSB7CiAgICAgICAgdGhpcy5yZW5k
        ZXIoJ215UG9zdCcsIHsgICAvLyB0aGUgdGVtcGxhdGUgdG8gcmVuZGVyCiAg
        ICAgICAgICBpbnRvOiAnaW5kZXgnLCAgICAgICAgICAvLyB0aGUgdGVtcGxh
        dGUgdG8gcmVuZGVyIGludG8KICAgICAgICAgIG91dGxldDogJ2RldGFpbCcs
        ICAgICAgIC8vIHRoZSBuYW1lIG9mIHRoZSBvdXRsZXQgaW4gdGhhdCB0ZW1w
        bGF0ZQogICAgICAgICAgY29udHJvbGxlcjogJ2Jsb2dQb3N0JyAgLy8gdGhl
        IGNvbnRyb2xsZXIgdG8gdXNlIGZvciB0aGUgdGVtcGxhdGUKICAgICAgICB9
        KTsKICAgICAgfQogICAgfSk7CiAgICBgYGAKCiAgICBSZW1lbWJlciB0aGF0
        IHRoZSBjb250cm9sbGVyJ3MgYGNvbnRlbnRgIHdpbGwgYmUgdGhlIHJvdXRl
        J3MgbW9kZWwuIEluCiAgICB0aGlzIGNhc2UsIHRoZSBkZWZhdWx0IG1vZGVs
        IHdpbGwgYmUgYEFwcC5Qb3N0LmZpbmQocGFyYW1zLnBvc3RfaWQpYC4KCiAg
        ICBAbWV0aG9kIHJlbmRlcgogICAgQHBhcmFtIHtTdHJpbmd9IG5hbWUgdGhl
        IG5hbWUgb2YgdGhlIHRlbXBsYXRlIHRvIHJlbmRlcgogICAgQHBhcmFtIHtP
        YmplY3R9IG9wdGlvbnMgdGhlIG9wdGlvbnMKICAqLwogIHJlbmRlcjogZnVu
        Y3Rpb24obmFtZSwgb3B0aW9ucykgewogICAgRW1iZXIuYXNzZXJ0KCJUaGUg
        bmFtZSBpbiB0aGUgZ2l2ZW4gYXJndW1lbnRzIGlzIHVuZGVmaW5lZCIsIGFy
        Z3VtZW50cy5sZW5ndGggPiAwID8gIUVtYmVyLmlzTm9uZShhcmd1bWVudHNb
        MF0pIDogdHJ1ZSk7CgogICAgdmFyIG5hbWVQYXNzZWQgPSAhIW5hbWU7Cgog
        ICAgaWYgKHR5cGVvZiBuYW1lID09PSAnb2JqZWN0JyAmJiAhb3B0aW9ucykg
        ewogICAgICBvcHRpb25zID0gbmFtZTsKICAgICAgbmFtZSA9IHRoaXMucm91
        dGVOYW1lOwogICAgfQoKICAgIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9Owog
        ICAgbmFtZSA9IG5hbWUgPyBuYW1lLnJlcGxhY2UoL1wvL2csICcuJykgOiB0
        aGlzLnJvdXRlTmFtZTsKICAgIHZhciB2aWV3TmFtZSA9IG9wdGlvbnMudmll
        dyB8fCB0aGlzLnZpZXdOYW1lIHx8IG5hbWU7CiAgICB2YXIgdGVtcGxhdGVO
        YW1lID0gdGhpcy50ZW1wbGF0ZU5hbWUgfHwgbmFtZTsKCiAgICB2YXIgY29u
        dGFpbmVyID0gdGhpcy5jb250YWluZXIsCiAgICAgICAgdmlldyA9IGNvbnRh
        aW5lci5sb29rdXAoJ3ZpZXc6JyArIHZpZXdOYW1lKSwKICAgICAgICB0ZW1w
        bGF0ZSA9IHZpZXcgPyB2aWV3LmdldCgndGVtcGxhdGUnKSA6IG51bGw7Cgog
        ICAgaWYgKCF0ZW1wbGF0ZSkgewogICAgICB0ZW1wbGF0ZSA9IGNvbnRhaW5l
        ci5sb29rdXAoJ3RlbXBsYXRlOicgKyB0ZW1wbGF0ZU5hbWUpOwogICAgfQoK
        ICAgIGlmICghdmlldyAmJiAhdGVtcGxhdGUpIHsKICAgICAgRW1iZXIuYXNz
        ZXJ0KCJDb3VsZCBub3QgZmluZCBcIiIgKyBuYW1lICsgIlwiIHRlbXBsYXRl
        IG9yIHZpZXcuIiwgIW5hbWVQYXNzZWQpOwogICAgICBpZiAoZ2V0KHRoaXMu
        cm91dGVyLCAnbmFtZXNwYWNlLkxPR19WSUVXX0xPT0tVUFMnKSkgewogICAg
        ICAgIEVtYmVyLkxvZ2dlci5pbmZvKCJDb3VsZCBub3QgZmluZCBcIiIgKyBu
        YW1lICsgIlwiIHRlbXBsYXRlIG9yIHZpZXcuIE5vdGhpbmcgd2lsbCBiZSBy
        ZW5kZXJlZCIsIHsgZnVsbE5hbWU6ICd0ZW1wbGF0ZTonICsgbmFtZSB9KTsK
        ICAgICAgfQogICAgICByZXR1cm47CiAgICB9CgogICAgb3B0aW9ucyA9IG5v
        cm1hbGl6ZU9wdGlvbnModGhpcywgbmFtZSwgdGVtcGxhdGUsIG9wdGlvbnMp
        OwogICAgdmlldyA9IHNldHVwVmlldyh2aWV3LCBjb250YWluZXIsIG9wdGlv
        bnMpOwoKICAgIGlmIChvcHRpb25zLm91dGxldCA9PT0gJ21haW4nKSB7IHRo
        aXMubGFzdFJlbmRlcmVkVGVtcGxhdGUgPSBuYW1lOyB9CgogICAgYXBwZW5k
        Vmlldyh0aGlzLCB2aWV3LCBvcHRpb25zKTsKICB9LAoKICAvKioKICAgIERp
        c2Nvbm5lY3RzIGEgdmlldyB0aGF0IGhhcyBiZWVuIHJlbmRlcmVkIGludG8g
        YW4gb3V0bGV0LgoKICAgIFlvdSBtYXkgcGFzcyBhbnkgb3IgYWxsIG9mIHRo
        ZSBmb2xsb3dpbmcgb3B0aW9ucyB0byBgZGlzY29ubmVjdE91dGxldGA6Cgog
        ICAgKiBgb3V0bGV0YDogdGhlIG5hbWUgb2YgdGhlIG91dGxldCB0byBjbGVh
        ciAoZGVmYXVsdDogJ21haW4nKQogICAgKiBgcGFyZW50Vmlld2A6IHRoZSBu
        YW1lIG9mIHRoZSB2aWV3IGNvbnRhaW5pbmcgdGhlIG91dGxldCB0byBjbGVh
        cgogICAgICAgKGRlZmF1bHQ6IHRoZSB2aWV3IHJlbmRlcmVkIGJ5IHRoZSBw
        YXJlbnQgcm91dGUpCgogICAgRXhhbXBsZToKCiAgICBgYGBqcwogICAgQXBw
        LkFwcGxpY2F0aW9uUm91dGUgPSBBcHAuUm91dGUuZXh0ZW5kKHsKICAgICAg
        YWN0aW9uczogewogICAgICAgIHNob3dNb2RhbDogZnVuY3Rpb24oZXZ0KSB7
        CiAgICAgICAgICB0aGlzLnJlbmRlcihldnQubW9kYWxOYW1lLCB7CiAgICAg
        ICAgICAgIG91dGxldDogJ21vZGFsJywKICAgICAgICAgICAgaW50bzogJ2Fw
        cGxpY2F0aW9uJwogICAgICAgICAgfSk7CiAgICAgICAgfSwKICAgICAgICBo
        aWRlTW9kYWw6IGZ1bmN0aW9uKGV2dCkgewogICAgICAgICAgdGhpcy5kaXNj
        b25uZWN0T3V0bGV0KHsKICAgICAgICAgICAgb3V0bGV0OiAnbW9kYWwnLAog
        ICAgICAgICAgICBwYXJlbnRWaWV3OiAnYXBwbGljYXRpb24nCiAgICAgICAg
        ICB9KTsKICAgICAgICB9CiAgICAgIH0KICAgIH0pOwogICAgYGBgCgogICAg
        QG1ldGhvZCBkaXNjb25uZWN0T3V0bGV0CiAgICBAcGFyYW0ge09iamVjdH0g
        b3B0aW9ucyB0aGUgb3B0aW9ucwogICovCiAgZGlzY29ubmVjdE91dGxldDog
        ZnVuY3Rpb24ob3B0aW9ucykgewogICAgb3B0aW9ucyA9IG9wdGlvbnMgfHwg
        e307CiAgICBvcHRpb25zLnBhcmVudFZpZXcgPSBvcHRpb25zLnBhcmVudFZp
        ZXcgPyBvcHRpb25zLnBhcmVudFZpZXcucmVwbGFjZSgvXC8vZywgJy4nKSA6
        IHBhcmVudFRlbXBsYXRlKHRoaXMpOwogICAgb3B0aW9ucy5vdXRsZXQgPSBv
        cHRpb25zLm91dGxldCB8fCAnbWFpbic7CgogICAgdmFyIHBhcmVudFZpZXcg
        PSB0aGlzLnJvdXRlci5fbG9va3VwQWN0aXZlVmlldyhvcHRpb25zLnBhcmVu
        dFZpZXcpOwogICAgcGFyZW50Vmlldy5kaXNjb25uZWN0T3V0bGV0KG9wdGlv
        bnMub3V0bGV0KTsKICB9LAoKICB3aWxsRGVzdHJveTogZnVuY3Rpb24oKSB7
        CiAgICB0aGlzLnRlYXJkb3duVmlld3MoKTsKICB9LAoKICAvKioKICAgIEBw
        cml2YXRlCgogICAgQG1ldGhvZCB0ZWFyZG93blZpZXdzCiAgKi8KICB0ZWFy
        ZG93blZpZXdzOiBmdW5jdGlvbigpIHsKICAgIC8vIFRlYXIgZG93biB0aGUg
        dG9wIGxldmVsIHZpZXcKICAgIGlmICh0aGlzLnRlYXJkb3duVG9wTGV2ZWxW
        aWV3KSB7IHRoaXMudGVhcmRvd25Ub3BMZXZlbFZpZXcoKTsgfQoKICAgIC8v
        IFRlYXIgZG93biBhbnkgb3V0bGV0cyByZW5kZXJlZCB3aXRoICdpbnRvJwog
        ICAgdmFyIHRlYXJkb3duT3V0bGV0Vmlld3MgPSB0aGlzLnRlYXJkb3duT3V0
        bGV0Vmlld3MgfHwgW107CiAgICBhX2ZvckVhY2godGVhcmRvd25PdXRsZXRW
        aWV3cywgZnVuY3Rpb24odGVhcmRvd25PdXRsZXRWaWV3KSB7CiAgICAgIHRl
        YXJkb3duT3V0bGV0VmlldygpOwogICAgfSk7CgogICAgZGVsZXRlIHRoaXMu
        dGVhcmRvd25Ub3BMZXZlbFZpZXc7CiAgICBkZWxldGUgdGhpcy50ZWFyZG93
        bk91dGxldFZpZXdzOwogICAgZGVsZXRlIHRoaXMubGFzdFJlbmRlcmVkVGVt
        cGxhdGU7CiAgfQp9KTsKCmZ1bmN0aW9uIHBhcmVudFJvdXRlKHJvdXRlKSB7
        CiAgdmFyIGhhbmRsZXJJbmZvcyA9IHJvdXRlLnJvdXRlci5yb3V0ZXIudGFy
        Z2V0SGFuZGxlckluZm9zOwoKICBpZiAoIWhhbmRsZXJJbmZvcykgeyByZXR1
        cm47IH0KCiAgdmFyIHBhcmVudCwgY3VycmVudDsKCiAgZm9yICh2YXIgaT0w
        LCBsPWhhbmRsZXJJbmZvcy5sZW5ndGg7IGk8bDsgaSsrKSB7CiAgICBjdXJy
        ZW50ID0gaGFuZGxlckluZm9zW2ldLmhhbmRsZXI7CiAgICBpZiAoY3VycmVu
        dCA9PT0gcm91dGUpIHsgcmV0dXJuIHBhcmVudDsgfQogICAgcGFyZW50ID0g
        Y3VycmVudDsKICB9Cn0KCmZ1bmN0aW9uIHBhcmVudFRlbXBsYXRlKHJvdXRl
        KSB7CiAgdmFyIHBhcmVudCA9IHBhcmVudFJvdXRlKHJvdXRlKSwgdGVtcGxh
        dGU7CgogIGlmICghcGFyZW50KSB7IHJldHVybjsgfQoKICBpZiAodGVtcGxh
        dGUgPSBwYXJlbnQubGFzdFJlbmRlcmVkVGVtcGxhdGUpIHsKICAgIHJldHVy
        biB0ZW1wbGF0ZTsKICB9IGVsc2UgewogICAgcmV0dXJuIHBhcmVudFRlbXBs
        YXRlKHBhcmVudCk7CiAgfQp9CgpmdW5jdGlvbiBub3JtYWxpemVPcHRpb25z
        KHJvdXRlLCBuYW1lLCB0ZW1wbGF0ZSwgb3B0aW9ucykgewogIG9wdGlvbnMg
        PSBvcHRpb25zIHx8IHt9OwogIG9wdGlvbnMuaW50byA9IG9wdGlvbnMuaW50
        byA/IG9wdGlvbnMuaW50by5yZXBsYWNlKC9cLy9nLCAnLicpIDogcGFyZW50
        VGVtcGxhdGUocm91dGUpOwogIG9wdGlvbnMub3V0bGV0ID0gb3B0aW9ucy5v
        dXRsZXQgfHwgJ21haW4nOwogIG9wdGlvbnMubmFtZSA9IG5hbWU7CiAgb3B0
        aW9ucy50ZW1wbGF0ZSA9IHRlbXBsYXRlOwogIG9wdGlvbnMuTE9HX1ZJRVdf
        TE9PS1VQUyA9IGdldChyb3V0ZS5yb3V0ZXIsICduYW1lc3BhY2UuTE9HX1ZJ
        RVdfTE9PS1VQUycpOwoKICBFbWJlci5hc3NlcnQoIkFuIG91dGxldCAoIitv
        cHRpb25zLm91dGxldCsiKSB3YXMgc3BlY2lmaWVkIGJ1dCB3YXMgbm90IGZv
        dW5kLiIsIG9wdGlvbnMub3V0bGV0ID09PSAnbWFpbicgfHwgb3B0aW9ucy5p
        bnRvKTsKCiAgdmFyIGNvbnRyb2xsZXIgPSBvcHRpb25zLmNvbnRyb2xsZXIs
        IG5hbWVkQ29udHJvbGxlcjsKCiAgaWYgKG9wdGlvbnMuY29udHJvbGxlcikg
        ewogICAgY29udHJvbGxlciA9IG9wdGlvbnMuY29udHJvbGxlcjsKICB9IGVs
        c2UgaWYgKG5hbWVkQ29udHJvbGxlciA9IHJvdXRlLmNvbnRhaW5lci5sb29r
        dXAoJ2NvbnRyb2xsZXI6JyArIG5hbWUpKSB7CiAgICBjb250cm9sbGVyID0g
        bmFtZWRDb250cm9sbGVyOwogIH0gZWxzZSB7CiAgICBjb250cm9sbGVyID0g
        cm91dGUuY29udHJvbGxlck5hbWUgfHwgcm91dGUucm91dGVOYW1lOwogIH0K
        CiAgaWYgKHR5cGVvZiBjb250cm9sbGVyID09PSAnc3RyaW5nJykgewogICAg
        Y29udHJvbGxlciA9IHJvdXRlLmNvbnRhaW5lci5sb29rdXAoJ2NvbnRyb2xs
        ZXI6JyArIGNvbnRyb2xsZXIpOwogIH0KCiAgb3B0aW9ucy5jb250cm9sbGVy
        ID0gY29udHJvbGxlcjsKCiAgcmV0dXJuIG9wdGlvbnM7Cn0KCmZ1bmN0aW9u
        IHNldHVwVmlldyh2aWV3LCBjb250YWluZXIsIG9wdGlvbnMpIHsKICBpZiAo
        dmlldykgewogICAgaWYgKG9wdGlvbnMuTE9HX1ZJRVdfTE9PS1VQUykgewog
        ICAgICBFbWJlci5Mb2dnZXIuaW5mbygiUmVuZGVyaW5nICIgKyBvcHRpb25z
        Lm5hbWUgKyAiIHdpdGggIiArIHZpZXcsIHsgZnVsbE5hbWU6ICd2aWV3Oicg
        KyBvcHRpb25zLm5hbWUgfSk7CiAgICB9CiAgfSBlbHNlIHsKICAgIHZhciBk
        ZWZhdWx0VmlldyA9IG9wdGlvbnMuaW50byA/ICd2aWV3OmRlZmF1bHQnIDog
        J3ZpZXc6dG9wbGV2ZWwnOwogICAgdmlldyA9IGNvbnRhaW5lci5sb29rdXAo
        ZGVmYXVsdFZpZXcpOwogICAgaWYgKG9wdGlvbnMuTE9HX1ZJRVdfTE9PS1VQ
        UykgewogICAgICBFbWJlci5Mb2dnZXIuaW5mbygiUmVuZGVyaW5nICIgKyBv
        cHRpb25zLm5hbWUgKyAiIHdpdGggZGVmYXVsdCB2aWV3ICIgKyB2aWV3LCB7
        IGZ1bGxOYW1lOiAndmlldzonICsgb3B0aW9ucy5uYW1lIH0pOwogICAgfQog
        IH0KCiAgaWYgKCFnZXQodmlldywgJ3RlbXBsYXRlTmFtZScpKSB7CiAgICBz
        ZXQodmlldywgJ3RlbXBsYXRlJywgb3B0aW9ucy50ZW1wbGF0ZSk7CgogICAg
        c2V0KHZpZXcsICdfZGVidWdUZW1wbGF0ZU5hbWUnLCBvcHRpb25zLm5hbWUp
        OwogIH0KCiAgc2V0KHZpZXcsICdyZW5kZXJlZE5hbWUnLCBvcHRpb25zLm5h
        bWUpOwogIHNldCh2aWV3LCAnY29udHJvbGxlcicsIG9wdGlvbnMuY29udHJv
        bGxlcik7CgogIHJldHVybiB2aWV3Owp9CgpmdW5jdGlvbiBhcHBlbmRWaWV3
        KHJvdXRlLCB2aWV3LCBvcHRpb25zKSB7CiAgaWYgKG9wdGlvbnMuaW50bykg
        ewogICAgdmFyIHBhcmVudFZpZXcgPSByb3V0ZS5yb3V0ZXIuX2xvb2t1cEFj
        dGl2ZVZpZXcob3B0aW9ucy5pbnRvKTsKICAgIHZhciB0ZWFyZG93bk91dGxl
        dFZpZXcgPSBnZW5lcmF0ZU91dGxldFRlYXJkb3duKHBhcmVudFZpZXcsIG9w
        dGlvbnMub3V0bGV0KTsKICAgIGlmICghcm91dGUudGVhcmRvd25PdXRsZXRW
        aWV3cykgeyByb3V0ZS50ZWFyZG93bk91dGxldFZpZXdzID0gW107IH0KICAg
        IGFfcmVwbGFjZShyb3V0ZS50ZWFyZG93bk91dGxldFZpZXdzLCAwLCAwLCBb
        dGVhcmRvd25PdXRsZXRWaWV3XSk7CiAgICBwYXJlbnRWaWV3LmNvbm5lY3RP
        dXRsZXQob3B0aW9ucy5vdXRsZXQsIHZpZXcpOwogIH0gZWxzZSB7CiAgICB2
        YXIgcm9vdEVsZW1lbnQgPSBnZXQocm91dGUsICdyb3V0ZXIubmFtZXNwYWNl
        LnJvb3RFbGVtZW50Jyk7CiAgICAvLyB0ZWFyIGRvd24gdmlldyBpZiBvbmUg
        aXMgYWxyZWFkeSByZW5kZXJlZAogICAgaWYgKHJvdXRlLnRlYXJkb3duVG9w
        TGV2ZWxWaWV3KSB7CiAgICAgIHJvdXRlLnRlYXJkb3duVG9wTGV2ZWxWaWV3
        KCk7CiAgICB9CiAgICByb3V0ZS5yb3V0ZXIuX2Nvbm5lY3RBY3RpdmVWaWV3
        KG9wdGlvbnMubmFtZSwgdmlldyk7CiAgICByb3V0ZS50ZWFyZG93blRvcExl
        dmVsVmlldyA9IGdlbmVyYXRlVG9wTGV2ZWxUZWFyZG93bih2aWV3KTsKICAg
        IHZpZXcuYXBwZW5kVG8ocm9vdEVsZW1lbnQpOwogIH0KfQoKZnVuY3Rpb24g
        Z2VuZXJhdGVUb3BMZXZlbFRlYXJkb3duKHZpZXcpIHsKICByZXR1cm4gZnVu
        Y3Rpb24oKSB7IHZpZXcuZGVzdHJveSgpOyB9Owp9CgpmdW5jdGlvbiBnZW5l
        cmF0ZU91dGxldFRlYXJkb3duKHBhcmVudFZpZXcsIG91dGxldCkgewogIHJl
        dHVybiBmdW5jdGlvbigpIHsgcGFyZW50Vmlldy5kaXNjb25uZWN0T3V0bGV0
        KG91dGxldCk7IH07Cn0KCn0pKCk7CgoKCihmdW5jdGlvbigpIHsKCn0pKCk7
        CgoKCihmdW5jdGlvbigpIHsKRW1iZXIub25Mb2FkKCdFbWJlci5IYW5kbGVi
        YXJzJywgZnVuY3Rpb24oKSB7CiAgdmFyIGhhbmRsZWJhcnNSZXNvbHZlID0g
        RW1iZXIuSGFuZGxlYmFycy5yZXNvbHZlUGFyYW1zLAogICAgICBtYXAgPSBF
        bWJlci5BcnJheVBvbHlmaWxscy5tYXAsCiAgICAgIGdldCA9IEVtYmVyLmdl
        dCwKICAgICAgaGFuZGxlYmFyc0dldCA9IEVtYmVyLkhhbmRsZWJhcnMuZ2V0
        OwoKICBmdW5jdGlvbiByZXNvbHZlUGFyYW1zKGNvbnRleHQsIHBhcmFtcywg
        b3B0aW9ucykgewogICAgcmV0dXJuIG1hcC5jYWxsKHJlc29sdmVQYXRocyhj
        b250ZXh0LCBwYXJhbXMsIG9wdGlvbnMpLCBmdW5jdGlvbihwYXRoLCBpKSB7
        CiAgICAgIGlmIChudWxsID09PSBwYXRoKSB7CiAgICAgICAgLy8gUGFyYW0g
        d2FzIHN0cmluZy9udW1iZXIsIG5vdCBhIHBhdGgsIHNvIGp1c3QgcmV0dXJu
        IHJhdyBzdHJpbmcvbnVtYmVyLgogICAgICAgIHJldHVybiBwYXJhbXNbaV07
        CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIGhhbmRsZWJhcnNHZXQo
        Y29udGV4dCwgcGF0aCwgb3B0aW9ucyk7CiAgICAgIH0KICAgIH0pOwogIH0K
        CiAgZnVuY3Rpb24gcmVzb2x2ZVBhdGhzKGNvbnRleHQsIHBhcmFtcywgb3B0
        aW9ucykgewogICAgdmFyIHJlc29sdmVkID0gaGFuZGxlYmFyc1Jlc29sdmUo
        Y29udGV4dCwgcGFyYW1zLCBvcHRpb25zKSwKICAgICAgICB0eXBlcyA9IG9w
        dGlvbnMudHlwZXM7CgogICAgcmV0dXJuIG1hcC5jYWxsKHJlc29sdmVkLCBm
        dW5jdGlvbihvYmplY3QsIGkpIHsKICAgICAgaWYgKHR5cGVzW2ldID09PSAn
        SUQnKSB7CiAgICAgICAgcmV0dXJuIHVud3JhcChvYmplY3QsIHBhcmFtc1tp
        XSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICAg
        IH0KICAgIH0pOwoKICAgIGZ1bmN0aW9uIHVud3JhcChvYmplY3QsIHBhdGgp
        IHsKICAgICAgaWYgKHBhdGggPT09ICdjb250cm9sbGVyJykgeyByZXR1cm4g
        cGF0aDsgfQoKICAgICAgaWYgKEVtYmVyLkNvbnRyb2xsZXJNaXhpbi5kZXRl
        Y3Qob2JqZWN0KSkgewogICAgICAgIHJldHVybiB1bndyYXAoZ2V0KG9iamVj
        dCwgJ21vZGVsJyksIHBhdGggPyBwYXRoICsgJy5tb2RlbCcgOiAnbW9kZWwn
        KTsKICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gcGF0aDsKICAgICAg
        fQogICAgfQogIH0KCiAgRW1iZXIuUm91dGVyLnJlc29sdmVQYXJhbXMgPSBy
        ZXNvbHZlUGFyYW1zOwogIEVtYmVyLlJvdXRlci5yZXNvbHZlUGF0aHMgPSBy
        ZXNvbHZlUGF0aHM7Cn0pOwoKfSkoKTsKCgoKKGZ1bmN0aW9uKCkgewovKioK
        QG1vZHVsZSBlbWJlcgpAc3VibW9kdWxlIGVtYmVyLXJvdXRpbmcKKi8KCnZh
        ciBnZXQgPSBFbWJlci5nZXQsIHNldCA9IEVtYmVyLnNldCwgZm10ID0gRW1i
        ZXIuU3RyaW5nLmZtdDsKRW1iZXIub25Mb2FkKCdFbWJlci5IYW5kbGViYXJz
        JywgZnVuY3Rpb24oSGFuZGxlYmFycykgewoKICB2YXIgcmVzb2x2ZVBhcmFt
        cyA9IEVtYmVyLlJvdXRlci5yZXNvbHZlUGFyYW1zLAogICAgICByZXNvbHZl
        UGF0aHMgID0gRW1iZXIuUm91dGVyLnJlc29sdmVQYXRocywKICAgICAgaXNT
        aW1wbGVDbGljayA9IEVtYmVyLlZpZXdVdGlscy5pc1NpbXBsZUNsaWNrOwoK
        ICBmdW5jdGlvbiBmdWxsUm91dGVOYW1lKHJvdXRlciwgbmFtZSkgewogICAg
        aWYgKCFyb3V0ZXIuaGFzUm91dGUobmFtZSkpIHsKICAgICAgbmFtZSA9IG5h
        bWUgKyAnLmluZGV4JzsKICAgIH0KCiAgICByZXR1cm4gbmFtZTsKICB9Cgog
        IGZ1bmN0aW9uIGdldFJlc29sdmVkUGF0aHMob3B0aW9ucykgewoKICAgIHZh
        ciB0eXBlcyA9IG9wdGlvbnMub3B0aW9ucy50eXBlcywKICAgICAgICBkYXRh
        ID0gb3B0aW9ucy5vcHRpb25zLmRhdGE7CgogICAgcmV0dXJuIHJlc29sdmVQ
        YXRocyhvcHRpb25zLmNvbnRleHQsIG9wdGlvbnMucGFyYW1zLCB7IHR5cGVz
        OiB0eXBlcywgZGF0YTogZGF0YSB9KTsKICB9CgogIC8qKgogICAgYEVtYmVy
        LkxpbmtWaWV3YCByZW5kZXJzIGFuIGVsZW1lbnQgd2hvc2UgYGNsaWNrYCBl
        dmVudCB0cmlnZ2VycyBhCiAgICB0cmFuc2l0aW9uIG9mIHRoZSBhcHBsaWNh
        dGlvbidzIGluc3RhbmNlIG9mIGBFbWJlci5Sb3V0ZXJgIHRvCiAgICBhIHN1
        cHBsaWVkIHJvdXRlIGJ5IG5hbWUuCgogICAgSW5zdGFuY2VzIG9mIGBMaW5r
        Vmlld2Agd2lsbCBtb3N0IGxpa2VseSBiZSBjcmVhdGVkIHRocm91Z2gKICAg
        IHRoZSBgbGluay10b2AgSGFuZGxlYmFycyBoZWxwZXIsIGJ1dCBwcm9wZXJ0
        aWVzIG9mIHRoaXMgY2xhc3MKICAgIGNhbiBiZSBvdmVycmlkZGVuIHRvIGN1
        c3RvbWl6ZSBhcHBsaWNhdGlvbi13aWRlIGJlaGF2aW9yLgoKICAgIEBjbGFz
        cyBMaW5rVmlldwogICAgQG5hbWVzcGFjZSBFbWJlcgogICAgQGV4dGVuZHMg
        RW1iZXIuVmlldwogICAgQHNlZSB7SGFuZGxlYmFycy5oZWxwZXJzLmxpbmst
        dG99CiAgKiovCiAgdmFyIExpbmtWaWV3ID0gRW1iZXIuTGlua1ZpZXcgPSBF
        bWJlci5WaWV3LmV4dGVuZCh7CiAgICB0YWdOYW1lOiAnYScsCiAgICBjdXJy
        ZW50V2hlbjogbnVsbCwKCiAgICAvKioKICAgICAgU2V0cyB0aGUgYHRpdGxl
        YCBhdHRyaWJ1dGUgb2YgdGhlIGBMaW5rVmlld2AncyBIVE1MIGVsZW1lbnQu
        CgogICAgICBAcHJvcGVydHkgdGl0bGUKICAgICAgQGRlZmF1bHQgbnVsbAog
        ICAgKiovCiAgICB0aXRsZTogbnVsbCwKCiAgICAvKioKICAgICAgU2V0cyB0
        aGUgYHJlbGAgYXR0cmlidXRlIG9mIHRoZSBgTGlua1ZpZXdgJ3MgSFRNTCBl
        bGVtZW50LgoKICAgICAgQHByb3BlcnR5IHJlbAogICAgICBAZGVmYXVsdCBu
        dWxsCiAgICAqKi8KICAgIHJlbDogbnVsbCwKCiAgICAvKioKICAgICAgVGhl
        IENTUyBjbGFzcyB0byBhcHBseSB0byBgTGlua1ZpZXdgJ3MgZWxlbWVudCB3
        aGVuIGl0cyBgYWN0aXZlYAogICAgICBwcm9wZXJ0eSBpcyBgdHJ1ZWAuCgog
        ICAgICBAcHJvcGVydHkgYWN0aXZlQ2xhc3MKICAgICAgQHR5cGUgU3RyaW5n
        CiAgICAgIEBkZWZhdWx0IGFjdGl2ZQogICAgKiovCiAgICBhY3RpdmVDbGFz
        czogJ2FjdGl2ZScsCgogICAgLyoqCiAgICAgIFRoZSBDU1MgY2xhc3MgdG8g
        YXBwbHkgdG8gYExpbmtWaWV3YCdzIGVsZW1lbnQgd2hlbiBpdHMgYGxvYWRp
        bmdgCiAgICAgIHByb3BlcnR5IGlzIGB0cnVlYC4KCiAgICAgIEBwcm9wZXJ0
        eSBsb2FkaW5nQ2xhc3MKICAgICAgQHR5cGUgU3RyaW5nCiAgICAgIEBkZWZh
        dWx0IGxvYWRpbmcKICAgICoqLwogICAgbG9hZGluZ0NsYXNzOiAnbG9hZGlu
        ZycsCgogICAgLyoqCiAgICAgIFRoZSBDU1MgY2xhc3MgdG8gYXBwbHkgdG8g
        YSBgTGlua1ZpZXdgJ3MgZWxlbWVudCB3aGVuIGl0cyBgZGlzYWJsZWRgCiAg
        ICAgIHByb3BlcnR5IGlzIGB0cnVlYC4KCiAgICAgIEBwcm9wZXJ0eSBkaXNh
        YmxlZENsYXNzCiAgICAgIEB0eXBlIFN0cmluZwogICAgICBAZGVmYXVsdCBk
        aXNhYmxlZAogICAgKiovCiAgICBkaXNhYmxlZENsYXNzOiAnZGlzYWJsZWQn
        LAogICAgX2lzRGlzYWJsZWQ6IGZhbHNlLAoKICAgIC8qKgogICAgICBEZXRl
        cm1pbmVzIHdoZXRoZXIgdGhlIGBMaW5rVmlld2Agd2lsbCB0cmlnZ2VyIHJv
        dXRpbmcgdmlhCiAgICAgIHRoZSBgcmVwbGFjZVdpdGhgIHJvdXRpbmcgc3Ry
        YXRlZ3kuCgogICAgICBAcHJvcGVydHkgcmVwbGFjZQogICAgICBAdHlwZSBC
        b29sZWFuCiAgICAgIEBkZWZhdWx0IGZhbHNlCiAgICAqKi8KICAgIHJlcGxh
        Y2U6IGZhbHNlLAoKICAgIC8qKgogICAgICBCeSBkZWZhdWx0IHRoZSBge3ts
        aW5rLXRvfX1gIGhlbHBlciB3aWxsIGJpbmQgdG8gdGhlIGBocmVmYCBhbmQK
        ICAgICAgYHRpdGxlYCBhdHRyaWJ1dGVzLiBJdCdzIGRpc2NvdXJhZ2UgdGhh
        dCB5b3Ugb3ZlcnJpZGUgdGhlc2UgZGVmYXVsdHMsCiAgICAgIGhvd2V2ZXIg
        eW91IGNhbiBwdXNoIG9udG8gdGhlIGFycmF5IGlmIG5lZWRlZC4KCiAgICAg
        IEBwcm9wZXJ0eSBhdHRyaWJ1dGVCaW5kaW5ncwogICAgICBAdHlwZSBBcnJh
        eSB8IFN0cmluZwogICAgICBAZGVmYXVsdCBbJ2hyZWYnLCAndGl0bGUnLCAn
        cmVsJ10KICAgICAqKi8KICAgIGF0dHJpYnV0ZUJpbmRpbmdzOiBbJ2hyZWYn
        LCAndGl0bGUnLCAncmVsJ10sCgogICAgLyoqCiAgICAgIEJ5IGRlZmF1bHQg
        dGhlIGB7e2xpbmstdG99fWAgaGVscGVyIHdpbGwgYmluZCB0byB0aGUgYGFj
        dGl2ZWAsIGBsb2FkaW5nYCwgYW5kCiAgICAgIGBkaXNhYmxlZGAgY2xhc3Nl
        cy4gSXQgaXMgZGlzY291cmFnZWQgdG8gb3ZlcnJpZGUgdGhlc2UgZGlyZWN0
        bHkuCgogICAgICBAcHJvcGVydHkgY2xhc3NOYW1lQmluZGluZ3MKICAgICAg
        QHR5cGUgQXJyYXkKICAgICAgQGRlZmF1bHQgWydhY3RpdmUnLCAnbG9hZGlu
        ZycsICdkaXNhYmxlZCddCiAgICAgKiovCiAgICBjbGFzc05hbWVCaW5kaW5n
        czogWydhY3RpdmUnLCAnbG9hZGluZycsICdkaXNhYmxlZCddLAoKICAgIC8q
        KgogICAgICBCeSBkZWZhdWx0IHRoZSBge3tsaW5rLXRvfX1gIGhlbHBlciBy
        ZXNwb25kcyB0byB0aGUgYGNsaWNrYCBldmVudC4gWW91CiAgICAgIGNhbiBv
        dmVycmlkZSB0aGlzIGdsb2JhbGx5IGJ5IHNldHRpbmcgdGhpcyBwcm9wZXJ0
        eSB0byB5b3VyIGN1c3RvbQogICAgICBldmVudCBuYW1lLgoKICAgICAgVGhp
        cyBpcyBwYXJ0aWN1bGFybHkgdXNlZnVsIG9uIG1vYmlsZSB3aGVuIG9uZSB3
        YW50cyB0byBhdm9pZCB0aGUgMzAwbXMKICAgICAgY2xpY2sgZGVsYXkgdXNp
        bmcgc29tZSBzb3J0IG9mIGN1c3RvbSBgdGFwYCBldmVudC4KCiAgICAgIEBw
        cm9wZXJ0eSBldmVudE5hbWUKICAgICAgQHR5cGUgU3RyaW5nCiAgICAgIEBk
        ZWZhdWx0IGNsaWNrCiAgICAqLwogICAgZXZlbnROYW1lOiAnY2xpY2snLAoK
        ICAgIC8vIHRoaXMgaXMgZG9jJ2VkIGhlcmUgc28gaXQgc2hvd3MgdXAgaW4g
        dGhlIGV2ZW50cwogICAgLy8gc2VjdGlvbiBvZiB0aGUgQVBJIGRvY3VtZW50
        YXRpb24sIHdoaWNoIGlzIHdoZXJlCiAgICAvLyBwZW9wbGUgd2lsbCBsaWtl
        bHkgZ28gbG9va2luZyBmb3IgaXQuCiAgICAvKioKICAgICAgVHJpZ2dlcnMg
        dGhlIGBMaW5rVmlld2AncyByb3V0aW5nIGJlaGF2aW9yLiBJZgogICAgICBg
        ZXZlbnROYW1lYCBpcyBjaGFuZ2VkIHRvIGEgdmFsdWUgb3RoZXIgdGhhbiBg
        Y2xpY2tgCiAgICAgIHRoZSByb3V0aW5nIGJlaGF2aW9yIHdpbGwgdHJpZ2dl
        ciBvbiB0aGF0IGN1c3RvbSBldmVudAogICAgICBpbnN0ZWFkLgoKICAgICAg
        QGV2ZW50IGNsaWNrCiAgICAqKi8KCiAgICAvKioKICAgICAgQW4gb3ZlcnJp
        ZGFibGUgbWV0aG9kIGNhbGxlZCB3aGVuIExpbmtWaWV3IG9iamVjdHMgYXJl
        IGluc3RhbnRpYXRlZC4KCiAgICAgIEV4YW1wbGU6CgogICAgICBgYGBqYXZh
        c2NyaXB0CiAgICAgIEFwcC5NeUxpbmtWaWV3ID0gRW1iZXIuTGlua1ZpZXcu
        ZXh0ZW5kKHsKICAgICAgICBpbml0OiBmdW5jdGlvbigpIHsKICAgICAgICAg
        IHRoaXMuX3N1cGVyKCk7CiAgICAgICAgICBFbWJlci5Mb2dnZXIubG9nKCdF
        dmVudCBpcyAnICsgdGhpcy5nZXQoJ2V2ZW50TmFtZScpKTsKICAgICAgICB9
        CiAgICAgIH0pOwogICAgICBgYGAKCiAgICAgIE5PVEU6IElmIHlvdSBkbyBv
        dmVycmlkZSBgaW5pdGAgZm9yIGEgZnJhbWV3b3JrIGNsYXNzIGxpa2UgYEVt
        YmVyLlZpZXdgIG9yCiAgICAgIGBFbWJlci5BcnJheUNvbnRyb2xsZXJgLCBi
        ZSBzdXJlIHRvIGNhbGwgYHRoaXMuX3N1cGVyKClgIGluIHlvdXIKICAgICAg
        YGluaXRgIGRlY2xhcmF0aW9uISBJZiB5b3UgZG9uJ3QsIEVtYmVyIG1heSBu
        b3QgaGF2ZSBhbiBvcHBvcnR1bml0eSB0bwogICAgICBkbyBpbXBvcnRhbnQg
        c2V0dXAgd29yaywgYW5kIHlvdSdsbCBzZWUgc3RyYW5nZSBiZWhhdmlvciBp
        biB5b3VyCiAgICAgIGFwcGxpY2F0aW9uLgoKICAgICAgQG1ldGhvZCBpbml0
        CiAgICAqLwogICAgaW5pdDogZnVuY3Rpb24oKSB7CiAgICAgIHRoaXMuX3N1
        cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CgogICAgICAvLyBNYXAgZGVz
        aXJlZCBldmVudCBuYW1lIHRvIGludm9rZSBmdW5jdGlvbgogICAgICB2YXIg
        ZXZlbnROYW1lID0gZ2V0KHRoaXMsICdldmVudE5hbWUnKTsKICAgICAgdGhp
        cy5vbihldmVudE5hbWUsIHRoaXMsIHRoaXMuX2ludm9rZSk7CgogICAgICB2
        YXIgaGVscGVyUGFyYW1ldGVycyA9IHRoaXMucGFyYW1ldGVycywKICAgICAg
        ICAgIHRlbXBsYXRlQ29udGV4dCA9IGhlbHBlclBhcmFtZXRlcnMuY29udGV4
        dCwKICAgICAgICAgIHBhdGhzID0gZ2V0UmVzb2x2ZWRQYXRocyhoZWxwZXJQ
        YXJhbWV0ZXJzKSwKICAgICAgICAgIGxlbmd0aCA9IHBhdGhzLmxlbmd0aCwK
        ICAgICAgICAgIHBhdGgsIGk7CgogICAgICBmb3IoaT0wOyBpIDwgbGVuZ3Ro
        OyBpKyspIHsKICAgICAgICBwYXRoID0gcGF0aHNbaV07CiAgICAgICAgaWYg
        KG51bGwgPT09IHBhdGgpIHsKICAgICAgICAgIC8vIEEgbGl0ZXJhbCB2YWx1
        ZSB3YXMgcHJvdmlkZWQsIG5vdCBhIHBhdGgsIHNvIG5vdGhpbmcgdG8gb2Jz
        ZXJ2ZS4KICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgIH0KCiAgICAgICAg
        dmFyIG5vcm1hbGl6ZWRQYXRoID0KICAgICAgICAgIEVtYmVyLkhhbmRsZWJh
        cnMubm9ybWFsaXplUGF0aCh0ZW1wbGF0ZUNvbnRleHQsIHBhdGgsIGhlbHBl
        clBhcmFtZXRlcnMub3B0aW9ucy5kYXRhKTsKICAgICAgICB0aGlzLnJlZ2lz
        dGVyT2JzZXJ2ZXIobm9ybWFsaXplZFBhdGgucm9vdCwgbm9ybWFsaXplZFBh
        dGgucGF0aCwgdGhpcywgdGhpcy5fcGFyYW1zQ2hhbmdlZCk7CiAgICAgIH0K
        ICAgIH0sCgogICAgLyoqCiAgICAgIEBwcml2YXRlCgogICAgICBUaGlzIG1l
        dGhvZCBpcyBpbnZva2VkIGJ5IG9ic2VydmVycyBpbnN0YWxsZWQgZHVyaW5n
        IGBpbml0YCB0aGF0IGZpcmUKICAgICAgd2hlbmV2ZXIgdGhlIGhlbHBlcnMK
        ICAgICAgQG1ldGhvZCBfcGFyYW1zQ2hhbmdlZAogICAgICovCiAgICBfcGFy
        YW1zQ2hhbmdlZDogZnVuY3Rpb24oKSB7CiAgICAgIHRoaXMubm90aWZ5UHJv
        cGVydHlDaGFuZ2UoJ3Jlc29sdmVkUGFyYW1zJyk7CiAgICB9LAoKICAgIC8q
        KgogICAgICBAcHJpdmF0ZQoKICAgICAgRXZlbiB0aG91Z2ggdGhpcyBpc24n
        dCBhIHZpcnR1YWwgdmlldywgd2Ugd2FudCB0byB0cmVhdCBpdCBhcyBpZiBp
        dCBpcwogICAgICBzbyB0aGF0IHlvdSBjYW4gYWNjZXNzIHRoZSBwYXJlbnQg
        d2l0aCB7e3ZpZXcucHJvcH19CgogICAgICBAbWV0aG9kIGNvbmNyZXRlVmll
        dwogICAgKiovCiAgICBjb25jcmV0ZVZpZXc6IEVtYmVyLmNvbXB1dGVkKGZ1
        bmN0aW9uKCkgewogICAgICByZXR1cm4gZ2V0KHRoaXMsICdwYXJlbnRWaWV3
        Jyk7CiAgICB9KS5wcm9wZXJ0eSgncGFyZW50VmlldycpLAoKICAgIC8qKgoK
        ICAgICAgQWNjZXNzZWQgYXMgYSBjbGFzc25hbWUgYmluZGluZyB0byBhcHBs
        eSB0aGUgYExpbmtWaWV3YCdzIGBkaXNhYmxlZENsYXNzYAogICAgICBDU1Mg
        YGNsYXNzYCB0byB0aGUgZWxlbWVudCB3aGVuIHRoZSBsaW5rIGlzIGRpc2Fi
        bGVkLgoKICAgICAgV2hlbiBgdHJ1ZWAgaW50ZXJhY3Rpb25zIHdpdGggdGhl
        IGVsZW1lbnQgd2lsbCBub3QgdHJpZ2dlciByb3V0ZSBjaGFuZ2VzLgogICAg
        ICBAcHJvcGVydHkgZGlzYWJsZWQKICAgICovCiAgICBkaXNhYmxlZDogRW1i
        ZXIuY29tcHV0ZWQoZnVuY3Rpb24oa2V5LCB2YWx1ZSkgewogICAgICBpZiAo
        dmFsdWUgIT09IHVuZGVmaW5lZCkgeyB0aGlzLnNldCgnX2lzRGlzYWJsZWQn
        LCB2YWx1ZSk7IH0KCiAgICAgIHJldHVybiB2YWx1ZSA/IGdldCh0aGlzLCAn
        ZGlzYWJsZWRDbGFzcycpIDogZmFsc2U7CiAgICB9KSwKCiAgICAvKioKICAg
        ICAgQWNjZXNzZWQgYXMgYSBjbGFzc25hbWUgYmluZGluZyB0byBhcHBseSB0
        aGUgYExpbmtWaWV3YCdzIGBhY3RpdmVDbGFzc2AKICAgICAgQ1NTIGBjbGFz
        c2AgdG8gdGhlIGVsZW1lbnQgd2hlbiB0aGUgbGluayBpcyBhY3RpdmUuCgog
        ICAgICBBIGBMaW5rVmlld2AgaXMgY29uc2lkZXJlZCBhY3RpdmUgd2hlbiBp
        dHMgYGN1cnJlbnRXaGVuYCBwcm9wZXJ0eSBpcyBgdHJ1ZWAKICAgICAgb3Ig
        dGhlIGFwcGxpY2F0aW9uJ3MgY3VycmVudCByb3V0ZSBpcyB0aGUgcm91dGUg
        dGhlIGBMaW5rVmlld2Agd291bGQgdHJpZ2dlcgogICAgICB0cmFuc2l0aW9u
        cyBpbnRvLgoKICAgICAgQHByb3BlcnR5IGFjdGl2ZQogICAgKiovCiAgICBh
        Y3RpdmU6IEVtYmVyLmNvbXB1dGVkKGZ1bmN0aW9uKCkgewogICAgICBpZiAo
        Z2V0KHRoaXMsICdsb2FkaW5nJykpIHsgcmV0dXJuIGZhbHNlOyB9CgogICAg
        ICB2YXIgcm91dGVyID0gZ2V0KHRoaXMsICdyb3V0ZXInKSwKICAgICAgICAg
        IHJvdXRlQXJncyA9IGdldCh0aGlzLCAncm91dGVBcmdzJyksCiAgICAgICAg
        ICBjb250ZXh0cyA9IHJvdXRlQXJncy5zbGljZSgxKSwKICAgICAgICAgIHJl
        c29sdmVkUGFyYW1zID0gZ2V0KHRoaXMsICdyZXNvbHZlZFBhcmFtcycpLAog
        ICAgICAgICAgY3VycmVudFdoZW4gPSB0aGlzLmN1cnJlbnRXaGVuIHx8IHJl
        c29sdmVkUGFyYW1zWzBdLAogICAgICAgICAgY3VycmVudFdpdGhJbmRleCA9
        IGN1cnJlbnRXaGVuICsgJy5pbmRleCcsCiAgICAgICAgICBpc0FjdGl2ZSA9
        IHJvdXRlci5pc0FjdGl2ZS5hcHBseShyb3V0ZXIsIFtjdXJyZW50V2hlbl0u
        Y29uY2F0KGNvbnRleHRzKSkgfHwKICAgICAgICAgICAgICAgICAgICAgcm91
        dGVyLmlzQWN0aXZlLmFwcGx5KHJvdXRlciwgW2N1cnJlbnRXaXRoSW5kZXhd
        LmNvbmNhdChjb250ZXh0cykpOwoKICAgICAgaWYgKGlzQWN0aXZlKSB7IHJl
        dHVybiBnZXQodGhpcywgJ2FjdGl2ZUNsYXNzJyk7IH0KICAgIH0pLnByb3Bl
        cnR5KCdyZXNvbHZlZFBhcmFtcycsICdyb3V0ZUFyZ3MnLCAncm91dGVyLnVy
        bCcpLAoKICAgIC8qKgogICAgICBBY2Nlc3NlZCBhcyBhIGNsYXNzbmFtZSBi
        aW5kaW5nIHRvIGFwcGx5IHRoZSBgTGlua1ZpZXdgJ3MgYGxvYWRpbmdDbGFz
        c2AKICAgICAgQ1NTIGBjbGFzc2AgdG8gdGhlIGVsZW1lbnQgd2hlbiB0aGUg
        bGluayBpcyBsb2FkaW5nLgoKICAgICAgQSBgTGlua1ZpZXdgIGlzIGNvbnNp
        ZGVyZWQgbG9hZGluZyB3aGVuIGl0IGhhcyBhdCBsZWFzdCBvbmUKICAgICAg
        cGFyYW1ldGVyIHdob3NlIHZhbHVlIGlzIGN1cnJlbnRseSBudWxsIG9yIHVu
        ZGVmaW5lZC4gRHVyaW5nCiAgICAgIHRoaXMgdGltZSwgY2xpY2tpbmcgdGhl
        IGxpbmsgd2lsbCBwZXJmb3JtIG5vIHRyYW5zaXRpb24gYW5kCiAgICAgIGVt
        aXQgYSB3YXJuaW5nIHRoYXQgdGhlIGxpbmsgaXMgc3RpbGwgaW4gYSBsb2Fk
        aW5nIHN0YXRlLgoKICAgICAgQHByb3BlcnR5IGxvYWRpbmcKICAgICoqLwog
        ICAgbG9hZGluZzogRW1iZXIuY29tcHV0ZWQoZnVuY3Rpb24oKSB7CiAgICAg
        IGlmICghZ2V0KHRoaXMsICdyb3V0ZUFyZ3MnKSkgeyByZXR1cm4gZ2V0KHRo
        aXMsICdsb2FkaW5nQ2xhc3MnKTsgfQogICAgfSkucHJvcGVydHkoJ3JvdXRl
        QXJncycpLAoKICAgIC8qKgogICAgICBAcHJpdmF0ZQoKICAgICAgUmV0dXJu
        cyB0aGUgYXBwbGljYXRpb24ncyBtYWluIHJvdXRlciBmcm9tIHRoZSBjb250
        YWluZXIuCgogICAgICBAcHJvcGVydHkgcm91dGVyCiAgICAqKi8KICAgIHJv
        dXRlcjogRW1iZXIuY29tcHV0ZWQoZnVuY3Rpb24oKSB7CiAgICAgIHJldHVy
        biBnZXQodGhpcywgJ2NvbnRyb2xsZXInKS5jb250YWluZXIubG9va3VwKCdy
        b3V0ZXI6bWFpbicpOwogICAgfSksCgogICAgLyoqCiAgICAgIEBwcml2YXRl
        CgogICAgICBFdmVudCBoYW5kbGVyIHRoYXQgaW52b2tlcyB0aGUgbGluaywg
        YWN0aXZhdGluZyB0aGUgYXNzb2NpYXRlZCByb3V0ZS4KCiAgICAgIEBtZXRo
        b2QgX2ludm9rZQogICAgICBAcGFyYW0ge0V2ZW50fSBldmVudAogICAgKi8K
        ICAgIF9pbnZva2U6IGZ1bmN0aW9uKGV2ZW50KSB7CiAgICAgIGlmICghaXNT
        aW1wbGVDbGljayhldmVudCkpIHsgcmV0dXJuIHRydWU7IH0KCiAgICAgIGV2
        ZW50LnByZXZlbnREZWZhdWx0KCk7CiAgICAgIGlmICh0aGlzLmJ1YmJsZXMg
        PT09IGZhbHNlKSB7IGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpOyB9CgogICAg
        ICBpZiAoZ2V0KHRoaXMsICdfaXNEaXNhYmxlZCcpKSB7IHJldHVybiBmYWxz
        ZTsgfQoKICAgICAgaWYgKGdldCh0aGlzLCAnbG9hZGluZycpKSB7CiAgICAg
        ICAgRW1iZXIuTG9nZ2VyLndhcm4oIlRoaXMgbGluay10byBpcyBpbiBhbiBp
        bmFjdGl2ZSBsb2FkaW5nIHN0YXRlIGJlY2F1c2UgYXQgbGVhc3Qgb25lIG9m
        IGl0cyBwYXJhbWV0ZXJzIHByZXNlbnRseSBoYXMgYSBudWxsL3VuZGVmaW5l
        ZCB2YWx1ZSwgb3IgdGhlIHByb3ZpZGVkIHJvdXRlIG5hbWUgaXMgaW52YWxp
        ZC4iKTsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KCiAgICAgIHZh
        ciByb3V0ZXIgPSBnZXQodGhpcywgJ3JvdXRlcicpLAogICAgICAgICAgcm91
        dGVBcmdzID0gZ2V0KHRoaXMsICdyb3V0ZUFyZ3MnKTsKCiAgICAgIGlmIChn
        ZXQodGhpcywgJ3JlcGxhY2UnKSkgewogICAgICAgIHJvdXRlci5yZXBsYWNl
        V2l0aC5hcHBseShyb3V0ZXIsIHJvdXRlQXJncyk7CiAgICAgIH0gZWxzZSB7
        CiAgICAgICAgcm91dGVyLnRyYW5zaXRpb25Uby5hcHBseShyb3V0ZXIsIHJv
        dXRlQXJncyk7CiAgICAgIH0KICAgIH0sCgogICAgLyoqCiAgICAgIEBwcml2
        YXRlCgogICAgICBDb21wdXRlZCBwcm9wZXJ0eSB0aGF0IHJldHVybnMgdGhl
        IHJlc29sdmVkIHBhcmFtZXRlcnMuCgogICAgICBAcHJvcGVydHkKICAgICAg
        QHJldHVybiB7QXJyYXl9CiAgICAgKi8KICAgIHJlc29sdmVkUGFyYW1zOiBF
        bWJlci5jb21wdXRlZChmdW5jdGlvbigpIHsKICAgICAgdmFyIHBhcmFtZXRl
        cnMgPSB0aGlzLnBhcmFtZXRlcnMsCiAgICAgICAgICBvcHRpb25zID0gcGFy
        YW1ldGVycy5vcHRpb25zLAogICAgICAgICAgdHlwZXMgPSBvcHRpb25zLnR5
        cGVzLAogICAgICAgICAgZGF0YSA9IG9wdGlvbnMuZGF0YTsKCiAgICAgIHJl
        dHVybiByZXNvbHZlUGFyYW1zKHBhcmFtZXRlcnMuY29udGV4dCwgcGFyYW1l
        dGVycy5wYXJhbXMsIHsgdHlwZXM6IHR5cGVzLCBkYXRhOiBkYXRhIH0pOwog
        ICAgfSkucHJvcGVydHkoKSwKCiAgICAvKioKICAgICAgQHByaXZhdGUKCiAg
        ICAgIENvbXB1dGVkIHByb3BlcnR5IHRoYXQgcmV0dXJucyB0aGUgY3VycmVu
        dCByb3V0ZSBuYW1lIGFuZAogICAgICBhbnkgZHluYW1pYyBzZWdtZW50cy4K
        CiAgICAgIEBwcm9wZXJ0eQogICAgICBAcmV0dXJuIHtBcnJheX0gQW4gYXJy
        YXkgd2l0aCB0aGUgcm91dGUgbmFtZSBhbmQgYW55IGR5bmFtaWMgc2VnbWVu
        dHMKICAgICAqLwogICAgcm91dGVBcmdzOiBFbWJlci5jb21wdXRlZChmdW5j
        dGlvbigpIHsKCiAgICAgIHZhciByZXNvbHZlZFBhcmFtcyA9IGdldCh0aGlz
        LCAncmVzb2x2ZWRQYXJhbXMnKS5zbGljZSgwKSwKICAgICAgICAgIHJvdXRl
        ciA9IGdldCh0aGlzLCAncm91dGVyJyksCiAgICAgICAgICBuYW1lZFJvdXRl
        ID0gcmVzb2x2ZWRQYXJhbXNbMF07CgogICAgICBpZiAoIW5hbWVkUm91dGUp
        IHsgcmV0dXJuOyB9CgogICAgICBuYW1lZFJvdXRlID0gZnVsbFJvdXRlTmFt
        ZShyb3V0ZXIsIG5hbWVkUm91dGUpOwogICAgICByZXNvbHZlZFBhcmFtc1sw
        XSA9IG5hbWVkUm91dGU7CgogICAgICBFbWJlci5hc3NlcnQoZm10KCJUaGUg
        YXR0ZW1wdCB0byBsaW5rLXRvIHJvdXRlICclQCcgZmFpbGVkLiBUaGUgcm91
        dGVyIGRpZCBub3QgZmluZCAnJUAnIGluIGl0cyBwb3NzaWJsZSByb3V0ZXM6
        ICclQCciLCBbbmFtZWRSb3V0ZSwgbmFtZWRSb3V0ZSwgRW1iZXIua2V5cyhy
        b3V0ZXIucm91dGVyLnJlY29nbml6ZXIubmFtZXMpLmpvaW4oIicsICciKV0p
        LCByb3V0ZXIuaGFzUm91dGUobmFtZWRSb3V0ZSkpOwoKICAgICAgZm9yICh2
        YXIgaSA9IDEsIGxlbiA9IHJlc29sdmVkUGFyYW1zLmxlbmd0aDsgaSA8IGxl
        bjsgKytpKSB7CiAgICAgICAgdmFyIHBhcmFtID0gcmVzb2x2ZWRQYXJhbXNb
        aV07CiAgICAgICAgaWYgKHBhcmFtID09PSBudWxsIHx8IHR5cGVvZiBwYXJh
        bSA9PT0gJ3VuZGVmaW5lZCcpIHsKICAgICAgICAgIC8vIElmIGNvbnRleHRz
        IGFyZW4ndCBwcmVzZW50LCBjb25zaWRlciB0aGUgbGlua1ZpZXcgdW5sb2Fk
        ZWQuCiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICB9CgogICAg
        ICByZXR1cm4gcmVzb2x2ZWRQYXJhbXM7CiAgICB9KS5wcm9wZXJ0eSgncmVz
        b2x2ZWRQYXJhbXMnKSwKCiAgICAvKioKICAgICAgU2V0cyB0aGUgZWxlbWVu
        dCdzIGBocmVmYCBhdHRyaWJ1dGUgdG8gdGhlIHVybCBmb3IKICAgICAgdGhl
        IGBMaW5rVmlld2AncyB0YXJnZXRlZCByb3V0ZS4KCiAgICAgIElmIHRoZSBg
        TGlua1ZpZXdgJ3MgYHRhZ05hbWVgIGlzIGNoYW5nZWQgdG8gYSB2YWx1ZSBv
        dGhlcgogICAgICB0aGFuIGBhYCwgdGhpcyBwcm9wZXJ0eSB3aWxsIGJlIGln
        bm9yZWQuCgogICAgICBAcHJvcGVydHkgaHJlZgogICAgKiovCiAgICBocmVm
        OiBFbWJlci5jb21wdXRlZChmdW5jdGlvbigpIHsKICAgICAgaWYgKGdldCh0
        aGlzLCAndGFnTmFtZScpICE9PSAnYScpIHsgcmV0dXJuOyB9CgogICAgICB2
        YXIgcm91dGVyID0gZ2V0KHRoaXMsICdyb3V0ZXInKSwKICAgICAgICAgIHJv
        dXRlQXJncyA9IGdldCh0aGlzLCAncm91dGVBcmdzJyk7CgogICAgICByZXR1
        cm4gcm91dGVBcmdzID8gcm91dGVyLmdlbmVyYXRlLmFwcGx5KHJvdXRlciwg
        cm91dGVBcmdzKSA6IGdldCh0aGlzLCAnbG9hZGluZ0hyZWYnKTsKICAgIH0p
        LnByb3BlcnR5KCdyb3V0ZUFyZ3MnKSwKCiAgICAvKioKICAgICAgVGhlIGRl
        ZmF1bHQgaHJlZiB2YWx1ZSB0byB1c2Ugd2hpbGUgYSBsaW5rLXRvIGlzIGxv
        YWRpbmcuCiAgICAgIE9ubHkgYXBwbGllcyB3aGVuIHRhZ05hbWUgaXMgJ2En
        CgogICAgICBAcHJvcGVydHkgbG9hZGluZ0hyZWYKICAgICAgQHR5cGUgU3Ry
        aW5nCiAgICAgIEBkZWZhdWx0ICMKICAgICovCiAgICBsb2FkaW5nSHJlZjog
        JyMnCiAgfSk7CgogIExpbmtWaWV3LnRvU3RyaW5nID0gZnVuY3Rpb24oKSB7
        IHJldHVybiAiTGlua1ZpZXciOyB9OwoKICAvKioKICAgIFRoZSBge3tsaW5r
        LXRvfX1gIGhlbHBlciByZW5kZXJzIGEgbGluayB0byB0aGUgc3VwcGxpZWQK
        ICAgIGByb3V0ZU5hbWVgIHBhc3NpbmcgYW4gb3B0aW9uYWxseSBzdXBwbGll
        ZCBtb2RlbCB0byB0aGUKICAgIHJvdXRlIGFzIGl0cyBgbW9kZWxgIGNvbnRl
        eHQgb2YgdGhlIHJvdXRlLiBUaGUgYmxvY2sKICAgIGZvciBge3tsaW5rLXRv
        fX1gIGJlY29tZXMgdGhlIGlubmVySFRNTCBvZiB0aGUgcmVuZGVyZWQKICAg
        IGVsZW1lbnQ6CgogICAgYGBgaGFuZGxlYmFycwogICAge3sjbGluay10byAn
        cGhvdG9HYWxsZXJ5J319CiAgICAgIEdyZWF0IEhhbXN0ZXIgUGhvdG9zCiAg
        ICB7ey9saW5rLXRvfX0KICAgIGBgYAoKICAgIGBgYGh0bWwKICAgIDxhIGhy
        ZWY9Ii9oYW1zdGVyLXBob3RvcyI+CiAgICAgIEdyZWF0IEhhbXN0ZXIgUGhv
        dG9zCiAgICA8L2E+CiAgICBgYGAKCiAgICAjIyMgU3VwcGx5aW5nIGEgdGFn
        TmFtZQogICAgQnkgZGVmYXVsdCBge3tsaW5rLXRvfX1gIHJlbmRlcnMgYW4g
        YDxhPmAgZWxlbWVudC4gVGhpcyBjYW4KICAgIGJlIG92ZXJyaWRkZW4gZm9y
        IGEgc2luZ2xlIHVzZSBvZiBge3tsaW5rLXRvfX1gIGJ5IHN1cHBseWluZwog
        ICAgYSBgdGFnTmFtZWAgb3B0aW9uOgoKICAgIGBgYGhhbmRsZWJhcnMKICAg
        IHt7I2xpbmstdG8gJ3Bob3RvR2FsbGVyeScgdGFnTmFtZT0ibGkifX0KICAg
        ICAgR3JlYXQgSGFtc3RlciBQaG90b3MKICAgIHt7L2xpbmstdG99fQogICAg
        YGBgCgogICAgYGBgaHRtbAogICAgPGxpPgogICAgICBHcmVhdCBIYW1zdGVy
        IFBob3RvcwogICAgPC9saT4KICAgIGBgYAoKICAgIFRvIG92ZXJyaWRlIHRo
        aXMgb3B0aW9uIGZvciB5b3VyIGVudGlyZSBhcHBsaWNhdGlvbiwgc2VlCiAg
        ICAiT3ZlcnJpZGluZyBBcHBsaWNhdGlvbi13aWRlIERlZmF1bHRzIi4KICAg
        IAogICAgIyMjIERpc2FibGluZyB0aGUgYGxpbmstdG9gIGhlbHBlcgogICAg
        QnkgZGVmYXVsdCBge3tsaW5rLXRvfX1gIGlzIGVuYWJsZWQuIAogICAgYW55
        IHBhc3NlZCB2YWx1ZSB0byBgZGlzYWJsZWRgIGhlbHBlciBwcm9wZXJ0eSB3
        aWxsIGRpc2FibGUgdGhlIGBsaW5rLXRvYCBoZWxwZXIuCiAgICAgCiAgICBz
        dGF0aWMgdXNlOiB0aGUgYGRpc2FibGVkYCBvcHRpb246CiAKICAgIGBgYGhh
        bmRsZWJhcnMKICAgIHt7I2xpbmstdG8gJ3Bob3RvR2FsbGVyeScgZGlzYWJs
        ZWQ9dHJ1ZX19CiAgICAgIEdyZWF0IEhhbXN0ZXIgUGhvdG9zCiAgICB7ey9s
        aW5rLXRvfX0KICAgIGBgYAogICAgIAogICAgZHluYW1pYyB1c2U6IHRoZSBg
        ZGlzYWJsZWRXaGVuYCBvcHRpb246CiAgICAKICAgIGBgYGhhbmRsZWJhcnMK
        ICAgIHt7I2xpbmstdG8gJ3Bob3RvR2FsbGVyeScgZGlzYWJsZWRXaGVuPWNv
        bnRyb2xsZXIuc29tZVByb3BlcnR5fX0KICAgICAgR3JlYXQgSGFtc3RlciBQ
        aG90b3MKICAgIHt7L2xpbmstdG99fQogICAgYGBgCiAgICAKICAgIGFueSBw
        YXNzZWQgdmFsdWUgdG8gYGRpc2FibGVkYCB3aWxsIGRpc2FibGUgaXQgZXhj
        ZXB0IGB1bmRlZmluZWRgLgogICAgdG8gZW5zdXJlIHRoYXQgb25seSBgdHJ1
        ZWAgZGlzYWJsZSB0aGUgYGxpbmstdG9gIGhlbHBlciB5b3UgY2FuCiAgICBv
        dmVycmlkZSB0aGUgZ2xvYmFsIGJlaGF2aW91ciBvZiBgRW1iZXIuTGlua1Zp
        ZXdgLgogICAgICAgICAKICAgIGBgYGphdmFzY3JpcHQgIAogICAgRW1iZXIu
        TGlua1ZpZXcucmVvcGVuKHsKICAgICAgZGlzYWJsZWQ6IEVtYmVyLmNvbXB1
        dGVkKGZ1bmN0aW9uKGtleSwgdmFsdWUpIHsKICAgICAgICBpZiAodmFsdWUg
        IT09IHVuZGVmaW5lZCkgeyAKICAgICAgICAgIHRoaXMuc2V0KCdfaXNEaXNh
        YmxlZCcsIHZhbHVlID09PSB0cnVlKTsgCiAgICAgICAgfQogICAgICAgIHJl
        dHVybiB2YWx1ZSA9PT0gdHJ1ZSA/IGdldCh0aGlzLCAnZGlzYWJsZWRDbGFz
        cycpIDogZmFsc2U7CiAgICAgIH0pCiAgICB9KTsKICAgIGBgYAogICAgIAog
        ICAgc2VlICJPdmVycmlkaW5nIEFwcGxpY2F0aW9uLXdpZGUgRGVmYXVsdHMi
        IGZvciBtb3JlLgogICAgCiAgICAjIyMgSGFuZGxpbmcgYGhyZWZgCiAgICBg
        e3tsaW5rLXRvfX1gIHdpbGwgdXNlIHlvdXIgYXBwbGljYXRpb24ncyBSb3V0
        ZXIgdG8KICAgIGZpbGwgdGhlIGVsZW1lbnQncyBgaHJlZmAgcHJvcGVydHkg
        d2l0aCBhIHVybCB0aGF0CiAgICBtYXRjaGVzIHRoZSBwYXRoIHRvIHRoZSBz
        dXBwbGllZCBgcm91dGVOYW1lYCBmb3IgeW91cgogICAgcm91dGVycydzIGNv
        bmZpZ3VyZWQgYExvY2F0aW9uYCBzY2hlbWUsIHdoaWNoIGRlZmF1bHRzCiAg
        ICB0byBFbWJlci5IYXNoTG9jYXRpb24uCgogICAgIyMjIEhhbmRsaW5nIGN1
        cnJlbnQgcm91dGUKICAgIGB7e2xpbmstdG99fWAgd2lsbCBhcHBseSBhIENT
        UyBjbGFzcyBuYW1lIG9mICdhY3RpdmUnCiAgICB3aGVuIHRoZSBhcHBsaWNh
        dGlvbidzIGN1cnJlbnQgcm91dGUgbWF0Y2hlcwogICAgdGhlIHN1cHBsaWVk
        IHJvdXRlTmFtZS4gRm9yIGV4YW1wbGUsIGlmIHRoZSBhcHBsaWNhdGlvbidz
        CiAgICBjdXJyZW50IHJvdXRlIGlzICdwaG90b0dhbGxlcnkucmVjZW50JyB0
        aGUgZm9sbG93aW5nCiAgICB1c2Ugb2YgYHt7bGluay10b319YDoKCiAgICBg
        YGBoYW5kbGViYXJzCiAgICB7eyNsaW5rLXRvICdwaG90b0dhbGxlcnkucmVj
        ZW50J319CiAgICAgIEdyZWF0IEhhbXN0ZXIgUGhvdG9zIGZyb20gdGhlIGxh
        c3Qgd2VlawogICAge3svbGluay10b319CiAgICBgYGAKCiAgICB3aWxsIHJl
        c3VsdCBpbgoKICAgIGBgYGh0bWwKICAgIDxhIGhyZWY9Ii9oYW1zdGVyLXBo
        b3Rvcy90aGlzLXdlZWsiIGNsYXNzPSJhY3RpdmUiPgogICAgICBHcmVhdCBI
        YW1zdGVyIFBob3RvcwogICAgPC9hPgogICAgYGBgCgogICAgVGhlIENTUyBj
        bGFzcyBuYW1lIHVzZWQgZm9yIGFjdGl2ZSBjbGFzc2VzIGNhbiBiZSBjdXN0
        b21pemVkCiAgICBmb3IgYSBzaW5nbGUgdXNlIG9mIGB7e2xpbmstdG99fWAg
        YnkgcGFzc2luZyBhbiBgYWN0aXZlQ2xhc3NgCiAgICBvcHRpb246CgogICAg
        YGBgaGFuZGxlYmFycwogICAge3sjbGluay10byAncGhvdG9HYWxsZXJ5LnJl
        Y2VudCcgYWN0aXZlQ2xhc3M9ImN1cnJlbnQtdXJsIn19CiAgICAgIEdyZWF0
        IEhhbXN0ZXIgUGhvdG9zIGZyb20gdGhlIGxhc3Qgd2VlawogICAge3svbGlu
        ay10b319CiAgICBgYGAKCiAgICBgYGBodG1sCiAgICA8YSBocmVmPSIvaGFt
        c3Rlci1waG90b3MvdGhpcy13ZWVrIiBjbGFzcz0iY3VycmVudC11cmwiPgog
        ICAgICBHcmVhdCBIYW1zdGVyIFBob3RvcwogICAgPC9hPgogICAgYGBgCgog
        ICAgVG8gb3ZlcnJpZGUgdGhpcyBvcHRpb24gZm9yIHlvdXIgZW50aXJlIGFw
        cGxpY2F0aW9uLCBzZWUKICAgICJPdmVycmlkaW5nIEFwcGxpY2F0aW9uLXdp
        ZGUgRGVmYXVsdHMiLgoKICAgICMjIyBTdXBwbHlpbmcgYSBtb2RlbAogICAg
        QW4gb3B0aW9uYWwgbW9kZWwgYXJndW1lbnQgY2FuIGJlIHVzZWQgZm9yIHJv
        dXRlcyB3aG9zZQogICAgcGF0aHMgY29udGFpbiBkeW5hbWljIHNlZ21lbnRz
        LiBUaGlzIGFyZ3VtZW50IHdpbGwgYmVjb21lCiAgICB0aGUgbW9kZWwgY29u
        dGV4dCBvZiB0aGUgbGlua2VkIHJvdXRlOgoKICAgIGBgYGphdmFzY3JpcHQK
        ICAgIEFwcC5Sb3V0ZXIubWFwKGZ1bmN0aW9uKCkgewogICAgICB0aGlzLnJl
        c291cmNlKCJwaG90b0dhbGxlcnkiLCB7cGF0aDogImhhbXN0ZXItcGhvdG9z
        LzpwaG90b19pZCJ9KTsKICAgIH0pOwogICAgYGBgCgogICAgYGBgaGFuZGxl
        YmFycwogICAge3sjbGluay10byAncGhvdG9HYWxsZXJ5JyBhUGhvdG99fQog
        ICAgICB7e2FQaG90by50aXRsZX19CiAgICB7ey9saW5rLXRvfX0KICAgIGBg
        YAoKICAgIGBgYGh0bWwKICAgIDxhIGhyZWY9Ii9oYW1zdGVyLXBob3Rvcy80
        MiI+CiAgICAgIFRvbXN0ZXIKICAgIDwvYT4KICAgIGBgYAoKICAgICMjIyBT
        dXBwbHlpbmcgbXVsdGlwbGUgbW9kZWxzCiAgICBGb3IgZGVlcC1saW5raW5n
        IHRvIHJvdXRlIHBhdGhzIHRoYXQgY29udGFpbiBtdWx0aXBsZQogICAgZHlu
        YW1pYyBzZWdtZW50cywgbXVsdGlwbGUgbW9kZWwgYXJndW1lbnRzIGNhbiBi
        ZSB1c2VkLgogICAgQXMgdGhlIHJvdXRlciB0cmFuc2l0aW9ucyB0aHJvdWdo
        IHRoZSByb3V0ZSBwYXRoLCBlYWNoCiAgICBzdXBwbGllZCBtb2RlbCBhcmd1
        bWVudCB3aWxsIGJlY29tZSB0aGUgY29udGV4dCBmb3IgdGhlCiAgICByb3V0
        ZSB3aXRoIHRoZSBkeW5hbWljIHNlZ21lbnRzOgoKICAgIGBgYGphdmFzY3Jp
        cHQKICAgIEFwcC5Sb3V0ZXIubWFwKGZ1bmN0aW9uKCkgewogICAgICB0aGlz
        LnJlc291cmNlKCJwaG90b0dhbGxlcnkiLCB7cGF0aDogImhhbXN0ZXItcGhv
        dG9zLzpwaG90b19pZCJ9LCBmdW5jdGlvbigpIHsKICAgICAgICB0aGlzLnJv
        dXRlKCJjb21tZW50Iiwge3BhdGg6ICJjb21tZW50cy86Y29tbWVudF9pZCJ9
        KTsKICAgICAgfSk7CiAgICB9KTsKICAgIGBgYAogICAgVGhpcyBhcmd1bWVu
        dCB3aWxsIGJlY29tZSB0aGUgbW9kZWwgY29udGV4dCBvZiB0aGUgbGlua2Vk
        IHJvdXRlOgoKICAgIGBgYGhhbmRsZWJhcnMKICAgIHt7I2xpbmstdG8gJ3Bo
        b3RvR2FsbGVyeS5jb21tZW50JyBhUGhvdG8gY29tbWVudH19CiAgICAgIHt7
        Y29tbWVudC5ib2R5fX0KICAgIHt7L2xpbmstdG99fQogICAgYGBgCgogICAg
        YGBgaHRtbAogICAgPGEgaHJlZj0iL2hhbXN0ZXItcGhvdG9zLzQyL2NvbW1l
        bnQvNzE4Ij4KICAgICAgQSsrKyB3b3VsZCBzbnVnZ2xlIGFnYWluLgogICAg
        PC9hPgogICAgYGBgCgogICAgIyMjIFN1cHBseWluZyBhbiBleHBsaWNpdCBk
        eW5hbWljIHNlZ21lbnQgdmFsdWUKICAgIElmIHlvdSBkb24ndCBoYXZlIGEg
        bW9kZWwgb2JqZWN0IGF2YWlsYWJsZSB0byBwYXNzIHRvIGB7e2xpbmstdG99
        fWAsCiAgICBhbiBvcHRpb25hbCBzdHJpbmcgb3IgaW50ZWdlciBhcmd1bWVu
        dCBjYW4gYmUgcGFzc2VkIGZvciByb3V0ZXMgd2hvc2UKICAgIHBhdGhzIGNv
        bnRhaW4gZHluYW1pYyBzZWdtZW50cy4gVGhpcyBhcmd1bWVudCB3aWxsIGJl
        Y29tZSB0aGUgdmFsdWUKICAgIG9mIHRoZSBkeW5hbWljIHNlZ21lbnQ6Cgog
        ICAgYGBgamF2YXNjcmlwdAogICAgQXBwLlJvdXRlci5tYXAoZnVuY3Rpb24o
        KSB7CiAgICAgIHRoaXMucmVzb3VyY2UoInBob3RvR2FsbGVyeSIsIHtwYXRo
        OiAiaGFtc3Rlci1waG90b3MvOnBob3RvX2lkIn0pOwogICAgfSk7CiAgICBg
        YGAKCiAgICBgYGBoYW5kbGViYXJzCiAgICB7eyNsaW5rLXRvICdwaG90b0dh
        bGxlcnknIGFQaG90b0lkfX0KICAgICAge3thUGhvdG8udGl0bGV9fQogICAg
        e3svbGluay10b319CiAgICBgYGAKCiAgICBgYGBodG1sCiAgICA8YSBocmVm
        PSIvaGFtc3Rlci1waG90b3MvNDIiPgogICAgICBUb21zdGVyCiAgICA8L2E+
        CiAgICBgYGAKCiAgICBXaGVuIHRyYW5zaXRpb25pbmcgaW50byB0aGUgbGlu
        a2VkIHJvdXRlLCB0aGUgYG1vZGVsYCBob29rIHdpbGwKICAgIGJlIHRyaWdn
        ZXJlZCB3aXRoIHBhcmFtZXRlcnMgaW5jbHVkaW5nIHRoaXMgcGFzc2VkIGlk
        ZW50aWZpZXIuCgogICAgIyMjIE92ZXJyaWRpbmcgYXR0cmlidXRlcwogICAg
        WW91IGNhbiBvdmVycmlkZSBhbnkgZ2l2ZW4gcHJvcGVydHkgb2YgdGhlIEVt
        YmVyLkxpbmtWaWV3CiAgICB0aGF0IGlzIGdlbmVyYXRlZCBieSB0aGUgYHt7
        bGluay10b319YCBoZWxwZXIgYnkgcGFzc2luZwogICAga2V5L3ZhbHVlIHBh
        aXJzLCBsaWtlIHNvOgoKICAgIGBgYGhhbmRsZWJhcnMKICAgIHt7I2xpbmst
        dG8gIGFQaG90byB0YWdOYW1lPSdsaScgdGl0bGU9J0ZvbGxvd2luZyB0aGlz
        IGxpbmsgd2lsbCBjaGFuZ2UgeW91ciBsaWZlJyBjbGFzc05hbWVzPVsncGlj
        JywgJ3N3ZWV0J119fQogICAgICBVaC1tYXppbmchCiAgICB7ey9saW5rLXRv
        fX0KICAgIGBgYAoKICAgIFNlZSBbRW1iZXIuTGlua1ZpZXddKC9hcGkvY2xh
        c3Nlcy9FbWJlci5MaW5rVmlldy5odG1sKSBmb3IgYQogICAgY29tcGxldGUg
        bGlzdCBvZiBvdmVycmlkZWFibGUgcHJvcGVydGllcy4gQmUgc3VyZSB0byBh
        bHNvCiAgICBjaGVjayBvdXQgaW5oZXJpdGVkIHByb3BlcnRpZXMgb2YgYExp
        bmtWaWV3YC4KCiAgICAjIyMgT3ZlcnJpZGluZyBBcHBsaWNhdGlvbi13aWRl
        IERlZmF1bHRzCiAgICBgYHt7bGluay10b319YGAgY3JlYXRlcyBhbiBpbnN0
        YW5jZSBvZiBFbWJlci5MaW5rVmlldwogICAgZm9yIHJlbmRlcmluZy4gVG8g
        b3ZlcnJpZGUgb3B0aW9ucyBmb3IgeW91ciBlbnRpcmUKICAgIGFwcGxpY2F0
        aW9uLCByZW9wZW4gRW1iZXIuTGlua1ZpZXcgYW5kIHN1cHBseSB0aGUKICAg
        IGRlc2lyZWQgdmFsdWVzOgoKICAgIGBgYCBqYXZhc2NyaXB0CiAgICBFbWJl
        ci5MaW5rVmlldy5yZW9wZW4oewogICAgICBhY3RpdmVDbGFzczogImlzLWFj
        dGl2ZSIsCiAgICAgIHRhZ05hbWU6ICdsaScKICAgIH0pCiAgICBgYGAKCiAg
        ICBJdCBpcyBhbHNvIHBvc3NpYmxlIHRvIG92ZXJyaWRlIHRoZSBkZWZhdWx0
        IGV2ZW50IGluCiAgICB0aGlzIG1hbm5lcjoKCiAgICBgYGAgamF2YXNjcmlw
        dAogICAgRW1iZXIuTGlua1ZpZXcucmVvcGVuKHsKICAgICAgZXZlbnROYW1l
        OiAnY3VzdG9tRXZlbnROYW1lJwogICAgfSk7CiAgICBgYGAKCiAgICBAbWV0
        aG9kIGxpbmstdG8KICAgIEBmb3IgRW1iZXIuSGFuZGxlYmFycy5oZWxwZXJz
        CiAgICBAcGFyYW0ge1N0cmluZ30gcm91dGVOYW1lCiAgICBAcGFyYW0ge09i
        amVjdH0gW2NvbnRleHRdKgogICAgQHBhcmFtIFtvcHRpb25zXSB7T2JqZWN0
        fSBIYW5kbGViYXJzIGtleS92YWx1ZSBwYWlycyBvZiBvcHRpb25zLCB5b3Ug
        Y2FuIG92ZXJyaWRlIGFueSBwcm9wZXJ0eSBvZiBFbWJlci5MaW5rVmlldwog
        ICAgQHJldHVybiB7U3RyaW5nfSBIVE1MIHN0cmluZwogICAgQHNlZSB7RW1i
        ZXIuTGlua1ZpZXd9CiAgKi8KICBFbWJlci5IYW5kbGViYXJzLnJlZ2lzdGVy
        SGVscGVyKCdsaW5rLXRvJywgZnVuY3Rpb24obmFtZSkgewogICAgdmFyIG9w
        dGlvbnMgPSBbXS5zbGljZS5jYWxsKGFyZ3VtZW50cywgLTEpWzBdLAogICAg
        ICAgIHBhcmFtcyA9IFtdLnNsaWNlLmNhbGwoYXJndW1lbnRzLCAwLCAtMSks
        CiAgICAgICAgaGFzaCA9IG9wdGlvbnMuaGFzaDsKCiAgICBoYXNoLmRpc2Fi
        bGVkQmluZGluZyA9IGhhc2guZGlzYWJsZWRXaGVuOwoKICAgIGhhc2gucGFy
        YW1ldGVycyA9IHsKICAgICAgY29udGV4dDogdGhpcywKICAgICAgb3B0aW9u
        czogb3B0aW9ucywKICAgICAgcGFyYW1zOiBwYXJhbXMKICAgIH07CgogICAg
        cmV0dXJuIEVtYmVyLkhhbmRsZWJhcnMuaGVscGVycy52aWV3LmNhbGwodGhp
        cywgTGlua1ZpZXcsIG9wdGlvbnMpOwogIH0pOwoKICAvKioKICAgIFNlZSBb
        bGluay10b10oL2FwaS9jbGFzc2VzL0VtYmVyLkhhbmRsZWJhcnMuaGVscGVy
        cy5odG1sI21ldGhvZF9saW5rLXRvKQoKICAgIEBtZXRob2QgbGlua1RvCiAg
        ICBAZm9yIEVtYmVyLkhhbmRsZWJhcnMuaGVscGVycwogICAgQGRlcHJlY2F0
        ZWQKICAgIEBwYXJhbSB7U3RyaW5nfSByb3V0ZU5hbWUKICAgIEBwYXJhbSB7
        T2JqZWN0fSBbY29udGV4dF0qCiAgICBAcmV0dXJuIHtTdHJpbmd9IEhUTUwg
        c3RyaW5nCiAgKi8KICBFbWJlci5IYW5kbGViYXJzLnJlZ2lzdGVySGVscGVy
        KCdsaW5rVG8nLCBFbWJlci5IYW5kbGViYXJzLmhlbHBlcnNbJ2xpbmstdG8n
        XSk7Cn0pOwoKCgp9KSgpOwoKCgooZnVuY3Rpb24oKSB7Ci8qKgpAbW9kdWxl
        IGVtYmVyCkBzdWJtb2R1bGUgZW1iZXItcm91dGluZwoqLwoKdmFyIGdldCA9
        IEVtYmVyLmdldCwgc2V0ID0gRW1iZXIuc2V0OwpFbWJlci5vbkxvYWQoJ0Vt
        YmVyLkhhbmRsZWJhcnMnLCBmdW5jdGlvbihIYW5kbGViYXJzKSB7CiAgLyoq
        CiAgQG1vZHVsZSBlbWJlcgogIEBzdWJtb2R1bGUgZW1iZXItcm91dGluZwog
        ICovCgogIEhhbmRsZWJhcnMuT3V0bGV0VmlldyA9IEVtYmVyLkNvbnRhaW5l
        clZpZXcuZXh0ZW5kKEVtYmVyLl9NZXRhbW9ycGgpOwoKICAvKioKICAgIFRo
        ZSBgb3V0bGV0YCBoZWxwZXIgaXMgYSBwbGFjZWhvbGRlciB0aGF0IHRoZSBy
        b3V0ZXIgd2lsbCBmaWxsIGluIHdpdGgKICAgIHRoZSBhcHByb3ByaWF0ZSB0
        ZW1wbGF0ZSBiYXNlZCBvbiB0aGUgY3VycmVudCBzdGF0ZSBvZiB0aGUgYXBw
        bGljYXRpb24uCgogICAgYGBgIGhhbmRsZWJhcnMKICAgIHt7b3V0bGV0fX0K
        ICAgIGBgYAoKICAgIEJ5IGRlZmF1bHQsIGEgdGVtcGxhdGUgYmFzZWQgb24g
        RW1iZXIncyBuYW1pbmcgY29udmVudGlvbnMgd2lsbCBiZSByZW5kZXJlZAog
        ICAgaW50byB0aGUgYG91dGxldGAgKGUuZy4gYEFwcC5Qb3N0c1JvdXRlYCB3
        aWxsIHJlbmRlciB0aGUgYHBvc3RzYCB0ZW1wbGF0ZSkuCgogICAgWW91IGNh
        biByZW5kZXIgYSBkaWZmZXJlbnQgdGVtcGxhdGUgYnkgdXNpbmcgdGhlIGBy
        ZW5kZXIoKWAgbWV0aG9kIGluIHRoZQogICAgcm91dGUncyBgcmVuZGVyVGVt
        cGxhdGVgIGhvb2suIFRoZSBmb2xsb3dpbmcgd2lsbCByZW5kZXIgdGhlIGBm
        YXZvcml0ZVBvc3RgCiAgICB0ZW1wbGF0ZSBpbnRvIHRoZSBgb3V0bGV0YC4K
        CiAgICBgYGAgamF2YXNjcmlwdAogICAgQXBwLlBvc3RzUm91dGUgPSBFbWJl
        ci5Sb3V0ZS5leHRlbmQoewogICAgICByZW5kZXJUZW1wbGF0ZTogZnVuY3Rp
        b24oKSB7CiAgICAgICAgdGhpcy5yZW5kZXIoJ2Zhdm9yaXRlUG9zdCcpOwog
        ICAgICB9CiAgICB9KTsKICAgIGBgYAoKICAgIFlvdSBjYW4gY3JlYXRlIGN1
        c3RvbSBuYW1lZCBvdXRsZXRzIGZvciBtb3JlIGNvbnRyb2wuCgogICAgYGBg
        IGhhbmRsZWJhcnMKICAgIHt7b3V0bGV0ICdmYXZvcml0ZVBvc3QnfX0KICAg
        IHt7b3V0bGV0ICdwb3N0cyd9fQogICAgYGBgCgogICAgVGhlbiB5b3UgY2Fu
        IGRlZmluZSB3aGF0IHRlbXBsYXRlIGlzIHJlbmRlcmVkIGludG8gZWFjaCBv
        dXRsZXQgaW4geW91cgogICAgcm91dGUuCgoKICAgIGBgYCBqYXZhc2NyaXB0
        CiAgICBBcHAuUG9zdHNSb3V0ZSA9IEVtYmVyLlJvdXRlLmV4dGVuZCh7CiAg
        ICAgIHJlbmRlclRlbXBsYXRlOiBmdW5jdGlvbigpIHsKICAgICAgICB0aGlz
        LnJlbmRlcignZmF2b3JpdGVQb3N0JywgeyBvdXRsZXQ6ICdmYXZvcml0ZVBv
        c3QnIH0pOwogICAgICAgIHRoaXMucmVuZGVyKCdwb3N0cycsIHsgb3V0bGV0
        OiAncG9zdHMnIH0pOwogICAgICB9CiAgICB9KTsKICAgIGBgYAoKICAgIFlv
        dSBjYW4gc3BlY2lmeSB0aGUgdmlldyBjbGFzcyB0aGF0IHRoZSBvdXRsZXQg
        dXNlcyB0byBjb250YWluIGFuZCBtYW5hZ2UgdGhlCiAgICB0ZW1wbGF0ZXMg
        cmVuZGVyZWQgaW50byBpdC4KCiAgICBgYGAgaGFuZGxlYmFycwogICAge3tv
        dXRsZXQgdmlld0NsYXNzPUFwcC5TZWN0aW9uQ29udGFpbmVyfX0KICAgIGBg
        YAoKICAgIGBgYCBqYXZhc2NyaXB0CiAgICBBcHAuU2VjdGlvbkNvbnRhaW5l
        ciA9IEVtYmVyLkNvbnRhaW5lclZpZXcuZXh0ZW5kKHsKICAgICAgdGFnTmFt
        ZTogJ3NlY3Rpb24nLAogICAgICBjbGFzc05hbWVzOiBbJ3NwZWNpYWwnXQog
        ICAgfSk7CiAgICBgYGAKCiAgICBAbWV0aG9kIG91dGxldAogICAgQGZvciBF
        bWJlci5IYW5kbGViYXJzLmhlbHBlcnMKICAgIEBwYXJhbSB7U3RyaW5nfSBw
        cm9wZXJ0eSB0aGUgcHJvcGVydHkgb24gdGhlIGNvbnRyb2xsZXIKICAgICAg
        dGhhdCBob2xkcyB0aGUgdmlldyBmb3IgdGhpcyBvdXRsZXQKICAgIEByZXR1
        cm4ge1N0cmluZ30gSFRNTCBzdHJpbmcKICAqLwogIEhhbmRsZWJhcnMucmVn
        aXN0ZXJIZWxwZXIoJ291dGxldCcsIGZ1bmN0aW9uKHByb3BlcnR5LCBvcHRp
        b25zKSB7CiAgICB2YXIgb3V0bGV0U291cmNlLCBvdXRsZXRDb250YWluZXJD
        bGFzczsKCiAgICBpZiAocHJvcGVydHkgJiYgcHJvcGVydHkuZGF0YSAmJiBw
        cm9wZXJ0eS5kYXRhLmlzUmVuZGVyRGF0YSkgewogICAgICBvcHRpb25zID0g
        cHJvcGVydHk7CiAgICAgIHByb3BlcnR5ID0gJ21haW4nOwogICAgfQoKICAg
        IG91dGxldFNvdXJjZSA9IG9wdGlvbnMuZGF0YS52aWV3OwogICAgd2hpbGUg
        KCFvdXRsZXRTb3VyY2UuZ2V0KCd0ZW1wbGF0ZS5pc1RvcCcpKSB7CiAgICAg
        IG91dGxldFNvdXJjZSA9IG91dGxldFNvdXJjZS5nZXQoJ19wYXJlbnRWaWV3
        Jyk7CiAgICB9CgogICAgb3V0bGV0Q29udGFpbmVyQ2xhc3MgPSBvcHRpb25z
        Lmhhc2gudmlld0NsYXNzIHx8IEhhbmRsZWJhcnMuT3V0bGV0VmlldzsKCiAg
        ICBvcHRpb25zLmRhdGEudmlldy5zZXQoJ291dGxldFNvdXJjZScsIG91dGxl
        dFNvdXJjZSk7CiAgICBvcHRpb25zLmhhc2guY3VycmVudFZpZXdCaW5kaW5n
        ID0gJ192aWV3Lm91dGxldFNvdXJjZS5fb3V0bGV0cy4nICsgcHJvcGVydHk7
        CgogICAgcmV0dXJuIEhhbmRsZWJhcnMuaGVscGVycy52aWV3LmNhbGwodGhp
        cywgb3V0bGV0Q29udGFpbmVyQ2xhc3MsIG9wdGlvbnMpOwogIH0pOwp9KTsK
        Cn0pKCk7CgoKCihmdW5jdGlvbigpIHsKLyoqCkBtb2R1bGUgZW1iZXIKQHN1
        Ym1vZHVsZSBlbWJlci1yb3V0aW5nCiovCgp2YXIgZ2V0ID0gRW1iZXIuZ2V0
        LCBzZXQgPSBFbWJlci5zZXQ7CkVtYmVyLm9uTG9hZCgnRW1iZXIuSGFuZGxl
        YmFycycsIGZ1bmN0aW9uKEhhbmRsZWJhcnMpIHsKCiAgLyoqCiAgICBDYWxs
        aW5nIGBge3tyZW5kZXJ9fWBgIGZyb20gd2l0aGluIGEgdGVtcGxhdGUgd2ls
        bCBpbnNlcnQgYW5vdGhlciAKICAgIHRlbXBsYXRlIHRoYXQgbWF0Y2hlcyB0
        aGUgcHJvdmlkZWQgbmFtZS4gVGhlIGluc2VydGVkIHRlbXBsYXRlIHdpbGwK
        ICAgIGFjY2VzcyBpdHMgcHJvcGVydGllcyBvbiBpdHMgb3duIGNvbnRyb2xs
        ZXIgKHJhdGhlciB0aGFuIHRoZSBjb250cm9sbGVyCiAgICBvZiB0aGUgcGFy
        ZW50IHRlbXBsYXRlKS4KCiAgICBJZiBhIHZpZXcgY2xhc3Mgd2l0aCB0aGUg
        c2FtZSBuYW1lIGV4aXN0cywgdGhlIHZpZXcgY2xhc3MgYWxzbyB3aWxsIGJl
        IHVzZWQuCiAgICAKICAgIE5vdGU6IEEgZ2l2ZW4gY29udHJvbGxlciBtYXkg
        b25seSBiZSB1c2VkICpvbmNlKiBpbiB5b3VyIGFwcCBpbiB0aGlzIG1hbm5l
        ci4KICAgIEEgc2luZ2xldG9uIGluc3RhbmNlIG9mIHRoZSBjb250cm9sbGVy
        IHdpbGwgYmUgY3JlYXRlZCBmb3IgeW91LgoKICAgIEV4YW1wbGU6CgogICAg
        YGBgamF2YXNjcmlwdAogICAgQXBwLk5hdmlnYXRpb25Db250cm9sbGVyID0g
        RW1iZXIuQ29udHJvbGxlci5leHRlbmQoewogICAgICB3aG86ICJ3b3JsZCIK
        ICAgIH0pOwogICAgYGBgCgogICAgYGBgaGFuZGVsYmFycwogICAgPCEtLSBu
        YXZpZ2F0aW9uLmhicyAtLT4KICAgIEhlbGxvLCB7e3dob319LgogICAgYGBg
        CgogICAgYGBgaGFuZGVsYmFycwogICAgPCEtLSBhcHBsaWNhdGlvbnMuaGJz
        IC0tPgogICAgPGgxPk15IGdyZWF0IGFwcDwvaDE+CiAgICB7e3JlbmRlciBu
        YXZpZ2F0b259fQogICAgYGBgCiAgICAKICAgIGBgYGh0bWwKICAgIDxoMT5N
        eSBncmVhdCBhcHA8L2gxPgogICAgPGRpdiBjbGFzcz0nZW1iZXItdmlldyc+
        CiAgICAgIEhlbGxvLCB3b3JsZC4KICAgIDwvZGl2PgogICAgYGBgCgogICAg
        T3B0aW9uYWxseSB5b3UgbWF5IHByb3ZpZGUgYSAgc2Vjb25kIGFyZ3VtZW50
        OiBhIHByb3BlcnR5IHBhdGgKICAgIHRoYXQgd2lsbCBiZSBib3VuZCB0byB0
        aGUgYG1vZGVsYCBwcm9wZXJ0eSBvZiB0aGUgY29udHJvbGxlci4KCiAgICBJ
        ZiBhIGBtb2RlbGAgcHJvcGVydHkgcGF0aCBpcyBzcGVjaWZpZWQsIHRoZW4g
        YSBuZXcgaW5zdGFuY2Ugb2YgdGhlCiAgICBjb250cm9sbGVyIHdpbGwgYmUg
        Y3JlYXRlZCBhbmQgYHt7cmVuZGVyfX1gIGNhbiBiZSB1c2VkIG11bHRpcGxl
        IHRpbWVzCiAgICB3aXRoIHRoZSBzYW1lIG5hbWUuCgogICBGb3IgZXhhbXBs
        ZSBpZiB5b3UgaGFkIHRoaXMgYGF1dGhvcmAgdGVtcGxhdGUuCgogICBgYGBo
        YW5kbGViYXJzCjxkaXYgY2xhc3M9ImF1dGhvciI+CiAgV3JpdHRlbiBieSB7
        e2ZpcnN0TmFtZX19IHt7bGFzdE5hbWV9fS4KICBUb3RhbCBQb3N0czoge3tw
        b3N0Q291bnR9fQo8L2Rpdj4KICBgYGAKCiAgWW91IGNvdWxkIHJlbmRlciBp
        dCBpbnNpZGUgdGhlIGBwb3N0YCB0ZW1wbGF0ZSB1c2luZyB0aGUgYHJlbmRl
        cmAgaGVscGVyLgoKICBgYGBoYW5kbGViYXJzCjxkaXYgY2xhc3M9InBvc3Qi
        PgogIDxoMT57e3RpdGxlfX08L2gxPgogIDxkaXY+e3tib2R5fX08L2Rpdj4K
        ICB7e3JlbmRlciAiYXV0aG9yIiBhdXRob3J9fQo8L2Rpdj4KICAgYGBgCgog
        ICAgQG1ldGhvZCByZW5kZXIKICAgIEBmb3IgRW1iZXIuSGFuZGxlYmFycy5o
        ZWxwZXJzCiAgICBAcGFyYW0ge1N0cmluZ30gbmFtZQogICAgQHBhcmFtIHtP
        YmplY3Q/fSBjb250ZXh0U3RyaW5nCiAgICBAcGFyYW0ge0hhc2h9IG9wdGlv
        bnMKICAgIEByZXR1cm4ge1N0cmluZ30gSFRNTCBzdHJpbmcKICAqLwogIEVt
        YmVyLkhhbmRsZWJhcnMucmVnaXN0ZXJIZWxwZXIoJ3JlbmRlcicsIGZ1bmN0
        aW9uKG5hbWUsIGNvbnRleHRTdHJpbmcsIG9wdGlvbnMpIHsKICAgIEVtYmVy
        LmFzc2VydCgiWW91IG11c3QgcGFzcyBhIHRlbXBsYXRlIHRvIHJlbmRlciIs
        IGFyZ3VtZW50cy5sZW5ndGggPj0gMik7CiAgICB2YXIgY29udGV4dFByb3Zp
        ZGVkID0gYXJndW1lbnRzLmxlbmd0aCA9PT0gMywKICAgICAgICBjb250YWlu
        ZXIsIHJvdXRlciwgY29udHJvbGxlciwgdmlldywgY29udGV4dCwgbG9va3Vw
        T3B0aW9uczsKCiAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMikgewog
        ICAgICBvcHRpb25zID0gY29udGV4dFN0cmluZzsKICAgICAgY29udGV4dFN0
        cmluZyA9IHVuZGVmaW5lZDsKICAgIH0KCiAgICBpZiAodHlwZW9mIGNvbnRl
        eHRTdHJpbmcgPT09ICdzdHJpbmcnKSB7CiAgICAgIGNvbnRleHQgPSBFbWJl
        ci5IYW5kbGViYXJzLmdldChvcHRpb25zLmNvbnRleHRzWzFdLCBjb250ZXh0
        U3RyaW5nLCBvcHRpb25zKTsKICAgICAgbG9va3VwT3B0aW9ucyA9IHsgc2lu
        Z2xldG9uOiBmYWxzZSB9OwogICAgfQoKICAgIG5hbWUgPSBuYW1lLnJlcGxh
        Y2UoL1wvL2csICcuJyk7CiAgICBjb250YWluZXIgPSBvcHRpb25zLmRhdGEu
        a2V5d29yZHMuY29udHJvbGxlci5jb250YWluZXI7CiAgICByb3V0ZXIgPSBj
        b250YWluZXIubG9va3VwKCdyb3V0ZXI6bWFpbicpOwoKICAgIEVtYmVyLmFz
        c2VydCgiWW91IGNhbiBvbmx5IHVzZSB0aGUge3tyZW5kZXJ9fSBoZWxwZXIg
        b25jZSB3aXRob3V0IGEgbW9kZWwgb2JqZWN0IGFzIGl0cyBzZWNvbmQgYXJn
        dW1lbnQsIGFzIGluIHt7cmVuZGVyIFwicG9zdFwiIHBvc3R9fS4iLCBjb250
        ZXh0UHJvdmlkZWQgfHwgIXJvdXRlciB8fCAhcm91dGVyLl9sb29rdXBBY3Rp
        dmVWaWV3KG5hbWUpKTsKCiAgICB2aWV3ID0gY29udGFpbmVyLmxvb2t1cCgn
        dmlldzonICsgbmFtZSkgfHwgY29udGFpbmVyLmxvb2t1cCgndmlldzpkZWZh
        dWx0Jyk7CgogICAgdmFyIGNvbnRyb2xsZXJOYW1lID0gb3B0aW9ucy5oYXNo
        LmNvbnRyb2xsZXI7CgogICAgLy8gTG9vayB1cCB0aGUgY29udHJvbGxlciBi
        eSBuYW1lLCBpZiBwcm92aWRlZC4KICAgIGlmIChjb250cm9sbGVyTmFtZSkg
        ewogICAgICBjb250cm9sbGVyID0gY29udGFpbmVyLmxvb2t1cCgnY29udHJv
        bGxlcjonICsgY29udHJvbGxlck5hbWUsIGxvb2t1cE9wdGlvbnMpOwogICAg
        ICBFbWJlci5hc3NlcnQoIlRoZSBjb250cm9sbGVyIG5hbWUgeW91IHN1cHBs
        aWVkICciICsgY29udHJvbGxlck5hbWUgKyAiJyBkaWQgbm90IHJlc29sdmUg
        dG8gYSBjb250cm9sbGVyLiIsICEhY29udHJvbGxlcik7CiAgICB9IGVsc2Ug
        ewogICAgICBjb250cm9sbGVyID0gY29udGFpbmVyLmxvb2t1cCgnY29udHJv
        bGxlcjonICsgbmFtZSwgbG9va3VwT3B0aW9ucykgfHwKICAgICAgICAgICAg
        ICAgICAgICAgIEVtYmVyLmdlbmVyYXRlQ29udHJvbGxlcihjb250YWluZXIs
        IG5hbWUsIGNvbnRleHQpOwogICAgfQoKICAgIGlmIChjb250cm9sbGVyICYm
        IGNvbnRleHRQcm92aWRlZCkgewogICAgICBjb250cm9sbGVyLnNldCgnbW9k
        ZWwnLCBjb250ZXh0KTsKICAgIH0KCiAgICB2YXIgcm9vdCA9IG9wdGlvbnMu
        Y29udGV4dHNbMV07CgogICAgaWYgKHJvb3QpIHsKICAgICAgdmlldy5yZWdp
        c3Rlck9ic2VydmVyKHJvb3QsIGNvbnRleHRTdHJpbmcsIGZ1bmN0aW9uKCkg
        ewogICAgICAgIGNvbnRyb2xsZXIuc2V0KCdtb2RlbCcsIEVtYmVyLkhhbmRs
        ZWJhcnMuZ2V0KHJvb3QsIGNvbnRleHRTdHJpbmcsIG9wdGlvbnMpKTsKICAg
        ICAgfSk7CiAgICB9CgogICAgY29udHJvbGxlci5zZXQoJ3RhcmdldCcsIG9w
        dGlvbnMuZGF0YS5rZXl3b3Jkcy5jb250cm9sbGVyKTsKCiAgICBvcHRpb25z
        Lmhhc2gudmlld05hbWUgPSBFbWJlci5TdHJpbmcuY2FtZWxpemUobmFtZSk7
        CiAgICBvcHRpb25zLmhhc2gudGVtcGxhdGUgPSBjb250YWluZXIubG9va3Vw
        KCd0ZW1wbGF0ZTonICsgbmFtZSk7CiAgICBvcHRpb25zLmhhc2guY29udHJv
        bGxlciA9IGNvbnRyb2xsZXI7CgogICAgaWYgKHJvdXRlciAmJiAhY29udGV4
        dCkgewogICAgICByb3V0ZXIuX2Nvbm5lY3RBY3RpdmVWaWV3KG5hbWUsIHZp
        ZXcpOwogICAgfQoKICAgIEVtYmVyLkhhbmRsZWJhcnMuaGVscGVycy52aWV3
        LmNhbGwodGhpcywgdmlldywgb3B0aW9ucyk7CiAgfSk7Cgp9KTsKCn0pKCk7
        CgoKCihmdW5jdGlvbigpIHsKLyoqCkBtb2R1bGUgZW1iZXIKQHN1Ym1vZHVs
        ZSBlbWJlci1yb3V0aW5nCiovCkVtYmVyLm9uTG9hZCgnRW1iZXIuSGFuZGxl
        YmFycycsIGZ1bmN0aW9uKEhhbmRsZWJhcnMpIHsKCiAgdmFyIHJlc29sdmVQ
        YXJhbXMgPSBFbWJlci5Sb3V0ZXIucmVzb2x2ZVBhcmFtcywKICAgICAgaXNT
        aW1wbGVDbGljayA9IEVtYmVyLlZpZXdVdGlscy5pc1NpbXBsZUNsaWNrOwoK
        ICB2YXIgRW1iZXJIYW5kbGViYXJzID0gRW1iZXIuSGFuZGxlYmFycywKICAg
        ICAgaGFuZGxlYmFyc0dldCA9IEVtYmVySGFuZGxlYmFycy5nZXQsCiAgICAg
        IFNhZmVTdHJpbmcgPSBFbWJlckhhbmRsZWJhcnMuU2FmZVN0cmluZywKICAg
        ICAgZm9yRWFjaCA9IEVtYmVyLkFycmF5UG9seWZpbGxzLmZvckVhY2gsCiAg
        ICAgIGdldCA9IEVtYmVyLmdldCwKICAgICAgYV9zbGljZSA9IEFycmF5LnBy
        b3RvdHlwZS5zbGljZTsKCiAgZnVuY3Rpb24gYXJncyhvcHRpb25zLCBhY3Rp
        b25OYW1lKSB7CiAgICB2YXIgcmV0ID0gW107CiAgICBpZiAoYWN0aW9uTmFt
        ZSkgeyByZXQucHVzaChhY3Rpb25OYW1lKTsgfQoKICAgIHZhciB0eXBlcyA9
        IG9wdGlvbnMub3B0aW9ucy50eXBlcy5zbGljZSgxKSwKICAgICAgICBkYXRh
        ID0gb3B0aW9ucy5vcHRpb25zLmRhdGE7CgogICAgcmV0dXJuIHJldC5jb25j
        YXQocmVzb2x2ZVBhcmFtcyhvcHRpb25zLmNvbnRleHQsIG9wdGlvbnMucGFy
        YW1zLCB7IHR5cGVzOiB0eXBlcywgZGF0YTogZGF0YSB9KSk7CiAgfQoKICB2
        YXIgQWN0aW9uSGVscGVyID0gRW1iZXJIYW5kbGViYXJzLkFjdGlvbkhlbHBl
        ciA9IHsKICAgIHJlZ2lzdGVyZWRBY3Rpb25zOiB7fQogIH07CgogIHZhciBr
        ZXlzID0gWyJhbHQiLCAic2hpZnQiLCAibWV0YSIsICJjdHJsIl07CgogIHZh
        ciBpc0FsbG93ZWRDbGljayA9IGZ1bmN0aW9uKGV2ZW50LCBhbGxvd2VkS2V5
        cykgewogICAgaWYgKHR5cGVvZiBhbGxvd2VkS2V5cyA9PT0gInVuZGVmaW5l
        ZCIpIHsKICAgICAgcmV0dXJuIGlzU2ltcGxlQ2xpY2soZXZlbnQpOwogICAg
        fQoKICAgIGlmIChhbGxvd2VkS2V5cy5pbmRleE9mKCJhbnkiKSA+PSAwKSB7
        CiAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIHZhciBhbGxvd2VkID0g
        dHJ1ZTsKCiAgICBmb3JFYWNoLmNhbGwoa2V5cywgZnVuY3Rpb24oa2V5KSB7
        CiAgICAgIGlmIChldmVudFtrZXkgKyAiS2V5Il0gJiYgYWxsb3dlZEtleXMu
        aW5kZXhPZihrZXkpID09PSAtMSkgewogICAgICAgIGFsbG93ZWQgPSBmYWxz
        ZTsKICAgICAgfQogICAgfSk7CgogICAgcmV0dXJuIGFsbG93ZWQ7CiAgfTsK
        CiAgQWN0aW9uSGVscGVyLnJlZ2lzdGVyQWN0aW9uID0gZnVuY3Rpb24oYWN0
        aW9uTmFtZSwgb3B0aW9ucywgYWxsb3dlZEtleXMpIHsKICAgIHZhciBhY3Rp
        b25JZCA9ICgrK0VtYmVyLnV1aWQpLnRvU3RyaW5nKCk7CgogICAgQWN0aW9u
        SGVscGVyLnJlZ2lzdGVyZWRBY3Rpb25zW2FjdGlvbklkXSA9IHsKICAgICAg
        ZXZlbnROYW1lOiBvcHRpb25zLmV2ZW50TmFtZSwKICAgICAgaGFuZGxlcjog
        ZnVuY3Rpb24oZXZlbnQpIHsKICAgICAgICBpZiAoIWlzQWxsb3dlZENsaWNr
        KGV2ZW50LCBhbGxvd2VkS2V5cykpIHsgcmV0dXJuIHRydWU7IH0KCiAgICAg
        ICAgZXZlbnQucHJldmVudERlZmF1bHQoKTsKCiAgICAgICAgaWYgKG9wdGlv
        bnMuYnViYmxlcyA9PT0gZmFsc2UpIHsKICAgICAgICAgIGV2ZW50LnN0b3BQ
        cm9wYWdhdGlvbigpOwogICAgICAgIH0KCiAgICAgICAgdmFyIHRhcmdldCA9
        IG9wdGlvbnMudGFyZ2V0OwoKICAgICAgICBpZiAodGFyZ2V0LnRhcmdldCkg
        ewogICAgICAgICAgdGFyZ2V0ID0gaGFuZGxlYmFyc0dldCh0YXJnZXQucm9v
        dCwgdGFyZ2V0LnRhcmdldCwgdGFyZ2V0Lm9wdGlvbnMpOwogICAgICAgIH0g
        ZWxzZSB7CiAgICAgICAgICB0YXJnZXQgPSB0YXJnZXQucm9vdDsKICAgICAg
        ICB9CgogICAgICAgIEVtYmVyLnJ1bihmdW5jdGlvbigpIHsKICAgICAgICAg
        IGlmICh0YXJnZXQuc2VuZCkgewogICAgICAgICAgICB0YXJnZXQuc2VuZC5h
        cHBseSh0YXJnZXQsIGFyZ3Mob3B0aW9ucy5wYXJhbWV0ZXJzLCBhY3Rpb25O
        YW1lKSk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBFbWJlci5h
        c3NlcnQoIlRoZSBhY3Rpb24gJyIgKyBhY3Rpb25OYW1lICsgIicgZGlkIG5v
        dCBleGlzdCBvbiAiICsgdGFyZ2V0LCB0eXBlb2YgdGFyZ2V0W2FjdGlvbk5h
        bWVdID09PSAnZnVuY3Rpb24nKTsKICAgICAgICAgICAgdGFyZ2V0W2FjdGlv
        bk5hbWVdLmFwcGx5KHRhcmdldCwgYXJncyhvcHRpb25zLnBhcmFtZXRlcnMp
        KTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfQogICAgfTsKCiAg
        ICBvcHRpb25zLnZpZXcub24oJ3dpbGxDbGVhclJlbmRlcicsIGZ1bmN0aW9u
        KCkgewogICAgICBkZWxldGUgQWN0aW9uSGVscGVyLnJlZ2lzdGVyZWRBY3Rp
        b25zW2FjdGlvbklkXTsKICAgIH0pOwoKICAgIHJldHVybiBhY3Rpb25JZDsK
        ICB9OwoKICAvKioKICAgIFRoZSBge3thY3Rpb259fWAgaGVscGVyIHJlZ2lz
        dGVycyBhbiBIVE1MIGVsZW1lbnQgd2l0aGluIGEgdGVtcGxhdGUgZm9yIERP
        TQogICAgZXZlbnQgaGFuZGxpbmcgYW5kIGZvcndhcmRzIHRoYXQgaW50ZXJh
        Y3Rpb24gdG8gdGhlIHRlbXBsYXRlcydzIGNvbnRyb2xsZXIKICAgIG9yIHN1
        cHBsaWVkIGB0YXJnZXRgIG9wdGlvbiAoc2VlICdTcGVjaWZ5aW5nIGEgVGFy
        Z2V0JykuCgogICAgSWYgdGhlIGNvbnRyb2xsZXIgZG9lcyBub3QgaW1wbGVt
        ZW50IHRoZSBldmVudCwgdGhlIGV2ZW50IGlzIHNlbnQKICAgIHRvIHRoZSBj
        dXJyZW50IHJvdXRlLCBhbmQgaXQgYnViYmxlcyB1cCB0aGUgcm91dGUgaGll
        cmFyY2h5IGZyb20gdGhlcmUuCgogICAgVXNlciBpbnRlcmFjdGlvbiB3aXRo
        IHRoYXQgZWxlbWVudCB3aWxsIGludm9rZSB0aGUgc3VwcGxpZWQgYWN0aW9u
        IG5hbWUgb24KICAgIHRoZSBhcHByb3ByaWF0ZSB0YXJnZXQuCgogICAgR2l2
        ZW4gdGhlIGZvbGxvd2luZyBhcHBsaWNhdGlvbiBIYW5kbGViYXJzIHRlbXBs
        YXRlIG9uIHRoZSBwYWdlCgogICAgYGBgaGFuZGxlYmFycwogICAgPGRpdiB7
        e2FjdGlvbiAnYW5BY3Rpb25OYW1lJ319PgogICAgICBjbGljayBtZQogICAg
        PC9kaXY+CiAgICBgYGAKCiAgICBBbmQgYXBwbGljYXRpb24gY29kZQoKICAg
        IGBgYGphdmFzY3JpcHQKICAgIEFwcC5BcHBsaWNhdGlvbkNvbnRyb2xsZXIg
        PSBFbWJlci5Db250cm9sbGVyLmV4dGVuZCh7CiAgICAgIGFjdGlvbnM6IHsK
        ICAgICAgICBhbkFjdGlvbk5hbWU6IGZ1bmN0aW9uKCkgewogICAgICAgICAg
        CiAgICAgICAgfSAgCiAgICAgIH0KICAgIH0pOwogICAgYGBgCgogICAgV2ls
        bCByZXN1bHQgaW4gdGhlIGZvbGxvd2luZyByZW5kZXJlZCBIVE1MCgogICAg
        YGBgaHRtbAogICAgPGRpdiBjbGFzcz0iZW1iZXItdmlldyI+CiAgICAgIDxk
        aXYgZGF0YS1lbWJlci1hY3Rpb249IjEiPgogICAgICAgIGNsaWNrIG1lCiAg
        ICAgIDwvZGl2PgogICAgPC9kaXY+CiAgICBgYGAKCiAgICBDbGlja2luZyAi
        Y2xpY2sgbWUiIHdpbGwgdHJpZ2dlciB0aGUgYGFuQWN0aW9uTmFtZWAgYWN0
        aW9uIG9mIHRoZQogICAgYEFwcC5BcHBsaWNhdGlvbkNvbnRyb2xsZXJgLiBJ
        biB0aGlzIGNhc2UsIG5vIGFkZGl0aW9uYWwgcGFyYW1ldGVycyB3aWxsIGJl
        IHBhc3NlZC4KCiAgICBJZiB5b3UgcHJvdmlkZSBhZGRpdGlvbmFsIHBhcmFt
        ZXRlcnMgdG8gdGhlIGhlbHBlcjoKCiAgICBgYGBoYW5kbGViYXJzCiAgICA8
        YnV0dG9uIHt7YWN0aW9uICdlZGl0JyBwb3N0fX0+RWRpdDwvYnV0dG9uPgog
        ICAgYGBgCgogICAgVGhvc2UgcGFyYW1ldGVycyB3aWxsIGJlIHBhc3NlZCBh
        bG9uZyBhcyBhcmd1bWVudHMgdG8gdGhlIEphdmFTY3JpcHQKICAgIGZ1bmN0
        aW9uIGltcGxlbWVudGluZyB0aGUgYWN0aW9uLgoKICAgICMjIyBFdmVudCBQ
        cm9wYWdhdGlvbgoKICAgIEV2ZW50cyB0cmlnZ2VyZWQgdGhyb3VnaCB0aGUg
        YWN0aW9uIGhlbHBlciB3aWxsIGF1dG9tYXRpY2FsbHkgaGF2ZQogICAgYC5w
        cmV2ZW50RGVmYXVsdCgpYCBjYWxsZWQgb24gdGhlbS4gWW91IGRvIG5vdCBu
        ZWVkIHRvIGRvIHNvIGluIHlvdXIgZXZlbnQKICAgIGhhbmRsZXJzLgoKICAg
        IFRvIGFsc28gZGlzYWJsZSBidWJibGluZywgcGFzcyBgYnViYmxlcz1mYWxz
        ZWAgdG8gdGhlIGhlbHBlcjoKCiAgICBgYGBoYW5kbGViYXJzCiAgICA8YnV0
        dG9uIHt7YWN0aW9uICdlZGl0JyBwb3N0IGJ1YmJsZXM9ZmFsc2V9fT5FZGl0
        PC9idXR0b24+CiAgICBgYGAKCiAgICBJZiB5b3UgbmVlZCB0aGUgZGVmYXVs
        dCBoYW5kbGVyIHRvIHRyaWdnZXIgeW91IHNob3VsZCBlaXRoZXIgcmVnaXN0
        ZXIgeW91cgogICAgb3duIGV2ZW50IGhhbmRsZXIsIG9yIHVzZSBldmVudCBt
        ZXRob2RzIG9uIHlvdXIgdmlldyBjbGFzcy4gU2VlIFtFbWJlci5WaWV3XSgv
        YXBpL2NsYXNzZXMvRW1iZXIuVmlldy5odG1sKQogICAgJ1Jlc3BvbmRpbmcg
        dG8gQnJvd3NlciBFdmVudHMnIGZvciBtb3JlIGluZm9ybWF0aW9uLgoKICAg
        ICMjIyBTcGVjaWZ5aW5nIERPTSBldmVudCB0eXBlCgogICAgQnkgZGVmYXVs
        dCB0aGUgYHt7YWN0aW9ufX1gIGhlbHBlciByZWdpc3RlcnMgZm9yIERPTSBg
        Y2xpY2tgIGV2ZW50cy4gWW91IGNhbgogICAgc3VwcGx5IGFuIGBvbmAgb3B0
        aW9uIHRvIHRoZSBoZWxwZXIgdG8gc3BlY2lmeSBhIGRpZmZlcmVudCBET00g
        ZXZlbnQgbmFtZToKCiAgICBgYGBoYW5kbGViYXJzCiAgICA8ZGl2IHt7YWN0
        aW9uICJhbkFjdGlvbk5hbWUiIG9uPSJkb3VibGVDbGljayJ9fT4KICAgICAg
        Y2xpY2sgbWUKICAgIDwvZGl2PgogICAgYGBgCgogICAgU2VlIGBFbWJlci5W
        aWV3YCAnUmVzcG9uZGluZyB0byBCcm93c2VyIEV2ZW50cycgZm9yIGEgbGlz
        dCBvZgogICAgYWNjZXB0YWJsZSBET00gZXZlbnQgbmFtZXMuCgogICAgTk9U
        RTogQmVjYXVzZSBge3thY3Rpb259fWAgZGVwZW5kcyBvbiBFbWJlcidzIGV2
        ZW50IGRpc3BhdGNoIHN5c3RlbSBpdCB3aWxsCiAgICBvbmx5IGZ1bmN0aW9u
        IGlmIGFuIGBFbWJlci5FdmVudERpc3BhdGNoZXJgIGluc3RhbmNlIGlzIGF2
        YWlsYWJsZS4gQW4KICAgIGBFbWJlci5FdmVudERpc3BhdGNoZXJgIGluc3Rh
        bmNlIHdpbGwgYmUgY3JlYXRlZCB3aGVuIGEgbmV3IGBFbWJlci5BcHBsaWNh
        dGlvbmAKICAgIGlzIGNyZWF0ZWQuIEhhdmluZyBhbiBpbnN0YW5jZSBvZiBg
        RW1iZXIuQXBwbGljYXRpb25gIHdpbGwgc2F0aXNmeSB0aGlzCiAgICByZXF1
        aXJlbWVudC4KCiAgICAjIyMgU3BlY2lmeWluZyB3aGl0ZWxpc3RlZCBtb2Rp
        ZmllciBrZXlzCgogICAgQnkgZGVmYXVsdCB0aGUgYHt7YWN0aW9ufX1gIGhl
        bHBlciB3aWxsIGlnbm9yZSBjbGljayBldmVudCB3aXRoIHByZXNzZWQgbW9k
        aWZpZXIKICAgIGtleXMuIFlvdSBjYW4gc3VwcGx5IGFuIGBhbGxvd2VkS2V5
        c2Agb3B0aW9uIHRvIHNwZWNpZnkgd2hpY2gga2V5cyBzaG91bGQgbm90IGJl
        IGlnbm9yZWQuCgogICAgYGBgaGFuZGxlYmFycwogICAgPGRpdiB7e2FjdGlv
        biAiYW5BY3Rpb25OYW1lIiBhbGxvd2VkS2V5cz0iYWx0In19PgogICAgICBj
        bGljayBtZQogICAgPC9kaXY+CiAgICBgYGAKCiAgICBUaGlzIHdheSB0aGUg
        YHt7YWN0aW9ufX1gIHdpbGwgZmlyZSB3aGVuIGNsaWNraW5nIHdpdGggdGhl
        IGFsdCBrZXkgcHJlc3NlZCBkb3duLgoKICAgIEFsdGVybmF0aXZlbHksIHN1
        cHBseSAiYW55IiB0byB0aGUgYGFsbG93ZWRLZXlzYCBvcHRpb24gdG8gYWNj
        ZXB0IGFueSBjb21iaW5hdGlvbiBvZiBtb2RpZmllciBrZXlzLgoKICAgIGBg
        YGhhbmRsZWJhcnMKICAgIDxkaXYge3thY3Rpb24gImFuQWN0aW9uTmFtZSIg
        YWxsb3dlZEtleXM9ImFueSJ9fT4KICAgICAgY2xpY2sgbWUgd2l0aCBhbnkg
        a2V5IHByZXNzZWQKICAgIDwvZGl2PgogICAgYGBgCgogICAgIyMjIFNwZWNp
        ZnlpbmcgYSBUYXJnZXQKCiAgICBUaGVyZSBhcmUgc2V2ZXJhbCBwb3NzaWJs
        ZSB0YXJnZXQgb2JqZWN0cyBmb3IgYHt7YWN0aW9ufX1gIGhlbHBlcnM6Cgog
        ICAgSW4gYSB0eXBpY2FsIEVtYmVyIGFwcGxpY2F0aW9uLCB3aGVyZSB2aWV3
        cyBhcmUgbWFuYWdlZCB0aHJvdWdoIHVzZSBvZiB0aGUKICAgIGB7e291dGxl
        dH19YCBoZWxwZXIsIGFjdGlvbnMgd2lsbCBidWJibGUgdG8gdGhlIGN1cnJl
        bnQgY29udHJvbGxlciwgdGhlbgogICAgdG8gdGhlIGN1cnJlbnQgcm91dGUs
        IGFuZCB0aGVuIHVwIHRoZSByb3V0ZSBoaWVyYXJjaHkuCgogICAgQWx0ZXJu
        YXRpdmVseSwgYSBgdGFyZ2V0YCBvcHRpb24gY2FuIGJlIHByb3ZpZGVkIHRv
        IHRoZSBoZWxwZXIgdG8gY2hhbmdlCiAgICB3aGljaCBvYmplY3Qgd2lsbCBy
        ZWNlaXZlIHRoZSBtZXRob2QgY2FsbC4gVGhpcyBvcHRpb24gbXVzdCBiZSBh
        IHBhdGgKICAgIHRvIGFuIG9iamVjdCwgYWNjZXNzaWJsZSBpbiB0aGUgY3Vy
        cmVudCBjb250ZXh0OgoKICAgIGBgYGhhbmRsZWJhcnMKICAgIHt7ISB0aGUg
        YXBwbGljYXRpb24gdGVtcGxhdGUgfX0KICAgIDxkaXYge3thY3Rpb24gImFu
        QWN0aW9uTmFtZSIgdGFyZ2V0PXZpZXd9fT4KICAgICAgY2xpY2sgbWUKICAg
        IDwvZGl2PgogICAgYGBgCgogICAgYGBgamF2YXNjcmlwdAogICAgQXBwLkFw
        cGxpY2F0aW9uVmlldyA9IEVtYmVyLlZpZXcuZXh0ZW5kKHsKICAgICAgYWN0
        aW9uczogewogICAgICAgIGFuQWN0aW9uTmFtZTogZnVuY3Rpb24oKXt9CiAg
        ICAgIH0KICAgIH0pOwoKICAgIGBgYAoKICAgICMjIyBBZGRpdGlvbmFsIFBh
        cmFtZXRlcnMKCiAgICBZb3UgbWF5IHNwZWNpZnkgYWRkaXRpb25hbCBwYXJh
        bWV0ZXJzIHRvIHRoZSBge3thY3Rpb259fWAgaGVscGVyLiBUaGVzZQogICAg
        cGFyYW1ldGVycyBhcmUgcGFzc2VkIGFsb25nIGFzIHRoZSBhcmd1bWVudHMg
        dG8gdGhlIEphdmFTY3JpcHQgZnVuY3Rpb24KICAgIGltcGxlbWVudGluZyB0
        aGUgYWN0aW9uLgoKICAgIGBgYGhhbmRsZWJhcnMKICAgIHt7I2VhY2ggcGVy
        c29uIGluIHBlb3BsZX19CiAgICAgIDxkaXYge3thY3Rpb24gImVkaXQiIHBl
        cnNvbn19PgogICAgICAgIGNsaWNrIG1lCiAgICAgIDwvZGl2PgogICAge3sv
        ZWFjaH19CiAgICBgYGAKCiAgICBDbGlja2luZyAiY2xpY2sgbWUiIHdpbGwg
        dHJpZ2dlciB0aGUgYGVkaXRgIG1ldGhvZCBvbiB0aGUgY3VycmVudCBjb250
        cm9sbGVyCiAgICB3aXRoIHRoZSB2YWx1ZSBvZiBgcGVyc29uYCBhcyBhIHBh
        cmFtZXRlci4KCiAgICBAbWV0aG9kIGFjdGlvbgogICAgQGZvciBFbWJlci5I
        YW5kbGViYXJzLmhlbHBlcnMKICAgIEBwYXJhbSB7U3RyaW5nfSBhY3Rpb25O
        YW1lCiAgICBAcGFyYW0ge09iamVjdH0gW2NvbnRleHRdKgogICAgQHBhcmFt
        IHtIYXNofSBvcHRpb25zCiAgKi8KICBFbWJlckhhbmRsZWJhcnMucmVnaXN0
        ZXJIZWxwZXIoJ2FjdGlvbicsIGZ1bmN0aW9uKGFjdGlvbk5hbWUpIHsKICAg
        IHZhciBvcHRpb25zID0gYXJndW1lbnRzW2FyZ3VtZW50cy5sZW5ndGggLSAx
        XSwKICAgICAgICBjb250ZXh0cyA9IGFfc2xpY2UuY2FsbChhcmd1bWVudHMs
        IDEsIC0xKTsKCiAgICB2YXIgaGFzaCA9IG9wdGlvbnMuaGFzaCwKICAgICAg
        ICBjb250cm9sbGVyOwoKICAgIC8vIGNyZWF0ZSBhIGhhc2ggdG8gcGFzcyBh
        bG9uZyB0byByZWdpc3RlckFjdGlvbgogICAgdmFyIGFjdGlvbiA9IHsKICAg
        ICAgZXZlbnROYW1lOiBoYXNoLm9uIHx8ICJjbGljayIKICAgIH07CgogICAg
        YWN0aW9uLnBhcmFtZXRlcnMgPSB7CiAgICAgIGNvbnRleHQ6IHRoaXMsCiAg
        ICAgIG9wdGlvbnM6IG9wdGlvbnMsCiAgICAgIHBhcmFtczogY29udGV4dHMK
        ICAgIH07CgogICAgYWN0aW9uLnZpZXcgPSBvcHRpb25zLmRhdGEudmlldzsK
        CiAgICB2YXIgcm9vdCwgdGFyZ2V0OwoKICAgIGlmIChoYXNoLnRhcmdldCkg
        ewogICAgICByb290ID0gdGhpczsKICAgICAgdGFyZ2V0ID0gaGFzaC50YXJn
        ZXQ7CiAgICB9IGVsc2UgaWYgKGNvbnRyb2xsZXIgPSBvcHRpb25zLmRhdGEu
        a2V5d29yZHMuY29udHJvbGxlcikgewogICAgICByb290ID0gY29udHJvbGxl
        cjsKICAgIH0KCiAgICBhY3Rpb24udGFyZ2V0ID0geyByb290OiByb290LCB0
        YXJnZXQ6IHRhcmdldCwgb3B0aW9uczogb3B0aW9ucyB9OwogICAgYWN0aW9u
        LmJ1YmJsZXMgPSBoYXNoLmJ1YmJsZXM7CgogICAgdmFyIGFjdGlvbklkID0g
        QWN0aW9uSGVscGVyLnJlZ2lzdGVyQWN0aW9uKGFjdGlvbk5hbWUsIGFjdGlv
        biwgaGFzaC5hbGxvd2VkS2V5cyk7CiAgICByZXR1cm4gbmV3IFNhZmVTdHJp
        bmcoJ2RhdGEtZW1iZXItYWN0aW9uPSInICsgYWN0aW9uSWQgKyAnIicpOwog
        IH0pOwoKfSk7Cgp9KSgpOwoKCgooZnVuY3Rpb24oKSB7Ci8qKgpAbW9kdWxl
        IGVtYmVyCkBzdWJtb2R1bGUgZW1iZXItcm91dGluZwoqLwoKaWYgKEVtYmVy
        LkVOVi5FWFBFUklNRU5UQUxfQ09OVFJPTF9IRUxQRVIpIHsKICB2YXIgZ2V0
        ID0gRW1iZXIuZ2V0LCBzZXQgPSBFbWJlci5zZXQ7CgogIC8qKgogICBge3tj
        b250cm9sfX1gIHdvcmtzIGxpa2UgcmVuZGVyLCBleGNlcHQgaXQgdXNlcyBh
        IG5ldyBjb250cm9sbGVyIGluc3RhbmNlIGZvciBldmVyeSBjYWxsLCBpbnN0
        ZWFkIG9mIHJldXNpbmcgdGhlIHNpbmdsZXRvbiBjb250cm9sbGVyLgoKICAg
        IFRoZSBjb250cm9sIGhlbHBlciBpcyBjdXJyZW50bHkgdW5kZXIgZGV2ZWxv
        cG1lbnQgYW5kIGlzIGNvbnNpZGVyZWQgZXhwZXJpbWVudGFsLgogICAgVG8g
        ZW5hYmxlIGl0LCBzZXQgYEVOVi5FWFBFUklNRU5UQUxfQ09OVFJPTF9IRUxQ
        RVIgPSB0cnVlYCBiZWZvcmUgcmVxdWlyaW5nIEVtYmVyLgoKICAgRm9yIGV4
        YW1wbGUgaWYgeW91IGhhZCB0aGlzIGBhdXRob3JgIHRlbXBsYXRlLgoKICAg
        YGBgaGFuZGxlYmFycwo8ZGl2IGNsYXNzPSJhdXRob3IiPgogIFdyaXR0ZW4g
        Ynkge3tmaXJzdE5hbWV9fSB7e2xhc3ROYW1lfX0uCiAgVG90YWwgUG9zdHM6
        IHt7cG9zdENvdW50fX0KPC9kaXY+CiAgIGBgYAoKICAgWW91IGNvdWxkIHJl
        bmRlciBpdCBpbnNpZGUgdGhlIGBwb3N0YCB0ZW1wbGF0ZSB1c2luZyB0aGUg
        YGNvbnRyb2xgIGhlbHBlci4KCiAgIGBgYGhhbmRsZWJhcnMKPGRpdiBjbGFz
        cz0icG9zdCI+CiAgPGgxPnt7dGl0bGV9fTwvaDE+CiAgPGRpdj57e2JvZHl9
        fTwvZGl2PgogICAgIHt7Y29udHJvbCAiYXV0aG9yIiBhdXRob3J9fQo8L2Rp
        dj4KICAgYGBgCgogICAgQG1ldGhvZCBjb250cm9sCiAgICBAZm9yIEVtYmVy
        LkhhbmRsZWJhcnMuaGVscGVycwogICAgQHBhcmFtIHtTdHJpbmd9IHBhdGgK
        ICAgIEBwYXJhbSB7U3RyaW5nfSBtb2RlbFBhdGgKICAgIEBwYXJhbSB7SGFz
        aH0gb3B0aW9ucwogICAgQHJldHVybiB7U3RyaW5nfSBIVE1MIHN0cmluZwog
        ICovCiAgRW1iZXIuSGFuZGxlYmFycy5yZWdpc3RlckhlbHBlcignY29udHJv
        bCcsIGZ1bmN0aW9uKHBhdGgsIG1vZGVsUGF0aCwgb3B0aW9ucykgewogICAg
        aWYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDIpIHsKICAgICAgb3B0aW9ucyA9
        IG1vZGVsUGF0aDsKICAgICAgbW9kZWxQYXRoID0gdW5kZWZpbmVkOwogICAg
        fQoKICAgIHZhciBtb2RlbDsKCiAgICBpZiAobW9kZWxQYXRoKSB7CiAgICAg
        IG1vZGVsID0gRW1iZXIuSGFuZGxlYmFycy5nZXQodGhpcywgbW9kZWxQYXRo
        LCBvcHRpb25zKTsKICAgIH0KCiAgICB2YXIgY29udHJvbGxlciA9IG9wdGlv
        bnMuZGF0YS5rZXl3b3Jkcy5jb250cm9sbGVyLAogICAgICAgIHZpZXcgPSBv
        cHRpb25zLmRhdGEua2V5d29yZHMudmlldywKICAgICAgICBjaGlsZHJlbiA9
        IGdldChjb250cm9sbGVyLCAnX2NoaWxkQ29udGFpbmVycycpLAogICAgICAg
        IGNvbnRyb2xJRCA9IG9wdGlvbnMuaGFzaC5jb250cm9sSUQsCiAgICAgICAg
        Y29udGFpbmVyLCBzdWJDb250YWluZXI7CgogICAgaWYgKGNoaWxkcmVuLmhh
        c093blByb3BlcnR5KGNvbnRyb2xJRCkpIHsKICAgICAgc3ViQ29udGFpbmVy
        ID0gY2hpbGRyZW5bY29udHJvbElEXTsKICAgIH0gZWxzZSB7CiAgICAgIGNv
        bnRhaW5lciA9IGdldChjb250cm9sbGVyLCAnY29udGFpbmVyJyksCiAgICAg
        IHN1YkNvbnRhaW5lciA9IGNvbnRhaW5lci5jaGlsZCgpOwogICAgICBjaGls
        ZHJlbltjb250cm9sSURdID0gc3ViQ29udGFpbmVyOwogICAgfQoKICAgIHZh
        ciBub3JtYWxpemVkUGF0aCA9IHBhdGgucmVwbGFjZSgvXC8vZywgJy4nKTsK
        CiAgICB2YXIgY2hpbGRWaWV3ID0gc3ViQ29udGFpbmVyLmxvb2t1cCgndmll
        dzonICsgbm9ybWFsaXplZFBhdGgpIHx8IHN1YkNvbnRhaW5lci5sb29rdXAo
        J3ZpZXc6ZGVmYXVsdCcpLAogICAgICAgIGNoaWxkQ29udHJvbGxlciA9IHN1
        YkNvbnRhaW5lci5sb29rdXAoJ2NvbnRyb2xsZXI6JyArIG5vcm1hbGl6ZWRQ
        YXRoKSwKICAgICAgICBjaGlsZFRlbXBsYXRlID0gc3ViQ29udGFpbmVyLmxv
        b2t1cCgndGVtcGxhdGU6JyArIHBhdGgpOwoKICAgIEVtYmVyLmFzc2VydCgi
        Q291bGQgbm90IGZpbmQgY29udHJvbGxlciBmb3IgcGF0aDogIiArIG5vcm1h
        bGl6ZWRQYXRoLCBjaGlsZENvbnRyb2xsZXIpOwogICAgRW1iZXIuYXNzZXJ0
        KCJDb3VsZCBub3QgZmluZCB2aWV3IGZvciBwYXRoOiAiICsgbm9ybWFsaXpl
        ZFBhdGgsIGNoaWxkVmlldyk7CgogICAgc2V0KGNoaWxkQ29udHJvbGxlciwg
        J3RhcmdldCcsIGNvbnRyb2xsZXIpOwogICAgc2V0KGNoaWxkQ29udHJvbGxl
        ciwgJ21vZGVsJywgbW9kZWwpOwoKICAgIG9wdGlvbnMuaGFzaC50ZW1wbGF0
        ZSA9IGNoaWxkVGVtcGxhdGU7CiAgICBvcHRpb25zLmhhc2guY29udHJvbGxl
        ciA9IGNoaWxkQ29udHJvbGxlcjsKCiAgICBmdW5jdGlvbiBvYnNlcnZlcigp
        IHsKICAgICAgdmFyIG1vZGVsID0gRW1iZXIuSGFuZGxlYmFycy5nZXQodGhp
        cywgbW9kZWxQYXRoLCBvcHRpb25zKTsKICAgICAgc2V0KGNoaWxkQ29udHJv
        bGxlciwgJ21vZGVsJywgbW9kZWwpOwogICAgICBjaGlsZFZpZXcucmVyZW5k
        ZXIoKTsKICAgIH0KCiAgICBpZiAobW9kZWxQYXRoKSB7CiAgICAgIEVtYmVy
        LmFkZE9ic2VydmVyKHRoaXMsIG1vZGVsUGF0aCwgb2JzZXJ2ZXIpOwogICAg
        ICBjaGlsZFZpZXcub25lKCd3aWxsRGVzdHJveUVsZW1lbnQnLCB0aGlzLCBm
        dW5jdGlvbigpIHsKICAgICAgICBFbWJlci5yZW1vdmVPYnNlcnZlcih0aGlz
        LCBtb2RlbFBhdGgsIG9ic2VydmVyKTsKICAgICAgfSk7CiAgICB9CgogICAg
        RW1iZXIuSGFuZGxlYmFycy5oZWxwZXJzLnZpZXcuY2FsbCh0aGlzLCBjaGls
        ZFZpZXcsIG9wdGlvbnMpOwogIH0pOwp9Cgp9KSgpOwoKCgooZnVuY3Rpb24o
        KSB7Cgp9KSgpOwoKCgooZnVuY3Rpb24oKSB7Ci8qKgpAbW9kdWxlIGVtYmVy
        CkBzdWJtb2R1bGUgZW1iZXItcm91dGluZwoqLwoKdmFyIGdldCA9IEVtYmVy
        LmdldCwgc2V0ID0gRW1iZXIuc2V0OwoKRW1iZXIuQ29udHJvbGxlck1peGlu
        LnJlb3Blbih7CiAgLyoqCiAgICBUcmFuc2l0aW9uIHRoZSBhcHBsaWNhdGlv
        biBpbnRvIGFub3RoZXIgcm91dGUuIFRoZSByb3V0ZSBtYXkKICAgIGJlIGVp
        dGhlciBhIHNpbmdsZSByb3V0ZSBvciByb3V0ZSBwYXRoOgoKICAgIGBgYGph
        dmFzY3JpcHQKICAgICAgYUNvbnRyb2xsZXIudHJhbnNpdGlvblRvUm91dGUo
        J2Jsb2dQb3N0cycpOwogICAgICBhQ29udHJvbGxlci50cmFuc2l0aW9uVG9S
        b3V0ZSgnYmxvZ1Bvc3RzLnJlY2VudEVudHJpZXMnKTsKICAgIGBgYAoKICAg
        IE9wdGlvbmFsbHkgc3VwcGx5IGEgbW9kZWwgZm9yIHRoZSByb3V0ZSBpbiBx
        dWVzdGlvbi4gVGhlIG1vZGVsCiAgICB3aWxsIGJlIHNlcmlhbGl6ZWQgaW50
        byB0aGUgVVJMIHVzaW5nIHRoZSBgc2VyaWFsaXplYCBob29rIG9mCiAgICB0
        aGUgcm91dGU6CgogICAgYGBgamF2YXNjcmlwdAogICAgICBhQ29udHJvbGxl
        ci50cmFuc2l0aW9uVG9Sb3V0ZSgnYmxvZ1Bvc3QnLCBhUG9zdCk7CiAgICBg
        YGAKCiAgICBNdWx0aXBsZSBtb2RlbHMgd2lsbCBiZSBhcHBsaWVkIGxhc3Qg
        dG8gZmlyc3QgcmVjdXJzaXZlbHkgdXAgdGhlCiAgICByZXNvdXJjZSB0cmVl
        LgoKICAgIGBgYGphdmFzY3JpcHQKCiAgICAgIHRoaXMucmVzb3VyY2UoJ2Js
        b2dQb3N0Jywge3BhdGg6JzpibG9nUG9zdElkJ30sIGZ1bmN0aW9uKCl7CiAg
        ICAgICAgdGhpcy5yZXNvdXJjZSgnYmxvZ0NvbW1lbnQnLCB7cGF0aDogJzpi
        bG9nQ29tbWVudElkJ30pOwogICAgICB9KTsKICAgICAgCiAgICAgIGFDb250
        cm9sbGVyLnRyYW5zaXRpb25Ub1JvdXRlKCdibG9nQ29tbWVudCcsIGFQb3N0
        LCBhQ29tbWVudCk7CiAgICBgYGAKCiAgICBTZWUgYWxzbyAncmVwbGFjZVJv
        dXRlJy4KCiAgICBAcGFyYW0ge1N0cmluZ30gbmFtZSB0aGUgbmFtZSBvZiB0
        aGUgcm91dGUKICAgIEBwYXJhbSB7Li4uT2JqZWN0fSBtb2RlbHMgdGhlIG1v
        ZGVsKHMpIHRvIGJlIHVzZWQgd2hpbGUgdHJhbnNpdGlvbmluZwogICAgdG8g
        dGhlIHJvdXRlLgogICAgQGZvciBFbWJlci5Db250cm9sbGVyTWl4aW4KICAg
        IEBtZXRob2QgdHJhbnNpdGlvblRvUm91dGUKICAqLwogIHRyYW5zaXRpb25U
        b1JvdXRlOiBmdW5jdGlvbigpIHsKICAgIC8vIHRhcmdldCBtYXkgYmUgZWl0
        aGVyIGFub3RoZXIgY29udHJvbGxlciBvciBhIHJvdXRlcgogICAgdmFyIHRh
        cmdldCA9IGdldCh0aGlzLCAndGFyZ2V0JyksCiAgICAgICAgbWV0aG9kID0g
        dGFyZ2V0LnRyYW5zaXRpb25Ub1JvdXRlIHx8IHRhcmdldC50cmFuc2l0aW9u
        VG87CiAgICByZXR1cm4gbWV0aG9kLmFwcGx5KHRhcmdldCwgYXJndW1lbnRz
        KTsKICB9LAoKICAvKioKICAgIEBkZXByZWNhdGVkCiAgICBAZm9yIEVtYmVy
        LkNvbnRyb2xsZXJNaXhpbgogICAgQG1ldGhvZCB0cmFuc2l0aW9uVG8KICAq
        LwogIHRyYW5zaXRpb25UbzogZnVuY3Rpb24oKSB7CiAgICBFbWJlci5kZXBy
        ZWNhdGUoInRyYW5zaXRpb25UbyBpcyBkZXByZWNhdGVkLiBQbGVhc2UgdXNl
        IHRyYW5zaXRpb25Ub1JvdXRlLiIpOwogICAgcmV0dXJuIHRoaXMudHJhbnNp
        dGlvblRvUm91dGUuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICB9LAoKICAv
        KioKICAgIFRyYW5zaXRpb24gaW50byBhbm90aGVyIHJvdXRlIHdoaWxlIHJl
        cGxhY2luZyB0aGUgY3VycmVudCBVUkwsIGlmIHBvc3NpYmxlLgogICAgVGhp
        cyB3aWxsIHJlcGxhY2UgdGhlIGN1cnJlbnQgaGlzdG9yeSBlbnRyeSBpbnN0
        ZWFkIG9mIGFkZGluZyBhIG5ldyBvbmUuIAogICAgQmVzaWRlIHRoYXQsIGl0
        IGlzIGlkZW50aWNhbCB0byBgdHJhbnNpdGlvblRvUm91dGVgIGluIGFsbCBv
        dGhlciByZXNwZWN0cy4KCiAgICBgYGBqYXZhc2NyaXB0CiAgICAgIGFDb250
        cm9sbGVyLnJlcGxhY2VSb3V0ZSgnYmxvZ1Bvc3RzJyk7CiAgICAgIGFDb250
        cm9sbGVyLnJlcGxhY2VSb3V0ZSgnYmxvZ1Bvc3RzLnJlY2VudEVudHJpZXMn
        KTsKICAgIGBgYAoKICAgIE9wdGlvbmFsbHkgc3VwcGx5IGEgbW9kZWwgZm9y
        IHRoZSByb3V0ZSBpbiBxdWVzdGlvbi4gVGhlIG1vZGVsCiAgICB3aWxsIGJl
        IHNlcmlhbGl6ZWQgaW50byB0aGUgVVJMIHVzaW5nIHRoZSBgc2VyaWFsaXpl
        YCBob29rIG9mCiAgICB0aGUgcm91dGU6CgogICAgYGBgamF2YXNjcmlwdAog
        ICAgICBhQ29udHJvbGxlci5yZXBsYWNlUm91dGUoJ2Jsb2dQb3N0JywgYVBv
        c3QpOwogICAgYGBgCgogICAgTXVsdGlwbGUgbW9kZWxzIHdpbGwgYmUgYXBw
        bGllZCBsYXN0IHRvIGZpcnN0IHJlY3Vyc2l2ZWx5IHVwIHRoZQogICAgcmVz
        b3VyY2UgdHJlZS4KCiAgICBgYGBqYXZhc2NyaXB0CgogICAgICB0aGlzLnJl
        c291cmNlKCdibG9nUG9zdCcsIHtwYXRoOic6YmxvZ1Bvc3RJZCd9LCBmdW5j
        dGlvbigpewogICAgICAgIHRoaXMucmVzb3VyY2UoJ2Jsb2dDb21tZW50Jywg
        e3BhdGg6ICc6YmxvZ0NvbW1lbnRJZCd9KTsKICAgICAgfSk7CiAgICAgIAog
        ICAgICBhQ29udHJvbGxlci5yZXBsYWNlUm91dGUoJ2Jsb2dDb21tZW50Jywg
        YVBvc3QsIGFDb21tZW50KTsKICAgIGBgYAoKICAgIEBwYXJhbSB7U3RyaW5n
        fSBuYW1lIHRoZSBuYW1lIG9mIHRoZSByb3V0ZQogICAgQHBhcmFtIHsuLi5P
        YmplY3R9IG1vZGVscyB0aGUgbW9kZWwocykgdG8gYmUgdXNlZCB3aGlsZSB0
        cmFuc2l0aW9uaW5nCiAgICB0byB0aGUgcm91dGUuCiAgICBAZm9yIEVtYmVy
        LkNvbnRyb2xsZXJNaXhpbgogICAgQG1ldGhvZCByZXBsYWNlUm91dGUKICAq
        LwogIHJlcGxhY2VSb3V0ZTogZnVuY3Rpb24oKSB7CiAgICAvLyB0YXJnZXQg
        bWF5IGJlIGVpdGhlciBhbm90aGVyIGNvbnRyb2xsZXIgb3IgYSByb3V0ZXIK
        ICAgIHZhciB0YXJnZXQgPSBnZXQodGhpcywgJ3RhcmdldCcpLAogICAgICAg
        IG1ldGhvZCA9IHRhcmdldC5yZXBsYWNlUm91dGUgfHwgdGFyZ2V0LnJlcGxh
        Y2VXaXRoOwogICAgcmV0dXJuIG1ldGhvZC5hcHBseSh0YXJnZXQsIGFyZ3Vt
        ZW50cyk7CiAgfSwKCiAgLyoqCiAgICBAZGVwcmVjYXRlZAogICAgQGZvciBF
        bWJlci5Db250cm9sbGVyTWl4aW4KICAgIEBtZXRob2QgcmVwbGFjZVdpdGgK
        ICAqLwogIHJlcGxhY2VXaXRoOiBmdW5jdGlvbigpIHsKICAgIEVtYmVyLmRl
        cHJlY2F0ZSgicmVwbGFjZVdpdGggaXMgZGVwcmVjYXRlZC4gUGxlYXNlIHVz
        ZSByZXBsYWNlUm91dGUuIik7CiAgICByZXR1cm4gdGhpcy5yZXBsYWNlUm91
        dGUuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICB9Cn0pOwoKfSkoKTsKCgoK
        KGZ1bmN0aW9uKCkgewovKioKQG1vZHVsZSBlbWJlcgpAc3VibW9kdWxlIGVt
        YmVyLXJvdXRpbmcKKi8KCnZhciBnZXQgPSBFbWJlci5nZXQsIHNldCA9IEVt
        YmVyLnNldDsKCkVtYmVyLlZpZXcucmVvcGVuKHsKCiAgLyoqCiAgICBTZXRz
        IHRoZSBwcml2YXRlIGBfb3V0bGV0c2Agb2JqZWN0IG9uIHRoZSB2aWV3LgoK
        ICAgIEBtZXRob2QgaW5pdAogICAqLwogIGluaXQ6IGZ1bmN0aW9uKCkgewog
        ICAgc2V0KHRoaXMsICdfb3V0bGV0cycsIHt9KTsKICAgIHRoaXMuX3N1cGVy
        KCk7CiAgfSwKCiAgLyoqCiAgICBNYW51YWxseSBmaWxsIGFueSBvZiBhIHZp
        ZXcncyBge3tvdXRsZXR9fWAgYXJlYXMgd2l0aCB0aGUKICAgIHN1cHBsaWVk
        IHZpZXcuCgogICAgRXhhbXBsZQoKICAgIGBgYGphdmFzY3JpcHQKICAgIHZh
        ciBNeVZpZXcgPSBFbWJlci5WaWV3LmV4dGVuZCh7CiAgICAgIHRlbXBsYXRl
        OiBFbWJlci5IYW5kbGViYXJzLmNvbXBpbGUoJ0NoaWxkIHZpZXc6IHt7b3V0
        bGV0ICJtYWluIn19ICcpCiAgICB9KTsKICAgIHZhciBteVZpZXcgPSBNeVZp
        ZXcuY3JlYXRlKCk7CiAgICBteVZpZXcuYXBwZW5kVG8oJ2JvZHknKTsKICAg
        IC8vIFRoZSBodG1sIGZvciBteVZpZXcgbm93IGxvb2tzIGxpa2U6CiAgICAv
        LyA8ZGl2IGlkPSJlbWJlcjIyOCIgY2xhc3M9ImVtYmVyLXZpZXciPkNoaWxk
        IHZpZXc6IDwvZGl2PgoKICAgIG15Vmlldy5jb25uZWN0T3V0bGV0KCdtYWlu
        JywgRW1iZXIuVmlldy5leHRlbmQoewogICAgICB0ZW1wbGF0ZTogRW1iZXIu
        SGFuZGxlYmFycy5jb21waWxlKCc8aDE+Rm9vPC9oMT4gJykKICAgIH0pKTsK
        ICAgIC8vIFRoZSBodG1sIGZvciBteVZpZXcgbm93IGxvb2tzIGxpa2U6CiAg
        ICAvLyA8ZGl2IGlkPSJlbWJlcjIyOCIgY2xhc3M9ImVtYmVyLXZpZXciPkNo
        aWxkIHZpZXc6CiAgICAvLyAgIDxkaXYgaWQ9ImVtYmVyMjM0IiBjbGFzcz0i
        ZW1iZXItdmlldyI+PGgxPkZvbzwvaDE+IDwvZGl2PgogICAgLy8gPC9kaXY+
        CiAgICBgYGAKICAgIEBtZXRob2QgY29ubmVjdE91dGxldAogICAgQHBhcmFt
        ICB7U3RyaW5nfSBvdXRsZXROYW1lIEEgdW5pcXVlIG5hbWUgZm9yIHRoZSBv
        dXRsZXQKICAgIEBwYXJhbSAge09iamVjdH0gdmlldyAgICAgICBBbiBFbWJl
        ci5WaWV3CiAgICovCiAgY29ubmVjdE91dGxldDogZnVuY3Rpb24ob3V0bGV0
        TmFtZSwgdmlldykgewogICAgaWYgKHRoaXMuX3BlbmRpbmdEaXNjb25uZWN0
        aW9ucykgewogICAgICBkZWxldGUgdGhpcy5fcGVuZGluZ0Rpc2Nvbm5lY3Rp
        b25zW291dGxldE5hbWVdOwogICAgfQoKICAgIGlmICh0aGlzLl9oYXNFcXVp
        dmFsZW50VmlldyhvdXRsZXROYW1lLCB2aWV3KSkgewogICAgICB2aWV3LmRl
        c3Ryb3koKTsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIHZhciBvdXRsZXRz
        ID0gZ2V0KHRoaXMsICdfb3V0bGV0cycpLAogICAgICAgIGNvbnRhaW5lciA9
        IGdldCh0aGlzLCAnY29udGFpbmVyJyksCiAgICAgICAgcm91dGVyID0gY29u
        dGFpbmVyICYmIGNvbnRhaW5lci5sb29rdXAoJ3JvdXRlcjptYWluJyksCiAg
        ICAgICAgcmVuZGVyZWROYW1lID0gZ2V0KHZpZXcsICdyZW5kZXJlZE5hbWUn
        KTsKCiAgICBzZXQob3V0bGV0cywgb3V0bGV0TmFtZSwgdmlldyk7CgogICAg
        aWYgKHJvdXRlciAmJiByZW5kZXJlZE5hbWUpIHsKICAgICAgcm91dGVyLl9j
        b25uZWN0QWN0aXZlVmlldyhyZW5kZXJlZE5hbWUsIHZpZXcpOwogICAgfQog
        IH0sCgogIC8qKgogICAgQHByaXZhdGUKCiAgICBEZXRlcm1pbmVzIGlmIHRo
        ZSB2aWV3IGhhcyBhbHJlYWR5IGJlZW4gY3JlYXRlZCBieSBjaGVja2luZyBp
        ZgogICAgdGhlIHZpZXcgaGFzIHRoZSBzYW1lIGNvbnN0cnVjdG9yLCB0ZW1w
        bGF0ZSwgYW5kIGNvbnRleHQgYXMgdGhlCiAgICB2aWV3IGluIHRoZSBgX291
        dGxldHNgIG9iamVjdC4KCiAgICBAbWV0aG9kIF9oYXNFcXVpdmFsZW50Vmll
        dwogICAgQHBhcmFtICB7U3RyaW5nfSBvdXRsZXROYW1lIFRoZSBuYW1lIG9m
        IHRoZSBvdXRsZXQgd2UgYXJlIGNoZWNraW5nCiAgICBAcGFyYW0gIHtPYmpl
        Y3R9IHZpZXcgICAgICAgQW4gRW1iZXIuVmlldwogICAgQHJldHVybiB7Qm9v
        bGVhbn0KICAgKi8KICBfaGFzRXF1aXZhbGVudFZpZXc6IGZ1bmN0aW9uKG91
        dGxldE5hbWUsIHZpZXcpIHsKICAgIHZhciBleGlzdGluZ1ZpZXcgPSBnZXQo
        dGhpcywgJ19vdXRsZXRzLicrb3V0bGV0TmFtZSk7CiAgICByZXR1cm4gZXhp
        c3RpbmdWaWV3ICYmCiAgICAgIGV4aXN0aW5nVmlldy5jb25zdHJ1Y3RvciA9
        PT0gdmlldy5jb25zdHJ1Y3RvciAmJgogICAgICBleGlzdGluZ1ZpZXcuZ2V0
        KCd0ZW1wbGF0ZScpID09PSB2aWV3LmdldCgndGVtcGxhdGUnKSAmJgogICAg
        ICBleGlzdGluZ1ZpZXcuZ2V0KCdjb250ZXh0JykgPT09IHZpZXcuZ2V0KCdj
        b250ZXh0Jyk7CiAgfSwKCiAgLyoqCiAgICBSZW1vdmVzIGFuIG91dGxldCBm
        cm9tIHRoZSB2aWV3LgoKICAgIEV4YW1wbGUKCiAgICBgYGBqYXZhc2NyaXB0
        CiAgICB2YXIgTXlWaWV3ID0gRW1iZXIuVmlldy5leHRlbmQoewogICAgICB0
        ZW1wbGF0ZTogRW1iZXIuSGFuZGxlYmFycy5jb21waWxlKCdDaGlsZCB2aWV3
        OiB7e291dGxldCAibWFpbiJ9fSAnKQogICAgfSk7CiAgICB2YXIgbXlWaWV3
        ID0gTXlWaWV3LmNyZWF0ZSgpOwogICAgbXlWaWV3LmFwcGVuZFRvKCdib2R5
        Jyk7CiAgICAvLyBteVZpZXcncyBodG1sOgogICAgLy8gPGRpdiBpZD0iZW1i
        ZXIyMjgiIGNsYXNzPSJlbWJlci12aWV3Ij5DaGlsZCB2aWV3OiA8L2Rpdj4K
        CiAgICBteVZpZXcuY29ubmVjdE91dGxldCgnbWFpbicsIEVtYmVyLlZpZXcu
        ZXh0ZW5kKHsKICAgICAgdGVtcGxhdGU6IEVtYmVyLkhhbmRsZWJhcnMuY29t
        cGlsZSgnPGgxPkZvbzwvaDE+ICcpCiAgICB9KSk7CiAgICAvLyBteVZpZXcn
        cyBodG1sOgogICAgLy8gPGRpdiBpZD0iZW1iZXIyMjgiIGNsYXNzPSJlbWJl
        ci12aWV3Ij5DaGlsZCB2aWV3OgogICAgLy8gICA8ZGl2IGlkPSJlbWJlcjIz
        NCIgY2xhc3M9ImVtYmVyLXZpZXciPjxoMT5Gb288L2gxPiA8L2Rpdj4KICAg
        IC8vIDwvZGl2PgoKICAgIG15Vmlldy5kaXNjb25uZWN0T3V0bGV0KCdtYWlu
        Jyk7CiAgICAvLyBteVZpZXcncyBodG1sOgogICAgLy8gPGRpdiBpZD0iZW1i
        ZXIyMjgiIGNsYXNzPSJlbWJlci12aWV3Ij5DaGlsZCB2aWV3OiA8L2Rpdj4K
        ICAgIGBgYAoKICAgIEBtZXRob2QgZGlzY29ubmVjdE91dGxldAogICAgQHBh
        cmFtICB7U3RyaW5nfSBvdXRsZXROYW1lIFRoZSBuYW1lIG9mIHRoZSBvdXRs
        ZXQgdG8gYmUgcmVtb3ZlZAogICAqLwogIGRpc2Nvbm5lY3RPdXRsZXQ6IGZ1
        bmN0aW9uKG91dGxldE5hbWUpIHsKICAgIGlmICghdGhpcy5fcGVuZGluZ0Rp
        c2Nvbm5lY3Rpb25zKSB7CiAgICAgIHRoaXMuX3BlbmRpbmdEaXNjb25uZWN0
        aW9ucyA9IHt9OwogICAgfQogICAgdGhpcy5fcGVuZGluZ0Rpc2Nvbm5lY3Rp
        b25zW291dGxldE5hbWVdID0gdHJ1ZTsKICAgIEVtYmVyLnJ1bi5vbmNlKHRo
        aXMsICdfZmluaXNoRGlzY29ubmVjdGlvbnMnKTsKICB9LAoKICAvKioKICAg
        IEBwcml2YXRlCgogICAgR2V0cyBhbiBvdXRsZXQgdGhhdCBpcyBwZW5kaW5n
        IGRpc2Nvbm5lY3Rpb24gYW5kIHRoZW4KICAgIG51bGxpZnlzIHRoZSBvYmpl
        Y3Qgb24gdGhlIGBfb3V0bGV0YCBvYmplY3QuCgogICAgQG1ldGhvZCBfZmlu
        aXNoRGlzY29ubmVjdGlvbnMKICAgKi8KICBfZmluaXNoRGlzY29ubmVjdGlv
        bnM6IGZ1bmN0aW9uKCkgewogICAgdmFyIG91dGxldHMgPSBnZXQodGhpcywg
        J19vdXRsZXRzJyk7CiAgICB2YXIgcGVuZGluZ0Rpc2Nvbm5lY3Rpb25zID0g
        dGhpcy5fcGVuZGluZ0Rpc2Nvbm5lY3Rpb25zOwogICAgdGhpcy5fcGVuZGlu
        Z0Rpc2Nvbm5lY3Rpb25zID0gbnVsbDsKCiAgICBmb3IgKHZhciBvdXRsZXRO
        YW1lIGluIHBlbmRpbmdEaXNjb25uZWN0aW9ucykgewogICAgICBzZXQob3V0
        bGV0cywgb3V0bGV0TmFtZSwgbnVsbCk7CiAgICB9CiAgfQp9KTsKCn0pKCk7
        CgoKCihmdW5jdGlvbigpIHsKLyoqCkBtb2R1bGUgZW1iZXIKQHN1Ym1vZHVs
        ZSBlbWJlci12aWV3cwoqLwoKLy8gQWRkIGEgbmV3IG5hbWVkIHF1ZXVlIGFm
        dGVyIHRoZSAnYWN0aW9ucycgcXVldWUgKHdoZXJlIFJTVlAgcHJvbWlzZXMK
        Ly8gcmVzb2x2ZSksIHdoaWNoIGlzIHVzZWQgaW4gcm91dGVyIHRyYW5zaXRp
        b25zIHRvIHByZXZlbnQgdW5uZWNlc3NhcnkKLy8gbG9hZGluZyBzdGF0ZSBl
        bnRyeSBpZiBhbGwgY29udGV4dCBwcm9taXNlcyByZXNvbHZlIG9uIHRoZSAK
        Ly8gJ2FjdGlvbnMnIHF1ZXVlIGZpcnN0LgoKdmFyIHF1ZXVlcyA9IEVtYmVy
        LnJ1bi5xdWV1ZXMsCiAgICBpbmRleE9mID0gRW1iZXIuQXJyYXlQb2x5Zmls
        bHMuaW5kZXhPZjsKcXVldWVzLnNwbGljZShpbmRleE9mLmNhbGwocXVldWVz
        LCAnYWN0aW9ucycpICsgMSwgMCwgJ3JvdXRlclRyYW5zaXRpb25zJyk7Cgp9
        KSgpOwoKCgooZnVuY3Rpb24oKSB7Ci8qKgpAbW9kdWxlIGVtYmVyCkBzdWJt
        b2R1bGUgZW1iZXItcm91dGluZwoqLwoKdmFyIGdldCA9IEVtYmVyLmdldCwg
        c2V0ID0gRW1iZXIuc2V0OwoKLyoKICBUaGlzIGZpbGUgaW1wbGVtZW50cyB0
        aGUgYGxvY2F0aW9uYCBBUEkgdXNlZCBieSBFbWJlcidzIHJvdXRlci4KCiAg
        VGhhdCBBUEkgaXM6CgogIGdldFVSTDogcmV0dXJucyB0aGUgY3VycmVudCBV
        UkwKICBzZXRVUkwocGF0aCk6IHNldHMgdGhlIGN1cnJlbnQgVVJMCiAgcmVw
        bGFjZVVSTChwYXRoKTogcmVwbGFjZSB0aGUgY3VycmVudCBVUkwgKG9wdGlv
        bmFsKQogIG9uVXBkYXRlVVJMKGNhbGxiYWNrKTogdHJpZ2dlcnMgdGhlIGNh
        bGxiYWNrIHdoZW4gdGhlIFVSTCBjaGFuZ2VzCiAgZm9ybWF0VVJMKHVybCk6
        IGZvcm1hdHMgYHVybGAgdG8gYmUgcGxhY2VkIGludG8gYGhyZWZgIGF0dHJp
        YnV0ZQoKICBDYWxsaW5nIHNldFVSTCBvciByZXBsYWNlVVJMIHdpbGwgbm90
        IHRyaWdnZXIgb25VcGRhdGVVUkwgY2FsbGJhY2tzLgoKICBUT0RPOiBUaGlz
        IHNob3VsZCBwZXJoYXBzIGJlIG1vdmVkIHNvIHRoYXQgaXQncyB2aXNpYmxl
        IGluIHRoZSBkb2Mgb3V0cHV0LgoqLwoKLyoqCiAgRW1iZXIuTG9jYXRpb24g
        cmV0dXJucyBhbiBpbnN0YW5jZSBvZiB0aGUgY29ycmVjdCBpbXBsZW1lbnRh
        dGlvbiBvZgogIHRoZSBgbG9jYXRpb25gIEFQSS4KCiAgWW91IGNhbiBwYXNz
        IGl0IGEgYGltcGxlbWVudGF0aW9uYCAoJ2hhc2gnLCAnaGlzdG9yeScsICdu
        b25lJykgdG8gZm9yY2UgYQogIHBhcnRpY3VsYXIgaW1wbGVtZW50YXRpb24u
        CgogIEBjbGFzcyBMb2NhdGlvbgogIEBuYW1lc3BhY2UgRW1iZXIKICBAc3Rh
        dGljCiovCkVtYmVyLkxvY2F0aW9uID0gewogIC8qKgogICBDcmVhdGUgYW4g
        aW5zdGFuY2Ugb2YgYSBhbiBpbXBsZW1lbnRhdGlvbiBvZiB0aGUgYGxvY2F0
        aW9uYCBBUEkuIFJlcXVpcmVzCiAgIGFuIG9wdGlvbnMgb2JqZWN0IHdpdGgg
        YW4gYGltcGxlbWVudGF0aW9uYCBwcm9wZXJ0eS4KCiAgIEV4YW1wbGUKCiAg
        IGBgYGphdmFzY3JpcHQKICAgdmFyIGhhc2hMb2NhdGlvbiA9IEVtYmVyLkxv
        Y2F0aW9uLmNyZWF0ZSh7aW1wbGVtZW50YXRpb246ICdoYXNoJ30pOwogICB2
        YXIgaGlzdG9yeUxvY2F0aW9uID0gRW1iZXIuTG9jYXRpb24uY3JlYXRlKHtp
        bXBsZW1lbnRhdGlvbjogJ2hpc3RvcnknfSk7CiAgIHZhciBub25lTG9jYXRp
        b24gPSBFbWJlci5Mb2NhdGlvbi5jcmVhdGUoe2ltcGxlbWVudGF0aW9uOiAn
        bm9uZSd9KTsKICAgYGBgCgogICAgQG1ldGhvZCBjcmVhdGUKICAgIEBwYXJh
        bSB7T2JqZWN0fSBvcHRpb25zCiAgICBAcmV0dXJuIHtPYmplY3R9IGFuIGlu
        c3RhbmNlIG9mIGFuIGltcGxlbWVudGF0aW9uIG9mIHRoZSBgbG9jYXRpb25g
        IEFQSQogICovCiAgY3JlYXRlOiBmdW5jdGlvbihvcHRpb25zKSB7CiAgICB2
        YXIgaW1wbGVtZW50YXRpb24gPSBvcHRpb25zICYmIG9wdGlvbnMuaW1wbGVt
        ZW50YXRpb247CiAgICBFbWJlci5hc3NlcnQoIkVtYmVyLkxvY2F0aW9uLmNy
        ZWF0ZTogeW91IG11c3Qgc3BlY2lmeSBhICdpbXBsZW1lbnRhdGlvbicgb3B0
        aW9uIiwgISFpbXBsZW1lbnRhdGlvbik7CgogICAgdmFyIGltcGxlbWVudGF0
        aW9uQ2xhc3MgPSB0aGlzLmltcGxlbWVudGF0aW9uc1tpbXBsZW1lbnRhdGlv
        bl07CiAgICBFbWJlci5hc3NlcnQoIkVtYmVyLkxvY2F0aW9uLmNyZWF0ZTog
        IiArIGltcGxlbWVudGF0aW9uICsgIiBpcyBub3QgYSB2YWxpZCBpbXBsZW1l
        bnRhdGlvbiIsICEhaW1wbGVtZW50YXRpb25DbGFzcyk7CgogICAgcmV0dXJu
        IGltcGxlbWVudGF0aW9uQ2xhc3MuY3JlYXRlLmFwcGx5KGltcGxlbWVudGF0
        aW9uQ2xhc3MsIGFyZ3VtZW50cyk7CiAgfSwKCiAgLyoqCiAgIFJlZ2lzdGVy
        cyBhIGNsYXNzIHRoYXQgaW1wbGVtZW50cyB0aGUgYGxvY2F0aW9uYCBBUEkg
        d2l0aCBhbiBpbXBsZW1lbnRhdGlvbgogICBuYW1lLiBUaGlzIGltcGxlbWVu
        dGF0aW9uIG5hbWUgY2FuIHRoZW4gYmUgc3BlY2lmaWVkIGJ5IHRoZSBsb2Nh
        dGlvbiBwcm9wZXJ0eSBvbgogICB0aGUgYXBwbGljYXRpb24ncyByb3V0ZXIg
        Y2xhc3MuCgogICBFeGFtcGxlCgogICBgYGBqYXZhc2NyaXB0CiAgIEVtYmVy
        LkxvY2F0aW9uLnJlZ2lzdGVySW1wbGVtZW50YXRpb24oJ2hpc3RvcnknLCBF
        bWJlci5IaXN0b3J5TG9jYXRpb24pOwoKICAgQXBwLlJvdXRlci5yZW9wZW4o
        ewogICAgIGxvY2F0aW9uOiAnaGlzdG9yeScKICAgfSk7CiAgIGBgYAoKICAg
        IEBtZXRob2QgcmVnaXN0ZXJJbXBsZW1lbnRhdGlvbgogICAgQHBhcmFtIHtT
        dHJpbmd9IG5hbWUKICAgIEBwYXJhbSB7T2JqZWN0fSBpbXBsZW1lbnRhdGlv
        biBvZiB0aGUgYGxvY2F0aW9uYCBBUEkKICAqLwogIHJlZ2lzdGVySW1wbGVt
        ZW50YXRpb246IGZ1bmN0aW9uKG5hbWUsIGltcGxlbWVudGF0aW9uKSB7CiAg
        ICB0aGlzLmltcGxlbWVudGF0aW9uc1tuYW1lXSA9IGltcGxlbWVudGF0aW9u
        OwogIH0sCgogIGltcGxlbWVudGF0aW9uczoge30KfTsKCn0pKCk7CgoKCihm
        dW5jdGlvbigpIHsKLyoqCkBtb2R1bGUgZW1iZXIKQHN1Ym1vZHVsZSBlbWJl
        ci1yb3V0aW5nCiovCgp2YXIgZ2V0ID0gRW1iZXIuZ2V0LCBzZXQgPSBFbWJl
        ci5zZXQ7CgovKioKICBFbWJlci5Ob25lTG9jYXRpb24gZG9lcyBub3QgaW50
        ZXJhY3Qgd2l0aCB0aGUgYnJvd3Nlci4gSXQgaXMgdXNlZnVsIGZvcgogIHRl
        c3RpbmcsIG9yIHdoZW4geW91IG5lZWQgdG8gbWFuYWdlIHN0YXRlIHdpdGgg
        eW91ciBSb3V0ZXIsIGJ1dCB0ZW1wb3JhcmlseQogIGRvbid0IHdhbnQgaXQg
        dG8gbXVjayB3aXRoIHRoZSBVUkwgKGZvciBleGFtcGxlIHdoZW4geW91IGVt
        YmVkIHlvdXIKICBhcHBsaWNhdGlvbiBpbiBhIGxhcmdlciBwYWdlKS4KCiAg
        QGNsYXNzIE5vbmVMb2NhdGlvbgogIEBuYW1lc3BhY2UgRW1iZXIKICBAZXh0
        ZW5kcyBFbWJlci5PYmplY3QKKi8KRW1iZXIuTm9uZUxvY2F0aW9uID0gRW1i
        ZXIuT2JqZWN0LmV4dGVuZCh7CiAgcGF0aDogJycsCgogIC8qKgogICAgQHBy
        aXZhdGUKCiAgICBSZXR1cm5zIHRoZSBjdXJyZW50IHBhdGguCgogICAgQG1l
        dGhvZCBnZXRVUkwKICAgIEByZXR1cm4ge1N0cmluZ30gcGF0aAogICovCiAg
        Z2V0VVJMOiBmdW5jdGlvbigpIHsKICAgIHJldHVybiBnZXQodGhpcywgJ3Bh
        dGgnKTsKICB9LAoKICAvKioKICAgIEBwcml2YXRlCgogICAgU2V0IHRoZSBw
        YXRoIGFuZCByZW1lbWJlcnMgd2hhdCB3YXMgc2V0LiBVc2luZyB0aGlzIG1l
        dGhvZAogICAgdG8gY2hhbmdlIHRoZSBwYXRoIHdpbGwgbm90IGludm9rZSB0
        aGUgYHVwZGF0ZVVSTGAgY2FsbGJhY2suCgogICAgQG1ldGhvZCBzZXRVUkwK
        ICAgIEBwYXJhbSBwYXRoIHtTdHJpbmd9CiAgKi8KICBzZXRVUkw6IGZ1bmN0
        aW9uKHBhdGgpIHsKICAgIHNldCh0aGlzLCAncGF0aCcsIHBhdGgpOwogIH0s
        CgogIC8qKgogICAgQHByaXZhdGUKCiAgICBSZWdpc3RlciBhIGNhbGxiYWNr
        IHRvIGJlIGludm9rZWQgd2hlbiB0aGUgcGF0aCBjaGFuZ2VzLiBUaGVzZQog
        ICAgY2FsbGJhY2tzIHdpbGwgZXhlY3V0ZSB3aGVuIHRoZSB1c2VyIHByZXNz
        ZXMgdGhlIGJhY2sgb3IgZm9yd2FyZAogICAgYnV0dG9uLCBidXQgbm90IGFm
        dGVyIGBzZXRVUkxgIGlzIGludm9rZWQuCgogICAgQG1ldGhvZCBvblVwZGF0
        ZVVSTAogICAgQHBhcmFtIGNhbGxiYWNrIHtGdW5jdGlvbn0KICAqLwogIG9u
        VXBkYXRlVVJMOiBmdW5jdGlvbihjYWxsYmFjaykgewogICAgdGhpcy51cGRh
        dGVDYWxsYmFjayA9IGNhbGxiYWNrOwogIH0sCgogIC8qKgogICAgQHByaXZh
        dGUKCiAgICBTZXRzIHRoZSBwYXRoIGFuZCBjYWxscyB0aGUgYHVwZGF0ZVVS
        TGAgY2FsbGJhY2suCgogICAgQG1ldGhvZCBoYW5kbGVVUkwKICAgIEBwYXJh
        bSBjYWxsYmFjayB7RnVuY3Rpb259CiAgKi8KICBoYW5kbGVVUkw6IGZ1bmN0
        aW9uKHVybCkgewogICAgc2V0KHRoaXMsICdwYXRoJywgdXJsKTsKICAgIHRo
        aXMudXBkYXRlQ2FsbGJhY2sodXJsKTsKICB9LAoKICAvKioKICAgIEBwcml2
        YXRlCgogICAgR2l2ZW4gYSBVUkwsIGZvcm1hdHMgaXQgdG8gYmUgcGxhY2Vk
        IGludG8gdGhlIHBhZ2UgYXMgcGFydAogICAgb2YgYW4gZWxlbWVudCdzIGBo
        cmVmYCBhdHRyaWJ1dGUuCgogICAgVGhpcyBpcyB1c2VkLCBmb3IgZXhhbXBs
        ZSwgd2hlbiB1c2luZyB0aGUge3thY3Rpb259fSBoZWxwZXIKICAgIHRvIGdl
        bmVyYXRlIGEgVVJMIGJhc2VkIG9uIGFuIGV2ZW50LgoKICAgIEBtZXRob2Qg
        Zm9ybWF0VVJMCiAgICBAcGFyYW0gdXJsIHtTdHJpbmd9CiAgICBAcmV0dXJu
        IHtTdHJpbmd9IHVybAogICovCiAgZm9ybWF0VVJMOiBmdW5jdGlvbih1cmwp
        IHsKICAgIC8vIFRoZSByZXR1cm4gdmFsdWUgaXMgbm90IG92ZXJseSBtZWFu
        aW5nZnVsLCBidXQgd2UgZG8gbm90IHdhbnQgdG8gdGhyb3cKICAgIC8vIGVy
        cm9ycyB3aGVuIHRlc3QgY29kZSByZW5kZXJzIHRlbXBsYXRlcyBjb250YWlu
        aW5nIHt7YWN0aW9uIGhyZWY9dHJ1ZX19CiAgICAvLyBoZWxwZXJzLgogICAg
        cmV0dXJuIHVybDsKICB9Cn0pOwoKRW1iZXIuTG9jYXRpb24ucmVnaXN0ZXJJ
        bXBsZW1lbnRhdGlvbignbm9uZScsIEVtYmVyLk5vbmVMb2NhdGlvbik7Cgp9
        KSgpOwoKCgooZnVuY3Rpb24oKSB7Ci8qKgpAbW9kdWxlIGVtYmVyCkBzdWJt
        b2R1bGUgZW1iZXItcm91dGluZwoqLwoKdmFyIGdldCA9IEVtYmVyLmdldCwg
        c2V0ID0gRW1iZXIuc2V0OwoKLyoqCiAgRW1iZXIuSGFzaExvY2F0aW9uIGlt
        cGxlbWVudHMgdGhlIGxvY2F0aW9uIEFQSSB1c2luZyB0aGUgYnJvd3Nlcidz
        CiAgaGFzaC4gQXQgcHJlc2VudCwgaXQgcmVsaWVzIG9uIGEgaGFzaGNoYW5n
        ZSBldmVudCBleGlzdGluZyBpbiB0aGUKICBicm93c2VyLgoKICBAY2xhc3Mg
        SGFzaExvY2F0aW9uCiAgQG5hbWVzcGFjZSBFbWJlcgogIEBleHRlbmRzIEVt
        YmVyLk9iamVjdAoqLwpFbWJlci5IYXNoTG9jYXRpb24gPSBFbWJlci5PYmpl
        Y3QuZXh0ZW5kKHsKCiAgaW5pdDogZnVuY3Rpb24oKSB7CiAgICBzZXQodGhp
        cywgJ2xvY2F0aW9uJywgZ2V0KHRoaXMsICdsb2NhdGlvbicpIHx8IHdpbmRv
        dy5sb2NhdGlvbik7CiAgfSwKCiAgLyoqCiAgICBAcHJpdmF0ZQoKICAgIFJl
        dHVybnMgdGhlIGN1cnJlbnQgYGxvY2F0aW9uLmhhc2hgLCBtaW51cyB0aGUg
        JyMnIGF0IHRoZSBmcm9udC4KCiAgICBAbWV0aG9kIGdldFVSTAogICovCiAg
        Z2V0VVJMOiBmdW5jdGlvbigpIHsKICAgIHJldHVybiBnZXQodGhpcywgJ2xv
        Y2F0aW9uJykuaGFzaC5zdWJzdHIoMSk7CiAgfSwKCiAgLyoqCiAgICBAcHJp
        dmF0ZQoKICAgIFNldCB0aGUgYGxvY2F0aW9uLmhhc2hgIGFuZCByZW1lbWJl
        cnMgd2hhdCB3YXMgc2V0LiBUaGlzIHByZXZlbnRzCiAgICBgb25VcGRhdGVV
        UkxgIGNhbGxiYWNrcyBmcm9tIHRyaWdnZXJpbmcgd2hlbiB0aGUgaGFzaCB3
        YXMgc2V0IGJ5CiAgICBgSGFzaExvY2F0aW9uYC4KCiAgICBAbWV0aG9kIHNl
        dFVSTAogICAgQHBhcmFtIHBhdGgge1N0cmluZ30KICAqLwogIHNldFVSTDog
        ZnVuY3Rpb24ocGF0aCkgewogICAgZ2V0KHRoaXMsICdsb2NhdGlvbicpLmhh
        c2ggPSBwYXRoOwogICAgc2V0KHRoaXMsICdsYXN0U2V0VVJMJywgcGF0aCk7
        CiAgfSwKCiAgLyoqCiAgICBAcHJpdmF0ZQoKICAgIFVzZXMgbG9jYXRpb24u
        cmVwbGFjZSB0byB1cGRhdGUgdGhlIHVybCB3aXRob3V0IGEgcGFnZSByZWxv
        YWQKICAgIG9yIGhpc3RvcnkgbW9kaWZpY2F0aW9uLgoKICAgIEBtZXRob2Qg
        cmVwbGFjZVVSTAogICAgQHBhcmFtIHBhdGgge1N0cmluZ30KICAqLwogIHJl
        cGxhY2VVUkw6IGZ1bmN0aW9uKHBhdGgpIHsKICAgIGdldCh0aGlzLCAnbG9j
        YXRpb24nKS5yZXBsYWNlKCcjJyArIHBhdGgpOwogIH0sCgogIC8qKgogICAg
        QHByaXZhdGUKCiAgICBSZWdpc3RlciBhIGNhbGxiYWNrIHRvIGJlIGludm9r
        ZWQgd2hlbiB0aGUgaGFzaCBjaGFuZ2VzLiBUaGVzZQogICAgY2FsbGJhY2tz
        IHdpbGwgZXhlY3V0ZSB3aGVuIHRoZSB1c2VyIHByZXNzZXMgdGhlIGJhY2sg
        b3IgZm9yd2FyZAogICAgYnV0dG9uLCBidXQgbm90IGFmdGVyIGBzZXRVUkxg
        IGlzIGludm9rZWQuCgogICAgQG1ldGhvZCBvblVwZGF0ZVVSTAogICAgQHBh
        cmFtIGNhbGxiYWNrIHtGdW5jdGlvbn0KICAqLwogIG9uVXBkYXRlVVJMOiBm
        dW5jdGlvbihjYWxsYmFjaykgewogICAgdmFyIHNlbGYgPSB0aGlzOwogICAg
        dmFyIGd1aWQgPSBFbWJlci5ndWlkRm9yKHRoaXMpOwoKICAgIEVtYmVyLiQo
        d2luZG93KS5vbignaGFzaGNoYW5nZS5lbWJlci1sb2NhdGlvbi0nK2d1aWQs
        IGZ1bmN0aW9uKCkgewogICAgICBFbWJlci5ydW4oZnVuY3Rpb24oKSB7CiAg
        ICAgICAgdmFyIHBhdGggPSBsb2NhdGlvbi5oYXNoLnN1YnN0cigxKTsKICAg
        ICAgICBpZiAoZ2V0KHNlbGYsICdsYXN0U2V0VVJMJykgPT09IHBhdGgpIHsg
        cmV0dXJuOyB9CgogICAgICAgIHNldChzZWxmLCAnbGFzdFNldFVSTCcsIG51
        bGwpOwoKICAgICAgICBjYWxsYmFjayhwYXRoKTsKICAgICAgfSk7CiAgICB9
        KTsKICB9LAoKICAvKioKICAgIEBwcml2YXRlCgogICAgR2l2ZW4gYSBVUkws
        IGZvcm1hdHMgaXQgdG8gYmUgcGxhY2VkIGludG8gdGhlIHBhZ2UgYXMgcGFy
        dAogICAgb2YgYW4gZWxlbWVudCdzIGBocmVmYCBhdHRyaWJ1dGUuCgogICAg
        VGhpcyBpcyB1c2VkLCBmb3IgZXhhbXBsZSwgd2hlbiB1c2luZyB0aGUge3th
        Y3Rpb259fSBoZWxwZXIKICAgIHRvIGdlbmVyYXRlIGEgVVJMIGJhc2VkIG9u
        IGFuIGV2ZW50LgoKICAgIEBtZXRob2QgZm9ybWF0VVJMCiAgICBAcGFyYW0g
        dXJsIHtTdHJpbmd9CiAgKi8KICBmb3JtYXRVUkw6IGZ1bmN0aW9uKHVybCkg
        ewogICAgcmV0dXJuICcjJyt1cmw7CiAgfSwKCiAgLyoqCiAgICBAcHJpdmF0
        ZQoKICAgIENsZWFucyB1cCB0aGUgSGFzaExvY2F0aW9uIGV2ZW50IGxpc3Rl
        bmVyLgoKICAgIEBtZXRob2Qgd2lsbERlc3Ryb3kKICAqLwogIHdpbGxEZXN0
        cm95OiBmdW5jdGlvbigpIHsKICAgIHZhciBndWlkID0gRW1iZXIuZ3VpZEZv
        cih0aGlzKTsKCiAgICBFbWJlci4kKHdpbmRvdykub2ZmKCdoYXNoY2hhbmdl
        LmVtYmVyLWxvY2F0aW9uLScrZ3VpZCk7CiAgfQp9KTsKCkVtYmVyLkxvY2F0
        aW9uLnJlZ2lzdGVySW1wbGVtZW50YXRpb24oJ2hhc2gnLCBFbWJlci5IYXNo
        TG9jYXRpb24pOwoKfSkoKTsKCgoKKGZ1bmN0aW9uKCkgewovKioKQG1vZHVs
        ZSBlbWJlcgpAc3VibW9kdWxlIGVtYmVyLXJvdXRpbmcKKi8KCnZhciBnZXQg
        PSBFbWJlci5nZXQsIHNldCA9IEVtYmVyLnNldDsKdmFyIHBvcHN0YXRlRmly
        ZWQgPSBmYWxzZTsKdmFyIHN1cHBvcnRzSGlzdG9yeVN0YXRlID0gd2luZG93
        Lmhpc3RvcnkgJiYgJ3N0YXRlJyBpbiB3aW5kb3cuaGlzdG9yeTsKCi8qKgog
        IEVtYmVyLkhpc3RvcnlMb2NhdGlvbiBpbXBsZW1lbnRzIHRoZSBsb2NhdGlv
        biBBUEkgdXNpbmcgdGhlIGJyb3dzZXIncwogIGhpc3RvcnkucHVzaFN0YXRl
        IEFQSS4KCiAgQGNsYXNzIEhpc3RvcnlMb2NhdGlvbgogIEBuYW1lc3BhY2Ug
        RW1iZXIKICBAZXh0ZW5kcyBFbWJlci5PYmplY3QKKi8KRW1iZXIuSGlzdG9y
        eUxvY2F0aW9uID0gRW1iZXIuT2JqZWN0LmV4dGVuZCh7CgogIGluaXQ6IGZ1
        bmN0aW9uKCkgewogICAgc2V0KHRoaXMsICdsb2NhdGlvbicsIGdldCh0aGlz
        LCAnbG9jYXRpb24nKSB8fCB3aW5kb3cubG9jYXRpb24pOwogICAgdGhpcy5p
        bml0U3RhdGUoKTsKICB9LAoKICAvKioKICAgIEBwcml2YXRlCgogICAgVXNl
        ZCB0byBzZXQgc3RhdGUgb24gZmlyc3QgY2FsbCB0byBzZXRVUkwKCiAgICBA
        bWV0aG9kIGluaXRTdGF0ZQogICovCiAgaW5pdFN0YXRlOiBmdW5jdGlvbigp
        IHsKICAgIHNldCh0aGlzLCAnaGlzdG9yeScsIGdldCh0aGlzLCAnaGlzdG9y
        eScpIHx8IHdpbmRvdy5oaXN0b3J5KTsKICAgIHRoaXMucmVwbGFjZVN0YXRl
        KHRoaXMuZm9ybWF0VVJMKHRoaXMuZ2V0VVJMKCkpKTsKICB9LAoKICAvKioK
        ICAgIFdpbGwgYmUgcHJlLXBlbmRlZCB0byBwYXRoIHVwb24gc3RhdGUgY2hh
        bmdlCgogICAgQHByb3BlcnR5IHJvb3RVUkwKICAgIEBkZWZhdWx0ICcvJwog
        ICovCiAgcm9vdFVSTDogJy8nLAoKICAvKioKICAgIEBwcml2YXRlCgogICAg
        UmV0dXJucyB0aGUgY3VycmVudCBgbG9jYXRpb24ucGF0aG5hbWVgIHdpdGhv
        dXQgcm9vdFVSTAoKICAgIEBtZXRob2QgZ2V0VVJMCiAgICBAcmV0dXJuIHVy
        bCB7U3RyaW5nfQogICovCiAgZ2V0VVJMOiBmdW5jdGlvbigpIHsKICAgIHZh
        ciByb290VVJMID0gZ2V0KHRoaXMsICdyb290VVJMJyksCiAgICAgICAgdXJs
        ID0gZ2V0KHRoaXMsICdsb2NhdGlvbicpLnBhdGhuYW1lOwoKICAgIHJvb3RV
        UkwgPSByb290VVJMLnJlcGxhY2UoL1wvJC8sICcnKTsKICAgIHVybCA9IHVy
        bC5yZXBsYWNlKHJvb3RVUkwsICcnKTsKCiAgICByZXR1cm4gdXJsOwogIH0s
        CgogIC8qKgogICAgQHByaXZhdGUKCiAgICBVc2VzIGBoaXN0b3J5LnB1c2hT
        dGF0ZWAgdG8gdXBkYXRlIHRoZSB1cmwgd2l0aG91dCBhIHBhZ2UgcmVsb2Fk
        LgoKICAgIEBtZXRob2Qgc2V0VVJMCiAgICBAcGFyYW0gcGF0aCB7U3RyaW5n
        fQogICovCiAgc2V0VVJMOiBmdW5jdGlvbihwYXRoKSB7CiAgICB2YXIgc3Rh
        dGUgPSB0aGlzLmdldFN0YXRlKCk7CiAgICBwYXRoID0gdGhpcy5mb3JtYXRV
        UkwocGF0aCk7CgogICAgaWYgKHN0YXRlICYmIHN0YXRlLnBhdGggIT09IHBh
        dGgpIHsKICAgICAgdGhpcy5wdXNoU3RhdGUocGF0aCk7CiAgICB9CiAgfSwK
        CiAgLyoqCiAgICBAcHJpdmF0ZQoKICAgIFVzZXMgYGhpc3RvcnkucmVwbGFj
        ZVN0YXRlYCB0byB1cGRhdGUgdGhlIHVybCB3aXRob3V0IGEgcGFnZSByZWxv
        YWQKICAgIG9yIGhpc3RvcnkgbW9kaWZpY2F0aW9uLgoKICAgIEBtZXRob2Qg
        cmVwbGFjZVVSTAogICAgQHBhcmFtIHBhdGgge1N0cmluZ30KICAqLwogIHJl
        cGxhY2VVUkw6IGZ1bmN0aW9uKHBhdGgpIHsKICAgIHZhciBzdGF0ZSA9IHRo
        aXMuZ2V0U3RhdGUoKTsKICAgIHBhdGggPSB0aGlzLmZvcm1hdFVSTChwYXRo
        KTsKCiAgICBpZiAoc3RhdGUgJiYgc3RhdGUucGF0aCAhPT0gcGF0aCkgewog
        ICAgICB0aGlzLnJlcGxhY2VTdGF0ZShwYXRoKTsKICAgIH0KICB9LAoKICAv
        KioKICAgQHByaXZhdGUKCiAgIEdldCB0aGUgY3VycmVudCBgaGlzdG9yeS5z
        dGF0ZWAKICAgUG9seWZpbGwgY2hlY2tzIGZvciBuYXRpdmUgYnJvd3NlciBz
        dXBwb3J0IGFuZCBmYWxscyBiYWNrIHRvIHJldHJpZXZpbmcKICAgZnJvbSBh
        IHByaXZhdGUgX2hpc3RvcnlTdGF0ZSB2YXJpYWJsZQoKICAgQG1ldGhvZCBn
        ZXRTdGF0ZQogICBAcmV0dXJuIHN0YXRlIHtPYmplY3R9CiAgKi8KICBnZXRT
        dGF0ZTogZnVuY3Rpb24oKSB7CiAgICByZXR1cm4gc3VwcG9ydHNIaXN0b3J5
        U3RhdGUgPyBnZXQodGhpcywgJ2hpc3RvcnknKS5zdGF0ZSA6IHRoaXMuX2hp
        c3RvcnlTdGF0ZTsKICB9LAoKICAvKioKICAgQHByaXZhdGUKCiAgIFB1c2hl
        cyBhIG5ldyBzdGF0ZQoKICAgQG1ldGhvZCBwdXNoU3RhdGUKICAgQHBhcmFt
        IHBhdGgge1N0cmluZ30KICAqLwogIHB1c2hTdGF0ZTogZnVuY3Rpb24ocGF0
        aCkgewogICAgdmFyIHN0YXRlID0geyBwYXRoOiBwYXRoIH07CgogICAgZ2V0
        KHRoaXMsICdoaXN0b3J5JykucHVzaFN0YXRlKHN0YXRlLCBudWxsLCBwYXRo
        KTsKCiAgICAvLyBzdG9yZSBzdGF0ZSBpZiBicm93c2VyIGRvZXNuJ3Qgc3Vw
        cG9ydCBgaGlzdG9yeS5zdGF0ZWAKICAgIGlmICghc3VwcG9ydHNIaXN0b3J5
        U3RhdGUpIHsKICAgICAgdGhpcy5faGlzdG9yeVN0YXRlID0gc3RhdGU7CiAg
        ICB9CgogICAgLy8gdXNlZCBmb3Igd2Via2l0IHdvcmthcm91bmQKICAgIHRo
        aXMuX3ByZXZpb3VzVVJMID0gdGhpcy5nZXRVUkwoKTsKICB9LAoKICAvKioK
        ICAgQHByaXZhdGUKCiAgIFJlcGxhY2VzIHRoZSBjdXJyZW50IHN0YXRlCgog
        ICBAbWV0aG9kIHJlcGxhY2VTdGF0ZQogICBAcGFyYW0gcGF0aCB7U3RyaW5n
        fQogICovCiAgcmVwbGFjZVN0YXRlOiBmdW5jdGlvbihwYXRoKSB7CiAgICB2
        YXIgc3RhdGUgPSB7IHBhdGg6IHBhdGggfTsKCiAgICBnZXQodGhpcywgJ2hp
        c3RvcnknKS5yZXBsYWNlU3RhdGUoc3RhdGUsIG51bGwsIHBhdGgpOwoKICAg
        IC8vIHN0b3JlIHN0YXRlIGlmIGJyb3dzZXIgZG9lc24ndCBzdXBwb3J0IGBo
        aXN0b3J5LnN0YXRlYAogICAgaWYgKCFzdXBwb3J0c0hpc3RvcnlTdGF0ZSkg
        ewogICAgICB0aGlzLl9oaXN0b3J5U3RhdGUgPSBzdGF0ZTsKICAgIH0KCiAg
        ICAvLyB1c2VkIGZvciB3ZWJraXQgd29ya2Fyb3VuZAogICAgdGhpcy5fcHJl
        dmlvdXNVUkwgPSB0aGlzLmdldFVSTCgpOwogIH0sCgogIC8qKgogICAgQHBy
        aXZhdGUKCiAgICBSZWdpc3RlciBhIGNhbGxiYWNrIHRvIGJlIGludm9rZWQg
        d2hlbmV2ZXIgdGhlIGJyb3dzZXIKICAgIGhpc3RvcnkgY2hhbmdlcywgaW5j
        bHVkaW5nIHVzaW5nIGZvcndhcmQgYW5kIGJhY2sgYnV0dG9ucy4KCiAgICBA
        bWV0aG9kIG9uVXBkYXRlVVJMCiAgICBAcGFyYW0gY2FsbGJhY2sge0Z1bmN0
        aW9ufQogICovCiAgb25VcGRhdGVVUkw6IGZ1bmN0aW9uKGNhbGxiYWNrKSB7
        CiAgICB2YXIgZ3VpZCA9IEVtYmVyLmd1aWRGb3IodGhpcyksCiAgICAgICAg
        c2VsZiA9IHRoaXM7CgogICAgRW1iZXIuJCh3aW5kb3cpLm9uKCdwb3BzdGF0
        ZS5lbWJlci1sb2NhdGlvbi0nK2d1aWQsIGZ1bmN0aW9uKGUpIHsKICAgICAg
        Ly8gSWdub3JlIGluaXRpYWwgcGFnZSBsb2FkIHBvcHN0YXRlIGV2ZW50IGlu
        IENocm9tZQogICAgICBpZiAoIXBvcHN0YXRlRmlyZWQpIHsKICAgICAgICBw
        b3BzdGF0ZUZpcmVkID0gdHJ1ZTsKICAgICAgICBpZiAoc2VsZi5nZXRVUkwo
        KSA9PT0gc2VsZi5fcHJldmlvdXNVUkwpIHsgcmV0dXJuOyB9CiAgICAgIH0K
        ICAgICAgY2FsbGJhY2soc2VsZi5nZXRVUkwoKSk7CiAgICB9KTsKICB9LAoK
        ICAvKioKICAgIEBwcml2YXRlCgogICAgVXNlZCB3aGVuIHVzaW5nIGB7e2Fj
        dGlvbn19YCBoZWxwZXIuICBUaGUgdXJsIGlzIGFsd2F5cyBhcHBlbmRlZCB0
        byB0aGUgcm9vdFVSTC4KCiAgICBAbWV0aG9kIGZvcm1hdFVSTAogICAgQHBh
        cmFtIHVybCB7U3RyaW5nfQogICAgQHJldHVybiBmb3JtYXR0ZWQgdXJsIHtT
        dHJpbmd9CiAgKi8KICBmb3JtYXRVUkw6IGZ1bmN0aW9uKHVybCkgewogICAg
        dmFyIHJvb3RVUkwgPSBnZXQodGhpcywgJ3Jvb3RVUkwnKTsKCiAgICBpZiAo
        dXJsICE9PSAnJykgewogICAgICByb290VVJMID0gcm9vdFVSTC5yZXBsYWNl
        KC9cLyQvLCAnJyk7CiAgICB9CgogICAgcmV0dXJuIHJvb3RVUkwgKyB1cmw7
        CiAgfSwKCiAgLyoqCiAgICBAcHJpdmF0ZQoKICAgIENsZWFucyB1cCB0aGUg
        SGlzdG9yeUxvY2F0aW9uIGV2ZW50IGxpc3RlbmVyLgoKICAgIEBtZXRob2Qg
        d2lsbERlc3Ryb3kKICAqLwogIHdpbGxEZXN0cm95OiBmdW5jdGlvbigpIHsK
        ICAgIHZhciBndWlkID0gRW1iZXIuZ3VpZEZvcih0aGlzKTsKCiAgICBFbWJl
        ci4kKHdpbmRvdykub2ZmKCdwb3BzdGF0ZS5lbWJlci1sb2NhdGlvbi0nK2d1
        aWQpOwogIH0KfSk7CgpFbWJlci5Mb2NhdGlvbi5yZWdpc3RlckltcGxlbWVu
        dGF0aW9uKCdoaXN0b3J5JywgRW1iZXIuSGlzdG9yeUxvY2F0aW9uKTsKCn0p
        KCk7CgoKCihmdW5jdGlvbigpIHsKCn0pKCk7CgoKCihmdW5jdGlvbigpIHsK
        LyoqCkVtYmVyIFJvdXRpbmcKCkBtb2R1bGUgZW1iZXIKQHN1Ym1vZHVsZSBl
        bWJlci1yb3V0aW5nCkByZXF1aXJlcyBlbWJlci12aWV3cwoqLwoKfSkoKTsK
        CihmdW5jdGlvbigpIHsKZnVuY3Rpb24gdmlzaXQodmVydGV4LCBmbiwgdmlz
        aXRlZCwgcGF0aCkgewogIHZhciBuYW1lID0gdmVydGV4Lm5hbWUsCiAgICB2
        ZXJ0aWNlcyA9IHZlcnRleC5pbmNvbWluZywKICAgIG5hbWVzID0gdmVydGV4
        LmluY29taW5nTmFtZXMsCiAgICBsZW4gPSBuYW1lcy5sZW5ndGgsCiAgICBp
        OwogIGlmICghdmlzaXRlZCkgewogICAgdmlzaXRlZCA9IHt9OwogIH0KICBp
        ZiAoIXBhdGgpIHsKICAgIHBhdGggPSBbXTsKICB9CiAgaWYgKHZpc2l0ZWQu
        aGFzT3duUHJvcGVydHkobmFtZSkpIHsKICAgIHJldHVybjsKICB9CiAgcGF0
        aC5wdXNoKG5hbWUpOwogIHZpc2l0ZWRbbmFtZV0gPSB0cnVlOwogIGZvciAo
        aSA9IDA7IGkgPCBsZW47IGkrKykgewogICAgdmlzaXQodmVydGljZXNbbmFt
        ZXNbaV1dLCBmbiwgdmlzaXRlZCwgcGF0aCk7CiAgfQogIGZuKHZlcnRleCwg
        cGF0aCk7CiAgcGF0aC5wb3AoKTsKfQoKZnVuY3Rpb24gREFHKCkgewogIHRo
        aXMubmFtZXMgPSBbXTsKICB0aGlzLnZlcnRpY2VzID0ge307Cn0KCkRBRy5w
        cm90b3R5cGUuYWRkID0gZnVuY3Rpb24obmFtZSkgewogIGlmICghbmFtZSkg
        eyByZXR1cm47IH0KICBpZiAodGhpcy52ZXJ0aWNlcy5oYXNPd25Qcm9wZXJ0
        eShuYW1lKSkgewogICAgcmV0dXJuIHRoaXMudmVydGljZXNbbmFtZV07CiAg
        fQogIHZhciB2ZXJ0ZXggPSB7CiAgICBuYW1lOiBuYW1lLCBpbmNvbWluZzog
        e30sIGluY29taW5nTmFtZXM6IFtdLCBoYXNPdXRnb2luZzogZmFsc2UsIHZh
        bHVlOiBudWxsCiAgfTsKICB0aGlzLnZlcnRpY2VzW25hbWVdID0gdmVydGV4
        OwogIHRoaXMubmFtZXMucHVzaChuYW1lKTsKICByZXR1cm4gdmVydGV4Owp9
        OwoKREFHLnByb3RvdHlwZS5tYXAgPSBmdW5jdGlvbihuYW1lLCB2YWx1ZSkg
        ewogIHRoaXMuYWRkKG5hbWUpLnZhbHVlID0gdmFsdWU7Cn07CgpEQUcucHJv
        dG90eXBlLmFkZEVkZ2UgPSBmdW5jdGlvbihmcm9tTmFtZSwgdG9OYW1lKSB7
        CiAgaWYgKCFmcm9tTmFtZSB8fCAhdG9OYW1lIHx8IGZyb21OYW1lID09PSB0
        b05hbWUpIHsKICAgIHJldHVybjsKICB9CiAgdmFyIGZyb20gPSB0aGlzLmFk
        ZChmcm9tTmFtZSksIHRvID0gdGhpcy5hZGQodG9OYW1lKTsKICBpZiAodG8u
        aW5jb21pbmcuaGFzT3duUHJvcGVydHkoZnJvbU5hbWUpKSB7CiAgICByZXR1
        cm47CiAgfQogIGZ1bmN0aW9uIGNoZWNrQ3ljbGUodmVydGV4LCBwYXRoKSB7
        CiAgICBpZiAodmVydGV4Lm5hbWUgPT09IHRvTmFtZSkgewogICAgICB0aHJv
        dyBuZXcgRW1iZXIuRXJyb3IoImN5Y2xlIGRldGVjdGVkOiAiICsgdG9OYW1l
        ICsgIiA8LSAiICsgcGF0aC5qb2luKCIgPC0gIikpOwogICAgfQogIH0KICB2
        aXNpdChmcm9tLCBjaGVja0N5Y2xlKTsKICBmcm9tLmhhc091dGdvaW5nID0g
        dHJ1ZTsKICB0by5pbmNvbWluZ1tmcm9tTmFtZV0gPSBmcm9tOwogIHRvLmlu
        Y29taW5nTmFtZXMucHVzaChmcm9tTmFtZSk7Cn07CgpEQUcucHJvdG90eXBl
        LnRvcHNvcnQgPSBmdW5jdGlvbihmbikgewogIHZhciB2aXNpdGVkID0ge30s
        CiAgICB2ZXJ0aWNlcyA9IHRoaXMudmVydGljZXMsCiAgICBuYW1lcyA9IHRo
        aXMubmFtZXMsCiAgICBsZW4gPSBuYW1lcy5sZW5ndGgsCiAgICBpLCB2ZXJ0
        ZXg7CiAgZm9yIChpID0gMDsgaSA8IGxlbjsgaSsrKSB7CiAgICB2ZXJ0ZXgg
        PSB2ZXJ0aWNlc1tuYW1lc1tpXV07CiAgICBpZiAoIXZlcnRleC5oYXNPdXRn
        b2luZykgewogICAgICB2aXNpdCh2ZXJ0ZXgsIGZuLCB2aXNpdGVkKTsKICAg
        IH0KICB9Cn07CgpEQUcucHJvdG90eXBlLmFkZEVkZ2VzID0gZnVuY3Rpb24o
        bmFtZSwgdmFsdWUsIGJlZm9yZSwgYWZ0ZXIpIHsKICB2YXIgaTsKICB0aGlz
        Lm1hcChuYW1lLCB2YWx1ZSk7CiAgaWYgKGJlZm9yZSkgewogICAgaWYgKHR5
        cGVvZiBiZWZvcmUgPT09ICdzdHJpbmcnKSB7CiAgICAgIHRoaXMuYWRkRWRn
        ZShuYW1lLCBiZWZvcmUpOwogICAgfSBlbHNlIHsKICAgICAgZm9yIChpID0g
        MDsgaSA8IGJlZm9yZS5sZW5ndGg7IGkrKykgewogICAgICAgIHRoaXMuYWRk
        RWRnZShuYW1lLCBiZWZvcmVbaV0pOwogICAgICB9CiAgICB9CiAgfQogIGlm
        IChhZnRlcikgewogICAgaWYgKHR5cGVvZiBhZnRlciA9PT0gJ3N0cmluZycp
        IHsKICAgICAgdGhpcy5hZGRFZGdlKGFmdGVyLCBuYW1lKTsKICAgIH0gZWxz
        ZSB7CiAgICAgIGZvciAoaSA9IDA7IGkgPCBhZnRlci5sZW5ndGg7IGkrKykg
        ewogICAgICAgIHRoaXMuYWRkRWRnZShhZnRlcltpXSwgbmFtZSk7CiAgICAg
        IH0KICAgIH0KICB9Cn07CgpFbWJlci5EQUcgPSBEQUc7Cgp9KSgpOwoKCgoo
        ZnVuY3Rpb24oKSB7Ci8qKgpAbW9kdWxlIGVtYmVyCkBzdWJtb2R1bGUgZW1i
        ZXItYXBwbGljYXRpb24KKi8KCnZhciBnZXQgPSBFbWJlci5nZXQsCiAgICBj
        bGFzc2lmeSA9IEVtYmVyLlN0cmluZy5jbGFzc2lmeSwKICAgIGNhcGl0YWxp
        emUgPSBFbWJlci5TdHJpbmcuY2FwaXRhbGl6ZSwKICAgIGRlY2FtZWxpemUg
        PSBFbWJlci5TdHJpbmcuZGVjYW1lbGl6ZTsKCi8qKgogIFRoZSBEZWZhdWx0
        UmVzb2x2ZXIgZGVmaW5lcyB0aGUgZGVmYXVsdCBsb29rdXAgcnVsZXMgdG8g
        cmVzb2x2ZQogIGNvbnRhaW5lciBsb29rdXBzIGJlZm9yZSBjb25zdWx0aW5n
        IHRoZSBjb250YWluZXIgZm9yIHJlZ2lzdGVyZWQKICBpdGVtczoKCiogdGVt
        cGxhdGVzIGFyZSBsb29rZWQgdXAgb24gYEVtYmVyLlRFTVBMQVRFU2AKKiBv
        dGhlciBuYW1lcyBhcmUgbG9va2VkIHVwIG9uIHRoZSBhcHBsaWNhdGlvbiBh
        ZnRlciBjb252ZXJ0aW5nCiAgdGhlIG5hbWUuIEZvciBleGFtcGxlLCBgY29u
        dHJvbGxlcjpwb3N0YCBsb29rcyB1cAogIGBBcHAuUG9zdENvbnRyb2xsZXJg
        IGJ5IGRlZmF1bHQuCiogdGhlcmUgYXJlIHNvbWUgbnVhbmNlcyAoc2VlIGV4
        YW1wbGVzIGJlbG93KQoKICAjIyMgSG93IFJlc29sdmluZyBXb3JrcwoKICBU
        aGUgY29udGFpbmVyIGNhbGxzIHRoaXMgb2JqZWN0J3MgYHJlc29sdmVgIG1l
        dGhvZCB3aXRoIHRoZQogIGBmdWxsTmFtZWAgYXJndW1lbnQuCgogIEl0IGZp
        cnN0IHBhcnNlcyB0aGUgZnVsbE5hbWUgaW50byBhbiBvYmplY3QgdXNpbmcg
        YHBhcnNlTmFtZWAuCgogIFRoZW4gaXQgY2hlY2tzIGZvciB0aGUgcHJlc2Vu
        Y2Ugb2YgYSB0eXBlLXNwZWNpZmljIGluc3RhbmNlCiAgbWV0aG9kIG9mIHRo
        ZSBmb3JtIGByZXNvbHZlW1R5cGVdYCBhbmQgY2FsbHMgaXQgaWYgaXQgZXhp
        c3RzLgogIEZvciBleGFtcGxlIGlmIGl0IHdhcyByZXNvbHZpbmcgJ3RlbXBs
        YXRlOnBvc3QnLCBpdCB3b3VsZCBjYWxsCiAgdGhlIGByZXNvbHZlVGVtcGxh
        dGVgIG1ldGhvZC4KCiAgSXRzIGxhc3QgcmVzb3J0IGlzIHRvIGNhbGwgdGhl
        IGByZXNvbHZlT3RoZXJgIG1ldGhvZC4KCiAgVGhlIG1ldGhvZHMgb2YgdGhp
        cyBvYmplY3QgYXJlIGRlc2lnbmVkIHRvIGJlIGVhc3kgdG8gb3ZlcnJpZGUK
        ICBpbiBhIHN1YmNsYXNzLiBGb3IgZXhhbXBsZSwgeW91IGNvdWxkIGVuaGFu
        Y2UgaG93IGEgdGVtcGxhdGUKICBpcyByZXNvbHZlZCBsaWtlIHNvOgoKICBg
        YGBqYXZhc2NyaXB0CiAgQXBwID0gRW1iZXIuQXBwbGljYXRpb24uY3JlYXRl
        KHsKICAgIFJlc29sdmVyOiBFbWJlci5EZWZhdWx0UmVzb2x2ZXIuZXh0ZW5k
        KHsKICAgICAgcmVzb2x2ZVRlbXBsYXRlOiBmdW5jdGlvbihwYXJzZWROYW1l
        KSB7CiAgICAgICAgdmFyIHJlc29sdmVkVGVtcGxhdGUgPSB0aGlzLl9zdXBl
        cihwYXJzZWROYW1lKTsKICAgICAgICBpZiAocmVzb2x2ZWRUZW1wbGF0ZSkg
        eyByZXR1cm4gcmVzb2x2ZWRUZW1wbGF0ZTsgfQogICAgICAgIHJldHVybiBF
        bWJlci5URU1QTEFURVNbJ25vdF9mb3VuZCddOwogICAgICB9CiAgICB9KQog
        IH0pOwogIGBgYAoKICBTb21lIGV4YW1wbGVzIG9mIGhvdyBuYW1lcyBhcmUg
        cmVzb2x2ZWQ6CgogIGBgYAogICd0ZW1wbGF0ZTpwb3N0JyAvLz0+IEVtYmVy
        LlRFTVBMQVRFU1sncG9zdCddCiAgJ3RlbXBsYXRlOnBvc3RzL2J5bGluZScg
        Ly89PiBFbWJlci5URU1QTEFURVNbJ3Bvc3RzL2J5bGluZSddCiAgJ3RlbXBs
        YXRlOnBvc3RzLmJ5bGluZScgLy89PiBFbWJlci5URU1QTEFURVNbJ3Bvc3Rz
        L2J5bGluZSddCiAgJ3RlbXBsYXRlOmJsb2dQb3N0JyAvLz0+IEVtYmVyLlRF
        TVBMQVRFU1snYmxvZ1Bvc3QnXQogICAgICAgICAgICAgICAgICAgICAgLy8g
        ICBPUgogICAgICAgICAgICAgICAgICAgICAgLy8gICBFbWJlci5URU1QTEFU
        RVNbJ2Jsb2dfcG9zdCddCiAgJ2NvbnRyb2xsZXI6cG9zdCcgLy89PiBBcHAu
        UG9zdENvbnRyb2xsZXIKICAnY29udHJvbGxlcjpwb3N0cy5pbmRleCcgLy89
        PiBBcHAuUG9zdHNJbmRleENvbnRyb2xsZXIKICAnY29udHJvbGxlcjpibG9n
        L3Bvc3QnIC8vPT4gQmxvZy5Qb3N0Q29udHJvbGxlcgogICdjb250cm9sbGVy
        OmJhc2ljJyAvLz0+IEVtYmVyLkNvbnRyb2xsZXIKICAncm91dGU6cG9zdCcg
        Ly89PiBBcHAuUG9zdFJvdXRlCiAgJ3JvdXRlOnBvc3RzLmluZGV4JyAvLz0+
        IEFwcC5Qb3N0c0luZGV4Um91dGUKICAncm91dGU6YmxvZy9wb3N0JyAvLz0+
        IEJsb2cuUG9zdFJvdXRlCiAgJ3JvdXRlOmJhc2ljJyAvLz0+IEVtYmVyLlJv
        dXRlCiAgJ3ZpZXc6cG9zdCcgLy89PiBBcHAuUG9zdFZpZXcKICAndmlldzpw
        b3N0cy5pbmRleCcgLy89PiBBcHAuUG9zdHNJbmRleFZpZXcKICAndmlldzpi
        bG9nL3Bvc3QnIC8vPT4gQmxvZy5Qb3N0VmlldwogICd2aWV3OmJhc2ljJyAv
        Lz0+IEVtYmVyLlZpZXcKICAnZm9vOnBvc3QnIC8vPT4gQXBwLlBvc3RGb28K
        ICAnbW9kZWw6cG9zdCcgLy89PiBBcHAuUG9zdAogIGBgYAoKICBAY2xhc3Mg
        RGVmYXVsdFJlc29sdmVyCiAgQG5hbWVzcGFjZSBFbWJlcgogIEBleHRlbmRz
        IEVtYmVyLk9iamVjdAoqLwpFbWJlci5EZWZhdWx0UmVzb2x2ZXIgPSBFbWJl
        ci5PYmplY3QuZXh0ZW5kKHsKICAvKioKICAgIFRoaXMgd2lsbCBiZSBzZXQg
        dG8gdGhlIEFwcGxpY2F0aW9uIGluc3RhbmNlIHdoZW4gaXQgaXMKICAgIGNy
        ZWF0ZWQuCgogICAgQHByb3BlcnR5IG5hbWVzcGFjZQogICovCiAgbmFtZXNw
        YWNlOiBudWxsLAoKICBub3JtYWxpemU6IGZ1bmN0aW9uKGZ1bGxOYW1lKSB7
        CiAgICB2YXIgc3BsaXQgPSBmdWxsTmFtZS5zcGxpdCgnOicsIDIpLAogICAg
        ICAgIHR5cGUgPSBzcGxpdFswXSwKICAgICAgICBuYW1lID0gc3BsaXRbMV07
        CgogICAgRW1iZXIuYXNzZXJ0KCJUcmllZCB0byBub3JtYWxpemUgYSBjb250
        YWluZXIgbmFtZSB3aXRob3V0IGEgY29sb24gKDopIGluIGl0LiBZb3UgcHJv
        YmFibHkgdHJpZWQgdG8gbG9va3VwIGEgbmFtZSB0aGF0IGRpZCBub3QgY29u
        dGFpbiBhIHR5cGUsIGEgY29sb24sIGFuZCBhIG5hbWUuIEEgcHJvcGVyIGxv
        b2t1cCBuYW1lIHdvdWxkIGJlIGB2aWV3OnBvc3RgLiIsIHNwbGl0Lmxlbmd0
        aCA9PT0gMik7CgogICAgaWYgKHR5cGUgIT09ICd0ZW1wbGF0ZScpIHsKICAg
        ICAgdmFyIHJlc3VsdCA9IG5hbWU7CgogICAgICBpZiAocmVzdWx0LmluZGV4
        T2YoJy4nKSA+IC0xKSB7CiAgICAgICAgcmVzdWx0ID0gcmVzdWx0LnJlcGxh
        Y2UoL1wuKC4pL2csIGZ1bmN0aW9uKG0pIHsgcmV0dXJuIG0uY2hhckF0KDEp
        LnRvVXBwZXJDYXNlKCk7IH0pOwogICAgICB9CgogICAgICBpZiAobmFtZS5p
        bmRleE9mKCdfJykgPiAtMSkgewogICAgICAgIHJlc3VsdCA9IHJlc3VsdC5y
        ZXBsYWNlKC9fKC4pL2csIGZ1bmN0aW9uKG0pIHsgcmV0dXJuIG0uY2hhckF0
        KDEpLnRvVXBwZXJDYXNlKCk7IH0pOwogICAgICB9CgogICAgICByZXR1cm4g
        dHlwZSArICc6JyArIHJlc3VsdDsKICAgIH0gZWxzZSB7CiAgICAgIHJldHVy
        biBmdWxsTmFtZTsKICAgIH0KICB9LAoKCiAgLyoqCiAgICBUaGlzIG1ldGhv
        ZCBpcyBjYWxsZWQgdmlhIHRoZSBjb250YWluZXIncyByZXNvbHZlciBtZXRo
        b2QuCiAgICBJdCBwYXJzZXMgdGhlIHByb3ZpZGVkIGBmdWxsTmFtZWAgYW5k
        IHRoZW4gbG9va3MgdXAgYW5kCiAgICByZXR1cm5zIHRoZSBhcHByb3ByaWF0
        ZSB0ZW1wbGF0ZSBvciBjbGFzcy4KCiAgICBAbWV0aG9kIHJlc29sdmUKICAg
        IEBwYXJhbSB7U3RyaW5nfSBmdWxsTmFtZSB0aGUgbG9va3VwIHN0cmluZwog
        ICAgQHJldHVybiB7T2JqZWN0fSB0aGUgcmVzb2x2ZWQgZmFjdG9yeQogICov
        CiAgcmVzb2x2ZTogZnVuY3Rpb24oZnVsbE5hbWUpIHsKICAgIHZhciBwYXJz
        ZWROYW1lID0gdGhpcy5wYXJzZU5hbWUoZnVsbE5hbWUpLAogICAgICAgIHR5
        cGVTcGVjaWZpY1Jlc29sdmVNZXRob2QgPSB0aGlzW3BhcnNlZE5hbWUucmVz
        b2x2ZU1ldGhvZE5hbWVdOwoKICAgIGlmICghcGFyc2VkTmFtZS5uYW1lIHx8
        ICFwYXJzZWROYW1lLnR5cGUpIHsKICAgICAgdGhyb3cgbmV3IFR5cGVFcnJv
        cigiSW52YWxpZCBmdWxsTmFtZTogYCIgKyBmdWxsTmFtZSArICJgLCBtdXN0
        IG9mIG9mIHRoZSBmb3JtIGB0eXBlOm5hbWVgICIpOwogICAgfQoKICAgIGlm
        ICh0eXBlU3BlY2lmaWNSZXNvbHZlTWV0aG9kKSB7CiAgICAgIHZhciByZXNv
        bHZlZCA9IHR5cGVTcGVjaWZpY1Jlc29sdmVNZXRob2QuY2FsbCh0aGlzLCBw
        YXJzZWROYW1lKTsKICAgICAgaWYgKHJlc29sdmVkKSB7IHJldHVybiByZXNv
        bHZlZDsgfQogICAgfQogICAgcmV0dXJuIHRoaXMucmVzb2x2ZU90aGVyKHBh
        cnNlZE5hbWUpOwogIH0sCiAgLyoqCiAgICBDb252ZXJ0IHRoZSBzdHJpbmcg
        bmFtZSBvZiB0aGUgZm9ybSAidHlwZTpuYW1lIiB0bwogICAgYSBKYXZhc2Ny
        aXB0IG9iamVjdCB3aXRoIHRoZSBwYXJzZWQgYXNwZWN0cyBvZiB0aGUgbmFt
        ZQogICAgYnJva2VuIG91dC4KCiAgICBAcHJvdGVjdGVkCiAgICBAcGFyYW0g
        e1N0cmluZ30gZnVsbE5hbWUgdGhlIGxvb2t1cCBzdHJpbmcKICAgIEBtZXRo
        b2QgcGFyc2VOYW1lCiAgKi8KICBwYXJzZU5hbWU6IGZ1bmN0aW9uKGZ1bGxO
        YW1lKSB7CiAgICB2YXIgbmFtZVBhcnRzID0gZnVsbE5hbWUuc3BsaXQoIjoi
        KSwKICAgICAgICB0eXBlID0gbmFtZVBhcnRzWzBdLCBmdWxsTmFtZVdpdGhv
        dXRUeXBlID0gbmFtZVBhcnRzWzFdLAogICAgICAgIG5hbWUgPSBmdWxsTmFt
        ZVdpdGhvdXRUeXBlLAogICAgICAgIG5hbWVzcGFjZSA9IGdldCh0aGlzLCAn
        bmFtZXNwYWNlJyksCiAgICAgICAgcm9vdCA9IG5hbWVzcGFjZTsKCiAgICBp
        ZiAodHlwZSAhPT0gJ3RlbXBsYXRlJyAmJiBuYW1lLmluZGV4T2YoJy8nKSAh
        PT0gLTEpIHsKICAgICAgdmFyIHBhcnRzID0gbmFtZS5zcGxpdCgnLycpOwog
        ICAgICBuYW1lID0gcGFydHNbcGFydHMubGVuZ3RoIC0gMV07CiAgICAgIHZh
        ciBuYW1lc3BhY2VOYW1lID0gY2FwaXRhbGl6ZShwYXJ0cy5zbGljZSgwLCAt
        MSkuam9pbignLicpKTsKICAgICAgcm9vdCA9IEVtYmVyLk5hbWVzcGFjZS5i
        eU5hbWUobmFtZXNwYWNlTmFtZSk7CgogICAgICBFbWJlci5hc3NlcnQoJ1lv
        dSBhcmUgbG9va2luZyBmb3IgYSAnICsgbmFtZSArICcgJyArIHR5cGUgKyAn
        IGluIHRoZSAnICsgbmFtZXNwYWNlTmFtZSArICcgbmFtZXNwYWNlLCBidXQg
        dGhlIG5hbWVzcGFjZSBjb3VsZCBub3QgYmUgZm91bmQnLCByb290KTsKICAg
        IH0KCiAgICByZXR1cm4gewogICAgICBmdWxsTmFtZTogZnVsbE5hbWUsCiAg
        ICAgIHR5cGU6IHR5cGUsCiAgICAgIGZ1bGxOYW1lV2l0aG91dFR5cGU6IGZ1
        bGxOYW1lV2l0aG91dFR5cGUsCiAgICAgIG5hbWU6IG5hbWUsCiAgICAgIHJv
        b3Q6IHJvb3QsCiAgICAgIHJlc29sdmVNZXRob2ROYW1lOiAicmVzb2x2ZSIg
        KyBjbGFzc2lmeSh0eXBlKQogICAgfTsKICB9LAogIC8qKgogICAgTG9vayB1
        cCB0aGUgdGVtcGxhdGUgaW4gRW1iZXIuVEVNUExBVEVTCgogICAgQHByb3Rl
        Y3RlZAogICAgQHBhcmFtIHtPYmplY3R9IHBhcnNlZE5hbWUgYSBwYXJzZU5h
        bWUgb2JqZWN0IHdpdGggdGhlIHBhcnNlZAogICAgICBmdWxsTmFtZSBsb29r
        dXAgc3RyaW5nCiAgICBAbWV0aG9kIHJlc29sdmVUZW1wbGF0ZQogICovCiAg
        cmVzb2x2ZVRlbXBsYXRlOiBmdW5jdGlvbihwYXJzZWROYW1lKSB7CiAgICB2
        YXIgdGVtcGxhdGVOYW1lID0gcGFyc2VkTmFtZS5mdWxsTmFtZVdpdGhvdXRU
        eXBlLnJlcGxhY2UoL1wuL2csICcvJyk7CgogICAgaWYgKEVtYmVyLlRFTVBM
        QVRFU1t0ZW1wbGF0ZU5hbWVdKSB7CiAgICAgIHJldHVybiBFbWJlci5URU1Q
        TEFURVNbdGVtcGxhdGVOYW1lXTsKICAgIH0KCiAgICB0ZW1wbGF0ZU5hbWUg
        PSBkZWNhbWVsaXplKHRlbXBsYXRlTmFtZSk7CiAgICBpZiAoRW1iZXIuVEVN
        UExBVEVTW3RlbXBsYXRlTmFtZV0pIHsKICAgICAgcmV0dXJuIEVtYmVyLlRF
        TVBMQVRFU1t0ZW1wbGF0ZU5hbWVdOwogICAgfQogIH0sCiAgLyoqCiAgICBH
        aXZlbiBhIHBhcnNlTmFtZSBvYmplY3QgKG91dHB1dCBmcm9tIGBwYXJzZU5h
        bWVgKSwgYXBwbHkKICAgIHRoZSBjb252ZW50aW9ucyBleHBlY3RlZCBieSBg
        RW1iZXIuUm91dGVyYAoKICAgIEBwcm90ZWN0ZWQKICAgIEBwYXJhbSB7T2Jq
        ZWN0fSBwYXJzZWROYW1lIGEgcGFyc2VOYW1lIG9iamVjdCB3aXRoIHRoZSBw
        YXJzZWQKICAgICAgZnVsbE5hbWUgbG9va3VwIHN0cmluZwogICAgQG1ldGhv
        ZCB1c2VSb3V0ZXJOYW1pbmcKICAqLwogIHVzZVJvdXRlck5hbWluZzogZnVu
        Y3Rpb24ocGFyc2VkTmFtZSkgewogICAgcGFyc2VkTmFtZS5uYW1lID0gcGFy
        c2VkTmFtZS5uYW1lLnJlcGxhY2UoL1wuL2csICdfJyk7CiAgICBpZiAocGFy
        c2VkTmFtZS5uYW1lID09PSAnYmFzaWMnKSB7CiAgICAgIHBhcnNlZE5hbWUu
        bmFtZSA9ICcnOwogICAgfQogIH0sCiAgLyoqCiAgICBMb29rdXAgdGhlIGNv
        bnRyb2xsZXIgdXNpbmcgYHJlc29sdmVPdGhlcmAKCiAgICBAcHJvdGVjdGVk
        CiAgICBAcGFyYW0ge09iamVjdH0gcGFyc2VkTmFtZSBhIHBhcnNlTmFtZSBv
        YmplY3Qgd2l0aCB0aGUgcGFyc2VkCiAgICAgIGZ1bGxOYW1lIGxvb2t1cCBz
        dHJpbmcKICAgIEBtZXRob2QgcmVzb2x2ZUNvbnRyb2xsZXIKICAqLwogIHJl
        c29sdmVDb250cm9sbGVyOiBmdW5jdGlvbihwYXJzZWROYW1lKSB7CiAgICB0
        aGlzLnVzZVJvdXRlck5hbWluZyhwYXJzZWROYW1lKTsKICAgIHJldHVybiB0
        aGlzLnJlc29sdmVPdGhlcihwYXJzZWROYW1lKTsKICB9LAogIC8qKgogICAg
        TG9va3VwIHRoZSByb3V0ZSB1c2luZyBgcmVzb2x2ZU90aGVyYAoKICAgIEBw
        cm90ZWN0ZWQKICAgIEBwYXJhbSB7T2JqZWN0fSBwYXJzZWROYW1lIGEgcGFy
        c2VOYW1lIG9iamVjdCB3aXRoIHRoZSBwYXJzZWQKICAgICAgZnVsbE5hbWUg
        bG9va3VwIHN0cmluZwogICAgQG1ldGhvZCByZXNvbHZlUm91dGUKICAqLwog
        IHJlc29sdmVSb3V0ZTogZnVuY3Rpb24ocGFyc2VkTmFtZSkgewogICAgdGhp
        cy51c2VSb3V0ZXJOYW1pbmcocGFyc2VkTmFtZSk7CiAgICByZXR1cm4gdGhp
        cy5yZXNvbHZlT3RoZXIocGFyc2VkTmFtZSk7CiAgfSwKICAvKioKICAgIExv
        b2t1cCB0aGUgdmlldyB1c2luZyBgcmVzb2x2ZU90aGVyYAoKICAgIEBwcm90
        ZWN0ZWQKICAgIEBwYXJhbSB7T2JqZWN0fSBwYXJzZWROYW1lIGEgcGFyc2VO
        YW1lIG9iamVjdCB3aXRoIHRoZSBwYXJzZWQKICAgICAgZnVsbE5hbWUgbG9v
        a3VwIHN0cmluZwogICAgQG1ldGhvZCByZXNvbHZlVmlldwogICovCiAgcmVz
        b2x2ZVZpZXc6IGZ1bmN0aW9uKHBhcnNlZE5hbWUpIHsKICAgIHRoaXMudXNl
        Um91dGVyTmFtaW5nKHBhcnNlZE5hbWUpOwogICAgcmV0dXJuIHRoaXMucmVz
        b2x2ZU90aGVyKHBhcnNlZE5hbWUpOwogIH0sCgogIC8qKgogICAgTG9va3Vw
        IHRoZSBtb2RlbCBvbiB0aGUgQXBwbGljYXRpb24gbmFtZXNwYWNlCgogICAg
        QHByb3RlY3RlZAogICAgQHBhcmFtIHtPYmplY3R9IHBhcnNlZE5hbWUgYSBw
        YXJzZU5hbWUgb2JqZWN0IHdpdGggdGhlIHBhcnNlZAogICAgICBmdWxsTmFt
        ZSBsb29rdXAgc3RyaW5nCiAgICBAbWV0aG9kIHJlc29sdmVNb2RlbAogICov
        CiAgcmVzb2x2ZU1vZGVsOiBmdW5jdGlvbihwYXJzZWROYW1lKSB7CiAgICB2
        YXIgY2xhc3NOYW1lID0gY2xhc3NpZnkocGFyc2VkTmFtZS5uYW1lKSwKICAg
        ICAgICBmYWN0b3J5ID0gZ2V0KHBhcnNlZE5hbWUucm9vdCwgY2xhc3NOYW1l
        KTsKCiAgICAgaWYgKGZhY3RvcnkpIHsgcmV0dXJuIGZhY3Rvcnk7IH0KICB9
        LAogIC8qKgogICAgTG9vayB1cCB0aGUgc3BlY2lmaWVkIG9iamVjdCAoZnJv
        bSBwYXJzZWROYW1lKSBvbiB0aGUgYXBwcm9wcmlhdGUKICAgIG5hbWVzcGFj
        ZSAodXN1YWxseSBvbiB0aGUgQXBwbGljYXRpb24pCgogICAgQHByb3RlY3Rl
        ZAogICAgQHBhcmFtIHtPYmplY3R9IHBhcnNlZE5hbWUgYSBwYXJzZU5hbWUg
        b2JqZWN0IHdpdGggdGhlIHBhcnNlZAogICAgICBmdWxsTmFtZSBsb29rdXAg
        c3RyaW5nCiAgICBAbWV0aG9kIHJlc29sdmVPdGhlcgogICovCiAgcmVzb2x2
        ZU90aGVyOiBmdW5jdGlvbihwYXJzZWROYW1lKSB7CiAgICB2YXIgY2xhc3NO
        YW1lID0gY2xhc3NpZnkocGFyc2VkTmFtZS5uYW1lKSArIGNsYXNzaWZ5KHBh
        cnNlZE5hbWUudHlwZSksCiAgICAgICAgZmFjdG9yeSA9IGdldChwYXJzZWRO
        YW1lLnJvb3QsIGNsYXNzTmFtZSk7CiAgICBpZiAoZmFjdG9yeSkgeyByZXR1
        cm4gZmFjdG9yeTsgfQogIH0sCgogIC8qKgogICAgUmV0dXJucyBhIGh1bWFu
        LXJlYWRhYmxlIGRlc2NyaXB0aW9uIGZvciBhIGZ1bGxOYW1lLiBVc2VkIGJ5
        IHRoZQogICAgQXBwbGljYXRpb24gbmFtZXNwYWNlIGluIGFzc2VydGlvbnMg
        dG8gZGVzY3JpYmUgdGhlCiAgICBwcmVjaXNlIG5hbWUgb2YgdGhlIGNsYXNz
        IHRoYXQgRW1iZXIgaXMgbG9va2luZyBmb3IsIHJhdGhlciB0aGFuCiAgICBj
        b250YWluZXIga2V5cy4KCiAgICBAcHJvdGVjdGVkCiAgICBAcGFyYW0ge1N0
        cmluZ30gZnVsbE5hbWUgdGhlIGxvb2t1cCBzdHJpbmcKICAgIEBtZXRob2Qg
        bG9va3VwRGVzY3JpcHRpb24KICAqLwogIGxvb2t1cERlc2NyaXB0aW9uOiBm
        dW5jdGlvbihmdWxsTmFtZSkgewogICAgdmFyIHBhcnNlZE5hbWUgPSB0aGlz
        LnBhcnNlTmFtZShmdWxsTmFtZSk7CgogICAgaWYgKHBhcnNlZE5hbWUudHlw
        ZSA9PT0gJ3RlbXBsYXRlJykgewogICAgICByZXR1cm4gInRlbXBsYXRlIGF0
        ICIgKyBwYXJzZWROYW1lLmZ1bGxOYW1lV2l0aG91dFR5cGUucmVwbGFjZSgv
        XC4vZywgJy8nKTsKICAgIH0KCiAgICB2YXIgZGVzY3JpcHRpb24gPSBwYXJz
        ZWROYW1lLnJvb3QgKyAiLiIgKyBjbGFzc2lmeShwYXJzZWROYW1lLm5hbWUp
        OwogICAgaWYgKHBhcnNlZE5hbWUudHlwZSAhPT0gJ21vZGVsJykgeyBkZXNj
        cmlwdGlvbiArPSBjbGFzc2lmeShwYXJzZWROYW1lLnR5cGUpOyB9CgogICAg
        cmV0dXJuIGRlc2NyaXB0aW9uOwogIH0sCgogIG1ha2VUb1N0cmluZzogZnVu
        Y3Rpb24oZmFjdG9yeSwgZnVsbE5hbWUpIHsKICAgIHJldHVybiBmYWN0b3J5
        LnRvU3RyaW5nKCk7CiAgfQp9KTsKCn0pKCk7CgoKCihmdW5jdGlvbigpIHsK
        LyoqCkBtb2R1bGUgZW1iZXIKQHN1Ym1vZHVsZSBlbWJlci1hcHBsaWNhdGlv
        bgoqLwoKdmFyIGdldCA9IEVtYmVyLmdldCwgc2V0ID0gRW1iZXIuc2V0OwoK
        ZnVuY3Rpb24gRGVwcmVjYXRlZENvbnRhaW5lcihjb250YWluZXIpIHsKICB0
        aGlzLl9jb250YWluZXIgPSBjb250YWluZXI7Cn0KCkRlcHJlY2F0ZWRDb250
        YWluZXIuZGVwcmVjYXRlID0gZnVuY3Rpb24obWV0aG9kKSB7CiAgcmV0dXJu
        IGZ1bmN0aW9uKCkgewogICAgdmFyIGNvbnRhaW5lciA9IHRoaXMuX2NvbnRh
        aW5lcjsKCiAgICBFbWJlci5kZXByZWNhdGUoJ1VzaW5nIHRoZSBkZWZhdWx0
        Q29udGFpbmVyIGlzIG5vIGxvbmdlciBzdXBwb3J0ZWQuIFtkZWZhdWx0Q29u
        dGFpbmVyIycgKyBtZXRob2QgKyAnXSBzZWU6IGh0dHA6Ly9naXQuaW8vRUtQ
        cG5BJywgZmFsc2UpOwogICAgcmV0dXJuIGNvbnRhaW5lclttZXRob2RdLmFw
        cGx5KGNvbnRhaW5lciwgYXJndW1lbnRzKTsKICB9Owp9OwoKRGVwcmVjYXRl
        ZENvbnRhaW5lci5wcm90b3R5cGUgPSB7CiAgX2NvbnRhaW5lcjogbnVsbCwK
        ICBsb29rdXA6IERlcHJlY2F0ZWRDb250YWluZXIuZGVwcmVjYXRlKCdsb29r
        dXAnKSwKICByZXNvbHZlOiBEZXByZWNhdGVkQ29udGFpbmVyLmRlcHJlY2F0
        ZSgncmVzb2x2ZScpLAogIHJlZ2lzdGVyOiBEZXByZWNhdGVkQ29udGFpbmVy
        LmRlcHJlY2F0ZSgncmVnaXN0ZXInKQp9OwoKLyoqCiAgQW4gaW5zdGFuY2Ug
        b2YgYEVtYmVyLkFwcGxpY2F0aW9uYCBpcyB0aGUgc3RhcnRpbmcgcG9pbnQg
        Zm9yIGV2ZXJ5IEVtYmVyCiAgYXBwbGljYXRpb24uIEl0IGhlbHBzIHRvIGlu
        c3RhbnRpYXRlLCBpbml0aWFsaXplIGFuZCBjb29yZGluYXRlIHRoZSBtYW55
        CiAgb2JqZWN0cyB0aGF0IG1ha2UgdXAgeW91ciBhcHAuCgogIEVhY2ggRW1i
        ZXIgYXBwIGhhcyBvbmUgYW5kIG9ubHkgb25lIGBFbWJlci5BcHBsaWNhdGlv
        bmAgb2JqZWN0LiBJbiBmYWN0LCB0aGUKICB2ZXJ5IGZpcnN0IHRoaW5nIHlv
        dSBzaG91bGQgZG8gaW4geW91ciBhcHBsaWNhdGlvbiBpcyBjcmVhdGUgdGhl
        IGluc3RhbmNlOgoKICBgYGBqYXZhc2NyaXB0CiAgd2luZG93LkFwcCA9IEVt
        YmVyLkFwcGxpY2F0aW9uLmNyZWF0ZSgpOwogIGBgYAoKICBUeXBpY2FsbHks
        IHRoZSBhcHBsaWNhdGlvbiBvYmplY3QgaXMgdGhlIG9ubHkgZ2xvYmFsIHZh
        cmlhYmxlLiBBbGwgb3RoZXIKICBjbGFzc2VzIGluIHlvdXIgYXBwIHNob3Vs
        ZCBiZSBwcm9wZXJ0aWVzIG9uIHRoZSBgRW1iZXIuQXBwbGljYXRpb25gIGlu
        c3RhbmNlLAogIHdoaWNoIGhpZ2hsaWdodHMgaXRzIGZpcnN0IHJvbGU6IGEg
        Z2xvYmFsIG5hbWVzcGFjZS4KCiAgRm9yIGV4YW1wbGUsIGlmIHlvdSBkZWZp
        bmUgYSB2aWV3IGNsYXNzLCBpdCBtaWdodCBsb29rIGxpa2UgdGhpczoKCiAg
        YGBgamF2YXNjcmlwdAogIEFwcC5NeVZpZXcgPSBFbWJlci5WaWV3LmV4dGVu
        ZCgpOwogIGBgYAoKICBCeSBkZWZhdWx0LCBjYWxsaW5nIGBFbWJlci5BcHBs
        aWNhdGlvbi5jcmVhdGUoKWAgd2lsbCBhdXRvbWF0aWNhbGx5IGluaXRpYWxp
        emUKICB5b3VyIGFwcGxpY2F0aW9uIGJ5IGNhbGxpbmcgdGhlIGBFbWJlci5B
        cHBsaWNhdGlvbi5pbml0aWFsaXplKClgIG1ldGhvZC4gSWYKICB5b3UgbmVl
        ZCB0byBkZWxheSBpbml0aWFsaXphdGlvbiwgeW91IGNhbiBjYWxsIHlvdXIg
        YXBwJ3MgYGRlZmVyUmVhZGluZXNzKClgCiAgbWV0aG9kLiBXaGVuIHlvdSBh
        cmUgcmVhZHkgZm9yIHlvdXIgYXBwIHRvIGJlIGluaXRpYWxpemVkLCBjYWxs
        IGl0cwogIGBhZHZhbmNlUmVhZGluZXNzKClgIG1ldGhvZC4KCiAgWW91IGNh
        biBkZWZpbmUgYSBgcmVhZHlgIG1ldGhvZCBvbiB0aGUgYEVtYmVyLkFwcGxp
        Y2F0aW9uYCBpbnN0YW5jZSwgd2hpY2gKICB3aWxsIGJlIHJ1biBieSBFbWJl
        ciB3aGVuIHRoZSBhcHBsaWNhdGlvbiBpcyBpbml0aWFsaXplZC4KCiAgQmVj
        YXVzZSBgRW1iZXIuQXBwbGljYXRpb25gIGluaGVyaXRzIGZyb20gYEVtYmVy
        Lk5hbWVzcGFjZWAsIGFueSBjbGFzc2VzCiAgeW91IGNyZWF0ZSB3aWxsIGhh
        dmUgdXNlZnVsIHN0cmluZyByZXByZXNlbnRhdGlvbnMgd2hlbiBjYWxsaW5n
        IGB0b1N0cmluZygpYC4KICBTZWUgdGhlIGBFbWJlci5OYW1lc3BhY2VgIGRv
        Y3VtZW50YXRpb24gZm9yIG1vcmUgaW5mb3JtYXRpb24uCgogIFdoaWxlIHlv
        dSBjYW4gdGhpbmsgb2YgeW91ciBgRW1iZXIuQXBwbGljYXRpb25gIGFzIGEg
        Y29udGFpbmVyIHRoYXQgaG9sZHMgdGhlCiAgb3RoZXIgY2xhc3NlcyBpbiB5
        b3VyIGFwcGxpY2F0aW9uLCB0aGVyZSBhcmUgc2V2ZXJhbCBvdGhlciByZXNw
        b25zaWJpbGl0aWVzCiAgZ29pbmcgb24gdW5kZXItdGhlLWhvb2QgdGhhdCB5
        b3UgbWF5IHdhbnQgdG8gdW5kZXJzdGFuZC4KCiAgIyMjIEV2ZW50IERlbGVn
        YXRpb24KCiAgRW1iZXIgdXNlcyBhIHRlY2huaXF1ZSBjYWxsZWQgX2V2ZW50
        IGRlbGVnYXRpb25fLiBUaGlzIGFsbG93cyB0aGUgZnJhbWV3b3JrCiAgdG8g
        c2V0IHVwIGEgZ2xvYmFsLCBzaGFyZWQgZXZlbnQgbGlzdGVuZXIgaW5zdGVh
        ZCBvZiByZXF1aXJpbmcgZWFjaCB2aWV3IHRvCiAgZG8gaXQgbWFudWFsbHku
        IEZvciBleGFtcGxlLCBpbnN0ZWFkIG9mIGVhY2ggdmlldyByZWdpc3Rlcmlu
        ZyBpdHMgb3duCiAgYG1vdXNlZG93bmAgbGlzdGVuZXIgb24gaXRzIGFzc29j
        aWF0ZWQgZWxlbWVudCwgRW1iZXIgc2V0cyB1cCBhIGBtb3VzZWRvd25gCiAg
        bGlzdGVuZXIgb24gdGhlIGBib2R5YC4KCiAgSWYgYSBgbW91c2Vkb3duYCBl
        dmVudCBvY2N1cnMsIEVtYmVyIHdpbGwgbG9vayBhdCB0aGUgdGFyZ2V0IG9m
        IHRoZSBldmVudCBhbmQKICBzdGFydCB3YWxraW5nIHVwIHRoZSBET00gbm9k
        ZSB0cmVlLCBmaW5kaW5nIGNvcnJlc3BvbmRpbmcgdmlld3MgYW5kIGludm9r
        aW5nCiAgdGhlaXIgYG1vdXNlRG93bmAgbWV0aG9kIGFzIGl0IGdvZXMuCgog
        IGBFbWJlci5BcHBsaWNhdGlvbmAgaGFzIGEgbnVtYmVyIG9mIGRlZmF1bHQg
        ZXZlbnRzIHRoYXQgaXQgbGlzdGVucyBmb3IsIGFzCiAgd2VsbCBhcyBhIG1h
        cHBpbmcgZnJvbSBsb3dlcmNhc2UgZXZlbnRzIHRvIGNhbWVsLWNhc2VkIHZp
        ZXcgbWV0aG9kIG5hbWVzLiBGb3IKICBleGFtcGxlLCB0aGUgYGtleXByZXNz
        YCBldmVudCBjYXVzZXMgdGhlIGBrZXlQcmVzc2AgbWV0aG9kIG9uIHRoZSB2
        aWV3IHRvIGJlCiAgY2FsbGVkLCB0aGUgYGRibGNsaWNrYCBldmVudCBjYXVz
        ZXMgYGRvdWJsZUNsaWNrYCB0byBiZSBjYWxsZWQsIGFuZCBzbyBvbi4KCiAg
        SWYgdGhlcmUgaXMgYSBidWJibGluZyBicm93c2VyIGV2ZW50IHRoYXQgRW1i
        ZXIgZG9lcyBub3QgbGlzdGVuIGZvciBieQogIGRlZmF1bHQsIHlvdSBjYW4g
        c3BlY2lmeSBjdXN0b20gZXZlbnRzIGFuZCB0aGVpciBjb3JyZXNwb25kaW5n
        IHZpZXcgbWV0aG9kCiAgbmFtZXMgYnkgc2V0dGluZyB0aGUgYXBwbGljYXRp
        b24ncyBgY3VzdG9tRXZlbnRzYCBwcm9wZXJ0eToKCiAgYGBgamF2YXNjcmlw
        dAogIEFwcCA9IEVtYmVyLkFwcGxpY2F0aW9uLmNyZWF0ZSh7CiAgICBjdXN0
        b21FdmVudHM6IHsKICAgICAgLy8gYWRkIHN1cHBvcnQgZm9yIHRoZSBwYXN0
        ZSBldmVudAogICAgICAncGFzdGU6ICJwYXN0ZSIKICAgIH0KICB9KTsKICBg
        YGAKCiAgQnkgZGVmYXVsdCwgdGhlIGFwcGxpY2F0aW9uIHNldHMgdXAgdGhl
        c2UgZXZlbnQgbGlzdGVuZXJzIG9uIHRoZSBkb2N1bWVudAogIGJvZHkuIEhv
        d2V2ZXIsIGluIGNhc2VzIHdoZXJlIHlvdSBhcmUgZW1iZWRkaW5nIGFuIEVt
        YmVyIGFwcGxpY2F0aW9uIGluc2lkZQogIGFuIGV4aXN0aW5nIHBhZ2UsIHlv
        dSBtYXkgd2FudCBpdCB0byBzZXQgdXAgdGhlIGxpc3RlbmVycyBvbiBhbiBl
        bGVtZW50CiAgaW5zaWRlIHRoZSBib2R5LgoKICBGb3IgZXhhbXBsZSwgaWYg
        b25seSBldmVudHMgaW5zaWRlIGEgRE9NIGVsZW1lbnQgd2l0aCB0aGUgSUQg
        b2YgYGVtYmVyLWFwcGAKICBzaG91bGQgYmUgZGVsZWdhdGVkLCBzZXQgeW91
        ciBhcHBsaWNhdGlvbidzIGByb290RWxlbWVudGAgcHJvcGVydHk6CgogIGBg
        YGphdmFzY3JpcHQKICB3aW5kb3cuQXBwID0gRW1iZXIuQXBwbGljYXRpb24u
        Y3JlYXRlKHsKICAgIHJvb3RFbGVtZW50OiAnI2VtYmVyLWFwcCcKICB9KTsK
        ICBgYGAKCiAgVGhlIGByb290RWxlbWVudGAgY2FuIGJlIGVpdGhlciBhIERP
        TSBlbGVtZW50IG9yIGEgalF1ZXJ5LWNvbXBhdGlibGUgc2VsZWN0b3IKICBz
        dHJpbmcuIE5vdGUgdGhhdCAqdmlld3MgYXBwZW5kZWQgdG8gdGhlIERPTSBv
        dXRzaWRlIHRoZSByb290IGVsZW1lbnQgd2lsbAogIG5vdCByZWNlaXZlIGV2
        ZW50cy4qIElmIHlvdSBzcGVjaWZ5IGEgY3VzdG9tIHJvb3QgZWxlbWVudCwg
        bWFrZSBzdXJlIHlvdSBvbmx5CiAgYXBwZW5kIHZpZXdzIGluc2lkZSBpdCEK
        CiAgVG8gbGVhcm4gbW9yZSBhYm91dCB0aGUgYWR2YW50YWdlcyBvZiBldmVu
        dCBkZWxlZ2F0aW9uIGFuZCB0aGUgRW1iZXIgdmlldwogIGxheWVyLCBhbmQg
        YSBsaXN0IG9mIHRoZSBldmVudCBsaXN0ZW5lcnMgdGhhdCBhcmUgc2V0dXAg
        YnkgZGVmYXVsdCwgdmlzaXQgdGhlCiAgW0VtYmVyIFZpZXcgTGF5ZXIgZ3Vp
        ZGVdKGh0dHA6Ly9lbWJlcmpzLmNvbS9ndWlkZXMvdW5kZXJzdGFuZGluZy1l
        bWJlci90aGUtdmlldy1sYXllci8jdG9jX2V2ZW50LWRlbGVnYXRpb24pLgoK
        ICAjIyMgSW5pdGlhbGl6ZXJzCgogIExpYnJhcmllcyBvbiB0b3Agb2YgRW1i
        ZXIgY2FuIHJlZ2lzdGVyIGFkZGl0aW9uYWwgaW5pdGlhbGl6ZXJzLCBsaWtl
        IHNvOgoKICBgYGBqYXZhc2NyaXB0CiAgRW1iZXIuQXBwbGljYXRpb24uaW5p
        dGlhbGl6ZXIoewogICAgbmFtZTogInN0b3JlIiwKCiAgICBpbml0aWFsaXpl
        OiBmdW5jdGlvbihjb250YWluZXIsIGFwcGxpY2F0aW9uKSB7CiAgICAgIGNv
        bnRhaW5lci5yZWdpc3Rlcignc3RvcmU6bWFpbicsIGFwcGxpY2F0aW9uLlN0
        b3JlKTsKICAgIH0KICB9KTsKICBgYGAKCiAgIyMjIFJvdXRpbmcKCiAgSW4g
        YWRkaXRpb24gdG8gY3JlYXRpbmcgeW91ciBhcHBsaWNhdGlvbidzIHJvdXRl
        ciwgYEVtYmVyLkFwcGxpY2F0aW9uYCBpcwogIGFsc28gcmVzcG9uc2libGUg
        Zm9yIHRlbGxpbmcgdGhlIHJvdXRlciB3aGVuIHRvIHN0YXJ0IHJvdXRpbmcu
        IFRyYW5zaXRpb25zCiAgYmV0d2VlbiByb3V0ZXMgY2FuIGJlIGxvZ2dlZCB3
        aXRoIHRoZSBgTE9HX1RSQU5TSVRJT05TYCBmbGFnLCBhbmQgbW9yZQogIGRl
        dGFpbGVkIGludHJhLXRyYW5zaXRpb24gbG9nZ2luZyBjYW4gYmUgbG9nZ2Vk
        IHdpdGgKICB0aGUgYExPR19UUkFOU0lUSU9OU19JTlRFUk5BTGAgZmxhZzoK
        CiAgYGBgamF2YXNjcmlwdAogIHdpbmRvdy5BcHAgPSBFbWJlci5BcHBsaWNh
        dGlvbi5jcmVhdGUoewogICAgTE9HX1RSQU5TSVRJT05TOiB0cnVlLCAvLyBi
        YXNpYyBsb2dnaW5nIG9mIHN1Y2Nlc3NmdWwgdHJhbnNpdGlvbnMKICAgIExP
        R19UUkFOU0lUSU9OU19JTlRFUk5BTDogdHJ1ZSAvLyBkZXRhaWxlZCBsb2dn
        aW5nIG9mIGFsbCByb3V0aW5nIHN0ZXBzCiAgfSk7CiAgYGBgCgogIEJ5IGRl
        ZmF1bHQsIHRoZSByb3V0ZXIgd2lsbCBiZWdpbiB0cnlpbmcgdG8gdHJhbnNs
        YXRlIHRoZSBjdXJyZW50IFVSTCBpbnRvCiAgYXBwbGljYXRpb24gc3RhdGUg
        b25jZSB0aGUgYnJvd3NlciBlbWl0cyB0aGUgYERPTUNvbnRlbnRSZWFkeWAg
        ZXZlbnQuIElmIHlvdQogIG5lZWQgdG8gZGVmZXIgcm91dGluZywgeW91IGNh
        biBjYWxsIHRoZSBhcHBsaWNhdGlvbidzIGBkZWZlclJlYWRpbmVzcygpYAog
        IG1ldGhvZC4gT25jZSByb3V0aW5nIGNhbiBiZWdpbiwgY2FsbCB0aGUgYGFk
        dmFuY2VSZWFkaW5lc3MoKWAgbWV0aG9kLgoKICBJZiB0aGVyZSBpcyBhbnkg
        c2V0dXAgcmVxdWlyZWQgYmVmb3JlIHJvdXRpbmcgYmVnaW5zLCB5b3UgY2Fu
        IGltcGxlbWVudCBhCiAgYHJlYWR5KClgIG1ldGhvZCBvbiB5b3VyIGFwcCB0
        aGF0IHdpbGwgYmUgaW52b2tlZCBpbW1lZGlhdGVseSBiZWZvcmUgcm91dGlu
        ZwogIGJlZ2lucy4KICBgYGAKCiAgQGNsYXNzIEFwcGxpY2F0aW9uCiAgQG5h
        bWVzcGFjZSBFbWJlcgogIEBleHRlbmRzIEVtYmVyLk5hbWVzcGFjZQoqLwoK
        dmFyIEFwcGxpY2F0aW9uID0gRW1iZXIuQXBwbGljYXRpb24gPSBFbWJlci5O
        YW1lc3BhY2UuZXh0ZW5kKEVtYmVyLkRlZmVycmVkTWl4aW4sIHsKCiAgLyoq
        CiAgICBUaGUgcm9vdCBET00gZWxlbWVudCBvZiB0aGUgQXBwbGljYXRpb24u
        IFRoaXMgY2FuIGJlIHNwZWNpZmllZCBhcyBhbgogICAgZWxlbWVudCBvciBh
        CiAgICBbalF1ZXJ5LWNvbXBhdGlibGUgc2VsZWN0b3Igc3RyaW5nXShodHRw
        Oi8vYXBpLmpxdWVyeS5jb20vY2F0ZWdvcnkvc2VsZWN0b3JzLykuCgogICAg
        VGhpcyBpcyB0aGUgZWxlbWVudCB0aGF0IHdpbGwgYmUgcGFzc2VkIHRvIHRo
        ZSBBcHBsaWNhdGlvbidzLAogICAgYGV2ZW50RGlzcGF0Y2hlcmAsIHdoaWNo
        IHNldHMgdXAgdGhlIGxpc3RlbmVycyBmb3IgZXZlbnQgZGVsZWdhdGlvbi4g
        RXZlcnkKICAgIHZpZXcgaW4geW91ciBhcHBsaWNhdGlvbiBzaG91bGQgYmUg
        YSBjaGlsZCBvZiB0aGUgZWxlbWVudCB5b3Ugc3BlY2lmeSBoZXJlLgoKICAg
        IEBwcm9wZXJ0eSByb290RWxlbWVudAogICAgQHR5cGUgRE9NRWxlbWVudAog
        ICAgQGRlZmF1bHQgJ2JvZHknCiAgKi8KICByb290RWxlbWVudDogJ2JvZHkn
        LAoKICAvKioKICAgIFRoZSBgRW1iZXIuRXZlbnREaXNwYXRjaGVyYCByZXNw
        b25zaWJsZSBmb3IgZGVsZWdhdGluZyBldmVudHMgdG8gdGhpcwogICAgYXBw
        bGljYXRpb24ncyB2aWV3cy4KCiAgICBUaGUgZXZlbnQgZGlzcGF0Y2hlciBp
        cyBjcmVhdGVkIGJ5IHRoZSBhcHBsaWNhdGlvbiBhdCBpbml0aWFsaXphdGlv
        biB0aW1lCiAgICBhbmQgc2V0cyB1cCBldmVudCBsaXN0ZW5lcnMgb24gdGhl
        IERPTSBlbGVtZW50IGRlc2NyaWJlZCBieSB0aGUKICAgIGFwcGxpY2F0aW9u
        J3MgYHJvb3RFbGVtZW50YCBwcm9wZXJ0eS4KCiAgICBTZWUgdGhlIGRvY3Vt
        ZW50YXRpb24gZm9yIGBFbWJlci5FdmVudERpc3BhdGNoZXJgIGZvciBtb3Jl
        IGluZm9ybWF0aW9uLgoKICAgIEBwcm9wZXJ0eSBldmVudERpc3BhdGNoZXIK
        ICAgIEB0eXBlIEVtYmVyLkV2ZW50RGlzcGF0Y2hlcgogICAgQGRlZmF1bHQg
        bnVsbAogICovCiAgZXZlbnREaXNwYXRjaGVyOiBudWxsLAoKICAvKioKICAg
        IFRoZSBET00gZXZlbnRzIGZvciB3aGljaCB0aGUgZXZlbnQgZGlzcGF0Y2hl
        ciBzaG91bGQgbGlzdGVuLgoKICAgIEJ5IGRlZmF1bHQsIHRoZSBhcHBsaWNh
        dGlvbidzIGBFbWJlci5FdmVudERpc3BhdGNoZXJgIGxpc3RlbnMKICAgIGZv
        ciBhIHNldCBvZiBzdGFuZGFyZCBET00gZXZlbnRzLCBzdWNoIGFzIGBtb3Vz
        ZWRvd25gIGFuZAogICAgYGtleXVwYCwgYW5kIGRlbGVnYXRlcyB0aGVtIHRv
        IHlvdXIgYXBwbGljYXRpb24ncyBgRW1iZXIuVmlld2AKICAgIGluc3RhbmNl
        cy4KCiAgICBJZiB5b3Ugd291bGQgbGlrZSBhZGRpdGlvbmFsIGJ1YmJsaW5n
        IGV2ZW50cyB0byBiZSBkZWxlZ2F0ZWQgdG8geW91cgogICAgdmlld3MsIHNl
        dCB5b3VyIGBFbWJlci5BcHBsaWNhdGlvbmAncyBgY3VzdG9tRXZlbnRzYCBw
        cm9wZXJ0eQogICAgdG8gYSBoYXNoIGNvbnRhaW5pbmcgdGhlIERPTSBldmVu
        dCBuYW1lIGFzIHRoZSBrZXkgYW5kIHRoZQogICAgY29ycmVzcG9uZGluZyB2
        aWV3IG1ldGhvZCBuYW1lIGFzIHRoZSB2YWx1ZS4gRm9yIGV4YW1wbGU6Cgog
        ICAgYGBgamF2YXNjcmlwdAogICAgQXBwID0gRW1iZXIuQXBwbGljYXRpb24u
        Y3JlYXRlKHsKICAgICAgY3VzdG9tRXZlbnRzOiB7CiAgICAgICAgLy8gYWRk
        IHN1cHBvcnQgZm9yIHRoZSBwYXN0ZSBldmVudAogICAgICAgICdwYXN0ZTog
        InBhc3RlIgogICAgICB9CiAgICB9KTsKICAgIGBgYAoKICAgIEBwcm9wZXJ0
        eSBjdXN0b21FdmVudHMKICAgIEB0eXBlIE9iamVjdAogICAgQGRlZmF1bHQg
        bnVsbAogICovCiAgY3VzdG9tRXZlbnRzOiBudWxsLAoKICAvLyBTdGFydCBv
        ZmYgdGhlIG51bWJlciBvZiBkZWZlcnJhbHMgYXQgMS4gVGhpcyB3aWxsIGJl
        CiAgLy8gZGVjcmVtZW50ZWQgYnkgdGhlIEFwcGxpY2F0aW9uJ3Mgb3duIGBp
        bml0aWFsaXplYCBtZXRob2QuCiAgX3JlYWRpbmVzc0RlZmVycmFsczogMSwK
        CiAgaW5pdDogZnVuY3Rpb24oKSB7CiAgICBpZiAoIXRoaXMuJCkgeyB0aGlz
        LiQgPSBFbWJlci4kOyB9CiAgICB0aGlzLl9fY29udGFpbmVyX18gPSB0aGlz
        LmJ1aWxkQ29udGFpbmVyKCk7CgogICAgdGhpcy5Sb3V0ZXIgPSB0aGlzLlJv
        dXRlciB8fCB0aGlzLmRlZmF1bHRSb3V0ZXIoKTsKICAgIGlmICh0aGlzLlJv
        dXRlcikgeyB0aGlzLlJvdXRlci5uYW1lc3BhY2UgPSB0aGlzOyB9CgogICAg
        dGhpcy5fc3VwZXIoKTsKCiAgICB0aGlzLnNjaGVkdWxlSW5pdGlhbGl6ZSgp
        OwoKICAgIEVtYmVyLmxpYnJhcmllcy5yZWdpc3RlckNvcmVMaWJyYXJ5KCdI
        YW5kbGViYXJzJywgRW1iZXIuSGFuZGxlYmFycy5WRVJTSU9OKTsKICAgIEVt
        YmVyLmxpYnJhcmllcy5yZWdpc3RlckNvcmVMaWJyYXJ5KCdqUXVlcnknLCBF
        bWJlci4kKCkuanF1ZXJ5KTsKCiAgICBpZiAoIEVtYmVyLkxPR19WRVJTSU9O
        ICkgewogICAgICBFbWJlci5MT0dfVkVSU0lPTiA9IGZhbHNlOyAvLyB3ZSBv
        bmx5IG5lZWQgdG8gc2VlIHRoaXMgb25jZSBwZXIgQXBwbGljYXRpb24jaW5p
        dAogICAgICB2YXIgbWF4TmFtZUxlbmd0aCA9IE1hdGgubWF4LmFwcGx5KHRo
        aXMsIEVtYmVyLkEoRW1iZXIubGlicmFyaWVzKS5tYXBCeSgibmFtZS5sZW5n
        dGgiKSk7CgogICAgICBFbWJlci5kZWJ1ZygnLS0tLS0tLS0tLS0tLS0tLS0t
        LS0tLS0tLS0tLS0tLScpOwogICAgICBFbWJlci5saWJyYXJpZXMuZWFjaChm
        dW5jdGlvbihuYW1lLCB2ZXJzaW9uKSB7CiAgICAgICAgdmFyIHNwYWNlcyA9
        IG5ldyBBcnJheShtYXhOYW1lTGVuZ3RoIC0gbmFtZS5sZW5ndGggKyAxKS5q
        b2luKCIgIik7CiAgICAgICAgRW1iZXIuZGVidWcoW25hbWUsIHNwYWNlcywg
        JyA6ICcsIHZlcnNpb25dLmpvaW4oIiIpKTsKICAgICAgfSk7CiAgICAgIEVt
        YmVyLmRlYnVnKCctLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tJyk7
        CiAgICB9CiAgfSwKCiAgLyoqCiAgICBAcHJpdmF0ZQoKICAgIEJ1aWxkIHRo
        ZSBjb250YWluZXIgZm9yIHRoZSBjdXJyZW50IGFwcGxpY2F0aW9uLgoKICAg
        IEFsc28gcmVnaXN0ZXIgYSBkZWZhdWx0IGFwcGxpY2F0aW9uIHZpZXcgaW4g
        Y2FzZSB0aGUgYXBwbGljYXRpb24KICAgIGl0c2VsZiBkb2VzIG5vdC4KCiAg
        ICBAbWV0aG9kIGJ1aWxkQ29udGFpbmVyCiAgICBAcmV0dXJuIHtFbWJlci5D
        b250YWluZXJ9IHRoZSBjb25maWd1cmVkIGNvbnRhaW5lcgogICovCiAgYnVp
        bGRDb250YWluZXI6IGZ1bmN0aW9uKCkgewogICAgdmFyIGNvbnRhaW5lciA9
        IHRoaXMuX19jb250YWluZXJfXyA9IEFwcGxpY2F0aW9uLmJ1aWxkQ29udGFp
        bmVyKHRoaXMpOwoKICAgIHJldHVybiBjb250YWluZXI7CiAgfSwKCiAgLyoq
        CiAgICBAcHJpdmF0ZQoKICAgIElmIHRoZSBhcHBsaWNhdGlvbiBoYXMgbm90
        IG9wdGVkIG91dCBvZiByb3V0aW5nIGFuZCBoYXMgbm90IGV4cGxpY2l0bHkK
        ICAgIGRlZmluZWQgYSByb3V0ZXIsIHN1cHBseSBhIGRlZmF1bHQgcm91dGVy
        IGZvciB0aGUgYXBwbGljYXRpb24gYXV0aG9yCiAgICB0byBjb25maWd1cmUu
        CgogICAgVGhpcyBhbGxvd3MgYXBwbGljYXRpb24gZGV2ZWxvcGVycyB0byBk
        bzoKCiAgICBgYGBqYXZhc2NyaXB0CiAgICB2YXIgQXBwID0gRW1iZXIuQXBw
        bGljYXRpb24uY3JlYXRlKCk7CgogICAgQXBwLlJvdXRlci5tYXAoZnVuY3Rp
        b24oKSB7CiAgICAgIHRoaXMucmVzb3VyY2UoJ3Bvc3RzJyk7CiAgICB9KTsK
        ICAgIGBgYAoKICAgIEBtZXRob2QgZGVmYXVsdFJvdXRlcgogICAgQHJldHVy
        biB7RW1iZXIuUm91dGVyfSB0aGUgZGVmYXVsdCByb3V0ZXIKICAqLwogIGRl
        ZmF1bHRSb3V0ZXI6IGZ1bmN0aW9uKCkgewogICAgLy8gQ3JlYXRlIGEgZGVm
        YXVsdCBBcHAuUm91dGVyIGlmIG9uZSB3YXMgbm90IHN1cHBsaWVkIHRvIG1h
        a2UKICAgIC8vIGl0IHBvc3NpYmxlIHRvIGRvIEFwcC5Sb3V0ZXIubWFwKC4u
        Likgd2l0aG91dCBleHBsaWNpdGx5CiAgICAvLyBjcmVhdGluZyBhIHJvdXRl
        ciBmaXJzdC4KICAgIGlmICh0aGlzLnJvdXRlciA9PT0gdW5kZWZpbmVkKSB7
        CiAgICAgIHJldHVybiBFbWJlci5Sb3V0ZXIuZXh0ZW5kKCk7CiAgICB9CiAg
        fSwKCiAgLyoqCiAgICBAcHJpdmF0ZQoKICAgIEF1dG9tYXRpY2FsbHkgaW5p
        dGlhbGl6ZSB0aGUgYXBwbGljYXRpb24gb25jZSB0aGUgRE9NIGhhcwogICAg
        YmVjb21lIHJlYWR5LgoKICAgIFRoZSBpbml0aWFsaXphdGlvbiBpdHNlbGYg
        aXMgc2NoZWR1bGVkIG9uIHRoZSBhY3Rpb25zIHF1ZXVlCiAgICB3aGljaCBl
        bnN1cmVzIHRoYXQgYXBwbGljYXRpb24gbG9hZGluZyBmaW5pc2hlcyBiZWZv
        cmUKICAgIGJvb3RpbmcuCgogICAgSWYgeW91IGFyZSBhc3luY2hyb25vdXNs
        eSBsb2FkaW5nIGNvZGUsIHlvdSBzaG91bGQgY2FsbAogICAgYGRlZmVyUmVh
        ZGluZXNzKClgIHRvIGRlZmVyIGJvb3RpbmcsIGFuZCB0aGVuIGNhbGwKICAg
        IGBhZHZhbmNlUmVhZGluZXNzKClgIG9uY2UgYWxsIG9mIHlvdXIgY29kZSBo
        YXMgZmluaXNoZWQKICAgIGxvYWRpbmcuCgogICAgQG1ldGhvZCBzY2hlZHVs
        ZUluaXRpYWxpemUKICAqLwogIHNjaGVkdWxlSW5pdGlhbGl6ZTogZnVuY3Rp
        b24oKSB7CiAgICB2YXIgc2VsZiA9IHRoaXM7CgogICAgaWYgKCF0aGlzLiQg
        fHwgdGhpcy4kLmlzUmVhZHkpIHsKICAgICAgRW1iZXIucnVuLnNjaGVkdWxl
        KCdhY3Rpb25zJywgc2VsZiwgJ19pbml0aWFsaXplJyk7CiAgICB9IGVsc2Ug
        ewogICAgICB0aGlzLiQoKS5yZWFkeShmdW5jdGlvbigpIHsKICAgICAgICBF
        bWJlci5ydW4oc2VsZiwgJ19pbml0aWFsaXplJyk7CiAgICAgIH0pOwogICAg
        fQogIH0sCgogIC8qKgogICAgVXNlIHRoaXMgdG8gZGVmZXIgcmVhZGluZXNz
        IHVudGlsIHNvbWUgY29uZGl0aW9uIGlzIHRydWUuCgogICAgRXhhbXBsZToK
        CiAgICBgYGBqYXZhc2NyaXB0CiAgICBBcHAgPSBFbWJlci5BcHBsaWNhdGlv
        bi5jcmVhdGUoKTsKICAgIEFwcC5kZWZlclJlYWRpbmVzcygpOwoKICAgIGpR
        dWVyeS5nZXRKU09OKCIvYXV0aC10b2tlbiIsIGZ1bmN0aW9uKHRva2VuKSB7
        CiAgICAgIEFwcC50b2tlbiA9IHRva2VuOwogICAgICBBcHAuYWR2YW5jZVJl
        YWRpbmVzcygpOwogICAgfSk7CiAgICBgYGAKCiAgICBUaGlzIGFsbG93cyB5
        b3UgdG8gcGVyZm9ybSBhc3luY2hyb25vdXMgc2V0dXAgbG9naWMgYW5kIGRl
        ZmVyCiAgICBib290aW5nIHlvdXIgYXBwbGljYXRpb24gdW50aWwgdGhlIHNl
        dHVwIGhhcyBmaW5pc2hlZC4KCiAgICBIb3dldmVyLCBpZiB0aGUgc2V0dXAg
        cmVxdWlyZXMgYSBsb2FkaW5nIFVJLCBpdCBtaWdodCBiZSBiZXR0ZXIKICAg
        IHRvIHVzZSB0aGUgcm91dGVyIGZvciB0aGlzIHB1cnBvc2UuCgogICAgQG1l
        dGhvZCBkZWZlclJlYWRpbmVzcwogICovCiAgZGVmZXJSZWFkaW5lc3M6IGZ1
        bmN0aW9uKCkgewogICAgRW1iZXIuYXNzZXJ0KCJZb3UgbXVzdCBjYWxsIGRl
        ZmVyUmVhZGluZXNzIG9uIGFuIGluc3RhbmNlIG9mIEVtYmVyLkFwcGxpY2F0
        aW9uIiwgdGhpcyBpbnN0YW5jZW9mIEVtYmVyLkFwcGxpY2F0aW9uKTsKICAg
        IEVtYmVyLmFzc2VydCgiWW91IGNhbm5vdCBkZWZlciByZWFkaW5lc3Mgc2lu
        Y2UgdGhlIGByZWFkeSgpYCBob29rIGhhcyBhbHJlYWR5IGJlZW4gY2FsbGVk
        LiIsIHRoaXMuX3JlYWRpbmVzc0RlZmVycmFscyA+IDApOwogICAgdGhpcy5f
        cmVhZGluZXNzRGVmZXJyYWxzKys7CiAgfSwKCiAgLyoqCiAgICBDYWxsIGBh
        ZHZhbmNlUmVhZGluZXNzYCBhZnRlciBhbnkgYXN5bmNocm9ub3VzIHNldHVw
        IGxvZ2ljIGhhcyBjb21wbGV0ZWQuCiAgICBFYWNoIGNhbGwgdG8gYGRlZmVy
        UmVhZGluZXNzYCBtdXN0IGJlIG1hdGNoZWQgYnkgYSBjYWxsIHRvIGBhZHZh
        bmNlUmVhZGluZXNzYAogICAgb3IgdGhlIGFwcGxpY2F0aW9uIHdpbGwgbmV2
        ZXIgYmVjb21lIHJlYWR5IGFuZCByb3V0aW5nIHdpbGwgbm90IGJlZ2luLgog
        ICAgCiAgICBAbWV0aG9kIGFkdmFuY2VSZWFkaW5lc3MKICAgIEBzZWUge0Vt
        YmVyLkFwcGxpY2F0aW9uI2RlZmVyUmVhZGluZXNzfQogICovCiAgYWR2YW5j
        ZVJlYWRpbmVzczogZnVuY3Rpb24oKSB7CiAgICBFbWJlci5hc3NlcnQoIllv
        dSBtdXN0IGNhbGwgYWR2YW5jZVJlYWRpbmVzcyBvbiBhbiBpbnN0YW5jZSBv
        ZiBFbWJlci5BcHBsaWNhdGlvbiIsIHRoaXMgaW5zdGFuY2VvZiBFbWJlci5B
        cHBsaWNhdGlvbik7CiAgICB0aGlzLl9yZWFkaW5lc3NEZWZlcnJhbHMtLTsK
        CiAgICBpZiAodGhpcy5fcmVhZGluZXNzRGVmZXJyYWxzID09PSAwKSB7CiAg
        ICAgIEVtYmVyLnJ1bi5vbmNlKHRoaXMsIHRoaXMuZGlkQmVjb21lUmVhZHkp
        OwogICAgfQogIH0sCgogIC8qKgogICAgcmVnaXN0ZXJzIGEgZmFjdG9yeSBm
        b3IgbGF0ZXIgaW5qZWN0aW9uCgogICAgRXhhbXBsZToKCiAgICBgYGBqYXZh
        c2NyaXB0CiAgICBBcHAgPSBFbWJlci5BcHBsaWNhdGlvbi5jcmVhdGUoKTsK
        CiAgICBBcHAuUGVyc29uICA9IEVtYmVyLk9iamVjdC5leHRlbmQoe30pOwog
        ICAgQXBwLk9yYW5nZSAgPSBFbWJlci5PYmplY3QuZXh0ZW5kKHt9KTsKICAg
        IEFwcC5FbWFpbCAgID0gRW1iZXIuT2JqZWN0LmV4dGVuZCh7fSk7CiAgICBB
        cHAuU2Vzc2lvbiA9IEVtYmVyLk9iamVjdC5jcmVhdGUoe30pOwoKICAgIEFw
        cC5yZWdpc3RlcignbW9kZWw6dXNlcicsIEFwcC5QZXJzb24sIHtzaW5nbGV0
        b246IGZhbHNlIH0pOwogICAgQXBwLnJlZ2lzdGVyKCdmcnVpdDpmYXZvcml0
        ZScsIEFwcC5PcmFuZ2UpOwogICAgQXBwLnJlZ2lzdGVyKCdjb21tdW5pY2F0
        aW9uOm1haW4nLCBBcHAuRW1haWwsIHtzaW5nbGV0b246IGZhbHNlfSk7CiAg
        ICBBcHAucmVnaXN0ZXIoJ3Nlc3Npb24nLCBBcHAuU2Vzc2lvbiwge2luc3Rh
        bnRpYXRlOiBmYWxzZX0pOwogICAgYGBgCgogICAgQG1ldGhvZCByZWdpc3Rl
        cgogICAgQHBhcmFtICBmdWxsTmFtZSB7U3RyaW5nfSB0eXBlOm5hbWUgKGUu
        Zy4sICdtb2RlbDp1c2VyJykKICAgIEBwYXJhbSAgZmFjdG9yeSB7RnVuY3Rp
        b259IChlLmcuLCBBcHAuUGVyc29uKQogICAgQHBhcmFtICBvcHRpb25zIHtT
        dHJpbmd9IChvcHRpb25hbCkKICAqKi8KICByZWdpc3RlcjogZnVuY3Rpb24o
        KSB7CiAgICB2YXIgY29udGFpbmVyID0gdGhpcy5fX2NvbnRhaW5lcl9fOwog
        ICAgY29udGFpbmVyLnJlZ2lzdGVyLmFwcGx5KGNvbnRhaW5lciwgYXJndW1l
        bnRzKTsKICB9LAogIC8qKgogICAgZGVmaW5lcyBhbiBpbmplY3Rpb24gb3Ig
        dHlwZUluamVjdGlvbgoKICAgIEV4YW1wbGU6CgogICAgYGBgamF2YXNjcmlw
        dAogICAgQXBwLmluamVjdCg8ZnVsbF9uYW1lIG9yIHR5cGU+LCA8cHJvcGVy
        dHkgbmFtZT4sIDxmdWxsX25hbWU+KQogICAgQXBwLmluamVjdCgnbW9kZWw6
        dXNlcicsICdlbWFpbCcsICdtb2RlbDplbWFpbCcpCiAgICBBcHAuaW5qZWN0
        KCdtb2RlbCcsICdzb3VyY2UnLCAnc291cmNlOm1haW4nKQogICAgYGBgCgog
        ICAgQG1ldGhvZCBpbmplY3QKICAgIEBwYXJhbSAgZmFjdG9yeU5hbWVPclR5
        cGUge1N0cmluZ30KICAgIEBwYXJhbSAgcHJvcGVydHkge1N0cmluZ30KICAg
        IEBwYXJhbSAgaW5qZWN0aW9uTmFtZSB7U3RyaW5nfQogICoqLwogIGluamVj
        dDogZnVuY3Rpb24oKSB7CiAgICB2YXIgY29udGFpbmVyID0gdGhpcy5fX2Nv
        bnRhaW5lcl9fOwogICAgY29udGFpbmVyLmluamVjdGlvbi5hcHBseShjb250
        YWluZXIsIGFyZ3VtZW50cyk7CiAgfSwKCiAgLyoqCiAgICBAcHJpdmF0ZQog
        ICAgQGRlcHJlY2F0ZWQKCiAgICBDYWxsaW5nIGluaXRpYWxpemUgbWFudWFs
        bHkgaXMgbm90IHN1cHBvcnRlZC4KCiAgICBQbGVhc2Ugc2VlIEVtYmVyLkFw
        cGxpY2F0aW9uI2FkdmFuY2VSZWFkaW5lc3MgYW5kCiAgICBFbWJlci5BcHBs
        aWNhdGlvbiNkZWZlclJlYWRpbmVzcy4KCiAgICBAbWV0aG9kIGluaXRpYWxp
        emUKICAgKiovCiAgaW5pdGlhbGl6ZTogZnVuY3Rpb24oKSB7CiAgICBFbWJl
        ci5kZXByZWNhdGUoJ0NhbGxpbmcgaW5pdGlhbGl6ZSBtYW51YWxseSBpcyBu
        b3Qgc3VwcG9ydGVkLiBQbGVhc2Ugc2VlIEVtYmVyLkFwcGxpY2F0aW9uI2Fk
        dmFuY2VSZWFkaW5lc3MgYW5kIEVtYmVyLkFwcGxpY2F0aW9uI2RlZmVyUmVh
        ZGluZXNzJyk7CiAgfSwKICAvKioKICAgIEBwcml2YXRlCgogICAgSW5pdGlh
        bGl6ZSB0aGUgYXBwbGljYXRpb24uIFRoaXMgaGFwcGVucyBhdXRvbWF0aWNh
        bGx5LgoKICAgIFJ1biBhbnkgaW5pdGlhbGl6ZXJzIGFuZCBydW4gdGhlIGFw
        cGxpY2F0aW9uIGxvYWQgaG9vay4gVGhlc2UgaG9va3MgbWF5CiAgICBjaG9v
        c2UgdG8gZGVmZXIgcmVhZGluZXNzLiBGb3IgZXhhbXBsZSwgYW4gYXV0aGVu
        dGljYXRpb24gaG9vayBtaWdodCB3YW50CiAgICB0byBkZWZlciByZWFkaW5l
        c3MgdW50aWwgdGhlIGF1dGggdG9rZW4gaGFzIGJlZW4gcmV0cmlldmVkLgoK
        ICAgIEBtZXRob2QgX2luaXRpYWxpemUKICAqLwogIF9pbml0aWFsaXplOiBm
        dW5jdGlvbigpIHsKICAgIGlmICh0aGlzLmlzRGVzdHJveWVkKSB7IHJldHVy
        bjsgfQoKICAgIC8vIEF0IHRoaXMgcG9pbnQsIHRoZSBBcHAuUm91dGVyIG11
        c3QgYWxyZWFkeSBiZSBhc3NpZ25lZAogICAgaWYgKHRoaXMuUm91dGVyKSB7
        CiAgICAgIHRoaXMucmVnaXN0ZXIoJ3JvdXRlcjptYWluJywgdGhpcy5Sb3V0
        ZXIpOwogICAgfQoKICAgIHRoaXMucnVuSW5pdGlhbGl6ZXJzKCk7CiAgICBF
        bWJlci5ydW5Mb2FkSG9va3MoJ2FwcGxpY2F0aW9uJywgdGhpcyk7CgogICAg
        Ly8gQXQgdGhpcyBwb2ludCwgYW55IGluaXRpYWxpemVycyBvciBsb2FkIGhv
        b2tzIHRoYXQgd291bGQgaGF2ZSB3YW50ZWQKICAgIC8vIHRvIGRlZmVyIHJl
        YWRpbmVzcyBoYXZlIGZpcmVkLiBJbiBnZW5lcmFsLCBhZHZhbmNpbmcgcmVh
        ZGluZXNzIGhlcmUKICAgIC8vIHdpbGwgcHJvY2VlZCB0byBkaWRCZWNvbWVS
        ZWFkeS4KICAgIHRoaXMuYWR2YW5jZVJlYWRpbmVzcygpOwoKICAgIHJldHVy
        biB0aGlzOwogIH0sCgogIC8qKgogICAgUmVzZXQgdGhlIGFwcGxpY2F0aW9u
        LiBUaGlzIGlzIHR5cGljYWxseSB1c2VkIG9ubHkgaW4gdGVzdHMuIEl0IGNs
        ZWFucyB1cAogICAgdGhlIGFwcGxpY2F0aW9uIGluIHRoZSBmb2xsb3dpbmcg
        b3JkZXI6CgogICAgMS4gRGVhY3RpdmF0ZSBleGlzdGluZyByb3V0ZXMKICAg
        IDIuIERlc3Ryb3kgYWxsIG9iamVjdHMgaW4gdGhlIGNvbnRhaW5lcgogICAg
        My4gQ3JlYXRlIGEgbmV3IGFwcGxpY2F0aW9uIGNvbnRhaW5lcgogICAgNC4g
        UmUtcm91dGUgdG8gdGhlIGV4aXN0aW5nIHVybAoKICAgIFR5cGljYWwgRXhh
        bXBsZToKCiAgICBgYGBqYXZhc2NyaXB0CgogICAgdmFyIEFwcDsKCiAgICBF
        bWJlci5ydW4oZnVuY3Rpb24oKSB7CiAgICAgIEFwcCA9IEVtYmVyLkFwcGxp
        Y2F0aW9uLmNyZWF0ZSgpOwogICAgfSk7CgogICAgbW9kdWxlKCJhY2NlcHRh
        bmNlIHRlc3QiLCB7CiAgICAgIHNldHVwOiBmdW5jdGlvbigpIHsKICAgICAg
        ICBBcHAucmVzZXQoKTsKICAgICAgfQogICAgfSk7CgogICAgdGVzdCgiZmly
        c3QgdGVzdCIsIGZ1bmN0aW9uKCkgewogICAgICAvLyBBcHAgaXMgZnJlc2hs
        eSByZXNldAogICAgfSk7CgogICAgdGVzdCgiZmlyc3QgdGVzdCIsIGZ1bmN0
        aW9uKCkgewogICAgICAvLyBBcHAgaXMgYWdhaW4gZnJlc2hseSByZXNldAog
        ICAgfSk7CiAgICBgYGAKCiAgICBBZHZhbmNlZCBFeGFtcGxlOgoKICAgIE9j
        Y2FzaW9uYWxseSB5b3UgbWF5IHdhbnQgdG8gcHJldmVudCB0aGUgYXBwIGZy
        b20gaW5pdGlhbGl6aW5nIGR1cmluZwogICAgc2V0dXAuIFRoaXMgY291bGQg
        ZW5hYmxlIGV4dHJhIGNvbmZpZ3VyYXRpb24sIG9yIGVuYWJsZSBhc3NlcnRp
        bmcgcHJpb3IKICAgIHRvIHRoZSBhcHAgYmVjb21pbmcgcmVhZHkuCgogICAg
        YGBgamF2YXNjcmlwdAoKICAgIHZhciBBcHA7CgogICAgRW1iZXIucnVuKGZ1
        bmN0aW9uKCkgewogICAgICBBcHAgPSBFbWJlci5BcHBsaWNhdGlvbi5jcmVh
        dGUoKTsKICAgIH0pOwoKICAgIG1vZHVsZSgiYWNjZXB0YW5jZSB0ZXN0Iiwg
        ewogICAgICBzZXR1cDogZnVuY3Rpb24oKSB7CiAgICAgICAgRW1iZXIucnVu
        KGZ1bmN0aW9uKCkgewogICAgICAgICAgQXBwLnJlc2V0KCk7CiAgICAgICAg
        ICBBcHAuZGVmZXJSZWFkaW5lc3MoKTsKICAgICAgICB9KTsKICAgICAgfQog
        ICAgfSk7CgogICAgdGVzdCgiZmlyc3QgdGVzdCIsIGZ1bmN0aW9uKCkgewog
        ICAgICBvayh0cnVlLCAnc29tZXRoaW5nIGJlZm9yZSBhcHAgaXMgaW5pdGlh
        bGl6ZWQnKTsKCiAgICAgIEVtYmVyLnJ1bihmdW5jdGlvbigpIHsKICAgICAg
        ICBBcHAuYWR2YW5jZVJlYWRpbmVzcygpOwogICAgICB9KTsKICAgICAgb2so
        dHJ1ZSwgJ3NvbWV0aGluZyBhZnRlciBhcHAgaXMgaW5pdGlhbGl6ZWQnKTsK
        ICAgIH0pOwogICAgYGBgCgogICAgQG1ldGhvZCByZXNldAogICoqLwogIHJl
        c2V0OiBmdW5jdGlvbigpIHsKICAgIHRoaXMuX3JlYWRpbmVzc0RlZmVycmFs
        cyA9IDE7CgogICAgZnVuY3Rpb24gaGFuZGxlUmVzZXQoKSB7CiAgICAgIHZh
        ciByb3V0ZXIgPSB0aGlzLl9fY29udGFpbmVyX18ubG9va3VwKCdyb3V0ZXI6
        bWFpbicpOwogICAgICByb3V0ZXIucmVzZXQoKTsKCiAgICAgIEVtYmVyLnJ1
        bih0aGlzLl9fY29udGFpbmVyX18sICdkZXN0cm95Jyk7CgogICAgICB0aGlz
        LmJ1aWxkQ29udGFpbmVyKCk7CgogICAgICBFbWJlci5ydW4uc2NoZWR1bGUo
        J2FjdGlvbnMnLCB0aGlzLCBmdW5jdGlvbigpIHsKICAgICAgICB0aGlzLl9p
        bml0aWFsaXplKCk7CiAgICAgIH0pOwogICAgfQoKICAgIEVtYmVyLnJ1bi5q
        b2luKHRoaXMsIGhhbmRsZVJlc2V0KTsKICB9LAoKICAvKioKICAgIEBwcml2
        YXRlCiAgICBAbWV0aG9kIHJ1bkluaXRpYWxpemVycwogICovCiAgcnVuSW5p
        dGlhbGl6ZXJzOiBmdW5jdGlvbigpIHsKICAgIHZhciBpbml0aWFsaXplcnMg
        PSBnZXQodGhpcy5jb25zdHJ1Y3RvciwgJ2luaXRpYWxpemVycycpLAogICAg
        ICAgIGNvbnRhaW5lciA9IHRoaXMuX19jb250YWluZXJfXywKICAgICAgICBn
        cmFwaCA9IG5ldyBFbWJlci5EQUcoKSwKICAgICAgICBuYW1lc3BhY2UgPSB0
        aGlzLAogICAgICAgIG5hbWUsIGluaXRpYWxpemVyOwoKICAgIGZvciAobmFt
        ZSBpbiBpbml0aWFsaXplcnMpIHsKICAgICAgaW5pdGlhbGl6ZXIgPSBpbml0
        aWFsaXplcnNbbmFtZV07CiAgICAgIGdyYXBoLmFkZEVkZ2VzKGluaXRpYWxp
        emVyLm5hbWUsIGluaXRpYWxpemVyLmluaXRpYWxpemUsIGluaXRpYWxpemVy
        LmJlZm9yZSwgaW5pdGlhbGl6ZXIuYWZ0ZXIpOwogICAgfQoKICAgIGdyYXBo
        LnRvcHNvcnQoZnVuY3Rpb24gKHZlcnRleCkgewogICAgICB2YXIgaW5pdGlh
        bGl6ZXIgPSB2ZXJ0ZXgudmFsdWU7CiAgICAgIEVtYmVyLmFzc2VydCgiTm8g
        YXBwbGljYXRpb24gaW5pdGlhbGl6ZXIgbmFtZWQgJyIrdmVydGV4Lm5hbWUr
        IiciLCBpbml0aWFsaXplcik7CiAgICAgIGluaXRpYWxpemVyKGNvbnRhaW5l
        ciwgbmFtZXNwYWNlKTsKICAgIH0pOwogIH0sCgogIC8qKgogICAgQHByaXZh
        dGUKICAgIEBtZXRob2QgZGlkQmVjb21lUmVhZHkKICAqLwogIGRpZEJlY29t
        ZVJlYWR5OiBmdW5jdGlvbigpIHsKICAgIHRoaXMuc2V0dXBFdmVudERpc3Bh
        dGNoZXIoKTsKICAgIHRoaXMucmVhZHkoKTsgLy8gdXNlciBob29rCiAgICB0
        aGlzLnN0YXJ0Um91dGluZygpOwoKICAgIGlmICghRW1iZXIudGVzdGluZykg
        ewogICAgICAvLyBFYWdlcmx5IG5hbWUgYWxsIGNsYXNzZXMgdGhhdCBhcmUg
        YWxyZWFkeSBsb2FkZWQKICAgICAgRW1iZXIuTmFtZXNwYWNlLnByb2Nlc3NB
        bGwoKTsKICAgICAgRW1iZXIuQk9PVEVEID0gdHJ1ZTsKICAgIH0KCiAgICB0
        aGlzLnJlc29sdmUodGhpcyk7CiAgfSwKCiAgLyoqCiAgICBAcHJpdmF0ZQoK
        ICAgIFNldHVwIHVwIHRoZSBldmVudCBkaXNwYXRjaGVyIHRvIHJlY2VpdmUg
        ZXZlbnRzIG9uIHRoZQogICAgYXBwbGljYXRpb24ncyBgcm9vdEVsZW1lbnRg
        IHdpdGggYW55IHJlZ2lzdGVyZWQKICAgIGBjdXN0b21FdmVudHNgLgoKICAg
        IEBtZXRob2Qgc2V0dXBFdmVudERpc3BhdGNoZXIKICAqLwogIHNldHVwRXZl
        bnREaXNwYXRjaGVyOiBmdW5jdGlvbigpIHsKICAgIHZhciBjdXN0b21FdmVu
        dHMgPSBnZXQodGhpcywgJ2N1c3RvbUV2ZW50cycpLAogICAgICAgIHJvb3RF
        bGVtZW50ID0gZ2V0KHRoaXMsICdyb290RWxlbWVudCcpLAogICAgICAgIGRp
        c3BhdGNoZXIgPSB0aGlzLl9fY29udGFpbmVyX18ubG9va3VwKCdldmVudF9k
        aXNwYXRjaGVyOm1haW4nKTsKCiAgICBzZXQodGhpcywgJ2V2ZW50RGlzcGF0
        Y2hlcicsIGRpc3BhdGNoZXIpOwogICAgZGlzcGF0Y2hlci5zZXR1cChjdXN0
        b21FdmVudHMsIHJvb3RFbGVtZW50KTsKICB9LAoKICAvKioKICAgIEBwcml2
        YXRlCgogICAgdHJpZ2dlciBhIG5ldyBjYWxsIHRvIGByb3V0ZWAgd2hlbmV2
        ZXIgdGhlIFVSTCBjaGFuZ2VzLgogICAgSWYgdGhlIGFwcGxpY2F0aW9uIGhh
        cyBhIHJvdXRlciwgdXNlIGl0IHRvIHJvdXRlIHRvIHRoZSBjdXJyZW50IFVS
        TCwgYW5kCgogICAgQG1ldGhvZCBzdGFydFJvdXRpbmcKICAgIEBwcm9wZXJ0
        eSByb3V0ZXIge0VtYmVyLlJvdXRlcn0KICAqLwogIHN0YXJ0Um91dGluZzog
        ZnVuY3Rpb24oKSB7CiAgICB2YXIgcm91dGVyID0gdGhpcy5fX2NvbnRhaW5l
        cl9fLmxvb2t1cCgncm91dGVyOm1haW4nKTsKICAgIGlmICghcm91dGVyKSB7
        IHJldHVybjsgfQoKICAgIHJvdXRlci5zdGFydFJvdXRpbmcoKTsKICB9LAoK
        ICBoYW5kbGVVUkw6IGZ1bmN0aW9uKHVybCkgewogICAgdmFyIHJvdXRlciA9
        IHRoaXMuX19jb250YWluZXJfXy5sb29rdXAoJ3JvdXRlcjptYWluJyk7Cgog
        ICAgcm91dGVyLmhhbmRsZVVSTCh1cmwpOwogIH0sCgogIC8qKgogICAgQ2Fs
        bGVkIHdoZW4gdGhlIEFwcGxpY2F0aW9uIGhhcyBiZWNvbWUgcmVhZHkuCiAg
        ICBUaGUgY2FsbCB3aWxsIGJlIGRlbGF5ZWQgdW50aWwgdGhlIERPTSBoYXMg
        YmVjb21lIHJlYWR5LgoKICAgIEBldmVudCByZWFkeQogICovCiAgcmVhZHk6
        IEVtYmVyLkssCgogIC8qKgogICAgQGRlcHJlY2F0ZWQgVXNlICdSZXNvbHZl
        cicgaW5zdGVhZAogICAgU2V0IHRoaXMgdG8gcHJvdmlkZSBhbiBhbHRlcm5h
        dGUgY2xhc3MgdG8gYEVtYmVyLkRlZmF1bHRSZXNvbHZlcmAKCgogICAgQHBy
        b3BlcnR5IHJlc29sdmVyCiAgKi8KICByZXNvbHZlcjogbnVsbCwKCiAgLyoq
        CiAgICBTZXQgdGhpcyB0byBwcm92aWRlIGFuIGFsdGVybmF0ZSBjbGFzcyB0
        byBgRW1iZXIuRGVmYXVsdFJlc29sdmVyYAoKICAgIEBwcm9wZXJ0eSByZXNv
        bHZlcgogICovCiAgUmVzb2x2ZXI6IG51bGwsCgogIHdpbGxEZXN0cm95OiBm
        dW5jdGlvbigpIHsKICAgIEVtYmVyLkJPT1RFRCA9IGZhbHNlOwoKICAgIHRo
        aXMuX19jb250YWluZXJfXy5kZXN0cm95KCk7CiAgfSwKCiAgaW5pdGlhbGl6
        ZXI6IGZ1bmN0aW9uKG9wdGlvbnMpIHsKICAgIHRoaXMuY29uc3RydWN0b3Iu
        aW5pdGlhbGl6ZXIob3B0aW9ucyk7CiAgfQp9KTsKCkVtYmVyLkFwcGxpY2F0
        aW9uLnJlb3BlbkNsYXNzKHsKICBpbml0aWFsaXplcnM6IHt9LAogIGluaXRp
        YWxpemVyOiBmdW5jdGlvbihpbml0aWFsaXplcikgewogICAgLy8gSWYgdGhp
        cyBpcyB0aGUgZmlyc3QgaW5pdGlhbGl6ZXIgYmVpbmcgYWRkZWQgdG8gYSBz
        dWJjbGFzcywgd2UgYXJlIGdvaW5nIHRvIHJlb3BlbiB0aGUgY2xhc3MKICAg
        IC8vIHRvIG1ha2Ugc3VyZSB3ZSBoYXZlIGEgbmV3IGBpbml0aWFsaXplcnNg
        IG9iamVjdCwgd2hpY2ggZXh0ZW5kcyBmcm9tIHRoZSBwYXJlbnQgY2xhc3Mn
        IHVzaW5nCiAgICAvLyBwcm90b3R5cGFsIGluaGVyaXRhbmNlLiBXaXRob3V0
        IHRoaXMsIGF0dGVtcHRpbmcgdG8gYWRkIGluaXRpYWxpemVycyB0byB0aGUg
        c3ViY2xhc3Mgd291bGQKICAgIC8vIHBvbGx1dGUgdGhlIHBhcmVudCBjbGFz
        cyBhcyB3ZWxsIGFzIG90aGVyIHN1YmNsYXNzZXMuCiAgICBpZiAodGhpcy5z
        dXBlcmNsYXNzLmluaXRpYWxpemVycyAhPT0gdW5kZWZpbmVkICYmIHRoaXMu
        c3VwZXJjbGFzcy5pbml0aWFsaXplcnMgPT09IHRoaXMuaW5pdGlhbGl6ZXJz
        KSB7CiAgICAgIHRoaXMucmVvcGVuQ2xhc3MoewogICAgICAgIGluaXRpYWxp
        emVyczogRW1iZXIuY3JlYXRlKHRoaXMuaW5pdGlhbGl6ZXJzKQogICAgICB9
        KTsKICAgIH0KCiAgICBFbWJlci5hc3NlcnQoIlRoZSBpbml0aWFsaXplciAn
        IiArIGluaXRpYWxpemVyLm5hbWUgKyAiJyBoYXMgYWxyZWFkeSBiZWVuIHJl
        Z2lzdGVyZWQiLCAhdGhpcy5pbml0aWFsaXplcnNbaW5pdGlhbGl6ZXIubmFt
        ZV0pOwogICAgRW1iZXIuYXNzZXJ0KCJBbiBpbml0aWFsaXplciBjYW5ub3Qg
        YmUgcmVnaXN0ZXJlZCB3aXRoIGJvdGggYSBiZWZvcmUgYW5kIGFuIGFmdGVy
        IiwgIShpbml0aWFsaXplci5iZWZvcmUgJiYgaW5pdGlhbGl6ZXIuYWZ0ZXIp
        KTsKICAgIEVtYmVyLmFzc2VydCgiQW4gaW5pdGlhbGl6ZXIgY2Fubm90IGJl
        IHJlZ2lzdGVyZWQgd2l0aG91dCBhbiBpbml0aWFsaXplIGZ1bmN0aW9uIiwg
        RW1iZXIuY2FuSW52b2tlKGluaXRpYWxpemVyLCAnaW5pdGlhbGl6ZScpKTsK
        CiAgICB0aGlzLmluaXRpYWxpemVyc1tpbml0aWFsaXplci5uYW1lXSA9IGlu
        aXRpYWxpemVyOwogIH0sCgogIC8qKgogICAgQHByaXZhdGUKCiAgICBUaGlz
        IGNyZWF0ZXMgYSBjb250YWluZXIgd2l0aCB0aGUgZGVmYXVsdCBFbWJlciBu
        YW1pbmcgY29udmVudGlvbnMuCgogICAgSXQgYWxzbyBjb25maWd1cmVzIHRo
        ZSBjb250YWluZXI6CgogICAgKiByZWdpc3RlcmVkIHZpZXdzIGFyZSBjcmVh
        dGVkIGV2ZXJ5IHRpbWUgdGhleSBhcmUgbG9va2VkIHVwICh0aGV5IGFyZQog
        ICAgICBub3Qgc2luZ2xldG9ucykKICAgICogcmVnaXN0ZXJlZCB0ZW1wbGF0
        ZXMgYXJlIG5vdCBmYWN0b3JpZXM7IHRoZSByZWdpc3RlcmVkIHZhbHVlIGlz
        CiAgICAgIHJldHVybmVkIGRpcmVjdGx5LgogICAgKiB0aGUgcm91dGVyIHJl
        Y2VpdmVzIHRoZSBhcHBsaWNhdGlvbiBhcyBpdHMgYG5hbWVzcGFjZWAgcHJv
        cGVydHkKICAgICogYWxsIGNvbnRyb2xsZXJzIHJlY2VpdmUgdGhlIHJvdXRl
        ciBhcyB0aGVpciBgdGFyZ2V0YCBhbmQgYGNvbnRyb2xsZXJzYAogICAgICBw
        cm9wZXJ0aWVzCiAgICAqIGFsbCBjb250cm9sbGVycyByZWNlaXZlIHRoZSBh
        cHBsaWNhdGlvbiBhcyB0aGVpciBgbmFtZXNwYWNlYCBwcm9wZXJ0eQogICAg
        KiB0aGUgYXBwbGljYXRpb24gdmlldyByZWNlaXZlcyB0aGUgYXBwbGljYXRp
        b24gY29udHJvbGxlciBhcyBpdHMKICAgICAgYGNvbnRyb2xsZXJgIHByb3Bl
        cnR5CiAgICAqIHRoZSBhcHBsaWNhdGlvbiB2aWV3IHJlY2VpdmVzIHRoZSBh
        cHBsaWNhdGlvbiB0ZW1wbGF0ZSBhcyBpdHMKICAgICAgYGRlZmF1bHRUZW1w
        bGF0ZWAgcHJvcGVydHkKCiAgICBAbWV0aG9kIGJ1aWxkQ29udGFpbmVyCiAg
        ICBAc3RhdGljCiAgICBAcGFyYW0ge0VtYmVyLkFwcGxpY2F0aW9ufSBuYW1l
        c3BhY2UgdGhlIGFwcGxpY2F0aW9uIHRvIGJ1aWxkIHRoZQogICAgICBjb250
        YWluZXIgZm9yLgogICAgQHJldHVybiB7RW1iZXIuQ29udGFpbmVyfSB0aGUg
        YnVpbHQgY29udGFpbmVyCiAgKi8KICBidWlsZENvbnRhaW5lcjogZnVuY3Rp
        b24obmFtZXNwYWNlKSB7CiAgICB2YXIgY29udGFpbmVyID0gbmV3IEVtYmVy
        LkNvbnRhaW5lcigpOwoKICAgIEVtYmVyLkNvbnRhaW5lci5kZWZhdWx0Q29u
        dGFpbmVyID0gbmV3IERlcHJlY2F0ZWRDb250YWluZXIoY29udGFpbmVyKTsK
        CiAgICBjb250YWluZXIuc2V0ID0gRW1iZXIuc2V0OwogICAgY29udGFpbmVy
        LnJlc29sdmVyICA9IHJlc29sdmVyRm9yKG5hbWVzcGFjZSk7CiAgICBjb250
        YWluZXIubm9ybWFsaXplID0gY29udGFpbmVyLnJlc29sdmVyLm5vcm1hbGl6
        ZTsKICAgIGNvbnRhaW5lci5kZXNjcmliZSAgPSBjb250YWluZXIucmVzb2x2
        ZXIuZGVzY3JpYmU7CiAgICBjb250YWluZXIubWFrZVRvU3RyaW5nID0gY29u
        dGFpbmVyLnJlc29sdmVyLm1ha2VUb1N0cmluZzsKCiAgICBjb250YWluZXIu
        b3B0aW9uc0ZvclR5cGUoJ2NvbXBvbmVudCcsIHsgc2luZ2xldG9uOiBmYWxz
        ZSB9KTsKICAgIGNvbnRhaW5lci5vcHRpb25zRm9yVHlwZSgndmlldycsIHsg
        c2luZ2xldG9uOiBmYWxzZSB9KTsKICAgIGNvbnRhaW5lci5vcHRpb25zRm9y
        VHlwZSgndGVtcGxhdGUnLCB7IGluc3RhbnRpYXRlOiBmYWxzZSB9KTsKICAg
        IGNvbnRhaW5lci5yZWdpc3RlcignYXBwbGljYXRpb246bWFpbicsIG5hbWVz
        cGFjZSwgeyBpbnN0YW50aWF0ZTogZmFsc2UgfSk7CgogICAgY29udGFpbmVy
        LnJlZ2lzdGVyKCdjb250cm9sbGVyOmJhc2ljJywgRW1iZXIuQ29udHJvbGxl
        ciwgeyBpbnN0YW50aWF0ZTogZmFsc2UgfSk7CiAgICBjb250YWluZXIucmVn
        aXN0ZXIoJ2NvbnRyb2xsZXI6b2JqZWN0JywgRW1iZXIuT2JqZWN0Q29udHJv
        bGxlciwgeyBpbnN0YW50aWF0ZTogZmFsc2UgfSk7CiAgICBjb250YWluZXIu
        cmVnaXN0ZXIoJ2NvbnRyb2xsZXI6YXJyYXknLCBFbWJlci5BcnJheUNvbnRy
        b2xsZXIsIHsgaW5zdGFudGlhdGU6IGZhbHNlIH0pOwogICAgY29udGFpbmVy
        LnJlZ2lzdGVyKCdyb3V0ZTpiYXNpYycsIEVtYmVyLlJvdXRlLCB7IGluc3Rh
        bnRpYXRlOiBmYWxzZSB9KTsKICAgIGNvbnRhaW5lci5yZWdpc3RlcignZXZl
        bnRfZGlzcGF0Y2hlcjptYWluJywgRW1iZXIuRXZlbnREaXNwYXRjaGVyKTsK
        CiAgICBjb250YWluZXIuaW5qZWN0aW9uKCdyb3V0ZXI6bWFpbicsICduYW1l
        c3BhY2UnLCAnYXBwbGljYXRpb246bWFpbicpOwoKICAgIGNvbnRhaW5lci5p
        bmplY3Rpb24oJ2NvbnRyb2xsZXInLCAndGFyZ2V0JywgJ3JvdXRlcjptYWlu
        Jyk7CiAgICBjb250YWluZXIuaW5qZWN0aW9uKCdjb250cm9sbGVyJywgJ25h
        bWVzcGFjZScsICdhcHBsaWNhdGlvbjptYWluJyk7CgogICAgY29udGFpbmVy
        LmluamVjdGlvbigncm91dGUnLCAncm91dGVyJywgJ3JvdXRlcjptYWluJyk7
        CgogICAgcmV0dXJuIGNvbnRhaW5lcjsKICB9Cn0pOwoKLyoqCiAgQHByaXZh
        dGUKCiAgVGhpcyBmdW5jdGlvbiBkZWZpbmVzIHRoZSBkZWZhdWx0IGxvb2t1
        cCBydWxlcyBmb3IgY29udGFpbmVyIGxvb2t1cHM6CgogICogdGVtcGxhdGVz
        IGFyZSBsb29rZWQgdXAgb24gYEVtYmVyLlRFTVBMQVRFU2AKICAqIG90aGVy
        IG5hbWVzIGFyZSBsb29rZWQgdXAgb24gdGhlIGFwcGxpY2F0aW9uIGFmdGVy
        IGNsYXNzaWZ5aW5nIHRoZSBuYW1lLgogICAgRm9yIGV4YW1wbGUsIGBjb250
        cm9sbGVyOnBvc3RgIGxvb2tzIHVwIGBBcHAuUG9zdENvbnRyb2xsZXJgIGJ5
        IGRlZmF1bHQuCiAgKiBpZiB0aGUgZGVmYXVsdCBsb29rdXAgZmFpbHMsIGxv
        b2sgZm9yIHJlZ2lzdGVyZWQgY2xhc3NlcyBvbiB0aGUgY29udGFpbmVyCgog
        IFRoaXMgYWxsb3dzIHRoZSBhcHBsaWNhdGlvbiB0byByZWdpc3RlciBkZWZh
        dWx0IGluamVjdGlvbnMgaW4gdGhlIGNvbnRhaW5lcgogIHRoYXQgY291bGQg
        YmUgb3ZlcnJpZGRlbiBieSB0aGUgbm9ybWFsIG5hbWluZyBjb252ZW50aW9u
        LgoKICBAbWV0aG9kIHJlc29sdmVyRm9yCiAgQHBhcmFtIHtFbWJlci5OYW1l
        c3BhY2V9IG5hbWVzcGFjZSB0aGUgbmFtZXNwYWNlIHRvIGxvb2sgZm9yIGNs
        YXNzZXMKICBAcmV0dXJuIHsqfSB0aGUgcmVzb2x2ZWQgdmFsdWUgZm9yIGEg
        Z2l2ZW4gbG9va3VwCiovCmZ1bmN0aW9uIHJlc29sdmVyRm9yKG5hbWVzcGFj
        ZSkgewogIGlmIChuYW1lc3BhY2UuZ2V0KCdyZXNvbHZlcicpKSB7CiAgICBF
        bWJlci5kZXByZWNhdGUoJ0FwcGxpY2F0aW9uLnJlc29sdmVyIGlzIGRlcHJl
        Y2F0ZWQgaW4gZmF2b3Igb2YgQXBwbGljYXRpb24uUmVzb2x2ZXInLCBmYWxz
        ZSk7CiAgfQoKICB2YXIgUmVzb2x2ZXJDbGFzcyA9IG5hbWVzcGFjZS5nZXQo
        J3Jlc29sdmVyJykgfHwgbmFtZXNwYWNlLmdldCgnUmVzb2x2ZXInKSB8fCBF
        bWJlci5EZWZhdWx0UmVzb2x2ZXI7CiAgdmFyIHJlc29sdmVyID0gUmVzb2x2
        ZXJDbGFzcy5jcmVhdGUoewogICAgbmFtZXNwYWNlOiBuYW1lc3BhY2UKICB9
        KTsKCiAgZnVuY3Rpb24gcmVzb2x2ZShmdWxsTmFtZSkgewogICAgcmV0dXJu
        IHJlc29sdmVyLnJlc29sdmUoZnVsbE5hbWUpOwogIH0KCiAgcmVzb2x2ZS5k
        ZXNjcmliZSA9IGZ1bmN0aW9uKGZ1bGxOYW1lKSB7CiAgICByZXR1cm4gcmVz
        b2x2ZXIubG9va3VwRGVzY3JpcHRpb24oZnVsbE5hbWUpOwogIH07CgogIHJl
        c29sdmUubWFrZVRvU3RyaW5nID0gZnVuY3Rpb24oZmFjdG9yeSwgZnVsbE5h
        bWUpIHsKICAgIHJldHVybiByZXNvbHZlci5tYWtlVG9TdHJpbmcoZmFjdG9y
        eSwgZnVsbE5hbWUpOwogIH07CgogIHJlc29sdmUubm9ybWFsaXplID0gZnVu
        Y3Rpb24oZnVsbE5hbWUpIHsKICAgIGlmIChyZXNvbHZlci5ub3JtYWxpemUp
        IHsKICAgICAgcmV0dXJuIHJlc29sdmVyLm5vcm1hbGl6ZShmdWxsTmFtZSk7
        CiAgICB9IGVsc2UgewogICAgICBFbWJlci5kZXByZWNhdGUoJ1RoZSBSZXNv
        bHZlciBzaG91bGQgbm93IHByb3ZpZGUgYSBcJ25vcm1hbGl6ZVwnIGZ1bmN0
        aW9uJywgZmFsc2UpOwogICAgICByZXR1cm4gZnVsbE5hbWU7CiAgICB9CiAg
        fTsKCiAgcmV0dXJuIHJlc29sdmU7Cn0KCkVtYmVyLnJ1bkxvYWRIb29rcygn
        RW1iZXIuQXBwbGljYXRpb24nLCBFbWJlci5BcHBsaWNhdGlvbik7Cgp9KSgp
        OwoKCgooZnVuY3Rpb24oKSB7Cgp9KSgpOwoKCgooZnVuY3Rpb24oKSB7Ci8q
        KgpAbW9kdWxlIGVtYmVyCkBzdWJtb2R1bGUgZW1iZXItYXBwbGljYXRpb24K
        Ki8KCnZhciBnZXQgPSBFbWJlci5nZXQsIHNldCA9IEVtYmVyLnNldDsKCmZ1
        bmN0aW9uIHZlcmlmeU5lZWRzRGVwZW5kZW5jaWVzKGNvbnRyb2xsZXIsIGNv
        bnRhaW5lciwgbmVlZHMpIHsKICB2YXIgZGVwZW5kZW5jeSwgaSwgbDsKCiAg
        Zm9yIChpPTAsIGw9bmVlZHMubGVuZ3RoOyBpPGw7IGkrKykgewogICAgZGVw
        ZW5kZW5jeSA9IG5lZWRzW2ldOwogICAgaWYgKGRlcGVuZGVuY3kuaW5kZXhP
        ZignOicpID09PSAtMSkgewogICAgICBkZXBlbmRlbmN5ID0gImNvbnRyb2xs
        ZXI6IiArIGRlcGVuZGVuY3k7CiAgICB9CgogICAgLy8gU3RydWN0dXJlIGFz
        c2VydCB0byBzdGlsbCBkbyB2ZXJpZmljYXRpb24gYnV0IG5vdCBzdHJpbmcg
        Y29uY2F0IGluIHByb2R1Y3Rpb24KICAgIGlmICghY29udGFpbmVyLmhhcyhk
        ZXBlbmRlbmN5KSkgewogICAgICBFbWJlci5hc3NlcnQoRW1iZXIuaW5zcGVj
        dChjb250cm9sbGVyKSArICIgbmVlZHMgIiArIGRlcGVuZGVuY3kgKyAiIGJ1
        dCBpdCBkb2VzIG5vdCBleGlzdCIsIGZhbHNlKTsKICAgIH0KICB9Cn0KCi8q
        KgogIEBjbGFzcyBDb250cm9sbGVyTWl4aW4KICBAbmFtZXNwYWNlIEVtYmVy
        CiovCkVtYmVyLkNvbnRyb2xsZXJNaXhpbi5yZW9wZW4oewogIGNvbmNhdGVu
        YXRlZFByb3BlcnRpZXM6IFsnbmVlZHMnXSwKCiAgLyoqCiAgICBBbiBhcnJh
        eSBvZiBvdGhlciBjb250cm9sbGVyIG9iamVjdHMgYXZhaWxhYmxlIGluc2lk
        ZQogICAgaW5zdGFuY2VzIG9mIHRoaXMgY29udHJvbGxlciB2aWEgdGhlIGBj
        b250cm9sbGVyc2AKICAgIHByb3BlcnR5OgoKICAgIEZvciBleGFtcGxlLCB3
        aGVuIHlvdSBkZWZpbmUgYSBjb250cm9sbGVyOgoKICAgIGBgYGphdmFzY3Jp
        cHQKICAgIEFwcC5Db21tZW50c0NvbnRyb2xsZXIgPSBFbWJlci5BcnJheUNv
        bnRyb2xsZXIuZXh0ZW5kKHsKICAgICAgbmVlZHM6IFsncG9zdCddCiAgICB9
        KTsKICAgIGBgYAoKICAgIFRoZSBhcHBsaWNhdGlvbidzIHNpbmdsZSBpbnN0
        YW5jZSBvZiB0aGVzZSBvdGhlcgogICAgY29udHJvbGxlcnMgYXJlIGFjY2Vz
        c2libGUgYnkgbmFtZSB0aHJvdWdoIHRoZQogICAgYGNvbnRyb2xsZXJzYCBw
        cm9wZXJ0eToKCiAgICBgYGBqYXZhc2NyaXB0CiAgICB0aGlzLmdldCgnY29u
        dHJvbGxlcnMucG9zdCcpOyAvLyBpbnN0YW5jZSBvZiBBcHAuUG9zdENvbnRy
        b2xsZXIKICAgIGBgYAoKICAgIFRoaXMgaXMgb25seSBhdmFpbGFibGUgZm9y
        IHNpbmdsZXRvbiBjb250cm9sbGVycy4KCiAgICBAcHJvcGVydHkge0FycmF5
        fSBuZWVkcwogICAgQGRlZmF1bHQgW10KICAqLwogIG5lZWRzOiBbXSwKCiAg
        aW5pdDogZnVuY3Rpb24oKSB7CiAgICB2YXIgbmVlZHMgPSBnZXQodGhpcywg
        J25lZWRzJyksCiAgICBsZW5ndGggPSBnZXQobmVlZHMsICdsZW5ndGgnKTsK
        CiAgICBpZiAobGVuZ3RoID4gMCkgewogICAgICBFbWJlci5hc3NlcnQoJyBg
        JyArIEVtYmVyLmluc3BlY3QodGhpcykgKyAnIHNwZWNpZmllcyBgbmVlZHNg
        LCBidXQgZG9lcyBub3QgaGF2ZSBhIGNvbnRhaW5lci4gUGxlYXNlIGVuc3Vy
        ZSB0aGlzIGNvbnRyb2xsZXIgd2FzIGluc3RhbnRpYXRlZCB3aXRoIGEgY29u
        dGFpbmVyLicsIHRoaXMuY29udGFpbmVyKTsKCiAgICAgIHZlcmlmeU5lZWRz
        RGVwZW5kZW5jaWVzKHRoaXMsIHRoaXMuY29udGFpbmVyLCBuZWVkcyk7Cgog
        ICAgICAvLyBpZiBuZWVkcyB0aGVuIGluaXRpYWxpemUgY29udHJvbGxlcnMg
        cHJveHkKICAgICAgZ2V0KHRoaXMsICdjb250cm9sbGVycycpOwogICAgfQoK
        ICAgIHRoaXMuX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgfSwK
        CiAgLyoqCiAgICBAbWV0aG9kIGNvbnRyb2xsZXJGb3IKICAgIEBzZWUge0Vt
        YmVyLlJvdXRlI2NvbnRyb2xsZXJGb3J9CiAgICBAZGVwcmVjYXRlZCBVc2Ug
        YG5lZWRzYCBpbnN0ZWFkCiAgKi8KICBjb250cm9sbGVyRm9yOiBmdW5jdGlv
        bihjb250cm9sbGVyTmFtZSkgewogICAgRW1iZXIuZGVwcmVjYXRlKCJDb250
        cm9sbGVyI2NvbnRyb2xsZXJGb3IgaXMgZGVwcmVjYXRlZCwgcGxlYXNlIHVz
        ZSBDb250cm9sbGVyI25lZWRzIGluc3RlYWQiKTsKICAgIHJldHVybiBFbWJl
        ci5jb250cm9sbGVyRm9yKGdldCh0aGlzLCAnY29udGFpbmVyJyksIGNvbnRy
        b2xsZXJOYW1lKTsKICB9LAoKICAvKioKICAgIFN0b3JlcyB0aGUgaW5zdGFu
        Y2VzIG9mIG90aGVyIGNvbnRyb2xsZXJzIGF2YWlsYWJsZSBmcm9tIHdpdGhp
        bgogICAgdGhpcyBjb250cm9sbGVyLiBBbnkgY29udHJvbGxlciBsaXN0ZWQg
        YnkgbmFtZSBpbiB0aGUgYG5lZWRzYAogICAgcHJvcGVydHkgd2lsbCBiZSBh
        Y2Nlc3NpYmxlIGJ5IG5hbWUgdGhyb3VnaCB0aGlzIHByb3BlcnR5LgoKICAg
        IGBgYGphdmFzY3JpcHQKICAgIEFwcC5Db21tZW50c0NvbnRyb2xsZXIgPSBF
        bWJlci5BcnJheUNvbnRyb2xsZXIuZXh0ZW5kKHsKICAgICAgbmVlZHM6IFsn
        cG9zdCddLAogICAgICBwb3N0VGl0bGU6IGZ1bmN0aW9uKCl7CiAgICAgICAg
        dmFyIGN1cnJlbnRQb3N0ID0gdGhpcy5nZXQoJ2NvbnRyb2xsZXJzLnBvc3Qn
        KTsgLy8gaW5zdGFuY2Ugb2YgQXBwLlBvc3RDb250cm9sbGVyCiAgICAgICAg
        cmV0dXJuIGN1cnJlbnRQb3N0LmdldCgndGl0bGUnKTsKICAgICAgfS5wcm9w
        ZXJ0eSgnY29udHJvbGxlcnMucG9zdC50aXRsZScpCiAgICB9KTsKICAgIGBg
        YAoKICAgIEBzZWUge0VtYmVyLkNvbnRyb2xsZXJNaXhpbiNuZWVkc30KICAg
        IEBwcm9wZXJ0eSB7T2JqZWN0fSBjb250cm9sbGVycwogICAgQGRlZmF1bHQg
        bnVsbAogICovCiAgY29udHJvbGxlcnM6IEVtYmVyLmNvbXB1dGVkKGZ1bmN0
        aW9uKCkgewogICAgdmFyIGNvbnRyb2xsZXIgPSB0aGlzOwoKICAgIHJldHVy
        biB7CiAgICAgIG5lZWRzOiBnZXQoY29udHJvbGxlciwgJ25lZWRzJyksCiAg
        ICAgIGNvbnRhaW5lcjogZ2V0KGNvbnRyb2xsZXIsICdjb250YWluZXInKSwK
        ICAgICAgdW5rbm93blByb3BlcnR5OiBmdW5jdGlvbihjb250cm9sbGVyTmFt
        ZSkgewogICAgICAgIHZhciBuZWVkcyA9IHRoaXMubmVlZHMsCiAgICAgICAg
        ICBkZXBlbmRlbmN5LCBpLCBsOwogICAgICAgIGZvciAoaT0wLCBsPW5lZWRz
        Lmxlbmd0aDsgaTxsOyBpKyspIHsKICAgICAgICAgIGRlcGVuZGVuY3kgPSBu
        ZWVkc1tpXTsKICAgICAgICAgIGlmIChkZXBlbmRlbmN5ID09PSBjb250cm9s
        bGVyTmFtZSkgewogICAgICAgICAgICByZXR1cm4gdGhpcy5jb250YWluZXIu
        bG9va3VwKCdjb250cm9sbGVyOicgKyBjb250cm9sbGVyTmFtZSk7CiAgICAg
        ICAgICB9CiAgICAgICAgfQoKICAgICAgICB2YXIgZXJyb3JNZXNzYWdlID0g
        RW1iZXIuaW5zcGVjdChjb250cm9sbGVyKSArICcjbmVlZHMgZG9lcyBub3Qg
        aW5jbHVkZSBgJyArIGNvbnRyb2xsZXJOYW1lICsgJ2AuIFRvIGFjY2VzcyB0
        aGUgJyArIGNvbnRyb2xsZXJOYW1lICsgJyBjb250cm9sbGVyIGZyb20gJyAr
        IEVtYmVyLmluc3BlY3QoY29udHJvbGxlcikgKyAnLCAnICsgRW1iZXIuaW5z
        cGVjdChjb250cm9sbGVyKSArICcgc2hvdWxkIGhhdmUgYSBgbmVlZHNgIHBy
        b3BlcnR5IHRoYXQgaXMgYW4gYXJyYXkgb2YgdGhlIGNvbnRyb2xsZXJzIGl0
        IGhhcyBhY2Nlc3MgdG8uJzsKICAgICAgICB0aHJvdyBuZXcgUmVmZXJlbmNl
        RXJyb3IoZXJyb3JNZXNzYWdlKTsKICAgICAgfQogICAgfTsKICB9KS5yZWFk
        T25seSgpCn0pOwoKfSkoKTsKCgoKKGZ1bmN0aW9uKCkgewoKfSkoKTsKCgoK
        KGZ1bmN0aW9uKCkgewovKioKRW1iZXIgQXBwbGljYXRpb24KCkBtb2R1bGUg
        ZW1iZXIKQHN1Ym1vZHVsZSBlbWJlci1hcHBsaWNhdGlvbgpAcmVxdWlyZXMg
        ZW1iZXItdmlld3MsIGVtYmVyLXJvdXRpbmcKKi8KCn0pKCk7CgooZnVuY3Rp
        b24oKSB7Ci8qKgpAbW9kdWxlIGVtYmVyCkBzdWJtb2R1bGUgZW1iZXItZXh0
        ZW5zaW9uLXN1cHBvcnQKKi8KLyoqCiAgVGhlIGBEYXRhQWRhcHRlcmAgaGVs
        cHMgYSBkYXRhIHBlcnNpc3RlbmNlIGxpYnJhcnkKICBpbnRlcmZhY2Ugd2l0
        aCB0b29scyB0aGF0IGRlYnVnIEVtYmVyIHN1Y2gKICBhcyB0aGUgQ2hyb21l
        IEVtYmVyIEV4dGVuc2lvbi4KCiAgVGhpcyBjbGFzcyB3aWxsIGJlIGV4dGVu
        ZGVkIGJ5IGEgcGVyc2lzdGVuY2UgbGlicmFyeQogIHdoaWNoIHdpbGwgb3Zl
        cnJpZGUgc29tZSBvZiB0aGUgbWV0aG9kcyB3aXRoCiAgbGlicmFyeS1zcGVj
        aWZpYyBjb2RlLgoKICBUaGUgbWV0aG9kcyBsaWtlbHkgdG8gYmUgb3ZlcnJp
        ZGVuIGFyZQogIGBnZXRGaWx0ZXJzYCwgYGRldGVjdGAsIGBjb2x1bW5zRm9y
        VHlwZWAsCiAgYGdldFJlY29yZHNgLCBgZ2V0UmVjb3JkQ29sdW1uVmFsdWVz
        YCwKICBgZ2V0UmVjb3JkS2V5d29yZHNgLCBgZ2V0UmVjb3JkRmlsdGVyVmFs
        dWVzYCwKICBgZ2V0UmVjb3JkQ29sb3JgLCBgb2JzZXJ2ZVJlY29yZGAKCiAg
        VGhlIGFkYXB0ZXIgd2lsbCBuZWVkIHRvIGJlIHJlZ2lzdGVyZWQKICBpbiB0
        aGUgYXBwbGljYXRpb24ncyBjb250YWluZXIgYXMgYGRhdGFBZGFwdGVyOm1h
        aW5gCgogIEV4YW1wbGU6CiAgYGBgamF2YXNjcmlwdAogIEFwcGxpY2F0aW9u
        LmluaXRpYWxpemVyKHsKICAgIG5hbWU6ICJkYXRhQWRhcHRlciIsCgogICAg
        aW5pdGlhbGl6ZTogZnVuY3Rpb24oY29udGFpbmVyLCBhcHBsaWNhdGlvbikg
        ewogICAgICBhcHBsaWNhdGlvbi5yZWdpc3RlcignZGF0YUFkYXB0ZXI6bWFp
        bicsIERTLkRhdGFBZGFwdGVyKTsKICAgIH0KICB9KTsKICBgYGAKCiAgQGNs
        YXNzIERhdGFBZGFwdGVyCiAgQG5hbWVzcGFjZSBFbWJlcgogIEBleHRlbmRz
        IEVtYmVyLk9iamVjdAoqLwpFbWJlci5EYXRhQWRhcHRlciA9IEVtYmVyLk9i
        amVjdC5leHRlbmQoewogIGluaXQ6IGZ1bmN0aW9uKCkgewogICAgdGhpcy5f
        c3VwZXIoKTsKICAgIHRoaXMucmVsZWFzZU1ldGhvZHMgPSBFbWJlci5BKCk7
        CiAgfSwKCiAgLyoqCiAgICBUaGUgY29udGFpbmVyIG9mIHRoZSBhcHBsaWNh
        dGlvbiBiZWluZyBkZWJ1Z2dlZC4KICAgIFRoaXMgcHJvcGVydHkgd2lsbCBi
        ZSBpbmplY3RlZAogICAgb24gY3JlYXRpb24uCiAgKi8KICBjb250YWluZXI6
        IG51bGwsCgogIC8qKgogICAgQHByaXZhdGUKCiAgICBOdW1iZXIgb2YgYXR0
        cmlidXRlcyB0byBzZW5kCiAgICBhcyBjb2x1bW5zLiAoRW5vdWdoIHRvIG1h
        a2UgdGhlIHJlY29yZAogICAgaWRlbnRpZmlhYmxlKS4KICAqLwogIGF0dHJp
        YnV0ZUxpbWl0OiAzLAoKICAvKioKICAgIEBwcml2YXRlCgogICAgU3RvcmVz
        IGFsbCBtZXRob2RzIHRoYXQgY2xlYXIgb2JzZXJ2ZXJzLgogICAgVGhlc2Ug
        bWV0aG9kcyB3aWxsIGJlIGNhbGxlZCBvbiBkZXN0cnVjdGlvbi4KICAqLwog
        IHJlbGVhc2VNZXRob2RzOiBFbWJlci5BKCksCgogIC8qKgogICAgQHB1Ymxp
        YwoKICAgIFNwZWNpZmllcyBob3cgcmVjb3JkcyBjYW4gYmUgZmlsdGVyZWQu
        CiAgICBSZWNvcmRzIHJldHVybmVkIHdpbGwgbmVlZCB0byBoYXZlIGEgYGZp
        bHRlclZhbHVlc2AKICAgIHByb3BlcnR5IHdpdGggYSBrZXkgZm9yIGV2ZXJ5
        IG5hbWUgaW4gdGhlIHJldHVybmVkIGFycmF5LgoKICAgIEBtZXRob2QgZ2V0
        RmlsdGVycwogICAgQHJldHVybiB7QXJyYXl9IExpc3Qgb2Ygb2JqZWN0cyBk
        ZWZpbmluZyBmaWx0ZXJzLgogICAgIFRoZSBvYmplY3Qgc2hvdWxkIGhhdmUg
        YSBgbmFtZWAgYW5kIGBkZXNjYCBwcm9wZXJ0eS4KICAqLwogIGdldEZpbHRl
        cnM6IGZ1bmN0aW9uKCkgewogICAgcmV0dXJuIEVtYmVyLkEoKTsKICB9LAoK
        ICAvKioKICAgIEBwdWJsaWMKCiAgICBGZXRjaCB0aGUgbW9kZWwgdHlwZXMg
        YW5kIG9ic2VydmUgdGhlbSBmb3IgY2hhbmdlcy4KCiAgICBAbWV0aG9kIHdh
        dGNoTW9kZWxUeXBlcwoKICAgIEBwYXJhbSB7RnVuY3Rpb259IHR5cGVzQWRk
        ZWQgQ2FsbGJhY2sgdG8gY2FsbCB0byBhZGQgdHlwZXMuCiAgICBUYWtlcyBh
        biBhcnJheSBvZiBvYmplY3RzIGNvbnRhaW5pbmcgd3JhcHBlZCB0eXBlcyAo
        cmV0dXJuZWQgZnJvbSBgd3JhcE1vZGVsVHlwZWApLgoKICAgIEBwYXJhbSB7
        RnVuY3Rpb259IHR5cGVzVXBkYXRlZCBDYWxsYmFjayB0byBjYWxsIHdoZW4g
        YSB0eXBlIGhhcyBjaGFuZ2VkLgogICAgVGFrZXMgYW4gYXJyYXkgb2Ygb2Jq
        ZWN0cyBjb250YWluaW5nIHdyYXBwZWQgdHlwZXMuCgogICAgQHJldHVybiB7
        RnVuY3Rpb259IE1ldGhvZCB0byBjYWxsIHRvIHJlbW92ZSBhbGwgb2JzZXJ2
        ZXJzCiAgKi8KICB3YXRjaE1vZGVsVHlwZXM6IGZ1bmN0aW9uKHR5cGVzQWRk
        ZWQsIHR5cGVzVXBkYXRlZCkgewogICAgdmFyIG1vZGVsVHlwZXMgPSB0aGlz
        LmdldE1vZGVsVHlwZXMoKSwKICAgICAgICBzZWxmID0gdGhpcywgdHlwZXNU
        b1NlbmQsIHJlbGVhc2VNZXRob2RzID0gRW1iZXIuQSgpOwoKICAgIHR5cGVz
        VG9TZW5kID0gbW9kZWxUeXBlcy5tYXAoZnVuY3Rpb24odHlwZSkgewogICAg
        ICB2YXIgd3JhcHBlZCA9IHNlbGYud3JhcE1vZGVsVHlwZSh0eXBlKTsKICAg
        ICAgcmVsZWFzZU1ldGhvZHMucHVzaChzZWxmLm9ic2VydmVNb2RlbFR5cGUo
        dHlwZSwgdHlwZXNVcGRhdGVkKSk7CiAgICAgIHJldHVybiB3cmFwcGVkOwog
        ICAgfSk7CgogICAgdHlwZXNBZGRlZCh0eXBlc1RvU2VuZCk7CgogICAgdmFy
        IHJlbGVhc2UgPSBmdW5jdGlvbigpIHsKICAgICAgcmVsZWFzZU1ldGhvZHMu
        Zm9yRWFjaChmdW5jdGlvbihmbikgeyBmbigpOyB9KTsKICAgICAgc2VsZi5y
        ZWxlYXNlTWV0aG9kcy5yZW1vdmVPYmplY3QocmVsZWFzZSk7CiAgICB9Owog
        ICAgdGhpcy5yZWxlYXNlTWV0aG9kcy5wdXNoT2JqZWN0KHJlbGVhc2UpOwog
        ICAgcmV0dXJuIHJlbGVhc2U7CiAgfSwKCiAgLyoqCiAgICBAcHVibGljCgog
        ICAgRmV0Y2ggdGhlIHJlY29yZHMgb2YgYSBnaXZlbiB0eXBlIGFuZCBvYnNl
        cnZlIHRoZW0gZm9yIGNoYW5nZXMuCgogICAgQG1ldGhvZCB3YXRjaFJlY29y
        ZHMKCiAgICBAcGFyYW0ge0Z1bmN0aW9ufSByZWNvcmRzQWRkZWQgQ2FsbGJh
        Y2sgdG8gY2FsbCB0byBhZGQgcmVjb3Jkcy4KICAgIFRha2VzIGFuIGFycmF5
        IG9mIG9iamVjdHMgY29udGFpbmluZyB3cmFwcGVkIHJlY29yZHMuCiAgICBU
        aGUgb2JqZWN0IHNob3VsZCBoYXZlIHRoZSBmb2xsb3dpbmcgcHJvcGVydGll
        czoKICAgICAgY29sdW1uVmFsdWVzOiB7T2JqZWN0fSBrZXkgYW5kIHZhbHVl
        IG9mIGEgdGFibGUgY2VsbAogICAgICBvYmplY3Q6IHtPYmplY3R9IHRoZSBh
        Y3R1YWwgcmVjb3JkIG9iamVjdAoKICAgIEBwYXJhbSB7RnVuY3Rpb259IHJl
        Y29yZHNVcGRhdGVkIENhbGxiYWNrIHRvIGNhbGwgd2hlbiBhIHJlY29yZCBo
        YXMgY2hhbmdlZC4KICAgIFRha2VzIGFuIGFycmF5IG9mIG9iamVjdHMgY29u
        dGFpbmluZyB3cmFwcGVkIHJlY29yZHMuCgogICAgQHBhcmFtIHtGdW5jdGlv
        bn0gcmVjb3Jkc1JlbW92ZWQgQ2FsbGJhY2sgdG8gY2FsbCB3aGVuIGEgcmVj
        b3JkIGhhcyByZW1vdmVkLgogICAgVGFrZXMgdGhlIGZvbGxvd2luZyBwYXJh
        bWV0ZXJzOgogICAgICBpbmRleDogdGhlIGFycmF5IGluZGV4IHdoZXJlIHRo
        ZSByZWNvcmRzIHdlcmUgcmVtb3ZlZAogICAgICBjb3VudDogdGhlIG51bWJl
        ciBvZiByZWNvcmRzIHJlbW92ZWQKCiAgICBAcmV0dXJuIHtGdW5jdGlvbn0g
        TWV0aG9kIHRvIGNhbGwgdG8gcmVtb3ZlIGFsbCBvYnNlcnZlcnMKICAqLwog
        IHdhdGNoUmVjb3JkczogZnVuY3Rpb24odHlwZSwgcmVjb3Jkc0FkZGVkLCBy
        ZWNvcmRzVXBkYXRlZCwgcmVjb3Jkc1JlbW92ZWQpIHsKICAgIHZhciBzZWxm
        ID0gdGhpcywgcmVsZWFzZU1ldGhvZHMgPSBFbWJlci5BKCksIHJlY29yZHMg
        PSB0aGlzLmdldFJlY29yZHModHlwZSksIHJlbGVhc2U7CgogICAgdmFyIHJl
        Y29yZFVwZGF0ZWQgPSBmdW5jdGlvbih1cGRhdGVkUmVjb3JkKSB7CiAgICAg
        IHJlY29yZHNVcGRhdGVkKFt1cGRhdGVkUmVjb3JkXSk7CiAgICB9OwoKICAg
        IHZhciByZWNvcmRzVG9TZW5kID0gcmVjb3Jkcy5tYXAoZnVuY3Rpb24ocmVj
        b3JkKSB7CiAgICAgIHJlbGVhc2VNZXRob2RzLnB1c2goc2VsZi5vYnNlcnZl
        UmVjb3JkKHJlY29yZCwgcmVjb3JkVXBkYXRlZCkpOwogICAgICByZXR1cm4g
        c2VsZi53cmFwUmVjb3JkKHJlY29yZCk7CiAgICB9KTsKCgogICAgdmFyIGNv
        bnRlbnREaWRDaGFuZ2UgPSBmdW5jdGlvbihhcnJheSwgaWR4LCByZW1vdmVk
        Q291bnQsIGFkZGVkQ291bnQpIHsKICAgICAgZm9yICh2YXIgaSA9IGlkeDsg
        aSA8IGlkeCArIGFkZGVkQ291bnQ7IGkrKykgewogICAgICAgIHZhciByZWNv
        cmQgPSBhcnJheS5vYmplY3RBdChpKTsKICAgICAgICB2YXIgd3JhcHBlZCA9
        IHNlbGYud3JhcFJlY29yZChyZWNvcmQpOwogICAgICAgIHJlbGVhc2VNZXRo
        b2RzLnB1c2goc2VsZi5vYnNlcnZlUmVjb3JkKHJlY29yZCwgcmVjb3JkVXBk
        YXRlZCkpOwogICAgICAgIHJlY29yZHNBZGRlZChbd3JhcHBlZF0pOwogICAg
        ICB9CgogICAgICBpZiAocmVtb3ZlZENvdW50KSB7CiAgICAgICAgcmVjb3Jk
        c1JlbW92ZWQoaWR4LCByZW1vdmVkQ291bnQpOwogICAgICB9CiAgICB9OwoK
        ICAgIHZhciBvYnNlcnZlciA9IHsgZGlkQ2hhbmdlOiBjb250ZW50RGlkQ2hh
        bmdlLCB3aWxsQ2hhbmdlOiBFbWJlci5LIH07CiAgICByZWNvcmRzLmFkZEFy
        cmF5T2JzZXJ2ZXIoc2VsZiwgb2JzZXJ2ZXIpOwoKICAgIHJlbGVhc2UgPSBm
        dW5jdGlvbigpIHsKICAgICAgcmVsZWFzZU1ldGhvZHMuZm9yRWFjaChmdW5j
        dGlvbihmbikgeyBmbigpOyB9KTsKICAgICAgcmVjb3Jkcy5yZW1vdmVBcnJh
        eU9ic2VydmVyKHNlbGYsIG9ic2VydmVyKTsKICAgICAgc2VsZi5yZWxlYXNl
        TWV0aG9kcy5yZW1vdmVPYmplY3QocmVsZWFzZSk7CiAgICB9OwoKICAgIHJl
        Y29yZHNBZGRlZChyZWNvcmRzVG9TZW5kKTsKCiAgICB0aGlzLnJlbGVhc2VN
        ZXRob2RzLnB1c2hPYmplY3QocmVsZWFzZSk7CiAgICByZXR1cm4gcmVsZWFz
        ZTsKICB9LAoKICAvKioKICAgIEBwcml2YXRlCgogICAgQ2xlYXIgYWxsIG9i
        c2VydmVycyBiZWZvcmUgZGVzdHJ1Y3Rpb24KICAqLwogIHdpbGxEZXN0cm95
        OiBmdW5jdGlvbigpIHsKICAgIHRoaXMuX3N1cGVyKCk7CiAgICB0aGlzLnJl
        bGVhc2VNZXRob2RzLmZvckVhY2goZnVuY3Rpb24oZm4pIHsKICAgICAgZm4o
        KTsKICAgIH0pOwogIH0sCgogIC8qKgogICAgQHByaXZhdGUKCiAgICBEZXRl
        Y3Qgd2hldGhlciBhIGNsYXNzIGlzIGEgbW9kZWwuCgogICAgVGVzdCB0aGF0
        IGFnYWluc3QgdGhlIG1vZGVsIGNsYXNzCiAgICBvZiB5b3VyIHBlcnNpc3Rl
        bmNlIGxpYnJhcnkKCiAgICBAbWV0aG9kIGRldGVjdAogICAgQHBhcmFtIHtD
        bGFzc30ga2xhc3MgVGhlIGNsYXNzIHRvIHRlc3QKICAgIEByZXR1cm4gYm9v
        bGVhbiBXaGV0aGVyIHRoZSBjbGFzcyBpcyBhIG1vZGVsIGNsYXNzIG9yIG5v
        dAogICovCiAgZGV0ZWN0OiBmdW5jdGlvbihrbGFzcykgewogICAgcmV0dXJu
        IGZhbHNlOwogIH0sCgogIC8qKgogICAgQHByaXZhdGUKCiAgICBHZXQgdGhl
        IGNvbHVtbnMgZm9yIGEgZ2l2ZW4gbW9kZWwgdHlwZS4KCiAgICBAbWV0aG9k
        IGNvbHVtbnNGb3JUeXBlCiAgICBAcGFyYW0ge0NsYXNzfSB0eXBlIFRoZSBt
        b2RlbCB0eXBlCiAgICBAcmV0dXJuIHtBcnJheX0gQW4gYXJyYXkgb2YgY29s
        dW1ucyBvZiB0aGUgZm9sbG93aW5nIGZvcm1hdDoKICAgICBuYW1lOiB7U3Ry
        aW5nfSBuYW1lIG9mIHRoZSBjb2x1bW4KICAgICBkZXNjOiB7U3RyaW5nfSBI
        dW1hbml6ZWQgZGVzY3JpcHRpb24gKHdoYXQgd291bGQgc2hvdyBpbiBhIHRh
        YmxlIGNvbHVtbiBuYW1lKQogICovCiAgY29sdW1uc0ZvclR5cGU6IGZ1bmN0
        aW9uKHR5cGUpIHsKICAgIHJldHVybiBFbWJlci5BKCk7CiAgfSwKCiAgLyoq
        CiAgICBAcHJpdmF0ZQoKICAgIEFkZHMgb2JzZXJ2ZXJzIHRvIGEgbW9kZWwg
        dHlwZSBjbGFzcy4KCiAgICBAbWV0aG9kIG9ic2VydmVNb2RlbFR5cGUKICAg
        IEBwYXJhbSB7Q2xhc3N9IHR5cGUgVGhlIG1vZGVsIHR5cGUgY2xhc3MKICAg
        IEBwYXJhbSB7RnVuY3Rpb259IHR5cGVzVXBkYXRlZCBDYWxsZWQgd2hlbiBh
        IHR5cGUgaXMgbW9kaWZpZWQuCiAgICBAcmV0dXJuIHtGdW5jdGlvbn0gVGhl
        IGZ1bmN0aW9uIHRvIGNhbGwgdG8gcmVtb3ZlIG9ic2VydmVycwogICovCgog
        IG9ic2VydmVNb2RlbFR5cGU6IGZ1bmN0aW9uKHR5cGUsIHR5cGVzVXBkYXRl
        ZCkgewogICAgdmFyIHNlbGYgPSB0aGlzLCByZWNvcmRzID0gdGhpcy5nZXRS
        ZWNvcmRzKHR5cGUpOwoKICAgIHZhciBvbkNoYW5nZSA9IGZ1bmN0aW9uKCkg
        ewogICAgICB0eXBlc1VwZGF0ZWQoW3NlbGYud3JhcE1vZGVsVHlwZSh0eXBl
        KV0pOwogICAgfTsKICAgIHZhciBvYnNlcnZlciA9IHsKICAgICAgZGlkQ2hh
        bmdlOiBmdW5jdGlvbigpIHsKICAgICAgICBFbWJlci5ydW4uc2NoZWR1bGVP
        bmNlKCdhY3Rpb25zJywgdGhpcywgb25DaGFuZ2UpOwogICAgICB9LAogICAg
        ICB3aWxsQ2hhbmdlOiBFbWJlci5LCiAgICB9OwoKICAgIHJlY29yZHMuYWRk
        QXJyYXlPYnNlcnZlcih0aGlzLCBvYnNlcnZlcik7CgogICAgdmFyIHJlbGVh
        c2UgPSBmdW5jdGlvbigpIHsKICAgICAgcmVjb3Jkcy5yZW1vdmVBcnJheU9i
        c2VydmVyKHNlbGYsIG9ic2VydmVyKTsKICAgIH07CgogICAgcmV0dXJuIHJl
        bGVhc2U7CiAgfSwKCgogIC8qKgogICAgQHByaXZhdGUKCiAgICBXcmFwcyBh
        IGdpdmVuIG1vZGVsIHR5cGUgYW5kIG9ic2VydmVzIGNoYW5nZXMgdG8gaXQu
        CgogICAgQG1ldGhvZCB3cmFwTW9kZWxUeXBlCiAgICBAcGFyYW0ge0NsYXNz
        fSB0eXBlIEEgbW9kZWwgY2xhc3MKICAgIEBwYXJhbSB7RnVuY3Rpb259IHR5
        cGVzVXBkYXRlZCBjYWxsYmFjayB0byBjYWxsIHdoZW4gdGhlIHR5cGUgY2hh
        bmdlcwogICAgQHJldHVybiB7T2JqZWN0fSBjb250YWlucyB0aGUgd3JhcHBl
        ZCB0eXBlIGFuZCB0aGUgZnVuY3Rpb24gdG8gcmVtb3ZlIG9ic2VydmVycwog
        ICAgRm9ybWF0OgogICAgICB0eXBlOiB7T2JqZWN0fSB0aGUgd3JhcHBlZCB0
        eXBlCiAgICAgICAgVGhlIHdyYXBwZWQgdHlwZSBoYXMgdGhlIGZvbGxvd2lu
        ZyBmb3JtYXQ6CiAgICAgICAgICBuYW1lOiB7U3RyaW5nfSBuYW1lIG9mIHRo
        ZSB0eXBlCiAgICAgICAgICBjb3VudDoge0ludGVnZXJ9IG51bWJlciBvZiBy
        ZWNvcmRzIGF2YWlsYWJsZQogICAgICAgICAgY29sdW1uczoge0NvbHVtbnN9
        IGFycmF5IG9mIGNvbHVtbnMgdG8gZGVzY3JpYmUgdGhlIHJlY29yZAogICAg
        ICAgICAgb2JqZWN0OiB7Q2xhc3N9IHRoZSBhY3R1YWwgTW9kZWwgdHlwZSBj
        bGFzcwogICAgICByZWxlYXNlOiB7RnVuY3Rpb259IFRoZSBmdW5jdGlvbiB0
        byByZW1vdmUgb2JzZXJ2ZXJzCiAgKi8KICB3cmFwTW9kZWxUeXBlOiBmdW5j
        dGlvbih0eXBlLCB0eXBlc1VwZGF0ZWQpIHsKICAgIHZhciByZWxlYXNlLCBy
        ZWNvcmRzID0gdGhpcy5nZXRSZWNvcmRzKHR5cGUpLAogICAgICAgIHR5cGVU
        b1NlbmQsIHNlbGYgPSB0aGlzOwoKICAgIHR5cGVUb1NlbmQgPSB7CiAgICAg
        IG5hbWU6IHR5cGUudG9TdHJpbmcoKSwKICAgICAgY291bnQ6IEVtYmVyLmdl
        dChyZWNvcmRzLCAnbGVuZ3RoJyksCiAgICAgIGNvbHVtbnM6IHRoaXMuY29s
        dW1uc0ZvclR5cGUodHlwZSksCiAgICAgIG9iamVjdDogdHlwZQogICAgfTsK
        CgogICAgcmV0dXJuIHR5cGVUb1NlbmQ7CiAgfSwKCgogIC8qKgogICAgQHBy
        aXZhdGUKCiAgICBGZXRjaGVzIGFsbCBtb2RlbHMgZGVmaW5lZCBpbiB0aGUg
        YXBwbGljYXRpb24uCiAgICBUT0RPOiBVc2UgdGhlIHJlc29sdmVyIGluc3Rl
        YWQgb2YgbG9vcGluZyBvdmVyIG5hbWVzcGFjZXMuCgogICAgQG1ldGhvZCBn
        ZXRNb2RlbFR5cGVzCiAgICBAcmV0dXJuIHtBcnJheX0gQXJyYXkgb2YgbW9k
        ZWwgdHlwZXMKICAqLwogIGdldE1vZGVsVHlwZXM6IGZ1bmN0aW9uKCkgewog
        ICAgdmFyIG5hbWVzcGFjZXMgPSBFbWJlci5BKEVtYmVyLk5hbWVzcGFjZS5O
        QU1FU1BBQ0VTKSwgdHlwZXMgPSBFbWJlci5BKCksIHNlbGYgPSB0aGlzOwoK
        ICAgIG5hbWVzcGFjZXMuZm9yRWFjaChmdW5jdGlvbihuYW1lc3BhY2UpIHsK
        ICAgICAgZm9yICh2YXIga2V5IGluIG5hbWVzcGFjZSkgewogICAgICAgIGlm
        ICghbmFtZXNwYWNlLmhhc093blByb3BlcnR5KGtleSkpIHsgY29udGludWU7
        IH0KICAgICAgICB2YXIga2xhc3MgPSBuYW1lc3BhY2Vba2V5XTsKICAgICAg
        ICBpZiAoc2VsZi5kZXRlY3Qoa2xhc3MpKSB7CiAgICAgICAgICB0eXBlcy5w
        dXNoKGtsYXNzKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0pOwogICAgcmV0
        dXJuIHR5cGVzOwogIH0sCgogIC8qKgogICAgQHByaXZhdGUKCiAgICBGZXRj
        aGVzIGFsbCBsb2FkZWQgcmVjb3JkcyBmb3IgYSBnaXZlbiB0eXBlLgoKICAg
        IEBtZXRob2QgZ2V0UmVjb3JkcwogICAgQHJldHVybiB7QXJyYXl9IGFycmF5
        IG9mIHJlY29yZHMuCiAgICAgVGhpcyBhcnJheSB3aWxsIGJlIG9ic2VydmVk
        IGZvciBjaGFuZ2VzLAogICAgIHNvIGl0IHNob3VsZCB1cGRhdGUgd2hlbiBu
        ZXcgcmVjb3JkcyBhcmUgYWRkZWQvcmVtb3ZlZC4KICAqLwogIGdldFJlY29y
        ZHM6IGZ1bmN0aW9uKHR5cGUpIHsKICAgIHJldHVybiBFbWJlci5BKCk7CiAg
        fSwKCiAgLyoqCiAgICBAcHJpdmF0ZQoKICAgIFdyYXBzIGEgcmVjb3JkIGFu
        ZCBvYnNlcnZlcnMgY2hhbmdlcyB0byBpdAoKICAgIEBtZXRob2Qgd3JhcFJl
        Y29yZAogICAgQHBhcmFtIHtPYmplY3R9IHJlY29yZCBUaGUgcmVjb3JkIGlu
        c3RhbmNlCiAgICBAcmV0dXJuIHtPYmplY3R9IHRoZSB3cmFwcGVkIHJlY29y
        ZC4gRm9ybWF0OgogICAgY29sdW1uVmFsdWVzOiB7QXJyYXl9CiAgICBzZWFy
        Y2hLZXl3b3Jkczoge0FycmF5fQogICovCiAgd3JhcFJlY29yZDogZnVuY3Rp
        b24ocmVjb3JkKSB7CiAgICB2YXIgcmVjb3JkVG9TZW5kID0geyBvYmplY3Q6
        IHJlY29yZCB9LCBjb2x1bW5WYWx1ZXMgPSB7fSwgc2VsZiA9IHRoaXM7Cgog
        ICAgcmVjb3JkVG9TZW5kLmNvbHVtblZhbHVlcyA9IHRoaXMuZ2V0UmVjb3Jk
        Q29sdW1uVmFsdWVzKHJlY29yZCk7CiAgICByZWNvcmRUb1NlbmQuc2VhcmNo
        S2V5d29yZHMgPSB0aGlzLmdldFJlY29yZEtleXdvcmRzKHJlY29yZCk7CiAg
        ICByZWNvcmRUb1NlbmQuZmlsdGVyVmFsdWVzID0gdGhpcy5nZXRSZWNvcmRG
        aWx0ZXJWYWx1ZXMocmVjb3JkKTsKICAgIHJlY29yZFRvU2VuZC5jb2xvciA9
        IHRoaXMuZ2V0UmVjb3JkQ29sb3IocmVjb3JkKTsKCiAgICByZXR1cm4gcmVj
        b3JkVG9TZW5kOwogIH0sCgogIC8qKgogICAgQHByaXZhdGUKCiAgICBHZXRz
        IHRoZSB2YWx1ZXMgZm9yIGVhY2ggY29sdW1uLgoKICAgIEBtZXRob2QgZ2V0
        UmVjb3JkQ29sdW1uVmFsdWVzCiAgICBAcmV0dXJuIHtPYmplY3R9IEtleXMg
        c2hvdWxkIG1hdGNoIGNvbHVtbiBuYW1lcyBkZWZpbmVkCiAgICBieSB0aGUg
        bW9kZWwgdHlwZS4KICAqLwogIGdldFJlY29yZENvbHVtblZhbHVlczogZnVu
        Y3Rpb24ocmVjb3JkKSB7CiAgICByZXR1cm4ge307CiAgfSwKCiAgLyoqCiAg
        ICBAcHJpdmF0ZQoKICAgIFJldHVybnMga2V5d29yZHMgdG8gbWF0Y2ggd2hl
        biBzZWFyY2hpbmcgcmVjb3Jkcy4KCiAgICBAbWV0aG9kIGdldFJlY29yZEtl
        eXdvcmRzCiAgICBAcmV0dXJuIHtBcnJheX0gUmVsZXZhbnQga2V5d29yZHMg
        Zm9yIHNlYXJjaC4KICAqLwogIGdldFJlY29yZEtleXdvcmRzOiBmdW5jdGlv
        bihyZWNvcmQpIHsKICAgIHJldHVybiBFbWJlci5BKCk7CiAgfSwKCiAgLyoq
        CiAgICBAcHJpdmF0ZQoKICAgIFJldHVybnMgdGhlIHZhbHVlcyBvZiBmaWx0
        ZXJzIGRlZmluZWQgYnkgYGdldEZpbHRlcnNgLgoKICAgIEBtZXRob2QgZ2V0
        UmVjb3JkRmlsdGVyVmFsdWVzCiAgICBAcGFyYW0ge09iamVjdH0gcmVjb3Jk
        IFRoZSByZWNvcmQgaW5zdGFuY2UKICAgIEByZXR1cm4ge09iamVjdH0gVGhl
        IGZpbHRlciB2YWx1ZXMKICAqLwogIGdldFJlY29yZEZpbHRlclZhbHVlczog
        ZnVuY3Rpb24ocmVjb3JkKSB7CiAgICByZXR1cm4ge307CiAgfSwKCiAgLyoq
        CiAgICBAcHJpdmF0ZQoKICAgIEVhY2ggcmVjb3JkIGNhbiBoYXZlIGEgY29s
        b3IgdGhhdCByZXByZXNlbnRzIGl0cyBzdGF0ZS4KCiAgICBAbWV0aG9kIGdl
        dFJlY29yZENvbG9yCiAgICBAcGFyYW0ge09iamVjdH0gcmVjb3JkIFRoZSBy
        ZWNvcmQgaW5zdGFuY2UKICAgIEByZXR1cm4ge1N0cmluZ30gVGhlIHJlY29y
        ZCdzIGNvbG9yCiAgICAgIFBvc3NpYmxlIG9wdGlvbnM6IGJsYWNrLCByZWQs
        IGJsdWUsIGdyZWVuCiAgKi8KICBnZXRSZWNvcmRDb2xvcjogZnVuY3Rpb24o
        cmVjb3JkKSB7CiAgICByZXR1cm4gbnVsbDsKICB9LAoKICAvKioKICAgIEBw
        cml2YXRlCgogICAgT2JzZXJ2ZXMgYWxsIHJlbGV2YW50IHByb3BlcnRpZXMg
        YW5kIHJlLXNlbmRzIHRoZSB3cmFwcGVkIHJlY29yZAogICAgd2hlbiBhIGNo
        YW5nZSBvY2N1cnMuCgogICAgQG1ldGhvZCBvYnNlcnZlclJlY29yZAogICAg
        QHBhcmFtIHtPYmplY3R9IHJlY29yZCBUaGUgcmVjb3JkIGluc3RhbmNlCiAg
        ICBAcGFyYW0ge0Z1bmN0aW9ufSByZWNvcmRVcGRhdGVkIFRoZSBjYWxsYmFj
        ayB0byBjYWxsIHdoZW4gYSByZWNvcmQgaXMgdXBkYXRlZC4KICAgIEByZXR1
        cm4ge0Z1bmN0aW9ufSBUaGUgZnVuY3Rpb24gdG8gY2FsbCB0byByZW1vdmUg
        YWxsIG9ic2VydmVycy4KICAqLwogIG9ic2VydmVSZWNvcmQ6IGZ1bmN0aW9u
        KHJlY29yZCwgcmVjb3JkVXBkYXRlZCkgewogICAgcmV0dXJuIGZ1bmN0aW9u
        KCl7fTsKICB9Cgp9KTsKCgp9KSgpOwoKCgooZnVuY3Rpb24oKSB7Ci8qKgpF
        bWJlciBFeHRlbnNpb24gU3VwcG9ydAoKQG1vZHVsZSBlbWJlcgpAc3VibW9k
        dWxlIGVtYmVyLWV4dGVuc2lvbi1zdXBwb3J0CkByZXF1aXJlcyBlbWJlci1h
        cHBsaWNhdGlvbgoqLwoKfSkoKTsKCihmdW5jdGlvbigpIHsKLyoqCiAgQG1v
        ZHVsZSBlbWJlcgogIEBzdWJtb2R1bGUgZW1iZXItdGVzdGluZwogKi8KdmFy
        IHNsaWNlID0gW10uc2xpY2UsCiAgICBoZWxwZXJzID0ge30sCiAgICBvcmln
        aW5hbE1ldGhvZHMgPSB7fSwKICAgIGluamVjdEhlbHBlcnNDYWxsYmFja3Mg
        PSBbXTsKCi8qKgogIFRoaXMgaXMgYSBjb250YWluZXIgZm9yIGFuIGFzc29y
        dG1lbnQgb2YgdGVzdGluZyByZWxhdGVkIGZ1bmN0aW9uYWxpdHk6CgogICog
        Q2hvb3NlIHlvdXIgZGVmYXVsdCB0ZXN0IGFkYXB0ZXIgKGZvciB5b3VyIGZy
        YW1ld29yayBvZiBjaG9pY2UpLgogICogUmVnaXN0ZXIvVW5yZWdpc3RlciBh
        ZGRpdGlvbmFsIHRlc3QgaGVscGVycy4KICAqIFNldHVwIGNhbGxiYWNrcyB0
        byBiZSBmaXJlZCB3aGVuIHRoZSB0ZXN0IGhlbHBlcnMgYXJlIGluamVjdGVk
        IGludG8KICAgIHlvdXIgYXBwbGljYXRpb24uCiAgCiAgQGNsYXNzIFRlc3QK
        ICBAbmFtZXNwYWNlIEVtYmVyCiovCkVtYmVyLlRlc3QgPSB7CgogIC8qKgog
        ICAgYHJlZ2lzdGVySGVscGVyYCBpcyB1c2VkIHRvIHJlZ2lzdGVyIGEgdGVz
        dCBoZWxwZXIgdGhhdCB3aWxsIGJlIGluamVjdGVkCiAgICB3aGVuIGBBcHAu
        aW5qZWN0VGVzdEhlbHBlcnNgIGlzIGNhbGxlZC4KCiAgICBUaGUgaGVscGVy
        IG1ldGhvZCB3aWxsIGFsd2F5cyBiZSBjYWxsZWQgd2l0aCB0aGUgY3VycmVu
        dCBBcHBsaWNhdGlvbiBhcwogICAgdGhlIGZpcnN0IHBhcmFtZXRlci4KCiAg
        ICBGb3IgZXhhbXBsZToKICAgIGBgYGphdmFzY3JpcHQKICAgICAgRW1iZXIu
        VGVzdC5yZWdpc3RlckhlbHBlcignYm9vdCcsIGZ1bmN0aW9uKGFwcCkgewog
        ICAgICAgIEVtYmVyLnJ1bihhcHAsIGFwcC5kZWZlclJlYWRpbmVzcyk7CiAg
        ICAgIH0pOwogICAgYGBgCgogICAgVGhpcyBoZWxwZXIgY2FuIGxhdGVyIGJl
        IGNhbGxlZCB3aXRob3V0IGFyZ3VtZW50cyBiZWNhdXNlIGl0IHdpbGwgYmUK
        ICAgIGNhbGxlZCB3aXRoIGBhcHBgIGFzIHRoZSBmaXJzdCBwYXJhbWV0ZXIu
        CgogICAgYGBgamF2YXNjcmlwdAogICAgICBBcHAgPSBFbWJlci5BcHBsaWNh
        dGlvbi5jcmVhdGUoKTsKICAgICAgQXBwLmluamVjdFRlc3RIZWxwZXJzKCk7
        CiAgICAgIGJvb3QoKTsKICAgIGBgYAoKICAgIFdoZW5ldmVyIHlvdSByZWdp
        c3RlciBhIGhlbHBlciB0aGF0IHBlcmZvcm1zIGFzeW5jIG9wZXJhdGlvbnMs
        IG1ha2Ugc3VyZQogICAgeW91IGByZXR1cm4gd2FpdCgpO2AgYXQgdGhlIGVu
        ZCBvZiB0aGUgaGVscGVyLgoKICAgIElmIGFuIGFzeW5jIGhlbHBlciBhbHNv
        IG5lZWRzIHRvIHJldHVybiBhIHZhbHVlLCBwYXNzIGl0IHRvIHRoZSBgd2Fp
        dGAKICAgIGhlbHBlciBhcyBhIGZpcnN0IGFyZ3VtZW50OgogICAgYHJldHVy
        biB3YWl0KHZhbCk7YAoKICAgIEBwdWJsaWMKICAgIEBtZXRob2QgcmVnaXN0
        ZXJIZWxwZXIKICAgIEBwYXJhbSB7U3RyaW5nfSBuYW1lIFRoZSBuYW1lIG9m
        IHRoZSBoZWxwZXIgbWV0aG9kIHRvIGFkZC4KICAgIEBwYXJhbSB7RnVuY3Rp
        b259IGhlbHBlck1ldGhvZAogICovCiAgcmVnaXN0ZXJIZWxwZXI6IGZ1bmN0
        aW9uKG5hbWUsIGhlbHBlck1ldGhvZCkgewogICAgaGVscGVyc1tuYW1lXSA9
        IGhlbHBlck1ldGhvZDsKICB9LAogIC8qKgogICAgUmVtb3ZlIGEgcHJldmlv
        dXNseSBhZGRlZCBoZWxwZXIgbWV0aG9kLgoKICAgIEV4YW1wbGU6CiAgICBg
        YGAKICAgIEVtYmVyLlRlc3QudW5yZWdpc3RlckhlbHBlcignd2FpdCcpOwog
        ICAgYGBgCgogICAgQHB1YmxpYwogICAgQG1ldGhvZCB1bnJlZ2lzdGVySGVs
        cGVyCiAgICBAcGFyYW0ge1N0cmluZ30gbmFtZSBUaGUgaGVscGVyIHRvIHJl
        bW92ZS4KICAqLwogIHVucmVnaXN0ZXJIZWxwZXI6IGZ1bmN0aW9uKG5hbWUp
        IHsKICAgIGRlbGV0ZSBoZWxwZXJzW25hbWVdOwogICAgaWYgKG9yaWdpbmFs
        TWV0aG9kc1tuYW1lXSkgewogICAgICB3aW5kb3dbbmFtZV0gPSBvcmlnaW5h
        bE1ldGhvZHNbbmFtZV07CiAgICB9CiAgICBkZWxldGUgb3JpZ2luYWxNZXRo
        b2RzW25hbWVdOwogIH0sCgogIC8qKgogICAgVXNlZCB0byByZWdpc3RlciBj
        YWxsYmFja3MgdG8gYmUgZmlyZWQgd2hlbmV2ZXIgYEFwcC5pbmplY3RUZXN0
        SGVscGVyc2AKICAgIGlzIGNhbGxlZC4KCiAgICBUaGUgY2FsbGJhY2sgd2ls
        bCByZWNlaXZlIHRoZSBjdXJyZW50IGFwcGxpY2F0aW9uIGFzIGFuIGFyZ3Vt
        ZW50LgoKICAgIEV4YW1wbGU6CiAgICBgYGAKICAgIEVtYmVyLlRlc3Qub25J
        bmplY3RIZWxwZXJzKGZ1bmN0aW9uKCkgewogICAgICBFbWJlci4kKGRvY3Vt
        ZW50KS5hamF4U3RhcnQoZnVuY3Rpb24oKSB7CiAgICAgICAgVGVzdC5wZW5k
        aW5nQWpheFJlcXVlc3RzKys7CiAgICAgIH0pOwoKICAgICAgRW1iZXIuJChk
        b2N1bWVudCkuYWpheFN0b3AoZnVuY3Rpb24oKSB7CiAgICAgICAgVGVzdC5w
        ZW5kaW5nQWpheFJlcXVlc3RzLS07CiAgICAgIH0pOwogICAgfSk7CiAgICBg
        YGAKCiAgICBAcHVibGljCiAgICBAbWV0aG9kIG9uSW5qZWN0SGVscGVycwog
        ICAgQHBhcmFtIHtGdW5jdGlvbn0gY2FsbGJhY2sgVGhlIGZ1bmN0aW9uIHRv
        IGJlIGNhbGxlZC4KICAqLwogIG9uSW5qZWN0SGVscGVyczogZnVuY3Rpb24o
        Y2FsbGJhY2spIHsKICAgIGluamVjdEhlbHBlcnNDYWxsYmFja3MucHVzaChj
        YWxsYmFjayk7CiAgfSwKCiAgLyoqCiAgICBUaGlzIHJldHVybnMgYSB0aGVu
        YWJsZSB0YWlsb3JlZCBmb3IgdGVzdGluZy4gIEl0IGNhdGNoZXMgZmFpbGVk
        CiAgICBgb25TdWNjZXNzYCBjYWxsYmFja3MgYW5kIGludm9rZXMgdGhlIGBF
        bWJlci5UZXN0LmFkYXB0ZXIuZXhjZXB0aW9uYAogICAgY2FsbGJhY2sgaW4g
        dGhlIGxhc3QgY2hhaW5lZCB0aGVuLgoKICAgIFRoaXMgbWV0aG9kIHNob3Vs
        ZCBiZSByZXR1cm5lZCBieSBhc3luYyBoZWxwZXJzIHN1Y2ggYXMgYHdhaXRg
        LgoKICAgIEBwdWJsaWMKICAgIEBtZXRob2QgcHJvbWlzZQogICAgQHBhcmFt
        IHtGdW5jdGlvbn0gcmVzb2x2ZXIgVGhlIGZ1bmN0aW9uIHVzZWQgdG8gcmVz
        b2x2ZSB0aGUgcHJvbWlzZS4KICAqLwogIHByb21pc2U6IGZ1bmN0aW9uKHJl
        c29sdmVyKSB7CiAgICB2YXIgcHJvbWlzZSA9IG5ldyBFbWJlci5SU1ZQLlBy
        b21pc2UocmVzb2x2ZXIpOwogICAgdmFyIHRoZW5hYmxlID0gewogICAgICBj
        aGFpbmVkOiBmYWxzZQogICAgfTsKICAgIHRoZW5hYmxlLnRoZW4gPSBmdW5j
        dGlvbihvblN1Y2Nlc3MsIG9uRmFpbHVyZSkgewogICAgICB2YXIgdGhlblBy
        b21pc2UsIG5leHRQcm9taXNlOwogICAgICB0aGVuYWJsZS5jaGFpbmVkID0g
        dHJ1ZTsKICAgICAgdGhlblByb21pc2UgPSBwcm9taXNlLnRoZW4ob25TdWNj
        ZXNzLCBvbkZhaWx1cmUpOwogICAgICAvLyB0aGlzIGlzIHRvIGVuc3VyZSBh
        bGwgZG93bnN0cmVhbSBmdWxmaWxsbWVudAogICAgICAvLyBoYW5kbGVycyBh
        cmUgd3JhcHBlZCBpbiB0aGUgZXJyb3IgaGFuZGxpbmcKICAgICAgbmV4dFBy
        b21pc2UgPSBFbWJlci5UZXN0LnByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSkg
        ewogICAgICAgIHJlc29sdmUodGhlblByb21pc2UpOwogICAgICB9KTsKICAg
        ICAgdGhlblByb21pc2UudGhlbihudWxsLCBmdW5jdGlvbihyZWFzb24pIHsK
        ICAgICAgICAvLyBlbnN1cmUgdGhpcyBpcyB0aGUgbGFzdCBwcm9taXNlIGlu
        IHRoZSBjaGFpbgogICAgICAgIC8vIGlmIG5vdCwgaWdub3JlIGFuZCB0aGUg
        ZXhjZXB0aW9uIHdpbGwgcHJvcGFnYXRlCiAgICAgICAgLy8gdGhpcyBwcmV2
        ZW50cyB0aGUgc2FtZSBlcnJvciBmcm9tIGJlaW5nIGZpcmVkIG11bHRpcGxl
        IHRpbWVzCiAgICAgICAgaWYgKCFuZXh0UHJvbWlzZS5jaGFpbmVkKSB7CiAg
        ICAgICAgICBFbWJlci5UZXN0LmFkYXB0ZXIuZXhjZXB0aW9uKHJlYXNvbik7
        CiAgICAgICAgfQogICAgICB9KTsKICAgICAgcmV0dXJuIG5leHRQcm9taXNl
        OwogICAgfTsKICAgIHJldHVybiB0aGVuYWJsZTsKICB9LAoKICAvKioKICAg
        VXNlZCB0byBhbGxvdyBlbWJlci10ZXN0aW5nIHRvIGNvbW11bmljYXRlIHdp
        dGggYSBzcGVjaWZpYyB0ZXN0aW5nCiAgIGZyYW1ld29yay4KCiAgIFlvdSBj
        YW4gbWFudWFsbHkgc2V0IGl0IGJlZm9yZSBjYWxsaW5nIGBBcHAuc2V0dXBG
        b3JUZXN0aW5nKClgLgoKICAgRXhhbXBsZToKICAgYGBgCiAgIEVtYmVyLlRl
        c3QuYWRhcHRlciA9IE15Q3VzdG9tQWRhcHRlci5jcmVhdGUoKQogICBgYGAK
        CiAgIElmIHlvdSBkbyBub3Qgc2V0IGl0LCBlbWJlci10ZXN0aW5nIHdpbGwg
        ZGVmYXVsdCB0byBgRW1iZXIuVGVzdC5RVW5pdEFkYXB0ZXJgLgoKICAgQHB1
        YmxpYwogICBAcHJvcGVydHkgYWRhcHRlcgogICBAdHlwZSB7Q2xhc3N9IFRo
        ZSBhZGFwdGVyIHRvIGJlIHVzZWQuCiAgIEBkZWZhdWx0IEVtYmVyLlRlc3Qu
        UVVuaXRBZGFwdGVyCiAgKi8KICBhZGFwdGVyOiBudWxsCn07CgpmdW5jdGlv
        biBjdXJyeShhcHAsIGZuKSB7CiAgcmV0dXJuIGZ1bmN0aW9uKCkgewogICAg
        dmFyIGFyZ3MgPSBzbGljZS5jYWxsKGFyZ3VtZW50cyk7CiAgICBhcmdzLnVu
        c2hpZnQoYXBwKTsKICAgIHJldHVybiBmbi5hcHBseShhcHAsIGFyZ3MpOwog
        IH07Cn0KCkVtYmVyLkFwcGxpY2F0aW9uLnJlb3Blbih7CiAgLyoqCiAgICBA
        cHJvcGVydHkgdGVzdEhlbHBlcnMKICAgIEB0eXBlIHtPYmplY3R9CiAgICBA
        ZGVmYXVsdCB7fQogICovCiAgdGVzdEhlbHBlcnM6IHt9LAoKICAvKioKICAg
        VGhpcyBob29rIGRlZmVycyB0aGUgcmVhZGluZXNzIG9mIHRoZSBhcHBsaWNh
        dGlvbiwgc28gdGhhdCB5b3UgY2FuIHN0YXJ0CiAgIHRoZSBhcHAgd2hlbiB5
        b3VyIHRlc3RzIGFyZSByZWFkeSB0byBydW4uIEl0IGFsc28gc2V0cyB0aGUg
        cm91dGVyJ3MKICAgbG9jYXRpb24gdG8gJ25vbmUnLCBzbyB0aGF0IHRoZSB3
        aW5kb3cncyBsb2NhdGlvbiB3aWxsIG5vdCBiZSBtb2RpZmllZAogICAocHJl
        dmVudGluZyBib3RoIGFjY2lkZW50YWwgbGVha2luZyBvZiBzdGF0ZSBiZXR3
        ZWVuIHRlc3RzIGFuZCBpbnRlcmZlcmVuY2UKICAgd2l0aCB5b3VyIHRlc3Rp
        bmcgZnJhbWV3b3JrKS4KCiAgIEV4YW1wbGU6CiAgYGBgCiAgQXBwLnNldHVw
        Rm9yVGVzdGluZygpOwogIGBgYAoKICAgIEBtZXRob2Qgc2V0dXBGb3JUZXN0
        aW5nCiAgKi8KICBzZXR1cEZvclRlc3Rpbmc6IGZ1bmN0aW9uKCkgewogICAg
        RW1iZXIudGVzdGluZyA9IHRydWU7CgogICAgdGhpcy5kZWZlclJlYWRpbmVz
        cygpOwoKICAgIHRoaXMuUm91dGVyLnJlb3Blbih7CiAgICAgIGxvY2F0aW9u
        OiAnbm9uZScKICAgIH0pOwoKICAgIC8vIGlmIGFkYXB0ZXIgaXMgbm90IG1h
        bnVhbGx5IHNldCBkZWZhdWx0IHRvIFFVbml0CiAgICBpZiAoIUVtYmVyLlRl
        c3QuYWRhcHRlcikgewogICAgICAgRW1iZXIuVGVzdC5hZGFwdGVyID0gRW1i
        ZXIuVGVzdC5RVW5pdEFkYXB0ZXIuY3JlYXRlKCk7CiAgICB9CiAgfSwKCiAg
        LyoqCiAgICBUaGlzIGluamVjdHMgdGhlIHRlc3QgaGVscGVycyBpbnRvIHRo
        ZSB3aW5kb3cncyBzY29wZS4gSWYgYSBmdW5jdGlvbiBvZiB0aGUKICAgIHNh
        bWUgbmFtZSBoYXMgYWxyZWFkeSBiZWVuIGRlZmluZWQgaXQgd2lsbCBiZSBj
        YWNoZWQgKHNvIHRoYXQgaXQgY2FuIGJlIHJlc2V0CiAgICBpZiB0aGUgaGVs
        cGVyIGlzIHJlbW92ZWQgd2l0aCBgdW5yZWdpc3RlckhlbHBlcmAgb3IgYHJl
        bW92ZVRlc3RIZWxwZXJzYCkuCgogICBBbnkgY2FsbGJhY2tzIHJlZ2lzdGVy
        ZWQgd2l0aCBgb25JbmplY3RIZWxwZXJzYCB3aWxsIGJlIGNhbGxlZCBvbmNl
        IHRoZQogICBoZWxwZXJzIGhhdmUgYmVlbiBpbmplY3RlZC4KCiAgRXhhbXBs
        ZToKICBgYGAKICBBcHAuaW5qZWN0VGVzdEhlbHBlcnMoKTsKICBgYGAKCiAg
        ICBAbWV0aG9kIGluamVjdFRlc3RIZWxwZXJzCiAgKi8KICBpbmplY3RUZXN0
        SGVscGVyczogZnVuY3Rpb24oKSB7CiAgICB0aGlzLnRlc3RIZWxwZXJzID0g
        e307CiAgICBmb3IgKHZhciBuYW1lIGluIGhlbHBlcnMpIHsKICAgICAgb3Jp
        Z2luYWxNZXRob2RzW25hbWVdID0gd2luZG93W25hbWVdOwogICAgICB0aGlz
        LnRlc3RIZWxwZXJzW25hbWVdID0gd2luZG93W25hbWVdID0gY3VycnkodGhp
        cywgaGVscGVyc1tuYW1lXSk7CiAgICB9CgogICAgZm9yKHZhciBpID0gMCwg
        bCA9IGluamVjdEhlbHBlcnNDYWxsYmFja3MubGVuZ3RoOyBpIDwgbDsgaSsr
        KSB7CiAgICAgIGluamVjdEhlbHBlcnNDYWxsYmFja3NbaV0odGhpcyk7CiAg
        ICB9CiAgfSwKCiAgLyoqCiAgICBUaGlzIHJlbW92ZXMgYWxsIGhlbHBlcnMg
        dGhhdCBoYXZlIGJlZW4gcmVnaXN0ZXJlZCwgYW5kIHJlc2V0cyBhbmQgZnVu
        Y3Rpb25zCiAgICB0aGF0IHdlcmUgb3ZlcnJpZGRlbiBieSB0aGUgaGVscGVy
        cy4KCiAgICBFeGFtcGxlOgogICAgYGBgCiAgICBBcHAucmVtb3ZlVGVzdEhl
        bHBlcnMoKTsKICAgIGBgYAoKICAgIEBwdWJsaWMKICAgIEBtZXRob2QgcmVt
        b3ZlVGVzdEhlbHBlcnMKICAqLwogIHJlbW92ZVRlc3RIZWxwZXJzOiBmdW5j
        dGlvbigpIHsKICAgIGZvciAodmFyIG5hbWUgaW4gaGVscGVycykgewogICAg
        ICB3aW5kb3dbbmFtZV0gPSBvcmlnaW5hbE1ldGhvZHNbbmFtZV07CiAgICAg
        IGRlbGV0ZSB0aGlzLnRlc3RIZWxwZXJzW25hbWVdOwogICAgICBkZWxldGUg
        b3JpZ2luYWxNZXRob2RzW25hbWVdOwogICAgfQogIH0KfSk7Cgp9KSgpOwoK
        CgooZnVuY3Rpb24oKSB7Ci8qKgogIEBtb2R1bGUgZW1iZXIKICBAc3VibW9k
        dWxlIGVtYmVyLXRlc3RpbmcKICovCgp2YXIgJCA9IEVtYmVyLiQ7CgovKioK
        ICBUaGlzIG1ldGhvZCBjcmVhdGVzIGEgY2hlY2tib3ggYW5kIHRyaWdnZXJz
        IHRoZSBjbGljayBldmVudCB0byBmaXJlIHRoZQogIHBhc3NlZCBpbiBoYW5k
        bGVyLiBJdCBpcyB1c2VkIHRvIGNvcnJlY3QgZm9yIGEgYnVnIGluIG9sZGVy
        IHZlcnNpb25zCiAgb2YgalF1ZXJ5IChlLmcgMS44LjMpLgoKICBAcHJpdmF0
        ZQogIEBtZXRob2QgdGVzdENoZWNrYm94Q2xpY2sKKi8KZnVuY3Rpb24gdGVz
        dENoZWNrYm94Q2xpY2soaGFuZGxlcikgewogICQoJzxpbnB1dCB0eXBlPSJj
        aGVja2JveCI+JykKICAgIC5jc3MoeyBwb3NpdGlvbjogJ2Fic29sdXRlJywg
        bGVmdDogJy0xMDAwcHgnLCB0b3A6ICctMTAwMHB4JyB9KQogICAgLmFwcGVu
        ZFRvKCdib2R5JykKICAgIC5vbignY2xpY2snLCBoYW5kbGVyKQogICAgLmNs
        aWNrKCkKICAgIC5yZW1vdmUoKTsKfQoKJChmdW5jdGlvbigpIHsKICAvKgog
        ICAgRGV0ZXJtaW5lIHdoZXRoZXIgYSBjaGVja2JveCBjaGVja2VkIHVzaW5n
        IGpRdWVyeSdzICJjbGljayIgbWV0aG9kIHdpbGwgaGF2ZQogICAgdGhlIGNv
        cnJlY3QgdmFsdWUgZm9yIGl0cyBjaGVja2VkIHByb3BlcnR5LgoKICAgIElm
        IHdlIGRldGVybWluZSB0aGF0IHRoZSBjdXJyZW50IGpRdWVyeSB2ZXJzaW9u
        IGV4aGliaXRzIHRoaXMgYmVoYXZpb3IsCiAgICBwYXRjaCBpdCB0byB3b3Jr
        IGNvcnJlY3RseSBhcyBpbiB0aGUgY29tbWl0IGZvciB0aGUgYWN0dWFsIGZp
        eDoKICAgIGh0dHBzOi8vZ2l0aHViLmNvbS9qcXVlcnkvanF1ZXJ5L2NvbW1p
        dC8xZmIyZjkyLgogICovCiAgdGVzdENoZWNrYm94Q2xpY2soZnVuY3Rpb24o
        KSB7CiAgICBpZiAoIXRoaXMuY2hlY2tlZCAmJiAhJC5ldmVudC5zcGVjaWFs
        LmNsaWNrKSB7CiAgICAgICQuZXZlbnQuc3BlY2lhbC5jbGljayA9IHsKICAg
        ICAgICAvLyBGb3IgY2hlY2tib3gsIGZpcmUgbmF0aXZlIGV2ZW50IHNvIGNo
        ZWNrZWQgc3RhdGUgd2lsbCBiZSByaWdodAogICAgICAgIHRyaWdnZXI6IGZ1
        bmN0aW9uKCkgewogICAgICAgICAgaWYgKCQubm9kZU5hbWUoIHRoaXMsICJp
        bnB1dCIgKSAmJiB0aGlzLnR5cGUgPT09ICJjaGVja2JveCIgJiYgdGhpcy5j
        bGljaykgewogICAgICAgICAgICB0aGlzLmNsaWNrKCk7CiAgICAgICAgICAg
        IHJldHVybiBmYWxzZTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH07
        CiAgICB9CiAgfSk7CgogIC8vIFRyeSBhZ2FpbiB0byB2ZXJpZnkgdGhhdCB0
        aGUgcGF0Y2ggdG9vayBlZmZlY3Qgb3IgYmxvdyB1cC4KICB0ZXN0Q2hlY2ti
        b3hDbGljayhmdW5jdGlvbigpIHsKICAgIEVtYmVyLndhcm4oImNsaWNrZWQg
        Y2hlY2tib3hlcyBzaG91bGQgYmUgY2hlY2tlZCEgdGhlIGpRdWVyeSBwYXRj
        aCBkaWRuJ3Qgd29yayIsIHRoaXMuY2hlY2tlZCk7CiAgfSk7Cn0pOwoKfSko
        KTsKCgoKKGZ1bmN0aW9uKCkgewovKioKIEBtb2R1bGUgZW1iZXIKIEBzdWJt
        b2R1bGUgZW1iZXItdGVzdGluZwoqLwoKdmFyIFRlc3QgPSBFbWJlci5UZXN0
        OwoKLyoqCiAgVGhlIHByaW1hcnkgcHVycG9zZSBvZiB0aGlzIGNsYXNzIGlz
        IHRvIGNyZWF0ZSBob29rcyB0aGF0IGNhbiBiZSBpbXBsZW1lbnRlZAogIGJ5
        IGFuIGFkYXB0ZXIgZm9yIHZhcmlvdXMgdGVzdCBmcmFtZXdvcmtzLgoKICBA
        Y2xhc3MgQWRhcHRlcgogIEBuYW1lc3BhY2UgRW1iZXIuVGVzdAoqLwpUZXN0
        LkFkYXB0ZXIgPSBFbWJlci5PYmplY3QuZXh0ZW5kKHsKICAvKioKICAgIFRo
        aXMgY2FsbGJhY2sgd2lsbCBiZSBjYWxsZWQgd2hlbmV2ZXIgYW4gYXN5bmMg
        b3BlcmF0aW9uIGlzIGFib3V0IHRvIHN0YXJ0LgoKICAgIE92ZXJyaWRlIHRo
        aXMgdG8gY2FsbCB5b3VyIGZyYW1ld29yaydzIG1ldGhvZHMgdGhhdCBoYW5k
        bGUgYXN5bmMKICAgIG9wZXJhdGlvbnMuCgogICAgQHB1YmxpYwogICAgQG1l
        dGhvZCBhc3luY1N0YXJ0CiAgKi8KICBhc3luY1N0YXJ0OiBFbWJlci5LLAoK
        ICAvKioKICAgIFRoaXMgY2FsbGJhY2sgd2lsbCBiZSBjYWxsZWQgd2hlbmV2
        ZXIgYW4gYXN5bmMgb3BlcmF0aW9uIGhhcyBjb21wbGV0ZWQuCgogICAgQHB1
        YmxpYwogICAgQG1ldGhvZCBhc3luY0VuZAogICovCiAgYXN5bmNFbmQ6IEVt
        YmVyLkssCgogIC8qKgogICAgT3ZlcnJpZGUgdGhpcyBtZXRob2Qgd2l0aCB5
        b3VyIHRlc3RpbmcgZnJhbWV3b3JrJ3MgZmFsc2UgYXNzZXJ0aW9uLgogICAg
        VGhpcyBmdW5jdGlvbiBpcyBjYWxsZWQgd2hlbmV2ZXIgYW4gZXhjZXB0aW9u
        IG9jY3VycyBjYXVzaW5nIHRoZSB0ZXN0aW5nCiAgICBwcm9taXNlIHRvIGZh
        aWwuCgogICAgUVVuaXQgZXhhbXBsZToKCiAgICBgYGBqYXZhc2NyaXB0CiAg
        ICAgIGV4Y2VwdGlvbjogZnVuY3Rpb24oZXJyb3IpIHsKICAgICAgICBvayhm
        YWxzZSwgZXJyb3IpOwogICAgICB9OwogICAgYGBgCgogICAgQHB1YmxpYwog
        ICAgQG1ldGhvZCBleGNlcHRpb24KICAgIEBwYXJhbSB7U3RyaW5nfSBlcnJv
        ciBUaGUgZXhjZXB0aW9uIHRvIGJlIHJhaXNlZC4KICAqLwogIGV4Y2VwdGlv
        bjogZnVuY3Rpb24oZXJyb3IpIHsKICAgIHNldFRpbWVvdXQoZnVuY3Rpb24o
        KSB7CiAgICAgIHRocm93IGVycm9yOwogICAgfSk7CiAgfQp9KTsKCi8qKgog
        IFRoaXMgY2xhc3MgaW1wbGVtZW50cyB0aGUgbWV0aG9kcyBkZWZpbmVkIGJ5
        IEVtYmVyLlRlc3QuQWRhcHRlciBmb3IgdGhlCiAgUVVuaXQgdGVzdGluZyBm
        cmFtZXdvcmsuCgogIEBjbGFzcyBRVW5pdEFkYXB0ZXIKICBAbmFtZXNwYWNl
        IEVtYmVyLlRlc3QKICBAZXh0ZW5kcyBFbWJlci5UZXN0LkFkYXB0ZXIKKi8K
        VGVzdC5RVW5pdEFkYXB0ZXIgPSBUZXN0LkFkYXB0ZXIuZXh0ZW5kKHsKICBh
        c3luY1N0YXJ0OiBmdW5jdGlvbigpIHsKICAgIHN0b3AoKTsKICB9LAogIGFz
        eW5jRW5kOiBmdW5jdGlvbigpIHsKICAgIHN0YXJ0KCk7CiAgfSwKICBleGNl
        cHRpb246IGZ1bmN0aW9uKGVycm9yKSB7CiAgICBvayhmYWxzZSwgRW1iZXIu
        aW5zcGVjdChlcnJvcikpOwogIH0KfSk7Cgp9KSgpOwoKCgooZnVuY3Rpb24o
        KSB7Ci8qKgoqIEBtb2R1bGUgZW1iZXIKKiBAc3VibW9kdWxlIGVtYmVyLXRl
        c3RpbmcKKi8KCnZhciBnZXQgPSBFbWJlci5nZXQsCiAgICBUZXN0ID0gRW1i
        ZXIuVGVzdCwKICAgIGhlbHBlciA9IFRlc3QucmVnaXN0ZXJIZWxwZXIsCiAg
        ICBjb3VudEFzeW5jID0gMDsKClRlc3QucGVuZGluZ0FqYXhSZXF1ZXN0cyA9
        IDA7CgpUZXN0Lm9uSW5qZWN0SGVscGVycyhmdW5jdGlvbigpIHsKICBFbWJl
        ci4kKGRvY3VtZW50KS5hamF4U3RhcnQoZnVuY3Rpb24oKSB7CiAgICBUZXN0
        LnBlbmRpbmdBamF4UmVxdWVzdHMrKzsKICB9KTsKCiAgRW1iZXIuJChkb2N1
        bWVudCkuYWpheFN0b3AoZnVuY3Rpb24oKSB7CiAgICBFbWJlci5hc3NlcnQo
        IkFuIGFqYXhTdG9wIGV2ZW50IHdoaWNoIHdvdWxkIGNhdXNlIHRoZSBudW1i
        ZXIgb2YgcGVuZGluZyBBSkFYIHJlcXVlc3RzIHRvIGJlIG5lZ2F0aXZlIGhh
        cyBiZWVuIHRyaWdnZXJlZC4gVGhpcyBpcyBtb3N0IGxpa2VseSBjYXVzZWQg
        YnkgQUpBWCBldmVudHMgdGhhdCB3ZXJlIHN0YXJ0ZWQgYmVmb3JlIGNhbGxp
        bmcgYGluamVjdFRlc3RIZWxwZXJzKClgLiIsIFRlc3QucGVuZGluZ0FqYXhS
        ZXF1ZXN0cyAhPT0gMCk7CiAgICBUZXN0LnBlbmRpbmdBamF4UmVxdWVzdHMt
        LTsKICB9KTsKfSk7CgoKZnVuY3Rpb24gdmlzaXQoYXBwLCB1cmwpIHsKICBh
        cHAuX19jb250YWluZXJfXy5sb29rdXAoJ3JvdXRlcjptYWluJykubG9jYXRp
        b24uc2V0VVJMKHVybCk7CiAgRW1iZXIucnVuKGFwcCwgYXBwLmhhbmRsZVVS
        TCwgdXJsKTsKICByZXR1cm4gd2FpdChhcHApOwp9CgpmdW5jdGlvbiBjbGlj
        ayhhcHAsIHNlbGVjdG9yLCBjb250ZXh0KSB7CiAgdmFyICRlbCA9IGZpbmRX
        aXRoQXNzZXJ0KGFwcCwgc2VsZWN0b3IsIGNvbnRleHQpOwogIEVtYmVyLnJ1
        bigkZWwsICdtb3VzZWRvd24nKTsKCiAgaWYgKCRlbC5pcygnOmlucHV0Jykp
        IHsKICAgIHZhciB0eXBlID0gJGVsLnByb3AoJ3R5cGUnKTsKICAgIGlmICh0
        eXBlICE9PSAnY2hlY2tib3gnICYmIHR5cGUgIT09ICdyYWRpbycgJiYgdHlw
        ZSAhPT0gJ2hpZGRlbicpIHsKICAgICAgRW1iZXIucnVuKCRlbCwgZnVuY3Rp
        b24oKXsKICAgICAgICAvLyBGaXJlZm94IGRvZXMgbm90IHRyaWdnZXIgdGhl
        IGBmb2N1c2luYCBldmVudCBpZiB0aGUgd2luZG93CiAgICAgICAgLy8gZG9l
        cyBub3QgaGF2ZSBmb2N1cy4gSWYgdGhlIGRvY3VtZW50IGRvZXNuJ3QgaGF2
        ZSBmb2N1cyBqdXN0CiAgICAgICAgLy8gdXNlIHRyaWdnZXIoJ2ZvY3VzaW4n
        KSBpbnN0ZWFkLgogICAgICAgIGlmICghZG9jdW1lbnQuaGFzRm9jdXMgfHwg
        ZG9jdW1lbnQuaGFzRm9jdXMoKSkgewogICAgICAgICAgdGhpcy5mb2N1cygp
        OwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aGlzLnRyaWdnZXIoJ2Zv
        Y3VzaW4nKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfQogIH0KCiAgRW1i
        ZXIucnVuKCRlbCwgJ21vdXNldXAnKTsKICBFbWJlci5ydW4oJGVsLCAnY2xp
        Y2snKTsKCiAgcmV0dXJuIHdhaXQoYXBwKTsKfQoKZnVuY3Rpb24ga2V5RXZl
        bnQoYXBwLCBzZWxlY3RvciwgY29udGV4dCwgdHlwZSwga2V5Q29kZSkgewog
        IHZhciAkZWw7CiAgaWYgKHR5cGVvZiBrZXlDb2RlID09PSAndW5kZWZpbmVk
        JykgewogICAga2V5Q29kZSA9IHR5cGU7CiAgICB0eXBlID0gY29udGV4dDsK
        ICAgIGNvbnRleHQgPSBudWxsOwogIH0KICAkZWwgPSBmaW5kV2l0aEFzc2Vy
        dChhcHAsIHNlbGVjdG9yLCBjb250ZXh0KTsKICB2YXIgZXZlbnQgPSBFbWJl
        ci4kLkV2ZW50KHR5cGUsIHsga2V5Q29kZToga2V5Q29kZSB9KTsKICBFbWJl
        ci5ydW4oJGVsLCAndHJpZ2dlcicsIGV2ZW50KTsKICByZXR1cm4gd2FpdChh
        cHApOwp9CgpmdW5jdGlvbiBmaWxsSW4oYXBwLCBzZWxlY3RvciwgY29udGV4
        dCwgdGV4dCkgewogIHZhciAkZWw7CiAgaWYgKHR5cGVvZiB0ZXh0ID09PSAn
        dW5kZWZpbmVkJykgewogICAgdGV4dCA9IGNvbnRleHQ7CiAgICBjb250ZXh0
        ID0gbnVsbDsKICB9CiAgJGVsID0gZmluZFdpdGhBc3NlcnQoYXBwLCBzZWxl
        Y3RvciwgY29udGV4dCk7CiAgRW1iZXIucnVuKGZ1bmN0aW9uKCkgewogICAg
        JGVsLnZhbCh0ZXh0KS5jaGFuZ2UoKTsKICB9KTsKICByZXR1cm4gd2FpdChh
        cHApOwp9CgpmdW5jdGlvbiBmaW5kV2l0aEFzc2VydChhcHAsIHNlbGVjdG9y
        LCBjb250ZXh0KSB7CiAgdmFyICRlbCA9IGZpbmQoYXBwLCBzZWxlY3Rvciwg
        Y29udGV4dCk7CiAgaWYgKCRlbC5sZW5ndGggPT09IDApIHsKICAgIHRocm93
        IG5ldyBFbWJlci5FcnJvcigiRWxlbWVudCAiICsgc2VsZWN0b3IgKyAiIG5v
        dCBmb3VuZC4iKTsKICB9CiAgcmV0dXJuICRlbDsKfQoKZnVuY3Rpb24gZmlu
        ZChhcHAsIHNlbGVjdG9yLCBjb250ZXh0KSB7CiAgdmFyICRlbDsKICBjb250
        ZXh0ID0gY29udGV4dCB8fCBnZXQoYXBwLCAncm9vdEVsZW1lbnQnKTsKICAk
        ZWwgPSBhcHAuJChzZWxlY3RvciwgY29udGV4dCk7CgogIHJldHVybiAkZWw7
        Cn0KCmZ1bmN0aW9uIHdhaXQoYXBwLCB2YWx1ZSkgewogIHZhciBwcm9taXNl
        OwoKICBwcm9taXNlID0gVGVzdC5wcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUp
        IHsKICAgIGlmICgrK2NvdW50QXN5bmMgPT09IDEpIHsKICAgICAgVGVzdC5h
        ZGFwdGVyLmFzeW5jU3RhcnQoKTsKICAgIH0KICAgIHZhciB3YXRjaGVyID0g
        c2V0SW50ZXJ2YWwoZnVuY3Rpb24oKSB7CiAgICAgIHZhciByb3V0ZXJJc0xv
        YWRpbmcgPSBhcHAuX19jb250YWluZXJfXy5sb29rdXAoJ3JvdXRlcjptYWlu
        Jykucm91dGVyLmlzTG9hZGluZzsKICAgICAgaWYgKHJvdXRlcklzTG9hZGlu
        ZykgeyByZXR1cm47IH0KICAgICAgaWYgKFRlc3QucGVuZGluZ0FqYXhSZXF1
        ZXN0cykgeyByZXR1cm47IH0KICAgICAgaWYgKEVtYmVyLnJ1bi5oYXNTY2hl
        ZHVsZWRUaW1lcnMoKSB8fCBFbWJlci5ydW4uY3VycmVudFJ1bkxvb3ApIHsg
        cmV0dXJuOyB9CgogICAgICBjbGVhckludGVydmFsKHdhdGNoZXIpOwoKICAg
        ICAgaWYgKC0tY291bnRBc3luYyA9PT0gMCkgewogICAgICAgIFRlc3QuYWRh
        cHRlci5hc3luY0VuZCgpOwogICAgICB9CgogICAgICBFbWJlci5ydW4obnVs
        bCwgcmVzb2x2ZSwgdmFsdWUpOwogICAgfSwgMTApOwogIH0pOwoKICByZXR1
        cm4gYnVpbGRDaGFpbk9iamVjdChhcHAsIHByb21pc2UpOwp9CgovKgogQnVp
        bGRzIGFuIG9iamVjdCB0aGF0IGNvbnRhaW5zIGFsbCBoZWxwZXIgbWV0aG9k
        cy4gVGhpcyBvYmplY3Qgd2lsbCBiZQogcmV0dXJuZWQgYnkgaGVscGVycyBh
        bmQgdGhlbi1wcm9taXNlcy4KCiBUaGlzIGFsbG93cyB1cyB0byBjaGFpbiBo
        ZWxwZXJzOgoKIGBgYGphdmFzY3JpcHQKICB2aXNpdCgncG9zdHMvbmV3JykK
        ICAuY2xpY2soJy5hZGQtYnRuJykKICAuZmlsbEluKCcudGl0bGUnLCAnUG9z
        dCcpCiAgLmNsaWNrKCcuc3VibWl0JykKICAudGhlbihmdW5jdGlvbigpIHsK
        ICAgIGVxdWFsKCcucG9zdC10aXRsZScsICdQb3N0Jyk7CiAgfSkKICAudmlz
        aXQoJ2NvbW1lbnRzJykKICAudGhlbihmdW5jdGlvbigpIHsKICAgIGVxdWFs
        KGZpbmQoJy5jb21tZW50cycpLGxlbmd0aCwgMCk7CiAgfSk7CiBgYGAKCiBA
        bWV0aG9kIGJ1aWxkQ2hhaW5PYmplY3QKIEBwYXJhbSB7RW1iZXIuQXBwbGlj
        YXRpb259IGFwcAogQHBhcmFtIHtFbWJlci5SU1ZQLlByb21pc2V9IHByb21p
        c2UKIEByZXR1cm4ge09iamVjdH0gQSBuZXcgb2JqZWN0IHdpdGggcHJvcGVy
        dGllcyBmb3IgZWFjaAogICAgICAgICAgICAgICAgICBvZiBhcHAncyBoZWxw
        ZXJzIHRvIGJlIHVzZWQgZm9yIGNvbnRpbnVlZAogICAgICAgICAgICAgICAg
        ICBtZXRob2QgY2hhaW5pbmcgKHVzaW5nIHByb21pc2VzKS4KKi8KZnVuY3Rp
        b24gYnVpbGRDaGFpbk9iamVjdChhcHAsIHByb21pc2UpIHsKICB2YXIgaGVs
        cGVyTmFtZSwgb2JqID0ge307CiAgZm9yKGhlbHBlck5hbWUgaW4gYXBwLnRl
        c3RIZWxwZXJzKSB7CiAgICBvYmpbaGVscGVyTmFtZV0gPSBjaGFpbihhcHAs
        IHByb21pc2UsIGFwcC50ZXN0SGVscGVyc1toZWxwZXJOYW1lXSk7CiAgfQog
        IG9iai50aGVuID0gZnVuY3Rpb24oZm4pIHsKICAgIHZhciB0aGVuUHJvbWlz
        ZSA9IHByb21pc2UudGhlbihmbik7CiAgICByZXR1cm4gYnVpbGRDaGFpbk9i
        amVjdChhcHAsIHRoZW5Qcm9taXNlKTsKICB9OwogIHJldHVybiBvYmo7Cn0K
        Ci8qCiAgVXNlZCBpbiBjb25qdW5jdGlvbiB3aXRoIGJ1aWxkQ2hhaW5PYmpl
        Y3QgdG8gc2V0dXAgYQogIGNvbnRpbnVlZCBjaGFpbiBvZiBtZXRob2QgY2Fs
        bHMgKHdpdGggcHJvbWlzZXMpCgogIEBtZXRob2QgY2hhaW4KICBAcGFyYW0g
        e0VtYmVyLkFwcGxpY2F0aW9ufSBhcHAKICBAcGFyYW0ge0VtYmVyLlJTVlAu
        UHJvbWlzZX0gcHJvbWlzZQogIEBwYXJhbSB7RnVuY3Rpb259IGZuCiovCmZ1
        bmN0aW9uIGNoYWluKGFwcCwgcHJvbWlzZSwgZm4pIHsKICByZXR1cm4gZnVu
        Y3Rpb24oKSB7CiAgICB2YXIgYXJncyA9IGFyZ3VtZW50cywgY2hhaW5lZFBy
        b21pc2U7CiAgICBjaGFpbmVkUHJvbWlzZSA9IHByb21pc2UudGhlbihmdW5j
        dGlvbigpIHsKICAgICAgcmV0dXJuIGZuLmFwcGx5KG51bGwsIGFyZ3MpOwog
        ICAgfSk7CiAgICByZXR1cm4gYnVpbGRDaGFpbk9iamVjdChhcHAsIGNoYWlu
        ZWRQcm9taXNlKTsKICB9Owp9CgovKioKKiBMb2FkcyBhIHJvdXRlLCBzZXRz
        IHVwIGFueSBjb250cm9sbGVycywgYW5kIHJlbmRlcnMgYW55IHRlbXBsYXRl
        cyBhc3NvY2lhdGVkCiogd2l0aCB0aGUgcm91dGUgYXMgdGhvdWdoIGEgcmVh
        bCB1c2VyIGhhZCB0cmlnZ2VyZWQgdGhlIHJvdXRlIGNoYW5nZSB3aGlsZQoq
        IHVzaW5nIHlvdXIgYXBwLgoqCiogRXhhbXBsZToKKgoqIGBgYAoqIHZpc2l0
        KCdwb3N0cy9pbmRleCcpLnRoZW4oZnVuY3Rpb24oKSB7CiogICAvLyBhc3Nl
        cnQgc29tZXRoaW5nCiogfSk7CiogYGBgCioKKiBAbWV0aG9kIHZpc2l0Ciog
        QHBhcmFtIHtTdHJpbmd9IHVybCB0aGUgbmFtZSBvZiB0aGUgcm91dGUKKiBA
        cmV0dXJuIHtSU1ZQLlByb21pc2V9CiovCmhlbHBlcigndmlzaXQnLCB2aXNp
        dCk7CgovKioKKiBDbGlja3MgYW4gZWxlbWVudCBhbmQgdHJpZ2dlcnMgYW55
        IGFjdGlvbnMgdHJpZ2dlcmVkIGJ5IHRoZSBlbGVtZW50J3MgYGNsaWNrYAoq
        IGV2ZW50LgoqCiogRXhhbXBsZToKKgoqIGBgYAoqIGNsaWNrKCcuc29tZS1q
        UXVlcnktc2VsZWN0b3InKS50aGVuKGZ1bmN0aW9uKCkgewoqICAvLyBhc3Nl
        cnQgc29tZXRoaW5nCiogfSk7CiogYGBgCioKKiBAbWV0aG9kIGNsaWNrCiog
        QHBhcmFtIHtTdHJpbmd9IHNlbGVjdG9yIGpRdWVyeSBzZWxlY3RvciBmb3Ig
        ZmluZGluZyBlbGVtZW50IG9uIHRoZSBET00KKiBAcmV0dXJuIHtSU1ZQLlBy
        b21pc2V9CiovCmhlbHBlcignY2xpY2snLCBjbGljayk7CgovKioKKiBTaW11
        bGF0ZXMgYSBrZXkgZXZlbnQsIGUuZy4gYGtleXByZXNzYCwgYGtleWRvd25g
        LCBga2V5dXBgIHdpdGggdGhlIGRlc2lyZWQga2V5Q29kZQoqCiogRXhhbXBs
        ZToKKgoqIGBgYAoqIGtleUV2ZW50KCcuc29tZS1qUXVlcnktc2VsZWN0b3In
        LCAna2V5cHJlc3MnLCAxMykudGhlbihmdW5jdGlvbigpIHsKKiAgLy8gYXNz
        ZXJ0IHNvbWV0aGluZwoqIH0pOwoqIGBgYAoqCiogQG1ldGhvZCBrZXlFdmVu
        dAoqIEBwYXJhbSB7U3RyaW5nfSBzZWxlY3RvciBqUXVlcnkgc2VsZWN0b3Ig
        Zm9yIGZpbmRpbmcgZWxlbWVudCBvbiB0aGUgRE9NCiogQHBhcmFtIHtTdHJp
        bmd9IHRoZSB0eXBlIG9mIGtleSBldmVudCwgZS5nLiBga2V5cHJlc3NgLCBg
        a2V5ZG93bmAsIGBrZXl1cGAKKiBAcGFyYW0ge051bWJlcn0gdGhlIGtleUNv
        ZGUgb2YgdGhlIHNpbXVsYXRlZCBrZXkgZXZlbnQKKiBAcmV0dXJuIHtSU1ZQ
        LlByb21pc2V9CiovCmhlbHBlcigna2V5RXZlbnQnLCBrZXlFdmVudCk7Cgov
        KioKKiBGaWxscyBpbiBhbiBpbnB1dCBlbGVtZW50IHdpdGggc29tZSB0ZXh0
        LgoqCiogRXhhbXBsZToKKgoqIGBgYAoqIGZpbGxJbignI2VtYWlsJywgJ3lv
        dUBleGFtcGxlLmNvbScpLnRoZW4oZnVuY3Rpb24oKSB7CiogICAvLyBhc3Nl
        cnQgc29tZXRoaW5nCiogfSk7CiogYGBgCioKKiBAbWV0aG9kIGZpbGxJbgoq
        IEBwYXJhbSB7U3RyaW5nfSBzZWxlY3RvciBqUXVlcnkgc2VsZWN0b3IgZmlu
        ZGluZyBhbiBpbnB1dCBlbGVtZW50IG9uIHRoZSBET00KKiB0byBmaWxsIHRl
        eHQgd2l0aAoqIEBwYXJhbSB7U3RyaW5nfSB0ZXh0IHRleHQgdG8gcGxhY2Ug
        aW5zaWRlIHRoZSBpbnB1dCBlbGVtZW50CiogQHJldHVybiB7UlNWUC5Qcm9t
        aXNlfQoqLwpoZWxwZXIoJ2ZpbGxJbicsIGZpbGxJbik7CgovKioKKiBGaW5k
        cyBhbiBlbGVtZW50IGluIHRoZSBjb250ZXh0IG9mIHRoZSBhcHAncyBjb250
        YWluZXIgZWxlbWVudC4gQSBzaW1wbGUgYWxpYXMKKiBmb3IgYGFwcC4kKHNl
        bGVjdG9yKWAuCioKKiBFeGFtcGxlOgoqCiogYGBgCiogdmFyICRlbCA9IGZp
        bmQoJy5teS1zZWxlY3Rvcik7CiogYGBgCioKKiBAbWV0aG9kIGZpbmQKKiBA
        cGFyYW0ge1N0cmluZ30gc2VsZWN0b3IgalF1ZXJ5IHN0cmluZyBzZWxlY3Rv
        ciBmb3IgZWxlbWVudCBsb29rdXAKKiBAcmV0dXJuIHtPYmplY3R9IGpRdWVy
        eSBvYmplY3QgcmVwcmVzZW50aW5nIHRoZSByZXN1bHRzIG9mIHRoZSBxdWVy
        eQoqLwpoZWxwZXIoJ2ZpbmQnLCBmaW5kKTsKCi8qKgoqCiogTGlrZSBgZmlu
        ZGAsIGJ1dCB0aHJvd3MgYW4gZXJyb3IgaWYgdGhlIGVsZW1lbnQgc2VsZWN0
        b3IgcmV0dXJucyBubyByZXN1bHRzCioKKiBFeGFtcGxlOgoqCiogYGBgCiog
        dmFyICRlbCA9IGZpbmRXaXRoQXNzZXJ0KCcuZG9lc250LWV4aXN0Jyk7IC8v
        IHRocm93cyBlcnJvcgoqIGBgYAoqCiogQG1ldGhvZCBmaW5kV2l0aEFzc2Vy
        dAoqIEBwYXJhbSB7U3RyaW5nfSBzZWxlY3RvciBqUXVlcnkgc2VsZWN0b3Ig
        c3RyaW5nIGZvciBmaW5kaW5nIGFuIGVsZW1lbnQgd2l0aGluCiogdGhlIERP
        TQoqIEByZXR1cm4ge09iamVjdH0galF1ZXJ5IG9iamVjdCByZXByZXNlbnRp
        bmcgdGhlIHJlc3VsdHMgb2YgdGhlIHF1ZXJ5CiogQHRocm93cyB7RXJyb3J9
        IHRocm93cyBlcnJvciBpZiBqUXVlcnkgb2JqZWN0IHJldHVybmVkIGhhcyBh
        IGxlbmd0aCBvZiAwCiovCmhlbHBlcignZmluZFdpdGhBc3NlcnQnLCBmaW5k
        V2l0aEFzc2VydCk7CgovKioKICBDYXVzZXMgdGhlIHJ1biBsb29wIHRvIHBy
        b2Nlc3MgYW55IHBlbmRpbmcgZXZlbnRzLiBUaGlzIGlzIHVzZWQgdG8gZW5z
        dXJlIHRoYXQKICBhbnkgYXN5bmMgb3BlcmF0aW9ucyBmcm9tIG90aGVyIGhl
        bHBlcnMgKG9yIHlvdXIgYXNzZXJ0aW9ucykgaGF2ZSBiZWVuIHByb2Nlc3Nl
        ZC4KCiAgVGhpcyBpcyBtb3N0IG9mdGVuIHVzZWQgYXMgdGhlIHJldHVybiB2
        YWx1ZSBmb3IgdGhlIGhlbHBlciBmdW5jdGlvbnMgKHNlZSAnY2xpY2snLAog
        ICdmaWxsSW4nLCd2aXNpdCcsZXRjKS4KCiAgRXhhbXBsZToKCiAgYGBgCiAg
        RW1iZXIuVGVzdC5yZWdpc3RlckhlbHBlcignbG9naW5Vc2VyJywgZnVuY3Rp
        b24oYXBwLCB1c2VybmFtZSwgcGFzc3dvcmQpIHsKICAgIHZpc2l0KCdzZWN1
        cmVkL3BhdGgvaGVyZScpCiAgICAuZmlsbEluKCcjdXNlcm5hbWUnLCB1c2Vy
        bmFtZSkKICAgIC5maWxsSW4oJyNwYXNzd29yZCcsIHVzZXJuYW1lKQogICAg
        LmNsaWNrKCcuc3VibWl0JykKCiAgICByZXR1cm4gd2FpdChhcHApOwogIH0p
        OwoKICBAbWV0aG9kIHdhaXQKICBAcGFyYW0ge09iamVjdH0gdmFsdWUgVGhl
        IHZhbHVlIHRvIGJlIHJldHVybmVkLgogIEByZXR1cm4ge1JTVlAuUHJvbWlz
        ZX0KICBgYGAKKi8KaGVscGVyKCd3YWl0Jywgd2FpdCk7Cgp9KSgpOwoKCgoo
        ZnVuY3Rpb24oKSB7Ci8qKgogIEVtYmVyIFRlc3RpbmcKCiAgQG1vZHVsZSBl
        bWJlcgogIEBzdWJtb2R1bGUgZW1iZXItdGVzdGluZwogIEByZXF1aXJlcyBl
        bWJlci1hcHBsaWNhdGlvbgoqLwoKfSkoKTsKCihmdW5jdGlvbigpIHsKLyoq
        CkVtYmVyCgpAbW9kdWxlIGVtYmVyCiovCgpmdW5jdGlvbiB0aHJvd1dpdGhN
        ZXNzYWdlKG1zZykgewogIHJldHVybiBmdW5jdGlvbigpIHsKICAgIHRocm93
        IG5ldyBFbWJlci5FcnJvcihtc2cpOwogIH07Cn0KCmZ1bmN0aW9uIGdlbmVy
        YXRlUmVtb3ZlZENsYXNzKGNsYXNzTmFtZSkgewogIHZhciBtc2cgPSAiIGhh
        cyBiZWVuIG1vdmVkIGludG8gYSBwbHVnaW46IGh0dHBzOi8vZ2l0aHViLmNv
        bS9lbWJlcmpzL2VtYmVyLXN0YXRlcyI7CgogIHJldHVybiB7CiAgICBleHRl
        bmQ6IHRocm93V2l0aE1lc3NhZ2UoY2xhc3NOYW1lICsgbXNnKSwKICAgIGNy
        ZWF0ZTogdGhyb3dXaXRoTWVzc2FnZShjbGFzc05hbWUgKyBtc2cpCiAgfTsK
        fQoKRW1iZXIuU3RhdGVNYW5hZ2VyID0gZ2VuZXJhdGVSZW1vdmVkQ2xhc3Mo
        IkVtYmVyLlN0YXRlTWFuYWdlciIpOwoKLyoqCiAgVGhpcyB3YXMgZXhwb3J0
        ZWQgdG8gZW1iZXItc3RhdGVzIHBsdWdpbiBmb3IgdiAxLjAuMCByZWxlYXNl
        LiBTZWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9lbWJlcmpzL2VtYmVyLXN0YXRl
        cwogIAogIEBjbGFzcyBTdGF0ZU1hbmFnZXIKICBAbmFtZXNwYWNlIEVtYmVy
        CiovCgpFbWJlci5TdGF0ZSA9IGdlbmVyYXRlUmVtb3ZlZENsYXNzKCJFbWJl
        ci5TdGF0ZSIpOwoKLyoqCiAgVGhpcyB3YXMgZXhwb3J0ZWQgdG8gZW1iZXIt
        c3RhdGVzIHBsdWdpbiBmb3IgdiAxLjAuMCByZWxlYXNlLiBTZWU6IGh0dHBz
        Oi8vZ2l0aHViLmNvbS9lbWJlcmpzL2VtYmVyLXN0YXRlcwogIAogIEBjbGFz
        cyBTdGF0ZQogIEBuYW1lc3BhY2UgRW1iZXIKKi8KCn0pKCk7CgoKfSkoKTsK
    http_version: 
  recorded_at: Wed, 30 Oct 2013 21:47:05 GMT
- request:
    method: get
    uri: http://builds.emberjs.com/release/ember.js
    body:
      encoding: US-ASCII
      string: ''
    headers:
      Accept:
      - ! '*/*'
      User-Agent:
      - Ruby
  response:
    status:
      code: 200
      message: OK
    headers:
      X-Amz-Id-2:
      - sHu3vaK/QCyogpQAf1zOylbuow5WQhLZEdepTwzEPgTO2V01yXFL7p+39Zr9rItf
      X-Amz-Request-Id:
      - 8E3EDF6FCB086374
      Date:
      - Wed, 30 Oct 2013 21:47:06 GMT
      Last-Modified:
      - Fri, 25 Oct 2013 20:17:10 GMT
      Etag:
      - ! '"361d9070cb86013a50a0f48f472f82ce"'
      Content-Type:
      - text/javascript
      Content-Length:
      - '1040400'
      Server:
      - AmazonS3
    body:
      encoding: ASCII-8BIT
      string: !binary |-
        IC8vIFZlcnNpb246IDEuMS4yCgooZnVuY3Rpb24oKSB7Ci8qZ2xvYmFsIF9f
        ZmFpbF9fKi8KCi8qKgpFbWJlciBEZWJ1ZwoKQG1vZHVsZSBlbWJlcgpAc3Vi
        bW9kdWxlIGVtYmVyLWRlYnVnCiovCgovKioKQGNsYXNzIEVtYmVyCiovCgpp
        ZiAoJ3VuZGVmaW5lZCcgPT09IHR5cGVvZiBFbWJlcikgewogIEVtYmVyID0g
        e307CgogIGlmICgndW5kZWZpbmVkJyAhPT0gdHlwZW9mIHdpbmRvdykgewog
        ICAgd2luZG93LkVtID0gd2luZG93LkVtYmVyID0gRW0gPSBFbWJlcjsKICB9
        Cn0KCkVtYmVyLkVOViA9ICd1bmRlZmluZWQnID09PSB0eXBlb2YgRU5WID8g
        e30gOiBFTlY7CgppZiAoISgnTUFOREFUT1JZX1NFVFRFUicgaW4gRW1iZXIu
        RU5WKSkgewogIEVtYmVyLkVOVi5NQU5EQVRPUllfU0VUVEVSID0gdHJ1ZTsg
        Ly8gZGVmYXVsdCB0byB0cnVlIGZvciBkZWJ1ZyBkaXN0Cn0KCi8qKgogIERl
        ZmluZSBhbiBhc3NlcnRpb24gdGhhdCB3aWxsIHRocm93IGFuIGV4Y2VwdGlv
        biBpZiB0aGUgY29uZGl0aW9uIGlzIG5vdAogIG1ldC4gRW1iZXIgYnVpbGQg
        dG9vbHMgd2lsbCByZW1vdmUgYW55IGNhbGxzIHRvIGBFbWJlci5hc3NlcnQo
        KWAgd2hlbgogIGRvaW5nIGEgcHJvZHVjdGlvbiBidWlsZC4gRXhhbXBsZToK
        CiAgYGBgamF2YXNjcmlwdAogIC8vIFRlc3QgZm9yIHRydXRoaW5lc3MKICBF
        bWJlci5hc3NlcnQoJ011c3QgcGFzcyBhIHZhbGlkIG9iamVjdCcsIG9iaik7
        CiAgLy8gRmFpbCB1bmNvbmRpdGlvbmFsbHkKICBFbWJlci5hc3NlcnQoJ1Ro
        aXMgY29kZSBwYXRoIHNob3VsZCBuZXZlciBiZSBydW4nKQogIGBgYAoKICBA
        bWV0aG9kIGFzc2VydAogIEBwYXJhbSB7U3RyaW5nfSBkZXNjIEEgZGVzY3Jp
        cHRpb24gb2YgdGhlIGFzc2VydGlvbi4gVGhpcyB3aWxsIGJlY29tZQogICAg
        dGhlIHRleHQgb2YgdGhlIEVycm9yIHRocm93biBpZiB0aGUgYXNzZXJ0aW9u
        IGZhaWxzLgogIEBwYXJhbSB7Qm9vbGVhbn0gdGVzdCBNdXN0IGJlIHRydXRo
        eSBmb3IgdGhlIGFzc2VydGlvbiB0byBwYXNzLiBJZgogICAgZmFsc3ksIGFu
        IGV4Y2VwdGlvbiB3aWxsIGJlIHRocm93bi4KKi8KRW1iZXIuYXNzZXJ0ID0g
        ZnVuY3Rpb24oZGVzYywgdGVzdCkgewogIGlmICghdGVzdCkgewogICAgRW1i
        ZXIuTG9nZ2VyLmFzc2VydCh0ZXN0LCBkZXNjKTsKICB9CgogIGlmIChFbWJl
        ci50ZXN0aW5nICYmICF0ZXN0KSB7CiAgICAvLyB3aGVuIHRlc3RpbmcsIGVu
        c3VyZSB0ZXN0IGZhaWx1cmVzIHdoZW4gYXNzZXJ0aW9ucyBmYWlsCiAgICB0
        aHJvdyBuZXcgRW1iZXIuRXJyb3IoIkFzc2VydGlvbiBGYWlsZWQ6ICIgKyBk
        ZXNjKTsKICB9Cn07CgoKLyoqCiAgRGlzcGxheSBhIHdhcm5pbmcgd2l0aCB0
        aGUgcHJvdmlkZWQgbWVzc2FnZS4gRW1iZXIgYnVpbGQgdG9vbHMgd2lsbAog
        IHJlbW92ZSBhbnkgY2FsbHMgdG8gYEVtYmVyLndhcm4oKWAgd2hlbiBkb2lu
        ZyBhIHByb2R1Y3Rpb24gYnVpbGQuCgogIEBtZXRob2Qgd2FybgogIEBwYXJh
        bSB7U3RyaW5nfSBtZXNzYWdlIEEgd2FybmluZyB0byBkaXNwbGF5LgogIEBw
        YXJhbSB7Qm9vbGVhbn0gdGVzdCBBbiBvcHRpb25hbCBib29sZWFuLiBJZiBm
        YWxzeSwgdGhlIHdhcm5pbmcKICAgIHdpbGwgYmUgZGlzcGxheWVkLgoqLwpF
        bWJlci53YXJuID0gZnVuY3Rpb24obWVzc2FnZSwgdGVzdCkgewogIGlmICgh
        dGVzdCkgewogICAgRW1iZXIuTG9nZ2VyLndhcm4oIldBUk5JTkc6ICIrbWVz
        c2FnZSk7CiAgICBpZiAoJ3RyYWNlJyBpbiBFbWJlci5Mb2dnZXIpIEVtYmVy
        LkxvZ2dlci50cmFjZSgpOwogIH0KfTsKCi8qKgogIERpc3BsYXkgYSBkZWJ1
        ZyBub3RpY2UuIEVtYmVyIGJ1aWxkIHRvb2xzIHdpbGwgcmVtb3ZlIGFueSBj
        YWxscyB0bwogIGBFbWJlci5kZWJ1ZygpYCB3aGVuIGRvaW5nIGEgcHJvZHVj
        dGlvbiBidWlsZC4KCiAgYGBgamF2YXNjcmlwdAogIEVtYmVyLmRlYnVnKCJJ
        J20gYSBkZWJ1ZyBub3RpY2UhIik7CiAgYGBgCgogIEBtZXRob2QgZGVidWcK
        ICBAcGFyYW0ge1N0cmluZ30gbWVzc2FnZSBBIGRlYnVnIG1lc3NhZ2UgdG8g
        ZGlzcGxheS4KKi8KRW1iZXIuZGVidWcgPSBmdW5jdGlvbihtZXNzYWdlKSB7
        CiAgRW1iZXIuTG9nZ2VyLmRlYnVnKCJERUJVRzogIittZXNzYWdlKTsKfTsK
        Ci8qKgogIERpc3BsYXkgYSBkZXByZWNhdGlvbiB3YXJuaW5nIHdpdGggdGhl
        IHByb3ZpZGVkIG1lc3NhZ2UgYW5kIGEgc3RhY2sgdHJhY2UKICAoQ2hyb21l
        IGFuZCBGaXJlZm94IG9ubHkpLiBFbWJlciBidWlsZCB0b29scyB3aWxsIHJl
        bW92ZSBhbnkgY2FsbHMgdG8KICBgRW1iZXIuZGVwcmVjYXRlKClgIHdoZW4g
        ZG9pbmcgYSBwcm9kdWN0aW9uIGJ1aWxkLgoKICBAbWV0aG9kIGRlcHJlY2F0
        ZQogIEBwYXJhbSB7U3RyaW5nfSBtZXNzYWdlIEEgZGVzY3JpcHRpb24gb2Yg
        dGhlIGRlcHJlY2F0aW9uLgogIEBwYXJhbSB7Qm9vbGVhbn0gdGVzdCBBbiBv
        cHRpb25hbCBib29sZWFuLiBJZiBmYWxzeSwgdGhlIGRlcHJlY2F0aW9uCiAg
        ICB3aWxsIGJlIGRpc3BsYXllZC4KKi8KRW1iZXIuZGVwcmVjYXRlID0gZnVu
        Y3Rpb24obWVzc2FnZSwgdGVzdCkgewogIGlmIChFbWJlci5URVNUSU5HX0RF
        UFJFQ0FUSU9OKSB7IHJldHVybjsgfQoKICBpZiAoYXJndW1lbnRzLmxlbmd0
        aCA9PT0gMSkgeyB0ZXN0ID0gZmFsc2U7IH0KICBpZiAodGVzdCkgeyByZXR1
        cm47IH0KCiAgaWYgKEVtYmVyLkVOVi5SQUlTRV9PTl9ERVBSRUNBVElPTikg
        eyB0aHJvdyBuZXcgRW1iZXIuRXJyb3IobWVzc2FnZSk7IH0KCiAgdmFyIGVy
        cm9yOwoKICAvLyBXaGVuIHVzaW5nIG5ldyBFcnJvciwgd2UgY2FuJ3QgZG8g
        dGhlIGFyZ3VtZW50cyBjaGVjayBmb3IgQ2hyb21lLiBBbHRlcm5hdGl2ZXMg
        YXJlIHdlbGNvbWUKICB0cnkgeyBfX2ZhaWxfXy5mYWlsKCk7IH0gY2F0Y2gg
        KGUpIHsgZXJyb3IgPSBlOyB9CgogIGlmIChFbWJlci5MT0dfU1RBQ0tUUkFD
        RV9PTl9ERVBSRUNBVElPTiAmJiBlcnJvci5zdGFjaykgewogICAgdmFyIHN0
        YWNrLCBzdGFja1N0ciA9ICcnOwogICAgaWYgKGVycm9yWydhcmd1bWVudHMn
        XSkgewogICAgICAvLyBDaHJvbWUKICAgICAgc3RhY2sgPSBlcnJvci5zdGFj
        ay5yZXBsYWNlKC9eXHMrYXRccysvZ20sICcnKS4KICAgICAgICAgICAgICAg
        ICAgICAgICAgICByZXBsYWNlKC9eKFteXChdKz8pKFtcbiRdKS9nbSwgJ3th
        bm9ueW1vdXN9KCQxKSQyJykuCiAgICAgICAgICAgICAgICAgICAgICAgICAg
        cmVwbGFjZSgvXk9iamVjdC48YW5vbnltb3VzPlxzKlwoKFteXCldKylcKS9n
        bSwgJ3thbm9ueW1vdXN9KCQxKScpLnNwbGl0KCdcbicpOwogICAgICBzdGFj
        ay5zaGlmdCgpOwogICAgfSBlbHNlIHsKICAgICAgLy8gRmlyZWZveAogICAg
        ICBzdGFjayA9IGVycm9yLnN0YWNrLnJlcGxhY2UoLyg/OlxuQDowKT9ccysk
        L20sICcnKS4KICAgICAgICAgICAgICAgICAgICAgICAgICByZXBsYWNlKC9e
        XCgvZ20sICd7YW5vbnltb3VzfSgnKS5zcGxpdCgnXG4nKTsKICAgIH0KCiAg
        ICBzdGFja1N0ciA9ICJcbiAgICAiICsgc3RhY2suc2xpY2UoMikuam9pbigi
        XG4gICAgIik7CiAgICBtZXNzYWdlID0gbWVzc2FnZSArIHN0YWNrU3RyOwog
        IH0KCiAgRW1iZXIuTG9nZ2VyLndhcm4oIkRFUFJFQ0FUSU9OOiAiK21lc3Nh
        Z2UpOwp9OwoKCgovKioKICBBbGlhcyBhbiBvbGQsIGRlcHJlY2F0ZWQgbWV0
        aG9kIHdpdGggaXRzIG5ldyBjb3VudGVycGFydC4KCiAgRGlzcGxheSBhIGRl
        cHJlY2F0aW9uIHdhcm5pbmcgd2l0aCB0aGUgcHJvdmlkZWQgbWVzc2FnZSBh
        bmQgYSBzdGFjayB0cmFjZQogIChDaHJvbWUgYW5kIEZpcmVmb3ggb25seSkg
        d2hlbiB0aGUgYXNzaWduZWQgbWV0aG9kIGlzIGNhbGxlZC4KCiAgRW1iZXIg
        YnVpbGQgdG9vbHMgd2lsbCBub3QgcmVtb3ZlIGNhbGxzIHRvIGBFbWJlci5k
        ZXByZWNhdGVGdW5jKClgLCB0aG91Z2gKICBubyB3YXJuaW5ncyB3aWxsIGJl
        IHNob3duIGluIHByb2R1Y3Rpb24uCgogIGBgYGphdmFzY3JpcHQKICBFbWJl
        ci5vbGRNZXRob2QgPSBFbWJlci5kZXByZWNhdGVGdW5jKCJQbGVhc2UgdXNl
        IHRoZSBuZXcsIHVwZGF0ZWQgbWV0aG9kIiwgRW1iZXIubmV3TWV0aG9kKTsK
        ICBgYGAKCiAgQG1ldGhvZCBkZXByZWNhdGVGdW5jCiAgQHBhcmFtIHtTdHJp
        bmd9IG1lc3NhZ2UgQSBkZXNjcmlwdGlvbiBvZiB0aGUgZGVwcmVjYXRpb24u
        CiAgQHBhcmFtIHtGdW5jdGlvbn0gZnVuYyBUaGUgbmV3IGZ1bmN0aW9uIGNh
        bGxlZCB0byByZXBsYWNlIGl0cyBkZXByZWNhdGVkIGNvdW50ZXJwYXJ0Lgog
        IEByZXR1cm4ge0Z1bmN0aW9ufSBhIG5ldyBmdW5jdGlvbiB0aGF0IHdyYXBw
        ZWQgdGhlIG9yaWdpbmFsIGZ1bmN0aW9uIHdpdGggYSBkZXByZWNhdGlvbiB3
        YXJuaW5nCiovCkVtYmVyLmRlcHJlY2F0ZUZ1bmMgPSBmdW5jdGlvbihtZXNz
        YWdlLCBmdW5jKSB7CiAgcmV0dXJuIGZ1bmN0aW9uKCkgewogICAgRW1iZXIu
        ZGVwcmVjYXRlKG1lc3NhZ2UpOwogICAgcmV0dXJuIGZ1bmMuYXBwbHkodGhp
        cywgYXJndW1lbnRzKTsKICB9Owp9OwoKCi8vIEluZm9ybSB0aGUgZGV2ZWxv
        cGVyIGFib3V0IHRoZSBFbWJlciBJbnNwZWN0b3IgaWYgbm90IGluc3RhbGxl
        ZC4KaWYgKCFFbWJlci50ZXN0aW5nKSB7CiAgaWYgKHR5cGVvZiB3aW5kb3cg
        IT09ICd1bmRlZmluZWQnICYmIHdpbmRvdy5jaHJvbWUgJiYgd2luZG93LmFk
        ZEV2ZW50TGlzdGVuZXIpIHsKICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVy
        KCJsb2FkIiwgZnVuY3Rpb24oKSB7CiAgICAgIGlmIChkb2N1bWVudC5ib2R5
        ICYmIGRvY3VtZW50LmJvZHkuZGF0YXNldCAmJiAhZG9jdW1lbnQuYm9keS5k
        YXRhc2V0LmVtYmVyRXh0ZW5zaW9uKSB7CiAgICAgICAgRW1iZXIuZGVidWco
        J0ZvciBtb3JlIGFkdmFuY2VkIGRlYnVnZ2luZywgaW5zdGFsbCB0aGUgRW1i
        ZXIgSW5zcGVjdG9yIGZyb20gaHR0cHM6Ly9jaHJvbWUuZ29vZ2xlLmNvbS93
        ZWJzdG9yZS9kZXRhaWwvZW1iZXItaW5zcGVjdG9yL2JtZGJsbmNlZ2tlbmth
        Y2llaWhmaHBqZnBwb2NvbmhpJyk7CiAgICAgIH0KICAgIH0sIGZhbHNlKTsK
        ICB9Cn0KCn0pKCk7CgogLy8gVmVyc2lvbjogMS4xLjIKCihmdW5jdGlvbigp
        IHsKdmFyIGRlZmluZSwgcmVxdWlyZU1vZHVsZTsKCihmdW5jdGlvbigpIHsK
        ICB2YXIgcmVnaXN0cnkgPSB7fSwgc2VlbiA9IHt9OwoKICBkZWZpbmUgPSBm
        dW5jdGlvbihuYW1lLCBkZXBzLCBjYWxsYmFjaykgewogICAgcmVnaXN0cnlb
        bmFtZV0gPSB7IGRlcHM6IGRlcHMsIGNhbGxiYWNrOiBjYWxsYmFjayB9Owog
        IH07CgogIHJlcXVpcmVNb2R1bGUgPSBmdW5jdGlvbihuYW1lKSB7CiAgICBp
        ZiAoc2VlbltuYW1lXSkgeyByZXR1cm4gc2VlbltuYW1lXTsgfQogICAgc2Vl
        bltuYW1lXSA9IHt9OwoKICAgIHZhciBtb2QsIGRlcHMsIGNhbGxiYWNrLCBy
        ZWlmaWVkLCBleHBvcnRzOwoKICAgIG1vZCA9IHJlZ2lzdHJ5W25hbWVdOwoK
        ICAgIGlmICghbW9kKSB7CiAgICAgIHRocm93IG5ldyBFcnJvcigiTW9kdWxl
        ICciICsgbmFtZSArICInIG5vdCBmb3VuZC4iKTsKICAgIH0KCiAgICBkZXBz
        ID0gbW9kLmRlcHM7CiAgICBjYWxsYmFjayA9IG1vZC5jYWxsYmFjazsKICAg
        IHJlaWZpZWQgPSBbXTsKCiAgICBmb3IgKHZhciBpPTAsIGw9ZGVwcy5sZW5n
        dGg7IGk8bDsgaSsrKSB7CiAgICAgIGlmIChkZXBzW2ldID09PSAnZXhwb3J0
        cycpIHsKICAgICAgICByZWlmaWVkLnB1c2goZXhwb3J0cyA9IHt9KTsKICAg
        ICAgfSBlbHNlIHsKICAgICAgICByZWlmaWVkLnB1c2gocmVxdWlyZU1vZHVs
        ZShkZXBzW2ldKSk7CiAgICAgIH0KICAgIH0KCiAgICB2YXIgdmFsdWUgPSBj
        YWxsYmFjay5hcHBseSh0aGlzLCByZWlmaWVkKTsKICAgIHJldHVybiBzZWVu
        W25hbWVdID0gZXhwb3J0cyB8fCB2YWx1ZTsKICB9Owp9KSgpOwooZnVuY3Rp
        b24oKSB7Ci8qZ2xvYmFscyBFbTp0cnVlIEVOViAqLwoKLyoqCkBtb2R1bGUg
        ZW1iZXIKQHN1Ym1vZHVsZSBlbWJlci1tZXRhbAoqLwoKLyoqCiAgQWxsIEVt
        YmVyIG1ldGhvZHMgYW5kIGZ1bmN0aW9ucyBhcmUgZGVmaW5lZCBpbnNpZGUg
        b2YgdGhpcyBuYW1lc3BhY2UuIFlvdQogIGdlbmVyYWxseSBzaG91bGQgbm90
        IGFkZCBuZXcgcHJvcGVydGllcyB0byB0aGlzIG5hbWVzcGFjZSBhcyBpdCBt
        YXkgYmUKICBvdmVyd3JpdHRlbiBieSBmdXR1cmUgdmVyc2lvbnMgb2YgRW1i
        ZXIuCgogIFlvdSBjYW4gYWxzbyB1c2UgdGhlIHNob3J0aGFuZCBgRW1gIGlu
        c3RlYWQgb2YgYEVtYmVyYC4KCiAgRW1iZXItUnVudGltZSBpcyBhIGZyYW1l
        d29yayB0aGF0IHByb3ZpZGVzIGNvcmUgZnVuY3Rpb25zIGZvciBFbWJlciBp
        bmNsdWRpbmcKICBjcm9zcy1wbGF0Zm9ybSBmdW5jdGlvbnMsIHN1cHBvcnQg
        Zm9yIHByb3BlcnR5IG9ic2VydmluZyBhbmQgb2JqZWN0cy4gSXRzCiAgZm9j
        dXMgaXMgb24gc21hbGwgc2l6ZSBhbmQgcGVyZm9ybWFuY2UuIFlvdSBjYW4g
        dXNlIHRoaXMgaW4gcGxhY2Ugb2Ygb3IKICBhbG9uZy1zaWRlIG90aGVyIGNy
        b3NzLXBsYXRmb3JtIGxpYnJhcmllcyBzdWNoIGFzIGpRdWVyeS4KCiAgVGhl
        IGNvcmUgUnVudGltZSBmcmFtZXdvcmsgaXMgYmFzZWQgb24gdGhlIGpRdWVy
        eSBBUEkgd2l0aCBhIG51bWJlciBvZgogIHBlcmZvcm1hbmNlIG9wdGltaXph
        dGlvbnMuCgogIEBjbGFzcyBFbWJlcgogIEBzdGF0aWMKICBAdmVyc2lvbiAx
        LjEuMgoqLwoKaWYgKCd1bmRlZmluZWQnID09PSB0eXBlb2YgRW1iZXIpIHsK
        ICAvLyBDcmVhdGUgY29yZSBvYmplY3QuIE1ha2UgaXQgYWN0IGxpa2UgYW4g
        aW5zdGFuY2Ugb2YgRW1iZXIuTmFtZXNwYWNlIHNvIHRoYXQKICAvLyBvYmpl
        Y3RzIGFzc2lnbmVkIHRvIGl0IGFyZSBnaXZlbiBhIHNhbmUgc3RyaW5nIHJl
        cHJlc2VudGF0aW9uLgogIEVtYmVyID0ge307Cn0KCi8vIERlZmF1bHQgaW1w
        b3J0cywgZXhwb3J0cyBhbmQgbG9va3VwIHRvIHRoZSBnbG9iYWwgb2JqZWN0
        Owp2YXIgaW1wb3J0cyA9IEVtYmVyLmltcG9ydHMgPSBFbWJlci5pbXBvcnRz
        IHx8IHRoaXM7CnZhciBleHBvcnRzID0gRW1iZXIuZXhwb3J0cyA9IEVtYmVy
        LmV4cG9ydHMgfHwgdGhpczsKdmFyIGxvb2t1cCAgPSBFbWJlci5sb29rdXAg
        ID0gRW1iZXIubG9va3VwICB8fCB0aGlzOwoKLy8gYWxpYXNlcyBuZWVkZWQg
        dG8ga2VlcCBtaW5pZmllcnMgZnJvbSByZW1vdmluZyB0aGUgZ2xvYmFsIGNv
        bnRleHQKZXhwb3J0cy5FbSA9IGV4cG9ydHMuRW1iZXIgPSBFbSA9IEVtYmVy
        OwoKLy8gTWFrZSBzdXJlIHRoZXNlIGFyZSBzZXQgd2hldGhlciBFbWJlciB3
        YXMgYWxyZWFkeSBkZWZpbmVkIG9yIG5vdAoKRW1iZXIuaXNOYW1lc3BhY2Ug
        PSB0cnVlOwoKRW1iZXIudG9TdHJpbmcgPSBmdW5jdGlvbigpIHsgcmV0dXJu
        ICJFbWJlciI7IH07CgoKLyoqCiAgQHByb3BlcnR5IFZFUlNJT04KICBAdHlw
        ZSBTdHJpbmcKICBAZGVmYXVsdCAnMS4xLjInCiAgQGZpbmFsCiovCkVtYmVy
        LlZFUlNJT04gPSAnMS4xLjInOwoKLyoqCiAgU3RhbmRhcmQgZW52aXJvbm1l
        bnRhbCB2YXJpYWJsZXMuIFlvdSBjYW4gZGVmaW5lIHRoZXNlIGluIGEgZ2xv
        YmFsIGBFTlZgCiAgdmFyaWFibGUgYmVmb3JlIGxvYWRpbmcgRW1iZXIgdG8g
        Y29udHJvbCB2YXJpb3VzIGNvbmZpZ3VyYXRpb24KICBzZXR0aW5ncy4KCiAg
        QHByb3BlcnR5IEVOVgogIEB0eXBlIEhhc2gKKi8KCmlmICgndW5kZWZpbmVk
        JyA9PT0gdHlwZW9mIEVOVikgewogIGV4cG9ydHMuRU5WID0ge307Cn0KCi8v
        IFdlIGRpc2FibGUgdGhlIFJBTkdFIEFQSSBieSBkZWZhdWx0IGZvciBwZXJm
        b3JtYW5jZSByZWFzb25zCmlmICgndW5kZWZpbmVkJyA9PT0gdHlwZW9mIEVO
        Vi5ESVNBQkxFX1JBTkdFX0FQSSkgewogIEVOVi5ESVNBQkxFX1JBTkdFX0FQ
        SSA9IHRydWU7Cn0KCgpFbWJlci5FTlYgPSBFbWJlci5FTlYgfHwgRU5WOwoK
        RW1iZXIuY29uZmlnID0gRW1iZXIuY29uZmlnIHx8IHt9OwoKLyoqCiAgSGFz
        aCBvZiBlbmFibGVkIENhbmFyeSBmZWF0dXJlcy4gQWRkIHRvIGJlZm9yZSBj
        cmVhdGluZyB5b3VyIGFwcGxpY2F0aW9uLgoKICBAcHJvcGVydHkgRkVBVFVS
        RVMKICBAdHlwZSBIYXNoCiovCgpFbWJlci5GRUFUVVJFUyA9IHt9OwoKLyoq
        CiAgVGVzdCB0aGF0IGEgZmVhdHVyZSBpcyBlbmFibGVkLiBQYXJzZWQgYnkg
        RW1iZXIncyBidWlsZCB0b29scyB0byBsZWF2ZQogIGV4cGVyaW1lbnRhbCBm
        ZWF0dXJlcyBvdXQgb2YgYmV0YS9zdGFibGUgYnVpbGRzLgoKICBAbWV0aG9k
        IGlzRW5hYmxlZAogIEBwYXJhbSB7c3RyaW5nfSBmZWF0dXJlCiovCgpFbWJl
        ci5GRUFUVVJFUy5pc0VuYWJsZWQgPSBmdW5jdGlvbihmZWF0dXJlKSB7CiAg
        cmV0dXJuIEVtYmVyLkZFQVRVUkVTW2ZlYXR1cmVdOwp9OwoKLy8gLi4uLi4u
        Li4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4u
        Li4uLi4uLgovLyBCT09UU1RSQVAKLy8KCi8qKgogIERldGVybWluZXMgd2hl
        dGhlciBFbWJlciBzaG91bGQgZW5oYW5jZXMgc29tZSBidWlsdC1pbiBvYmpl
        Y3QgcHJvdG90eXBlcyB0bwogIHByb3ZpZGUgYSBtb3JlIGZyaWVuZGx5IEFQ
        SS4gSWYgZW5hYmxlZCwgYSBmZXcgbWV0aG9kcyB3aWxsIGJlIGFkZGVkIHRv
        CiAgYEZ1bmN0aW9uYCwgYFN0cmluZ2AsIGFuZCBgQXJyYXlgLiBgT2JqZWN0
        LnByb3RvdHlwZWAgd2lsbCBub3QgYmUgZW5oYW5jZWQsCiAgd2hpY2ggaXMg
        dGhlIG9uZSB0aGF0IGNhdXNlcyBtb3N0IHRyb3VibGUgZm9yIHBlb3BsZS4K
        CiAgSW4gZ2VuZXJhbCB3ZSByZWNvbW1lbmQgbGVhdmluZyB0aGlzIG9wdGlv
        biBzZXQgdG8gdHJ1ZSBzaW5jZSBpdCByYXJlbHkKICBjb25mbGljdHMgd2l0
        aCBvdGhlciBjb2RlLiBJZiB5b3UgbmVlZCB0byB0dXJuIGl0IG9mZiBob3dl
        dmVyLCB5b3UgY2FuCiAgZGVmaW5lIGFuIGBFTlYuRVhURU5EX1BST1RPVFlQ
        RVNgIGNvbmZpZyB0byBkaXNhYmxlIGl0LgoKICBAcHJvcGVydHkgRVhURU5E
        X1BST1RPVFlQRVMKICBAdHlwZSBCb29sZWFuCiAgQGRlZmF1bHQgdHJ1ZQoq
        LwpFbWJlci5FWFRFTkRfUFJPVE9UWVBFUyA9IEVtYmVyLkVOVi5FWFRFTkRf
        UFJPVE9UWVBFUzsKCmlmICh0eXBlb2YgRW1iZXIuRVhURU5EX1BST1RPVFlQ
        RVMgPT09ICd1bmRlZmluZWQnKSB7CiAgRW1iZXIuRVhURU5EX1BST1RPVFlQ
        RVMgPSB0cnVlOwp9CgovKioKICBEZXRlcm1pbmVzIHdoZXRoZXIgRW1iZXIg
        bG9ncyBhIGZ1bGwgc3RhY2sgdHJhY2UgZHVyaW5nIGRlcHJlY2F0aW9uIHdh
        cm5pbmdzCgogIEBwcm9wZXJ0eSBMT0dfU1RBQ0tUUkFDRV9PTl9ERVBSRUNB
        VElPTgogIEB0eXBlIEJvb2xlYW4KICBAZGVmYXVsdCB0cnVlCiovCkVtYmVy
        LkxPR19TVEFDS1RSQUNFX09OX0RFUFJFQ0FUSU9OID0gKEVtYmVyLkVOVi5M
        T0dfU1RBQ0tUUkFDRV9PTl9ERVBSRUNBVElPTiAhPT0gZmFsc2UpOwoKLyoq
        CiAgRGV0ZXJtaW5lcyB3aGV0aGVyIEVtYmVyIHNob3VsZCBhZGQgRUNNQVNj
        cmlwdCA1IHNoaW1zIHRvIG9sZGVyIGJyb3dzZXJzLgoKICBAcHJvcGVydHkg
        U0hJTV9FUzUKICBAdHlwZSBCb29sZWFuCiAgQGRlZmF1bHQgRW1iZXIuRVhU
        RU5EX1BST1RPVFlQRVMKKi8KRW1iZXIuU0hJTV9FUzUgPSAoRW1iZXIuRU5W
        LlNISU1fRVM1ID09PSBmYWxzZSkgPyBmYWxzZSA6IEVtYmVyLkVYVEVORF9Q
        Uk9UT1RZUEVTOwoKLyoqCiAgRGV0ZXJtaW5lcyB3aGV0aGVyIEVtYmVyIGxv
        Z3MgaW5mbyBhYm91dCB2ZXJzaW9uIG9mIHVzZWQgbGlicmFyaWVzCgogIEBw
        cm9wZXJ0eSBMT0dfVkVSU0lPTgogIEB0eXBlIEJvb2xlYW4KICBAZGVmYXVs
        dCB0cnVlCiovCkVtYmVyLkxPR19WRVJTSU9OID0gKEVtYmVyLkVOVi5MT0df
        VkVSU0lPTiA9PT0gZmFsc2UpID8gZmFsc2UgOiB0cnVlOwoKLyoqCiAgRW1w
        dHkgZnVuY3Rpb24uIFVzZWZ1bCBmb3Igc29tZSBvcGVyYXRpb25zLiBBbHdh
        eXMgcmV0dXJucyBgdGhpc2AuCgogIEBtZXRob2QgSwogIEBwcml2YXRlCiAg
        QHJldHVybiB7T2JqZWN0fQoqLwpFbWJlci5LID0gZnVuY3Rpb24oKSB7IHJl
        dHVybiB0aGlzOyB9OwoKCi8vIFN0dWIgb3V0IHRoZSBtZXRob2RzIGRlZmlu
        ZWQgYnkgdGhlIGVtYmVyLWRlYnVnIHBhY2thZ2UgaW4gY2FzZSBpdCdzIG5v
        dCBsb2FkZWQKCmlmICgndW5kZWZpbmVkJyA9PT0gdHlwZW9mIEVtYmVyLmFz
        c2VydCkgeyBFbWJlci5hc3NlcnQgPSBFbWJlci5LOyB9CmlmICgndW5kZWZp
        bmVkJyA9PT0gdHlwZW9mIEVtYmVyLndhcm4pIHsgRW1iZXIud2FybiA9IEVt
        YmVyLks7IH0KaWYgKCd1bmRlZmluZWQnID09PSB0eXBlb2YgRW1iZXIuZGVi
        dWcpIHsgRW1iZXIuZGVidWcgPSBFbWJlci5LOyB9CmlmICgndW5kZWZpbmVk
        JyA9PT0gdHlwZW9mIEVtYmVyLmRlcHJlY2F0ZSkgeyBFbWJlci5kZXByZWNh
        dGUgPSBFbWJlci5LOyB9CmlmICgndW5kZWZpbmVkJyA9PT0gdHlwZW9mIEVt
        YmVyLmRlcHJlY2F0ZUZ1bmMpIHsKICBFbWJlci5kZXByZWNhdGVGdW5jID0g
        ZnVuY3Rpb24oXywgZnVuYykgeyByZXR1cm4gZnVuYzsgfTsKfQoKLyoqCiAg
        UHJldmlvdXNseSB3ZSB1c2VkIGBFbWJlci4kLnV1aWRgLCBob3dldmVyIGAk
        LnV1aWRgIGhhcyBiZWVuIHJlbW92ZWQgZnJvbQogIGpRdWVyeSBtYXN0ZXIu
        IFdlJ2xsIGp1c3QgYm9vdHN0cmFwIG91ciBvd24gdXVpZCBub3cuCgogIEBw
        cm9wZXJ0eSB1dWlkCiAgQHR5cGUgTnVtYmVyCiAgQHByaXZhdGUKKi8KRW1i
        ZXIudXVpZCA9IDA7CgovLyAuLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4u
        Li4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uCi8vIExPR0dFUgovLwoK
        ZnVuY3Rpb24gY29uc29sZU1ldGhvZChuYW1lKSB7CiAgdmFyIGNvbnNvbGVP
        Ymo7CiAgaWYgKGltcG9ydHMuY29uc29sZSkgewogICAgY29uc29sZU9iaiA9
        IGltcG9ydHMuY29uc29sZTsKICB9IGVsc2UgaWYgKHR5cGVvZiBjb25zb2xl
        ICE9PSAndW5kZWZpbmVkJykgewogICAgY29uc29sZU9iaiA9IGNvbnNvbGU7
        CiAgfQoKICB2YXIgbWV0aG9kID0gdHlwZW9mIGNvbnNvbGVPYmogPT09ICdv
        YmplY3QnID8gY29uc29sZU9ialtuYW1lXSA6IG51bGw7CgogIGlmIChtZXRo
        b2QpIHsKICAgIC8vIE9sZGVyIElFIGRvZXNuJ3Qgc3VwcG9ydCBhcHBseSwg
        YnV0IENocm9tZSBuZWVkcyBpdAogICAgaWYgKG1ldGhvZC5hcHBseSkgewog
        ICAgICByZXR1cm4gZnVuY3Rpb24oKSB7CiAgICAgICAgbWV0aG9kLmFwcGx5
        KGNvbnNvbGVPYmosIGFyZ3VtZW50cyk7CiAgICAgIH07CiAgICB9IGVsc2Ug
        ewogICAgICByZXR1cm4gZnVuY3Rpb24oKSB7CiAgICAgICAgdmFyIG1lc3Nh
        Z2UgPSBBcnJheS5wcm90b3R5cGUuam9pbi5jYWxsKGFyZ3VtZW50cywgJywg
        Jyk7CiAgICAgICAgbWV0aG9kKG1lc3NhZ2UpOwogICAgICB9OwogICAgfQog
        IH0KfQoKZnVuY3Rpb24gYXNzZXJ0UG9seWZpbGwodGVzdCwgbWVzc2FnZSkg
        ewogIGlmICghdGVzdCkgewogICAgdHJ5IHsKICAgICAgLy8gYXR0ZW1wdCB0
        byBwcmVzZXJ2ZSB0aGUgc3RhY2sKICAgICAgdGhyb3cgbmV3IEVycm9yKCJh
        c3NlcnRpb24gZmFpbGVkOiAiICsgbWVzc2FnZSk7CiAgICB9IGNhdGNoKGVy
        cm9yKSB7CiAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7CiAgICAgICAg
        dGhyb3cgZXJyb3I7CiAgICAgIH0sIDApOwogICAgfQogIH0KfQoKLyoqCiAg
        SW5zaWRlIEVtYmVyLU1ldGFsLCBzaW1wbHkgdXNlcyB0aGUgbWV0aG9kcyBm
        cm9tIGBpbXBvcnRzLmNvbnNvbGVgLgogIE92ZXJyaWRlIHRoaXMgdG8gcHJv
        dmlkZSBtb3JlIHJvYnVzdCBsb2dnaW5nIGZ1bmN0aW9uYWxpdHkuCgogIEBj
        bGFzcyBMb2dnZXIKICBAbmFtZXNwYWNlIEVtYmVyCiovCkVtYmVyLkxvZ2dl
        ciA9IHsKICAvKioKICAgTG9ncyB0aGUgYXJndW1lbnRzIHRvIHRoZSBjb25z
        b2xlLgogICBZb3UgY2FuIHBhc3MgYXMgbWFueSBhcmd1bWVudHMgYXMgeW91
        IHdhbnQgYW5kIHRoZXkgd2lsbCBiZSBqb2luZWQgdG9nZXRoZXIgd2l0aCBh
        IHNwYWNlLgoKICAgIGBgYGphdmFzY3JpcHQKICAgIHZhciBmb28gPSAxOwog
        ICAgRW1iZXIuTG9nZ2VyLmxvZygnbG9nIHZhbHVlIG9mIGZvbzonLCBmb28p
        OyAvLyAibG9nIHZhbHVlIG9mIGZvbzogMSIgd2lsbCBiZSBwcmludGVkIHRv
        IHRoZSBjb25zb2xlCiAgICBgYGAKCiAgIEBtZXRob2QgbG9nCiAgIEBmb3Ig
        RW1iZXIuTG9nZ2VyCiAgIEBwYXJhbSB7Kn0gYXJndW1lbnRzCiAgKi8KICBs
        b2c6ICAgY29uc29sZU1ldGhvZCgnbG9nJykgICB8fCBFbWJlci5LLAogIC8q
        KgogICBQcmludHMgdGhlIGFyZ3VtZW50cyB0byB0aGUgY29uc29sZSB3aXRo
        IGEgd2FybmluZyBpY29uLgogICBZb3UgY2FuIHBhc3MgYXMgbWFueSBhcmd1
        bWVudHMgYXMgeW91IHdhbnQgYW5kIHRoZXkgd2lsbCBiZSBqb2luZWQgdG9n
        ZXRoZXIgd2l0aCBhIHNwYWNlLgoKICAgIGBgYGphdmFzY3JpcHQKICAgIEVt
        YmVyLkxvZ2dlci53YXJuKCdTb21ldGhpbmcgaGFwcGVuZWQhJyk7IC8vICJT
        b21ldGhpbmcgaGFwcGVuZWQhIiB3aWxsIGJlIHByaW50ZWQgdG8gdGhlIGNv
        bnNvbGUgd2l0aCBhIHdhcm5pbmcgaWNvbi4KICAgIGBgYAoKICAgQG1ldGhv
        ZCB3YXJuCiAgIEBmb3IgRW1iZXIuTG9nZ2VyCiAgIEBwYXJhbSB7Kn0gYXJn
        dW1lbnRzCiAgKi8KICB3YXJuOiAgY29uc29sZU1ldGhvZCgnd2FybicpICB8
        fCBFbWJlci5LLAogIC8qKgogICBQcmludHMgdGhlIGFyZ3VtZW50cyB0byB0
        aGUgY29uc29sZSB3aXRoIGFuIGVycm9yIGljb24sIHJlZCB0ZXh0IGFuZCBh
        IHN0YWNrIHJhY2UuCiAgIFlvdSBjYW4gcGFzcyBhcyBtYW55IGFyZ3VtZW50
        cyBhcyB5b3Ugd2FudCBhbmQgdGhleSB3aWxsIGJlIGpvaW5lZCB0b2dldGhl
        ciB3aXRoIGEgc3BhY2UuCgogICAgYGBgamF2YXNjcmlwdAogICAgRW1iZXIu
        TG9nZ2VyLmVycm9yKCdEYW5nZXIhIERhbmdlciEnKTsgLy8gIkRhbmdlciEg
        RGFuZ2VyISIgd2lsbCBiZSBwcmludGVkIHRvIHRoZSBjb25zb2xlIGluIHJl
        ZCB0ZXh0LgogICAgYGBgCgogICBAbWV0aG9kIGVycm9yCiAgIEBmb3IgRW1i
        ZXIuTG9nZ2VyCiAgIEBwYXJhbSB7Kn0gYXJndW1lbnRzCiAgKi8KICBlcnJv
        cjogY29uc29sZU1ldGhvZCgnZXJyb3InKSB8fCBFbWJlci5LLAogIC8qKgog
        ICBMb2dzIHRoZSBhcmd1bWVudHMgdG8gdGhlIGNvbnNvbGUuCiAgIFlvdSBj
        YW4gcGFzcyBhcyBtYW55IGFyZ3VtZW50cyBhcyB5b3Ugd2FudCBhbmQgdGhl
        eSB3aWxsIGJlIGpvaW5lZCB0b2dldGhlciB3aXRoIGEgc3BhY2UuCgogICAg
        YGBgamF2YXNjcmlwdAogICAgdmFyIGZvbyA9IDE7CiAgICBFbWJlci5Mb2dn
        ZXIuaW5mbygnbG9nIHZhbHVlIG9mIGZvbzonLCBmb28pOyAvLyAibG9nIHZh
        bHVlIG9mIGZvbzogMSIgd2lsbCBiZSBwcmludGVkIHRvIHRoZSBjb25zb2xl
        CiAgICBgYGAKCiAgIEBtZXRob2QgaW5mbwogICBAZm9yIEVtYmVyLkxvZ2dl
        cgogICBAcGFyYW0geyp9IGFyZ3VtZW50cwogICovCiAgaW5mbzogIGNvbnNv
        bGVNZXRob2QoJ2luZm8nKSAgfHwgRW1iZXIuSywKICAvKioKICAgTG9ncyB0
        aGUgYXJndW1lbnRzIHRvIHRoZSBjb25zb2xlIGluIGJsdWUgdGV4dC4KICAg
        WW91IGNhbiBwYXNzIGFzIG1hbnkgYXJndW1lbnRzIGFzIHlvdSB3YW50IGFu
        ZCB0aGV5IHdpbGwgYmUgam9pbmVkIHRvZ2V0aGVyIHdpdGggYSBzcGFjZS4K
        CiAgICBgYGBqYXZhc2NyaXB0CiAgICB2YXIgZm9vID0gMTsKICAgIEVtYmVy
        LkxvZ2dlci5kZWJ1ZygnbG9nIHZhbHVlIG9mIGZvbzonLCBmb28pOyAvLyAi
        bG9nIHZhbHVlIG9mIGZvbzogMSIgd2lsbCBiZSBwcmludGVkIHRvIHRoZSBj
        b25zb2xlCiAgICBgYGAKCiAgIEBtZXRob2QgZGVidWcKICAgQGZvciBFbWJl
        ci5Mb2dnZXIKICAgQHBhcmFtIHsqfSBhcmd1bWVudHMKICAqLwogIGRlYnVn
        OiBjb25zb2xlTWV0aG9kKCdkZWJ1ZycpIHx8IGNvbnNvbGVNZXRob2QoJ2lu
        Zm8nKSB8fCBFbWJlci5LLAogIC8qKgoKICAgSWYgdGhlIHZhbHVlIHBhc3Nl
        ZCBpbnRvIEVtYmVyLkxvZ2dlci5hc3NlcnQgaXMgbm90IHRydXRoeSBpdCB3
        aWxsIHRocm93IGFuIGVycm9yIHdpdGggYSBzdGFjayB0cmFjZS4KCiAgICBg
        YGBqYXZhc2NyaXB0CiAgICBFbWJlci5Mb2dnZXIuYXNzZXJ0KHRydWUpOyAv
        LyB1bmRlZmluZWQKICAgIEVtYmVyLkxvZ2dlci5hc3NlcnQodHJ1ZSA9PT0g
        ZmFsc2UpOyAvLyBUaHJvd3MgYW4gQXNzZXJ0aW9uIGZhaWxlZCBlcnJvci4K
        ICAgIGBgYAoKICAgQG1ldGhvZCBhc3NlcnQKICAgQGZvciBFbWJlci5Mb2dn
        ZXIKICAgQHBhcmFtIHtCb29sZWFufSBib29sIFZhbHVlIHRvIHRlc3QKICAq
        LwogIGFzc2VydDogY29uc29sZU1ldGhvZCgnYXNzZXJ0JykgfHwgYXNzZXJ0
        UG9seWZpbGwKfTsKCgovLyAuLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4u
        Li4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uCi8vIEVSUk9SIEhBTkRM
        SU5HCi8vCgovKioKICBBIGZ1bmN0aW9uIG1heSBiZSBhc3NpZ25lZCB0byBg
        RW1iZXIub25lcnJvcmAgdG8gYmUgY2FsbGVkIHdoZW4gRW1iZXIKICBpbnRl
        cm5hbHMgZW5jb3VudGVyIGFuIGVycm9yLiBUaGlzIGlzIHVzZWZ1bCBmb3Ig
        c3BlY2lhbGl6ZWQgZXJyb3IgaGFuZGxpbmcKICBhbmQgcmVwb3J0aW5nIGNv
        ZGUuCgogIGBgYGphdmFzY3JpcHQKICBFbWJlci5vbmVycm9yID0gZnVuY3Rp
        b24oZXJyb3IpIHsKICAgIEVtLiQuYWpheCgnL3JlcG9ydC1lcnJvcicsICdQ
        T1NUJywgewogICAgICBzdGFjazogZXJyb3Iuc3RhY2ssCiAgICAgIG90aGVy
        SW5mb3JtYXRpb246ICd3aGF0ZXZlciBhcHAgc3RhdGUgeW91IHdhbnQgdG8g
        cHJvdmlkZScKICAgIH0pOwogIH07CiAgYGBgCgogIEBldmVudCBvbmVycm9y
        CiAgQGZvciBFbWJlcgogIEBwYXJhbSB7RXhjZXB0aW9ufSBlcnJvciB0aGUg
        ZXJyb3Igb2JqZWN0CiovCkVtYmVyLm9uZXJyb3IgPSBudWxsOwoKLyoqCiAg
        QHByaXZhdGUKCiAgV3JhcCBjb2RlIGJsb2NrIGluIGEgdHJ5L2NhdGNoIGlm
        IGBFbWJlci5vbmVycm9yYCBpcyBzZXQuCgogIEBtZXRob2QgaGFuZGxlRXJy
        b3JzCiAgQGZvciBFbWJlcgogIEBwYXJhbSB7RnVuY3Rpb259IGZ1bmMKICBA
        cGFyYW0gW2NvbnRleHRdCiovCkVtYmVyLmhhbmRsZUVycm9ycyA9IGZ1bmN0
        aW9uKGZ1bmMsIGNvbnRleHQpIHsKICAvLyBVbmZvcnR1bmF0ZWx5IGluIHNv
        bWUgYnJvd3NlcnMgd2UgbG9zZSB0aGUgYmFja3RyYWNlIGlmIHdlIHJldGhy
        b3cgdGhlIGV4aXN0aW5nIGVycm9yLAogIC8vIHNvIGluIHRoZSBldmVudCB0
        aGF0IHdlIGRvbid0IGhhdmUgYW4gYG9uZXJyb3JgIGhhbmRsZXIgd2UgZG9u
        J3Qgd3JhcCBpbiBhIHRyeS9jYXRjaAogIGlmICgnZnVuY3Rpb24nID09PSB0
        eXBlb2YgRW1iZXIub25lcnJvcikgewogICAgdHJ5IHsKICAgICAgcmV0dXJu
        IGZ1bmMuY2FsbChjb250ZXh0IHx8IHRoaXMpOwogICAgfSBjYXRjaCAoZXJy
        b3IpIHsKICAgICAgRW1iZXIub25lcnJvcihlcnJvcik7CiAgICB9CiAgfSBl
        bHNlIHsKICAgIHJldHVybiBmdW5jLmNhbGwoY29udGV4dCB8fCB0aGlzKTsK
        ICB9Cn07CgovKioKICBNZXJnZSB0aGUgY29udGVudHMgb2YgdHdvIG9iamVj
        dHMgdG9nZXRoZXIgaW50byB0aGUgZmlyc3Qgb2JqZWN0LgoKICBgYGBqYXZh
        c2NyaXB0CiAgRW1iZXIubWVyZ2Uoe2ZpcnN0OiAnVG9tJ30sIHtsYXN0OiAn
        RGFsZSd9KTsgLy8ge2ZpcnN0OiAnVG9tJywgbGFzdDogJ0RhbGUnfQogIHZh
        ciBhID0ge2ZpcnN0OiAnWWVodWRhJ30sIGIgPSB7bGFzdDogJ0thdHonfTsK
        ICBFbWJlci5tZXJnZShhLCBiKTsgLy8gYSA9PSB7Zmlyc3Q6ICdZZWh1ZGEn
        LCBsYXN0OiAnS2F0eid9LCBiID09IHtsYXN0OiAnS2F0eid9CiAgYGBgCgog
        IEBtZXRob2QgbWVyZ2UKICBAZm9yIEVtYmVyCiAgQHBhcmFtIHtPYmplY3R9
        IG9yaWdpbmFsIFRoZSBvYmplY3QgdG8gbWVyZ2UgaW50bwogIEBwYXJhbSB7
        T2JqZWN0fSB1cGRhdGVzIFRoZSBvYmplY3QgdG8gY29weSBwcm9wZXJ0aWVz
        IGZyb20KICBAcmV0dXJuIHtPYmplY3R9CiovCkVtYmVyLm1lcmdlID0gZnVu
        Y3Rpb24ob3JpZ2luYWwsIHVwZGF0ZXMpIHsKICBmb3IgKHZhciBwcm9wIGlu
        IHVwZGF0ZXMpIHsKICAgIGlmICghdXBkYXRlcy5oYXNPd25Qcm9wZXJ0eShw
        cm9wKSkgeyBjb250aW51ZTsgfQogICAgb3JpZ2luYWxbcHJvcF0gPSB1cGRh
        dGVzW3Byb3BdOwogIH0KICByZXR1cm4gb3JpZ2luYWw7Cn07CgovKioKICBS
        ZXR1cm5zIHRydWUgaWYgdGhlIHBhc3NlZCB2YWx1ZSBpcyBudWxsIG9yIHVu
        ZGVmaW5lZC4gVGhpcyBhdm9pZHMgZXJyb3JzCiAgZnJvbSBKU0xpbnQgY29t
        cGxhaW5pbmcgYWJvdXQgdXNlIG9mID09LCB3aGljaCBjYW4gYmUgdGVjaG5p
        Y2FsbHkKICBjb25mdXNpbmcuCgogIGBgYGphdmFzY3JpcHQKICBFbWJlci5p
        c05vbmUoKTsgICAgICAgICAgICAgIC8vIHRydWUKICBFbWJlci5pc05vbmUo
        bnVsbCk7ICAgICAgICAgIC8vIHRydWUKICBFbWJlci5pc05vbmUodW5kZWZp
        bmVkKTsgICAgIC8vIHRydWUKICBFbWJlci5pc05vbmUoJycpOyAgICAgICAg
        ICAgIC8vIGZhbHNlCiAgRW1iZXIuaXNOb25lKFtdKTsgICAgICAgICAgICAv
        LyBmYWxzZQogIEVtYmVyLmlzTm9uZShmdW5jdGlvbigpIHt9KTsgIC8vIGZh
        bHNlCiAgYGBgCgogIEBtZXRob2QgaXNOb25lCiAgQGZvciBFbWJlcgogIEBw
        YXJhbSB7T2JqZWN0fSBvYmogVmFsdWUgdG8gdGVzdAogIEByZXR1cm4ge0Jv
        b2xlYW59CiovCkVtYmVyLmlzTm9uZSA9IGZ1bmN0aW9uKG9iaikgewogIHJl
        dHVybiBvYmogPT09IG51bGwgfHwgb2JqID09PSB1bmRlZmluZWQ7Cn07CkVt
        YmVyLm5vbmUgPSBFbWJlci5kZXByZWNhdGVGdW5jKCJFbWJlci5ub25lIGlz
        IGRlcHJlY2F0ZWQuIFBsZWFzZSB1c2UgRW1iZXIuaXNOb25lIGluc3RlYWQu
        IiwgRW1iZXIuaXNOb25lKTsKCi8qKgogIFZlcmlmaWVzIHRoYXQgYSB2YWx1
        ZSBpcyBgbnVsbGAgb3IgYW4gZW1wdHkgc3RyaW5nLCBlbXB0eSBhcnJheSwK
        ICBvciBlbXB0eSBmdW5jdGlvbi4KCiAgQ29uc3RyYWlucyB0aGUgcnVsZXMg
        b24gYEVtYmVyLmlzTm9uZWAgYnkgcmV0dXJuaW5nIGZhbHNlIGZvciBlbXB0
        eQogIHN0cmluZyBhbmQgZW1wdHkgYXJyYXlzLgoKICBgYGBqYXZhc2NyaXB0
        CiAgRW1iZXIuaXNFbXB0eSgpOyAgICAgICAgICAgICAgICAvLyB0cnVlCiAg
        RW1iZXIuaXNFbXB0eShudWxsKTsgICAgICAgICAgICAvLyB0cnVlCiAgRW1i
        ZXIuaXNFbXB0eSh1bmRlZmluZWQpOyAgICAgICAvLyB0cnVlCiAgRW1iZXIu
        aXNFbXB0eSgnJyk7ICAgICAgICAgICAgICAvLyB0cnVlCiAgRW1iZXIuaXNF
        bXB0eShbXSk7ICAgICAgICAgICAgICAvLyB0cnVlCiAgRW1iZXIuaXNFbXB0
        eSgnQWRhbSBIYXdraW5zJyk7ICAvLyBmYWxzZQogIEVtYmVyLmlzRW1wdHko
        WzAsMSwyXSk7ICAgICAgICAgLy8gZmFsc2UKICBgYGAKCiAgQG1ldGhvZCBp
        c0VtcHR5CiAgQGZvciBFbWJlcgogIEBwYXJhbSB7T2JqZWN0fSBvYmogVmFs
        dWUgdG8gdGVzdAogIEByZXR1cm4ge0Jvb2xlYW59CiovCkVtYmVyLmlzRW1w
        dHkgPSBmdW5jdGlvbihvYmopIHsKICByZXR1cm4gRW1iZXIuaXNOb25lKG9i
        aikgfHwgKG9iai5sZW5ndGggPT09IDAgJiYgdHlwZW9mIG9iaiAhPT0gJ2Z1
        bmN0aW9uJykgfHwgKHR5cGVvZiBvYmogPT09ICdvYmplY3QnICYmIEVtYmVy
        LmdldChvYmosICdsZW5ndGgnKSA9PT0gMCk7Cn07CkVtYmVyLmVtcHR5ID0g
        RW1iZXIuZGVwcmVjYXRlRnVuYygiRW1iZXIuZW1wdHkgaXMgZGVwcmVjYXRl
        ZC4gUGxlYXNlIHVzZSBFbWJlci5pc0VtcHR5IGluc3RlYWQuIiwgRW1iZXIu
        aXNFbXB0eSkgOwoKCn0pKCk7CgoKCihmdW5jdGlvbigpIHsKLypnbG9iYWxz
        IE5vZGUgKi8KLyoqCkBtb2R1bGUgZW1iZXItbWV0YWwKKi8KCi8qKgogIFBs
        YXRmb3JtIHNwZWNpZmljIG1ldGhvZHMgYW5kIGZlYXR1cmUgZGV0ZWN0b3Jz
        IG5lZWRlZCBieSB0aGUgZnJhbWV3b3JrLgoKICBAY2xhc3MgcGxhdGZvcm0K
        ICBAbmFtZXNwYWNlIEVtYmVyCiAgQHN0YXRpYwoqLwp2YXIgcGxhdGZvcm0g
        PSBFbWJlci5wbGF0Zm9ybSA9IHt9OwoKCi8qKgogIElkZW50aWNhbCB0byBg
        T2JqZWN0LmNyZWF0ZSgpYC4gSW1wbGVtZW50cyBpZiBub3QgYXZhaWxhYmxl
        IG5hdGl2ZWx5LgoKICBAbWV0aG9kIGNyZWF0ZQogIEBmb3IgRW1iZXIKKi8K
        RW1iZXIuY3JlYXRlID0gT2JqZWN0LmNyZWF0ZTsKCi8vIElFOCBoYXMgT2Jq
        ZWN0LmNyZWF0ZSBidXQgaXQgY291bGRuJ3QgdHJlYXQgcHJvcGVydHkgZGVz
        Y3JpcHRlcnMuCmlmIChFbWJlci5jcmVhdGUpIHsKICBpZiAoRW1iZXIuY3Jl
        YXRlKHthOiAxfSwge2E6IHt2YWx1ZTogMn19KS5hICE9PSAyKSB7CiAgICBF
        bWJlci5jcmVhdGUgPSBudWxsOwogIH0KfQoKLy8gU1RVQl9PQkpFQ1RfQ1JF
        QVRFIGFsbG93cyB1cyB0byBvdmVycmlkZSBvdGhlciBsaWJyYXJpZXMgdGhh
        dCBzdHViCi8vIE9iamVjdC5jcmVhdGUgZGlmZmVyZW50IHRoYW4gd2Ugd291
        bGQgcHJlZmVyCmlmICghRW1iZXIuY3JlYXRlIHx8IEVtYmVyLkVOVi5TVFVC
        X09CSkVDVF9DUkVBVEUpIHsKICB2YXIgSyA9IGZ1bmN0aW9uKCkge307Cgog
        IEVtYmVyLmNyZWF0ZSA9IGZ1bmN0aW9uKG9iaiwgcHJvcHMpIHsKICAgIEsu
        cHJvdG90eXBlID0gb2JqOwogICAgb2JqID0gbmV3IEsoKTsKICAgIGlmIChw
        cm9wcykgewogICAgICBLLnByb3RvdHlwZSA9IG9iajsKICAgICAgZm9yICh2
        YXIgcHJvcCBpbiBwcm9wcykgewogICAgICAgIEsucHJvdG90eXBlW3Byb3Bd
        ID0gcHJvcHNbcHJvcF0udmFsdWU7CiAgICAgIH0KICAgICAgb2JqID0gbmV3
        IEsoKTsKICAgIH0KICAgIEsucHJvdG90eXBlID0gbnVsbDsKCiAgICByZXR1
        cm4gb2JqOwogIH07CgogIEVtYmVyLmNyZWF0ZS5pc1NpbXVsYXRlZCA9IHRy
        dWU7Cn0KCnZhciBkZWZpbmVQcm9wZXJ0eSA9IE9iamVjdC5kZWZpbmVQcm9w
        ZXJ0eTsKdmFyIGNhblJlZGVmaW5lUHJvcGVydGllcywgY2FuRGVmaW5lUHJv
        cGVydHlPbkRPTTsKCi8vIENhdGNoIElFOCB3aGVyZSBPYmplY3QuZGVmaW5l
        UHJvcGVydHkgZXhpc3RzIGJ1dCBvbmx5IHdvcmtzIG9uIERPTSBlbGVtZW50
        cwppZiAoZGVmaW5lUHJvcGVydHkpIHsKICB0cnkgewogICAgZGVmaW5lUHJv
        cGVydHkoe30sICdhJyx7Z2V0OmZ1bmN0aW9uKCkge319KTsKICB9IGNhdGNo
        IChlKSB7CiAgICBkZWZpbmVQcm9wZXJ0eSA9IG51bGw7CiAgfQp9CgppZiAo
        ZGVmaW5lUHJvcGVydHkpIHsKICAvLyBEZXRlY3RzIGEgYnVnIGluIEFuZHJv
        aWQgPDMuMiB3aGVyZSB5b3UgY2Fubm90IHJlZGVmaW5lIGEgcHJvcGVydHkg
        dXNpbmcKICAvLyBPYmplY3QuZGVmaW5lUHJvcGVydHkgb25jZSBhY2Nlc3Nv
        cnMgaGF2ZSBhbHJlYWR5IGJlZW4gc2V0LgogIGNhblJlZGVmaW5lUHJvcGVy
        dGllcyA9IChmdW5jdGlvbigpIHsKICAgIHZhciBvYmogPSB7fTsKCiAgICBk
        ZWZpbmVQcm9wZXJ0eShvYmosICdhJywgewogICAgICBjb25maWd1cmFibGU6
        IHRydWUsCiAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgIGdldDogZnVu
        Y3Rpb24oKSB7IH0sCiAgICAgIHNldDogZnVuY3Rpb24oKSB7IH0KICAgIH0p
        OwoKICAgIGRlZmluZVByb3BlcnR5KG9iaiwgJ2EnLCB7CiAgICAgIGNvbmZp
        Z3VyYWJsZTogdHJ1ZSwKICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAg
        d3JpdGFibGU6IHRydWUsCiAgICAgIHZhbHVlOiB0cnVlCiAgICB9KTsKCiAg
        ICByZXR1cm4gb2JqLmEgPT09IHRydWU7CiAgfSkoKTsKCiAgLy8gVGhpcyBp
        cyBmb3IgU2FmYXJpIDUuMCwgd2hpY2ggc3VwcG9ydHMgT2JqZWN0LmRlZmlu
        ZVByb3BlcnR5LCBidXQgbm90CiAgLy8gb24gRE9NIG5vZGVzLgogIGNhbkRl
        ZmluZVByb3BlcnR5T25ET00gPSAoZnVuY3Rpb24oKSB7CiAgICB0cnkgewog
        ICAgICBkZWZpbmVQcm9wZXJ0eShkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdk
        aXYnKSwgJ2RlZmluZVByb3BlcnR5T25ET00nLCB7fSk7CiAgICAgIHJldHVy
        biB0cnVlOwogICAgfSBjYXRjaChlKSB7IH0KCiAgICByZXR1cm4gZmFsc2U7
        CiAgfSkoKTsKCiAgaWYgKCFjYW5SZWRlZmluZVByb3BlcnRpZXMpIHsKICAg
        IGRlZmluZVByb3BlcnR5ID0gbnVsbDsKICB9IGVsc2UgaWYgKCFjYW5EZWZp
        bmVQcm9wZXJ0eU9uRE9NKSB7CiAgICBkZWZpbmVQcm9wZXJ0eSA9IGZ1bmN0
        aW9uKG9iaiwga2V5TmFtZSwgZGVzYykgewogICAgICB2YXIgaXNOb2RlOwoK
        ICAgICAgaWYgKHR5cGVvZiBOb2RlID09PSAib2JqZWN0IikgewogICAgICAg
        IGlzTm9kZSA9IG9iaiBpbnN0YW5jZW9mIE5vZGU7CiAgICAgIH0gZWxzZSB7
        CiAgICAgICAgaXNOb2RlID0gdHlwZW9mIG9iaiA9PT0gIm9iamVjdCIgJiYg
        dHlwZW9mIG9iai5ub2RlVHlwZSA9PT0gIm51bWJlciIgJiYgdHlwZW9mIG9i
        ai5ub2RlTmFtZSA9PT0gInN0cmluZyI7CiAgICAgIH0KCiAgICAgIGlmIChp
        c05vZGUpIHsKICAgICAgICAvLyBUT0RPOiBTaG91bGQgd2UgaGF2ZSBhIHdh
        cm5pbmcgaGVyZT8KICAgICAgICByZXR1cm4gKG9ialtrZXlOYW1lXSA9IGRl
        c2MudmFsdWUpOwogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiBPYmpl
        Y3QuZGVmaW5lUHJvcGVydHkob2JqLCBrZXlOYW1lLCBkZXNjKTsKICAgICAg
        fQogICAgfTsKICB9Cn0KCi8qKgpAY2xhc3MgcGxhdGZvcm0KQG5hbWVzcGFj
        ZSBFbWJlcgoqLwoKLyoqCiAgSWRlbnRpY2FsIHRvIGBPYmplY3QuZGVmaW5l
        UHJvcGVydHkoKWAuIEltcGxlbWVudHMgYXMgbXVjaCBmdW5jdGlvbmFsaXR5
        CiAgYXMgcG9zc2libGUgaWYgbm90IGF2YWlsYWJsZSBuYXRpdmVseS4KCiAg
        QG1ldGhvZCBkZWZpbmVQcm9wZXJ0eQogIEBwYXJhbSB7T2JqZWN0fSBvYmog
        VGhlIG9iamVjdCB0byBtb2RpZnkKICBAcGFyYW0ge1N0cmluZ30ga2V5TmFt
        ZSBwcm9wZXJ0eSBuYW1lIHRvIG1vZGlmeQogIEBwYXJhbSB7T2JqZWN0fSBk
        ZXNjIGRlc2NyaXB0b3IgaGFzaAogIEByZXR1cm4ge3ZvaWR9CiovCnBsYXRm
        b3JtLmRlZmluZVByb3BlcnR5ID0gZGVmaW5lUHJvcGVydHk7CgovKioKICBT
        ZXQgdG8gdHJ1ZSBpZiB0aGUgcGxhdGZvcm0gc3VwcG9ydHMgbmF0aXZlIGdl
        dHRlcnMgYW5kIHNldHRlcnMuCgogIEBwcm9wZXJ0eSBoYXNQcm9wZXJ0eUFj
        Y2Vzc29ycwogIEBmaW5hbAoqLwpwbGF0Zm9ybS5oYXNQcm9wZXJ0eUFjY2Vz
        c29ycyA9IHRydWU7CgppZiAoIXBsYXRmb3JtLmRlZmluZVByb3BlcnR5KSB7
        CiAgcGxhdGZvcm0uaGFzUHJvcGVydHlBY2Nlc3NvcnMgPSBmYWxzZTsKCiAg
        cGxhdGZvcm0uZGVmaW5lUHJvcGVydHkgPSBmdW5jdGlvbihvYmosIGtleU5h
        bWUsIGRlc2MpIHsKICAgIGlmICghZGVzYy5nZXQpIHsgb2JqW2tleU5hbWVd
        ID0gZGVzYy52YWx1ZTsgfQogIH07CgogIHBsYXRmb3JtLmRlZmluZVByb3Bl
        cnR5LmlzU2ltdWxhdGVkID0gdHJ1ZTsKfQoKaWYgKEVtYmVyLkVOVi5NQU5E
        QVRPUllfU0VUVEVSICYmICFwbGF0Zm9ybS5oYXNQcm9wZXJ0eUFjY2Vzc29y
        cykgewogIEVtYmVyLkVOVi5NQU5EQVRPUllfU0VUVEVSID0gZmFsc2U7Cn0K
        Cn0pKCk7CgoKCihmdW5jdGlvbigpIHsKLypqc2hpbnQgbmV3Y2FwOmZhbHNl
        Ki8KLyoqCkBtb2R1bGUgZW1iZXItbWV0YWwKKi8KCi8vIE5PVEU6IFRoZXJl
        IGlzIGEgYnVnIGluIGpzaGludCB0aGF0IGRvZXNuJ3QgcmVjb2duaXplIGBP
        YmplY3QoKWAgd2l0aG91dCBgbmV3YAovLyBhcyBiZWluZyBvayB1bmxlc3Mg
        Ym90aCBgbmV3Y2FwOmZhbHNlYCBhbmQgbm90IGB1c2Ugc3RyaWN0YC4KLy8g
        aHR0cHM6Ly9naXRodWIuY29tL2pzaGludC9qc2hpbnQvaXNzdWVzLzM5MgoK
        Ly8gVGVzdGluZyB0aGlzIGlzIG5vdCBpZGVhbCwgYnV0IHdlIHdhbnQgdG8g
        dXNlIG5hdGl2ZSBmdW5jdGlvbnMKLy8gaWYgYXZhaWxhYmxlLCBidXQgbm90
        IHRvIHVzZSB2ZXJzaW9ucyBjcmVhdGVkIGJ5IGxpYnJhcmllcyBsaWtlIFBy
        b3RvdHlwZQp2YXIgaXNOYXRpdmVGdW5jID0gZnVuY3Rpb24oZnVuYykgewog
        IC8vIFRoaXMgc2hvdWxkIHByb2JhYmx5IHdvcmsgaW4gYWxsIGJyb3dzZXJz
        IGxpa2VseSB0byBoYXZlIEVTNSBhcnJheSBtZXRob2RzCiAgcmV0dXJuIGZ1
        bmMgJiYgRnVuY3Rpb24ucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoZnVuYyku
        aW5kZXhPZignW25hdGl2ZSBjb2RlXScpID4gLTE7Cn07CgovLyBGcm9tOiBo
        dHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi9KYXZhU2NyaXB0L1Jl
        ZmVyZW5jZS9HbG9iYWxfT2JqZWN0cy9hcnJheS9tYXAKdmFyIGFycmF5TWFw
        ID0gaXNOYXRpdmVGdW5jKEFycmF5LnByb3RvdHlwZS5tYXApID8gQXJyYXku
        cHJvdG90eXBlLm1hcCA6IGZ1bmN0aW9uKGZ1biAvKiwgdGhpc3AgKi8pIHsK
        ICAvLyJ1c2Ugc3RyaWN0IjsKCiAgaWYgKHRoaXMgPT09IHZvaWQgMCB8fCB0
        aGlzID09PSBudWxsKSB7CiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCk7CiAg
        fQoKICB2YXIgdCA9IE9iamVjdCh0aGlzKTsKICB2YXIgbGVuID0gdC5sZW5n
        dGggPj4+IDA7CiAgaWYgKHR5cGVvZiBmdW4gIT09ICJmdW5jdGlvbiIpIHsK
        ICAgIHRocm93IG5ldyBUeXBlRXJyb3IoKTsKICB9CgogIHZhciByZXMgPSBu
        ZXcgQXJyYXkobGVuKTsKICB2YXIgdGhpc3AgPSBhcmd1bWVudHNbMV07CiAg
        Zm9yICh2YXIgaSA9IDA7IGkgPCBsZW47IGkrKykgewogICAgaWYgKGkgaW4g
        dCkgewogICAgICByZXNbaV0gPSBmdW4uY2FsbCh0aGlzcCwgdFtpXSwgaSwg
        dCk7CiAgICB9CiAgfQoKICByZXR1cm4gcmVzOwp9OwoKLy8gRnJvbTogaHR0
        cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4vSmF2YVNjcmlwdC9SZWZl
        cmVuY2UvR2xvYmFsX09iamVjdHMvYXJyYXkvZm9yZWFjaAp2YXIgYXJyYXlG
        b3JFYWNoID0gaXNOYXRpdmVGdW5jKEFycmF5LnByb3RvdHlwZS5mb3JFYWNo
        KSA/IEFycmF5LnByb3RvdHlwZS5mb3JFYWNoIDogZnVuY3Rpb24oZnVuIC8q
        LCB0aGlzcCAqLykgewogIC8vInVzZSBzdHJpY3QiOwoKICBpZiAodGhpcyA9
        PT0gdm9pZCAwIHx8IHRoaXMgPT09IG51bGwpIHsKICAgIHRocm93IG5ldyBU
        eXBlRXJyb3IoKTsKICB9CgogIHZhciB0ID0gT2JqZWN0KHRoaXMpOwogIHZh
        ciBsZW4gPSB0Lmxlbmd0aCA+Pj4gMDsKICBpZiAodHlwZW9mIGZ1biAhPT0g
        ImZ1bmN0aW9uIikgewogICAgdGhyb3cgbmV3IFR5cGVFcnJvcigpOwogIH0K
        CiAgdmFyIHRoaXNwID0gYXJndW1lbnRzWzFdOwogIGZvciAodmFyIGkgPSAw
        OyBpIDwgbGVuOyBpKyspIHsKICAgIGlmIChpIGluIHQpIHsKICAgICAgZnVu
        LmNhbGwodGhpc3AsIHRbaV0sIGksIHQpOwogICAgfQogIH0KfTsKCnZhciBh
        cnJheUluZGV4T2YgPSBpc05hdGl2ZUZ1bmMoQXJyYXkucHJvdG90eXBlLmlu
        ZGV4T2YpID8gQXJyYXkucHJvdG90eXBlLmluZGV4T2YgOiBmdW5jdGlvbiAo
        b2JqLCBmcm9tSW5kZXgpIHsKICBpZiAoZnJvbUluZGV4ID09PSBudWxsIHx8
        IGZyb21JbmRleCA9PT0gdW5kZWZpbmVkKSB7IGZyb21JbmRleCA9IDA7IH0K
        ICBlbHNlIGlmIChmcm9tSW5kZXggPCAwKSB7IGZyb21JbmRleCA9IE1hdGgu
        bWF4KDAsIHRoaXMubGVuZ3RoICsgZnJvbUluZGV4KTsgfQogIGZvciAodmFy
        IGkgPSBmcm9tSW5kZXgsIGogPSB0aGlzLmxlbmd0aDsgaSA8IGo7IGkrKykg
        ewogICAgaWYgKHRoaXNbaV0gPT09IG9iaikgeyByZXR1cm4gaTsgfQogIH0K
        ICByZXR1cm4gLTE7Cn07CgovKioKICBBcnJheSBwb2x5ZmlsbHMgdG8gc3Vw
        cG9ydCBFUzUgZmVhdHVyZXMgaW4gb2xkZXIgYnJvd3NlcnMuCgogIEBuYW1l
        c3BhY2UgRW1iZXIKICBAcHJvcGVydHkgQXJyYXlQb2x5ZmlsbHMKKi8KRW1i
        ZXIuQXJyYXlQb2x5ZmlsbHMgPSB7CiAgbWFwOiBhcnJheU1hcCwKICBmb3JF
        YWNoOiBhcnJheUZvckVhY2gsCiAgaW5kZXhPZjogYXJyYXlJbmRleE9mCn07
        CgppZiAoRW1iZXIuU0hJTV9FUzUpIHsKICBpZiAoIUFycmF5LnByb3RvdHlw
        ZS5tYXApIHsKICAgIEFycmF5LnByb3RvdHlwZS5tYXAgPSBhcnJheU1hcDsK
        ICB9CgogIGlmICghQXJyYXkucHJvdG90eXBlLmZvckVhY2gpIHsKICAgIEFy
        cmF5LnByb3RvdHlwZS5mb3JFYWNoID0gYXJyYXlGb3JFYWNoOwogIH0KCiAg
        aWYgKCFBcnJheS5wcm90b3R5cGUuaW5kZXhPZikgewogICAgQXJyYXkucHJv
        dG90eXBlLmluZGV4T2YgPSBhcnJheUluZGV4T2Y7CiAgfQp9Cgp9KSgpOwoK
        CgooZnVuY3Rpb24oKSB7Ci8qKgpAbW9kdWxlIGVtYmVyLW1ldGFsCiovCgoK
        dmFyIG9fZGVmaW5lUHJvcGVydHkgPSBFbWJlci5wbGF0Zm9ybS5kZWZpbmVQ
        cm9wZXJ0eSwKICAgIG9fY3JlYXRlID0gRW1iZXIuY3JlYXRlLAogICAgLy8g
        VXNlZCBmb3IgZ3VpZCBnZW5lcmF0aW9uLi4uCiAgICBHVUlEX0tFWSA9ICdf
        X2VtYmVyJysgKCsgbmV3IERhdGUoKSksCiAgICB1dWlkICAgICAgICAgPSAw
        LAogICAgbnVtYmVyQ2FjaGUgID0gW10sCiAgICBzdHJpbmdDYWNoZSAgPSB7
        fTsKCnZhciBNQU5EQVRPUllfU0VUVEVSID0gRW1iZXIuRU5WLk1BTkRBVE9S
        WV9TRVRURVI7CgovKioKICBAcHJpdmF0ZQoKICBBIHVuaXF1ZSBrZXkgdXNl
        ZCB0byBhc3NpZ24gZ3VpZHMgYW5kIG90aGVyIHByaXZhdGUgbWV0YWRhdGEg
        dG8gb2JqZWN0cy4KICBJZiB5b3UgaW5zcGVjdCBhbiBvYmplY3QgaW4geW91
        ciBicm93c2VyIGRlYnVnZ2VyIHlvdSB3aWxsIG9mdGVuIHNlZSB0aGVzZS4K
        ICBUaGV5IGNhbiBiZSBzYWZlbHkgaWdub3JlZC4KCiAgT24gYnJvd3NlcnMg
        dGhhdCBzdXBwb3J0IGl0LCB0aGVzZSBwcm9wZXJ0aWVzIGFyZSBhZGRlZCB3
        aXRoIGVudW1lcmF0aW9uCiAgZGlzYWJsZWQgc28gdGhleSB3b24ndCBzaG93
        IHVwIHdoZW4geW91IGl0ZXJhdGUgb3ZlciB5b3VyIHByb3BlcnRpZXMuCgog
        IEBwcm9wZXJ0eSBHVUlEX0tFWQogIEBmb3IgRW1iZXIKICBAdHlwZSBTdHJp
        bmcKICBAZmluYWwKKi8KRW1iZXIuR1VJRF9LRVkgPSBHVUlEX0tFWTsKCnZh
        ciBHVUlEX0RFU0MgPSB7CiAgd3JpdGFibGU6ICAgIGZhbHNlLAogIGNvbmZp
        Z3VyYWJsZTogZmFsc2UsCiAgZW51bWVyYWJsZTogIGZhbHNlLAogIHZhbHVl
        OiBudWxsCn07CgovKioKICBAcHJpdmF0ZQoKICBHZW5lcmF0ZXMgYSBuZXcg
        Z3VpZCwgb3B0aW9uYWxseSBzYXZpbmcgdGhlIGd1aWQgdG8gdGhlIG9iamVj
        dCB0aGF0IHlvdQogIHBhc3MgaW4uIFlvdSB3aWxsIHJhcmVseSBuZWVkIHRv
        IHVzZSB0aGlzIG1ldGhvZC4gSW5zdGVhZCB5b3Ugc2hvdWxkCiAgY2FsbCBg
        RW1iZXIuZ3VpZEZvcihvYmopYCwgd2hpY2ggcmV0dXJuIGFuIGV4aXN0aW5n
        IGd1aWQgaWYgYXZhaWxhYmxlLgoKICBAbWV0aG9kIGdlbmVyYXRlR3VpZAog
        IEBmb3IgRW1iZXIKICBAcGFyYW0ge09iamVjdH0gW29ial0gT2JqZWN0IHRo
        ZSBndWlkIHdpbGwgYmUgdXNlZCBmb3IuIElmIHBhc3NlZCBpbiwgdGhlIGd1
        aWQgd2lsbAogICAgYmUgc2F2ZWQgb24gdGhlIG9iamVjdCBhbmQgcmV1c2Vk
        IHdoZW5ldmVyIHlvdSBwYXNzIHRoZSBzYW1lIG9iamVjdAogICAgYWdhaW4u
        CgogICAgSWYgbm8gb2JqZWN0IGlzIHBhc3NlZCwganVzdCBnZW5lcmF0ZSBh
        IG5ldyBndWlkLgogIEBwYXJhbSB7U3RyaW5nfSBbcHJlZml4XSBQcmVmaXgg
        dG8gcGxhY2UgaW4gZnJvbnQgb2YgdGhlIGd1aWQuIFVzZWZ1bCB3aGVuIHlv
        dSB3YW50IHRvCiAgICBzZXBhcmF0ZSB0aGUgZ3VpZCBpbnRvIHNlcGFyYXRl
        IG5hbWVzcGFjZXMuCiAgQHJldHVybiB7U3RyaW5nfSB0aGUgZ3VpZAoqLwpF
        bWJlci5nZW5lcmF0ZUd1aWQgPSBmdW5jdGlvbiBnZW5lcmF0ZUd1aWQob2Jq
        LCBwcmVmaXgpIHsKICBpZiAoIXByZWZpeCkgcHJlZml4ID0gJ2VtYmVyJzsK
        ICB2YXIgcmV0ID0gKHByZWZpeCArICh1dWlkKyspKTsKICBpZiAob2JqKSB7
        CiAgICBHVUlEX0RFU0MudmFsdWUgPSByZXQ7CiAgICBvX2RlZmluZVByb3Bl
        cnR5KG9iaiwgR1VJRF9LRVksIEdVSURfREVTQyk7CiAgfQogIHJldHVybiBy
        ZXQgOwp9OwoKLyoqCiAgQHByaXZhdGUKCiAgUmV0dXJucyBhIHVuaXF1ZSBp
        ZCBmb3IgdGhlIG9iamVjdC4gSWYgdGhlIG9iamVjdCBkb2VzIG5vdCB5ZXQg
        aGF2ZSBhIGd1aWQsCiAgb25lIHdpbGwgYmUgYXNzaWduZWQgdG8gaXQuIFlv
        dSBjYW4gY2FsbCB0aGlzIG9uIGFueSBvYmplY3QsCiAgYEVtYmVyLk9iamVj
        dGAtYmFzZWQgb3Igbm90LCBidXQgYmUgYXdhcmUgdGhhdCBpdCB3aWxsIGFk
        ZCBhIGBfZ3VpZGAKICBwcm9wZXJ0eS4KCiAgWW91IGNhbiBhbHNvIHVzZSB0
        aGlzIG1ldGhvZCBvbiBET00gRWxlbWVudCBvYmplY3RzLgoKICBAbWV0aG9k
        IGd1aWRGb3IKICBAZm9yIEVtYmVyCiAgQHBhcmFtIHtPYmplY3R9IG9iaiBh
        bnkgb2JqZWN0LCBzdHJpbmcsIG51bWJlciwgRWxlbWVudCwgb3IgcHJpbWl0
        aXZlCiAgQHJldHVybiB7U3RyaW5nfSB0aGUgdW5pcXVlIGd1aWQgZm9yIHRo
        aXMgaW5zdGFuY2UuCiovCkVtYmVyLmd1aWRGb3IgPSBmdW5jdGlvbiBndWlk
        Rm9yKG9iaikgewoKICAvLyBzcGVjaWFsIGNhc2VzIHdoZXJlIHdlIGRvbid0
        IHdhbnQgdG8gYWRkIGEga2V5IHRvIG9iamVjdAogIGlmIChvYmogPT09IHVu
        ZGVmaW5lZCkgcmV0dXJuICIodW5kZWZpbmVkKSI7CiAgaWYgKG9iaiA9PT0g
        bnVsbCkgcmV0dXJuICIobnVsbCkiOwoKICB2YXIgcmV0OwogIHZhciB0eXBl
        ID0gdHlwZW9mIG9iajsKCiAgLy8gRG9uJ3QgYWxsb3cgcHJvdG90eXBlIGNo
        YW5nZXMgdG8gU3RyaW5nIGV0Yy4gdG8gY2hhbmdlIHRoZSBndWlkRm9yCiAg
        c3dpdGNoKHR5cGUpIHsKICAgIGNhc2UgJ251bWJlcic6CiAgICAgIHJldCA9
        IG51bWJlckNhY2hlW29ial07CiAgICAgIGlmICghcmV0KSByZXQgPSBudW1i
        ZXJDYWNoZVtvYmpdID0gJ251JytvYmo7CiAgICAgIHJldHVybiByZXQ7Cgog
        ICAgY2FzZSAnc3RyaW5nJzoKICAgICAgcmV0ID0gc3RyaW5nQ2FjaGVbb2Jq
        XTsKICAgICAgaWYgKCFyZXQpIHJldCA9IHN0cmluZ0NhY2hlW29ial0gPSAn
        c3QnKyh1dWlkKyspOwogICAgICByZXR1cm4gcmV0OwoKICAgIGNhc2UgJ2Jv
        b2xlYW4nOgogICAgICByZXR1cm4gb2JqID8gJyh0cnVlKScgOiAnKGZhbHNl
        KSc7CgogICAgZGVmYXVsdDoKICAgICAgaWYgKG9ialtHVUlEX0tFWV0pIHJl
        dHVybiBvYmpbR1VJRF9LRVldOwogICAgICBpZiAob2JqID09PSBPYmplY3Qp
        IHJldHVybiAnKE9iamVjdCknOwogICAgICBpZiAob2JqID09PSBBcnJheSkg
        IHJldHVybiAnKEFycmF5KSc7CiAgICAgIHJldCA9ICdlbWJlcicrKHV1aWQr
        Kyk7CiAgICAgIEdVSURfREVTQy52YWx1ZSA9IHJldDsKICAgICAgb19kZWZp
        bmVQcm9wZXJ0eShvYmosIEdVSURfS0VZLCBHVUlEX0RFU0MpOwogICAgICBy
        ZXR1cm4gcmV0OwogIH0KfTsKCi8vIC4uLi4uLi4uLi4uLi4uLi4uLi4uLi4u
        Li4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4KLy8gTUVUQQov
        LwoKdmFyIE1FVEFfREVTQyA9IHsKICB3cml0YWJsZTogICAgdHJ1ZSwKICBj
        b25maWd1cmFibGU6IGZhbHNlLAogIGVudW1lcmFibGU6ICBmYWxzZSwKICB2
        YWx1ZTogbnVsbAp9OwoKdmFyIE1FVEFfS0VZID0gRW1iZXIuR1VJRF9LRVkr
        J19tZXRhJzsKCi8qKgogIFRoZSBrZXkgdXNlZCB0byBzdG9yZSBtZXRhIGlu
        Zm9ybWF0aW9uIG9uIG9iamVjdCBmb3IgcHJvcGVydHkgb2JzZXJ2aW5nLgoK
        ICBAcHJvcGVydHkgTUVUQV9LRVkKICBAZm9yIEVtYmVyCiAgQHByaXZhdGUK
        ICBAZmluYWwKICBAdHlwZSBTdHJpbmcKKi8KRW1iZXIuTUVUQV9LRVkgPSBN
        RVRBX0tFWTsKCi8vIFBsYWNlaG9sZGVyIGZvciBub24td3JpdGFibGUgbWV0
        YXMuCnZhciBFTVBUWV9NRVRBID0gewogIGRlc2NzOiB7fSwKICB3YXRjaGlu
        Zzoge30KfTsKCmlmIChNQU5EQVRPUllfU0VUVEVSKSB7IEVNUFRZX01FVEEu
        dmFsdWVzID0ge307IH0KCkVtYmVyLkVNUFRZX01FVEEgPSBFTVBUWV9NRVRB
        OwoKaWYgKE9iamVjdC5mcmVlemUpIE9iamVjdC5mcmVlemUoRU1QVFlfTUVU
        QSk7Cgp2YXIgaXNEZWZpbmVQcm9wZXJ0eVNpbXVsYXRlZCA9IEVtYmVyLnBs
        YXRmb3JtLmRlZmluZVByb3BlcnR5LmlzU2ltdWxhdGVkOwoKZnVuY3Rpb24g
        TWV0YShvYmopIHsKICB0aGlzLmRlc2NzID0ge307CiAgdGhpcy53YXRjaGlu
        ZyA9IHt9OwogIHRoaXMuY2FjaGUgPSB7fTsKICB0aGlzLnNvdXJjZSA9IG9i
        ajsKfQoKaWYgKGlzRGVmaW5lUHJvcGVydHlTaW11bGF0ZWQpIHsKICAvLyBv
        biBwbGF0Zm9ybXMgdGhhdCBkb24ndCBzdXBwb3J0IGVudW1lcmFibGUgZmFs
        c2UKICAvLyBtYWtlIG1ldGEgZmFpbCBqUXVlcnkuaXNQbGFpbk9iamVjdCgp
        IHRvIGhpZGUgZnJvbQogIC8vIGpRdWVyeS5leHRlbmQoKSBieSBoYXZpbmcg
        YSBwcm9wZXJ0eSB0aGF0IGZhaWxzCiAgLy8gaGFzT3duUHJvcGVydHkgY2hl
        Y2suCiAgTWV0YS5wcm90b3R5cGUuX19wcmV2ZW50UGxhaW5PYmplY3RfXyA9
        IHRydWU7CgogIC8vIFdpdGhvdXQgbm9uLWVudW1lcmFibGUgcHJvcGVydGll
        cywgbWV0YSBvYmplY3RzIHdpbGwgYmUgb3V0cHV0IGluIEpTT04KICAvLyB1
        bmxlc3MgZXhwbGljaXRseSBzdXBwcmVzc2VkCiAgTWV0YS5wcm90b3R5cGUu
        dG9KU09OID0gZnVuY3Rpb24gKCkgeyB9Owp9CgovKioKICBSZXRyaWV2ZXMg
        dGhlIG1ldGEgaGFzaCBmb3IgYW4gb2JqZWN0LiBJZiBgd3JpdGFibGVgIGlz
        IHRydWUgZW5zdXJlcyB0aGUKICBoYXNoIGlzIHdyaXRhYmxlIGZvciB0aGlz
        IG9iamVjdCBhcyB3ZWxsLgoKICBUaGUgbWV0YSBvYmplY3QgY29udGFpbnMg
        aW5mb3JtYXRpb24gYWJvdXQgY29tcHV0ZWQgcHJvcGVydHkgZGVzY3JpcHRv
        cnMgYXMKICB3ZWxsIGFzIGFueSB3YXRjaGVkIHByb3BlcnRpZXMgYW5kIG90
        aGVyIGluZm9ybWF0aW9uLiBZb3UgZ2VuZXJhbGx5IHdpbGwKICBub3QgYWNj
        ZXNzIHRoaXMgaW5mb3JtYXRpb24gZGlyZWN0bHkgYnV0IGluc3RlYWQgd29y
        ayB3aXRoIGhpZ2hlciBsZXZlbAogIG1ldGhvZHMgdGhhdCBtYW5pcHVsYXRl
        IHRoaXMgaGFzaCBpbmRpcmVjdGx5LgoKICBAbWV0aG9kIG1ldGEKICBAZm9y
        IEVtYmVyCiAgQHByaXZhdGUKCiAgQHBhcmFtIHtPYmplY3R9IG9iaiBUaGUg
        b2JqZWN0IHRvIHJldHJpZXZlIG1ldGEgZm9yCiAgQHBhcmFtIHtCb29sZWFu
        fSBbd3JpdGFibGU9dHJ1ZV0gUGFzcyBgZmFsc2VgIGlmIHlvdSBkbyBub3Qg
        aW50ZW5kIHRvIG1vZGlmeQogICAgdGhlIG1ldGEgaGFzaCwgYWxsb3dpbmcg
        dGhlIG1ldGhvZCB0byBhdm9pZCBtYWtpbmcgYW4gdW5uZWNlc3NhcnkgY29w
        eS4KICBAcmV0dXJuIHtPYmplY3R9IHRoZSBtZXRhIGhhc2ggZm9yIGFuIG9i
        amVjdAoqLwpFbWJlci5tZXRhID0gZnVuY3Rpb24gbWV0YShvYmosIHdyaXRh
        YmxlKSB7CgogIHZhciByZXQgPSBvYmpbTUVUQV9LRVldOwogIGlmICh3cml0
        YWJsZT09PWZhbHNlKSByZXR1cm4gcmV0IHx8IEVNUFRZX01FVEE7CgogIGlm
        ICghcmV0KSB7CiAgICBpZiAoIWlzRGVmaW5lUHJvcGVydHlTaW11bGF0ZWQp
        IG9fZGVmaW5lUHJvcGVydHkob2JqLCBNRVRBX0tFWSwgTUVUQV9ERVNDKTsK
        CiAgICByZXQgPSBuZXcgTWV0YShvYmopOwoKICAgIGlmIChNQU5EQVRPUllf
        U0VUVEVSKSB7IHJldC52YWx1ZXMgPSB7fTsgfQoKICAgIG9ialtNRVRBX0tF
        WV0gPSByZXQ7CgogICAgLy8gbWFrZSBzdXJlIHdlIGRvbid0IGFjY2lkZW50
        YWxseSB0cnkgdG8gY3JlYXRlIGNvbnN0cnVjdG9yIGxpa2UgZGVzYwogICAg
        cmV0LmRlc2NzLmNvbnN0cnVjdG9yID0gbnVsbDsKCiAgfSBlbHNlIGlmIChy
        ZXQuc291cmNlICE9PSBvYmopIHsKICAgIGlmICghaXNEZWZpbmVQcm9wZXJ0
        eVNpbXVsYXRlZCkgb19kZWZpbmVQcm9wZXJ0eShvYmosIE1FVEFfS0VZLCBN
        RVRBX0RFU0MpOwoKICAgIHJldCA9IG9fY3JlYXRlKHJldCk7CiAgICByZXQu
        ZGVzY3MgICAgPSBvX2NyZWF0ZShyZXQuZGVzY3MpOwogICAgcmV0LndhdGNo
        aW5nID0gb19jcmVhdGUocmV0LndhdGNoaW5nKTsKICAgIHJldC5jYWNoZSAg
        ICA9IHt9OwogICAgcmV0LnNvdXJjZSAgID0gb2JqOwoKICAgIGlmIChNQU5E
        QVRPUllfU0VUVEVSKSB7IHJldC52YWx1ZXMgPSBvX2NyZWF0ZShyZXQudmFs
        dWVzKTsgfQoKICAgIG9ialtNRVRBX0tFWV0gPSByZXQ7CiAgfQogIHJldHVy
        biByZXQ7Cn07CgpFbWJlci5nZXRNZXRhID0gZnVuY3Rpb24gZ2V0TWV0YShv
        YmosIHByb3BlcnR5KSB7CiAgdmFyIG1ldGEgPSBFbWJlci5tZXRhKG9iaiwg
        ZmFsc2UpOwogIHJldHVybiBtZXRhW3Byb3BlcnR5XTsKfTsKCkVtYmVyLnNl
        dE1ldGEgPSBmdW5jdGlvbiBzZXRNZXRhKG9iaiwgcHJvcGVydHksIHZhbHVl
        KSB7CiAgdmFyIG1ldGEgPSBFbWJlci5tZXRhKG9iaiwgdHJ1ZSk7CiAgbWV0
        YVtwcm9wZXJ0eV0gPSB2YWx1ZTsKICByZXR1cm4gdmFsdWU7Cn07CgovKioK
        ICBAZGVwcmVjYXRlZAogIEBwcml2YXRlCgogIEluIG9yZGVyIHRvIHN0b3Jl
        IGRlZmF1bHRzIGZvciBhIGNsYXNzLCBhIHByb3RvdHlwZSBtYXkgbmVlZCB0
        byBjcmVhdGUKICBhIGRlZmF1bHQgbWV0YSBvYmplY3QsIHdoaWNoIHdpbGwg
        YmUgaW5oZXJpdGVkIGJ5IGFueSBvYmplY3RzIGluc3RhbnRpYXRlZAogIGZy
        b20gdGhlIGNsYXNzJ3MgY29uc3RydWN0b3IuCgogIEhvd2V2ZXIsIHRoZSBw
        cm9wZXJ0aWVzIG9mIHRoYXQgbWV0YSBvYmplY3QgYXJlIG9ubHkgc2hhbGxv
        dy1jbG9uZWQsCiAgc28gaWYgYSBwcm9wZXJ0eSBpcyBhIGhhc2ggKGxpa2Ug
        dGhlIGV2ZW50IHN5c3RlbSdzIGBsaXN0ZW5lcnNgIGhhc2gpLAogIGl0IHdp
        bGwgYnkgZGVmYXVsdCBiZSBzaGFyZWQgYWNyb3NzIGFsbCBpbnN0YW5jZXMg
        b2YgdGhhdCBjbGFzcy4KCiAgVGhpcyBtZXRob2QgYWxsb3dzIGV4dGVuc2lv
        bnMgdG8gZGVlcGx5IGNsb25lIGEgc2VyaWVzIG9mIG5lc3RlZCBoYXNoZXMg
        b3IKICBvdGhlciBjb21wbGV4IG9iamVjdHMuIEZvciBpbnN0YW5jZSwgdGhl
        IGV2ZW50IHN5c3RlbSBtaWdodCBwYXNzCiAgYFsnbGlzdGVuZXJzJywgJ2Zv
        bzpjaGFuZ2UnLCAnZW1iZXIxNTcnXWAgdG8gYHByZXBhcmVNZXRhUGF0aGAs
        IHdoaWNoIHdpbGwKICB3YWxrIGRvd24gdGhlIGtleXMgcHJvdmlkZWQuCgog
        IEZvciBlYWNoIGtleSwgaWYgdGhlIGtleSBkb2VzIG5vdCBleGlzdCwgaXQg
        aXMgY3JlYXRlZC4gSWYgaXQgYWxyZWFkeQogIGV4aXN0cyBhbmQgaXQgd2Fz
        IGluaGVyaXRlZCBmcm9tIGl0cyBjb25zdHJ1Y3RvciwgdGhlIGNvbnN0cnVj
        dG9yJ3MKICBrZXkgaXMgY2xvbmVkLgoKICBZb3UgY2FuIGFsc28gcGFzcyBm
        YWxzZSBmb3IgYHdyaXRhYmxlYCwgd2hpY2ggd2lsbCBzaW1wbHkgcmV0dXJu
        CiAgdW5kZWZpbmVkIGlmIGBwcmVwYXJlTWV0YVBhdGhgIGRpc2NvdmVycyBh
        bnkgcGFydCBvZiB0aGUgcGF0aCB0aGF0CiAgc2hhcmVkIG9yIHVuZGVmaW5l
        ZC4KCiAgQG1ldGhvZCBtZXRhUGF0aAogIEBmb3IgRW1iZXIKICBAcGFyYW0g
        e09iamVjdH0gb2JqIFRoZSBvYmplY3Qgd2hvc2UgbWV0YSB3ZSBhcmUgZXhh
        bWluaW5nCiAgQHBhcmFtIHtBcnJheX0gcGF0aCBBbiBhcnJheSBvZiBrZXlz
        IHRvIHdhbGsgZG93bgogIEBwYXJhbSB7Qm9vbGVhbn0gd3JpdGFibGUgd2hl
        dGhlciBvciBub3QgdG8gY3JlYXRlIGEgbmV3IG1ldGEKICAgIChvciBtZXRh
        IHByb3BlcnR5KSBpZiBvbmUgZG9lcyBub3QgYWxyZWFkeSBleGlzdCBvciBp
        ZiBpdCdzCiAgICBzaGFyZWQgd2l0aCBpdHMgY29uc3RydWN0b3IKKi8KRW1i
        ZXIubWV0YVBhdGggPSBmdW5jdGlvbiBtZXRhUGF0aChvYmosIHBhdGgsIHdy
        aXRhYmxlKSB7CiAgRW1iZXIuZGVwcmVjYXRlKCJFbWJlci5tZXRhUGF0aCBp
        cyBkZXByZWNhdGVkIGFuZCB3aWxsIGJlIHJlbW92ZWQgZnJvbSBmdXR1cmUg
        cmVsZWFzZXMuIik7CiAgdmFyIG1ldGEgPSBFbWJlci5tZXRhKG9iaiwgd3Jp
        dGFibGUpLCBrZXlOYW1lLCB2YWx1ZTsKCiAgZm9yICh2YXIgaT0wLCBsPXBh
        dGgubGVuZ3RoOyBpPGw7IGkrKykgewogICAga2V5TmFtZSA9IHBhdGhbaV07
        CiAgICB2YWx1ZSA9IG1ldGFba2V5TmFtZV07CgogICAgaWYgKCF2YWx1ZSkg
        ewogICAgICBpZiAoIXdyaXRhYmxlKSB7IHJldHVybiB1bmRlZmluZWQ7IH0K
        ICAgICAgdmFsdWUgPSBtZXRhW2tleU5hbWVdID0geyBfX2VtYmVyX3NvdXJj
        ZV9fOiBvYmogfTsKICAgIH0gZWxzZSBpZiAodmFsdWUuX19lbWJlcl9zb3Vy
        Y2VfXyAhPT0gb2JqKSB7CiAgICAgIGlmICghd3JpdGFibGUpIHsgcmV0dXJu
        IHVuZGVmaW5lZDsgfQogICAgICB2YWx1ZSA9IG1ldGFba2V5TmFtZV0gPSBv
        X2NyZWF0ZSh2YWx1ZSk7CiAgICAgIHZhbHVlLl9fZW1iZXJfc291cmNlX18g
        PSBvYmo7CiAgICB9CgogICAgbWV0YSA9IHZhbHVlOwogIH0KCiAgcmV0dXJu
        IHZhbHVlOwp9OwoKLyoqCiAgQHByaXZhdGUKCiAgV3JhcHMgdGhlIHBhc3Nl
        ZCBmdW5jdGlvbiBzbyB0aGF0IGB0aGlzLl9zdXBlcmAgd2lsbCBwb2ludCB0
        byB0aGUgc3VwZXJGdW5jCiAgd2hlbiB0aGUgZnVuY3Rpb24gaXMgaW52b2tl
        ZC4gVGhpcyBpcyB0aGUgcHJpbWl0aXZlIHdlIHVzZSB0byBpbXBsZW1lbnQK
        ICBjYWxscyB0byBzdXBlci4KCiAgQG1ldGhvZCB3cmFwCiAgQGZvciBFbWJl
        cgogIEBwYXJhbSB7RnVuY3Rpb259IGZ1bmMgVGhlIGZ1bmN0aW9uIHRvIGNh
        bGwKICBAcGFyYW0ge0Z1bmN0aW9ufSBzdXBlckZ1bmMgVGhlIHN1cGVyIGZ1
        bmN0aW9uLgogIEByZXR1cm4ge0Z1bmN0aW9ufSB3cmFwcGVkIGZ1bmN0aW9u
        LgoqLwpFbWJlci53cmFwID0gZnVuY3Rpb24oZnVuYywgc3VwZXJGdW5jKSB7
        CiAgZnVuY3Rpb24gSygpIHt9CgogIGZ1bmN0aW9uIHN1cGVyV3JhcHBlcigp
        IHsKICAgIHZhciByZXQsIHN1cCA9IHRoaXMuX3N1cGVyOwogICAgdGhpcy5f
        c3VwZXIgPSBzdXBlckZ1bmMgfHwgSzsKICAgIHJldCA9IGZ1bmMuYXBwbHko
        dGhpcywgYXJndW1lbnRzKTsKICAgIHRoaXMuX3N1cGVyID0gc3VwOwogICAg
        cmV0dXJuIHJldDsKICB9CgogIHN1cGVyV3JhcHBlci53cmFwcGVkRnVuY3Rp
        b24gPSBmdW5jOwogIHN1cGVyV3JhcHBlci5fX2VtYmVyX29ic2VydmVzX18g
        PSBmdW5jLl9fZW1iZXJfb2JzZXJ2ZXNfXzsKICBzdXBlcldyYXBwZXIuX19l
        bWJlcl9vYnNlcnZlc0JlZm9yZV9fID0gZnVuYy5fX2VtYmVyX29ic2VydmVz
        QmVmb3JlX187CiAgc3VwZXJXcmFwcGVyLl9fZW1iZXJfbGlzdGVuc19fID0g
        ZnVuYy5fX2VtYmVyX2xpc3RlbnNfXzsKCiAgcmV0dXJuIHN1cGVyV3JhcHBl
        cjsKfTsKCi8qKgogIFJldHVybnMgdHJ1ZSBpZiB0aGUgcGFzc2VkIG9iamVj
        dCBpcyBhbiBhcnJheSBvciBBcnJheS1saWtlLgoKICBFbWJlciBBcnJheSBQ
        cm90b2NvbDoKCiAgICAtIHRoZSBvYmplY3QgaGFzIGFuIG9iamVjdEF0IHBy
        b3BlcnR5CiAgICAtIHRoZSBvYmplY3QgaXMgYSBuYXRpdmUgQXJyYXkKICAg
        IC0gdGhlIG9iamVjdCBpcyBhbiBPYmplY3QsIGFuZCBoYXMgYSBsZW5ndGgg
        cHJvcGVydHkKCiAgVW5saWtlIGBFbWJlci50eXBlT2ZgIHRoaXMgbWV0aG9k
        IHJldHVybnMgdHJ1ZSBldmVuIGlmIHRoZSBwYXNzZWQgb2JqZWN0IGlzCiAg
        bm90IGZvcm1hbGx5IGFycmF5IGJ1dCBhcHBlYXJzIHRvIGJlIGFycmF5LWxp
        a2UgKGkuZS4gaW1wbGVtZW50cyBgRW1iZXIuQXJyYXlgKQoKICBgYGBqYXZh
        c2NyaXB0CiAgRW1iZXIuaXNBcnJheSgpOyAgICAgICAgICAgICAgICAgICAg
        ICAgICAgICAgICAgICAgICAgICAgICAgLy8gZmFsc2UKICBFbWJlci5pc0Fy
        cmF5KFtdKTsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
        ICAgICAvLyB0cnVlCiAgRW1iZXIuaXNBcnJheSggRW1iZXIuQXJyYXlQcm94
        eS5jcmVhdGUoeyBjb250ZW50OiBbXSB9KSApOyAgLy8gdHJ1ZQogIGBgYAoK
        ICBAbWV0aG9kIGlzQXJyYXkKICBAZm9yIEVtYmVyCiAgQHBhcmFtIHtPYmpl
        Y3R9IG9iaiBUaGUgb2JqZWN0IHRvIHRlc3QKICBAcmV0dXJuIHtCb29sZWFu
        fSB0cnVlIGlmIHRoZSBwYXNzZWQgb2JqZWN0IGlzIGFuIGFycmF5IG9yIEFy
        cmF5LWxpa2UKKi8KRW1iZXIuaXNBcnJheSA9IGZ1bmN0aW9uKG9iaikgewog
        IGlmICghb2JqIHx8IG9iai5zZXRJbnRlcnZhbCkgeyByZXR1cm4gZmFsc2U7
        IH0KICBpZiAoQXJyYXkuaXNBcnJheSAmJiBBcnJheS5pc0FycmF5KG9iaikp
        IHsgcmV0dXJuIHRydWU7IH0KICBpZiAoRW1iZXIuQXJyYXkgJiYgRW1iZXIu
        QXJyYXkuZGV0ZWN0KG9iaikpIHsgcmV0dXJuIHRydWU7IH0KICBpZiAoKG9i
        ai5sZW5ndGggIT09IHVuZGVmaW5lZCkgJiYgJ29iamVjdCc9PT10eXBlb2Yg
        b2JqKSB7IHJldHVybiB0cnVlOyB9CiAgcmV0dXJuIGZhbHNlOwp9OwoKLyoq
        CiAgRm9yY2VzIHRoZSBwYXNzZWQgb2JqZWN0IHRvIGJlIHBhcnQgb2YgYW4g
        YXJyYXkuIElmIHRoZSBvYmplY3QgaXMgYWxyZWFkeQogIGFuIGFycmF5IG9y
        IGFycmF5LWxpa2UsIHJldHVybnMgdGhlIG9iamVjdC4gT3RoZXJ3aXNlIGFk
        ZHMgdGhlIG9iamVjdCB0bwogIGFuIGFycmF5LiBJZiBvYmogaXMgYG51bGxg
        IG9yIGB1bmRlZmluZWRgLCByZXR1cm5zIGFuIGVtcHR5IGFycmF5LgoKICBg
        YGBqYXZhc2NyaXB0CiAgRW1iZXIubWFrZUFycmF5KCk7ICAgICAgICAgICAg
        ICAgICAgICAgICAgICAgLy8gW10KICBFbWJlci5tYWtlQXJyYXkobnVsbCk7
        ICAgICAgICAgICAgICAgICAgICAgICAvLyBbXQogIEVtYmVyLm1ha2VBcnJh
        eSh1bmRlZmluZWQpOyAgICAgICAgICAgICAgICAgIC8vIFtdCiAgRW1iZXIu
        bWFrZUFycmF5KCdsaW5kc2F5Jyk7ICAgICAgICAgICAgICAgICAgLy8gWyds
        aW5kc2F5J10KICBFbWJlci5tYWtlQXJyYXkoWzEsMiw0Ml0pOyAgICAgICAg
        ICAgICAgICAgICAvLyBbMSwyLDQyXQoKICB2YXIgY29udHJvbGxlciA9IEVt
        YmVyLkFycmF5UHJveHkuY3JlYXRlKHsgY29udGVudDogW10gfSk7CiAgRW1i
        ZXIubWFrZUFycmF5KGNvbnRyb2xsZXIpID09PSBjb250cm9sbGVyOyAgLy8g
        dHJ1ZQogIGBgYAoKICBAbWV0aG9kIG1ha2VBcnJheQogIEBmb3IgRW1iZXIK
        ICBAcGFyYW0ge09iamVjdH0gb2JqIHRoZSBvYmplY3QKICBAcmV0dXJuIHtB
        cnJheX0KKi8KRW1iZXIubWFrZUFycmF5ID0gZnVuY3Rpb24ob2JqKSB7CiAg
        aWYgKG9iaiA9PT0gbnVsbCB8fCBvYmogPT09IHVuZGVmaW5lZCkgeyByZXR1
        cm4gW107IH0KICByZXR1cm4gRW1iZXIuaXNBcnJheShvYmopID8gb2JqIDog
        W29ial07Cn07CgpmdW5jdGlvbiBjYW5JbnZva2Uob2JqLCBtZXRob2ROYW1l
        KSB7CiAgcmV0dXJuICEhKG9iaiAmJiB0eXBlb2Ygb2JqW21ldGhvZE5hbWVd
        ID09PSAnZnVuY3Rpb24nKTsKfQoKLyoqCiAgQ2hlY2tzIHRvIHNlZSBpZiB0
        aGUgYG1ldGhvZE5hbWVgIGV4aXN0cyBvbiB0aGUgYG9iamAuCgogIGBgYGph
        dmFzY3JpcHQKICB2YXIgZm9vID0ge2JhcjogRW1iZXIuSywgYmF6OiBudWxs
        fTsKICBFbWJlci5jYW5JbnZva2UoZm9vLCAnYmFyJyk7IC8vIHRydWUKICBF
        bWJlci5jYW5JbnZva2UoZm9vLCAnYmF6Jyk7IC8vIGZhbHNlCiAgRW1iZXIu
        Y2FuSW52b2tlKGZvbywgJ2JhdCcpOyAvLyBmYWxzZQogIGBgYAoKICBAbWV0
        aG9kIGNhbkludm9rZQogIEBmb3IgRW1iZXIKICBAcGFyYW0ge09iamVjdH0g
        b2JqIFRoZSBvYmplY3QgdG8gY2hlY2sgZm9yIHRoZSBtZXRob2QKICBAcGFy
        YW0ge1N0cmluZ30gbWV0aG9kTmFtZSBUaGUgbWV0aG9kIG5hbWUgdG8gY2hl
        Y2sgZm9yCiAgQHJldHVybiB7Qm9vbGVhbn0KKi8KRW1iZXIuY2FuSW52b2tl
        ID0gY2FuSW52b2tlOwoKLyoqCiAgQ2hlY2tzIHRvIHNlZSBpZiB0aGUgYG1l
        dGhvZE5hbWVgIGV4aXN0cyBvbiB0aGUgYG9iamAsCiAgYW5kIGlmIGl0IGRv
        ZXMsIGludm9rZXMgaXQgd2l0aCB0aGUgYXJndW1lbnRzIHBhc3NlZC4KCiAg
        YGBgamF2YXNjcmlwdAogIHZhciBkID0gbmV3IERhdGUoJzAzLzE1LzIwMTMn
        KTsKICBFbWJlci50cnlJbnZva2UoZCwgJ2dldFRpbWUnKTsgLy8gMTM2MzMy
        MDAwMDAwMAogIEVtYmVyLnRyeUludm9rZShkLCAnc2V0RnVsbFllYXInLCBb
        MjAxNF0pOyAvLyAxMzk0ODU2MDAwMDAwCiAgRW1iZXIudHJ5SW52b2tlKGQs
        ICdub1N1Y2hNZXRob2QnLCBbMjAxNF0pOyAvLyB1bmRlZmluZWQKICBgYGAK
        CiAgQG1ldGhvZCB0cnlJbnZva2UKICBAZm9yIEVtYmVyCiAgQHBhcmFtIHtP
        YmplY3R9IG9iaiBUaGUgb2JqZWN0IHRvIGNoZWNrIGZvciB0aGUgbWV0aG9k
        CiAgQHBhcmFtIHtTdHJpbmd9IG1ldGhvZE5hbWUgVGhlIG1ldGhvZCBuYW1l
        IHRvIGNoZWNrIGZvcgogIEBwYXJhbSB7QXJyYXl9IFthcmdzXSBUaGUgYXJn
        dW1lbnRzIHRvIHBhc3MgdG8gdGhlIG1ldGhvZAogIEByZXR1cm4geyp9IHRo
        ZSByZXR1cm4gdmFsdWUgb2YgdGhlIGludm9rZWQgbWV0aG9kIG9yIHVuZGVm
        aW5lZCBpZiBpdCBjYW5ub3QgYmUgaW52b2tlZAoqLwpFbWJlci50cnlJbnZv
        a2UgPSBmdW5jdGlvbihvYmosIG1ldGhvZE5hbWUsIGFyZ3MpIHsKICBpZiAo
        Y2FuSW52b2tlKG9iaiwgbWV0aG9kTmFtZSkpIHsKICAgIHJldHVybiBvYmpb
        bWV0aG9kTmFtZV0uYXBwbHkob2JqLCBhcmdzIHx8IFtdKTsKICB9Cn07Cgov
        LyBodHRwczovL2dpdGh1Yi5jb20vZW1iZXJqcy9lbWJlci5qcy9wdWxsLzE2
        MTcKdmFyIG5lZWRzRmluYWxseUZpeCA9IChmdW5jdGlvbigpIHsKICB2YXIg
        Y291bnQgPSAwOwogIHRyeXsKICAgIHRyeSB7IH0KICAgIGZpbmFsbHkgewog
        ICAgICBjb3VudCsrOwogICAgICB0aHJvdyBuZXcgRXJyb3IoJ25lZWRzRmlu
        YWxseUZpeFRlc3QnKTsKICAgIH0KICB9IGNhdGNoIChlKSB7fQoKICByZXR1
        cm4gY291bnQgIT09IDE7Cn0pKCk7CgovKioKICBQcm92aWRlcyB0cnkgeyB9
        IGZpbmFsbHkgeyB9IGZ1bmN0aW9uYWxpdHksIHdoaWxlIHdvcmtpbmcKICBh
        cm91bmQgU2FmYXJpJ3MgZG91YmxlIGZpbmFsbHkgYnVnLgoKICBgYGBqYXZh
        c2NyaXB0CiAgdmFyIHRyeWFibGUgPSBmdW5jdGlvbigpIHsKICAgIHNvbWVS
        ZXNvdXJjZS5sb2NrKCk7CiAgICBydW5DYWxsYmFjaygpOyAvLyBNYXkgdGhy
        b3cgZXJyb3IuCiAgfTsKICB2YXIgZmluYWxpemVyID0gZnVuY3Rpb24oKSB7
        CiAgICBzb21lUmVzb3VyY2UudW5sb2NrKCk7CiAgfTsKICBFbWJlci50cnlG
        aW5hbGx5KHRyeWFibGUsIGZpbmFsaXplcik7CiAgYGBgCgogIEBtZXRob2Qg
        dHJ5RmluYWxseQogIEBmb3IgRW1iZXIKICBAcGFyYW0ge0Z1bmN0aW9ufSB0
        cnlhYmxlIFRoZSBmdW5jdGlvbiB0byBydW4gdGhlIHRyeSBjYWxsYmFjawog
        IEBwYXJhbSB7RnVuY3Rpb259IGZpbmFsaXplciBUaGUgZnVuY3Rpb24gdG8g
        cnVuIHRoZSBmaW5hbGx5IGNhbGxiYWNrCiAgQHBhcmFtIHtPYmplY3R9IFti
        aW5kaW5nXSBUaGUgb3B0aW9uYWwgY2FsbGluZyBvYmplY3QuIERlZmF1bHRz
        IHRvICd0aGlzJwogIEByZXR1cm4geyp9IFRoZSByZXR1cm4gdmFsdWUgaXMg
        dGhlIHRoYXQgb2YgdGhlIGZpbmFsaXplciwKICB1bmxlc3MgdGhhdCB2YWx1
        ZSBpcyB1bmRlZmluZWQsIGluIHdoaWNoIGNhc2UgaXQgaXMgdGhlIHJldHVy
        biB2YWx1ZQogIG9mIHRoZSB0cnlhYmxlCiovCgppZiAobmVlZHNGaW5hbGx5
        Rml4KSB7CiAgRW1iZXIudHJ5RmluYWxseSA9IGZ1bmN0aW9uKHRyeWFibGUs
        IGZpbmFsaXplciwgYmluZGluZykgewogICAgdmFyIHJlc3VsdCwgZmluYWxS
        ZXN1bHQsIGZpbmFsRXJyb3I7CgogICAgYmluZGluZyA9IGJpbmRpbmcgfHwg
        dGhpczsKCiAgICB0cnkgewogICAgICByZXN1bHQgPSB0cnlhYmxlLmNhbGwo
        YmluZGluZyk7CiAgICB9IGZpbmFsbHkgewogICAgICB0cnkgewogICAgICAg
        IGZpbmFsUmVzdWx0ID0gZmluYWxpemVyLmNhbGwoYmluZGluZyk7CiAgICAg
        IH0gY2F0Y2ggKGUpIHsKICAgICAgICBmaW5hbEVycm9yID0gZTsKICAgICAg
        fQogICAgfQoKICAgIGlmIChmaW5hbEVycm9yKSB7IHRocm93IGZpbmFsRXJy
        b3I7IH0KCiAgICByZXR1cm4gKGZpbmFsUmVzdWx0ID09PSB1bmRlZmluZWQp
        ID8gcmVzdWx0IDogZmluYWxSZXN1bHQ7CiAgfTsKfSBlbHNlIHsKICBFbWJl
        ci50cnlGaW5hbGx5ID0gZnVuY3Rpb24odHJ5YWJsZSwgZmluYWxpemVyLCBi
        aW5kaW5nKSB7CiAgICB2YXIgcmVzdWx0LCBmaW5hbFJlc3VsdDsKCiAgICBi
        aW5kaW5nID0gYmluZGluZyB8fCB0aGlzOwoKICAgIHRyeSB7CiAgICAgIHJl
        c3VsdCA9IHRyeWFibGUuY2FsbChiaW5kaW5nKTsKICAgIH0gZmluYWxseSB7
        CiAgICAgIGZpbmFsUmVzdWx0ID0gZmluYWxpemVyLmNhbGwoYmluZGluZyk7
        CiAgICB9CgogICAgcmV0dXJuIChmaW5hbFJlc3VsdCA9PT0gdW5kZWZpbmVk
        KSA/IHJlc3VsdCA6IGZpbmFsUmVzdWx0OwogIH07Cn0KCi8qKgogIFByb3Zp
        ZGVzIHRyeSB7IH0gY2F0Y2ggZmluYWxseSB7IH0gZnVuY3Rpb25hbGl0eSwg
        d2hpbGUgd29ya2luZwogIGFyb3VuZCBTYWZhcmkncyBkb3VibGUgZmluYWxs
        eSBidWcuCgogIGBgYGphdmFzY3JpcHQKICB2YXIgdHJ5YWJsZSA9IGZ1bmN0
        aW9uKCkgewogICAgZm9yIChpPTAsIGw9bGlzdGVuZXJzLmxlbmd0aDsgaTxs
        OyBpKyspIHsKICAgICAgbGlzdGVuZXIgPSBsaXN0ZW5lcnNbaV07CiAgICAg
        IGJlZm9yZVZhbHVlc1tpXSA9IGxpc3RlbmVyLmJlZm9yZShuYW1lLCB0aW1l
        KCksIHBheWxvYWQpOwogICAgfQoKICAgIHJldHVybiBjYWxsYmFjay5jYWxs
        KGJpbmRpbmcpOwogIH07CgogIHZhciBjYXRjaGFibGUgPSBmdW5jdGlvbihl
        KSB7CiAgICBwYXlsb2FkID0gcGF5bG9hZCB8fCB7fTsKICAgIHBheWxvYWQu
        ZXhjZXB0aW9uID0gZTsKICB9OwoKICB2YXIgZmluYWxpemVyID0gZnVuY3Rp
        b24oKSB7CiAgICBmb3IgKGk9MCwgbD1saXN0ZW5lcnMubGVuZ3RoOyBpPGw7
        IGkrKykgewogICAgICBsaXN0ZW5lciA9IGxpc3RlbmVyc1tpXTsKICAgICAg
        bGlzdGVuZXIuYWZ0ZXIobmFtZSwgdGltZSgpLCBwYXlsb2FkLCBiZWZvcmVW
        YWx1ZXNbaV0pOwogICAgfQogIH07CiAgRW1iZXIudHJ5Q2F0Y2hGaW5hbGx5
        KHRyeWFibGUsIGNhdGNoYWJsZSwgZmluYWxpemVyKTsKICBgYGAKCiAgQG1l
        dGhvZCB0cnlDYXRjaEZpbmFsbHkKICBAZm9yIEVtYmVyCiAgQHBhcmFtIHtG
        dW5jdGlvbn0gdHJ5YWJsZSBUaGUgZnVuY3Rpb24gdG8gcnVuIHRoZSB0cnkg
        Y2FsbGJhY2sKICBAcGFyYW0ge0Z1bmN0aW9ufSBjYXRjaGFibGUgVGhlIGZ1
        bmN0aW9uIHRvIHJ1biB0aGUgY2F0Y2hhYmxlIGNhbGxiYWNrCiAgQHBhcmFt
        IHtGdW5jdGlvbn0gZmluYWxpemVyIFRoZSBmdW5jdGlvbiB0byBydW4gdGhl
        IGZpbmFsbHkgY2FsbGJhY2sKICBAcGFyYW0ge09iamVjdH0gW2JpbmRpbmdd
        IFRoZSBvcHRpb25hbCBjYWxsaW5nIG9iamVjdC4gRGVmYXVsdHMgdG8gJ3Ro
        aXMnCiAgQHJldHVybiB7Kn0gVGhlIHJldHVybiB2YWx1ZSBpcyB0aGUgdGhh
        dCBvZiB0aGUgZmluYWxpemVyLAogIHVubGVzcyB0aGF0IHZhbHVlIGlzIHVu
        ZGVmaW5lZCwgaW4gd2hpY2ggY2FzZSBpdCBpcyB0aGUgcmV0dXJuIHZhbHVl
        CiAgb2YgdGhlIHRyeWFibGUuCiovCmlmIChuZWVkc0ZpbmFsbHlGaXgpIHsK
        ICBFbWJlci50cnlDYXRjaEZpbmFsbHkgPSBmdW5jdGlvbih0cnlhYmxlLCBj
        YXRjaGFibGUsIGZpbmFsaXplciwgYmluZGluZykgewogICAgdmFyIHJlc3Vs
        dCwgZmluYWxSZXN1bHQsIGZpbmFsRXJyb3I7CgogICAgYmluZGluZyA9IGJp
        bmRpbmcgfHwgdGhpczsKCiAgICB0cnkgewogICAgICByZXN1bHQgPSB0cnlh
        YmxlLmNhbGwoYmluZGluZyk7CiAgICB9IGNhdGNoKGVycm9yKSB7CiAgICAg
        IHJlc3VsdCA9IGNhdGNoYWJsZS5jYWxsKGJpbmRpbmcsIGVycm9yKTsKICAg
        IH0gZmluYWxseSB7CiAgICAgIHRyeSB7CiAgICAgICAgZmluYWxSZXN1bHQg
        PSBmaW5hbGl6ZXIuY2FsbChiaW5kaW5nKTsKICAgICAgfSBjYXRjaCAoZSkg
        ewogICAgICAgIGZpbmFsRXJyb3IgPSBlOwogICAgICB9CiAgICB9CgogICAg
        aWYgKGZpbmFsRXJyb3IpIHsgdGhyb3cgZmluYWxFcnJvcjsgfQoKICAgIHJl
        dHVybiAoZmluYWxSZXN1bHQgPT09IHVuZGVmaW5lZCkgPyByZXN1bHQgOiBm
        aW5hbFJlc3VsdDsKICB9Owp9IGVsc2UgewogIEVtYmVyLnRyeUNhdGNoRmlu
        YWxseSA9IGZ1bmN0aW9uKHRyeWFibGUsIGNhdGNoYWJsZSwgZmluYWxpemVy
        LCBiaW5kaW5nKSB7CiAgICB2YXIgcmVzdWx0LCBmaW5hbFJlc3VsdDsKCiAg
        ICBiaW5kaW5nID0gYmluZGluZyB8fCB0aGlzOwoKICAgIHRyeSB7CiAgICAg
        IHJlc3VsdCA9IHRyeWFibGUuY2FsbChiaW5kaW5nKTsKICAgIH0gY2F0Y2go
        ZXJyb3IpIHsKICAgICAgcmVzdWx0ID0gY2F0Y2hhYmxlLmNhbGwoYmluZGlu
        ZywgZXJyb3IpOwogICAgfSBmaW5hbGx5IHsKICAgICAgZmluYWxSZXN1bHQg
        PSBmaW5hbGl6ZXIuY2FsbChiaW5kaW5nKTsKICAgIH0KCiAgICByZXR1cm4g
        KGZpbmFsUmVzdWx0ID09PSB1bmRlZmluZWQpID8gcmVzdWx0IDogZmluYWxS
        ZXN1bHQ7CiAgfTsKfQoKLy8gLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4u
        Li4uLi4uLi4uLi4uLgovLyBUWVBJTkcgJiBBUlJBWSBNRVNTQUdJTkcKLy8K
        CnZhciBUWVBFX01BUCA9IHt9Owp2YXIgdCA9ICJCb29sZWFuIE51bWJlciBT
        dHJpbmcgRnVuY3Rpb24gQXJyYXkgRGF0ZSBSZWdFeHAgT2JqZWN0Ii5zcGxp
        dCgiICIpOwpFbWJlci5BcnJheVBvbHlmaWxscy5mb3JFYWNoLmNhbGwodCwg
        ZnVuY3Rpb24obmFtZSkgewogIFRZUEVfTUFQWyAiW29iamVjdCAiICsgbmFt
        ZSArICJdIiBdID0gbmFtZS50b0xvd2VyQ2FzZSgpOwp9KTsKCnZhciB0b1N0
        cmluZyA9IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmc7CgovKioKICBSZXR1
        cm5zIGEgY29uc2lzdGVudCB0eXBlIGZvciB0aGUgcGFzc2VkIGl0ZW0uCgog
        IFVzZSB0aGlzIGluc3RlYWQgb2YgdGhlIGJ1aWx0LWluIGB0eXBlb2ZgIHRv
        IGdldCB0aGUgdHlwZSBvZiBhbiBpdGVtLgogIEl0IHdpbGwgcmV0dXJuIHRo
        ZSBzYW1lIHJlc3VsdCBhY3Jvc3MgYWxsIGJyb3dzZXJzIGFuZCBpbmNsdWRl
        cyBhIGJpdAogIG1vcmUgZGV0YWlsLiBIZXJlIGlzIHdoYXQgd2lsbCBiZSBy
        ZXR1cm5lZDoKCiAgICAgIHwgUmV0dXJuIFZhbHVlICB8IE1lYW5pbmcgICAg
        ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfAog
        ICAgICB8LS0tLS0tLS0tLS0tLS0tfC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
        LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLXwKICAgICAgfCAnc3Ry
        aW5nJyAgICAgIHwgU3RyaW5nIHByaW1pdGl2ZSAgICAgICAgICAgICAgICAg
        ICAgICAgICAgICAgICAgICAgICB8CiAgICAgIHwgJ251bWJlcicgICAgICB8
        IE51bWJlciBwcmltaXRpdmUgICAgICAgICAgICAgICAgICAgICAgICAgICAg
        ICAgICAgICAgfAogICAgICB8ICdib29sZWFuJyAgICAgfCBCb29sZWFuIHBy
        aW1pdGl2ZSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwK
        ICAgICAgfCAnbnVsbCcgICAgICAgIHwgTnVsbCB2YWx1ZSAgICAgICAgICAg
        ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8CiAgICAgIHwgJ3Vu
        ZGVmaW5lZCcgICB8IFVuZGVmaW5lZCB2YWx1ZSAgICAgICAgICAgICAgICAg
        ICAgICAgICAgICAgICAgICAgICAgfAogICAgICB8ICdmdW5jdGlvbicgICAg
        fCBBIGZ1bmN0aW9uICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
        ICAgICAgICAgIHwKICAgICAgfCAnYXJyYXknICAgICAgIHwgQW4gaW5zdGFu
        Y2Ugb2YgQXJyYXkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8
        CiAgICAgIHwgJ2NsYXNzJyAgICAgICB8IEFuIEVtYmVyIGNsYXNzIChjcmVh
        dGVkIHVzaW5nIEVtYmVyLk9iamVjdC5leHRlbmQoKSkgfAogICAgICB8ICdp
        bnN0YW5jZScgICAgfCBBbiBFbWJlciBvYmplY3QgaW5zdGFuY2UgICAgICAg
        ICAgICAgICAgICAgICAgICAgICAgIHwKICAgICAgfCAnZXJyb3InICAgICAg
        IHwgQW4gaW5zdGFuY2Ugb2YgdGhlIEVycm9yIG9iamVjdCAgICAgICAgICAg
        ICAgICAgICAgICB8CiAgICAgIHwgJ29iamVjdCcgICAgICB8IEEgSmF2YVNj
        cmlwdCBvYmplY3Qgbm90IGluaGVyaXRpbmcgZnJvbSBFbWJlci5PYmplY3Qg
        fAoKICBFeGFtcGxlczoKCiAgYGBgamF2YXNjcmlwdAogIEVtYmVyLnR5cGVP
        ZigpOyAgICAgICAgICAgICAgICAgICAgICAgLy8gJ3VuZGVmaW5lZCcKICBF
        bWJlci50eXBlT2YobnVsbCk7ICAgICAgICAgICAgICAgICAgIC8vICdudWxs
        JwogIEVtYmVyLnR5cGVPZih1bmRlZmluZWQpOyAgICAgICAgICAgICAgLy8g
        J3VuZGVmaW5lZCcKICBFbWJlci50eXBlT2YoJ21pY2hhZWwnKTsgICAgICAg
        ICAgICAgIC8vICdzdHJpbmcnCiAgRW1iZXIudHlwZU9mKDEwMSk7ICAgICAg
        ICAgICAgICAgICAgICAvLyAnbnVtYmVyJwogIEVtYmVyLnR5cGVPZih0cnVl
        KTsgICAgICAgICAgICAgICAgICAgLy8gJ2Jvb2xlYW4nCiAgRW1iZXIudHlw
        ZU9mKEVtYmVyLm1ha2VBcnJheSk7ICAgICAgICAvLyAnZnVuY3Rpb24nCiAg
        RW1iZXIudHlwZU9mKFsxLDIsOTBdKTsgICAgICAgICAgICAgICAvLyAnYXJy
        YXknCiAgRW1iZXIudHlwZU9mKEVtYmVyLk9iamVjdC5leHRlbmQoKSk7ICAv
        LyAnY2xhc3MnCiAgRW1iZXIudHlwZU9mKEVtYmVyLk9iamVjdC5jcmVhdGUo
        KSk7ICAvLyAnaW5zdGFuY2UnCiAgRW1iZXIudHlwZU9mKG5ldyBFcnJvcign
        dGVhbW9jaWwnKSk7ICAvLyAnZXJyb3InCgogIC8vICJub3JtYWwiIEphdmFT
        Y3JpcHQgb2JqZWN0CiAgRW1iZXIudHlwZU9mKHthOiAnYid9KTsgICAgICAg
        ICAgICAgIC8vICdvYmplY3QnCiAgYGBgCgogIEBtZXRob2QgdHlwZU9mCiAg
        QGZvciBFbWJlcgogIEBwYXJhbSB7T2JqZWN0fSBpdGVtIHRoZSBpdGVtIHRv
        IGNoZWNrCiAgQHJldHVybiB7U3RyaW5nfSB0aGUgdHlwZQoqLwpFbWJlci50
        eXBlT2YgPSBmdW5jdGlvbihpdGVtKSB7CiAgdmFyIHJldDsKCiAgcmV0ID0g
        KGl0ZW0gPT09IG51bGwgfHwgaXRlbSA9PT0gdW5kZWZpbmVkKSA/IFN0cmlu
        ZyhpdGVtKSA6IFRZUEVfTUFQW3RvU3RyaW5nLmNhbGwoaXRlbSldIHx8ICdv
        YmplY3QnOwoKICBpZiAocmV0ID09PSAnZnVuY3Rpb24nKSB7CiAgICBpZiAo
        RW1iZXIuT2JqZWN0ICYmIEVtYmVyLk9iamVjdC5kZXRlY3QoaXRlbSkpIHJl
        dCA9ICdjbGFzcyc7CiAgfSBlbHNlIGlmIChyZXQgPT09ICdvYmplY3QnKSB7
        CiAgICBpZiAoaXRlbSBpbnN0YW5jZW9mIEVycm9yKSByZXQgPSAnZXJyb3In
        OwogICAgZWxzZSBpZiAoRW1iZXIuT2JqZWN0ICYmIGl0ZW0gaW5zdGFuY2Vv
        ZiBFbWJlci5PYmplY3QpIHJldCA9ICdpbnN0YW5jZSc7CiAgICBlbHNlIHJl
        dCA9ICdvYmplY3QnOwogIH0KCiAgcmV0dXJuIHJldDsKfTsKCn0pKCk7CgoK
        CihmdW5jdGlvbigpIHsKLy8gRW1iZXIudHJ5Q2F0Y2hGaW5hbGx5CgovKioK
        ICBUaGUgcHVycG9zZSBvZiB0aGUgRW1iZXIgSW5zdHJ1bWVudGF0aW9uIG1v
        ZHVsZSBpcwogIHRvIHByb3ZpZGUgZWZmaWNpZW50LCBnZW5lcmFsLXB1cnBv
        c2UgaW5zdHJ1bWVudGF0aW9uCiAgZm9yIEVtYmVyLgoKICBTdWJzY3JpYmUg
        dG8gYSBsaXN0ZW5lciBieSB1c2luZyBgRW1iZXIuc3Vic2NyaWJlYDoKCiAg
        YGBgamF2YXNjcmlwdAogIEVtYmVyLnN1YnNjcmliZSgicmVuZGVyIiwgewog
        ICAgYmVmb3JlOiBmdW5jdGlvbihuYW1lLCB0aW1lc3RhbXAsIHBheWxvYWQp
        IHsKCiAgICB9LAoKICAgIGFmdGVyOiBmdW5jdGlvbihuYW1lLCB0aW1lc3Rh
        bXAsIHBheWxvYWQpIHsKCiAgICB9CiAgfSk7CiAgYGBgCgogIElmIHlvdSBy
        ZXR1cm4gYSB2YWx1ZSBmcm9tIHRoZSBgYmVmb3JlYCBjYWxsYmFjaywgdGhh
        dCBzYW1lCiAgdmFsdWUgd2lsbCBiZSBwYXNzZWQgYXMgYSBmb3VydGggcGFy
        YW1ldGVyIHRvIHRoZSBgYWZ0ZXJgCiAgY2FsbGJhY2suCgogIEluc3RydW1l
        bnQgYSBibG9jayBvZiBjb2RlIGJ5IHVzaW5nIGBFbWJlci5pbnN0cnVtZW50
        YDoKCiAgYGBgamF2YXNjcmlwdAogIEVtYmVyLmluc3RydW1lbnQoInJlbmRl
        ci5oYW5kbGViYXJzIiwgcGF5bG9hZCwgZnVuY3Rpb24oKSB7CiAgICAvLyBy
        ZW5kZXJpbmcgbG9naWMKICB9LCBiaW5kaW5nKTsKICBgYGAKCiAgRXZlbnQg
        bmFtZXMgcGFzc2VkIHRvIGBFbWJlci5pbnN0cnVtZW50YCBhcmUgbmFtZXNw
        YWNlZAogIGJ5IHBlcmlvZHMsIGZyb20gbW9yZSBnZW5lcmFsIHRvIG1vcmUg
        c3BlY2lmaWMuIFN1YnNjcmliZXJzCiAgY2FuIGxpc3RlbiBmb3IgZXZlbnRz
        IGJ5IHdoYXRldmVyIGxldmVsIG9mIGdyYW51bGFyaXR5IHRoZXkKICBhcmUg
        aW50ZXJlc3RlZCBpbi4KCiAgSW4gdGhlIGFib3ZlIGV4YW1wbGUsIHRoZSBl
        dmVudCBpcyBgcmVuZGVyLmhhbmRsZWJhcnNgLAogIGFuZCB0aGUgc3Vic2Ny
        aWJlciBsaXN0ZW5lZCBmb3IgYWxsIGV2ZW50cyBiZWdpbm5pbmcgd2l0aAog
        IGByZW5kZXJgLiBJdCB3b3VsZCByZWNlaXZlIGNhbGxiYWNrcyBmb3IgZXZl
        bnRzIG5hbWVkCiAgYHJlbmRlcmAsIGByZW5kZXIuaGFuZGxlYmFyc2AsIGBy
        ZW5kZXIuY29udGFpbmVyYCwgb3IKICBldmVuIGByZW5kZXIuaGFuZGxlYmFy
        cy5sYXlvdXRgLgoKICBAY2xhc3MgSW5zdHJ1bWVudGF0aW9uCiAgQG5hbWVz
        cGFjZSBFbWJlcgogIEBzdGF0aWMKKi8KRW1iZXIuSW5zdHJ1bWVudGF0aW9u
        ID0ge307Cgp2YXIgc3Vic2NyaWJlcnMgPSBbXSwgY2FjaGUgPSB7fTsKCnZh
        ciBwb3B1bGF0ZUxpc3RlbmVycyA9IGZ1bmN0aW9uKG5hbWUpIHsKICB2YXIg
        bGlzdGVuZXJzID0gW10sIHN1YnNjcmliZXI7CgogIGZvciAodmFyIGk9MCwg
        bD1zdWJzY3JpYmVycy5sZW5ndGg7IGk8bDsgaSsrKSB7CiAgICBzdWJzY3Jp
        YmVyID0gc3Vic2NyaWJlcnNbaV07CiAgICBpZiAoc3Vic2NyaWJlci5yZWdl
        eC50ZXN0KG5hbWUpKSB7CiAgICAgIGxpc3RlbmVycy5wdXNoKHN1YnNjcmli
        ZXIub2JqZWN0KTsKICAgIH0KICB9CgogIGNhY2hlW25hbWVdID0gbGlzdGVu
        ZXJzOwogIHJldHVybiBsaXN0ZW5lcnM7Cn07Cgp2YXIgdGltZSA9IChmdW5j
        dGlvbigpIHsKICB2YXIgcGVyZiA9ICd1bmRlZmluZWQnICE9PSB0eXBlb2Yg
        d2luZG93ID8gd2luZG93LnBlcmZvcm1hbmNlIHx8IHt9IDoge307CiAgdmFy
        IGZuID0gcGVyZi5ub3cgfHwgcGVyZi5tb3pOb3cgfHwgcGVyZi53ZWJraXRO
        b3cgfHwgcGVyZi5tc05vdyB8fCBwZXJmLm9Ob3c7CiAgLy8gZm4uYmluZCB3
        aWxsIGJlIGF2YWlsYWJsZSBpbiBhbGwgdGhlIGJyb3dzZXJzIHRoYXQgc3Vw
        cG9ydCB0aGUgYWR2YW5jZWQgd2luZG93LnBlcmZvcm1hbmNlLi4uIDstKQog
        IHJldHVybiBmbiA/IGZuLmJpbmQocGVyZikgOiBmdW5jdGlvbigpIHsgcmV0
        dXJuICtuZXcgRGF0ZSgpOyB9Owp9KSgpOwoKLyoqCiAgTm90aWZpZXMgZXZl
        bnQncyBzdWJzY3JpYmVycywgY2FsbHMgYGJlZm9yZWAgYW5kIGBhZnRlcmAg
        aG9va3MuCgogIEBtZXRob2QgaW5zdHJ1bWVudAogIEBuYW1lc3BhY2UgRW1i
        ZXIuSW5zdHJ1bWVudGF0aW9uCgogIEBwYXJhbSB7U3RyaW5nfSBbbmFtZV0g
        TmFtZXNwYWNlZCBldmVudCBuYW1lLgogIEBwYXJhbSB7T2JqZWN0fSBwYXls
        b2FkCiAgQHBhcmFtIHtGdW5jdGlvbn0gY2FsbGJhY2sgRnVuY3Rpb24gdGhh
        dCB5b3UncmUgaW5zdHJ1bWVudGluZy4KICBAcGFyYW0ge09iamVjdH0gYmlu
        ZGluZyBDb250ZXh0IHRoYXQgaW5zdHJ1bWVudCBmdW5jdGlvbiBpcyBjYWxs
        ZWQgd2l0aC4KKi8KRW1iZXIuSW5zdHJ1bWVudGF0aW9uLmluc3RydW1lbnQg
        PSBmdW5jdGlvbihuYW1lLCBwYXlsb2FkLCBjYWxsYmFjaywgYmluZGluZykg
        ewogIHZhciBsaXN0ZW5lcnMgPSBjYWNoZVtuYW1lXSwgdGltZU5hbWUsIHJl
        dDsKCiAgaWYgKEVtYmVyLlNUUlVDVFVSRURfUFJPRklMRSkgewogICAgdGlt
        ZU5hbWUgPSBuYW1lICsgIjogIiArIHBheWxvYWQub2JqZWN0OwogICAgY29u
        c29sZS50aW1lKHRpbWVOYW1lKTsKICB9CgogIGlmICghbGlzdGVuZXJzKSB7
        CiAgICBsaXN0ZW5lcnMgPSBwb3B1bGF0ZUxpc3RlbmVycyhuYW1lKTsKICB9
        CgogIGlmIChsaXN0ZW5lcnMubGVuZ3RoID09PSAwKSB7CiAgICByZXQgPSBj
        YWxsYmFjay5jYWxsKGJpbmRpbmcpOwogICAgaWYgKEVtYmVyLlNUUlVDVFVS
        RURfUFJPRklMRSkgeyBjb25zb2xlLnRpbWVFbmQodGltZU5hbWUpOyB9CiAg
        ICByZXR1cm4gcmV0OwogIH0KCiAgdmFyIGJlZm9yZVZhbHVlcyA9IFtdLCBs
        aXN0ZW5lciwgaSwgbDsKCiAgZnVuY3Rpb24gdHJ5YWJsZSgpIHsKICAgIGZv
        ciAoaT0wLCBsPWxpc3RlbmVycy5sZW5ndGg7IGk8bDsgaSsrKSB7CiAgICAg
        IGxpc3RlbmVyID0gbGlzdGVuZXJzW2ldOwogICAgICBiZWZvcmVWYWx1ZXNb
        aV0gPSBsaXN0ZW5lci5iZWZvcmUobmFtZSwgdGltZSgpLCBwYXlsb2FkKTsK
        ICAgIH0KCiAgICByZXR1cm4gY2FsbGJhY2suY2FsbChiaW5kaW5nKTsKICB9
        CgogIGZ1bmN0aW9uIGNhdGNoYWJsZShlKSB7CiAgICBwYXlsb2FkID0gcGF5
        bG9hZCB8fCB7fTsKICAgIHBheWxvYWQuZXhjZXB0aW9uID0gZTsKICB9Cgog
        IGZ1bmN0aW9uIGZpbmFsaXplcigpIHsKICAgIGZvciAoaT0wLCBsPWxpc3Rl
        bmVycy5sZW5ndGg7IGk8bDsgaSsrKSB7CiAgICAgIGxpc3RlbmVyID0gbGlz
        dGVuZXJzW2ldOwogICAgICBsaXN0ZW5lci5hZnRlcihuYW1lLCB0aW1lKCks
        IHBheWxvYWQsIGJlZm9yZVZhbHVlc1tpXSk7CiAgICB9CgogICAgaWYgKEVt
        YmVyLlNUUlVDVFVSRURfUFJPRklMRSkgewogICAgICBjb25zb2xlLnRpbWVF
        bmQodGltZU5hbWUpOwogICAgfQogIH0KCiAgcmV0dXJuIEVtYmVyLnRyeUNh
        dGNoRmluYWxseSh0cnlhYmxlLCBjYXRjaGFibGUsIGZpbmFsaXplcik7Cn07
        CgovKioKICBTdWJzY3JpYmVzIHRvIGEgcGFydGljdWxhciBldmVudCBvciBp
        bnN0cnVtZW50ZWQgYmxvY2sgb2YgY29kZS4KCiAgQG1ldGhvZCBzdWJzY3Jp
        YmUKICBAbmFtZXNwYWNlIEVtYmVyLkluc3RydW1lbnRhdGlvbgoKICBAcGFy
        YW0ge1N0cmluZ30gW3BhdHRlcm5dIE5hbWVzcGFjZWQgZXZlbnQgbmFtZS4K
        ICBAcGFyYW0ge09iamVjdH0gW29iamVjdF0gQmVmb3JlIGFuZCBBZnRlciBo
        b29rcy4KKi8KRW1iZXIuSW5zdHJ1bWVudGF0aW9uLnN1YnNjcmliZSA9IGZ1
        bmN0aW9uKHBhdHRlcm4sIG9iamVjdCkgewogIHZhciBwYXRocyA9IHBhdHRl
        cm4uc3BsaXQoIi4iKSwgcGF0aCwgcmVnZXggPSBbXTsKCiAgZm9yICh2YXIg
        aT0wLCBsPXBhdGhzLmxlbmd0aDsgaTxsOyBpKyspIHsKICAgIHBhdGggPSBw
        YXRoc1tpXTsKICAgIGlmIChwYXRoID09PSAiKiIpIHsKICAgICAgcmVnZXgu
        cHVzaCgiW15cXC5dKiIpOwogICAgfSBlbHNlIHsKICAgICAgcmVnZXgucHVz
        aChwYXRoKTsKICAgIH0KICB9CgogIHJlZ2V4ID0gcmVnZXguam9pbigiXFwu
        Iik7CiAgcmVnZXggPSByZWdleCArICIoXFwuLiopPyI7CgogIHZhciBzdWJz
        Y3JpYmVyID0gewogICAgcGF0dGVybjogcGF0dGVybiwKICAgIHJlZ2V4OiBu
        ZXcgUmVnRXhwKCJeIiArIHJlZ2V4ICsgIiQiKSwKICAgIG9iamVjdDogb2Jq
        ZWN0CiAgfTsKCiAgc3Vic2NyaWJlcnMucHVzaChzdWJzY3JpYmVyKTsKICBj
        YWNoZSA9IHt9OwoKICByZXR1cm4gc3Vic2NyaWJlcjsKfTsKCi8qKgogIFVu
        c3Vic2NyaWJlcyBmcm9tIGEgcGFydGljdWxhciBldmVudCBvciBpbnN0cnVt
        ZW50ZWQgYmxvY2sgb2YgY29kZS4KCiAgQG1ldGhvZCB1bnN1YnNjcmliZQog
        IEBuYW1lc3BhY2UgRW1iZXIuSW5zdHJ1bWVudGF0aW9uCgogIEBwYXJhbSB7
        T2JqZWN0fSBbc3Vic2NyaWJlcl0KKi8KRW1iZXIuSW5zdHJ1bWVudGF0aW9u
        LnVuc3Vic2NyaWJlID0gZnVuY3Rpb24oc3Vic2NyaWJlcikgewogIHZhciBp
        bmRleDsKCiAgZm9yICh2YXIgaT0wLCBsPXN1YnNjcmliZXJzLmxlbmd0aDsg
        aTxsOyBpKyspIHsKICAgIGlmIChzdWJzY3JpYmVyc1tpXSA9PT0gc3Vic2Ny
        aWJlcikgewogICAgICBpbmRleCA9IGk7CiAgICB9CiAgfQoKICBzdWJzY3Jp
        YmVycy5zcGxpY2UoaW5kZXgsIDEpOwogIGNhY2hlID0ge307Cn07CgovKioK
        ICBSZXNldHMgYEVtYmVyLkluc3RydW1lbnRhdGlvbmAgYnkgZmx1c2hpbmcg
        bGlzdCBvZiBzdWJzY3JpYmVycy4KCiAgQG1ldGhvZCByZXNldAogIEBuYW1l
        c3BhY2UgRW1iZXIuSW5zdHJ1bWVudGF0aW9uCiovCkVtYmVyLkluc3RydW1l
        bnRhdGlvbi5yZXNldCA9IGZ1bmN0aW9uKCkgewogIHN1YnNjcmliZXJzID0g
        W107CiAgY2FjaGUgPSB7fTsKfTsKCkVtYmVyLmluc3RydW1lbnQgPSBFbWJl
        ci5JbnN0cnVtZW50YXRpb24uaW5zdHJ1bWVudDsKRW1iZXIuc3Vic2NyaWJl
        ID0gRW1iZXIuSW5zdHJ1bWVudGF0aW9uLnN1YnNjcmliZTsKfSkoKTsKCgoK
        KGZ1bmN0aW9uKCkgewp2YXIgbWFwLCBmb3JFYWNoLCBpbmRleE9mLCBzcGxp
        Y2U7Cm1hcCAgICAgPSBBcnJheS5wcm90b3R5cGUubWFwICAgICB8fCBFbWJl
        ci5BcnJheVBvbHlmaWxscy5tYXA7CmZvckVhY2ggPSBBcnJheS5wcm90b3R5
        cGUuZm9yRWFjaCB8fCBFbWJlci5BcnJheVBvbHlmaWxscy5mb3JFYWNoOwpp
        bmRleE9mID0gQXJyYXkucHJvdG90eXBlLmluZGV4T2YgfHwgRW1iZXIuQXJy
        YXlQb2x5ZmlsbHMuaW5kZXhPZjsKc3BsaWNlID0gQXJyYXkucHJvdG90eXBl
        LnNwbGljZTsKCnZhciB1dGlscyA9IEVtYmVyLkVudW1lcmFibGVVdGlscyA9
        IHsKICBtYXA6IGZ1bmN0aW9uKG9iaiwgY2FsbGJhY2ssIHRoaXNBcmcpIHsK
        ICAgIHJldHVybiBvYmoubWFwID8gb2JqLm1hcC5jYWxsKG9iaiwgY2FsbGJh
        Y2ssIHRoaXNBcmcpIDogbWFwLmNhbGwob2JqLCBjYWxsYmFjaywgdGhpc0Fy
        Zyk7CiAgfSwKCiAgZm9yRWFjaDogZnVuY3Rpb24ob2JqLCBjYWxsYmFjaywg
        dGhpc0FyZykgewogICAgcmV0dXJuIG9iai5mb3JFYWNoID8gb2JqLmZvckVh
        Y2guY2FsbChvYmosIGNhbGxiYWNrLCB0aGlzQXJnKSA6IGZvckVhY2guY2Fs
        bChvYmosIGNhbGxiYWNrLCB0aGlzQXJnKTsKICB9LAoKICBpbmRleE9mOiBm
        dW5jdGlvbihvYmosIGVsZW1lbnQsIGluZGV4KSB7CiAgICByZXR1cm4gb2Jq
        LmluZGV4T2YgPyBvYmouaW5kZXhPZi5jYWxsKG9iaiwgZWxlbWVudCwgaW5k
        ZXgpIDogaW5kZXhPZi5jYWxsKG9iaiwgZWxlbWVudCwgaW5kZXgpOwogIH0s
        CgogIGluZGV4ZXNPZjogZnVuY3Rpb24ob2JqLCBlbGVtZW50cykgewogICAg
        cmV0dXJuIGVsZW1lbnRzID09PSB1bmRlZmluZWQgPyBbXSA6IHV0aWxzLm1h
        cChlbGVtZW50cywgZnVuY3Rpb24oaXRlbSkgewogICAgICByZXR1cm4gdXRp
        bHMuaW5kZXhPZihvYmosIGl0ZW0pOwogICAgfSk7CiAgfSwKCiAgYWRkT2Jq
        ZWN0OiBmdW5jdGlvbihhcnJheSwgaXRlbSkgewogICAgdmFyIGluZGV4ID0g
        dXRpbHMuaW5kZXhPZihhcnJheSwgaXRlbSk7CiAgICBpZiAoaW5kZXggPT09
        IC0xKSB7IGFycmF5LnB1c2goaXRlbSk7IH0KICB9LAoKICByZW1vdmVPYmpl
        Y3Q6IGZ1bmN0aW9uKGFycmF5LCBpdGVtKSB7CiAgICB2YXIgaW5kZXggPSB1
        dGlscy5pbmRleE9mKGFycmF5LCBpdGVtKTsKICAgIGlmIChpbmRleCAhPT0g
        LTEpIHsgYXJyYXkuc3BsaWNlKGluZGV4LCAxKTsgfQogIH0sCgogIF9yZXBs
        YWNlOiBmdW5jdGlvbihhcnJheSwgaWR4LCBhbXQsIG9iamVjdHMpIHsKICAg
        IHZhciBhcmdzID0gW10uY29uY2F0KG9iamVjdHMpLCBjaHVuaywgcmV0ID0g
        W10sCiAgICAgICAgLy8gaHR0cHM6Ly9jb2RlLmdvb2dsZS5jb20vcC9jaHJv
        bWl1bS9pc3N1ZXMvZGV0YWlsP2lkPTU2NTg4CiAgICAgICAgc2l6ZSA9IDYw
        MDAwLCBzdGFydCA9IGlkeCwgZW5kcyA9IGFtdCwgY291bnQ7CgogICAgd2hp
        bGUgKGFyZ3MubGVuZ3RoKSB7CiAgICAgIGNvdW50ID0gZW5kcyA+IHNpemUg
        PyBzaXplIDogZW5kczsKICAgICAgaWYgKGNvdW50IDw9IDApIHsgY291bnQg
        PSAwOyB9CgogICAgICBjaHVuayA9IGFyZ3Muc3BsaWNlKDAsIHNpemUpOwog
        ICAgICBjaHVuayA9IFtzdGFydCwgY291bnRdLmNvbmNhdChjaHVuayk7Cgog
        ICAgICBzdGFydCArPSBzaXplOwogICAgICBlbmRzIC09IGNvdW50OwoKICAg
        ICAgcmV0ID0gcmV0LmNvbmNhdChzcGxpY2UuYXBwbHkoYXJyYXksIGNodW5r
        KSk7CiAgICB9CiAgICByZXR1cm4gcmV0OwogIH0sCgogIHJlcGxhY2U6IGZ1
        bmN0aW9uKGFycmF5LCBpZHgsIGFtdCwgb2JqZWN0cykgewogICAgaWYgKGFy
        cmF5LnJlcGxhY2UpIHsKICAgICAgcmV0dXJuIGFycmF5LnJlcGxhY2UoaWR4
        LCBhbXQsIG9iamVjdHMpOwogICAgfSBlbHNlIHsKICAgICAgcmV0dXJuIHV0
        aWxzLl9yZXBsYWNlKGFycmF5LCBpZHgsIGFtdCwgb2JqZWN0cyk7CiAgICB9
        CiAgfSwKCiAgaW50ZXJzZWN0aW9uOiBmdW5jdGlvbihhcnJheTEsIGFycmF5
        MikgewogICAgdmFyIGludGVyc2VjdGlvbiA9IFtdOwoKICAgIHV0aWxzLmZv
        ckVhY2goYXJyYXkxLCBmdW5jdGlvbihlbGVtZW50KSB7CiAgICAgIGlmICh1
        dGlscy5pbmRleE9mKGFycmF5MiwgZWxlbWVudCkgPj0gMCkgewogICAgICAg
        IGludGVyc2VjdGlvbi5wdXNoKGVsZW1lbnQpOwogICAgICB9CiAgICB9KTsK
        CiAgICByZXR1cm4gaW50ZXJzZWN0aW9uOwogIH0KfTsKCn0pKCk7CgoKCihm
        dW5jdGlvbigpIHsKLyoqCkBtb2R1bGUgZW1iZXItbWV0YWwKKi8KCnZhciBN
        RVRBX0tFWSA9IEVtYmVyLk1FVEFfS0VZLCBnZXQ7Cgp2YXIgTUFOREFUT1JZ
        X1NFVFRFUiA9IEVtYmVyLkVOVi5NQU5EQVRPUllfU0VUVEVSOwoKdmFyIElT
        X0dMT0JBTF9QQVRIID0gL14oW0EtWiRdfChbMC05XVtBLVokXSkpLipbXC5c
        Kl0vOwp2YXIgSEFTX1RISVMgID0gL150aGlzW1wuXCpdLzsKdmFyIEZJUlNU
        X0tFWSA9IC9eKFteXC5cKl0rKS87CgovLyAuLi4uLi4uLi4uLi4uLi4uLi4u
        Li4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uCi8vIEdF
        VCBBTkQgU0VUCi8vCi8vIElmIHdlIGFyZSBvbiBhIHBsYXRmb3JtIHRoYXQg
        c3VwcG9ydHMgYWNjZXNzb3JzIHdlIGNhbiB1c2UgdGhvc2UuCi8vIE90aGVy
        d2lzZSBzaW11bGF0ZSBhY2Nlc3NvcnMgYnkgbG9va2luZyB1cCB0aGUgcHJv
        cGVydHkgZGlyZWN0bHkgb24gdGhlCi8vIG9iamVjdC4KCi8qKgogIEdldHMg
        dGhlIHZhbHVlIG9mIGEgcHJvcGVydHkgb24gYW4gb2JqZWN0LiBJZiB0aGUg
        cHJvcGVydHkgaXMgY29tcHV0ZWQsCiAgdGhlIGZ1bmN0aW9uIHdpbGwgYmUg
        aW52b2tlZC4gSWYgdGhlIHByb3BlcnR5IGlzIG5vdCBkZWZpbmVkIGJ1dCB0
        aGUKICBvYmplY3QgaW1wbGVtZW50cyB0aGUgYHVua25vd25Qcm9wZXJ0eWAg
        bWV0aG9kIHRoZW4gdGhhdCB3aWxsIGJlIGludm9rZWQuCgogIElmIHlvdSBw
        bGFuIHRvIHJ1biBvbiBJRTggYW5kIG9sZGVyIGJyb3dzZXJzIHRoZW4geW91
        IHNob3VsZCB1c2UgdGhpcwogIG1ldGhvZCBhbnl0aW1lIHlvdSB3YW50IHRv
        IHJldHJpZXZlIGEgcHJvcGVydHkgb24gYW4gb2JqZWN0IHRoYXQgeW91IGRv
        bid0CiAga25vdyBmb3Igc3VyZSBpcyBwcml2YXRlLiAoUHJvcGVydGllcyBi
        ZWdpbm5pbmcgd2l0aCBhbiB1bmRlcnNjb3JlICdfJwogIGFyZSBjb25zaWRl
        cmVkIHByaXZhdGUuKQoKICBPbiBhbGwgbmV3ZXIgYnJvd3NlcnMsIHlvdSBv
        bmx5IG5lZWQgdG8gdXNlIHRoaXMgbWV0aG9kIHRvIHJldHJpZXZlCiAgcHJv
        cGVydGllcyBpZiB0aGUgcHJvcGVydHkgbWlnaHQgbm90IGJlIGRlZmluZWQg
        b24gdGhlIG9iamVjdCBhbmQgeW91IHdhbnQKICB0byByZXNwZWN0IHRoZSBg
        dW5rbm93blByb3BlcnR5YCBoYW5kbGVyLiBPdGhlcndpc2UgeW91IGNhbiBp
        Z25vcmUgdGhpcwogIG1ldGhvZC4KCiAgTm90ZSB0aGF0IGlmIHRoZSBvYmpl
        Y3QgaXRzZWxmIGlzIGB1bmRlZmluZWRgLCB0aGlzIG1ldGhvZCB3aWxsIHRo
        cm93CiAgYW4gZXJyb3IuCgogIEBtZXRob2QgZ2V0CiAgQGZvciBFbWJlcgog
        IEBwYXJhbSB7T2JqZWN0fSBvYmogVGhlIG9iamVjdCB0byByZXRyaWV2ZSBm
        cm9tLgogIEBwYXJhbSB7U3RyaW5nfSBrZXlOYW1lIFRoZSBwcm9wZXJ0eSBr
        ZXkgdG8gcmV0cmlldmUKICBAcmV0dXJuIHtPYmplY3R9IHRoZSBwcm9wZXJ0
        eSB2YWx1ZSBvciBgbnVsbGAuCiovCmdldCA9IGZ1bmN0aW9uIGdldChvYmos
        IGtleU5hbWUpIHsKICAvLyBIZWxwZXJzIHRoYXQgb3BlcmF0ZSB3aXRoICd0
        aGlzJyB3aXRoaW4gYW4gI2VhY2gKICBpZiAoa2V5TmFtZSA9PT0gJycpIHsK
        ICAgIHJldHVybiBvYmo7CiAgfQoKICBpZiAoIWtleU5hbWUgJiYgJ3N0cmlu
        Zyc9PT10eXBlb2Ygb2JqKSB7CiAgICBrZXlOYW1lID0gb2JqOwogICAgb2Jq
        ID0gbnVsbDsKICB9CgogIEVtYmVyLmFzc2VydCgiQ2Fubm90IGNhbGwgZ2V0
        IHdpdGggIisga2V5TmFtZSArIiBrZXkuIiwgISFrZXlOYW1lKTsKICBFbWJl
        ci5hc3NlcnQoIkNhbm5vdCBjYWxsIGdldCB3aXRoICciKyBrZXlOYW1lICsi
        JyBvbiBhbiB1bmRlZmluZWQgb2JqZWN0LiIsIG9iaiAhPT0gdW5kZWZpbmVk
        KTsKCiAgaWYgKG9iaiA9PT0gbnVsbCB8fCBrZXlOYW1lLmluZGV4T2YoJy4n
        KSAhPT0gLTEpIHsKICAgIHJldHVybiBnZXRQYXRoKG9iaiwga2V5TmFtZSk7
        CiAgfQoKICB2YXIgbWV0YSA9IG9ialtNRVRBX0tFWV0sIGRlc2MgPSBtZXRh
        ICYmIG1ldGEuZGVzY3Nba2V5TmFtZV0sIHJldDsKICBpZiAoZGVzYykgewog
        ICAgcmV0dXJuIGRlc2MuZ2V0KG9iaiwga2V5TmFtZSk7CiAgfSBlbHNlIHsK
        ICAgIGlmIChNQU5EQVRPUllfU0VUVEVSICYmIG1ldGEgJiYgbWV0YS53YXRj
        aGluZ1trZXlOYW1lXSA+IDApIHsKICAgICAgcmV0ID0gbWV0YS52YWx1ZXNb
        a2V5TmFtZV07CiAgICB9IGVsc2UgewogICAgICByZXQgPSBvYmpba2V5TmFt
        ZV07CiAgICB9CgogICAgaWYgKHJldCA9PT0gdW5kZWZpbmVkICYmCiAgICAg
        ICAgJ29iamVjdCcgPT09IHR5cGVvZiBvYmogJiYgIShrZXlOYW1lIGluIG9i
        aikgJiYgJ2Z1bmN0aW9uJyA9PT0gdHlwZW9mIG9iai51bmtub3duUHJvcGVy
        dHkpIHsKICAgICAgcmV0dXJuIG9iai51bmtub3duUHJvcGVydHkoa2V5TmFt
        ZSk7CiAgICB9CgogICAgcmV0dXJuIHJldDsKICB9Cn07CgovLyBDdXJyZW50
        bHkgdXNlZCBvbmx5IGJ5IEVtYmVyIERhdGEgdGVzdHMKaWYgKEVtYmVyLmNv
        bmZpZy5vdmVycmlkZUFjY2Vzc29ycykgewogIEVtYmVyLmdldCA9IGdldDsK
        ICBFbWJlci5jb25maWcub3ZlcnJpZGVBY2Nlc3NvcnMoKTsKICBnZXQgPSBF
        bWJlci5nZXQ7Cn0KCi8qKgogIEBwcml2YXRlCgogIE5vcm1hbGl6ZXMgYSB0
        YXJnZXQvcGF0aCBwYWlyIHRvIHJlZmxlY3QgdGhhdCBhY3R1YWwgdGFyZ2V0
        L3BhdGggdGhhdCBzaG91bGQKICBiZSBvYnNlcnZlZCwgZXRjLiBUaGlzIHRh
        a2VzIGludG8gYWNjb3VudCBwYXNzaW5nIGluIGdsb2JhbCBwcm9wZXJ0eQog
        IHBhdGhzIChpLmUuIGEgcGF0aCBiZWdpbm5pbmcgd2l0aCBhIGNhcHRpYWwg
        bGV0dGVyIG5vdCBkZWZpbmVkIG9uIHRoZQogIHRhcmdldCkgYW5kICogc2Vw
        YXJhdG9ycy4KCiAgQG1ldGhvZCBub3JtYWxpemVUdXBsZQogIEBmb3IgRW1i
        ZXIKICBAcGFyYW0ge09iamVjdH0gdGFyZ2V0IFRoZSBjdXJyZW50IHRhcmdl
        dC4gTWF5IGJlIGBudWxsYC4KICBAcGFyYW0ge1N0cmluZ30gcGF0aCBBIHBh
        dGggb24gdGhlIHRhcmdldCBvciBhIGdsb2JhbCBwcm9wZXJ0eSBwYXRoLgog
        IEByZXR1cm4ge0FycmF5fSBhIHRlbXBvcmFyeSBhcnJheSB3aXRoIHRoZSBu
        b3JtYWxpemVkIHRhcmdldC9wYXRoIHBhaXIuCiovCnZhciBub3JtYWxpemVU
        dXBsZSA9IEVtYmVyLm5vcm1hbGl6ZVR1cGxlID0gZnVuY3Rpb24odGFyZ2V0
        LCBwYXRoKSB7CiAgdmFyIGhhc1RoaXMgID0gSEFTX1RISVMudGVzdChwYXRo
        KSwKICAgICAgaXNHbG9iYWwgPSAhaGFzVGhpcyAmJiBJU19HTE9CQUxfUEFU
        SC50ZXN0KHBhdGgpLAogICAgICBrZXk7CgogIGlmICghdGFyZ2V0IHx8IGlz
        R2xvYmFsKSB0YXJnZXQgPSBFbWJlci5sb29rdXA7CiAgaWYgKGhhc1RoaXMp
        IHBhdGggPSBwYXRoLnNsaWNlKDUpOwoKICBpZiAodGFyZ2V0ID09PSBFbWJl
        ci5sb29rdXApIHsKICAgIGtleSA9IHBhdGgubWF0Y2goRklSU1RfS0VZKVsw
        XTsKICAgIHRhcmdldCA9IGdldCh0YXJnZXQsIGtleSk7CiAgICBwYXRoICAg
        PSBwYXRoLnNsaWNlKGtleS5sZW5ndGgrMSk7CiAgfQoKICAvLyBtdXN0IHJl
        dHVybiBzb21lIGtpbmQgb2YgcGF0aCB0byBiZSB2YWxpZCBlbHNlIG90aGVy
        IHRoaW5ncyB3aWxsIGJyZWFrLgogIGlmICghcGF0aCB8fCBwYXRoLmxlbmd0
        aD09PTApIHRocm93IG5ldyBFcnJvcignSW52YWxpZCBQYXRoJyk7CgogIHJl
        dHVybiBbIHRhcmdldCwgcGF0aCBdOwp9OwoKdmFyIGdldFBhdGggPSBFbWJl
        ci5fZ2V0UGF0aCA9IGZ1bmN0aW9uKHJvb3QsIHBhdGgpIHsKICB2YXIgaGFz
        VGhpcywgcGFydHMsIHR1cGxlLCBpZHgsIGxlbjsKCiAgLy8gSWYgdGhlcmUg
        aXMgbm8gcm9vdCBhbmQgcGF0aCBpcyBhIGtleSBuYW1lLCByZXR1cm4gdGhh
        dAogIC8vIHByb3BlcnR5IGZyb20gdGhlIGdsb2JhbCBvYmplY3QuCiAgLy8g
        RS5nLiBnZXQoJ0VtYmVyJykgLT4gRW1iZXIKICBpZiAocm9vdCA9PT0gbnVs
        bCAmJiBwYXRoLmluZGV4T2YoJy4nKSA9PT0gLTEpIHsgcmV0dXJuIGdldChF
        bWJlci5sb29rdXAsIHBhdGgpOyB9CgogIC8vIGRldGVjdCBjb21wbGljYXRl
        ZCBwYXRocyBhbmQgbm9ybWFsaXplIHRoZW0KICBoYXNUaGlzICA9IEhBU19U
        SElTLnRlc3QocGF0aCk7CgogIGlmICghcm9vdCB8fCBoYXNUaGlzKSB7CiAg
        ICB0dXBsZSA9IG5vcm1hbGl6ZVR1cGxlKHJvb3QsIHBhdGgpOwogICAgcm9v
        dCA9IHR1cGxlWzBdOwogICAgcGF0aCA9IHR1cGxlWzFdOwogICAgdHVwbGUu
        bGVuZ3RoID0gMDsKICB9CgogIHBhcnRzID0gcGF0aC5zcGxpdCgiLiIpOwog
        IGxlbiA9IHBhcnRzLmxlbmd0aDsKICBmb3IgKGlkeCA9IDA7IHJvb3QgIT0g
        bnVsbCAmJiBpZHggPCBsZW47IGlkeCsrKSB7CiAgICByb290ID0gZ2V0KHJv
        b3QsIHBhcnRzW2lkeF0sIHRydWUpOwogICAgaWYgKHJvb3QgJiYgcm9vdC5p
        c0Rlc3Ryb3llZCkgeyByZXR1cm4gdW5kZWZpbmVkOyB9CiAgfQogIHJldHVy
        biByb290Owp9OwoKRW1iZXIuZ2V0V2l0aERlZmF1bHQgPSBmdW5jdGlvbihy
        b290LCBrZXksIGRlZmF1bHRWYWx1ZSkgewogIHZhciB2YWx1ZSA9IGdldChy
        b290LCBrZXkpOwoKICBpZiAodmFsdWUgPT09IHVuZGVmaW5lZCkgeyByZXR1
        cm4gZGVmYXVsdFZhbHVlOyB9CiAgcmV0dXJuIHZhbHVlOwp9OwoKCkVtYmVy
        LmdldCA9IGdldDsKRW1iZXIuZ2V0UGF0aCA9IEVtYmVyLmRlcHJlY2F0ZUZ1
        bmMoJ2dldFBhdGggaXMgZGVwcmVjYXRlZCBzaW5jZSBnZXQgbm93IHN1cHBv
        cnRzIHBhdGhzJywgRW1iZXIuZ2V0KTsKCn0pKCk7CgoKCihmdW5jdGlvbigp
        IHsKLyoqCkBtb2R1bGUgZW1iZXItbWV0YWwKKi8KCnZhciBvX2NyZWF0ZSA9
        IEVtYmVyLmNyZWF0ZSwKICAgIG1ldGFGb3IgPSBFbWJlci5tZXRhLAogICAg
        TUVUQV9LRVkgPSBFbWJlci5NRVRBX0tFWSwKICAgIGFfc2xpY2UgPSBbXS5z
        bGljZSwKICAgIC8qIGxpc3RlbmVyIGZsYWdzICovCiAgICBPTkNFID0gMSwg
        U1VTUEVOREVEID0gMjsKCi8qCiAgVGhlIGV2ZW50IHN5c3RlbSB1c2VzIGEg
        c2VyaWVzIG9mIG5lc3RlZCBoYXNoZXMgdG8gc3RvcmUgbGlzdGVuZXJzIG9u
        IGFuCiAgb2JqZWN0LiBXaGVuIGEgbGlzdGVuZXIgaXMgcmVnaXN0ZXJlZCwg
        b3Igd2hlbiBhbiBldmVudCBhcnJpdmVzLCB0aGVzZQogIGhhc2hlcyBhcmUg
        Y29uc3VsdGVkIHRvIGRldGVybWluZSB3aGljaCB0YXJnZXQgYW5kIGFjdGlv
        biBwYWlyIHRvIGludm9rZS4KCiAgVGhlIGhhc2hlcyBhcmUgc3RvcmVkIGlu
        IHRoZSBvYmplY3QncyBtZXRhIGhhc2gsIGFuZCBsb29rIGxpa2UgdGhpczoK
        CiAgICAgIC8vIE9iamVjdCdzIG1ldGEgaGFzaAogICAgICB7CiAgICAgICAg
        bGlzdGVuZXJzOiB7ICAgICAgIC8vIHZhcmlhYmxlIG5hbWU6IGBsaXN0ZW5l
        clNldGAKICAgICAgICAgICJmb286Y2hhbmdlZCI6IFsgLy8gdmFyaWFibGUg
        bmFtZTogYGFjdGlvbnNgCiAgICAgICAgICAgIHRhcmdldCwgbWV0aG9kLCBm
        bGFncwogICAgICAgICAgXQogICAgICAgIH0KICAgICAgfQoKKi8KCmZ1bmN0
        aW9uIGluZGV4T2YoYXJyYXksIHRhcmdldCwgbWV0aG9kKSB7CiAgdmFyIGlu
        ZGV4ID0gLTE7CiAgZm9yICh2YXIgaSA9IDAsIGwgPSBhcnJheS5sZW5ndGg7
        IGkgPCBsOyBpICs9IDMpIHsKICAgIGlmICh0YXJnZXQgPT09IGFycmF5W2ld
        ICYmIG1ldGhvZCA9PT0gYXJyYXlbaSsxXSkgeyBpbmRleCA9IGk7IGJyZWFr
        OyB9CiAgfQogIHJldHVybiBpbmRleDsKfQoKZnVuY3Rpb24gYWN0aW9uc0Zv
        cihvYmosIGV2ZW50TmFtZSkgewogIHZhciBtZXRhID0gbWV0YUZvcihvYmos
        IHRydWUpLAogICAgICBhY3Rpb25zOwoKICBpZiAoIW1ldGEubGlzdGVuZXJz
        KSB7IG1ldGEubGlzdGVuZXJzID0ge307IH0KCiAgaWYgKCFtZXRhLmhhc093
        blByb3BlcnR5KCdsaXN0ZW5lcnMnKSkgewogICAgLy8gc2V0dXAgaW5oZXJp
        dGVkIGNvcHkgb2YgdGhlIGxpc3RlbmVycyBvYmplY3QKICAgIG1ldGEubGlz
        dGVuZXJzID0gb19jcmVhdGUobWV0YS5saXN0ZW5lcnMpOwogIH0KCiAgYWN0
        aW9ucyA9IG1ldGEubGlzdGVuZXJzW2V2ZW50TmFtZV07CgogIC8vIGlmIHRo
        ZXJlIGFyZSBhY3Rpb25zLCBidXQgdGhlIGV2ZW50TmFtZSBkb2Vzbid0IGV4
        aXN0IGluIG91ciBsaXN0ZW5lcnMsIHRoZW4gY29weSB0aGVtIGZyb20gdGhl
        IHByb3RvdHlwZQogIGlmIChhY3Rpb25zICYmICFtZXRhLmxpc3RlbmVycy5o
        YXNPd25Qcm9wZXJ0eShldmVudE5hbWUpKSB7CiAgICBhY3Rpb25zID0gbWV0
        YS5saXN0ZW5lcnNbZXZlbnROYW1lXSA9IG1ldGEubGlzdGVuZXJzW2V2ZW50
        TmFtZV0uc2xpY2UoKTsKICB9IGVsc2UgaWYgKCFhY3Rpb25zKSB7CiAgICBh
        Y3Rpb25zID0gbWV0YS5saXN0ZW5lcnNbZXZlbnROYW1lXSA9IFtdOwogIH0K
        CiAgcmV0dXJuIGFjdGlvbnM7Cn0KCmZ1bmN0aW9uIGFjdGlvbnNVbmlvbihv
        YmosIGV2ZW50TmFtZSwgb3RoZXJBY3Rpb25zKSB7CiAgdmFyIG1ldGEgPSBv
        YmpbTUVUQV9LRVldLAogICAgICBhY3Rpb25zID0gbWV0YSAmJiBtZXRhLmxp
        c3RlbmVycyAmJiBtZXRhLmxpc3RlbmVyc1tldmVudE5hbWVdOwoKICBpZiAo
        IWFjdGlvbnMpIHsgcmV0dXJuOyB9CiAgZm9yICh2YXIgaSA9IGFjdGlvbnMu
        bGVuZ3RoIC0gMzsgaSA+PSAwOyBpIC09IDMpIHsKICAgIHZhciB0YXJnZXQg
        PSBhY3Rpb25zW2ldLAogICAgICAgIG1ldGhvZCA9IGFjdGlvbnNbaSsxXSwK
        ICAgICAgICBmbGFncyA9IGFjdGlvbnNbaSsyXSwKICAgICAgICBhY3Rpb25J
        bmRleCA9IGluZGV4T2Yob3RoZXJBY3Rpb25zLCB0YXJnZXQsIG1ldGhvZCk7
        CgogICAgaWYgKGFjdGlvbkluZGV4ID09PSAtMSkgewogICAgICBvdGhlckFj
        dGlvbnMucHVzaCh0YXJnZXQsIG1ldGhvZCwgZmxhZ3MpOwogICAgfQogIH0K
        fQoKZnVuY3Rpb24gYWN0aW9uc0RpZmYob2JqLCBldmVudE5hbWUsIG90aGVy
        QWN0aW9ucykgewogIHZhciBtZXRhID0gb2JqW01FVEFfS0VZXSwKICAgICAg
        YWN0aW9ucyA9IG1ldGEgJiYgbWV0YS5saXN0ZW5lcnMgJiYgbWV0YS5saXN0
        ZW5lcnNbZXZlbnROYW1lXSwKICAgICAgZGlmZkFjdGlvbnMgPSBbXTsKCiAg
        aWYgKCFhY3Rpb25zKSB7IHJldHVybjsgfQogIGZvciAodmFyIGkgPSBhY3Rp
        b25zLmxlbmd0aCAtIDM7IGkgPj0gMDsgaSAtPSAzKSB7CiAgICB2YXIgdGFy
        Z2V0ID0gYWN0aW9uc1tpXSwKICAgICAgICBtZXRob2QgPSBhY3Rpb25zW2kr
        MV0sCiAgICAgICAgZmxhZ3MgPSBhY3Rpb25zW2krMl0sCiAgICAgICAgYWN0
        aW9uSW5kZXggPSBpbmRleE9mKG90aGVyQWN0aW9ucywgdGFyZ2V0LCBtZXRo
        b2QpOwoKICAgIGlmIChhY3Rpb25JbmRleCAhPT0gLTEpIHsgY29udGludWU7
        IH0KCiAgICBvdGhlckFjdGlvbnMucHVzaCh0YXJnZXQsIG1ldGhvZCwgZmxh
        Z3MpOwogICAgZGlmZkFjdGlvbnMucHVzaCh0YXJnZXQsIG1ldGhvZCwgZmxh
        Z3MpOwogIH0KCiAgcmV0dXJuIGRpZmZBY3Rpb25zOwp9CgovKioKICBBZGQg
        YW4gZXZlbnQgbGlzdGVuZXIKCiAgQG1ldGhvZCBhZGRMaXN0ZW5lcgogIEBm
        b3IgRW1iZXIKICBAcGFyYW0gb2JqCiAgQHBhcmFtIHtTdHJpbmd9IGV2ZW50
        TmFtZQogIEBwYXJhbSB7T2JqZWN0fEZ1bmN0aW9ufSB0YXJnZXRPck1ldGhv
        ZCBBIHRhcmdldCBvYmplY3Qgb3IgYSBmdW5jdGlvbgogIEBwYXJhbSB7RnVu
        Y3Rpb258U3RyaW5nfSBtZXRob2QgQSBmdW5jdGlvbiBvciB0aGUgbmFtZSBv
        ZiBhIGZ1bmN0aW9uIHRvIGJlIGNhbGxlZCBvbiBgdGFyZ2V0YAogIEBwYXJh
        bSB7Qm9vbGVhbn0gb25jZSBBIGZsYWcgd2hldGhlciBhIGZ1bmN0aW9uIHNo
        b3VsZCBvbmx5IGJlIGNhbGxlZCBvbmNlCiovCmZ1bmN0aW9uIGFkZExpc3Rl
        bmVyKG9iaiwgZXZlbnROYW1lLCB0YXJnZXQsIG1ldGhvZCwgb25jZSkgewog
        IEVtYmVyLmFzc2VydCgiWW91IG11c3QgcGFzcyBhdCBsZWFzdCBhbiBvYmpl
        Y3QgYW5kIGV2ZW50IG5hbWUgdG8gRW1iZXIuYWRkTGlzdGVuZXIiLCAhIW9i
        aiAmJiAhIWV2ZW50TmFtZSk7CgogIGlmICghbWV0aG9kICYmICdmdW5jdGlv
        bicgPT09IHR5cGVvZiB0YXJnZXQpIHsKICAgIG1ldGhvZCA9IHRhcmdldDsK
        ICAgIHRhcmdldCA9IG51bGw7CiAgfQoKICB2YXIgYWN0aW9ucyA9IGFjdGlv
        bnNGb3Iob2JqLCBldmVudE5hbWUpLAogICAgICBhY3Rpb25JbmRleCA9IGlu
        ZGV4T2YoYWN0aW9ucywgdGFyZ2V0LCBtZXRob2QpLAogICAgICBmbGFncyA9
        IDA7CgogIGlmIChvbmNlKSBmbGFncyB8PSBPTkNFOwoKICBpZiAoYWN0aW9u
        SW5kZXggIT09IC0xKSB7IHJldHVybjsgfQoKICBhY3Rpb25zLnB1c2godGFy
        Z2V0LCBtZXRob2QsIGZsYWdzKTsKCiAgaWYgKCdmdW5jdGlvbicgPT09IHR5
        cGVvZiBvYmouZGlkQWRkTGlzdGVuZXIpIHsKICAgIG9iai5kaWRBZGRMaXN0
        ZW5lcihldmVudE5hbWUsIHRhcmdldCwgbWV0aG9kKTsKICB9Cn0KCi8qKgog
        IFJlbW92ZSBhbiBldmVudCBsaXN0ZW5lcgoKICBBcmd1bWVudHMgc2hvdWxk
        IG1hdGNoIHRob3NlIHBhc3NlZCB0byBgRW1iZXIuYWRkTGlzdGVuZXJgLgoK
        ICBAbWV0aG9kIHJlbW92ZUxpc3RlbmVyCiAgQGZvciBFbWJlcgogIEBwYXJh
        bSBvYmoKICBAcGFyYW0ge1N0cmluZ30gZXZlbnROYW1lCiAgQHBhcmFtIHtP
        YmplY3R8RnVuY3Rpb259IHRhcmdldE9yTWV0aG9kIEEgdGFyZ2V0IG9iamVj
        dCBvciBhIGZ1bmN0aW9uCiAgQHBhcmFtIHtGdW5jdGlvbnxTdHJpbmd9IG1l
        dGhvZCBBIGZ1bmN0aW9uIG9yIHRoZSBuYW1lIG9mIGEgZnVuY3Rpb24gdG8g
        YmUgY2FsbGVkIG9uIGB0YXJnZXRgCiovCmZ1bmN0aW9uIHJlbW92ZUxpc3Rl
        bmVyKG9iaiwgZXZlbnROYW1lLCB0YXJnZXQsIG1ldGhvZCkgewogIEVtYmVy
        LmFzc2VydCgiWW91IG11c3QgcGFzcyBhdCBsZWFzdCBhbiBvYmplY3QgYW5k
        IGV2ZW50IG5hbWUgdG8gRW1iZXIucmVtb3ZlTGlzdGVuZXIiLCAhIW9iaiAm
        JiAhIWV2ZW50TmFtZSk7CgogIGlmICghbWV0aG9kICYmICdmdW5jdGlvbicg
        PT09IHR5cGVvZiB0YXJnZXQpIHsKICAgIG1ldGhvZCA9IHRhcmdldDsKICAg
        IHRhcmdldCA9IG51bGw7CiAgfQoKICBmdW5jdGlvbiBfcmVtb3ZlTGlzdGVu
        ZXIodGFyZ2V0LCBtZXRob2QpIHsKICAgIHZhciBhY3Rpb25zID0gYWN0aW9u
        c0ZvcihvYmosIGV2ZW50TmFtZSksCiAgICAgICAgYWN0aW9uSW5kZXggPSBp
        bmRleE9mKGFjdGlvbnMsIHRhcmdldCwgbWV0aG9kKTsKCiAgICAvLyBhY3Rp
        b24gZG9lc24ndCBleGlzdCwgZ2l2ZSB1cCBzaWxlbnRseQogICAgaWYgKGFj
        dGlvbkluZGV4ID09PSAtMSkgeyByZXR1cm47IH0KCiAgICBhY3Rpb25zLnNw
        bGljZShhY3Rpb25JbmRleCwgMyk7CgogICAgaWYgKCdmdW5jdGlvbicgPT09
        IHR5cGVvZiBvYmouZGlkUmVtb3ZlTGlzdGVuZXIpIHsKICAgICAgb2JqLmRp
        ZFJlbW92ZUxpc3RlbmVyKGV2ZW50TmFtZSwgdGFyZ2V0LCBtZXRob2QpOwog
        ICAgfQogIH0KCiAgaWYgKG1ldGhvZCkgewogICAgX3JlbW92ZUxpc3RlbmVy
        KHRhcmdldCwgbWV0aG9kKTsKICB9IGVsc2UgewogICAgdmFyIG1ldGEgPSBv
        YmpbTUVUQV9LRVldLAogICAgICAgIGFjdGlvbnMgPSBtZXRhICYmIG1ldGEu
        bGlzdGVuZXJzICYmIG1ldGEubGlzdGVuZXJzW2V2ZW50TmFtZV07CgogICAg
        aWYgKCFhY3Rpb25zKSB7IHJldHVybjsgfQogICAgZm9yICh2YXIgaSA9IGFj
        dGlvbnMubGVuZ3RoIC0gMzsgaSA+PSAwOyBpIC09IDMpIHsKICAgICAgX3Jl
        bW92ZUxpc3RlbmVyKGFjdGlvbnNbaV0sIGFjdGlvbnNbaSsxXSk7CiAgICB9
        CiAgfQp9CgovKioKICBAcHJpdmF0ZQoKICBTdXNwZW5kIGxpc3RlbmVyIGR1
        cmluZyBjYWxsYmFjay4KCiAgVGhpcyBzaG91bGQgb25seSBiZSB1c2VkIGJ5
        IHRoZSB0YXJnZXQgb2YgdGhlIGV2ZW50IGxpc3RlbmVyCiAgd2hlbiBpdCBp
        cyB0YWtpbmcgYW4gYWN0aW9uIHRoYXQgd291bGQgY2F1c2UgdGhlIGV2ZW50
        LCBlLmcuCiAgYW4gb2JqZWN0IG1pZ2h0IHN1c3BlbmQgaXRzIHByb3BlcnR5
        IGNoYW5nZSBsaXN0ZW5lciB3aGlsZSBpdCBpcwogIHNldHRpbmcgdGhhdCBw
        cm9wZXJ0eS4KCiAgQG1ldGhvZCBzdXNwZW5kTGlzdGVuZXIKICBAZm9yIEVt
        YmVyCiAgQHBhcmFtIG9iagogIEBwYXJhbSB7U3RyaW5nfSBldmVudE5hbWUK
        ICBAcGFyYW0ge09iamVjdHxGdW5jdGlvbn0gdGFyZ2V0T3JNZXRob2QgQSB0
        YXJnZXQgb2JqZWN0IG9yIGEgZnVuY3Rpb24KICBAcGFyYW0ge0Z1bmN0aW9u
        fFN0cmluZ30gbWV0aG9kIEEgZnVuY3Rpb24gb3IgdGhlIG5hbWUgb2YgYSBm
        dW5jdGlvbiB0byBiZSBjYWxsZWQgb24gYHRhcmdldGAKICBAcGFyYW0ge0Z1
        bmN0aW9ufSBjYWxsYmFjawoqLwpmdW5jdGlvbiBzdXNwZW5kTGlzdGVuZXIo
        b2JqLCBldmVudE5hbWUsIHRhcmdldCwgbWV0aG9kLCBjYWxsYmFjaykgewog
        IGlmICghbWV0aG9kICYmICdmdW5jdGlvbicgPT09IHR5cGVvZiB0YXJnZXQp
        IHsKICAgIG1ldGhvZCA9IHRhcmdldDsKICAgIHRhcmdldCA9IG51bGw7CiAg
        fQoKICB2YXIgYWN0aW9ucyA9IGFjdGlvbnNGb3Iob2JqLCBldmVudE5hbWUp
        LAogICAgICBhY3Rpb25JbmRleCA9IGluZGV4T2YoYWN0aW9ucywgdGFyZ2V0
        LCBtZXRob2QpOwoKICBpZiAoYWN0aW9uSW5kZXggIT09IC0xKSB7CiAgICBh
        Y3Rpb25zW2FjdGlvbkluZGV4KzJdIHw9IFNVU1BFTkRFRDsgLy8gbWFyayB0
        aGUgYWN0aW9uIGFzIHN1c3BlbmRlZAogIH0KCiAgZnVuY3Rpb24gdHJ5YWJs
        ZSgpICAgeyByZXR1cm4gY2FsbGJhY2suY2FsbCh0YXJnZXQpOyB9CiAgZnVu
        Y3Rpb24gZmluYWxpemVyKCkgeyBpZiAoYWN0aW9uSW5kZXggIT09IC0xKSB7
        IGFjdGlvbnNbYWN0aW9uSW5kZXgrMl0gJj0gflNVU1BFTkRFRDsgfSB9Cgog
        IHJldHVybiBFbWJlci50cnlGaW5hbGx5KHRyeWFibGUsIGZpbmFsaXplcik7
        Cn0KCi8qKgogIEBwcml2YXRlCgogIFN1c3BlbmRzIG11bHRpcGxlIGxpc3Rl
        bmVycyBkdXJpbmcgYSBjYWxsYmFjay4KCiAgCiAgQG1ldGhvZCBzdXNwZW5k
        TGlzdGVuZXJzCiAgQGZvciBFbWJlcgogIEBwYXJhbSBvYmoKICBAcGFyYW0g
        e0FycmF5fSBldmVudE5hbWUgQXJyYXkgb2YgZXZlbnQgbmFtZXMKICBAcGFy
        YW0ge09iamVjdHxGdW5jdGlvbn0gdGFyZ2V0T3JNZXRob2QgQSB0YXJnZXQg
        b2JqZWN0IG9yIGEgZnVuY3Rpb24KICBAcGFyYW0ge0Z1bmN0aW9ufFN0cmlu
        Z30gbWV0aG9kIEEgZnVuY3Rpb24gb3IgdGhlIG5hbWUgb2YgYSBmdW5jdGlv
        biB0byBiZSBjYWxsZWQgb24gYHRhcmdldGAKICBAcGFyYW0ge0Z1bmN0aW9u
        fSBjYWxsYmFjawoqLwpmdW5jdGlvbiBzdXNwZW5kTGlzdGVuZXJzKG9iaiwg
        ZXZlbnROYW1lcywgdGFyZ2V0LCBtZXRob2QsIGNhbGxiYWNrKSB7CiAgaWYg
        KCFtZXRob2QgJiYgJ2Z1bmN0aW9uJyA9PT0gdHlwZW9mIHRhcmdldCkgewog
        ICAgbWV0aG9kID0gdGFyZ2V0OwogICAgdGFyZ2V0ID0gbnVsbDsKICB9Cgog
        IHZhciBzdXNwZW5kZWRBY3Rpb25zID0gW10sCiAgICAgIGFjdGlvbnNMaXN0
        ID0gW10sCiAgICAgIGV2ZW50TmFtZSwgYWN0aW9ucywgaSwgbDsKCiAgZm9y
        IChpPTAsIGw9ZXZlbnROYW1lcy5sZW5ndGg7IGk8bDsgaSsrKSB7CiAgICBl
        dmVudE5hbWUgPSBldmVudE5hbWVzW2ldOwogICAgYWN0aW9ucyA9IGFjdGlv
        bnNGb3Iob2JqLCBldmVudE5hbWUpOwogICAgdmFyIGFjdGlvbkluZGV4ID0g
        aW5kZXhPZihhY3Rpb25zLCB0YXJnZXQsIG1ldGhvZCk7CgogICAgaWYgKGFj
        dGlvbkluZGV4ICE9PSAtMSkgewogICAgICBhY3Rpb25zW2FjdGlvbkluZGV4
        KzJdIHw9IFNVU1BFTkRFRDsKICAgICAgc3VzcGVuZGVkQWN0aW9ucy5wdXNo
        KGFjdGlvbkluZGV4KTsKICAgICAgYWN0aW9uc0xpc3QucHVzaChhY3Rpb25z
        KTsKICAgIH0KICB9CgogIGZ1bmN0aW9uIHRyeWFibGUoKSB7IHJldHVybiBj
        YWxsYmFjay5jYWxsKHRhcmdldCk7IH0KCiAgZnVuY3Rpb24gZmluYWxpemVy
        KCkgewogICAgZm9yICh2YXIgaSA9IDAsIGwgPSBzdXNwZW5kZWRBY3Rpb25z
        Lmxlbmd0aDsgaSA8IGw7IGkrKykgewogICAgICB2YXIgYWN0aW9uSW5kZXgg
        PSBzdXNwZW5kZWRBY3Rpb25zW2ldOwogICAgICBhY3Rpb25zTGlzdFtpXVth
        Y3Rpb25JbmRleCsyXSAmPSB+U1VTUEVOREVEOwogICAgfQogIH0KCiAgcmV0
        dXJuIEVtYmVyLnRyeUZpbmFsbHkodHJ5YWJsZSwgZmluYWxpemVyKTsKfQoK
        LyoqCiAgQHByaXZhdGUKCiAgUmV0dXJuIGEgbGlzdCBvZiBjdXJyZW50bHkg
        d2F0Y2hlZCBldmVudHMKCiAgQG1ldGhvZCB3YXRjaGVkRXZlbnRzCiAgQGZv
        ciBFbWJlcgogIEBwYXJhbSBvYmoKKi8KZnVuY3Rpb24gd2F0Y2hlZEV2ZW50
        cyhvYmopIHsKICB2YXIgbGlzdGVuZXJzID0gb2JqW01FVEFfS0VZXS5saXN0
        ZW5lcnMsIHJldCA9IFtdOwoKICBpZiAobGlzdGVuZXJzKSB7CiAgICBmb3Io
        dmFyIGV2ZW50TmFtZSBpbiBsaXN0ZW5lcnMpIHsKICAgICAgaWYgKGxpc3Rl
        bmVyc1tldmVudE5hbWVdKSB7IHJldC5wdXNoKGV2ZW50TmFtZSk7IH0KICAg
        IH0KICB9CiAgcmV0dXJuIHJldDsKfQoKLyoqCiAgU2VuZCBhbiBldmVudC4g
        VGhlIGV4ZWN1dGlvbiBvZiBzdXNwZW5kZWQgbGlzdGVuZXJzCiAgaXMgc2tp
        cHBlZCwgYW5kIG9uY2UgbGlzdGVuZXJzIGFyZSByZW1vdmVkLiBBIGxpc3Rl
        bmVyIHdpdGhvdXQKICBhIHRhcmdldCBpcyBleGVjdXRlZCBvbiB0aGUgcGFz
        c2VkIG9iamVjdC4gSWYgYW4gYXJyYXkgb2YgYWN0aW9ucwogIGlzIG5vdCBw
        YXNzZWQsIHRoZSBhY3Rpb25zIHN0b3JlZCBvbiB0aGUgcGFzc2VkIG9iamVj
        dCBhcmUgaW52b2tlZC4KICAKICBAbWV0aG9kIHNlbmRFdmVudAogIEBmb3Ig
        RW1iZXIKICBAcGFyYW0gb2JqCiAgQHBhcmFtIHtTdHJpbmd9IGV2ZW50TmFt
        ZQogIEBwYXJhbSB7QXJyYXl9IHBhcmFtcyBPcHRpb25hbCBwYXJhbWV0ZXJz
        IGZvciBlYWNoIGxpc3RlbmVyLgogIEBwYXJhbSB7QXJyYXl9IGFjdGlvbnMg
        T3B0aW9uYWwgYXJyYXkgb2YgYWN0aW9ucyAobGlzdGVuZXJzKS4KICBAcmV0
        dXJuIHRydWUKKi8KZnVuY3Rpb24gc2VuZEV2ZW50KG9iaiwgZXZlbnROYW1l
        LCBwYXJhbXMsIGFjdGlvbnMpIHsKICAvLyBmaXJzdCBnaXZlIG9iamVjdCBh
        IGNoYW5jZSB0byBoYW5kbGUgaXQKICBpZiAob2JqICE9PSBFbWJlciAmJiAn
        ZnVuY3Rpb24nID09PSB0eXBlb2Ygb2JqLnNlbmRFdmVudCkgewogICAgb2Jq
        LnNlbmRFdmVudChldmVudE5hbWUsIHBhcmFtcyk7CiAgfQoKICBpZiAoIWFj
        dGlvbnMpIHsKICAgIHZhciBtZXRhID0gb2JqW01FVEFfS0VZXTsKICAgIGFj
        dGlvbnMgPSBtZXRhICYmIG1ldGEubGlzdGVuZXJzICYmIG1ldGEubGlzdGVu
        ZXJzW2V2ZW50TmFtZV07CiAgfQoKICBpZiAoIWFjdGlvbnMpIHsgcmV0dXJu
        OyB9CgogIGZvciAodmFyIGkgPSBhY3Rpb25zLmxlbmd0aCAtIDM7IGkgPj0g
        MDsgaSAtPSAzKSB7IC8vIGxvb3BpbmcgaW4gcmV2ZXJzZSBmb3Igb25jZSBs
        aXN0ZW5lcnMKICAgIHZhciB0YXJnZXQgPSBhY3Rpb25zW2ldLCBtZXRob2Qg
        PSBhY3Rpb25zW2krMV0sIGZsYWdzID0gYWN0aW9uc1tpKzJdOwogICAgaWYg
        KCFtZXRob2QpIHsgY29udGludWU7IH0KICAgIGlmIChmbGFncyAmIFNVU1BF
        TkRFRCkgeyBjb250aW51ZTsgfQogICAgaWYgKGZsYWdzICYgT05DRSkgeyBy
        ZW1vdmVMaXN0ZW5lcihvYmosIGV2ZW50TmFtZSwgdGFyZ2V0LCBtZXRob2Qp
        OyB9CiAgICBpZiAoIXRhcmdldCkgeyB0YXJnZXQgPSBvYmo7IH0KICAgIGlm
        ICgnc3RyaW5nJyA9PT0gdHlwZW9mIG1ldGhvZCkgeyBtZXRob2QgPSB0YXJn
        ZXRbbWV0aG9kXTsgfQogICAgaWYgKHBhcmFtcykgewogICAgICBtZXRob2Qu
        YXBwbHkodGFyZ2V0LCBwYXJhbXMpOwogICAgfSBlbHNlIHsKICAgICAgbWV0
        aG9kLmNhbGwodGFyZ2V0KTsKICAgIH0KICB9CiAgcmV0dXJuIHRydWU7Cn0K
        Ci8qKgogIEBwcml2YXRlCiAgQG1ldGhvZCBoYXNMaXN0ZW5lcnMKICBAZm9y
        IEVtYmVyCiAgQHBhcmFtIG9iagogIEBwYXJhbSB7U3RyaW5nfSBldmVudE5h
        bWUKKi8KZnVuY3Rpb24gaGFzTGlzdGVuZXJzKG9iaiwgZXZlbnROYW1lKSB7
        CiAgdmFyIG1ldGEgPSBvYmpbTUVUQV9LRVldLAogICAgICBhY3Rpb25zID0g
        bWV0YSAmJiBtZXRhLmxpc3RlbmVycyAmJiBtZXRhLmxpc3RlbmVyc1tldmVu
        dE5hbWVdOwoKICByZXR1cm4gISEoYWN0aW9ucyAmJiBhY3Rpb25zLmxlbmd0
        aCk7Cn0KCi8qKgogIEBwcml2YXRlCiAgQG1ldGhvZCBsaXN0ZW5lcnNGb3IK
        ICBAZm9yIEVtYmVyCiAgQHBhcmFtIG9iagogIEBwYXJhbSB7U3RyaW5nfSBl
        dmVudE5hbWUKKi8KZnVuY3Rpb24gbGlzdGVuZXJzRm9yKG9iaiwgZXZlbnRO
        YW1lKSB7CiAgdmFyIHJldCA9IFtdOwogIHZhciBtZXRhID0gb2JqW01FVEFf
        S0VZXSwKICAgICAgYWN0aW9ucyA9IG1ldGEgJiYgbWV0YS5saXN0ZW5lcnMg
        JiYgbWV0YS5saXN0ZW5lcnNbZXZlbnROYW1lXTsKCiAgaWYgKCFhY3Rpb25z
        KSB7IHJldHVybiByZXQ7IH0KCiAgZm9yICh2YXIgaSA9IDAsIGwgPSBhY3Rp
        b25zLmxlbmd0aDsgaSA8IGw7IGkgKz0gMykgewogICAgdmFyIHRhcmdldCA9
        IGFjdGlvbnNbaV0sCiAgICAgICAgbWV0aG9kID0gYWN0aW9uc1tpKzFdOwog
        ICAgcmV0LnB1c2goW3RhcmdldCwgbWV0aG9kXSk7CiAgfQoKICByZXR1cm4g
        cmV0Owp9CgovKioKICBEZWZpbmUgYSBwcm9wZXJ0eSBhcyBhIGZ1bmN0aW9u
        IHRoYXQgc2hvdWxkIGJlIGV4ZWN1dGVkIHdoZW4KICBhIHNwZWNpZmllZCBl
        dmVudCBvciBldmVudHMgYXJlIHRyaWdnZXJlZC4KCiAgICAgIHZhciBKb2Ig
        PSBFbWJlci5PYmplY3QuZXh0ZW5kKHsKICAgICAgICBsb2dDb21wbGV0ZWQ6
        IEVtYmVyLm9uKCdjb21wbGV0ZWQnLCBmdW5jdGlvbigpewogICAgICAgICAg
        Y29uc29sZS5sb2coJ0pvYiBjb21wbGV0ZWQhJyk7CiAgICAgICAgfSkKICAg
        ICAgfSk7CiAgICAgIHZhciBqb2IgPSBKb2IuY3JlYXRlKCk7CiAgICAgIEVt
        YmVyLnNlbmRFdmVudChqb2IsICdjb21wbGV0ZWQnKTsgLy8gTG9ncyAiSm9i
        IGNvbXBsZXRlZCEiCgogIEBtZXRob2Qgb24KICBAZm9yIEVtYmVyCiAgQHBh
        cmFtIHtTdHJpbmd9IGV2ZW50TmFtZXMqCiAgQHBhcmFtIHtGdW5jdGlvbn0g
        ZnVuYwogIEByZXR1cm4gZnVuYwoqLwpFbWJlci5vbiA9IGZ1bmN0aW9uKCl7
        CiAgdmFyIGZ1bmMgPSBhX3NsaWNlLmNhbGwoYXJndW1lbnRzLCAtMSlbMF0s
        CiAgICAgIGV2ZW50cyA9IGFfc2xpY2UuY2FsbChhcmd1bWVudHMsIDAsIC0x
        KTsKICBmdW5jLl9fZW1iZXJfbGlzdGVuc19fID0gZXZlbnRzOwogIHJldHVy
        biBmdW5jOwp9OwoKRW1iZXIuYWRkTGlzdGVuZXIgPSBhZGRMaXN0ZW5lcjsK
        RW1iZXIucmVtb3ZlTGlzdGVuZXIgPSByZW1vdmVMaXN0ZW5lcjsKRW1iZXIu
        X3N1c3BlbmRMaXN0ZW5lciA9IHN1c3BlbmRMaXN0ZW5lcjsKRW1iZXIuX3N1
        c3BlbmRMaXN0ZW5lcnMgPSBzdXNwZW5kTGlzdGVuZXJzOwpFbWJlci5zZW5k
        RXZlbnQgPSBzZW5kRXZlbnQ7CkVtYmVyLmhhc0xpc3RlbmVycyA9IGhhc0xp
        c3RlbmVyczsKRW1iZXIud2F0Y2hlZEV2ZW50cyA9IHdhdGNoZWRFdmVudHM7
        CkVtYmVyLmxpc3RlbmVyc0ZvciA9IGxpc3RlbmVyc0ZvcjsKRW1iZXIubGlz
        dGVuZXJzRGlmZiA9IGFjdGlvbnNEaWZmOwpFbWJlci5saXN0ZW5lcnNVbmlv
        biA9IGFjdGlvbnNVbmlvbjsKCn0pKCk7CgoKCihmdW5jdGlvbigpIHsKdmFy
        IGd1aWRGb3IgPSBFbWJlci5ndWlkRm9yLAogICAgc2VuZEV2ZW50ID0gRW1i
        ZXIuc2VuZEV2ZW50OwoKLyoKICB0aGlzLm9ic2VydmVyU2V0ID0gewogICAg
        W3NlbmRlckd1aWRdOiB7IC8vIHZhcmlhYmxlIG5hbWU6IGBrZXlTZXRgCiAg
        ICAgIFtrZXlOYW1lXTogbGlzdEluZGV4CiAgICB9CiAgfSwKICB0aGlzLm9i
        c2VydmVycyA9IFsKICAgIHsKICAgICAgc2VuZGVyOiBvYmosCiAgICAgIGtl
        eU5hbWU6IGtleU5hbWUsCiAgICAgIGV2ZW50TmFtZTogZXZlbnROYW1lLAog
        ICAgICBsaXN0ZW5lcnM6IFsKICAgICAgICBbdGFyZ2V0LCBtZXRob2QsIGZs
        YWdzXQogICAgICBdCiAgICB9LAogICAgLi4uCiAgXQoqLwp2YXIgT2JzZXJ2
        ZXJTZXQgPSBFbWJlci5fT2JzZXJ2ZXJTZXQgPSBmdW5jdGlvbigpIHsKICB0
        aGlzLmNsZWFyKCk7Cn07CgpPYnNlcnZlclNldC5wcm90b3R5cGUuYWRkID0g
        ZnVuY3Rpb24oc2VuZGVyLCBrZXlOYW1lLCBldmVudE5hbWUpIHsKICB2YXIg
        b2JzZXJ2ZXJTZXQgPSB0aGlzLm9ic2VydmVyU2V0LAogICAgICBvYnNlcnZl
        cnMgPSB0aGlzLm9ic2VydmVycywKICAgICAgc2VuZGVyR3VpZCA9IGd1aWRG
        b3Ioc2VuZGVyKSwKICAgICAga2V5U2V0ID0gb2JzZXJ2ZXJTZXRbc2VuZGVy
        R3VpZF0sCiAgICAgIGluZGV4OwoKICBpZiAoIWtleVNldCkgewogICAgb2Jz
        ZXJ2ZXJTZXRbc2VuZGVyR3VpZF0gPSBrZXlTZXQgPSB7fTsKICB9CiAgaW5k
        ZXggPSBrZXlTZXRba2V5TmFtZV07CiAgaWYgKGluZGV4ID09PSB1bmRlZmlu
        ZWQpIHsKICAgIGluZGV4ID0gb2JzZXJ2ZXJzLnB1c2goewogICAgICBzZW5k
        ZXI6IHNlbmRlciwKICAgICAga2V5TmFtZToga2V5TmFtZSwKICAgICAgZXZl
        bnROYW1lOiBldmVudE5hbWUsCiAgICAgIGxpc3RlbmVyczogW10KICAgIH0p
        IC0gMTsKICAgIGtleVNldFtrZXlOYW1lXSA9IGluZGV4OwogIH0KICByZXR1
        cm4gb2JzZXJ2ZXJzW2luZGV4XS5saXN0ZW5lcnM7Cn07CgpPYnNlcnZlclNl
        dC5wcm90b3R5cGUuZmx1c2ggPSBmdW5jdGlvbigpIHsKICB2YXIgb2JzZXJ2
        ZXJzID0gdGhpcy5vYnNlcnZlcnMsIGksIGxlbiwgb2JzZXJ2ZXIsIHNlbmRl
        cjsKICB0aGlzLmNsZWFyKCk7CiAgZm9yIChpPTAsIGxlbj1vYnNlcnZlcnMu
        bGVuZ3RoOyBpIDwgbGVuOyArK2kpIHsKICAgIG9ic2VydmVyID0gb2JzZXJ2
        ZXJzW2ldOwogICAgc2VuZGVyID0gb2JzZXJ2ZXIuc2VuZGVyOwogICAgaWYg
        KHNlbmRlci5pc0Rlc3Ryb3lpbmcgfHwgc2VuZGVyLmlzRGVzdHJveWVkKSB7
        IGNvbnRpbnVlOyB9CiAgICBzZW5kRXZlbnQoc2VuZGVyLCBvYnNlcnZlci5l
        dmVudE5hbWUsIFtzZW5kZXIsIG9ic2VydmVyLmtleU5hbWVdLCBvYnNlcnZl
        ci5saXN0ZW5lcnMpOwogIH0KfTsKCk9ic2VydmVyU2V0LnByb3RvdHlwZS5j
        bGVhciA9IGZ1bmN0aW9uKCkgewogIHRoaXMub2JzZXJ2ZXJTZXQgPSB7fTsK
        ICB0aGlzLm9ic2VydmVycyA9IFtdOwp9Owp9KSgpOwoKCgooZnVuY3Rpb24o
        KSB7CnZhciBtZXRhRm9yID0gRW1iZXIubWV0YSwKICAgIGd1aWRGb3IgPSBF
        bWJlci5ndWlkRm9yLAogICAgdHJ5RmluYWxseSA9IEVtYmVyLnRyeUZpbmFs
        bHksCiAgICBzZW5kRXZlbnQgPSBFbWJlci5zZW5kRXZlbnQsCiAgICBsaXN0
        ZW5lcnNVbmlvbiA9IEVtYmVyLmxpc3RlbmVyc1VuaW9uLAogICAgbGlzdGVu
        ZXJzRGlmZiA9IEVtYmVyLmxpc3RlbmVyc0RpZmYsCiAgICBPYnNlcnZlclNl
        dCA9IEVtYmVyLl9PYnNlcnZlclNldCwKICAgIGJlZm9yZU9ic2VydmVyU2V0
        ID0gbmV3IE9ic2VydmVyU2V0KCksCiAgICBvYnNlcnZlclNldCA9IG5ldyBP
        YnNlcnZlclNldCgpLAogICAgZGVmZXJyZWQgPSAwOwoKLy8gLi4uLi4uLi4u
        Li4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4u
        Li4uLgovLyBQUk9QRVJUWSBDSEFOR0VTCi8vCgovKioKICBUaGlzIGZ1bmN0
        aW9uIGlzIGNhbGxlZCBqdXN0IGJlZm9yZSBhbiBvYmplY3QgcHJvcGVydHkg
        aXMgYWJvdXQgdG8gY2hhbmdlLgogIEl0IHdpbGwgbm90aWZ5IGFueSBiZWZv
        cmUgb2JzZXJ2ZXJzIGFuZCBwcmVwYXJlIGNhY2hlcyBhbW9uZyBvdGhlciB0
        aGluZ3MuCgogIE5vcm1hbGx5IHlvdSB3aWxsIG5vdCBuZWVkIHRvIGNhbGwg
        dGhpcyBtZXRob2QgZGlyZWN0bHkgYnV0IGlmIGZvciBzb21lCiAgcmVhc29u
        IHlvdSBjYW4ndCBkaXJlY3RseSB3YXRjaCBhIHByb3BlcnR5IHlvdSBjYW4g
        aW52b2tlIHRoaXMgbWV0aG9kCiAgbWFudWFsbHkgYWxvbmcgd2l0aCBgRW1i
        ZXIucHJvcGVydHlEaWRDaGFuZ2UoKWAgd2hpY2ggeW91IHNob3VsZCBjYWxs
        IGp1c3QKICBhZnRlciB0aGUgcHJvcGVydHkgdmFsdWUgY2hhbmdlcy4KCiAg
        QG1ldGhvZCBwcm9wZXJ0eVdpbGxDaGFuZ2UKICBAZm9yIEVtYmVyCiAgQHBh
        cmFtIHtPYmplY3R9IG9iaiBUaGUgb2JqZWN0IHdpdGggdGhlIHByb3BlcnR5
        IHRoYXQgd2lsbCBjaGFuZ2UKICBAcGFyYW0ge1N0cmluZ30ga2V5TmFtZSBU
        aGUgcHJvcGVydHkga2V5IChvciBwYXRoKSB0aGF0IHdpbGwgY2hhbmdlLgog
        IEByZXR1cm4ge3ZvaWR9CiovCmZ1bmN0aW9uIHByb3BlcnR5V2lsbENoYW5n
        ZShvYmosIGtleU5hbWUpIHsKICB2YXIgbSA9IG1ldGFGb3Iob2JqLCBmYWxz
        ZSksCiAgICAgIHdhdGNoaW5nID0gbS53YXRjaGluZ1trZXlOYW1lXSA+IDAg
        fHwga2V5TmFtZSA9PT0gJ2xlbmd0aCcsCiAgICAgIHByb3RvID0gbS5wcm90
        bywKICAgICAgZGVzYyA9IG0uZGVzY3Nba2V5TmFtZV07CgogIGlmICghd2F0
        Y2hpbmcpIHsgcmV0dXJuOyB9CiAgaWYgKHByb3RvID09PSBvYmopIHsgcmV0
        dXJuOyB9CiAgaWYgKGRlc2MgJiYgZGVzYy53aWxsQ2hhbmdlKSB7IGRlc2Mu
        d2lsbENoYW5nZShvYmosIGtleU5hbWUpOyB9CiAgZGVwZW5kZW50S2V5c1dp
        bGxDaGFuZ2Uob2JqLCBrZXlOYW1lLCBtKTsKICBjaGFpbnNXaWxsQ2hhbmdl
        KG9iaiwga2V5TmFtZSwgbSk7CiAgbm90aWZ5QmVmb3JlT2JzZXJ2ZXJzKG9i
        aiwga2V5TmFtZSk7Cn0KRW1iZXIucHJvcGVydHlXaWxsQ2hhbmdlID0gcHJv
        cGVydHlXaWxsQ2hhbmdlOwoKLyoqCiAgVGhpcyBmdW5jdGlvbiBpcyBjYWxs
        ZWQganVzdCBhZnRlciBhbiBvYmplY3QgcHJvcGVydHkgaGFzIGNoYW5nZWQu
        CiAgSXQgd2lsbCBub3RpZnkgYW55IG9ic2VydmVycyBhbmQgY2xlYXIgY2Fj
        aGVzIGFtb25nIG90aGVyIHRoaW5ncy4KCiAgTm9ybWFsbHkgeW91IHdpbGwg
        bm90IG5lZWQgdG8gY2FsbCB0aGlzIG1ldGhvZCBkaXJlY3RseSBidXQgaWYg
        Zm9yIHNvbWUKICByZWFzb24geW91IGNhbid0IGRpcmVjdGx5IHdhdGNoIGEg
        cHJvcGVydHkgeW91IGNhbiBpbnZva2UgdGhpcyBtZXRob2QKICBtYW51YWxs
        eSBhbG9uZyB3aXRoIGBFbWJlci5wcm9wZXJ0eVdpbGxDaGFuZ2UoKWAgd2hp
        Y2ggeW91IHNob3VsZCBjYWxsIGp1c3QKICBiZWZvcmUgdGhlIHByb3BlcnR5
        IHZhbHVlIGNoYW5nZXMuCgogIEBtZXRob2QgcHJvcGVydHlEaWRDaGFuZ2UK
        ICBAZm9yIEVtYmVyCiAgQHBhcmFtIHtPYmplY3R9IG9iaiBUaGUgb2JqZWN0
        IHdpdGggdGhlIHByb3BlcnR5IHRoYXQgd2lsbCBjaGFuZ2UKICBAcGFyYW0g
        e1N0cmluZ30ga2V5TmFtZSBUaGUgcHJvcGVydHkga2V5IChvciBwYXRoKSB0
        aGF0IHdpbGwgY2hhbmdlLgogIEByZXR1cm4ge3ZvaWR9CiovCmZ1bmN0aW9u
        IHByb3BlcnR5RGlkQ2hhbmdlKG9iaiwga2V5TmFtZSkgewogIHZhciBtID0g
        bWV0YUZvcihvYmosIGZhbHNlKSwKICAgICAgd2F0Y2hpbmcgPSBtLndhdGNo
        aW5nW2tleU5hbWVdID4gMCB8fCBrZXlOYW1lID09PSAnbGVuZ3RoJywKICAg
        ICAgcHJvdG8gPSBtLnByb3RvLAogICAgICBkZXNjID0gbS5kZXNjc1trZXlO
        YW1lXTsKCiAgaWYgKHByb3RvID09PSBvYmopIHsgcmV0dXJuOyB9CgogIC8v
        IHNob3VsZG4ndCB0aGlzIG1lYW4gdGhhdCB3ZSdyZSB3YXRjaGluZyB0aGlz
        IGtleT8KICBpZiAoZGVzYyAmJiBkZXNjLmRpZENoYW5nZSkgeyBkZXNjLmRp
        ZENoYW5nZShvYmosIGtleU5hbWUpOyB9CiAgaWYgKCF3YXRjaGluZyAmJiBr
        ZXlOYW1lICE9PSAnbGVuZ3RoJykgeyByZXR1cm47IH0KCiAgZGVwZW5kZW50
        S2V5c0RpZENoYW5nZShvYmosIGtleU5hbWUsIG0pOwogIGNoYWluc0RpZENo
        YW5nZShvYmosIGtleU5hbWUsIG0sIGZhbHNlKTsKICBub3RpZnlPYnNlcnZl
        cnMob2JqLCBrZXlOYW1lKTsKfQpFbWJlci5wcm9wZXJ0eURpZENoYW5nZSA9
        IHByb3BlcnR5RGlkQ2hhbmdlOwoKdmFyIFdJTExfU0VFTiwgRElEX1NFRU47
        CgovLyBjYWxsZWQgd2hlbmV2ZXIgYSBwcm9wZXJ0eSBpcyBhYm91dCB0byBj
        aGFuZ2UgdG8gY2xlYXIgdGhlIGNhY2hlIG9mIGFueSBkZXBlbmRlbnQga2V5
        cyAoYW5kIG5vdGlmeSB0aG9zZSBwcm9wZXJ0aWVzIG9mIGNoYW5nZXMsIGV0
        Yy4uLikKZnVuY3Rpb24gZGVwZW5kZW50S2V5c1dpbGxDaGFuZ2Uob2JqLCBk
        ZXBLZXksIG1ldGEpIHsKICBpZiAob2JqLmlzRGVzdHJveWluZykgeyByZXR1
        cm47IH0KCiAgdmFyIHNlZW4gPSBXSUxMX1NFRU4sIHRvcCA9ICFzZWVuOwog
        IGlmICh0b3ApIHsgc2VlbiA9IFdJTExfU0VFTiA9IHt9OyB9CiAgaXRlckRl
        cHMocHJvcGVydHlXaWxsQ2hhbmdlLCBvYmosIGRlcEtleSwgc2VlbiwgbWV0
        YSk7CiAgaWYgKHRvcCkgeyBXSUxMX1NFRU4gPSBudWxsOyB9Cn0KCi8vIGNh
        bGxlZCB3aGVuZXZlciBhIHByb3BlcnR5IGhhcyBqdXN0IGNoYW5nZWQgdG8g
        dXBkYXRlIGRlcGVuZGVudCBrZXlzCmZ1bmN0aW9uIGRlcGVuZGVudEtleXNE
        aWRDaGFuZ2Uob2JqLCBkZXBLZXksIG1ldGEpIHsKICBpZiAob2JqLmlzRGVz
        dHJveWluZykgeyByZXR1cm47IH0KCiAgdmFyIHNlZW4gPSBESURfU0VFTiwg
        dG9wID0gIXNlZW47CiAgaWYgKHRvcCkgeyBzZWVuID0gRElEX1NFRU4gPSB7
        fTsgfQogIGl0ZXJEZXBzKHByb3BlcnR5RGlkQ2hhbmdlLCBvYmosIGRlcEtl
        eSwgc2VlbiwgbWV0YSk7CiAgaWYgKHRvcCkgeyBESURfU0VFTiA9IG51bGw7
        IH0KfQoKZnVuY3Rpb24gaXRlckRlcHMobWV0aG9kLCBvYmosIGRlcEtleSwg
        c2VlbiwgbWV0YSkgewogIHZhciBndWlkID0gZ3VpZEZvcihvYmopOwogIGlm
        ICghc2VlbltndWlkXSkgc2VlbltndWlkXSA9IHt9OwogIGlmIChzZWVuW2d1
        aWRdW2RlcEtleV0pIHJldHVybjsKICBzZWVuW2d1aWRdW2RlcEtleV0gPSB0
        cnVlOwoKICB2YXIgZGVwcyA9IG1ldGEuZGVwczsKICBkZXBzID0gZGVwcyAm
        JiBkZXBzW2RlcEtleV07CiAgaWYgKGRlcHMpIHsKICAgIGZvcih2YXIga2V5
        IGluIGRlcHMpIHsKICAgICAgdmFyIGRlc2MgPSBtZXRhLmRlc2NzW2tleV07
        CiAgICAgIGlmIChkZXNjICYmIGRlc2MuX3N1c3BlbmRlZCA9PT0gb2JqKSBj
        b250aW51ZTsKICAgICAgbWV0aG9kKG9iaiwga2V5KTsKICAgIH0KICB9Cn0K
        CmZ1bmN0aW9uIGNoYWluc1dpbGxDaGFuZ2Uob2JqLCBrZXlOYW1lLCBtKSB7
        CiAgaWYgKCEobS5oYXNPd25Qcm9wZXJ0eSgnY2hhaW5XYXRjaGVycycpICYm
        CiAgICAgICAgbS5jaGFpbldhdGNoZXJzW2tleU5hbWVdKSkgewogICAgcmV0
        dXJuOwogIH0KCiAgdmFyIG5vZGVzID0gbS5jaGFpbldhdGNoZXJzW2tleU5h
        bWVdLAogICAgICBldmVudHMgPSBbXSwKICAgICAgaSwgbDsKCiAgZm9yKGkg
        PSAwLCBsID0gbm9kZXMubGVuZ3RoOyBpIDwgbDsgaSsrKSB7CiAgICBub2Rl
        c1tpXS53aWxsQ2hhbmdlKGV2ZW50cyk7CiAgfQoKICBmb3IgKGkgPSAwLCBs
        ID0gZXZlbnRzLmxlbmd0aDsgaSA8IGw7IGkgKz0gMikgewogICAgcHJvcGVy
        dHlXaWxsQ2hhbmdlKGV2ZW50c1tpXSwgZXZlbnRzW2krMV0pOwogIH0KfQoK
        ZnVuY3Rpb24gY2hhaW5zRGlkQ2hhbmdlKG9iaiwga2V5TmFtZSwgbSwgc3Vw
        cHJlc3NFdmVudHMpIHsKICBpZiAoIShtLmhhc093blByb3BlcnR5KCdjaGFp
        bldhdGNoZXJzJykgJiYKICAgICAgICBtLmNoYWluV2F0Y2hlcnNba2V5TmFt
        ZV0pKSB7CiAgICByZXR1cm47CiAgfQoKICB2YXIgbm9kZXMgPSBtLmNoYWlu
        V2F0Y2hlcnNba2V5TmFtZV0sCiAgICAgIGV2ZW50cyA9IHN1cHByZXNzRXZl
        bnRzID8gbnVsbCA6IFtdLAogICAgICBpLCBsOwoKICBmb3IoaSA9IDAsIGwg
        PSBub2Rlcy5sZW5ndGg7IGkgPCBsOyBpKyspIHsKICAgIG5vZGVzW2ldLmRp
        ZENoYW5nZShldmVudHMpOwogIH0KCiAgaWYgKHN1cHByZXNzRXZlbnRzKSB7
        CiAgICByZXR1cm47CiAgfQoKICBmb3IgKGkgPSAwLCBsID0gZXZlbnRzLmxl
        bmd0aDsgaSA8IGw7IGkgKz0gMikgewogICAgcHJvcGVydHlEaWRDaGFuZ2Uo
        ZXZlbnRzW2ldLCBldmVudHNbaSsxXSk7CiAgfQp9CgpFbWJlci5vdmVycmlk
        ZUNoYWlucyA9IGZ1bmN0aW9uKG9iaiwga2V5TmFtZSwgbSkgewogIGNoYWlu
        c0RpZENoYW5nZShvYmosIGtleU5hbWUsIG0sIHRydWUpOwp9OwoKLyoqCiAg
        QG1ldGhvZCBiZWdpblByb3BlcnR5Q2hhbmdlcwogIEBjaGFpbmFibGUKKi8K
        ZnVuY3Rpb24gYmVnaW5Qcm9wZXJ0eUNoYW5nZXMoKSB7CiAgZGVmZXJyZWQr
        KzsKfQoKRW1iZXIuYmVnaW5Qcm9wZXJ0eUNoYW5nZXMgPSBiZWdpblByb3Bl
        cnR5Q2hhbmdlczsKCi8qKgogIEBtZXRob2QgZW5kUHJvcGVydHlDaGFuZ2Vz
        CiovCmZ1bmN0aW9uIGVuZFByb3BlcnR5Q2hhbmdlcygpIHsKICBkZWZlcnJl
        ZC0tOwogIGlmIChkZWZlcnJlZDw9MCkgewogICAgYmVmb3JlT2JzZXJ2ZXJT
        ZXQuY2xlYXIoKTsKICAgIG9ic2VydmVyU2V0LmZsdXNoKCk7CiAgfQp9CgpF
        bWJlci5lbmRQcm9wZXJ0eUNoYW5nZXMgPSBlbmRQcm9wZXJ0eUNoYW5nZXM7
        CgovKioKICBNYWtlIGEgc2VyaWVzIG9mIHByb3BlcnR5IGNoYW5nZXMgdG9n
        ZXRoZXIgaW4gYW4KICBleGNlcHRpb24tc2FmZSB3YXkuCgogIGBgYGphdmFz
        Y3JpcHQKICBFbWJlci5jaGFuZ2VQcm9wZXJ0aWVzKGZ1bmN0aW9uKCkgewog
        ICAgb2JqMS5zZXQoJ2ZvbycsIG1heUJsb3dVcFdoZW5TZXQpOwogICAgb2Jq
        Mi5zZXQoJ2JhcicsIGJheik7CiAgfSk7CiAgYGBgCgogIEBtZXRob2QgY2hh
        bmdlUHJvcGVydGllcwogIEBwYXJhbSB7RnVuY3Rpb259IGNhbGxiYWNrCiAg
        QHBhcmFtIFtiaW5kaW5nXQoqLwpFbWJlci5jaGFuZ2VQcm9wZXJ0aWVzID0g
        ZnVuY3Rpb24oY2IsIGJpbmRpbmcpIHsKICBiZWdpblByb3BlcnR5Q2hhbmdl
        cygpOwogIHRyeUZpbmFsbHkoY2IsIGVuZFByb3BlcnR5Q2hhbmdlcywgYmlu
        ZGluZyk7Cn07CgpmdW5jdGlvbiBub3RpZnlCZWZvcmVPYnNlcnZlcnMob2Jq
        LCBrZXlOYW1lKSB7CiAgaWYgKG9iai5pc0Rlc3Ryb3lpbmcpIHsgcmV0dXJu
        OyB9CgogIHZhciBldmVudE5hbWUgPSBrZXlOYW1lICsgJzpiZWZvcmUnLCBs
        aXN0ZW5lcnMsIGRpZmY7CiAgaWYgKGRlZmVycmVkKSB7CiAgICBsaXN0ZW5l
        cnMgPSBiZWZvcmVPYnNlcnZlclNldC5hZGQob2JqLCBrZXlOYW1lLCBldmVu
        dE5hbWUpOwogICAgZGlmZiA9IGxpc3RlbmVyc0RpZmYob2JqLCBldmVudE5h
        bWUsIGxpc3RlbmVycyk7CiAgICBzZW5kRXZlbnQob2JqLCBldmVudE5hbWUs
        IFtvYmosIGtleU5hbWVdLCBkaWZmKTsKICB9IGVsc2UgewogICAgc2VuZEV2
        ZW50KG9iaiwgZXZlbnROYW1lLCBbb2JqLCBrZXlOYW1lXSk7CiAgfQp9Cgpm
        dW5jdGlvbiBub3RpZnlPYnNlcnZlcnMob2JqLCBrZXlOYW1lKSB7CiAgaWYg
        KG9iai5pc0Rlc3Ryb3lpbmcpIHsgcmV0dXJuOyB9CgogIHZhciBldmVudE5h
        bWUgPSBrZXlOYW1lICsgJzpjaGFuZ2UnLCBsaXN0ZW5lcnM7CiAgaWYgKGRl
        ZmVycmVkKSB7CiAgICBsaXN0ZW5lcnMgPSBvYnNlcnZlclNldC5hZGQob2Jq
        LCBrZXlOYW1lLCBldmVudE5hbWUpOwogICAgbGlzdGVuZXJzVW5pb24ob2Jq
        LCBldmVudE5hbWUsIGxpc3RlbmVycyk7CiAgfSBlbHNlIHsKICAgIHNlbmRF
        dmVudChvYmosIGV2ZW50TmFtZSwgW29iaiwga2V5TmFtZV0pOwogIH0KfQoK
        fSkoKTsKCgoKKGZ1bmN0aW9uKCkgewovLyBNRVRBX0tFWQovLyBfZ2V0UGF0
        aAovLyBwcm9wZXJ0eVdpbGxDaGFuZ2UsIHByb3BlcnR5RGlkQ2hhbmdlCgp2
        YXIgTUVUQV9LRVkgPSBFbWJlci5NRVRBX0tFWSwKICAgIE1BTkRBVE9SWV9T
        RVRURVIgPSBFbWJlci5FTlYuTUFOREFUT1JZX1NFVFRFUiwKICAgIElTX0dM
        T0JBTCA9IC9eKFtBLVokXXwoWzAtOV1bQS1aJF0pKS8sCiAgICBnZXRQYXRo
        ID0gRW1iZXIuX2dldFBhdGg7CgovKioKICBTZXRzIHRoZSB2YWx1ZSBvZiBh
        IHByb3BlcnR5IG9uIGFuIG9iamVjdCwgcmVzcGVjdGluZyBjb21wdXRlZCBw
        cm9wZXJ0aWVzCiAgYW5kIG5vdGlmeWluZyBvYnNlcnZlcnMgYW5kIG90aGVy
        IGxpc3RlbmVycyBvZiB0aGUgY2hhbmdlLiBJZiB0aGUKICBwcm9wZXJ0eSBp
        cyBub3QgZGVmaW5lZCBidXQgdGhlIG9iamVjdCBpbXBsZW1lbnRzIHRoZSBg
        c2V0VW5rbm93blByb3BlcnR5YAogIG1ldGhvZCB0aGVuIHRoYXQgd2lsbCBi
        ZSBpbnZva2VkIGFzIHdlbGwuCgogIElmIHlvdSBwbGFuIHRvIHJ1biBvbiBJ
        RTggYW5kIG9sZGVyIGJyb3dzZXJzIHRoZW4geW91IHNob3VsZCB1c2UgdGhp
        cwogIG1ldGhvZCBhbnl0aW1lIHlvdSB3YW50IHRvIHNldCBhIHByb3BlcnR5
        IG9uIGFuIG9iamVjdCB0aGF0IHlvdSBkb24ndAogIGtub3cgZm9yIHN1cmUg
        aXMgcHJpdmF0ZS4gKFByb3BlcnRpZXMgYmVnaW5uaW5nIHdpdGggYW4gdW5k
        ZXJzY29yZSAnXycKICBhcmUgY29uc2lkZXJlZCBwcml2YXRlLikKCiAgT24g
        YWxsIG5ld2VyIGJyb3dzZXJzLCB5b3Ugb25seSBuZWVkIHRvIHVzZSB0aGlz
        IG1ldGhvZCB0byBzZXQKICBwcm9wZXJ0aWVzIGlmIHRoZSBwcm9wZXJ0eSBt
        aWdodCBub3QgYmUgZGVmaW5lZCBvbiB0aGUgb2JqZWN0IGFuZCB5b3Ugd2Fu
        dAogIHRvIHJlc3BlY3QgdGhlIGBzZXRVbmtub3duUHJvcGVydHlgIGhhbmRs
        ZXIuIE90aGVyd2lzZSB5b3UgY2FuIGlnbm9yZSB0aGlzCiAgbWV0aG9kLgoK
        ICBAbWV0aG9kIHNldAogIEBmb3IgRW1iZXIKICBAcGFyYW0ge09iamVjdH0g
        b2JqIFRoZSBvYmplY3QgdG8gbW9kaWZ5LgogIEBwYXJhbSB7U3RyaW5nfSBr
        ZXlOYW1lIFRoZSBwcm9wZXJ0eSBrZXkgdG8gc2V0CiAgQHBhcmFtIHtPYmpl
        Y3R9IHZhbHVlIFRoZSB2YWx1ZSB0byBzZXQKICBAcmV0dXJuIHtPYmplY3R9
        IHRoZSBwYXNzZWQgdmFsdWUuCiovCnZhciBzZXQgPSBmdW5jdGlvbiBzZXQo
        b2JqLCBrZXlOYW1lLCB2YWx1ZSwgdG9sZXJhbnQpIHsKICBpZiAodHlwZW9m
        IG9iaiA9PT0gJ3N0cmluZycpIHsKICAgIEVtYmVyLmFzc2VydCgiUGF0aCAn
        IiArIG9iaiArICInIG11c3QgYmUgZ2xvYmFsIGlmIG5vIG9iaiBpcyBnaXZl
        bi4iLCBJU19HTE9CQUwudGVzdChvYmopKTsKICAgIHZhbHVlID0ga2V5TmFt
        ZTsKICAgIGtleU5hbWUgPSBvYmo7CiAgICBvYmogPSBudWxsOwogIH0KCiAg
        RW1iZXIuYXNzZXJ0KCJDYW5ub3QgY2FsbCBzZXQgd2l0aCAiKyBrZXlOYW1l
        ICsiIGtleS4iLCAhIWtleU5hbWUpOwoKICBpZiAoIW9iaiB8fCBrZXlOYW1l
        LmluZGV4T2YoJy4nKSAhPT0gLTEpIHsKICAgIHJldHVybiBzZXRQYXRoKG9i
        aiwga2V5TmFtZSwgdmFsdWUsIHRvbGVyYW50KTsKICB9CgogIEVtYmVyLmFz
        c2VydCgiWW91IG5lZWQgdG8gcHJvdmlkZSBhbiBvYmplY3QgYW5kIGtleSB0
        byBgc2V0YC4iLCAhIW9iaiAmJiBrZXlOYW1lICE9PSB1bmRlZmluZWQpOwog
        IEVtYmVyLmFzc2VydCgnY2FsbGluZyBzZXQgb24gZGVzdHJveWVkIG9iamVj
        dCcsICFvYmouaXNEZXN0cm95ZWQpOwoKICB2YXIgbWV0YSA9IG9ialtNRVRB
        X0tFWV0sIGRlc2MgPSBtZXRhICYmIG1ldGEuZGVzY3Nba2V5TmFtZV0sCiAg
        ICAgIGlzVW5rbm93biwgY3VycmVudFZhbHVlOwogIGlmIChkZXNjKSB7CiAg
        ICBkZXNjLnNldChvYmosIGtleU5hbWUsIHZhbHVlKTsKICB9IGVsc2Ugewog
        ICAgaXNVbmtub3duID0gJ29iamVjdCcgPT09IHR5cGVvZiBvYmogJiYgIShr
        ZXlOYW1lIGluIG9iaik7CgogICAgLy8gc2V0VW5rbm93blByb3BlcnR5IGlz
        IGNhbGxlZCBpZiBgb2JqYCBpcyBhbiBvYmplY3QsCiAgICAvLyB0aGUgcHJv
        cGVydHkgZG9lcyBub3QgYWxyZWFkeSBleGlzdCwgYW5kIHRoZQogICAgLy8g
        YHNldFVua25vd25Qcm9wZXJ0eWAgbWV0aG9kIGV4aXN0cyBvbiB0aGUgb2Jq
        ZWN0CiAgICBpZiAoaXNVbmtub3duICYmICdmdW5jdGlvbicgPT09IHR5cGVv
        ZiBvYmouc2V0VW5rbm93blByb3BlcnR5KSB7CiAgICAgIG9iai5zZXRVbmtu
        b3duUHJvcGVydHkoa2V5TmFtZSwgdmFsdWUpOwogICAgfSBlbHNlIGlmICht
        ZXRhICYmIG1ldGEud2F0Y2hpbmdba2V5TmFtZV0gPiAwKSB7CiAgICAgIGlm
        IChNQU5EQVRPUllfU0VUVEVSKSB7CiAgICAgICAgY3VycmVudFZhbHVlID0g
        bWV0YS52YWx1ZXNba2V5TmFtZV07CiAgICAgIH0gZWxzZSB7CiAgICAgICAg
        Y3VycmVudFZhbHVlID0gb2JqW2tleU5hbWVdOwogICAgICB9CiAgICAgIC8v
        IG9ubHkgdHJpZ2dlciBhIGNoYW5nZSBpZiB0aGUgdmFsdWUgaGFzIGNoYW5n
        ZWQKICAgICAgaWYgKHZhbHVlICE9PSBjdXJyZW50VmFsdWUpIHsKICAgICAg
        ICBFbWJlci5wcm9wZXJ0eVdpbGxDaGFuZ2Uob2JqLCBrZXlOYW1lKTsKICAg
        ICAgICBpZiAoTUFOREFUT1JZX1NFVFRFUikgewogICAgICAgICAgaWYgKGN1
        cnJlbnRWYWx1ZSA9PT0gdW5kZWZpbmVkICYmICEoa2V5TmFtZSBpbiBvYmop
        KSB7CiAgICAgICAgICAgIEVtYmVyLmRlZmluZVByb3BlcnR5KG9iaiwga2V5
        TmFtZSwgbnVsbCwgdmFsdWUpOyAvLyBzZXR1cCBtYW5kYXRvcnkgc2V0dGVy
        CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBtZXRhLnZhbHVlc1tr
        ZXlOYW1lXSA9IHZhbHVlOwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7
        CiAgICAgICAgICBvYmpba2V5TmFtZV0gPSB2YWx1ZTsKICAgICAgICB9CiAg
        ICAgICAgRW1iZXIucHJvcGVydHlEaWRDaGFuZ2Uob2JqLCBrZXlOYW1lKTsK
        ICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgb2JqW2tleU5hbWVdID0gdmFs
        dWU7CiAgICB9CiAgfQogIHJldHVybiB2YWx1ZTsKfTsKCi8vIEN1cnJlbnRs
        eSB1c2VkIG9ubHkgYnkgRW1iZXIgRGF0YSB0ZXN0cwppZiAoRW1iZXIuY29u
        ZmlnLm92ZXJyaWRlQWNjZXNzb3JzKSB7CiAgRW1iZXIuc2V0ID0gc2V0Owog
        IEVtYmVyLmNvbmZpZy5vdmVycmlkZUFjY2Vzc29ycygpOwogIHNldCA9IEVt
        YmVyLnNldDsKfQoKZnVuY3Rpb24gc2V0UGF0aChyb290LCBwYXRoLCB2YWx1
        ZSwgdG9sZXJhbnQpIHsKICB2YXIga2V5TmFtZTsKCiAgLy8gZ2V0IHRoZSBs
        YXN0IHBhcnQgb2YgdGhlIHBhdGgKICBrZXlOYW1lID0gcGF0aC5zbGljZShw
        YXRoLmxhc3RJbmRleE9mKCcuJykgKyAxKTsKCiAgLy8gZ2V0IHRoZSBmaXJz
        dCBwYXJ0IG9mIHRoZSBwYXJ0CiAgcGF0aCAgICA9IHBhdGguc2xpY2UoMCwg
        cGF0aC5sZW5ndGgtKGtleU5hbWUubGVuZ3RoKzEpKTsKCiAgLy8gdW5sZXNz
        IHRoZSBwYXRoIGlzIHRoaXMsIGxvb2sgdXAgdGhlIGZpcnN0IHBhcnQgdG8K
        ICAvLyBnZXQgdGhlIHJvb3QKICBpZiAocGF0aCAhPT0gJ3RoaXMnKSB7CiAg
        ICByb290ID0gZ2V0UGF0aChyb290LCBwYXRoKTsKICB9CgogIGlmICgha2V5
        TmFtZSB8fCBrZXlOYW1lLmxlbmd0aCA9PT0gMCkgewogICAgdGhyb3cgbmV3
        IEVycm9yKCdZb3UgcGFzc2VkIGFuIGVtcHR5IHBhdGgnKTsKICB9CgogIGlm
        ICghcm9vdCkgewogICAgaWYgKHRvbGVyYW50KSB7IHJldHVybjsgfQogICAg
        ZWxzZSB7IHRocm93IG5ldyBFcnJvcignT2JqZWN0IGluIHBhdGggJytwYXRo
        KycgY291bGQgbm90IGJlIGZvdW5kIG9yIHdhcyBkZXN0cm95ZWQuJyk7IH0K
        ICB9CgogIHJldHVybiBzZXQocm9vdCwga2V5TmFtZSwgdmFsdWUpOwp9CgpF
        bWJlci5zZXQgPSBzZXQ7CkVtYmVyLnNldFBhdGggPSBFbWJlci5kZXByZWNh
        dGVGdW5jKCdzZXRQYXRoIGlzIGRlcHJlY2F0ZWQgc2luY2Ugc2V0IG5vdyBz
        dXBwb3J0cyBwYXRocycsIEVtYmVyLnNldCk7CgovKioKICBFcnJvci10b2xl
        cmFudCBmb3JtIG9mIGBFbWJlci5zZXRgLiBXaWxsIG5vdCBibG93IHVwIGlm
        IGFueSBwYXJ0IG9mIHRoZQogIGNoYWluIGlzIGB1bmRlZmluZWRgLCBgbnVs
        bGAsIG9yIGRlc3Ryb3llZC4KCiAgVGhpcyBpcyBwcmltYXJpbHkgdXNlZCB3
        aGVuIHN5bmNpbmcgYmluZGluZ3MsIHdoaWNoIG1heSB0cnkgdG8gdXBkYXRl
        IGFmdGVyCiAgYW4gb2JqZWN0IGhhcyBiZWVuIGRlc3Ryb3llZC4KCiAgQG1l
        dGhvZCB0cnlTZXQKICBAZm9yIEVtYmVyCiAgQHBhcmFtIHtPYmplY3R9IG9i
        aiBUaGUgb2JqZWN0IHRvIG1vZGlmeS4KICBAcGFyYW0ge1N0cmluZ30gcGF0
        aCBUaGUgcHJvcGVydHkgcGF0aCB0byBzZXQKICBAcGFyYW0ge09iamVjdH0g
        dmFsdWUgVGhlIHZhbHVlIHRvIHNldAoqLwpFbWJlci50cnlTZXQgPSBmdW5j
        dGlvbihyb290LCBwYXRoLCB2YWx1ZSkgewogIHJldHVybiBzZXQocm9vdCwg
        cGF0aCwgdmFsdWUsIHRydWUpOwp9OwpFbWJlci50cnlTZXRQYXRoID0gRW1i
        ZXIuZGVwcmVjYXRlRnVuYygndHJ5U2V0UGF0aCBoYXMgYmVlbiByZW5hbWVk
        IHRvIHRyeVNldCcsIEVtYmVyLnRyeVNldCk7Cgp9KSgpOwoKCgooZnVuY3Rp
        b24oKSB7Ci8qKgpAbW9kdWxlIGVtYmVyLW1ldGFsCiovCgovKgogIEphdmFT
        Y3JpcHQgKGJlZm9yZSBFUzYpIGRvZXMgbm90IGhhdmUgYSBNYXAgaW1wbGVt
        ZW50YXRpb24uIE9iamVjdHMsCiAgd2hpY2ggYXJlIG9mdGVuIHVzZWQgYXMg
        ZGljdGlvbmFyaWVzLCBtYXkgb25seSBoYXZlIFN0cmluZ3MgYXMga2V5cy4K
        CiAgQmVjYXVzZSBFbWJlciBoYXMgYSB3YXkgdG8gZ2V0IGEgdW5pcXVlIGlk
        ZW50aWZpZXIgZm9yIGV2ZXJ5IG9iamVjdAogIHZpYSBgRW1iZXIuZ3VpZEZv
        cmAsIHdlIGNhbiBpbXBsZW1lbnQgYSBwZXJmb3JtYW50IE1hcCB3aXRoIGFy
        Yml0cmFyeQogIGtleXMuIEJlY2F1c2UgaXQgaXMgY29tbW9ubHkgdXNlZCBp
        biBsb3ctbGV2ZWwgYm9va2tlZXBpbmcsIE1hcCBpcwogIGltcGxlbWVudGVk
        IGFzIGEgcHVyZSBKYXZhU2NyaXB0IG9iamVjdCBmb3IgcGVyZm9ybWFuY2Uu
        CgogIFRoaXMgaW1wbGVtZW50YXRpb24gZm9sbG93cyB0aGUgY3VycmVudCBp
        dGVyYXRpb24gb2YgdGhlIEVTNiBwcm9wb3NhbCBmb3IKICBtYXBzIChodHRw
        Oi8vd2lraS5lY21hc2NyaXB0Lm9yZy9kb2t1LnBocD9pZD1oYXJtb255OnNp
        bXBsZV9tYXBzX2FuZF9zZXRzKSwKICB3aXRoIHR3byBleGNlcHRpb25zLiBG
        aXJzdCwgYmVjYXVzZSB3ZSBuZWVkIG91ciBpbXBsZW1lbnRhdGlvbiB0byBi
        ZSBwbGVhc2FudAogIG9uIG9sZGVyIGJyb3dzZXJzLCB3ZSBkbyBub3QgdXNl
        IHRoZSBgZGVsZXRlYCBuYW1lICh1c2luZyBgcmVtb3ZlYCBpbnN0ZWFkKS4K
        ICBTZWNvbmQsIGFzIHdlIGRvIG5vdCBoYXZlIHRoZSBsdXh1cnkgb2YgaW4t
        Vk0gaXRlcmF0aW9uLCB3ZSBpbXBsZW1lbnQgYQogIGZvckVhY2ggbWV0aG9k
        IGZvciBpdGVyYXRpb24uCgogIE1hcCBpcyBtb2NrZWQgb3V0IHRvIGxvb2sg
        bGlrZSBhbiBFbWJlciBvYmplY3QsIHNvIHlvdSBjYW4gZG8KICBgRW1iZXIu
        TWFwLmNyZWF0ZSgpYCBmb3Igc3ltbWV0cnkgd2l0aCBvdGhlciBFbWJlciBj
        bGFzc2VzLgoqLwp2YXIgc2V0ID0gRW1iZXIuc2V0LAogICAgZ3VpZEZvciA9
        IEVtYmVyLmd1aWRGb3IsCiAgICBpbmRleE9mID0gRW1iZXIuQXJyYXlQb2x5
        ZmlsbHMuaW5kZXhPZjsKCnZhciBjb3B5ID0gZnVuY3Rpb24ob2JqKSB7CiAg
        dmFyIG91dHB1dCA9IHt9OwoKICBmb3IgKHZhciBwcm9wIGluIG9iaikgewog
        ICAgaWYgKG9iai5oYXNPd25Qcm9wZXJ0eShwcm9wKSkgeyBvdXRwdXRbcHJv
        cF0gPSBvYmpbcHJvcF07IH0KICB9CgogIHJldHVybiBvdXRwdXQ7Cn07Cgp2
        YXIgY29weU1hcCA9IGZ1bmN0aW9uKG9yaWdpbmFsLCBuZXdPYmplY3QpIHsK
        ICB2YXIga2V5cyA9IG9yaWdpbmFsLmtleXMuY29weSgpLAogICAgICB2YWx1
        ZXMgPSBjb3B5KG9yaWdpbmFsLnZhbHVlcyk7CgogIG5ld09iamVjdC5rZXlz
        ID0ga2V5czsKICBuZXdPYmplY3QudmFsdWVzID0gdmFsdWVzOwogIG5ld09i
        amVjdC5sZW5ndGggPSBvcmlnaW5hbC5sZW5ndGg7CgogIHJldHVybiBuZXdP
        YmplY3Q7Cn07CgovKioKICBUaGlzIGNsYXNzIGlzIHVzZWQgaW50ZXJuYWxs
        eSBieSBFbWJlciBhbmQgRW1iZXIgRGF0YS4KICBQbGVhc2UgZG8gbm90IHVz
        ZSBpdCBhdCB0aGlzIHRpbWUuIFdlIHBsYW4gdG8gY2xlYW4gaXQgdXAKICBh
        bmQgYWRkIG1hbnkgdGVzdHMgc29vbi4KCiAgQGNsYXNzIE9yZGVyZWRTZXQK
        ICBAbmFtZXNwYWNlIEVtYmVyCiAgQGNvbnN0cnVjdG9yCiAgQHByaXZhdGUK
        Ki8KdmFyIE9yZGVyZWRTZXQgPSBFbWJlci5PcmRlcmVkU2V0ID0gZnVuY3Rp
        b24oKSB7CiAgdGhpcy5jbGVhcigpOwp9OwoKLyoqCiAgQG1ldGhvZCBjcmVh
        dGUKICBAc3RhdGljCiAgQHJldHVybiB7RW1iZXIuT3JkZXJlZFNldH0KKi8K
        T3JkZXJlZFNldC5jcmVhdGUgPSBmdW5jdGlvbigpIHsKICByZXR1cm4gbmV3
        IE9yZGVyZWRTZXQoKTsKfTsKCgpPcmRlcmVkU2V0LnByb3RvdHlwZSA9IHsK
        ICAvKioKICAgIEBtZXRob2QgY2xlYXIKICAqLwogIGNsZWFyOiBmdW5jdGlv
        bigpIHsKICAgIHRoaXMucHJlc2VuY2VTZXQgPSB7fTsKICAgIHRoaXMubGlz
        dCA9IFtdOwogIH0sCgogIC8qKgogICAgQG1ldGhvZCBhZGQKICAgIEBwYXJh
        bSBvYmoKICAqLwogIGFkZDogZnVuY3Rpb24ob2JqKSB7CiAgICB2YXIgZ3Vp
        ZCA9IGd1aWRGb3Iob2JqKSwKICAgICAgICBwcmVzZW5jZVNldCA9IHRoaXMu
        cHJlc2VuY2VTZXQsCiAgICAgICAgbGlzdCA9IHRoaXMubGlzdDsKCiAgICBp
        ZiAoZ3VpZCBpbiBwcmVzZW5jZVNldCkgeyByZXR1cm47IH0KCiAgICBwcmVz
        ZW5jZVNldFtndWlkXSA9IHRydWU7CiAgICBsaXN0LnB1c2gob2JqKTsKICB9
        LAoKICAvKioKICAgIEBtZXRob2QgcmVtb3ZlCiAgICBAcGFyYW0gb2JqCiAg
        Ki8KICByZW1vdmU6IGZ1bmN0aW9uKG9iaikgewogICAgdmFyIGd1aWQgPSBn
        dWlkRm9yKG9iaiksCiAgICAgICAgcHJlc2VuY2VTZXQgPSB0aGlzLnByZXNl
        bmNlU2V0LAogICAgICAgIGxpc3QgPSB0aGlzLmxpc3Q7CgogICAgZGVsZXRl
        IHByZXNlbmNlU2V0W2d1aWRdOwoKICAgIHZhciBpbmRleCA9IGluZGV4T2Yu
        Y2FsbChsaXN0LCBvYmopOwogICAgaWYgKGluZGV4ID4gLTEpIHsKICAgICAg
        bGlzdC5zcGxpY2UoaW5kZXgsIDEpOwogICAgfQogIH0sCgogIC8qKgogICAg
        QG1ldGhvZCBpc0VtcHR5CiAgICBAcmV0dXJuIHtCb29sZWFufQogICovCiAg
        aXNFbXB0eTogZnVuY3Rpb24oKSB7CiAgICByZXR1cm4gdGhpcy5saXN0Lmxl
        bmd0aCA9PT0gMDsKICB9LAoKICAvKioKICAgIEBtZXRob2QgaGFzCiAgICBA
        cGFyYW0gb2JqCiAgICBAcmV0dXJuIHtCb29sZWFufQogICovCiAgaGFzOiBm
        dW5jdGlvbihvYmopIHsKICAgIHZhciBndWlkID0gZ3VpZEZvcihvYmopLAog
        ICAgICAgIHByZXNlbmNlU2V0ID0gdGhpcy5wcmVzZW5jZVNldDsKCiAgICBy
        ZXR1cm4gZ3VpZCBpbiBwcmVzZW5jZVNldDsKICB9LAoKICAvKioKICAgIEBt
        ZXRob2QgZm9yRWFjaAogICAgQHBhcmFtIHtGdW5jdGlvbn0gZm4KICAgIEBw
        YXJhbSBzZWxmCiAgKi8KICBmb3JFYWNoOiBmdW5jdGlvbihmbiwgc2VsZikg
        ewogICAgLy8gYWxsb3cgbXV0YXRpb24gZHVyaW5nIGl0ZXJhdGlvbgogICAg
        dmFyIGxpc3QgPSB0aGlzLnRvQXJyYXkoKTsKCiAgICBmb3IgKHZhciBpID0g
        MCwgaiA9IGxpc3QubGVuZ3RoOyBpIDwgajsgaSsrKSB7CiAgICAgIGZuLmNh
        bGwoc2VsZiwgbGlzdFtpXSk7CiAgICB9CiAgfSwKCiAgLyoqCiAgICBAbWV0
        aG9kIHRvQXJyYXkKICAgIEByZXR1cm4ge0FycmF5fQogICovCiAgdG9BcnJh
        eTogZnVuY3Rpb24oKSB7CiAgICByZXR1cm4gdGhpcy5saXN0LnNsaWNlKCk7
        CiAgfSwKCiAgLyoqCiAgICBAbWV0aG9kIGNvcHkKICAgIEByZXR1cm4ge0Vt
        YmVyLk9yZGVyZWRTZXR9CiAgKi8KICBjb3B5OiBmdW5jdGlvbigpIHsKICAg
        IHZhciBzZXQgPSBuZXcgT3JkZXJlZFNldCgpOwoKICAgIHNldC5wcmVzZW5j
        ZVNldCA9IGNvcHkodGhpcy5wcmVzZW5jZVNldCk7CiAgICBzZXQubGlzdCA9
        IHRoaXMudG9BcnJheSgpOwoKICAgIHJldHVybiBzZXQ7CiAgfQp9OwoKLyoq
        CiAgQSBNYXAgc3RvcmVzIHZhbHVlcyBpbmRleGVkIGJ5IGtleXMuIFVubGlr
        ZSBKYXZhU2NyaXB0J3MKICBkZWZhdWx0IE9iamVjdHMsIHRoZSBrZXlzIG9m
        IGEgTWFwIGNhbiBiZSBhbnkgSmF2YVNjcmlwdAogIG9iamVjdC4KCiAgSW50
        ZXJuYWxseSwgYSBNYXAgaGFzIHR3byBkYXRhIHN0cnVjdHVyZXM6CgogIDEu
        IGBrZXlzYDogYW4gT3JkZXJlZFNldCBvZiBhbGwgb2YgdGhlIGV4aXN0aW5n
        IGtleXMKICAyLiBgdmFsdWVzYDogYSBKYXZhU2NyaXB0IE9iamVjdCBpbmRl
        eGVkIGJ5IHRoZSBgRW1iZXIuZ3VpZEZvcihrZXkpYAoKICBXaGVuIGEga2V5
        L3ZhbHVlIHBhaXIgaXMgYWRkZWQgZm9yIHRoZSBmaXJzdCB0aW1lLCB3ZQog
        IGFkZCB0aGUga2V5IHRvIHRoZSBga2V5c2AgT3JkZXJlZFNldCwgYW5kIGNy
        ZWF0ZSBvcgogIHJlcGxhY2UgYW4gZW50cnkgaW4gYHZhbHVlc2AuIFdoZW4g
        YW4gZW50cnkgaXMgZGVsZXRlZCwKICB3ZSBkZWxldGUgaXRzIGVudHJ5IGlu
        IGBrZXlzYCBhbmQgYHZhbHVlc2AuCgogIEBjbGFzcyBNYXAKICBAbmFtZXNw
        YWNlIEVtYmVyCiAgQHByaXZhdGUKICBAY29uc3RydWN0b3IKKi8KdmFyIE1h
        cCA9IEVtYmVyLk1hcCA9IGZ1bmN0aW9uKCkgewogIHRoaXMua2V5cyA9IEVt
        YmVyLk9yZGVyZWRTZXQuY3JlYXRlKCk7CiAgdGhpcy52YWx1ZXMgPSB7fTsK
        fTsKCi8qKgogIEBtZXRob2QgY3JlYXRlCiAgQHN0YXRpYwoqLwpNYXAuY3Jl
        YXRlID0gZnVuY3Rpb24oKSB7CiAgcmV0dXJuIG5ldyBNYXAoKTsKfTsKCk1h
        cC5wcm90b3R5cGUgPSB7CiAgLyoqCiAgICBUaGlzIHByb3BlcnR5IHdpbGwg
        Y2hhbmdlIGFzIHRoZSBudW1iZXIgb2Ygb2JqZWN0cyBpbiB0aGUgbWFwIGNo
        YW5nZXMuCiAgIAogICAgQHByb3BlcnR5IGxlbmd0aAogICAgQHR5cGUgbnVt
        YmVyCiAgICBAZGVmYXVsdCAwCiAgKi8KICBsZW5ndGg6IDAsCiAgICAKICAg
        IAogIC8qKgogICAgUmV0cmlldmUgdGhlIHZhbHVlIGFzc29jaWF0ZWQgd2l0
        aCBhIGdpdmVuIGtleS4KCiAgICBAbWV0aG9kIGdldAogICAgQHBhcmFtIHsq
        fSBrZXkKICAgIEByZXR1cm4geyp9IHRoZSB2YWx1ZSBhc3NvY2lhdGVkIHdp
        dGggdGhlIGtleSwgb3IgYHVuZGVmaW5lZGAKICAqLwogIGdldDogZnVuY3Rp
        b24oa2V5KSB7CiAgICB2YXIgdmFsdWVzID0gdGhpcy52YWx1ZXMsCiAgICAg
        ICAgZ3VpZCA9IGd1aWRGb3Ioa2V5KTsKCiAgICByZXR1cm4gdmFsdWVzW2d1
        aWRdOwogIH0sCgogIC8qKgogICAgQWRkcyBhIHZhbHVlIHRvIHRoZSBtYXAu
        IElmIGEgdmFsdWUgZm9yIHRoZSBnaXZlbiBrZXkgaGFzIGFscmVhZHkgYmVl
        bgogICAgcHJvdmlkZWQsIHRoZSBuZXcgdmFsdWUgd2lsbCByZXBsYWNlIHRo
        ZSBvbGQgdmFsdWUuCgogICAgQG1ldGhvZCBzZXQKICAgIEBwYXJhbSB7Kn0g
        a2V5CiAgICBAcGFyYW0geyp9IHZhbHVlCiAgKi8KICBzZXQ6IGZ1bmN0aW9u
        KGtleSwgdmFsdWUpIHsKICAgIHZhciBrZXlzID0gdGhpcy5rZXlzLAogICAg
        ICAgIHZhbHVlcyA9IHRoaXMudmFsdWVzLAogICAgICAgIGd1aWQgPSBndWlk
        Rm9yKGtleSk7CgogICAga2V5cy5hZGQoa2V5KTsKICAgIHZhbHVlc1tndWlk
        XSA9IHZhbHVlOwogICAgc2V0KHRoaXMsICdsZW5ndGgnLCBrZXlzLmxpc3Qu
        bGVuZ3RoKTsKICB9LAoKICAvKioKICAgIFJlbW92ZXMgYSB2YWx1ZSBmcm9t
        IHRoZSBtYXAgZm9yIGFuIGFzc29jaWF0ZWQga2V5LgoKICAgIEBtZXRob2Qg
        cmVtb3ZlCiAgICBAcGFyYW0geyp9IGtleQogICAgQHJldHVybiB7Qm9vbGVh
        bn0gdHJ1ZSBpZiBhbiBpdGVtIHdhcyByZW1vdmVkLCBmYWxzZSBvdGhlcndp
        c2UKICAqLwogIHJlbW92ZTogZnVuY3Rpb24oa2V5KSB7CiAgICAvLyBkb24n
        dCB1c2UgRVM2ICJkZWxldGUiIGJlY2F1c2UgaXQgd2lsbCBiZSBhbm5veWlu
        ZwogICAgLy8gdG8gdXNlIGluIGJyb3dzZXJzIHRoYXQgYXJlIG5vdCBFUzYg
        ZnJpZW5kbHk7CiAgICB2YXIga2V5cyA9IHRoaXMua2V5cywKICAgICAgICB2
        YWx1ZXMgPSB0aGlzLnZhbHVlcywKICAgICAgICBndWlkID0gZ3VpZEZvcihr
        ZXkpOwoKICAgIGlmICh2YWx1ZXMuaGFzT3duUHJvcGVydHkoZ3VpZCkpIHsK
        ICAgICAga2V5cy5yZW1vdmUoa2V5KTsKICAgICAgZGVsZXRlIHZhbHVlc1tn
        dWlkXTsKICAgICAgc2V0KHRoaXMsICdsZW5ndGgnLCBrZXlzLmxpc3QubGVu
        Z3RoKTsKICAgICAgcmV0dXJuIHRydWU7CiAgICB9IGVsc2UgewogICAgICBy
        ZXR1cm4gZmFsc2U7CiAgICB9CiAgfSwKCiAgLyoqCiAgICBDaGVjayB3aGV0
        aGVyIGEga2V5IGlzIHByZXNlbnQuCgogICAgQG1ldGhvZCBoYXMKICAgIEBw
        YXJhbSB7Kn0ga2V5CiAgICBAcmV0dXJuIHtCb29sZWFufSB0cnVlIGlmIHRo
        ZSBpdGVtIHdhcyBwcmVzZW50LCBmYWxzZSBvdGhlcndpc2UKICAqLwogIGhh
        czogZnVuY3Rpb24oa2V5KSB7CiAgICB2YXIgdmFsdWVzID0gdGhpcy52YWx1
        ZXMsCiAgICAgICAgZ3VpZCA9IGd1aWRGb3Ioa2V5KTsKCiAgICByZXR1cm4g
        dmFsdWVzLmhhc093blByb3BlcnR5KGd1aWQpOwogIH0sCgogIC8qKgogICAg
        SXRlcmF0ZSBvdmVyIGFsbCB0aGUga2V5cyBhbmQgdmFsdWVzLiBDYWxscyB0
        aGUgZnVuY3Rpb24gb25jZQogICAgZm9yIGVhY2gga2V5LCBwYXNzaW5nIGlu
        IHRoZSBrZXkgYW5kIHZhbHVlLCBpbiB0aGF0IG9yZGVyLgoKICAgIFRoZSBr
        ZXlzIGFyZSBndWFyYW50ZWVkIHRvIGJlIGl0ZXJhdGVkIG92ZXIgaW4gaW5z
        ZXJ0aW9uIG9yZGVyLgoKICAgIEBtZXRob2QgZm9yRWFjaAogICAgQHBhcmFt
        IHtGdW5jdGlvbn0gY2FsbGJhY2sKICAgIEBwYXJhbSB7Kn0gc2VsZiBpZiBw
        YXNzZWQsIHRoZSBgdGhpc2AgdmFsdWUgaW5zaWRlIHRoZQogICAgICBjYWxs
        YmFjay4gQnkgZGVmYXVsdCwgYHRoaXNgIGlzIHRoZSBtYXAuCiAgKi8KICBm
        b3JFYWNoOiBmdW5jdGlvbihjYWxsYmFjaywgc2VsZikgewogICAgdmFyIGtl
        eXMgPSB0aGlzLmtleXMsCiAgICAgICAgdmFsdWVzID0gdGhpcy52YWx1ZXM7
        CgogICAga2V5cy5mb3JFYWNoKGZ1bmN0aW9uKGtleSkgewogICAgICB2YXIg
        Z3VpZCA9IGd1aWRGb3Ioa2V5KTsKICAgICAgY2FsbGJhY2suY2FsbChzZWxm
        LCBrZXksIHZhbHVlc1tndWlkXSk7CiAgICB9KTsKICB9LAoKICAvKioKICAg
        IEBtZXRob2QgY29weQogICAgQHJldHVybiB7RW1iZXIuTWFwfQogICovCiAg
        Y29weTogZnVuY3Rpb24oKSB7CiAgICByZXR1cm4gY29weU1hcCh0aGlzLCBu
        ZXcgTWFwKCkpOwogIH0KfTsKCi8qKgogIEBjbGFzcyBNYXBXaXRoRGVmYXVs
        dAogIEBuYW1lc3BhY2UgRW1iZXIKICBAZXh0ZW5kcyBFbWJlci5NYXAKICBA
        cHJpdmF0ZQogIEBjb25zdHJ1Y3RvcgogIEBwYXJhbSBbb3B0aW9uc10KICAg
        IEBwYXJhbSB7Kn0gW29wdGlvbnMuZGVmYXVsdFZhbHVlXQoqLwp2YXIgTWFw
        V2l0aERlZmF1bHQgPSBFbWJlci5NYXBXaXRoRGVmYXVsdCA9IGZ1bmN0aW9u
        KG9wdGlvbnMpIHsKICBNYXAuY2FsbCh0aGlzKTsKICB0aGlzLmRlZmF1bHRW
        YWx1ZSA9IG9wdGlvbnMuZGVmYXVsdFZhbHVlOwp9OwoKLyoqCiAgQG1ldGhv
        ZCBjcmVhdGUKICBAc3RhdGljCiAgQHBhcmFtIFtvcHRpb25zXQogICAgQHBh
        cmFtIHsqfSBbb3B0aW9ucy5kZWZhdWx0VmFsdWVdCiAgQHJldHVybiB7RW1i
        ZXIuTWFwV2l0aERlZmF1bHR8RW1iZXIuTWFwfSBJZiBvcHRpb25zIGFyZSBw
        YXNzZWQsIHJldHVybnMKICAgIGBFbWJlci5NYXBXaXRoRGVmYXVsdGAgb3Ro
        ZXJ3aXNlIHJldHVybnMgYEVtYmVyLk1hcGAKKi8KTWFwV2l0aERlZmF1bHQu
        Y3JlYXRlID0gZnVuY3Rpb24ob3B0aW9ucykgewogIGlmIChvcHRpb25zKSB7
        CiAgICByZXR1cm4gbmV3IE1hcFdpdGhEZWZhdWx0KG9wdGlvbnMpOwogIH0g
        ZWxzZSB7CiAgICByZXR1cm4gbmV3IE1hcCgpOwogIH0KfTsKCk1hcFdpdGhE
        ZWZhdWx0LnByb3RvdHlwZSA9IEVtYmVyLmNyZWF0ZShNYXAucHJvdG90eXBl
        KTsKCi8qKgogIFJldHJpZXZlIHRoZSB2YWx1ZSBhc3NvY2lhdGVkIHdpdGgg
        YSBnaXZlbiBrZXkuCgogIEBtZXRob2QgZ2V0CiAgQHBhcmFtIHsqfSBrZXkK
        ICBAcmV0dXJuIHsqfSB0aGUgdmFsdWUgYXNzb2NpYXRlZCB3aXRoIHRoZSBr
        ZXksIG9yIHRoZSBkZWZhdWx0IHZhbHVlCiovCk1hcFdpdGhEZWZhdWx0LnBy
        b3RvdHlwZS5nZXQgPSBmdW5jdGlvbihrZXkpIHsKICB2YXIgaGFzVmFsdWUg
        PSB0aGlzLmhhcyhrZXkpOwoKICBpZiAoaGFzVmFsdWUpIHsKICAgIHJldHVy
        biBNYXAucHJvdG90eXBlLmdldC5jYWxsKHRoaXMsIGtleSk7CiAgfSBlbHNl
        IHsKICAgIHZhciBkZWZhdWx0VmFsdWUgPSB0aGlzLmRlZmF1bHRWYWx1ZShr
        ZXkpOwogICAgdGhpcy5zZXQoa2V5LCBkZWZhdWx0VmFsdWUpOwogICAgcmV0
        dXJuIGRlZmF1bHRWYWx1ZTsKICB9Cn07CgovKioKICBAbWV0aG9kIGNvcHkK
        ICBAcmV0dXJuIHtFbWJlci5NYXBXaXRoRGVmYXVsdH0KKi8KTWFwV2l0aERl
        ZmF1bHQucHJvdG90eXBlLmNvcHkgPSBmdW5jdGlvbigpIHsKICByZXR1cm4g
        Y29weU1hcCh0aGlzLCBuZXcgTWFwV2l0aERlZmF1bHQoewogICAgZGVmYXVs
        dFZhbHVlOiB0aGlzLmRlZmF1bHRWYWx1ZQogIH0pKTsKfTsKCn0pKCk7CgoK
        CihmdW5jdGlvbigpIHsKLyoqCkBtb2R1bGUgZW1iZXItbWV0YWwKKi8KCnZh
        ciBNRVRBX0tFWSA9IEVtYmVyLk1FVEFfS0VZLAogICAgbWV0YUZvciA9IEVt
        YmVyLm1ldGEsCiAgICBvYmplY3REZWZpbmVQcm9wZXJ0eSA9IEVtYmVyLnBs
        YXRmb3JtLmRlZmluZVByb3BlcnR5OwoKdmFyIE1BTkRBVE9SWV9TRVRURVIg
        PSBFbWJlci5FTlYuTUFOREFUT1JZX1NFVFRFUjsKCi8vIC4uLi4uLi4uLi4u
        Li4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4u
        Li4KLy8gREVTQ1JJUFRPUgovLwoKLyoqCiAgT2JqZWN0cyBvZiB0aGlzIHR5
        cGUgY2FuIGltcGxlbWVudCBhbiBpbnRlcmZhY2UgdG8gcmVzcG9uZCB0byBy
        ZXF1ZXN0cyB0bwogIGdldCBhbmQgc2V0LiBUaGUgZGVmYXVsdCBpbXBsZW1l
        bnRhdGlvbiBoYW5kbGVzIHNpbXBsZSBwcm9wZXJ0aWVzLgoKICBZb3UgZ2Vu
        ZXJhbGx5IHdvbid0IG5lZWQgdG8gY3JlYXRlIG9yIHN1YmNsYXNzIHRoaXMg
        ZGlyZWN0bHkuCgogIEBjbGFzcyBEZXNjcmlwdG9yCiAgQG5hbWVzcGFjZSBF
        bWJlcgogIEBwcml2YXRlCiAgQGNvbnN0cnVjdG9yCiovCkVtYmVyLkRlc2Ny
        aXB0b3IgPSBmdW5jdGlvbigpIHt9OwoKLy8gLi4uLi4uLi4uLi4uLi4uLi4u
        Li4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLgovLyBE
        RUZJTklORyBQUk9QRVJUSUVTIEFQSQovLwoKdmFyIE1BTkRBVE9SWV9TRVRU
        RVJfRlVOQ1RJT04gPSBFbWJlci5NQU5EQVRPUllfU0VUVEVSX0ZVTkNUSU9O
        ID0gZnVuY3Rpb24odmFsdWUpIHsKICBFbWJlci5hc3NlcnQoIllvdSBtdXN0
        IHVzZSBFbWJlci5zZXQoKSB0byBhY2Nlc3MgdGhpcyBwcm9wZXJ0eSAob2Yg
        IiArIHRoaXMgKyAiKSIsIGZhbHNlKTsKfTsKCnZhciBERUZBVUxUX0dFVFRF
        Ul9GVU5DVElPTiA9IEVtYmVyLkRFRkFVTFRfR0VUVEVSX0ZVTkNUSU9OID0g
        ZnVuY3Rpb24obmFtZSkgewogIHJldHVybiBmdW5jdGlvbigpIHsKICAgIHZh
        ciBtZXRhID0gdGhpc1tNRVRBX0tFWV07CiAgICByZXR1cm4gbWV0YSAmJiBt
        ZXRhLnZhbHVlc1tuYW1lXTsKICB9Owp9OwoKLyoqCiAgQHByaXZhdGUKCiAg
        Tk9URTogVGhpcyBpcyBhIGxvdy1sZXZlbCBtZXRob2QgdXNlZCBieSBvdGhl
        ciBwYXJ0cyBvZiB0aGUgQVBJLiBZb3UgYWxtb3N0CiAgbmV2ZXIgd2FudCB0
        byBjYWxsIHRoaXMgbWV0aG9kIGRpcmVjdGx5LiBJbnN0ZWFkIHlvdSBzaG91
        bGQgdXNlCiAgYEVtYmVyLm1peGluKClgIHRvIGRlZmluZSBuZXcgcHJvcGVy
        dGllcy4KCiAgRGVmaW5lcyBhIHByb3BlcnR5IG9uIGFuIG9iamVjdC4gVGhp
        cyBtZXRob2Qgd29ya3MgbXVjaCBsaWtlIHRoZSBFUzUKICBgT2JqZWN0LmRl
        ZmluZVByb3BlcnR5KClgIG1ldGhvZCBleGNlcHQgdGhhdCBpdCBjYW4gYWxz
        byBhY2NlcHQgY29tcHV0ZWQKICBwcm9wZXJ0aWVzIGFuZCBvdGhlciBzcGVj
        aWFsIGRlc2NyaXB0b3JzLgoKICBOb3JtYWxseSB0aGlzIG1ldGhvZCB0YWtl
        cyBvbmx5IHRocmVlIHBhcmFtZXRlcnMuIEhvd2V2ZXIgaWYgeW91IHBhc3Mg
        YW4KICBpbnN0YW5jZSBvZiBgRW1iZXIuRGVzY3JpcHRvcmAgYXMgdGhlIHRo
        aXJkIHBhcmFtIHRoZW4geW91IGNhbiBwYXNzIGFuCiAgb3B0aW9uYWwgdmFs
        dWUgYXMgdGhlIGZvdXJ0aCBwYXJhbWV0ZXIuIFRoaXMgaXMgb2Z0ZW4gbW9y
        ZSBlZmZpY2llbnQgdGhhbgogIGNyZWF0aW5nIG5ldyBkZXNjcmlwdG9yIGhh
        c2hlcyBmb3IgZWFjaCBwcm9wZXJ0eS4KCiAgIyMgRXhhbXBsZXMKCiAgYGBg
        amF2YXNjcmlwdAogIC8vIEVTNSBjb21wYXRpYmxlIG1vZGUKICBFbWJlci5k
        ZWZpbmVQcm9wZXJ0eShjb250YWN0LCAnZmlyc3ROYW1lJywgewogICAgd3Jp
        dGFibGU6IHRydWUsCiAgICBjb25maWd1cmFibGU6IGZhbHNlLAogICAgZW51
        bWVyYWJsZTogdHJ1ZSwKICAgIHZhbHVlOiAnQ2hhcmxlcycKICB9KTsKCiAg
        Ly8gZGVmaW5lIGEgc2ltcGxlIHByb3BlcnR5CiAgRW1iZXIuZGVmaW5lUHJv
        cGVydHkoY29udGFjdCwgJ2xhc3ROYW1lJywgdW5kZWZpbmVkLCAnSm9sbGV5
        Jyk7CgogIC8vIGRlZmluZSBhIGNvbXB1dGVkIHByb3BlcnR5CiAgRW1iZXIu
        ZGVmaW5lUHJvcGVydHkoY29udGFjdCwgJ2Z1bGxOYW1lJywgRW1iZXIuY29t
        cHV0ZWQoZnVuY3Rpb24oKSB7CiAgICByZXR1cm4gdGhpcy5maXJzdE5hbWUr
        JyAnK3RoaXMubGFzdE5hbWU7CiAgfSkucHJvcGVydHkoJ2ZpcnN0TmFtZScs
        ICdsYXN0TmFtZScpKTsKICBgYGAKCiAgQG1ldGhvZCBkZWZpbmVQcm9wZXJ0
        eQogIEBmb3IgRW1iZXIKICBAcGFyYW0ge09iamVjdH0gb2JqIHRoZSBvYmpl
        Y3QgdG8gZGVmaW5lIHRoaXMgcHJvcGVydHkgb24uIFRoaXMgbWF5IGJlIGEg
        cHJvdG90eXBlLgogIEBwYXJhbSB7U3RyaW5nfSBrZXlOYW1lIHRoZSBuYW1l
        IG9mIHRoZSBwcm9wZXJ0eQogIEBwYXJhbSB7RW1iZXIuRGVzY3JpcHRvcn0g
        W2Rlc2NdIGFuIGluc3RhbmNlIG9mIGBFbWJlci5EZXNjcmlwdG9yYCAodHlw
        aWNhbGx5IGEKICAgIGNvbXB1dGVkIHByb3BlcnR5KSBvciBhbiBFUzUgZGVz
        Y3JpcHRvci4KICAgIFlvdSBtdXN0IHByb3ZpZGUgdGhpcyBvciBgZGF0YWAg
        YnV0IG5vdCBib3RoLgogIEBwYXJhbSB7Kn0gW2RhdGFdIHNvbWV0aGluZyBv
        dGhlciB0aGFuIGEgZGVzY3JpcHRvciwgdGhhdCB3aWxsCiAgICBiZWNvbWUg
        dGhlIGV4cGxpY2l0IHZhbHVlIG9mIHRoaXMgcHJvcGVydHkuCiovCkVtYmVy
        LmRlZmluZVByb3BlcnR5ID0gZnVuY3Rpb24ob2JqLCBrZXlOYW1lLCBkZXNj
        LCBkYXRhLCBtZXRhKSB7CiAgdmFyIGRlc2NzLCBleGlzdGluZ0Rlc2MsIHdh
        dGNoaW5nLCB2YWx1ZTsKCiAgaWYgKCFtZXRhKSBtZXRhID0gbWV0YUZvcihv
        YmopOwogIGRlc2NzID0gbWV0YS5kZXNjczsKICBleGlzdGluZ0Rlc2MgPSBt
        ZXRhLmRlc2NzW2tleU5hbWVdOwogIHdhdGNoaW5nID0gbWV0YS53YXRjaGlu
        Z1trZXlOYW1lXSA+IDA7CgogIGlmIChleGlzdGluZ0Rlc2MgaW5zdGFuY2Vv
        ZiBFbWJlci5EZXNjcmlwdG9yKSB7CiAgICBleGlzdGluZ0Rlc2MudGVhcmRv
        d24ob2JqLCBrZXlOYW1lKTsKICB9CgogIGlmIChkZXNjIGluc3RhbmNlb2Yg
        RW1iZXIuRGVzY3JpcHRvcikgewogICAgdmFsdWUgPSBkZXNjOwoKICAgIGRl
        c2NzW2tleU5hbWVdID0gZGVzYzsKICAgIGlmIChNQU5EQVRPUllfU0VUVEVS
        ICYmIHdhdGNoaW5nKSB7CiAgICAgIG9iamVjdERlZmluZVByb3BlcnR5KG9i
        aiwga2V5TmFtZSwgewogICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAg
        ICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgIHdyaXRhYmxlOiB0cnVl
        LAogICAgICAgIHZhbHVlOiB1bmRlZmluZWQgLy8gbWFrZSBlbnVtZXJhYmxl
        CiAgICAgIH0pOwogICAgfSBlbHNlIHsKICAgICAgb2JqW2tleU5hbWVdID0g
        dW5kZWZpbmVkOyAvLyBtYWtlIGVudW1lcmFibGUKICAgIH0KICB9IGVsc2Ug
        ewogICAgZGVzY3Nba2V5TmFtZV0gPSB1bmRlZmluZWQ7IC8vIHNoYWRvdyBk
        ZXNjcmlwdG9yIGluIHByb3RvCiAgICBpZiAoZGVzYyA9PSBudWxsKSB7CiAg
        ICAgIHZhbHVlID0gZGF0YTsKCiAgICAgIGlmIChNQU5EQVRPUllfU0VUVEVS
        ICYmIHdhdGNoaW5nKSB7CiAgICAgICAgbWV0YS52YWx1ZXNba2V5TmFtZV0g
        PSBkYXRhOwogICAgICAgIG9iamVjdERlZmluZVByb3BlcnR5KG9iaiwga2V5
        TmFtZSwgewogICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAg
        ICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICAgIHNldDogTUFOREFUT1JZ
        X1NFVFRFUl9GVU5DVElPTiwKICAgICAgICAgIGdldDogREVGQVVMVF9HRVRU
        RVJfRlVOQ1RJT04oa2V5TmFtZSkKICAgICAgICB9KTsKICAgICAgfSBlbHNl
        IHsKICAgICAgICBvYmpba2V5TmFtZV0gPSBkYXRhOwogICAgICB9CiAgICB9
        IGVsc2UgewogICAgICB2YWx1ZSA9IGRlc2M7CgogICAgICAvLyBjb21wYXRp
        YmlsaXR5IHdpdGggRVM1CiAgICAgIG9iamVjdERlZmluZVByb3BlcnR5KG9i
        aiwga2V5TmFtZSwgZGVzYyk7CiAgICB9CiAgfQoKICAvLyBpZiBrZXkgaXMg
        YmVpbmcgd2F0Y2hlZCwgb3ZlcnJpZGUgY2hhaW5zIHRoYXQKICAvLyB3ZXJl
        IGluaXRpYWxpemVkIHdpdGggdGhlIHByb3RvdHlwZQogIGlmICh3YXRjaGlu
        ZykgeyBFbWJlci5vdmVycmlkZUNoYWlucyhvYmosIGtleU5hbWUsIG1ldGEp
        OyB9CgogIC8vIFRoZSBgdmFsdWVgIHBhc3NlZCB0byB0aGUgYGRpZERlZmlu
        ZVByb3BlcnR5YCBob29rIGlzCiAgLy8gZWl0aGVyIHRoZSBkZXNjcmlwdG9y
        IG9yIGRhdGEsIHdoaWNoZXZlciB3YXMgcGFzc2VkLgogIGlmIChvYmouZGlk
        RGVmaW5lUHJvcGVydHkpIHsgb2JqLmRpZERlZmluZVByb3BlcnR5KG9iaiwg
        a2V5TmFtZSwgdmFsdWUpOyB9CgogIHJldHVybiB0aGlzOwp9OwoKCn0pKCk7
        CgoKCihmdW5jdGlvbigpIHsKdmFyIGdldCA9IEVtYmVyLmdldDsKCi8qKgog
        IFRvIGdldCBtdWx0aXBsZSBwcm9wZXJ0aWVzIGF0IG9uY2UsIGNhbGwgYEVt
        YmVyLmdldFByb3BlcnRpZXNgCiAgd2l0aCBhbiBvYmplY3QgZm9sbG93ZWQg
        YnkgYSBsaXN0IG9mIHN0cmluZ3Mgb3IgYW4gYXJyYXk6CgogIGBgYGphdmFz
        Y3JpcHQKICBFbWJlci5nZXRQcm9wZXJ0aWVzKHJlY29yZCwgJ2ZpcnN0TmFt
        ZScsICdsYXN0TmFtZScsICd6aXBDb2RlJyk7ICAvLyB7IGZpcnN0TmFtZTog
        J0pvaG4nLCBsYXN0TmFtZTogJ0RvZScsIHppcENvZGU6ICcxMDAxMScgfQog
        IGBgYAoKICBpcyBlcXVpdmFsZW50IHRvOgoKICBgYGBqYXZhc2NyaXB0CiAg
        RW1iZXIuZ2V0UHJvcGVydGllcyhyZWNvcmQsIFsnZmlyc3ROYW1lJywgJ2xh
        c3ROYW1lJywgJ3ppcENvZGUnXSk7ICAvLyB7IGZpcnN0TmFtZTogJ0pvaG4n
        LCBsYXN0TmFtZTogJ0RvZScsIHppcENvZGU6ICcxMDAxMScgfQogIGBgYAoK
        ICBAbWV0aG9kIGdldFByb3BlcnRpZXMKICBAcGFyYW0gb2JqCiAgQHBhcmFt
        IHtTdHJpbmcuLi58QXJyYXl9IGxpc3Qgb2Yga2V5cyB0byBnZXQKICBAcmV0
        dXJuIHtIYXNofQoqLwpFbWJlci5nZXRQcm9wZXJ0aWVzID0gZnVuY3Rpb24o
        b2JqKSB7CiAgdmFyIHJldCA9IHt9LAogICAgICBwcm9wZXJ0eU5hbWVzID0g
        YXJndW1lbnRzLAogICAgICBpID0gMTsKCiAgaWYgKGFyZ3VtZW50cy5sZW5n
        dGggPT09IDIgJiYgRW1iZXIudHlwZU9mKGFyZ3VtZW50c1sxXSkgPT09ICdh
        cnJheScpIHsKICAgIGkgPSAwOwogICAgcHJvcGVydHlOYW1lcyA9IGFyZ3Vt
        ZW50c1sxXTsKICB9CiAgZm9yKHZhciBsZW4gPSBwcm9wZXJ0eU5hbWVzLmxl
        bmd0aDsgaSA8IGxlbjsgaSsrKSB7CiAgICByZXRbcHJvcGVydHlOYW1lc1tp
        XV0gPSBnZXQob2JqLCBwcm9wZXJ0eU5hbWVzW2ldKTsKICB9CiAgcmV0dXJu
        IHJldDsKfTsKCn0pKCk7CgoKCihmdW5jdGlvbigpIHsKdmFyIGNoYW5nZVBy
        b3BlcnRpZXMgPSBFbWJlci5jaGFuZ2VQcm9wZXJ0aWVzLAogICAgc2V0ID0g
        RW1iZXIuc2V0OwoKLyoqCiAgU2V0IGEgbGlzdCBvZiBwcm9wZXJ0aWVzIG9u
        IGFuIG9iamVjdC4gVGhlc2UgcHJvcGVydGllcyBhcmUgc2V0IGluc2lkZQog
        IGEgc2luZ2xlIGBiZWdpblByb3BlcnR5Q2hhbmdlc2AgYW5kIGBlbmRQcm9w
        ZXJ0eUNoYW5nZXNgIGJhdGNoLCBzbwogIG9ic2VydmVycyB3aWxsIGJlIGJ1
        ZmZlcmVkLgoKICBgYGBqYXZhc2NyaXB0CiAgYW5PYmplY3Quc2V0UHJvcGVy
        dGllcyh7CiAgICBmaXJzdE5hbWU6ICJTdGFubGV5IiwKICAgIGxhc3ROYW1l
        OiAiU3R1YXJ0IiwKICAgIGFnZTogIjIxIgogIH0pCiAgYGBgCgogIEBtZXRo
        b2Qgc2V0UHJvcGVydGllcwogIEBwYXJhbSBzZWxmCiAgQHBhcmFtIHtPYmpl
        Y3R9IGhhc2gKICBAcmV0dXJuIHNlbGYKKi8KRW1iZXIuc2V0UHJvcGVydGll
        cyA9IGZ1bmN0aW9uKHNlbGYsIGhhc2gpIHsKICBjaGFuZ2VQcm9wZXJ0aWVz
        KGZ1bmN0aW9uKCkgewogICAgZm9yKHZhciBwcm9wIGluIGhhc2gpIHsKICAg
        ICAgaWYgKGhhc2guaGFzT3duUHJvcGVydHkocHJvcCkpIHsgc2V0KHNlbGYs
        IHByb3AsIGhhc2hbcHJvcF0pOyB9CiAgICB9CiAgfSk7CiAgcmV0dXJuIHNl
        bGY7Cn07Cgp9KSgpOwoKCgooZnVuY3Rpb24oKSB7CnZhciBtZXRhRm9yID0g
        RW1iZXIubWV0YSwgLy8gdXRpbHMuanMKICAgIHR5cGVPZiA9IEVtYmVyLnR5
        cGVPZiwgLy8gdXRpbHMuanMKICAgIE1BTkRBVE9SWV9TRVRURVIgPSBFbWJl
        ci5FTlYuTUFOREFUT1JZX1NFVFRFUiwKICAgIG9fZGVmaW5lUHJvcGVydHkg
        PSBFbWJlci5wbGF0Zm9ybS5kZWZpbmVQcm9wZXJ0eTsKCkVtYmVyLndhdGNo
        S2V5ID0gZnVuY3Rpb24ob2JqLCBrZXlOYW1lKSB7CiAgLy8gY2FuJ3Qgd2F0
        Y2ggbGVuZ3RoIG9uIEFycmF5IC0gaXQgaXMgc3BlY2lhbC4uLgogIGlmIChr
        ZXlOYW1lID09PSAnbGVuZ3RoJyAmJiB0eXBlT2Yob2JqKSA9PT0gJ2FycmF5
        JykgeyByZXR1cm47IH0KCiAgdmFyIG0gPSBtZXRhRm9yKG9iaiksIHdhdGNo
        aW5nID0gbS53YXRjaGluZzsKCiAgLy8gYWN0aXZhdGUgd2F0Y2hpbmcgZmly
        c3QgdGltZQogIGlmICghd2F0Y2hpbmdba2V5TmFtZV0pIHsKICAgIHdhdGNo
        aW5nW2tleU5hbWVdID0gMTsKCiAgICBpZiAoJ2Z1bmN0aW9uJyA9PT0gdHlw
        ZW9mIG9iai53aWxsV2F0Y2hQcm9wZXJ0eSkgewogICAgICBvYmoud2lsbFdh
        dGNoUHJvcGVydHkoa2V5TmFtZSk7CiAgICB9CgogICAgaWYgKE1BTkRBVE9S
        WV9TRVRURVIgJiYga2V5TmFtZSBpbiBvYmopIHsKICAgICAgbS52YWx1ZXNb
        a2V5TmFtZV0gPSBvYmpba2V5TmFtZV07CiAgICAgIG9fZGVmaW5lUHJvcGVy
        dHkob2JqLCBrZXlOYW1lLCB7CiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVl
        LAogICAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgICAgc2V0OiBFbWJl
        ci5NQU5EQVRPUllfU0VUVEVSX0ZVTkNUSU9OLAogICAgICAgIGdldDogRW1i
        ZXIuREVGQVVMVF9HRVRURVJfRlVOQ1RJT04oa2V5TmFtZSkKICAgICAgfSk7
        CiAgICB9CiAgfSBlbHNlIHsKICAgIHdhdGNoaW5nW2tleU5hbWVdID0gKHdh
        dGNoaW5nW2tleU5hbWVdIHx8IDApICsgMTsKICB9Cn07CgoKRW1iZXIudW53
        YXRjaEtleSA9IGZ1bmN0aW9uKG9iaiwga2V5TmFtZSkgewogIHZhciBtID0g
        bWV0YUZvcihvYmopLCB3YXRjaGluZyA9IG0ud2F0Y2hpbmc7CgogIGlmICh3
        YXRjaGluZ1trZXlOYW1lXSA9PT0gMSkgewogICAgd2F0Y2hpbmdba2V5TmFt
        ZV0gPSAwOwoKICAgIGlmICgnZnVuY3Rpb24nID09PSB0eXBlb2Ygb2JqLmRp
        ZFVud2F0Y2hQcm9wZXJ0eSkgewogICAgICBvYmouZGlkVW53YXRjaFByb3Bl
        cnR5KGtleU5hbWUpOwogICAgfQoKICAgIGlmIChNQU5EQVRPUllfU0VUVEVS
        ICYmIGtleU5hbWUgaW4gb2JqKSB7CiAgICAgIG9fZGVmaW5lUHJvcGVydHko
        b2JqLCBrZXlOYW1lLCB7CiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAog
        ICAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgICAgd3JpdGFibGU6IHRy
        dWUsCiAgICAgICAgdmFsdWU6IG0udmFsdWVzW2tleU5hbWVdCiAgICAgIH0p
        OwogICAgICBkZWxldGUgbS52YWx1ZXNba2V5TmFtZV07CiAgICB9CiAgfSBl
        bHNlIGlmICh3YXRjaGluZ1trZXlOYW1lXSA+IDEpIHsKICAgIHdhdGNoaW5n
        W2tleU5hbWVdLS07CiAgfQp9OwoKfSkoKTsKCgoKKGZ1bmN0aW9uKCkgewp2
        YXIgbWV0YUZvciA9IEVtYmVyLm1ldGEsIC8vIHV0aWxzLmpzCiAgICBnZXQg
        PSBFbWJlci5nZXQsIC8vIHByb3BlcnR5X2dldC5qcwogICAgbm9ybWFsaXpl
        VHVwbGUgPSBFbWJlci5ub3JtYWxpemVUdXBsZSwgLy8gcHJvcGVydHlfZ2V0
        LmpzCiAgICBmb3JFYWNoID0gRW1iZXIuQXJyYXlQb2x5ZmlsbHMuZm9yRWFj
        aCwgLy8gYXJyYXkuanMKICAgIHdhcm4gPSBFbWJlci53YXJuLAogICAgd2F0
        Y2hLZXkgPSBFbWJlci53YXRjaEtleSwKICAgIHVud2F0Y2hLZXkgPSBFbWJl
        ci51bndhdGNoS2V5LAogICAgRklSU1RfS0VZID0gL14oW15cLlwqXSspLzsK
        CmZ1bmN0aW9uIGZpcnN0S2V5KHBhdGgpIHsKICByZXR1cm4gcGF0aC5tYXRj
        aChGSVJTVF9LRVkpWzBdOwp9Cgp2YXIgcGVuZGluZ1F1ZXVlID0gW107Cgov
        LyBhdHRlbXB0cyB0byBhZGQgdGhlIHBlbmRpbmdRdWV1ZSBjaGFpbnMgYWdh
        aW4uIElmIHNvbWUgb2YgdGhlbSBlbmQgdXAKLy8gYmFjayBpbiB0aGUgcXVl
        dWUgYW5kIHJlc2NoZWR1bGUgaXMgdHJ1ZSwgc2NoZWR1bGVzIGEgdGltZW91
        dCB0byB0cnkKLy8gYWdhaW4uCkVtYmVyLmZsdXNoUGVuZGluZ0NoYWlucyA9
        IGZ1bmN0aW9uKCkgewogIGlmIChwZW5kaW5nUXVldWUubGVuZ3RoID09PSAw
        KSB7IHJldHVybjsgfSAvLyBub3RoaW5nIHRvIGRvCgogIHZhciBxdWV1ZSA9
        IHBlbmRpbmdRdWV1ZTsKICBwZW5kaW5nUXVldWUgPSBbXTsKCiAgZm9yRWFj
        aC5jYWxsKHF1ZXVlLCBmdW5jdGlvbihxKSB7IHFbMF0uYWRkKHFbMV0pOyB9
        KTsKCiAgd2FybignV2F0Y2hpbmcgYW4gdW5kZWZpbmVkIGdsb2JhbCwgRW1i
        ZXIgZXhwZWN0cyB3YXRjaGVkIGdsb2JhbHMgdG8gYmUgc2V0dXAgYnkgdGhl
        IHRpbWUgdGhlIHJ1biBsb29wIGlzIGZsdXNoZWQsIGNoZWNrIGZvciB0eXBv
        cycsIHBlbmRpbmdRdWV1ZS5sZW5ndGggPT09IDApOwp9OwoKCmZ1bmN0aW9u
        IGFkZENoYWluV2F0Y2hlcihvYmosIGtleU5hbWUsIG5vZGUpIHsKICBpZiAo
        IW9iaiB8fCAoJ29iamVjdCcgIT09IHR5cGVvZiBvYmopKSB7IHJldHVybjsg
        fSAvLyBub3RoaW5nIHRvIGRvCgogIHZhciBtID0gbWV0YUZvcihvYmopLCBu
        b2RlcyA9IG0uY2hhaW5XYXRjaGVyczsKCiAgaWYgKCFtLmhhc093blByb3Bl
        cnR5KCdjaGFpbldhdGNoZXJzJykpIHsKICAgIG5vZGVzID0gbS5jaGFpbldh
        dGNoZXJzID0ge307CiAgfQoKICBpZiAoIW5vZGVzW2tleU5hbWVdKSB7IG5v
        ZGVzW2tleU5hbWVdID0gW107IH0KICBub2Rlc1trZXlOYW1lXS5wdXNoKG5v
        ZGUpOwogIHdhdGNoS2V5KG9iaiwga2V5TmFtZSk7Cn0KCnZhciByZW1vdmVD
        aGFpbldhdGNoZXIgPSBFbWJlci5yZW1vdmVDaGFpbldhdGNoZXIgPSBmdW5j
        dGlvbihvYmosIGtleU5hbWUsIG5vZGUpIHsKICBpZiAoIW9iaiB8fCAnb2Jq
        ZWN0JyAhPT0gdHlwZW9mIG9iaikgeyByZXR1cm47IH0gLy8gbm90aGluZyB0
        byBkbwoKICB2YXIgbSA9IG1ldGFGb3Iob2JqLCBmYWxzZSk7CiAgaWYgKCFt
        Lmhhc093blByb3BlcnR5KCdjaGFpbldhdGNoZXJzJykpIHsgcmV0dXJuOyB9
        IC8vIG5vdGhpbmcgdG8gZG8KCiAgdmFyIG5vZGVzID0gbS5jaGFpbldhdGNo
        ZXJzOwoKICBpZiAobm9kZXNba2V5TmFtZV0pIHsKICAgIG5vZGVzID0gbm9k
        ZXNba2V5TmFtZV07CiAgICBmb3IgKHZhciBpID0gMCwgbCA9IG5vZGVzLmxl
        bmd0aDsgaSA8IGw7IGkrKykgewogICAgICBpZiAobm9kZXNbaV0gPT09IG5v
        ZGUpIHsgbm9kZXMuc3BsaWNlKGksIDEpOyB9CiAgICB9CiAgfQogIHVud2F0
        Y2hLZXkob2JqLCBrZXlOYW1lKTsKfTsKCi8vIEEgQ2hhaW5Ob2RlIHdhdGNo
        ZXMgYSBzaW5nbGUga2V5IG9uIGFuIG9iamVjdC4gSWYgeW91IHByb3ZpZGUg
        YSBzdGFydGluZwovLyB2YWx1ZSBmb3IgdGhlIGtleSB0aGVuIHRoZSBub2Rl
        IHdvbid0IGFjdHVhbGx5IHdhdGNoIGl0LiBGb3IgYSByb290IG5vZGUKLy8g
        cGFzcyBudWxsIGZvciBwYXJlbnQgYW5kIGtleSBhbmQgb2JqZWN0IGZvciB2
        YWx1ZS4KdmFyIENoYWluTm9kZSA9IEVtYmVyLl9DaGFpbk5vZGUgPSBmdW5j
        dGlvbihwYXJlbnQsIGtleSwgdmFsdWUpIHsKICB0aGlzLl9wYXJlbnQgPSBw
        YXJlbnQ7CiAgdGhpcy5fa2V5ICAgID0ga2V5OwoKICAvLyBfd2F0Y2hpbmcg
        aXMgdHJ1ZSB3aGVuIGNhbGxpbmcgZ2V0KHRoaXMuX3BhcmVudCwgdGhpcy5f
        a2V5KSB3aWxsCiAgLy8gcmV0dXJuIHRoZSB2YWx1ZSBvZiB0aGlzIG5vZGUu
        CiAgLy8KICAvLyBJdCBpcyBmYWxzZSBmb3IgdGhlIHJvb3Qgb2YgYSBjaGFp
        biAoYmVjYXVzZSB3ZSBoYXZlIG5vIHBhcmVudCkKICAvLyBhbmQgZm9yIGds
        b2JhbCBwYXRocyAoYmVjYXVzZSB0aGUgcGFyZW50IG5vZGUgaXMgdGhlIG9i
        amVjdCB3aXRoCiAgLy8gdGhlIG9ic2VydmVyIG9uIGl0KQogIHRoaXMuX3dh
        dGNoaW5nID0gdmFsdWU9PT11bmRlZmluZWQ7CgogIHRoaXMuX3ZhbHVlICA9
        IHZhbHVlOwogIHRoaXMuX3BhdGhzID0ge307CiAgaWYgKHRoaXMuX3dhdGNo
        aW5nKSB7CiAgICB0aGlzLl9vYmplY3QgPSBwYXJlbnQudmFsdWUoKTsKICAg
        IGlmICh0aGlzLl9vYmplY3QpIHsgYWRkQ2hhaW5XYXRjaGVyKHRoaXMuX29i
        amVjdCwgdGhpcy5fa2V5LCB0aGlzKTsgfQogIH0KCiAgLy8gU3BlY2lhbC1j
        YXNlOiB0aGUgRWFjaFByb3h5IHJlbGllcyBvbiBpbW1lZGlhdGUgZXZhbHVh
        dGlvbiB0bwogIC8vIGVzdGFibGlzaCBpdHMgb2JzZXJ2ZXJzLgogIC8vCiAg
        Ly8gVE9ETzogUmVwbGFjZSB0aGlzIHdpdGggYW4gZWZmaWNpZW50IGNhbGxi
        YWNrIHRoYXQgdGhlIEVhY2hQcm94eQogIC8vIGNhbiBpbXBsZW1lbnQuCiAg
        aWYgKHRoaXMuX3BhcmVudCAmJiB0aGlzLl9wYXJlbnQuX2tleSA9PT0gJ0Bl
        YWNoJykgewogICAgdGhpcy52YWx1ZSgpOwogIH0KfTsKCnZhciBDaGFpbk5v
        ZGVQcm90b3R5cGUgPSBDaGFpbk5vZGUucHJvdG90eXBlOwoKZnVuY3Rpb24g
        bGF6eUdldChvYmosIGtleSkgewogIGlmICghb2JqKSByZXR1cm4gdW5kZWZp
        bmVkOwoKICB2YXIgbWV0YSA9IG1ldGFGb3Iob2JqLCBmYWxzZSk7CiAgLy8g
        Y2hlY2sgaWYgb2JqZWN0IG1lYW50IG9ubHkgdG8gYmUgYSBwcm90b3R5cGUK
        ICBpZiAobWV0YS5wcm90byA9PT0gb2JqKSByZXR1cm4gdW5kZWZpbmVkOwoK
        ICBpZiAoa2V5ID09PSAiQGVhY2giKSByZXR1cm4gZ2V0KG9iaiwga2V5KTsK
        CiAgLy8gaWYgYSBDUCBvbmx5IHJldHVybiBjYWNoZWQgdmFsdWUKICB2YXIg
        ZGVzYyA9IG1ldGEuZGVzY3Nba2V5XTsKICBpZiAoZGVzYyAmJiBkZXNjLl9j
        YWNoZWFibGUpIHsKICAgIGlmIChrZXkgaW4gbWV0YS5jYWNoZSkgewogICAg
        ICByZXR1cm4gbWV0YS5jYWNoZVtrZXldOwogICAgfSBlbHNlIHsKICAgICAg
        cmV0dXJuIHVuZGVmaW5lZDsKICAgIH0KICB9CgogIHJldHVybiBnZXQob2Jq
        LCBrZXkpOwp9CgpDaGFpbk5vZGVQcm90b3R5cGUudmFsdWUgPSBmdW5jdGlv
        bigpIHsKICBpZiAodGhpcy5fdmFsdWUgPT09IHVuZGVmaW5lZCAmJiB0aGlz
        Ll93YXRjaGluZykgewogICAgdmFyIG9iaiA9IHRoaXMuX3BhcmVudC52YWx1
        ZSgpOwogICAgdGhpcy5fdmFsdWUgPSBsYXp5R2V0KG9iaiwgdGhpcy5fa2V5
        KTsKICB9CiAgcmV0dXJuIHRoaXMuX3ZhbHVlOwp9OwoKQ2hhaW5Ob2RlUHJv
        dG90eXBlLmRlc3Ryb3kgPSBmdW5jdGlvbigpIHsKICBpZiAodGhpcy5fd2F0
        Y2hpbmcpIHsKICAgIHZhciBvYmogPSB0aGlzLl9vYmplY3Q7CiAgICBpZiAo
        b2JqKSB7IHJlbW92ZUNoYWluV2F0Y2hlcihvYmosIHRoaXMuX2tleSwgdGhp
        cyk7IH0KICAgIHRoaXMuX3dhdGNoaW5nID0gZmFsc2U7IC8vIHNvIGZ1dHVy
        ZSBjYWxscyBkbyBub3RoaW5nCiAgfQp9OwoKLy8gY29waWVzIGEgdG9wIGxl
        dmVsIG9iamVjdCBvbmx5CkNoYWluTm9kZVByb3RvdHlwZS5jb3B5ID0gZnVu
        Y3Rpb24ob2JqKSB7CiAgdmFyIHJldCA9IG5ldyBDaGFpbk5vZGUobnVsbCwg
        bnVsbCwgb2JqKSwKICAgICAgcGF0aHMgPSB0aGlzLl9wYXRocywgcGF0aDsK
        ICBmb3IgKHBhdGggaW4gcGF0aHMpIHsKICAgIGlmIChwYXRoc1twYXRoXSA8
        PSAwKSB7IGNvbnRpbnVlOyB9IC8vIHRoaXMgY2hlY2sgd2lsbCBhbHNvIGNh
        dGNoIG5vbi1udW1iZXIgdmFscy4KICAgIHJldC5hZGQocGF0aCk7CiAgfQog
        IHJldHVybiByZXQ7Cn07CgovLyBjYWxsZWQgb24gdGhlIHJvb3Qgbm9kZSBv
        ZiBhIGNoYWluIHRvIHNldHVwIHdhdGNoZXJzIG9uIHRoZSBzcGVjaWZpZWQK
        Ly8gcGF0aC4KQ2hhaW5Ob2RlUHJvdG90eXBlLmFkZCA9IGZ1bmN0aW9uKHBh
        dGgpIHsKICB2YXIgb2JqLCB0dXBsZSwga2V5LCBzcmMsIHBhdGhzOwoKICBw
        YXRocyA9IHRoaXMuX3BhdGhzOwogIHBhdGhzW3BhdGhdID0gKHBhdGhzW3Bh
        dGhdIHx8IDApICsgMTsKCiAgb2JqID0gdGhpcy52YWx1ZSgpOwogIHR1cGxl
        ID0gbm9ybWFsaXplVHVwbGUob2JqLCBwYXRoKTsKCiAgLy8gdGhlIHBhdGgg
        d2FzIGEgbG9jYWwgcGF0aAogIGlmICh0dXBsZVswXSAmJiB0dXBsZVswXSA9
        PT0gb2JqKSB7CiAgICBwYXRoID0gdHVwbGVbMV07CiAgICBrZXkgID0gZmly
        c3RLZXkocGF0aCk7CiAgICBwYXRoID0gcGF0aC5zbGljZShrZXkubGVuZ3Ro
        KzEpOwoKICAvLyBnbG9iYWwgcGF0aCwgYnV0IG9iamVjdCBkb2VzIG5vdCBl
        eGlzdCB5ZXQuCiAgLy8gcHV0IGludG8gYSBxdWV1ZSBhbmQgdHJ5IHRvIGNv
        bm5lY3QgbGF0ZXIuCiAgfSBlbHNlIGlmICghdHVwbGVbMF0pIHsKICAgIHBl
        bmRpbmdRdWV1ZS5wdXNoKFt0aGlzLCBwYXRoXSk7CiAgICB0dXBsZS5sZW5n
        dGggPSAwOwogICAgcmV0dXJuOwoKICAvLyBnbG9iYWwgcGF0aCwgYW5kIG9i
        amVjdCBhbHJlYWR5IGV4aXN0cwogIH0gZWxzZSB7CiAgICBzcmMgID0gdHVw
        bGVbMF07CiAgICBrZXkgID0gcGF0aC5zbGljZSgwLCAwLSh0dXBsZVsxXS5s
        ZW5ndGgrMSkpOwogICAgcGF0aCA9IHR1cGxlWzFdOwogIH0KCiAgdHVwbGUu
        bGVuZ3RoID0gMDsKICB0aGlzLmNoYWluKGtleSwgcGF0aCwgc3JjKTsKfTsK
        Ci8vIGNhbGxlZCBvbiB0aGUgcm9vdCBub2RlIG9mIGEgY2hhaW4gdG8gdGVh
        cmRvd24gd2F0Y2hlciBvbiB0aGUgc3BlY2lmaWVkCi8vIHBhdGgKQ2hhaW5O
        b2RlUHJvdG90eXBlLnJlbW92ZSA9IGZ1bmN0aW9uKHBhdGgpIHsKICB2YXIg
        b2JqLCB0dXBsZSwga2V5LCBzcmMsIHBhdGhzOwoKICBwYXRocyA9IHRoaXMu
        X3BhdGhzOwogIGlmIChwYXRoc1twYXRoXSA+IDApIHsgcGF0aHNbcGF0aF0t
        LTsgfQoKICBvYmogPSB0aGlzLnZhbHVlKCk7CiAgdHVwbGUgPSBub3JtYWxp
        emVUdXBsZShvYmosIHBhdGgpOwogIGlmICh0dXBsZVswXSA9PT0gb2JqKSB7
        CiAgICBwYXRoID0gdHVwbGVbMV07CiAgICBrZXkgID0gZmlyc3RLZXkocGF0
        aCk7CiAgICBwYXRoID0gcGF0aC5zbGljZShrZXkubGVuZ3RoKzEpOwogIH0g
        ZWxzZSB7CiAgICBzcmMgID0gdHVwbGVbMF07CiAgICBrZXkgID0gcGF0aC5z
        bGljZSgwLCAwLSh0dXBsZVsxXS5sZW5ndGgrMSkpOwogICAgcGF0aCA9IHR1
        cGxlWzFdOwogIH0KCiAgdHVwbGUubGVuZ3RoID0gMDsKICB0aGlzLnVuY2hh
        aW4oa2V5LCBwYXRoKTsKfTsKCkNoYWluTm9kZVByb3RvdHlwZS5jb3VudCA9
        IDA7CgpDaGFpbk5vZGVQcm90b3R5cGUuY2hhaW4gPSBmdW5jdGlvbihrZXks
        IHBhdGgsIHNyYykgewogIHZhciBjaGFpbnMgPSB0aGlzLl9jaGFpbnMsIG5v
        ZGU7CiAgaWYgKCFjaGFpbnMpIHsgY2hhaW5zID0gdGhpcy5fY2hhaW5zID0g
        e307IH0KCiAgbm9kZSA9IGNoYWluc1trZXldOwogIGlmICghbm9kZSkgeyBu
        b2RlID0gY2hhaW5zW2tleV0gPSBuZXcgQ2hhaW5Ob2RlKHRoaXMsIGtleSwg
        c3JjKTsgfQogIG5vZGUuY291bnQrKzsgLy8gY291bnQgY2hhaW5zLi4uCgog
        IC8vIGNoYWluIHJlc3Qgb2YgcGF0aCBpZiB0aGVyZSBpcyBvbmUKICBpZiAo
        cGF0aCAmJiBwYXRoLmxlbmd0aD4wKSB7CiAgICBrZXkgPSBmaXJzdEtleShw
        YXRoKTsKICAgIHBhdGggPSBwYXRoLnNsaWNlKGtleS5sZW5ndGgrMSk7CiAg
        ICBub2RlLmNoYWluKGtleSwgcGF0aCk7IC8vIE5PVEU6IG5vIHNyYyBtZWFu
        cyBpdCB3aWxsIG9ic2VydmUgY2hhbmdlcy4uLgogIH0KfTsKCkNoYWluTm9k
        ZVByb3RvdHlwZS51bmNoYWluID0gZnVuY3Rpb24oa2V5LCBwYXRoKSB7CiAg
        dmFyIGNoYWlucyA9IHRoaXMuX2NoYWlucywgbm9kZSA9IGNoYWluc1trZXld
        OwoKICAvLyB1bmNoYWluIHJlc3Qgb2YgcGF0aCBmaXJzdC4uLgogIGlmIChw
        YXRoICYmIHBhdGgubGVuZ3RoPjEpIHsKICAgIGtleSAgPSBmaXJzdEtleShw
        YXRoKTsKICAgIHBhdGggPSBwYXRoLnNsaWNlKGtleS5sZW5ndGgrMSk7CiAg
        ICBub2RlLnVuY2hhaW4oa2V5LCBwYXRoKTsKICB9CgogIC8vIGRlbGV0ZSBu
        b2RlIGlmIG5lZWRlZC4KICBub2RlLmNvdW50LS07CiAgaWYgKG5vZGUuY291
        bnQ8PTApIHsKICAgIGRlbGV0ZSBjaGFpbnNbbm9kZS5fa2V5XTsKICAgIG5v
        ZGUuZGVzdHJveSgpOwogIH0KCn07CgpDaGFpbk5vZGVQcm90b3R5cGUud2ls
        bENoYW5nZSA9IGZ1bmN0aW9uKGV2ZW50cykgewogIHZhciBjaGFpbnMgPSB0
        aGlzLl9jaGFpbnM7CiAgaWYgKGNoYWlucykgewogICAgZm9yKHZhciBrZXkg
        aW4gY2hhaW5zKSB7CiAgICAgIGlmICghY2hhaW5zLmhhc093blByb3BlcnR5
        KGtleSkpIHsgY29udGludWU7IH0KICAgICAgY2hhaW5zW2tleV0ud2lsbENo
        YW5nZShldmVudHMpOwogICAgfQogIH0KCiAgaWYgKHRoaXMuX3BhcmVudCkg
        eyB0aGlzLl9wYXJlbnQuY2hhaW5XaWxsQ2hhbmdlKHRoaXMsIHRoaXMuX2tl
        eSwgMSwgZXZlbnRzKTsgfQp9OwoKQ2hhaW5Ob2RlUHJvdG90eXBlLmNoYWlu
        V2lsbENoYW5nZSA9IGZ1bmN0aW9uKGNoYWluLCBwYXRoLCBkZXB0aCwgZXZl
        bnRzKSB7CiAgaWYgKHRoaXMuX2tleSkgeyBwYXRoID0gdGhpcy5fa2V5ICsg
        Jy4nICsgcGF0aDsgfQoKICBpZiAodGhpcy5fcGFyZW50KSB7CiAgICB0aGlz
        Ll9wYXJlbnQuY2hhaW5XaWxsQ2hhbmdlKHRoaXMsIHBhdGgsIGRlcHRoKzEs
        IGV2ZW50cyk7CiAgfSBlbHNlIHsKICAgIGlmIChkZXB0aCA+IDEpIHsKICAg
        ICAgZXZlbnRzLnB1c2godGhpcy52YWx1ZSgpLCBwYXRoKTsKICAgIH0KICAg
        IHBhdGggPSAndGhpcy4nICsgcGF0aDsKICAgIGlmICh0aGlzLl9wYXRoc1tw
        YXRoXSA+IDApIHsKICAgICAgZXZlbnRzLnB1c2godGhpcy52YWx1ZSgpLCBw
        YXRoKTsKICAgIH0KICB9Cn07CgpDaGFpbk5vZGVQcm90b3R5cGUuY2hhaW5E
        aWRDaGFuZ2UgPSBmdW5jdGlvbihjaGFpbiwgcGF0aCwgZGVwdGgsIGV2ZW50
        cykgewogIGlmICh0aGlzLl9rZXkpIHsgcGF0aCA9IHRoaXMuX2tleSArICcu
        JyArIHBhdGg7IH0KICBpZiAodGhpcy5fcGFyZW50KSB7CiAgICB0aGlzLl9w
        YXJlbnQuY2hhaW5EaWRDaGFuZ2UodGhpcywgcGF0aCwgZGVwdGgrMSwgZXZl
        bnRzKTsKICB9IGVsc2UgewogICAgaWYgKGRlcHRoID4gMSkgewogICAgICBl
        dmVudHMucHVzaCh0aGlzLnZhbHVlKCksIHBhdGgpOwogICAgfQogICAgcGF0
        aCA9ICd0aGlzLicgKyBwYXRoOwogICAgaWYgKHRoaXMuX3BhdGhzW3BhdGhd
        ID4gMCkgewogICAgICBldmVudHMucHVzaCh0aGlzLnZhbHVlKCksIHBhdGgp
        OwogICAgfQogIH0KfTsKCkNoYWluTm9kZVByb3RvdHlwZS5kaWRDaGFuZ2Ug
        PSBmdW5jdGlvbihldmVudHMpIHsKICAvLyBpbnZhbGlkYXRlIG15IG93biB2
        YWx1ZSBmaXJzdC4KICBpZiAodGhpcy5fd2F0Y2hpbmcpIHsKICAgIHZhciBv
        YmogPSB0aGlzLl9wYXJlbnQudmFsdWUoKTsKICAgIGlmIChvYmogIT09IHRo
        aXMuX29iamVjdCkgewogICAgICByZW1vdmVDaGFpbldhdGNoZXIodGhpcy5f
        b2JqZWN0LCB0aGlzLl9rZXksIHRoaXMpOwogICAgICB0aGlzLl9vYmplY3Qg
        PSBvYmo7CiAgICAgIGFkZENoYWluV2F0Y2hlcihvYmosIHRoaXMuX2tleSwg
        dGhpcyk7CiAgICB9CiAgICB0aGlzLl92YWx1ZSAgPSB1bmRlZmluZWQ7Cgog
        ICAgLy8gU3BlY2lhbC1jYXNlOiB0aGUgRWFjaFByb3h5IHJlbGllcyBvbiBp
        bW1lZGlhdGUgZXZhbHVhdGlvbiB0bwogICAgLy8gZXN0YWJsaXNoIGl0cyBv
        YnNlcnZlcnMuCiAgICBpZiAodGhpcy5fcGFyZW50ICYmIHRoaXMuX3BhcmVu
        dC5fa2V5ID09PSAnQGVhY2gnKQogICAgICB0aGlzLnZhbHVlKCk7CiAgfQoK
        ICAvLyB0aGVuIG5vdGlmeSBjaGFpbnMuLi4KICB2YXIgY2hhaW5zID0gdGhp
        cy5fY2hhaW5zOwogIGlmIChjaGFpbnMpIHsKICAgIGZvcih2YXIga2V5IGlu
        IGNoYWlucykgewogICAgICBpZiAoIWNoYWlucy5oYXNPd25Qcm9wZXJ0eShr
        ZXkpKSB7IGNvbnRpbnVlOyB9CiAgICAgIGNoYWluc1trZXldLmRpZENoYW5n
        ZShldmVudHMpOwogICAgfQogIH0KCiAgLy8gaWYgbm8gZXZlbnRzIGFyZSBw
        YXNzZWQgaW4gdGhlbiB3ZSBvbmx5IGNhcmUgYWJvdXQgdGhlIGFib3ZlIHdp
        cmluZyB1cGRhdGUKICBpZiAoZXZlbnRzID09PSBudWxsKSB7IHJldHVybjsg
        fQoKICAvLyBhbmQgZmluYWxseSB0ZWxsIHBhcmVudCBhYm91dCBteSBwYXRo
        IGNoYW5naW5nLi4uCiAgaWYgKHRoaXMuX3BhcmVudCkgeyB0aGlzLl9wYXJl
        bnQuY2hhaW5EaWRDaGFuZ2UodGhpcywgdGhpcy5fa2V5LCAxLCBldmVudHMp
        OyB9Cn07CgpFbWJlci5maW5pc2hDaGFpbnMgPSBmdW5jdGlvbihvYmopIHsK
        ICB2YXIgbSA9IG1ldGFGb3Iob2JqLCBmYWxzZSksIGNoYWlucyA9IG0uY2hh
        aW5zOwogIGlmIChjaGFpbnMpIHsKICAgIGlmIChjaGFpbnMudmFsdWUoKSAh
        PT0gb2JqKSB7CiAgICAgIG0uY2hhaW5zID0gY2hhaW5zID0gY2hhaW5zLmNv
        cHkob2JqKTsKICAgIH0KICAgIGNoYWlucy5kaWRDaGFuZ2UobnVsbCk7CiAg
        fQp9OwoKfSkoKTsKCgoKKGZ1bmN0aW9uKCkgewp2YXIgbWV0YUZvciA9IEVt
        YmVyLm1ldGEsIC8vIHV0aWxzLmpzCiAgICB0eXBlT2YgPSBFbWJlci50eXBl
        T2YsIC8vIHV0aWxzLmpzCiAgICBDaGFpbk5vZGUgPSBFbWJlci5fQ2hhaW5O
        b2RlOyAvLyBjaGFpbnMuanMKCi8vIGdldCB0aGUgY2hhaW5zIGZvciB0aGUg
        Y3VycmVudCBvYmplY3QuIElmIHRoZSBjdXJyZW50IG9iamVjdCBoYXMKLy8g
        Y2hhaW5zIGluaGVyaXRlZCBmcm9tIHRoZSBwcm90byB0aGV5IHdpbGwgYmUg
        Y2xvbmVkIGFuZCByZWNvbmZpZ3VyZWQgZm9yCi8vIHRoZSBjdXJyZW50IG9i
        amVjdC4KZnVuY3Rpb24gY2hhaW5zRm9yKG9iaikgewogIHZhciBtID0gbWV0
        YUZvcihvYmopLCByZXQgPSBtLmNoYWluczsKICBpZiAoIXJldCkgewogICAg
        cmV0ID0gbS5jaGFpbnMgPSBuZXcgQ2hhaW5Ob2RlKG51bGwsIG51bGwsIG9i
        aik7CiAgfSBlbHNlIGlmIChyZXQudmFsdWUoKSAhPT0gb2JqKSB7CiAgICBy
        ZXQgPSBtLmNoYWlucyA9IHJldC5jb3B5KG9iaik7CiAgfQogIHJldHVybiBy
        ZXQ7Cn0KCkVtYmVyLndhdGNoUGF0aCA9IGZ1bmN0aW9uKG9iaiwga2V5UGF0
        aCkgewogIC8vIGNhbid0IHdhdGNoIGxlbmd0aCBvbiBBcnJheSAtIGl0IGlz
        IHNwZWNpYWwuLi4KICBpZiAoa2V5UGF0aCA9PT0gJ2xlbmd0aCcgJiYgdHlw
        ZU9mKG9iaikgPT09ICdhcnJheScpIHsgcmV0dXJuOyB9CgogIHZhciBtID0g
        bWV0YUZvcihvYmopLCB3YXRjaGluZyA9IG0ud2F0Y2hpbmc7CgogIGlmICgh
        d2F0Y2hpbmdba2V5UGF0aF0pIHsgLy8gYWN0aXZhdGUgd2F0Y2hpbmcgZmly
        c3QgdGltZQogICAgd2F0Y2hpbmdba2V5UGF0aF0gPSAxOwogICAgY2hhaW5z
        Rm9yKG9iaikuYWRkKGtleVBhdGgpOwogIH0gZWxzZSB7CiAgICB3YXRjaGlu
        Z1trZXlQYXRoXSA9ICh3YXRjaGluZ1trZXlQYXRoXSB8fCAwKSArIDE7CiAg
        fQp9OwoKRW1iZXIudW53YXRjaFBhdGggPSBmdW5jdGlvbihvYmosIGtleVBh
        dGgpIHsKICB2YXIgbSA9IG1ldGFGb3Iob2JqKSwgd2F0Y2hpbmcgPSBtLndh
        dGNoaW5nOwoKICBpZiAod2F0Y2hpbmdba2V5UGF0aF0gPT09IDEpIHsKICAg
        IHdhdGNoaW5nW2tleVBhdGhdID0gMDsKICAgIGNoYWluc0ZvcihvYmopLnJl
        bW92ZShrZXlQYXRoKTsKICB9IGVsc2UgaWYgKHdhdGNoaW5nW2tleVBhdGhd
        ID4gMSkgewogICAgd2F0Y2hpbmdba2V5UGF0aF0tLTsKICB9Cn07Cn0pKCk7
        CgoKCihmdW5jdGlvbigpIHsKLyoqCkBtb2R1bGUgZW1iZXItbWV0YWwKKi8K
        CnZhciBtZXRhRm9yID0gRW1iZXIubWV0YSwgLy8gdXRpbHMuanMKICAgIEdV
        SURfS0VZID0gRW1iZXIuR1VJRF9LRVksIC8vIHV0aWxzLmpzCiAgICBNRVRB
        X0tFWSA9IEVtYmVyLk1FVEFfS0VZLCAvLyB1dGlscy5qcwogICAgcmVtb3Zl
        Q2hhaW5XYXRjaGVyID0gRW1iZXIucmVtb3ZlQ2hhaW5XYXRjaGVyLAogICAg
        d2F0Y2hLZXkgPSBFbWJlci53YXRjaEtleSwgLy8gd2F0Y2hfa2V5LmpzCiAg
        ICB1bndhdGNoS2V5ID0gRW1iZXIudW53YXRjaEtleSwKICAgIHdhdGNoUGF0
        aCA9IEVtYmVyLndhdGNoUGF0aCwgLy8gd2F0Y2hfcGF0aC5qcwogICAgdW53
        YXRjaFBhdGggPSBFbWJlci51bndhdGNoUGF0aCwKICAgIHR5cGVPZiA9IEVt
        YmVyLnR5cGVPZiwgLy8gdXRpbHMuanMKICAgIGdlbmVyYXRlR3VpZCA9IEVt
        YmVyLmdlbmVyYXRlR3VpZCwKICAgIElTX1BBVEggPSAvW1wuXCpdLzsKCi8v
        IHJldHVybnMgdHJ1ZSBpZiB0aGUgcGFzc2VkIHBhdGggaXMganVzdCBhIGtl
        eU5hbWUKZnVuY3Rpb24gaXNLZXlOYW1lKHBhdGgpIHsKICByZXR1cm4gcGF0
        aD09PScqJyB8fCAhSVNfUEFUSC50ZXN0KHBhdGgpOwp9CgovKioKICBAcHJp
        dmF0ZQoKICBTdGFydHMgd2F0Y2hpbmcgYSBwcm9wZXJ0eSBvbiBhbiBvYmpl
        Y3QuIFdoZW5ldmVyIHRoZSBwcm9wZXJ0eSBjaGFuZ2VzLAogIGludm9rZXMg
        YEVtYmVyLnByb3BlcnR5V2lsbENoYW5nZWAgYW5kIGBFbWJlci5wcm9wZXJ0
        eURpZENoYW5nZWAuIFRoaXMgaXMgdGhlCiAgcHJpbWl0aXZlIHVzZWQgYnkg
        b2JzZXJ2ZXJzIGFuZCBkZXBlbmRlbnQga2V5czsgdXN1YWxseSB5b3Ugd2ls
        bCBuZXZlciBjYWxsCiAgdGhpcyBtZXRob2QgZGlyZWN0bHkgYnV0IGluc3Rl
        YWQgdXNlIGhpZ2hlciBsZXZlbCBtZXRob2RzIGxpa2UKICBgRW1iZXIuYWRk
        T2JzZXJ2ZXIoKWAKCiAgQG1ldGhvZCB3YXRjaAogIEBmb3IgRW1iZXIKICBA
        cGFyYW0gb2JqCiAgQHBhcmFtIHtTdHJpbmd9IGtleU5hbWUKKi8KRW1iZXIu
        d2F0Y2ggPSBmdW5jdGlvbihvYmosIGtleVBhdGgpIHsKICAvLyBjYW4ndCB3
        YXRjaCBsZW5ndGggb24gQXJyYXkgLSBpdCBpcyBzcGVjaWFsLi4uCiAgaWYg
        KGtleVBhdGggPT09ICdsZW5ndGgnICYmIHR5cGVPZihvYmopID09PSAnYXJy
        YXknKSB7IHJldHVybjsgfQoKICBpZiAoaXNLZXlOYW1lKGtleVBhdGgpKSB7
        CiAgICB3YXRjaEtleShvYmosIGtleVBhdGgpOwogIH0gZWxzZSB7CiAgICB3
        YXRjaFBhdGgob2JqLCBrZXlQYXRoKTsKICB9Cn07CgpFbWJlci5pc1dhdGNo
        aW5nID0gZnVuY3Rpb24gaXNXYXRjaGluZyhvYmosIGtleSkgewogIHZhciBt
        ZXRhID0gb2JqW01FVEFfS0VZXTsKICByZXR1cm4gKG1ldGEgJiYgbWV0YS53
        YXRjaGluZ1trZXldKSA+IDA7Cn07CgpFbWJlci53YXRjaC5mbHVzaFBlbmRp
        bmcgPSBFbWJlci5mbHVzaFBlbmRpbmdDaGFpbnM7CgpFbWJlci51bndhdGNo
        ID0gZnVuY3Rpb24ob2JqLCBrZXlQYXRoKSB7CiAgLy8gY2FuJ3Qgd2F0Y2gg
        bGVuZ3RoIG9uIEFycmF5IC0gaXQgaXMgc3BlY2lhbC4uLgogIGlmIChrZXlQ
        YXRoID09PSAnbGVuZ3RoJyAmJiB0eXBlT2Yob2JqKSA9PT0gJ2FycmF5Jykg
        eyByZXR1cm47IH0KCiAgaWYgKGlzS2V5TmFtZShrZXlQYXRoKSkgewogICAg
        dW53YXRjaEtleShvYmosIGtleVBhdGgpOwogIH0gZWxzZSB7CiAgICB1bndh
        dGNoUGF0aChvYmosIGtleVBhdGgpOwogIH0KfTsKCi8qKgogIEBwcml2YXRl
        CgogIENhbGwgb24gYW4gb2JqZWN0IHdoZW4geW91IGZpcnN0IGJlZ2V0IGl0
        IGZyb20gYW5vdGhlciBvYmplY3QuIFRoaXMgd2lsbAogIHNldHVwIGFueSBj
        aGFpbmVkIHdhdGNoZXJzIG9uIHRoZSBvYmplY3QgaW5zdGFuY2UgYXMgbmVl
        ZGVkLiBUaGlzIG1ldGhvZCBpcwogIHNhZmUgdG8gY2FsbCBtdWx0aXBsZSB0
        aW1lcy4KCiAgQG1ldGhvZCByZXdhdGNoCiAgQGZvciBFbWJlcgogIEBwYXJh
        bSBvYmoKKi8KRW1iZXIucmV3YXRjaCA9IGZ1bmN0aW9uKG9iaikgewogIHZh
        ciBtID0gbWV0YUZvcihvYmosIGZhbHNlKSwgY2hhaW5zID0gbS5jaGFpbnM7
        CgogIC8vIG1ha2Ugc3VyZSB0aGUgb2JqZWN0IGhhcyBpdHMgb3duIGd1aWQu
        CiAgaWYgKEdVSURfS0VZIGluIG9iaiAmJiAhb2JqLmhhc093blByb3BlcnR5
        KEdVSURfS0VZKSkgewogICAgZ2VuZXJhdGVHdWlkKG9iaiwgJ2VtYmVyJyk7
        CiAgfQoKICAvLyBtYWtlIHN1cmUgYW55IGNoYWluZWQgd2F0Y2hlcnMgdXBk
        YXRlLgogIGlmIChjaGFpbnMgJiYgY2hhaW5zLnZhbHVlKCkgIT09IG9iaikg
        ewogICAgbS5jaGFpbnMgPSBjaGFpbnMuY29weShvYmopOwogIH0KfTsKCnZh
        ciBOT0RFX1NUQUNLID0gW107CgovKioKICBUZWFycyBkb3duIHRoZSBtZXRh
        IG9uIGFuIG9iamVjdCBzbyB0aGF0IGl0IGNhbiBiZSBnYXJiYWdlIGNvbGxl
        Y3RlZC4KICBNdWx0aXBsZSBjYWxscyB3aWxsIGhhdmUgbm8gZWZmZWN0LgoK
        ICBAbWV0aG9kIGRlc3Ryb3kKICBAZm9yIEVtYmVyCiAgQHBhcmFtIHtPYmpl
        Y3R9IG9iaiAgdGhlIG9iamVjdCB0byBkZXN0cm95CiAgQHJldHVybiB7dm9p
        ZH0KKi8KRW1iZXIuZGVzdHJveSA9IGZ1bmN0aW9uIChvYmopIHsKICB2YXIg
        bWV0YSA9IG9ialtNRVRBX0tFWV0sIG5vZGUsIG5vZGVzLCBrZXksIG5vZGVP
        YmplY3Q7CiAgaWYgKG1ldGEpIHsKICAgIG9ialtNRVRBX0tFWV0gPSBudWxs
        OwogICAgLy8gcmVtb3ZlIGNoYWluV2F0Y2hlcnMgdG8gcmVtb3ZlIGNpcmN1
        bGFyIHJlZmVyZW5jZXMgdGhhdCB3b3VsZCBwcmV2ZW50IEdDCiAgICBub2Rl
        ID0gbWV0YS5jaGFpbnM7CiAgICBpZiAobm9kZSkgewogICAgICBOT0RFX1NU
        QUNLLnB1c2gobm9kZSk7CiAgICAgIC8vIHByb2Nlc3MgdHJlZQogICAgICB3
        aGlsZSAoTk9ERV9TVEFDSy5sZW5ndGggPiAwKSB7CiAgICAgICAgbm9kZSA9
        IE5PREVfU1RBQ0sucG9wKCk7CiAgICAgICAgLy8gcHVzaCBjaGlsZHJlbgog
        ICAgICAgIG5vZGVzID0gbm9kZS5fY2hhaW5zOwogICAgICAgIGlmIChub2Rl
        cykgewogICAgICAgICAgZm9yIChrZXkgaW4gbm9kZXMpIHsKICAgICAgICAg
        ICAgaWYgKG5vZGVzLmhhc093blByb3BlcnR5KGtleSkpIHsKICAgICAgICAg
        ICAgICBOT0RFX1NUQUNLLnB1c2gobm9kZXNba2V5XSk7CiAgICAgICAgICAg
        IH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgLy8gcmVtb3ZlIGNo
        YWluV2F0Y2hlciBpbiBub2RlIG9iamVjdAogICAgICAgIGlmIChub2RlLl93
        YXRjaGluZykgewogICAgICAgICAgbm9kZU9iamVjdCA9IG5vZGUuX29iamVj
        dDsKICAgICAgICAgIGlmIChub2RlT2JqZWN0KSB7CiAgICAgICAgICAgIHJl
        bW92ZUNoYWluV2F0Y2hlcihub2RlT2JqZWN0LCBub2RlLl9rZXksIG5vZGUp
        OwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfQogIH0KfTsK
        Cn0pKCk7CgoKCihmdW5jdGlvbigpIHsKLyoqCkBtb2R1bGUgZW1iZXItbWV0
        YWwKKi8KCkVtYmVyLndhcm4oIlRoZSBDUF9ERUZBVUxUX0NBQ0hFQUJMRSBm
        bGFnIGhhcyBiZWVuIHJlbW92ZWQgYW5kIGNvbXB1dGVkIHByb3BlcnRpZXMg
        YXJlIGFsd2F5cyBjYWNoZWQgYnkgZGVmYXVsdC4gVXNlIGB2b2xhdGlsZWAg
        aWYgeW91IGRvbid0IHdhbnQgY2FjaGluZy4iLCBFbWJlci5FTlYuQ1BfREVG
        QVVMVF9DQUNIRUFCTEUgIT09IGZhbHNlKTsKCgp2YXIgZ2V0ID0gRW1iZXIu
        Z2V0LAogICAgc2V0ID0gRW1iZXIuc2V0LAogICAgbWV0YUZvciA9IEVtYmVy
        Lm1ldGEsCiAgICBhX3NsaWNlID0gW10uc2xpY2UsCiAgICBvX2NyZWF0ZSA9
        IEVtYmVyLmNyZWF0ZSwKICAgIE1FVEFfS0VZID0gRW1iZXIuTUVUQV9LRVks
        CiAgICB3YXRjaCA9IEVtYmVyLndhdGNoLAogICAgdW53YXRjaCA9IEVtYmVy
        LnVud2F0Y2g7CgovLyAuLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4u
        Li4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uCi8vIERFUEVOREVOVCBLRVlT
        Ci8vCgovLyBkYXRhIHN0cnVjdHVyZToKLy8gIG1ldGEuZGVwcyA9IHsKLy8g
        ICAnZGVwS2V5JzogewovLyAgICAgJ2tleU5hbWUnOiBjb3VudCwKLy8gICB9
        Ci8vICB9CgovKgogIFRoaXMgZnVuY3Rpb24gcmV0dXJucyBhIG1hcCBvZiB1
        bmlxdWUgZGVwZW5kZW5jaWVzIGZvciBhCiAgZ2l2ZW4gb2JqZWN0IGFuZCBr
        ZXkuCiovCmZ1bmN0aW9uIGtleXNGb3JEZXAoZGVwc01ldGEsIGRlcEtleSkg
        ewogIHZhciBrZXlzID0gZGVwc01ldGFbZGVwS2V5XTsKICBpZiAoIWtleXMp
        IHsKICAgIC8vIGlmIHRoZXJlIGFyZSBubyBkZXBlbmRlbmNpZXMgeWV0IGZv
        ciBhIHRoZSBnaXZlbiBrZXkKICAgIC8vIGNyZWF0ZSBhIG5ldyBlbXB0eSBs
        aXN0IG9mIGRlcGVuZGVuY2llcyBmb3IgdGhlIGtleQogICAga2V5cyA9IGRl
        cHNNZXRhW2RlcEtleV0gPSB7fTsKICB9IGVsc2UgaWYgKCFkZXBzTWV0YS5o
        YXNPd25Qcm9wZXJ0eShkZXBLZXkpKSB7CiAgICAvLyBvdGhlcndpc2UgaWYg
        dGhlIGRlcGVuZGVuY3kgbGlzdCBpcyBpbmhlcml0ZWQgZnJvbQogICAgLy8g
        YSBzdXBlcmNsYXNzLCBjbG9uZSB0aGUgaGFzaAogICAga2V5cyA9IGRlcHNN
        ZXRhW2RlcEtleV0gPSBvX2NyZWF0ZShrZXlzKTsKICB9CiAgcmV0dXJuIGtl
        eXM7Cn0KCmZ1bmN0aW9uIG1ldGFGb3JEZXBzKG1ldGEpIHsKICByZXR1cm4g
        a2V5c0ZvckRlcChtZXRhLCAnZGVwcycpOwp9CgpmdW5jdGlvbiBhZGREZXBl
        bmRlbnRLZXlzKGRlc2MsIG9iaiwga2V5TmFtZSwgbWV0YSkgewogIC8vIHRo
        ZSBkZXNjcmlwdG9yIGhhcyBhIGxpc3Qgb2YgZGVwZW5kZW50IGtleXMsIHNv
        CiAgLy8gYWRkIGFsbCBvZiBpdHMgZGVwZW5kZW50IGtleXMuCiAgdmFyIGRl
        cEtleXMgPSBkZXNjLl9kZXBlbmRlbnRLZXlzLCBkZXBzTWV0YSwgaWR4LCBs
        ZW4sIGRlcEtleSwga2V5czsKICBpZiAoIWRlcEtleXMpIHJldHVybjsKCiAg
        ZGVwc01ldGEgPSBtZXRhRm9yRGVwcyhtZXRhKTsKCiAgZm9yKGlkeCA9IDAs
        IGxlbiA9IGRlcEtleXMubGVuZ3RoOyBpZHggPCBsZW47IGlkeCsrKSB7CiAg
        ICBkZXBLZXkgPSBkZXBLZXlzW2lkeF07CiAgICAvLyBMb29rdXAga2V5cyBt
        ZXRhIGZvciBkZXBLZXkKICAgIGtleXMgPSBrZXlzRm9yRGVwKGRlcHNNZXRh
        LCBkZXBLZXkpOwogICAgLy8gSW5jcmVtZW50IHRoZSBudW1iZXIgb2YgdGlt
        ZXMgZGVwS2V5IGRlcGVuZHMgb24ga2V5TmFtZS4KICAgIGtleXNba2V5TmFt
        ZV0gPSAoa2V5c1trZXlOYW1lXSB8fCAwKSArIDE7CiAgICAvLyBXYXRjaCB0
        aGUgZGVwS2V5CiAgICB3YXRjaChvYmosIGRlcEtleSk7CiAgfQp9CgpmdW5j
        dGlvbiByZW1vdmVEZXBlbmRlbnRLZXlzKGRlc2MsIG9iaiwga2V5TmFtZSwg
        bWV0YSkgewogIC8vIHRoZSBkZXNjcmlwdG9yIGhhcyBhIGxpc3Qgb2YgZGVw
        ZW5kZW50IGtleXMsIHNvCiAgLy8gYWRkIGFsbCBvZiBpdHMgZGVwZW5kZW50
        IGtleXMuCiAgdmFyIGRlcEtleXMgPSBkZXNjLl9kZXBlbmRlbnRLZXlzLCBk
        ZXBzTWV0YSwgaWR4LCBsZW4sIGRlcEtleSwga2V5czsKICBpZiAoIWRlcEtl
        eXMpIHJldHVybjsKCiAgZGVwc01ldGEgPSBtZXRhRm9yRGVwcyhtZXRhKTsK
        CiAgZm9yKGlkeCA9IDAsIGxlbiA9IGRlcEtleXMubGVuZ3RoOyBpZHggPCBs
        ZW47IGlkeCsrKSB7CiAgICBkZXBLZXkgPSBkZXBLZXlzW2lkeF07CiAgICAv
        LyBMb29rdXAga2V5cyBtZXRhIGZvciBkZXBLZXkKICAgIGtleXMgPSBrZXlz
        Rm9yRGVwKGRlcHNNZXRhLCBkZXBLZXkpOwogICAgLy8gSW5jcmVtZW50IHRo
        ZSBudW1iZXIgb2YgdGltZXMgZGVwS2V5IGRlcGVuZHMgb24ga2V5TmFtZS4K
        ICAgIGtleXNba2V5TmFtZV0gPSAoa2V5c1trZXlOYW1lXSB8fCAwKSAtIDE7
        CiAgICAvLyBXYXRjaCB0aGUgZGVwS2V5CiAgICB1bndhdGNoKG9iaiwgZGVw
        S2V5KTsKICB9Cn0KCi8vIC4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4u
        Li4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4KLy8gQ09NUFVURUQgUFJP
        UEVSVFkKLy8KCi8qKgogIEEgY29tcHV0ZWQgcHJvcGVydHkgdHJhbnNmb3Jt
        cyBhbiBvYmplY3RzIGZ1bmN0aW9uIGludG8gYSBwcm9wZXJ0eS4KCiAgQnkg
        ZGVmYXVsdCB0aGUgZnVuY3Rpb24gYmFja2luZyB0aGUgY29tcHV0ZWQgcHJv
        cGVydHkgd2lsbCBvbmx5IGJlIGNhbGxlZAogIG9uY2UgYW5kIHRoZSByZXN1
        bHQgd2lsbCBiZSBjYWNoZWQuIFlvdSBjYW4gc3BlY2lmeSB2YXJpb3VzIHBy
        b3BlcnRpZXMKICB0aGF0IHlvdXIgY29tcHV0ZWQgcHJvcGVydHkgaXMgZGVw
        ZW5kZW50IG9uLiBUaGlzIHdpbGwgZm9yY2UgdGhlIGNhY2hlZAogIHJlc3Vs
        dCB0byBiZSByZWNvbXB1dGVkIGlmIHRoZSBkZXBlbmRlbmNpZXMgYXJlIG1v
        ZGlmaWVkLgoKICBJbiB0aGUgZm9sbG93aW5nIGV4YW1wbGUgd2UgZGVjbGFy
        ZSBhIGNvbXB1dGVkIHByb3BlcnR5IChieSBjYWxsaW5nCiAgYC5wcm9wZXJ0
        eSgpYCBvbiB0aGUgZnVsbE5hbWUgZnVuY3Rpb24pIGFuZCBzZXR1cCB0aGUg
        cHJvcGVydGllcwogIGRlcGVuZGVuY2llcyAoZGVwZW5kaW5nIG9uIGZpcnN0
        TmFtZSBhbmQgbGFzdE5hbWUpLiBUaGUgZnVsbE5hbWUgZnVuY3Rpb24KICB3
        aWxsIGJlIGNhbGxlZCBvbmNlIChyZWdhcmRsZXNzIG9mIGhvdyBtYW55IHRp
        bWVzIGl0IGlzIGFjY2Vzc2VkKSBhcyBsb25nCiAgYXMgaXQncyBkZXBlbmRl
        bmNpZXMgaGF2ZSBub3QgYmVlbiBjaGFuZ2VkLiBPbmNlIGZpcnN0TmFtZSBv
        ciBsYXN0TmFtZSBhcmUgdXBkYXRlZAogIGFueSBmdXR1cmUgY2FsbHMgKG9y
        IGFueXRoaW5nIGJvdW5kKSB0byBmdWxsTmFtZSB3aWxsIGluY29ycG9yYXRl
        IHRoZSBuZXcKICB2YWx1ZXMuCgogIGBgYGphdmFzY3JpcHQKICBQZXJzb24g
        PSBFbWJlci5PYmplY3QuZXh0ZW5kKHsKICAgIC8vIHRoZXNlIHdpbGwgYmUg
        c3VwcGxpZWQgYnkgYGNyZWF0ZWAKICAgIGZpcnN0TmFtZTogbnVsbCwKICAg
        IGxhc3ROYW1lOiBudWxsLAoKICAgIGZ1bGxOYW1lOiBmdW5jdGlvbigpIHsK
        ICAgICAgdmFyIGZpcnN0TmFtZSA9IHRoaXMuZ2V0KCdmaXJzdE5hbWUnKTsK
        ICAgICAgdmFyIGxhc3ROYW1lID0gdGhpcy5nZXQoJ2xhc3ROYW1lJyk7Cgog
        ICAgIHJldHVybiBmaXJzdE5hbWUgKyAnICcgKyBsYXN0TmFtZTsKICAgIH0u
        cHJvcGVydHkoJ2ZpcnN0TmFtZScsICdsYXN0TmFtZScpCiAgfSk7CgogIHZh
        ciB0b20gPSBQZXJzb24uY3JlYXRlKHsKICAgIGZpcnN0TmFtZTogIlRvbSIs
        CiAgICBsYXN0TmFtZTogIkRhbGUiCiAgfSk7CgogIHRvbS5nZXQoJ2Z1bGxO
        YW1lJykgLy8gIlRvbSBEYWxlIgogIGBgYAoKICBZb3UgY2FuIGFsc28gZGVm
        aW5lIHdoYXQgRW1iZXIgc2hvdWxkIGRvIHdoZW4gc2V0dGluZyBhIGNvbXB1
        dGVkIHByb3BlcnR5LgogIElmIHlvdSB0cnkgdG8gc2V0IGEgY29tcHV0ZWQg
        cHJvcGVydHksIGl0IHdpbGwgYmUgaW52b2tlZCB3aXRoIHRoZSBrZXkgYW5k
        CiAgdmFsdWUgeW91IHdhbnQgdG8gc2V0IGl0IHRvLiBZb3UgY2FuIGFsc28g
        YWNjZXB0IHRoZSBwcmV2aW91cyB2YWx1ZSBhcyB0aGUKICB0aGlyZCBwYXJh
        bWV0ZXIuCgogIGBgYGphdmFzY3JpcHQKCiBQZXJzb24gPSBFbWJlci5PYmpl
        Y3QuZXh0ZW5kKHsKICAgIC8vIHRoZXNlIHdpbGwgYmUgc3VwcGxpZWQgYnkg
        YGNyZWF0ZWAKICAgIGZpcnN0TmFtZTogbnVsbCwKICAgIGxhc3ROYW1lOiBu
        dWxsLAoKICAgIGZ1bGxOYW1lOiBmdW5jdGlvbihrZXksIHZhbHVlLCBvbGRW
        YWx1ZSkgewogICAgICAvLyBnZXR0ZXIKICAgICAgaWYgKGFyZ3VtZW50cy5s
        ZW5ndGggPT09IDEpIHsKICAgICAgICB2YXIgZmlyc3ROYW1lID0gdGhpcy5n
        ZXQoJ2ZpcnN0TmFtZScpOwogICAgICAgIHZhciBsYXN0TmFtZSA9IHRoaXMu
        Z2V0KCdsYXN0TmFtZScpOwoKICAgICAgICByZXR1cm4gZmlyc3ROYW1lICsg
        JyAnICsgbGFzdE5hbWU7CgogICAgICAvLyBzZXR0ZXIKICAgICAgfSBlbHNl
        IHsKICAgICAgICB2YXIgbmFtZSA9IHZhbHVlLnNwbGl0KCIgIik7CgogICAg
        ICAgIHRoaXMuc2V0KCdmaXJzdE5hbWUnLCBuYW1lWzBdKTsKICAgICAgICB0
        aGlzLnNldCgnbGFzdE5hbWUnLCBuYW1lWzFdKTsKCiAgICAgICAgcmV0dXJu
        IHZhbHVlOwogICAgICB9CiAgICB9LnByb3BlcnR5KCdmaXJzdE5hbWUnLCAn
        bGFzdE5hbWUnKQogIH0pOwoKICB2YXIgcGVyc29uID0gUGVyc29uLmNyZWF0
        ZSgpOwogIHBlcnNvbi5zZXQoJ2Z1bGxOYW1lJywgIlBldGVyIFdhZ2VuZXQi
        KTsKICBwZXJzb24uZ2V0KCdmaXJzdE5hbWUnKSAvLyBQZXRlcgogIHBlcnNv
        bi5nZXQoJ2xhc3ROYW1lJykgLy8gV2FnZW5ldAogIGBgYAoKICBAY2xhc3Mg
        Q29tcHV0ZWRQcm9wZXJ0eQogIEBuYW1lc3BhY2UgRW1iZXIKICBAZXh0ZW5k
        cyBFbWJlci5EZXNjcmlwdG9yCiAgQGNvbnN0cnVjdG9yCiovCmZ1bmN0aW9u
        IENvbXB1dGVkUHJvcGVydHkoZnVuYywgb3B0cykgewogIHRoaXMuZnVuYyA9
        IGZ1bmM7CgogIHRoaXMuX2NhY2hlYWJsZSA9IChvcHRzICYmIG9wdHMuY2Fj
        aGVhYmxlICE9PSB1bmRlZmluZWQpID8gb3B0cy5jYWNoZWFibGUgOiB0cnVl
        OwogIHRoaXMuX2RlcGVuZGVudEtleXMgPSBvcHRzICYmIG9wdHMuZGVwZW5k
        ZW50S2V5czsKICB0aGlzLl9yZWFkT25seSA9IG9wdHMgJiYgKG9wdHMucmVh
        ZE9ubHkgIT09IHVuZGVmaW5lZCB8fCAhIW9wdHMucmVhZE9ubHkpOwp9CgpF
        bWJlci5Db21wdXRlZFByb3BlcnR5ID0gQ29tcHV0ZWRQcm9wZXJ0eTsKQ29t
        cHV0ZWRQcm9wZXJ0eS5wcm90b3R5cGUgPSBuZXcgRW1iZXIuRGVzY3JpcHRv
        cigpOwoKdmFyIENvbXB1dGVkUHJvcGVydHlQcm90b3R5cGUgPSBDb21wdXRl
        ZFByb3BlcnR5LnByb3RvdHlwZTsKCi8qKgogIFByb3BlcnRpZXMgYXJlIGNh
        Y2hlYWJsZSBieSBkZWZhdWx0LiBDb21wdXRlZCBwcm9wZXJ0eSB3aWxsIGF1
        dG9tYXRpY2FsbHkKICBjYWNoZSB0aGUgcmV0dXJuIHZhbHVlIG9mIHlvdXIg
        ZnVuY3Rpb24gdW50aWwgb25lIG9mIHRoZSBkZXBlbmRlbnQga2V5cyBjaGFu
        Z2VzLgoKICBDYWxsIGB2b2xhdGlsZSgpYCB0byBzZXQgaXQgaW50byBub24t
        Y2FjaGVkIG1vZGUuIFdoZW4gaW4gdGhpcyBtb2RlCiAgdGhlIGNvbXB1dGVk
        IHByb3BlcnR5IHdpbGwgbm90IGF1dG9tYXRpY2FsbHkgY2FjaGUgdGhlIHJl
        dHVybiB2YWx1ZS4KCiAgSG93ZXZlciwgaWYgYSBwcm9wZXJ0eSBpcyBwcm9w
        ZXJseSBvYnNlcnZhYmxlLCB0aGVyZSBpcyBubyByZWFzb24gdG8gZGlzYWJs
        ZQogIGNhY2hpbmcuCgogIEBtZXRob2QgY2FjaGVhYmxlCiAgQHBhcmFtIHtC
        b29sZWFufSBhRmxhZyBvcHRpb25hbCBzZXQgdG8gYGZhbHNlYCB0byBkaXNh
        YmxlIGNhY2hpbmcKICBAcmV0dXJuIHtFbWJlci5Db21wdXRlZFByb3BlcnR5
        fSB0aGlzCiAgQGNoYWluYWJsZQoqLwpDb21wdXRlZFByb3BlcnR5UHJvdG90
        eXBlLmNhY2hlYWJsZSA9IGZ1bmN0aW9uKGFGbGFnKSB7CiAgdGhpcy5fY2Fj
        aGVhYmxlID0gYUZsYWcgIT09IGZhbHNlOwogIHJldHVybiB0aGlzOwp9OwoK
        LyoqCiAgQ2FsbCBvbiBhIGNvbXB1dGVkIHByb3BlcnR5IHRvIHNldCBpdCBp
        bnRvIG5vbi1jYWNoZWQgbW9kZS4gV2hlbiBpbiB0aGlzCiAgbW9kZSB0aGUg
        Y29tcHV0ZWQgcHJvcGVydHkgd2lsbCBub3QgYXV0b21hdGljYWxseSBjYWNo
        ZSB0aGUgcmV0dXJuIHZhbHVlLgoKICBgYGBqYXZhc2NyaXB0CiAgTXlBcHAu
        b3V0c2lkZVNlcnZpY2UgPSBFbWJlci5PYmplY3QuY3JlYXRlKHsKICAgIHZh
        bHVlOiBmdW5jdGlvbigpIHsKICAgICAgcmV0dXJuIE91dHNpZGVTZXJ2aWNl
        LmdldFZhbHVlKCk7CiAgICB9LnByb3BlcnR5KCkudm9sYXRpbGUoKQogIH0p
        OwogIGBgYAoKICBAbWV0aG9kIHZvbGF0aWxlCiAgQHJldHVybiB7RW1iZXIu
        Q29tcHV0ZWRQcm9wZXJ0eX0gdGhpcwogIEBjaGFpbmFibGUKKi8KQ29tcHV0
        ZWRQcm9wZXJ0eVByb3RvdHlwZS52b2xhdGlsZSA9IGZ1bmN0aW9uKCkgewog
        IHJldHVybiB0aGlzLmNhY2hlYWJsZShmYWxzZSk7Cn07CgovKioKICBDYWxs
        IG9uIGEgY29tcHV0ZWQgcHJvcGVydHkgdG8gc2V0IGl0IGludG8gcmVhZC1v
        bmx5IG1vZGUuIFdoZW4gaW4gdGhpcwogIG1vZGUgdGhlIGNvbXB1dGVkIHBy
        b3BlcnR5IHdpbGwgdGhyb3cgYW4gZXJyb3Igd2hlbiBzZXQuCgogIGBgYGph
        dmFzY3JpcHQKICBNeUFwcC5wZXJzb24gPSBFbWJlci5PYmplY3QuY3JlYXRl
        KHsKICAgIGd1aWQ6IGZ1bmN0aW9uKCkgewogICAgICByZXR1cm4gJ2d1aWQt
        Z3VpZC1ndWlkJzsKICAgIH0ucHJvcGVydHkoKS5yZWFkT25seSgpCiAgfSk7
        CgogIE15QXBwLnBlcnNvbi5zZXQoJ2d1aWQnLCAnbmV3LWd1aWQnKTsgLy8g
        d2lsbCB0aHJvdyBhbiBleGNlcHRpb24KICBgYGAKCiAgQG1ldGhvZCByZWFk
        T25seQogIEByZXR1cm4ge0VtYmVyLkNvbXB1dGVkUHJvcGVydHl9IHRoaXMK
        ICBAY2hhaW5hYmxlCiovCkNvbXB1dGVkUHJvcGVydHlQcm90b3R5cGUucmVh
        ZE9ubHkgPSBmdW5jdGlvbihyZWFkT25seSkgewogIHRoaXMuX3JlYWRPbmx5
        ID0gcmVhZE9ubHkgPT09IHVuZGVmaW5lZCB8fCAhIXJlYWRPbmx5OwogIHJl
        dHVybiB0aGlzOwp9OwoKLyoqCiAgU2V0cyB0aGUgZGVwZW5kZW50IGtleXMg
        b24gdGhpcyBjb21wdXRlZCBwcm9wZXJ0eS4gUGFzcyBhbnkgbnVtYmVyIG9m
        CiAgYXJndW1lbnRzIGNvbnRhaW5pbmcga2V5IHBhdGhzIHRoYXQgdGhpcyBj
        b21wdXRlZCBwcm9wZXJ0eSBkZXBlbmRzIG9uLgoKICBgYGBqYXZhc2NyaXB0
        CiAgTXlBcHAucHJlc2lkZW50ID0gRW1iZXIuT2JqZWN0LmNyZWF0ZSh7CiAg
        ICBmdWxsTmFtZTogRW1iZXIuY29tcHV0ZWQoZnVuY3Rpb24oKSB7CiAgICAg
        IHJldHVybiB0aGlzLmdldCgnZmlyc3ROYW1lJykgKyAnICcgKyB0aGlzLmdl
        dCgnbGFzdE5hbWUnKTsKCiAgICAgIC8vIFRlbGwgRW1iZXIgdGhhdCB0aGlz
        IGNvbXB1dGVkIHByb3BlcnR5IGRlcGVuZHMgb24gZmlyc3ROYW1lCiAgICAg
        IC8vIGFuZCBsYXN0TmFtZQogICAgfSkucHJvcGVydHkoJ2ZpcnN0TmFtZScs
        ICdsYXN0TmFtZScpCiAgfSk7CiAgYGBgCgogIEBtZXRob2QgcHJvcGVydHkK
        ICBAcGFyYW0ge1N0cmluZ30gcGF0aCogemVybyBvciBtb3JlIHByb3BlcnR5
        IHBhdGhzCiAgQHJldHVybiB7RW1iZXIuQ29tcHV0ZWRQcm9wZXJ0eX0gdGhp
        cwogIEBjaGFpbmFibGUKKi8KQ29tcHV0ZWRQcm9wZXJ0eVByb3RvdHlwZS5w
        cm9wZXJ0eSA9IGZ1bmN0aW9uKCkgewogIHZhciBhcmdzID0gW107CiAgZm9y
        ICh2YXIgaSA9IDAsIGwgPSBhcmd1bWVudHMubGVuZ3RoOyBpIDwgbDsgaSsr
        KSB7CiAgICBhcmdzLnB1c2goYXJndW1lbnRzW2ldKTsKICB9CiAgdGhpcy5f
        ZGVwZW5kZW50S2V5cyA9IGFyZ3M7CiAgcmV0dXJuIHRoaXM7Cn07CgovKioK
        ICBJbiBzb21lIGNhc2VzLCB5b3UgbWF5IHdhbnQgdG8gYW5ub3RhdGUgY29t
        cHV0ZWQgcHJvcGVydGllcyB3aXRoIGFkZGl0aW9uYWwKICBtZXRhZGF0YSBh
        Ym91dCBob3cgdGhleSBmdW5jdGlvbiBvciB3aGF0IHZhbHVlcyB0aGV5IG9w
        ZXJhdGUgb24uIEZvciBleGFtcGxlLAogIGNvbXB1dGVkIHByb3BlcnR5IGZ1
        bmN0aW9ucyBtYXkgY2xvc2Ugb3ZlciB2YXJpYWJsZXMgdGhhdCBhcmUgdGhl
        biBubyBsb25nZXIKICBhdmFpbGFibGUgZm9yIGludHJvc3BlY3Rpb24uCgog
        IFlvdSBjYW4gcGFzcyBhIGhhc2ggb2YgdGhlc2UgdmFsdWVzIHRvIGEgY29t
        cHV0ZWQgcHJvcGVydHkgbGlrZSB0aGlzOgoKICBgYGAKICBwZXJzb246IGZ1
        bmN0aW9uKCkgewogICAgdmFyIHBlcnNvbklkID0gdGhpcy5nZXQoJ3BlcnNv
        bklkJyk7CiAgICByZXR1cm4gQXBwLlBlcnNvbi5jcmVhdGUoeyBpZDogcGVy
        c29uSWQgfSk7CiAgfS5wcm9wZXJ0eSgpLm1ldGEoeyB0eXBlOiBBcHAuUGVy
        c29uIH0pCiAgYGBgCgogIFRoZSBoYXNoIHRoYXQgeW91IHBhc3MgdG8gdGhl
        IGBtZXRhKClgIGZ1bmN0aW9uIHdpbGwgYmUgc2F2ZWQgb24gdGhlCiAgY29t
        cHV0ZWQgcHJvcGVydHkgZGVzY3JpcHRvciB1bmRlciB0aGUgYF9tZXRhYCBr
        ZXkuIEVtYmVyIHJ1bnRpbWUKICBleHBvc2VzIGEgcHVibGljIEFQSSBmb3Ig
        cmV0cmlldmluZyB0aGVzZSB2YWx1ZXMgZnJvbSBjbGFzc2VzLAogIHZpYSB0
        aGUgYG1ldGFGb3JQcm9wZXJ0eSgpYCBmdW5jdGlvbi4KCiAgQG1ldGhvZCBt
        ZXRhCiAgQHBhcmFtIHtIYXNofSBtZXRhCiAgQGNoYWluYWJsZQoqLwoKQ29t
        cHV0ZWRQcm9wZXJ0eVByb3RvdHlwZS5tZXRhID0gZnVuY3Rpb24obWV0YSkg
        ewogIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAwKSB7CiAgICByZXR1cm4g
        dGhpcy5fbWV0YSB8fCB7fTsKICB9IGVsc2UgewogICAgdGhpcy5fbWV0YSA9
        IG1ldGE7CiAgICByZXR1cm4gdGhpczsKICB9Cn07CgovKiBpbXBsIGRlc2Ny
        aXB0b3IgQVBJICovCkNvbXB1dGVkUHJvcGVydHlQcm90b3R5cGUuZGlkQ2hh
        bmdlID0gZnVuY3Rpb24ob2JqLCBrZXlOYW1lKSB7CiAgLy8gX3N1c3BlbmRl
        ZCBpcyBzZXQgdmlhIGEgQ1Auc2V0IHRvIGVuc3VyZSB3ZSBkb24ndCBjbGVh
        cgogIC8vIHRoZSBjYWNoZWQgdmFsdWUgc2V0IGJ5IHRoZSBzZXR0ZXIKICBp
        ZiAodGhpcy5fY2FjaGVhYmxlICYmIHRoaXMuX3N1c3BlbmRlZCAhPT0gb2Jq
        KSB7CiAgICB2YXIgbWV0YSA9IG1ldGFGb3Iob2JqKTsKICAgIGlmIChrZXlO
        YW1lIGluIG1ldGEuY2FjaGUpIHsKICAgICAgZGVsZXRlIG1ldGEuY2FjaGVb
        a2V5TmFtZV07CiAgICAgIHJlbW92ZURlcGVuZGVudEtleXModGhpcywgb2Jq
        LCBrZXlOYW1lLCBtZXRhKTsKICAgIH0KICB9Cn07CgpmdW5jdGlvbiBmaW5p
        c2hDaGFpbnMoY2hhaW5Ob2RlcykKewogIGZvciAodmFyIGk9MCwgbD1jaGFp
        bk5vZGVzLmxlbmd0aDsgaTxsOyBpKyspIHsKICAgIGNoYWluTm9kZXNbaV0u
        ZGlkQ2hhbmdlKG51bGwpOwogIH0KfQoKLyoqCiAgQWNjZXNzIHRoZSB2YWx1
        ZSBvZiB0aGUgZnVuY3Rpb24gYmFja2luZyB0aGUgY29tcHV0ZWQgcHJvcGVy
        dHkuCiAgSWYgdGhpcyBwcm9wZXJ0eSBoYXMgYWxyZWFkeSBiZWVuIGNhY2hl
        ZCwgcmV0dXJuIHRoZSBjYWNoZWQgcmVzdWx0LgogIE90aGVyd2lzZSwgY2Fs
        bCB0aGUgZnVuY3Rpb24gcGFzc2luZyB0aGUgcHJvcGVydHkgbmFtZSBhcyBh
        biBhcmd1bWVudC4KCiAgYGBgamF2YXNjcmlwdAogIFBlcnNvbiA9IEVtYmVy
        Lk9iamVjdC5leHRlbmQoewogICAgZnVsbE5hbWU6IGZ1bmN0aW9uKGtleU5h
        bWUpIHsKICAgICAgLy8gdGhlIGtleU5hbWUgcGFyYW1ldGVyIGlzICdmdWxs
        TmFtZScgaW4gdGhpcyBjYXNlLgoKICAgICAgcmV0dXJuIHRoaXMuZ2V0KCdm
        aXJzdE5hbWUnKSArICcgJyArIHRoaXMuZ2V0KCdsYXN0TmFtZScpOwogICAg
        fS5wcm9wZXJ0eSgnZmlyc3ROYW1lJywgJ2xhc3ROYW1lJykKICB9KTsKCgog
        IHZhciB0b20gPSBQZXJzb24uY3JlYXRlKHsKICAgIGZpcnN0TmFtZTogIlRv
        bSIsCiAgICBsYXN0TmFtZTogIkRhbGUiCiAgfSk7CgogIHRvbS5nZXQoJ2Z1
        bGxOYW1lJykgLy8gIlRvbSBEYWxlIgogIGBgYAoKICBAbWV0aG9kIGdldAog
        IEBwYXJhbSB7U3RyaW5nfSBrZXlOYW1lIFRoZSBrZXkgYmVpbmcgYWNjZXNz
        ZWQuCiAgQHJldHVybiB7T2JqZWN0fSBUaGUgcmV0dXJuIHZhbHVlIG9mIHRo
        ZSBmdW5jdGlvbiBiYWNraW5nIHRoZSBDUC4KKi8KQ29tcHV0ZWRQcm9wZXJ0
        eVByb3RvdHlwZS5nZXQgPSBmdW5jdGlvbihvYmosIGtleU5hbWUpIHsKICB2
        YXIgcmV0LCBjYWNoZSwgbWV0YSwgY2hhaW5Ob2RlczsKICBpZiAodGhpcy5f
        Y2FjaGVhYmxlKSB7CiAgICBtZXRhID0gbWV0YUZvcihvYmopOwogICAgY2Fj
        aGUgPSBtZXRhLmNhY2hlOwogICAgaWYgKGtleU5hbWUgaW4gY2FjaGUpIHsg
        cmV0dXJuIGNhY2hlW2tleU5hbWVdOyB9CiAgICByZXQgPSBjYWNoZVtrZXlO
        YW1lXSA9IHRoaXMuZnVuYy5jYWxsKG9iaiwga2V5TmFtZSk7CiAgICBjaGFp
        bk5vZGVzID0gbWV0YS5jaGFpbldhdGNoZXJzICYmIG1ldGEuY2hhaW5XYXRj
        aGVyc1trZXlOYW1lXTsKICAgIGlmIChjaGFpbk5vZGVzKSB7IGZpbmlzaENo
        YWlucyhjaGFpbk5vZGVzKTsgfQogICAgYWRkRGVwZW5kZW50S2V5cyh0aGlz
        LCBvYmosIGtleU5hbWUsIG1ldGEpOwogIH0gZWxzZSB7CiAgICByZXQgPSB0
        aGlzLmZ1bmMuY2FsbChvYmosIGtleU5hbWUpOwogIH0KICByZXR1cm4gcmV0
        Owp9OwoKLyoqCiAgU2V0IHRoZSB2YWx1ZSBvZiBhIGNvbXB1dGVkIHByb3Bl
        cnR5LiBJZiB0aGUgZnVuY3Rpb24gdGhhdCBiYWNrcyB5b3VyCiAgY29tcHV0
        ZWQgcHJvcGVydHkgZG9lcyBub3QgYWNjZXB0IGFyZ3VtZW50cyB0aGVuIHRo
        ZSBkZWZhdWx0IGFjdGlvbiBmb3IKICBzZXR0aW5nIHdvdWxkIGJlIHRvIGRl
        ZmluZSB0aGUgcHJvcGVydHkgb24gdGhlIGN1cnJlbnQgb2JqZWN0LCBhbmQg
        c2V0CiAgdGhlIHZhbHVlIG9mIHRoZSBwcm9wZXJ0eSB0byB0aGUgdmFsdWUg
        YmVpbmcgc2V0LgoKICBHZW5lcmFsbHkgc3BlYWtpbmcgaWYgeW91IGludGVu
        ZCBmb3IgeW91ciBjb21wdXRlZCBwcm9wZXJ0eSB0byBiZSBzZXQKICB5b3Vy
        IGJhY2tpbmcgZnVuY3Rpb24gc2hvdWxkIGFjY2VwdCBlaXRoZXIgdHdvIG9y
        IHRocmVlIGFyZ3VtZW50cy4KCiAgQG1ldGhvZCBzZXQKICBAcGFyYW0ge1N0
        cmluZ30ga2V5TmFtZSBUaGUga2V5IGJlaW5nIGFjY2Vzc2VkLgogIEBwYXJh
        bSB7T2JqZWN0fSBuZXdWYWx1ZSBUaGUgbmV3IHZhbHVlIGJlaW5nIGFzc2ln
        bmVkLgogIEBwYXJhbSB7U3RyaW5nfSBvbGRWYWx1ZSBUaGUgb2xkIHZhbHVl
        IGJlaW5nIHJlcGxhY2VkLgogIEByZXR1cm4ge09iamVjdH0gVGhlIHJldHVy
        biB2YWx1ZSBvZiB0aGUgZnVuY3Rpb24gYmFja2luZyB0aGUgQ1AuCiovCkNv
        bXB1dGVkUHJvcGVydHlQcm90b3R5cGUuc2V0ID0gZnVuY3Rpb24ob2JqLCBr
        ZXlOYW1lLCB2YWx1ZSkgewogIHZhciBjYWNoZWFibGUgPSB0aGlzLl9jYWNo
        ZWFibGUsCiAgICAgIGZ1bmMgPSB0aGlzLmZ1bmMsCiAgICAgIG1ldGEgPSBt
        ZXRhRm9yKG9iaiwgY2FjaGVhYmxlKSwKICAgICAgd2F0Y2hlZCA9IG1ldGEu
        d2F0Y2hpbmdba2V5TmFtZV0sCiAgICAgIG9sZFN1c3BlbmRlZCA9IHRoaXMu
        X3N1c3BlbmRlZCwKICAgICAgaGFkQ2FjaGVkVmFsdWUgPSBmYWxzZSwKICAg
        ICAgY2FjaGUgPSBtZXRhLmNhY2hlLAogICAgICBmdW5jQXJnTGVuZ3RoLCBj
        YWNoZWRWYWx1ZSwgcmV0OwoKICBpZiAodGhpcy5fcmVhZE9ubHkpIHsKICAg
        IHRocm93IG5ldyBFcnJvcignQ2Fubm90IFNldDogJyArIGtleU5hbWUgKyAn
        IG9uOiAnICsgb2JqLnRvU3RyaW5nKCkgKTsKICB9CgogIHRoaXMuX3N1c3Bl
        bmRlZCA9IG9iajsKCiAgdHJ5IHsKCiAgICBpZiAoY2FjaGVhYmxlICYmIGNh
        Y2hlLmhhc093blByb3BlcnR5KGtleU5hbWUpKSB7CiAgICAgIGNhY2hlZFZh
        bHVlID0gY2FjaGVba2V5TmFtZV07CiAgICAgIGhhZENhY2hlZFZhbHVlID0g
        dHJ1ZTsKICAgIH0KCiAgICAvLyBDaGVjayBpZiB0aGUgQ1AgaGFzIGJlZW4g
        d3JhcHBlZC4gSWYgaWYgaGFzLCB1c2UgdGhlCiAgICAvLyBsZW5ndGggZnJv
        bSB0aGUgd3JhcHBlZCBmdW5jdGlvbi4KICAgIGZ1bmNBcmdMZW5ndGggPSAo
        ZnVuYy53cmFwcGVkRnVuY3Rpb24gPyBmdW5jLndyYXBwZWRGdW5jdGlvbi5s
        ZW5ndGggOiBmdW5jLmxlbmd0aCk7CgogICAgLy8gRm9yIGJhY2t3YXJkcy1j
        b21wYXRpYmlsaXR5IHdpdGggY29tcHV0ZWQgcHJvcGVydGllcwogICAgLy8g
        dGhhdCBjaGVjayBmb3IgYXJndW1lbnRzLmxlbmd0aCA9PT0gMiB0byBkZXRl
        cm1pbmUgaWYKICAgIC8vIHRoZXkgYXJlIGJlaW5nIGdldCBvciBzZXQsIG9u
        bHkgcGFzcyB0aGUgb2xkIGNhY2hlZAogICAgLy8gdmFsdWUgaWYgdGhlIGNv
        bXB1dGVkIHByb3BlcnR5IG9wdHMgaW50byBhIHRoaXJkCiAgICAvLyBhcmd1
        bWVudC4KICAgIGlmIChmdW5jQXJnTGVuZ3RoID09PSAzKSB7CiAgICAgIHJl
        dCA9IGZ1bmMuY2FsbChvYmosIGtleU5hbWUsIHZhbHVlLCBjYWNoZWRWYWx1
        ZSk7CiAgICB9IGVsc2UgaWYgKGZ1bmNBcmdMZW5ndGggPT09IDIpIHsKICAg
        ICAgcmV0ID0gZnVuYy5jYWxsKG9iaiwga2V5TmFtZSwgdmFsdWUpOwogICAg
        fSBlbHNlIHsKICAgICAgRW1iZXIuZGVmaW5lUHJvcGVydHkob2JqLCBrZXlO
        YW1lLCBudWxsLCBjYWNoZWRWYWx1ZSk7CiAgICAgIEVtYmVyLnNldChvYmos
        IGtleU5hbWUsIHZhbHVlKTsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGlm
        IChoYWRDYWNoZWRWYWx1ZSAmJiBjYWNoZWRWYWx1ZSA9PT0gcmV0KSB7IHJl
        dHVybjsgfQoKICAgIGlmICh3YXRjaGVkKSB7IEVtYmVyLnByb3BlcnR5V2ls
        bENoYW5nZShvYmosIGtleU5hbWUpOyB9CgogICAgaWYgKGhhZENhY2hlZFZh
        bHVlKSB7CiAgICAgIGRlbGV0ZSBjYWNoZVtrZXlOYW1lXTsKICAgIH0KCiAg
        ICBpZiAoY2FjaGVhYmxlKSB7CiAgICAgIGlmICghaGFkQ2FjaGVkVmFsdWUp
        IHsKICAgICAgICBhZGREZXBlbmRlbnRLZXlzKHRoaXMsIG9iaiwga2V5TmFt
        ZSwgbWV0YSk7CiAgICAgIH0KICAgICAgY2FjaGVba2V5TmFtZV0gPSByZXQ7
        CiAgICB9CgogICAgaWYgKHdhdGNoZWQpIHsgRW1iZXIucHJvcGVydHlEaWRD
        aGFuZ2Uob2JqLCBrZXlOYW1lKTsgfQogIH0gZmluYWxseSB7CiAgICB0aGlz
        Ll9zdXNwZW5kZWQgPSBvbGRTdXNwZW5kZWQ7CiAgfQogIHJldHVybiByZXQ7
        Cn07CgovKiBjYWxsZWQgYmVmb3JlIHByb3BlcnR5IGlzIG92ZXJyaWRkZW4g
        Ki8KQ29tcHV0ZWRQcm9wZXJ0eVByb3RvdHlwZS50ZWFyZG93biA9IGZ1bmN0
        aW9uKG9iaiwga2V5TmFtZSkgewogIHZhciBtZXRhID0gbWV0YUZvcihvYmop
        OwoKICBpZiAoa2V5TmFtZSBpbiBtZXRhLmNhY2hlKSB7CiAgICByZW1vdmVE
        ZXBlbmRlbnRLZXlzKHRoaXMsIG9iaiwga2V5TmFtZSwgbWV0YSk7CiAgfQoK
        ICBpZiAodGhpcy5fY2FjaGVhYmxlKSB7IGRlbGV0ZSBtZXRhLmNhY2hlW2tl
        eU5hbWVdOyB9CgogIHJldHVybiBudWxsOyAvLyBubyB2YWx1ZSB0byByZXN0
        b3JlCn07CgoKLyoqCiAgVGhpcyBoZWxwZXIgcmV0dXJucyBhIG5ldyBwcm9w
        ZXJ0eSBkZXNjcmlwdG9yIHRoYXQgd3JhcHMgdGhlIHBhc3NlZAogIGNvbXB1
        dGVkIHByb3BlcnR5IGZ1bmN0aW9uLiBZb3UgY2FuIHVzZSB0aGlzIGhlbHBl
        ciB0byBkZWZpbmUgcHJvcGVydGllcwogIHdpdGggbWl4aW5zIG9yIHZpYSBg
        RW1iZXIuZGVmaW5lUHJvcGVydHkoKWAuCgogIFRoZSBmdW5jdGlvbiB5b3Ug
        cGFzcyB3aWxsIGJlIHVzZWQgdG8gYm90aCBnZXQgYW5kIHNldCBwcm9wZXJ0
        eSB2YWx1ZXMuCiAgVGhlIGZ1bmN0aW9uIHNob3VsZCBhY2NlcHQgdHdvIHBh
        cmFtZXRlcnMsIGtleSBhbmQgdmFsdWUuIElmIHZhbHVlIGlzIG5vdAogIHVu
        ZGVmaW5lZCB5b3Ugc2hvdWxkIHNldCB0aGUgdmFsdWUgZmlyc3QuIEluIGVp
        dGhlciBjYXNlIHJldHVybiB0aGUKICBjdXJyZW50IHZhbHVlIG9mIHRoZSBw
        cm9wZXJ0eS4KICBAbWV0aG9kIGNvbXB1dGVkCiAgQGZvciBFbWJlcgogIEBw
        YXJhbSB7RnVuY3Rpb259IGZ1bmMgVGhlIGNvbXB1dGVkIHByb3BlcnR5IGZ1
        bmN0aW9uLgogIEByZXR1cm4ge0VtYmVyLkNvbXB1dGVkUHJvcGVydHl9IHBy
        b3BlcnR5IGRlc2NyaXB0b3IgaW5zdGFuY2UKKi8KRW1iZXIuY29tcHV0ZWQg
        PSBmdW5jdGlvbihmdW5jKSB7CiAgdmFyIGFyZ3M7CgogIGlmIChhcmd1bWVu
        dHMubGVuZ3RoID4gMSkgewogICAgYXJncyA9IGFfc2xpY2UuY2FsbChhcmd1
        bWVudHMsIDAsIC0xKTsKICAgIGZ1bmMgPSBhX3NsaWNlLmNhbGwoYXJndW1l
        bnRzLCAtMSlbMF07CiAgfQoKICBpZiAodHlwZW9mIGZ1bmMgIT09ICJmdW5j
        dGlvbiIpIHsKICAgIHRocm93IG5ldyBFcnJvcigiQ29tcHV0ZWQgUHJvcGVy
        dHkgZGVjbGFyZWQgd2l0aG91dCBhIHByb3BlcnR5IGZ1bmN0aW9uIik7CiAg
        fQoKICB2YXIgY3AgPSBuZXcgQ29tcHV0ZWRQcm9wZXJ0eShmdW5jKTsKCiAg
        aWYgKGFyZ3MpIHsKICAgIGNwLnByb3BlcnR5LmFwcGx5KGNwLCBhcmdzKTsK
        ICB9CgogIHJldHVybiBjcDsKfTsKCi8qKgogIFJldHVybnMgdGhlIGNhY2hl
        ZCB2YWx1ZSBmb3IgYSBwcm9wZXJ0eSwgaWYgb25lIGV4aXN0cy4KICBUaGlz
        IGNhbiBiZSB1c2VmdWwgZm9yIHBlZWtpbmcgYXQgdGhlIHZhbHVlIG9mIGEg
        Y29tcHV0ZWQKICBwcm9wZXJ0eSB0aGF0IGlzIGdlbmVyYXRlZCBsYXppbHks
        IHdpdGhvdXQgYWNjaWRlbnRhbGx5IGNhdXNpbmcKICBpdCB0byBiZSBjcmVh
        dGVkLgoKICBAbWV0aG9kIGNhY2hlRm9yCiAgQGZvciBFbWJlcgogIEBwYXJh
        bSB7T2JqZWN0fSBvYmogdGhlIG9iamVjdCB3aG9zZSBwcm9wZXJ0eSB5b3Ug
        d2FudCB0byBjaGVjawogIEBwYXJhbSB7U3RyaW5nfSBrZXkgdGhlIG5hbWUg
        b2YgdGhlIHByb3BlcnR5IHdob3NlIGNhY2hlZCB2YWx1ZSB5b3Ugd2FudAog
        ICAgdG8gcmV0dXJuCiAgQHJldHVybiB7Kn0gdGhlIGNhY2hlZCB2YWx1ZQoq
        LwpFbWJlci5jYWNoZUZvciA9IGZ1bmN0aW9uIGNhY2hlRm9yKG9iaiwga2V5
        KSB7CiAgdmFyIGNhY2hlID0gbWV0YUZvcihvYmosIGZhbHNlKS5jYWNoZTsK
        CiAgaWYgKGNhY2hlICYmIGtleSBpbiBjYWNoZSkgewogICAgcmV0dXJuIGNh
        Y2hlW2tleV07CiAgfQp9OwoKZnVuY3Rpb24gZ2V0UHJvcGVydGllcyhzZWxm
        LCBwcm9wZXJ0eU5hbWVzKSB7CiAgdmFyIHJldCA9IHt9OwogIGZvcih2YXIg
        aSA9IDA7IGkgPCBwcm9wZXJ0eU5hbWVzLmxlbmd0aDsgaSsrKSB7CiAgICBy
        ZXRbcHJvcGVydHlOYW1lc1tpXV0gPSBnZXQoc2VsZiwgcHJvcGVydHlOYW1l
        c1tpXSk7CiAgfQogIHJldHVybiByZXQ7Cn0KCmZ1bmN0aW9uIHJlZ2lzdGVy
        Q29tcHV0ZWQobmFtZSwgbWFjcm8pIHsKICBFbWJlci5jb21wdXRlZFtuYW1l
        XSA9IGZ1bmN0aW9uKGRlcGVuZGVudEtleSkgewogICAgdmFyIGFyZ3MgPSBh
        X3NsaWNlLmNhbGwoYXJndW1lbnRzKTsKICAgIHJldHVybiBFbWJlci5jb21w
        dXRlZChkZXBlbmRlbnRLZXksIGZ1bmN0aW9uKCkgewogICAgICByZXR1cm4g
        bWFjcm8uYXBwbHkodGhpcywgYXJncyk7CiAgICB9KTsKICB9Owp9CgpmdW5j
        dGlvbiByZWdpc3RlckNvbXB1dGVkV2l0aFByb3BlcnRpZXMobmFtZSwgbWFj
        cm8pIHsKICBFbWJlci5jb21wdXRlZFtuYW1lXSA9IGZ1bmN0aW9uKCkgewog
        ICAgdmFyIHByb3BlcnRpZXMgPSBhX3NsaWNlLmNhbGwoYXJndW1lbnRzKTsK
        CiAgICB2YXIgY29tcHV0ZWQgPSBFbWJlci5jb21wdXRlZChmdW5jdGlvbigp
        IHsKICAgICAgcmV0dXJuIG1hY3JvLmFwcGx5KHRoaXMsIFtnZXRQcm9wZXJ0
        aWVzKHRoaXMsIHByb3BlcnRpZXMpXSk7CiAgICB9KTsKCiAgICByZXR1cm4g
        Y29tcHV0ZWQucHJvcGVydHkuYXBwbHkoY29tcHV0ZWQsIHByb3BlcnRpZXMp
        OwogIH07Cn0KCi8qKgogIEEgY29tcHV0ZWQgcHJvcGVydHkgdGhhdCByZXR1
        cm5zIHRydWUgaWYgdGhlIHZhbHVlIG9mIHRoZSBkZXBlbmRlbnQKICBwcm9w
        ZXJ0eSBpcyBudWxsLCBhbiBlbXB0eSBzdHJpbmcsIGVtcHR5IGFycmF5LCBv
        ciBlbXB0eSBmdW5jdGlvbi4KCiAgTm90ZTogV2hlbiB1c2luZyBgRW1iZXIu
        Y29tcHV0ZWQuZW1wdHlgIHRvIHdhdGNoIGFuIGFycmF5IG1ha2Ugc3VyZSB0
        bwogIHVzZSB0aGUgYGFycmF5LltdYCBzeW50YXggc28gdGhlIGNvbXB1dGVk
        IGNhbiBzdWJzY3JpYmUgdG8gdHJhbnNpdGlvbnMKICBmcm9tIGVtcHR5IHRv
        IG5vbi1lbXB0eSBzdGF0ZXMuCgogIEV4YW1wbGUKCiAgYGBgamF2YXNjcmlw
        dAogIHZhciBUb0RvTGlzdCA9IEVtYmVyLk9iamVjdC5leHRlbmQoewogICAg
        ZG9uZTogRW1iZXIuY29tcHV0ZWQuZW1wdHkoJ3RvZG9zLltdJykgLy8gZGV0
        ZWN0IGFycmF5IGNoYW5nZXMKICB9KTsKICB2YXIgdG9kb0xpc3QgPSBUb0Rv
        TGlzdC5jcmVhdGUoe3RvZG9zOiBbJ1VuaXQgVGVzdCcsICdEb2N1bWVudGF0
        aW9uJywgJ1JlbGVhc2UnXX0pOwogIHRvZG9MaXN0LmdldCgnZG9uZScpOyAv
        LyBmYWxzZQogIHRvZG9MaXN0LmdldCgndG9kb3MnKS5jbGVhcigpOyAvLyBb
        XQogIHRvZG9MaXN0LmdldCgnZG9uZScpOyAvLyB0cnVlCiAgYGBgCgogIEBt
        ZXRob2QgY29tcHV0ZWQuZW1wdHkKICBAZm9yIEVtYmVyCiAgQHBhcmFtIHtT
        dHJpbmd9IGRlcGVuZGVudEtleQogIEByZXR1cm4ge0VtYmVyLkNvbXB1dGVk
        UHJvcGVydHl9IGNvbXB1dGVkIHByb3BlcnR5IHdoaWNoIG5lZ2F0ZQogIHRo
        ZSBvcmlnaW5hbCB2YWx1ZSBmb3IgcHJvcGVydHkKKi8KcmVnaXN0ZXJDb21w
        dXRlZCgnZW1wdHknLCBmdW5jdGlvbihkZXBlbmRlbnRLZXkpIHsKICByZXR1
        cm4gRW1iZXIuaXNFbXB0eShnZXQodGhpcywgZGVwZW5kZW50S2V5KSk7Cn0p
        OwoKLyoqCiAgQSBjb21wdXRlZCBwcm9wZXJ0eSB0aGF0IHJldHVybnMgdHJ1
        ZSBpZiB0aGUgdmFsdWUgb2YgdGhlIGRlcGVuZGVudAogIHByb3BlcnR5IGlz
        IE5PVCBudWxsLCBhbiBlbXB0eSBzdHJpbmcsIGVtcHR5IGFycmF5LCBvciBl
        bXB0eSBmdW5jdGlvbi4KCiAgRXhhbXBsZQoKICBgYGBqYXZhc2NyaXB0CiAg
        dmFyIEhhbXBzdGVyID0gRW1iZXIuT2JqZWN0LmV4dGVuZCh7CiAgICBoYXNT
        dHVmZjogRW1iZXIuY29tcHV0ZWQubm90RW1wdHkoJ2JhY2twYWNrJykKICB9
        KTsKICB2YXIgaGFtcHN0ZXIgPSBIYW1wc3Rlci5jcmVhdGUoe2JhY2twYWNr
        OiBbJ0Zvb2QnLCAnU2xlZXBpbmcgQmFnJywgJ1RlbnQnXX0pOwogIGhhbXBz
        dGVyLmdldCgnaGFzU3R1ZmYnKTsgLy8gdHJ1ZQogIGhhbXBzdGVyLmdldCgn
        YmFja3BhY2snKS5jbGVhcigpOyAvLyBbXQogIGhhbXBzdGVyLmdldCgnaGFz
        U3R1ZmYnKTsgLy8gZmFsc2UKICBgYGAKCiAgQG1ldGhvZCBjb21wdXRlZC5u
        b3RFbXB0eQogIEBmb3IgRW1iZXIKICBAcGFyYW0ge1N0cmluZ30gZGVwZW5k
        ZW50S2V5CiAgQHJldHVybiB7RW1iZXIuQ29tcHV0ZWRQcm9wZXJ0eX0gY29t
        cHV0ZWQgcHJvcGVydHkgd2hpY2ggcmV0dXJucyB0cnVlIGlmCiAgb3JpZ2lu
        YWwgdmFsdWUgZm9yIHByb3BlcnR5IGlzIG5vdCBlbXB0eS4KKi8KcmVnaXN0
        ZXJDb21wdXRlZCgnbm90RW1wdHknLCBmdW5jdGlvbihkZXBlbmRlbnRLZXkp
        IHsKICByZXR1cm4gIUVtYmVyLmlzRW1wdHkoZ2V0KHRoaXMsIGRlcGVuZGVu
        dEtleSkpOwp9KTsKCi8qKgogIEEgY29tcHV0ZWQgcHJvcGVydHkgdGhhdCBy
        ZXR1cm5zIHRydWUgaWYgdGhlIHZhbHVlIG9mIHRoZSBkZXBlbmRlbnQKICBw
        cm9wZXJ0eSBpcyBudWxsIG9yIHVuZGVmaW5lZC4gVGhpcyBhdm9pZHMgZXJy
        b3JzIGZyb20gSlNMaW50IGNvbXBsYWluaW5nCiAgYWJvdXQgdXNlIG9mID09
        LCB3aGljaCBjYW4gYmUgdGVjaG5pY2FsbHkgY29uZnVzaW5nLgoKICBFeGFt
        cGxlCgogIGBgYGphdmFzY3JpcHQKICB2YXIgSGFtcHN0ZXIgPSBFbWJlci5P
        YmplY3QuZXh0ZW5kKHsKICAgIGlzSHVuZ3J5OiBFbWJlci5jb21wdXRlZC5u
        b25lKCdmb29kJykKICB9KTsKICB2YXIgaGFtcHN0ZXIgPSBIYW1wc3Rlci5j
        cmVhdGUoKTsKICBoYW1wc3Rlci5nZXQoJ2lzSHVuZ3J5Jyk7IC8vIHRydWUK
        ICBoYW1wc3Rlci5zZXQoJ2Zvb2QnLCAnQmFuYW5hJyk7CiAgaGFtcHN0ZXIu
        Z2V0KCdpc0h1bmdyeScpOyAvLyBmYWxzZQogIGhhbXBzdGVyLnNldCgnZm9v
        ZCcsIG51bGwpOwogIGhhbXBzdGVyLmdldCgnaXNIdW5ncnknKTsgLy8gdHJ1
        ZQogIGBgYAoKICBAbWV0aG9kIGNvbXB1dGVkLm5vbmUKICBAZm9yIEVtYmVy
        CiAgQHBhcmFtIHtTdHJpbmd9IGRlcGVuZGVudEtleQogIEByZXR1cm4ge0Vt
        YmVyLkNvbXB1dGVkUHJvcGVydHl9IGNvbXB1dGVkIHByb3BlcnR5IHdoaWNo
        CiAgcmV0dXJucyB0cnVlIGlmIG9yaWdpbmFsIHZhbHVlIGZvciBwcm9wZXJ0
        eSBpcyBudWxsIG9yIHVuZGVmaW5lZC4KKi8KcmVnaXN0ZXJDb21wdXRlZCgn
        bm9uZScsIGZ1bmN0aW9uKGRlcGVuZGVudEtleSkgewogIHJldHVybiBFbWJl
        ci5pc05vbmUoZ2V0KHRoaXMsIGRlcGVuZGVudEtleSkpOwp9KTsKCi8qKgog
        IEEgY29tcHV0ZWQgcHJvcGVydHkgdGhhdCByZXR1cm5zIHRoZSBpbnZlcnNl
        IGJvb2xlYW4gdmFsdWUKICBvZiB0aGUgb3JpZ2luYWwgdmFsdWUgZm9yIHRo
        ZSBkZXBlbmRlbnQgcHJvcGVydHkuCgogIEV4YW1wbGUKCiAgYGBgamF2YXNj
        cmlwdAogIHZhciBVc2VyID0gRW1iZXIuT2JqZWN0LmV4dGVuZCh7CiAgICBp
        c0Fub255bW91czogRW1iZXIuY29tcHV0ZWQubm90KCdsb2dnZWRJbicpCiAg
        fSk7CiAgdmFyIHVzZXIgPSBVc2VyLmNyZWF0ZSh7bG9nZ2VkSW46IGZhbHNl
        fSk7CiAgdXNlci5nZXQoJ2lzQW5vbnltb3VzJyk7IC8vIHRydWUKICB1c2Vy
        LnNldCgnbG9nZ2VkSW4nLCB0cnVlKTsKICB1c2VyLmdldCgnaXNBbm9ueW1v
        dXMnKTsgLy8gZmFsc2UKICBgYGAKCiAgQG1ldGhvZCBjb21wdXRlZC5ub3QK
        ICBAZm9yIEVtYmVyCiAgQHBhcmFtIHtTdHJpbmd9IGRlcGVuZGVudEtleQog
        IEByZXR1cm4ge0VtYmVyLkNvbXB1dGVkUHJvcGVydHl9IGNvbXB1dGVkIHBy
        b3BlcnR5IHdoaWNoIHJldHVybnMKICBpbnZlcnNlIG9mIHRoZSBvcmlnaW5h
        bCB2YWx1ZSBmb3IgcHJvcGVydHkKKi8KcmVnaXN0ZXJDb21wdXRlZCgnbm90
        JywgZnVuY3Rpb24oZGVwZW5kZW50S2V5KSB7CiAgcmV0dXJuICFnZXQodGhp
        cywgZGVwZW5kZW50S2V5KTsKfSk7CgovKioKICBBIGNvbXB1dGVkIHByb3Bl
        cnR5IHRoYXQgY29udmVydHMgdGhlIHByb3ZpZGVkIGRlcGVuZGVudCBwcm9w
        ZXJ0eQogIGludG8gYSBib29sZWFuIHZhbHVlLgoKICBgYGBqYXZhc2NyaXB0
        CiAgdmFyIEhhbXBzdGVyID0gRW1iZXIuT2JqZWN0LmV4dGVuZCh7CiAgICBo
        YXNCYW5hbmFzOiBFbWJlci5jb21wdXRlZC5ib29sKCdudW1CYW5hbmFzJykK
        ICB9KTsKICB2YXIgaGFtcHN0ZXIgPSBIYW1wc3Rlci5jcmVhdGUoKTsKICBo
        YW1wc3Rlci5nZXQoJ2hhc0JhbmFuYXMnKTsgLy8gZmFsc2UKICBoYW1wc3Rl
        ci5zZXQoJ251bUJhbmFuYXMnLCAwKTsKICBoYW1wc3Rlci5nZXQoJ2hhc0Jh
        bmFuYXMnKTsgLy8gZmFsc2UKICBoYW1wc3Rlci5zZXQoJ251bUJhbmFuYXMn
        LCAxKTsKICBoYW1wc3Rlci5nZXQoJ2hhc0JhbmFuYXMnKTsgLy8gdHJ1ZQog
        IGhhbXBzdGVyLnNldCgnbnVtQmFuYW5hcycsIG51bGwpOwogIGhhbXBzdGVy
        LmdldCgnaGFzQmFuYW5hcycpOyAvLyBmYWxzZQogIGBgYAoKICBAbWV0aG9k
        IGNvbXB1dGVkLmJvb2wKICBAZm9yIEVtYmVyCiAgQHBhcmFtIHtTdHJpbmd9
        IGRlcGVuZGVudEtleQogIEByZXR1cm4ge0VtYmVyLkNvbXB1dGVkUHJvcGVy
        dHl9IGNvbXB1dGVkIHByb3BlcnR5IHdoaWNoIGNvbnZlcnRzCiAgdG8gYm9v
        bGVhbiB0aGUgb3JpZ2luYWwgdmFsdWUgZm9yIHByb3BlcnR5CiovCnJlZ2lz
        dGVyQ29tcHV0ZWQoJ2Jvb2wnLCBmdW5jdGlvbihkZXBlbmRlbnRLZXkpIHsK
        ICByZXR1cm4gISFnZXQodGhpcywgZGVwZW5kZW50S2V5KTsKfSk7CgovKioK
        ICBBIGNvbXB1dGVkIHByb3BlcnR5IHdoaWNoIG1hdGNoZXMgdGhlIG9yaWdp
        bmFsIHZhbHVlIGZvciB0aGUKICBkZXBlbmRlbnQgcHJvcGVydHkgYWdhaW5z
        dCBhIGdpdmVuIFJlZ0V4cCwgcmV0dXJuaW5nIGB0cnVlYAogIGlmIHRoZXkg
        dmFsdWVzIG1hdGNoZXMgdGhlIFJlZ0V4cCBhbmQgYGZhbHNlYCBpZiBpdCBk
        b2VzIG5vdC4KCiAgRXhhbXBsZQoKICBgYGBqYXZhc2NyaXB0CiAgdmFyIFVz
        ZXIgPSBFbWJlci5PYmplY3QuZXh0ZW5kKHsKICAgIGhhc1ZhbGlkRW1haWw6
        IEVtYmVyLmNvbXB1dGVkLm1hdGNoKCdlbWFpbCcsIC9eLitALitcLi4rJC8p
        CiAgfSk7CiAgdmFyIHVzZXIgPSBVc2VyLmNyZWF0ZSh7bG9nZ2VkSW46IGZh
        bHNlfSk7CiAgdXNlci5nZXQoJ2hhc1ZhbGlkRW1haWwnKTsgLy8gZmFsc2UK
        ICB1c2VyLnNldCgnZW1haWwnLCAnJyk7CiAgdXNlci5nZXQoJ2hhc1ZhbGlk
        RW1haWwnKTsgLy8gZmFsc2UKICB1c2VyLnNldCgnZW1haWwnLCAnZW1iZXJf
        aGFtcHN0ZXJAZXhhbXBsZS5jb20nKTsKICB1c2VyLmdldCgnaGFzVmFsaWRF
        bWFpbCcpOyAvLyB0cnVlCiAgYGBgCgogIEBtZXRob2QgY29tcHV0ZWQubWF0
        Y2gKICBAZm9yIEVtYmVyCiAgQHBhcmFtIHtTdHJpbmd9IGRlcGVuZGVudEtl
        eQogIEBwYXJhbSB7UmVnRXhwfSByZWdleHAKICBAcmV0dXJuIHtFbWJlci5D
        b21wdXRlZFByb3BlcnR5fSBjb21wdXRlZCBwcm9wZXJ0eSB3aGljaCBtYXRj
        aAogIHRoZSBvcmlnaW5hbCB2YWx1ZSBmb3IgcHJvcGVydHkgYWdhaW5zdCBh
        IGdpdmVuIFJlZ0V4cAoqLwpyZWdpc3RlckNvbXB1dGVkKCdtYXRjaCcsIGZ1
        bmN0aW9uKGRlcGVuZGVudEtleSwgcmVnZXhwKSB7CiAgdmFyIHZhbHVlID0g
        Z2V0KHRoaXMsIGRlcGVuZGVudEtleSk7CiAgcmV0dXJuIHR5cGVvZiB2YWx1
        ZSA9PT0gJ3N0cmluZycgPyAhIXZhbHVlLm1hdGNoKHJlZ2V4cCkgOiBmYWxz
        ZTsKfSk7CgovKioKICBBIGNvbXB1dGVkIHByb3BlcnR5IHRoYXQgcmV0dXJu
        cyB0cnVlIGlmIHRoZSBwcm92aWRlZCBkZXBlbmRlbnQgcHJvcGVydHkKICBp
        cyBlcXVhbCB0byB0aGUgZ2l2ZW4gdmFsdWUuCgogIEV4YW1wbGUKCiAgYGBg
        amF2YXNjcmlwdAogIHZhciBIYW1wc3RlciA9IEVtYmVyLk9iamVjdC5leHRl
        bmQoewogICAgbmFwVGltZTogRW1iZXIuY29tcHV0ZWQuZXF1YWwoJ3N0YXRl
        JywgJ3NsZWVweScpCiAgfSk7CiAgdmFyIGhhbXBzdGVyID0gSGFtcHN0ZXIu
        Y3JlYXRlKCk7CiAgaGFtcHN0ZXIuZ2V0KCduYXBUaW1lJyk7IC8vIGZhbHNl
        CiAgaGFtcHN0ZXIuc2V0KCdzdGF0ZScsICdzbGVlcHknKTsKICBoYW1wc3Rl
        ci5nZXQoJ25hcFRpbWUnKTsgLy8gdHJ1ZQogIGhhbXBzdGVyLnNldCgnc3Rh
        dGUnLCAnaHVuZ3J5Jyk7CiAgaGFtcHN0ZXIuZ2V0KCduYXBUaW1lJyk7IC8v
        IGZhbHNlCiAgYGBgCgogIEBtZXRob2QgY29tcHV0ZWQuZXF1YWwKICBAZm9y
        IEVtYmVyCiAgQHBhcmFtIHtTdHJpbmd9IGRlcGVuZGVudEtleQogIEBwYXJh
        bSB7U3RyaW5nfE51bWJlcnxPYmplY3R9IHZhbHVlCiAgQHJldHVybiB7RW1i
        ZXIuQ29tcHV0ZWRQcm9wZXJ0eX0gY29tcHV0ZWQgcHJvcGVydHkgd2hpY2gg
        cmV0dXJucyB0cnVlIGlmCiAgdGhlIG9yaWdpbmFsIHZhbHVlIGZvciBwcm9w
        ZXJ0eSBpcyBlcXVhbCB0byB0aGUgZ2l2ZW4gdmFsdWUuCiovCnJlZ2lzdGVy
        Q29tcHV0ZWQoJ2VxdWFsJywgZnVuY3Rpb24oZGVwZW5kZW50S2V5LCB2YWx1
        ZSkgewogIHJldHVybiBnZXQodGhpcywgZGVwZW5kZW50S2V5KSA9PT0gdmFs
        dWU7Cn0pOwoKLyoqCiAgQSBjb21wdXRlZCBwcm9wZXJ0eSB0aGF0IHJldHVy
        bnMgdHJ1ZSBpZiB0aGUgcHJvdmllZCBkZXBlbmRlbnQgcHJvcGVydHkKICBp
        cyBncmVhdGVyIHRoYW4gdGhlIHByb3ZpZGVkIHZhbHVlLgoKICBFeGFtcGxl
        CgogIGBgYGphdmFzY3JpcHQKICB2YXIgSGFtcHN0ZXIgPSBFbWJlci5PYmpl
        Y3QuZXh0ZW5kKHsKICAgIGhhc1Rvb01hbnlCYW5hbmFzOiBFbWJlci5jb21w
        dXRlZC5ndCgnbnVtQmFuYW5hcycsIDEwKQogIH0pOwogIHZhciBoYW1wc3Rl
        ciA9IEhhbXBzdGVyLmNyZWF0ZSgpOwogIGhhbXBzdGVyLmdldCgnaGFzVG9v
        TWFueUJhbmFuYXMnKTsgLy8gZmFsc2UKICBoYW1wc3Rlci5zZXQoJ251bUJh
        bmFuYXMnLCAzKTsKICBoYW1wc3Rlci5nZXQoJ2hhc1Rvb01hbnlCYW5hbmFz
        Jyk7IC8vIGZhbHNlCiAgaGFtcHN0ZXIuc2V0KCdudW1CYW5hbmFzJywgMTEp
        OwogIGhhbXBzdGVyLmdldCgnaGFzVG9vTWFueUJhbmFuYXMnKTsgLy8gdHJ1
        ZQogIGBgYAoKICBAbWV0aG9kIGNvbXB1dGVkLmd0CiAgQGZvciBFbWJlcgog
        IEBwYXJhbSB7U3RyaW5nfSBkZXBlbmRlbnRLZXkKICBAcGFyYW0ge051bWJl
        cn0gdmFsdWUKICBAcmV0dXJuIHtFbWJlci5Db21wdXRlZFByb3BlcnR5fSBj
        b21wdXRlZCBwcm9wZXJ0eSB3aGljaCByZXR1cm5zIHRydWUgaWYKICB0aGUg
        b3JpZ2luYWwgdmFsdWUgZm9yIHByb3BlcnR5IGlzIGdyZWF0ZXIgdGhlbiBn
        aXZlbiB2YWx1ZS4KKi8KcmVnaXN0ZXJDb21wdXRlZCgnZ3QnLCBmdW5jdGlv
        bihkZXBlbmRlbnRLZXksIHZhbHVlKSB7CiAgcmV0dXJuIGdldCh0aGlzLCBk
        ZXBlbmRlbnRLZXkpID4gdmFsdWU7Cn0pOwoKLyoqCiAgQSBjb21wdXRlZCBw
        cm9wZXJ0eSB0aGF0IHJldHVybnMgdHJ1ZSBpZiB0aGUgcHJvdmlkZWQgZGVw
        ZW5kZW50IHByb3BlcnR5CiAgaXMgZ3JlYXRlciB0aGFuIG9yIGVxdWFsIHRv
        IHRoZSBwcm92aWRlZCB2YWx1ZS4KCiAgRXhhbXBsZQoKICBgYGBqYXZhc2Ny
        aXB0CiAgdmFyIEhhbXBzdGVyID0gRW1iZXIuT2JqZWN0LmV4dGVuZCh7CiAg
        ICBoYXNUb29NYW55QmFuYW5hczogRW1iZXIuY29tcHV0ZWQuZ3RlKCdudW1C
        YW5hbmFzJywgMTApCiAgfSk7CiAgdmFyIGhhbXBzdGVyID0gSGFtcHN0ZXIu
        Y3JlYXRlKCk7CiAgaGFtcHN0ZXIuZ2V0KCdoYXNUb29NYW55QmFuYW5hcycp
        OyAvLyBmYWxzZQogIGhhbXBzdGVyLnNldCgnbnVtQmFuYW5hcycsIDMpOwog
        IGhhbXBzdGVyLmdldCgnaGFzVG9vTWFueUJhbmFuYXMnKTsgLy8gZmFsc2UK
        ICBoYW1wc3Rlci5zZXQoJ251bUJhbmFuYXMnLCAxMCk7CiAgaGFtcHN0ZXIu
        Z2V0KCdoYXNUb29NYW55QmFuYW5hcycpOyAvLyB0cnVlCiAgYGBgCgogIEBt
        ZXRob2QgY29tcHV0ZWQuZ3RlCiAgQGZvciBFbWJlcgogIEBwYXJhbSB7U3Ry
        aW5nfSBkZXBlbmRlbnRLZXkKICBAcGFyYW0ge051bWJlcn0gdmFsdWUKICBA
        cmV0dXJuIHtFbWJlci5Db21wdXRlZFByb3BlcnR5fSBjb21wdXRlZCBwcm9w
        ZXJ0eSB3aGljaCByZXR1cm5zIHRydWUgaWYKICB0aGUgb3JpZ2luYWwgdmFs
        dWUgZm9yIHByb3BlcnR5IGlzIGdyZWF0ZXIgb3IgZXF1YWwgdGhlbiBnaXZl
        biB2YWx1ZS4KKi8KcmVnaXN0ZXJDb21wdXRlZCgnZ3RlJywgZnVuY3Rpb24o
        ZGVwZW5kZW50S2V5LCB2YWx1ZSkgewogIHJldHVybiBnZXQodGhpcywgZGVw
        ZW5kZW50S2V5KSA+PSB2YWx1ZTsKfSk7CgovKioKICBBIGNvbXB1dGVkIHBy
        b3BlcnR5IHRoYXQgcmV0dXJucyB0cnVlIGlmIHRoZSBwcm92aWRlZCBkZXBl
        bmRlbnQgcHJvcGVydHkKICBpcyBsZXNzIHRoYW4gdGhlIHByb3ZpZGVkIHZh
        bHVlLgoKICBFeGFtcGxlCgogIGBgYGphdmFzY3JpcHQKICB2YXIgSGFtcHN0
        ZXIgPSBFbWJlci5PYmplY3QuZXh0ZW5kKHsKICAgIG5lZWRzTW9yZUJhbmFu
        YXM6IEVtYmVyLmNvbXB1dGVkLmx0KCdudW1CYW5hbmFzJywgMykKICB9KTsK
        ICB2YXIgaGFtcHN0ZXIgPSBIYW1wc3Rlci5jcmVhdGUoKTsKICBoYW1wc3Rl
        ci5nZXQoJ25lZWRzTW9yZUJhbmFuYXMnKTsgLy8gdHJ1ZQogIGhhbXBzdGVy
        LnNldCgnbnVtQmFuYW5hcycsIDMpOwogIGhhbXBzdGVyLmdldCgnbmVlZHNN
        b3JlQmFuYW5hcycpOyAvLyBmYWxzZQogIGhhbXBzdGVyLnNldCgnbnVtQmFu
        YW5hcycsIDIpOwogIGhhbXBzdGVyLmdldCgnbmVlZHNNb3JlQmFuYW5hcycp
        OyAvLyB0cnVlCiAgYGBgCgogIEBtZXRob2QgY29tcHV0ZWQubHQKICBAZm9y
        IEVtYmVyCiAgQHBhcmFtIHtTdHJpbmd9IGRlcGVuZGVudEtleQogIEBwYXJh
        bSB7TnVtYmVyfSB2YWx1ZQogIEByZXR1cm4ge0VtYmVyLkNvbXB1dGVkUHJv
        cGVydHl9IGNvbXB1dGVkIHByb3BlcnR5IHdoaWNoIHJldHVybnMgdHJ1ZSBp
        ZgogIHRoZSBvcmlnaW5hbCB2YWx1ZSBmb3IgcHJvcGVydHkgaXMgbGVzcyB0
        aGVuIGdpdmVuIHZhbHVlLgoqLwpyZWdpc3RlckNvbXB1dGVkKCdsdCcsIGZ1
        bmN0aW9uKGRlcGVuZGVudEtleSwgdmFsdWUpIHsKICByZXR1cm4gZ2V0KHRo
        aXMsIGRlcGVuZGVudEtleSkgPCB2YWx1ZTsKfSk7CgovKioKICBBIGNvbXB1
        dGVkIHByb3BlcnR5IHRoYXQgcmV0dXJucyB0cnVlIGlmIHRoZSBwcm92aWRl
        ZCBkZXBlbmRlbnQgcHJvcGVydHkKICBpcyBsZXNzIHRoYW4gb3IgZXF1YWwg
        dG8gdGhlIHByb3ZpZGVkIHZhbHVlLgoKICBFeGFtcGxlCgogIGBgYGphdmFz
        Y3JpcHQKICB2YXIgSGFtcHN0ZXIgPSBFbWJlci5PYmplY3QuZXh0ZW5kKHsK
        ICAgIG5lZWRzTW9yZUJhbmFuYXM6IEVtYmVyLmNvbXB1dGVkLmx0ZSgnbnVt
        QmFuYW5hcycsIDMpCiAgfSk7CiAgdmFyIGhhbXBzdGVyID0gSGFtcHN0ZXIu
        Y3JlYXRlKCk7CiAgaGFtcHN0ZXIuZ2V0KCduZWVkc01vcmVCYW5hbmFzJyk7
        IC8vIHRydWUKICBoYW1wc3Rlci5zZXQoJ251bUJhbmFuYXMnLCA1KTsKICBo
        YW1wc3Rlci5nZXQoJ25lZWRzTW9yZUJhbmFuYXMnKTsgLy8gZmFsc2UKICBo
        YW1wc3Rlci5zZXQoJ251bUJhbmFuYXMnLCAzKTsKICBoYW1wc3Rlci5nZXQo
        J25lZWRzTW9yZUJhbmFuYXMnKTsgLy8gdHJ1ZQogIGBgYAoKICBAbWV0aG9k
        IGNvbXB1dGVkLmx0ZQogIEBmb3IgRW1iZXIKICBAcGFyYW0ge1N0cmluZ30g
        ZGVwZW5kZW50S2V5CiAgQHBhcmFtIHtOdW1iZXJ9IHZhbHVlCiAgQHJldHVy
        biB7RW1iZXIuQ29tcHV0ZWRQcm9wZXJ0eX0gY29tcHV0ZWQgcHJvcGVydHkg
        d2hpY2ggcmV0dXJucyB0cnVlIGlmCiAgdGhlIG9yaWdpbmFsIHZhbHVlIGZv
        ciBwcm9wZXJ0eSBpcyBsZXNzIG9yIGVxdWFsIHRoZW4gZ2l2ZW4gdmFsdWUu
        CiovCnJlZ2lzdGVyQ29tcHV0ZWQoJ2x0ZScsIGZ1bmN0aW9uKGRlcGVuZGVu
        dEtleSwgdmFsdWUpIHsKICByZXR1cm4gZ2V0KHRoaXMsIGRlcGVuZGVudEtl
        eSkgPD0gdmFsdWU7Cn0pOwoKLyoqCiAgQSBjb21wdXRlZCBwcm9wZXJ0eSB0
        aGF0IHBlcmZvcm1zIGEgbG9naWNhbCBgYW5kYCBvbiB0aGUKICBvcmlnaW5h
        bCB2YWx1ZXMgZm9yIHRoZSBwcm92aWRlZCBkZXBlbmRlbnQgcHJvcGVydGll
        cy4KCgogIEV4YW1wbGUKCiAgYGBgamF2YXNjcmlwdAogIHZhciBIYW1wc3Rl
        ciA9IEVtYmVyLk9iamVjdC5leHRlbmQoewogICAgcmVhZHlGb3JDYW1wOiBF
        bWJlci5jb21wdXRlZC5hbmQoJ2hhc1RlbnQnLCAnaGFzQmFja3BhY2snKQog
        IH0pOwogIHZhciBoYW1wc3RlciA9IEhhbXBzdGVyLmNyZWF0ZSgpOwogIGhh
        bXBzdGVyLmdldCgncmVhZHlGb3JDYW1wJyk7IC8vIGZhbHNlCiAgaGFtcHN0
        ZXIuc2V0KCdoYXNUZW50JywgdHJ1ZSk7CiAgaGFtcHN0ZXIuZ2V0KCdyZWFk
        eUZvckNhbXAnKTsgLy8gZmFsc2UKICBoYW1wc3Rlci5zZXQoJ2hhc0JhY2tw
        YWNrJywgdHJ1ZSk7CiAgaGFtcHN0ZXIuZ2V0KCdyZWFkeUZvckNhbXAnKTsg
        Ly8gdHJ1ZQogIGBgYAoKICBAbWV0aG9kIGNvbXB1dGVkLmFuZAogIEBmb3Ig
        RW1iZXIKICBAcGFyYW0ge1N0cmluZ30gZGVwZW5kZW50S2V5LCBbZGVwZW5k
        ZW50S2V5Li4uXQogIEByZXR1cm4ge0VtYmVyLkNvbXB1dGVkUHJvcGVydHl9
        IGNvbXB1dGVkIHByb3BlcnR5IHdoaWNoIHBlcmZvcm1zCiAgYSBsb2dpY2Fs
        IGBhbmRgIG9uIHRoZSB2YWx1ZXMgb2YgYWxsIHRoZSBvcmlnaW5hbCB2YWx1
        ZXMgZm9yIHByb3BlcnRpZXMuCiovCnJlZ2lzdGVyQ29tcHV0ZWRXaXRoUHJv
        cGVydGllcygnYW5kJywgZnVuY3Rpb24ocHJvcGVydGllcykgewogIGZvciAo
        dmFyIGtleSBpbiBwcm9wZXJ0aWVzKSB7CiAgICBpZiAocHJvcGVydGllcy5o
        YXNPd25Qcm9wZXJ0eShrZXkpICYmICFwcm9wZXJ0aWVzW2tleV0pIHsKICAg
        ICAgcmV0dXJuIGZhbHNlOwogICAgfQogIH0KICByZXR1cm4gdHJ1ZTsKfSk7
        CgovKioKICBBIGNvbXB1dGVkIHByb3BlcnR5IHdoaWNoIHBlcmZvcm1zIGEg
        bG9naWNhbCBgb3JgIG9uIHRoZQogIG9yaWdpbmFsIHZhbHVlcyBmb3IgdGhl
        IHByb3ZpZGVkIGRlcGVuZGVudCBwcm9wZXJ0aWVzLgoKICBFeGFtcGxlCgog
        IGBgYGphdmFzY3JpcHQKICB2YXIgSGFtcHN0ZXIgPSBFbWJlci5PYmplY3Qu
        ZXh0ZW5kKHsKICAgIHJlYWR5Rm9yUmFpbjogRW1iZXIuY29tcHV0ZWQub3Io
        J2hhc0phY2tldCcsICdoYXNVbWJyZWxsYScpCiAgfSk7CiAgdmFyIGhhbXBz
        dGVyID0gSGFtcHN0ZXIuY3JlYXRlKCk7CiAgaGFtcHN0ZXIuZ2V0KCdyZWFk
        eUZvclJhaW4nKTsgLy8gZmFsc2UKICBoYW1wc3Rlci5zZXQoJ2hhc0phY2tl
        dCcsIHRydWUpOwogIGhhbXBzdGVyLmdldCgncmVhZHlGb3JSYWluJyk7IC8v
        IHRydWUKICBgYGAKCiAgQG1ldGhvZCBjb21wdXRlZC5vcgogIEBmb3IgRW1i
        ZXIKICBAcGFyYW0ge1N0cmluZ30gZGVwZW5kZW50S2V5LCBbZGVwZW5kZW50
        S2V5Li4uXQogIEByZXR1cm4ge0VtYmVyLkNvbXB1dGVkUHJvcGVydHl9IGNv
        bXB1dGVkIHByb3BlcnR5IHdoaWNoIHBlcmZvcm1zCiAgYSBsb2dpY2FsIGBv
        cmAgb24gdGhlIHZhbHVlcyBvZiBhbGwgdGhlIG9yaWdpbmFsIHZhbHVlcyBm
        b3IgcHJvcGVydGllcy4KKi8KcmVnaXN0ZXJDb21wdXRlZFdpdGhQcm9wZXJ0
        aWVzKCdvcicsIGZ1bmN0aW9uKHByb3BlcnRpZXMpIHsKICBmb3IgKHZhciBr
        ZXkgaW4gcHJvcGVydGllcykgewogICAgaWYgKHByb3BlcnRpZXMuaGFzT3du
        UHJvcGVydHkoa2V5KSAmJiBwcm9wZXJ0aWVzW2tleV0pIHsKICAgICAgcmV0
        dXJuIHRydWU7CiAgICB9CiAgfQogIHJldHVybiBmYWxzZTsKfSk7CgovKioK
        ICBBIGNvbXB1dGVkIHByb3BlcnR5IHRoYXQgcmV0dXJucyB0aGUgZmlyc3Qg
        dHJ1dGh5IHZhbHVlCiAgZnJvbSBhIGxpc3Qgb2YgZGVwZW5kZW50IHByb3Bl
        cnRpZXMuCgogIEV4YW1wbGUKCiAgYGBgamF2YXNjcmlwdAogIHZhciBIYW1w
        c3RlciA9IEVtYmVyLk9iamVjdC5leHRlbmQoewogICAgaGFzQ2xvdGhlczog
        RW1iZXIuY29tcHV0ZWQuYW55KCdoYXQnLCAnc2hpcnQnKQogIH0pOwogIHZh
        ciBoYW1wc3RlciA9IEhhbXBzdGVyLmNyZWF0ZSgpOwogIGhhbXBzdGVyLmdl
        dCgnaGFzQ2xvdGhlcycpOyAvLyBudWxsCiAgaGFtcHN0ZXIuc2V0KCdzaGly
        dCcsICdIYXdhaWlhbiBTaGlydCcpOwogIGhhbXBzdGVyLmdldCgnaGFzQ2xv
        dGhlcycpOyAvLyAnSGF3YWlpYW4gU2hpcnQnCiAgYGBgCgogIEBtZXRob2Qg
        Y29tcHV0ZWQuYW55CiAgQGZvciBFbWJlcgogIEBwYXJhbSB7U3RyaW5nfSBk
        ZXBlbmRlbnRLZXksIFtkZXBlbmRlbnRLZXkuLi5dCiAgQHJldHVybiB7RW1i
        ZXIuQ29tcHV0ZWRQcm9wZXJ0eX0gY29tcHV0ZWQgcHJvcGVydHkgd2hpY2gg
        cmV0dXJucwogIHRoZSBmaXJzdCB0cnV0aHkgdmFsdWUgb2YgZ2l2ZW4gbGlz
        dCBvZiBwcm9wZXJ0aWVzLgoqLwpyZWdpc3RlckNvbXB1dGVkV2l0aFByb3Bl
        cnRpZXMoJ2FueScsIGZ1bmN0aW9uKHByb3BlcnRpZXMpIHsKICBmb3IgKHZh
        ciBrZXkgaW4gcHJvcGVydGllcykgewogICAgaWYgKHByb3BlcnRpZXMuaGFz
        T3duUHJvcGVydHkoa2V5KSAmJiBwcm9wZXJ0aWVzW2tleV0pIHsKICAgICAg
        cmV0dXJuIHByb3BlcnRpZXNba2V5XTsKICAgIH0KICB9CiAgcmV0dXJuIG51
        bGw7Cn0pOwoKLyoqCiAgQSBjb21wdXRlZCBwcm9wZXJ0eSB0aGF0IHJldHVy
        bnMgdGhlIGFycmF5IG9mIHZhbHVlcwogIGZvciB0aGUgcHJvdmlkZWQgZGVw
        ZW5kZW50IHByb3BlcnRpZXMuCgogIEV4YW1wbGUKCiAgYGBgamF2YXNjcmlw
        dAogIHZhciBIYW1wc3RlciA9IEVtYmVyLk9iamVjdC5leHRlbmQoewogICAg
        Y2xvdGhlczogRW1iZXIuY29tcHV0ZWQubWFwKCdoYXQnLCAnc2hpcnQnKQog
        IH0pOwogIHZhciBoYW1wc3RlciA9IEhhbXBzdGVyLmNyZWF0ZSgpOwogIGhh
        bXBzdGVyLmdldCgnY2xvdGhlcycpOyAvLyBbbnVsbCwgbnVsbF0KICBoYW1w
        c3Rlci5zZXQoJ2hhdCcsICdDYW1wIEhhdCcpOwogIGhhbXBzdGVyLnNldCgn
        c2hpcnQnLCAnQ2FtcCBTaGlydCcpOwogIGhhbXBzdGVyLmdldCgnY2xvdGhl
        cycpOyAvLyBbJ0NhbXAgSGF0JywgJ0NhbXAgU2hpcnQnXQogIGBgYAoKICBA
        bWV0aG9kIGNvbXB1dGVkLm1hcAogIEBmb3IgRW1iZXIKICBAcGFyYW0ge1N0
        cmluZ30gZGVwZW5kZW50S2V5LCBbZGVwZW5kZW50S2V5Li4uXQogIEByZXR1
        cm4ge0VtYmVyLkNvbXB1dGVkUHJvcGVydHl9IGNvbXB1dGVkIHByb3BlcnR5
        IHdoaWNoIG1hcHMKICB2YWx1ZXMgb2YgYWxsIHBhc3NlZCBwcm9wZXJ0aWVz
        IGluIHRvIGFuIGFycmF5LgoqLwpyZWdpc3RlckNvbXB1dGVkV2l0aFByb3Bl
        cnRpZXMoJ2NvbGxlY3QnLCBmdW5jdGlvbihwcm9wZXJ0aWVzKSB7CiAgdmFy
        IHJlcyA9IFtdOwogIGZvciAodmFyIGtleSBpbiBwcm9wZXJ0aWVzKSB7CiAg
        ICBpZiAocHJvcGVydGllcy5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7CiAgICAg
        IGlmIChFbWJlci5pc05vbmUocHJvcGVydGllc1trZXldKSkgewogICAgICAg
        IHJlcy5wdXNoKG51bGwpOwogICAgICB9IGVsc2UgewogICAgICAgIHJlcy5w
        dXNoKHByb3BlcnRpZXNba2V5XSk7CiAgICAgIH0KICAgIH0KICB9CiAgcmV0
        dXJuIHJlczsKfSk7CgovKioKICBDcmVhdGVzIGEgbmV3IHByb3BlcnR5IHRo
        YXQgaXMgYW4gYWxpYXMgZm9yIGFub3RoZXIgcHJvcGVydHkKICBvbiBhbiBv
        YmplY3QuIENhbGxzIHRvIGBnZXRgIG9yIGBzZXRgIHRoaXMgcHJvcGVydHkg
        YmVoYXZlIGFzCiAgdGhvdWdoIHRoZXkgd2VyZSBjYWxsZWQgb24gdGhlIG9y
        aWdpbmFsIHByb3BlcnR5LgoKICBgYGBqYXZhc2NyaXB0CiAgUGVyc29uID0g
        RW1iZXIuT2JqZWN0LmV4dGVuZCh7CiAgICBuYW1lOiAnQWxleCBNYXRjaG5l
        ZXInLAogICAgbm9tZW46IEVtYmVyLmNvbXB1dGVkLmFsaWFzKCduYW1lJykK
        ICB9KTsKCiAgYWxleCA9IFBlcnNvbi5jcmVhdGUoKTsKICBhbGV4LmdldCgn
        bm9tZW4nKTsgLy8gJ0FsZXggTWF0Y2huZWVyJwogIGFsZXguZ2V0KCduYW1l
        Jyk7ICAvLyAnQWxleCBNYXRjaG5lZXInCgogIGFsZXguc2V0KCdub21lbics
        ICdAbWFjaHR5Jyk7CiAgYWxleC5nZXQoJ25hbWUnKTsgIC8vICdAbWFjaHR5
        JwogIGBgYAogIEBtZXRob2QgY29tcHV0ZWQuYWxpYXMKICBAZm9yIEVtYmVy
        CiAgQHBhcmFtIHtTdHJpbmd9IGRlcGVuZGVudEtleQogIEByZXR1cm4ge0Vt
        YmVyLkNvbXB1dGVkUHJvcGVydHl9IGNvbXB1dGVkIHByb3BlcnR5IHdoaWNo
        IGNyZWF0ZXMgYW4KICBhbGlhcyB0byB0aGUgb3JpZ2luYWwgdmFsdWUgZm9y
        IHByb3BlcnR5LgoqLwpFbWJlci5jb21wdXRlZC5hbGlhcyA9IGZ1bmN0aW9u
        KGRlcGVuZGVudEtleSkgewogIHJldHVybiBFbWJlci5jb21wdXRlZChkZXBl
        bmRlbnRLZXksIGZ1bmN0aW9uKGtleSwgdmFsdWUpIHsKICAgIGlmIChhcmd1
        bWVudHMubGVuZ3RoID4gMSkgewogICAgICBzZXQodGhpcywgZGVwZW5kZW50
        S2V5LCB2YWx1ZSk7CiAgICAgIHJldHVybiB2YWx1ZTsKICAgIH0gZWxzZSB7
        CiAgICAgIHJldHVybiBnZXQodGhpcywgZGVwZW5kZW50S2V5KTsKICAgIH0K
        ICB9KTsKfTsKCi8qKgogIFdoZXJlIGBjb21wdXRlZC5hbGlhc2AgYWxpYXNl
        cyBgZ2V0YCBhbmQgYHNldGAsIGFuZCBhbGxvd3MgZm9yIGJpZGlyZWN0aW9u
        YWwKICBkYXRhIGZsb3csIGBjb21wdXRlZC5vbmVXYXlgIG9ubHkgcHJvdmlk
        ZXMgYW4gYWxpYXNlZCBgZ2V0YC4gVGhlIGBzZXRgIHdpbGwKICBub3QgbXV0
        YXRlIHRoZSB1cHN0cmVhbSBwcm9wZXJ0eSwgcmF0aGVyIGNhdXNlcyB0aGUg
        Y3VycmVudCBwcm9wZXJ0eSB0bwogIGJlY29tZSB0aGUgdmFsdWUgc2V0LiBU
        aGlzIGNhdXNlcyB0aGUgZG93bnN0cmVhbSBwcm9wZXJ0eSB0byBwZXJtZW50
        YW50bHkKICBkaXZlcmdlIGZyb20gdGhlIHVwc3RyZWFtIHByb3BlcnR5LgoK
        ICBFeGFtcGxlCgogIGBgYGphdmFzY3JpcHQKICBVc2VyID0gRW1iZXIuT2Jq
        ZWN0LmV4dGVuZCh7CiAgICBmaXJzdE5hbWU6IG51bGwsCiAgICBsYXN0TmFt
        ZTogbnVsbCwKICAgIG5pY2tOYW1lOiBFbWJlci5jb21wdXRlZC5vbmVXYXko
        J2ZpcnN0TmFtZScpCiAgfSk7CgogIHVzZXIgPSBVc2VyLmNyZWF0ZSh7CiAg
        ICBmaXJzdE5hbWU6ICdUZWRkeScsCiAgICBsYXN0TmFtZTogICdaZWVubnkn
        CiAgfSk7CgogIHVzZXIuZ2V0KCduaWNrTmFtZScpOwogICMgJ1RlZGR5JwoK
        ICB1c2VyLnNldCgnbmlja05hbWUnLCAnVGVkZHlCZWFyJyk7CiAgIyAnVGVk
        ZHlCZWFyJwoKICB1c2VyLmdldCgnZmlyc3ROYW1lJyk7CiAgIyAnVGVkZHkn
        CiAgYGBgCgogIEBtZXRob2QgY29tcHV0ZWQub25lV2F5CiAgQGZvciBFbWJl
        cgogIEBwYXJhbSB7U3RyaW5nfSBkZXBlbmRlbnRLZXkKICBAcmV0dXJuIHtF
        bWJlci5Db21wdXRlZFByb3BlcnR5fSBjb21wdXRlZCBwcm9wZXJ0eSB3aGlj
        aCBjcmVhdGVzIGEKICBvbmUgd2F5IGNvbXB1dGVkIHByb3BlcnR5IHRvIHRo
        ZSBvcmlnaW5hbCB2YWx1ZSBmb3IgcHJvcGVydHkuCiovCkVtYmVyLmNvbXB1
        dGVkLm9uZVdheSA9IGZ1bmN0aW9uKGRlcGVuZGVudEtleSkgewogIHJldHVy
        biBFbWJlci5jb21wdXRlZChkZXBlbmRlbnRLZXksIGZ1bmN0aW9uKCkgewog
        ICAgcmV0dXJuIGdldCh0aGlzLCBkZXBlbmRlbnRLZXkpOwogIH0pOwp9OwoK
        Ci8qKgogIEEgY29tcHV0ZWQgcHJvcGVydHkgdGhhdCBhY3RzIGxpa2UgYSBz
        dGFuZGFyZCBnZXR0ZXIgYW5kIHNldHRlciwKICBidXQgcmV0dXJucyB0aGUg
        dmFsdWUgYXQgdGhlIHByb3ZpZGVkIGBkZWZhdWx0UGF0aGAgaWYgdGhlCiAg
        cHJvcGVydHkgaXRzZWxmIGhhcyBub3QgYmVlbiBzZXQgdG8gYSB2YWx1ZQoK
        ICBFeGFtcGxlCgogIGBgYGphdmFzY3JpcHQKICB2YXIgSGFtcHN0ZXIgPSBF
        bWJlci5PYmplY3QuZXh0ZW5kKHsKICAgIHdpc2hMaXN0OiBFbWJlci5jb21w
        dXRlZC5kZWZhdWx0VG8oJ2Zhdm9yaXRlRm9vZCcpCiAgfSk7CiAgdmFyIGhh
        bXBzdGVyID0gSGFtcHN0ZXIuY3JlYXRlKHtmYXZvcml0ZUZvb2Q6ICdCYW5h
        bmEnfSk7CiAgaGFtcHN0ZXIuZ2V0KCd3aXNoTGlzdCcpOyAvLyAnQmFuYW5h
        JwogIGhhbXBzdGVyLnNldCgnd2lzaExpc3QnLCAnTW9yZSBVbml0IFRlc3Rz
        Jyk7CiAgaGFtcHN0ZXIuZ2V0KCd3aXNoTGlzdCcpOyAvLyAnTW9yZSBVbml0
        IFRlc3RzJwogIGhhbXBzdGVyLmdldCgnZmF2b3JpdGVGb29kJyk7IC8vICdC
        YW5hbmEnCiAgYGBgCgogIEBtZXRob2QgY29tcHV0ZWQuZGVmYXVsdFRvCiAg
        QGZvciBFbWJlcgogIEBwYXJhbSB7U3RyaW5nfSBkZWZhdWx0UGF0aAogIEBy
        ZXR1cm4ge0VtYmVyLkNvbXB1dGVkUHJvcGVydHl9IGNvbXB1dGVkIHByb3Bl
        cnR5IHdoaWNoIGFjdHMgbGlrZQogIGEgc3RhbmRhcmQgZ2V0dGVyIGFuZCBz
        ZXR0ZXIsIGJ1dCBkZWZhdWx0cyB0byB0aGUgdmFsdWUgZnJvbSBgZGVmYXVs
        dFBhdGhgLgoqLwpFbWJlci5jb21wdXRlZC5kZWZhdWx0VG8gPSBmdW5jdGlv
        bihkZWZhdWx0UGF0aCkgewogIHJldHVybiBFbWJlci5jb21wdXRlZChmdW5j
        dGlvbihrZXksIG5ld1ZhbHVlLCBjYWNoZWRWYWx1ZSkgewogICAgaWYgKGFy
        Z3VtZW50cy5sZW5ndGggPT09IDEpIHsKICAgICAgcmV0dXJuIGNhY2hlZFZh
        bHVlICE9IG51bGwgPyBjYWNoZWRWYWx1ZSA6IGdldCh0aGlzLCBkZWZhdWx0
        UGF0aCk7CiAgICB9CiAgICByZXR1cm4gbmV3VmFsdWUgIT0gbnVsbCA/IG5l
        d1ZhbHVlIDogZ2V0KHRoaXMsIGRlZmF1bHRQYXRoKTsKICB9KTsKfTsKCgoK
        fSkoKTsKCgoKKGZ1bmN0aW9uKCkgewovLyBFbWJlci50cnlGaW5hbGx5Ci8q
        KgpAbW9kdWxlIGVtYmVyLW1ldGFsCiovCgp2YXIgQUZURVJfT0JTRVJWRVJT
        ID0gJzpjaGFuZ2UnOwp2YXIgQkVGT1JFX09CU0VSVkVSUyA9ICc6YmVmb3Jl
        JzsKCmZ1bmN0aW9uIGNoYW5nZUV2ZW50KGtleU5hbWUpIHsKICByZXR1cm4g
        a2V5TmFtZStBRlRFUl9PQlNFUlZFUlM7Cn0KCmZ1bmN0aW9uIGJlZm9yZUV2
        ZW50KGtleU5hbWUpIHsKICByZXR1cm4ga2V5TmFtZStCRUZPUkVfT0JTRVJW
        RVJTOwp9CgovKioKICBAbWV0aG9kIGFkZE9ic2VydmVyCiAgQHBhcmFtIG9i
        agogIEBwYXJhbSB7U3RyaW5nfSBwYXRoCiAgQHBhcmFtIHtPYmplY3R8RnVu
        Y3Rpb259IHRhcmdldE9yTWV0aG9kCiAgQHBhcmFtIHtGdW5jdGlvbnxTdHJp
        bmd9IFttZXRob2RdCiovCkVtYmVyLmFkZE9ic2VydmVyID0gZnVuY3Rpb24o
        b2JqLCBwYXRoLCB0YXJnZXQsIG1ldGhvZCkgewogIEVtYmVyLmFkZExpc3Rl
        bmVyKG9iaiwgY2hhbmdlRXZlbnQocGF0aCksIHRhcmdldCwgbWV0aG9kKTsK
        ICBFbWJlci53YXRjaChvYmosIHBhdGgpOwogIHJldHVybiB0aGlzOwp9OwoK
        RW1iZXIub2JzZXJ2ZXJzRm9yID0gZnVuY3Rpb24ob2JqLCBwYXRoKSB7CiAg
        cmV0dXJuIEVtYmVyLmxpc3RlbmVyc0ZvcihvYmosIGNoYW5nZUV2ZW50KHBh
        dGgpKTsKfTsKCi8qKgogIEBtZXRob2QgcmVtb3ZlT2JzZXJ2ZXIKICBAcGFy
        YW0gb2JqCiAgQHBhcmFtIHtTdHJpbmd9IHBhdGgKICBAcGFyYW0ge09iamVj
        dHxGdW5jdGlvbn0gdGFyZ2V0T3JNZXRob2QKICBAcGFyYW0ge0Z1bmN0aW9u
        fFN0cmluZ30gW21ldGhvZF0KKi8KRW1iZXIucmVtb3ZlT2JzZXJ2ZXIgPSBm
        dW5jdGlvbihvYmosIHBhdGgsIHRhcmdldCwgbWV0aG9kKSB7CiAgRW1iZXIu
        dW53YXRjaChvYmosIHBhdGgpOwogIEVtYmVyLnJlbW92ZUxpc3RlbmVyKG9i
        aiwgY2hhbmdlRXZlbnQocGF0aCksIHRhcmdldCwgbWV0aG9kKTsKICByZXR1
        cm4gdGhpczsKfTsKCi8qKgogIEBtZXRob2QgYWRkQmVmb3JlT2JzZXJ2ZXIK
        ICBAcGFyYW0gb2JqCiAgQHBhcmFtIHtTdHJpbmd9IHBhdGgKICBAcGFyYW0g
        e09iamVjdHxGdW5jdGlvbn0gdGFyZ2V0T3JNZXRob2QKICBAcGFyYW0ge0Z1
        bmN0aW9ufFN0cmluZ30gW21ldGhvZF0KKi8KRW1iZXIuYWRkQmVmb3JlT2Jz
        ZXJ2ZXIgPSBmdW5jdGlvbihvYmosIHBhdGgsIHRhcmdldCwgbWV0aG9kKSB7
        CiAgRW1iZXIuYWRkTGlzdGVuZXIob2JqLCBiZWZvcmVFdmVudChwYXRoKSwg
        dGFyZ2V0LCBtZXRob2QpOwogIEVtYmVyLndhdGNoKG9iaiwgcGF0aCk7CiAg
        cmV0dXJuIHRoaXM7Cn07CgovLyBTdXNwZW5kIG9ic2VydmVyIGR1cmluZyBj
        YWxsYmFjay4KLy8KLy8gVGhpcyBzaG91bGQgb25seSBiZSB1c2VkIGJ5IHRo
        ZSB0YXJnZXQgb2YgdGhlIG9ic2VydmVyCi8vIHdoaWxlIGl0IGlzIHNldHRp
        bmcgdGhlIG9ic2VydmVkIHBhdGguCkVtYmVyLl9zdXNwZW5kQmVmb3JlT2Jz
        ZXJ2ZXIgPSBmdW5jdGlvbihvYmosIHBhdGgsIHRhcmdldCwgbWV0aG9kLCBj
        YWxsYmFjaykgewogIHJldHVybiBFbWJlci5fc3VzcGVuZExpc3RlbmVyKG9i
        aiwgYmVmb3JlRXZlbnQocGF0aCksIHRhcmdldCwgbWV0aG9kLCBjYWxsYmFj
        ayk7Cn07CgpFbWJlci5fc3VzcGVuZE9ic2VydmVyID0gZnVuY3Rpb24ob2Jq
        LCBwYXRoLCB0YXJnZXQsIG1ldGhvZCwgY2FsbGJhY2spIHsKICByZXR1cm4g
        RW1iZXIuX3N1c3BlbmRMaXN0ZW5lcihvYmosIGNoYW5nZUV2ZW50KHBhdGgp
        LCB0YXJnZXQsIG1ldGhvZCwgY2FsbGJhY2spOwp9OwoKdmFyIG1hcCA9IEVt
        YmVyLkFycmF5UG9seWZpbGxzLm1hcDsKCkVtYmVyLl9zdXNwZW5kQmVmb3Jl
        T2JzZXJ2ZXJzID0gZnVuY3Rpb24ob2JqLCBwYXRocywgdGFyZ2V0LCBtZXRo
        b2QsIGNhbGxiYWNrKSB7CiAgdmFyIGV2ZW50cyA9IG1hcC5jYWxsKHBhdGhz
        LCBiZWZvcmVFdmVudCk7CiAgcmV0dXJuIEVtYmVyLl9zdXNwZW5kTGlzdGVu
        ZXJzKG9iaiwgZXZlbnRzLCB0YXJnZXQsIG1ldGhvZCwgY2FsbGJhY2spOwp9
        OwoKRW1iZXIuX3N1c3BlbmRPYnNlcnZlcnMgPSBmdW5jdGlvbihvYmosIHBh
        dGhzLCB0YXJnZXQsIG1ldGhvZCwgY2FsbGJhY2spIHsKICB2YXIgZXZlbnRz
        ID0gbWFwLmNhbGwocGF0aHMsIGNoYW5nZUV2ZW50KTsKICByZXR1cm4gRW1i
        ZXIuX3N1c3BlbmRMaXN0ZW5lcnMob2JqLCBldmVudHMsIHRhcmdldCwgbWV0
        aG9kLCBjYWxsYmFjayk7Cn07CgpFbWJlci5iZWZvcmVPYnNlcnZlcnNGb3Ig
        PSBmdW5jdGlvbihvYmosIHBhdGgpIHsKICByZXR1cm4gRW1iZXIubGlzdGVu
        ZXJzRm9yKG9iaiwgYmVmb3JlRXZlbnQocGF0aCkpOwp9OwoKLyoqCiAgQG1l
        dGhvZCByZW1vdmVCZWZvcmVPYnNlcnZlcgogIEBwYXJhbSBvYmoKICBAcGFy
        YW0ge1N0cmluZ30gcGF0aAogIEBwYXJhbSB7T2JqZWN0fEZ1bmN0aW9ufSB0
        YXJnZXRPck1ldGhvZAogIEBwYXJhbSB7RnVuY3Rpb258U3RyaW5nfSBbbWV0
        aG9kXQoqLwpFbWJlci5yZW1vdmVCZWZvcmVPYnNlcnZlciA9IGZ1bmN0aW9u
        KG9iaiwgcGF0aCwgdGFyZ2V0LCBtZXRob2QpIHsKICBFbWJlci51bndhdGNo
        KG9iaiwgcGF0aCk7CiAgRW1iZXIucmVtb3ZlTGlzdGVuZXIob2JqLCBiZWZv
        cmVFdmVudChwYXRoKSwgdGFyZ2V0LCBtZXRob2QpOwogIHJldHVybiB0aGlz
        Owp9Owp9KSgpOwoKCgooZnVuY3Rpb24oKSB7CmRlZmluZSgiYmFja2J1cm5l
        ci9xdWV1ZSIsCiAgWyJleHBvcnRzIl0sCiAgZnVuY3Rpb24oX19leHBvcnRz
        X18pIHsKICAgICJ1c2Ugc3RyaWN0IjsKICAgIGZ1bmN0aW9uIFF1ZXVlKGRh
        cSwgbmFtZSwgb3B0aW9ucykgewogICAgICB0aGlzLmRhcSA9IGRhcTsKICAg
        ICAgdGhpcy5uYW1lID0gbmFtZTsKICAgICAgdGhpcy5vcHRpb25zID0gb3B0
        aW9uczsKICAgICAgdGhpcy5fcXVldWUgPSBbXTsKICAgIH0KCiAgICBRdWV1
        ZS5wcm90b3R5cGUgPSB7CiAgICAgIGRhcTogbnVsbCwKICAgICAgbmFtZTog
        bnVsbCwKICAgICAgb3B0aW9uczogbnVsbCwKICAgICAgX3F1ZXVlOiBudWxs
        LAoKICAgICAgcHVzaDogZnVuY3Rpb24odGFyZ2V0LCBtZXRob2QsIGFyZ3Ms
        IHN0YWNrKSB7CiAgICAgICAgdmFyIHF1ZXVlID0gdGhpcy5fcXVldWU7CiAg
        ICAgICAgcXVldWUucHVzaCh0YXJnZXQsIG1ldGhvZCwgYXJncywgc3RhY2sp
        OwogICAgICAgIHJldHVybiB7cXVldWU6IHRoaXMsIHRhcmdldDogdGFyZ2V0
        LCBtZXRob2Q6IG1ldGhvZH07CiAgICAgIH0sCgogICAgICBwdXNoVW5pcXVl
        OiBmdW5jdGlvbih0YXJnZXQsIG1ldGhvZCwgYXJncywgc3RhY2spIHsKICAg
        ICAgICB2YXIgcXVldWUgPSB0aGlzLl9xdWV1ZSwgY3VycmVudFRhcmdldCwg
        Y3VycmVudE1ldGhvZCwgaSwgbDsKCiAgICAgICAgZm9yIChpID0gMCwgbCA9
        IHF1ZXVlLmxlbmd0aDsgaSA8IGw7IGkgKz0gNCkgewogICAgICAgICAgY3Vy
        cmVudFRhcmdldCA9IHF1ZXVlW2ldOwogICAgICAgICAgY3VycmVudE1ldGhv
        ZCA9IHF1ZXVlW2krMV07CgogICAgICAgICAgaWYgKGN1cnJlbnRUYXJnZXQg
        PT09IHRhcmdldCAmJiBjdXJyZW50TWV0aG9kID09PSBtZXRob2QpIHsKICAg
        ICAgICAgICAgcXVldWVbaSsyXSA9IGFyZ3M7IC8vIHJlcGxhY2UgYXJncwog
        ICAgICAgICAgICBxdWV1ZVtpKzNdID0gc3RhY2s7IC8vIHJlcGxhY2Ugc3Rh
        Y2sKICAgICAgICAgICAgcmV0dXJuIHtxdWV1ZTogdGhpcywgdGFyZ2V0OiB0
        YXJnZXQsIG1ldGhvZDogbWV0aG9kfTsgLy8gVE9ETzogdGVzdCB0aGlzIGNv
        ZGUgcGF0aAogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgdGhpcy5f
        cXVldWUucHVzaCh0YXJnZXQsIG1ldGhvZCwgYXJncywgc3RhY2spOwogICAg
        ICAgIHJldHVybiB7cXVldWU6IHRoaXMsIHRhcmdldDogdGFyZ2V0LCBtZXRo
        b2Q6IG1ldGhvZH07CiAgICAgIH0sCgogICAgICAvLyBUT0RPOiByZW1vdmUg
        bWUsIG9ubHkgYmVpbmcgdXNlZCBmb3IgRW1iZXIucnVuLnN5bmMKICAgICAg
        Zmx1c2g6IGZ1bmN0aW9uKCkgewogICAgICAgIHZhciBxdWV1ZSA9IHRoaXMu
        X3F1ZXVlLAogICAgICAgICAgICBvcHRpb25zID0gdGhpcy5vcHRpb25zLAog
        ICAgICAgICAgICBiZWZvcmUgPSBvcHRpb25zICYmIG9wdGlvbnMuYmVmb3Jl
        LAogICAgICAgICAgICBhZnRlciA9IG9wdGlvbnMgJiYgb3B0aW9ucy5hZnRl
        ciwKICAgICAgICAgICAgdGFyZ2V0LCBtZXRob2QsIGFyZ3MsIHN0YWNrLCBp
        LCBsID0gcXVldWUubGVuZ3RoOwoKICAgICAgICBpZiAobCAmJiBiZWZvcmUp
        IHsgYmVmb3JlKCk7IH0KICAgICAgICBmb3IgKGkgPSAwOyBpIDwgbDsgaSAr
        PSA0KSB7CiAgICAgICAgICB0YXJnZXQgPSBxdWV1ZVtpXTsKICAgICAgICAg
        IG1ldGhvZCA9IHF1ZXVlW2krMV07CiAgICAgICAgICBhcmdzICAgPSBxdWV1
        ZVtpKzJdOwogICAgICAgICAgc3RhY2sgID0gcXVldWVbaSszXTsgLy8gRGVi
        dWdnaW5nIGFzc2lzdGFuY2UKCiAgICAgICAgICAvLyBUT0RPOiBlcnJvciBo
        YW5kbGluZwogICAgICAgICAgaWYgKGFyZ3MgJiYgYXJncy5sZW5ndGggPiAw
        KSB7CiAgICAgICAgICAgIG1ldGhvZC5hcHBseSh0YXJnZXQsIGFyZ3MpOwog
        ICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgbWV0aG9kLmNhbGwodGFy
        Z2V0KTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgaWYgKGwgJiYg
        YWZ0ZXIpIHsgYWZ0ZXIoKTsgfQoKICAgICAgICAvLyBjaGVjayBpZiBuZXcg
        aXRlbXMgaGF2ZSBiZWVuIGFkZGVkCiAgICAgICAgaWYgKHF1ZXVlLmxlbmd0
        aCA+IGwpIHsKICAgICAgICAgIHRoaXMuX3F1ZXVlID0gcXVldWUuc2xpY2Uo
        bCk7CiAgICAgICAgICB0aGlzLmZsdXNoKCk7CiAgICAgICAgfSBlbHNlIHsK
        ICAgICAgICAgIHRoaXMuX3F1ZXVlLmxlbmd0aCA9IDA7CiAgICAgICAgfQog
        ICAgICB9LAoKICAgICAgY2FuY2VsOiBmdW5jdGlvbihhY3Rpb25Ub0NhbmNl
        bCkgewogICAgICAgIHZhciBxdWV1ZSA9IHRoaXMuX3F1ZXVlLCBjdXJyZW50
        VGFyZ2V0LCBjdXJyZW50TWV0aG9kLCBpLCBsOwoKICAgICAgICBmb3IgKGkg
        PSAwLCBsID0gcXVldWUubGVuZ3RoOyBpIDwgbDsgaSArPSA0KSB7CiAgICAg
        ICAgICBjdXJyZW50VGFyZ2V0ID0gcXVldWVbaV07CiAgICAgICAgICBjdXJy
        ZW50TWV0aG9kID0gcXVldWVbaSsxXTsKCiAgICAgICAgICBpZiAoY3VycmVu
        dFRhcmdldCA9PT0gYWN0aW9uVG9DYW5jZWwudGFyZ2V0ICYmIGN1cnJlbnRN
        ZXRob2QgPT09IGFjdGlvblRvQ2FuY2VsLm1ldGhvZCkgewogICAgICAgICAg
        ICBxdWV1ZS5zcGxpY2UoaSwgNCk7CiAgICAgICAgICAgIHJldHVybiB0cnVl
        OwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgLy8gaWYgbm90IGZv
        dW5kIGluIGN1cnJlbnQgcXVldWUKICAgICAgICAvLyBjb3VsZCBiZSBpbiB0
        aGUgcXVldWUgdGhhdCBpcyBiZWluZyBmbHVzaGVkCiAgICAgICAgcXVldWUg
        PSB0aGlzLl9xdWV1ZUJlaW5nRmx1c2hlZDsKICAgICAgICBpZiAoIXF1ZXVl
        KSB7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIGZvciAo
        aSA9IDAsIGwgPSBxdWV1ZS5sZW5ndGg7IGkgPCBsOyBpICs9IDQpIHsKICAg
        ICAgICAgIGN1cnJlbnRUYXJnZXQgPSBxdWV1ZVtpXTsKICAgICAgICAgIGN1
        cnJlbnRNZXRob2QgPSBxdWV1ZVtpKzFdOwoKICAgICAgICAgIGlmIChjdXJy
        ZW50VGFyZ2V0ID09PSBhY3Rpb25Ub0NhbmNlbC50YXJnZXQgJiYgY3VycmVu
        dE1ldGhvZCA9PT0gYWN0aW9uVG9DYW5jZWwubWV0aG9kKSB7CiAgICAgICAg
        ICAgIC8vIGRvbid0IG1lc3Mgd2l0aCBhcnJheSBkdXJpbmcgZmx1c2gKICAg
        ICAgICAgICAgLy8ganVzdCBudWxsaWZ5IHRoZSBtZXRob2QKICAgICAgICAg
        ICAgcXVldWVbaSsxXSA9IG51bGw7CiAgICAgICAgICAgIHJldHVybiB0cnVl
        OwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfTsKCgogICAg
        X19leHBvcnRzX18uUXVldWUgPSBRdWV1ZTsKICB9KTsKCmRlZmluZSgiYmFj
        a2J1cm5lci9kZWZlcnJlZF9hY3Rpb25fcXVldWVzIiwKICBbImJhY2tidXJu
        ZXIvcXVldWUiLCJleHBvcnRzIl0sCiAgZnVuY3Rpb24oX19kZXBlbmRlbmN5
        MV9fLCBfX2V4cG9ydHNfXykgewogICAgInVzZSBzdHJpY3QiOwogICAgdmFy
        IFF1ZXVlID0gX19kZXBlbmRlbmN5MV9fLlF1ZXVlOwoKICAgIGZ1bmN0aW9u
        IERlZmVycmVkQWN0aW9uUXVldWVzKHF1ZXVlTmFtZXMsIG9wdGlvbnMpIHsK
        ICAgICAgdmFyIHF1ZXVlcyA9IHRoaXMucXVldWVzID0ge307CiAgICAgIHRo
        aXMucXVldWVOYW1lcyA9IHF1ZXVlTmFtZXMgPSBxdWV1ZU5hbWVzIHx8IFtd
        OwoKICAgICAgdmFyIHF1ZXVlTmFtZTsKICAgICAgZm9yICh2YXIgaSA9IDAs
        IGwgPSBxdWV1ZU5hbWVzLmxlbmd0aDsgaSA8IGw7IGkrKykgewogICAgICAg
        IHF1ZXVlTmFtZSA9IHF1ZXVlTmFtZXNbaV07CiAgICAgICAgcXVldWVzW3F1
        ZXVlTmFtZV0gPSBuZXcgUXVldWUodGhpcywgcXVldWVOYW1lLCBvcHRpb25z
        W3F1ZXVlTmFtZV0pOwogICAgICB9CiAgICB9CgogICAgRGVmZXJyZWRBY3Rp
        b25RdWV1ZXMucHJvdG90eXBlID0gewogICAgICBxdWV1ZU5hbWVzOiBudWxs
        LAogICAgICBxdWV1ZXM6IG51bGwsCgogICAgICBzY2hlZHVsZTogZnVuY3Rp
        b24ocXVldWVOYW1lLCB0YXJnZXQsIG1ldGhvZCwgYXJncywgb25jZUZsYWcs
        IHN0YWNrKSB7CiAgICAgICAgdmFyIHF1ZXVlcyA9IHRoaXMucXVldWVzLAog
        ICAgICAgICAgICBxdWV1ZSA9IHF1ZXVlc1txdWV1ZU5hbWVdOwoKICAgICAg
        ICBpZiAoIXF1ZXVlKSB7IHRocm93IG5ldyBFcnJvcigiWW91IGF0dGVtcHRl
        ZCB0byBzY2hlZHVsZSBhbiBhY3Rpb24gaW4gYSBxdWV1ZSAoIiArIHF1ZXVl
        TmFtZSArICIpIHRoYXQgZG9lc24ndCBleGlzdCIpOyB9CgogICAgICAgIGlm
        IChvbmNlRmxhZykgewogICAgICAgICAgcmV0dXJuIHF1ZXVlLnB1c2hVbmlx
        dWUodGFyZ2V0LCBtZXRob2QsIGFyZ3MsIHN0YWNrKTsKICAgICAgICB9IGVs
        c2UgewogICAgICAgICAgcmV0dXJuIHF1ZXVlLnB1c2godGFyZ2V0LCBtZXRo
        b2QsIGFyZ3MsIHN0YWNrKTsKICAgICAgICB9CiAgICAgIH0sCgogICAgICBm
        bHVzaDogZnVuY3Rpb24oKSB7CiAgICAgICAgdmFyIHF1ZXVlcyA9IHRoaXMu
        cXVldWVzLAogICAgICAgICAgICBxdWV1ZU5hbWVzID0gdGhpcy5xdWV1ZU5h
        bWVzLAogICAgICAgICAgICBxdWV1ZU5hbWUsIHF1ZXVlLCBxdWV1ZUl0ZW1z
        LCBwcmlvclF1ZXVlTmFtZUluZGV4LAogICAgICAgICAgICBxdWV1ZU5hbWVJ
        bmRleCA9IDAsIG51bWJlck9mUXVldWVzID0gcXVldWVOYW1lcy5sZW5ndGg7
        CgogICAgICAgIG91dGVybG9vcDoKICAgICAgICB3aGlsZSAocXVldWVOYW1l
        SW5kZXggPCBudW1iZXJPZlF1ZXVlcykgewogICAgICAgICAgcXVldWVOYW1l
        ID0gcXVldWVOYW1lc1txdWV1ZU5hbWVJbmRleF07CiAgICAgICAgICBxdWV1
        ZSA9IHF1ZXVlc1txdWV1ZU5hbWVdOwogICAgICAgICAgcXVldWVJdGVtcyA9
        IHF1ZXVlLl9xdWV1ZUJlaW5nRmx1c2hlZCA9IHF1ZXVlLl9xdWV1ZS5zbGlj
        ZSgpOwogICAgICAgICAgcXVldWUuX3F1ZXVlID0gW107CgogICAgICAgICAg
        dmFyIG9wdGlvbnMgPSBxdWV1ZS5vcHRpb25zLAogICAgICAgICAgICAgIGJl
        Zm9yZSA9IG9wdGlvbnMgJiYgb3B0aW9ucy5iZWZvcmUsCiAgICAgICAgICAg
        ICAgYWZ0ZXIgPSBvcHRpb25zICYmIG9wdGlvbnMuYWZ0ZXIsCiAgICAgICAg
        ICAgICAgdGFyZ2V0LCBtZXRob2QsIGFyZ3MsIHN0YWNrLAogICAgICAgICAg
        ICAgIHF1ZXVlSW5kZXggPSAwLCBudW1iZXJPZlF1ZXVlSXRlbXMgPSBxdWV1
        ZUl0ZW1zLmxlbmd0aDsKCiAgICAgICAgICBpZiAobnVtYmVyT2ZRdWV1ZUl0
        ZW1zICYmIGJlZm9yZSkgeyBiZWZvcmUoKTsgfQogICAgICAgICAgd2hpbGUg
        KHF1ZXVlSW5kZXggPCBudW1iZXJPZlF1ZXVlSXRlbXMpIHsKICAgICAgICAg
        ICAgdGFyZ2V0ID0gcXVldWVJdGVtc1txdWV1ZUluZGV4XTsKICAgICAgICAg
        ICAgbWV0aG9kID0gcXVldWVJdGVtc1txdWV1ZUluZGV4KzFdOwogICAgICAg
        ICAgICBhcmdzICAgPSBxdWV1ZUl0ZW1zW3F1ZXVlSW5kZXgrMl07CiAgICAg
        ICAgICAgIHN0YWNrICA9IHF1ZXVlSXRlbXNbcXVldWVJbmRleCszXTsgLy8g
        RGVidWdnaW5nIGFzc2lzdGFuY2UKCiAgICAgICAgICAgIGlmICh0eXBlb2Yg
        bWV0aG9kID09PSAnc3RyaW5nJykgeyBtZXRob2QgPSB0YXJnZXRbbWV0aG9k
        XTsgfQoKICAgICAgICAgICAgLy8gbWV0aG9kIGNvdWxkIGhhdmUgYmVlbiBu
        dWxsaWZpZWQgLyBjYW5jZWxlZCBkdXJpbmcgZmx1c2gKICAgICAgICAgICAg
        aWYgKG1ldGhvZCkgewogICAgICAgICAgICAgIC8vIFRPRE86IGVycm9yIGhh
        bmRsaW5nCiAgICAgICAgICAgICAgaWYgKGFyZ3MgJiYgYXJncy5sZW5ndGgg
        PiAwKSB7CiAgICAgICAgICAgICAgICBtZXRob2QuYXBwbHkodGFyZ2V0LCBh
        cmdzKTsKICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAg
        bWV0aG9kLmNhbGwodGFyZ2V0KTsKICAgICAgICAgICAgICB9CiAgICAgICAg
        ICAgIH0KCiAgICAgICAgICAgIHF1ZXVlSW5kZXggKz0gNDsKICAgICAgICAg
        IH0KICAgICAgICAgIHF1ZXVlLl9xdWV1ZUJlaW5nRmx1c2hlZCA9IG51bGw7
        CiAgICAgICAgICBpZiAobnVtYmVyT2ZRdWV1ZUl0ZW1zICYmIGFmdGVyKSB7
        IGFmdGVyKCk7IH0KCiAgICAgICAgICBpZiAoKHByaW9yUXVldWVOYW1lSW5k
        ZXggPSBpbmRleE9mUHJpb3JRdWV1ZVdpdGhBY3Rpb25zKHRoaXMsIHF1ZXVl
        TmFtZUluZGV4KSkgIT09IC0xKSB7CiAgICAgICAgICAgIHF1ZXVlTmFtZUlu
        ZGV4ID0gcHJpb3JRdWV1ZU5hbWVJbmRleDsKICAgICAgICAgICAgY29udGlu
        dWUgb3V0ZXJsb29wOwogICAgICAgICAgfQoKICAgICAgICAgIHF1ZXVlTmFt
        ZUluZGV4Kys7CiAgICAgICAgfQogICAgICB9CiAgICB9OwoKICAgIGZ1bmN0
        aW9uIGluZGV4T2ZQcmlvclF1ZXVlV2l0aEFjdGlvbnMoZGFxLCBjdXJyZW50
        UXVldWVJbmRleCkgewogICAgICB2YXIgcXVldWVOYW1lLCBxdWV1ZTsKCiAg
        ICAgIGZvciAodmFyIGkgPSAwLCBsID0gY3VycmVudFF1ZXVlSW5kZXg7IGkg
        PD0gbDsgaSsrKSB7CiAgICAgICAgcXVldWVOYW1lID0gZGFxLnF1ZXVlTmFt
        ZXNbaV07CiAgICAgICAgcXVldWUgPSBkYXEucXVldWVzW3F1ZXVlTmFtZV07
        CiAgICAgICAgaWYgKHF1ZXVlLl9xdWV1ZS5sZW5ndGgpIHsgcmV0dXJuIGk7
        IH0KICAgICAgfQoKICAgICAgcmV0dXJuIC0xOwogICAgfQoKCiAgICBfX2V4
        cG9ydHNfXy5EZWZlcnJlZEFjdGlvblF1ZXVlcyA9IERlZmVycmVkQWN0aW9u
        UXVldWVzOwogIH0pOwoKZGVmaW5lKCJiYWNrYnVybmVyIiwKICBbImJhY2ti
        dXJuZXIvZGVmZXJyZWRfYWN0aW9uX3F1ZXVlcyIsImV4cG9ydHMiXSwKICBm
        dW5jdGlvbihfX2RlcGVuZGVuY3kxX18sIF9fZXhwb3J0c19fKSB7CiAgICAi
        dXNlIHN0cmljdCI7CiAgICB2YXIgRGVmZXJyZWRBY3Rpb25RdWV1ZXMgPSBf
        X2RlcGVuZGVuY3kxX18uRGVmZXJyZWRBY3Rpb25RdWV1ZXM7CgogICAgdmFy
        IHNsaWNlID0gW10uc2xpY2UsCiAgICAgICAgcG9wID0gW10ucG9wLAogICAg
        ICAgIHRocm90dGxlcnMgPSBbXSwKICAgICAgICBkZWJvdW5jZWVzID0gW10s
        CiAgICAgICAgdGltZXJzID0gW10sCiAgICAgICAgYXV0b3J1biwgbGF0ZXJU
        aW1lciwgbGF0ZXJUaW1lckV4cGlyZXNBdCwKICAgICAgICBnbG9iYWwgPSB0
        aGlzLAogICAgICAgIE5VTUJFUiA9IC9cZCsvOwoKICAgIGZ1bmN0aW9uIGlz
        Q29lcmNhYmxlTnVtYmVyKG51bWJlcikgewogICAgICByZXR1cm4gdHlwZW9m
        IG51bWJlciA9PT0gJ251bWJlcicgfHwgTlVNQkVSLnRlc3QobnVtYmVyKTsK
        ICAgIH0KCiAgICBmdW5jdGlvbiBCYWNrYnVybmVyKHF1ZXVlTmFtZXMsIG9w
        dGlvbnMpIHsKICAgICAgdGhpcy5xdWV1ZU5hbWVzID0gcXVldWVOYW1lczsK
        ICAgICAgdGhpcy5vcHRpb25zID0gb3B0aW9ucyB8fCB7fTsKICAgICAgaWYg
        KCF0aGlzLm9wdGlvbnMuZGVmYXVsdFF1ZXVlKSB7CiAgICAgICAgdGhpcy5v
        cHRpb25zLmRlZmF1bHRRdWV1ZSA9IHF1ZXVlTmFtZXNbMF07CiAgICAgIH0K
        ICAgICAgdGhpcy5pbnN0YW5jZVN0YWNrID0gW107CiAgICB9CgogICAgQmFj
        a2J1cm5lci5wcm90b3R5cGUgPSB7CiAgICAgIHF1ZXVlTmFtZXM6IG51bGws
        CiAgICAgIG9wdGlvbnM6IG51bGwsCiAgICAgIGN1cnJlbnRJbnN0YW5jZTog
        bnVsbCwKICAgICAgaW5zdGFuY2VTdGFjazogbnVsbCwKCiAgICAgIGJlZ2lu
        OiBmdW5jdGlvbigpIHsKICAgICAgICB2YXIgb25CZWdpbiA9IHRoaXMub3B0
        aW9ucyAmJiB0aGlzLm9wdGlvbnMub25CZWdpbiwKICAgICAgICAgICAgcHJl
        dmlvdXNJbnN0YW5jZSA9IHRoaXMuY3VycmVudEluc3RhbmNlOwoKICAgICAg
        ICBpZiAocHJldmlvdXNJbnN0YW5jZSkgewogICAgICAgICAgdGhpcy5pbnN0
        YW5jZVN0YWNrLnB1c2gocHJldmlvdXNJbnN0YW5jZSk7CiAgICAgICAgfQoK
        ICAgICAgICB0aGlzLmN1cnJlbnRJbnN0YW5jZSA9IG5ldyBEZWZlcnJlZEFj
        dGlvblF1ZXVlcyh0aGlzLnF1ZXVlTmFtZXMsIHRoaXMub3B0aW9ucyk7CiAg
        ICAgICAgaWYgKG9uQmVnaW4pIHsKICAgICAgICAgIG9uQmVnaW4odGhpcy5j
        dXJyZW50SW5zdGFuY2UsIHByZXZpb3VzSW5zdGFuY2UpOwogICAgICAgIH0K
        ICAgICAgfSwKCiAgICAgIGVuZDogZnVuY3Rpb24oKSB7CiAgICAgICAgdmFy
        IG9uRW5kID0gdGhpcy5vcHRpb25zICYmIHRoaXMub3B0aW9ucy5vbkVuZCwK
        ICAgICAgICAgICAgY3VycmVudEluc3RhbmNlID0gdGhpcy5jdXJyZW50SW5z
        dGFuY2UsCiAgICAgICAgICAgIG5leHRJbnN0YW5jZSA9IG51bGw7CgogICAg
        ICAgIHRyeSB7CiAgICAgICAgICBjdXJyZW50SW5zdGFuY2UuZmx1c2goKTsK
        ICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgdGhpcy5jdXJyZW50SW5z
        dGFuY2UgPSBudWxsOwoKICAgICAgICAgIGlmICh0aGlzLmluc3RhbmNlU3Rh
        Y2subGVuZ3RoKSB7CiAgICAgICAgICAgIG5leHRJbnN0YW5jZSA9IHRoaXMu
        aW5zdGFuY2VTdGFjay5wb3AoKTsKICAgICAgICAgICAgdGhpcy5jdXJyZW50
        SW5zdGFuY2UgPSBuZXh0SW5zdGFuY2U7CiAgICAgICAgICB9CgogICAgICAg
        ICAgaWYgKG9uRW5kKSB7CiAgICAgICAgICAgIG9uRW5kKGN1cnJlbnRJbnN0
        YW5jZSwgbmV4dEluc3RhbmNlKTsKICAgICAgICAgIH0KICAgICAgICB9CiAg
        ICAgIH0sCgogICAgICBydW46IGZ1bmN0aW9uKHRhcmdldCwgbWV0aG9kIC8q
        LCBhcmdzICovKSB7CiAgICAgICAgdmFyIHJldDsKICAgICAgICB0aGlzLmJl
        Z2luKCk7CgogICAgICAgIGlmICghbWV0aG9kKSB7CiAgICAgICAgICBtZXRo
        b2QgPSB0YXJnZXQ7CiAgICAgICAgICB0YXJnZXQgPSBudWxsOwogICAgICAg
        IH0KCiAgICAgICAgaWYgKHR5cGVvZiBtZXRob2QgPT09ICdzdHJpbmcnKSB7
        CiAgICAgICAgICBtZXRob2QgPSB0YXJnZXRbbWV0aG9kXTsKICAgICAgICB9
        CgogICAgICAgIC8vIFByZXZlbnQgU2FmYXJpIGRvdWJsZS1maW5hbGx5Lgog
        ICAgICAgIHZhciBmaW5hbGx5QWxyZWFkeUNhbGxlZCA9IGZhbHNlOwogICAg
        ICAgIHRyeSB7CiAgICAgICAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA+IDIp
        IHsKICAgICAgICAgICAgcmV0ID0gbWV0aG9kLmFwcGx5KHRhcmdldCwgc2xp
        Y2UuY2FsbChhcmd1bWVudHMsIDIpKTsKICAgICAgICAgIH0gZWxzZSB7CiAg
        ICAgICAgICAgIHJldCA9IG1ldGhvZC5jYWxsKHRhcmdldCk7CiAgICAgICAg
        ICB9CiAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgIGlmICghZmluYWxs
        eUFscmVhZHlDYWxsZWQpIHsKICAgICAgICAgICAgZmluYWxseUFscmVhZHlD
        YWxsZWQgPSB0cnVlOwogICAgICAgICAgICB0aGlzLmVuZCgpOwogICAgICAg
        ICAgfQogICAgICAgIH0KICAgICAgICByZXR1cm4gcmV0OwogICAgICB9LAoK
        ICAgICAgZGVmZXI6IGZ1bmN0aW9uKHF1ZXVlTmFtZSwgdGFyZ2V0LCBtZXRo
        b2QgLyogLCBhcmdzICovKSB7CiAgICAgICAgaWYgKCFtZXRob2QpIHsKICAg
        ICAgICAgIG1ldGhvZCA9IHRhcmdldDsKICAgICAgICAgIHRhcmdldCA9IG51
        bGw7CiAgICAgICAgfQoKICAgICAgICBpZiAodHlwZW9mIG1ldGhvZCA9PT0g
        J3N0cmluZycpIHsKICAgICAgICAgIG1ldGhvZCA9IHRhcmdldFttZXRob2Rd
        OwogICAgICAgIH0KCiAgICAgICAgdmFyIHN0YWNrID0gdGhpcy5ERUJVRyA/
        IG5ldyBFcnJvcigpLnN0YWNrIDogdW5kZWZpbmVkLAogICAgICAgICAgICBh
        cmdzID0gYXJndW1lbnRzLmxlbmd0aCA+IDMgPyBzbGljZS5jYWxsKGFyZ3Vt
        ZW50cywgMykgOiB1bmRlZmluZWQ7CiAgICAgICAgaWYgKCF0aGlzLmN1cnJl
        bnRJbnN0YW5jZSkgeyBjcmVhdGVBdXRvcnVuKHRoaXMpOyB9CiAgICAgICAg
        cmV0dXJuIHRoaXMuY3VycmVudEluc3RhbmNlLnNjaGVkdWxlKHF1ZXVlTmFt
        ZSwgdGFyZ2V0LCBtZXRob2QsIGFyZ3MsIGZhbHNlLCBzdGFjayk7CiAgICAg
        IH0sCgogICAgICBkZWZlck9uY2U6IGZ1bmN0aW9uKHF1ZXVlTmFtZSwgdGFy
        Z2V0LCBtZXRob2QgLyogLCBhcmdzICovKSB7CiAgICAgICAgaWYgKCFtZXRo
        b2QpIHsKICAgICAgICAgIG1ldGhvZCA9IHRhcmdldDsKICAgICAgICAgIHRh
        cmdldCA9IG51bGw7CiAgICAgICAgfQoKICAgICAgICBpZiAodHlwZW9mIG1l
        dGhvZCA9PT0gJ3N0cmluZycpIHsKICAgICAgICAgIG1ldGhvZCA9IHRhcmdl
        dFttZXRob2RdOwogICAgICAgIH0KCiAgICAgICAgdmFyIHN0YWNrID0gdGhp
        cy5ERUJVRyA/IG5ldyBFcnJvcigpLnN0YWNrIDogdW5kZWZpbmVkLAogICAg
        ICAgICAgICBhcmdzID0gYXJndW1lbnRzLmxlbmd0aCA+IDMgPyBzbGljZS5j
        YWxsKGFyZ3VtZW50cywgMykgOiB1bmRlZmluZWQ7CiAgICAgICAgaWYgKCF0
        aGlzLmN1cnJlbnRJbnN0YW5jZSkgeyBjcmVhdGVBdXRvcnVuKHRoaXMpOyB9
        CiAgICAgICAgcmV0dXJuIHRoaXMuY3VycmVudEluc3RhbmNlLnNjaGVkdWxl
        KHF1ZXVlTmFtZSwgdGFyZ2V0LCBtZXRob2QsIGFyZ3MsIHRydWUsIHN0YWNr
        KTsKICAgICAgfSwKCiAgICAgIHNldFRpbWVvdXQ6IGZ1bmN0aW9uKCkgewog
        ICAgICAgIHZhciBhcmdzID0gc2xpY2UuY2FsbChhcmd1bWVudHMpOwogICAg
        ICAgIHZhciBsZW5ndGggPSBhcmdzLmxlbmd0aDsKICAgICAgICB2YXIgbWV0
        aG9kLCB3YWl0LCB0YXJnZXQ7CiAgICAgICAgdmFyIHNlbGYgPSB0aGlzOwog
        ICAgICAgIHZhciBtZXRob2RPclRhcmdldCwgbWV0aG9kT3JXYWl0LCBtZXRo
        b2RPckFyZ3M7CgogICAgICAgIGlmIChsZW5ndGggPT09IDApIHsKICAgICAg
        ICAgIHJldHVybjsKICAgICAgICB9IGVsc2UgaWYgKGxlbmd0aCA9PT0gMSkg
        ewogICAgICAgICAgbWV0aG9kID0gYXJncy5zaGlmdCgpOwogICAgICAgICAg
        d2FpdCA9IDA7CiAgICAgICAgfSBlbHNlIGlmIChsZW5ndGggPT09IDIpIHsK
        ICAgICAgICAgIG1ldGhvZE9yVGFyZ2V0ID0gYXJnc1swXTsKICAgICAgICAg
        IG1ldGhvZE9yV2FpdCA9IGFyZ3NbMV07CgogICAgICAgICAgaWYgKHR5cGVv
        ZiBtZXRob2RPcldhaXQgPT09ICdmdW5jdGlvbicgfHwgdHlwZW9mICBtZXRo
        b2RPclRhcmdldFttZXRob2RPcldhaXRdID09PSAnZnVuY3Rpb24nKSB7CiAg
        ICAgICAgICAgIHRhcmdldCA9IGFyZ3Muc2hpZnQoKTsKICAgICAgICAgICAg
        bWV0aG9kID0gYXJncy5zaGlmdCgpOwogICAgICAgICAgICB3YWl0ID0gMDsK
        ICAgICAgICAgIH0gZWxzZSBpZiAoaXNDb2VyY2FibGVOdW1iZXIobWV0aG9k
        T3JXYWl0KSkgewogICAgICAgICAgICBtZXRob2QgPSBhcmdzLnNoaWZ0KCk7
        CiAgICAgICAgICAgIHdhaXQgPSBhcmdzLnNoaWZ0KCk7CiAgICAgICAgICB9
        IGVsc2UgewogICAgICAgICAgICBtZXRob2QgPSBhcmdzLnNoaWZ0KCk7CiAg
        ICAgICAgICAgIHdhaXQgPSAgMDsKICAgICAgICAgIH0KICAgICAgICB9IGVs
        c2UgewogICAgICAgICAgdmFyIGxhc3QgPSBhcmdzW2FyZ3MubGVuZ3RoIC0g
        MV07CgogICAgICAgICAgaWYgKGlzQ29lcmNhYmxlTnVtYmVyKGxhc3QpKSB7
        CiAgICAgICAgICAgIHdhaXQgPSBhcmdzLnBvcCgpOwogICAgICAgICAgfQoK
        ICAgICAgICAgIG1ldGhvZE9yVGFyZ2V0ID0gYXJnc1swXTsKICAgICAgICAg
        IG1ldGhvZE9yQXJncyA9IGFyZ3NbMV07CgogICAgICAgICAgaWYgKHR5cGVv
        ZiBtZXRob2RPckFyZ3MgPT09ICdmdW5jdGlvbicgfHwgKHR5cGVvZiBtZXRo
        b2RPckFyZ3MgPT09ICdzdHJpbmcnICYmCiAgICAgICAgICAgICAgICAgICAg
        ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWV0aG9kT3JUYXJn
        ZXQgIT09IG51bGwgJiYKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
        ICAgICAgICAgICAgICAgICAgICAgICBtZXRob2RPckFyZ3MgaW4gbWV0aG9k
        T3JUYXJnZXQpKSB7CiAgICAgICAgICAgIHRhcmdldCA9IGFyZ3Muc2hpZnQo
        KTsKICAgICAgICAgICAgbWV0aG9kID0gYXJncy5zaGlmdCgpOwogICAgICAg
        ICAgfSBlbHNlIHsKICAgICAgICAgICAgbWV0aG9kID0gYXJncy5zaGlmdCgp
        OwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgdmFyIGV4ZWN1dGVB
        dCA9ICgrbmV3IERhdGUoKSkgKyBwYXJzZUludCh3YWl0LCAxMCk7CgogICAg
        ICAgIGlmICh0eXBlb2YgbWV0aG9kID09PSAnc3RyaW5nJykgewogICAgICAg
        ICAgbWV0aG9kID0gdGFyZ2V0W21ldGhvZF07CiAgICAgICAgfQoKICAgICAg
        ICBmdW5jdGlvbiBmbigpIHsKICAgICAgICAgIG1ldGhvZC5hcHBseSh0YXJn
        ZXQsIGFyZ3MpOwogICAgICAgIH0KCiAgICAgICAgLy8gZmluZCBwb3NpdGlv
        biB0byBpbnNlcnQgLSBUT0RPOiBiaW5hcnkgc2VhcmNoCiAgICAgICAgdmFy
        IGksIGw7CiAgICAgICAgZm9yIChpID0gMCwgbCA9IHRpbWVycy5sZW5ndGg7
        IGkgPCBsOyBpICs9IDIpIHsKICAgICAgICAgIGlmIChleGVjdXRlQXQgPCB0
        aW1lcnNbaV0pIHsgYnJlYWs7IH0KICAgICAgICB9CgogICAgICAgIHRpbWVy
        cy5zcGxpY2UoaSwgMCwgZXhlY3V0ZUF0LCBmbik7CgogICAgICAgIGlmIChs
        YXRlclRpbWVyICYmIGxhdGVyVGltZXJFeHBpcmVzQXQgPCBleGVjdXRlQXQp
        IHsgcmV0dXJuIGZuOyB9CgogICAgICAgIGlmIChsYXRlclRpbWVyKSB7CiAg
        ICAgICAgICBjbGVhclRpbWVvdXQobGF0ZXJUaW1lcik7CiAgICAgICAgICBs
        YXRlclRpbWVyID0gbnVsbDsKICAgICAgICB9CiAgICAgICAgbGF0ZXJUaW1l
        ciA9IGdsb2JhbC5zZXRUaW1lb3V0KGZ1bmN0aW9uKCkgewogICAgICAgICAg
        ZXhlY3V0ZVRpbWVycyhzZWxmKTsKICAgICAgICAgIGxhdGVyVGltZXIgPSBu
        dWxsOwogICAgICAgICAgbGF0ZXJUaW1lckV4cGlyZXNBdCA9IG51bGw7CiAg
        ICAgICAgfSwgd2FpdCk7CiAgICAgICAgbGF0ZXJUaW1lckV4cGlyZXNBdCA9
        IGV4ZWN1dGVBdDsKCiAgICAgICAgcmV0dXJuIGZuOwogICAgICB9LAoKICAg
        ICAgdGhyb3R0bGU6IGZ1bmN0aW9uKHRhcmdldCwgbWV0aG9kIC8qICwgYXJn
        cywgd2FpdCAqLykgewogICAgICAgIHZhciBzZWxmID0gdGhpcywKICAgICAg
        ICAgICAgYXJncyA9IGFyZ3VtZW50cywKICAgICAgICAgICAgd2FpdCA9IHBv
        cC5jYWxsKGFyZ3MpLAogICAgICAgICAgICB0aHJvdHRsZXI7CgogICAgICAg
        IGZvciAodmFyIGkgPSAwLCBsID0gdGhyb3R0bGVycy5sZW5ndGg7IGkgPCBs
        OyBpKyspIHsKICAgICAgICAgIHRocm90dGxlciA9IHRocm90dGxlcnNbaV07
        CiAgICAgICAgICBpZiAodGhyb3R0bGVyWzBdID09PSB0YXJnZXQgJiYgdGhy
        b3R0bGVyWzFdID09PSBtZXRob2QpIHsgcmV0dXJuOyB9IC8vIGRvIG5vdGhp
        bmcKICAgICAgICB9CgogICAgICAgIHZhciB0aW1lciA9IGdsb2JhbC5zZXRU
        aW1lb3V0KGZ1bmN0aW9uKCkgewogICAgICAgICAgc2VsZi5ydW4uYXBwbHko
        c2VsZiwgYXJncyk7CgogICAgICAgICAgLy8gcmVtb3ZlIHRocm90dGxlcgog
        ICAgICAgICAgdmFyIGluZGV4ID0gLTE7CiAgICAgICAgICBmb3IgKHZhciBp
        ID0gMCwgbCA9IHRocm90dGxlcnMubGVuZ3RoOyBpIDwgbDsgaSsrKSB7CiAg
        ICAgICAgICAgIHRocm90dGxlciA9IHRocm90dGxlcnNbaV07CiAgICAgICAg
        ICAgIGlmICh0aHJvdHRsZXJbMF0gPT09IHRhcmdldCAmJiB0aHJvdHRsZXJb
        MV0gPT09IG1ldGhvZCkgewogICAgICAgICAgICAgIGluZGV4ID0gaTsKICAg
        ICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQogICAgICAgICAgfQoK
        ICAgICAgICAgIGlmIChpbmRleCA+IC0xKSB7IHRocm90dGxlcnMuc3BsaWNl
        KGluZGV4LCAxKTsgfQogICAgICAgIH0sIHdhaXQpOwoKICAgICAgICB0aHJv
        dHRsZXJzLnB1c2goW3RhcmdldCwgbWV0aG9kLCB0aW1lcl0pOwogICAgICB9
        LAoKICAgICAgZGVib3VuY2U6IGZ1bmN0aW9uKHRhcmdldCwgbWV0aG9kIC8q
        ICwgYXJncywgd2FpdCwgW2ltbWVkaWF0ZV0gKi8pIHsKICAgICAgICB2YXIg
        c2VsZiA9IHRoaXMsCiAgICAgICAgICAgIGFyZ3MgPSBhcmd1bWVudHMsCiAg
        ICAgICAgICAgIGltbWVkaWF0ZSA9IHBvcC5jYWxsKGFyZ3MpLAogICAgICAg
        ICAgICB3YWl0LAogICAgICAgICAgICBpbmRleCwKICAgICAgICAgICAgZGVi
        b3VuY2VlOwoKICAgICAgICBpZiAodHlwZW9mIGltbWVkaWF0ZSA9PT0gIm51
        bWJlciIpIHsKICAgICAgICAgIHdhaXQgPSBpbW1lZGlhdGU7CiAgICAgICAg
        ICBpbW1lZGlhdGUgPSBmYWxzZTsKICAgICAgICB9IGVsc2UgewogICAgICAg
        ICAgd2FpdCA9IHBvcC5jYWxsKGFyZ3MpOwogICAgICAgIH0KCiAgICAgICAg
        Ly8gUmVtb3ZlIGRlYm91bmNlZQogICAgICAgIGluZGV4ID0gZmluZERlYm91
        bmNlZSh0YXJnZXQsIG1ldGhvZCk7CgogICAgICAgIGlmIChpbmRleCAhPT0g
        LTEpIHsKICAgICAgICAgIGRlYm91bmNlZSA9IGRlYm91bmNlZXNbaW5kZXhd
        OwogICAgICAgICAgZGVib3VuY2Vlcy5zcGxpY2UoaW5kZXgsIDEpOwogICAg
        ICAgICAgY2xlYXJUaW1lb3V0KGRlYm91bmNlZVsyXSk7CiAgICAgICAgfQoK
        ICAgICAgICB2YXIgdGltZXIgPSBnbG9iYWwuc2V0VGltZW91dChmdW5jdGlv
        bigpIHsKICAgICAgICAgIGlmICghaW1tZWRpYXRlKSB7CiAgICAgICAgICAg
        IHNlbGYucnVuLmFwcGx5KHNlbGYsIGFyZ3MpOwogICAgICAgICAgfQogICAg
        ICAgICAgaW5kZXggPSBmaW5kRGVib3VuY2VlKHRhcmdldCwgbWV0aG9kKTsK
        ICAgICAgICAgIGlmIChpbmRleCkgewogICAgICAgICAgICBkZWJvdW5jZWVz
        LnNwbGljZShpbmRleCwgMSk7CiAgICAgICAgICB9CiAgICAgICAgfSwgd2Fp
        dCk7CgogICAgICAgIGlmIChpbW1lZGlhdGUgJiYgaW5kZXggPT09IC0xKSB7
        CiAgICAgICAgICBzZWxmLnJ1bi5hcHBseShzZWxmLCBhcmdzKTsKICAgICAg
        ICB9CgogICAgICAgIGRlYm91bmNlZXMucHVzaChbdGFyZ2V0LCBtZXRob2Qs
        IHRpbWVyXSk7CiAgICAgIH0sCgogICAgICBjYW5jZWxUaW1lcnM6IGZ1bmN0
        aW9uKCkgewogICAgICAgIHZhciBpLCBsZW47CgogICAgICAgIGZvciAoaSA9
        IDAsIGxlbiA9IHRocm90dGxlcnMubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHsK
        ICAgICAgICAgIGNsZWFyVGltZW91dCh0aHJvdHRsZXJzW2ldWzJdKTsKICAg
        ICAgICB9CiAgICAgICAgdGhyb3R0bGVycyA9IFtdOwoKICAgICAgICBmb3Ig
        KGkgPSAwLCBsZW4gPSBkZWJvdW5jZWVzLmxlbmd0aDsgaSA8IGxlbjsgaSsr
        KSB7CiAgICAgICAgICBjbGVhclRpbWVvdXQoZGVib3VuY2Vlc1tpXVsyXSk7
        CiAgICAgICAgfQogICAgICAgIGRlYm91bmNlZXMgPSBbXTsKCiAgICAgICAg
        aWYgKGxhdGVyVGltZXIpIHsKICAgICAgICAgIGNsZWFyVGltZW91dChsYXRl
        clRpbWVyKTsKICAgICAgICAgIGxhdGVyVGltZXIgPSBudWxsOwogICAgICAg
        IH0KICAgICAgICB0aW1lcnMgPSBbXTsKCiAgICAgICAgaWYgKGF1dG9ydW4p
        IHsKICAgICAgICAgIGNsZWFyVGltZW91dChhdXRvcnVuKTsKICAgICAgICAg
        IGF1dG9ydW4gPSBudWxsOwogICAgICAgIH0KICAgICAgfSwKCiAgICAgIGhh
        c1RpbWVyczogZnVuY3Rpb24oKSB7CiAgICAgICAgcmV0dXJuICEhdGltZXJz
        Lmxlbmd0aCB8fCBhdXRvcnVuOwogICAgICB9LAoKICAgICAgY2FuY2VsOiBm
        dW5jdGlvbih0aW1lcikgewogICAgICAgIGlmICh0aW1lciAmJiB0eXBlb2Yg
        dGltZXIgPT09ICdvYmplY3QnICYmIHRpbWVyLnF1ZXVlICYmIHRpbWVyLm1l
        dGhvZCkgeyAvLyB3ZSdyZSBjYW5jZWxsaW5nIGEgZGVmZXJPbmNlCiAgICAg
        ICAgICByZXR1cm4gdGltZXIucXVldWUuY2FuY2VsKHRpbWVyKTsKICAgICAg
        ICB9IGVsc2UgaWYgKHR5cGVvZiB0aW1lciA9PT0gJ2Z1bmN0aW9uJykgeyAv
        LyB3ZSdyZSBjYW5jZWxsaW5nIGEgc2V0VGltZW91dAogICAgICAgICAgZm9y
        ICh2YXIgaSA9IDAsIGwgPSB0aW1lcnMubGVuZ3RoOyBpIDwgbDsgaSArPSAy
        KSB7CiAgICAgICAgICAgIGlmICh0aW1lcnNbaSArIDFdID09PSB0aW1lcikg
        ewogICAgICAgICAgICAgIHRpbWVycy5zcGxpY2UoaSwgMik7IC8vIHJlbW92
        ZSB0aGUgdHdvIGVsZW1lbnRzCiAgICAgICAgICAgICAgcmV0dXJuIHRydWU7
        CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9IGVsc2Ugewog
        ICAgICAgICAgcmV0dXJuOyAvLyB0aW1lciB3YXMgbnVsbCBvciBub3QgYSB0
        aW1lcgogICAgICAgIH0KICAgICAgfQogICAgfTsKCiAgICBCYWNrYnVybmVy
        LnByb3RvdHlwZS5zY2hlZHVsZSA9IEJhY2tidXJuZXIucHJvdG90eXBlLmRl
        ZmVyOwogICAgQmFja2J1cm5lci5wcm90b3R5cGUuc2NoZWR1bGVPbmNlID0g
        QmFja2J1cm5lci5wcm90b3R5cGUuZGVmZXJPbmNlOwogICAgQmFja2J1cm5l
        ci5wcm90b3R5cGUubGF0ZXIgPSBCYWNrYnVybmVyLnByb3RvdHlwZS5zZXRU
        aW1lb3V0OwoKICAgIGZ1bmN0aW9uIGNyZWF0ZUF1dG9ydW4oYmFja2J1cm5l
        cikgewogICAgICBiYWNrYnVybmVyLmJlZ2luKCk7CiAgICAgIGF1dG9ydW4g
        PSBnbG9iYWwuc2V0VGltZW91dChmdW5jdGlvbigpIHsKICAgICAgICBhdXRv
        cnVuID0gbnVsbDsKICAgICAgICBiYWNrYnVybmVyLmVuZCgpOwogICAgICB9
        KTsKICAgIH0KCiAgICBmdW5jdGlvbiBleGVjdXRlVGltZXJzKHNlbGYpIHsK
        ICAgICAgdmFyIG5vdyA9ICtuZXcgRGF0ZSgpLAogICAgICAgICAgdGltZSwg
        Zm5zLCBpLCBsOwoKICAgICAgc2VsZi5ydW4oZnVuY3Rpb24oKSB7CiAgICAg
        ICAgLy8gVE9ETzogYmluYXJ5IHNlYXJjaAogICAgICAgIGZvciAoaSA9IDAs
        IGwgPSB0aW1lcnMubGVuZ3RoOyBpIDwgbDsgaSArPSAyKSB7CiAgICAgICAg
        ICB0aW1lID0gdGltZXJzW2ldOwogICAgICAgICAgaWYgKHRpbWUgPiBub3cp
        IHsgYnJlYWs7IH0KICAgICAgICB9CgogICAgICAgIGZucyA9IHRpbWVycy5z
        cGxpY2UoMCwgaSk7CgogICAgICAgIGZvciAoaSA9IDEsIGwgPSBmbnMubGVu
        Z3RoOyBpIDwgbDsgaSArPSAyKSB7CiAgICAgICAgICBzZWxmLnNjaGVkdWxl
        KHNlbGYub3B0aW9ucy5kZWZhdWx0UXVldWUsIG51bGwsIGZuc1tpXSk7CiAg
        ICAgICAgfQogICAgICB9KTsKCiAgICAgIGlmICh0aW1lcnMubGVuZ3RoKSB7
        CiAgICAgICAgbGF0ZXJUaW1lciA9IGdsb2JhbC5zZXRUaW1lb3V0KGZ1bmN0
        aW9uKCkgewogICAgICAgICAgZXhlY3V0ZVRpbWVycyhzZWxmKTsKICAgICAg
        ICAgIGxhdGVyVGltZXIgPSBudWxsOwogICAgICAgICAgbGF0ZXJUaW1lckV4
        cGlyZXNBdCA9IG51bGw7CiAgICAgICAgfSwgdGltZXJzWzBdIC0gbm93KTsK
        ICAgICAgICBsYXRlclRpbWVyRXhwaXJlc0F0ID0gdGltZXJzWzBdOwogICAg
        ICB9CiAgICB9CgogICAgZnVuY3Rpb24gZmluZERlYm91bmNlZSh0YXJnZXQs
        IG1ldGhvZCkgewogICAgICB2YXIgZGVib3VuY2VlLAogICAgICAgICAgaW5k
        ZXggPSAtMTsKCiAgICAgIGZvciAodmFyIGkgPSAwLCBsID0gZGVib3VuY2Vl
        cy5sZW5ndGg7IGkgPCBsOyBpKyspIHsKICAgICAgICBkZWJvdW5jZWUgPSBk
        ZWJvdW5jZWVzW2ldOwogICAgICAgIGlmIChkZWJvdW5jZWVbMF0gPT09IHRh
        cmdldCAmJiBkZWJvdW5jZWVbMV0gPT09IG1ldGhvZCkgewogICAgICAgICAg
        aW5kZXggPSBpOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICB9
        CgogICAgICByZXR1cm4gaW5kZXg7CiAgICB9CgoKICAgIF9fZXhwb3J0c19f
        LkJhY2tidXJuZXIgPSBCYWNrYnVybmVyOwogIH0pOwoKfSkoKTsKCgoKKGZ1
        bmN0aW9uKCkgewp2YXIgb25CZWdpbiA9IGZ1bmN0aW9uKGN1cnJlbnQpIHsK
        ICBFbWJlci5ydW4uY3VycmVudFJ1bkxvb3AgPSBjdXJyZW50Owp9OwoKdmFy
        IG9uRW5kID0gZnVuY3Rpb24oY3VycmVudCwgbmV4dCkgewogIEVtYmVyLnJ1
        bi5jdXJyZW50UnVuTG9vcCA9IG5leHQ7Cn07Cgp2YXIgQmFja2J1cm5lciA9
        IHJlcXVpcmVNb2R1bGUoJ2JhY2tidXJuZXInKS5CYWNrYnVybmVyLAogICAg
        YmFja2J1cm5lciA9IG5ldyBCYWNrYnVybmVyKFsnc3luYycsICdhY3Rpb25z
        JywgJ2Rlc3Ryb3knXSwgewogICAgICBzeW5jOiB7CiAgICAgICAgYmVmb3Jl
        OiBFbWJlci5iZWdpblByb3BlcnR5Q2hhbmdlcywKICAgICAgICBhZnRlcjog
        RW1iZXIuZW5kUHJvcGVydHlDaGFuZ2VzCiAgICAgIH0sCiAgICAgIGRlZmF1
        bHRRdWV1ZTogJ2FjdGlvbnMnLAogICAgICBvbkJlZ2luOiBvbkJlZ2luLAog
        ICAgICBvbkVuZDogb25FbmQKICAgIH0pLAogICAgc2xpY2UgPSBbXS5zbGlj
        ZTsKCi8vIC4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4u
        Li4uLi4uLi4uLi4uLi4uLi4uLi4KLy8gRW1iZXIucnVuIC0gdGhpcyBpcyBp
        ZGVhbGx5IHRoZSBvbmx5IHB1YmxpYyBBUEkgdGhlIGRldiBzZWVzCi8vCgov
        KioKICBSdW5zIHRoZSBwYXNzZWQgdGFyZ2V0IGFuZCBtZXRob2QgaW5zaWRl
        IG9mIGEgUnVuTG9vcCwgZW5zdXJpbmcgYW55CiAgZGVmZXJyZWQgYWN0aW9u
        cyBpbmNsdWRpbmcgYmluZGluZ3MgYW5kIHZpZXdzIHVwZGF0ZXMgYXJlIGZs
        dXNoZWQgYXQgdGhlCiAgZW5kLgoKICBOb3JtYWxseSB5b3Ugc2hvdWxkIG5v
        dCBuZWVkIHRvIGludm9rZSB0aGlzIG1ldGhvZCB5b3Vyc2VsZi4gSG93ZXZl
        ciBpZgogIHlvdSBhcmUgaW1wbGVtZW50aW5nIHJhdyBldmVudCBoYW5kbGVy
        cyB3aGVuIGludGVyZmFjaW5nIHdpdGggb3RoZXIKICBsaWJyYXJpZXMgb3Ig
        cGx1Z2lucywgeW91IHNob3VsZCBwcm9iYWJseSB3cmFwIGFsbCBvZiB5b3Vy
        IGNvZGUgaW5zaWRlIHRoaXMKICBjYWxsLgoKICBgYGBqYXZhc2NyaXB0CiAg
        RW1iZXIucnVuKGZ1bmN0aW9uKCkgewogICAgLy8gY29kZSB0byBiZSBleGVj
        dXRlIHdpdGhpbiBhIFJ1bkxvb3AKICB9KTsKICBgYGAKCiAgQGNsYXNzIHJ1
        bgogIEBuYW1lc3BhY2UgRW1iZXIKICBAc3RhdGljCiAgQGNvbnN0cnVjdG9y
        CiAgQHBhcmFtIHtPYmplY3R9IFt0YXJnZXRdIHRhcmdldCBvZiBtZXRob2Qg
        dG8gY2FsbAogIEBwYXJhbSB7RnVuY3Rpb258U3RyaW5nfSBtZXRob2QgTWV0
        aG9kIHRvIGludm9rZS4KICAgIE1heSBiZSBhIGZ1bmN0aW9uIG9yIGEgc3Ry
        aW5nLiBJZiB5b3UgcGFzcyBhIHN0cmluZwogICAgdGhlbiBpdCB3aWxsIGJl
        IGxvb2tlZCB1cCBvbiB0aGUgcGFzc2VkIHRhcmdldC4KICBAcGFyYW0ge09i
        amVjdH0gW2FyZ3MqXSBBbnkgYWRkaXRpb25hbCBhcmd1bWVudHMgeW91IHdp
        c2ggdG8gcGFzcyB0byB0aGUgbWV0aG9kLgogIEByZXR1cm4ge09iamVjdH0g
        cmV0dXJuIHZhbHVlIGZyb20gaW52b2tpbmcgdGhlIHBhc3NlZCBmdW5jdGlv
        bi4KKi8KRW1iZXIucnVuID0gZnVuY3Rpb24odGFyZ2V0LCBtZXRob2QpIHsK
        ICB2YXIgcmV0OwoKICBpZiAoRW1iZXIub25lcnJvcikgewogICAgdHJ5IHsK
        ICAgICAgcmV0ID0gYmFja2J1cm5lci5ydW4uYXBwbHkoYmFja2J1cm5lciwg
        YXJndW1lbnRzKTsKICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgRW1iZXIub25l
        cnJvcihlKTsKICAgIH0KICB9IGVsc2UgewogICAgcmV0ID0gYmFja2J1cm5l
        ci5ydW4uYXBwbHkoYmFja2J1cm5lciwgYXJndW1lbnRzKTsKICB9CgogIHJl
        dHVybiByZXQ7Cn07CgovKioKCiAgSWYgbm8gcnVuLWxvb3AgaXMgcHJlc2Vu
        dCwgaXQgY3JlYXRlcyBhIG5ldyBvbmUuIElmIGEgcnVuIGxvb3AgaXMKICBw
        cmVzZW50IGl0IHdpbGwgcXVldWUgaXRzZWxmIHRvIHJ1biBvbiB0aGUgZXhp
        c3RpbmcgcnVuLWxvb3BzIGFjdGlvbgogIHF1ZXVlLgoKICBQbGVhc2Ugbm90
        ZTogVGhpcyBpcyBub3QgZm9yIG5vcm1hbCB1c2FnZSwgYW5kIHNob3VsZCBi
        ZSB1c2VkIHNwYXJpbmdseS4KCiAgSWYgaW52b2tlZCB3aGVuIG5vdCB3aXRo
        aW4gYSBydW4gbG9vcDoKCiAgYGBgamF2YXNjcmlwdAogIEVtYmVyLnJ1bi5q
        b2luKGZ1bmN0aW9uKCkgewogICAgLy8gY3JlYXRlcyBhIG5ldyBydW4tbG9v
        cAogIH0pOwogIGBgYAoKICBBbHRlcm5hdGl2ZWx5LCBpZiBjYWxsZWQgd2l0
        aGluIGFuIGV4aXN0aW5nIHJ1biBsb29wOgoKICBgYGBqYXZhc2NyaXB0CiAg
        RW1iZXIucnVuKGZ1bmN0aW9uKCkgewogICAgLy8gY3JlYXRlcyBhIG5ldyBy
        dW4tbG9vcAogICAgRW1iZXIucnVuLmpvaW4oZnVuY3Rpb24oKSB7CiAgICAg
        IC8vIGpvaW5zIHdpdGggdGhlIGV4aXN0aW5nIHJ1bi1sb29wLCBhbmQgcXVl
        dWVzIGZvciBpbnZvY2F0aW9uIG9uCiAgICAgIC8vIHRoZSBleGlzdGluZyBy
        dW4tbG9vcHMgYWN0aW9uIHF1ZXVlLgogICAgfSk7CiAgfSk7CiAgYGBgCgog
        IEBtZXRob2Qgam9pbgogIEBuYW1lc3BhY2UgRW1iZXIKICBAcGFyYW0ge09i
        amVjdH0gW3RhcmdldF0gdGFyZ2V0IG9mIG1ldGhvZCB0byBjYWxsCiAgQHBh
        cmFtIHtGdW5jdGlvbnxTdHJpbmd9IG1ldGhvZCBNZXRob2QgdG8gaW52b2tl
        LgogICAgTWF5IGJlIGEgZnVuY3Rpb24gb3IgYSBzdHJpbmcuIElmIHlvdSBw
        YXNzIGEgc3RyaW5nCiAgICB0aGVuIGl0IHdpbGwgYmUgbG9va2VkIHVwIG9u
        IHRoZSBwYXNzZWQgdGFyZ2V0LgogIEBwYXJhbSB7T2JqZWN0fSBbYXJncypd
        IEFueSBhZGRpdGlvbmFsIGFyZ3VtZW50cyB5b3Ugd2lzaCB0byBwYXNzIHRv
        IHRoZSBtZXRob2QuCiAgQHJldHVybiB7T2JqZWN0fSByZXR1cm4gdmFsdWUg
        ZnJvbSBpbnZva2luZyB0aGUgcGFzc2VkIGZ1bmN0aW9uLiBQbGVhc2Ugbm90
        ZSwKICB3aGVuIGNhbGxlZCB3aXRoaW4gYW4gZXhpc3RpbmcgbG9vcCwgbm8g
        cmV0dXJuIHZhbHVlIGlzIHBvc3NpYmxlLgoqLwpFbWJlci5ydW4uam9pbiA9
        IGZ1bmN0aW9uKHRhcmdldCwgbWV0aG9kKSB7CiAgaWYgKCFFbWJlci5ydW4u
        Y3VycmVudFJ1bkxvb3ApIHsKICAgIHJldHVybiBFbWJlci5ydW4uYXBwbHko
        RW1iZXIucnVuLCBhcmd1bWVudHMpOwogIH0KCiAgdmFyIGFyZ3MgPSBzbGlj
        ZS5jYWxsKGFyZ3VtZW50cyk7CiAgYXJncy51bnNoaWZ0KCdhY3Rpb25zJyk7
        CiAgRW1iZXIucnVuLnNjaGVkdWxlLmFwcGx5KEVtYmVyLnJ1biwgYXJncyk7
        Cn07CgpFbWJlci5ydW4uYmFja2J1cm5lciA9IGJhY2tidXJuZXI7Cgp2YXIg
        cnVuID0gRW1iZXIucnVuOwoKRW1iZXIucnVuLmN1cnJlbnRSdW5Mb29wID0g
        bnVsbDsKCkVtYmVyLnJ1bi5xdWV1ZXMgPSBiYWNrYnVybmVyLnF1ZXVlTmFt
        ZXM7CgovKioKICBCZWdpbnMgYSBuZXcgUnVuTG9vcC4gQW55IGRlZmVycmVk
        IGFjdGlvbnMgaW52b2tlZCBhZnRlciB0aGUgYmVnaW4gd2lsbAogIGJlIGJ1
        ZmZlcmVkIHVudGlsIHlvdSBpbnZva2UgYSBtYXRjaGluZyBjYWxsIHRvIGBF
        bWJlci5ydW4uZW5kKClgLiBUaGlzIGlzCiAgYSBsb3dlci1sZXZlbCB3YXkg
        dG8gdXNlIGEgUnVuTG9vcCBpbnN0ZWFkIG9mIHVzaW5nIGBFbWJlci5ydW4o
        KWAuCgogIGBgYGphdmFzY3JpcHQKICBFbWJlci5ydW4uYmVnaW4oKTsKICAv
        LyBjb2RlIHRvIGJlIGV4ZWN1dGUgd2l0aGluIGEgUnVuTG9vcAogIEVtYmVy
        LnJ1bi5lbmQoKTsKICBgYGAKCiAgQG1ldGhvZCBiZWdpbgogIEByZXR1cm4g
        e3ZvaWR9CiovCkVtYmVyLnJ1bi5iZWdpbiA9IGZ1bmN0aW9uKCkgewogIGJh
        Y2tidXJuZXIuYmVnaW4oKTsKfTsKCi8qKgogIEVuZHMgYSBSdW5Mb29wLiBU
        aGlzIG11c3QgYmUgY2FsbGVkIHNvbWV0aW1lIGFmdGVyIHlvdSBjYWxsCiAg
        YEVtYmVyLnJ1bi5iZWdpbigpYCB0byBmbHVzaCBhbnkgZGVmZXJyZWQgYWN0
        aW9ucy4gVGhpcyBpcyBhIGxvd2VyLWxldmVsIHdheQogIHRvIHVzZSBhIFJ1
        bkxvb3AgaW5zdGVhZCBvZiB1c2luZyBgRW1iZXIucnVuKClgLgoKICBgYGBq
        YXZhc2NyaXB0CiAgRW1iZXIucnVuLmJlZ2luKCk7CiAgLy8gY29kZSB0byBi
        ZSBleGVjdXRlIHdpdGhpbiBhIFJ1bkxvb3AKICBFbWJlci5ydW4uZW5kKCk7
        CiAgYGBgCgogIEBtZXRob2QgZW5kCiAgQHJldHVybiB7dm9pZH0KKi8KRW1i
        ZXIucnVuLmVuZCA9IGZ1bmN0aW9uKCkgewogIGJhY2tidXJuZXIuZW5kKCk7
        Cn07CgovKioKICBBcnJheSBvZiBuYW1lZCBxdWV1ZXMuIFRoaXMgYXJyYXkg
        ZGV0ZXJtaW5lcyB0aGUgb3JkZXIgaW4gd2hpY2ggcXVldWVzCiAgYXJlIGZs
        dXNoZWQgYXQgdGhlIGVuZCBvZiB0aGUgUnVuTG9vcC4gWW91IGNhbiBkZWZp
        bmUgeW91ciBvd24gcXVldWVzIGJ5CiAgc2ltcGx5IGFkZGluZyB0aGUgcXVl
        dWUgbmFtZSB0byB0aGlzIGFycmF5LiBOb3JtYWxseSB5b3Ugc2hvdWxkIG5v
        dCBuZWVkCiAgdG8gaW5zcGVjdCBvciBtb2RpZnkgdGhpcyBwcm9wZXJ0eS4K
        CiAgQHByb3BlcnR5IHF1ZXVlcwogIEB0eXBlIEFycmF5CiAgQGRlZmF1bHQg
        WydzeW5jJywgJ2FjdGlvbnMnLCAnZGVzdHJveSddCiovCgovKioKICBBZGRz
        IHRoZSBwYXNzZWQgdGFyZ2V0L21ldGhvZCBhbmQgYW55IG9wdGlvbmFsIGFy
        Z3VtZW50cyB0byB0aGUgbmFtZWQKICBxdWV1ZSB0byBiZSBleGVjdXRlZCBh
        dCB0aGUgZW5kIG9mIHRoZSBSdW5Mb29wLiBJZiB5b3UgaGF2ZSBub3QgYWxy
        ZWFkeQogIHN0YXJ0ZWQgYSBSdW5Mb29wIHdoZW4gY2FsbGluZyB0aGlzIG1l
        dGhvZCBvbmUgd2lsbCBiZSBzdGFydGVkIGZvciB5b3UKICBhdXRvbWF0aWNh
        bGx5LgoKICBBdCB0aGUgZW5kIG9mIGEgUnVuTG9vcCwgYW55IG1ldGhvZHMg
        c2NoZWR1bGVkIGluIHRoaXMgd2F5IHdpbGwgYmUgaW52b2tlZC4KICBNZXRo
        b2RzIHdpbGwgYmUgaW52b2tlZCBpbiBhbiBvcmRlciBtYXRjaGluZyB0aGUg
        bmFtZWQgcXVldWVzIGRlZmluZWQgaW4KICB0aGUgYEVtYmVyLnJ1bi5xdWV1
        ZXNgIHByb3BlcnR5LgoKICBgYGBqYXZhc2NyaXB0CiAgRW1iZXIucnVuLnNj
        aGVkdWxlKCdzeW5jJywgdGhpcywgZnVuY3Rpb24oKSB7CiAgICAvLyB0aGlz
        IHdpbGwgYmUgZXhlY3V0ZWQgaW4gdGhlIGZpcnN0IFJ1bkxvb3AgcXVldWUs
        IHdoZW4gYmluZGluZ3MgYXJlIHN5bmNlZAogICAgY29uc29sZS5sb2coInNj
        aGVkdWxlZCBvbiBzeW5jIHF1ZXVlIik7CiAgfSk7CgogIEVtYmVyLnJ1bi5z
        Y2hlZHVsZSgnYWN0aW9ucycsIHRoaXMsIGZ1bmN0aW9uKCkgewogICAgLy8g
        dGhpcyB3aWxsIGJlIGV4ZWN1dGVkIGluIHRoZSAnYWN0aW9ucycgcXVldWUs
        IGFmdGVyIGJpbmRpbmdzIGhhdmUgc3luY2VkLgogICAgY29uc29sZS5sb2co
        InNjaGVkdWxlZCBvbiBhY3Rpb25zIHF1ZXVlIik7CiAgfSk7CgogIC8vIE5v
        dGUgdGhlIGZ1bmN0aW9ucyB3aWxsIGJlIHJ1biBpbiBvcmRlciBiYXNlZCBv
        biB0aGUgcnVuIHF1ZXVlcyBvcmRlci4gT3V0cHV0IHdvdWxkIGJlOgogIC8v
        ICAgc2NoZWR1bGVkIG9uIHN5bmMgcXVldWUKICAvLyAgIHNjaGVkdWxlZCBv
        biBhY3Rpb25zIHF1ZXVlCiAgYGBgCgogIEBtZXRob2Qgc2NoZWR1bGUKICBA
        cGFyYW0ge1N0cmluZ30gcXVldWUgVGhlIG5hbWUgb2YgdGhlIHF1ZXVlIHRv
        IHNjaGVkdWxlIGFnYWluc3QuCiAgICBEZWZhdWx0IHF1ZXVlcyBhcmUgJ3N5
        bmMnIGFuZCAnYWN0aW9ucycKICBAcGFyYW0ge09iamVjdH0gW3RhcmdldF0g
        dGFyZ2V0IG9iamVjdCB0byB1c2UgYXMgdGhlIGNvbnRleHQgd2hlbiBpbnZv
        a2luZyBhIG1ldGhvZC4KICBAcGFyYW0ge1N0cmluZ3xGdW5jdGlvbn0gbWV0
        aG9kIFRoZSBtZXRob2QgdG8gaW52b2tlLiBJZiB5b3UgcGFzcyBhIHN0cmlu
        ZyBpdAogICAgd2lsbCBiZSByZXNvbHZlZCBvbiB0aGUgdGFyZ2V0IG9iamVj
        dCBhdCB0aGUgdGltZSB0aGUgc2NoZWR1bGVkIGl0ZW0gaXMKICAgIGludm9r
        ZWQgYWxsb3dpbmcgeW91IHRvIGNoYW5nZSB0aGUgdGFyZ2V0IGZ1bmN0aW9u
        LgogIEBwYXJhbSB7T2JqZWN0fSBbYXJndW1lbnRzKl0gT3B0aW9uYWwgYXJn
        dW1lbnRzIHRvIGJlIHBhc3NlZCB0byB0aGUgcXVldWVkIG1ldGhvZC4KICBA
        cmV0dXJuIHt2b2lkfQoqLwpFbWJlci5ydW4uc2NoZWR1bGUgPSBmdW5jdGlv
        bihxdWV1ZSwgdGFyZ2V0LCBtZXRob2QpIHsKICBjaGVja0F1dG9SdW4oKTsK
        ICBiYWNrYnVybmVyLnNjaGVkdWxlLmFwcGx5KGJhY2tidXJuZXIsIGFyZ3Vt
        ZW50cyk7Cn07CgovLyBVc2VkIGJ5IGdsb2JhbCB0ZXN0IHRlYXJkb3duCkVt
        YmVyLnJ1bi5oYXNTY2hlZHVsZWRUaW1lcnMgPSBmdW5jdGlvbigpIHsKICBy
        ZXR1cm4gYmFja2J1cm5lci5oYXNUaW1lcnMoKTsKfTsKCi8vIFVzZWQgYnkg
        Z2xvYmFsIHRlc3QgdGVhcmRvd24KRW1iZXIucnVuLmNhbmNlbFRpbWVycyA9
        IGZ1bmN0aW9uICgpIHsKICBiYWNrYnVybmVyLmNhbmNlbFRpbWVycygpOwp9
        OwoKLyoqCiAgSW1tZWRpYXRlbHkgZmx1c2hlcyBhbnkgZXZlbnRzIHNjaGVk
        dWxlZCBpbiB0aGUgJ3N5bmMnIHF1ZXVlLiBCaW5kaW5ncwogIHVzZSB0aGlz
        IHF1ZXVlIHNvIHRoaXMgbWV0aG9kIGlzIGEgdXNlZnVsIHdheSB0byBpbW1l
        ZGlhdGVseSBmb3JjZSBhbGwKICBiaW5kaW5ncyBpbiB0aGUgYXBwbGljYXRp
        b24gdG8gc3luYy4KCiAgWW91IHNob3VsZCBjYWxsIHRoaXMgbWV0aG9kIGFu
        eXRpbWUgeW91IG5lZWQgYW55IGNoYW5nZWQgc3RhdGUgdG8gcHJvcGFnYXRl
        CiAgdGhyb3VnaG91dCB0aGUgYXBwIGltbWVkaWF0ZWx5IHdpdGhvdXQgcmVw
        YWludGluZyB0aGUgVUkgKHdoaWNoIGhhcHBlbnMKICBpbiB0aGUgbGF0ZXIg
        J3JlbmRlcicgcXVldWUgYWRkZWQgYnkgdGhlIGBlbWJlci12aWV3c2AgcGFj
        a2FnZSkuCgogIGBgYGphdmFzY3JpcHQKICBFbWJlci5ydW4uc3luYygpOwog
        IGBgYAoKICBAbWV0aG9kIHN5bmMKICBAcmV0dXJuIHt2b2lkfQoqLwpFbWJl
        ci5ydW4uc3luYyA9IGZ1bmN0aW9uKCkgewogIGlmIChiYWNrYnVybmVyLmN1
        cnJlbnRJbnN0YW5jZSkgewogICAgYmFja2J1cm5lci5jdXJyZW50SW5zdGFu
        Y2UucXVldWVzLnN5bmMuZmx1c2goKTsKICB9Cn07CgovKioKICBJbnZva2Vz
        IHRoZSBwYXNzZWQgdGFyZ2V0L21ldGhvZCBhbmQgb3B0aW9uYWwgYXJndW1l
        bnRzIGFmdGVyIGEgc3BlY2lmaWVkCiAgcGVyaW9kIGlmIHRpbWUuIFRoZSBs
        YXN0IHBhcmFtZXRlciBvZiB0aGlzIG1ldGhvZCBtdXN0IGFsd2F5cyBiZSBh
        IG51bWJlcgogIG9mIG1pbGxpc2Vjb25kcy4KCiAgWW91IHNob3VsZCB1c2Ug
        dGhpcyBtZXRob2Qgd2hlbmV2ZXIgeW91IG5lZWQgdG8gcnVuIHNvbWUgYWN0
        aW9uIGFmdGVyIGEKICBwZXJpb2Qgb2YgdGltZSBpbnN0ZWFkIG9mIHVzaW5n
        IGBzZXRUaW1lb3V0KClgLiBUaGlzIG1ldGhvZCB3aWxsIGVuc3VyZSB0aGF0
        CiAgaXRlbXMgdGhhdCBleHBpcmUgZHVyaW5nIHRoZSBzYW1lIHNjcmlwdCBl
        eGVjdXRpb24gY3ljbGUgYWxsIGV4ZWN1dGUKICB0b2dldGhlciwgd2hpY2gg
        aXMgb2Z0ZW4gbW9yZSBlZmZpY2llbnQgdGhhbiB1c2luZyBhIHJlYWwgc2V0
        VGltZW91dC4KCiAgYGBgamF2YXNjcmlwdAogIEVtYmVyLnJ1bi5sYXRlciht
        eUNvbnRleHQsIGZ1bmN0aW9uKCkgewogICAgLy8gY29kZSBoZXJlIHdpbGwg
        ZXhlY3V0ZSB3aXRoaW4gYSBSdW5Mb29wIGluIGFib3V0IDUwMG1zIHdpdGgg
        dGhpcyA9PSBteUNvbnRleHQKICB9LCA1MDApOwogIGBgYAoKICBAbWV0aG9k
        IGxhdGVyCiAgQHBhcmFtIHtPYmplY3R9IFt0YXJnZXRdIHRhcmdldCBvZiBt
        ZXRob2QgdG8gaW52b2tlCiAgQHBhcmFtIHtGdW5jdGlvbnxTdHJpbmd9IG1l
        dGhvZCBUaGUgbWV0aG9kIHRvIGludm9rZS4KICAgIElmIHlvdSBwYXNzIGEg
        c3RyaW5nIGl0IHdpbGwgYmUgcmVzb2x2ZWQgb24gdGhlCiAgICB0YXJnZXQg
        YXQgdGhlIHRpbWUgdGhlIG1ldGhvZCBpcyBpbnZva2VkLgogIEBwYXJhbSB7
        T2JqZWN0fSBbYXJncypdIE9wdGlvbmFsIGFyZ3VtZW50cyB0byBwYXNzIHRv
        IHRoZSB0aW1lb3V0LgogIEBwYXJhbSB7TnVtYmVyfSB3YWl0IE51bWJlciBv
        ZiBtaWxsaXNlY29uZHMgdG8gd2FpdC4KICBAcmV0dXJuIHtTdHJpbmd9IGEg
        c3RyaW5nIHlvdSBjYW4gdXNlIHRvIGNhbmNlbCB0aGUgdGltZXIgaW4KICAg
        IGBFbWJlci5ydW4uY2FuY2VsYCBsYXRlci4KKi8KRW1iZXIucnVuLmxhdGVy
        ID0gZnVuY3Rpb24odGFyZ2V0LCBtZXRob2QpIHsKICByZXR1cm4gYmFja2J1
        cm5lci5sYXRlci5hcHBseShiYWNrYnVybmVyLCBhcmd1bWVudHMpOwp9OwoK
        LyoqCiAgU2NoZWR1bGUgYSBmdW5jdGlvbiB0byBydW4gb25lIHRpbWUgZHVy
        aW5nIHRoZSBjdXJyZW50IFJ1bkxvb3AuIFRoaXMgaXMgZXF1aXZhbGVudAog
        IHRvIGNhbGxpbmcgYHNjaGVkdWxlT25jZWAgd2l0aCB0aGUgImFjdGlvbnMi
        IHF1ZXVlLgoKICBAbWV0aG9kIG9uY2UKICBAcGFyYW0ge09iamVjdH0gW3Rh
        cmdldF0gVGhlIHRhcmdldCBvZiB0aGUgbWV0aG9kIHRvIGludm9rZS4KICBA
        cGFyYW0ge0Z1bmN0aW9ufFN0cmluZ30gbWV0aG9kIFRoZSBtZXRob2QgdG8g
        aW52b2tlLgogICAgSWYgeW91IHBhc3MgYSBzdHJpbmcgaXQgd2lsbCBiZSBy
        ZXNvbHZlZCBvbiB0aGUKICAgIHRhcmdldCBhdCB0aGUgdGltZSB0aGUgbWV0
        aG9kIGlzIGludm9rZWQuCiAgQHBhcmFtIHtPYmplY3R9IFthcmdzKl0gT3B0
        aW9uYWwgYXJndW1lbnRzIHRvIHBhc3MgdG8gdGhlIHRpbWVvdXQuCiAgQHJl
        dHVybiB7T2JqZWN0fSB0aW1lcgoqLwpFbWJlci5ydW4ub25jZSA9IGZ1bmN0
        aW9uKHRhcmdldCwgbWV0aG9kKSB7CiAgY2hlY2tBdXRvUnVuKCk7CiAgdmFy
        IGFyZ3MgPSBzbGljZS5jYWxsKGFyZ3VtZW50cyk7CiAgYXJncy51bnNoaWZ0
        KCdhY3Rpb25zJyk7CiAgcmV0dXJuIGJhY2tidXJuZXIuc2NoZWR1bGVPbmNl
        LmFwcGx5KGJhY2tidXJuZXIsIGFyZ3MpOwp9OwoKLyoqCiAgU2NoZWR1bGVz
        IGEgZnVuY3Rpb24gdG8gcnVuIG9uZSB0aW1lIGluIGEgZ2l2ZW4gcXVldWUg
        b2YgdGhlIGN1cnJlbnQgUnVuTG9vcC4KICBDYWxsaW5nIHRoaXMgbWV0aG9k
        IHdpdGggdGhlIHNhbWUgcXVldWUvdGFyZ2V0L21ldGhvZCBjb21iaW5hdGlv
        biB3aWxsIGhhdmUKICBubyBlZmZlY3QgKHBhc3QgdGhlIGluaXRpYWwgY2Fs
        bCkuCgogIE5vdGUgdGhhdCBhbHRob3VnaCB5b3UgY2FuIHBhc3Mgb3B0aW9u
        YWwgYXJndW1lbnRzIHRoZXNlIHdpbGwgbm90IGJlCiAgY29uc2lkZXJlZCB3
        aGVuIGxvb2tpbmcgZm9yIGR1cGxpY2F0ZXMuIE5ldyBhcmd1bWVudHMgd2ls
        bCByZXBsYWNlIHByZXZpb3VzCiAgY2FsbHMuCgogIGBgYGphdmFzY3JpcHQK
        ICBFbWJlci5ydW4oZnVuY3Rpb24oKSB7CiAgICB2YXIgc2F5SGkgPSBmdW5j
        dGlvbigpIHsgY29uc29sZS5sb2coJ2hpJyk7IH0KICAgIEVtYmVyLnJ1bi5z
        Y2hlZHVsZU9uY2UoJ2FmdGVyUmVuZGVyJywgbXlDb250ZXh0LCBzYXlIaSk7
        CiAgICBFbWJlci5ydW4uc2NoZWR1bGVPbmNlKCdhZnRlclJlbmRlcicsIG15
        Q29udGV4dCwgc2F5SGkpOwogICAgLy8gc2F5SGkgd2lsbCBvbmx5IGJlIGV4
        ZWN1dGVkIG9uY2UsIGluIHRoZSBhZnRlclJlbmRlciBxdWV1ZSBvZiB0aGUg
        UnVuTG9vcAogIH0pOwogIGBgYAoKICBBbHNvIG5vdGUgdGhhdCBwYXNzaW5n
        IGFuIGFub255bW91cyBmdW5jdGlvbiB0byBgRW1iZXIucnVuLnNjaGVkdWxl
        T25jZWAgd2lsbAogIG5vdCBwcmV2ZW50IGFkZGl0aW9uYWwgY2FsbHMgd2l0
        aCBhbiBpZGVudGljYWwgYW5vbnltb3VzIGZ1bmN0aW9uIGZyb20KICBzY2hl
        ZHVsaW5nIHRoZSBpdGVtcyBtdWx0aXBsZSB0aW1lcywgZS5nLjoKCiAgYGBg
        amF2YXNjcmlwdAogIGZ1bmN0aW9uIHNjaGVkdWxlSXQoKSB7CiAgICBFbWJl
        ci5ydW4uc2NoZWR1bGVPbmNlKCdhY3Rpb25zJywgbXlDb250ZXh0LCBmdW5j
        dGlvbigpIHsgY29uc29sZS5sb2coIkNsb3N1cmUiKTsgfSk7CiAgfQogIHNj
        aGVkdWxlSXQoKTsKICBzY2hlZHVsZUl0KCk7CiAgLy8gIkNsb3N1cmUiIHdp
        bGwgcHJpbnQgdHdpY2UsIGV2ZW4gdGhvdWdoIHdlJ3JlIHVzaW5nIGBFbWJl
        ci5ydW4uc2NoZWR1bGVPbmNlYCwKICAvLyBiZWNhdXNlIHRoZSBmdW5jdGlv
        biB3ZSBwYXNzIHRvIGl0IGlzIGFub255bW91cyBhbmQgd29uJ3QgbWF0Y2gg
        dGhlCiAgLy8gcHJldmlvdXNseSBzY2hlZHVsZWQgb3BlcmF0aW9uLgogIGBg
        YAoKICBBdmFpbGFibGUgcXVldWVzLCBhbmQgdGhlaXIgb3JkZXIsIGNhbiBi
        ZSBmb3VuZCBhdCBgRW1iZXIucnVuLnF1ZXVlc2AKCiAgQG1ldGhvZCBzY2hl
        ZHVsZU9uY2UKICBAcGFyYW0ge1N0cmluZ30gW3F1ZXVlXSBUaGUgbmFtZSBv
        ZiB0aGUgcXVldWUgdG8gc2NoZWR1bGUgYWdhaW5zdC4gRGVmYXVsdCBxdWV1
        ZXMgYXJlICdzeW5jJyBhbmQgJ2FjdGlvbnMnLgogIEBwYXJhbSB7T2JqZWN0
        fSBbdGFyZ2V0XSBUaGUgdGFyZ2V0IG9mIHRoZSBtZXRob2QgdG8gaW52b2tl
        LgogIEBwYXJhbSB7RnVuY3Rpb258U3RyaW5nfSBtZXRob2QgVGhlIG1ldGhv
        ZCB0byBpbnZva2UuCiAgICBJZiB5b3UgcGFzcyBhIHN0cmluZyBpdCB3aWxs
        IGJlIHJlc29sdmVkIG9uIHRoZQogICAgdGFyZ2V0IGF0IHRoZSB0aW1lIHRo
        ZSBtZXRob2QgaXMgaW52b2tlZC4KICBAcGFyYW0ge09iamVjdH0gW2FyZ3Mq
        XSBPcHRpb25hbCBhcmd1bWVudHMgdG8gcGFzcyB0byB0aGUgdGltZW91dC4K
        ICBAcmV0dXJuIHtPYmplY3R9IHRpbWVyCiovCkVtYmVyLnJ1bi5zY2hlZHVs
        ZU9uY2UgPSBmdW5jdGlvbihxdWV1ZSwgdGFyZ2V0LCBtZXRob2QpIHsKICBj
        aGVja0F1dG9SdW4oKTsKICByZXR1cm4gYmFja2J1cm5lci5zY2hlZHVsZU9u
        Y2UuYXBwbHkoYmFja2J1cm5lciwgYXJndW1lbnRzKTsKfTsKCi8qKgogIFNj
        aGVkdWxlcyBhbiBpdGVtIHRvIHJ1biBmcm9tIHdpdGhpbiBhIHNlcGFyYXRl
        IHJ1biBsb29wLCBhZnRlcgogIGNvbnRyb2wgaGFzIGJlZW4gcmV0dXJuZWQg
        dG8gdGhlIHN5c3RlbS4gVGhpcyBpcyBlcXVpdmFsZW50IHRvIGNhbGxpbmcK
        ICBgRW1iZXIucnVuLmxhdGVyYCB3aXRoIGEgd2FpdCB0aW1lIG9mIDFtcy4K
        CiAgYGBgamF2YXNjcmlwdAogIEVtYmVyLnJ1bi5uZXh0KG15Q29udGV4dCwg
        ZnVuY3Rpb24oKSB7CiAgICAvLyBjb2RlIHRvIGJlIGV4ZWN1dGVkIGluIHRo
        ZSBuZXh0IHJ1biBsb29wLCB3aGljaCB3aWxsIGJlIHNjaGVkdWxlZCBhZnRl
        ciB0aGUgY3VycmVudCBvbmUKICB9KTsKICBgYGAKCiAgTXVsdGlwbGUgb3Bl
        cmF0aW9ucyBzY2hlZHVsZWQgd2l0aCBgRW1iZXIucnVuLm5leHRgIHdpbGwg
        Y29hbGVzY2UKICBpbnRvIHRoZSBzYW1lIGxhdGVyIHJ1biBsb29wLCBhbG9u
        ZyB3aXRoIGFueSBvdGhlciBvcGVyYXRpb25zCiAgc2NoZWR1bGVkIGJ5IGBF
        bWJlci5ydW4ubGF0ZXJgIHRoYXQgZXhwaXJlIHJpZ2h0IGFyb3VuZCB0aGUg
        c2FtZQogIHRpbWUgdGhhdCBgRW1iZXIucnVuLm5leHRgIG9wZXJhdGlvbnMg
        d2lsbCBmaXJlLgoKICBOb3RlIHRoYXQgdGhlcmUgYXJlIG9mdGVuIGFsdGVy
        bmF0aXZlcyB0byB1c2luZyBgRW1iZXIucnVuLm5leHRgLgogIEZvciBpbnN0
        YW5jZSwgaWYgeW91J2QgbGlrZSB0byBzY2hlZHVsZSBhbiBvcGVyYXRpb24g
        dG8gaGFwcGVuCiAgYWZ0ZXIgYWxsIERPTSBlbGVtZW50IG9wZXJhdGlvbnMg
        aGF2ZSBjb21wbGV0ZWQgd2l0aGluIHRoZSBjdXJyZW50CiAgcnVuIGxvb3As
        IHlvdSBjYW4gbWFrZSB1c2Ugb2YgdGhlIGBhZnRlclJlbmRlcmAgcnVuIGxv
        b3AgcXVldWUgKGFkZGVkCiAgYnkgdGhlIGBlbWJlci12aWV3c2AgcGFja2Fn
        ZSwgYWxvbmcgd2l0aCB0aGUgcHJlY2VkaW5nIGByZW5kZXJgIHF1ZXVlCiAg
        d2hlcmUgYWxsIHRoZSBET00gZWxlbWVudCBvcGVyYXRpb25zIGhhcHBlbiku
        IEV4YW1wbGU6CgogIGBgYGphdmFzY3JpcHQKICBBcHAuTXlDb2xsZWN0aW9u
        VmlldyA9IEVtYmVyLkNvbGxlY3Rpb25WaWV3LmV4dGVuZCh7CiAgICBkaWRJ
        bnNlcnRFbGVtZW50OiBmdW5jdGlvbigpIHsKICAgICAgRW1iZXIucnVuLnNj
        aGVkdWxlT25jZSgnYWZ0ZXJSZW5kZXInLCB0aGlzLCAncHJvY2Vzc0NoaWxk
        RWxlbWVudHMnKTsKICAgIH0sCiAgICBwcm9jZXNzQ2hpbGRFbGVtZW50czog
        ZnVuY3Rpb24oKSB7CiAgICAgIC8vIC4uLiBkbyBzb21ldGhpbmcgd2l0aCBj
        b2xsZWN0aW9uVmlldydzIGNoaWxkIHZpZXcKICAgICAgLy8gZWxlbWVudHMg
        YWZ0ZXIgdGhleSd2ZSBmaW5pc2hlZCByZW5kZXJpbmcsIHdoaWNoCiAgICAg
        IC8vIGNhbid0IGJlIGRvbmUgd2l0aGluIHRoZSBDb2xsZWN0aW9uVmlldydz
        CiAgICAgIC8vIGBkaWRJbnNlcnRFbGVtZW50YCBob29rIGJlY2F1c2UgdGhh
        dCBnZXRzIHJ1bgogICAgICAvLyBiZWZvcmUgdGhlIGNoaWxkIGVsZW1lbnRz
        IGhhdmUgYmVlbiBhZGRlZCB0byB0aGUgRE9NLgogICAgfQogIH0pOwogIGBg
        YAoKICBPbmUgYmVuZWZpdCBvZiB0aGUgYWJvdmUgYXBwcm9hY2ggY29tcGFy
        ZWQgdG8gdXNpbmcgYEVtYmVyLnJ1bi5uZXh0YCBpcwogIHRoYXQgeW91IHdp
        bGwgYmUgYWJsZSB0byBwZXJmb3JtIERPTS9DU1Mgb3BlcmF0aW9ucyBiZWZv
        cmUgdW5wcm9jZXNzZWQKICBlbGVtZW50cyBhcmUgcmVuZGVyZWQgdG8gdGhl
        IHNjcmVlbiwgd2hpY2ggbWF5IHByZXZlbnQgZmxpY2tlcmluZyBvcgogIG90
        aGVyIGFydGlmYWN0cyBjYXVzZWQgYnkgZGVsYXlpbmcgcHJvY2Vzc2luZyB1
        bnRpbCBhZnRlciByZW5kZXJpbmcuCgogIFRoZSBvdGhlciBtYWpvciBiZW5l
        Zml0IHRvIHRoZSBhYm92ZSBhcHByb2FjaCBpcyB0aGF0IGBFbWJlci5ydW4u
        bmV4dGAKICBpbnRyb2R1Y2VzIGFuIGVsZW1lbnQgb2Ygbm9uLWRldGVybWlu
        aXNtLCB3aGljaCBjYW4gbWFrZSB0aGluZ3MgbXVjaAogIGhhcmRlciB0byB0
        ZXN0LCBkdWUgdG8gaXRzIHJlbGlhbmNlIG9uIGBzZXRUaW1lb3V0YDsgaXQn
        cyBtdWNoIGhhcmRlcgogIHRvIGd1YXJhbnRlZSB0aGUgb3JkZXIgb2Ygc2No
        ZWR1bGVkIG9wZXJhdGlvbnMgd2hlbiB0aGV5IGFyZSBzY2hlZHVsZWQKICBv
        dXRzaWRlIG9mIHRoZSBjdXJyZW50IHJ1biBsb29wLCBpLmUuIHdpdGggYEVt
        YmVyLnJ1bi5uZXh0YC4KCiAgQG1ldGhvZCBuZXh0CiAgQHBhcmFtIHtPYmpl
        Y3R9IFt0YXJnZXRdIHRhcmdldCBvZiBtZXRob2QgdG8gaW52b2tlCiAgQHBh
        cmFtIHtGdW5jdGlvbnxTdHJpbmd9IG1ldGhvZCBUaGUgbWV0aG9kIHRvIGlu
        dm9rZS4KICAgIElmIHlvdSBwYXNzIGEgc3RyaW5nIGl0IHdpbGwgYmUgcmVz
        b2x2ZWQgb24gdGhlCiAgICB0YXJnZXQgYXQgdGhlIHRpbWUgdGhlIG1ldGhv
        ZCBpcyBpbnZva2VkLgogIEBwYXJhbSB7T2JqZWN0fSBbYXJncypdIE9wdGlv
        bmFsIGFyZ3VtZW50cyB0byBwYXNzIHRvIHRoZSB0aW1lb3V0LgogIEByZXR1
        cm4ge09iamVjdH0gdGltZXIKKi8KRW1iZXIucnVuLm5leHQgPSBmdW5jdGlv
        bigpIHsKICB2YXIgYXJncyA9IHNsaWNlLmNhbGwoYXJndW1lbnRzKTsKICBh
        cmdzLnB1c2goMSk7CiAgcmV0dXJuIGJhY2tidXJuZXIubGF0ZXIuYXBwbHko
        YmFja2J1cm5lciwgYXJncyk7Cn07CgovKioKICBDYW5jZWxzIGEgc2NoZWR1
        bGVkIGl0ZW0uIE11c3QgYmUgYSB2YWx1ZSByZXR1cm5lZCBieSBgRW1iZXIu
        cnVuLmxhdGVyKClgLAogIGBFbWJlci5ydW4ub25jZSgpYCwgb3IgYEVtYmVy
        LnJ1bi5uZXh0KClgLgoKICBgYGBqYXZhc2NyaXB0CiAgdmFyIHJ1bk5leHQg
        PSBFbWJlci5ydW4ubmV4dChteUNvbnRleHQsIGZ1bmN0aW9uKCkgewogICAg
        Ly8gd2lsbCBub3QgYmUgZXhlY3V0ZWQKICB9KTsKICBFbWJlci5ydW4uY2Fu
        Y2VsKHJ1bk5leHQpOwoKICB2YXIgcnVuTGF0ZXIgPSBFbWJlci5ydW4ubGF0
        ZXIobXlDb250ZXh0LCBmdW5jdGlvbigpIHsKICAgIC8vIHdpbGwgbm90IGJl
        IGV4ZWN1dGVkCiAgfSwgNTAwKTsKICBFbWJlci5ydW4uY2FuY2VsKHJ1bkxh
        dGVyKTsKCiAgdmFyIHJ1bk9uY2UgPSBFbWJlci5ydW4ub25jZShteUNvbnRl
        eHQsIGZ1bmN0aW9uKCkgewogICAgLy8gd2lsbCBub3QgYmUgZXhlY3V0ZWQK
        ICB9KTsKICBFbWJlci5ydW4uY2FuY2VsKHJ1bk9uY2UpOwogIGBgYAoKICBA
        bWV0aG9kIGNhbmNlbAogIEBwYXJhbSB7T2JqZWN0fSB0aW1lciBUaW1lciBv
        YmplY3QgdG8gY2FuY2VsCiAgQHJldHVybiB7dm9pZH0KKi8KRW1iZXIucnVu
        LmNhbmNlbCA9IGZ1bmN0aW9uKHRpbWVyKSB7CiAgcmV0dXJuIGJhY2tidXJu
        ZXIuY2FuY2VsKHRpbWVyKTsKfTsKCi8qKgogIERlbGF5IGNhbGxpbmcgdGhl
        IHRhcmdldCBtZXRob2QgdW50aWwgdGhlIGRlYm91bmNlIHBlcmlvZCBoYXMg
        ZWxhcHNlZAogIHdpdGggbm8gYWRkaXRpb25hbCBkZWJvdW5jZSBjYWxscy4g
        SWYgYGRlYm91bmNlYCBpcyBjYWxsZWQgYWdhaW4gYmVmb3JlCiAgdGhlIHNw
        ZWNpZmllZCB0aW1lIGhhcyBlbGFwc2VkLCB0aGUgdGltZXIgaXMgcmVzZXQg
        YW5kIHRoZSBlbnRpcmUgcGVyaW9kCiAgbXVzdCBwYXNzIGFnYWluIGJlZm9y
        ZSB0aGUgdGFyZ2V0IG1ldGhvZCBpcyBjYWxsZWQuCgogIFRoaXMgbWV0aG9k
        IHNob3VsZCBiZSB1c2VkIHdoZW4gYW4gZXZlbnQgbWF5IGJlIGNhbGxlZCBt
        dWx0aXBsZSB0aW1lcwogIGJ1dCB0aGUgYWN0aW9uIHNob3VsZCBvbmx5IGJl
        IGNhbGxlZCBvbmNlIHdoZW4gdGhlIGV2ZW50IGlzIGRvbmUgZmlyaW5nLgog
        IEEgY29tbW9uIGV4YW1wbGUgaXMgZm9yIHNjcm9sbCBldmVudHMgd2hlcmUg
        eW91IG9ubHkgd2FudCB1cGRhdGVzIHRvCiAgaGFwcGVuIG9uY2Ugc2Nyb2xs
        aW5nIGhhcyBjZWFzZWQuCgogIGBgYGphdmFzY3JpcHQKICAgIHZhciBteUZ1
        bmMgPSBmdW5jdGlvbigpIHsgY29uc29sZS5sb2codGhpcy5uYW1lICsgJyBy
        YW4uJyk7IH07CiAgICB2YXIgbXlDb250ZXh0ID0ge25hbWU6ICdkZWJvdW5j
        ZSd9OwoKICAgIEVtYmVyLnJ1bi5kZWJvdW5jZShteUNvbnRleHQsIG15RnVu
        YywgMTUwKTsKCiAgICAvLyBsZXNzIHRoYW4gMTUwbXMgcGFzc2VzCgogICAg
        RW1iZXIucnVuLmRlYm91bmNlKG15Q29udGV4dCwgbXlGdW5jLCAxNTApOwoK
        ICAgIC8vIDE1MG1zIHBhc3NlcwogICAgLy8gbXlGdW5jIGlzIGludm9rZWQg
        d2l0aCBjb250ZXh0IG15Q29udGV4dAogICAgLy8gY29uc29sZSBsb2dzICdk
        ZWJvdW5jZSByYW4uJyBvbmUgdGltZS4KICBgYGAKCiAgQG1ldGhvZCBkZWJv
        dW5jZQogIEBwYXJhbSB7T2JqZWN0fSBbdGFyZ2V0XSB0YXJnZXQgb2YgbWV0
        aG9kIHRvIGludm9rZQogIEBwYXJhbSB7RnVuY3Rpb258U3RyaW5nfSBtZXRo
        b2QgVGhlIG1ldGhvZCB0byBpbnZva2UuCiAgICBNYXkgYmUgYSBmdW5jdGlv
        biBvciBhIHN0cmluZy4gSWYgeW91IHBhc3MgYSBzdHJpbmcKICAgIHRoZW4g
        aXQgd2lsbCBiZSBsb29rZWQgdXAgb24gdGhlIHBhc3NlZCB0YXJnZXQuCiAg
        QHBhcmFtIHtPYmplY3R9IFthcmdzKl0gT3B0aW9uYWwgYXJndW1lbnRzIHRv
        IHBhc3MgdG8gdGhlIHRpbWVvdXQuCiAgQHBhcmFtIHtOdW1iZXJ9IHdhaXQg
        TnVtYmVyIG9mIG1pbGxpc2Vjb25kcyB0byB3YWl0LgogIEBwYXJhbSB7Qm9v
        bGVhbn0gaW1tZWRpYXRlIFRyaWdnZXIgdGhlIGZ1bmN0aW9uIG9uIHRoZSBs
        ZWFkaW5nIGluc3RlYWQgb2YgdGhlIHRyYWlsaW5nIGVkZ2Ugb2YgdGhlIHdh
        aXQgaW50ZXJ2YWwuCiAgQHJldHVybiB7dm9pZH0KKi8KRW1iZXIucnVuLmRl
        Ym91bmNlID0gZnVuY3Rpb24oKSB7CiAgcmV0dXJuIGJhY2tidXJuZXIuZGVi
        b3VuY2UuYXBwbHkoYmFja2J1cm5lciwgYXJndW1lbnRzKTsKfTsKCi8qKgog
        IEVuc3VyZSB0aGF0IHRoZSB0YXJnZXQgbWV0aG9kIGlzIG5ldmVyIGNhbGxl
        ZCBtb3JlIGZyZXF1ZW50bHkgdGhhbgogIHRoZSBzcGVjaWZpZWQgc3BhY2lu
        ZyBwZXJpb2QuCgogIGBgYGphdmFzY3JpcHQKICAgIHZhciBteUZ1bmMgPSBm
        dW5jdGlvbigpIHsgY29uc29sZS5sb2codGhpcy5uYW1lICsgJyByYW4uJyk7
        IH07CiAgICB2YXIgbXlDb250ZXh0ID0ge25hbWU6ICd0aHJvdHRsZSd9OwoK
        ICAgIEVtYmVyLnJ1bi50aHJvdHRsZShteUNvbnRleHQsIG15RnVuYywgMTUw
        KTsKCiAgICAvLyA1MG1zIHBhc3NlcwogICAgRW1iZXIucnVuLnRocm90dGxl
        KG15Q29udGV4dCwgbXlGdW5jLCAxNTApOwoKICAgIC8vIDUwbXMgcGFzc2Vz
        CiAgICBFbWJlci5ydW4udGhyb3R0bGUobXlDb250ZXh0LCBteUZ1bmMsIDE1
        MCk7CgogICAgLy8gNTBtcyBwYXNzZXMKICAgIEVtYmVyLnJ1bi50aHJvdHRs
        ZShteUNvbnRleHQsIG15RnVuYywgMTUwKTsKCiAgICAvLyAxNTBtcyBwYXNz
        ZXMKICAgIC8vIG15RnVuYyBpcyBpbnZva2VkIHdpdGggY29udGV4dCBteUNv
        bnRleHQKICAgIC8vIGNvbnNvbGUgbG9ncyAndGhyb3R0bGUgcmFuLicgdHdp
        Y2UsIDE1MG1zIGFwYXJ0LgogIGBgYAoKICBAbWV0aG9kIHRocm90dGxlCiAg
        QHBhcmFtIHtPYmplY3R9IFt0YXJnZXRdIHRhcmdldCBvZiBtZXRob2QgdG8g
        aW52b2tlCiAgQHBhcmFtIHtGdW5jdGlvbnxTdHJpbmd9IG1ldGhvZCBUaGUg
        bWV0aG9kIHRvIGludm9rZS4KICAgIE1heSBiZSBhIGZ1bmN0aW9uIG9yIGEg
        c3RyaW5nLiBJZiB5b3UgcGFzcyBhIHN0cmluZwogICAgdGhlbiBpdCB3aWxs
        IGJlIGxvb2tlZCB1cCBvbiB0aGUgcGFzc2VkIHRhcmdldC4KICBAcGFyYW0g
        e09iamVjdH0gW2FyZ3MqXSBPcHRpb25hbCBhcmd1bWVudHMgdG8gcGFzcyB0
        byB0aGUgdGltZW91dC4KICBAcGFyYW0ge051bWJlcn0gc3BhY2luZyBOdW1i
        ZXIgb2YgbWlsbGlzZWNvbmRzIHRvIHNwYWNlIG91dCByZXF1ZXN0cy4KICBA
        cmV0dXJuIHt2b2lkfQoqLwpFbWJlci5ydW4udGhyb3R0bGUgPSBmdW5jdGlv
        bigpIHsKICByZXR1cm4gYmFja2J1cm5lci50aHJvdHRsZS5hcHBseShiYWNr
        YnVybmVyLCBhcmd1bWVudHMpOwp9OwoKLy8gTWFrZSBzdXJlIGl0J3Mgbm90
        IGFuIGF1dG9ydW4gZHVyaW5nIHRlc3RpbmcKZnVuY3Rpb24gY2hlY2tBdXRv
        UnVuKCkgewogIGlmICghRW1iZXIucnVuLmN1cnJlbnRSdW5Mb29wKSB7CiAg
        ICBFbWJlci5hc3NlcnQoIllvdSBoYXZlIHR1cm5lZCBvbiB0ZXN0aW5nIG1v
        ZGUsIHdoaWNoIGRpc2FibGVkIHRoZSBydW4tbG9vcCdzIGF1dG9ydW4uIFlv
        dSB3aWxsIG5lZWQgdG8gd3JhcCBhbnkgY29kZSB3aXRoIGFzeW5jaHJvbm91
        cyBzaWRlLWVmZmVjdHMgaW4gYW4gRW1iZXIucnVuIiwgIUVtYmVyLnRlc3Rp
        bmcpOwogIH0KfQoKfSkoKTsKCgoKKGZ1bmN0aW9uKCkgewovLyBFbWJlci5M
        b2dnZXIKLy8gZ2V0Ci8vIHNldAovLyBndWlkRm9yLCBtZXRhCi8vIGFkZE9i
        c2VydmVyLCByZW1vdmVPYnNlcnZlcgovLyBFbWJlci5ydW4uc2NoZWR1bGUK
        LyoqCkBtb2R1bGUgZW1iZXItbWV0YWwKKi8KCi8vIC4uLi4uLi4uLi4uLi4u
        Li4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4K
        Ly8gQ09OU1RBTlRTCi8vCgovKioKICBEZWJ1ZyBwYXJhbWV0ZXIgeW91IGNh
        biB0dXJuIG9uLiBUaGlzIHdpbGwgbG9nIGFsbCBiaW5kaW5ncyB0aGF0IGZp
        cmUgdG8KICB0aGUgY29uc29sZS4gVGhpcyBzaG91bGQgYmUgZGlzYWJsZWQg
        aW4gcHJvZHVjdGlvbiBjb2RlLiBOb3RlIHRoYXQgeW91CiAgY2FuIGFsc28g
        ZW5hYmxlIHRoaXMgZnJvbSB0aGUgY29uc29sZSBvciB0ZW1wb3JhcmlseS4K
        CiAgQHByb3BlcnR5IExPR19CSU5ESU5HUwogIEBmb3IgRW1iZXIKICBAdHlw
        ZSBCb29sZWFuCiAgQGRlZmF1bHQgZmFsc2UKKi8KRW1iZXIuTE9HX0JJTkRJ
        TkdTID0gZmFsc2UgfHwgISFFbWJlci5FTlYuTE9HX0JJTkRJTkdTOwoKdmFy
        IGdldCAgICAgPSBFbWJlci5nZXQsCiAgICBzZXQgICAgID0gRW1iZXIuc2V0
        LAogICAgZ3VpZEZvciA9IEVtYmVyLmd1aWRGb3IsCiAgICBJU19HTE9CQUwg
        PSAvXihbQS1aJF18KFswLTldW0EtWiRdKSkvOwoKLyoqCiAgUmV0dXJucyB0
        cnVlIGlmIHRoZSBwcm92aWRlZCBwYXRoIGlzIGdsb2JhbCAoZS5nLiwgYE15
        QXBwLmZvb0NvbnRyb2xsZXIuYmFyYCkKICBpbnN0ZWFkIG9mIGxvY2FsIChg
        Zm9vLmJhci5iYXpgKS4KCiAgQG1ldGhvZCBpc0dsb2JhbFBhdGgKICBAZm9y
        IEVtYmVyCiAgQHByaXZhdGUKICBAcGFyYW0ge1N0cmluZ30gcGF0aAogIEBy
        ZXR1cm4gQm9vbGVhbgoqLwp2YXIgaXNHbG9iYWxQYXRoID0gRW1iZXIuaXNH
        bG9iYWxQYXRoID0gZnVuY3Rpb24ocGF0aCkgewogIHJldHVybiBJU19HTE9C
        QUwudGVzdChwYXRoKTsKfTsKCmZ1bmN0aW9uIGdldFdpdGhHbG9iYWxzKG9i
        aiwgcGF0aCkgewogIHJldHVybiBnZXQoaXNHbG9iYWxQYXRoKHBhdGgpID8g
        RW1iZXIubG9va3VwIDogb2JqLCBwYXRoKTsKfQoKLy8gLi4uLi4uLi4uLi4u
        Li4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4u
        LgovLyBCSU5ESU5HCi8vCgp2YXIgQmluZGluZyA9IGZ1bmN0aW9uKHRvUGF0
        aCwgZnJvbVBhdGgpIHsKICB0aGlzLl9kaXJlY3Rpb24gPSAnZndkJzsKICB0
        aGlzLl9mcm9tID0gZnJvbVBhdGg7CiAgdGhpcy5fdG8gICA9IHRvUGF0aDsK
        ICB0aGlzLl9kaXJlY3Rpb25NYXAgPSBFbWJlci5NYXAuY3JlYXRlKCk7Cn07
        CgovKioKQGNsYXNzIEJpbmRpbmcKQG5hbWVzcGFjZSBFbWJlcgoqLwoKQmlu
        ZGluZy5wcm90b3R5cGUgPSB7CiAgLyoqCiAgICBUaGlzIGNvcGllcyB0aGUg
        QmluZGluZyBzbyBpdCBjYW4gYmUgY29ubmVjdGVkIHRvIGFub3RoZXIgb2Jq
        ZWN0LgoKICAgIEBtZXRob2QgY29weQogICAgQHJldHVybiB7RW1iZXIuQmlu
        ZGluZ30gYHRoaXNgCiAgKi8KICBjb3B5OiBmdW5jdGlvbiAoKSB7CiAgICB2
        YXIgY29weSA9IG5ldyBCaW5kaW5nKHRoaXMuX3RvLCB0aGlzLl9mcm9tKTsK
        ICAgIGlmICh0aGlzLl9vbmVXYXkpIHsgY29weS5fb25lV2F5ID0gdHJ1ZTsg
        fQogICAgcmV0dXJuIGNvcHk7CiAgfSwKCiAgLy8gLi4uLi4uLi4uLi4uLi4u
        Li4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLgog
        IC8vIENPTkZJRwogIC8vCgogIC8qKgogICAgVGhpcyB3aWxsIHNldCBgZnJv
        bWAgcHJvcGVydHkgcGF0aCB0byB0aGUgc3BlY2lmaWVkIHZhbHVlLiBJdCB3
        aWxsIG5vdAogICAgYXR0ZW1wdCB0byByZXNvbHZlIHRoaXMgcHJvcGVydHkg
        cGF0aCB0byBhbiBhY3R1YWwgb2JqZWN0IHVudGlsIHlvdQogICAgY29ubmVj
        dCB0aGUgYmluZGluZy4KCiAgICBUaGUgYmluZGluZyB3aWxsIHNlYXJjaCBm
        b3IgdGhlIHByb3BlcnR5IHBhdGggc3RhcnRpbmcgYXQgdGhlIHJvb3Qgb2Jq
        ZWN0CiAgICB5b3UgcGFzcyB3aGVuIHlvdSBgY29ubmVjdCgpYCB0aGUgYmlu
        ZGluZy4gSXQgZm9sbG93cyB0aGUgc2FtZSBydWxlcyBhcwogICAgYGdldCgp
        YCAtIHNlZSB0aGF0IG1ldGhvZCBmb3IgbW9yZSBpbmZvcm1hdGlvbi4KCiAg
        ICBAbWV0aG9kIGZyb20KICAgIEBwYXJhbSB7U3RyaW5nfSBwYXRoIHRoZSBw
        cm9wZXJ0eSBwYXRoIHRvIGNvbm5lY3QgdG8KICAgIEByZXR1cm4ge0VtYmVy
        LkJpbmRpbmd9IGB0aGlzYAogICovCiAgZnJvbTogZnVuY3Rpb24ocGF0aCkg
        ewogICAgdGhpcy5fZnJvbSA9IHBhdGg7CiAgICByZXR1cm4gdGhpczsKICB9
        LAoKICAvKioKICAgIFRoaXMgd2lsbCBzZXQgdGhlIGB0b2AgcHJvcGVydHkg
        cGF0aCB0byB0aGUgc3BlY2lmaWVkIHZhbHVlLiBJdCB3aWxsIG5vdAogICAg
        YXR0ZW1wdCB0byByZXNvbHZlIHRoaXMgcHJvcGVydHkgcGF0aCB0byBhbiBh
        Y3R1YWwgb2JqZWN0IHVudGlsIHlvdQogICAgY29ubmVjdCB0aGUgYmluZGlu
        Zy4KCiAgICBUaGUgYmluZGluZyB3aWxsIHNlYXJjaCBmb3IgdGhlIHByb3Bl
        cnR5IHBhdGggc3RhcnRpbmcgYXQgdGhlIHJvb3Qgb2JqZWN0CiAgICB5b3Ug
        cGFzcyB3aGVuIHlvdSBgY29ubmVjdCgpYCB0aGUgYmluZGluZy4gSXQgZm9s
        bG93cyB0aGUgc2FtZSBydWxlcyBhcwogICAgYGdldCgpYCAtIHNlZSB0aGF0
        IG1ldGhvZCBmb3IgbW9yZSBpbmZvcm1hdGlvbi4KCiAgICBAbWV0aG9kIHRv
        CiAgICBAcGFyYW0ge1N0cmluZ3xUdXBsZX0gcGF0aCBBIHByb3BlcnR5IHBh
        dGggb3IgdHVwbGUKICAgIEByZXR1cm4ge0VtYmVyLkJpbmRpbmd9IGB0aGlz
        YAogICovCiAgdG86IGZ1bmN0aW9uKHBhdGgpIHsKICAgIHRoaXMuX3RvID0g
        cGF0aDsKICAgIHJldHVybiB0aGlzOwogIH0sCgogIC8qKgogICAgQ29uZmln
        dXJlcyB0aGUgYmluZGluZyBhcyBvbmUgd2F5LiBBIG9uZS13YXkgYmluZGlu
        ZyB3aWxsIHJlbGF5IGNoYW5nZXMKICAgIG9uIHRoZSBgZnJvbWAgc2lkZSB0
        byB0aGUgYHRvYCBzaWRlLCBidXQgbm90IHRoZSBvdGhlciB3YXkgYXJvdW5k
        LiBUaGlzCiAgICBtZWFucyB0aGF0IGlmIHlvdSBjaGFuZ2UgdGhlIGB0b2Ag
        c2lkZSBkaXJlY3RseSwgdGhlIGBmcm9tYCBzaWRlIG1heSBoYXZlCiAgICBh
        IGRpZmZlcmVudCB2YWx1ZS4KCiAgICBAbWV0aG9kIG9uZVdheQogICAgQHJl
        dHVybiB7RW1iZXIuQmluZGluZ30gYHRoaXNgCiAgKi8KICBvbmVXYXk6IGZ1
        bmN0aW9uKCkgewogICAgdGhpcy5fb25lV2F5ID0gdHJ1ZTsKICAgIHJldHVy
        biB0aGlzOwogIH0sCgogIC8qKgogICAgQG1ldGhvZCB0b1N0cmluZwogICAg
        QHJldHVybiB7U3RyaW5nfSBzdHJpbmcgcmVwcmVzZW50YXRpb24gb2YgYmlu
        ZGluZwogICovCiAgdG9TdHJpbmc6IGZ1bmN0aW9uKCkgewogICAgdmFyIG9u
        ZVdheSA9IHRoaXMuX29uZVdheSA/ICdbb25lV2F5XScgOiAnJzsKICAgIHJl
        dHVybiAiRW1iZXIuQmluZGluZzwiICsgZ3VpZEZvcih0aGlzKSArICI+KCIg
        KyB0aGlzLl9mcm9tICsgIiAtPiAiICsgdGhpcy5fdG8gKyAiKSIgKyBvbmVX
        YXk7CiAgfSwKCiAgLy8gLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4u
        Li4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLgogIC8vIENPTk5FQ1QgQU5E
        IFNZTkMKICAvLwoKICAvKioKICAgIEF0dGVtcHRzIHRvIGNvbm5lY3QgdGhp
        cyBiaW5kaW5nIGluc3RhbmNlIHNvIHRoYXQgaXQgY2FuIHJlY2VpdmUgYW5k
        IHJlbGF5CiAgICBjaGFuZ2VzLiBUaGlzIG1ldGhvZCB3aWxsIHJhaXNlIGFu
        IGV4Y2VwdGlvbiBpZiB5b3UgaGF2ZSBub3Qgc2V0IHRoZQogICAgZnJvbS90
        byBwcm9wZXJ0aWVzIHlldC4KCiAgICBAbWV0aG9kIGNvbm5lY3QKICAgIEBw
        YXJhbSB7T2JqZWN0fSBvYmogVGhlIHJvb3Qgb2JqZWN0IGZvciB0aGlzIGJp
        bmRpbmcuCiAgICBAcmV0dXJuIHtFbWJlci5CaW5kaW5nfSBgdGhpc2AKICAq
        LwogIGNvbm5lY3Q6IGZ1bmN0aW9uKG9iaikgewogICAgRW1iZXIuYXNzZXJ0
        KCdNdXN0IHBhc3MgYSB2YWxpZCBvYmplY3QgdG8gRW1iZXIuQmluZGluZy5j
        b25uZWN0KCknLCAhIW9iaik7CgogICAgdmFyIGZyb21QYXRoID0gdGhpcy5f
        ZnJvbSwgdG9QYXRoID0gdGhpcy5fdG87CiAgICBFbWJlci50cnlTZXQob2Jq
        LCB0b1BhdGgsIGdldFdpdGhHbG9iYWxzKG9iaiwgZnJvbVBhdGgpKTsKCiAg
        ICAvLyBhZGQgYW4gb2JzZXJ2ZXIgb24gdGhlIG9iamVjdCB0byBiZSBub3Rp
        ZmllZCB3aGVuIHRoZSBiaW5kaW5nIHNob3VsZCBiZSB1cGRhdGVkCiAgICBF
        bWJlci5hZGRPYnNlcnZlcihvYmosIGZyb21QYXRoLCB0aGlzLCB0aGlzLmZy
        b21EaWRDaGFuZ2UpOwoKICAgIC8vIGlmIHRoZSBiaW5kaW5nIGlzIGEgdHdv
        LXdheSBiaW5kaW5nLCBhbHNvIHNldCB1cCBhbiBvYnNlcnZlciBvbiB0aGUg
        dGFyZ2V0CiAgICBpZiAoIXRoaXMuX29uZVdheSkgeyBFbWJlci5hZGRPYnNl
        cnZlcihvYmosIHRvUGF0aCwgdGhpcywgdGhpcy50b0RpZENoYW5nZSk7IH0K
        CiAgICB0aGlzLl9yZWFkeVRvU3luYyA9IHRydWU7CgogICAgcmV0dXJuIHRo
        aXM7CiAgfSwKCiAgLyoqCiAgICBEaXNjb25uZWN0cyB0aGUgYmluZGluZyBp
        bnN0YW5jZS4gQ2hhbmdlcyB3aWxsIG5vIGxvbmdlciBiZSByZWxheWVkLiBZ
        b3UKICAgIHdpbGwgbm90IHVzdWFsbHkgbmVlZCB0byBjYWxsIHRoaXMgbWV0
        aG9kLgoKICAgIEBtZXRob2QgZGlzY29ubmVjdAogICAgQHBhcmFtIHtPYmpl
        Y3R9IG9iaiBUaGUgcm9vdCBvYmplY3QgeW91IHBhc3NlZCB3aGVuIGNvbm5l
        Y3RpbmcgdGhlIGJpbmRpbmcuCiAgICBAcmV0dXJuIHtFbWJlci5CaW5kaW5n
        fSBgdGhpc2AKICAqLwogIGRpc2Nvbm5lY3Q6IGZ1bmN0aW9uKG9iaikgewog
        ICAgRW1iZXIuYXNzZXJ0KCdNdXN0IHBhc3MgYSB2YWxpZCBvYmplY3QgdG8g
        RW1iZXIuQmluZGluZy5kaXNjb25uZWN0KCknLCAhIW9iaik7CgogICAgdmFy
        IHR3b1dheSA9ICF0aGlzLl9vbmVXYXk7CgogICAgLy8gcmVtb3ZlIGFuIG9i
        c2VydmVyIG9uIHRoZSBvYmplY3Qgc28gd2UncmUgbm8gbG9uZ2VyIG5vdGlm
        aWVkIG9mCiAgICAvLyBjaGFuZ2VzIHRoYXQgc2hvdWxkIHVwZGF0ZSBiaW5k
        aW5ncy4KICAgIEVtYmVyLnJlbW92ZU9ic2VydmVyKG9iaiwgdGhpcy5fZnJv
        bSwgdGhpcywgdGhpcy5mcm9tRGlkQ2hhbmdlKTsKCiAgICAvLyBpZiB0aGUg
        YmluZGluZyBpcyB0d28td2F5LCByZW1vdmUgdGhlIG9ic2VydmVyIGZyb20g
        dGhlIHRhcmdldCBhcyB3ZWxsCiAgICBpZiAodHdvV2F5KSB7IEVtYmVyLnJl
        bW92ZU9ic2VydmVyKG9iaiwgdGhpcy5fdG8sIHRoaXMsIHRoaXMudG9EaWRD
        aGFuZ2UpOyB9CgogICAgdGhpcy5fcmVhZHlUb1N5bmMgPSBmYWxzZTsgLy8g
        ZGlzYWJsZSBzY2hlZHVsZWQgc3luY3MuLi4KICAgIHJldHVybiB0aGlzOwog
        IH0sCgogIC8vIC4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4u
        Li4uLi4uLi4uLi4uLi4uLi4uLi4uLi4KICAvLyBQUklWQVRFCiAgLy8KCiAg
        LyogY2FsbGVkIHdoZW4gdGhlIGZyb20gc2lkZSBjaGFuZ2VzICovCiAgZnJv
        bURpZENoYW5nZTogZnVuY3Rpb24odGFyZ2V0KSB7CiAgICB0aGlzLl9zY2hl
        ZHVsZVN5bmModGFyZ2V0LCAnZndkJyk7CiAgfSwKCiAgLyogY2FsbGVkIHdo
        ZW4gdGhlIHRvIHNpZGUgY2hhbmdlcyAqLwogIHRvRGlkQ2hhbmdlOiBmdW5j
        dGlvbih0YXJnZXQpIHsKICAgIHRoaXMuX3NjaGVkdWxlU3luYyh0YXJnZXQs
        ICdiYWNrJyk7CiAgfSwKCiAgX3NjaGVkdWxlU3luYzogZnVuY3Rpb24ob2Jq
        LCBkaXIpIHsKICAgIHZhciBkaXJlY3Rpb25NYXAgPSB0aGlzLl9kaXJlY3Rp
        b25NYXA7CiAgICB2YXIgZXhpc3RpbmdEaXIgPSBkaXJlY3Rpb25NYXAuZ2V0
        KG9iaik7CgogICAgLy8gaWYgd2UgaGF2ZW4ndCBzY2hlZHVsZWQgdGhlIGJp
        bmRpbmcgeWV0LCBzY2hlZHVsZSBpdAogICAgaWYgKCFleGlzdGluZ0Rpcikg
        ewogICAgICBFbWJlci5ydW4uc2NoZWR1bGUoJ3N5bmMnLCB0aGlzLCB0aGlz
        Ll9zeW5jLCBvYmopOwogICAgICBkaXJlY3Rpb25NYXAuc2V0KG9iaiwgZGly
        KTsKICAgIH0KCiAgICAvLyBJZiBib3RoIGEgJ2JhY2snIGFuZCAnZndkJyBz
        eW5jIGhhdmUgYmVlbiBzY2hlZHVsZWQgb24gdGhlIHNhbWUgb2JqZWN0LAog
        ICAgLy8gZGVmYXVsdCB0byBhICdmd2QnIHN5bmMgc28gdGhhdCBpdCByZW1h
        aW5zIGRldGVybWluaXN0aWMuCiAgICBpZiAoZXhpc3RpbmdEaXIgPT09ICdi
        YWNrJyAmJiBkaXIgPT09ICdmd2QnKSB7CiAgICAgIGRpcmVjdGlvbk1hcC5z
        ZXQob2JqLCAnZndkJyk7CiAgICB9CiAgfSwKCiAgX3N5bmM6IGZ1bmN0aW9u
        KG9iaikgewogICAgdmFyIGxvZyA9IEVtYmVyLkxPR19CSU5ESU5HUzsKCiAg
        ICAvLyBkb24ndCBzeW5jaHJvbml6ZSBkZXN0cm95ZWQgb2JqZWN0cyBvciBk
        aXNjb25uZWN0ZWQgYmluZGluZ3MKICAgIGlmIChvYmouaXNEZXN0cm95ZWQg
        fHwgIXRoaXMuX3JlYWR5VG9TeW5jKSB7IHJldHVybjsgfQoKICAgIC8vIGdl
        dCB0aGUgZGlyZWN0aW9uIG9mIHRoZSBiaW5kaW5nIGZvciB0aGUgb2JqZWN0
        IHdlIGFyZQogICAgLy8gc3luY2hyb25pemluZyBmcm9tCiAgICB2YXIgZGly
        ZWN0aW9uTWFwID0gdGhpcy5fZGlyZWN0aW9uTWFwOwogICAgdmFyIGRpcmVj
        dGlvbiA9IGRpcmVjdGlvbk1hcC5nZXQob2JqKTsKCiAgICB2YXIgZnJvbVBh
        dGggPSB0aGlzLl9mcm9tLCB0b1BhdGggPSB0aGlzLl90bzsKCiAgICBkaXJl
        Y3Rpb25NYXAucmVtb3ZlKG9iaik7CgogICAgLy8gaWYgd2UncmUgc3luY2hy
        b25pemluZyBmcm9tIHRoZSByZW1vdGUgb2JqZWN0Li4uCiAgICBpZiAoZGly
        ZWN0aW9uID09PSAnZndkJykgewogICAgICB2YXIgZnJvbVZhbHVlID0gZ2V0
        V2l0aEdsb2JhbHMob2JqLCB0aGlzLl9mcm9tKTsKICAgICAgaWYgKGxvZykg
        ewogICAgICAgIEVtYmVyLkxvZ2dlci5sb2coJyAnLCB0aGlzLnRvU3RyaW5n
        KCksICctPicsIGZyb21WYWx1ZSwgb2JqKTsKICAgICAgfQogICAgICBpZiAo
        dGhpcy5fb25lV2F5KSB7CiAgICAgICAgRW1iZXIudHJ5U2V0KG9iaiwgdG9Q
        YXRoLCBmcm9tVmFsdWUpOwogICAgICB9IGVsc2UgewogICAgICAgIEVtYmVy
        Ll9zdXNwZW5kT2JzZXJ2ZXIob2JqLCB0b1BhdGgsIHRoaXMsIHRoaXMudG9E
        aWRDaGFuZ2UsIGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEVtYmVyLnRyeVNl
        dChvYmosIHRvUGF0aCwgZnJvbVZhbHVlKTsKICAgICAgICB9KTsKICAgICAg
        fQogICAgLy8gaWYgd2UncmUgc3luY2hyb25pemluZyAqdG8qIHRoZSByZW1v
        dGUgb2JqZWN0CiAgICB9IGVsc2UgaWYgKGRpcmVjdGlvbiA9PT0gJ2JhY2sn
        KSB7CiAgICAgIHZhciB0b1ZhbHVlID0gZ2V0KG9iaiwgdGhpcy5fdG8pOwog
        ICAgICBpZiAobG9nKSB7CiAgICAgICAgRW1iZXIuTG9nZ2VyLmxvZygnICcs
        IHRoaXMudG9TdHJpbmcoKSwgJzwtJywgdG9WYWx1ZSwgb2JqKTsKICAgICAg
        fQogICAgICBFbWJlci5fc3VzcGVuZE9ic2VydmVyKG9iaiwgZnJvbVBhdGgs
        IHRoaXMsIHRoaXMuZnJvbURpZENoYW5nZSwgZnVuY3Rpb24gKCkgewogICAg
        ICAgIEVtYmVyLnRyeVNldChFbWJlci5pc0dsb2JhbFBhdGgoZnJvbVBhdGgp
        ID8gRW1iZXIubG9va3VwIDogb2JqLCBmcm9tUGF0aCwgdG9WYWx1ZSk7CiAg
        ICAgIH0pOwogICAgfQogIH0KCn07CgpmdW5jdGlvbiBtaXhpblByb3BlcnRp
        ZXModG8sIGZyb20pIHsKICBmb3IgKHZhciBrZXkgaW4gZnJvbSkgewogICAg
        aWYgKGZyb20uaGFzT3duUHJvcGVydHkoa2V5KSkgewogICAgICB0b1trZXld
        ID0gZnJvbVtrZXldOwogICAgfQogIH0KfQoKbWl4aW5Qcm9wZXJ0aWVzKEJp
        bmRpbmcsIHsKCiAgLyoKICAgIFNlZSBgRW1iZXIuQmluZGluZy5mcm9tYC4K
        CiAgICBAbWV0aG9kIGZyb20KICAgIEBzdGF0aWMKICAqLwogIGZyb206IGZ1
        bmN0aW9uKCkgewogICAgdmFyIEMgPSB0aGlzLCBiaW5kaW5nID0gbmV3IEMo
        KTsKICAgIHJldHVybiBiaW5kaW5nLmZyb20uYXBwbHkoYmluZGluZywgYXJn
        dW1lbnRzKTsKICB9LAoKICAvKgogICAgU2VlIGBFbWJlci5CaW5kaW5nLnRv
        YC4KCiAgICBAbWV0aG9kIHRvCiAgICBAc3RhdGljCiAgKi8KICB0bzogZnVu
        Y3Rpb24oKSB7CiAgICB2YXIgQyA9IHRoaXMsIGJpbmRpbmcgPSBuZXcgQygp
        OwogICAgcmV0dXJuIGJpbmRpbmcudG8uYXBwbHkoYmluZGluZywgYXJndW1l
        bnRzKTsKICB9LAoKICAvKioKICAgIENyZWF0ZXMgYSBuZXcgQmluZGluZyBp
        bnN0YW5jZSBhbmQgbWFrZXMgaXQgYXBwbHkgaW4gYSBzaW5nbGUgZGlyZWN0
        aW9uLgogICAgQSBvbmUtd2F5IGJpbmRpbmcgd2lsbCByZWxheSBjaGFuZ2Vz
        IG9uIHRoZSBgZnJvbWAgc2lkZSBvYmplY3QgKHN1cHBsaWVkCiAgICBhcyB0
        aGUgYGZyb21gIGFyZ3VtZW50KSB0aGUgYHRvYCBzaWRlLCBidXQgbm90IHRo
        ZSBvdGhlciB3YXkgYXJvdW5kLgogICAgVGhpcyBtZWFucyB0aGF0IGlmIHlv
        dSBjaGFuZ2UgdGhlICJ0byIgc2lkZSBkaXJlY3RseSwgdGhlICJmcm9tIiBz
        aWRlIG1heSBoYXZlCiAgICBhIGRpZmZlcmVudCB2YWx1ZS4KCiAgICBTZWUg
        YEJpbmRpbmcub25lV2F5YC4KCiAgICBAbWV0aG9kIG9uZVdheQogICAgQHBh
        cmFtIHtTdHJpbmd9IGZyb20gZnJvbSBwYXRoLgogICAgQHBhcmFtIHtCb29s
        ZWFufSBbZmxhZ10gKE9wdGlvbmFsKSBwYXNzaW5nIG5vdGhpbmcgaGVyZSB3
        aWxsIG1ha2UgdGhlCiAgICAgIGJpbmRpbmcgYG9uZVdheWAuIFlvdSBjYW4g
        aW5zdGVhZCBwYXNzIGBmYWxzZWAgdG8gZGlzYWJsZSBgb25lV2F5YCwgbWFr
        aW5nIHRoZQogICAgICBiaW5kaW5nIHR3byB3YXkgYWdhaW4uCiAgICBAcmV0
        dXJuIHtFbWJlci5CaW5kaW5nfSBgdGhpc2AKICAqLwogIG9uZVdheTogZnVu
        Y3Rpb24oZnJvbSwgZmxhZykgewogICAgdmFyIEMgPSB0aGlzLCBiaW5kaW5n
        ID0gbmV3IEMobnVsbCwgZnJvbSk7CiAgICByZXR1cm4gYmluZGluZy5vbmVX
        YXkoZmxhZyk7CiAgfQoKfSk7CgovKioKICBBbiBgRW1iZXIuQmluZGluZ2Ag
        Y29ubmVjdHMgdGhlIHByb3BlcnRpZXMgb2YgdHdvIG9iamVjdHMgc28gdGhh
        dCB3aGVuZXZlcgogIHRoZSB2YWx1ZSBvZiBvbmUgcHJvcGVydHkgY2hhbmdl
        cywgdGhlIG90aGVyIHByb3BlcnR5IHdpbGwgYmUgY2hhbmdlZCBhbHNvLgoK
        ICAjIyBBdXRvbWF0aWMgQ3JlYXRpb24gb2YgQmluZGluZ3Mgd2l0aCBgL14q
        QmluZGluZy9gLW5hbWVkIFByb3BlcnRpZXMKCiAgWW91IGRvIG5vdCB1c3Vh
        bGx5IGNyZWF0ZSBCaW5kaW5nIG9iamVjdHMgZGlyZWN0bHkgYnV0IGluc3Rl
        YWQgZGVzY3JpYmUKICBiaW5kaW5ncyBpbiB5b3VyIGNsYXNzIG9yIG9iamVj
        dCBkZWZpbml0aW9uIHVzaW5nIGF1dG9tYXRpYyBiaW5kaW5nCiAgZGV0ZWN0
        aW9uLgoKICBQcm9wZXJ0aWVzIGVuZGluZyBpbiBhIGBCaW5kaW5nYCBzdWZm
        aXggd2lsbCBiZSBjb252ZXJ0ZWQgdG8gYEVtYmVyLkJpbmRpbmdgCiAgaW5z
        dGFuY2VzLiBUaGUgdmFsdWUgb2YgdGhpcyBwcm9wZXJ0eSBzaG91bGQgYmUg
        YSBzdHJpbmcgcmVwcmVzZW50aW5nIGEgcGF0aAogIHRvIGFub3RoZXIgb2Jq
        ZWN0IG9yIGEgY3VzdG9tIGJpbmRpbmcgaW5zdGFuY2VkIGNyZWF0ZWQgdXNp
        bmcgQmluZGluZyBoZWxwZXJzCiAgKHNlZSAiT25lIFdheSBCaW5kaW5ncyIp
        OgoKICBgYGAKICB2YWx1ZUJpbmRpbmc6ICJNeUFwcC5zb21lQ29udHJvbGxl
        ci50aXRsZSIKICBgYGAKCiAgVGhpcyB3aWxsIGNyZWF0ZSBhIGJpbmRpbmcg
        ZnJvbSBgTXlBcHAuc29tZUNvbnRyb2xsZXIudGl0bGVgIHRvIHRoZSBgdmFs
        dWVgCiAgcHJvcGVydHkgb2YgeW91ciBvYmplY3QgaW5zdGFuY2UgYXV0b21h
        dGljYWxseS4gTm93IHRoZSB0d28gdmFsdWVzIHdpbGwgYmUKICBrZXB0IGlu
        IHN5bmMuCgogICMjIE9uZSBXYXkgQmluZGluZ3MKCiAgT25lIGVzcGVjaWFs
        bHkgdXNlZnVsIGJpbmRpbmcgY3VzdG9taXphdGlvbiB5b3UgY2FuIHVzZSBp
        cyB0aGUgYG9uZVdheSgpYAogIGhlbHBlci4gVGhpcyBoZWxwZXIgdGVsbHMg
        RW1iZXIgdGhhdCB5b3UgYXJlIG9ubHkgaW50ZXJlc3RlZCBpbgogIHJlY2Vp
        dmluZyBjaGFuZ2VzIG9uIHRoZSBvYmplY3QgeW91IGFyZSBiaW5kaW5nIGZy
        b20uIEZvciBleGFtcGxlLCBpZiB5b3UKICBhcmUgYmluZGluZyB0byBhIHBy
        ZWZlcmVuY2UgYW5kIHlvdSB3YW50IHRvIGJlIG5vdGlmaWVkIGlmIHRoZSBw
        cmVmZXJlbmNlCiAgaGFzIGNoYW5nZWQsIGJ1dCB5b3VyIG9iamVjdCB3aWxs
        IG5vdCBiZSBjaGFuZ2luZyB0aGUgcHJlZmVyZW5jZSBpdHNlbGYsIHlvdQog
        IGNvdWxkIGRvOgoKICBgYGAKICBiaWdUaXRsZXNCaW5kaW5nOiBFbWJlci5C
        aW5kaW5nLm9uZVdheSgiTXlBcHAucHJlZmVyZW5jZXNDb250cm9sbGVyLmJp
        Z1RpdGxlcyIpCiAgYGBgCgogIFRoaXMgd2F5IGlmIHRoZSB2YWx1ZSBvZiBg
        TXlBcHAucHJlZmVyZW5jZXNDb250cm9sbGVyLmJpZ1RpdGxlc2AgY2hhbmdl
        cyB0aGUKICBgYmlnVGl0bGVzYCBwcm9wZXJ0eSBvZiB5b3VyIG9iamVjdCB3
        aWxsIGNoYW5nZSBhbHNvLiBIb3dldmVyLCBpZiB5b3UKICBjaGFuZ2UgdGhl
        IHZhbHVlIG9mIHlvdXIgYGJpZ1RpdGxlc2AgcHJvcGVydHksIGl0IHdpbGwg
        bm90IHVwZGF0ZSB0aGUKICBgcHJlZmVyZW5jZXNDb250cm9sbGVyYC4KCiAg
        T25lIHdheSBiaW5kaW5ncyBhcmUgYWxtb3N0IHR3aWNlIGFzIGZhc3QgdG8g
        c2V0dXAgYW5kIHR3aWNlIGFzIGZhc3QgdG8KICBleGVjdXRlIGJlY2F1c2Ug
        dGhlIGJpbmRpbmcgb25seSBoYXMgdG8gd29ycnkgYWJvdXQgY2hhbmdlcyB0
        byBvbmUgc2lkZS4KCiAgWW91IHNob3VsZCBjb25zaWRlciB1c2luZyBvbmUg
        d2F5IGJpbmRpbmdzIGFueXRpbWUgeW91IGhhdmUgYW4gb2JqZWN0IHRoYXQK
        ICBtYXkgYmUgY3JlYXRlZCBmcmVxdWVudGx5IGFuZCB5b3UgZG8gbm90IGlu
        dGVuZCB0byBjaGFuZ2UgYSBwcm9wZXJ0eTsgb25seQogIHRvIG1vbml0b3Ig
        aXQgZm9yIGNoYW5nZXMgKHN1Y2ggYXMgaW4gdGhlIGV4YW1wbGUgYWJvdmUp
        LgoKICAjIyBBZGRpbmcgQmluZGluZ3MgTWFudWFsbHkKCiAgQWxsIG9mIHRo
        ZSBleGFtcGxlcyBhYm92ZSBzaG93IHlvdSBob3cgdG8gY29uZmlndXJlIGEg
        Y3VzdG9tIGJpbmRpbmcsIGJ1dCB0aGUKICByZXN1bHQgb2YgdGhlc2UgY3Vz
        dG9taXphdGlvbnMgd2lsbCBiZSBhIGJpbmRpbmcgdGVtcGxhdGUsIG5vdCBh
        IGZ1bGx5IGFjdGl2ZQogIEJpbmRpbmcgaW5zdGFuY2UuIFRoZSBiaW5kaW5n
        IHdpbGwgYWN0dWFsbHkgYmVjb21lIGFjdGl2ZSBvbmx5IHdoZW4geW91CiAg
        aW5zdGFudGlhdGUgdGhlIG9iamVjdCB0aGUgYmluZGluZyBiZWxvbmdzIHRv
        LiBJdCBpcyB1c2VmdWwgaG93ZXZlciwgdG8KICB1bmRlcnN0YW5kIHdoYXQg
        YWN0dWFsbHkgaGFwcGVucyB3aGVuIHRoZSBiaW5kaW5nIGlzIGFjdGl2YXRl
        ZC4KCiAgRm9yIGEgYmluZGluZyB0byBmdW5jdGlvbiBpdCBtdXN0IGhhdmUg
        YXQgbGVhc3QgYSBgZnJvbWAgcHJvcGVydHkgYW5kIGEgYHRvYAogIHByb3Bl
        cnR5LiBUaGUgYGZyb21gIHByb3BlcnR5IHBhdGggcG9pbnRzIHRvIHRoZSBv
        YmplY3Qva2V5IHRoYXQgeW91IHdhbnQgdG8KICBiaW5kIGZyb20gd2hpbGUg
        dGhlIGB0b2AgcGF0aCBwb2ludHMgdG8gdGhlIG9iamVjdC9rZXkgeW91IHdh
        bnQgdG8gYmluZCB0by4KCiAgV2hlbiB5b3UgZGVmaW5lIGEgY3VzdG9tIGJp
        bmRpbmcsIHlvdSBhcmUgdXN1YWxseSBkZXNjcmliaW5nIHRoZSBwcm9wZXJ0
        eQogIHlvdSB3YW50IHRvIGJpbmQgZnJvbSAoc3VjaCBhcyBgTXlBcHAuc29t
        ZUNvbnRyb2xsZXIudmFsdWVgIGluIHRoZSBleGFtcGxlcwogIGFib3ZlKS4g
        V2hlbiB5b3VyIG9iamVjdCBpcyBjcmVhdGVkLCBpdCB3aWxsIGF1dG9tYXRp
        Y2FsbHkgYXNzaWduIHRoZSB2YWx1ZQogIHlvdSB3YW50IHRvIGJpbmQgYHRv
        YCBiYXNlZCBvbiB0aGUgbmFtZSBvZiB5b3VyIGJpbmRpbmcga2V5LiBJbiB0
        aGUKICBleGFtcGxlcyBhYm92ZSwgZHVyaW5nIGluaXQsIEVtYmVyIG9iamVj
        dHMgd2lsbCBlZmZlY3RpdmVseSBjYWxsCiAgc29tZXRoaW5nIGxpa2UgdGhp
        cyBvbiB5b3VyIGJpbmRpbmc6CgogIGBgYGphdmFzY3JpcHQKICBiaW5kaW5n
        ID0gRW1iZXIuQmluZGluZy5mcm9tKHRoaXMudmFsdWVCaW5kaW5nKS50bygi
        dmFsdWUiKTsKICBgYGAKCiAgVGhpcyBjcmVhdGVzIGEgbmV3IGJpbmRpbmcg
        aW5zdGFuY2UgYmFzZWQgb24gdGhlIHRlbXBsYXRlIHlvdSBwcm92aWRlLCBh
        bmQKICBzZXRzIHRoZSB0byBwYXRoIHRvIHRoZSBgdmFsdWVgIHByb3BlcnR5
        IG9mIHRoZSBuZXcgb2JqZWN0LiBOb3cgdGhhdCB0aGUKICBiaW5kaW5nIGlz
        IGZ1bGx5IGNvbmZpZ3VyZWQgd2l0aCBhIGBmcm9tYCBhbmQgYSBgdG9gLCBp
        dCBzaW1wbHkgbmVlZHMgdG8gYmUKICBjb25uZWN0ZWQgdG8gYmVjb21lIGFj
        dGl2ZS4gVGhpcyBpcyBkb25lIHRocm91Z2ggdGhlIGBjb25uZWN0KClgIG1l
        dGhvZDoKCiAgYGBgamF2YXNjcmlwdAogIGJpbmRpbmcuY29ubmVjdCh0aGlz
        KTsKICBgYGAKCiAgTm90ZSB0aGF0IHdoZW4geW91IGNvbm5lY3QgYSBiaW5k
        aW5nIHlvdSBwYXNzIHRoZSBvYmplY3QgeW91IHdhbnQgaXQgdG8gYmUKICBj
        b25uZWN0ZWQgdG8uIFRoaXMgb2JqZWN0IHdpbGwgYmUgdXNlZCBhcyB0aGUg
        cm9vdCBmb3IgYm90aCB0aGUgZnJvbSBhbmQKICB0byBzaWRlIG9mIHRoZSBi
        aW5kaW5nIHdoZW4gaW5zcGVjdGluZyByZWxhdGl2ZSBwYXRocy4gVGhpcyBh
        bGxvd3MgdGhlCiAgYmluZGluZyB0byBiZSBhdXRvbWF0aWNhbGx5IGluaGVy
        aXRlZCBieSBzdWJjbGFzc2VkIG9iamVjdHMgYXMgd2VsbC4KCiAgTm93IHRo
        YXQgdGhlIGJpbmRpbmcgaXMgY29ubmVjdGVkLCBpdCB3aWxsIG9ic2VydmUg
        Ym90aCB0aGUgZnJvbSBhbmQgdG8gc2lkZQogIGFuZCByZWxheSBjaGFuZ2Vz
        LgoKICBJZiB5b3UgZXZlciBuZWVkZWQgdG8gZG8gc28gKHlvdSBhbG1vc3Qg
        bmV2ZXIgd2lsbCwgYnV0IGl0IGlzIHVzZWZ1bCB0bwogIHVuZGVyc3RhbmQg
        dGhpcyBhbnl3YXkpLCB5b3UgY291bGQgbWFudWFsbHkgY3JlYXRlIGFuIGFj
        dGl2ZSBiaW5kaW5nIGJ5CiAgdXNpbmcgdGhlIGBFbWJlci5iaW5kKClgIGhl
        bHBlciBtZXRob2QuIChUaGlzIGlzIHRoZSBzYW1lIG1ldGhvZCB1c2VkIGJ5
        CiAgdG8gc2V0dXAgeW91ciBiaW5kaW5ncyBvbiBvYmplY3RzKToKCiAgYGBg
        amF2YXNjcmlwdAogIEVtYmVyLmJpbmQoTXlBcHAuYW5vdGhlck9iamVjdCwg
        InZhbHVlIiwgIk15QXBwLnNvbWVDb250cm9sbGVyLnZhbHVlIik7CiAgYGBg
        CgogIEJvdGggb2YgdGhlc2UgY29kZSBmcmFnbWVudHMgaGF2ZSB0aGUgc2Ft
        ZSBlZmZlY3QgYXMgZG9pbmcgdGhlIG1vc3QgZnJpZW5kbHkKICBmb3JtIG9m
        IGJpbmRpbmcgY3JlYXRpb24gbGlrZSBzbzoKCiAgYGBgamF2YXNjcmlwdAog
        IE15QXBwLmFub3RoZXJPYmplY3QgPSBFbWJlci5PYmplY3QuY3JlYXRlKHsK
        ICAgIHZhbHVlQmluZGluZzogIk15QXBwLnNvbWVDb250cm9sbGVyLnZhbHVl
        IiwKCiAgICAvLyBPVEhFUiBDT0RFIEZPUiBUSElTIE9CSkVDVC4uLgogIH0p
        OwogIGBgYAoKICBFbWJlcidzIGJ1aWx0IGluIGJpbmRpbmcgY3JlYXRpb24g
        bWV0aG9kIG1ha2VzIGl0IGVhc3kgdG8gYXV0b21hdGljYWxseQogIGNyZWF0
        ZSBiaW5kaW5ncyBmb3IgeW91LiBZb3Ugc2hvdWxkIGFsd2F5cyB1c2UgdGhl
        IGhpZ2hlc3QtbGV2ZWwgQVBJcwogIGF2YWlsYWJsZSwgZXZlbiBpZiB5b3Ug
        dW5kZXJzdGFuZCBob3cgaXQgd29ya3MgdW5kZXJuZWF0aC4KCiAgQGNsYXNz
        IEJpbmRpbmcKICBAbmFtZXNwYWNlIEVtYmVyCiAgQHNpbmNlIEVtYmVyIDAu
        OQoqLwpFbWJlci5CaW5kaW5nID0gQmluZGluZzsKCgovKioKICBHbG9iYWwg
        aGVscGVyIG1ldGhvZCB0byBjcmVhdGUgYSBuZXcgYmluZGluZy4gSnVzdCBw
        YXNzIHRoZSByb290IG9iamVjdAogIGFsb25nIHdpdGggYSBgdG9gIGFuZCBg
        ZnJvbWAgcGF0aCB0byBjcmVhdGUgYW5kIGNvbm5lY3QgdGhlIGJpbmRpbmcu
        CgogIEBtZXRob2QgYmluZAogIEBmb3IgRW1iZXIKICBAcGFyYW0ge09iamVj
        dH0gb2JqIFRoZSByb290IG9iamVjdCBvZiB0aGUgdHJhbnNmb3JtLgogIEBw
        YXJhbSB7U3RyaW5nfSB0byBUaGUgcGF0aCB0byB0aGUgJ3RvJyBzaWRlIG9m
        IHRoZSBiaW5kaW5nLgogICAgTXVzdCBiZSByZWxhdGl2ZSB0byBvYmouCiAg
        QHBhcmFtIHtTdHJpbmd9IGZyb20gVGhlIHBhdGggdG8gdGhlICdmcm9tJyBz
        aWRlIG9mIHRoZSBiaW5kaW5nLgogICAgTXVzdCBiZSByZWxhdGl2ZSB0byBv
        Ymogb3IgYSBnbG9iYWwgcGF0aC4KICBAcmV0dXJuIHtFbWJlci5CaW5kaW5n
        fSBiaW5kaW5nIGluc3RhbmNlCiovCkVtYmVyLmJpbmQgPSBmdW5jdGlvbihv
        YmosIHRvLCBmcm9tKSB7CiAgcmV0dXJuIG5ldyBFbWJlci5CaW5kaW5nKHRv
        LCBmcm9tKS5jb25uZWN0KG9iaik7Cn07CgovKioKICBAbWV0aG9kIG9uZVdh
        eQogIEBmb3IgRW1iZXIKICBAcGFyYW0ge09iamVjdH0gb2JqIFRoZSByb290
        IG9iamVjdCBvZiB0aGUgdHJhbnNmb3JtLgogIEBwYXJhbSB7U3RyaW5nfSB0
        byBUaGUgcGF0aCB0byB0aGUgJ3RvJyBzaWRlIG9mIHRoZSBiaW5kaW5nLgog
        ICAgTXVzdCBiZSByZWxhdGl2ZSB0byBvYmouCiAgQHBhcmFtIHtTdHJpbmd9
        IGZyb20gVGhlIHBhdGggdG8gdGhlICdmcm9tJyBzaWRlIG9mIHRoZSBiaW5k
        aW5nLgogICAgTXVzdCBiZSByZWxhdGl2ZSB0byBvYmogb3IgYSBnbG9iYWwg
        cGF0aC4KICBAcmV0dXJuIHtFbWJlci5CaW5kaW5nfSBiaW5kaW5nIGluc3Rh
        bmNlCiovCkVtYmVyLm9uZVdheSA9IGZ1bmN0aW9uKG9iaiwgdG8sIGZyb20p
        IHsKICByZXR1cm4gbmV3IEVtYmVyLkJpbmRpbmcodG8sIGZyb20pLm9uZVdh
        eSgpLmNvbm5lY3Qob2JqKTsKfTsKCn0pKCk7CgoKCihmdW5jdGlvbigpIHsK
        LyoqCkBtb2R1bGUgZW1iZXIKQHN1Ym1vZHVsZSBlbWJlci1tZXRhbAoqLwoK
        dmFyIE1peGluLCBSRVFVSVJFRCwgQWxpYXMsCiAgICBhX21hcCA9IEVtYmVy
        LkFycmF5UG9seWZpbGxzLm1hcCwKICAgIGFfaW5kZXhPZiA9IEVtYmVyLkFy
        cmF5UG9seWZpbGxzLmluZGV4T2YsCiAgICBhX2ZvckVhY2ggPSBFbWJlci5B
        cnJheVBvbHlmaWxscy5mb3JFYWNoLAogICAgYV9zbGljZSA9IFtdLnNsaWNl
        LAogICAgb19jcmVhdGUgPSBFbWJlci5jcmVhdGUsCiAgICBkZWZpbmVQcm9w
        ZXJ0eSA9IEVtYmVyLmRlZmluZVByb3BlcnR5LAogICAgZ3VpZEZvciA9IEVt
        YmVyLmd1aWRGb3I7CgpmdW5jdGlvbiBtaXhpbnNNZXRhKG9iaikgewogIHZh
        ciBtID0gRW1iZXIubWV0YShvYmosIHRydWUpLCByZXQgPSBtLm1peGluczsK
        ICBpZiAoIXJldCkgewogICAgcmV0ID0gbS5taXhpbnMgPSB7fTsKICB9IGVs
        c2UgaWYgKCFtLmhhc093blByb3BlcnR5KCdtaXhpbnMnKSkgewogICAgcmV0
        ID0gbS5taXhpbnMgPSBvX2NyZWF0ZShyZXQpOwogIH0KICByZXR1cm4gcmV0
        Owp9CgpmdW5jdGlvbiBpbml0TWl4aW4obWl4aW4sIGFyZ3MpIHsKICBpZiAo
        YXJncyAmJiBhcmdzLmxlbmd0aCA+IDApIHsKICAgIG1peGluLm1peGlucyA9
        IGFfbWFwLmNhbGwoYXJncywgZnVuY3Rpb24oeCkgewogICAgICBpZiAoeCBp
        bnN0YW5jZW9mIE1peGluKSB7IHJldHVybiB4OyB9CgogICAgICAvLyBOb3Rl
        OiBNYW51YWxseSBzZXR1cCBhIHByaW1pdGl2ZSBtaXhpbiBoZXJlLiBUaGlz
        IGlzIHRoZSBvbmx5CiAgICAgIC8vIHdheSB0byBhY3R1YWxseSBnZXQgYSBw
        cmltaXRpdmUgbWl4aW4uIFRoaXMgd2F5IG5vcm1hbCBjcmVhdGlvbgogICAg
        ICAvLyBvZiBtaXhpbnMgd2lsbCBnaXZlIHlvdSBjb21iaW5lZCBtaXhpbnMu
        Li4KICAgICAgdmFyIG1peGluID0gbmV3IE1peGluKCk7CiAgICAgIG1peGlu
        LnByb3BlcnRpZXMgPSB4OwogICAgICByZXR1cm4gbWl4aW47CiAgICB9KTsK
        ICB9CiAgcmV0dXJuIG1peGluOwp9CgpmdW5jdGlvbiBpc01ldGhvZChvYmop
        IHsKICByZXR1cm4gJ2Z1bmN0aW9uJyA9PT0gdHlwZW9mIG9iaiAmJgogICAg
        ICAgICBvYmouaXNNZXRob2QgIT09IGZhbHNlICYmCiAgICAgICAgIG9iaiAh
        PT0gQm9vbGVhbiAmJiBvYmogIT09IE9iamVjdCAmJiBvYmogIT09IE51bWJl
        ciAmJiBvYmogIT09IEFycmF5ICYmIG9iaiAhPT0gRGF0ZSAmJiBvYmogIT09
        IFN0cmluZzsKfQoKdmFyIENPTlRJTlVFID0ge307CgpmdW5jdGlvbiBtaXhp
        blByb3BlcnRpZXMobWl4aW5zTWV0YSwgbWl4aW4pIHsKICB2YXIgZ3VpZDsK
        CiAgaWYgKG1peGluIGluc3RhbmNlb2YgTWl4aW4pIHsKICAgIGd1aWQgPSBn
        dWlkRm9yKG1peGluKTsKICAgIGlmIChtaXhpbnNNZXRhW2d1aWRdKSB7IHJl
        dHVybiBDT05USU5VRTsgfQogICAgbWl4aW5zTWV0YVtndWlkXSA9IG1peGlu
        OwogICAgcmV0dXJuIG1peGluLnByb3BlcnRpZXM7CiAgfSBlbHNlIHsKICAg
        IHJldHVybiBtaXhpbjsgLy8gYXBwbHkgYW5vbnltb3VzIG1peGluIHByb3Bl
        cnRpZXMKICB9Cn0KCmZ1bmN0aW9uIGNvbmNhdGVuYXRlZE1peGluUHJvcGVy
        dGllcyhjb25jYXRQcm9wLCBwcm9wcywgdmFsdWVzLCBiYXNlKSB7CiAgdmFy
        IGNvbmNhdHM7CgogIC8vIHJlc2V0IGJlZm9yZSBhZGRpbmcgZWFjaCBuZXcg
        bWl4aW4gdG8gcGlja3VwIGNvbmNhdHMgZnJvbSBwcmV2aW91cwogIGNvbmNh
        dHMgPSB2YWx1ZXNbY29uY2F0UHJvcF0gfHwgYmFzZVtjb25jYXRQcm9wXTsK
        ICBpZiAocHJvcHNbY29uY2F0UHJvcF0pIHsKICAgIGNvbmNhdHMgPSBjb25j
        YXRzID8gY29uY2F0cy5jb25jYXQocHJvcHNbY29uY2F0UHJvcF0pIDogcHJv
        cHNbY29uY2F0UHJvcF07CiAgfQoKICByZXR1cm4gY29uY2F0czsKfQoKZnVu
        Y3Rpb24gZ2l2ZURlc2NyaXB0b3JTdXBlcihtZXRhLCBrZXksIHByb3BlcnR5
        LCB2YWx1ZXMsIGRlc2NzKSB7CiAgdmFyIHN1cGVyUHJvcGVydHk7CgogIC8v
        IENvbXB1dGVkIHByb3BlcnRpZXMgb3ZlcnJpZGUgbWV0aG9kcywgYW5kIGRv
        IG5vdCBjYWxsIHN1cGVyIHRvIHRoZW0KICBpZiAodmFsdWVzW2tleV0gPT09
        IHVuZGVmaW5lZCkgewogICAgLy8gRmluZCB0aGUgb3JpZ2luYWwgZGVzY3Jp
        cHRvciBpbiBhIHBhcmVudCBtaXhpbgogICAgc3VwZXJQcm9wZXJ0eSA9IGRl
        c2NzW2tleV07CiAgfQoKICAvLyBJZiB3ZSBkaWRuJ3QgZmluZCB0aGUgb3Jp
        Z2luYWwgZGVzY3JpcHRvciBpbiBhIHBhcmVudCBtaXhpbiwgZmluZAogIC8v
        IGl0IG9uIHRoZSBvcmlnaW5hbCBvYmplY3QuCiAgc3VwZXJQcm9wZXJ0eSA9
        IHN1cGVyUHJvcGVydHkgfHwgbWV0YS5kZXNjc1trZXldOwoKICBpZiAoIXN1
        cGVyUHJvcGVydHkgfHwgIShzdXBlclByb3BlcnR5IGluc3RhbmNlb2YgRW1i
        ZXIuQ29tcHV0ZWRQcm9wZXJ0eSkpIHsKICAgIHJldHVybiBwcm9wZXJ0eTsK
        ICB9CgogIC8vIFNpbmNlIG11bHRpcGxlIG1peGlucyBtYXkgaW5oZXJpdCBm
        cm9tIHRoZSBzYW1lIHBhcmVudCwgd2UgbmVlZAogIC8vIHRvIGNsb25lIHRo
        ZSBjb21wdXRlZCBwcm9wZXJ0eSBzbyB0aGF0IG90aGVyIG1peGlucyBkbyBu
        b3QgcmVjZWl2ZQogIC8vIHRoZSB3cmFwcGVkIHZlcnNpb24uCiAgcHJvcGVy
        dHkgPSBvX2NyZWF0ZShwcm9wZXJ0eSk7CiAgcHJvcGVydHkuZnVuYyA9IEVt
        YmVyLndyYXAocHJvcGVydHkuZnVuYywgc3VwZXJQcm9wZXJ0eS5mdW5jKTsK
        CiAgcmV0dXJuIHByb3BlcnR5Owp9CgpmdW5jdGlvbiBnaXZlTWV0aG9kU3Vw
        ZXIob2JqLCBrZXksIG1ldGhvZCwgdmFsdWVzLCBkZXNjcykgewogIHZhciBz
        dXBlck1ldGhvZDsKCiAgLy8gTWV0aG9kcyBvdmVyd3JpdGUgY29tcHV0ZWQg
        cHJvcGVydGllcywgYW5kIGRvIG5vdCBjYWxsIHN1cGVyIHRvIHRoZW0uCiAg
        aWYgKGRlc2NzW2tleV0gPT09IHVuZGVmaW5lZCkgewogICAgLy8gRmluZCB0
        aGUgb3JpZ2luYWwgbWV0aG9kIGluIGEgcGFyZW50IG1peGluCiAgICBzdXBl
        ck1ldGhvZCA9IHZhbHVlc1trZXldOwogIH0KCiAgLy8gSWYgd2UgZGlkbid0
        IGZpbmQgdGhlIG9yaWdpbmFsIHZhbHVlIGluIGEgcGFyZW50IG1peGluLCBm
        aW5kIGl0IGluCiAgLy8gdGhlIG9yaWdpbmFsIG9iamVjdAogIHN1cGVyTWV0
        aG9kID0gc3VwZXJNZXRob2QgfHwgb2JqW2tleV07CgogIC8vIE9ubHkgd3Jh
        cCB0aGUgbmV3IG1ldGhvZCBpZiB0aGUgb3JpZ2luYWwgbWV0aG9kIHdhcyBh
        IGZ1bmN0aW9uCiAgaWYgKCdmdW5jdGlvbicgIT09IHR5cGVvZiBzdXBlck1l
        dGhvZCkgewogICAgcmV0dXJuIG1ldGhvZDsKICB9CgogIHJldHVybiBFbWJl
        ci53cmFwKG1ldGhvZCwgc3VwZXJNZXRob2QpOwp9CgpmdW5jdGlvbiBhcHBs
        eUNvbmNhdGVuYXRlZFByb3BlcnRpZXMob2JqLCBrZXksIHZhbHVlLCB2YWx1
        ZXMpIHsKICB2YXIgYmFzZVZhbHVlID0gdmFsdWVzW2tleV0gfHwgb2JqW2tl
        eV07CgogIGlmIChiYXNlVmFsdWUpIHsKICAgIGlmICgnZnVuY3Rpb24nID09
        PSB0eXBlb2YgYmFzZVZhbHVlLmNvbmNhdCkgewogICAgICByZXR1cm4gYmFz
        ZVZhbHVlLmNvbmNhdCh2YWx1ZSk7CiAgICB9IGVsc2UgewogICAgICByZXR1
        cm4gRW1iZXIubWFrZUFycmF5KGJhc2VWYWx1ZSkuY29uY2F0KHZhbHVlKTsK
        ICAgIH0KICB9IGVsc2UgewogICAgcmV0dXJuIEVtYmVyLm1ha2VBcnJheSh2
        YWx1ZSk7CiAgfQp9CgpmdW5jdGlvbiBhcHBseU1lcmdlZFByb3BlcnRpZXMo
        b2JqLCBrZXksIHZhbHVlLCB2YWx1ZXMpIHsKICB2YXIgYmFzZVZhbHVlID0g
        dmFsdWVzW2tleV0gfHwgb2JqW2tleV07CgogIGlmICghYmFzZVZhbHVlKSB7
        IHJldHVybiB2YWx1ZTsgfQoKICB2YXIgbmV3QmFzZSA9IEVtYmVyLm1lcmdl
        KHt9LCBiYXNlVmFsdWUpOwogIGZvciAodmFyIHByb3AgaW4gdmFsdWUpIHsK
        ICAgIGlmICghdmFsdWUuaGFzT3duUHJvcGVydHkocHJvcCkpIHsgY29udGlu
        dWU7IH0KCiAgICB2YXIgcHJvcFZhbHVlID0gdmFsdWVbcHJvcF07CiAgICBp
        ZiAoaXNNZXRob2QocHJvcFZhbHVlKSkgewogICAgICAvLyBUT0RPOiBzdXBw
        b3J0IGZvciBDb21wdXRlZCBQcm9wZXJ0aWVzLCBldGM/CiAgICAgIG5ld0Jh
        c2VbcHJvcF0gPSBnaXZlTWV0aG9kU3VwZXIob2JqLCBwcm9wLCBwcm9wVmFs
        dWUsIGJhc2VWYWx1ZSwge30pOwogICAgfSBlbHNlIHsKICAgICAgbmV3QmFz
        ZVtwcm9wXSA9IHByb3BWYWx1ZTsKICAgIH0KICB9CgogIHJldHVybiBuZXdC
        YXNlOwp9CgpmdW5jdGlvbiBhZGROb3JtYWxpemVkUHJvcGVydHkoYmFzZSwg
        a2V5LCB2YWx1ZSwgbWV0YSwgZGVzY3MsIHZhbHVlcywgY29uY2F0cywgbWVy
        Z2luZ3MpIHsKICBpZiAodmFsdWUgaW5zdGFuY2VvZiBFbWJlci5EZXNjcmlw
        dG9yKSB7CiAgICBpZiAodmFsdWUgPT09IFJFUVVJUkVEICYmIGRlc2NzW2tl
        eV0pIHsgcmV0dXJuIENPTlRJTlVFOyB9CgogICAgLy8gV3JhcCBkZXNjcmlw
        dG9yIGZ1bmN0aW9uIHRvIGltcGxlbWVudAogICAgLy8gX3N1cGVyKCkgaWYg
        bmVlZGVkCiAgICBpZiAodmFsdWUuZnVuYykgewogICAgICB2YWx1ZSA9IGdp
        dmVEZXNjcmlwdG9yU3VwZXIobWV0YSwga2V5LCB2YWx1ZSwgdmFsdWVzLCBk
        ZXNjcyk7CiAgICB9CgogICAgZGVzY3Nba2V5XSAgPSB2YWx1ZTsKICAgIHZh
        bHVlc1trZXldID0gdW5kZWZpbmVkOwogIH0gZWxzZSB7CiAgICBpZiAoKGNv
        bmNhdHMgJiYgYV9pbmRleE9mLmNhbGwoY29uY2F0cywga2V5KSA+PSAwKSB8
        fAogICAgICAgICAgICAgICAga2V5ID09PSAnY29uY2F0ZW5hdGVkUHJvcGVy
        dGllcycgfHwKICAgICAgICAgICAgICAgIGtleSA9PT0gJ21lcmdlZFByb3Bl
        cnRpZXMnKSB7CiAgICAgIHZhbHVlID0gYXBwbHlDb25jYXRlbmF0ZWRQcm9w
        ZXJ0aWVzKGJhc2UsIGtleSwgdmFsdWUsIHZhbHVlcyk7CiAgICB9IGVsc2Ug
        aWYgKChtZXJnaW5ncyAmJiBhX2luZGV4T2YuY2FsbChtZXJnaW5ncywga2V5
        KSA+PSAwKSkgewogICAgICB2YWx1ZSA9IGFwcGx5TWVyZ2VkUHJvcGVydGll
        cyhiYXNlLCBrZXksIHZhbHVlLCB2YWx1ZXMpOwogICAgfSBlbHNlIGlmIChp
        c01ldGhvZCh2YWx1ZSkpIHsKICAgICAgdmFsdWUgPSBnaXZlTWV0aG9kU3Vw
        ZXIoYmFzZSwga2V5LCB2YWx1ZSwgdmFsdWVzLCBkZXNjcyk7CiAgICB9Cgog
        ICAgZGVzY3Nba2V5XSA9IHVuZGVmaW5lZDsKICAgIHZhbHVlc1trZXldID0g
        dmFsdWU7CiAgfQp9CgpmdW5jdGlvbiBtZXJnZU1peGlucyhtaXhpbnMsIG0s
        IGRlc2NzLCB2YWx1ZXMsIGJhc2UsIGtleXMpIHsKICB2YXIgbWl4aW4sIHBy
        b3BzLCBrZXksIGNvbmNhdHMsIG1lcmdpbmdzLCBtZXRhOwoKICBmdW5jdGlv
        biByZW1vdmVLZXlzKGtleU5hbWUpIHsKICAgIGRlbGV0ZSBkZXNjc1trZXlO
        YW1lXTsKICAgIGRlbGV0ZSB2YWx1ZXNba2V5TmFtZV07CiAgfQoKICBmb3Io
        dmFyIGk9MCwgbD1taXhpbnMubGVuZ3RoOyBpPGw7IGkrKykgewogICAgbWl4
        aW4gPSBtaXhpbnNbaV07CiAgICBFbWJlci5hc3NlcnQoJ0V4cGVjdGVkIGhh
        c2ggb3IgTWl4aW4gaW5zdGFuY2UsIGdvdCAnICsgT2JqZWN0LnByb3RvdHlw
        ZS50b1N0cmluZy5jYWxsKG1peGluKSwgdHlwZW9mIG1peGluID09PSAnb2Jq
        ZWN0JyAmJiBtaXhpbiAhPT0gbnVsbCAmJiBPYmplY3QucHJvdG90eXBlLnRv
        U3RyaW5nLmNhbGwobWl4aW4pICE9PSAnW29iamVjdCBBcnJheV0nKTsKCiAg
        ICBwcm9wcyA9IG1peGluUHJvcGVydGllcyhtLCBtaXhpbik7CiAgICBpZiAo
        cHJvcHMgPT09IENPTlRJTlVFKSB7IGNvbnRpbnVlOyB9CgogICAgaWYgKHBy
        b3BzKSB7CiAgICAgIG1ldGEgPSBFbWJlci5tZXRhKGJhc2UpOwogICAgICBp
        ZiAoYmFzZS53aWxsTWVyZ2VNaXhpbikgeyBiYXNlLndpbGxNZXJnZU1peGlu
        KHByb3BzKTsgfQogICAgICBjb25jYXRzID0gY29uY2F0ZW5hdGVkTWl4aW5Q
        cm9wZXJ0aWVzKCdjb25jYXRlbmF0ZWRQcm9wZXJ0aWVzJywgcHJvcHMsIHZh
        bHVlcywgYmFzZSk7CiAgICAgIG1lcmdpbmdzID0gY29uY2F0ZW5hdGVkTWl4
        aW5Qcm9wZXJ0aWVzKCdtZXJnZWRQcm9wZXJ0aWVzJywgcHJvcHMsIHZhbHVl
        cywgYmFzZSk7CgogICAgICBmb3IgKGtleSBpbiBwcm9wcykgewogICAgICAg
        IGlmICghcHJvcHMuaGFzT3duUHJvcGVydHkoa2V5KSkgeyBjb250aW51ZTsg
        fQogICAgICAgIGtleXMucHVzaChrZXkpOwogICAgICAgIGFkZE5vcm1hbGl6
        ZWRQcm9wZXJ0eShiYXNlLCBrZXksIHByb3BzW2tleV0sIG1ldGEsIGRlc2Nz
        LCB2YWx1ZXMsIGNvbmNhdHMsIG1lcmdpbmdzKTsKICAgICAgfQoKICAgICAg
        Ly8gbWFudWFsbHkgY29weSB0b1N0cmluZygpIGJlY2F1c2Ugc29tZSBKUyBl
        bmdpbmVzIGRvIG5vdCBlbnVtZXJhdGUgaXQKICAgICAgaWYgKHByb3BzLmhh
        c093blByb3BlcnR5KCd0b1N0cmluZycpKSB7IGJhc2UudG9TdHJpbmcgPSBw
        cm9wcy50b1N0cmluZzsgfQogICAgfSBlbHNlIGlmIChtaXhpbi5taXhpbnMp
        IHsKICAgICAgbWVyZ2VNaXhpbnMobWl4aW4ubWl4aW5zLCBtLCBkZXNjcywg
        dmFsdWVzLCBiYXNlLCBrZXlzKTsKICAgICAgaWYgKG1peGluLl93aXRob3V0
        KSB7IGFfZm9yRWFjaC5jYWxsKG1peGluLl93aXRob3V0LCByZW1vdmVLZXlz
        KTsgfQogICAgfQogIH0KfQoKdmFyIElTX0JJTkRJTkcgPSBFbWJlci5JU19C
        SU5ESU5HID0gL14uK0JpbmRpbmckLzsKCmZ1bmN0aW9uIGRldGVjdEJpbmRp
        bmcob2JqLCBrZXksIHZhbHVlLCBtKSB7CiAgaWYgKElTX0JJTkRJTkcudGVz
        dChrZXkpKSB7CiAgICB2YXIgYmluZGluZ3MgPSBtLmJpbmRpbmdzOwogICAg
        aWYgKCFiaW5kaW5ncykgewogICAgICBiaW5kaW5ncyA9IG0uYmluZGluZ3Mg
        PSB7fTsKICAgIH0gZWxzZSBpZiAoIW0uaGFzT3duUHJvcGVydHkoJ2JpbmRp
        bmdzJykpIHsKICAgICAgYmluZGluZ3MgPSBtLmJpbmRpbmdzID0gb19jcmVh
        dGUobS5iaW5kaW5ncyk7CiAgICB9CiAgICBiaW5kaW5nc1trZXldID0gdmFs
        dWU7CiAgfQp9CgpmdW5jdGlvbiBjb25uZWN0QmluZGluZ3Mob2JqLCBtKSB7
        CiAgLy8gVE9ETyBNaXhpbi5hcHBseShpbnN0YW5jZSkgc2hvdWxkIGRpc2Nv
        bm5lY3QgYmluZGluZyBpZiBleGlzdHMKICB2YXIgYmluZGluZ3MgPSBtLmJp
        bmRpbmdzLCBrZXksIGJpbmRpbmcsIHRvOwogIGlmIChiaW5kaW5ncykgewog
        ICAgZm9yIChrZXkgaW4gYmluZGluZ3MpIHsKICAgICAgYmluZGluZyA9IGJp
        bmRpbmdzW2tleV07CiAgICAgIGlmIChiaW5kaW5nKSB7CiAgICAgICAgdG8g
        PSBrZXkuc2xpY2UoMCwgLTcpOyAvLyBzdHJpcCBCaW5kaW5nIG9mZiBlbmQK
        ICAgICAgICBpZiAoYmluZGluZyBpbnN0YW5jZW9mIEVtYmVyLkJpbmRpbmcp
        IHsKICAgICAgICAgIGJpbmRpbmcgPSBiaW5kaW5nLmNvcHkoKTsgLy8gY29w
        eSBwcm90b3R5cGVzJyBpbnN0YW5jZQogICAgICAgICAgYmluZGluZy50byh0
        byk7CiAgICAgICAgfSBlbHNlIHsgLy8gYmluZGluZyBpcyBzdHJpbmcgcGF0
        aAogICAgICAgICAgYmluZGluZyA9IG5ldyBFbWJlci5CaW5kaW5nKHRvLCBi
        aW5kaW5nKTsKICAgICAgICB9CiAgICAgICAgYmluZGluZy5jb25uZWN0KG9i
        aik7CiAgICAgICAgb2JqW2tleV0gPSBiaW5kaW5nOwogICAgICB9CiAgICB9
        CiAgICAvLyBtYXJrIGFzIGFwcGxpZWQKICAgIG0uYmluZGluZ3MgPSB7fTsK
        ICB9Cn0KCmZ1bmN0aW9uIGZpbmlzaFBhcnRpYWwob2JqLCBtKSB7CiAgY29u
        bmVjdEJpbmRpbmdzKG9iaiwgbSB8fCBFbWJlci5tZXRhKG9iaikpOwogIHJl
        dHVybiBvYmo7Cn0KCmZ1bmN0aW9uIGZvbGxvd0FsaWFzKG9iaiwgZGVzYywg
        bSwgZGVzY3MsIHZhbHVlcykgewogIHZhciBhbHRLZXkgPSBkZXNjLm1ldGhv
        ZE5hbWUsIHZhbHVlOwogIGlmIChkZXNjc1thbHRLZXldIHx8IHZhbHVlc1th
        bHRLZXldKSB7CiAgICB2YWx1ZSA9IHZhbHVlc1thbHRLZXldOwogICAgZGVz
        YyAgPSBkZXNjc1thbHRLZXldOwogIH0gZWxzZSBpZiAobS5kZXNjc1thbHRL
        ZXldKSB7CiAgICBkZXNjICA9IG0uZGVzY3NbYWx0S2V5XTsKICAgIHZhbHVl
        ID0gdW5kZWZpbmVkOwogIH0gZWxzZSB7CiAgICBkZXNjID0gdW5kZWZpbmVk
        OwogICAgdmFsdWUgPSBvYmpbYWx0S2V5XTsKICB9CgogIHJldHVybiB7IGRl
        c2M6IGRlc2MsIHZhbHVlOiB2YWx1ZSB9Owp9CgpmdW5jdGlvbiB1cGRhdGVP
        YnNlcnZlcnNBbmRMaXN0ZW5lcnMob2JqLCBrZXksIG9ic2VydmVyT3JMaXN0
        ZW5lciwgcGF0aHNLZXksIHVwZGF0ZU1ldGhvZCkgewogIHZhciBwYXRocyA9
        IG9ic2VydmVyT3JMaXN0ZW5lcltwYXRoc0tleV07CgogIGlmIChwYXRocykg
        ewogICAgZm9yICh2YXIgaT0wLCBsPXBhdGhzLmxlbmd0aDsgaTxsOyBpKysp
        IHsKICAgICAgRW1iZXJbdXBkYXRlTWV0aG9kXShvYmosIHBhdGhzW2ldLCBu
        dWxsLCBrZXkpOwogICAgfQogIH0KfQoKZnVuY3Rpb24gcmVwbGFjZU9ic2Vy
        dmVyc0FuZExpc3RlbmVycyhvYmosIGtleSwgb2JzZXJ2ZXJPckxpc3RlbmVy
        KSB7CiAgdmFyIHByZXYgPSBvYmpba2V5XTsKCiAgaWYgKCdmdW5jdGlvbicg
        PT09IHR5cGVvZiBwcmV2KSB7CiAgICB1cGRhdGVPYnNlcnZlcnNBbmRMaXN0
        ZW5lcnMob2JqLCBrZXksIHByZXYsICdfX2VtYmVyX29ic2VydmVzQmVmb3Jl
        X18nLCAncmVtb3ZlQmVmb3JlT2JzZXJ2ZXInKTsKICAgIHVwZGF0ZU9ic2Vy
        dmVyc0FuZExpc3RlbmVycyhvYmosIGtleSwgcHJldiwgJ19fZW1iZXJfb2Jz
        ZXJ2ZXNfXycsICdyZW1vdmVPYnNlcnZlcicpOwogICAgdXBkYXRlT2JzZXJ2
        ZXJzQW5kTGlzdGVuZXJzKG9iaiwga2V5LCBwcmV2LCAnX19lbWJlcl9saXN0
        ZW5zX18nLCAncmVtb3ZlTGlzdGVuZXInKTsKICB9CgogIGlmICgnZnVuY3Rp
        b24nID09PSB0eXBlb2Ygb2JzZXJ2ZXJPckxpc3RlbmVyKSB7CiAgICB1cGRh
        dGVPYnNlcnZlcnNBbmRMaXN0ZW5lcnMob2JqLCBrZXksIG9ic2VydmVyT3JM
        aXN0ZW5lciwgJ19fZW1iZXJfb2JzZXJ2ZXNCZWZvcmVfXycsICdhZGRCZWZv
        cmVPYnNlcnZlcicpOwogICAgdXBkYXRlT2JzZXJ2ZXJzQW5kTGlzdGVuZXJz
        KG9iaiwga2V5LCBvYnNlcnZlck9yTGlzdGVuZXIsICdfX2VtYmVyX29ic2Vy
        dmVzX18nLCAnYWRkT2JzZXJ2ZXInKTsKICAgIHVwZGF0ZU9ic2VydmVyc0Fu
        ZExpc3RlbmVycyhvYmosIGtleSwgb2JzZXJ2ZXJPckxpc3RlbmVyLCAnX19l
        bWJlcl9saXN0ZW5zX18nLCAnYWRkTGlzdGVuZXInKTsKICB9Cn0KCmZ1bmN0
        aW9uIGFwcGx5TWl4aW4ob2JqLCBtaXhpbnMsIHBhcnRpYWwpIHsKICB2YXIg
        ZGVzY3MgPSB7fSwgdmFsdWVzID0ge30sIG0gPSBFbWJlci5tZXRhKG9iaiks
        CiAgICAgIGtleSwgdmFsdWUsIGRlc2MsIGtleXMgPSBbXTsKCiAgLy8gR28g
        dGhyb3VnaCBhbGwgbWl4aW5zIGFuZCBoYXNoZXMgcGFzc2VkIGluLCBhbmQ6
        CiAgLy8KICAvLyAqIEhhbmRsZSBjb25jYXRlbmF0ZWQgcHJvcGVydGllcwog
        IC8vICogSGFuZGxlIG1lcmdlZCBwcm9wZXJ0aWVzCiAgLy8gKiBTZXQgdXAg
        X3N1cGVyIHdyYXBwaW5nIGlmIG5lY2Vzc2FyeQogIC8vICogU2V0IHVwIGNv
        bXB1dGVkIHByb3BlcnR5IGRlc2NyaXB0b3JzCiAgLy8gKiBDb3B5aW5nIGB0
        b1N0cmluZ2AgaW4gYnJva2VuIGJyb3dzZXJzCiAgbWVyZ2VNaXhpbnMobWl4
        aW5zLCBtaXhpbnNNZXRhKG9iaiksIGRlc2NzLCB2YWx1ZXMsIG9iaiwga2V5
        cyk7CgogIGZvcih2YXIgaSA9IDAsIGwgPSBrZXlzLmxlbmd0aDsgaSA8IGw7
        IGkrKykgewogICAga2V5ID0ga2V5c1tpXTsKICAgIGlmIChrZXkgPT09ICdj
        b25zdHJ1Y3RvcicgfHwgIXZhbHVlcy5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7
        IGNvbnRpbnVlOyB9CgogICAgZGVzYyA9IGRlc2NzW2tleV07CiAgICB2YWx1
        ZSA9IHZhbHVlc1trZXldOwoKICAgIGlmIChkZXNjID09PSBSRVFVSVJFRCkg
        eyBjb250aW51ZTsgfQoKICAgIHdoaWxlIChkZXNjICYmIGRlc2MgaW5zdGFu
        Y2VvZiBBbGlhcykgewogICAgICB2YXIgZm9sbG93ZWQgPSBmb2xsb3dBbGlh
        cyhvYmosIGRlc2MsIG0sIGRlc2NzLCB2YWx1ZXMpOwogICAgICBkZXNjID0g
        Zm9sbG93ZWQuZGVzYzsKICAgICAgdmFsdWUgPSBmb2xsb3dlZC52YWx1ZTsK
        ICAgIH0KCiAgICBpZiAoZGVzYyA9PT0gdW5kZWZpbmVkICYmIHZhbHVlID09
        PSB1bmRlZmluZWQpIHsgY29udGludWU7IH0KCiAgICByZXBsYWNlT2JzZXJ2
        ZXJzQW5kTGlzdGVuZXJzKG9iaiwga2V5LCB2YWx1ZSk7CiAgICBkZXRlY3RC
        aW5kaW5nKG9iaiwga2V5LCB2YWx1ZSwgbSk7CiAgICBkZWZpbmVQcm9wZXJ0
        eShvYmosIGtleSwgZGVzYywgdmFsdWUsIG0pOwogIH0KCiAgaWYgKCFwYXJ0
        aWFsKSB7IC8vIGRvbid0IGFwcGx5IHRvIHByb3RvdHlwZQogICAgZmluaXNo
        UGFydGlhbChvYmosIG0pOwogIH0KCiAgcmV0dXJuIG9iajsKfQoKLyoqCiAg
        QG1ldGhvZCBtaXhpbgogIEBmb3IgRW1iZXIKICBAcGFyYW0gb2JqCiAgQHBh
        cmFtIG1peGlucyoKICBAcmV0dXJuIG9iagoqLwpFbWJlci5taXhpbiA9IGZ1
        bmN0aW9uKG9iaikgewogIHZhciBhcmdzID0gYV9zbGljZS5jYWxsKGFyZ3Vt
        ZW50cywgMSk7CiAgYXBwbHlNaXhpbihvYmosIGFyZ3MsIGZhbHNlKTsKICBy
        ZXR1cm4gb2JqOwp9OwoKLyoqCiAgVGhlIGBFbWJlci5NaXhpbmAgY2xhc3Mg
        YWxsb3dzIHlvdSB0byBjcmVhdGUgbWl4aW5zLCB3aG9zZSBwcm9wZXJ0aWVz
        IGNhbiBiZQogIGFkZGVkIHRvIG90aGVyIGNsYXNzZXMuIEZvciBpbnN0YW5j
        ZSwKCiAgYGBgamF2YXNjcmlwdAogIEFwcC5FZGl0YWJsZSA9IEVtYmVyLk1p
        eGluLmNyZWF0ZSh7CiAgICBlZGl0OiBmdW5jdGlvbigpIHsKICAgICAgY29u
        c29sZS5sb2coJ3N0YXJ0aW5nIHRvIGVkaXQnKTsKICAgICAgdGhpcy5zZXQo
        J2lzRWRpdGluZycsIHRydWUpOwogICAgfSwKICAgIGlzRWRpdGluZzogZmFs
        c2UKICB9KTsKCiAgLy8gTWl4IG1peGlucyBpbnRvIGNsYXNzZXMgYnkgcGFz
        c2luZyB0aGVtIGFzIHRoZSBmaXJzdCBhcmd1bWVudHMgdG8KICAvLyAuZXh0
        ZW5kLgogIEFwcC5Db21tZW50VmlldyA9IEVtYmVyLlZpZXcuZXh0ZW5kKEFw
        cC5FZGl0YWJsZSwgewogICAgdGVtcGxhdGU6IEVtYmVyLkhhbmRsZWJhcnMu
        Y29tcGlsZSgne3sjaWYgdmlldy5pc0VkaXRpbmd9fS4uLnt7ZWxzZX19Li4u
        e3svaWZ9fScpCiAgfSk7CgogIGNvbW1lbnRWaWV3ID0gQXBwLkNvbW1lbnRW
        aWV3LmNyZWF0ZSgpOwogIGNvbW1lbnRWaWV3LmVkaXQoKTsgLy8gb3V0cHV0
        cyAnc3RhcnRpbmcgdG8gZWRpdCcKICBgYGAKCiAgTm90ZSB0aGF0IE1peGlu
        cyBhcmUgY3JlYXRlZCB3aXRoIGBFbWJlci5NaXhpbi5jcmVhdGVgLCBub3QK
        ICBgRW1iZXIuTWl4aW4uZXh0ZW5kYC4KCiAgTm90ZSB0aGF0IG1peGlucyBl
        eHRlbmQgYSBjb25zdHJ1Y3RvcidzIHByb3RvdHlwZSBzbyBhcnJheXMgYW5k
        IG9iamVjdCBsaXRlcmFscwogIGRlZmluZWQgYXMgcHJvcGVydGllcyB3aWxs
        IGJlIHNoYXJlZCBhbW9uZ3N0IG9iamVjdHMgdGhhdCBpbXBsZW1lbnQgdGhl
        IG1peGluLgogIElmIHlvdSB3YW50IHRvIGRlZmluZSBhbiBwcm9wZXJ0eSBp
        biBhIG1peGluIHRoYXQgaXMgbm90IHNoYXJlZCwgeW91IGNhbiBkZWZpbmUK
        ICBpdCBlaXRoZXIgYXMgYSBjb21wdXRlZCBwcm9wZXJ0eSBvciBoYXZlIGl0
        IGJlIGNyZWF0ZWQgb24gaW5pdGlhbGl6YXRpb24gb2YgdGhlIG9iamVjdC4K
        CiAgYGBgamF2YXNjcmlwdAogIC8vZmlsdGVycyBhcnJheSB3aWxsIGJlIHNo
        YXJlZCBhbW9uZ3N0IGFueSBvYmplY3QgaW1wbGVtZW50aW5nIG1peGluCiAg
        QXBwLkZpbHRlcmFibGUgPSBFbWJlci5NaXhpbi5jcmVhdGUoewogICAgZmls
        dGVyczogRW1iZXIuQSgpCiAgfSk7CgogIC8vZmlsdGVycyB3aWxsIGJlIGEg
        c2VwYXJhdGUgIGFycmF5IGZvciBldmVyeSBvYmplY3QgaW1wbGVtZW50aW5n
        IHRoZSBtaXhpbgogIEFwcC5GaWx0ZXJhYmxlID0gRW1iZXIuTWl4aW4uY3Jl
        YXRlKHsKICAgIGZpbHRlcnM6IEVtYmVyLmNvbXB1dGVkKGZ1bmN0aW9uKCl7
        cmV0dXJuIEVtYmVyLkEoKTt9KQogIH0pOwoKICAvL2ZpbHRlcnMgd2lsbCBi
        ZSBjcmVhdGVkIGFzIGEgc2VwYXJhdGUgYXJyYXkgZHVyaW5nIHRoZSBvYmpl
        Y3QncyBpbml0aWFsaXphdGlvbgogIEFwcC5GaWx0ZXJhYmxlID0gRW1iZXIu
        TWl4aW4uY3JlYXRlKHsKICAgIGluaXQ6IGZ1bmN0aW9uKCkgewogICAgICB0
        aGlzLl9zdXBlcigpOwogICAgICB0aGlzLnNldCgiZmlsdGVycyIsIEVtYmVy
        LkEoKSk7CiAgICB9CiAgfSk7CiAgYGBgCgogIEBjbGFzcyBNaXhpbgogIEBu
        YW1lc3BhY2UgRW1iZXIKKi8KRW1iZXIuTWl4aW4gPSBmdW5jdGlvbigpIHsg
        cmV0dXJuIGluaXRNaXhpbih0aGlzLCBhcmd1bWVudHMpOyB9OwoKTWl4aW4g
        PSBFbWJlci5NaXhpbjsKCk1peGluLnByb3RvdHlwZSA9IHsKICBwcm9wZXJ0
        aWVzOiBudWxsLAogIG1peGluczogbnVsbCwKICBvd25lckNvbnN0cnVjdG9y
        OiBudWxsCn07CgpNaXhpbi5fYXBwbHkgPSBhcHBseU1peGluOwoKTWl4aW4u
        YXBwbHlQYXJ0aWFsID0gZnVuY3Rpb24ob2JqKSB7CiAgdmFyIGFyZ3MgPSBh
        X3NsaWNlLmNhbGwoYXJndW1lbnRzLCAxKTsKICByZXR1cm4gYXBwbHlNaXhp
        bihvYmosIGFyZ3MsIHRydWUpOwp9OwoKTWl4aW4uZmluaXNoUGFydGlhbCA9
        IGZpbmlzaFBhcnRpYWw7CgpFbWJlci5hbnlVbnByb2Nlc3NlZE1peGlucyA9
        IGZhbHNlOwoKLyoqCiAgQG1ldGhvZCBjcmVhdGUKICBAc3RhdGljCiAgQHBh
        cmFtIGFyZ3VtZW50cyoKKi8KTWl4aW4uY3JlYXRlID0gZnVuY3Rpb24oKSB7
        CiAgRW1iZXIuYW55VW5wcm9jZXNzZWRNaXhpbnMgPSB0cnVlOwogIHZhciBN
        ID0gdGhpczsKICByZXR1cm4gaW5pdE1peGluKG5ldyBNKCksIGFyZ3VtZW50
        cyk7Cn07Cgp2YXIgTWl4aW5Qcm90b3R5cGUgPSBNaXhpbi5wcm90b3R5cGU7
        CgovKioKICBAbWV0aG9kIHJlb3BlbgogIEBwYXJhbSBhcmd1bWVudHMqCiov
        Ck1peGluUHJvdG90eXBlLnJlb3BlbiA9IGZ1bmN0aW9uKCkgewogIHZhciBt
        aXhpbiwgdG1wOwoKICBpZiAodGhpcy5wcm9wZXJ0aWVzKSB7CiAgICBtaXhp
        biA9IE1peGluLmNyZWF0ZSgpOwogICAgbWl4aW4ucHJvcGVydGllcyA9IHRo
        aXMucHJvcGVydGllczsKICAgIGRlbGV0ZSB0aGlzLnByb3BlcnRpZXM7CiAg
        ICB0aGlzLm1peGlucyA9IFttaXhpbl07CiAgfSBlbHNlIGlmICghdGhpcy5t
        aXhpbnMpIHsKICAgIHRoaXMubWl4aW5zID0gW107CiAgfQoKICB2YXIgbGVu
        ID0gYXJndW1lbnRzLmxlbmd0aCwgbWl4aW5zID0gdGhpcy5taXhpbnMsIGlk
        eDsKCiAgZm9yKGlkeD0wOyBpZHggPCBsZW47IGlkeCsrKSB7CiAgICBtaXhp
        biA9IGFyZ3VtZW50c1tpZHhdOwogICAgRW1iZXIuYXNzZXJ0KCdFeHBlY3Rl
        ZCBoYXNoIG9yIE1peGluIGluc3RhbmNlLCBnb3QgJyArIE9iamVjdC5wcm90
        b3R5cGUudG9TdHJpbmcuY2FsbChtaXhpbiksIHR5cGVvZiBtaXhpbiA9PT0g
        J29iamVjdCcgJiYgbWl4aW4gIT09IG51bGwgJiYgT2JqZWN0LnByb3RvdHlw
        ZS50b1N0cmluZy5jYWxsKG1peGluKSAhPT0gJ1tvYmplY3QgQXJyYXldJyk7
        CgogICAgaWYgKG1peGluIGluc3RhbmNlb2YgTWl4aW4pIHsKICAgICAgbWl4
        aW5zLnB1c2gobWl4aW4pOwogICAgfSBlbHNlIHsKICAgICAgdG1wID0gTWl4
        aW4uY3JlYXRlKCk7CiAgICAgIHRtcC5wcm9wZXJ0aWVzID0gbWl4aW47CiAg
        ICAgIG1peGlucy5wdXNoKHRtcCk7CiAgICB9CiAgfQoKICByZXR1cm4gdGhp
        czsKfTsKCi8qKgogIEBtZXRob2QgYXBwbHkKICBAcGFyYW0gb2JqCiAgQHJl
        dHVybiBhcHBsaWVkIG9iamVjdAoqLwpNaXhpblByb3RvdHlwZS5hcHBseSA9
        IGZ1bmN0aW9uKG9iaikgewogIHJldHVybiBhcHBseU1peGluKG9iaiwgW3Ro
        aXNdLCBmYWxzZSk7Cn07CgpNaXhpblByb3RvdHlwZS5hcHBseVBhcnRpYWwg
        PSBmdW5jdGlvbihvYmopIHsKICByZXR1cm4gYXBwbHlNaXhpbihvYmosIFt0
        aGlzXSwgdHJ1ZSk7Cn07CgpmdW5jdGlvbiBfZGV0ZWN0KGN1ck1peGluLCB0
        YXJnZXRNaXhpbiwgc2VlbikgewogIHZhciBndWlkID0gZ3VpZEZvcihjdXJN
        aXhpbik7CgogIGlmIChzZWVuW2d1aWRdKSB7IHJldHVybiBmYWxzZTsgfQog
        IHNlZW5bZ3VpZF0gPSB0cnVlOwoKICBpZiAoY3VyTWl4aW4gPT09IHRhcmdl
        dE1peGluKSB7IHJldHVybiB0cnVlOyB9CiAgdmFyIG1peGlucyA9IGN1ck1p
        eGluLm1peGlucywgbG9jID0gbWl4aW5zID8gbWl4aW5zLmxlbmd0aCA6IDA7
        CiAgd2hpbGUgKC0tbG9jID49IDApIHsKICAgIGlmIChfZGV0ZWN0KG1peGlu
        c1tsb2NdLCB0YXJnZXRNaXhpbiwgc2VlbikpIHsgcmV0dXJuIHRydWU7IH0K
        ICB9CiAgcmV0dXJuIGZhbHNlOwp9CgovKioKICBAbWV0aG9kIGRldGVjdAog
        IEBwYXJhbSBvYmoKICBAcmV0dXJuIHtCb29sZWFufQoqLwpNaXhpblByb3Rv
        dHlwZS5kZXRlY3QgPSBmdW5jdGlvbihvYmopIHsKICBpZiAoIW9iaikgeyBy
        ZXR1cm4gZmFsc2U7IH0KICBpZiAob2JqIGluc3RhbmNlb2YgTWl4aW4pIHsg
        cmV0dXJuIF9kZXRlY3Qob2JqLCB0aGlzLCB7fSk7IH0KICB2YXIgbWl4aW5z
        ID0gRW1iZXIubWV0YShvYmosIGZhbHNlKS5taXhpbnM7CiAgaWYgKG1peGlu
        cykgewogICAgcmV0dXJuICEhbWl4aW5zW2d1aWRGb3IodGhpcyldOwogIH0K
        ICByZXR1cm4gZmFsc2U7Cn07CgpNaXhpblByb3RvdHlwZS53aXRob3V0ID0g
        ZnVuY3Rpb24oKSB7CiAgdmFyIHJldCA9IG5ldyBNaXhpbih0aGlzKTsKICBy
        ZXQuX3dpdGhvdXQgPSBhX3NsaWNlLmNhbGwoYXJndW1lbnRzKTsKICByZXR1
        cm4gcmV0Owp9OwoKZnVuY3Rpb24gX2tleXMocmV0LCBtaXhpbiwgc2Vlbikg
        ewogIGlmIChzZWVuW2d1aWRGb3IobWl4aW4pXSkgeyByZXR1cm47IH0KICBz
        ZWVuW2d1aWRGb3IobWl4aW4pXSA9IHRydWU7CgogIGlmIChtaXhpbi5wcm9w
        ZXJ0aWVzKSB7CiAgICB2YXIgcHJvcHMgPSBtaXhpbi5wcm9wZXJ0aWVzOwog
        ICAgZm9yICh2YXIga2V5IGluIHByb3BzKSB7CiAgICAgIGlmIChwcm9wcy5o
        YXNPd25Qcm9wZXJ0eShrZXkpKSB7IHJldFtrZXldID0gdHJ1ZTsgfQogICAg
        fQogIH0gZWxzZSBpZiAobWl4aW4ubWl4aW5zKSB7CiAgICBhX2ZvckVhY2gu
        Y2FsbChtaXhpbi5taXhpbnMsIGZ1bmN0aW9uKHgpIHsgX2tleXMocmV0LCB4
        LCBzZWVuKTsgfSk7CiAgfQp9CgpNaXhpblByb3RvdHlwZS5rZXlzID0gZnVu
        Y3Rpb24oKSB7CiAgdmFyIGtleXMgPSB7fSwgc2VlbiA9IHt9LCByZXQgPSBb
        XTsKICBfa2V5cyhrZXlzLCB0aGlzLCBzZWVuKTsKICBmb3IodmFyIGtleSBp
        biBrZXlzKSB7CiAgICBpZiAoa2V5cy5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7
        IHJldC5wdXNoKGtleSk7IH0KICB9CiAgcmV0dXJuIHJldDsKfTsKCi8vIHJl
        dHVybnMgdGhlIG1peGlucyBjdXJyZW50bHkgYXBwbGllZCB0byB0aGUgc3Bl
        Y2lmaWVkIG9iamVjdAovLyBUT0RPOiBNYWtlIEVtYmVyLm1peGluCk1peGlu
        Lm1peGlucyA9IGZ1bmN0aW9uKG9iaikgewogIHZhciBtaXhpbnMgPSBFbWJl
        ci5tZXRhKG9iaiwgZmFsc2UpLm1peGlucywgcmV0ID0gW107CgogIGlmICgh
        bWl4aW5zKSB7IHJldHVybiByZXQ7IH0KCiAgZm9yICh2YXIga2V5IGluIG1p
        eGlucykgewogICAgdmFyIG1peGluID0gbWl4aW5zW2tleV07CgogICAgLy8g
        c2tpcCBwcmltaXRpdmUgbWl4aW5zIHNpbmNlIHRoZXNlIGFyZSBhbHdheXMg
        YW5vbnltb3VzCiAgICBpZiAoIW1peGluLnByb3BlcnRpZXMpIHsgcmV0LnB1
        c2gobWl4aW4pOyB9CiAgfQoKICByZXR1cm4gcmV0Owp9OwoKUkVRVUlSRUQg
        PSBuZXcgRW1iZXIuRGVzY3JpcHRvcigpOwpSRVFVSVJFRC50b1N0cmluZyA9
        IGZ1bmN0aW9uKCkgeyByZXR1cm4gJyhSZXF1aXJlZCBQcm9wZXJ0eSknOyB9
        OwoKLyoqCiAgRGVub3RlcyBhIHJlcXVpcmVkIHByb3BlcnR5IGZvciBhIG1p
        eGluCgogIEBtZXRob2QgcmVxdWlyZWQKICBAZm9yIEVtYmVyCiovCkVtYmVy
        LnJlcXVpcmVkID0gZnVuY3Rpb24oKSB7CiAgcmV0dXJuIFJFUVVJUkVEOwp9
        OwoKQWxpYXMgPSBmdW5jdGlvbihtZXRob2ROYW1lKSB7CiAgdGhpcy5tZXRo
        b2ROYW1lID0gbWV0aG9kTmFtZTsKfTsKQWxpYXMucHJvdG90eXBlID0gbmV3
        IEVtYmVyLkRlc2NyaXB0b3IoKTsKCi8qKgogIE1ha2VzIGEgcHJvcGVydHkg
        b3IgbWV0aG9kIGF2YWlsYWJsZSB2aWEgYW4gYWRkaXRpb25hbCBuYW1lLgoK
        ICBgYGBqYXZhc2NyaXB0CiAgQXBwLlBhaW50U2FtcGxlID0gRW1iZXIuT2Jq
        ZWN0LmV4dGVuZCh7CiAgICBjb2xvcjogJ3JlZCcsCiAgICBjb2xvdXI6IEVt
        YmVyLmFsaWFzKCdjb2xvcicpLAogICAgbmFtZTogZnVuY3Rpb24oKSB7CiAg
        ICAgIHJldHVybiAiWmVkIjsKICAgIH0sCiAgICBtb25pa2VyOiBFbWJlci5h
        bGlhcygibmFtZSIpCiAgfSk7CgogIHZhciBwYWludFNhbXBsZSA9IEFwcC5Q
        YWludFNhbXBsZS5jcmVhdGUoKQogIHBhaW50U2FtcGxlLmdldCgnY29sb3Vy
        Jyk7ICAvLyAncmVkJwogIHBhaW50U2FtcGxlLm1vbmlrZXIoKTsgICAgICAv
        LyAnWmVkJwogIGBgYAoKICBAbWV0aG9kIGFsaWFzCiAgQGZvciBFbWJlcgog
        IEBwYXJhbSB7U3RyaW5nfSBtZXRob2ROYW1lIG5hbWUgb2YgdGhlIG1ldGhv
        ZCBvciBwcm9wZXJ0eSB0byBhbGlhcwogIEByZXR1cm4ge0VtYmVyLkRlc2Ny
        aXB0b3J9CiAgQGRlcHJlY2F0ZWQgVXNlIGBFbWJlci5hbGlhc01ldGhvZGAg
        b3IgYEVtYmVyLmNvbXB1dGVkLmFsaWFzYCBpbnN0ZWFkCiovCkVtYmVyLmFs
        aWFzID0gZnVuY3Rpb24obWV0aG9kTmFtZSkgewogIEVtYmVyLmRlcHJlY2F0
        ZSgiRW1iZXIuYWxpYXMgaXMgZGVwcmVjYXRlZC4gUGxlYXNlIHVzZSBFbWJl
        ci5hbGlhc01ldGhvZCBvciBFbWJlci5jb21wdXRlZC5hbGlhcyBpbnN0ZWFk
        LiIpOwogIHJldHVybiBuZXcgQWxpYXMobWV0aG9kTmFtZSk7Cn07CgovKioK
        ICBNYWtlcyBhIG1ldGhvZCBhdmFpbGFibGUgdmlhIGFuIGFkZGl0aW9uYWwg
        bmFtZS4KCiAgYGBgamF2YXNjcmlwdAogIEFwcC5QZXJzb24gPSBFbWJlci5P
        YmplY3QuZXh0ZW5kKHsKICAgIG5hbWU6IGZ1bmN0aW9uKCkgewogICAgICBy
        ZXR1cm4gJ1RvbWh1ZGEgS2F0emRhbGUnOwogICAgfSwKICAgIG1vbmlrZXI6
        IEVtYmVyLmFsaWFzTWV0aG9kKCduYW1lJykKICB9KTsKCiAgdmFyIGdvb2RH
        dXkgPSBBcHAuUGVyc29uLmNyZWF0ZSgpCiAgYGBgCgogIEBtZXRob2QgYWxp
        YXNNZXRob2QKICBAZm9yIEVtYmVyCiAgQHBhcmFtIHtTdHJpbmd9IG1ldGhv
        ZE5hbWUgbmFtZSBvZiB0aGUgbWV0aG9kIHRvIGFsaWFzCiAgQHJldHVybiB7
        RW1iZXIuRGVzY3JpcHRvcn0KKi8KRW1iZXIuYWxpYXNNZXRob2QgPSBmdW5j
        dGlvbihtZXRob2ROYW1lKSB7CiAgcmV0dXJuIG5ldyBBbGlhcyhtZXRob2RO
        YW1lKTsKfTsKCi8vIC4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4u
        Li4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4KLy8gT0JTRVJWRVIgSEVMUEVS
        Ci8vCgovKioKICBTcGVjaWZ5IGEgbWV0aG9kIHRoYXQgb2JzZXJ2ZXMgcHJv
        cGVydHkgY2hhbmdlcy4KCiAgYGBgamF2YXNjcmlwdAogIEVtYmVyLk9iamVj
        dC5leHRlbmQoewogICAgdmFsdWVPYnNlcnZlcjogRW1iZXIub2JzZXJ2ZXIo
        ZnVuY3Rpb24oKSB7CiAgICAgIC8vIEV4ZWN1dGVzIHdoZW5ldmVyIHRoZSAi
        dmFsdWUiIHByb3BlcnR5IGNoYW5nZXMKICAgIH0sICd2YWx1ZScpCiAgfSk7
        CiAgYGBgCgogIEluIHRoZSBmdXR1cmUgdGhpcyBtZXRob2QgbWF5IGJlY29t
        ZSBhc3luY2hyb25vdXMuIElmIHlvdSB3YW50IHRvIGVuc3VyZQogIHN5bmNo
        cm9ub3VzIGJlaGF2aW9yLCB1c2UgYGltbWVkaWF0ZU9ic2VydmVyYC4KCiAg
        QWxzbyBhdmFpbGFibGUgYXMgYEZ1bmN0aW9uLnByb3RvdHlwZS5vYnNlcnZl
        c2AgaWYgcHJvdG90eXBlIGV4dGVuc2lvbnMgYXJlCiAgZW5hYmxlZC4KCiAg
        QG1ldGhvZCBvYnNlcnZlcgogIEBmb3IgRW1iZXIKICBAcGFyYW0ge0Z1bmN0
        aW9ufSBmdW5jCiAgQHBhcmFtIHtTdHJpbmd9IHByb3BlcnR5TmFtZXMqCiAg
        QHJldHVybiBmdW5jCiovCkVtYmVyLm9ic2VydmVyID0gZnVuY3Rpb24oZnVu
        YykgewogIHZhciBwYXRocyA9IGFfc2xpY2UuY2FsbChhcmd1bWVudHMsIDEp
        OwogIGZ1bmMuX19lbWJlcl9vYnNlcnZlc19fID0gcGF0aHM7CiAgcmV0dXJu
        IGZ1bmM7Cn07CgovKioKICBTcGVjaWZ5IGEgbWV0aG9kIHRoYXQgb2JzZXJ2
        ZXMgcHJvcGVydHkgY2hhbmdlcy4KCiAgYGBgamF2YXNjcmlwdAogIEVtYmVy
        Lk9iamVjdC5leHRlbmQoewogICAgdmFsdWVPYnNlcnZlcjogRW1iZXIuaW1t
        ZWRpYXRlT2JzZXJ2ZXIoZnVuY3Rpb24oKSB7CiAgICAgIC8vIEV4ZWN1dGVz
        IHdoZW5ldmVyIHRoZSAidmFsdWUiIHByb3BlcnR5IGNoYW5nZXMKICAgIH0s
        ICd2YWx1ZScpCiAgfSk7CiAgYGBgCgogIEluIHRoZSBmdXR1cmUsIGBFbWJl
        ci5vYnNlcnZlcmAgbWF5IGJlY29tZSBhc3luY2hyb25vdXMuIEluIHRoaXMg
        ZXZlbnQsCiAgYEVtYmVyLmltbWVkaWF0ZU9ic2VydmVyYCB3aWxsIG1haW50
        YWluIHRoZSBzeW5jaHJvbm91cyBiZWhhdmlvci4KCiAgQWxzbyBhdmFpbGFi
        bGUgYXMgYEZ1bmN0aW9uLnByb3RvdHlwZS5vYnNlcnZlc0ltbWVkaWF0ZWx5
        YCBpZiBwcm90b3R5cGUgZXh0ZW5zaW9ucyBhcmUKICBlbmFibGVkLgoKICBA
        bWV0aG9kIGltbWVkaWF0ZU9ic2VydmVyCiAgQGZvciBFbWJlcgogIEBwYXJh
        bSB7RnVuY3Rpb259IGZ1bmMKICBAcGFyYW0ge1N0cmluZ30gcHJvcGVydHlO
        YW1lcyoKICBAcmV0dXJuIGZ1bmMKKi8KRW1iZXIuaW1tZWRpYXRlT2JzZXJ2
        ZXIgPSBmdW5jdGlvbigpIHsKICBmb3IgKHZhciBpPTAsIGw9YXJndW1lbnRz
        Lmxlbmd0aDsgaTxsOyBpKyspIHsKICAgIHZhciBhcmcgPSBhcmd1bWVudHNb
        aV07CiAgICBFbWJlci5hc3NlcnQoIkltbWVkaWF0ZSBvYnNlcnZlcnMgbXVz
        dCBvYnNlcnZlIGludGVybmFsIHByb3BlcnRpZXMgb25seSwgbm90IHByb3Bl
        cnRpZXMgb24gb3RoZXIgb2JqZWN0cy4iLCB0eXBlb2YgYXJnICE9PSAic3Ry
        aW5nIiB8fCBhcmcuaW5kZXhPZignLicpID09PSAtMSk7CiAgfQoKICByZXR1
        cm4gRW1iZXIub2JzZXJ2ZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKfTsK
        Ci8qKgogIFdoZW4gb2JzZXJ2ZXJzIGZpcmUsIHRoZXkgYXJlIGNhbGxlZCB3
        aXRoIHRoZSBhcmd1bWVudHMgYG9iamAsIGBrZXlOYW1lYC4KCiAgTm90ZSwg
        YEBlYWNoLnByb3BlcnR5YCBvYnNlcnZlciBpcyBjYWxsZWQgcGVyIGVhY2gg
        YWRkIG9yIHJlcGxhY2Ugb2YgYW4gZWxlbWVudAogIGFuZCBpdCdzIG5vdCBj
        YWxsZWQgd2l0aCBhIHNwZWNpZmljIGVudW1lcmF0aW9uIGl0ZW0uCgogIEEg
        YGJlZm9yZU9ic2VydmVyYCBmaXJlcyBiZWZvcmUgYSBwcm9wZXJ0eSBjaGFu
        Z2VzLgoKICBBIGBiZWZvcmVPYnNlcnZlcmAgaXMgYW4gYWx0ZXJuYXRpdmUg
        Zm9ybSBvZiBgLm9ic2VydmVzQmVmb3JlKClgLgoKICBgYGBqYXZhc2NyaXB0
        CiAgQXBwLlBlcnNvblZpZXcgPSBFbWJlci5WaWV3LmV4dGVuZCh7CgogICAg
        ZnJpZW5kczogW3sgbmFtZTogJ1RvbScgfSwgeyBuYW1lOiAnU3RlZmFuJyB9
        LCB7IG5hbWU6ICdLcmlzJyB9XSwKCiAgICB2YWx1ZVdpbGxDaGFuZ2U6IEVt
        YmVyLmJlZm9yZU9ic2VydmVyKGZ1bmN0aW9uKG9iaiwga2V5TmFtZSkgewog
        ICAgICB0aGlzLmNoYW5naW5nRnJvbSA9IG9iai5nZXQoa2V5TmFtZSk7CiAg
        ICB9LCAnY29udGVudC52YWx1ZScpLAoKICAgIHZhbHVlRGlkQ2hhbmdlOiBF
        bWJlci5vYnNlcnZlcihmdW5jdGlvbihvYmosIGtleU5hbWUpIHsKICAgICAg
        ICAvLyBvbmx5IHJ1biBpZiB1cGRhdGluZyBhIHZhbHVlIGFscmVhZHkgaW4g
        dGhlIERPTQogICAgICAgIGlmICh0aGlzLmdldCgnc3RhdGUnKSA9PT0gJ2lu
        RE9NJykgewogICAgICAgICAgdmFyIGNvbG9yID0gb2JqLmdldChrZXlOYW1l
        KSA+IHRoaXMuY2hhbmdpbmdGcm9tID8gJ2dyZWVuJyA6ICdyZWQnOwogICAg
        ICAgICAgLy8gbG9naWMKICAgICAgICB9CiAgICB9LCAnY29udGVudC52YWx1
        ZScpLAoKICAgIGZyaWVuZHNEaWRDaGFuZ2U6IEVtYmVyLm9ic2VydmVyKGZ1
        bmN0aW9uKG9iaiwga2V5TmFtZSkgewogICAgICAvLyBzb21lIGxvZ2ljCiAg
        ICAgIC8vIG9iai5nZXQoa2V5TmFtZSkgcmV0dXJucyBmcmllbmRzIGFycmF5
        CiAgICB9LCAnZnJpZW5kcy5AZWFjaC5uYW1lJykKICB9KTsKICBgYGAKCiAg
        QWxzbyBhdmFpbGFibGUgYXMgYEZ1bmN0aW9uLnByb3RvdHlwZS5vYnNlcnZl
        c0JlZm9yZWAgaWYgcHJvdG90eXBlIGV4dGVuc2lvbnMgYXJlCiAgZW5hYmxl
        ZC4KCiAgQG1ldGhvZCBiZWZvcmVPYnNlcnZlcgogIEBmb3IgRW1iZXIKICBA
        cGFyYW0ge0Z1bmN0aW9ufSBmdW5jCiAgQHBhcmFtIHtTdHJpbmd9IHByb3Bl
        cnR5TmFtZXMqCiAgQHJldHVybiBmdW5jCiovCkVtYmVyLmJlZm9yZU9ic2Vy
        dmVyID0gZnVuY3Rpb24oZnVuYykgewogIHZhciBwYXRocyA9IGFfc2xpY2Uu
        Y2FsbChhcmd1bWVudHMsIDEpOwogIGZ1bmMuX19lbWJlcl9vYnNlcnZlc0Jl
        Zm9yZV9fID0gcGF0aHM7CiAgcmV0dXJuIGZ1bmM7Cn07Cgp9KSgpOwoKCgoo
        ZnVuY3Rpb24oKSB7Ci8vIFByb3ZpZGVzIGEgd2F5IHRvIHJlZ2lzdGVyIGxp
        YnJhcnkgdmVyc2lvbnMgd2l0aCBlbWJlci4KdmFyIGZvckVhY2ggPSBFbWJl
        ci5FbnVtZXJhYmxlVXRpbHMuZm9yRWFjaCwKICAgIGluZGV4T2YgPSBFbWJl
        ci5FbnVtZXJhYmxlVXRpbHMuaW5kZXhPZjsKCkVtYmVyLmxpYnJhcmllcyA9
        IGZ1bmN0aW9uKCkgewogIHZhciBsaWJyYXJpZXMgICAgPSBbXTsKICB2YXIg
        Y29yZUxpYkluZGV4ID0gMDsKCiAgdmFyIGdldExpYnJhcnkgPSBmdW5jdGlv
        bihuYW1lKSB7CiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxpYnJhcmllcy5s
        ZW5ndGg7IGkrKykgewogICAgICBpZiAobGlicmFyaWVzW2ldLm5hbWUgPT09
        IG5hbWUpIHsKICAgICAgICByZXR1cm4gbGlicmFyaWVzW2ldOwogICAgICB9
        CiAgICB9CiAgfTsKCiAgbGlicmFyaWVzLnJlZ2lzdGVyID0gZnVuY3Rpb24o
        bmFtZSwgdmVyc2lvbikgewogICAgaWYgKCFnZXRMaWJyYXJ5KG5hbWUpKSB7
        CiAgICAgIGxpYnJhcmllcy5wdXNoKHtuYW1lOiBuYW1lLCB2ZXJzaW9uOiB2
        ZXJzaW9ufSk7CiAgICB9CiAgfTsKCiAgbGlicmFyaWVzLnJlZ2lzdGVyQ29y
        ZUxpYnJhcnkgPSBmdW5jdGlvbihuYW1lLCB2ZXJzaW9uKSB7CiAgICBpZiAo
        IWdldExpYnJhcnkobmFtZSkpIHsKICAgICAgbGlicmFyaWVzLnNwbGljZShj
        b3JlTGliSW5kZXgrKywgMCwge25hbWU6IG5hbWUsIHZlcnNpb246IHZlcnNp
        b259KTsKICAgIH0KICB9OwoKICBsaWJyYXJpZXMuZGVSZWdpc3RlciA9IGZ1
        bmN0aW9uKG5hbWUpIHsKICAgIHZhciBsaWIgPSBnZXRMaWJyYXJ5KG5hbWUp
        OwogICAgaWYgKGxpYikgbGlicmFyaWVzLnNwbGljZShpbmRleE9mKGxpYnJh
        cmllcywgbGliKSwgMSk7CiAgfTsKCiAgbGlicmFyaWVzLmVhY2ggPSBmdW5j
        dGlvbiAoY2FsbGJhY2spIHsKICAgIGZvckVhY2gobGlicmFyaWVzLCBmdW5j
        dGlvbihsaWIpIHsKICAgICAgY2FsbGJhY2sobGliLm5hbWUsIGxpYi52ZXJz
        aW9uKTsKICAgIH0pOwogIH07CgogIHJldHVybiBsaWJyYXJpZXM7Cn0oKTsK
        CkVtYmVyLmxpYnJhcmllcy5yZWdpc3RlckNvcmVMaWJyYXJ5KCdFbWJlcics
        IEVtYmVyLlZFUlNJT04pOwoKfSkoKTsKCgoKKGZ1bmN0aW9uKCkgewovKioK
        RW1iZXIgTWV0YWwKCkBtb2R1bGUgZW1iZXIKQHN1Ym1vZHVsZSBlbWJlci1t
        ZXRhbAoqLwoKfSkoKTsKCihmdW5jdGlvbigpIHsKZGVmaW5lKCJyc3ZwL2Fs
        bCIsCiAgWyJyc3ZwL3Byb21pc2UiLCJleHBvcnRzIl0sCiAgZnVuY3Rpb24o
        X19kZXBlbmRlbmN5MV9fLCBfX2V4cG9ydHNfXykgewogICAgInVzZSBzdHJp
        Y3QiOwogICAgdmFyIFByb21pc2UgPSBfX2RlcGVuZGVuY3kxX18uUHJvbWlz
        ZTsKICAgIC8qIGdsb2JhbCB0b1N0cmluZyAqLwoKCiAgICBmdW5jdGlvbiBh
        bGwocHJvbWlzZXMpIHsKICAgICAgaWYgKE9iamVjdC5wcm90b3R5cGUudG9T
        dHJpbmcuY2FsbChwcm9taXNlcykgIT09ICJbb2JqZWN0IEFycmF5XSIpIHsK
        ICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdZb3UgbXVzdCBwYXNzIGFu
        IGFycmF5IHRvIGFsbC4nKTsKICAgICAgfQoKICAgICAgcmV0dXJuIG5ldyBQ
        cm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkgewogICAgICAgIHZh
        ciByZXN1bHRzID0gW10sIHJlbWFpbmluZyA9IHByb21pc2VzLmxlbmd0aCwK
        ICAgICAgICBwcm9taXNlOwoKICAgICAgICBpZiAocmVtYWluaW5nID09PSAw
        KSB7CiAgICAgICAgICByZXNvbHZlKFtdKTsKICAgICAgICB9CgogICAgICAg
        IGZ1bmN0aW9uIHJlc29sdmVyKGluZGV4KSB7CiAgICAgICAgICByZXR1cm4g
        ZnVuY3Rpb24odmFsdWUpIHsKICAgICAgICAgICAgcmVzb2x2ZUFsbChpbmRl
        eCwgdmFsdWUpOwogICAgICAgICAgfTsKICAgICAgICB9CgogICAgICAgIGZ1
        bmN0aW9uIHJlc29sdmVBbGwoaW5kZXgsIHZhbHVlKSB7CiAgICAgICAgICBy
        ZXN1bHRzW2luZGV4XSA9IHZhbHVlOwogICAgICAgICAgaWYgKC0tcmVtYWlu
        aW5nID09PSAwKSB7CiAgICAgICAgICAgIHJlc29sdmUocmVzdWx0cyk7CiAg
        ICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBmb3IgKHZhciBpID0gMDsg
        aSA8IHByb21pc2VzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICBwcm9taXNl
        ID0gcHJvbWlzZXNbaV07CgogICAgICAgICAgaWYgKHByb21pc2UgJiYgdHlw
        ZW9mIHByb21pc2UudGhlbiA9PT0gJ2Z1bmN0aW9uJykgewogICAgICAgICAg
        ICBwcm9taXNlLnRoZW4ocmVzb2x2ZXIoaSksIHJlamVjdCk7CiAgICAgICAg
        ICB9IGVsc2UgewogICAgICAgICAgICByZXNvbHZlQWxsKGksIHByb21pc2Up
        OwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSk7CiAgICB9CgoKICAg
        IF9fZXhwb3J0c19fLmFsbCA9IGFsbDsKICB9KTsKZGVmaW5lKCJyc3ZwL2Fz
        eW5jIiwKICBbImV4cG9ydHMiXSwKICBmdW5jdGlvbihfX2V4cG9ydHNfXykg
        ewogICAgInVzZSBzdHJpY3QiOwogICAgdmFyIGJyb3dzZXJHbG9iYWwgPSAo
        dHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcpID8gd2luZG93IDoge307
        CiAgICB2YXIgQnJvd3Nlck11dGF0aW9uT2JzZXJ2ZXIgPSBicm93c2VyR2xv
        YmFsLk11dGF0aW9uT2JzZXJ2ZXIgfHwgYnJvd3Nlckdsb2JhbC5XZWJLaXRN
        dXRhdGlvbk9ic2VydmVyOwogICAgdmFyIGFzeW5jOwogICAgdmFyIGxvY2Fs
        ID0gKHR5cGVvZiBnbG9iYWwgIT09ICd1bmRlZmluZWQnKSA/IGdsb2JhbCA6
        IHRoaXM7CgogICAgLy8gb2xkIG5vZGUKICAgIGZ1bmN0aW9uIHVzZU5leHRU
        aWNrKCkgewogICAgICByZXR1cm4gZnVuY3Rpb24oY2FsbGJhY2ssIGFyZykg
        ewogICAgICAgIHByb2Nlc3MubmV4dFRpY2soZnVuY3Rpb24oKSB7CiAgICAg
        ICAgICBjYWxsYmFjayhhcmcpOwogICAgICAgIH0pOwogICAgICB9OwogICAg
        fQoKICAgIC8vIG5vZGUgPj0gMC4xMC54CiAgICBmdW5jdGlvbiB1c2VTZXRJ
        bW1lZGlhdGUoKSB7CiAgICAgIHJldHVybiBmdW5jdGlvbihjYWxsYmFjaywg
        YXJnKSB7CiAgICAgICAgLyogZ2xvYmFsICBzZXRJbW1lZGlhdGUgKi8KICAg
        ICAgICBzZXRJbW1lZGlhdGUoZnVuY3Rpb24oKXsKICAgICAgICAgIGNhbGxi
        YWNrKGFyZyk7CiAgICAgICAgfSk7CiAgICAgIH07CiAgICB9CgogICAgZnVu
        Y3Rpb24gdXNlTXV0YXRpb25PYnNlcnZlcigpIHsKICAgICAgdmFyIHF1ZXVl
        ID0gW107CgogICAgICB2YXIgb2JzZXJ2ZXIgPSBuZXcgQnJvd3Nlck11dGF0
        aW9uT2JzZXJ2ZXIoZnVuY3Rpb24oKSB7CiAgICAgICAgdmFyIHRvUHJvY2Vz
        cyA9IHF1ZXVlLnNsaWNlKCk7CiAgICAgICAgcXVldWUgPSBbXTsKCiAgICAg
        ICAgdG9Qcm9jZXNzLmZvckVhY2goZnVuY3Rpb24odHVwbGUpIHsKICAgICAg
        ICAgIHZhciBjYWxsYmFjayA9IHR1cGxlWzBdLCBhcmc9IHR1cGxlWzFdOwog
        ICAgICAgICAgY2FsbGJhY2soYXJnKTsKICAgICAgICB9KTsKICAgICAgfSk7
        CgogICAgICB2YXIgZWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQo
        J2RpdicpOwogICAgICBvYnNlcnZlci5vYnNlcnZlKGVsZW1lbnQsIHsgYXR0
        cmlidXRlczogdHJ1ZSB9KTsKCiAgICAgIC8vIENocm9tZSBNZW1vcnkgTGVh
        azogaHR0cHM6Ly9idWdzLndlYmtpdC5vcmcvc2hvd19idWcuY2dpP2lkPTkz
        NjYxCiAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCd1bmxvYWQnLCBm
        dW5jdGlvbigpewogICAgICAgIG9ic2VydmVyLmRpc2Nvbm5lY3QoKTsKICAg
        ICAgICBvYnNlcnZlciA9IG51bGw7CiAgICAgIH0sIGZhbHNlKTsKCiAgICAg
        IHJldHVybiBmdW5jdGlvbihjYWxsYmFjaywgYXJnKSB7CiAgICAgICAgcXVl
        dWUucHVzaChbY2FsbGJhY2ssIGFyZ10pOwogICAgICAgIGVsZW1lbnQuc2V0
        QXR0cmlidXRlKCdkcmFpblF1ZXVlJywgJ2RyYWluUXVldWUnKTsKICAgICAg
        fTsKICAgIH0KCiAgICBmdW5jdGlvbiB1c2VTZXRUaW1lb3V0KCkgewogICAg
        ICByZXR1cm4gZnVuY3Rpb24oY2FsbGJhY2ssIGFyZykgewogICAgICAgIGxv
        Y2FsLnNldFRpbWVvdXQoZnVuY3Rpb24oKSB7CiAgICAgICAgICBjYWxsYmFj
        ayhhcmcpOwogICAgICAgIH0sIDEpOwogICAgICB9OwogICAgfQoKICAgIGlm
        ICh0eXBlb2Ygc2V0SW1tZWRpYXRlID09PSAnZnVuY3Rpb24nKSB7CiAgICAg
        IGFzeW5jID0gdXNlU2V0SW1tZWRpYXRlKCk7CiAgICB9IGVsc2UgaWYgKHR5
        cGVvZiBwcm9jZXNzICE9PSAndW5kZWZpbmVkJyAmJiB7fS50b1N0cmluZy5j
        YWxsKHByb2Nlc3MpID09PSAnW29iamVjdCBwcm9jZXNzXScpIHsKICAgICAg
        YXN5bmMgPSB1c2VOZXh0VGljaygpOwogICAgfSBlbHNlIGlmIChCcm93c2Vy
        TXV0YXRpb25PYnNlcnZlcikgewogICAgICBhc3luYyA9IHVzZU11dGF0aW9u
        T2JzZXJ2ZXIoKTsKICAgIH0gZWxzZSB7CiAgICAgIGFzeW5jID0gdXNlU2V0
        VGltZW91dCgpOwogICAgfQoKCiAgICBfX2V4cG9ydHNfXy5hc3luYyA9IGFz
        eW5jOwogIH0pOwpkZWZpbmUoInJzdnAvY29uZmlnIiwKICBbInJzdnAvYXN5
        bmMiLCJleHBvcnRzIl0sCiAgZnVuY3Rpb24oX19kZXBlbmRlbmN5MV9fLCBf
        X2V4cG9ydHNfXykgewogICAgInVzZSBzdHJpY3QiOwogICAgdmFyIGFzeW5j
        ID0gX19kZXBlbmRlbmN5MV9fLmFzeW5jOwoKICAgIHZhciBjb25maWcgPSB7
        fTsKICAgIGNvbmZpZy5hc3luYyA9IGFzeW5jOwoKCiAgICBfX2V4cG9ydHNf
        Xy5jb25maWcgPSBjb25maWc7CiAgfSk7CmRlZmluZSgicnN2cC9kZWZlciIs
        CiAgWyJyc3ZwL3Byb21pc2UiLCJleHBvcnRzIl0sCiAgZnVuY3Rpb24oX19k
        ZXBlbmRlbmN5MV9fLCBfX2V4cG9ydHNfXykgewogICAgInVzZSBzdHJpY3Qi
        OwogICAgdmFyIFByb21pc2UgPSBfX2RlcGVuZGVuY3kxX18uUHJvbWlzZTsK
        CiAgICBmdW5jdGlvbiBkZWZlcigpIHsKICAgICAgdmFyIGRlZmVycmVkID0g
        ewogICAgICAgIC8vIHByZS1hbGxvY2F0ZSBzaGFwZQogICAgICAgIHJlc29s
        dmU6IHVuZGVmaW5lZCwKICAgICAgICByZWplY3Q6ICB1bmRlZmluZWQsCiAg
        ICAgICAgcHJvbWlzZTogdW5kZWZpbmVkCiAgICAgIH07CgogICAgICBkZWZl
        cnJlZC5wcm9taXNlID0gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwg
        cmVqZWN0KSB7CiAgICAgICAgZGVmZXJyZWQucmVzb2x2ZSA9IHJlc29sdmU7
        CiAgICAgICAgZGVmZXJyZWQucmVqZWN0ID0gcmVqZWN0OwogICAgICB9KTsK
        CiAgICAgIHJldHVybiBkZWZlcnJlZDsKICAgIH0KCgogICAgX19leHBvcnRz
        X18uZGVmZXIgPSBkZWZlcjsKICB9KTsKZGVmaW5lKCJyc3ZwL2V2ZW50cyIs
        CiAgWyJleHBvcnRzIl0sCiAgZnVuY3Rpb24oX19leHBvcnRzX18pIHsKICAg
        ICJ1c2Ugc3RyaWN0IjsKICAgIHZhciBFdmVudCA9IGZ1bmN0aW9uKHR5cGUs
        IG9wdGlvbnMpIHsKICAgICAgdGhpcy50eXBlID0gdHlwZTsKCiAgICAgIGZv
        ciAodmFyIG9wdGlvbiBpbiBvcHRpb25zKSB7CiAgICAgICAgaWYgKCFvcHRp
        b25zLmhhc093blByb3BlcnR5KG9wdGlvbikpIHsgY29udGludWU7IH0KCiAg
        ICAgICAgdGhpc1tvcHRpb25dID0gb3B0aW9uc1tvcHRpb25dOwogICAgICB9
        CiAgICB9OwoKICAgIHZhciBpbmRleE9mID0gZnVuY3Rpb24oY2FsbGJhY2tz
        LCBjYWxsYmFjaykgewogICAgICBmb3IgKHZhciBpPTAsIGw9Y2FsbGJhY2tz
        Lmxlbmd0aDsgaTxsOyBpKyspIHsKICAgICAgICBpZiAoY2FsbGJhY2tzW2ld
        WzBdID09PSBjYWxsYmFjaykgeyByZXR1cm4gaTsgfQogICAgICB9CgogICAg
        ICByZXR1cm4gLTE7CiAgICB9OwoKICAgIHZhciBjYWxsYmFja3NGb3IgPSBm
        dW5jdGlvbihvYmplY3QpIHsKICAgICAgdmFyIGNhbGxiYWNrcyA9IG9iamVj
        dC5fcHJvbWlzZUNhbGxiYWNrczsKCiAgICAgIGlmICghY2FsbGJhY2tzKSB7
        CiAgICAgICAgY2FsbGJhY2tzID0gb2JqZWN0Ll9wcm9taXNlQ2FsbGJhY2tz
        ID0ge307CiAgICAgIH0KCiAgICAgIHJldHVybiBjYWxsYmFja3M7CiAgICB9
        OwoKICAgIHZhciBFdmVudFRhcmdldCA9IHsKICAgICAgbWl4aW46IGZ1bmN0
        aW9uKG9iamVjdCkgewogICAgICAgIG9iamVjdC5vbiA9IHRoaXMub247CiAg
        ICAgICAgb2JqZWN0Lm9mZiA9IHRoaXMub2ZmOwogICAgICAgIG9iamVjdC50
        cmlnZ2VyID0gdGhpcy50cmlnZ2VyOwogICAgICAgIHJldHVybiBvYmplY3Q7
        CiAgICAgIH0sCgogICAgICBvbjogZnVuY3Rpb24oZXZlbnROYW1lcywgY2Fs
        bGJhY2ssIGJpbmRpbmcpIHsKICAgICAgICB2YXIgYWxsQ2FsbGJhY2tzID0g
        Y2FsbGJhY2tzRm9yKHRoaXMpLCBjYWxsYmFja3MsIGV2ZW50TmFtZTsKICAg
        ICAgICBldmVudE5hbWVzID0gZXZlbnROYW1lcy5zcGxpdCgvXHMrLyk7CiAg
        ICAgICAgYmluZGluZyA9IGJpbmRpbmcgfHwgdGhpczsKCiAgICAgICAgd2hp
        bGUgKGV2ZW50TmFtZSA9IGV2ZW50TmFtZXMuc2hpZnQoKSkgewogICAgICAg
        ICAgY2FsbGJhY2tzID0gYWxsQ2FsbGJhY2tzW2V2ZW50TmFtZV07CgogICAg
        ICAgICAgaWYgKCFjYWxsYmFja3MpIHsKICAgICAgICAgICAgY2FsbGJhY2tz
        ID0gYWxsQ2FsbGJhY2tzW2V2ZW50TmFtZV0gPSBbXTsKICAgICAgICAgIH0K
        CiAgICAgICAgICBpZiAoaW5kZXhPZihjYWxsYmFja3MsIGNhbGxiYWNrKSA9
        PT0gLTEpIHsKICAgICAgICAgICAgY2FsbGJhY2tzLnB1c2goW2NhbGxiYWNr
        LCBiaW5kaW5nXSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9LAoK
        ICAgICAgb2ZmOiBmdW5jdGlvbihldmVudE5hbWVzLCBjYWxsYmFjaykgewog
        ICAgICAgIHZhciBhbGxDYWxsYmFja3MgPSBjYWxsYmFja3NGb3IodGhpcyks
        IGNhbGxiYWNrcywgZXZlbnROYW1lLCBpbmRleDsKICAgICAgICBldmVudE5h
        bWVzID0gZXZlbnROYW1lcy5zcGxpdCgvXHMrLyk7CgogICAgICAgIHdoaWxl
        IChldmVudE5hbWUgPSBldmVudE5hbWVzLnNoaWZ0KCkpIHsKICAgICAgICAg
        IGlmICghY2FsbGJhY2spIHsKICAgICAgICAgICAgYWxsQ2FsbGJhY2tzW2V2
        ZW50TmFtZV0gPSBbXTsKICAgICAgICAgICAgY29udGludWU7CiAgICAgICAg
        ICB9CgogICAgICAgICAgY2FsbGJhY2tzID0gYWxsQ2FsbGJhY2tzW2V2ZW50
        TmFtZV07CgogICAgICAgICAgaW5kZXggPSBpbmRleE9mKGNhbGxiYWNrcywg
        Y2FsbGJhY2spOwoKICAgICAgICAgIGlmIChpbmRleCAhPT0gLTEpIHsgY2Fs
        bGJhY2tzLnNwbGljZShpbmRleCwgMSk7IH0KICAgICAgICB9CiAgICAgIH0s
        CgogICAgICB0cmlnZ2VyOiBmdW5jdGlvbihldmVudE5hbWUsIG9wdGlvbnMp
        IHsKICAgICAgICB2YXIgYWxsQ2FsbGJhY2tzID0gY2FsbGJhY2tzRm9yKHRo
        aXMpLAogICAgICAgICAgICBjYWxsYmFja3MsIGNhbGxiYWNrVHVwbGUsIGNh
        bGxiYWNrLCBiaW5kaW5nLCBldmVudDsKCiAgICAgICAgaWYgKGNhbGxiYWNr
        cyA9IGFsbENhbGxiYWNrc1tldmVudE5hbWVdKSB7CiAgICAgICAgICAvLyBE
        b24ndCBjYWNoZSB0aGUgY2FsbGJhY2tzLmxlbmd0aCBzaW5jZSBpdCBtYXkg
        Z3JvdwogICAgICAgICAgZm9yICh2YXIgaT0wOyBpPGNhbGxiYWNrcy5sZW5n
        dGg7IGkrKykgewogICAgICAgICAgICBjYWxsYmFja1R1cGxlID0gY2FsbGJh
        Y2tzW2ldOwogICAgICAgICAgICBjYWxsYmFjayA9IGNhbGxiYWNrVHVwbGVb
        MF07CiAgICAgICAgICAgIGJpbmRpbmcgPSBjYWxsYmFja1R1cGxlWzFdOwoK
        ICAgICAgICAgICAgaWYgKHR5cGVvZiBvcHRpb25zICE9PSAnb2JqZWN0Jykg
        ewogICAgICAgICAgICAgIG9wdGlvbnMgPSB7IGRldGFpbDogb3B0aW9ucyB9
        OwogICAgICAgICAgICB9CgogICAgICAgICAgICBldmVudCA9IG5ldyBFdmVu
        dChldmVudE5hbWUsIG9wdGlvbnMpOwogICAgICAgICAgICBjYWxsYmFjay5j
        YWxsKGJpbmRpbmcsIGV2ZW50KTsKICAgICAgICAgIH0KICAgICAgICB9CiAg
        ICAgIH0KICAgIH07CgoKICAgIF9fZXhwb3J0c19fLkV2ZW50VGFyZ2V0ID0g
        RXZlbnRUYXJnZXQ7CiAgfSk7CmRlZmluZSgicnN2cC9oYXNoIiwKICBbInJz
        dnAvZGVmZXIiLCJleHBvcnRzIl0sCiAgZnVuY3Rpb24oX19kZXBlbmRlbmN5
        MV9fLCBfX2V4cG9ydHNfXykgewogICAgInVzZSBzdHJpY3QiOwogICAgdmFy
        IGRlZmVyID0gX19kZXBlbmRlbmN5MV9fLmRlZmVyOwoKICAgIGZ1bmN0aW9u
        IHNpemUob2JqZWN0KSB7CiAgICAgIHZhciBzID0gMDsKCiAgICAgIGZvciAo
        dmFyIHByb3AgaW4gb2JqZWN0KSB7CiAgICAgICAgcysrOwogICAgICB9Cgog
        ICAgICByZXR1cm4gczsKICAgIH0KCiAgICBmdW5jdGlvbiBoYXNoKHByb21p
        c2VzKSB7CiAgICAgIHZhciByZXN1bHRzID0ge30sIGRlZmVycmVkID0gZGVm
        ZXIoKSwgcmVtYWluaW5nID0gc2l6ZShwcm9taXNlcyk7CgogICAgICBpZiAo
        cmVtYWluaW5nID09PSAwKSB7CiAgICAgICAgZGVmZXJyZWQucmVzb2x2ZSh7
        fSk7CiAgICAgIH0KCiAgICAgIHZhciByZXNvbHZlciA9IGZ1bmN0aW9uKHBy
        b3ApIHsKICAgICAgICByZXR1cm4gZnVuY3Rpb24odmFsdWUpIHsKICAgICAg
        ICAgIHJlc29sdmVBbGwocHJvcCwgdmFsdWUpOwogICAgICAgIH07CiAgICAg
        IH07CgogICAgICB2YXIgcmVzb2x2ZUFsbCA9IGZ1bmN0aW9uKHByb3AsIHZh
        bHVlKSB7CiAgICAgICAgcmVzdWx0c1twcm9wXSA9IHZhbHVlOwogICAgICAg
        IGlmICgtLXJlbWFpbmluZyA9PT0gMCkgewogICAgICAgICAgZGVmZXJyZWQu
        cmVzb2x2ZShyZXN1bHRzKTsKICAgICAgICB9CiAgICAgIH07CgogICAgICB2
        YXIgcmVqZWN0QWxsID0gZnVuY3Rpb24oZXJyb3IpIHsKICAgICAgICBkZWZl
        cnJlZC5yZWplY3QoZXJyb3IpOwogICAgICB9OwoKICAgICAgZm9yICh2YXIg
        cHJvcCBpbiBwcm9taXNlcykgewogICAgICAgIGlmIChwcm9taXNlc1twcm9w
        XSAmJiB0eXBlb2YgcHJvbWlzZXNbcHJvcF0udGhlbiA9PT0gJ2Z1bmN0aW9u
        JykgewogICAgICAgICAgcHJvbWlzZXNbcHJvcF0udGhlbihyZXNvbHZlcihw
        cm9wKSwgcmVqZWN0QWxsKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAg
        cmVzb2x2ZUFsbChwcm9wLCBwcm9taXNlc1twcm9wXSk7CiAgICAgICAgfQog
        ICAgICB9CgogICAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTsKICAgIH0K
        CgogICAgX19leHBvcnRzX18uaGFzaCA9IGhhc2g7CiAgfSk7CmRlZmluZSgi
        cnN2cC9ub2RlIiwKICBbInJzdnAvcHJvbWlzZSIsInJzdnAvYWxsIiwiZXhw
        b3J0cyJdLAogIGZ1bmN0aW9uKF9fZGVwZW5kZW5jeTFfXywgX19kZXBlbmRl
        bmN5Ml9fLCBfX2V4cG9ydHNfXykgewogICAgInVzZSBzdHJpY3QiOwogICAg
        dmFyIFByb21pc2UgPSBfX2RlcGVuZGVuY3kxX18uUHJvbWlzZTsKICAgIHZh
        ciBhbGwgPSBfX2RlcGVuZGVuY3kyX18uYWxsOwoKICAgIGZ1bmN0aW9uIG1h
        a2VOb2RlQ2FsbGJhY2tGb3IocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgIHJl
        dHVybiBmdW5jdGlvbiAoZXJyb3IsIHZhbHVlKSB7CiAgICAgICAgaWYgKGVy
        cm9yKSB7CiAgICAgICAgICByZWplY3QoZXJyb3IpOwogICAgICAgIH0gZWxz
        ZSBpZiAoYXJndW1lbnRzLmxlbmd0aCA+IDIpIHsKICAgICAgICAgIHJlc29s
        dmUoQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLCAxKSk7
        CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHJlc29sdmUodmFsdWUpOwog
        ICAgICAgIH0KICAgICAgfTsKICAgIH0KCiAgICBmdW5jdGlvbiBkZW5vZGVp
        Znkobm9kZUZ1bmMpIHsKICAgICAgcmV0dXJuIGZ1bmN0aW9uKCkgIHsKICAg
        ICAgICB2YXIgbm9kZUFyZ3MgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2Fs
        bChhcmd1bWVudHMpLCByZXNvbHZlLCByZWplY3Q7CiAgICAgICAgdmFyIHRo
        aXNBcmcgPSB0aGlzOwoKICAgICAgICB2YXIgcHJvbWlzZSA9IG5ldyBQcm9t
        aXNlKGZ1bmN0aW9uKG5vZGVSZXNvbHZlLCBub2RlUmVqZWN0KSB7CiAgICAg
        ICAgICByZXNvbHZlID0gbm9kZVJlc29sdmU7CiAgICAgICAgICByZWplY3Qg
        PSBub2RlUmVqZWN0OwogICAgICAgIH0pOwoKICAgICAgICBhbGwobm9kZUFy
        Z3MpLnRoZW4oZnVuY3Rpb24obm9kZUFyZ3MpIHsKICAgICAgICAgIG5vZGVB
        cmdzLnB1c2gobWFrZU5vZGVDYWxsYmFja0ZvcihyZXNvbHZlLCByZWplY3Qp
        KTsKCiAgICAgICAgICB0cnkgewogICAgICAgICAgICBub2RlRnVuYy5hcHBs
        eSh0aGlzQXJnLCBub2RlQXJncyk7CiAgICAgICAgICB9IGNhdGNoKGUpIHsK
        ICAgICAgICAgICAgcmVqZWN0KGUpOwogICAgICAgICAgfQogICAgICAgIH0p
        OwoKICAgICAgICByZXR1cm4gcHJvbWlzZTsKICAgICAgfTsKICAgIH0KCgog
        ICAgX19leHBvcnRzX18uZGVub2RlaWZ5ID0gZGVub2RlaWZ5OwogIH0pOwpk
        ZWZpbmUoInJzdnAvcHJvbWlzZSIsCiAgWyJyc3ZwL2NvbmZpZyIsInJzdnAv
        ZXZlbnRzIiwiZXhwb3J0cyJdLAogIGZ1bmN0aW9uKF9fZGVwZW5kZW5jeTFf
        XywgX19kZXBlbmRlbmN5Ml9fLCBfX2V4cG9ydHNfXykgewogICAgInVzZSBz
        dHJpY3QiOwogICAgdmFyIGNvbmZpZyA9IF9fZGVwZW5kZW5jeTFfXy5jb25m
        aWc7CiAgICB2YXIgRXZlbnRUYXJnZXQgPSBfX2RlcGVuZGVuY3kyX18uRXZl
        bnRUYXJnZXQ7CgogICAgZnVuY3Rpb24gb2JqZWN0T3JGdW5jdGlvbih4KSB7
        CiAgICAgIHJldHVybiBpc0Z1bmN0aW9uKHgpIHx8ICh0eXBlb2YgeCA9PT0g
        Im9iamVjdCIgJiYgeCAhPT0gbnVsbCk7CiAgICB9CgogICAgZnVuY3Rpb24g
        aXNGdW5jdGlvbih4KXsKICAgICAgcmV0dXJuIHR5cGVvZiB4ID09PSAiZnVu
        Y3Rpb24iOwogICAgfQoKICAgIHZhciBQcm9taXNlID0gZnVuY3Rpb24ocmVz
        b2x2ZXIpIHsKICAgICAgdmFyIHByb21pc2UgPSB0aGlzLAogICAgICByZXNv
        bHZlZCA9IGZhbHNlOwoKICAgICAgaWYgKHR5cGVvZiByZXNvbHZlciAhPT0g
        J2Z1bmN0aW9uJykgewogICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ1lv
        dSBtdXN0IHBhc3MgYSByZXNvbHZlciBmdW5jdGlvbiBhcyB0aGUgc29sZSBh
        cmd1bWVudCB0byB0aGUgcHJvbWlzZSBjb25zdHJ1Y3RvcicpOwogICAgICB9
        CgogICAgICBpZiAoIShwcm9taXNlIGluc3RhbmNlb2YgUHJvbWlzZSkpIHsK
        ICAgICAgICByZXR1cm4gbmV3IFByb21pc2UocmVzb2x2ZXIpOwogICAgICB9
        CgogICAgICB2YXIgcmVzb2x2ZVByb21pc2UgPSBmdW5jdGlvbih2YWx1ZSkg
        ewogICAgICAgIGlmIChyZXNvbHZlZCkgeyByZXR1cm47IH0KICAgICAgICBy
        ZXNvbHZlZCA9IHRydWU7CiAgICAgICAgcmVzb2x2ZShwcm9taXNlLCB2YWx1
        ZSk7CiAgICAgIH07CgogICAgICB2YXIgcmVqZWN0UHJvbWlzZSA9IGZ1bmN0
        aW9uKHZhbHVlKSB7CiAgICAgICAgaWYgKHJlc29sdmVkKSB7IHJldHVybjsg
        fQogICAgICAgIHJlc29sdmVkID0gdHJ1ZTsKICAgICAgICByZWplY3QocHJv
        bWlzZSwgdmFsdWUpOwogICAgICB9OwoKICAgICAgdGhpcy5vbigncHJvbWlz
        ZTpyZXNvbHZlZCcsIGZ1bmN0aW9uKGV2ZW50KSB7CiAgICAgICAgdGhpcy50
        cmlnZ2VyKCdzdWNjZXNzJywgeyBkZXRhaWw6IGV2ZW50LmRldGFpbCB9KTsK
        ICAgICAgfSwgdGhpcyk7CgogICAgICB0aGlzLm9uKCdwcm9taXNlOmZhaWxl
        ZCcsIGZ1bmN0aW9uKGV2ZW50KSB7CiAgICAgICAgdGhpcy50cmlnZ2VyKCdl
        cnJvcicsIHsgZGV0YWlsOiBldmVudC5kZXRhaWwgfSk7CiAgICAgIH0sIHRo
        aXMpOwoKICAgICAgdGhpcy5vbignZXJyb3InLCBvbmVycm9yKTsKCiAgICAg
        IHRyeSB7CiAgICAgICAgcmVzb2x2ZXIocmVzb2x2ZVByb21pc2UsIHJlamVj
        dFByb21pc2UpOwogICAgICB9IGNhdGNoKGUpIHsKICAgICAgICByZWplY3RQ
        cm9taXNlKGUpOwogICAgICB9CiAgICB9OwoKICAgIGZ1bmN0aW9uIG9uZXJy
        b3IoZXZlbnQpIHsKICAgICAgaWYgKGNvbmZpZy5vbmVycm9yKSB7CiAgICAg
        ICAgY29uZmlnLm9uZXJyb3IoZXZlbnQuZGV0YWlsKTsKICAgICAgfQogICAg
        fQoKICAgIHZhciBpbnZva2VDYWxsYmFjayA9IGZ1bmN0aW9uKHR5cGUsIHBy
        b21pc2UsIGNhbGxiYWNrLCBldmVudCkgewogICAgICB2YXIgaGFzQ2FsbGJh
        Y2sgPSBpc0Z1bmN0aW9uKGNhbGxiYWNrKSwKICAgICAgICAgIHZhbHVlLCBl
        cnJvciwgc3VjY2VlZGVkLCBmYWlsZWQ7CgogICAgICBpZiAoaGFzQ2FsbGJh
        Y2spIHsKICAgICAgICB0cnkgewogICAgICAgICAgdmFsdWUgPSBjYWxsYmFj
        ayhldmVudC5kZXRhaWwpOwogICAgICAgICAgc3VjY2VlZGVkID0gdHJ1ZTsK
        ICAgICAgICB9IGNhdGNoKGUpIHsKICAgICAgICAgIGZhaWxlZCA9IHRydWU7
        CiAgICAgICAgICBlcnJvciA9IGU7CiAgICAgICAgfQogICAgICB9IGVsc2Ug
        ewogICAgICAgIHZhbHVlID0gZXZlbnQuZGV0YWlsOwogICAgICAgIHN1Y2Nl
        ZWRlZCA9IHRydWU7CiAgICAgIH0KCiAgICAgIGlmIChoYW5kbGVUaGVuYWJs
        ZShwcm9taXNlLCB2YWx1ZSkpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0g
        ZWxzZSBpZiAoaGFzQ2FsbGJhY2sgJiYgc3VjY2VlZGVkKSB7CiAgICAgICAg
        cmVzb2x2ZShwcm9taXNlLCB2YWx1ZSk7CiAgICAgIH0gZWxzZSBpZiAoZmFp
        bGVkKSB7CiAgICAgICAgcmVqZWN0KHByb21pc2UsIGVycm9yKTsKICAgICAg
        fSBlbHNlIGlmICh0eXBlID09PSAncmVzb2x2ZScpIHsKICAgICAgICByZXNv
        bHZlKHByb21pc2UsIHZhbHVlKTsKICAgICAgfSBlbHNlIGlmICh0eXBlID09
        PSAncmVqZWN0JykgewogICAgICAgIHJlamVjdChwcm9taXNlLCB2YWx1ZSk7
        CiAgICAgIH0KICAgIH07CgogICAgUHJvbWlzZS5wcm90b3R5cGUgPSB7CiAg
        ICAgIGNvbnN0cnVjdG9yOiBQcm9taXNlLAoKICAgICAgaXNSZWplY3RlZDog
        dW5kZWZpbmVkLAogICAgICBpc0Z1bGZpbGxlZDogdW5kZWZpbmVkLAogICAg
        ICByZWplY3RlZFJlYXNvbjogdW5kZWZpbmVkLAogICAgICBmdWxmaWxsbWVu
        dFZhbHVlOiB1bmRlZmluZWQsCgogICAgICB0aGVuOiBmdW5jdGlvbihkb25l
        LCBmYWlsKSB7CiAgICAgICAgdGhpcy5vZmYoJ2Vycm9yJywgb25lcnJvcik7
        CgogICAgICAgIHZhciB0aGVuUHJvbWlzZSA9IG5ldyB0aGlzLmNvbnN0cnVj
        dG9yKGZ1bmN0aW9uKCkge30pOwoKICAgICAgICBpZiAodGhpcy5pc0Z1bGZp
        bGxlZCkgewogICAgICAgICAgY29uZmlnLmFzeW5jKGZ1bmN0aW9uKHByb21p
        c2UpIHsKICAgICAgICAgICAgaW52b2tlQ2FsbGJhY2soJ3Jlc29sdmUnLCB0
        aGVuUHJvbWlzZSwgZG9uZSwgeyBkZXRhaWw6IHByb21pc2UuZnVsZmlsbG1l
        bnRWYWx1ZSB9KTsKICAgICAgICAgIH0sIHRoaXMpOwogICAgICAgIH0KCiAg
        ICAgICAgaWYgKHRoaXMuaXNSZWplY3RlZCkgewogICAgICAgICAgY29uZmln
        LmFzeW5jKGZ1bmN0aW9uKHByb21pc2UpIHsKICAgICAgICAgICAgaW52b2tl
        Q2FsbGJhY2soJ3JlamVjdCcsIHRoZW5Qcm9taXNlLCBmYWlsLCB7IGRldGFp
        bDogcHJvbWlzZS5yZWplY3RlZFJlYXNvbiB9KTsKICAgICAgICAgIH0sIHRo
        aXMpOwogICAgICAgIH0KCiAgICAgICAgdGhpcy5vbigncHJvbWlzZTpyZXNv
        bHZlZCcsIGZ1bmN0aW9uKGV2ZW50KSB7CiAgICAgICAgICBpbnZva2VDYWxs
        YmFjaygncmVzb2x2ZScsIHRoZW5Qcm9taXNlLCBkb25lLCBldmVudCk7CiAg
        ICAgICAgfSk7CgogICAgICAgIHRoaXMub24oJ3Byb21pc2U6ZmFpbGVkJywg
        ZnVuY3Rpb24oZXZlbnQpIHsKICAgICAgICAgIGludm9rZUNhbGxiYWNrKCdy
        ZWplY3QnLCB0aGVuUHJvbWlzZSwgZmFpbCwgZXZlbnQpOwogICAgICAgIH0p
        OwoKICAgICAgICByZXR1cm4gdGhlblByb21pc2U7CiAgICAgIH0sCgogICAg
        ICBmYWlsOiBmdW5jdGlvbihmYWlsKSB7CiAgICAgICAgcmV0dXJuIHRoaXMu
        dGhlbihudWxsLCBmYWlsKTsKICAgICAgfQogICAgfTsKCiAgICBFdmVudFRh
        cmdldC5taXhpbihQcm9taXNlLnByb3RvdHlwZSk7CgogICAgZnVuY3Rpb24g
        cmVzb2x2ZShwcm9taXNlLCB2YWx1ZSkgewogICAgICBpZiAocHJvbWlzZSA9
        PT0gdmFsdWUpIHsKICAgICAgICBmdWxmaWxsKHByb21pc2UsIHZhbHVlKTsK
        ICAgICAgfSBlbHNlIGlmICghaGFuZGxlVGhlbmFibGUocHJvbWlzZSwgdmFs
        dWUpKSB7CiAgICAgICAgZnVsZmlsbChwcm9taXNlLCB2YWx1ZSk7CiAgICAg
        IH0KICAgIH0KCiAgICBmdW5jdGlvbiBoYW5kbGVUaGVuYWJsZShwcm9taXNl
        LCB2YWx1ZSkgewogICAgICB2YXIgdGhlbiA9IG51bGwsCiAgICAgIHJlc29s
        dmVkOwoKICAgICAgdHJ5IHsKICAgICAgICBpZiAocHJvbWlzZSA9PT0gdmFs
        dWUpIHsKICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoIkEgcHJvbWlz
        ZXMgY2FsbGJhY2sgY2Fubm90IHJldHVybiB0aGF0IHNhbWUgcHJvbWlzZS4i
        KTsKICAgICAgICB9CgogICAgICAgIGlmIChvYmplY3RPckZ1bmN0aW9uKHZh
        bHVlKSkgewogICAgICAgICAgdGhlbiA9IHZhbHVlLnRoZW47CgogICAgICAg
        ICAgaWYgKGlzRnVuY3Rpb24odGhlbikpIHsKICAgICAgICAgICAgdGhlbi5j
        YWxsKHZhbHVlLCBmdW5jdGlvbih2YWwpIHsKICAgICAgICAgICAgICBpZiAo
        cmVzb2x2ZWQpIHsgcmV0dXJuIHRydWU7IH0KICAgICAgICAgICAgICByZXNv
        bHZlZCA9IHRydWU7CgogICAgICAgICAgICAgIGlmICh2YWx1ZSAhPT0gdmFs
        KSB7CiAgICAgICAgICAgICAgICByZXNvbHZlKHByb21pc2UsIHZhbCk7CiAg
        ICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGZ1bGZpbGwo
        cHJvbWlzZSwgdmFsKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0s
        IGZ1bmN0aW9uKHZhbCkgewogICAgICAgICAgICAgIGlmIChyZXNvbHZlZCkg
        eyByZXR1cm4gdHJ1ZTsgfQogICAgICAgICAgICAgIHJlc29sdmVkID0gdHJ1
        ZTsKCiAgICAgICAgICAgICAgcmVqZWN0KHByb21pc2UsIHZhbCk7CiAgICAg
        ICAgICAgIH0pOwoKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAg
        ICB9CiAgICAgICAgfQogICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAg
        IHJlamVjdChwcm9taXNlLCBlcnJvcik7CiAgICAgICAgcmV0dXJuIHRydWU7
        CiAgICAgIH0KCiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICBmdW5j
        dGlvbiBmdWxmaWxsKHByb21pc2UsIHZhbHVlKSB7CiAgICAgIGNvbmZpZy5h
        c3luYyhmdW5jdGlvbigpIHsKICAgICAgICBwcm9taXNlLnRyaWdnZXIoJ3By
        b21pc2U6cmVzb2x2ZWQnLCB7IGRldGFpbDogdmFsdWUgfSk7CiAgICAgICAg
        cHJvbWlzZS5pc0Z1bGZpbGxlZCA9IHRydWU7CiAgICAgICAgcHJvbWlzZS5m
        dWxmaWxsbWVudFZhbHVlID0gdmFsdWU7CiAgICAgIH0pOwogICAgfQoKICAg
        IGZ1bmN0aW9uIHJlamVjdChwcm9taXNlLCB2YWx1ZSkgewogICAgICBjb25m
        aWcuYXN5bmMoZnVuY3Rpb24oKSB7CiAgICAgICAgcHJvbWlzZS50cmlnZ2Vy
        KCdwcm9taXNlOmZhaWxlZCcsIHsgZGV0YWlsOiB2YWx1ZSB9KTsKICAgICAg
        ICBwcm9taXNlLmlzUmVqZWN0ZWQgPSB0cnVlOwogICAgICAgIHByb21pc2Uu
        cmVqZWN0ZWRSZWFzb24gPSB2YWx1ZTsKICAgICAgfSk7CiAgICB9CgoKICAg
        IF9fZXhwb3J0c19fLlByb21pc2UgPSBQcm9taXNlOwogIH0pOwpkZWZpbmUo
        InJzdnAvcmVqZWN0IiwKICBbInJzdnAvcHJvbWlzZSIsImV4cG9ydHMiXSwK
        ICBmdW5jdGlvbihfX2RlcGVuZGVuY3kxX18sIF9fZXhwb3J0c19fKSB7CiAg
        ICAidXNlIHN0cmljdCI7CiAgICB2YXIgUHJvbWlzZSA9IF9fZGVwZW5kZW5j
        eTFfXy5Qcm9taXNlOwoKICAgIGZ1bmN0aW9uIHJlamVjdChyZWFzb24pIHsK
        ICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCBy
        ZWplY3QpIHsKICAgICAgICByZWplY3QocmVhc29uKTsKICAgICAgfSk7CiAg
        ICB9CgoKICAgIF9fZXhwb3J0c19fLnJlamVjdCA9IHJlamVjdDsKICB9KTsK
        ZGVmaW5lKCJyc3ZwL3Jlc29sdmUiLAogIFsicnN2cC9wcm9taXNlIiwiZXhw
        b3J0cyJdLAogIGZ1bmN0aW9uKF9fZGVwZW5kZW5jeTFfXywgX19leHBvcnRz
        X18pIHsKICAgICJ1c2Ugc3RyaWN0IjsKICAgIHZhciBQcm9taXNlID0gX19k
        ZXBlbmRlbmN5MV9fLlByb21pc2U7CgogICAgZnVuY3Rpb24gcmVzb2x2ZSh0
        aGVuYWJsZSkgewogICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24o
        cmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgICAgcmVzb2x2ZSh0aGVuYWJsZSk7
        CiAgICAgIH0pOwogICAgfQoKCiAgICBfX2V4cG9ydHNfXy5yZXNvbHZlID0g
        cmVzb2x2ZTsKICB9KTsKZGVmaW5lKCJyc3ZwL3JldGhyb3ciLAogIFsiZXhw
        b3J0cyJdLAogIGZ1bmN0aW9uKF9fZXhwb3J0c19fKSB7CiAgICAidXNlIHN0
        cmljdCI7CiAgICB2YXIgbG9jYWwgPSAodHlwZW9mIGdsb2JhbCA9PT0gInVu
        ZGVmaW5lZCIpID8gdGhpcyA6IGdsb2JhbDsKCiAgICBmdW5jdGlvbiByZXRo
        cm93KHJlYXNvbikgewogICAgICBsb2NhbC5zZXRUaW1lb3V0KGZ1bmN0aW9u
        KCkgewogICAgICAgIHRocm93IHJlYXNvbjsKICAgICAgfSk7CiAgICAgIHRo
        cm93IHJlYXNvbjsKICAgIH0KCgogICAgX19leHBvcnRzX18ucmV0aHJvdyA9
        IHJldGhyb3c7CiAgfSk7CmRlZmluZSgicnN2cCIsCiAgWyJyc3ZwL2V2ZW50
        cyIsInJzdnAvcHJvbWlzZSIsInJzdnAvbm9kZSIsInJzdnAvYWxsIiwicnN2
        cC9oYXNoIiwicnN2cC9yZXRocm93IiwicnN2cC9kZWZlciIsInJzdnAvY29u
        ZmlnIiwicnN2cC9yZXNvbHZlIiwicnN2cC9yZWplY3QiLCJleHBvcnRzIl0s
        CiAgZnVuY3Rpb24oX19kZXBlbmRlbmN5MV9fLCBfX2RlcGVuZGVuY3kyX18s
        IF9fZGVwZW5kZW5jeTNfXywgX19kZXBlbmRlbmN5NF9fLCBfX2RlcGVuZGVu
        Y3k1X18sIF9fZGVwZW5kZW5jeTZfXywgX19kZXBlbmRlbmN5N19fLCBfX2Rl
        cGVuZGVuY3k4X18sIF9fZGVwZW5kZW5jeTlfXywgX19kZXBlbmRlbmN5MTBf
        XywgX19leHBvcnRzX18pIHsKICAgICJ1c2Ugc3RyaWN0IjsKICAgIHZhciBF
        dmVudFRhcmdldCA9IF9fZGVwZW5kZW5jeTFfXy5FdmVudFRhcmdldDsKICAg
        IHZhciBQcm9taXNlID0gX19kZXBlbmRlbmN5Ml9fLlByb21pc2U7CiAgICB2
        YXIgZGVub2RlaWZ5ID0gX19kZXBlbmRlbmN5M19fLmRlbm9kZWlmeTsKICAg
        IHZhciBhbGwgPSBfX2RlcGVuZGVuY3k0X18uYWxsOwogICAgdmFyIGhhc2gg
        PSBfX2RlcGVuZGVuY3k1X18uaGFzaDsKICAgIHZhciByZXRocm93ID0gX19k
        ZXBlbmRlbmN5Nl9fLnJldGhyb3c7CiAgICB2YXIgZGVmZXIgPSBfX2RlcGVu
        ZGVuY3k3X18uZGVmZXI7CiAgICB2YXIgY29uZmlnID0gX19kZXBlbmRlbmN5
        OF9fLmNvbmZpZzsKICAgIHZhciByZXNvbHZlID0gX19kZXBlbmRlbmN5OV9f
        LnJlc29sdmU7CiAgICB2YXIgcmVqZWN0ID0gX19kZXBlbmRlbmN5MTBfXy5y
        ZWplY3Q7CgogICAgZnVuY3Rpb24gY29uZmlndXJlKG5hbWUsIHZhbHVlKSB7
        CiAgICAgIGNvbmZpZ1tuYW1lXSA9IHZhbHVlOwogICAgfQoKCiAgICBfX2V4
        cG9ydHNfXy5Qcm9taXNlID0gUHJvbWlzZTsKICAgIF9fZXhwb3J0c19fLkV2
        ZW50VGFyZ2V0ID0gRXZlbnRUYXJnZXQ7CiAgICBfX2V4cG9ydHNfXy5hbGwg
        PSBhbGw7CiAgICBfX2V4cG9ydHNfXy5oYXNoID0gaGFzaDsKICAgIF9fZXhw
        b3J0c19fLnJldGhyb3cgPSByZXRocm93OwogICAgX19leHBvcnRzX18uZGVm
        ZXIgPSBkZWZlcjsKICAgIF9fZXhwb3J0c19fLmRlbm9kZWlmeSA9IGRlbm9k
        ZWlmeTsKICAgIF9fZXhwb3J0c19fLmNvbmZpZ3VyZSA9IGNvbmZpZ3VyZTsK
        ICAgIF9fZXhwb3J0c19fLnJlc29sdmUgPSByZXNvbHZlOwogICAgX19leHBv
        cnRzX18ucmVqZWN0ID0gcmVqZWN0OwogIH0pOwp9KSgpOwoKKGZ1bmN0aW9u
        KCkgewovKioKQHByaXZhdGUKUHVibGljIGFwaSBmb3IgdGhlIGNvbnRhaW5l
        ciBpcyBzdGlsbCBpbiBmbHV4LgpUaGUgcHVibGljIGFwaSwgc3BlY2lmaWVk
        IG9uIHRoZSBhcHBsaWNhdGlvbiBuYW1lc3BhY2Ugc2hvdWxkIGJlIGNvbnNp
        ZGVyZWQgdGhlIHN0YWJsZSBhcGkuCi8vIEBtb2R1bGUgY29udGFpbmVyCiov
        CgovKgogRmxhZyB0byBlbmFibGUvZGlzYWJsZSBtb2RlbCBmYWN0b3J5IGlu
        amVjdGlvbnMgKGRpc2FibGVkIGJ5IGRlZmF1bHQpCiBJZiBtb2RlbCBmYWN0
        b3J5IGluamVjdGlvbnMgYXJlIGVuYWJsZWQsIG1vZGVscyBzaG91bGQgbm90
        IGJlCiBhY2Nlc3NlZCBnbG9iYWxseSAob25seSB0aHJvdWdoIGBjb250YWlu
        ZXIubG9va3VwRmFjdG9yeSgnbW9kZWw6bW9kZWxOYW1lJykpYCk7CiovCkVt
        YmVyLk1PREVMX0ZBQ1RPUllfSU5KRUNUSU9OUyA9IGZhbHNlIHx8ICEhRW1i
        ZXIuRU5WLk1PREVMX0ZBQ1RPUllfSU5KRUNUSU9OUzsKCmRlZmluZSgiY29u
        dGFpbmVyIiwKICBbXSwKICBmdW5jdGlvbigpIHsKCiAgICAvLyBBIHNhZmUg
        YW5kIHNpbXBsZSBpbmhlcml0aW5nIG9iamVjdC4KICAgIGZ1bmN0aW9uIElu
        aGVyaXRpbmdEaWN0KHBhcmVudCkgewogICAgICB0aGlzLnBhcmVudCA9IHBh
        cmVudDsKICAgICAgdGhpcy5kaWN0ID0ge307CiAgICB9CgogICAgSW5oZXJp
        dGluZ0RpY3QucHJvdG90eXBlID0gewoKICAgICAgLyoqCiAgICAgICAgQHBy
        b3BlcnR5IHBhcmVudAogICAgICAgIEB0eXBlIEluaGVyaXRpbmdEaWN0CiAg
        ICAgICAgQGRlZmF1bHQgbnVsbAogICAgICAqLwoKICAgICAgcGFyZW50OiBu
        dWxsLAoKICAgICAgLyoqCiAgICAgICAgT2JqZWN0IHVzZWQgdG8gc3RvcmUg
        dGhlIGN1cnJlbnQgbm9kZXMgZGF0YS4KCiAgICAgICAgQHByb3BlcnR5IGRp
        Y3QKICAgICAgICBAdHlwZSBPYmplY3QKICAgICAgICBAZGVmYXVsdCBPYmpl
        Y3QKICAgICAgKi8KICAgICAgZGljdDogbnVsbCwKCiAgICAgIC8qKgogICAg
        ICAgIFJldHJpZXZlIHRoZSB2YWx1ZSBnaXZlbiBhIGtleSwgaWYgdGhlIHZh
        bHVlIGlzIHByZXNlbnQgYXQgdGhlIGN1cnJlbnQKICAgICAgICBsZXZlbCB1
        c2UgaXQsIG90aGVyd2lzZSB3YWxrIHVwIHRoZSBwYXJlbnQgaGllcmFyY2h5
        IGFuZCB0cnkgYWdhaW4uIElmCiAgICAgICAgbm8gbWF0Y2hpbmcga2V5IGlz
        IGZvdW5kLCByZXR1cm4gdW5kZWZpbmVkLgoKICAgICAgICBAbWV0aG9kIGdl
        dAogICAgICAgIEByZXR1cm4ge2FueX0KICAgICAgKi8KICAgICAgZ2V0OiBm
        dW5jdGlvbihrZXkpIHsKICAgICAgICB2YXIgZGljdCA9IHRoaXMuZGljdDsK
        CiAgICAgICAgaWYgKGRpY3QuaGFzT3duUHJvcGVydHkoa2V5KSkgewogICAg
        ICAgICAgcmV0dXJuIGRpY3Rba2V5XTsKICAgICAgICB9CgogICAgICAgIGlm
        ICh0aGlzLnBhcmVudCkgewogICAgICAgICAgcmV0dXJuIHRoaXMucGFyZW50
        LmdldChrZXkpOwogICAgICAgIH0KICAgICAgfSwKCiAgICAgIC8qKgogICAg
        ICAgIFNldCB0aGUgZ2l2ZW4gdmFsdWUgZm9yIHRoZSBnaXZlbiBrZXksIGF0
        IHRoZSBjdXJyZW50IGxldmVsLgoKICAgICAgICBAbWV0aG9kIHNldAogICAg
        ICAgIEBwYXJhbSB7U3RyaW5nfSBrZXkKICAgICAgICBAcGFyYW0ge0FueX0g
        dmFsdWUKICAgICAgKi8KICAgICAgc2V0OiBmdW5jdGlvbihrZXksIHZhbHVl
        KSB7CiAgICAgICAgdGhpcy5kaWN0W2tleV0gPSB2YWx1ZTsKICAgICAgfSwK
        CiAgICAgIC8qKgogICAgICAgIERlbGV0ZSB0aGUgZ2l2ZW4ga2V5CgogICAg
        ICAgIEBtZXRob2QgcmVtb3ZlCiAgICAgICAgQHBhcmFtIHtTdHJpbmd9IGtl
        eQogICAgICAqLwogICAgICByZW1vdmU6IGZ1bmN0aW9uKGtleSkgewogICAg
        ICAgIGRlbGV0ZSB0aGlzLmRpY3Rba2V5XTsKICAgICAgfSwKCiAgICAgIC8q
        KgogICAgICAgIENoZWNrIGZvciB0aGUgZXhpc3RlbmNlIG9mIGdpdmVuIGEg
        a2V5LCBpZiB0aGUga2V5IGlzIHByZXNlbnQgYXQgdGhlIGN1cnJlbnQKICAg
        ICAgICBsZXZlbCByZXR1cm4gdHJ1ZSwgb3RoZXJ3aXNlIHdhbGsgdXAgdGhl
        IHBhcmVudCBoaWVyYXJjaHkgYW5kIHRyeSBhZ2Fpbi4gSWYKICAgICAgICBu
        byBtYXRjaGluZyBrZXkgaXMgZm91bmQsIHJldHVybiBmYWxzZS4KCiAgICAg
        ICAgQG1ldGhvZCBoYXMKICAgICAgICBAcGFyYW0ge1N0cmluZ30ga2V5CiAg
        ICAgICAgQHJldHVybiB7Qm9vbGVhbn0KICAgICAgKi8KICAgICAgaGFzOiBm
        dW5jdGlvbihrZXkpIHsKICAgICAgICB2YXIgZGljdCA9IHRoaXMuZGljdDsK
        CiAgICAgICAgaWYgKGRpY3QuaGFzT3duUHJvcGVydHkoa2V5KSkgewogICAg
        ICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQoKICAgICAgICBpZiAodGhp
        cy5wYXJlbnQpIHsKICAgICAgICAgIHJldHVybiB0aGlzLnBhcmVudC5oYXMo
        a2V5KTsKICAgICAgICB9CgogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAg
        fSwKCiAgICAgIC8qKgogICAgICAgIEl0ZXJhdGUgYW5kIGludm9rZSBhIGNh
        bGxiYWNrIGZvciBlYWNoIGxvY2FsIGtleS12YWx1ZSBwYWlyLgoKICAgICAg
        ICBAbWV0aG9kIGVhY2hMb2NhbAogICAgICAgIEBwYXJhbSB7RnVuY3Rpb259
        IGNhbGxiYWNrCiAgICAgICAgQHBhcmFtIHtPYmplY3R9IGJpbmRpbmcKICAg
        ICAgKi8KICAgICAgZWFjaExvY2FsOiBmdW5jdGlvbihjYWxsYmFjaywgYmlu
        ZGluZykgewogICAgICAgIHZhciBkaWN0ID0gdGhpcy5kaWN0OwoKICAgICAg
        ICBmb3IgKHZhciBwcm9wIGluIGRpY3QpIHsKICAgICAgICAgIGlmIChkaWN0
        Lmhhc093blByb3BlcnR5KHByb3ApKSB7CiAgICAgICAgICAgIGNhbGxiYWNr
        LmNhbGwoYmluZGluZywgcHJvcCwgZGljdFtwcm9wXSk7CiAgICAgICAgICB9
        CiAgICAgICAgfQogICAgICB9CiAgICB9OwoKCiAgICAvLyBBIGxpZ2h0d2Vp
        Z2h0IGNvbnRhaW5lciB0aGF0IGhlbHBzIHRvIGFzc2VtYmxlIGFuZCBkZWNv
        dXBsZSBjb21wb25lbnRzLgogICAgLy8gUHVibGljIGFwaSBmb3IgdGhlIGNv
        bnRhaW5lciBpcyBzdGlsbCBpbiBmbHV4LgogICAgLy8gVGhlIHB1YmxpYyBh
        cGksIHNwZWNpZmllZCBvbiB0aGUgYXBwbGljYXRpb24gbmFtZXNwYWNlIHNo
        b3VsZCBiZSBjb25zaWRlcmVkIHRoZSBzdGFibGUgYXBpLgogICAgZnVuY3Rp
        b24gQ29udGFpbmVyKHBhcmVudCkgewogICAgICB0aGlzLnBhcmVudCA9IHBh
        cmVudDsKICAgICAgdGhpcy5jaGlsZHJlbiA9IFtdOwoKICAgICAgdGhpcy5y
        ZXNvbHZlciA9IHBhcmVudCAmJiBwYXJlbnQucmVzb2x2ZXIgfHwgZnVuY3Rp
        b24oKSB7fTsKCiAgICAgIHRoaXMucmVnaXN0cnkgPSBuZXcgSW5oZXJpdGlu
        Z0RpY3QocGFyZW50ICYmIHBhcmVudC5yZWdpc3RyeSk7CiAgICAgIHRoaXMu
        Y2FjaGUgPSBuZXcgSW5oZXJpdGluZ0RpY3QocGFyZW50ICYmIHBhcmVudC5j
        YWNoZSk7CiAgICAgIHRoaXMuZmFjdG9yeUNhY2hlID0gbmV3IEluaGVyaXRp
        bmdEaWN0KHBhcmVudCAmJiBwYXJlbnQuY2FjaGUpOwogICAgICB0aGlzLnR5
        cGVJbmplY3Rpb25zID0gbmV3IEluaGVyaXRpbmdEaWN0KHBhcmVudCAmJiBw
        YXJlbnQudHlwZUluamVjdGlvbnMpOwogICAgICB0aGlzLmluamVjdGlvbnMg
        PSB7fTsKCiAgICAgIHRoaXMuZmFjdG9yeVR5cGVJbmplY3Rpb25zID0gbmV3
        IEluaGVyaXRpbmdEaWN0KHBhcmVudCAmJiBwYXJlbnQuZmFjdG9yeVR5cGVJ
        bmplY3Rpb25zKTsKICAgICAgdGhpcy5mYWN0b3J5SW5qZWN0aW9ucyA9IHt9
        OwoKICAgICAgdGhpcy5fb3B0aW9ucyA9IG5ldyBJbmhlcml0aW5nRGljdChw
        YXJlbnQgJiYgcGFyZW50Ll9vcHRpb25zKTsKICAgICAgdGhpcy5fdHlwZU9w
        dGlvbnMgPSBuZXcgSW5oZXJpdGluZ0RpY3QocGFyZW50ICYmIHBhcmVudC5f
        dHlwZU9wdGlvbnMpOwogICAgfQoKICAgIENvbnRhaW5lci5wcm90b3R5cGUg
        PSB7CgogICAgICAvKioKICAgICAgICBAcHJvcGVydHkgcGFyZW50CiAgICAg
        ICAgQHR5cGUgQ29udGFpbmVyCiAgICAgICAgQGRlZmF1bHQgbnVsbAogICAg
        ICAqLwogICAgICBwYXJlbnQ6IG51bGwsCgogICAgICAvKioKICAgICAgICBA
        cHJvcGVydHkgY2hpbGRyZW4KICAgICAgICBAdHlwZSBBcnJheQogICAgICAg
        IEBkZWZhdWx0IFtdCiAgICAgICovCiAgICAgIGNoaWxkcmVuOiBudWxsLAoK
        ICAgICAgLyoqCiAgICAgICAgQHByb3BlcnR5IHJlc29sdmVyCiAgICAgICAg
        QHR5cGUgZnVuY3Rpb24KICAgICAgKi8KICAgICAgcmVzb2x2ZXI6IG51bGws
        CgogICAgICAvKioKICAgICAgICBAcHJvcGVydHkgcmVnaXN0cnkKICAgICAg
        ICBAdHlwZSBJbmhlcml0aW5nRGljdAogICAgICAqLwogICAgICByZWdpc3Ry
        eTogbnVsbCwKCiAgICAgIC8qKgogICAgICAgIEBwcm9wZXJ0eSBjYWNoZQog
        ICAgICAgIEB0eXBlIEluaGVyaXRpbmdEaWN0CiAgICAgICovCiAgICAgIGNh
        Y2hlOiBudWxsLAoKICAgICAgLyoqCiAgICAgICAgQHByb3BlcnR5IHR5cGVJ
        bmplY3Rpb25zCiAgICAgICAgQHR5cGUgSW5oZXJpdGluZ0RpY3QKICAgICAg
        Ki8KICAgICAgdHlwZUluamVjdGlvbnM6IG51bGwsCgogICAgICAvKioKICAg
        ICAgICBAcHJvcGVydHkgaW5qZWN0aW9ucwogICAgICAgIEB0eXBlIE9iamVj
        dAogICAgICAgIEBkZWZhdWx0IHt9CiAgICAgICovCiAgICAgIGluamVjdGlv
        bnM6IG51bGwsCgogICAgICAvKioKICAgICAgICBAcHJpdmF0ZQoKICAgICAg
        ICBAcHJvcGVydHkgX29wdGlvbnMKICAgICAgICBAdHlwZSBJbmhlcml0aW5n
        RGljdAogICAgICAgIEBkZWZhdWx0IG51bGwKICAgICAgKi8KICAgICAgX29w
        dGlvbnM6IG51bGwsCgogICAgICAvKioKICAgICAgICBAcHJpdmF0ZQoKICAg
        ICAgICBAcHJvcGVydHkgX3R5cGVPcHRpb25zCiAgICAgICAgQHR5cGUgSW5o
        ZXJpdGluZ0RpY3QKICAgICAgKi8KICAgICAgX3R5cGVPcHRpb25zOiBudWxs
        LAoKICAgICAgLyoqCiAgICAgICAgUmV0dXJucyBhIG5ldyBjaGlsZCBvZiB0
        aGUgY3VycmVudCBjb250YWluZXIuIFRoZXNlIGNoaWxkcmVuIGFyZSBjb25m
        aWd1cmVkCiAgICAgICAgdG8gY29ycmVjdGx5IGluaGVyaXQgZnJvbSB0aGUg
        Y3VycmVudCBjb250YWluZXIuCgogICAgICAgIEBtZXRob2QgY2hpbGQKICAg
        ICAgICBAcmV0dXJuIHtDb250YWluZXJ9CiAgICAgICovCiAgICAgIGNoaWxk
        OiBmdW5jdGlvbigpIHsKICAgICAgICB2YXIgY29udGFpbmVyID0gbmV3IENv
        bnRhaW5lcih0aGlzKTsKICAgICAgICB0aGlzLmNoaWxkcmVuLnB1c2goY29u
        dGFpbmVyKTsKICAgICAgICByZXR1cm4gY29udGFpbmVyOwogICAgICB9LAoK
        ICAgICAgLyoqCiAgICAgICAgU2V0cyBhIGtleS12YWx1ZSBwYWlyIG9uIHRo
        ZSBjdXJyZW50IGNvbnRhaW5lci4gSWYgYSBwYXJlbnQgY29udGFpbmVyLAog
        ICAgICAgIGhhcyB0aGUgc2FtZSBrZXksIG9uY2Ugc2V0IG9uIGEgY2hpbGQs
        IHRoZSBwYXJlbnQgYW5kIGNoaWxkIHdpbGwgZGl2ZXJnZQogICAgICAgIGFz
        IGV4cGVjdGVkLgoKICAgICAgICBAbWV0aG9kIHNldAogICAgICAgIEBwYXJh
        bSB7T2JqZWN0fSBvYmplY3QKICAgICAgICBAcGFyYW0ge1N0cmluZ30ga2V5
        CiAgICAgICAgQHBhcmFtIHthbnl9IHZhbHVlCiAgICAgICovCiAgICAgIHNl
        dDogZnVuY3Rpb24ob2JqZWN0LCBrZXksIHZhbHVlKSB7CiAgICAgICAgb2Jq
        ZWN0W2tleV0gPSB2YWx1ZTsKICAgICAgfSwKCiAgICAgIC8qKgogICAgICAg
        IFJlZ2lzdGVycyBhIGZhY3RvcnkgZm9yIGxhdGVyIGluamVjdGlvbi4KCiAg
        ICAgICAgRXhhbXBsZToKCiAgICAgICAgYGBgamF2YXNjcmlwdAogICAgICAg
        IHZhciBjb250YWluZXIgPSBuZXcgQ29udGFpbmVyKCk7CgogICAgICAgIGNv
        bnRhaW5lci5yZWdpc3RlcignbW9kZWw6dXNlcicsIFBlcnNvbiwge3Npbmds
        ZXRvbjogZmFsc2UgfSk7CiAgICAgICAgY29udGFpbmVyLnJlZ2lzdGVyKCdm
        cnVpdDpmYXZvcml0ZScsIE9yYW5nZSk7CiAgICAgICAgY29udGFpbmVyLnJl
        Z2lzdGVyKCdjb21tdW5pY2F0aW9uOm1haW4nLCBFbWFpbCwge3NpbmdsZXRv
        bjogZmFsc2V9KTsKICAgICAgICBgYGAKCiAgICAgICAgQG1ldGhvZCByZWdp
        c3RlcgogICAgICAgIEBwYXJhbSB7U3RyaW5nfSBmdWxsTmFtZQogICAgICAg
        IEBwYXJhbSB7RnVuY3Rpb259IGZhY3RvcnkKICAgICAgICBAcGFyYW0ge09i
        amVjdH0gb3B0aW9ucwogICAgICAqLwogICAgICByZWdpc3RlcjogZnVuY3Rp
        b24oZnVsbE5hbWUsIGZhY3RvcnksIG9wdGlvbnMpIHsKICAgICAgICBpZiAo
        ZnVsbE5hbWUuaW5kZXhPZignOicpID09PSAtMSkgewogICAgICAgICAgdGhy
        b3cgbmV3IFR5cGVFcnJvcigibWFsZm9ybWVkIGZ1bGxOYW1lLCBleHBlY3Rl
        ZDogYHR5cGU6bmFtZWAgZ290OiAiICsgZnVsbE5hbWUgKyAiIik7CiAgICAg
        ICAgfQoKICAgICAgICBpZiAoZmFjdG9yeSA9PT0gdW5kZWZpbmVkKSB7CiAg
        ICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdBdHRlbXB0aW5nIHRvIHJl
        Z2lzdGVyIGFuIHVua25vd24gZmFjdG9yeTogYCcgKyBmdWxsTmFtZSArICdg
        Jyk7CiAgICAgICAgfQoKICAgICAgICB2YXIgbm9ybWFsaXplZE5hbWUgPSB0
        aGlzLm5vcm1hbGl6ZShmdWxsTmFtZSk7CgogICAgICAgIGlmICh0aGlzLmNh
        Y2hlLmhhcyhub3JtYWxpemVkTmFtZSkpIHsKICAgICAgICAgIHRocm93IG5l
        dyBFcnJvcignQ2Fubm90IHJlLXJlZ2lzdGVyOiBgJyArIGZ1bGxOYW1lICsn
        YCwgYXMgaXQgaGFzIGFscmVhZHkgYmVlbiBsb29rZWQgdXAuJyk7CiAgICAg
        ICAgfQoKICAgICAgICB0aGlzLnJlZ2lzdHJ5LnNldChub3JtYWxpemVkTmFt
        ZSwgZmFjdG9yeSk7CiAgICAgICAgdGhpcy5fb3B0aW9ucy5zZXQobm9ybWFs
        aXplZE5hbWUsIG9wdGlvbnMgfHwge30pOwogICAgICB9LAoKICAgICAgLyoq
        CiAgICAgICAgVW5yZWdpc3RlciBhIGZ1bGxOYW1lCgogICAgICAgIGBgYGph
        dmFzY3JpcHQKICAgICAgICB2YXIgY29udGFpbmVyID0gbmV3IENvbnRhaW5l
        cigpOwogICAgICAgIGNvbnRhaW5lci5yZWdpc3RlcignbW9kZWw6dXNlcics
        IFVzZXIpOwoKICAgICAgICBjb250YWluZXIubG9va3VwKCdtb2RlbDp1c2Vy
        JykgaW5zdGFuY2VvZiBVc2VyIC8vPT4gdHJ1ZQoKICAgICAgICBjb250YWlu
        ZXIudW5yZWdpc3RlcignbW9kZWw6dXNlcicpCiAgICAgICAgY29udGFpbmVy
        Lmxvb2t1cCgnbW9kZWw6dXNlcicpID09PSB1bmRlZmluZWQgLy89PiB0cnVl
        CiAgICAgICAgYGBgCgogICAgICAgIEBtZXRob2QgdW5yZWdpc3RlcgogICAg
        ICAgIEBwYXJhbSB7U3RyaW5nfSBmdWxsTmFtZQogICAgICAgKi8KICAgICAg
        dW5yZWdpc3RlcjogZnVuY3Rpb24oZnVsbE5hbWUpIHsKICAgICAgICB2YXIg
        bm9ybWFsaXplZE5hbWUgPSB0aGlzLm5vcm1hbGl6ZShmdWxsTmFtZSk7Cgog
        ICAgICAgIHRoaXMucmVnaXN0cnkucmVtb3ZlKG5vcm1hbGl6ZWROYW1lKTsK
        ICAgICAgICB0aGlzLmNhY2hlLnJlbW92ZShub3JtYWxpemVkTmFtZSk7CiAg
        ICAgICAgdGhpcy5mYWN0b3J5Q2FjaGUucmVtb3ZlKG5vcm1hbGl6ZWROYW1l
        KTsKICAgICAgICB0aGlzLl9vcHRpb25zLnJlbW92ZShub3JtYWxpemVkTmFt
        ZSk7CiAgICAgIH0sCgogICAgICAvKioKICAgICAgICBHaXZlbiBhIGZ1bGxO
        YW1lIHJldHVybiB0aGUgY29ycmVzcG9uZGluZyBmYWN0b3J5LgoKICAgICAg
        ICBCeSBkZWZhdWx0IGByZXNvbHZlYCB3aWxsIHJldHJpZXZlIHRoZSBmYWN0
        b3J5IGZyb20KICAgICAgICBpdHMgY29udGFpbmVyJ3MgcmVnaXN0cnkuCgog
        ICAgICAgIGBgYGphdmFzY3JpcHQKICAgICAgICB2YXIgY29udGFpbmVyID0g
        bmV3IENvbnRhaW5lcigpOwogICAgICAgIGNvbnRhaW5lci5yZWdpc3Rlcign
        YXBpOnR3aXR0ZXInLCBUd2l0dGVyKTsKCiAgICAgICAgY29udGFpbmVyLnJl
        c29sdmUoJ2FwaTp0d2l0dGVyJykgLy8gPT4gVHdpdHRlcgogICAgICAgIGBg
        YAoKICAgICAgICBPcHRpb25hbGx5IHRoZSBjb250YWluZXIgY2FuIGJlIHBy
        b3ZpZGVkIHdpdGggYSBjdXN0b20gcmVzb2x2ZXIuCiAgICAgICAgSWYgcHJv
        dmlkZWQsIGByZXNvbHZlYCB3aWxsIGZpcnN0IHByb3ZpZGUgdGhlIGN1c3Rv
        bSByZXNvbHZlcgogICAgICAgIHRoZSBvcHBlcnR1bml0eSB0byByZXNvbHZl
        IHRoZSBmdWxsTmFtZSwgb3RoZXJ3aXNlIGl0IHdpbGwgZmFsbGJhY2sKICAg
        ICAgICB0byB0aGUgcmVnaXN0cnkuCgogICAgICAgIGBgYGphdmFzY3JpcHQK
        ICAgICAgICB2YXIgY29udGFpbmVyID0gbmV3IENvbnRhaW5lcigpOwogICAg
        ICAgIGNvbnRhaW5lci5yZXNvbHZlciA9IGZ1bmN0aW9uKGZ1bGxOYW1lKSB7
        CiAgICAgICAgICAvLyBsb29rdXAgdmlhIHRoZSBtb2R1bGUgc3lzdGVtIG9m
        IGNob2ljZQogICAgICAgIH07CgogICAgICAgIC8vIHRoZSB0d2l0dGVyIGZh
        Y3RvcnkgaXMgYWRkZWQgdG8gdGhlIG1vZHVsZSBzeXN0ZW0KICAgICAgICBj
        b250YWluZXIucmVzb2x2ZSgnYXBpOnR3aXR0ZXInKSAvLyA9PiBUd2l0dGVy
        CiAgICAgICAgYGBgCgogICAgICAgIEBtZXRob2QgcmVzb2x2ZQogICAgICAg
        IEBwYXJhbSB7U3RyaW5nfSBmdWxsTmFtZQogICAgICAgIEByZXR1cm4ge0Z1
        bmN0aW9ufSBmdWxsTmFtZSdzIGZhY3RvcnkKICAgICAgKi8KICAgICAgcmVz
        b2x2ZTogZnVuY3Rpb24oZnVsbE5hbWUpIHsKICAgICAgICByZXR1cm4gdGhp
        cy5yZXNvbHZlcihmdWxsTmFtZSkgfHwgdGhpcy5yZWdpc3RyeS5nZXQoZnVs
        bE5hbWUpOwogICAgICB9LAoKICAgICAgLyoqCiAgICAgICAgQSBob29rIHRo
        YXQgY2FuIGJlIHVzZWQgdG8gZGVzY3JpYmUgaG93IHRoZSByZXNvbHZlciB3
        aWxsCiAgICAgICAgYXR0ZW1wdCB0byBmaW5kIHRoZSBmYWN0b3J5LgoKICAg
        ICAgICBGb3IgZXhhbXBsZSwgdGhlIGRlZmF1bHQgRW1iZXIgYC5kZXNjcmli
        ZWAgcmV0dXJucyB0aGUgZnVsbAogICAgICAgIGNsYXNzIG5hbWUgKGluY2x1
        ZGluZyBuYW1lc3BhY2UpIHdoZXJlIEVtYmVyJ3MgcmVzb2x2ZXIgZXhwZWN0
        cwogICAgICAgIHRvIGZpbmQgdGhlIGBmdWxsTmFtZWAuCgogICAgICAgIEBt
        ZXRob2QgZGVzY3JpYmUKICAgICAgKi8KICAgICAgZGVzY3JpYmU6IGZ1bmN0
        aW9uKGZ1bGxOYW1lKSB7CiAgICAgICAgcmV0dXJuIGZ1bGxOYW1lOwogICAg
        ICB9LAoKICAgICAgLyoqCiAgICAgICAgQSBob29rIHRvIGVuYWJsZSBjdXN0
        b20gZnVsbE5hbWUgbm9ybWFsaXphdGlvbiBiZWhhdmlvdXIKCiAgICAgICAg
        QG1ldGhvZCBub3JtYWxpemUKICAgICAgICBAcGFyYW0ge1N0cmluZ30gZnVs
        bE5hbWUKICAgICAgICBAcmV0dXJuIHtzdHJpbmd9IG5vcm1hbGl6ZWQgZnVs
        bE5hbWUKICAgICAgKi8KICAgICAgbm9ybWFsaXplOiBmdW5jdGlvbihmdWxs
        TmFtZSkgewogICAgICAgIHJldHVybiBmdWxsTmFtZTsKICAgICAgfSwKCiAg
        ICAgIC8qKgogICAgICAgIEBtZXRob2QgbWFrZVRvU3RyaW5nCgogICAgICAg
        IEBwYXJhbSB7YW55fSBmYWN0b3J5CiAgICAgICAgQHBhcmFtIHtzdHJpbmd9
        IGZ1bGxOYW1lCiAgICAgICAgQHJldHVybiB7ZnVuY3Rpb259IHRvU3RyaW5n
        IGZ1bmN0aW9uCiAgICAgICovCiAgICAgIG1ha2VUb1N0cmluZzogZnVuY3Rp
        b24oZmFjdG9yeSwgZnVsbE5hbWUpIHsKICAgICAgICByZXR1cm4gZmFjdG9y
        eS50b1N0cmluZygpOwogICAgICB9LAoKICAgICAgLyoqCiAgICAgICAgR2l2
        ZW4gYSBmdWxsTmFtZSByZXR1cm4gYSBjb3JyZXNwb25kaW5nIGluc3RhbmNl
        LgoKICAgICAgICBUaGUgZGVmYXVsdCBiZWhhdmlvdXIgaXMgZm9yIGxvb2t1
        cCB0byByZXR1cm4gYSBzaW5nbGV0b24gaW5zdGFuY2UuCiAgICAgICAgVGhl
        IHNpbmdsZXRvbiBpcyBzY29wZWQgdG8gdGhlIGNvbnRhaW5lciwgYWxsb3dp
        bmcgbXVsdGlwbGUgY29udGFpbmVycwogICAgICAgIHRvIGFsbCBoYXZlIHRo
        ZWlyIG93biBsb2NhbGx5IHNjb3BlZCBzaW5nbGV0b25zLgoKICAgICAgICBg
        YGBqYXZhc2NyaXB0CiAgICAgICAgdmFyIGNvbnRhaW5lciA9IG5ldyBDb250
        YWluZXIoKTsKICAgICAgICBjb250YWluZXIucmVnaXN0ZXIoJ2FwaTp0d2l0
        dGVyJywgVHdpdHRlcik7CgogICAgICAgIHZhciB0d2l0dGVyID0gY29udGFp
        bmVyLmxvb2t1cCgnYXBpOnR3aXR0ZXInKTsKCiAgICAgICAgdHdpdHRlciBp
        bnN0YW5jZW9mIFR3aXR0ZXI7IC8vID0+IHRydWUKCiAgICAgICAgLy8gYnkg
        ZGVmYXVsdCB0aGUgY29udGFpbmVyIHdpbGwgcmV0dXJuIHNpbmdsZXRvbnMK
        ICAgICAgICB0d2l0dGVyMiA9IGNvbnRhaW5lci5sb29rdXAoJ2FwaTp0d2l0
        dGVyJyk7CiAgICAgICAgdHdpdHRlciBpbnN0YW5jZW9mIFR3aXR0ZXI7IC8v
        ID0+IHRydWUKCiAgICAgICAgdHdpdHRlciA9PT0gdHdpdHRlcjI7IC8vPT4g
        dHJ1ZQogICAgICAgIGBgYAoKICAgICAgICBJZiBzaW5nbGV0b25zIGFyZSBu
        b3Qgd2FudGVkIGFuIG9wdGlvbmFsIGZsYWcgY2FuIGJlIHByb3ZpZGVkIGF0
        IGxvb2t1cC4KCiAgICAgICAgYGBgamF2YXNjcmlwdAogICAgICAgIHZhciBj
        b250YWluZXIgPSBuZXcgQ29udGFpbmVyKCk7CiAgICAgICAgY29udGFpbmVy
        LnJlZ2lzdGVyKCdhcGk6dHdpdHRlcicsIFR3aXR0ZXIpOwoKICAgICAgICB2
        YXIgdHdpdHRlciA9IGNvbnRhaW5lci5sb29rdXAoJ2FwaTp0d2l0dGVyJywg
        eyBzaW5nbGV0b246IGZhbHNlIH0pOwogICAgICAgIHZhciB0d2l0dGVyMiA9
        IGNvbnRhaW5lci5sb29rdXAoJ2FwaTp0d2l0dGVyJywgeyBzaW5nbGV0b246
        IGZhbHNlIH0pOwoKICAgICAgICB0d2l0dGVyID09PSB0d2l0dGVyMjsgLy89
        PiBmYWxzZQogICAgICAgIGBgYAoKICAgICAgICBAbWV0aG9kIGxvb2t1cAog
        ICAgICAgIEBwYXJhbSB7U3RyaW5nfSBmdWxsTmFtZQogICAgICAgIEBwYXJh
        bSB7T2JqZWN0fSBvcHRpb25zCiAgICAgICAgQHJldHVybiB7YW55fQogICAg
        ICAqLwogICAgICBsb29rdXA6IGZ1bmN0aW9uKGZ1bGxOYW1lLCBvcHRpb25z
        KSB7CiAgICAgICAgZnVsbE5hbWUgPSB0aGlzLm5vcm1hbGl6ZShmdWxsTmFt
        ZSk7CgogICAgICAgIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9OwoKICAgICAg
        ICBpZiAodGhpcy5jYWNoZS5oYXMoZnVsbE5hbWUpICYmIG9wdGlvbnMuc2lu
        Z2xldG9uICE9PSBmYWxzZSkgewogICAgICAgICAgcmV0dXJuIHRoaXMuY2Fj
        aGUuZ2V0KGZ1bGxOYW1lKTsKICAgICAgICB9CgogICAgICAgIHZhciB2YWx1
        ZSA9IGluc3RhbnRpYXRlKHRoaXMsIGZ1bGxOYW1lKTsKCiAgICAgICAgaWYg
        KHZhbHVlID09PSB1bmRlZmluZWQpIHsgcmV0dXJuOyB9CgogICAgICAgIGlm
        IChpc1NpbmdsZXRvbih0aGlzLCBmdWxsTmFtZSkgJiYgb3B0aW9ucy5zaW5n
        bGV0b24gIT09IGZhbHNlKSB7CiAgICAgICAgICB0aGlzLmNhY2hlLnNldChm
        dWxsTmFtZSwgdmFsdWUpOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIHZh
        bHVlOwogICAgICB9LAoKICAgICAgLyoqCiAgICAgICAgR2l2ZW4gYSBmdWxs
        TmFtZSByZXR1cm4gdGhlIGNvcnJlc3BvbmRpbmcgZmFjdG9yeS4KCiAgICAg
        ICAgQG1ldGhvZCBsb29rdXBGYWN0b3J5CiAgICAgICAgQHBhcmFtIHtTdHJp
        bmd9IGZ1bGxOYW1lCiAgICAgICAgQHJldHVybiB7YW55fQogICAgICAqLwog
        ICAgICBsb29rdXBGYWN0b3J5OiBmdW5jdGlvbihmdWxsTmFtZSkgewogICAg
        ICAgIHJldHVybiBmYWN0b3J5Rm9yKHRoaXMsIGZ1bGxOYW1lKTsKICAgICAg
        fSwKCiAgICAgIC8qKgogICAgICAgIEdpdmVuIGEgZnVsbE5hbWUgY2hlY2sg
        aWYgdGhlIGNvbnRhaW5lciBpcyBhd2FyZSBvZiBpdHMgZmFjdG9yeQogICAg
        ICAgIG9yIHNpbmdsZXRvbiBpbnN0YW5jZS4KCiAgICAgICAgQG1ldGhvZCBo
        YXMKICAgICAgICBAcGFyYW0ge1N0cmluZ30gZnVsbE5hbWUKICAgICAgICBA
        cmV0dXJuIHtCb29sZWFufQogICAgICAqLwogICAgICBoYXM6IGZ1bmN0aW9u
        KGZ1bGxOYW1lKSB7CiAgICAgICAgaWYgKHRoaXMuY2FjaGUuaGFzKGZ1bGxO
        YW1lKSkgewogICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQoKICAg
        ICAgICByZXR1cm4gISFmYWN0b3J5Rm9yKHRoaXMsIGZ1bGxOYW1lKTsKICAg
        ICAgfSwKCiAgICAgIC8qKgogICAgICAgIEFsbG93IHJlZ2lzdGVyaW5nIG9w
        dGlvbnMgZm9yIGFsbCBmYWN0b3JpZXMgb2YgYSB0eXBlLgoKICAgICAgICBg
        YGBqYXZhc2NyaXB0CiAgICAgICAgdmFyIGNvbnRhaW5lciA9IG5ldyBDb250
        YWluZXIoKTsKCiAgICAgICAgLy8gaWYgYWxsIG9mIHR5cGUgYGNvbm5lY3Rp
        b25gIG11c3Qgbm90IGJlIHNpbmdsZXRvbnMKICAgICAgICBjb250YWluZXIu
        b3B0aW9uc0ZvclR5cGUoJ2Nvbm5lY3Rpb24nLCB7IHNpbmdsZXRvbjogZmFs
        c2UgfSk7CgogICAgICAgIGNvbnRhaW5lci5yZWdpc3RlcignY29ubmVjdGlv
        bjp0d2l0dGVyJywgVHdpdHRlckNvbm5lY3Rpb24pOwogICAgICAgIGNvbnRh
        aW5lci5yZWdpc3RlcignY29ubmVjdGlvbjpmYWNlYm9vaycsIEZhY2Vib29r
        Q29ubmVjdGlvbik7CgogICAgICAgIHZhciB0d2l0dGVyID0gY29udGFpbmVy
        Lmxvb2t1cCgnY29ubmVjdGlvbjp0d2l0dGVyJyk7CiAgICAgICAgdmFyIHR3
        aXR0ZXIyID0gY29udGFpbmVyLmxvb2t1cCgnY29ubmVjdGlvbjp0d2l0dGVy
        Jyk7CgogICAgICAgIHR3aXR0ZXIgPT09IHR3aXR0ZXIyOyAvLyA9PiBmYWxz
        ZQoKICAgICAgICB2YXIgZmFjZWJvb2sgPSBjb250YWluZXIubG9va3VwKCdj
        b25uZWN0aW9uOmZhY2Vib29rJyk7CiAgICAgICAgdmFyIGZhY2Vib29rMiA9
        IGNvbnRhaW5lci5sb29rdXAoJ2Nvbm5lY3Rpb246ZmFjZWJvb2snKTsKCiAg
        ICAgICAgZmFjZWJvb2sgPT09IGZhY2Vib29rMjsgLy8gPT4gZmFsc2UKICAg
        ICAgICBgYGAKCiAgICAgICAgQG1ldGhvZCBvcHRpb25zRm9yVHlwZQogICAg
        ICAgIEBwYXJhbSB7U3RyaW5nfSB0eXBlCiAgICAgICAgQHBhcmFtIHtPYmpl
        Y3R9IG9wdGlvbnMKICAgICAgKi8KICAgICAgb3B0aW9uc0ZvclR5cGU6IGZ1
        bmN0aW9uKHR5cGUsIG9wdGlvbnMpIHsKICAgICAgICBpZiAodGhpcy5wYXJl
        bnQpIHsgaWxsZWdhbENoaWxkT3BlcmF0aW9uKCdvcHRpb25zRm9yVHlwZScp
        OyB9CgogICAgICAgIHRoaXMuX3R5cGVPcHRpb25zLnNldCh0eXBlLCBvcHRp
        b25zKTsKICAgICAgfSwKCiAgICAgIC8qKgogICAgICAgIEBtZXRob2Qgb3B0
        aW9ucwogICAgICAgIEBwYXJhbSB7U3RyaW5nfSB0eXBlCiAgICAgICAgQHBh
        cmFtIHtPYmplY3R9IG9wdGlvbnMKICAgICAgKi8KICAgICAgb3B0aW9uczog
        ZnVuY3Rpb24odHlwZSwgb3B0aW9ucykgewogICAgICAgIHRoaXMub3B0aW9u
        c0ZvclR5cGUodHlwZSwgb3B0aW9ucyk7CiAgICAgIH0sCgogICAgICAvKioK
        ICAgICAgICBAcHJpdmF0ZQoKICAgICAgICBVc2VkIG9ubHkgdmlhIGBpbmpl
        Y3Rpb25gLgoKICAgICAgICBQcm92aWRlcyBhIHNwZWNpYWxpemVkIGZvcm0g
        b2YgaW5qZWN0aW9uLCBzcGVjaWZpY2FsbHkgZW5hYmxpbmcKICAgICAgICBh
        bGwgb2JqZWN0cyBvZiBvbmUgdHlwZSB0byBiZSBpbmplY3RlZCB3aXRoIGEg
        cmVmZXJlbmNlIHRvIGFub3RoZXIKICAgICAgICBvYmplY3QuCgogICAgICAg
        IEZvciBleGFtcGxlLCBwcm92aWRlZCBlYWNoIG9iamVjdCBvZiB0eXBlIGBj
        b250cm9sbGVyYCBuZWVkZWQgYSBgcm91dGVyYC4KICAgICAgICBvbmUgd291
        bGQgZG8gdGhlIGZvbGxvd2luZzoKCiAgICAgICAgYGBgamF2YXNjcmlwdAog
        ICAgICAgIHZhciBjb250YWluZXIgPSBuZXcgQ29udGFpbmVyKCk7CgogICAg
        ICAgIGNvbnRhaW5lci5yZWdpc3Rlcigncm91dGVyOm1haW4nLCBSb3V0ZXIp
        OwogICAgICAgIGNvbnRhaW5lci5yZWdpc3RlcignY29udHJvbGxlcjp1c2Vy
        JywgVXNlckNvbnRyb2xsZXIpOwogICAgICAgIGNvbnRhaW5lci5yZWdpc3Rl
        cignY29udHJvbGxlcjpwb3N0JywgUG9zdENvbnRyb2xsZXIpOwoKICAgICAg
        ICBjb250YWluZXIudHlwZUluamVjdGlvbignY29udHJvbGxlcicsICdyb3V0
        ZXInLCAncm91dGVyOm1haW4nKTsKCiAgICAgICAgdmFyIHVzZXIgPSBjb250
        YWluZXIubG9va3VwKCdjb250cm9sbGVyOnVzZXInKTsKICAgICAgICB2YXIg
        cG9zdCA9IGNvbnRhaW5lci5sb29rdXAoJ2NvbnRyb2xsZXI6cG9zdCcpOwoK
        ICAgICAgICB1c2VyLnJvdXRlciBpbnN0YW5jZW9mIFJvdXRlcjsgLy89PiB0
        cnVlCiAgICAgICAgcG9zdC5yb3V0ZXIgaW5zdGFuY2VvZiBSb3V0ZXI7IC8v
        PT4gdHJ1ZQoKICAgICAgICAvLyBib3RoIGNvbnRyb2xsZXJzIHNoYXJlIHRo
        ZSBzYW1lIHJvdXRlcgogICAgICAgIHVzZXIucm91dGVyID09PSBwb3N0LnJv
        dXRlcjsgLy89PiB0cnVlCiAgICAgICAgYGBgCgogICAgICAgIEBtZXRob2Qg
        dHlwZUluamVjdGlvbgogICAgICAgIEBwYXJhbSB7U3RyaW5nfSB0eXBlCiAg
        ICAgICAgQHBhcmFtIHtTdHJpbmd9IHByb3BlcnR5CiAgICAgICAgQHBhcmFt
        IHtTdHJpbmd9IGZ1bGxOYW1lCiAgICAgICovCiAgICAgIHR5cGVJbmplY3Rp
        b246IGZ1bmN0aW9uKHR5cGUsIHByb3BlcnR5LCBmdWxsTmFtZSkgewogICAg
        ICAgIGlmICh0aGlzLnBhcmVudCkgeyBpbGxlZ2FsQ2hpbGRPcGVyYXRpb24o
        J3R5cGVJbmplY3Rpb24nKTsgfQoKICAgICAgICBhZGRUeXBlSW5qZWN0aW9u
        KHRoaXMudHlwZUluamVjdGlvbnMsIHR5cGUsIHByb3BlcnR5LCBmdWxsTmFt
        ZSk7CiAgICAgIH0sCgogICAgICAvKioKICAgICAgICBEZWZpbmVzIGluamVj
        dGlvbiBydWxlcy4KCiAgICAgICAgVGhlc2UgcnVsZXMgYXJlIHVzZWQgdG8g
        aW5qZWN0IGRlcGVuZGVuY2llcyBvbnRvIG9iamVjdHMgd2hlbiB0aGV5CiAg
        ICAgICAgYXJlIGluc3RhbnRpYXRlZC4KCiAgICAgICAgVHdvIGZvcm1zIG9m
        IGluamVjdGlvbnMgYXJlIHBvc3NpYmxlOgoKICAgICAgKiBJbmplY3Rpbmcg
        b25lIGZ1bGxOYW1lIG9uIGFub3RoZXIgZnVsbE5hbWUKICAgICAgKiBJbmpl
        Y3Rpbmcgb25lIGZ1bGxOYW1lIG9uIGEgdHlwZQoKICAgICAgICBFeGFtcGxl
        OgoKICAgICAgICBgYGBqYXZhc2NyaXB0CiAgICAgICAgdmFyIGNvbnRhaW5l
        ciA9IG5ldyBDb250YWluZXIoKTsKCiAgICAgICAgY29udGFpbmVyLnJlZ2lz
        dGVyKCdzb3VyY2U6bWFpbicsIFNvdXJjZSk7CiAgICAgICAgY29udGFpbmVy
        LnJlZ2lzdGVyKCdtb2RlbDp1c2VyJywgVXNlcik7CiAgICAgICAgY29udGFp
        bmVyLnJlZ2lzdGVyKCdtb2RlbDpwb3N0JywgUG9zdCk7CgogICAgICAgIC8v
        IGluamVjdGluZyBvbmUgZnVsbE5hbWUgb24gYW5vdGhlciBmdWxsTmFtZQog
        ICAgICAgIC8vIGVnLiBlYWNoIHVzZXIgbW9kZWwgZ2V0cyBhIHBvc3QgbW9k
        ZWwKICAgICAgICBjb250YWluZXIuaW5qZWN0aW9uKCdtb2RlbDp1c2VyJywg
        J3Bvc3QnLCAnbW9kZWw6cG9zdCcpOwoKICAgICAgICAvLyBpbmplY3Rpbmcg
        b25lIGZ1bGxOYW1lIG9uIGFub3RoZXIgdHlwZQogICAgICAgIGNvbnRhaW5l
        ci5pbmplY3Rpb24oJ21vZGVsJywgJ3NvdXJjZScsICdzb3VyY2U6bWFpbicp
        OwoKICAgICAgICB2YXIgdXNlciA9IGNvbnRhaW5lci5sb29rdXAoJ21vZGVs
        OnVzZXInKTsKICAgICAgICB2YXIgcG9zdCA9IGNvbnRhaW5lci5sb29rdXAo
        J21vZGVsOnBvc3QnKTsKCiAgICAgICAgdXNlci5zb3VyY2UgaW5zdGFuY2Vv
        ZiBTb3VyY2U7IC8vPT4gdHJ1ZQogICAgICAgIHBvc3Quc291cmNlIGluc3Rh
        bmNlb2YgU291cmNlOyAvLz0+IHRydWUKCiAgICAgICAgdXNlci5wb3N0IGlu
        c3RhbmNlb2YgUG9zdDsgLy89PiB0cnVlCgogICAgICAgIC8vIGFuZCBib3Ro
        IG1vZGVscyBzaGFyZSB0aGUgc2FtZSBzb3VyY2UKICAgICAgICB1c2VyLnNv
        dXJjZSA9PT0gcG9zdC5zb3VyY2U7IC8vPT4gdHJ1ZQogICAgICAgIGBgYAoK
        ICAgICAgICBAbWV0aG9kIGluamVjdGlvbgogICAgICAgIEBwYXJhbSB7U3Ry
        aW5nfSBmYWN0b3J5TmFtZQogICAgICAgIEBwYXJhbSB7U3RyaW5nfSBwcm9w
        ZXJ0eQogICAgICAgIEBwYXJhbSB7U3RyaW5nfSBpbmplY3Rpb25OYW1lCiAg
        ICAgICovCiAgICAgIGluamVjdGlvbjogZnVuY3Rpb24oZmFjdG9yeU5hbWUs
        IHByb3BlcnR5LCBpbmplY3Rpb25OYW1lKSB7CiAgICAgICAgaWYgKHRoaXMu
        cGFyZW50KSB7IGlsbGVnYWxDaGlsZE9wZXJhdGlvbignaW5qZWN0aW9uJyk7
        IH0KCiAgICAgICAgaWYgKGZhY3RvcnlOYW1lLmluZGV4T2YoJzonKSA9PT0g
        LTEpIHsKICAgICAgICAgIHJldHVybiB0aGlzLnR5cGVJbmplY3Rpb24oZmFj
        dG9yeU5hbWUsIHByb3BlcnR5LCBpbmplY3Rpb25OYW1lKTsKICAgICAgICB9
        CgogICAgICAgIGFkZEluamVjdGlvbih0aGlzLmluamVjdGlvbnMsIGZhY3Rv
        cnlOYW1lLCBwcm9wZXJ0eSwgaW5qZWN0aW9uTmFtZSk7CiAgICAgIH0sCgoK
        ICAgICAgLyoqCiAgICAgICAgQHByaXZhdGUKCiAgICAgICAgVXNlZCBvbmx5
        IHZpYSBgZmFjdG9yeUluamVjdGlvbmAuCgogICAgICAgIFByb3ZpZGVzIGEg
        c3BlY2lhbGl6ZWQgZm9ybSBvZiBpbmplY3Rpb24sIHNwZWNpZmljYWxseSBl
        bmFibGluZwogICAgICAgIGFsbCBmYWN0b3J5IG9mIG9uZSB0eXBlIHRvIGJl
        IGluamVjdGVkIHdpdGggYSByZWZlcmVuY2UgdG8gYW5vdGhlcgogICAgICAg
        IG9iamVjdC4KCiAgICAgICAgRm9yIGV4YW1wbGUsIHByb3ZpZGVkIGVhY2gg
        ZmFjdG9yeSBvZiB0eXBlIGBtb2RlbGAgbmVlZGVkIGEgYHN0b3JlYC4KICAg
        ICAgICBvbmUgd291bGQgZG8gdGhlIGZvbGxvd2luZzoKCiAgICAgICAgYGBg
        amF2YXNjcmlwdAogICAgICAgIHZhciBjb250YWluZXIgPSBuZXcgQ29udGFp
        bmVyKCk7CgogICAgICAgIGNvbnRhaW5lci5yZWdpc3RlckZhY3RvcnkoJ21v
        ZGVsOnVzZXInLCBVc2VyKTsKICAgICAgICBjb250YWluZXIucmVnaXN0ZXIo
        J3N0b3JlOm1haW4nLCBTb21lU3RvcmUpOwoKICAgICAgICBjb250YWluZXIu
        ZmFjdG9yeVR5cGVJbmplY3Rpb24oJ21vZGVsJywgJ3N0b3JlJywgJ3N0b3Jl
        Om1haW4nKTsKCiAgICAgICAgdmFyIHN0b3JlID0gY29udGFpbmVyLmxvb2t1
        cCgnc3RvcmU6bWFpbicpOwogICAgICAgIHZhciBVc2VyRmFjdG9yeSA9IGNv
        bnRhaW5lci5sb29rdXBGYWN0b3J5KCdtb2RlbDp1c2VyJyk7CgogICAgICAg
        IFVzZXJGYWN0b3J5LnN0b3JlIGluc3RhbmNlb2YgU29tZVN0b3JlOyAvLz0+
        IHRydWUKICAgICAgICBgYGAKCiAgICAgICAgQG1ldGhvZCBmYWN0b3J5VHlw
        ZUluamVjdGlvbgogICAgICAgIEBwYXJhbSB7U3RyaW5nfSB0eXBlCiAgICAg
        ICAgQHBhcmFtIHtTdHJpbmd9IHByb3BlcnR5CiAgICAgICAgQHBhcmFtIHtT
        dHJpbmd9IGZ1bGxOYW1lCiAgICAgICovCiAgICAgIGZhY3RvcnlUeXBlSW5q
        ZWN0aW9uOiBmdW5jdGlvbih0eXBlLCBwcm9wZXJ0eSwgZnVsbE5hbWUpIHsK
        ICAgICAgICBpZiAodGhpcy5wYXJlbnQpIHsgaWxsZWdhbENoaWxkT3BlcmF0
        aW9uKCdmYWN0b3J5VHlwZUluamVjdGlvbicpOyB9CgogICAgICAgIGFkZFR5
        cGVJbmplY3Rpb24odGhpcy5mYWN0b3J5VHlwZUluamVjdGlvbnMsIHR5cGUs
        IHByb3BlcnR5LCBmdWxsTmFtZSk7CiAgICAgIH0sCgogICAgICAvKioKICAg
        ICAgICBEZWZpbmVzIGZhY3RvcnkgaW5qZWN0aW9uIHJ1bGVzLgoKICAgICAg
        ICBTaW1pbGFyIHRvIHJlZ3VsYXIgaW5qZWN0aW9uIHJ1bGVzLCBidXQgYXJl
        IHJ1biBhZ2FpbnN0IGZhY3RvcmllcywgdmlhCiAgICAgICAgYENvbnRhaW5l
        ciNsb29rdXBGYWN0b3J5YC4KCiAgICAgICAgVGhlc2UgcnVsZXMgYXJlIHVz
        ZWQgdG8gaW5qZWN0IG9iamVjdHMgb250byBmYWN0b3JpZXMgd2hlbiB0aGV5
        CiAgICAgICAgYXJlIGxvb2tlZCB1cC4KCiAgICAgICAgVHdvIGZvcm1zIG9m
        IGluamVjdGlvbnMgYXJlIHBvc3NpYmxlOgoKICAgICAgKiBJbmplY3Rpbmcg
        b25lIGZ1bGxOYW1lIG9uIGFub3RoZXIgZnVsbE5hbWUKICAgICAgKiBJbmpl
        Y3Rpbmcgb25lIGZ1bGxOYW1lIG9uIGEgdHlwZQoKICAgICAgICBFeGFtcGxl
        OgoKICAgICAgICBgYGBqYXZhc2NyaXB0CiAgICAgICAgdmFyIGNvbnRhaW5l
        ciA9IG5ldyBDb250YWluZXIoKTsKCiAgICAgICAgY29udGFpbmVyLnJlZ2lz
        dGVyKCdzdG9yZTptYWluJywgU3RvcmUpOwogICAgICAgIGNvbnRhaW5lci5y
        ZWdpc3Rlcignc3RvcmU6c2Vjb25kYXJ5JywgT3RoZXJTdG9yZSk7CiAgICAg
        ICAgY29udGFpbmVyLnJlZ2lzdGVyKCdtb2RlbDp1c2VyJywgVXNlcik7CiAg
        ICAgICAgY29udGFpbmVyLnJlZ2lzdGVyKCdtb2RlbDpwb3N0JywgUG9zdCk7
        CgogICAgICAgIC8vIGluamVjdGluZyBvbmUgZnVsbE5hbWUgb24gYW5vdGhl
        ciB0eXBlCiAgICAgICAgY29udGFpbmVyLmZhY3RvcnlJbmplY3Rpb24oJ21v
        ZGVsJywgJ3N0b3JlJywgJ3N0b3JlOm1haW4nKTsKCiAgICAgICAgLy8gaW5q
        ZWN0aW5nIG9uZSBmdWxsTmFtZSBvbiBhbm90aGVyIGZ1bGxOYW1lCiAgICAg
        ICAgY29udGFpbmVyLmZhY3RvcnlJbmplY3Rpb24oJ21vZGVsOnBvc3QnLCAn
        c2Vjb25kYXJ5U3RvcmUnLCAnc3RvcmU6c2Vjb25kYXJ5Jyk7CgogICAgICAg
        IHZhciBVc2VyRmFjdG9yeSA9IGNvbnRhaW5lci5sb29rdXBGYWN0b3J5KCdt
        b2RlbDp1c2VyJyk7CiAgICAgICAgdmFyIFBvc3RGYWN0b3J5ID0gY29udGFp
        bmVyLmxvb2t1cEZhY3RvcnkoJ21vZGVsOnBvc3QnKTsKICAgICAgICB2YXIg
        c3RvcmUgPSBjb250YWluZXIubG9va3VwKCdzdG9yZTptYWluJyk7CgogICAg
        ICAgIFVzZXJGYWN0b3J5LnN0b3JlIGluc3RhbmNlb2YgU3RvcmU7IC8vPT4g
        dHJ1ZQogICAgICAgIFVzZXJGYWN0b3J5LnNlY29uZGFyeVN0b3JlIGluc3Rh
        bmNlb2YgT3RoZXJTdG9yZTsgLy89PiBmYWxzZQoKICAgICAgICBQb3N0RmFj
        dG9yeS5zdG9yZSBpbnN0YW5jZW9mIFN0b3JlOyAvLz0+IHRydWUKICAgICAg
        ICBQb3N0RmFjdG9yeS5zZWNvbmRhcnlTdG9yZSBpbnN0YW5jZW9mIE90aGVy
        U3RvcmU7IC8vPT4gdHJ1ZQoKICAgICAgICAvLyBhbmQgYm90aCBtb2RlbHMg
        c2hhcmUgdGhlIHNhbWUgc291cmNlIGluc3RhbmNlCiAgICAgICAgVXNlckZh
        Y3Rvcnkuc3RvcmUgPT09IFBvc3RGYWN0b3J5LnN0b3JlOyAvLz0+IHRydWUK
        ICAgICAgICBgYGAKCiAgICAgICAgQG1ldGhvZCBmYWN0b3J5SW5qZWN0aW9u
        CiAgICAgICAgQHBhcmFtIHtTdHJpbmd9IGZhY3RvcnlOYW1lCiAgICAgICAg
        QHBhcmFtIHtTdHJpbmd9IHByb3BlcnR5CiAgICAgICAgQHBhcmFtIHtTdHJp
        bmd9IGluamVjdGlvbk5hbWUKICAgICAgKi8KICAgICAgZmFjdG9yeUluamVj
        dGlvbjogZnVuY3Rpb24oZmFjdG9yeU5hbWUsIHByb3BlcnR5LCBpbmplY3Rp
        b25OYW1lKSB7CiAgICAgICAgaWYgKHRoaXMucGFyZW50KSB7IGlsbGVnYWxD
        aGlsZE9wZXJhdGlvbignaW5qZWN0aW9uJyk7IH0KCiAgICAgICAgaWYgKGZh
        Y3RvcnlOYW1lLmluZGV4T2YoJzonKSA9PT0gLTEpIHsKICAgICAgICAgIHJl
        dHVybiB0aGlzLmZhY3RvcnlUeXBlSW5qZWN0aW9uKGZhY3RvcnlOYW1lLCBw
        cm9wZXJ0eSwgaW5qZWN0aW9uTmFtZSk7CiAgICAgICAgfQoKICAgICAgICBh
        ZGRJbmplY3Rpb24odGhpcy5mYWN0b3J5SW5qZWN0aW9ucywgZmFjdG9yeU5h
        bWUsIHByb3BlcnR5LCBpbmplY3Rpb25OYW1lKTsKICAgICAgfSwKCiAgICAg
        IC8qKgogICAgICAgIEEgZGVwdGggZmlyc3QgdHJhdmVyc2FsLCBkZXN0cm95
        aW5nIHRoZSBjb250YWluZXIsIGl0cyBkZXNjZW5kYW50IGNvbnRhaW5lcnMg
        YW5kIGFsbAogICAgICAgIHRoZWlyIG1hbmFnZWQgb2JqZWN0cy4KCiAgICAg
        ICAgQG1ldGhvZCBkZXN0cm95CiAgICAgICovCiAgICAgIGRlc3Ryb3k6IGZ1
        bmN0aW9uKCkgewogICAgICAgIHRoaXMuaXNEZXN0cm95ZWQgPSB0cnVlOwoK
        ICAgICAgICBmb3IgKHZhciBpPTAsIGw9dGhpcy5jaGlsZHJlbi5sZW5ndGg7
        IGk8bDsgaSsrKSB7CiAgICAgICAgICB0aGlzLmNoaWxkcmVuW2ldLmRlc3Ry
        b3koKTsKICAgICAgICB9CgogICAgICAgIHRoaXMuY2hpbGRyZW4gPSBbXTsK
        CiAgICAgICAgZWFjaERlc3Ryb3lhYmxlKHRoaXMsIGZ1bmN0aW9uKGl0ZW0p
        IHsKICAgICAgICAgIGl0ZW0uZGVzdHJveSgpOwogICAgICAgIH0pOwoKICAg
        ICAgICB0aGlzLnBhcmVudCA9IHVuZGVmaW5lZDsKICAgICAgICB0aGlzLmlz
        RGVzdHJveWVkID0gdHJ1ZTsKICAgICAgfSwKCiAgICAgIC8qKgogICAgICAg
        IEBtZXRob2QgcmVzZXQKICAgICAgKi8KICAgICAgcmVzZXQ6IGZ1bmN0aW9u
        KCkgewogICAgICAgIGZvciAodmFyIGk9MCwgbD10aGlzLmNoaWxkcmVuLmxl
        bmd0aDsgaTxsOyBpKyspIHsKICAgICAgICAgIHJlc2V0Q2FjaGUodGhpcy5j
        aGlsZHJlbltpXSk7CiAgICAgICAgfQogICAgICAgIHJlc2V0Q2FjaGUodGhp
        cyk7CiAgICAgIH0KICAgIH07CgogICAgZnVuY3Rpb24gaWxsZWdhbENoaWxk
        T3BlcmF0aW9uKG9wZXJhdGlvbikgewogICAgICB0aHJvdyBuZXcgRXJyb3Io
        b3BlcmF0aW9uICsgIiBpcyBub3QgY3VycmVudGx5IHN1cHBvcnRlZCBvbiBj
        aGlsZCBjb250YWluZXJzIik7CiAgICB9CgogICAgZnVuY3Rpb24gaXNTaW5n
        bGV0b24oY29udGFpbmVyLCBmdWxsTmFtZSkgewogICAgICB2YXIgc2luZ2xl
        dG9uID0gb3B0aW9uKGNvbnRhaW5lciwgZnVsbE5hbWUsICdzaW5nbGV0b24n
        KTsKCiAgICAgIHJldHVybiBzaW5nbGV0b24gIT09IGZhbHNlOwogICAgfQoK
        ICAgIGZ1bmN0aW9uIGJ1aWxkSW5qZWN0aW9ucyhjb250YWluZXIsIGluamVj
        dGlvbnMpIHsKICAgICAgdmFyIGhhc2ggPSB7fTsKCiAgICAgIGlmICghaW5q
        ZWN0aW9ucykgeyByZXR1cm4gaGFzaDsgfQoKICAgICAgdmFyIGluamVjdGlv
        biwgbG9va3VwOwoKICAgICAgZm9yICh2YXIgaT0wLCBsPWluamVjdGlvbnMu
        bGVuZ3RoOyBpPGw7IGkrKykgewogICAgICAgIGluamVjdGlvbiA9IGluamVj
        dGlvbnNbaV07CiAgICAgICAgbG9va3VwID0gY29udGFpbmVyLmxvb2t1cChp
        bmplY3Rpb24uZnVsbE5hbWUpOwoKICAgICAgICBpZiAobG9va3VwICE9PSB1
        bmRlZmluZWQpIHsKICAgICAgICAgIGhhc2hbaW5qZWN0aW9uLnByb3BlcnR5
        XSA9IGxvb2t1cDsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhyb3cg
        bmV3IEVycm9yKCdBdHRlbXB0aW5nIHRvIGluamVjdCBhbiB1bmtub3duIGlu
        amVjdGlvbjogYCcgKyBpbmplY3Rpb24uZnVsbE5hbWUgKyAnYCcpOwogICAg
        ICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIGhhc2g7CiAgICB9CgogICAg
        ZnVuY3Rpb24gb3B0aW9uKGNvbnRhaW5lciwgZnVsbE5hbWUsIG9wdGlvbk5h
        bWUpIHsKICAgICAgdmFyIG9wdGlvbnMgPSBjb250YWluZXIuX29wdGlvbnMu
        Z2V0KGZ1bGxOYW1lKTsKCiAgICAgIGlmIChvcHRpb25zICYmIG9wdGlvbnNb
        b3B0aW9uTmFtZV0gIT09IHVuZGVmaW5lZCkgewogICAgICAgIHJldHVybiBv
        cHRpb25zW29wdGlvbk5hbWVdOwogICAgICB9CgogICAgICB2YXIgdHlwZSA9
        IGZ1bGxOYW1lLnNwbGl0KCI6IilbMF07CiAgICAgIG9wdGlvbnMgPSBjb250
        YWluZXIuX3R5cGVPcHRpb25zLmdldCh0eXBlKTsKCiAgICAgIGlmIChvcHRp
        b25zKSB7CiAgICAgICAgcmV0dXJuIG9wdGlvbnNbb3B0aW9uTmFtZV07CiAg
        ICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiBmYWN0b3J5Rm9yKGNvbnRhaW5l
        ciwgZnVsbE5hbWUpIHsKICAgICAgdmFyIG5hbWUgPSBjb250YWluZXIubm9y
        bWFsaXplKGZ1bGxOYW1lKTsKICAgICAgdmFyIGZhY3RvcnkgPSBjb250YWlu
        ZXIucmVzb2x2ZShuYW1lKTsKICAgICAgdmFyIGluamVjdGVkRmFjdG9yeTsK
        ICAgICAgdmFyIGNhY2hlID0gY29udGFpbmVyLmZhY3RvcnlDYWNoZTsKICAg
        ICAgdmFyIHR5cGUgPSBmdWxsTmFtZS5zcGxpdCgiOiIpWzBdOwoKICAgICAg
        aWYgKGZhY3RvcnkgPT09IHVuZGVmaW5lZCkgeyByZXR1cm47IH0KCiAgICAg
        IGlmIChjYWNoZS5oYXMoZnVsbE5hbWUpKSB7CiAgICAgICAgcmV0dXJuIGNh
        Y2hlLmdldChmdWxsTmFtZSk7CiAgICAgIH0KCiAgICAgIGlmICghZmFjdG9y
        eSB8fCB0eXBlb2YgZmFjdG9yeS5leHRlbmQgIT09ICdmdW5jdGlvbicgfHwg
        KCFFbWJlci5NT0RFTF9GQUNUT1JZX0lOSkVDVElPTlMgJiYgdHlwZSA9PT0g
        J21vZGVsJykpIHsKICAgICAgICAvLyBUT0RPOiB0aGluayBhYm91dCBhICdz
        YWZlJyBtZXJnZSBzdHlsZSBleHRlbnNpb24KICAgICAgICAvLyBmb3Igbm93
        IGp1c3QgZmFsbGJhY2sgdG8gY3JlYXRlIHRpbWUgaW5qZWN0aW9uCiAgICAg
        ICAgcmV0dXJuIGZhY3Rvcnk7CiAgICAgIH0gZWxzZSB7CgogICAgICAgIHZh
        ciBpbmplY3Rpb25zICAgICAgICA9IGluamVjdGlvbnNGb3IoY29udGFpbmVy
        LCBmdWxsTmFtZSk7CiAgICAgICAgdmFyIGZhY3RvcnlJbmplY3Rpb25zID0g
        ZmFjdG9yeUluamVjdGlvbnNGb3IoY29udGFpbmVyLCBmdWxsTmFtZSk7Cgog
        ICAgICAgIGZhY3RvcnlJbmplY3Rpb25zLl90b1N0cmluZyA9IGNvbnRhaW5l
        ci5tYWtlVG9TdHJpbmcoZmFjdG9yeSwgZnVsbE5hbWUpOwoKICAgICAgICBp
        bmplY3RlZEZhY3RvcnkgPSBmYWN0b3J5LmV4dGVuZChpbmplY3Rpb25zKTsK
        ICAgICAgICBpbmplY3RlZEZhY3RvcnkucmVvcGVuQ2xhc3MoZmFjdG9yeUlu
        amVjdGlvbnMpOwoKICAgICAgICBjYWNoZS5zZXQoZnVsbE5hbWUsIGluamVj
        dGVkRmFjdG9yeSk7CgogICAgICAgIHJldHVybiBpbmplY3RlZEZhY3Rvcnk7
        CiAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiBpbmplY3Rpb25zRm9yKGNv
        bnRhaW5lciAsZnVsbE5hbWUpIHsKICAgICAgdmFyIHNwbGl0TmFtZSA9IGZ1
        bGxOYW1lLnNwbGl0KCI6IiksCiAgICAgICAgdHlwZSA9IHNwbGl0TmFtZVsw
        XSwKICAgICAgICBpbmplY3Rpb25zID0gW107CgogICAgICBpbmplY3Rpb25z
        ID0gaW5qZWN0aW9ucy5jb25jYXQoY29udGFpbmVyLnR5cGVJbmplY3Rpb25z
        LmdldCh0eXBlKSB8fCBbXSk7CiAgICAgIGluamVjdGlvbnMgPSBpbmplY3Rp
        b25zLmNvbmNhdChjb250YWluZXIuaW5qZWN0aW9uc1tmdWxsTmFtZV0gfHwg
        W10pOwoKICAgICAgaW5qZWN0aW9ucyA9IGJ1aWxkSW5qZWN0aW9ucyhjb250
        YWluZXIsIGluamVjdGlvbnMpOwogICAgICBpbmplY3Rpb25zLl9kZWJ1Z0Nv
        bnRhaW5lcktleSA9IGZ1bGxOYW1lOwogICAgICBpbmplY3Rpb25zLmNvbnRh
        aW5lciA9IGNvbnRhaW5lcjsKCiAgICAgIHJldHVybiBpbmplY3Rpb25zOwog
        ICAgfQoKICAgIGZ1bmN0aW9uIGZhY3RvcnlJbmplY3Rpb25zRm9yKGNvbnRh
        aW5lciwgZnVsbE5hbWUpIHsKICAgICAgdmFyIHNwbGl0TmFtZSA9IGZ1bGxO
        YW1lLnNwbGl0KCI6IiksCiAgICAgICAgdHlwZSA9IHNwbGl0TmFtZVswXSwK
        ICAgICAgICBmYWN0b3J5SW5qZWN0aW9ucyA9IFtdOwoKICAgICAgZmFjdG9y
        eUluamVjdGlvbnMgPSBmYWN0b3J5SW5qZWN0aW9ucy5jb25jYXQoY29udGFp
        bmVyLmZhY3RvcnlUeXBlSW5qZWN0aW9ucy5nZXQodHlwZSkgfHwgW10pOwog
        ICAgICBmYWN0b3J5SW5qZWN0aW9ucyA9IGZhY3RvcnlJbmplY3Rpb25zLmNv
        bmNhdChjb250YWluZXIuZmFjdG9yeUluamVjdGlvbnNbZnVsbE5hbWVdIHx8
        IFtdKTsKCiAgICAgIGZhY3RvcnlJbmplY3Rpb25zID0gYnVpbGRJbmplY3Rp
        b25zKGNvbnRhaW5lciwgZmFjdG9yeUluamVjdGlvbnMpOwogICAgICBmYWN0
        b3J5SW5qZWN0aW9ucy5fZGVidWdDb250YWluZXJLZXkgPSBmdWxsTmFtZTsK
        CiAgICAgIHJldHVybiBmYWN0b3J5SW5qZWN0aW9uczsKICAgIH0KCiAgICBm
        dW5jdGlvbiBpbnN0YW50aWF0ZShjb250YWluZXIsIGZ1bGxOYW1lKSB7CiAg
        ICAgIHZhciBmYWN0b3J5ID0gZmFjdG9yeUZvcihjb250YWluZXIsIGZ1bGxO
        YW1lKTsKCiAgICAgIGlmIChvcHRpb24oY29udGFpbmVyLCBmdWxsTmFtZSwg
        J2luc3RhbnRpYXRlJykgPT09IGZhbHNlKSB7CiAgICAgICAgcmV0dXJuIGZh
        Y3Rvcnk7CiAgICAgIH0KCiAgICAgIGlmIChmYWN0b3J5KSB7CiAgICAgICAg
        aWYgKHR5cGVvZiBmYWN0b3J5LmV4dGVuZCA9PT0gJ2Z1bmN0aW9uJykgewog
        ICAgICAgICAgLy8gYXNzdW1lIHRoZSBmYWN0b3J5IHdhcyBleHRlbmRhYmxl
        IGFuZCBpcyBhbHJlYWR5IGluamVjdGVkCiAgICAgICAgICByZXR1cm4gZmFj
        dG9yeS5jcmVhdGUoKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgLy8g
        YXNzdW1lIHRoZSBmYWN0b3J5IHdhcyBleHRlbmRhYmxlCiAgICAgICAgICAv
        LyB0byBjcmVhdGUgdGltZSBpbmplY3Rpb25zCiAgICAgICAgICAvLyBUT0RP
        OiBzdXBwb3J0IG5ldydpbmcgZm9yIGluc3RhbnRpYXRpb24gYW5kIG1lcmdl
        IGluamVjdGlvbnMgZm9yIHB1cmUgSlMgRnVuY3Rpb25zCiAgICAgICAgICBy
        ZXR1cm4gZmFjdG9yeS5jcmVhdGUoaW5qZWN0aW9uc0Zvcihjb250YWluZXIs
        IGZ1bGxOYW1lKSk7CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgZnVu
        Y3Rpb24gZWFjaERlc3Ryb3lhYmxlKGNvbnRhaW5lciwgY2FsbGJhY2spIHsK
        ICAgICAgY29udGFpbmVyLmNhY2hlLmVhY2hMb2NhbChmdW5jdGlvbihrZXks
        IHZhbHVlKSB7CiAgICAgICAgaWYgKG9wdGlvbihjb250YWluZXIsIGtleSwg
        J2luc3RhbnRpYXRlJykgPT09IGZhbHNlKSB7IHJldHVybjsgfQogICAgICAg
        IGNhbGxiYWNrKHZhbHVlKTsKICAgICAgfSk7CiAgICB9CgogICAgZnVuY3Rp
        b24gcmVzZXRDYWNoZShjb250YWluZXIpIHsKICAgICAgY29udGFpbmVyLmNh
        Y2hlLmVhY2hMb2NhbChmdW5jdGlvbihrZXksIHZhbHVlKSB7CiAgICAgICAg
        aWYgKG9wdGlvbihjb250YWluZXIsIGtleSwgJ2luc3RhbnRpYXRlJykgPT09
        IGZhbHNlKSB7IHJldHVybjsgfQogICAgICAgIHZhbHVlLmRlc3Ryb3koKTsK
        ICAgICAgfSk7CiAgICAgIGNvbnRhaW5lci5jYWNoZS5kaWN0ID0ge307CiAg
        ICB9CgogICAgZnVuY3Rpb24gYWRkVHlwZUluamVjdGlvbihydWxlcywgdHlw
        ZSwgcHJvcGVydHksIGZ1bGxOYW1lKSB7CiAgICAgIHZhciBpbmplY3Rpb25z
        ID0gcnVsZXMuZ2V0KHR5cGUpOwoKICAgICAgaWYgKCFpbmplY3Rpb25zKSB7
        CiAgICAgICAgaW5qZWN0aW9ucyA9IFtdOwogICAgICAgIHJ1bGVzLnNldCh0
        eXBlLCBpbmplY3Rpb25zKTsKICAgICAgfQoKICAgICAgaW5qZWN0aW9ucy5w
        dXNoKHsKICAgICAgICBwcm9wZXJ0eTogcHJvcGVydHksCiAgICAgICAgZnVs
        bE5hbWU6IGZ1bGxOYW1lCiAgICAgIH0pOwogICAgfQoKICAgIGZ1bmN0aW9u
        IGFkZEluamVjdGlvbihydWxlcywgZmFjdG9yeU5hbWUsIHByb3BlcnR5LCBp
        bmplY3Rpb25OYW1lKSB7CiAgICAgIHZhciBpbmplY3Rpb25zID0gcnVsZXNb
        ZmFjdG9yeU5hbWVdID0gcnVsZXNbZmFjdG9yeU5hbWVdIHx8IFtdOwogICAg
        ICBpbmplY3Rpb25zLnB1c2goeyBwcm9wZXJ0eTogcHJvcGVydHksIGZ1bGxO
        YW1lOiBpbmplY3Rpb25OYW1lIH0pOwogICAgfQoKICAgIHJldHVybiBDb250
        YWluZXI7Cn0pOwoKfSkoKTsKCihmdW5jdGlvbigpIHsKLypnbG9iYWxzIEVO
        ViAqLwovKioKQG1vZHVsZSBlbWJlcgpAc3VibW9kdWxlIGVtYmVyLXJ1bnRp
        bWUKKi8KCnZhciBpbmRleE9mID0gRW1iZXIuRW51bWVyYWJsZVV0aWxzLmlu
        ZGV4T2Y7CgovKioKIFRoaXMgd2lsbCBjb21wYXJlIHR3byBqYXZhc2NyaXB0
        IHZhbHVlcyBvZiBwb3NzaWJseSBkaWZmZXJlbnQgdHlwZXMuCiBJdCB3aWxs
        IHRlbGwgeW91IHdoaWNoIG9uZSBpcyBncmVhdGVyIHRoYW4gdGhlIG90aGVy
        IGJ5IHJldHVybmluZzoKCiAgLSAtMSBpZiB0aGUgZmlyc3QgaXMgc21hbGxl
        ciB0aGFuIHRoZSBzZWNvbmQsCiAgLSAwIGlmIGJvdGggYXJlIGVxdWFsLAog
        IC0gMSBpZiB0aGUgZmlyc3QgaXMgZ3JlYXRlciB0aGFuIHRoZSBzZWNvbmQu
        CgogVGhlIG9yZGVyIGlzIGNhbGN1bGF0ZWQgYmFzZWQgb24gYEVtYmVyLk9S
        REVSX0RFRklOSVRJT05gLCBpZiB0eXBlcyBhcmUgZGlmZmVyZW50LgogSW4g
        Y2FzZSB0aGV5IGhhdmUgdGhlIHNhbWUgdHlwZSBhbiBhcHByb3ByaWF0ZSBj
        b21wYXJpc29uIGZvciB0aGlzIHR5cGUgaXMgbWFkZS4KCiAgYGBgamF2YXNj
        cmlwdAogIEVtYmVyLmNvbXBhcmUoJ2hlbGxvJywgJ2hlbGxvJyk7ICAvLyAw
        CiAgRW1iZXIuY29tcGFyZSgnYWJjJywgJ2RmZycpOyAgICAgIC8vIC0xCiAg
        RW1iZXIuY29tcGFyZSgyLCAxKTsgICAgICAgICAgICAgIC8vIDEKICBgYGAK
        CiBAbWV0aG9kIGNvbXBhcmUKIEBmb3IgRW1iZXIKIEBwYXJhbSB7T2JqZWN0
        fSB2IEZpcnN0IHZhbHVlIHRvIGNvbXBhcmUKIEBwYXJhbSB7T2JqZWN0fSB3
        IFNlY29uZCB2YWx1ZSB0byBjb21wYXJlCiBAcmV0dXJuIHtOdW1iZXJ9IC0x
        IGlmIHYgPCB3LCAwIGlmIHYgPSB3IGFuZCAxIGlmIHYgPiB3LgoqLwpFbWJl
        ci5jb21wYXJlID0gZnVuY3Rpb24gY29tcGFyZSh2LCB3KSB7CiAgaWYgKHYg
        PT09IHcpIHsgcmV0dXJuIDA7IH0KCiAgdmFyIHR5cGUxID0gRW1iZXIudHlw
        ZU9mKHYpOwogIHZhciB0eXBlMiA9IEVtYmVyLnR5cGVPZih3KTsKCiAgdmFy
        IENvbXBhcmFibGUgPSBFbWJlci5Db21wYXJhYmxlOwogIGlmIChDb21wYXJh
        YmxlKSB7CiAgICBpZiAodHlwZTE9PT0naW5zdGFuY2UnICYmIENvbXBhcmFi
        bGUuZGV0ZWN0KHYuY29uc3RydWN0b3IpKSB7CiAgICAgIHJldHVybiB2LmNv
        bnN0cnVjdG9yLmNvbXBhcmUodiwgdyk7CiAgICB9CgogICAgaWYgKHR5cGUy
        ID09PSAnaW5zdGFuY2UnICYmIENvbXBhcmFibGUuZGV0ZWN0KHcuY29uc3Ry
        dWN0b3IpKSB7CiAgICAgIHJldHVybiAxLXcuY29uc3RydWN0b3IuY29tcGFy
        ZSh3LCB2KTsKICAgIH0KICB9CgogIC8vIElmIHdlIGhhdmVuJ3QgeWV0IGdl
        bmVyYXRlZCBhIHJldmVyc2UtbWFwcGluZyBvZiBFbWJlci5PUkRFUl9ERUZJ
        TklUSU9OLAogIC8vIGRvIHNvIG5vdy4KICB2YXIgbWFwcGluZyA9IEVtYmVy
        Lk9SREVSX0RFRklOSVRJT05fTUFQUElORzsKICBpZiAoIW1hcHBpbmcpIHsK
        ICAgIHZhciBvcmRlciA9IEVtYmVyLk9SREVSX0RFRklOSVRJT047CiAgICBt
        YXBwaW5nID0gRW1iZXIuT1JERVJfREVGSU5JVElPTl9NQVBQSU5HID0ge307
        CiAgICB2YXIgaWR4LCBsZW47CiAgICBmb3IgKGlkeCA9IDAsIGxlbiA9IG9y
        ZGVyLmxlbmd0aDsgaWR4IDwgbGVuOyAgKytpZHgpIHsKICAgICAgbWFwcGlu
        Z1tvcmRlcltpZHhdXSA9IGlkeDsKICAgIH0KCiAgICAvLyBXZSBubyBsb25n
        ZXIgbmVlZCBFbWJlci5PUkRFUl9ERUZJTklUSU9OLgogICAgZGVsZXRlIEVt
        YmVyLk9SREVSX0RFRklOSVRJT047CiAgfQoKICB2YXIgdHlwZTFJbmRleCA9
        IG1hcHBpbmdbdHlwZTFdOwogIHZhciB0eXBlMkluZGV4ID0gbWFwcGluZ1t0
        eXBlMl07CgogIGlmICh0eXBlMUluZGV4IDwgdHlwZTJJbmRleCkgeyByZXR1
        cm4gLTE7IH0KICBpZiAodHlwZTFJbmRleCA+IHR5cGUySW5kZXgpIHsgcmV0
        dXJuIDE7IH0KCiAgLy8gdHlwZXMgYXJlIGVxdWFsIC0gc28gd2UgaGF2ZSB0
        byBjaGVjayB2YWx1ZXMgbm93CiAgc3dpdGNoICh0eXBlMSkgewogICAgY2Fz
        ZSAnYm9vbGVhbic6CiAgICBjYXNlICdudW1iZXInOgogICAgICBpZiAodiA8
        IHcpIHsgcmV0dXJuIC0xOyB9CiAgICAgIGlmICh2ID4gdykgeyByZXR1cm4g
        MTsgfQogICAgICByZXR1cm4gMDsKCiAgICBjYXNlICdzdHJpbmcnOgogICAg
        ICB2YXIgY29tcCA9IHYubG9jYWxlQ29tcGFyZSh3KTsKICAgICAgaWYgKGNv
        bXAgPCAwKSB7IHJldHVybiAtMTsgfQogICAgICBpZiAoY29tcCA+IDApIHsg
        cmV0dXJuIDE7IH0KICAgICAgcmV0dXJuIDA7CgogICAgY2FzZSAnYXJyYXkn
        OgogICAgICB2YXIgdkxlbiA9IHYubGVuZ3RoOwogICAgICB2YXIgd0xlbiA9
        IHcubGVuZ3RoOwogICAgICB2YXIgbCA9IE1hdGgubWluKHZMZW4sIHdMZW4p
        OwogICAgICB2YXIgciA9IDA7CiAgICAgIHZhciBpID0gMDsKICAgICAgd2hp
        bGUgKHIgPT09IDAgJiYgaSA8IGwpIHsKICAgICAgICByID0gY29tcGFyZSh2
        W2ldLHdbaV0pOwogICAgICAgIGkrKzsKICAgICAgfQogICAgICBpZiAociAh
        PT0gMCkgeyByZXR1cm4gcjsgfQoKICAgICAgLy8gYWxsIGVsZW1lbnRzIGFy
        ZSBlcXVhbCBub3cKICAgICAgLy8gc2hvcnRlciBhcnJheSBzaG91bGQgYmUg
        b3JkZXJlZCBmaXJzdAogICAgICBpZiAodkxlbiA8IHdMZW4pIHsgcmV0dXJu
        IC0xOyB9CiAgICAgIGlmICh2TGVuID4gd0xlbikgeyByZXR1cm4gMTsgfQog
        ICAgICAvLyBhcnJheXMgYXJlIGVxdWFsIG5vdwogICAgICByZXR1cm4gMDsK
        CiAgICBjYXNlICdpbnN0YW5jZSc6CiAgICAgIGlmIChFbWJlci5Db21wYXJh
        YmxlICYmIEVtYmVyLkNvbXBhcmFibGUuZGV0ZWN0KHYpKSB7CiAgICAgICAg
        cmV0dXJuIHYuY29tcGFyZSh2LCB3KTsKICAgICAgfQogICAgICByZXR1cm4g
        MDsKCiAgICBjYXNlICdkYXRlJzoKICAgICAgdmFyIHZOdW0gPSB2LmdldFRp
        bWUoKTsKICAgICAgdmFyIHdOdW0gPSB3LmdldFRpbWUoKTsKICAgICAgaWYg
        KHZOdW0gPCB3TnVtKSB7IHJldHVybiAtMTsgfQogICAgICBpZiAodk51bSA+
        IHdOdW0pIHsgcmV0dXJuIDE7IH0KICAgICAgcmV0dXJuIDA7CgogICAgZGVm
        YXVsdDoKICAgICAgcmV0dXJuIDA7CiAgfQp9OwoKZnVuY3Rpb24gX2NvcHko
        b2JqLCBkZWVwLCBzZWVuLCBjb3BpZXMpIHsKICB2YXIgcmV0LCBsb2MsIGtl
        eTsKCiAgLy8gcHJpbWl0aXZlIGRhdGEgdHlwZXMgYXJlIGltbXV0YWJsZSwg
        anVzdCByZXR1cm4gdGhlbS4KICBpZiAoJ29iamVjdCcgIT09IHR5cGVvZiBv
        YmogfHwgb2JqPT09bnVsbCkgcmV0dXJuIG9iajsKCiAgLy8gYXZvaWQgY3lj
        bGljYWwgbG9vcHMKICBpZiAoZGVlcCAmJiAobG9jPWluZGV4T2Yoc2Vlbiwg
        b2JqKSk+PTApIHJldHVybiBjb3BpZXNbbG9jXTsKCiAgRW1iZXIuYXNzZXJ0
        KCdDYW5ub3QgY2xvbmUgYW4gRW1iZXIuT2JqZWN0IHRoYXQgZG9lcyBub3Qg
        aW1wbGVtZW50IEVtYmVyLkNvcHlhYmxlJywgIShvYmogaW5zdGFuY2VvZiBF
        bWJlci5PYmplY3QpIHx8IChFbWJlci5Db3B5YWJsZSAmJiBFbWJlci5Db3B5
        YWJsZS5kZXRlY3Qob2JqKSkpOwoKICAvLyBJTVBPUlRBTlQ6IHRoaXMgc3Bl
        Y2lmaWMgdGVzdCB3aWxsIGRldGVjdCBhIG5hdGl2ZSBhcnJheSBvbmx5LiBB
        bnkgb3RoZXIKICAvLyBvYmplY3Qgd2lsbCBuZWVkIHRvIGltcGxlbWVudCBD
        b3B5YWJsZS4KICBpZiAoRW1iZXIudHlwZU9mKG9iaikgPT09ICdhcnJheScp
        IHsKICAgIHJldCA9IG9iai5zbGljZSgpOwogICAgaWYgKGRlZXApIHsKICAg
        ICAgbG9jID0gcmV0Lmxlbmd0aDsKICAgICAgd2hpbGUoLS1sb2M+PTApIHJl
        dFtsb2NdID0gX2NvcHkocmV0W2xvY10sIGRlZXAsIHNlZW4sIGNvcGllcyk7
        CiAgICB9CiAgfSBlbHNlIGlmIChFbWJlci5Db3B5YWJsZSAmJiBFbWJlci5D
        b3B5YWJsZS5kZXRlY3Qob2JqKSkgewogICAgcmV0ID0gb2JqLmNvcHkoZGVl
        cCwgc2VlbiwgY29waWVzKTsKICB9IGVsc2UgewogICAgcmV0ID0ge307CiAg
        ICBmb3Ioa2V5IGluIG9iaikgewogICAgICBpZiAoIW9iai5oYXNPd25Qcm9w
        ZXJ0eShrZXkpKSBjb250aW51ZTsKCiAgICAgIC8vIFByZXZlbnRzIGJyb3dz
        ZXJzIHRoYXQgZG9uJ3QgcmVzcGVjdCBub24tZW51bWVyYWJpbGl0eSBmcm9t
        CiAgICAgIC8vIGNvcHlpbmcgaW50ZXJuYWwgRW1iZXIgcHJvcGVydGllcwog
        ICAgICBpZiAoa2V5LnN1YnN0cmluZygwLDIpID09PSAnX18nKSBjb250aW51
        ZTsKCiAgICAgIHJldFtrZXldID0gZGVlcCA/IF9jb3B5KG9ialtrZXldLCBk
        ZWVwLCBzZWVuLCBjb3BpZXMpIDogb2JqW2tleV07CiAgICB9CiAgfQoKICBp
        ZiAoZGVlcCkgewogICAgc2Vlbi5wdXNoKG9iaik7CiAgICBjb3BpZXMucHVz
        aChyZXQpOwogIH0KCiAgcmV0dXJuIHJldDsKfQoKLyoqCiAgQ3JlYXRlcyBh
        IGNsb25lIG9mIHRoZSBwYXNzZWQgb2JqZWN0LiBUaGlzIGZ1bmN0aW9uIGNh
        biB0YWtlIGp1c3QgYWJvdXQKICBhbnkgdHlwZSBvZiBvYmplY3QgYW5kIGNy
        ZWF0ZSBhIGNsb25lIG9mIGl0LCBpbmNsdWRpbmcgcHJpbWl0aXZlIHZhbHVl
        cwogICh3aGljaCBhcmUgbm90IGFjdHVhbGx5IGNsb25lZCBiZWNhdXNlIHRo
        ZXkgYXJlIGltbXV0YWJsZSkuCgogIElmIHRoZSBwYXNzZWQgb2JqZWN0IGlt
        cGxlbWVudHMgdGhlIGBjbG9uZSgpYCBtZXRob2QsIHRoZW4gdGhpcyBmdW5j
        dGlvbgogIHdpbGwgc2ltcGx5IGNhbGwgdGhhdCBtZXRob2QgYW5kIHJldHVy
        biB0aGUgcmVzdWx0LgoKICBAbWV0aG9kIGNvcHkKICBAZm9yIEVtYmVyCiAg
        QHBhcmFtIHtPYmplY3R9IG9iaiBUaGUgb2JqZWN0IHRvIGNsb25lCiAgQHBh
        cmFtIHtCb29sZWFufSBkZWVwIElmIHRydWUsIGEgZGVlcCBjb3B5IG9mIHRo
        ZSBvYmplY3QgaXMgbWFkZQogIEByZXR1cm4ge09iamVjdH0gVGhlIGNsb25l
        ZCBvYmplY3QKKi8KRW1iZXIuY29weSA9IGZ1bmN0aW9uKG9iaiwgZGVlcCkg
        ewogIC8vIGZhc3QgcGF0aHMKICBpZiAoJ29iamVjdCcgIT09IHR5cGVvZiBv
        YmogfHwgb2JqPT09bnVsbCkgcmV0dXJuIG9iajsgLy8gY2FuJ3QgY29weSBw
        cmltaXRpdmVzCiAgaWYgKEVtYmVyLkNvcHlhYmxlICYmIEVtYmVyLkNvcHlh
        YmxlLmRldGVjdChvYmopKSByZXR1cm4gb2JqLmNvcHkoZGVlcCk7CiAgcmV0
        dXJuIF9jb3B5KG9iaiwgZGVlcCwgZGVlcCA/IFtdIDogbnVsbCwgZGVlcCA/
        IFtdIDogbnVsbCk7Cn07CgovKioKICBDb252ZW5pZW5jZSBtZXRob2QgdG8g
        aW5zcGVjdCBhbiBvYmplY3QuIFRoaXMgbWV0aG9kIHdpbGwgYXR0ZW1wdCB0
        bwogIGNvbnZlcnQgdGhlIG9iamVjdCBpbnRvIGEgdXNlZnVsIHN0cmluZyBk
        ZXNjcmlwdGlvbi4KCiAgSXQgaXMgYSBwcmV0dHkgc2ltcGxlIGltcGxlbWVu
        dGF0aW9uLiBJZiB5b3Ugd2FudCBzb21ldGhpbmcgbW9yZSByb2J1c3QsCiAg
        dXNlIHNvbWV0aGluZyBsaWtlIEpTRHVtcDogaHR0cHM6Ly9naXRodWIuY29t
        L05WL2pzRHVtcAoKICBAbWV0aG9kIGluc3BlY3QKICBAZm9yIEVtYmVyCiAg
        QHBhcmFtIHtPYmplY3R9IG9iaiBUaGUgb2JqZWN0IHlvdSB3YW50IHRvIGlu
        c3BlY3QuCiAgQHJldHVybiB7U3RyaW5nfSBBIGRlc2NyaXB0aW9uIG9mIHRo
        ZSBvYmplY3QKKi8KRW1iZXIuaW5zcGVjdCA9IGZ1bmN0aW9uKG9iaikgewog
        IHZhciB0eXBlID0gRW1iZXIudHlwZU9mKG9iaik7CiAgaWYgKHR5cGUgPT09
        ICdhcnJheScpIHsKICAgIHJldHVybiAnWycgKyBvYmogKyAnXSc7CiAgfQog
        IGlmICh0eXBlICE9PSAnb2JqZWN0JykgewogICAgcmV0dXJuIG9iaiArICcn
        OwogIH0KCiAgdmFyIHYsIHJldCA9IFtdOwogIGZvcih2YXIga2V5IGluIG9i
        aikgewogICAgaWYgKG9iai5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7CiAgICAg
        IHYgPSBvYmpba2V5XTsKICAgICAgaWYgKHYgPT09ICd0b1N0cmluZycpIHsg
        Y29udGludWU7IH0gLy8gaWdub3JlIHVzZWxlc3MgaXRlbXMKICAgICAgaWYg
        KEVtYmVyLnR5cGVPZih2KSA9PT0gJ2Z1bmN0aW9uJykgeyB2ID0gImZ1bmN0
        aW9uKCkgeyAuLi4gfSI7IH0KICAgICAgcmV0LnB1c2goa2V5ICsgIjogIiAr
        IHYpOwogICAgfQogIH0KICByZXR1cm4gInsiICsgcmV0LmpvaW4oIiwgIikg
        KyAifSI7Cn07CgovKioKICBDb21wYXJlcyB0d28gb2JqZWN0cywgcmV0dXJu
        aW5nIHRydWUgaWYgdGhleSBhcmUgbG9naWNhbGx5IGVxdWFsLiBUaGlzIGlz
        CiAgYSBkZWVwZXIgY29tcGFyaXNvbiB0aGFuIGEgc2ltcGxlIHRyaXBsZSBl
        cXVhbC4gRm9yIHNldHMgaXQgd2lsbCBjb21wYXJlIHRoZQogIGludGVybmFs
        IG9iamVjdHMuIEZvciBhbnkgb3RoZXIgb2JqZWN0IHRoYXQgaW1wbGVtZW50
        cyBgaXNFcXVhbCgpYCBpdCB3aWxsCiAgcmVzcGVjdCB0aGF0IG1ldGhvZC4K
        CiAgYGBgamF2YXNjcmlwdAogIEVtYmVyLmlzRXF1YWwoJ2hlbGxvJywgJ2hl
        bGxvJyk7ICAvLyB0cnVlCiAgRW1iZXIuaXNFcXVhbCgxLCAyKTsgICAgICAg
        ICAgICAgIC8vIGZhbHNlCiAgRW1iZXIuaXNFcXVhbChbNCwyXSwgWzQsMl0p
        OyAgICAgIC8vIGZhbHNlCiAgYGBgCgogIEBtZXRob2QgaXNFcXVhbAogIEBm
        b3IgRW1iZXIKICBAcGFyYW0ge09iamVjdH0gYSBmaXJzdCBvYmplY3QgdG8g
        Y29tcGFyZQogIEBwYXJhbSB7T2JqZWN0fSBiIHNlY29uZCBvYmplY3QgdG8g
        Y29tcGFyZQogIEByZXR1cm4ge0Jvb2xlYW59CiovCkVtYmVyLmlzRXF1YWwg
        PSBmdW5jdGlvbihhLCBiKSB7CiAgaWYgKGEgJiYgJ2Z1bmN0aW9uJz09PXR5
        cGVvZiBhLmlzRXF1YWwpIHJldHVybiBhLmlzRXF1YWwoYik7CiAgcmV0dXJu
        IGEgPT09IGI7Cn07CgovLyBVc2VkIGJ5IEVtYmVyLmNvbXBhcmUKRW1iZXIu
        T1JERVJfREVGSU5JVElPTiA9IEVtYmVyLkVOVi5PUkRFUl9ERUZJTklUSU9O
        IHx8IFsKICAndW5kZWZpbmVkJywKICAnbnVsbCcsCiAgJ2Jvb2xlYW4nLAog
        ICdudW1iZXInLAogICdzdHJpbmcnLAogICdhcnJheScsCiAgJ29iamVjdCcs
        CiAgJ2luc3RhbmNlJywKICAnZnVuY3Rpb24nLAogICdjbGFzcycsCiAgJ2Rh
        dGUnCl07CgovKioKICBSZXR1cm5zIGFsbCBvZiB0aGUga2V5cyBkZWZpbmVk
        IG9uIGFuIG9iamVjdCBvciBoYXNoLiBUaGlzIGlzIHVzZWZ1bAogIHdoZW4g
        aW5zcGVjdGluZyBvYmplY3RzIGZvciBkZWJ1Z2dpbmcuIE9uIGJyb3dzZXJz
        IHRoYXQgc3VwcG9ydCBpdCwgdGhpcwogIHVzZXMgdGhlIG5hdGl2ZSBgT2Jq
        ZWN0LmtleXNgIGltcGxlbWVudGF0aW9uLgoKICBAbWV0aG9kIGtleXMKICBA
        Zm9yIEVtYmVyCiAgQHBhcmFtIHtPYmplY3R9IG9iagogIEByZXR1cm4ge0Fy
        cmF5fSBBcnJheSBjb250YWluaW5nIGtleXMgb2Ygb2JqCiovCkVtYmVyLmtl
        eXMgPSBPYmplY3Qua2V5czsKCmlmICghRW1iZXIua2V5cyB8fCBFbWJlci5j
        cmVhdGUuaXNTaW11bGF0ZWQpIHsKICB2YXIgcHJvdG90eXBlUHJvcGVydGll
        cyA9IFsKICAgICdjb25zdHJ1Y3RvcicsCiAgICAnaGFzT3duUHJvcGVydHkn
        LAogICAgJ2lzUHJvdG90eXBlT2YnLAogICAgJ3Byb3BlcnR5SXNFbnVtZXJh
        YmxlJywKICAgICd2YWx1ZU9mJywKICAgICd0b0xvY2FsZVN0cmluZycsCiAg
        ICAndG9TdHJpbmcnCiAgXSwKICBwdXNoUHJvcGVydHlOYW1lID0gZnVuY3Rp
        b24ob2JqLCBhcnJheSwga2V5KSB7CiAgICAvLyBQcmV2ZW50cyBicm93c2Vy
        cyB0aGF0IGRvbid0IHJlc3BlY3Qgbm9uLWVudW1lcmFiaWxpdHkgZnJvbQog
        ICAgLy8gY29weWluZyBpbnRlcm5hbCBFbWJlciBwcm9wZXJ0aWVzCiAgICBp
        ZiAoa2V5LnN1YnN0cmluZygwLDIpID09PSAnX18nKSByZXR1cm47CiAgICBp
        ZiAoa2V5ID09PSAnX3N1cGVyJykgcmV0dXJuOwogICAgaWYgKGluZGV4T2Yo
        YXJyYXksIGtleSkgPj0gMCkgcmV0dXJuOwogICAgaWYgKCFvYmouaGFzT3du
        UHJvcGVydHkoa2V5KSkgcmV0dXJuOwoKICAgIGFycmF5LnB1c2goa2V5KTsK
        ICB9OwoKICBFbWJlci5rZXlzID0gZnVuY3Rpb24ob2JqKSB7CiAgICB2YXIg
        cmV0ID0gW10sIGtleTsKICAgIGZvciAoa2V5IGluIG9iaikgewogICAgICBw
        dXNoUHJvcGVydHlOYW1lKG9iaiwgcmV0LCBrZXkpOwogICAgfQoKICAgIC8v
        IElFOCBkb2Vzbid0IGVudW1lcmF0ZSBwcm9wZXJ0eSB0aGF0IG5hbWVkIHRo
        ZSBzYW1lIGFzIHByb3RvdHlwZSBwcm9wZXJ0aWVzLgogICAgZm9yICh2YXIg
        aSA9IDAsIGwgPSBwcm90b3R5cGVQcm9wZXJ0aWVzLmxlbmd0aDsgaSA8IGw7
        IGkrKykgewogICAgICBrZXkgPSBwcm90b3R5cGVQcm9wZXJ0aWVzW2ldOwoK
        ICAgICAgcHVzaFByb3BlcnR5TmFtZShvYmosIHJldCwga2V5KTsKICAgIH0K
        CiAgICByZXR1cm4gcmV0OwogIH07Cn0KCi8vIC4uLi4uLi4uLi4uLi4uLi4u
        Li4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4KLy8g
        RVJST1IKLy8KCnZhciBlcnJvclByb3BzID0gWydkZXNjcmlwdGlvbicsICdm
        aWxlTmFtZScsICdsaW5lTnVtYmVyJywgJ21lc3NhZ2UnLCAnbmFtZScsICdu
        dW1iZXInLCAnc3RhY2snXTsKCi8qKgogIEEgc3ViY2xhc3Mgb2YgdGhlIEph
        dmFTY3JpcHQgRXJyb3Igb2JqZWN0IGZvciB1c2UgaW4gRW1iZXIuCgogIEBj
        bGFzcyBFcnJvcgogIEBuYW1lc3BhY2UgRW1iZXIKICBAZXh0ZW5kcyBFcnJv
        cgogIEBjb25zdHJ1Y3RvcgoqLwpFbWJlci5FcnJvciA9IGZ1bmN0aW9uKCkg
        ewogIHZhciB0bXAgPSBFcnJvci5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwoK
        ICAvLyBVbmZvcnR1bmF0ZWx5IGVycm9ycyBhcmUgbm90IGVudW1lcmFibGUg
        aW4gQ2hyb21lIChhdCBsZWFzdCksIHNvIGBmb3IgcHJvcCBpbiB0bXBgIGRv
        ZXNuJ3Qgd29yay4KICBmb3IgKHZhciBpZHggPSAwOyBpZHggPCBlcnJvclBy
        b3BzLmxlbmd0aDsgaWR4KyspIHsKICAgIHRoaXNbZXJyb3JQcm9wc1tpZHhd
        XSA9IHRtcFtlcnJvclByb3BzW2lkeF1dOwogIH0KfTsKCkVtYmVyLkVycm9y
        LnByb3RvdHlwZSA9IEVtYmVyLmNyZWF0ZShFcnJvci5wcm90b3R5cGUpOwoK
        fSkoKTsKCgoKKGZ1bmN0aW9uKCkgewovKioKQG1vZHVsZSBlbWJlcgpAc3Vi
        bW9kdWxlIGVtYmVyLXJ1bnRpbWUKKi8KCi8vIC4uLi4uLi4uLi4uLi4uLi4u
        Li4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4KLy8g
        SEVMUEVSUwovLwoKdmFyIGdldCA9IEVtYmVyLmdldCwgc2V0ID0gRW1iZXIu
        c2V0Owp2YXIgYV9zbGljZSA9IEFycmF5LnByb3RvdHlwZS5zbGljZTsKdmFy
        IGFfaW5kZXhPZiA9IEVtYmVyLkVudW1lcmFibGVVdGlscy5pbmRleE9mOwoK
        dmFyIGNvbnRleHRzID0gW107CgpmdW5jdGlvbiBwb3BDdHgoKSB7CiAgcmV0
        dXJuIGNvbnRleHRzLmxlbmd0aD09PTAgPyB7fSA6IGNvbnRleHRzLnBvcCgp
        Owp9CgpmdW5jdGlvbiBwdXNoQ3R4KGN0eCkgewogIGNvbnRleHRzLnB1c2go
        Y3R4KTsKICByZXR1cm4gbnVsbDsKfQoKZnVuY3Rpb24gaXRlcihrZXksIHZh
        bHVlKSB7CiAgdmFyIHZhbHVlUHJvdmlkZWQgPSBhcmd1bWVudHMubGVuZ3Ro
        ID09PSAyOwoKICBmdW5jdGlvbiBpKGl0ZW0pIHsKICAgIHZhciBjdXIgPSBn
        ZXQoaXRlbSwga2V5KTsKICAgIHJldHVybiB2YWx1ZVByb3ZpZGVkID8gdmFs
        dWU9PT1jdXIgOiAhIWN1cjsKICB9CiAgcmV0dXJuIGkgOwp9CgovKioKICBU
        aGlzIG1peGluIGRlZmluZXMgdGhlIGNvbW1vbiBpbnRlcmZhY2UgaW1wbGVt
        ZW50ZWQgYnkgZW51bWVyYWJsZSBvYmplY3RzCiAgaW4gRW1iZXIuIE1vc3Qg
        b2YgdGhlc2UgbWV0aG9kcyBmb2xsb3cgdGhlIHN0YW5kYXJkIEFycmF5IGl0
        ZXJhdGlvbgogIEFQSSBkZWZpbmVkIHVwIHRvIEphdmFTY3JpcHQgMS44IChl
        eGNsdWRpbmcgbGFuZ3VhZ2Utc3BlY2lmaWMgZmVhdHVyZXMgdGhhdAogIGNh
        bm5vdCBiZSBlbXVsYXRlZCBpbiBvbGRlciB2ZXJzaW9ucyBvZiBKYXZhU2Ny
        aXB0KS4KCiAgVGhpcyBtaXhpbiBpcyBhcHBsaWVkIGF1dG9tYXRpY2FsbHkg
        dG8gdGhlIEFycmF5IGNsYXNzIG9uIHBhZ2UgbG9hZCwgc28geW91CiAgY2Fu
        IHVzZSBhbnkgb2YgdGhlc2UgbWV0aG9kcyBvbiBzaW1wbGUgYXJyYXlzLiBJ
        ZiBBcnJheSBhbHJlYWR5IGltcGxlbWVudHMKICBvbmUgb2YgdGhlc2UgbWV0
        aG9kcywgdGhlIG1peGluIHdpbGwgbm90IG92ZXJyaWRlIHRoZW0uCgogICMj
        IFdyaXRpbmcgWW91ciBPd24gRW51bWVyYWJsZQoKICBUbyBtYWtlIHlvdXIg
        b3duIGN1c3RvbSBjbGFzcyBlbnVtZXJhYmxlLCB5b3UgbmVlZCB0d28gaXRl
        bXM6CgogIDEuIFlvdSBtdXN0IGhhdmUgYSBsZW5ndGggcHJvcGVydHkuIFRo
        aXMgcHJvcGVydHkgc2hvdWxkIGNoYW5nZSB3aGVuZXZlcgogICAgIHRoZSBu
        dW1iZXIgb2YgaXRlbXMgaW4geW91ciBlbnVtZXJhYmxlIG9iamVjdCBjaGFu
        Z2VzLiBJZiB5b3UgdXNpbmcgdGhpcwogICAgIHdpdGggYW4gYEVtYmVyLk9i
        amVjdGAgc3ViY2xhc3MsIHlvdSBzaG91bGQgYmUgc3VyZSB0byBjaGFuZ2Ug
        dGhlIGxlbmd0aAogICAgIHByb3BlcnR5IHVzaW5nIGBzZXQoKS5gCgogIDIu
        IElmIHlvdSBtdXN0IGltcGxlbWVudCBgbmV4dE9iamVjdCgpLmAgU2VlIGRv
        Y3VtZW50YXRpb24uCgogIE9uY2UgeW91IGhhdmUgdGhlc2UgdHdvIG1ldGhv
        ZHMgaW1wbGVtZW50LCBhcHBseSB0aGUgYEVtYmVyLkVudW1lcmFibGVgIG1p
        eGluCiAgdG8geW91ciBjbGFzcyBhbmQgeW91IHdpbGwgYmUgYWJsZSB0byBl
        bnVtZXJhdGUgdGhlIGNvbnRlbnRzIG9mIHlvdXIgb2JqZWN0CiAgbGlrZSBh
        bnkgb3RoZXIgY29sbGVjdGlvbi4KCiAgIyMgVXNpbmcgRW1iZXIgRW51bWVy
        YXRpb24gd2l0aCBPdGhlciBMaWJyYXJpZXMKCiAgTWFueSBvdGhlciBsaWJy
        YXJpZXMgcHJvdmlkZSBzb21lIGtpbmQgb2YgaXRlcmF0b3Igb3IgZW51bWVy
        YXRpb24gbGlrZQogIGZhY2lsaXR5LiBUaGlzIGlzIG9mdGVuIHdoZXJlIHRo
        ZSBtb3N0IGNvbW1vbiBBUEkgY29uZmxpY3RzIG9jY3VyLgogIEVtYmVyJ3Mg
        QVBJIGlzIGRlc2lnbmVkIHRvIGJlIGFzIGZyaWVuZGx5IGFzIHBvc3NpYmxl
        IHdpdGggb3RoZXIKICBsaWJyYXJpZXMgYnkgaW1wbGVtZW50aW5nIG9ubHkg
        bWV0aG9kcyB0aGF0IG1vc3RseSBjb3JyZXNwb25kIHRvIHRoZQogIEphdmFT
        Y3JpcHQgMS44IEFQSS4KCiAgQGNsYXNzIEVudW1lcmFibGUKICBAbmFtZXNw
        YWNlIEVtYmVyCiAgQHNpbmNlIEVtYmVyIDAuOQoqLwpFbWJlci5FbnVtZXJh
        YmxlID0gRW1iZXIuTWl4aW4uY3JlYXRlKHsKCiAgLyoqCiAgICBJbXBsZW1l
        bnQgdGhpcyBtZXRob2QgdG8gbWFrZSB5b3VyIGNsYXNzIGVudW1lcmFibGUu
        CgogICAgVGhpcyBtZXRob2Qgd2lsbCBiZSBjYWxsIHJlcGVhdGVkbHkgZHVy
        aW5nIGVudW1lcmF0aW9uLiBUaGUgaW5kZXggdmFsdWUKICAgIHdpbGwgYWx3
        YXlzIGJlZ2luIHdpdGggMCBhbmQgaW5jcmVtZW50IG1vbm90b25pY2FsbHku
        IFlvdSBkb24ndCBoYXZlIHRvCiAgICByZWx5IG9uIHRoZSBpbmRleCB2YWx1
        ZSB0byBkZXRlcm1pbmUgd2hhdCBvYmplY3QgdG8gcmV0dXJuLCBidXQgeW91
        IHNob3VsZAogICAgYWx3YXlzIGNoZWNrIHRoZSB2YWx1ZSBhbmQgc3RhcnQg
        ZnJvbSB0aGUgYmVnaW5uaW5nIHdoZW4geW91IHNlZSB0aGUKICAgIHJlcXVl
        c3RlZCBpbmRleCBpcyAwLgoKICAgIFRoZSBgcHJldmlvdXNPYmplY3RgIGlz
        IHRoZSBvYmplY3QgdGhhdCB3YXMgcmV0dXJuZWQgZnJvbSB0aGUgbGFzdCBj
        YWxsCiAgICB0byBgbmV4dE9iamVjdGAgZm9yIHRoZSBjdXJyZW50IGl0ZXJh
        dGlvbi4gVGhpcyBpcyBhIHVzZWZ1bCB3YXkgdG8KICAgIG1hbmFnZSBpdGVy
        YXRpb24gaWYgeW91IGFyZSB0cmFjaW5nIGEgbGlua2VkIGxpc3QsIGZvciBl
        eGFtcGxlLgoKICAgIEZpbmFsbHkgdGhlIGNvbnRleHQgcGFyYW1ldGVyIHdp
        bGwgYWx3YXlzIGNvbnRhaW4gYSBoYXNoIHlvdSBjYW4gdXNlIGFzCiAgICBh
        ICJzY3JhdGNocGFkIiB0byBtYWludGFpbiBhbnkgb3RoZXIgc3RhdGUgeW91
        IG5lZWQgaW4gb3JkZXIgdG8gaXRlcmF0ZQogICAgcHJvcGVybHkuIFRoZSBj
        b250ZXh0IG9iamVjdCBpcyByZXVzZWQgYW5kIGlzIG5vdCByZXNldCBiZXR3
        ZWVuCiAgICBpdGVyYXRpb25zIHNvIG1ha2Ugc3VyZSB5b3Ugc2V0dXAgdGhl
        IGNvbnRleHQgd2l0aCBhIGZyZXNoIHN0YXRlIHdoZW5ldmVyCiAgICB0aGUg
        aW5kZXggcGFyYW1ldGVyIGlzIDAuCgogICAgR2VuZXJhbGx5IGl0ZXJhdG9y
        cyB3aWxsIGNvbnRpbnVlIHRvIGNhbGwgYG5leHRPYmplY3RgIHVudGlsIHRo
        ZSBpbmRleAogICAgcmVhY2hlcyB0aGUgeW91ciBjdXJyZW50IGxlbmd0aC0x
        LiBJZiB5b3UgcnVuIG91dCBvZiBkYXRhIGJlZm9yZSB0aGlzCiAgICB0aW1l
        IGZvciBzb21lIHJlYXNvbiwgeW91IHNob3VsZCBzaW1wbHkgcmV0dXJuIHVu
        ZGVmaW5lZC4KCiAgICBUaGUgZGVmYXVsdCBpbXBsZW1lbnRhdGlvbiBvZiB0
        aGlzIG1ldGhvZCBzaW1wbHkgbG9va3MgdXAgdGhlIGluZGV4LgogICAgVGhp
        cyB3b3JrcyBncmVhdCBvbiBhbnkgQXJyYXktbGlrZSBvYmplY3RzLgoKICAg
        IEBtZXRob2QgbmV4dE9iamVjdAogICAgQHBhcmFtIHtOdW1iZXJ9IGluZGV4
        IHRoZSBjdXJyZW50IGluZGV4IG9mIHRoZSBpdGVyYXRpb24KICAgIEBwYXJh
        bSB7T2JqZWN0fSBwcmV2aW91c09iamVjdCB0aGUgdmFsdWUgcmV0dXJuZWQg
        YnkgdGhlIGxhc3QgY2FsbCB0bwogICAgICBgbmV4dE9iamVjdGAuCiAgICBA
        cGFyYW0ge09iamVjdH0gY29udGV4dCBhIGNvbnRleHQgb2JqZWN0IHlvdSBj
        YW4gdXNlIHRvIG1haW50YWluIHN0YXRlLgogICAgQHJldHVybiB7T2JqZWN0
        fSB0aGUgbmV4dCBvYmplY3QgaW4gdGhlIGl0ZXJhdGlvbiBvciB1bmRlZmlu
        ZWQKICAqLwogIG5leHRPYmplY3Q6IEVtYmVyLnJlcXVpcmVkKEZ1bmN0aW9u
        KSwKCiAgLyoqCiAgICBIZWxwZXIgbWV0aG9kIHJldHVybnMgdGhlIGZpcnN0
        IG9iamVjdCBmcm9tIGEgY29sbGVjdGlvbi4gVGhpcyBpcyB1c3VhbGx5CiAg
        ICB1c2VkIGJ5IGJpbmRpbmdzIGFuZCBvdGhlciBwYXJ0cyBvZiB0aGUgZnJh
        bWV3b3JrIHRvIGV4dHJhY3QgYSBzaW5nbGUKICAgIG9iamVjdCBpZiB0aGUg
        ZW51bWVyYWJsZSBjb250YWlucyBvbmx5IG9uZSBpdGVtLgoKICAgIElmIHlv
        dSBvdmVycmlkZSB0aGlzIG1ldGhvZCwgeW91IHNob3VsZCBpbXBsZW1lbnQg
        aXQgc28gdGhhdCBpdCB3aWxsCiAgICBhbHdheXMgcmV0dXJuIHRoZSBzYW1l
        IHZhbHVlIGVhY2ggdGltZSBpdCBpcyBjYWxsZWQuIElmIHlvdXIgZW51bWVy
        YWJsZQogICAgY29udGFpbnMgb25seSBvbmUgb2JqZWN0LCB0aGlzIG1ldGhv
        ZCBzaG91bGQgYWx3YXlzIHJldHVybiB0aGF0IG9iamVjdC4KICAgIElmIHlv
        dXIgZW51bWVyYWJsZSBpcyBlbXB0eSwgdGhpcyBtZXRob2Qgc2hvdWxkIHJl
        dHVybiBgdW5kZWZpbmVkYC4KCiAgICBgYGBqYXZhc2NyaXB0CiAgICB2YXIg
        YXJyID0gWyJhIiwgImIiLCAiYyJdOwogICAgYXJyLmdldCgnZmlyc3RPYmpl
        Y3QnKTsgIC8vICJhIgoKICAgIHZhciBhcnIgPSBbXTsKICAgIGFyci5nZXQo
        J2ZpcnN0T2JqZWN0Jyk7ICAvLyB1bmRlZmluZWQKICAgIGBgYAoKICAgIEBw
        cm9wZXJ0eSBmaXJzdE9iamVjdAogICAgQHJldHVybiB7T2JqZWN0fSB0aGUg
        b2JqZWN0IG9yIHVuZGVmaW5lZAogICovCiAgZmlyc3RPYmplY3Q6IEVtYmVy
        LmNvbXB1dGVkKGZ1bmN0aW9uKCkgewogICAgaWYgKGdldCh0aGlzLCAnbGVu
        Z3RoJyk9PT0wKSByZXR1cm4gdW5kZWZpbmVkIDsKCiAgICAvLyBoYW5kbGUg
        Z2VuZXJpYyBlbnVtZXJhYmxlcwogICAgdmFyIGNvbnRleHQgPSBwb3BDdHgo
        KSwgcmV0OwogICAgcmV0ID0gdGhpcy5uZXh0T2JqZWN0KDAsIG51bGwsIGNv
        bnRleHQpOwogICAgcHVzaEN0eChjb250ZXh0KTsKICAgIHJldHVybiByZXQg
        OwogIH0pLnByb3BlcnR5KCdbXScpLAoKICAvKioKICAgIEhlbHBlciBtZXRo
        b2QgcmV0dXJucyB0aGUgbGFzdCBvYmplY3QgZnJvbSBhIGNvbGxlY3Rpb24u
        IElmIHlvdXIgZW51bWVyYWJsZQogICAgY29udGFpbnMgb25seSBvbmUgb2Jq
        ZWN0LCB0aGlzIG1ldGhvZCBzaG91bGQgYWx3YXlzIHJldHVybiB0aGF0IG9i
        amVjdC4KICAgIElmIHlvdXIgZW51bWVyYWJsZSBpcyBlbXB0eSwgdGhpcyBt
        ZXRob2Qgc2hvdWxkIHJldHVybiBgdW5kZWZpbmVkYC4KCiAgICBgYGBqYXZh
        c2NyaXB0CiAgICB2YXIgYXJyID0gWyJhIiwgImIiLCAiYyJdOwogICAgYXJy
        LmdldCgnbGFzdE9iamVjdCcpOyAgLy8gImMiCgogICAgdmFyIGFyciA9IFtd
        OwogICAgYXJyLmdldCgnbGFzdE9iamVjdCcpOyAgLy8gdW5kZWZpbmVkCiAg
        ICBgYGAKCiAgICBAcHJvcGVydHkgbGFzdE9iamVjdAogICAgQHJldHVybiB7
        T2JqZWN0fSB0aGUgbGFzdCBvYmplY3Qgb3IgdW5kZWZpbmVkCiAgKi8KICBs
        YXN0T2JqZWN0OiBFbWJlci5jb21wdXRlZChmdW5jdGlvbigpIHsKICAgIHZh
        ciBsZW4gPSBnZXQodGhpcywgJ2xlbmd0aCcpOwogICAgaWYgKGxlbj09PTAp
        IHJldHVybiB1bmRlZmluZWQgOwogICAgdmFyIGNvbnRleHQgPSBwb3BDdHgo
        KSwgaWR4PTAsIGN1ciwgbGFzdCA9IG51bGw7CiAgICBkbyB7CiAgICAgIGxh
        c3QgPSBjdXI7CiAgICAgIGN1ciA9IHRoaXMubmV4dE9iamVjdChpZHgrKywg
        bGFzdCwgY29udGV4dCk7CiAgICB9IHdoaWxlIChjdXIgIT09IHVuZGVmaW5l
        ZCk7CiAgICBwdXNoQ3R4KGNvbnRleHQpOwogICAgcmV0dXJuIGxhc3Q7CiAg
        fSkucHJvcGVydHkoJ1tdJyksCgogIC8qKgogICAgUmV0dXJucyBgdHJ1ZWAg
        aWYgdGhlIHBhc3NlZCBvYmplY3QgY2FuIGJlIGZvdW5kIGluIHRoZSByZWNl
        aXZlci4gVGhlCiAgICBkZWZhdWx0IHZlcnNpb24gd2lsbCBpdGVyYXRlIHRo
        cm91Z2ggdGhlIGVudW1lcmFibGUgdW50aWwgdGhlIG9iamVjdAogICAgaXMg
        Zm91bmQuIFlvdSBtYXkgd2FudCB0byBvdmVycmlkZSB0aGlzIHdpdGggYSBt
        b3JlIGVmZmljaWVudCB2ZXJzaW9uLgoKICAgIGBgYGphdmFzY3JpcHQKICAg
        IHZhciBhcnIgPSBbImEiLCAiYiIsICJjIl07CiAgICBhcnIuY29udGFpbnMo
        ImEiKTsgLy8gdHJ1ZQogICAgYXJyLmNvbnRhaW5zKCJ6Iik7IC8vIGZhbHNl
        CiAgICBgYGAKCiAgICBAbWV0aG9kIGNvbnRhaW5zCiAgICBAcGFyYW0ge09i
        amVjdH0gb2JqIFRoZSBvYmplY3QgdG8gc2VhcmNoIGZvci4KICAgIEByZXR1
        cm4ge0Jvb2xlYW59IGB0cnVlYCBpZiBvYmplY3QgaXMgZm91bmQgaW4gZW51
        bWVyYWJsZS4KICAqLwogIGNvbnRhaW5zOiBmdW5jdGlvbihvYmopIHsKICAg
        IHJldHVybiB0aGlzLmZpbmQoZnVuY3Rpb24oaXRlbSkgeyByZXR1cm4gaXRl
        bT09PW9iajsgfSkgIT09IHVuZGVmaW5lZDsKICB9LAoKICAvKioKICAgIEl0
        ZXJhdGVzIHRocm91Z2ggdGhlIGVudW1lcmFibGUsIGNhbGxpbmcgdGhlIHBh
        c3NlZCBmdW5jdGlvbiBvbiBlYWNoCiAgICBpdGVtLiBUaGlzIG1ldGhvZCBj
        b3JyZXNwb25kcyB0byB0aGUgYGZvckVhY2goKWAgbWV0aG9kIGRlZmluZWQg
        aW4KICAgIEphdmFTY3JpcHQgMS42LgoKICAgIFRoZSBjYWxsYmFjayBtZXRo
        b2QgeW91IHByb3ZpZGUgc2hvdWxkIGhhdmUgdGhlIGZvbGxvd2luZyBzaWdu
        YXR1cmUgKGFsbAogICAgcGFyYW1ldGVycyBhcmUgb3B0aW9uYWwpOgoKICAg
        IGBgYGphdmFzY3JpcHQKICAgIGZ1bmN0aW9uKGl0ZW0sIGluZGV4LCBlbnVt
        ZXJhYmxlKTsKICAgIGBgYAoKICAgIC0gYGl0ZW1gIGlzIHRoZSBjdXJyZW50
        IGl0ZW0gaW4gdGhlIGl0ZXJhdGlvbi4KICAgIC0gYGluZGV4YCBpcyB0aGUg
        Y3VycmVudCBpbmRleCBpbiB0aGUgaXRlcmF0aW9uLgogICAgLSBgZW51bWVy
        YWJsZWAgaXMgdGhlIGVudW1lcmFibGUgb2JqZWN0IGl0c2VsZi4KCiAgICBO
        b3RlIHRoYXQgaW4gYWRkaXRpb24gdG8gYSBjYWxsYmFjaywgeW91IGNhbiBh
        bHNvIHBhc3MgYW4gb3B0aW9uYWwgdGFyZ2V0CiAgICBvYmplY3QgdGhhdCB3
        aWxsIGJlIHNldCBhcyBgdGhpc2Agb24gdGhlIGNvbnRleHQuIFRoaXMgaXMg
        YSBnb29kIHdheQogICAgdG8gZ2l2ZSB5b3VyIGl0ZXJhdG9yIGZ1bmN0aW9u
        IGFjY2VzcyB0byB0aGUgY3VycmVudCBvYmplY3QuCgogICAgQG1ldGhvZCBm
        b3JFYWNoCiAgICBAcGFyYW0ge0Z1bmN0aW9ufSBjYWxsYmFjayBUaGUgY2Fs
        bGJhY2sgdG8gZXhlY3V0ZQogICAgQHBhcmFtIHtPYmplY3R9IFt0YXJnZXRd
        IFRoZSB0YXJnZXQgb2JqZWN0IHRvIHVzZQogICAgQHJldHVybiB7T2JqZWN0
        fSByZWNlaXZlcgogICovCiAgZm9yRWFjaDogZnVuY3Rpb24oY2FsbGJhY2ss
        IHRhcmdldCkgewogICAgaWYgKHR5cGVvZiBjYWxsYmFjayAhPT0gImZ1bmN0
        aW9uIikgdGhyb3cgbmV3IFR5cGVFcnJvcigpIDsKICAgIHZhciBsZW4gPSBn
        ZXQodGhpcywgJ2xlbmd0aCcpLCBsYXN0ID0gbnVsbCwgY29udGV4dCA9IHBv
        cEN0eCgpOwoKICAgIGlmICh0YXJnZXQgPT09IHVuZGVmaW5lZCkgdGFyZ2V0
        ID0gbnVsbDsKCiAgICBmb3IodmFyIGlkeD0wO2lkeDxsZW47aWR4KyspIHsK
        ICAgICAgdmFyIG5leHQgPSB0aGlzLm5leHRPYmplY3QoaWR4LCBsYXN0LCBj
        b250ZXh0KSA7CiAgICAgIGNhbGxiYWNrLmNhbGwodGFyZ2V0LCBuZXh0LCBp
        ZHgsIHRoaXMpOwogICAgICBsYXN0ID0gbmV4dCA7CiAgICB9CiAgICBsYXN0
        ID0gbnVsbCA7CiAgICBjb250ZXh0ID0gcHVzaEN0eChjb250ZXh0KTsKICAg
        IHJldHVybiB0aGlzIDsKICB9LAoKICAvKioKICAgIEFsaWFzIGZvciBgbWFw
        QnlgCgogICAgQG1ldGhvZCBnZXRFYWNoCiAgICBAcGFyYW0ge1N0cmluZ30g
        a2V5IG5hbWUgb2YgdGhlIHByb3BlcnR5CiAgICBAcmV0dXJuIHtBcnJheX0g
        VGhlIG1hcHBlZCBhcnJheS4KICAqLwogIGdldEVhY2g6IGZ1bmN0aW9uKGtl
        eSkgewogICAgcmV0dXJuIHRoaXMubWFwQnkoa2V5KTsKICB9LAoKICAvKioK
        ICAgIFNldHMgdGhlIHZhbHVlIG9uIHRoZSBuYW1lZCBwcm9wZXJ0eSBmb3Ig
        ZWFjaCBtZW1iZXIuIFRoaXMgaXMgbW9yZQogICAgZWZmaWNpZW50IHRoYW4g
        dXNpbmcgb3RoZXIgbWV0aG9kcyBkZWZpbmVkIG9uIHRoaXMgaGVscGVyLiBJ
        ZiB0aGUgb2JqZWN0CiAgICBpbXBsZW1lbnRzIEVtYmVyLk9ic2VydmFibGUs
        IHRoZSB2YWx1ZSB3aWxsIGJlIGNoYW5nZWQgdG8gYHNldCgpLGAgb3RoZXJ3
        aXNlCiAgICBpdCB3aWxsIGJlIHNldCBkaXJlY3RseS4gYG51bGxgIG9iamVj
        dHMgYXJlIHNraXBwZWQuCgogICAgQG1ldGhvZCBzZXRFYWNoCiAgICBAcGFy
        YW0ge1N0cmluZ30ga2V5IFRoZSBrZXkgdG8gc2V0CiAgICBAcGFyYW0ge09i
        amVjdH0gdmFsdWUgVGhlIG9iamVjdCB0byBzZXQKICAgIEByZXR1cm4ge09i
        amVjdH0gcmVjZWl2ZXIKICAqLwogIHNldEVhY2g6IGZ1bmN0aW9uKGtleSwg
        dmFsdWUpIHsKICAgIHJldHVybiB0aGlzLmZvckVhY2goZnVuY3Rpb24oaXRl
        bSkgewogICAgICBzZXQoaXRlbSwga2V5LCB2YWx1ZSk7CiAgICB9KTsKICB9
        LAoKICAvKioKICAgIE1hcHMgYWxsIG9mIHRoZSBpdGVtcyBpbiB0aGUgZW51
        bWVyYXRpb24gdG8gYW5vdGhlciB2YWx1ZSwgcmV0dXJuaW5nCiAgICBhIG5l
        dyBhcnJheS4gVGhpcyBtZXRob2QgY29ycmVzcG9uZHMgdG8gYG1hcCgpYCBk
        ZWZpbmVkIGluIEphdmFTY3JpcHQgMS42LgoKICAgIFRoZSBjYWxsYmFjayBt
        ZXRob2QgeW91IHByb3ZpZGUgc2hvdWxkIGhhdmUgdGhlIGZvbGxvd2luZyBz
        aWduYXR1cmUgKGFsbAogICAgcGFyYW1ldGVycyBhcmUgb3B0aW9uYWwpOgoK
        ICAgIGBgYGphdmFzY3JpcHQKICAgIGZ1bmN0aW9uKGl0ZW0sIGluZGV4LCBl
        bnVtZXJhYmxlKTsKICAgIGBgYAoKICAgIC0gYGl0ZW1gIGlzIHRoZSBjdXJy
        ZW50IGl0ZW0gaW4gdGhlIGl0ZXJhdGlvbi4KICAgIC0gYGluZGV4YCBpcyB0
        aGUgY3VycmVudCBpbmRleCBpbiB0aGUgaXRlcmF0aW9uLgogICAgLSBgZW51
        bWVyYWJsZWAgaXMgdGhlIGVudW1lcmFibGUgb2JqZWN0IGl0c2VsZi4KCiAg
        ICBJdCBzaG91bGQgcmV0dXJuIHRoZSBtYXBwZWQgdmFsdWUuCgogICAgTm90
        ZSB0aGF0IGluIGFkZGl0aW9uIHRvIGEgY2FsbGJhY2ssIHlvdSBjYW4gYWxz
        byBwYXNzIGFuIG9wdGlvbmFsIHRhcmdldAogICAgb2JqZWN0IHRoYXQgd2ls
        bCBiZSBzZXQgYXMgYHRoaXNgIG9uIHRoZSBjb250ZXh0LiBUaGlzIGlzIGEg
        Z29vZCB3YXkKICAgIHRvIGdpdmUgeW91ciBpdGVyYXRvciBmdW5jdGlvbiBh
        Y2Nlc3MgdG8gdGhlIGN1cnJlbnQgb2JqZWN0LgoKICAgIEBtZXRob2QgbWFw
        CiAgICBAcGFyYW0ge0Z1bmN0aW9ufSBjYWxsYmFjayBUaGUgY2FsbGJhY2sg
        dG8gZXhlY3V0ZQogICAgQHBhcmFtIHtPYmplY3R9IFt0YXJnZXRdIFRoZSB0
        YXJnZXQgb2JqZWN0IHRvIHVzZQogICAgQHJldHVybiB7QXJyYXl9IFRoZSBt
        YXBwZWQgYXJyYXkuCiAgKi8KICBtYXA6IGZ1bmN0aW9uKGNhbGxiYWNrLCB0
        YXJnZXQpIHsKICAgIHZhciByZXQgPSBFbWJlci5BKCk7CiAgICB0aGlzLmZv
        ckVhY2goZnVuY3Rpb24oeCwgaWR4LCBpKSB7CiAgICAgIHJldFtpZHhdID0g
        Y2FsbGJhY2suY2FsbCh0YXJnZXQsIHgsIGlkeCxpKTsKICAgIH0pOwogICAg
        cmV0dXJuIHJldCA7CiAgfSwKCiAgLyoqCiAgICBTaW1pbGFyIHRvIG1hcCwg
        dGhpcyBzcGVjaWFsaXplZCBmdW5jdGlvbiByZXR1cm5zIHRoZSB2YWx1ZSBv
        ZiB0aGUgbmFtZWQKICAgIHByb3BlcnR5IG9uIGFsbCBpdGVtcyBpbiB0aGUg
        ZW51bWVyYXRpb24uCgogICAgQG1ldGhvZCBtYXBCeQogICAgQHBhcmFtIHtT
        dHJpbmd9IGtleSBuYW1lIG9mIHRoZSBwcm9wZXJ0eQogICAgQHJldHVybiB7
        QXJyYXl9IFRoZSBtYXBwZWQgYXJyYXkuCiAgKi8KICBtYXBCeTogZnVuY3Rp
        b24oa2V5KSB7CiAgICByZXR1cm4gdGhpcy5tYXAoZnVuY3Rpb24obmV4dCkg
        ewogICAgICByZXR1cm4gZ2V0KG5leHQsIGtleSk7CiAgICB9KTsKICB9LAoK
        ICAvKioKICAgIFNpbWlsYXIgdG8gbWFwLCB0aGlzIHNwZWNpYWxpemVkIGZ1
        bmN0aW9uIHJldHVybnMgdGhlIHZhbHVlIG9mIHRoZSBuYW1lZAogICAgcHJv
        cGVydHkgb24gYWxsIGl0ZW1zIGluIHRoZSBlbnVtZXJhdGlvbi4KCiAgICBA
        bWV0aG9kIG1hcFByb3BlcnR5CiAgICBAcGFyYW0ge1N0cmluZ30ga2V5IG5h
        bWUgb2YgdGhlIHByb3BlcnR5CiAgICBAcmV0dXJuIHtBcnJheX0gVGhlIG1h
        cHBlZCBhcnJheS4KICAgIEBkZXByZWNhdGVkIFVzZSBgbWFwQnlgIGluc3Rl
        YWQKICAqLwoKICBtYXBQcm9wZXJ0eTogRW1iZXIuYWxpYXNNZXRob2QoJ21h
        cEJ5JyksCgogIC8qKgogICAgUmV0dXJucyBhbiBhcnJheSB3aXRoIGFsbCBv
        ZiB0aGUgaXRlbXMgaW4gdGhlIGVudW1lcmF0aW9uIHRoYXQgdGhlIHBhc3Nl
        ZAogICAgZnVuY3Rpb24gcmV0dXJucyB0cnVlIGZvci4gVGhpcyBtZXRob2Qg
        Y29ycmVzcG9uZHMgdG8gYGZpbHRlcigpYCBkZWZpbmVkIGluCiAgICBKYXZh
        U2NyaXB0IDEuNi4KCiAgICBUaGUgY2FsbGJhY2sgbWV0aG9kIHlvdSBwcm92
        aWRlIHNob3VsZCBoYXZlIHRoZSBmb2xsb3dpbmcgc2lnbmF0dXJlIChhbGwK
        ICAgIHBhcmFtZXRlcnMgYXJlIG9wdGlvbmFsKToKCiAgICBgYGBqYXZhc2Ny
        aXB0CiAgICBmdW5jdGlvbihpdGVtLCBpbmRleCwgZW51bWVyYWJsZSk7CiAg
        ICBgYGAKCiAgICAtIGBpdGVtYCBpcyB0aGUgY3VycmVudCBpdGVtIGluIHRo
        ZSBpdGVyYXRpb24uCiAgICAtIGBpbmRleGAgaXMgdGhlIGN1cnJlbnQgaW5k
        ZXggaW4gdGhlIGl0ZXJhdGlvbi4KICAgIC0gYGVudW1lcmFibGVgIGlzIHRo
        ZSBlbnVtZXJhYmxlIG9iamVjdCBpdHNlbGYuCgogICAgSXQgc2hvdWxkIHJl
        dHVybiB0aGUgYHRydWVgIHRvIGluY2x1ZGUgdGhlIGl0ZW0gaW4gdGhlIHJl
        c3VsdHMsIGBmYWxzZWAKICAgIG90aGVyd2lzZS4KCiAgICBOb3RlIHRoYXQg
        aW4gYWRkaXRpb24gdG8gYSBjYWxsYmFjaywgeW91IGNhbiBhbHNvIHBhc3Mg
        YW4gb3B0aW9uYWwgdGFyZ2V0CiAgICBvYmplY3QgdGhhdCB3aWxsIGJlIHNl
        dCBhcyBgdGhpc2Agb24gdGhlIGNvbnRleHQuIFRoaXMgaXMgYSBnb29kIHdh
        eQogICAgdG8gZ2l2ZSB5b3VyIGl0ZXJhdG9yIGZ1bmN0aW9uIGFjY2VzcyB0
        byB0aGUgY3VycmVudCBvYmplY3QuCgogICAgQG1ldGhvZCBmaWx0ZXIKICAg
        IEBwYXJhbSB7RnVuY3Rpb259IGNhbGxiYWNrIFRoZSBjYWxsYmFjayB0byBl
        eGVjdXRlCiAgICBAcGFyYW0ge09iamVjdH0gW3RhcmdldF0gVGhlIHRhcmdl
        dCBvYmplY3QgdG8gdXNlCiAgICBAcmV0dXJuIHtBcnJheX0gQSBmaWx0ZXJl
        ZCBhcnJheS4KICAqLwogIGZpbHRlcjogZnVuY3Rpb24oY2FsbGJhY2ssIHRh
        cmdldCkgewogICAgdmFyIHJldCA9IEVtYmVyLkEoKTsKICAgIHRoaXMuZm9y
        RWFjaChmdW5jdGlvbih4LCBpZHgsIGkpIHsKICAgICAgaWYgKGNhbGxiYWNr
        LmNhbGwodGFyZ2V0LCB4LCBpZHgsIGkpKSByZXQucHVzaCh4KTsKICAgIH0p
        OwogICAgcmV0dXJuIHJldCA7CiAgfSwKCiAgLyoqCiAgICBSZXR1cm5zIGFu
        IGFycmF5IHdpdGggYWxsIG9mIHRoZSBpdGVtcyBpbiB0aGUgZW51bWVyYXRp
        b24gd2hlcmUgdGhlIHBhc3NlZAogICAgZnVuY3Rpb24gcmV0dXJucyBmYWxz
        ZSBmb3IuIFRoaXMgbWV0aG9kIGlzIHRoZSBpbnZlcnNlIG9mIGZpbHRlcigp
        LgoKICAgIFRoZSBjYWxsYmFjayBtZXRob2QgeW91IHByb3ZpZGUgc2hvdWxk
        IGhhdmUgdGhlIGZvbGxvd2luZyBzaWduYXR1cmUgKGFsbAogICAgcGFyYW1l
        dGVycyBhcmUgb3B0aW9uYWwpOgoKICAgICAgICAgIGZ1bmN0aW9uKGl0ZW0s
        IGluZGV4LCBlbnVtZXJhYmxlKTsKCiAgICAtICppdGVtKiBpcyB0aGUgY3Vy
        cmVudCBpdGVtIGluIHRoZSBpdGVyYXRpb24uCiAgICAtICppbmRleCogaXMg
        dGhlIGN1cnJlbnQgaW5kZXggaW4gdGhlIGl0ZXJhdGlvbgogICAgLSAqZW51
        bWVyYWJsZSogaXMgdGhlIGVudW1lcmFibGUgb2JqZWN0IGl0c2VsZi4KCiAg
        ICBJdCBzaG91bGQgcmV0dXJuIHRoZSBhIGZhbHNleSB2YWx1ZSB0byBpbmNs
        dWRlIHRoZSBpdGVtIGluIHRoZSByZXN1bHRzLgoKICAgIE5vdGUgdGhhdCBp
        biBhZGRpdGlvbiB0byBhIGNhbGxiYWNrLCB5b3UgY2FuIGFsc28gcGFzcyBh
        biBvcHRpb25hbCB0YXJnZXQKICAgIG9iamVjdCB0aGF0IHdpbGwgYmUgc2V0
        IGFzICJ0aGlzIiBvbiB0aGUgY29udGV4dC4gVGhpcyBpcyBhIGdvb2Qgd2F5
        CiAgICB0byBnaXZlIHlvdXIgaXRlcmF0b3IgZnVuY3Rpb24gYWNjZXNzIHRv
        IHRoZSBjdXJyZW50IG9iamVjdC4KCiAgICBAbWV0aG9kIHJlamVjdAogICAg
        QHBhcmFtIHtGdW5jdGlvbn0gY2FsbGJhY2sgVGhlIGNhbGxiYWNrIHRvIGV4
        ZWN1dGUKICAgIEBwYXJhbSB7T2JqZWN0fSBbdGFyZ2V0XSBUaGUgdGFyZ2V0
        IG9iamVjdCB0byB1c2UKICAgIEByZXR1cm4ge0FycmF5fSBBIHJlamVjdGVk
        IGFycmF5LgogICAqLwogIHJlamVjdDogZnVuY3Rpb24oY2FsbGJhY2ssIHRh
        cmdldCkgewogICAgcmV0dXJuIHRoaXMuZmlsdGVyKGZ1bmN0aW9uKCkgewog
        ICAgICByZXR1cm4gIShjYWxsYmFjay5hcHBseSh0YXJnZXQsIGFyZ3VtZW50
        cykpOwogICAgfSk7CiAgfSwKCiAgLyoqCiAgICBSZXR1cm5zIGFuIGFycmF5
        IHdpdGgganVzdCB0aGUgaXRlbXMgd2l0aCB0aGUgbWF0Y2hlZCBwcm9wZXJ0
        eS4gWW91CiAgICBjYW4gcGFzcyBhbiBvcHRpb25hbCBzZWNvbmQgYXJndW1l
        bnQgd2l0aCB0aGUgdGFyZ2V0IHZhbHVlLiBPdGhlcndpc2UKICAgIHRoaXMg
        d2lsbCBtYXRjaCBhbnkgcHJvcGVydHkgdGhhdCBldmFsdWF0ZXMgdG8gYHRy
        dWVgLgoKICAgIEBtZXRob2QgZmlsdGVyQnkKICAgIEBwYXJhbSB7U3RyaW5n
        fSBrZXkgdGhlIHByb3BlcnR5IHRvIHRlc3QKICAgIEBwYXJhbSB7U3RyaW5n
        fSBbdmFsdWVdIG9wdGlvbmFsIHZhbHVlIHRvIHRlc3QgYWdhaW5zdC4KICAg
        IEByZXR1cm4ge0FycmF5fSBmaWx0ZXJlZCBhcnJheQogICovCiAgZmlsdGVy
        Qnk6IGZ1bmN0aW9uKGtleSwgdmFsdWUpIHsKICAgIHJldHVybiB0aGlzLmZp
        bHRlcihpdGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykpOwogIH0sCgogIC8q
        KgogICAgUmV0dXJucyBhbiBhcnJheSB3aXRoIGp1c3QgdGhlIGl0ZW1zIHdp
        dGggdGhlIG1hdGNoZWQgcHJvcGVydHkuIFlvdQogICAgY2FuIHBhc3MgYW4g
        b3B0aW9uYWwgc2Vjb25kIGFyZ3VtZW50IHdpdGggdGhlIHRhcmdldCB2YWx1
        ZS4gT3RoZXJ3aXNlCiAgICB0aGlzIHdpbGwgbWF0Y2ggYW55IHByb3BlcnR5
        IHRoYXQgZXZhbHVhdGVzIHRvIGB0cnVlYC4KCiAgICBAbWV0aG9kIGZpbHRl
        clByb3BlcnR5CiAgICBAcGFyYW0ge1N0cmluZ30ga2V5IHRoZSBwcm9wZXJ0
        eSB0byB0ZXN0CiAgICBAcGFyYW0ge1N0cmluZ30gW3ZhbHVlXSBvcHRpb25h
        bCB2YWx1ZSB0byB0ZXN0IGFnYWluc3QuCiAgICBAcmV0dXJuIHtBcnJheX0g
        ZmlsdGVyZWQgYXJyYXkKICAgIEBkZXByZWNhdGVkIFVzZSBgZmlsdGVyQnlg
        IGluc3RlYWQKICAqLwogIGZpbHRlclByb3BlcnR5OiBFbWJlci5hbGlhc01l
        dGhvZCgnZmlsdGVyQnknKSwKCiAgLyoqCiAgICBSZXR1cm5zIGFuIGFycmF5
        IHdpdGggdGhlIGl0ZW1zIHRoYXQgZG8gbm90IGhhdmUgdHJ1dGh5IHZhbHVl
        cyBmb3IKICAgIGtleS4gIFlvdSBjYW4gcGFzcyBhbiBvcHRpb25hbCBzZWNv
        bmQgYXJndW1lbnQgd2l0aCB0aGUgdGFyZ2V0IHZhbHVlLiAgT3RoZXJ3aXNl
        CiAgICB0aGlzIHdpbGwgbWF0Y2ggYW55IHByb3BlcnR5IHRoYXQgZXZhbHVh
        dGVzIHRvIGZhbHNlLgoKICAgIEBtZXRob2QgcmVqZWN0QnkKICAgIEBwYXJh
        bSB7U3RyaW5nfSBrZXkgdGhlIHByb3BlcnR5IHRvIHRlc3QKICAgIEBwYXJh
        bSB7U3RyaW5nfSBbdmFsdWVdIG9wdGlvbmFsIHZhbHVlIHRvIHRlc3QgYWdh
        aW5zdC4KICAgIEByZXR1cm4ge0FycmF5fSByZWplY3RlZCBhcnJheQogICov
        CiAgcmVqZWN0Qnk6IGZ1bmN0aW9uKGtleSwgdmFsdWUpIHsKICAgIHZhciBl
        eGFjdFZhbHVlID0gZnVuY3Rpb24oaXRlbSkgeyByZXR1cm4gZ2V0KGl0ZW0s
        IGtleSkgPT09IHZhbHVlOyB9LAogICAgICAgIGhhc1ZhbHVlID0gZnVuY3Rp
        b24oaXRlbSkgeyByZXR1cm4gISFnZXQoaXRlbSwga2V5KTsgfSwKICAgICAg
        ICB1c2UgPSAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMiA/IGV4YWN0VmFsdWUg
        OiBoYXNWYWx1ZSk7CgogICAgcmV0dXJuIHRoaXMucmVqZWN0KHVzZSk7CiAg
        fSwKCiAgLyoqCiAgICBSZXR1cm5zIGFuIGFycmF5IHdpdGggdGhlIGl0ZW1z
        IHRoYXQgZG8gbm90IGhhdmUgdHJ1dGh5IHZhbHVlcyBmb3IKICAgIGtleS4g
        IFlvdSBjYW4gcGFzcyBhbiBvcHRpb25hbCBzZWNvbmQgYXJndW1lbnQgd2l0
        aCB0aGUgdGFyZ2V0IHZhbHVlLiAgT3RoZXJ3aXNlCiAgICB0aGlzIHdpbGwg
        bWF0Y2ggYW55IHByb3BlcnR5IHRoYXQgZXZhbHVhdGVzIHRvIGZhbHNlLgoK
        ICAgIEBtZXRob2QgcmVqZWN0UHJvcGVydHkKICAgIEBwYXJhbSB7U3RyaW5n
        fSBrZXkgdGhlIHByb3BlcnR5IHRvIHRlc3QKICAgIEBwYXJhbSB7U3RyaW5n
        fSBbdmFsdWVdIG9wdGlvbmFsIHZhbHVlIHRvIHRlc3QgYWdhaW5zdC4KICAg
        IEByZXR1cm4ge0FycmF5fSByZWplY3RlZCBhcnJheQogICAgQGRlcHJlY2F0
        ZWQgVXNlIGByZWplY3RCeWAgaW5zdGVhZAogICovCiAgcmVqZWN0UHJvcGVy
        dHk6IEVtYmVyLmFsaWFzTWV0aG9kKCdyZWplY3RCeScpLAoKICAvKioKICAg
        IFJldHVybnMgdGhlIGZpcnN0IGl0ZW0gaW4gdGhlIGFycmF5IGZvciB3aGlj
        aCB0aGUgY2FsbGJhY2sgcmV0dXJucyB0cnVlLgogICAgVGhpcyBtZXRob2Qg
        d29ya3Mgc2ltaWxhciB0byB0aGUgYGZpbHRlcigpYCBtZXRob2QgZGVmaW5l
        ZCBpbiBKYXZhU2NyaXB0IDEuNgogICAgZXhjZXB0IHRoYXQgaXQgd2lsbCBz
        dG9wIHdvcmtpbmcgb24gdGhlIGFycmF5IG9uY2UgYSBtYXRjaCBpcyBmb3Vu
        ZC4KCiAgICBUaGUgY2FsbGJhY2sgbWV0aG9kIHlvdSBwcm92aWRlIHNob3Vs
        ZCBoYXZlIHRoZSBmb2xsb3dpbmcgc2lnbmF0dXJlIChhbGwKICAgIHBhcmFt
        ZXRlcnMgYXJlIG9wdGlvbmFsKToKCiAgICBgYGBqYXZhc2NyaXB0CiAgICBm
        dW5jdGlvbihpdGVtLCBpbmRleCwgZW51bWVyYWJsZSk7CiAgICBgYGAKCiAg
        ICAtIGBpdGVtYCBpcyB0aGUgY3VycmVudCBpdGVtIGluIHRoZSBpdGVyYXRp
        b24uCiAgICAtIGBpbmRleGAgaXMgdGhlIGN1cnJlbnQgaW5kZXggaW4gdGhl
        IGl0ZXJhdGlvbi4KICAgIC0gYGVudW1lcmFibGVgIGlzIHRoZSBlbnVtZXJh
        YmxlIG9iamVjdCBpdHNlbGYuCgogICAgSXQgc2hvdWxkIHJldHVybiB0aGUg
        YHRydWVgIHRvIGluY2x1ZGUgdGhlIGl0ZW0gaW4gdGhlIHJlc3VsdHMsIGBm
        YWxzZWAKICAgIG90aGVyd2lzZS4KCiAgICBOb3RlIHRoYXQgaW4gYWRkaXRp
        b24gdG8gYSBjYWxsYmFjaywgeW91IGNhbiBhbHNvIHBhc3MgYW4gb3B0aW9u
        YWwgdGFyZ2V0CiAgICBvYmplY3QgdGhhdCB3aWxsIGJlIHNldCBhcyBgdGhp
        c2Agb24gdGhlIGNvbnRleHQuIFRoaXMgaXMgYSBnb29kIHdheQogICAgdG8g
        Z2l2ZSB5b3VyIGl0ZXJhdG9yIGZ1bmN0aW9uIGFjY2VzcyB0byB0aGUgY3Vy
        cmVudCBvYmplY3QuCgogICAgQG1ldGhvZCBmaW5kCiAgICBAcGFyYW0ge0Z1
        bmN0aW9ufSBjYWxsYmFjayBUaGUgY2FsbGJhY2sgdG8gZXhlY3V0ZQogICAg
        QHBhcmFtIHtPYmplY3R9IFt0YXJnZXRdIFRoZSB0YXJnZXQgb2JqZWN0IHRv
        IHVzZQogICAgQHJldHVybiB7T2JqZWN0fSBGb3VuZCBpdGVtIG9yIGB1bmRl
        ZmluZWRgLgogICovCiAgZmluZDogZnVuY3Rpb24oY2FsbGJhY2ssIHRhcmdl
        dCkgewogICAgdmFyIGxlbiA9IGdldCh0aGlzLCAnbGVuZ3RoJykgOwogICAg
        aWYgKHRhcmdldCA9PT0gdW5kZWZpbmVkKSB0YXJnZXQgPSBudWxsOwoKICAg
        IHZhciBsYXN0ID0gbnVsbCwgbmV4dCwgZm91bmQgPSBmYWxzZSwgcmV0IDsK
        ICAgIHZhciBjb250ZXh0ID0gcG9wQ3R4KCk7CiAgICBmb3IodmFyIGlkeD0w
        O2lkeDxsZW4gJiYgIWZvdW5kO2lkeCsrKSB7CiAgICAgIG5leHQgPSB0aGlz
        Lm5leHRPYmplY3QoaWR4LCBsYXN0LCBjb250ZXh0KSA7CiAgICAgIGlmIChm
        b3VuZCA9IGNhbGxiYWNrLmNhbGwodGFyZ2V0LCBuZXh0LCBpZHgsIHRoaXMp
        KSByZXQgPSBuZXh0IDsKICAgICAgbGFzdCA9IG5leHQgOwogICAgfQogICAg
        bmV4dCA9IGxhc3QgPSBudWxsIDsKICAgIGNvbnRleHQgPSBwdXNoQ3R4KGNv
        bnRleHQpOwogICAgcmV0dXJuIHJldCA7CiAgfSwKCiAgLyoqCiAgICBSZXR1
        cm5zIHRoZSBmaXJzdCBpdGVtIHdpdGggYSBwcm9wZXJ0eSBtYXRjaGluZyB0
        aGUgcGFzc2VkIHZhbHVlLiBZb3UKICAgIGNhbiBwYXNzIGFuIG9wdGlvbmFs
        IHNlY29uZCBhcmd1bWVudCB3aXRoIHRoZSB0YXJnZXQgdmFsdWUuIE90aGVy
        d2lzZQogICAgdGhpcyB3aWxsIG1hdGNoIGFueSBwcm9wZXJ0eSB0aGF0IGV2
        YWx1YXRlcyB0byBgdHJ1ZWAuCgogICAgVGhpcyBtZXRob2Qgd29ya3MgbXVj
        aCBsaWtlIHRoZSBtb3JlIGdlbmVyaWMgYGZpbmQoKWAgbWV0aG9kLgoKICAg
        IEBtZXRob2QgZmluZEJ5CiAgICBAcGFyYW0ge1N0cmluZ30ga2V5IHRoZSBw
        cm9wZXJ0eSB0byB0ZXN0CiAgICBAcGFyYW0ge1N0cmluZ30gW3ZhbHVlXSBv
        cHRpb25hbCB2YWx1ZSB0byB0ZXN0IGFnYWluc3QuCiAgICBAcmV0dXJuIHtP
        YmplY3R9IGZvdW5kIGl0ZW0gb3IgYHVuZGVmaW5lZGAKICAqLwogIGZpbmRC
        eTogZnVuY3Rpb24oa2V5LCB2YWx1ZSkgewogICAgcmV0dXJuIHRoaXMuZmlu
        ZChpdGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykpOwogIH0sCgogIC8qKgog
        ICAgUmV0dXJucyB0aGUgZmlyc3QgaXRlbSB3aXRoIGEgcHJvcGVydHkgbWF0
        Y2hpbmcgdGhlIHBhc3NlZCB2YWx1ZS4gWW91CiAgICBjYW4gcGFzcyBhbiBv
        cHRpb25hbCBzZWNvbmQgYXJndW1lbnQgd2l0aCB0aGUgdGFyZ2V0IHZhbHVl
        LiBPdGhlcndpc2UKICAgIHRoaXMgd2lsbCBtYXRjaCBhbnkgcHJvcGVydHkg
        dGhhdCBldmFsdWF0ZXMgdG8gYHRydWVgLgoKICAgIFRoaXMgbWV0aG9kIHdv
        cmtzIG11Y2ggbGlrZSB0aGUgbW9yZSBnZW5lcmljIGBmaW5kKClgIG1ldGhv
        ZC4KCiAgICBAbWV0aG9kIGZpbmRQcm9wZXJ0eQogICAgQHBhcmFtIHtTdHJp
        bmd9IGtleSB0aGUgcHJvcGVydHkgdG8gdGVzdAogICAgQHBhcmFtIHtTdHJp
        bmd9IFt2YWx1ZV0gb3B0aW9uYWwgdmFsdWUgdG8gdGVzdCBhZ2FpbnN0Lgog
        ICAgQHJldHVybiB7T2JqZWN0fSBmb3VuZCBpdGVtIG9yIGB1bmRlZmluZWRg
        CiAgICBAZGVwcmVjYXRlZCBVc2UgYGZpbmRCeWAgaW5zdGVhZAogICovCiAg
        ZmluZFByb3BlcnR5OiBFbWJlci5hbGlhc01ldGhvZCgnZmluZEJ5JyksCgog
        IC8qKgogICAgUmV0dXJucyBgdHJ1ZWAgaWYgdGhlIHBhc3NlZCBmdW5jdGlv
        biByZXR1cm5zIHRydWUgZm9yIGV2ZXJ5IGl0ZW0gaW4gdGhlCiAgICBlbnVt
        ZXJhdGlvbi4gVGhpcyBjb3JyZXNwb25kcyB3aXRoIHRoZSBgZXZlcnkoKWAg
        bWV0aG9kIGluIEphdmFTY3JpcHQgMS42LgoKICAgIFRoZSBjYWxsYmFjayBt
        ZXRob2QgeW91IHByb3ZpZGUgc2hvdWxkIGhhdmUgdGhlIGZvbGxvd2luZyBz
        aWduYXR1cmUgKGFsbAogICAgcGFyYW1ldGVycyBhcmUgb3B0aW9uYWwpOgoK
        ICAgIGBgYGphdmFzY3JpcHQKICAgIGZ1bmN0aW9uKGl0ZW0sIGluZGV4LCBl
        bnVtZXJhYmxlKTsKICAgIGBgYAoKICAgIC0gYGl0ZW1gIGlzIHRoZSBjdXJy
        ZW50IGl0ZW0gaW4gdGhlIGl0ZXJhdGlvbi4KICAgIC0gYGluZGV4YCBpcyB0
        aGUgY3VycmVudCBpbmRleCBpbiB0aGUgaXRlcmF0aW9uLgogICAgLSBgZW51
        bWVyYWJsZWAgaXMgdGhlIGVudW1lcmFibGUgb2JqZWN0IGl0c2VsZi4KCiAg
        ICBJdCBzaG91bGQgcmV0dXJuIHRoZSBgdHJ1ZWAgb3IgYGZhbHNlYC4KCiAg
        ICBOb3RlIHRoYXQgaW4gYWRkaXRpb24gdG8gYSBjYWxsYmFjaywgeW91IGNh
        biBhbHNvIHBhc3MgYW4gb3B0aW9uYWwgdGFyZ2V0CiAgICBvYmplY3QgdGhh
        dCB3aWxsIGJlIHNldCBhcyBgdGhpc2Agb24gdGhlIGNvbnRleHQuIFRoaXMg
        aXMgYSBnb29kIHdheQogICAgdG8gZ2l2ZSB5b3VyIGl0ZXJhdG9yIGZ1bmN0
        aW9uIGFjY2VzcyB0byB0aGUgY3VycmVudCBvYmplY3QuCgogICAgRXhhbXBs
        ZSBVc2FnZToKCiAgICBgYGBqYXZhc2NyaXB0CiAgICBpZiAocGVvcGxlLmV2
        ZXJ5KGlzRW5naW5lZXIpKSB7IFBheWNoZWNrcy5hZGRCaWdCb251cygpOyB9
        CiAgICBgYGAKCiAgICBAbWV0aG9kIGV2ZXJ5CiAgICBAcGFyYW0ge0Z1bmN0
        aW9ufSBjYWxsYmFjayBUaGUgY2FsbGJhY2sgdG8gZXhlY3V0ZQogICAgQHBh
        cmFtIHtPYmplY3R9IFt0YXJnZXRdIFRoZSB0YXJnZXQgb2JqZWN0IHRvIHVz
        ZQogICAgQHJldHVybiB7Qm9vbGVhbn0KICAqLwogIGV2ZXJ5OiBmdW5jdGlv
        bihjYWxsYmFjaywgdGFyZ2V0KSB7CiAgICByZXR1cm4gIXRoaXMuZmluZChm
        dW5jdGlvbih4LCBpZHgsIGkpIHsKICAgICAgcmV0dXJuICFjYWxsYmFjay5j
        YWxsKHRhcmdldCwgeCwgaWR4LCBpKTsKICAgIH0pOwogIH0sCgogIC8qKgog
        ICAgUmV0dXJucyBgdHJ1ZWAgaWYgdGhlIHBhc3NlZCBwcm9wZXJ0eSByZXNv
        bHZlcyB0byBgdHJ1ZWAgZm9yIGFsbCBpdGVtcyBpbgogICAgdGhlIGVudW1l
        cmFibGUuIFRoaXMgbWV0aG9kIGlzIG9mdGVuIHNpbXBsZXIvZmFzdGVyIHRo
        YW4gdXNpbmcgYSBjYWxsYmFjay4KCiAgICBAbWV0aG9kIGV2ZXJ5QnkKICAg
        IEBwYXJhbSB7U3RyaW5nfSBrZXkgdGhlIHByb3BlcnR5IHRvIHRlc3QKICAg
        IEBwYXJhbSB7U3RyaW5nfSBbdmFsdWVdIG9wdGlvbmFsIHZhbHVlIHRvIHRl
        c3QgYWdhaW5zdC4KICAgIEByZXR1cm4ge0Jvb2xlYW59CiAgKi8KICBldmVy
        eUJ5OiBmdW5jdGlvbihrZXksIHZhbHVlKSB7CiAgICByZXR1cm4gdGhpcy5l
        dmVyeShpdGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykpOwogIH0sCgogIC8q
        KgogICAgUmV0dXJucyBgdHJ1ZWAgaWYgdGhlIHBhc3NlZCBwcm9wZXJ0eSBy
        ZXNvbHZlcyB0byBgdHJ1ZWAgZm9yIGFsbCBpdGVtcyBpbgogICAgdGhlIGVu
        dW1lcmFibGUuIFRoaXMgbWV0aG9kIGlzIG9mdGVuIHNpbXBsZXIvZmFzdGVy
        IHRoYW4gdXNpbmcgYSBjYWxsYmFjay4KCiAgICBAbWV0aG9kIGV2ZXJ5UHJv
        cGVydHkKICAgIEBwYXJhbSB7U3RyaW5nfSBrZXkgdGhlIHByb3BlcnR5IHRv
        IHRlc3QKICAgIEBwYXJhbSB7U3RyaW5nfSBbdmFsdWVdIG9wdGlvbmFsIHZh
        bHVlIHRvIHRlc3QgYWdhaW5zdC4KICAgIEByZXR1cm4ge0Jvb2xlYW59CiAg
        ICBAZGVwcmVjYXRlZCBVc2UgYGV2ZXJ5QnlgIGluc3RlYWQKICAqLwogIGV2
        ZXJ5UHJvcGVydHk6IEVtYmVyLmFsaWFzTWV0aG9kKCdldmVyeUJ5JyksCgog
        IC8qKgogICAgUmV0dXJucyBgdHJ1ZWAgaWYgdGhlIHBhc3NlZCBmdW5jdGlv
        biByZXR1cm5zIHRydWUgZm9yIGFueSBpdGVtIGluIHRoZQogICAgZW51bWVy
        YXRpb24uIFRoaXMgY29ycmVzcG9uZHMgd2l0aCB0aGUgYHNvbWUoKWAgbWV0
        aG9kIGluIEphdmFTY3JpcHQgMS42LgoKICAgIFRoZSBjYWxsYmFjayBtZXRo
        b2QgeW91IHByb3ZpZGUgc2hvdWxkIGhhdmUgdGhlIGZvbGxvd2luZyBzaWdu
        YXR1cmUgKGFsbAogICAgcGFyYW1ldGVycyBhcmUgb3B0aW9uYWwpOgoKICAg
        IGBgYGphdmFzY3JpcHQKICAgIGZ1bmN0aW9uKGl0ZW0sIGluZGV4LCBlbnVt
        ZXJhYmxlKTsKICAgIGBgYAoKICAgIC0gYGl0ZW1gIGlzIHRoZSBjdXJyZW50
        IGl0ZW0gaW4gdGhlIGl0ZXJhdGlvbi4KICAgIC0gYGluZGV4YCBpcyB0aGUg
        Y3VycmVudCBpbmRleCBpbiB0aGUgaXRlcmF0aW9uLgogICAgLSBgZW51bWVy
        YWJsZWAgaXMgdGhlIGVudW1lcmFibGUgb2JqZWN0IGl0c2VsZi4KCiAgICBJ
        dCBzaG91bGQgcmV0dXJuIHRoZSBgdHJ1ZWAgdG8gaW5jbHVkZSB0aGUgaXRl
        bSBpbiB0aGUgcmVzdWx0cywgYGZhbHNlYAogICAgb3RoZXJ3aXNlLgoKICAg
        IE5vdGUgdGhhdCBpbiBhZGRpdGlvbiB0byBhIGNhbGxiYWNrLCB5b3UgY2Fu
        IGFsc28gcGFzcyBhbiBvcHRpb25hbCB0YXJnZXQKICAgIG9iamVjdCB0aGF0
        IHdpbGwgYmUgc2V0IGFzIGB0aGlzYCBvbiB0aGUgY29udGV4dC4gVGhpcyBp
        cyBhIGdvb2Qgd2F5CiAgICB0byBnaXZlIHlvdXIgaXRlcmF0b3IgZnVuY3Rp
        b24gYWNjZXNzIHRvIHRoZSBjdXJyZW50IG9iamVjdC4KCiAgICBVc2FnZSBF
        eGFtcGxlOgoKICAgIGBgYGphdmFzY3JpcHQKICAgIGlmIChwZW9wbGUuYW55
        KGlzTWFuYWdlcikpIHsgUGF5Y2hlY2tzLmFkZEJpZ2dlckJvbnVzKCk7IH0K
        ICAgIGBgYAoKICAgIEBtZXRob2QgYW55CiAgICBAcGFyYW0ge0Z1bmN0aW9u
        fSBjYWxsYmFjayBUaGUgY2FsbGJhY2sgdG8gZXhlY3V0ZQogICAgQHBhcmFt
        IHtPYmplY3R9IFt0YXJnZXRdIFRoZSB0YXJnZXQgb2JqZWN0IHRvIHVzZQog
        ICAgQHJldHVybiB7Qm9vbGVhbn0gYHRydWVgIGlmIHRoZSBwYXNzZWQgZnVu
        Y3Rpb24gcmV0dXJucyBgdHJ1ZWAgZm9yIGFueSBpdGVtCiAgKi8KICBhbnk6
        IGZ1bmN0aW9uKGNhbGxiYWNrLCB0YXJnZXQpIHsKICAgIHJldHVybiAhIXRo
        aXMuZmluZChmdW5jdGlvbih4LCBpZHgsIGkpIHsKICAgICAgcmV0dXJuICEh
        Y2FsbGJhY2suY2FsbCh0YXJnZXQsIHgsIGlkeCwgaSk7CiAgICB9KTsKICB9
        LAoKICAvKioKICAgIFJldHVybnMgYHRydWVgIGlmIHRoZSBwYXNzZWQgZnVu
        Y3Rpb24gcmV0dXJucyB0cnVlIGZvciBhbnkgaXRlbSBpbiB0aGUKICAgIGVu
        dW1lcmF0aW9uLiBUaGlzIGNvcnJlc3BvbmRzIHdpdGggdGhlIGBzb21lKClg
        IG1ldGhvZCBpbiBKYXZhU2NyaXB0IDEuNi4KCiAgICBUaGUgY2FsbGJhY2sg
        bWV0aG9kIHlvdSBwcm92aWRlIHNob3VsZCBoYXZlIHRoZSBmb2xsb3dpbmcg
        c2lnbmF0dXJlIChhbGwKICAgIHBhcmFtZXRlcnMgYXJlIG9wdGlvbmFsKToK
        CiAgICBgYGBqYXZhc2NyaXB0CiAgICBmdW5jdGlvbihpdGVtLCBpbmRleCwg
        ZW51bWVyYWJsZSk7CiAgICBgYGAKCiAgICAtIGBpdGVtYCBpcyB0aGUgY3Vy
        cmVudCBpdGVtIGluIHRoZSBpdGVyYXRpb24uCiAgICAtIGBpbmRleGAgaXMg
        dGhlIGN1cnJlbnQgaW5kZXggaW4gdGhlIGl0ZXJhdGlvbi4KICAgIC0gYGVu
        dW1lcmFibGVgIGlzIHRoZSBlbnVtZXJhYmxlIG9iamVjdCBpdHNlbGYuCgog
        ICAgSXQgc2hvdWxkIHJldHVybiB0aGUgYHRydWVgIHRvIGluY2x1ZGUgdGhl
        IGl0ZW0gaW4gdGhlIHJlc3VsdHMsIGBmYWxzZWAKICAgIG90aGVyd2lzZS4K
        CiAgICBOb3RlIHRoYXQgaW4gYWRkaXRpb24gdG8gYSBjYWxsYmFjaywgeW91
        IGNhbiBhbHNvIHBhc3MgYW4gb3B0aW9uYWwgdGFyZ2V0CiAgICBvYmplY3Qg
        dGhhdCB3aWxsIGJlIHNldCBhcyBgdGhpc2Agb24gdGhlIGNvbnRleHQuIFRo
        aXMgaXMgYSBnb29kIHdheQogICAgdG8gZ2l2ZSB5b3VyIGl0ZXJhdG9yIGZ1
        bmN0aW9uIGFjY2VzcyB0byB0aGUgY3VycmVudCBvYmplY3QuCgogICAgVXNh
        Z2UgRXhhbXBsZToKCiAgICBgYGBqYXZhc2NyaXB0CiAgICBpZiAocGVvcGxl
        LnNvbWUoaXNNYW5hZ2VyKSkgeyBQYXljaGVja3MuYWRkQmlnZ2VyQm9udXMo
        KTsgfQogICAgYGBgCgogICAgQG1ldGhvZCBzb21lCiAgICBAcGFyYW0ge0Z1
        bmN0aW9ufSBjYWxsYmFjayBUaGUgY2FsbGJhY2sgdG8gZXhlY3V0ZQogICAg
        QHBhcmFtIHtPYmplY3R9IFt0YXJnZXRdIFRoZSB0YXJnZXQgb2JqZWN0IHRv
        IHVzZQogICAgQHJldHVybiB7Qm9vbGVhbn0gYHRydWVgIGlmIHRoZSBwYXNz
        ZWQgZnVuY3Rpb24gcmV0dXJucyBgdHJ1ZWAgZm9yIGFueSBpdGVtCiAgICBA
        ZGVwcmVjYXRlZCBVc2UgYGFueWAgaW5zdGVhZAogICovCiAgc29tZTogRW1i
        ZXIuYWxpYXNNZXRob2QoJ2FueScpLAoKICAvKioKICAgIFJldHVybnMgYHRy
        dWVgIGlmIHRoZSBwYXNzZWQgcHJvcGVydHkgcmVzb2x2ZXMgdG8gYHRydWVg
        IGZvciBhbnkgaXRlbSBpbgogICAgdGhlIGVudW1lcmFibGUuIFRoaXMgbWV0
        aG9kIGlzIG9mdGVuIHNpbXBsZXIvZmFzdGVyIHRoYW4gdXNpbmcgYSBjYWxs
        YmFjay4KCiAgICBAbWV0aG9kIGFueUJ5CiAgICBAcGFyYW0ge1N0cmluZ30g
        a2V5IHRoZSBwcm9wZXJ0eSB0byB0ZXN0CiAgICBAcGFyYW0ge1N0cmluZ30g
        W3ZhbHVlXSBvcHRpb25hbCB2YWx1ZSB0byB0ZXN0IGFnYWluc3QuCiAgICBA
        cmV0dXJuIHtCb29sZWFufSBgdHJ1ZWAgaWYgdGhlIHBhc3NlZCBmdW5jdGlv
        biByZXR1cm5zIGB0cnVlYCBmb3IgYW55IGl0ZW0KICAqLwogIGFueUJ5OiBm
        dW5jdGlvbihrZXksIHZhbHVlKSB7CiAgICByZXR1cm4gdGhpcy5hbnkoaXRl
        ci5hcHBseSh0aGlzLCBhcmd1bWVudHMpKTsKICB9LAoKICAvKioKICAgIFJl
        dHVybnMgYHRydWVgIGlmIHRoZSBwYXNzZWQgcHJvcGVydHkgcmVzb2x2ZXMg
        dG8gYHRydWVgIGZvciBhbnkgaXRlbSBpbgogICAgdGhlIGVudW1lcmFibGUu
        IFRoaXMgbWV0aG9kIGlzIG9mdGVuIHNpbXBsZXIvZmFzdGVyIHRoYW4gdXNp
        bmcgYSBjYWxsYmFjay4KCiAgICBAbWV0aG9kIHNvbWVQcm9wZXJ0eQogICAg
        QHBhcmFtIHtTdHJpbmd9IGtleSB0aGUgcHJvcGVydHkgdG8gdGVzdAogICAg
        QHBhcmFtIHtTdHJpbmd9IFt2YWx1ZV0gb3B0aW9uYWwgdmFsdWUgdG8gdGVz
        dCBhZ2FpbnN0LgogICAgQHJldHVybiB7Qm9vbGVhbn0gYHRydWVgIGlmIHRo
        ZSBwYXNzZWQgZnVuY3Rpb24gcmV0dXJucyBgdHJ1ZWAgZm9yIGFueSBpdGVt
        CiAgICBAZGVwcmVjYXRlZCBVc2UgYGFueUJ5YCBpbnN0ZWFkCiAgKi8KICBz
        b21lUHJvcGVydHk6IEVtYmVyLmFsaWFzTWV0aG9kKCdhbnlCeScpLAoKICAv
        KioKICAgIFRoaXMgd2lsbCBjb21iaW5lIHRoZSB2YWx1ZXMgb2YgdGhlIGVu
        dW1lcmF0b3IgaW50byBhIHNpbmdsZSB2YWx1ZS4gSXQKICAgIGlzIGEgdXNl
        ZnVsIHdheSB0byBjb2xsZWN0IGEgc3VtbWFyeSB2YWx1ZSBmcm9tIGFuIGVu
        dW1lcmF0aW9uLiBUaGlzCiAgICBjb3JyZXNwb25kcyB0byB0aGUgYHJlZHVj
        ZSgpYCBtZXRob2QgZGVmaW5lZCBpbiBKYXZhU2NyaXB0IDEuOC4KCiAgICBU
        aGUgY2FsbGJhY2sgbWV0aG9kIHlvdSBwcm92aWRlIHNob3VsZCBoYXZlIHRo
        ZSBmb2xsb3dpbmcgc2lnbmF0dXJlIChhbGwKICAgIHBhcmFtZXRlcnMgYXJl
        IG9wdGlvbmFsKToKCiAgICBgYGBqYXZhc2NyaXB0CiAgICBmdW5jdGlvbihw
        cmV2aW91c1ZhbHVlLCBpdGVtLCBpbmRleCwgZW51bWVyYWJsZSk7CiAgICBg
        YGAKCiAgICAtIGBwcmV2aW91c1ZhbHVlYCBpcyB0aGUgdmFsdWUgcmV0dXJu
        ZWQgYnkgdGhlIGxhc3QgY2FsbCB0byB0aGUgaXRlcmF0b3IuCiAgICAtIGBp
        dGVtYCBpcyB0aGUgY3VycmVudCBpdGVtIGluIHRoZSBpdGVyYXRpb24uCiAg
        ICAtIGBpbmRleGAgaXMgdGhlIGN1cnJlbnQgaW5kZXggaW4gdGhlIGl0ZXJh
        dGlvbi4KICAgIC0gYGVudW1lcmFibGVgIGlzIHRoZSBlbnVtZXJhYmxlIG9i
        amVjdCBpdHNlbGYuCgogICAgUmV0dXJuIHRoZSBuZXcgY3VtdWxhdGl2ZSB2
        YWx1ZS4KCiAgICBJbiBhZGRpdGlvbiB0byB0aGUgY2FsbGJhY2sgeW91IGNh
        biBhbHNvIHBhc3MgYW4gYGluaXRpYWxWYWx1ZWAuIEFuIGVycm9yCiAgICB3
        aWxsIGJlIHJhaXNlZCBpZiB5b3UgZG8gbm90IHBhc3MgYW4gaW5pdGlhbCB2
        YWx1ZSBhbmQgdGhlIGVudW1lcmF0b3IgaXMKICAgIGVtcHR5LgoKICAgIE5v
        dGUgdGhhdCB1bmxpa2UgdGhlIG90aGVyIG1ldGhvZHMsIHRoaXMgbWV0aG9k
        IGRvZXMgbm90IGFsbG93IHlvdSB0bwogICAgcGFzcyBhIHRhcmdldCBvYmpl
        Y3QgdG8gc2V0IGFzIHRoaXMgZm9yIHRoZSBjYWxsYmFjay4gSXQncyBwYXJ0
        IG9mIHRoZQogICAgc3BlYy4gU29ycnkuCgogICAgQG1ldGhvZCByZWR1Y2UK
        ICAgIEBwYXJhbSB7RnVuY3Rpb259IGNhbGxiYWNrIFRoZSBjYWxsYmFjayB0
        byBleGVjdXRlCiAgICBAcGFyYW0ge09iamVjdH0gaW5pdGlhbFZhbHVlIElu
        aXRpYWwgdmFsdWUgZm9yIHRoZSByZWR1Y2UKICAgIEBwYXJhbSB7U3RyaW5n
        fSByZWR1Y2VyUHJvcGVydHkgaW50ZXJuYWwgdXNlIG9ubHkuCiAgICBAcmV0
        dXJuIHtPYmplY3R9IFRoZSByZWR1Y2VkIHZhbHVlLgogICovCiAgcmVkdWNl
        OiBmdW5jdGlvbihjYWxsYmFjaywgaW5pdGlhbFZhbHVlLCByZWR1Y2VyUHJv
        cGVydHkpIHsKICAgIGlmICh0eXBlb2YgY2FsbGJhY2sgIT09ICJmdW5jdGlv
        biIpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcigpOyB9CgogICAgdmFyIHJldCA9
        IGluaXRpYWxWYWx1ZTsKCiAgICB0aGlzLmZvckVhY2goZnVuY3Rpb24oaXRl
        bSwgaSkgewogICAgICByZXQgPSBjYWxsYmFjay5jYWxsKG51bGwsIHJldCwg
        aXRlbSwgaSwgdGhpcywgcmVkdWNlclByb3BlcnR5KTsKICAgIH0sIHRoaXMp
        OwoKICAgIHJldHVybiByZXQ7CiAgfSwKCiAgLyoqCiAgICBJbnZva2VzIHRo
        ZSBuYW1lZCBtZXRob2Qgb24gZXZlcnkgb2JqZWN0IGluIHRoZSByZWNlaXZl
        ciB0aGF0CiAgICBpbXBsZW1lbnRzIGl0LiBUaGlzIG1ldGhvZCBjb3JyZXNw
        b25kcyB0byB0aGUgaW1wbGVtZW50YXRpb24gaW4KICAgIFByb3RvdHlwZSAx
        LjYuCgogICAgQG1ldGhvZCBpbnZva2UKICAgIEBwYXJhbSB7U3RyaW5nfSBt
        ZXRob2ROYW1lIHRoZSBuYW1lIG9mIHRoZSBtZXRob2QKICAgIEBwYXJhbSB7
        T2JqZWN0Li4ufSBhcmdzIG9wdGlvbmFsIGFyZ3VtZW50cyB0byBwYXNzIGFz
        IHdlbGwuCiAgICBAcmV0dXJuIHtBcnJheX0gcmV0dXJuIHZhbHVlcyBmcm9t
        IGNhbGxpbmcgaW52b2tlLgogICovCiAgaW52b2tlOiBmdW5jdGlvbihtZXRo
        b2ROYW1lKSB7CiAgICB2YXIgYXJncywgcmV0ID0gRW1iZXIuQSgpOwogICAg
        aWYgKGFyZ3VtZW50cy5sZW5ndGg+MSkgYXJncyA9IGFfc2xpY2UuY2FsbChh
        cmd1bWVudHMsIDEpOwoKICAgIHRoaXMuZm9yRWFjaChmdW5jdGlvbih4LCBp
        ZHgpIHsKICAgICAgdmFyIG1ldGhvZCA9IHggJiYgeFttZXRob2ROYW1lXTsK
        ICAgICAgaWYgKCdmdW5jdGlvbicgPT09IHR5cGVvZiBtZXRob2QpIHsKICAg
        ICAgICByZXRbaWR4XSA9IGFyZ3MgPyBtZXRob2QuYXBwbHkoeCwgYXJncykg
        OiBtZXRob2QuY2FsbCh4KTsKICAgICAgfQogICAgfSwgdGhpcyk7CgogICAg
        cmV0dXJuIHJldDsKICB9LAoKICAvKioKICAgIFNpbXBseSBjb252ZXJ0cyB0
        aGUgZW51bWVyYWJsZSBpbnRvIGEgZ2VudWluZSBhcnJheS4gVGhlIG9yZGVy
        IGlzIG5vdAogICAgZ3VhcmFudGVlZC4gQ29ycmVzcG9uZHMgdG8gdGhlIG1l
        dGhvZCBpbXBsZW1lbnRlZCBieSBQcm90b3R5cGUuCgogICAgQG1ldGhvZCB0
        b0FycmF5CiAgICBAcmV0dXJuIHtBcnJheX0gdGhlIGVudW1lcmFibGUgYXMg
        YW4gYXJyYXkuCiAgKi8KICB0b0FycmF5OiBmdW5jdGlvbigpIHsKICAgIHZh
        ciByZXQgPSBFbWJlci5BKCk7CiAgICB0aGlzLmZvckVhY2goZnVuY3Rpb24o
        bywgaWR4KSB7IHJldFtpZHhdID0gbzsgfSk7CiAgICByZXR1cm4gcmV0IDsK
        ICB9LAoKICAvKioKICAgIFJldHVybnMgYSBjb3B5IG9mIHRoZSBhcnJheSB3
        aXRoIGFsbCBudWxsIGFuZCB1bmRlZmluZWQgZWxlbWVudHMgcmVtb3ZlZC4K
        CiAgICBgYGBqYXZhc2NyaXB0CiAgICB2YXIgYXJyID0gWyJhIiwgbnVsbCwg
        ImMiLCB1bmRlZmluZWRdOwogICAgYXJyLmNvbXBhY3QoKTsgIC8vIFsiYSIs
        ICJjIl0KICAgIGBgYAoKICAgIEBtZXRob2QgY29tcGFjdAogICAgQHJldHVy
        biB7QXJyYXl9IHRoZSBhcnJheSB3aXRob3V0IG51bGwgYW5kIHVuZGVmaW5l
        ZCBlbGVtZW50cy4KICAqLwogIGNvbXBhY3Q6IGZ1bmN0aW9uKCkgewogICAg
        cmV0dXJuIHRoaXMuZmlsdGVyKGZ1bmN0aW9uKHZhbHVlKSB7IHJldHVybiB2
        YWx1ZSAhPSBudWxsOyB9KTsKICB9LAoKICAvKioKICAgIFJldHVybnMgYSBu
        ZXcgZW51bWVyYWJsZSB0aGF0IGV4Y2x1ZGVzIHRoZSBwYXNzZWQgdmFsdWUu
        IFRoZSBkZWZhdWx0CiAgICBpbXBsZW1lbnRhdGlvbiByZXR1cm5zIGFuIGFy
        cmF5IHJlZ2FyZGxlc3Mgb2YgdGhlIHJlY2VpdmVyIHR5cGUgdW5sZXNzCiAg
        ICB0aGUgcmVjZWl2ZXIgZG9lcyBub3QgY29udGFpbiB0aGUgdmFsdWUuCgog
        ICAgYGBgamF2YXNjcmlwdAogICAgdmFyIGFyciA9IFsiYSIsICJiIiwgImEi
        LCAiYyJdOwogICAgYXJyLndpdGhvdXQoImEiKTsgIC8vIFsiYiIsICJjIl0K
        ICAgIGBgYAoKICAgIEBtZXRob2Qgd2l0aG91dAogICAgQHBhcmFtIHtPYmpl
        Y3R9IHZhbHVlCiAgICBAcmV0dXJuIHtFbWJlci5FbnVtZXJhYmxlfQogICov
        CiAgd2l0aG91dDogZnVuY3Rpb24odmFsdWUpIHsKICAgIGlmICghdGhpcy5j
        b250YWlucyh2YWx1ZSkpIHJldHVybiB0aGlzOyAvLyBub3RoaW5nIHRvIGRv
        CiAgICB2YXIgcmV0ID0gRW1iZXIuQSgpOwogICAgdGhpcy5mb3JFYWNoKGZ1
        bmN0aW9uKGspIHsKICAgICAgaWYgKGsgIT09IHZhbHVlKSByZXRbcmV0Lmxl
        bmd0aF0gPSBrOwogICAgfSkgOwogICAgcmV0dXJuIHJldCA7CiAgfSwKCiAg
        LyoqCiAgICBSZXR1cm5zIGEgbmV3IGVudW1lcmFibGUgdGhhdCBjb250YWlu
        cyBvbmx5IHVuaXF1ZSB2YWx1ZXMuIFRoZSBkZWZhdWx0CiAgICBpbXBsZW1l
        bnRhdGlvbiByZXR1cm5zIGFuIGFycmF5IHJlZ2FyZGxlc3Mgb2YgdGhlIHJl
        Y2VpdmVyIHR5cGUuCgogICAgYGBgamF2YXNjcmlwdAogICAgdmFyIGFyciA9
        IFsiYSIsICJhIiwgImIiLCAiYiJdOwogICAgYXJyLnVuaXEoKTsgIC8vIFsi
        YSIsICJiIl0KICAgIGBgYAoKICAgIEBtZXRob2QgdW5pcQogICAgQHJldHVy
        biB7RW1iZXIuRW51bWVyYWJsZX0KICAqLwogIHVuaXE6IGZ1bmN0aW9uKCkg
        ewogICAgdmFyIHJldCA9IEVtYmVyLkEoKTsKICAgIHRoaXMuZm9yRWFjaChm
        dW5jdGlvbihrKSB7CiAgICAgIGlmIChhX2luZGV4T2YocmV0LCBrKTwwKSBy
        ZXQucHVzaChrKTsKICAgIH0pOwogICAgcmV0dXJuIHJldDsKICB9LAoKICAv
        KioKICAgIFRoaXMgcHJvcGVydHkgd2lsbCB0cmlnZ2VyIGFueXRpbWUgdGhl
        IGVudW1lcmFibGUncyBjb250ZW50IGNoYW5nZXMuCiAgICBZb3UgY2FuIG9i
        c2VydmUgdGhpcyBwcm9wZXJ0eSB0byBiZSBub3RpZmllZCBvZiBjaGFuZ2Vz
        IHRvIHRoZSBlbnVtZXJhYmxlcwogICAgY29udGVudC4KCiAgICBGb3IgcGxh
        aW4gZW51bWVyYWJsZXMsIHRoaXMgcHJvcGVydHkgaXMgcmVhZCBvbmx5LiBg
        RW1iZXIuQXJyYXlgIG92ZXJyaWRlcwogICAgdGhpcyBtZXRob2QuCgogICAg
        QHByb3BlcnR5IFtdCiAgICBAdHlwZSBFbWJlci5BcnJheQogICAgQHJldHVy
        biB0aGlzCiAgKi8KICAnW10nOiBFbWJlci5jb21wdXRlZChmdW5jdGlvbihr
        ZXksIHZhbHVlKSB7CiAgICByZXR1cm4gdGhpczsKICB9KSwKCiAgLy8gLi4u
        Li4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4u
        Li4uLi4uLi4uLgogIC8vIEVOVU1FUkFCTEUgT0JTRVJWRVJTCiAgLy8KCiAg
        LyoqCiAgICBSZWdpc3RlcnMgYW4gZW51bWVyYWJsZSBvYnNlcnZlci4gTXVz
        dCBpbXBsZW1lbnQgYEVtYmVyLkVudW1lcmFibGVPYnNlcnZlcmAKICAgIG1p
        eGluLgoKICAgIEBtZXRob2QgYWRkRW51bWVyYWJsZU9ic2VydmVyCiAgICBA
        cGFyYW0ge09iamVjdH0gdGFyZ2V0CiAgICBAcGFyYW0ge0hhc2h9IFtvcHRz
        XQogICAgQHJldHVybiB0aGlzCiAgKi8KICBhZGRFbnVtZXJhYmxlT2JzZXJ2
        ZXI6IGZ1bmN0aW9uKHRhcmdldCwgb3B0cykgewogICAgdmFyIHdpbGxDaGFu
        Z2UgPSAob3B0cyAmJiBvcHRzLndpbGxDaGFuZ2UpIHx8ICdlbnVtZXJhYmxl
        V2lsbENoYW5nZScsCiAgICAgICAgZGlkQ2hhbmdlICA9IChvcHRzICYmIG9w
        dHMuZGlkQ2hhbmdlKSB8fCAnZW51bWVyYWJsZURpZENoYW5nZSc7CgogICAg
        dmFyIGhhc09ic2VydmVycyA9IGdldCh0aGlzLCAnaGFzRW51bWVyYWJsZU9i
        c2VydmVycycpOwogICAgaWYgKCFoYXNPYnNlcnZlcnMpIEVtYmVyLnByb3Bl
        cnR5V2lsbENoYW5nZSh0aGlzLCAnaGFzRW51bWVyYWJsZU9ic2VydmVycycp
        OwogICAgRW1iZXIuYWRkTGlzdGVuZXIodGhpcywgJ0BlbnVtZXJhYmxlOmJl
        Zm9yZScsIHRhcmdldCwgd2lsbENoYW5nZSk7CiAgICBFbWJlci5hZGRMaXN0
        ZW5lcih0aGlzLCAnQGVudW1lcmFibGU6Y2hhbmdlJywgdGFyZ2V0LCBkaWRD
        aGFuZ2UpOwogICAgaWYgKCFoYXNPYnNlcnZlcnMpIEVtYmVyLnByb3BlcnR5
        RGlkQ2hhbmdlKHRoaXMsICdoYXNFbnVtZXJhYmxlT2JzZXJ2ZXJzJyk7CiAg
        ICByZXR1cm4gdGhpczsKICB9LAoKICAvKioKICAgIFJlbW92ZXMgYSByZWdp
        c3RlcmVkIGVudW1lcmFibGUgb2JzZXJ2ZXIuCgogICAgQG1ldGhvZCByZW1v
        dmVFbnVtZXJhYmxlT2JzZXJ2ZXIKICAgIEBwYXJhbSB7T2JqZWN0fSB0YXJn
        ZXQKICAgIEBwYXJhbSB7SGFzaH0gW29wdHNdCiAgICBAcmV0dXJuIHRoaXMK
        ICAqLwogIHJlbW92ZUVudW1lcmFibGVPYnNlcnZlcjogZnVuY3Rpb24odGFy
        Z2V0LCBvcHRzKSB7CiAgICB2YXIgd2lsbENoYW5nZSA9IChvcHRzICYmIG9w
        dHMud2lsbENoYW5nZSkgfHwgJ2VudW1lcmFibGVXaWxsQ2hhbmdlJywKICAg
        ICAgICBkaWRDaGFuZ2UgID0gKG9wdHMgJiYgb3B0cy5kaWRDaGFuZ2UpIHx8
        ICdlbnVtZXJhYmxlRGlkQ2hhbmdlJzsKCiAgICB2YXIgaGFzT2JzZXJ2ZXJz
        ID0gZ2V0KHRoaXMsICdoYXNFbnVtZXJhYmxlT2JzZXJ2ZXJzJyk7CiAgICBp
        ZiAoaGFzT2JzZXJ2ZXJzKSBFbWJlci5wcm9wZXJ0eVdpbGxDaGFuZ2UodGhp
        cywgJ2hhc0VudW1lcmFibGVPYnNlcnZlcnMnKTsKICAgIEVtYmVyLnJlbW92
        ZUxpc3RlbmVyKHRoaXMsICdAZW51bWVyYWJsZTpiZWZvcmUnLCB0YXJnZXQs
        IHdpbGxDaGFuZ2UpOwogICAgRW1iZXIucmVtb3ZlTGlzdGVuZXIodGhpcywg
        J0BlbnVtZXJhYmxlOmNoYW5nZScsIHRhcmdldCwgZGlkQ2hhbmdlKTsKICAg
        IGlmIChoYXNPYnNlcnZlcnMpIEVtYmVyLnByb3BlcnR5RGlkQ2hhbmdlKHRo
        aXMsICdoYXNFbnVtZXJhYmxlT2JzZXJ2ZXJzJyk7CiAgICByZXR1cm4gdGhp
        czsKICB9LAoKICAvKioKICAgIEJlY29tZXMgdHJ1ZSB3aGVuZXZlciB0aGUg
        YXJyYXkgY3VycmVudGx5IGhhcyBvYnNlcnZlcnMgd2F0Y2hpbmcgY2hhbmdl
        cwogICAgb24gdGhlIGFycmF5LgoKICAgIEBwcm9wZXJ0eSBoYXNFbnVtZXJh
        YmxlT2JzZXJ2ZXJzCiAgICBAdHlwZSBCb29sZWFuCiAgKi8KICBoYXNFbnVt
        ZXJhYmxlT2JzZXJ2ZXJzOiBFbWJlci5jb21wdXRlZChmdW5jdGlvbigpIHsK
        ICAgIHJldHVybiBFbWJlci5oYXNMaXN0ZW5lcnModGhpcywgJ0BlbnVtZXJh
        YmxlOmNoYW5nZScpIHx8IEVtYmVyLmhhc0xpc3RlbmVycyh0aGlzLCAnQGVu
        dW1lcmFibGU6YmVmb3JlJyk7CiAgfSksCgoKICAvKioKICAgIEludm9rZSB0
        aGlzIG1ldGhvZCBqdXN0IGJlZm9yZSB0aGUgY29udGVudHMgb2YgeW91ciBl
        bnVtZXJhYmxlIHdpbGwKICAgIGNoYW5nZS4gWW91IGNhbiBlaXRoZXIgb21p
        dCB0aGUgcGFyYW1ldGVycyBjb21wbGV0ZWx5IG9yIHBhc3MgdGhlIG9iamVj
        dHMKICAgIHRvIGJlIHJlbW92ZWQgb3IgYWRkZWQgaWYgYXZhaWxhYmxlIG9y
        IGp1c3QgYSBjb3VudC4KCiAgICBAbWV0aG9kIGVudW1lcmFibGVDb250ZW50
        V2lsbENoYW5nZQogICAgQHBhcmFtIHtFbWJlci5FbnVtZXJhYmxlfE51bWJl
        cn0gcmVtb3ZpbmcgQW4gZW51bWVyYWJsZSBvZiB0aGUgb2JqZWN0cyB0bwog
        ICAgICBiZSByZW1vdmVkIG9yIHRoZSBudW1iZXIgb2YgaXRlbXMgdG8gYmUg
        cmVtb3ZlZC4KICAgIEBwYXJhbSB7RW1iZXIuRW51bWVyYWJsZXxOdW1iZXJ9
        IGFkZGluZyBBbiBlbnVtZXJhYmxlIG9mIHRoZSBvYmplY3RzIHRvIGJlCiAg
        ICAgIGFkZGVkIG9yIHRoZSBudW1iZXIgb2YgaXRlbXMgdG8gYmUgYWRkZWQu
        CiAgICBAY2hhaW5hYmxlCiAgKi8KICBlbnVtZXJhYmxlQ29udGVudFdpbGxD
        aGFuZ2U6IGZ1bmN0aW9uKHJlbW92aW5nLCBhZGRpbmcpIHsKCiAgICB2YXIg
        cmVtb3ZlQ250LCBhZGRDbnQsIGhhc0RlbHRhOwoKICAgIGlmICgnbnVtYmVy
        JyA9PT0gdHlwZW9mIHJlbW92aW5nKSByZW1vdmVDbnQgPSByZW1vdmluZzsK
        ICAgIGVsc2UgaWYgKHJlbW92aW5nKSByZW1vdmVDbnQgPSBnZXQocmVtb3Zp
        bmcsICdsZW5ndGgnKTsKICAgIGVsc2UgcmVtb3ZlQ250ID0gcmVtb3Zpbmcg
        PSAtMTsKCiAgICBpZiAoJ251bWJlcicgPT09IHR5cGVvZiBhZGRpbmcpIGFk
        ZENudCA9IGFkZGluZzsKICAgIGVsc2UgaWYgKGFkZGluZykgYWRkQ250ID0g
        Z2V0KGFkZGluZywnbGVuZ3RoJyk7CiAgICBlbHNlIGFkZENudCA9IGFkZGlu
        ZyA9IC0xOwoKICAgIGhhc0RlbHRhID0gYWRkQ250PDAgfHwgcmVtb3ZlQ250
        PDAgfHwgYWRkQ250LXJlbW92ZUNudCE9PTA7CgogICAgaWYgKHJlbW92aW5n
        ID09PSAtMSkgcmVtb3ZpbmcgPSBudWxsOwogICAgaWYgKGFkZGluZyAgID09
        PSAtMSkgYWRkaW5nICAgPSBudWxsOwoKICAgIEVtYmVyLnByb3BlcnR5V2ls
        bENoYW5nZSh0aGlzLCAnW10nKTsKICAgIGlmIChoYXNEZWx0YSkgRW1iZXIu
        cHJvcGVydHlXaWxsQ2hhbmdlKHRoaXMsICdsZW5ndGgnKTsKICAgIEVtYmVy
        LnNlbmRFdmVudCh0aGlzLCAnQGVudW1lcmFibGU6YmVmb3JlJywgW3RoaXMs
        IHJlbW92aW5nLCBhZGRpbmddKTsKCiAgICByZXR1cm4gdGhpczsKICB9LAoK
        ICAvKioKICAgIEludm9rZSB0aGlzIG1ldGhvZCB3aGVuIHRoZSBjb250ZW50
        cyBvZiB5b3VyIGVudW1lcmFibGUgaGFzIGNoYW5nZWQuCiAgICBUaGlzIHdp
        bGwgbm90aWZ5IGFueSBvYnNlcnZlcnMgd2F0Y2hpbmcgZm9yIGNvbnRlbnQg
        Y2hhbmdlcy4gSWYgeW91ciBhcmUKICAgIGltcGxlbWVudGluZyBhbiBvcmRl
        cmVkIGVudW1lcmFibGUgKHN1Y2ggYXMgYW4gYXJyYXkpLCBhbHNvIHBhc3Mg
        dGhlCiAgICBzdGFydCBhbmQgZW5kIHZhbHVlcyB3aGVyZSB0aGUgY29udGVu
        dCBjaGFuZ2VkIHNvIHRoYXQgaXQgY2FuIGJlIHVzZWQgdG8KICAgIG5vdGlm
        eSByYW5nZSBvYnNlcnZlcnMuCgogICAgQG1ldGhvZCBlbnVtZXJhYmxlQ29u
        dGVudERpZENoYW5nZQogICAgQHBhcmFtIHtOdW1iZXJ9IFtzdGFydF0gb3B0
        aW9uYWwgc3RhcnQgb2Zmc2V0IGZvciB0aGUgY29udGVudCBjaGFuZ2UuCiAg
        ICAgIEZvciB1bm9yZGVyZWQgZW51bWVyYWJsZXMsIHlvdSBzaG91bGQgYWx3
        YXlzIHBhc3MgLTEuCiAgICBAcGFyYW0ge0VtYmVyLkVudW1lcmFibGV8TnVt
        YmVyfSByZW1vdmluZyBBbiBlbnVtZXJhYmxlIG9mIHRoZSBvYmplY3RzIHRv
        CiAgICAgIGJlIHJlbW92ZWQgb3IgdGhlIG51bWJlciBvZiBpdGVtcyB0byBi
        ZSByZW1vdmVkLgogICAgQHBhcmFtIHtFbWJlci5FbnVtZXJhYmxlfE51bWJl
        cn0gYWRkaW5nICBBbiBlbnVtZXJhYmxlIG9mIHRoZSBvYmplY3RzIHRvCiAg
        ICAgIGJlIGFkZGVkIG9yIHRoZSBudW1iZXIgb2YgaXRlbXMgdG8gYmUgYWRk
        ZWQuCiAgICBAY2hhaW5hYmxlCiAgKi8KICBlbnVtZXJhYmxlQ29udGVudERp
        ZENoYW5nZTogZnVuY3Rpb24ocmVtb3ZpbmcsIGFkZGluZykgewogICAgdmFy
        IHJlbW92ZUNudCwgYWRkQ250LCBoYXNEZWx0YTsKCiAgICBpZiAoJ251bWJl
        cicgPT09IHR5cGVvZiByZW1vdmluZykgcmVtb3ZlQ250ID0gcmVtb3Zpbmc7
        CiAgICBlbHNlIGlmIChyZW1vdmluZykgcmVtb3ZlQ250ID0gZ2V0KHJlbW92
        aW5nLCAnbGVuZ3RoJyk7CiAgICBlbHNlIHJlbW92ZUNudCA9IHJlbW92aW5n
        ID0gLTE7CgogICAgaWYgKCdudW1iZXInID09PSB0eXBlb2YgYWRkaW5nKSBh
        ZGRDbnQgPSBhZGRpbmc7CiAgICBlbHNlIGlmIChhZGRpbmcpIGFkZENudCA9
        IGdldChhZGRpbmcsICdsZW5ndGgnKTsKICAgIGVsc2UgYWRkQ250ID0gYWRk
        aW5nID0gLTE7CgogICAgaGFzRGVsdGEgPSBhZGRDbnQ8MCB8fCByZW1vdmVD
        bnQ8MCB8fCBhZGRDbnQtcmVtb3ZlQ250IT09MDsKCiAgICBpZiAocmVtb3Zp
        bmcgPT09IC0xKSByZW1vdmluZyA9IG51bGw7CiAgICBpZiAoYWRkaW5nICAg
        PT09IC0xKSBhZGRpbmcgICA9IG51bGw7CgogICAgRW1iZXIuc2VuZEV2ZW50
        KHRoaXMsICdAZW51bWVyYWJsZTpjaGFuZ2UnLCBbdGhpcywgcmVtb3Zpbmcs
        IGFkZGluZ10pOwogICAgaWYgKGhhc0RlbHRhKSBFbWJlci5wcm9wZXJ0eURp
        ZENoYW5nZSh0aGlzLCAnbGVuZ3RoJyk7CiAgICBFbWJlci5wcm9wZXJ0eURp
        ZENoYW5nZSh0aGlzLCAnW10nKTsKCiAgICByZXR1cm4gdGhpcyA7CiAgfQoK
        fSkgOwoKfSkoKTsKCgoKKGZ1bmN0aW9uKCkgewovKioKQG1vZHVsZSBlbWJl
        cgpAc3VibW9kdWxlIGVtYmVyLXJ1bnRpbWUKKi8KCi8vIC4uLi4uLi4uLi4u
        Li4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4u
        Li4KLy8gSEVMUEVSUwovLwoKdmFyIGdldCA9IEVtYmVyLmdldCwgc2V0ID0g
        RW1iZXIuc2V0LCBpc05vbmUgPSBFbWJlci5pc05vbmUsIG1hcCA9IEVtYmVy
        LkVudW1lcmFibGVVdGlscy5tYXAsIGNhY2hlRm9yID0gRW1iZXIuY2FjaGVG
        b3I7CgovLyAuLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4u
        Li4uLi4uLi4uLi4uLi4uLi4uLi4uCi8vIEFSUkFZCi8vCi8qKgogIFRoaXMg
        bW9kdWxlIGltcGxlbWVudHMgT2JzZXJ2ZXItZnJpZW5kbHkgQXJyYXktbGlr
        ZSBiZWhhdmlvci4gVGhpcyBtaXhpbiBpcwogIHBpY2tlZCB1cCBieSB0aGUg
        QXJyYXkgY2xhc3MgYXMgd2VsbCBhcyBvdGhlciBjb250cm9sbGVycywgZXRj
        LiB0aGF0IHdhbnQgdG8KICBhcHBlYXIgdG8gYmUgYXJyYXlzLgoKICBVbmxp
        a2UgYEVtYmVyLkVudW1lcmFibGUsYCB0aGlzIG1peGluIGRlZmluZXMgbWV0
        aG9kcyBzcGVjaWZpY2FsbHkgZm9yCiAgY29sbGVjdGlvbnMgdGhhdCBwcm92
        aWRlIGluZGV4LW9yZGVyZWQgYWNjZXNzIHRvIHRoZWlyIGNvbnRlbnRzLiBX
        aGVuIHlvdQogIGFyZSBkZXNpZ25pbmcgY29kZSB0aGF0IG5lZWRzIHRvIGFj
        Y2VwdCBhbnkga2luZCBvZiBBcnJheS1saWtlIG9iamVjdCwgeW91CiAgc2hv
        dWxkIHVzZSB0aGVzZSBtZXRob2RzIGluc3RlYWQgb2YgQXJyYXkgcHJpbWl0
        aXZlcyBiZWNhdXNlIHRoZXNlIHdpbGwKICBwcm9wZXJseSBub3RpZnkgb2Jz
        ZXJ2ZXJzIG9mIGNoYW5nZXMgdG8gdGhlIGFycmF5LgoKICBBbHRob3VnaCB0
        aGVzZSBtZXRob2RzIGFyZSBlZmZpY2llbnQsIHRoZXkgZG8gYWRkIGEgbGF5
        ZXIgb2YgaW5kaXJlY3Rpb24gdG8KICB5b3VyIGFwcGxpY2F0aW9uIHNvIGl0
        IGlzIGEgZ29vZCBpZGVhIHRvIHVzZSB0aGVtIG9ubHkgd2hlbiB5b3UgbmVl
        ZCB0aGUKICBmbGV4aWJpbGl0eSBvZiB1c2luZyBib3RoIHRydWUgSmF2YVNj
        cmlwdCBhcnJheXMgYW5kICJ2aXJ0dWFsIiBhcnJheXMgc3VjaAogIGFzIGNv
        bnRyb2xsZXJzIGFuZCBjb2xsZWN0aW9ucy4KCiAgWW91IGNhbiB1c2UgdGhl
        IG1ldGhvZHMgZGVmaW5lZCBpbiB0aGlzIG1vZHVsZSB0byBhY2Nlc3MgYW5k
        IG1vZGlmeSBhcnJheQogIGNvbnRlbnRzIGluIGEgS1ZPLWZyaWVuZGx5IHdh
        eS4gWW91IGNhbiBhbHNvIGJlIG5vdGlmaWVkIHdoZW5ldmVyIHRoZQogIG1l
        bWJlcnNoaXAgb2YgYW4gYXJyYXkgY2hhbmdlcyBieSBjaGFuZ2luZyB0aGUg
        c3ludGF4IG9mIHRoZSBwcm9wZXJ0eSB0bwogIGAub2JzZXJ2ZXMoJypteVBy
        b3BlcnR5LltdJylgLgoKICBUbyBzdXBwb3J0IGBFbWJlci5BcnJheWAgaW4g
        eW91ciBvd24gY2xhc3MsIHlvdSBtdXN0IG92ZXJyaWRlIHR3bwogIHByaW1p
        dGl2ZXMgdG8gdXNlIGl0OiBgcmVwbGFjZSgpYCBhbmQgYG9iamVjdEF0KClg
        LgoKICBOb3RlIHRoYXQgdGhlIEVtYmVyLkFycmF5IG1peGluIGFsc28gaW5j
        b3Jwb3JhdGVzIHRoZSBgRW1iZXIuRW51bWVyYWJsZWAKICBtaXhpbi4gQWxs
        IGBFbWJlci5BcnJheWAtbGlrZSBvYmplY3RzIGFyZSBhbHNvIGVudW1lcmFi
        bGUuCgogIEBjbGFzcyBBcnJheQogIEBuYW1lc3BhY2UgRW1iZXIKICBAdXNl
        cyBFbWJlci5FbnVtZXJhYmxlCiAgQHNpbmNlIEVtYmVyIDAuOS4wCiovCkVt
        YmVyLkFycmF5ID0gRW1iZXIuTWl4aW4uY3JlYXRlKEVtYmVyLkVudW1lcmFi
        bGUsIC8qKiBAc2NvcGUgRW1iZXIuQXJyYXkucHJvdG90eXBlICovIHsKCiAg
        LyoqCiAgICBZb3VyIGFycmF5IG11c3Qgc3VwcG9ydCB0aGUgYGxlbmd0aGAg
        cHJvcGVydHkuIFlvdXIgcmVwbGFjZSBtZXRob2RzIHNob3VsZAogICAgc2V0
        IHRoaXMgcHJvcGVydHkgd2hlbmV2ZXIgaXQgY2hhbmdlcy4KCiAgICBAcHJv
        cGVydHkge051bWJlcn0gbGVuZ3RoCiAgKi8KICBsZW5ndGg6IEVtYmVyLnJl
        cXVpcmVkKCksCgogIC8qKgogICAgUmV0dXJucyB0aGUgb2JqZWN0IGF0IHRo
        ZSBnaXZlbiBgaW5kZXhgLiBJZiB0aGUgZ2l2ZW4gYGluZGV4YCBpcyBuZWdh
        dGl2ZQogICAgb3IgaXMgZ3JlYXRlciBvciBlcXVhbCB0aGFuIHRoZSBhcnJh
        eSBsZW5ndGgsIHJldHVybnMgYHVuZGVmaW5lZGAuCgogICAgVGhpcyBpcyBv
        bmUgb2YgdGhlIHByaW1pdGl2ZXMgeW91IG11c3QgaW1wbGVtZW50IHRvIHN1
        cHBvcnQgYEVtYmVyLkFycmF5YC4KICAgIElmIHlvdXIgb2JqZWN0IHN1cHBv
        cnRzIHJldHJpZXZpbmcgdGhlIHZhbHVlIG9mIGFuIGFycmF5IGl0ZW0gdXNp
        bmcgYGdldCgpYAogICAgKGkuZS4gYG15QXJyYXkuZ2V0KDApYCksIHRoZW4g
        eW91IGRvIG5vdCBuZWVkIHRvIGltcGxlbWVudCB0aGlzIG1ldGhvZAogICAg
        eW91cnNlbGYuCgogICAgYGBgamF2YXNjcmlwdAogICAgdmFyIGFyciA9IFsn
        YScsICdiJywgJ2MnLCAnZCddOwogICAgYXJyLm9iamVjdEF0KDApOyAgIC8v
        ICJhIgogICAgYXJyLm9iamVjdEF0KDMpOyAgIC8vICJkIgogICAgYXJyLm9i
        amVjdEF0KC0xKTsgIC8vIHVuZGVmaW5lZAogICAgYXJyLm9iamVjdEF0KDQp
        OyAgIC8vIHVuZGVmaW5lZAogICAgYXJyLm9iamVjdEF0KDUpOyAgIC8vIHVu
        ZGVmaW5lZAogICAgYGBgCgogICAgQG1ldGhvZCBvYmplY3RBdAogICAgQHBh
        cmFtIHtOdW1iZXJ9IGlkeCBUaGUgaW5kZXggb2YgdGhlIGl0ZW0gdG8gcmV0
        dXJuLgogICAgQHJldHVybiB7Kn0gaXRlbSBhdCBpbmRleCBvciB1bmRlZmlu
        ZWQKICAqLwogIG9iamVjdEF0OiBmdW5jdGlvbihpZHgpIHsKICAgIGlmICgo
        aWR4IDwgMCkgfHwgKGlkeD49Z2V0KHRoaXMsICdsZW5ndGgnKSkpIHJldHVy
        biB1bmRlZmluZWQgOwogICAgcmV0dXJuIGdldCh0aGlzLCBpZHgpOwogIH0s
        CgogIC8qKgogICAgVGhpcyByZXR1cm5zIHRoZSBvYmplY3RzIGF0IHRoZSBz
        cGVjaWZpZWQgaW5kZXhlcywgdXNpbmcgYG9iamVjdEF0YC4KCiAgICBgYGBq
        YXZhc2NyaXB0CiAgICB2YXIgYXJyID3CoFsnYScsICdiJywgJ2MnLCAnZCdd
        OwogICAgYXJyLm9iamVjdHNBdChbMCwgMSwgMl0pOyAgLy8gWyJhIiwgImIi
        LCAiYyJdCiAgICBhcnIub2JqZWN0c0F0KFsyLCAzLCA0XSk7ICAvLyBbImMi
        LCAiZCIsIHVuZGVmaW5lZF0KICAgIGBgYAoKICAgIEBtZXRob2Qgb2JqZWN0
        c0F0CiAgICBAcGFyYW0ge0FycmF5fSBpbmRleGVzIEFuIGFycmF5IG9mIGlu
        ZGV4ZXMgb2YgaXRlbXMgdG8gcmV0dXJuLgogICAgQHJldHVybiB7QXJyYXl9
        CiAgICovCiAgb2JqZWN0c0F0OiBmdW5jdGlvbihpbmRleGVzKSB7CiAgICB2
        YXIgc2VsZiA9IHRoaXM7CiAgICByZXR1cm4gbWFwKGluZGV4ZXMsIGZ1bmN0
        aW9uKGlkeCkgeyByZXR1cm4gc2VsZi5vYmplY3RBdChpZHgpOyB9KTsKICB9
        LAoKICAvLyBvdmVycmlkZXMgRW1iZXIuRW51bWVyYWJsZSB2ZXJzaW9uCiAg
        bmV4dE9iamVjdDogZnVuY3Rpb24oaWR4KSB7CiAgICByZXR1cm4gdGhpcy5v
        YmplY3RBdChpZHgpOwogIH0sCgogIC8qKgogICAgVGhpcyBpcyB0aGUgaGFu
        ZGxlciBmb3IgdGhlIHNwZWNpYWwgYXJyYXkgY29udGVudCBwcm9wZXJ0eS4g
        SWYgeW91IGdldAogICAgdGhpcyBwcm9wZXJ0eSwgaXQgd2lsbCByZXR1cm4g
        dGhpcy4gSWYgeW91IHNldCB0aGlzIHByb3BlcnR5IGl0IGEgbmV3CiAgICBh
        cnJheSwgaXQgd2lsbCByZXBsYWNlIHRoZSBjdXJyZW50IGNvbnRlbnQuCgog
        ICAgVGhpcyBwcm9wZXJ0eSBvdmVycmlkZXMgdGhlIGRlZmF1bHQgcHJvcGVy
        dHkgZGVmaW5lZCBpbiBgRW1iZXIuRW51bWVyYWJsZWAuCgogICAgQHByb3Bl
        cnR5IFtdCiAgICBAcmV0dXJuIHRoaXMKICAqLwogICdbXSc6IEVtYmVyLmNv
        bXB1dGVkKGZ1bmN0aW9uKGtleSwgdmFsdWUpIHsKICAgIGlmICh2YWx1ZSAh
        PT0gdW5kZWZpbmVkKSB0aGlzLnJlcGxhY2UoMCwgZ2V0KHRoaXMsICdsZW5n
        dGgnKSwgdmFsdWUpIDsKICAgIHJldHVybiB0aGlzIDsKICB9KSwKCiAgZmly
        c3RPYmplY3Q6IEVtYmVyLmNvbXB1dGVkKGZ1bmN0aW9uKCkgewogICAgcmV0
        dXJuIHRoaXMub2JqZWN0QXQoMCk7CiAgfSksCgogIGxhc3RPYmplY3Q6IEVt
        YmVyLmNvbXB1dGVkKGZ1bmN0aW9uKCkgewogICAgcmV0dXJuIHRoaXMub2Jq
        ZWN0QXQoZ2V0KHRoaXMsICdsZW5ndGgnKS0xKTsKICB9KSwKCiAgLy8gb3B0
        aW1pemVkIHZlcnNpb24gZnJvbSBFbnVtZXJhYmxlCiAgY29udGFpbnM6IGZ1
        bmN0aW9uKG9iaikgewogICAgcmV0dXJuIHRoaXMuaW5kZXhPZihvYmopID49
        IDA7CiAgfSwKCiAgLy8gQWRkIGFueSBleHRyYSBtZXRob2RzIHRvIEVtYmVy
        LkFycmF5IHRoYXQgYXJlIG5hdGl2ZSB0byB0aGUgYnVpbHQtaW4gQXJyYXku
        CiAgLyoqCiAgICBSZXR1cm5zIGEgbmV3IGFycmF5IHRoYXQgaXMgYSBzbGlj
        ZSBvZiB0aGUgcmVjZWl2ZXIuIFRoaXMgaW1wbGVtZW50YXRpb24KICAgIHVz
        ZXMgdGhlIG9ic2VydmFibGUgYXJyYXkgbWV0aG9kcyB0byByZXRyaWV2ZSB0
        aGUgb2JqZWN0cyBmb3IgdGhlIG5ldwogICAgc2xpY2UuCgogICAgYGBgamF2
        YXNjcmlwdAogICAgdmFyIGFyciA9IFsncmVkJywgJ2dyZWVuJywgJ2JsdWUn
        XTsKICAgIGFyci5zbGljZSgwKTsgICAgICAgLy8gWydyZWQnLCAnZ3JlZW4n
        LCAnYmx1ZSddCiAgICBhcnIuc2xpY2UoMCwgMik7ICAgIC8vIFsncmVkJywg
        J2dyZWVuJ10KICAgIGFyci5zbGljZSgxLCAxMDApOyAgLy8gWydncmVlbics
        ICdibHVlJ10KICAgIGBgYAoKICAgIEBtZXRob2Qgc2xpY2UKICAgIEBwYXJh
        bSB7SW50ZWdlcn0gYmVnaW5JbmRleCAoT3B0aW9uYWwpIGluZGV4IHRvIGJl
        Z2luIHNsaWNpbmcgZnJvbS4KICAgIEBwYXJhbSB7SW50ZWdlcn0gZW5kSW5k
        ZXggKE9wdGlvbmFsKSBpbmRleCB0byBlbmQgdGhlIHNsaWNlIGF0LgogICAg
        QHJldHVybiB7QXJyYXl9IE5ldyBhcnJheSB3aXRoIHNwZWNpZmllZCBzbGlj
        ZQogICovCiAgc2xpY2U6IGZ1bmN0aW9uKGJlZ2luSW5kZXgsIGVuZEluZGV4
        KSB7CiAgICB2YXIgcmV0ID0gRW1iZXIuQSgpOwogICAgdmFyIGxlbmd0aCA9
        IGdldCh0aGlzLCAnbGVuZ3RoJykgOwogICAgaWYgKGlzTm9uZShiZWdpbklu
        ZGV4KSkgYmVnaW5JbmRleCA9IDAgOwogICAgaWYgKGlzTm9uZShlbmRJbmRl
        eCkgfHwgKGVuZEluZGV4ID4gbGVuZ3RoKSkgZW5kSW5kZXggPSBsZW5ndGgg
        OwoKICAgIGlmIChiZWdpbkluZGV4IDwgMCkgYmVnaW5JbmRleCA9IGxlbmd0
        aCArIGJlZ2luSW5kZXg7CiAgICBpZiAoZW5kSW5kZXggPCAwKSBlbmRJbmRl
        eCA9IGxlbmd0aCArIGVuZEluZGV4OwoKICAgIHdoaWxlKGJlZ2luSW5kZXgg
        PCBlbmRJbmRleCkgewogICAgICByZXRbcmV0Lmxlbmd0aF0gPSB0aGlzLm9i
        amVjdEF0KGJlZ2luSW5kZXgrKykgOwogICAgfQogICAgcmV0dXJuIHJldCA7
        CiAgfSwKCiAgLyoqCiAgICBSZXR1cm5zIHRoZSBpbmRleCBvZiB0aGUgZ2l2
        ZW4gb2JqZWN0J3MgZmlyc3Qgb2NjdXJyZW5jZS4KICAgIElmIG5vIGBzdGFy
        dEF0YCBhcmd1bWVudCBpcyBnaXZlbiwgdGhlIHN0YXJ0aW5nIGxvY2F0aW9u
        IHRvCiAgICBzZWFyY2ggaXMgMC4gSWYgaXQncyBuZWdhdGl2ZSwgd2lsbCBj
        b3VudCBiYWNrd2FyZCBmcm9tCiAgICB0aGUgZW5kIG9mIHRoZSBhcnJheS4g
        UmV0dXJucyAtMSBpZiBubyBtYXRjaCBpcyBmb3VuZC4KCiAgICBgYGBqYXZh
        c2NyaXB0CiAgICB2YXIgYXJyID0gWyJhIiwgImIiLCAiYyIsICJkIiwgImEi
        XTsKICAgIGFyci5pbmRleE9mKCJhIik7ICAgICAgIC8vICAwCiAgICBhcnIu
        aW5kZXhPZigieiIpOyAgICAgICAvLyAtMQogICAgYXJyLmluZGV4T2YoImEi
        LCAyKTsgICAgLy8gIDQKICAgIGFyci5pbmRleE9mKCJhIiwgLTEpOyAgIC8v
        ICA0CiAgICBhcnIuaW5kZXhPZigiYiIsIDMpOyAgICAvLyAtMQogICAgYXJy
        LmluZGV4T2YoImEiLCAxMDApOyAgLy8gLTEKICAgIGBgYAoKICAgIEBtZXRo
        b2QgaW5kZXhPZgogICAgQHBhcmFtIHtPYmplY3R9IG9iamVjdCB0aGUgaXRl
        bSB0byBzZWFyY2ggZm9yCiAgICBAcGFyYW0ge051bWJlcn0gc3RhcnRBdCBv
        cHRpb25hbCBzdGFydGluZyBsb2NhdGlvbiB0byBzZWFyY2gsIGRlZmF1bHQg
        MAogICAgQHJldHVybiB7TnVtYmVyfSBpbmRleCBvciAtMSBpZiBub3QgZm91
        bmQKICAqLwogIGluZGV4T2Y6IGZ1bmN0aW9uKG9iamVjdCwgc3RhcnRBdCkg
        ewogICAgdmFyIGlkeCwgbGVuID0gZ2V0KHRoaXMsICdsZW5ndGgnKTsKCiAg
        ICBpZiAoc3RhcnRBdCA9PT0gdW5kZWZpbmVkKSBzdGFydEF0ID0gMDsKICAg
        IGlmIChzdGFydEF0IDwgMCkgc3RhcnRBdCArPSBsZW47CgogICAgZm9yKGlk
        eD1zdGFydEF0O2lkeDxsZW47aWR4KyspIHsKICAgICAgaWYgKHRoaXMub2Jq
        ZWN0QXQoaWR4KSA9PT0gb2JqZWN0KSByZXR1cm4gaWR4IDsKICAgIH0KICAg
        IHJldHVybiAtMTsKICB9LAoKICAvKioKICAgIFJldHVybnMgdGhlIGluZGV4
        IG9mIHRoZSBnaXZlbiBvYmplY3QncyBsYXN0IG9jY3VycmVuY2UuCiAgICBJ
        ZiBubyBgc3RhcnRBdGAgYXJndW1lbnQgaXMgZ2l2ZW4sIHRoZSBzZWFyY2gg
        c3RhcnRzIGZyb20KICAgIHRoZSBsYXN0IHBvc2l0aW9uLiBJZiBpdCdzIG5l
        Z2F0aXZlLCB3aWxsIGNvdW50IGJhY2t3YXJkCiAgICBmcm9tIHRoZSBlbmQg
        b2YgdGhlIGFycmF5LiBSZXR1cm5zIC0xIGlmIG5vIG1hdGNoIGlzIGZvdW5k
        LgoKICAgIGBgYGphdmFzY3JpcHQKICAgIHZhciBhcnIgPSBbImEiLCAiYiIs
        ICJjIiwgImQiLCAiYSJdOwogICAgYXJyLmxhc3RJbmRleE9mKCJhIik7ICAg
        ICAgIC8vICA0CiAgICBhcnIubGFzdEluZGV4T2YoInoiKTsgICAgICAgLy8g
        LTEKICAgIGFyci5sYXN0SW5kZXhPZigiYSIsIDIpOyAgICAvLyAgMAogICAg
        YXJyLmxhc3RJbmRleE9mKCJhIiwgLTEpOyAgIC8vICA0CiAgICBhcnIubGFz
        dEluZGV4T2YoImIiLCAzKTsgICAgLy8gIDEKICAgIGFyci5sYXN0SW5kZXhP
        ZigiYSIsIDEwMCk7ICAvLyAgNAogICAgYGBgCgogICAgQG1ldGhvZCBsYXN0
        SW5kZXhPZgogICAgQHBhcmFtIHtPYmplY3R9IG9iamVjdCB0aGUgaXRlbSB0
        byBzZWFyY2ggZm9yCiAgICBAcGFyYW0ge051bWJlcn0gc3RhcnRBdCBvcHRp
        b25hbCBzdGFydGluZyBsb2NhdGlvbiB0byBzZWFyY2gsIGRlZmF1bHQgMAog
        ICAgQHJldHVybiB7TnVtYmVyfSBpbmRleCBvciAtMSBpZiBub3QgZm91bmQK
        ICAqLwogIGxhc3RJbmRleE9mOiBmdW5jdGlvbihvYmplY3QsIHN0YXJ0QXQp
        IHsKICAgIHZhciBpZHgsIGxlbiA9IGdldCh0aGlzLCAnbGVuZ3RoJyk7Cgog
        ICAgaWYgKHN0YXJ0QXQgPT09IHVuZGVmaW5lZCB8fCBzdGFydEF0ID49IGxl
        bikgc3RhcnRBdCA9IGxlbi0xOwogICAgaWYgKHN0YXJ0QXQgPCAwKSBzdGFy
        dEF0ICs9IGxlbjsKCiAgICBmb3IoaWR4PXN0YXJ0QXQ7aWR4Pj0wO2lkeC0t
        KSB7CiAgICAgIGlmICh0aGlzLm9iamVjdEF0KGlkeCkgPT09IG9iamVjdCkg
        cmV0dXJuIGlkeCA7CiAgICB9CiAgICByZXR1cm4gLTE7CiAgfSwKCiAgLy8g
        Li4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4u
        Li4uLi4uLi4uLi4uLgogIC8vIEFSUkFZIE9CU0VSVkVSUwogIC8vCgogIC8q
        KgogICAgQWRkcyBhbiBhcnJheSBvYnNlcnZlciB0byB0aGUgcmVjZWl2aW5n
        IGFycmF5LiBUaGUgYXJyYXkgb2JzZXJ2ZXIgb2JqZWN0CiAgICBub3JtYWxs
        eSBtdXN0IGltcGxlbWVudCB0d28gbWV0aG9kczoKCiAgICAqIGBhcnJheVdp
        bGxDaGFuZ2Uob2JzZXJ2ZWRPYmosIHN0YXJ0LCByZW1vdmVDb3VudCwgYWRk
        Q291bnQpYCAtIFRoaXMgbWV0aG9kIHdpbGwgYmUKICAgICAgY2FsbGVkIGp1
        c3QgYmVmb3JlIHRoZSBhcnJheSBpcyBtb2RpZmllZC4KICAgICogYGFycmF5
        RGlkQ2hhbmdlKG9ic2VydmVkT2JqLCBzdGFydCwgcmVtb3ZlQ291bnQsIGFk
        ZENvdW50KWAgLSBUaGlzIG1ldGhvZCB3aWxsIGJlCiAgICAgIGNhbGxlZCBq
        dXN0IGFmdGVyIHRoZSBhcnJheSBpcyBtb2RpZmllZC4KCiAgICBCb3RoIGNh
        bGxiYWNrcyB3aWxsIGJlIHBhc3NlZCB0aGUgb2JzZXJ2ZWQgb2JqZWN0LCBz
        dGFydGluZyBpbmRleCBvZiB0aGUKICAgIGNoYW5nZSBhcyB3ZWxsIGEgYSBj
        b3VudCBvZiB0aGUgaXRlbXMgdG8gYmUgcmVtb3ZlZCBhbmQgYWRkZWQuIFlv
        dSBjYW4gdXNlCiAgICB0aGVzZSBjYWxsYmFja3MgdG8gb3B0aW9uYWxseSBp
        bnNwZWN0IHRoZSBhcnJheSBkdXJpbmcgdGhlIGNoYW5nZSwgY2xlYXIKICAg
        IGNhY2hlcywgb3IgZG8gYW55IG90aGVyIGJvb2trZWVwaW5nIG5lY2Vzc2Fy
        eS4KCiAgICBJbiBhZGRpdGlvbiB0byBwYXNzaW5nIGEgdGFyZ2V0LCB5b3Ug
        Y2FuIGFsc28gaW5jbHVkZSBhbiBvcHRpb25zIGhhc2gKICAgIHdoaWNoIHlv
        dSBjYW4gdXNlIHRvIG92ZXJyaWRlIHRoZSBtZXRob2QgbmFtZXMgdGhhdCB3
        aWxsIGJlIGludm9rZWQgb24gdGhlCiAgICB0YXJnZXQuCgogICAgQG1ldGhv
        ZCBhZGRBcnJheU9ic2VydmVyCiAgICBAcGFyYW0ge09iamVjdH0gdGFyZ2V0
        IFRoZSBvYnNlcnZlciBvYmplY3QuCiAgICBAcGFyYW0ge0hhc2h9IG9wdHMg
        T3B0aW9uYWwgaGFzaCBvZiBjb25maWd1cmF0aW9uIG9wdGlvbnMgaW5jbHVk
        aW5nCiAgICAgIGB3aWxsQ2hhbmdlYCBhbmQgYGRpZENoYW5nZWAgb3B0aW9u
        LgogICAgQHJldHVybiB7RW1iZXIuQXJyYXl9IHJlY2VpdmVyCiAgKi8KICBh
        ZGRBcnJheU9ic2VydmVyOiBmdW5jdGlvbih0YXJnZXQsIG9wdHMpIHsKICAg
        IHZhciB3aWxsQ2hhbmdlID0gKG9wdHMgJiYgb3B0cy53aWxsQ2hhbmdlKSB8
        fCAnYXJyYXlXaWxsQ2hhbmdlJywKICAgICAgICBkaWRDaGFuZ2UgID0gKG9w
        dHMgJiYgb3B0cy5kaWRDaGFuZ2UpIHx8ICdhcnJheURpZENoYW5nZSc7Cgog
        ICAgdmFyIGhhc09ic2VydmVycyA9IGdldCh0aGlzLCAnaGFzQXJyYXlPYnNl
        cnZlcnMnKTsKICAgIGlmICghaGFzT2JzZXJ2ZXJzKSBFbWJlci5wcm9wZXJ0
        eVdpbGxDaGFuZ2UodGhpcywgJ2hhc0FycmF5T2JzZXJ2ZXJzJyk7CiAgICBF
        bWJlci5hZGRMaXN0ZW5lcih0aGlzLCAnQGFycmF5OmJlZm9yZScsIHRhcmdl
        dCwgd2lsbENoYW5nZSk7CiAgICBFbWJlci5hZGRMaXN0ZW5lcih0aGlzLCAn
        QGFycmF5OmNoYW5nZScsIHRhcmdldCwgZGlkQ2hhbmdlKTsKICAgIGlmICgh
        aGFzT2JzZXJ2ZXJzKSBFbWJlci5wcm9wZXJ0eURpZENoYW5nZSh0aGlzLCAn
        aGFzQXJyYXlPYnNlcnZlcnMnKTsKICAgIHJldHVybiB0aGlzOwogIH0sCgog
        IC8qKgogICAgUmVtb3ZlcyBhbiBhcnJheSBvYnNlcnZlciBmcm9tIHRoZSBv
        YmplY3QgaWYgdGhlIG9ic2VydmVyIGlzIGN1cnJlbnQKICAgIHJlZ2lzdGVy
        ZWQuIENhbGxpbmcgdGhpcyBtZXRob2QgbXVsdGlwbGUgdGltZXMgd2l0aCB0
        aGUgc2FtZSBvYmplY3Qgd2lsbAogICAgaGF2ZSBubyBlZmZlY3QuCgogICAg
        QG1ldGhvZCByZW1vdmVBcnJheU9ic2VydmVyCiAgICBAcGFyYW0ge09iamVj
        dH0gdGFyZ2V0IFRoZSBvYmplY3Qgb2JzZXJ2aW5nIHRoZSBhcnJheS4KICAg
        IEBwYXJhbSB7SGFzaH0gb3B0cyBPcHRpb25hbCBoYXNoIG9mIGNvbmZpZ3Vy
        YXRpb24gb3B0aW9ucyBpbmNsdWRpbmcKICAgICAgYHdpbGxDaGFuZ2VgIGFu
        ZCBgZGlkQ2hhbmdlYCBvcHRpb24uCiAgICBAcmV0dXJuIHtFbWJlci5BcnJh
        eX0gcmVjZWl2ZXIKICAqLwogIHJlbW92ZUFycmF5T2JzZXJ2ZXI6IGZ1bmN0
        aW9uKHRhcmdldCwgb3B0cykgewogICAgdmFyIHdpbGxDaGFuZ2UgPSAob3B0
        cyAmJiBvcHRzLndpbGxDaGFuZ2UpIHx8ICdhcnJheVdpbGxDaGFuZ2UnLAog
        ICAgICAgIGRpZENoYW5nZSAgPSAob3B0cyAmJiBvcHRzLmRpZENoYW5nZSkg
        fHwgJ2FycmF5RGlkQ2hhbmdlJzsKCiAgICB2YXIgaGFzT2JzZXJ2ZXJzID0g
        Z2V0KHRoaXMsICdoYXNBcnJheU9ic2VydmVycycpOwogICAgaWYgKGhhc09i
        c2VydmVycykgRW1iZXIucHJvcGVydHlXaWxsQ2hhbmdlKHRoaXMsICdoYXNB
        cnJheU9ic2VydmVycycpOwogICAgRW1iZXIucmVtb3ZlTGlzdGVuZXIodGhp
        cywgJ0BhcnJheTpiZWZvcmUnLCB0YXJnZXQsIHdpbGxDaGFuZ2UpOwogICAg
        RW1iZXIucmVtb3ZlTGlzdGVuZXIodGhpcywgJ0BhcnJheTpjaGFuZ2UnLCB0
        YXJnZXQsIGRpZENoYW5nZSk7CiAgICBpZiAoaGFzT2JzZXJ2ZXJzKSBFbWJl
        ci5wcm9wZXJ0eURpZENoYW5nZSh0aGlzLCAnaGFzQXJyYXlPYnNlcnZlcnMn
        KTsKICAgIHJldHVybiB0aGlzOwogIH0sCgogIC8qKgogICAgQmVjb21lcyB0
        cnVlIHdoZW5ldmVyIHRoZSBhcnJheSBjdXJyZW50bHkgaGFzIG9ic2VydmVy
        cyB3YXRjaGluZyBjaGFuZ2VzCiAgICBvbiB0aGUgYXJyYXkuCgogICAgQHBy
        b3BlcnR5IEJvb2xlYW4KICAqLwogIGhhc0FycmF5T2JzZXJ2ZXJzOiBFbWJl
        ci5jb21wdXRlZChmdW5jdGlvbigpIHsKICAgIHJldHVybiBFbWJlci5oYXNM
        aXN0ZW5lcnModGhpcywgJ0BhcnJheTpjaGFuZ2UnKSB8fCBFbWJlci5oYXNM
        aXN0ZW5lcnModGhpcywgJ0BhcnJheTpiZWZvcmUnKTsKICB9KSwKCiAgLyoq
        CiAgICBJZiB5b3UgYXJlIGltcGxlbWVudGluZyBhbiBvYmplY3QgdGhhdCBz
        dXBwb3J0cyBgRW1iZXIuQXJyYXlgLCBjYWxsIHRoaXMKICAgIG1ldGhvZCBq
        dXN0IGJlZm9yZSB0aGUgYXJyYXkgY29udGVudCBjaGFuZ2VzIHRvIG5vdGlm
        eSBhbnkgb2JzZXJ2ZXJzIGFuZAogICAgaW52YWxpZGF0ZSBhbnkgcmVsYXRl
        ZCBwcm9wZXJ0aWVzLiBQYXNzIHRoZSBzdGFydGluZyBpbmRleCBvZiB0aGUg
        Y2hhbmdlCiAgICBhcyB3ZWxsIGFzIGEgZGVsdGEgb2YgdGhlIGFtb3VudHMg
        dG8gY2hhbmdlLgoKICAgIEBtZXRob2QgYXJyYXlDb250ZW50V2lsbENoYW5n
        ZQogICAgQHBhcmFtIHtOdW1iZXJ9IHN0YXJ0SWR4IFRoZSBzdGFydGluZyBp
        bmRleCBpbiB0aGUgYXJyYXkgdGhhdCB3aWxsIGNoYW5nZS4KICAgIEBwYXJh
        bSB7TnVtYmVyfSByZW1vdmVBbXQgVGhlIG51bWJlciBvZiBpdGVtcyB0aGF0
        IHdpbGwgYmUgcmVtb3ZlZC4gSWYgeW91CiAgICAgIHBhc3MgYG51bGxgIGFz
        c3VtZXMgMAogICAgQHBhcmFtIHtOdW1iZXJ9IGFkZEFtdCBUaGUgbnVtYmVy
        IG9mIGl0ZW1zIHRoYXQgd2lsbCBiZSBhZGRlZC4gSWYgeW91CiAgICAgIHBh
        c3MgYG51bGxgIGFzc3VtZXMgMC4KICAgIEByZXR1cm4ge0VtYmVyLkFycmF5
        fSByZWNlaXZlcgogICovCiAgYXJyYXlDb250ZW50V2lsbENoYW5nZTogZnVu
        Y3Rpb24oc3RhcnRJZHgsIHJlbW92ZUFtdCwgYWRkQW10KSB7CgogICAgLy8g
        aWYgbm8gYXJncyBhcmUgcGFzc2VkIGFzc3VtZSBldmVyeXRoaW5nIGNoYW5n
        ZXMKICAgIGlmIChzdGFydElkeD09PXVuZGVmaW5lZCkgewogICAgICBzdGFy
        dElkeCA9IDA7CiAgICAgIHJlbW92ZUFtdCA9IGFkZEFtdCA9IC0xOwogICAg
        fSBlbHNlIHsKICAgICAgaWYgKHJlbW92ZUFtdCA9PT0gdW5kZWZpbmVkKSBy
        ZW1vdmVBbXQ9LTE7CiAgICAgIGlmIChhZGRBbXQgICAgPT09IHVuZGVmaW5l
        ZCkgYWRkQW10PS0xOwogICAgfQoKICAgIC8vIE1ha2Ugc3VyZSB0aGUgQGVh
        Y2ggcHJveHkgaXMgc2V0IHVwIGlmIGFueW9uZSBpcyBvYnNlcnZpbmcgQGVh
        Y2gKICAgIGlmIChFbWJlci5pc1dhdGNoaW5nKHRoaXMsICdAZWFjaCcpKSB7
        IGdldCh0aGlzLCAnQGVhY2gnKTsgfQoKICAgIEVtYmVyLnNlbmRFdmVudCh0
        aGlzLCAnQGFycmF5OmJlZm9yZScsIFt0aGlzLCBzdGFydElkeCwgcmVtb3Zl
        QW10LCBhZGRBbXRdKTsKCiAgICB2YXIgcmVtb3ZpbmcsIGxpbTsKICAgIGlm
        IChzdGFydElkeD49MCAmJiByZW1vdmVBbXQ+PTAgJiYgZ2V0KHRoaXMsICdo
        YXNFbnVtZXJhYmxlT2JzZXJ2ZXJzJykpIHsKICAgICAgcmVtb3ZpbmcgPSBb
        XTsKICAgICAgbGltID0gc3RhcnRJZHgrcmVtb3ZlQW10OwogICAgICBmb3Io
        dmFyIGlkeD1zdGFydElkeDtpZHg8bGltO2lkeCsrKSByZW1vdmluZy5wdXNo
        KHRoaXMub2JqZWN0QXQoaWR4KSk7CiAgICB9IGVsc2UgewogICAgICByZW1v
        dmluZyA9IHJlbW92ZUFtdDsKICAgIH0KCiAgICB0aGlzLmVudW1lcmFibGVD
        b250ZW50V2lsbENoYW5nZShyZW1vdmluZywgYWRkQW10KTsKCiAgICByZXR1
        cm4gdGhpczsKICB9LAoKICAvKioKICAgIElmIHlvdSBhcmUgaW1wbGVtZW50
        aW5nIGFuIG9iamVjdCB0aGF0IHN1cHBvcnRzIGBFbWJlci5BcnJheWAsIGNh
        bGwgdGhpcwogICAgbWV0aG9kIGp1c3QgYWZ0ZXIgdGhlIGFycmF5IGNvbnRl
        bnQgY2hhbmdlcyB0byBub3RpZnkgYW55IG9ic2VydmVycyBhbmQKICAgIGlu
        dmFsaWRhdGUgYW55IHJlbGF0ZWQgcHJvcGVydGllcy4gUGFzcyB0aGUgc3Rh
        cnRpbmcgaW5kZXggb2YgdGhlIGNoYW5nZQogICAgYXMgd2VsbCBhcyBhIGRl
        bHRhIG9mIHRoZSBhbW91bnRzIHRvIGNoYW5nZS4KCiAgICBAbWV0aG9kIGFy
        cmF5Q29udGVudERpZENoYW5nZQogICAgQHBhcmFtIHtOdW1iZXJ9IHN0YXJ0
        SWR4IFRoZSBzdGFydGluZyBpbmRleCBpbiB0aGUgYXJyYXkgdGhhdCBkaWQg
        Y2hhbmdlLgogICAgQHBhcmFtIHtOdW1iZXJ9IHJlbW92ZUFtdCBUaGUgbnVt
        YmVyIG9mIGl0ZW1zIHRoYXQgd2VyZSByZW1vdmVkLiBJZiB5b3UKICAgICAg
        cGFzcyBgbnVsbGAgYXNzdW1lcyAwCiAgICBAcGFyYW0ge051bWJlcn0gYWRk
        QW10IFRoZSBudW1iZXIgb2YgaXRlbXMgdGhhdCB3ZXJlIGFkZGVkLiBJZiB5
        b3UKICAgICAgcGFzcyBgbnVsbGAgYXNzdW1lcyAwLgogICAgQHJldHVybiB7
        RW1iZXIuQXJyYXl9IHJlY2VpdmVyCiAgKi8KICBhcnJheUNvbnRlbnREaWRD
        aGFuZ2U6IGZ1bmN0aW9uKHN0YXJ0SWR4LCByZW1vdmVBbXQsIGFkZEFtdCkg
        ewoKICAgIC8vIGlmIG5vIGFyZ3MgYXJlIHBhc3NlZCBhc3N1bWUgZXZlcnl0
        aGluZyBjaGFuZ2VzCiAgICBpZiAoc3RhcnRJZHg9PT11bmRlZmluZWQpIHsK
        ICAgICAgc3RhcnRJZHggPSAwOwogICAgICByZW1vdmVBbXQgPSBhZGRBbXQg
        PSAtMTsKICAgIH0gZWxzZSB7CiAgICAgIGlmIChyZW1vdmVBbXQgPT09IHVu
        ZGVmaW5lZCkgcmVtb3ZlQW10PS0xOwogICAgICBpZiAoYWRkQW10ICAgID09
        PSB1bmRlZmluZWQpIGFkZEFtdD0tMTsKICAgIH0KCiAgICB2YXIgYWRkaW5n
        LCBsaW07CiAgICBpZiAoc3RhcnRJZHg+PTAgJiYgYWRkQW10Pj0wICYmIGdl
        dCh0aGlzLCAnaGFzRW51bWVyYWJsZU9ic2VydmVycycpKSB7CiAgICAgIGFk
        ZGluZyA9IFtdOwogICAgICBsaW0gPSBzdGFydElkeCthZGRBbXQ7CiAgICAg
        IGZvcih2YXIgaWR4PXN0YXJ0SWR4O2lkeDxsaW07aWR4KyspIGFkZGluZy5w
        dXNoKHRoaXMub2JqZWN0QXQoaWR4KSk7CiAgICB9IGVsc2UgewogICAgICBh
        ZGRpbmcgPSBhZGRBbXQ7CiAgICB9CgogICAgdGhpcy5lbnVtZXJhYmxlQ29u
        dGVudERpZENoYW5nZShyZW1vdmVBbXQsIGFkZGluZyk7CiAgICBFbWJlci5z
        ZW5kRXZlbnQodGhpcywgJ0BhcnJheTpjaGFuZ2UnLCBbdGhpcywgc3RhcnRJ
        ZHgsIHJlbW92ZUFtdCwgYWRkQW10XSk7CgogICAgdmFyIGxlbmd0aCAgICAg
        ID0gZ2V0KHRoaXMsICdsZW5ndGgnKSwKICAgICAgICBjYWNoZWRGaXJzdCA9
        IGNhY2hlRm9yKHRoaXMsICdmaXJzdE9iamVjdCcpLAogICAgICAgIGNhY2hl
        ZExhc3QgID0gY2FjaGVGb3IodGhpcywgJ2xhc3RPYmplY3QnKTsKICAgIGlm
        ICh0aGlzLm9iamVjdEF0KDApICE9PSBjYWNoZWRGaXJzdCkgewogICAgICBF
        bWJlci5wcm9wZXJ0eVdpbGxDaGFuZ2UodGhpcywgJ2ZpcnN0T2JqZWN0Jyk7
        CiAgICAgIEVtYmVyLnByb3BlcnR5RGlkQ2hhbmdlKHRoaXMsICdmaXJzdE9i
        amVjdCcpOwogICAgfQogICAgaWYgKHRoaXMub2JqZWN0QXQobGVuZ3RoLTEp
        ICE9PSBjYWNoZWRMYXN0KSB7CiAgICAgIEVtYmVyLnByb3BlcnR5V2lsbENo
        YW5nZSh0aGlzLCAnbGFzdE9iamVjdCcpOwogICAgICBFbWJlci5wcm9wZXJ0
        eURpZENoYW5nZSh0aGlzLCAnbGFzdE9iamVjdCcpOwogICAgfQoKICAgIHJl
        dHVybiB0aGlzOwogIH0sCgogIC8vIC4uLi4uLi4uLi4uLi4uLi4uLi4uLi4u
        Li4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4KICAvLyBFTlVN
        RVJBVEVEIFBST1BFUlRJRVMKICAvLwoKICAvKioKICAgIFJldHVybnMgYSBz
        cGVjaWFsIG9iamVjdCB0aGF0IGNhbiBiZSB1c2VkIHRvIG9ic2VydmUgaW5k
        aXZpZHVhbCBwcm9wZXJ0aWVzCiAgICBvbiB0aGUgYXJyYXkuIEp1c3QgZ2V0
        IGFuIGVxdWl2YWxlbnQgcHJvcGVydHkgb24gdGhpcyBvYmplY3QgYW5kIGl0
        IHdpbGwKICAgIHJldHVybiBhbiBlbnVtZXJhYmxlIHRoYXQgbWFwcyBhdXRv
        bWF0aWNhbGx5IHRvIHRoZSBuYW1lZCBrZXkgb24gdGhlCiAgICBtZW1iZXIg
        b2JqZWN0cy4KCiAgICBJZiB5b3UgbWVyZWx5IHdhbnQgdG8gd2F0Y2ggZm9y
        IGFueSBpdGVtcyBiZWluZyBhZGRlZCBvciByZW1vdmVkIHRvIHRoZSBhcnJh
        eSwKICAgIHVzZSB0aGUgYFtdYCBwcm9wZXJ0eSBpbnN0ZWFkIG9mIGBAZWFj
        aGAuCgogICAgQHByb3BlcnR5IEBlYWNoCiAgKi8KICAnQGVhY2gnOiBFbWJl
        ci5jb21wdXRlZChmdW5jdGlvbigpIHsKICAgIGlmICghdGhpcy5fX2VhY2gp
        IHRoaXMuX19lYWNoID0gbmV3IEVtYmVyLkVhY2hQcm94eSh0aGlzKTsKICAg
        IHJldHVybiB0aGlzLl9fZWFjaDsKICB9KQoKfSkgOwoKfSkoKTsKCgoKKGZ1
        bmN0aW9uKCkgewp2YXIgZ2V0ID0gRW1iZXIuZ2V0LAogICAgc2V0ID0gRW1i
        ZXIuc2V0LAogICAgZ3VpZEZvciA9IEVtYmVyLmd1aWRGb3IsCiAgICBtZXRh
        Rm9yID0gRW1iZXIubWV0YSwKICAgIHByb3BlcnR5V2lsbENoYW5nZSA9IEVt
        YmVyLnByb3BlcnR5V2lsbENoYW5nZSwKICAgIHByb3BlcnR5RGlkQ2hhbmdl
        ID0gRW1iZXIucHJvcGVydHlEaWRDaGFuZ2UsCiAgICBhZGRCZWZvcmVPYnNl
        cnZlciA9IEVtYmVyLmFkZEJlZm9yZU9ic2VydmVyLAogICAgcmVtb3ZlQmVm
        b3JlT2JzZXJ2ZXIgPSBFbWJlci5yZW1vdmVCZWZvcmVPYnNlcnZlciwKICAg
        IGFkZE9ic2VydmVyID0gRW1iZXIuYWRkT2JzZXJ2ZXIsCiAgICByZW1vdmVP
        YnNlcnZlciA9IEVtYmVyLnJlbW92ZU9ic2VydmVyLAogICAgQ29tcHV0ZWRQ
        cm9wZXJ0eSA9IEVtYmVyLkNvbXB1dGVkUHJvcGVydHksCiAgICBhX3NsaWNl
        ID0gW10uc2xpY2UsCiAgICBvX2NyZWF0ZSA9IEVtYmVyLmNyZWF0ZSwKICAg
        IGZvckVhY2ggPSBFbWJlci5FbnVtZXJhYmxlVXRpbHMuZm9yRWFjaCwKICAg
        IC8vIEhlcmUgd2UgZXhwbGljaXRseSBkb24ndCBhbGxvdyBgQGVhY2guZm9v
        YDsgaXQgd291bGQgcmVxdWlyZSBzb21lIHNwZWNpYWwKICAgIC8vIHRlc3Rp
        bmcsIGJ1dCB0aGVyZSdzIG5vIHBhcnRpY3VsYXIgcmVhc29uIHdoeSBpdCBz
        aG91bGQgYmUgZGlzYWxsb3dlZC4KICAgIGVhY2hQcm9wZXJ0eVBhdHRlcm4g
        PSAvXiguKilcLkBlYWNoXC4oLiopLywKICAgIGRvdWJsZUVhY2hQcm9wZXJ0
        eVBhdHRlcm4gPSAvKC4qXC5AZWFjaCl7Mix9LzsKCi8qCiAgVHJhY2tzIGNo
        YW5nZXMgdG8gZGVwZW5kZW50IGFycmF5cywgYXMgd2VsbCBhcyB0byBwcm9w
        ZXJ0aWVzIG9mIGl0ZW1zIGluCiAgZGVwZW5kZW50IGFycmF5cy4KCiAgQGNs
        YXNzIERlcGVuZGVudEFycmF5c09ic2VydmVyCiovCmZ1bmN0aW9uIERlcGVu
        ZGVudEFycmF5c09ic2VydmVyKGNhbGxiYWNrcywgY3AsIGluc3RhbmNlTWV0
        YSwgY29udGV4dCwgcHJvcGVydHlOYW1lLCBzdWdhck1ldGEpIHsKICAvLyB1
        c2VyIHNwZWNpZmllZCBjYWxsYmFja3MgZm9yIGBhZGRlZEl0ZW1gIGFuZCBg
        cmVtb3ZlZEl0ZW1gCiAgdGhpcy5jYWxsYmFja3MgPSBjYWxsYmFja3M7Cgog
        IC8vIHRoZSBjb21wdXRlZCBwcm9wZXJ0eTogcmVtZW1iZXIgdGhlc2UgYXJl
        IHNoYXJlZCBhY3Jvc3MgaW5zdGFuY2VzCiAgdGhpcy5jcCA9IGNwOwoKICAv
        LyB0aGUgUmVkdWNlQ29tcHV0ZWRQcm9wZXJ0eUluc3RhbmNlTWV0YSB0aGlz
        IERlcGVuZGVudEFycmF5c09ic2VydmVyIGlzCiAgLy8gYXNzb2NpYXRlZCB3
        aXRoCiAgdGhpcy5pbnN0YW5jZU1ldGEgPSBpbnN0YW5jZU1ldGE7CgogIC8v
        IEEgbWFwIG9mIGFycmF5IGd1aWRzIHRvIGRlcGVuZGVudEtleXMsIGZvciB0
        aGUgZ2l2ZW4gY29udGV4dC4gIFdlIHRyYWNrCiAgLy8gdGhpcyBiZWNhdXNl
        IHdlIHdhbnQgdG8gc2V0IHVwIHRoZSBjb21wdXRlZCBwcm9wZXJ0eSBwb3Rl
        bnRpYWxseSBiZWZvcmUgdGhlCiAgLy8gZGVwZW5kZW50IGFycmF5IGV2ZW4g
        ZXhpc3RzLCBidXQgd2hlbiB0aGUgYXJyYXkgb2JzZXJ2ZXIgZmlyZXMsIHdl
        IGxhY2sKICAvLyBlbm91Z2ggY29udGV4dCB0byBrbm93IHdoYXQgdG8gdXBk
        YXRlOiB3ZSBjYW4gcmVjb3ZlciB0aGF0IGNvbnRleHQgYnkKICAvLyBnZXR0
        aW5nIHRoZSBkZXBlbmRlbnRLZXkuCiAgdGhpcy5kZXBlbmRlbnRLZXlzQnlH
        dWlkID0ge307CgogIC8vIGEgbWFwIG9mIGRlcGVuZGVudCBhcnJheSBndWlk
        cyAtPiBFbWJlci5UcmFja2VkQXJyYXkgaW5zdGFuY2VzLiAgV2UgdXNlCiAg
        Ly8gdGhpcyB0byBsYXppbHkgcmVjb21wdXRlIGluZGV4ZXMgZm9yIGl0ZW0g
        cHJvcGVydHkgb2JzZXJ2ZXJzLgogIHRoaXMudHJhY2tlZEFycmF5c0J5R3Vp
        ZCA9IHt9OwoKICAvLyBUaGlzIGlzIHVzZWQgdG8gY29hbGVzY2UgaXRlbSBj
        aGFuZ2VzIGZyb20gcHJvcGVydHkgb2JzZXJ2ZXJzLgogIHRoaXMuY2hhbmdl
        ZEl0ZW1zID0ge307Cn0KCmZ1bmN0aW9uIEl0ZW1Qcm9wZXJ0eU9ic2VydmVy
        Q29udGV4dCAoZGVwZW5kZW50QXJyYXksIGluZGV4LCB0cmFja2VkQXJyYXkp
        IHsKICBFbWJlci5hc3NlcnQoIkludGVybmFsIGVycm9yOiB0cmFja2VkQXJy
        YXkgaXMgbnVsbCBvciB1bmRlZmluZWQiLCB0cmFja2VkQXJyYXkpOwoKICB0
        aGlzLmRlcGVuZGVudEFycmF5ID0gZGVwZW5kZW50QXJyYXk7CiAgdGhpcy5p
        bmRleCA9IGluZGV4OwogIHRoaXMuaXRlbSA9IGRlcGVuZGVudEFycmF5Lm9i
        amVjdEF0KGluZGV4KTsKICB0aGlzLnRyYWNrZWRBcnJheSA9IHRyYWNrZWRB
        cnJheTsKICB0aGlzLmJlZm9yZU9ic2VydmVyID0gbnVsbDsKICB0aGlzLm9i
        c2VydmVyID0gbnVsbDsKCiAgdGhpcy5kZXN0cm95ZWQgPSBmYWxzZTsKfQoK
        RGVwZW5kZW50QXJyYXlzT2JzZXJ2ZXIucHJvdG90eXBlID0gewogIHNldFZh
        bHVlOiBmdW5jdGlvbiAobmV3VmFsdWUpIHsKICAgIHRoaXMuaW5zdGFuY2VN
        ZXRhLnNldFZhbHVlKG5ld1ZhbHVlLCB0cnVlKTsKICB9LAogIGdldFZhbHVl
        OiBmdW5jdGlvbiAoKSB7CiAgICByZXR1cm4gdGhpcy5pbnN0YW5jZU1ldGEu
        Z2V0VmFsdWUoKTsKICB9LAoKICBzZXR1cE9ic2VydmVyczogZnVuY3Rpb24g
        KGRlcGVuZGVudEFycmF5LCBkZXBlbmRlbnRLZXkpIHsKICAgIEVtYmVyLmFz
        c2VydCgiZGVwZW5kZW50IGFycmF5IG11c3QgYmUgYW4gYEVtYmVyLkFycmF5
        YCIsIEVtYmVyLkFycmF5LmRldGVjdChkZXBlbmRlbnRBcnJheSkpOwoKICAg
        IHRoaXMuZGVwZW5kZW50S2V5c0J5R3VpZFtndWlkRm9yKGRlcGVuZGVudEFy
        cmF5KV0gPSBkZXBlbmRlbnRLZXk7CgogICAgZGVwZW5kZW50QXJyYXkuYWRk
        QXJyYXlPYnNlcnZlcih0aGlzLCB7CiAgICAgIHdpbGxDaGFuZ2U6ICdkZXBl
        bmRlbnRBcnJheVdpbGxDaGFuZ2UnLAogICAgICBkaWRDaGFuZ2U6ICdkZXBl
        bmRlbnRBcnJheURpZENoYW5nZScKICAgIH0pOwoKICAgIGlmICh0aGlzLmNw
        Ll9pdGVtUHJvcGVydHlLZXlzW2RlcGVuZGVudEtleV0pIHsKICAgICAgdGhp
        cy5zZXR1cFByb3BlcnR5T2JzZXJ2ZXJzKGRlcGVuZGVudEtleSwgdGhpcy5j
        cC5faXRlbVByb3BlcnR5S2V5c1tkZXBlbmRlbnRLZXldKTsKICAgIH0KICB9
        LAoKICB0ZWFyZG93bk9ic2VydmVyczogZnVuY3Rpb24gKGRlcGVuZGVudEFy
        cmF5LCBkZXBlbmRlbnRLZXkpIHsKICAgIHZhciBpdGVtUHJvcGVydHlLZXlz
        ID0gdGhpcy5jcC5faXRlbVByb3BlcnR5S2V5c1tkZXBlbmRlbnRLZXldIHx8
        IFtdOwoKICAgIGRlbGV0ZSB0aGlzLmRlcGVuZGVudEtleXNCeUd1aWRbZ3Vp
        ZEZvcihkZXBlbmRlbnRBcnJheSldOwoKICAgIHRoaXMudGVhcmRvd25Qcm9w
        ZXJ0eU9ic2VydmVycyhkZXBlbmRlbnRLZXksIGl0ZW1Qcm9wZXJ0eUtleXMp
        OwoKICAgIGRlcGVuZGVudEFycmF5LnJlbW92ZUFycmF5T2JzZXJ2ZXIodGhp
        cywgewogICAgICB3aWxsQ2hhbmdlOiAnZGVwZW5kZW50QXJyYXlXaWxsQ2hh
        bmdlJywKICAgICAgZGlkQ2hhbmdlOiAnZGVwZW5kZW50QXJyYXlEaWRDaGFu
        Z2UnCiAgICB9KTsKICB9LAoKICBzZXR1cFByb3BlcnR5T2JzZXJ2ZXJzOiBm
        dW5jdGlvbiAoZGVwZW5kZW50S2V5LCBpdGVtUHJvcGVydHlLZXlzKSB7CiAg
        ICB2YXIgZGVwZW5kZW50QXJyYXkgPSBnZXQodGhpcy5pbnN0YW5jZU1ldGEu
        Y29udGV4dCwgZGVwZW5kZW50S2V5KSwKICAgICAgICBsZW5ndGggPSBnZXQo
        ZGVwZW5kZW50QXJyYXksICdsZW5ndGgnKSwKICAgICAgICBvYnNlcnZlckNv
        bnRleHRzID0gbmV3IEFycmF5KGxlbmd0aCk7CgogICAgdGhpcy5yZXNldFRy
        YW5zZm9ybWF0aW9ucyhkZXBlbmRlbnRLZXksIG9ic2VydmVyQ29udGV4dHMp
        OwoKICAgIGZvckVhY2goZGVwZW5kZW50QXJyYXksIGZ1bmN0aW9uIChpdGVt
        LCBpbmRleCkgewogICAgICB2YXIgb2JzZXJ2ZXJDb250ZXh0ID0gdGhpcy5j
        cmVhdGVQcm9wZXJ0eU9ic2VydmVyQ29udGV4dChkZXBlbmRlbnRBcnJheSwg
        aW5kZXgsIHRoaXMudHJhY2tlZEFycmF5c0J5R3VpZFtkZXBlbmRlbnRLZXld
        KTsKICAgICAgb2JzZXJ2ZXJDb250ZXh0c1tpbmRleF0gPSBvYnNlcnZlckNv
        bnRleHQ7CgogICAgICBmb3JFYWNoKGl0ZW1Qcm9wZXJ0eUtleXMsIGZ1bmN0
        aW9uIChwcm9wZXJ0eUtleSkgewogICAgICAgIGFkZEJlZm9yZU9ic2VydmVy
        KGl0ZW0sIHByb3BlcnR5S2V5LCB0aGlzLCBvYnNlcnZlckNvbnRleHQuYmVm
        b3JlT2JzZXJ2ZXIpOwogICAgICAgIGFkZE9ic2VydmVyKGl0ZW0sIHByb3Bl
        cnR5S2V5LCB0aGlzLCBvYnNlcnZlckNvbnRleHQub2JzZXJ2ZXIpOwogICAg
        ICB9LCB0aGlzKTsKICAgIH0sIHRoaXMpOwogIH0sCgogIHRlYXJkb3duUHJv
        cGVydHlPYnNlcnZlcnM6IGZ1bmN0aW9uIChkZXBlbmRlbnRLZXksIGl0ZW1Q
        cm9wZXJ0eUtleXMpIHsKICAgIHZhciBkZXBlbmRlbnRBcnJheU9ic2VydmVy
        ID0gdGhpcywKICAgICAgICB0cmFja2VkQXJyYXkgPSB0aGlzLnRyYWNrZWRB
        cnJheXNCeUd1aWRbZGVwZW5kZW50S2V5XSwKICAgICAgICBiZWZvcmVPYnNl
        cnZlciwKICAgICAgICBvYnNlcnZlciwKICAgICAgICBpdGVtOwoKICAgIGlm
        ICghdHJhY2tlZEFycmF5KSB7IHJldHVybjsgfQoKICAgIHRyYWNrZWRBcnJh
        eS5hcHBseShmdW5jdGlvbiAob2JzZXJ2ZXJDb250ZXh0cywgb2Zmc2V0LCBv
        cGVyYXRpb24pIHsKICAgICAgaWYgKG9wZXJhdGlvbiA9PT0gRW1iZXIuVHJh
        Y2tlZEFycmF5LkRFTEVURSkgeyByZXR1cm47IH0KCiAgICAgIGZvckVhY2go
        b2JzZXJ2ZXJDb250ZXh0cywgZnVuY3Rpb24gKG9ic2VydmVyQ29udGV4dCkg
        ewogICAgICAgIG9ic2VydmVyQ29udGV4dC5kZXN0cm95ZWQgPSB0cnVlOwog
        ICAgICAgIGJlZm9yZU9ic2VydmVyID0gb2JzZXJ2ZXJDb250ZXh0LmJlZm9y
        ZU9ic2VydmVyOwogICAgICAgIG9ic2VydmVyID0gb2JzZXJ2ZXJDb250ZXh0
        Lm9ic2VydmVyOwogICAgICAgIGl0ZW0gPSBvYnNlcnZlckNvbnRleHQuaXRl
        bTsKCiAgICAgICAgZm9yRWFjaChpdGVtUHJvcGVydHlLZXlzLCBmdW5jdGlv
        biAocHJvcGVydHlLZXkpIHsKICAgICAgICAgIHJlbW92ZUJlZm9yZU9ic2Vy
        dmVyKGl0ZW0sIHByb3BlcnR5S2V5LCBkZXBlbmRlbnRBcnJheU9ic2VydmVy
        LCBiZWZvcmVPYnNlcnZlcik7CiAgICAgICAgICByZW1vdmVPYnNlcnZlcihp
        dGVtLCBwcm9wZXJ0eUtleSwgZGVwZW5kZW50QXJyYXlPYnNlcnZlciwgb2Jz
        ZXJ2ZXIpOwogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0pOwogIH0sCgog
        IGNyZWF0ZVByb3BlcnR5T2JzZXJ2ZXJDb250ZXh0OiBmdW5jdGlvbiAoZGVw
        ZW5kZW50QXJyYXksIGluZGV4LCB0cmFja2VkQXJyYXkpIHsKICAgIHZhciBv
        YnNlcnZlckNvbnRleHQgPSBuZXcgSXRlbVByb3BlcnR5T2JzZXJ2ZXJDb250
        ZXh0KGRlcGVuZGVudEFycmF5LCBpbmRleCwgdHJhY2tlZEFycmF5KTsKCiAg
        ICB0aGlzLmNyZWF0ZVByb3BlcnR5T2JzZXJ2ZXIob2JzZXJ2ZXJDb250ZXh0
        KTsKCiAgICByZXR1cm4gb2JzZXJ2ZXJDb250ZXh0OwogIH0sCgogIGNyZWF0
        ZVByb3BlcnR5T2JzZXJ2ZXI6IGZ1bmN0aW9uIChvYnNlcnZlckNvbnRleHQp
        IHsKICAgIHZhciBkZXBlbmRlbnRBcnJheU9ic2VydmVyID0gdGhpczsKCiAg
        ICBvYnNlcnZlckNvbnRleHQuYmVmb3JlT2JzZXJ2ZXIgPSBmdW5jdGlvbiAo
        b2JqLCBrZXlOYW1lKSB7CiAgICAgIHJldHVybiBkZXBlbmRlbnRBcnJheU9i
        c2VydmVyLml0ZW1Qcm9wZXJ0eVdpbGxDaGFuZ2Uob2JqLCBrZXlOYW1lLCBv
        YnNlcnZlckNvbnRleHQuZGVwZW5kZW50QXJyYXksIG9ic2VydmVyQ29udGV4
        dCk7CiAgICB9OwogICAgb2JzZXJ2ZXJDb250ZXh0Lm9ic2VydmVyID0gZnVu
        Y3Rpb24gKG9iaiwga2V5TmFtZSkgewogICAgICByZXR1cm4gZGVwZW5kZW50
        QXJyYXlPYnNlcnZlci5pdGVtUHJvcGVydHlEaWRDaGFuZ2Uob2JqLCBrZXlO
        YW1lLCBvYnNlcnZlckNvbnRleHQuZGVwZW5kZW50QXJyYXksIG9ic2VydmVy
        Q29udGV4dCk7CiAgICB9OwogIH0sCgogIHJlc2V0VHJhbnNmb3JtYXRpb25z
        OiBmdW5jdGlvbiAoZGVwZW5kZW50S2V5LCBvYnNlcnZlckNvbnRleHRzKSB7
        CiAgICB0aGlzLnRyYWNrZWRBcnJheXNCeUd1aWRbZGVwZW5kZW50S2V5XSA9
        IG5ldyBFbWJlci5UcmFja2VkQXJyYXkob2JzZXJ2ZXJDb250ZXh0cyk7CiAg
        fSwKCiAgdHJhY2tBZGQ6IGZ1bmN0aW9uIChkZXBlbmRlbnRLZXksIGluZGV4
        LCBuZXdJdGVtcykgewogICAgdmFyIHRyYWNrZWRBcnJheSA9IHRoaXMudHJh
        Y2tlZEFycmF5c0J5R3VpZFtkZXBlbmRlbnRLZXldOwogICAgaWYgKHRyYWNr
        ZWRBcnJheSkgewogICAgICB0cmFja2VkQXJyYXkuYWRkSXRlbXMoaW5kZXgs
        IG5ld0l0ZW1zKTsKICAgIH0KICB9LAoKICB0cmFja1JlbW92ZTogZnVuY3Rp
        b24gKGRlcGVuZGVudEtleSwgaW5kZXgsIHJlbW92ZWRDb3VudCkgewogICAg
        dmFyIHRyYWNrZWRBcnJheSA9IHRoaXMudHJhY2tlZEFycmF5c0J5R3VpZFtk
        ZXBlbmRlbnRLZXldOwoKICAgIGlmICh0cmFja2VkQXJyYXkpIHsKICAgICAg
        cmV0dXJuIHRyYWNrZWRBcnJheS5yZW1vdmVJdGVtcyhpbmRleCwgcmVtb3Zl
        ZENvdW50KTsKICAgIH0KCiAgICByZXR1cm4gW107CiAgfSwKCiAgdXBkYXRl
        SW5kZXhlczogZnVuY3Rpb24gKHRyYWNrZWRBcnJheSwgYXJyYXkpIHsKICAg
        IHZhciBsZW5ndGggPSBnZXQoYXJyYXksICdsZW5ndGgnKTsKICAgIC8vIE9Q
        VElNSVpFOiB3ZSBjb3VsZCBzdG9wIHVwZGF0aW5nIG9uY2Ugd2UgaGl0IHRo
        ZSBvYmplY3Qgd2hvc2Ugb2JzZXJ2ZXIKICAgIC8vIGZpcmVkOyBpZSBwYXJ0
        aWFsbHkgYXBwbHkgdGhlIHRyYW5zZm9ybWF0aW9ucwogICAgdHJhY2tlZEFy
        cmF5LmFwcGx5KGZ1bmN0aW9uIChvYnNlcnZlckNvbnRleHRzLCBvZmZzZXQs
        IG9wZXJhdGlvbikgewogICAgICAvLyB3ZSBkb24ndCBldmVuIGhhdmUgb2Jz
        ZXJ2ZXIgY29udGV4dHMgZm9yIHJlbW92ZWQgaXRlbXMsIGV2ZW4gaWYgd2Ug
        ZGlkLAogICAgICAvLyB0aGV5IG5vIGxvbmdlciBoYXZlIGFueSBpbmRleCBp
        biB0aGUgYXJyYXkKICAgICAgaWYgKG9wZXJhdGlvbiA9PT0gRW1iZXIuVHJh
        Y2tlZEFycmF5LkRFTEVURSkgeyByZXR1cm47IH0KICAgICAgaWYgKG9wZXJh
        dGlvbiA9PT0gRW1iZXIuVHJhY2tlZEFycmF5LlJFVEFJTiAmJiBvYnNlcnZl
        ckNvbnRleHRzLmxlbmd0aCA9PT0gbGVuZ3RoICYmIG9mZnNldCA9PT0gMCkg
        ewogICAgICAgIC8vIElmIHdlIHVwZGF0ZSBtYW55IGl0ZW1zIHdlIGRvbid0
        IHdhbnQgdG8gd2FsayB0aGUgYXJyYXkgZWFjaCB0aW1lOiB3ZQogICAgICAg
        IC8vIG9ubHkgbmVlZCB0byB1cGRhdGUgdGhlIGluZGV4ZXMgYXQgbW9zdCBv
        bmNlIHBlciBydW4gbG9vcC4KICAgICAgICByZXR1cm47CiAgICAgIH0KCiAg
        ICAgIGZvckVhY2gob2JzZXJ2ZXJDb250ZXh0cywgZnVuY3Rpb24gKGNvbnRl
        eHQsIGluZGV4KSB7CiAgICAgICAgY29udGV4dC5pbmRleCA9IGluZGV4ICsg
        b2Zmc2V0OwogICAgICB9KTsKICAgIH0pOwogIH0sCgogIGRlcGVuZGVudEFy
        cmF5V2lsbENoYW5nZTogZnVuY3Rpb24gKGRlcGVuZGVudEFycmF5LCBpbmRl
        eCwgcmVtb3ZlZENvdW50LCBhZGRlZENvdW50KSB7CiAgICB2YXIgcmVtb3Zl
        ZEl0ZW0gPSB0aGlzLmNhbGxiYWNrcy5yZW1vdmVkSXRlbSwKICAgICAgICBj
        aGFuZ2VNZXRhLAogICAgICAgIGd1aWQgPSBndWlkRm9yKGRlcGVuZGVudEFy
        cmF5KSwKICAgICAgICBkZXBlbmRlbnRLZXkgPSB0aGlzLmRlcGVuZGVudEtl
        eXNCeUd1aWRbZ3VpZF0sCiAgICAgICAgaXRlbVByb3BlcnR5S2V5cyA9IHRo
        aXMuY3AuX2l0ZW1Qcm9wZXJ0eUtleXNbZGVwZW5kZW50S2V5XSB8fCBbXSwK
        ICAgICAgICBpdGVtLAogICAgICAgIGl0ZW1JbmRleCwKICAgICAgICBzbGlj
        ZUluZGV4LAogICAgICAgIG9ic2VydmVyQ29udGV4dHM7CgogICAgb2JzZXJ2
        ZXJDb250ZXh0cyA9IHRoaXMudHJhY2tSZW1vdmUoZGVwZW5kZW50S2V5LCBp
        bmRleCwgcmVtb3ZlZENvdW50KTsKCiAgICBmdW5jdGlvbiByZW1vdmVPYnNl
        cnZlcnMocHJvcGVydHlLZXkpIHsKICAgICAgb2JzZXJ2ZXJDb250ZXh0c1tz
        bGljZUluZGV4XS5kZXN0cm95ZWQgPSB0cnVlOwogICAgICByZW1vdmVCZWZv
        cmVPYnNlcnZlcihpdGVtLCBwcm9wZXJ0eUtleSwgdGhpcywgb2JzZXJ2ZXJD
        b250ZXh0c1tzbGljZUluZGV4XS5iZWZvcmVPYnNlcnZlcik7CiAgICAgIHJl
        bW92ZU9ic2VydmVyKGl0ZW0sIHByb3BlcnR5S2V5LCB0aGlzLCBvYnNlcnZl
        ckNvbnRleHRzW3NsaWNlSW5kZXhdLm9ic2VydmVyKTsKICAgIH0KCiAgICBm
        b3IgKHNsaWNlSW5kZXggPSByZW1vdmVkQ291bnQgLSAxOyBzbGljZUluZGV4
        ID49IDA7IC0tc2xpY2VJbmRleCkgewogICAgICBpdGVtSW5kZXggPSBpbmRl
        eCArIHNsaWNlSW5kZXg7CiAgICAgIGl0ZW0gPSBkZXBlbmRlbnRBcnJheS5v
        YmplY3RBdChpdGVtSW5kZXgpOwoKICAgICAgZm9yRWFjaChpdGVtUHJvcGVy
        dHlLZXlzLCByZW1vdmVPYnNlcnZlcnMsIHRoaXMpOwoKICAgICAgY2hhbmdl
        TWV0YSA9IGNyZWF0ZUNoYW5nZU1ldGEoZGVwZW5kZW50QXJyYXksIGl0ZW0s
        IGl0ZW1JbmRleCwgdGhpcy5pbnN0YW5jZU1ldGEucHJvcGVydHlOYW1lLCB0
        aGlzLmNwKTsKICAgICAgdGhpcy5zZXRWYWx1ZSggcmVtb3ZlZEl0ZW0uY2Fs
        bCgKICAgICAgICB0aGlzLmluc3RhbmNlTWV0YS5jb250ZXh0LCB0aGlzLmdl
        dFZhbHVlKCksIGl0ZW0sIGNoYW5nZU1ldGEsIHRoaXMuaW5zdGFuY2VNZXRh
        LnN1Z2FyTWV0YSkpOwogICAgfQogIH0sCgogIGRlcGVuZGVudEFycmF5RGlk
        Q2hhbmdlOiBmdW5jdGlvbiAoZGVwZW5kZW50QXJyYXksIGluZGV4LCByZW1v
        dmVkQ291bnQsIGFkZGVkQ291bnQpIHsKICAgIHZhciBhZGRlZEl0ZW0gPSB0
        aGlzLmNhbGxiYWNrcy5hZGRlZEl0ZW0sCiAgICAgICAgZ3VpZCA9IGd1aWRG
        b3IoZGVwZW5kZW50QXJyYXkpLAogICAgICAgIGRlcGVuZGVudEtleSA9IHRo
        aXMuZGVwZW5kZW50S2V5c0J5R3VpZFtndWlkXSwKICAgICAgICBvYnNlcnZl
        ckNvbnRleHRzID0gbmV3IEFycmF5KGFkZGVkQ291bnQpLAogICAgICAgIGl0
        ZW1Qcm9wZXJ0eUtleXMgPSB0aGlzLmNwLl9pdGVtUHJvcGVydHlLZXlzW2Rl
        cGVuZGVudEtleV0sCiAgICAgICAgY2hhbmdlTWV0YSwKICAgICAgICBvYnNl
        cnZlckNvbnRleHQ7CgogICAgZm9yRWFjaChkZXBlbmRlbnRBcnJheS5zbGlj
        ZShpbmRleCwgaW5kZXggKyBhZGRlZENvdW50KSwgZnVuY3Rpb24gKGl0ZW0s
        IHNsaWNlSW5kZXgpIHsKICAgICAgaWYgKGl0ZW1Qcm9wZXJ0eUtleXMpIHsK
        ICAgICAgICBvYnNlcnZlckNvbnRleHQgPQogICAgICAgICAgb2JzZXJ2ZXJD
        b250ZXh0c1tzbGljZUluZGV4XSA9CiAgICAgICAgICB0aGlzLmNyZWF0ZVBy
        b3BlcnR5T2JzZXJ2ZXJDb250ZXh0KGRlcGVuZGVudEFycmF5LCBpbmRleCAr
        IHNsaWNlSW5kZXgsIHRoaXMudHJhY2tlZEFycmF5c0J5R3VpZFtkZXBlbmRl
        bnRLZXldKTsKICAgICAgICBmb3JFYWNoKGl0ZW1Qcm9wZXJ0eUtleXMsIGZ1
        bmN0aW9uIChwcm9wZXJ0eUtleSkgewogICAgICAgICAgYWRkQmVmb3JlT2Jz
        ZXJ2ZXIoaXRlbSwgcHJvcGVydHlLZXksIHRoaXMsIG9ic2VydmVyQ29udGV4
        dC5iZWZvcmVPYnNlcnZlcik7CiAgICAgICAgICBhZGRPYnNlcnZlcihpdGVt
        LCBwcm9wZXJ0eUtleSwgdGhpcywgb2JzZXJ2ZXJDb250ZXh0Lm9ic2VydmVy
        KTsKICAgICAgICB9LCB0aGlzKTsKICAgICAgfQoKICAgICAgY2hhbmdlTWV0
        YSA9IGNyZWF0ZUNoYW5nZU1ldGEoZGVwZW5kZW50QXJyYXksIGl0ZW0sIGlu
        ZGV4ICsgc2xpY2VJbmRleCwgdGhpcy5pbnN0YW5jZU1ldGEucHJvcGVydHlO
        YW1lLCB0aGlzLmNwKTsKICAgICAgdGhpcy5zZXRWYWx1ZSggYWRkZWRJdGVt
        LmNhbGwoCiAgICAgICAgdGhpcy5pbnN0YW5jZU1ldGEuY29udGV4dCwgdGhp
        cy5nZXRWYWx1ZSgpLCBpdGVtLCBjaGFuZ2VNZXRhLCB0aGlzLmluc3RhbmNl
        TWV0YS5zdWdhck1ldGEpKTsKICAgIH0sIHRoaXMpOwoKICAgIHRoaXMudHJh
        Y2tBZGQoZGVwZW5kZW50S2V5LCBpbmRleCwgb2JzZXJ2ZXJDb250ZXh0cyk7
        CiAgfSwKCiAgaXRlbVByb3BlcnR5V2lsbENoYW5nZTogZnVuY3Rpb24gKG9i
        aiwga2V5TmFtZSwgYXJyYXksIG9ic2VydmVyQ29udGV4dCkgewogICAgdmFy
        IGd1aWQgPSBndWlkRm9yKG9iaik7CgogICAgaWYgKCF0aGlzLmNoYW5nZWRJ
        dGVtc1tndWlkXSkgewogICAgICB0aGlzLmNoYW5nZWRJdGVtc1tndWlkXSA9
        IHsKICAgICAgICBhcnJheTogICAgICAgICAgICBhcnJheSwKICAgICAgICBv
        YnNlcnZlckNvbnRleHQ6ICBvYnNlcnZlckNvbnRleHQsCiAgICAgICAgb2Jq
        OiAgICAgICAgICAgICAgb2JqLAogICAgICAgIHByZXZpb3VzVmFsdWVzOiAg
        IHt9CiAgICAgIH07CiAgICB9CgogICAgdGhpcy5jaGFuZ2VkSXRlbXNbZ3Vp
        ZF0ucHJldmlvdXNWYWx1ZXNba2V5TmFtZV0gPSBnZXQob2JqLCBrZXlOYW1l
        KTsKICB9LAoKICBpdGVtUHJvcGVydHlEaWRDaGFuZ2U6IGZ1bmN0aW9uKG9i
        aiwga2V5TmFtZSwgYXJyYXksIG9ic2VydmVyQ29udGV4dCkgewogICAgdGhp
        cy5mbHVzaENoYW5nZXMoKTsKICB9LAoKICBmbHVzaENoYW5nZXM6IGZ1bmN0
        aW9uKCkgewogICAgdmFyIGNoYW5nZWRJdGVtcyA9IHRoaXMuY2hhbmdlZEl0
        ZW1zLCBrZXksIGMsIGNoYW5nZU1ldGE7CgogICAgZm9yIChrZXkgaW4gY2hh
        bmdlZEl0ZW1zKSB7CiAgICAgIGMgPSBjaGFuZ2VkSXRlbXNba2V5XTsKICAg
        ICAgaWYgKGMub2JzZXJ2ZXJDb250ZXh0LmRlc3Ryb3llZCkgeyBjb250aW51
        ZTsgfQoKICAgICAgdGhpcy51cGRhdGVJbmRleGVzKGMub2JzZXJ2ZXJDb250
        ZXh0LnRyYWNrZWRBcnJheSwgYy5vYnNlcnZlckNvbnRleHQuZGVwZW5kZW50
        QXJyYXkpOwoKICAgICAgY2hhbmdlTWV0YSA9IGNyZWF0ZUNoYW5nZU1ldGEo
        Yy5hcnJheSwgYy5vYmosIGMub2JzZXJ2ZXJDb250ZXh0LmluZGV4LCB0aGlz
        Lmluc3RhbmNlTWV0YS5wcm9wZXJ0eU5hbWUsIHRoaXMuY3AsIGMucHJldmlv
        dXNWYWx1ZXMpOwogICAgICB0aGlzLnNldFZhbHVlKAogICAgICAgIHRoaXMu
        Y2FsbGJhY2tzLnJlbW92ZWRJdGVtLmNhbGwodGhpcy5pbnN0YW5jZU1ldGEu
        Y29udGV4dCwgdGhpcy5nZXRWYWx1ZSgpLCBjLm9iaiwgY2hhbmdlTWV0YSwg
        dGhpcy5pbnN0YW5jZU1ldGEuc3VnYXJNZXRhKSk7CiAgICAgIHRoaXMuc2V0
        VmFsdWUoCiAgICAgICAgdGhpcy5jYWxsYmFja3MuYWRkZWRJdGVtLmNhbGwo
        dGhpcy5pbnN0YW5jZU1ldGEuY29udGV4dCwgdGhpcy5nZXRWYWx1ZSgpLCBj
        Lm9iaiwgY2hhbmdlTWV0YSwgdGhpcy5pbnN0YW5jZU1ldGEuc3VnYXJNZXRh
        KSk7CiAgICB9CiAgICB0aGlzLmNoYW5nZWRJdGVtcyA9IHt9OwogIH0KfTsK
        CmZ1bmN0aW9uIGNyZWF0ZUNoYW5nZU1ldGEoZGVwZW5kZW50QXJyYXksIGl0
        ZW0sIGluZGV4LCBwcm9wZXJ0eU5hbWUsIHByb3BlcnR5LCBwcmV2aW91c1Zh
        bHVlcykgewogIHZhciBtZXRhID0gewogICAgYXJyYXlDaGFuZ2VkOiBkZXBl
        bmRlbnRBcnJheSwKICAgIGluZGV4OiBpbmRleCwKICAgIGl0ZW06IGl0ZW0s
        CiAgICBwcm9wZXJ0eU5hbWU6IHByb3BlcnR5TmFtZSwKICAgIHByb3BlcnR5
        OiBwcm9wZXJ0eQogIH07CgogIGlmIChwcmV2aW91c1ZhbHVlcykgewogICAg
        Ly8gcHJldmlvdXMgdmFsdWVzIG9ubHkgYXZhaWxhYmxlIGZvciBpdGVtIHBy
        b3BlcnR5IGNoYW5nZXMKICAgIG1ldGEucHJldmlvdXNWYWx1ZXMgPSBwcmV2
        aW91c1ZhbHVlczsKICB9CgogIHJldHVybiBtZXRhOwp9CgpmdW5jdGlvbiBh
        ZGRJdGVtcyAoZGVwZW5kZW50QXJyYXksIGNhbGxiYWNrcywgY3AsIHByb3Bl
        cnR5TmFtZSwgbWV0YSkgewogIGZvckVhY2goZGVwZW5kZW50QXJyYXksIGZ1
        bmN0aW9uIChpdGVtLCBpbmRleCkgewogICAgbWV0YS5zZXRWYWx1ZSggY2Fs
        bGJhY2tzLmFkZGVkSXRlbS5jYWxsKAogICAgICB0aGlzLCBtZXRhLmdldFZh
        bHVlKCksIGl0ZW0sIGNyZWF0ZUNoYW5nZU1ldGEoZGVwZW5kZW50QXJyYXks
        IGl0ZW0sIGluZGV4LCBwcm9wZXJ0eU5hbWUsIGNwKSwgbWV0YS5zdWdhck1l
        dGEpKTsKICB9LCB0aGlzKTsKfQoKZnVuY3Rpb24gcmVzZXQoY3AsIHByb3Bl
        cnR5TmFtZSkgewogIHZhciBjYWxsYmFja3MgPSBjcC5fY2FsbGJhY2tzKCks
        CiAgICAgIG1ldGE7CgogIGlmIChjcC5faGFzSW5zdGFuY2VNZXRhKHRoaXMs
        IHByb3BlcnR5TmFtZSkpIHsKICAgIG1ldGEgPSBjcC5faW5zdGFuY2VNZXRh
        KHRoaXMsIHByb3BlcnR5TmFtZSk7CiAgICBtZXRhLnNldFZhbHVlKGNwLnJl
        c2V0VmFsdWUobWV0YS5nZXRWYWx1ZSgpKSk7CiAgfSBlbHNlIHsKICAgIG1l
        dGEgPSBjcC5faW5zdGFuY2VNZXRhKHRoaXMsIHByb3BlcnR5TmFtZSk7CiAg
        fQoKICBpZiAoY3Aub3B0aW9ucy5pbml0aWFsaXplKSB7CiAgICBjcC5vcHRp
        b25zLmluaXRpYWxpemUuY2FsbCh0aGlzLCBtZXRhLmdldFZhbHVlKCksIHsg
        cHJvcGVydHk6IGNwLCBwcm9wZXJ0eU5hbWU6IHByb3BlcnR5TmFtZSB9LCBt
        ZXRhLnN1Z2FyTWV0YSk7CiAgfQp9CgpmdW5jdGlvbiBSZWR1Y2VDb21wdXRl
        ZFByb3BlcnR5SW5zdGFuY2VNZXRhKGNvbnRleHQsIHByb3BlcnR5TmFtZSwg
        aW5pdGlhbFZhbHVlKSB7CiAgdGhpcy5jb250ZXh0ID0gY29udGV4dDsKICB0
        aGlzLnByb3BlcnR5TmFtZSA9IHByb3BlcnR5TmFtZTsKICB0aGlzLmNhY2hl
        ID0gbWV0YUZvcihjb250ZXh0KS5jYWNoZTsKCiAgdGhpcy5kZXBlbmRlbnRB
        cnJheXMgPSB7fTsKICB0aGlzLnN1Z2FyTWV0YSA9IHt9OwoKICB0aGlzLmlu
        aXRpYWxWYWx1ZSA9IGluaXRpYWxWYWx1ZTsKfQoKUmVkdWNlQ29tcHV0ZWRQ
        cm9wZXJ0eUluc3RhbmNlTWV0YS5wcm90b3R5cGUgPSB7CiAgZ2V0VmFsdWU6
        IGZ1bmN0aW9uICgpIHsKICAgIGlmICh0aGlzLnByb3BlcnR5TmFtZSBpbiB0
        aGlzLmNhY2hlKSB7CiAgICAgIHJldHVybiB0aGlzLmNhY2hlW3RoaXMucHJv
        cGVydHlOYW1lXTsKICAgIH0gZWxzZSB7CiAgICAgIHJldHVybiB0aGlzLmlu
        aXRpYWxWYWx1ZTsKICAgIH0KICB9LAoKICBzZXRWYWx1ZTogZnVuY3Rpb24o
        bmV3VmFsdWUsIHRyaWdnZXJPYnNlcnZlcnMpIHsKICAgIC8vIFRoaXMgbGV0
        cyBzdWdhcnMgZm9yY2UgYSByZWNvbXB1dGF0aW9uLCBoYW5keSBmb3IgdmVy
        eSBzaW1wbGUKICAgIC8vIGltcGxlbWVudGF0aW9ucyBvZiBlZyBtYXguCiAg
        ICBpZiAobmV3VmFsdWUgIT09IHVuZGVmaW5lZCkgewogICAgICB2YXIgZmly
        ZU9ic2VydmVycyA9IHRyaWdnZXJPYnNlcnZlcnMgJiYgKG5ld1ZhbHVlICE9
        PSB0aGlzLmNhY2hlW3RoaXMucHJvcGVydHlOYW1lXSk7CgogICAgICBpZiAo
        ZmlyZU9ic2VydmVycykgewogICAgICAgIHByb3BlcnR5V2lsbENoYW5nZSh0
        aGlzLmNvbnRleHQsIHRoaXMucHJvcGVydHlOYW1lKTsKICAgICAgfQoKICAg
        ICAgdGhpcy5jYWNoZVt0aGlzLnByb3BlcnR5TmFtZV0gPSBuZXdWYWx1ZTsK
        CiAgICAgIGlmIChmaXJlT2JzZXJ2ZXJzKSB7CiAgICAgICAgcHJvcGVydHlE
        aWRDaGFuZ2UodGhpcy5jb250ZXh0LCB0aGlzLnByb3BlcnR5TmFtZSk7CiAg
        ICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIGRlbGV0ZSB0aGlzLmNhY2hlW3Ro
        aXMucHJvcGVydHlOYW1lXTsKICAgIH0KICB9Cn07CgovKioKICBBIGNvbXB1
        dGVkIHByb3BlcnR5IHdob3NlIGRlcGVuZGVudCBrZXlzIGFyZSBhcnJheXMg
        YW5kIHdoaWNoIGlzIHVwZGF0ZWQgd2l0aAogICJvbmUgYXQgYSB0aW1lIiBz
        ZW1hbnRpY3MuCgogIEBjbGFzcyBSZWR1Y2VDb21wdXRlZFByb3BlcnR5CiAg
        QG5hbWVzcGFjZSBFbWJlcgogIEBleHRlbmRzIEVtYmVyLkNvbXB1dGVkUHJv
        cGVydHkKICBAY29uc3RydWN0b3IKKi8KZnVuY3Rpb24gUmVkdWNlQ29tcHV0
        ZWRQcm9wZXJ0eShvcHRpb25zKSB7CiAgdmFyIGNwID0gdGhpczsKCiAgdGhp
        cy5vcHRpb25zID0gb3B0aW9uczsKICB0aGlzLl9pbnN0YW5jZU1ldGFzID0g
        e307CgogIHRoaXMuX2RlcGVuZGVudEtleXMgPSBudWxsOwogIC8vIEEgbWFw
        IG9mIGRlcGVuZGVudEtleSAtPiBbaXRlbVByb3BlcnR5LCAuLi5dIHRoYXQg
        dHJhY2tzIHdoYXQgcHJvcGVydGllcyBvZgogIC8vIGl0ZW1zIGluIHRoZSBh
        cnJheSB3ZSBtdXN0IHRyYWNrIHRvIHVwZGF0ZSB0aGlzIHByb3BlcnR5Lgog
        IHRoaXMuX2l0ZW1Qcm9wZXJ0eUtleXMgPSB7fTsKICB0aGlzLl9wcmV2aW91
        c0l0ZW1Qcm9wZXJ0eUtleXMgPSB7fTsKCiAgdGhpcy5yZWFkT25seSgpOwog
        IHRoaXMuY2FjaGVhYmxlKCk7CgogIHRoaXMucmVjb21wdXRlT25jZSA9IGZ1
        bmN0aW9uKHByb3BlcnR5TmFtZSkgewogICAgLy8gV2hhdCB3ZSByZWFsbHkg
        d2FudCB0byBkbyBpcyBjb2FsZXNjZSBieSA8Y3AsIHByb3BlcnR5TmFtZT4u
        CiAgICAvLyBXZSBuZWVkIGEgZm9ybSBvZiBgc2NoZWR1bGVPbmNlYCB0aGF0
        IGFjY2VwdHMgYW4gYXJiaXRyYXJ5IHRva2VuIHRvCiAgICAvLyBjb2FsZXNj
        ZSBieSwgaW4gYWRkaXRpb24gdG8gdGhlIHRhcmdldCBhbmQgbWV0aG9kLgog
        ICAgRW1iZXIucnVuLm9uY2UodGhpcywgcmVjb21wdXRlLCBwcm9wZXJ0eU5h
        bWUpOwogIH07CiAgdmFyIHJlY29tcHV0ZSA9IGZ1bmN0aW9uKHByb3BlcnR5
        TmFtZSkgewogICAgdmFyIGRlcGVuZGVudEtleXMgPSBjcC5fZGVwZW5kZW50
        S2V5cywKICAgICAgICBtZXRhID0gY3AuX2luc3RhbmNlTWV0YSh0aGlzLCBw
        cm9wZXJ0eU5hbWUpLAogICAgICAgIGNhbGxiYWNrcyA9IGNwLl9jYWxsYmFj
        a3MoKTsKCiAgICByZXNldC5jYWxsKHRoaXMsIGNwLCBwcm9wZXJ0eU5hbWUp
        OwoKICAgIGZvckVhY2goY3AuX2RlcGVuZGVudEtleXMsIGZ1bmN0aW9uIChk
        ZXBlbmRlbnRLZXkpIHsKICAgICAgdmFyIGRlcGVuZGVudEFycmF5ID0gZ2V0
        KHRoaXMsIGRlcGVuZGVudEtleSksCiAgICAgICAgICBwcmV2aW91c0RlcGVu
        ZGVudEFycmF5ID0gbWV0YS5kZXBlbmRlbnRBcnJheXNbZGVwZW5kZW50S2V5
        XTsKCiAgICAgIGlmIChkZXBlbmRlbnRBcnJheSA9PT0gcHJldmlvdXNEZXBl
        bmRlbnRBcnJheSkgewogICAgICAgIC8vIFRoZSBhcnJheSBtYXkgYmUgdGhl
        IHNhbWUsIGJ1dCBvdXIgaXRlbSBwcm9wZXJ0eSBrZXlzIG1heSBoYXZlCiAg
        ICAgICAgLy8gY2hhbmdlZCwgc28gd2Ugc2V0IHRoZW0gdXAgYWdhaW4uICBX
        ZSBjYW4ndCBlYXNpbHkgdGVsbCBpZiB0aGV5J3ZlCiAgICAgICAgLy8gY2hh
        bmdlZDogdGhlIGFycmF5IG1heSBiZSB0aGUgc2FtZSBvYmplY3QsIGJ1dCB3
        aXRoIGRpZmZlcmVudAogICAgICAgIC8vIGNvbnRlbnRzLgogICAgICAgIGlm
        IChjcC5fcHJldmlvdXNJdGVtUHJvcGVydHlLZXlzW2RlcGVuZGVudEtleV0p
        IHsKICAgICAgICAgIGRlbGV0ZSBjcC5fcHJldmlvdXNJdGVtUHJvcGVydHlL
        ZXlzW2RlcGVuZGVudEtleV07CiAgICAgICAgICBtZXRhLmRlcGVuZGVudEFy
        cmF5c09ic2VydmVyLnNldHVwUHJvcGVydHlPYnNlcnZlcnMoZGVwZW5kZW50
        S2V5LCBjcC5faXRlbVByb3BlcnR5S2V5c1tkZXBlbmRlbnRLZXldKTsKICAg
        ICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgbWV0YS5kZXBlbmRlbnRB
        cnJheXNbZGVwZW5kZW50S2V5XSA9IGRlcGVuZGVudEFycmF5OwoKICAgICAg
        ICBpZiAocHJldmlvdXNEZXBlbmRlbnRBcnJheSkgewogICAgICAgICAgbWV0
        YS5kZXBlbmRlbnRBcnJheXNPYnNlcnZlci50ZWFyZG93bk9ic2VydmVycyhw
        cmV2aW91c0RlcGVuZGVudEFycmF5LCBkZXBlbmRlbnRLZXkpOwogICAgICAg
        IH0KCiAgICAgICAgaWYgKGRlcGVuZGVudEFycmF5KSB7CiAgICAgICAgICBt
        ZXRhLmRlcGVuZGVudEFycmF5c09ic2VydmVyLnNldHVwT2JzZXJ2ZXJzKGRl
        cGVuZGVudEFycmF5LCBkZXBlbmRlbnRLZXkpOwogICAgICAgIH0KICAgICAg
        fQogICAgfSwgdGhpcyk7CgogICAgZm9yRWFjaChjcC5fZGVwZW5kZW50S2V5
        cywgZnVuY3Rpb24oZGVwZW5kZW50S2V5KSB7CiAgICAgIHZhciBkZXBlbmRl
        bnRBcnJheSA9IGdldCh0aGlzLCBkZXBlbmRlbnRLZXkpOwogICAgICBpZiAo
        ZGVwZW5kZW50QXJyYXkpIHsKICAgICAgICBhZGRJdGVtcy5jYWxsKHRoaXMs
        IGRlcGVuZGVudEFycmF5LCBjYWxsYmFja3MsIGNwLCBwcm9wZXJ0eU5hbWUs
        IG1ldGEpOwogICAgICB9CiAgICB9LCB0aGlzKTsKICB9OwoKICB0aGlzLmZ1
        bmMgPSBmdW5jdGlvbiAocHJvcGVydHlOYW1lKSB7CiAgICBFbWJlci5hc3Nl
        cnQoIkNvbXB1dGVkIHJlZHVjZSB2YWx1ZXMgcmVxdWlyZSBhdCBsZWFzdCBv
        bmUgZGVwZW5kZW50IGtleSIsIGNwLl9kZXBlbmRlbnRLZXlzKTsKCiAgICBy
        ZWNvbXB1dGUuY2FsbCh0aGlzLCBwcm9wZXJ0eU5hbWUpOwoKICAgIHJldHVy
        biBjcC5faW5zdGFuY2VNZXRhKHRoaXMsIHByb3BlcnR5TmFtZSkuZ2V0VmFs
        dWUoKTsKICB9Owp9CgpFbWJlci5SZWR1Y2VDb21wdXRlZFByb3BlcnR5ID0g
        UmVkdWNlQ29tcHV0ZWRQcm9wZXJ0eTsKUmVkdWNlQ29tcHV0ZWRQcm9wZXJ0
        eS5wcm90b3R5cGUgPSBvX2NyZWF0ZShDb21wdXRlZFByb3BlcnR5LnByb3Rv
        dHlwZSk7CgpmdW5jdGlvbiBkZWZhdWx0Q2FsbGJhY2soY29tcHV0ZWRWYWx1
        ZSkgewogIHJldHVybiBjb21wdXRlZFZhbHVlOwp9CgpSZWR1Y2VDb21wdXRl
        ZFByb3BlcnR5LnByb3RvdHlwZS5fY2FsbGJhY2tzID0gZnVuY3Rpb24gKCkg
        ewogIGlmICghdGhpcy5jYWxsYmFja3MpIHsKICAgIHZhciBvcHRpb25zID0g
        dGhpcy5vcHRpb25zOwogICAgdGhpcy5jYWxsYmFja3MgPSB7CiAgICAgIHJl
        bW92ZWRJdGVtOiBvcHRpb25zLnJlbW92ZWRJdGVtIHx8IGRlZmF1bHRDYWxs
        YmFjaywKICAgICAgYWRkZWRJdGVtOiBvcHRpb25zLmFkZGVkSXRlbSB8fCBk
        ZWZhdWx0Q2FsbGJhY2sKICAgIH07CiAgfQogIHJldHVybiB0aGlzLmNhbGxi
        YWNrczsKfTsKClJlZHVjZUNvbXB1dGVkUHJvcGVydHkucHJvdG90eXBlLl9o
        YXNJbnN0YW5jZU1ldGEgPSBmdW5jdGlvbiAoY29udGV4dCwgcHJvcGVydHlO
        YW1lKSB7CiAgdmFyIGd1aWQgPSBndWlkRm9yKGNvbnRleHQpLAogICAgICBr
        ZXkgPSBndWlkICsgJzonICsgcHJvcGVydHlOYW1lOwoKICByZXR1cm4gISF0
        aGlzLl9pbnN0YW5jZU1ldGFzW2tleV07Cn07CgpSZWR1Y2VDb21wdXRlZFBy
        b3BlcnR5LnByb3RvdHlwZS5faW5zdGFuY2VNZXRhID0gZnVuY3Rpb24gKGNv
        bnRleHQsIHByb3BlcnR5TmFtZSkgewogIHZhciBndWlkID0gZ3VpZEZvcihj
        b250ZXh0KSwKICAgICAga2V5ID0gZ3VpZCArICc6JyArIHByb3BlcnR5TmFt
        ZSwKICAgICAgbWV0YSA9IHRoaXMuX2luc3RhbmNlTWV0YXNba2V5XTsKCiAg
        aWYgKCFtZXRhKSB7CiAgICBtZXRhID0gdGhpcy5faW5zdGFuY2VNZXRhc1tr
        ZXldID0gbmV3IFJlZHVjZUNvbXB1dGVkUHJvcGVydHlJbnN0YW5jZU1ldGEo
        Y29udGV4dCwgcHJvcGVydHlOYW1lLCB0aGlzLmluaXRpYWxWYWx1ZSgpKTsK
        ICAgIG1ldGEuZGVwZW5kZW50QXJyYXlzT2JzZXJ2ZXIgPSBuZXcgRGVwZW5k
        ZW50QXJyYXlzT2JzZXJ2ZXIodGhpcy5fY2FsbGJhY2tzKCksIHRoaXMsIG1l
        dGEsIGNvbnRleHQsIHByb3BlcnR5TmFtZSwgbWV0YS5zdWdhck1ldGEpOwog
        IH0KCiAgcmV0dXJuIG1ldGE7Cn07CgpSZWR1Y2VDb21wdXRlZFByb3BlcnR5
        LnByb3RvdHlwZS5pbml0aWFsVmFsdWUgPSBmdW5jdGlvbiAoKSB7CiAgaWYg
        KHR5cGVvZiB0aGlzLm9wdGlvbnMuaW5pdGlhbFZhbHVlID09PSAnZnVuY3Rp
        b24nKSB7CiAgICByZXR1cm4gdGhpcy5vcHRpb25zLmluaXRpYWxWYWx1ZSgp
        OwogIH0KICBlbHNlIHsKICAgIHJldHVybiB0aGlzLm9wdGlvbnMuaW5pdGlh
        bFZhbHVlOwogIH0KfTsKClJlZHVjZUNvbXB1dGVkUHJvcGVydHkucHJvdG90
        eXBlLnJlc2V0VmFsdWUgPSBmdW5jdGlvbiAodmFsdWUpIHsKICByZXR1cm4g
        dGhpcy5pbml0aWFsVmFsdWUoKTsKfTsKClJlZHVjZUNvbXB1dGVkUHJvcGVy
        dHkucHJvdG90eXBlLml0ZW1Qcm9wZXJ0eUtleSA9IGZ1bmN0aW9uIChkZXBl
        bmRlbnRBcnJheUtleSwgaXRlbVByb3BlcnR5S2V5KSB7CiAgdGhpcy5faXRl
        bVByb3BlcnR5S2V5c1tkZXBlbmRlbnRBcnJheUtleV0gPSB0aGlzLl9pdGVt
        UHJvcGVydHlLZXlzW2RlcGVuZGVudEFycmF5S2V5XSB8fCBbXTsKICB0aGlz
        Ll9pdGVtUHJvcGVydHlLZXlzW2RlcGVuZGVudEFycmF5S2V5XS5wdXNoKGl0
        ZW1Qcm9wZXJ0eUtleSk7Cn07CgpSZWR1Y2VDb21wdXRlZFByb3BlcnR5LnBy
        b3RvdHlwZS5jbGVhckl0ZW1Qcm9wZXJ0eUtleXMgPSBmdW5jdGlvbiAoZGVw
        ZW5kZW50QXJyYXlLZXkpIHsKICBpZiAodGhpcy5faXRlbVByb3BlcnR5S2V5
        c1tkZXBlbmRlbnRBcnJheUtleV0pIHsKICAgIHRoaXMuX3ByZXZpb3VzSXRl
        bVByb3BlcnR5S2V5c1tkZXBlbmRlbnRBcnJheUtleV0gPSB0aGlzLl9pdGVt
        UHJvcGVydHlLZXlzW2RlcGVuZGVudEFycmF5S2V5XTsKICAgIHRoaXMuX2l0
        ZW1Qcm9wZXJ0eUtleXNbZGVwZW5kZW50QXJyYXlLZXldID0gW107CiAgfQp9
        OwoKUmVkdWNlQ29tcHV0ZWRQcm9wZXJ0eS5wcm90b3R5cGUucHJvcGVydHkg
        PSBmdW5jdGlvbiAoKSB7CiAgdmFyIGNwID0gdGhpcywKICAgICAgYXJncyA9
        IGFfc2xpY2UuY2FsbChhcmd1bWVudHMpLAogICAgICBwcm9wZXJ0eUFyZ3Mg
        PSBuZXcgRW1iZXIuU2V0KCksCiAgICAgIG1hdGNoLAogICAgICBkZXBlbmRl
        bnRBcnJheUtleSwKICAgICAgaXRlbVByb3BlcnR5S2V5OwoKICBmb3JFYWNo
        KGFfc2xpY2UuY2FsbChhcmd1bWVudHMpLCBmdW5jdGlvbiAoZGVwZW5kZW50
        S2V5KSB7CiAgICBpZiAoZG91YmxlRWFjaFByb3BlcnR5UGF0dGVybi50ZXN0
        KGRlcGVuZGVudEtleSkpIHsKICAgICAgdGhyb3cgbmV3IEVtYmVyLkVycm9y
        KCJOZXN0ZWQgQGVhY2ggcHJvcGVydGllcyBub3Qgc3VwcG9ydGVkOiAiICsg
        ZGVwZW5kZW50S2V5KTsKICAgIH0gZWxzZSBpZiAobWF0Y2ggPSBlYWNoUHJv
        cGVydHlQYXR0ZXJuLmV4ZWMoZGVwZW5kZW50S2V5KSkgewogICAgICBkZXBl
        bmRlbnRBcnJheUtleSA9IG1hdGNoWzFdOwogICAgICBpdGVtUHJvcGVydHlL
        ZXkgPSBtYXRjaFsyXTsKICAgICAgY3AuaXRlbVByb3BlcnR5S2V5KGRlcGVu
        ZGVudEFycmF5S2V5LCBpdGVtUHJvcGVydHlLZXkpOwogICAgICBwcm9wZXJ0
        eUFyZ3MuYWRkKGRlcGVuZGVudEFycmF5S2V5KTsKICAgIH0gZWxzZSB7CiAg
        ICAgIHByb3BlcnR5QXJncy5hZGQoZGVwZW5kZW50S2V5KTsKICAgIH0KICB9
        KTsKCiAgcmV0dXJuIENvbXB1dGVkUHJvcGVydHkucHJvdG90eXBlLnByb3Bl
        cnR5LmFwcGx5KHRoaXMsIHByb3BlcnR5QXJncy50b0FycmF5KCkpOwp9OwoK
        LyoqCiAgQ3JlYXRlcyBhIGNvbXB1dGVkIHByb3BlcnR5IHdoaWNoIG9wZXJh
        dGVzIG9uIGRlcGVuZGVudCBhcnJheXMgYW5kCiAgaXMgdXBkYXRlZCB3aXRo
        ICJvbmUgYXQgYSB0aW1lIiBzZW1hbnRpY3MuIFdoZW4gaXRlbXMgYXJlIGFk
        ZGVkIG9yCiAgcmVtb3ZlZCBmcm9tIHRoZSBkZXBlbmRlbnQgYXJyYXkocykg
        YSByZWR1Y2UgY29tcHV0ZWQgb25seSBvcGVyYXRlcwogIG9uIHRoZSBjaGFu
        Z2UgaW5zdGVhZCBvZiByZS1ldmFsdWF0aW5nIHRoZSBlbnRpcmUgYXJyYXku
        CgogIElmIHRoZXJlIGFyZSBtb3JlIHRoYW4gb25lIGFyZ3VtZW50cyB0aGUg
        Zmlyc3QgYXJndW1lbnRzIGFyZQogIGNvbnNpZGVyZWQgdG8gYmUgZGVwZW5k
        ZW50IHByb3BlcnR5IGtleXMuIFRoZSBsYXN0IGFyZ3VtZW50IGlzCiAgcmVx
        dWlyZWQgdG8gYmUgYW4gb3B0aW9ucyBvYmplY3QuIFRoZSBvcHRpb25zIG9i
        amVjdCBjYW4gaGF2ZSB0aGUKICBmb2xsb3dpbmcgZm91ciBwcm9wZXJ0aWVz
        OgoKICBgaW5pdGlhbFZhbHVlYCAtIEEgdmFsdWUgb3IgZnVuY3Rpb24gdGhh
        dCB3aWxsIGJlIHVzZWQgYXMgdGhlIGluaXRpYWwKICB2YWx1ZSBmb3IgdGhl
        IGNvbXB1dGVkLiBJZiB0aGlzIHByb3BlcnR5IGlzIGEgZnVuY3Rpb24gdGhl
        IHJlc3VsdCBvZiBjYWxsaW5nCiAgdGhlIGZ1bmN0aW9uIHdpbGwgYmUgdXNl
        ZCBhcyB0aGUgaW5pdGlhbCB2YWx1ZS4gVGhpcyBwcm9wZXJ0eSBpcyByZXF1
        aXJlZC4KCiAgYGluaXRpYWxpemVgIC0gQW4gb3B0aW9uYWwgaW5pdGlhbGl6
        ZSBmdW5jdGlvbi4gVHlwaWNhbGx5IHRoaXMgd2lsbCBiZSB1c2VkCiAgdG8g
        c2V0IHVwIHN0YXRlIG9uIHRoZSBpbnN0YW5jZU1ldGEgb2JqZWN0LgoKICBg
        cmVtb3ZlZEl0ZW1gIC0gQSBmdW5jdGlvbiB0aGF0IGlzIGNhbGxlZCBlYWNo
        IHRpbWUgYW4gZWxlbWVudCBpcyByZW1vdmVkCiAgZnJvbSB0aGUgYXJyYXku
        CgogIGBhZGRlZEl0ZW1gIC0gQSBmdW5jdGlvbiB0aGF0IGlzIGNhbGxlZCBl
        YWNoIHRpbWUgYW4gZWxlbWVudCBpcyBhZGRlZCB0bwogIHRoZSBhcnJheS4K
        CgogIFRoZSBgaW5pdGlhbGl6ZWAgZnVuY3Rpb24gaGFzIHRoZSBmb2xsb3dp
        bmcgc2lnbmF0dXJlOgoKICBgYGBqYXZhc2NyaXB0CiAgIGZ1bmN0aW9uIChp
        bml0aWFsVmFsdWUsIGNoYW5nZU1ldGEsIGluc3RhbmNlTWV0YSkKICBgYGAK
        CiAgYGluaXRpYWxWYWx1ZWAgLSBUaGUgdmFsdWUgb2YgdGhlIGBpbml0aWFs
        VmFsdWVgIHByb3BlcnR5IGZyb20gdGhlCiAgb3B0aW9ucyBvYmplY3QuCgog
        IGBjaGFuZ2VNZXRhYCAtIEFuIG9iamVjdCB3aGljaCBjb250YWlucyBtZXRh
        IGluZm9ybWF0aW9uIGFib3V0IHRoZQogIGNvbXB1dGVkLiBJdCBjb250YWlu
        cyB0aGUgZm9sbG93aW5nIHByb3BlcnRpZXM6CgogICAgIC0gYHByb3BlcnR5
        YCB0aGUgY29tcHV0ZWQgcHJvcGVydHkKICAgICAtIGBwcm9wZXJ0eU5hbWVg
        IHRoZSBuYW1lIG9mIHRoZSBwcm9wZXJ0eSBvbiB0aGUgb2JqZWN0CgogIGBp
        bnN0YW5jZU1ldGFgIC0gQW4gb2JqZWN0IHRoYXQgY2FuIGJlIHVzZWQgdG8g
        c3RvcmUgbWV0YQogIGluZm9ybWF0aW9uIG5lZWRlZCBmb3IgY2FsY3VsYXRp
        bmcgeW91ciBjb21wdXRlZC4gRm9yIGV4YW1wbGUgYQogIHVuaXF1ZSBjb21w
        dXRlZCBtaWdodCB1c2UgdGhpcyB0byBzdG9yZSB0aGUgbnVtYmVyIG9mIHRp
        bWVzIGEgZ2l2ZW4KICBlbGVtZW50IGlzIGZvdW5kIGluIHRoZSBkZXBlbmRl
        bnQgYXJyYXkuCgoKICBUaGUgYHJlbW92ZWRJdGVtYCBhbmQgYGFkZGVkSXRl
        bWAgZnVuY3Rpb25zIGJvdGggaGF2ZSB0aGUgZm9sbG93aW5nIHNpZ25hdHVy
        ZToKCiAgYGBgamF2YXNjcmlwdAogIGZ1bmN0aW9uIChhY2N1bXVsYXRlZFZh
        bHVlLCBpdGVtLCBjaGFuZ2VNZXRhLCBpbnN0YW5jZU1ldGEpCiAgYGBgCgog
        IGBhY2N1bXVsYXRlZFZhbHVlYCAtIFRoZSB2YWx1ZSByZXR1cm5lZCBmcm9t
        IHRoZSBsYXN0IHRpbWUKICBgcmVtb3ZlZEl0ZW1gIG9yIGBhZGRlZEl0ZW1g
        IHdhcyBjYWxsZWQgb3IgYGluaXRpYWxWYWx1ZWAuCgogIGBpdGVtYCAtIHRo
        ZSBlbGVtZW50IGFkZGVkIG9yIHJlbW92ZWQgZnJvbSB0aGUgYXJyYXkKCiAg
        YGNoYW5nZU1ldGFgIC0gQW4gb2JqZWN0IHdoaWNoIGNvbnRhaW5zIG1ldGEg
        aW5mb3JtYXRpb24gYWJvdXQgdGhlCiAgY2hhbmdlLiBJdCBjb250YWlucyB0
        aGUgZm9sbG93aW5nIHByb3BlcnRpZXM6CgogICAgLSBgcHJvcGVydHlgIHRo
        ZSBjb21wdXRlZCBwcm9wZXJ0eQogICAgLSBgcHJvcGVydHlOYW1lYCB0aGUg
        bmFtZSBvZiB0aGUgcHJvcGVydHkgb24gdGhlIG9iamVjdAogICAgLSBgaW5k
        ZXhgIHRoZSBpbmRleCBvZiB0aGUgYWRkZWQgb3IgcmVtb3ZlZCBpdGVtCiAg
        ICAtIGBpdGVtYCB0aGUgYWRkZWQgb3IgcmVtb3ZlZCBpdGVtOiB0aGlzIGlz
        IGV4YWN0bHkgdGhlIHNhbWUgYXMKICAgICAgdGhlIHNlY29uZCBhcmcKICAg
        IC0gYGFycmF5Q2hhbmdlZGAgdGhlIGFycmF5IHRoYXQgdHJpZ2dlcmVkIHRo
        ZSBjaGFuZ2UuIENhbiBiZQogICAgICB1c2VmdWwgd2hlbiBkZXBlbmRpbmcg
        b24gbXVsdGlwbGUgYXJyYXlzLgoKICBGb3IgcHJvcGVydHkgY2hhbmdlcyB0
        cmlnZ2VyZWQgb24gYW4gaXRlbSBwcm9wZXJ0eSBjaGFuZ2UgKHdoZW4KICBk
        ZXBLZXkgaXMgc29tZXRoaW5nIGxpa2UgYHNvbWVBcnJheS5AZWFjaC5zb21l
        UHJvcGVydHlgKSwKICBgY2hhbmdlTWV0YWAgd2lsbCBhbHNvIGNvbnRhaW4g
        dGhlIGZvbGxvd2luZyBwcm9wZXJ0eToKCiAgICAtIGBwcmV2aW91c1ZhbHVl
        c2AgYW4gb2JqZWN0IHdob3NlIGtleXMgYXJlIHRoZSBwcm9wZXJ0aWVzIHRo
        YXQgY2hhbmdlZCBvbgogICAgdGhlIGl0ZW0sIGFuZCB3aG9zZSB2YWx1ZXMg
        YXJlIHRoZSBpdGVtJ3MgcHJldmlvdXMgdmFsdWVzLgoKICBgcHJldmlvdXNW
        YWx1ZXNgIGlzIGltcG9ydGFudCBFbWJlciBjb2FsZXNjZXMgaXRlbSBwcm9w
        ZXJ0eSBjaGFuZ2VzIHZpYQogIEVtYmVyLnJ1bi5vbmNlLiBUaGlzIG1lYW5z
        IHRoYXQgYnkgdGhlIHRpbWUgcmVtb3ZlZEl0ZW0gZ2V0cyBjYWxsZWQsIGl0
        ZW0gaGFzCiAgdGhlIG5ldyB2YWx1ZXMsIGJ1dCB5b3UgbWF5IG5lZWQgdGhl
        IHByZXZpb3VzIHZhbHVlIChlZyBmb3Igc29ydGluZyAmCiAgZmlsdGVyaW5n
        KS4KCiAgYGluc3RhbmNlTWV0YWAgLSBBbiBvYmplY3QgdGhhdCBjYW4gYmUg
        dXNlZCB0byBzdG9yZSBtZXRhCiAgaW5mb3JtYXRpb24gbmVlZGVkIGZvciBj
        YWxjdWxhdGluZyB5b3VyIGNvbXB1dGVkLiBGb3IgZXhhbXBsZSBhCiAgdW5p
        cXVlIGNvbXB1dGVkIG1pZ2h0IHVzZSB0aGlzIHRvIHN0b3JlIHRoZSBudW1i
        ZXIgb2YgdGltZXMgYSBnaXZlbgogIGVsZW1lbnQgaXMgZm91bmQgaW4gdGhl
        IGRlcGVuZGVudCBhcnJheS4KCiAgVGhlIGByZW1vdmVkSXRlbWAgYW5kIGBh
        ZGRlZEl0ZW1gIGZ1bmN0aW9ucyBzaG91bGQgcmV0dXJuIHRoZSBhY2N1bXVs
        YXRlZAogIHZhbHVlLiBJdCBpcyBhY2NlcHRhYmxlIHRvIG5vdCByZXR1cm4g
        YW55dGhpbmcgKGllIHJldHVybiB1bmRlZmluZWQpCiAgdG8gaW52YWxpZGF0
        ZSB0aGUgY29tcHV0YXRpb24uIFRoaXMgaXMgZ2VuZXJhbGx5IG5vdCBhIGdv
        b2QgaWRlYSBmb3IKICBhcnJheUNvbXB1dGVkIGJ1dCBpdCdzIHVzZWQgaW4g
        ZWcgbWF4IGFuZCBtaW4uCgogIE5vdGUgdGhhdCBvYnNlcnZlcnMgd2lsbCBi
        ZSBmaXJlZCBpZiBlaXRoZXIgb2YgdGhlc2UgZnVuY3Rpb25zIHJldHVybiBh
        IHZhbHVlCiAgdGhhdCBkaWZmZXJzIGZyb20gdGhlIGFjY3VtdWxhdGVkIHZh
        bHVlLiAgV2hlbiByZXR1cm5pbmcgYW4gb2JqZWN0IHRoYXQKICBtdXRhdGVz
        IGluIHJlc3BvbnNlIHRvIGFycmF5IGNoYW5nZXMsIGZvciBleGFtcGxlIGFu
        IGFycmF5IHRoYXQgbWFwcwogIGV2ZXJ5dGhpbmcgZnJvbSBzb21lIG90aGVy
        IGFycmF5IChzZWUgYEVtYmVyLmNvbXB1dGVkLm1hcGApLCBpdCBpcyB1c3Vh
        bGx5CiAgaW1wb3J0YW50IHRoYXQgdGhlICpzYW1lKiBhcnJheSBiZSByZXR1
        cm5lZCB0byBhdm9pZCBhY2NpZGVudGFsbHkgdHJpZ2dlcmluZyBvYnNlcnZl
        cnMuCgogIEV4YW1wbGUKCiAgYGBgamF2YXNjcmlwdAogIEVtYmVyLmNvbXB1
        dGVkLm1heCA9IGZ1bmN0aW9uIChkZXBlbmRlbnRLZXkpIHsKICAgIHJldHVy
        biBFbWJlci5yZWR1Y2VDb21wdXRlZC5jYWxsKG51bGwsIGRlcGVuZGVudEtl
        eSwgewogICAgICBpbml0aWFsVmFsdWU6IC1JbmZpbml0eSwKCiAgICAgIGFk
        ZGVkSXRlbTogZnVuY3Rpb24gKGFjY3VtdWxhdGVkVmFsdWUsIGl0ZW0sIGNo
        YW5nZU1ldGEsIGluc3RhbmNlTWV0YSkgewogICAgICAgIHJldHVybiBNYXRo
        Lm1heChhY2N1bXVsYXRlZFZhbHVlLCBpdGVtKTsKICAgICAgfSwKCiAgICAg
        IHJlbW92ZWRJdGVtOiBmdW5jdGlvbiAoYWNjdW11bGF0ZWRWYWx1ZSwgaXRl
        bSwgY2hhbmdlTWV0YSwgaW5zdGFuY2VNZXRhKSB7CiAgICAgICAgaWYgKGl0
        ZW0gPCBhY2N1bXVsYXRlZFZhbHVlKSB7CiAgICAgICAgICByZXR1cm4gYWNj
        dW11bGF0ZWRWYWx1ZTsKICAgICAgICB9CiAgICAgIH0KICAgIH0pOwogIH07
        CiAgYGBgCgogIEBtZXRob2QgcmVkdWNlQ29tcHV0ZWQKICBAZm9yIEVtYmVy
        CiAgQHBhcmFtIHtTdHJpbmd9IFtkZXBlbmRlbnRLZXlzKl0KICBAcGFyYW0g
        e09iamVjdH0gb3B0aW9ucwogIEByZXR1cm4ge0VtYmVyLkNvbXB1dGVkUHJv
        cGVydHl9CiovCkVtYmVyLnJlZHVjZUNvbXB1dGVkID0gZnVuY3Rpb24gKG9w
        dGlvbnMpIHsKICB2YXIgYXJnczsKCiAgaWYgKGFyZ3VtZW50cy5sZW5ndGgg
        PiAxKSB7CiAgICBhcmdzID0gYV9zbGljZS5jYWxsKGFyZ3VtZW50cywgMCwg
        LTEpOwogICAgb3B0aW9ucyA9IGFfc2xpY2UuY2FsbChhcmd1bWVudHMsIC0x
        KVswXTsKICB9CgogIGlmICh0eXBlb2Ygb3B0aW9ucyAhPT0gIm9iamVjdCIp
        IHsKICAgIHRocm93IG5ldyBFbWJlci5FcnJvcigiUmVkdWNlIENvbXB1dGVk
        IFByb3BlcnR5IGRlY2xhcmVkIHdpdGhvdXQgYW4gb3B0aW9ucyBoYXNoIik7
        CiAgfQoKICBpZiAoISgnaW5pdGlhbFZhbHVlJyBpbiBvcHRpb25zKSkgewog
        ICAgdGhyb3cgbmV3IEVtYmVyLkVycm9yKCJSZWR1Y2UgQ29tcHV0ZWQgUHJv
        cGVydHkgZGVjbGFyZWQgd2l0aG91dCBhbiBpbml0aWFsIHZhbHVlIik7CiAg
        fQoKICB2YXIgY3AgPSBuZXcgUmVkdWNlQ29tcHV0ZWRQcm9wZXJ0eShvcHRp
        b25zKTsKCiAgaWYgKGFyZ3MpIHsKICAgIGNwLnByb3BlcnR5LmFwcGx5KGNw
        LCBhcmdzKTsKICB9CgogIHJldHVybiBjcDsKfTsKCn0pKCk7CgoKCihmdW5j
        dGlvbigpIHsKdmFyIFJlZHVjZUNvbXB1dGVkUHJvcGVydHkgPSBFbWJlci5S
        ZWR1Y2VDb21wdXRlZFByb3BlcnR5LAogICAgYV9zbGljZSA9IFtdLnNsaWNl
        LAogICAgb19jcmVhdGUgPSBFbWJlci5jcmVhdGUsCiAgICBmb3JFYWNoID0g
        RW1iZXIuRW51bWVyYWJsZVV0aWxzLmZvckVhY2g7CgpmdW5jdGlvbiBBcnJh
        eUNvbXB1dGVkUHJvcGVydHkoKSB7CiAgdmFyIGNwID0gdGhpczsKCiAgUmVk
        dWNlQ29tcHV0ZWRQcm9wZXJ0eS5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwoK
        ICB0aGlzLmZ1bmMgPSAoZnVuY3Rpb24ocmVkdWNlRnVuYykgewogICAgcmV0
        dXJuIGZ1bmN0aW9uIChwcm9wZXJ0eU5hbWUpIHsKICAgICAgaWYgKCFjcC5f
        aGFzSW5zdGFuY2VNZXRhKHRoaXMsIHByb3BlcnR5TmFtZSkpIHsKICAgICAg
        ICAvLyBXaGVuIHdlIHJlY29tcHV0ZSBhbiBhcnJheSBjb21wdXRlZCBwcm9w
        ZXJ0eSwgd2UgbmVlZCBhbHJlYWR5CiAgICAgICAgLy8gcmV0cmlldmVkIGFy
        cmF5cyB0byBiZSB1cGRhdGVkOyB3ZSBjYW4ndCBzaW1wbHkgZW1wdHkgdGhl
        IGNhY2hlIGFuZAogICAgICAgIC8vIGhvcGUgdGhlIGFycmF5IGlzIHJlLXJl
        dHJpZXZlZC4KICAgICAgICBmb3JFYWNoKGNwLl9kZXBlbmRlbnRLZXlzLCBm
        dW5jdGlvbihkZXBlbmRlbnRLZXkpIHsKICAgICAgICAgIEVtYmVyLmFkZE9i
        c2VydmVyKHRoaXMsIGRlcGVuZGVudEtleSwgZnVuY3Rpb24oKSB7CiAgICAg
        ICAgICAgIGNwLnJlY29tcHV0ZU9uY2UuY2FsbCh0aGlzLCBwcm9wZXJ0eU5h
        bWUpOwogICAgICAgICAgfSk7CiAgICAgICAgfSwgdGhpcyk7CiAgICAgIH0K
        CiAgICAgIHJldHVybiByZWR1Y2VGdW5jLmFwcGx5KHRoaXMsIGFyZ3VtZW50
        cyk7CiAgICB9OwogIH0pKHRoaXMuZnVuYyk7CgogIHJldHVybiB0aGlzOwp9
        CkVtYmVyLkFycmF5Q29tcHV0ZWRQcm9wZXJ0eSA9IEFycmF5Q29tcHV0ZWRQ
        cm9wZXJ0eTsKQXJyYXlDb21wdXRlZFByb3BlcnR5LnByb3RvdHlwZSA9IG9f
        Y3JlYXRlKFJlZHVjZUNvbXB1dGVkUHJvcGVydHkucHJvdG90eXBlKTsKQXJy
        YXlDb21wdXRlZFByb3BlcnR5LnByb3RvdHlwZS5pbml0aWFsVmFsdWUgPSBm
        dW5jdGlvbiAoKSB7CiAgcmV0dXJuIEVtYmVyLkEoKTsKfTsKQXJyYXlDb21w
        dXRlZFByb3BlcnR5LnByb3RvdHlwZS5yZXNldFZhbHVlID0gZnVuY3Rpb24g
        KGFycmF5KSB7CiAgYXJyYXkuY2xlYXIoKTsKICByZXR1cm4gYXJyYXk7Cn07
        CgovKioKICBDcmVhdGVzIGEgY29tcHV0ZWQgcHJvcGVydHkgd2hpY2ggb3Bl
        cmF0ZXMgb24gZGVwZW5kZW50IGFycmF5cyBhbmQKICBpcyB1cGRhdGVkIHdp
        dGggIm9uZSBhdCBhIHRpbWUiIHNlbWFudGljcy4gV2hlbiBpdGVtcyBhcmUg
        YWRkZWQgb3IKICByZW1vdmVkIGZyb20gdGhlIGRlcGVuZGVudCBhcnJheShz
        KSBhbiBhcnJheSBjb21wdXRlZCBvbmx5IG9wZXJhdGVzCiAgb24gdGhlIGNo
        YW5nZSBpbnN0ZWFkIG9mIHJlLWV2YWx1YXRpbmcgdGhlIGVudGlyZSBhcnJh
        eS4gVGhpcyBzaG91bGQKICByZXR1cm4gYW4gYXJyYXksIGlmIHlvdSdkIGxp
        a2UgdG8gdXNlICJvbmUgYXQgYSB0aW1lIiBzZW1hbnRpY3MgYW5kCiAgY29t
        cHV0ZSBzb21lIHZhbHVlIG90aGVyIHRoZW4gYW4gYXJyYXkgbG9vayBhdAog
        IGBFbWJlci5yZWR1Y2VDb21wdXRlZGAuCgogIElmIHRoZXJlIGFyZSBtb3Jl
        IHRoYW4gb25lIGFyZ3VtZW50cyB0aGUgZmlyc3QgYXJndW1lbnRzIGFyZQog
        IGNvbnNpZGVyZWQgdG8gYmUgZGVwZW5kZW50IHByb3BlcnR5IGtleXMuIFRo
        ZSBsYXN0IGFyZ3VtZW50IGlzCiAgcmVxdWlyZWQgdG8gYmUgYW4gb3B0aW9u
        cyBvYmplY3QuIFRoZSBvcHRpb25zIG9iamVjdCBjYW4gaGF2ZSB0aGUKICBm
        b2xsb3dpbmcgdGhyZWUgcHJvcGVydGllcy4KCiAgYGluaXRpYWxpemVgIC0g
        QW4gb3B0aW9uYWwgaW5pdGlhbGl6ZSBmdW5jdGlvbi4gVHlwaWNhbGx5IHRo
        aXMgd2lsbCBiZSB1c2VkCiAgdG8gc2V0IHVwIHN0YXRlIG9uIHRoZSBpbnN0
        YW5jZU1ldGEgb2JqZWN0LgoKICBgcmVtb3ZlZEl0ZW1gIC0gQSBmdW5jdGlv
        biB0aGF0IGlzIGNhbGxlZCBlYWNoIHRpbWUgYW4gZWxlbWVudCBpcwogIHJl
        bW92ZWQgZnJvbSB0aGUgYXJyYXkuCgogIGBhZGRlZEl0ZW1gIC0gQSBmdW5j
        dGlvbiB0aGF0IGlzIGNhbGxlZCBlYWNoIHRpbWUgYW4gZWxlbWVudCBpcwog
        IGFkZGVkIHRvIHRoZSBhcnJheS4KCgogIFRoZSBgaW5pdGlhbGl6ZWAgZnVu
        Y3Rpb24gaGFzIHRoZSBmb2xsb3dpbmcgc2lnbmF0dXJlOgoKICBgYGBqYXZh
        c2NyaXB0CiAgIGZ1bmN0aW9uIChhcnJheSwgY2hhbmdlTWV0YSwgaW5zdGFu
        Y2VNZXRhKQogIGBgYAoKICBgYXJyYXlgIC0gVGhlIGluaXRpYWwgdmFsdWUg
        b2YgdGhlIGFycmF5Q29tcHV0ZWQsIGFuIGVtcHR5IGFycmF5LgoKICBgY2hh
        bmdlTWV0YWAgLSBBbiBvYmplY3Qgd2hpY2ggY29udGFpbnMgbWV0YSBpbmZv
        cm1hdGlvbiBhYm91dCB0aGUKICBjb21wdXRlZC4gSXQgY29udGFpbnMgdGhl
        IGZvbGxvd2luZyBwcm9wZXJ0aWVzOgoKICAgICAtIGBwcm9wZXJ0eWAgdGhl
        IGNvbXB1dGVkIHByb3BlcnR5CiAgICAgLSBgcHJvcGVydHlOYW1lYCB0aGUg
        bmFtZSBvZiB0aGUgcHJvcGVydHkgb24gdGhlIG9iamVjdAoKICBgaW5zdGFu
        Y2VNZXRhYCAtIEFuIG9iamVjdCB0aGF0IGNhbiBiZSB1c2VkIHRvIHN0b3Jl
        IG1ldGEKICBpbmZvcm1hdGlvbiBuZWVkZWQgZm9yIGNhbGN1bGF0aW5nIHlv
        dXIgY29tcHV0ZWQuIEZvciBleGFtcGxlIGEKICB1bmlxdWUgY29tcHV0ZWQg
        bWlnaHQgdXNlIHRoaXMgdG8gc3RvcmUgdGhlIG51bWJlciBvZiB0aW1lcyBh
        IGdpdmVuCiAgZWxlbWVudCBpcyBmb3VuZCBpbiB0aGUgZGVwZW5kZW50IGFy
        cmF5LgoKCiAgVGhlIGByZW1vdmVkSXRlbWAgYW5kIGBhZGRlZEl0ZW1gIGZ1
        bmN0aW9ucyBib3RoIGhhdmUgdGhlIGZvbGxvd2luZyBzaWduYXR1cmU6Cgog
        IGBgYGphdmFzY3JpcHQKICBmdW5jdGlvbiAoYWNjdW11bGF0ZWRWYWx1ZSwg
        aXRlbSwgY2hhbmdlTWV0YSwgaW5zdGFuY2VNZXRhKQogIGBgYAoKICBgYWNj
        dW11bGF0ZWRWYWx1ZWAgLSBUaGUgdmFsdWUgcmV0dXJuZWQgZnJvbSB0aGUg
        bGFzdCB0aW1lCiAgYHJlbW92ZWRJdGVtYCBvciBgYWRkZWRJdGVtYCB3YXMg
        Y2FsbGVkIG9yIGFuIGVtcHR5IGFycmF5LgoKICBgaXRlbWAgLSB0aGUgZWxl
        bWVudCBhZGRlZCBvciByZW1vdmVkIGZyb20gdGhlIGFycmF5CgogIGBjaGFu
        Z2VNZXRhYCAtIEFuIG9iamVjdCB3aGljaCBjb250YWlucyBtZXRhIGluZm9y
        bWF0aW9uIGFib3V0IHRoZQogIGNoYW5nZS4gSXQgY29udGFpbnMgdGhlIGZv
        bGxvd2luZyBwcm9wZXJ0aWVzOgoKICAgIC0gYHByb3BlcnR5YCB0aGUgY29t
        cHV0ZWQgcHJvcGVydHkKICAgIC0gYHByb3BlcnR5TmFtZWAgdGhlIG5hbWUg
        b2YgdGhlIHByb3BlcnR5IG9uIHRoZSBvYmplY3QKICAgIC0gYGluZGV4YCB0
        aGUgaW5kZXggb2YgdGhlIGFkZGVkIG9yIHJlbW92ZWQgaXRlbQogICAgLSBg
        aXRlbWAgdGhlIGFkZGVkIG9yIHJlbW92ZWQgaXRlbTogdGhpcyBpcyBleGFj
        dGx5IHRoZSBzYW1lIGFzCiAgICAgIHRoZSBzZWNvbmQgYXJnCiAgICAtIGBh
        cnJheUNoYW5nZWRgIHRoZSBhcnJheSB0aGF0IHRyaWdnZXJlZCB0aGUgY2hh
        bmdlLiBDYW4gYmUKICAgICAgdXNlZnVsIHdoZW4gZGVwZW5kaW5nIG9uIG11
        bHRpcGxlIGFycmF5cy4KCiAgRm9yIHByb3BlcnR5IGNoYW5nZXMgdHJpZ2dl
        cmVkIG9uIGFuIGl0ZW0gcHJvcGVydHkgY2hhbmdlICh3aGVuCiAgZGVwS2V5
        IGlzIHNvbWV0aGluZyBsaWtlIGBzb21lQXJyYXkuQGVhY2guc29tZVByb3Bl
        cnR5YCksCiAgYGNoYW5nZU1ldGFgIHdpbGwgYWxzbyBjb250YWluIHRoZSBm
        b2xsb3dpbmcgcHJvcGVydHk6CgogICAgLSBgcHJldmlvdXNWYWx1ZXNgIGFu
        IG9iamVjdCB3aG9zZSBrZXlzIGFyZSB0aGUgcHJvcGVydGllcyB0aGF0IGNo
        YW5nZWQgb24KICAgIHRoZSBpdGVtLCBhbmQgd2hvc2UgdmFsdWVzIGFyZSB0
        aGUgaXRlbSdzIHByZXZpb3VzIHZhbHVlcy4KCiAgYHByZXZpb3VzVmFsdWVz
        YCBpcyBpbXBvcnRhbnQgRW1iZXIgY29hbGVzY2VzIGl0ZW0gcHJvcGVydHkg
        Y2hhbmdlcyB2aWEKICBFbWJlci5ydW4ub25jZS4gVGhpcyBtZWFucyB0aGF0
        IGJ5IHRoZSB0aW1lIHJlbW92ZWRJdGVtIGdldHMgY2FsbGVkLCBpdGVtIGhh
        cwogIHRoZSBuZXcgdmFsdWVzLCBidXQgeW91IG1heSBuZWVkIHRoZSBwcmV2
        aW91cyB2YWx1ZSAoZWcgZm9yIHNvcnRpbmcgJgogIGZpbHRlcmluZykuCgog
        IGBpbnN0YW5jZU1ldGFgIC0gQW4gb2JqZWN0IHRoYXQgY2FuIGJlIHVzZWQg
        dG8gc3RvcmUgbWV0YQogIGluZm9ybWF0aW9uIG5lZWRlZCBmb3IgY2FsY3Vs
        YXRpbmcgeW91ciBjb21wdXRlZC4gRm9yIGV4YW1wbGUgYQogIHVuaXF1ZSBj
        b21wdXRlZCBtaWdodCB1c2UgdGhpcyB0byBzdG9yZSB0aGUgbnVtYmVyIG9m
        IHRpbWVzIGEgZ2l2ZW4KICBlbGVtZW50IGlzIGZvdW5kIGluIHRoZSBkZXBl
        bmRlbnQgYXJyYXkuCgogIFRoZSBgcmVtb3ZlZEl0ZW1gIGFuZCBgYWRkZWRJ
        dGVtYCBmdW5jdGlvbnMgc2hvdWxkIHJldHVybiB0aGUgYWNjdW11bGF0ZWQK
        ICB2YWx1ZS4gSXQgaXMgYWNjZXB0YWJsZSB0byBub3QgcmV0dXJuIGFueXRo
        aW5nIChpZSByZXR1cm4gdW5kZWZpbmVkKQogIHRvIGludmFsaWRhdGUgdGhl
        IGNvbXB1dGF0aW9uLiBUaGlzIGlzIGdlbmVyYWxseSBub3QgYSBnb29kIGlk
        ZWEgZm9yCiAgYXJyYXlDb21wdXRlZCBidXQgaXQncyB1c2VkIGluIGVnIG1h
        eCBhbmQgbWluLgoKICBFeGFtcGxlCgogIGBgYGphdmFzY3JpcHQKICBFbWJl
        ci5jb21wdXRlZC5tYXAgPSBmdW5jdGlvbihkZXBlbmRlbnRLZXksIGNhbGxi
        YWNrKSB7CiAgICB2YXIgb3B0aW9ucyA9IHsKICAgICAgYWRkZWRJdGVtOiBm
        dW5jdGlvbihhcnJheSwgaXRlbSwgY2hhbmdlTWV0YSwgaW5zdGFuY2VNZXRh
        KSB7CiAgICAgICAgdmFyIG1hcHBlZCA9IGNhbGxiYWNrKGl0ZW0pOwogICAg
        ICAgIGFycmF5Lmluc2VydEF0KGNoYW5nZU1ldGEuaW5kZXgsIG1hcHBlZCk7
        CiAgICAgICAgcmV0dXJuIGFycmF5OwogICAgICB9LAogICAgICByZW1vdmVk
        SXRlbTogZnVuY3Rpb24oYXJyYXksIGl0ZW0sIGNoYW5nZU1ldGEsIGluc3Rh
        bmNlTWV0YSkgewogICAgICAgIGFycmF5LnJlbW92ZUF0KGNoYW5nZU1ldGEu
        aW5kZXgsIDEpOwogICAgICAgIHJldHVybiBhcnJheTsKICAgICAgfQogICAg
        fTsKCiAgICByZXR1cm4gRW1iZXIuYXJyYXlDb21wdXRlZChkZXBlbmRlbnRL
        ZXksIG9wdGlvbnMpOwogIH07CiAgYGBgCgogIEBtZXRob2QgYXJyYXlDb21w
        dXRlZAogIEBmb3IgRW1iZXIKICBAcGFyYW0ge1N0cmluZ30gW2RlcGVuZGVu
        dEtleXMqXQogIEBwYXJhbSB7T2JqZWN0fSBvcHRpb25zCiAgQHJldHVybiB7
        RW1iZXIuQ29tcHV0ZWRQcm9wZXJ0eX0KKi8KRW1iZXIuYXJyYXlDb21wdXRl
        ZCA9IGZ1bmN0aW9uIChvcHRpb25zKSB7CiAgdmFyIGFyZ3M7CgogIGlmIChh
        cmd1bWVudHMubGVuZ3RoID4gMSkgewogICAgYXJncyA9IGFfc2xpY2UuY2Fs
        bChhcmd1bWVudHMsIDAsIC0xKTsKICAgIG9wdGlvbnMgPSBhX3NsaWNlLmNh
        bGwoYXJndW1lbnRzLCAtMSlbMF07CiAgfQoKICBpZiAodHlwZW9mIG9wdGlv
        bnMgIT09ICJvYmplY3QiKSB7CiAgICB0aHJvdyBuZXcgRW1iZXIuRXJyb3Io
        IkFycmF5IENvbXB1dGVkIFByb3BlcnR5IGRlY2xhcmVkIHdpdGhvdXQgYW4g
        b3B0aW9ucyBoYXNoIik7CiAgfQoKICB2YXIgY3AgPSBuZXcgQXJyYXlDb21w
        dXRlZFByb3BlcnR5KG9wdGlvbnMpOwoKICBpZiAoYXJncykgewogICAgY3Au
        cHJvcGVydHkuYXBwbHkoY3AsIGFyZ3MpOwogIH0KCiAgcmV0dXJuIGNwOwp9
        OwoKfSkoKTsKCgoKKGZ1bmN0aW9uKCkgewovKioKQG1vZHVsZSBlbWJlcgpA
        c3VibW9kdWxlIGVtYmVyLXJ1bnRpbWUKKi8KCnZhciBnZXQgPSBFbWJlci5n
        ZXQsCiAgICBzZXQgPSBFbWJlci5zZXQsCiAgICBndWlkRm9yID0gRW1iZXIu
        Z3VpZEZvciwKICAgIG1lcmdlID0gRW1iZXIubWVyZ2UsCiAgICBhX3NsaWNl
        ID0gW10uc2xpY2UsCiAgICBmb3JFYWNoID0gRW1iZXIuRW51bWVyYWJsZVV0
        aWxzLmZvckVhY2gsCiAgICBtYXAgPSBFbWJlci5FbnVtZXJhYmxlVXRpbHMu
        bWFwOwoKLyoqCiAgQSBjb21wdXRlZCBwcm9wZXJ0eSB0aGF0IGNhbGN1bGF0
        ZXMgdGhlIG1heGltdW0gdmFsdWUgaW4gdGhlCiAgZGVwZW5kZW50IGFycmF5
        LiBUaGlzIHdpbGwgcmV0dXJuIGAtSW5maW5pdHlgIHdoZW4gdGhlIGRlcGVu
        ZGVudAogIGFycmF5IGlzIGVtcHR5LgoKICBFeGFtcGxlCgogIGBgYGphdmFz
        Y3JpcHQKICBBcHAuUGVyc29uID0gRW1iZXIuT2JqZWN0LmV4dGVuZCh7CiAg
        ICBjaGlsZEFnZXM6IEVtYmVyLmNvbXB1dGVkLm1hcEJ5KCdjaGlsZHJlbics
        ICdhZ2UnKSwKICAgIG1heENoaWxkQWdlOiBFbWJlci5jb21wdXRlZC5tYXgo
        J2NoaWxkQWdlcycpCiAgfSk7CgogIHZhciBsb3JkQnlyb24gPSBBcHAuUGVy
        c29uLmNyZWF0ZSh7Y2hpbGRyZW46IFtdfSk7CiAgbG9yZEJ5cm9uLmdldCgn
        bWF4Q2hpbGRBZ2UnKTsgLy8gLUluZmluaXR5CiAgbG9yZEJ5cm9uLmdldCgn
        Y2hpbGRyZW4nKS5wdXNoT2JqZWN0KHtuYW1lOiAnQXVndXN0YSBBZGEgQnly
        b24nLCBhZ2U6IDd9KTsKICBsb3JkQnlyb24uZ2V0KCdtYXhDaGlsZEFnZScp
        OyAvLyA3CiAgbG9yZEJ5cm9uLmdldCgnY2hpbGRyZW4nKS5wdXNoT2JqZWN0
        cyhbe25hbWU6ICdBbGxlZ3JhIEJ5cm9uJywgYWdlOiA1fSwge25hbWU6ICdF
        bGl6YWJldGggTWVkb3JhIExlaWdoJywgYWdlOiA4fV0pOwogIGxvcmRCeXJv
        bi5nZXQoJ21heENoaWxkQWdlJyk7IC8vIDgKICBgYGAKCiAgQG1ldGhvZCBj
        b21wdXRlZC5tYXgKICBAZm9yIEVtYmVyCiAgQHBhcmFtIHtTdHJpbmd9IGRl
        cGVuZGVudEtleQogIEByZXR1cm4ge0VtYmVyLkNvbXB1dGVkUHJvcGVydHl9
        IGNvbXB1dGVzIHRoZSBsYXJnZXN0IHZhbHVlIGluIHRoZSBkZXBlbmRlbnRL
        ZXkncyBhcnJheQoqLwpFbWJlci5jb21wdXRlZC5tYXggPSBmdW5jdGlvbiAo
        ZGVwZW5kZW50S2V5KSB7CiAgcmV0dXJuIEVtYmVyLnJlZHVjZUNvbXB1dGVk
        LmNhbGwobnVsbCwgZGVwZW5kZW50S2V5LCB7CiAgICBpbml0aWFsVmFsdWU6
        IC1JbmZpbml0eSwKCiAgICBhZGRlZEl0ZW06IGZ1bmN0aW9uIChhY2N1bXVs
        YXRlZFZhbHVlLCBpdGVtLCBjaGFuZ2VNZXRhLCBpbnN0YW5jZU1ldGEpIHsK
        ICAgICAgcmV0dXJuIE1hdGgubWF4KGFjY3VtdWxhdGVkVmFsdWUsIGl0ZW0p
        OwogICAgfSwKCiAgICByZW1vdmVkSXRlbTogZnVuY3Rpb24gKGFjY3VtdWxh
        dGVkVmFsdWUsIGl0ZW0sIGNoYW5nZU1ldGEsIGluc3RhbmNlTWV0YSkgewog
        ICAgICBpZiAoaXRlbSA8IGFjY3VtdWxhdGVkVmFsdWUpIHsKICAgICAgICBy
        ZXR1cm4gYWNjdW11bGF0ZWRWYWx1ZTsKICAgICAgfQogICAgfQogIH0pOwp9
        OwoKLyoqCiAgQSBjb21wdXRlZCBwcm9wZXJ0eSB0aGF0IGNhbGN1bGF0ZXMg
        dGhlIG1pbmltdW0gdmFsdWUgaW4gdGhlCiAgZGVwZW5kZW50IGFycmF5LiBU
        aGlzIHdpbGwgcmV0dXJuIGBJbmZpbml0eWAgd2hlbiB0aGUgZGVwZW5kZW50
        CiAgYXJyYXkgaXMgZW1wdHkuCgogIEV4YW1wbGUKCiAgYGBgamF2YXNjcmlw
        dAogIEFwcC5QZXJzb24gPSBFbWJlci5PYmplY3QuZXh0ZW5kKHsKICAgIGNo
        aWxkQWdlczogRW1iZXIuY29tcHV0ZWQubWFwQnkoJ2NoaWxkcmVuJywgJ2Fn
        ZScpLAogICAgbWluQ2hpbGRBZ2U6IEVtYmVyLmNvbXB1dGVkLm1pbignY2hp
        bGRBZ2VzJykKICB9KTsKCiAgdmFyIGxvcmRCeXJvbiA9IEFwcC5QZXJzb24u
        Y3JlYXRlKHtjaGlsZHJlbjogW119KTsKICBsb3JkQnlyb24uZ2V0KCdtaW5D
        aGlsZEFnZScpOyAvLyBJbmZpbml0eQogIGxvcmRCeXJvbi5nZXQoJ2NoaWxk
        cmVuJykucHVzaE9iamVjdCh7bmFtZTogJ0F1Z3VzdGEgQWRhIEJ5cm9uJywg
        YWdlOiA3fSk7CiAgbG9yZEJ5cm9uLmdldCgnbWluQ2hpbGRBZ2UnKTsgLy8g
        NwogIGxvcmRCeXJvbi5nZXQoJ2NoaWxkcmVuJykucHVzaE9iamVjdHMoW3tu
        YW1lOiAnQWxsZWdyYSBCeXJvbicsIGFnZTogNX0sIHtuYW1lOiAnRWxpemFi
        ZXRoIE1lZG9yYSBMZWlnaCcsIGFnZTogOH1dKTsKICBsb3JkQnlyb24uZ2V0
        KCdtaW5DaGlsZEFnZScpOyAvLyA1CiAgYGBgCgogIEBtZXRob2QgY29tcHV0
        ZWQubWluCiAgQGZvciBFbWJlcgogIEBwYXJhbSB7U3RyaW5nfSBkZXBlbmRl
        bnRLZXkKICBAcmV0dXJuIHtFbWJlci5Db21wdXRlZFByb3BlcnR5fSBjb21w
        dXRlcyB0aGUgc21hbGxlc3QgdmFsdWUgaW4gdGhlIGRlcGVuZGVudEtleSdz
        IGFycmF5CiovCkVtYmVyLmNvbXB1dGVkLm1pbiA9IGZ1bmN0aW9uIChkZXBl
        bmRlbnRLZXkpIHsKICByZXR1cm4gRW1iZXIucmVkdWNlQ29tcHV0ZWQuY2Fs
        bChudWxsLCBkZXBlbmRlbnRLZXksIHsKICAgIGluaXRpYWxWYWx1ZTogSW5m
        aW5pdHksCgogICAgYWRkZWRJdGVtOiBmdW5jdGlvbiAoYWNjdW11bGF0ZWRW
        YWx1ZSwgaXRlbSwgY2hhbmdlTWV0YSwgaW5zdGFuY2VNZXRhKSB7CiAgICAg
        IHJldHVybiBNYXRoLm1pbihhY2N1bXVsYXRlZFZhbHVlLCBpdGVtKTsKICAg
        IH0sCgogICAgcmVtb3ZlZEl0ZW06IGZ1bmN0aW9uIChhY2N1bXVsYXRlZFZh
        bHVlLCBpdGVtLCBjaGFuZ2VNZXRhLCBpbnN0YW5jZU1ldGEpIHsKICAgICAg
        aWYgKGl0ZW0gPiBhY2N1bXVsYXRlZFZhbHVlKSB7CiAgICAgICAgcmV0dXJu
        IGFjY3VtdWxhdGVkVmFsdWU7CiAgICAgIH0KICAgIH0KICB9KTsKfTsKCi8q
        KgogIFJldHVybnMgYW4gYXJyYXkgbWFwcGVkIHZpYSB0aGUgY2FsbGJhY2sK
        CiAgVGhlIGNhbGxiYWNrIG1ldGhvZCB5b3UgcHJvdmlkZSBzaG91bGQgaGF2
        ZSB0aGUgZm9sbG93aW5nIHNpZ25hdHVyZToKCiAgYGBgamF2YXNjcmlwdAog
        IGZ1bmN0aW9uKGl0ZW0pOwogIGBgYAoKICAtIGBpdGVtYCBpcyB0aGUgY3Vy
        cmVudCBpdGVtIGluIHRoZSBpdGVyYXRpb24uCgogIEV4YW1wbGUKCiAgYGBg
        amF2YXNjcmlwdAogIEFwcC5IYW1wc3RlciA9IEVtYmVyLk9iamVjdC5leHRl
        bmQoewogICAgZXhjaXRpbmdDaG9yZXM6IEVtYmVyLmNvbXB1dGVkLm1hcCgn
        Y2hvcmVzJywgZnVuY3Rpb24oY2hvcmUpIHsKICAgICAgcmV0dXJuIGNob3Jl
        LnRvVXBwZXJDYXNlKCkgKyAnISc7CiAgICB9KQogIH0pOwoKICB2YXIgaGFt
        cHN0ZXIgPSBBcHAuSGFtcHN0ZXIuY3JlYXRlKHtjaG9yZXM6IFsnY29vaycs
        ICdjbGVhbicsICd3cml0ZSBtb3JlIHVuaXQgdGVzdHMnXX0pOwogIGhhbXBz
        dGVyLmdldCgnZXhjaXRpbmdDaG9yZXMnKTsgLy8gWydDT09LIScsICdDTEVB
        TiEnLCAnV1JJVEUgTU9SRSBVTklUIFRFU1RTISddCiAgYGBgCgogIEBtZXRo
        b2QgY29tcHV0ZWQubWFwCiAgQGZvciBFbWJlcgogIEBwYXJhbSB7U3RyaW5n
        fSBkZXBlbmRlbnRLZXkKICBAcGFyYW0ge0Z1bmN0aW9ufSBjYWxsYmFjawog
        IEByZXR1cm4ge0VtYmVyLkNvbXB1dGVkUHJvcGVydHl9IGFuIGFycmF5IG1h
        cHBlZCB2aWEgdGhlIGNhbGxiYWNrCiovCkVtYmVyLmNvbXB1dGVkLm1hcCA9
        IGZ1bmN0aW9uKGRlcGVuZGVudEtleSwgY2FsbGJhY2spIHsKICB2YXIgb3B0
        aW9ucyA9IHsKICAgIGFkZGVkSXRlbTogZnVuY3Rpb24oYXJyYXksIGl0ZW0s
        IGNoYW5nZU1ldGEsIGluc3RhbmNlTWV0YSkgewogICAgICB2YXIgbWFwcGVk
        ID0gY2FsbGJhY2suY2FsbCh0aGlzLCBpdGVtKTsKICAgICAgYXJyYXkuaW5z
        ZXJ0QXQoY2hhbmdlTWV0YS5pbmRleCwgbWFwcGVkKTsKICAgICAgcmV0dXJu
        IGFycmF5OwogICAgfSwKICAgIHJlbW92ZWRJdGVtOiBmdW5jdGlvbihhcnJh
        eSwgaXRlbSwgY2hhbmdlTWV0YSwgaW5zdGFuY2VNZXRhKSB7CiAgICAgIGFy
        cmF5LnJlbW92ZUF0KGNoYW5nZU1ldGEuaW5kZXgsIDEpOwogICAgICByZXR1
        cm4gYXJyYXk7CiAgICB9CiAgfTsKCiAgcmV0dXJuIEVtYmVyLmFycmF5Q29t
        cHV0ZWQoZGVwZW5kZW50S2V5LCBvcHRpb25zKTsKfTsKCi8qKgogIFJldHVy
        bnMgYW4gYXJyYXkgbWFwcGVkIHRvIHRoZSBzcGVjaWZpZWQga2V5LgoKICBF
        eGFtcGxlCgogIGBgYGphdmFzY3JpcHQKICBBcHAuUGVyc29uID0gRW1iZXIu
        T2JqZWN0LmV4dGVuZCh7CiAgICBjaGlsZEFnZXM6IEVtYmVyLmNvbXB1dGVk
        Lm1hcEJ5KCdjaGlsZHJlbicsICdhZ2UnKQogIH0pOwoKICB2YXIgbG9yZEJ5
        cm9uID0gQXBwLlBlcnNvbi5jcmVhdGUoe2NoaWxkcmVuOiBbXX0pOwogIGxv
        cmRCeXJvbi5nZXQoJ2NoaWxkQWdlcycpOyAvLyBbXQogIGxvcmRCeXJvbi5n
        ZXQoJ2NoaWxkcmVuJykucHVzaE9iamVjdCh7bmFtZTogJ0F1Z3VzdGEgQWRh
        IEJ5cm9uJywgYWdlOiA3fSk7CiAgbG9yZEJ5cm9uLmdldCgnY2hpbGRBZ2Vz
        Jyk7IC8vIFs3XQogIGxvcmRCeXJvbi5nZXQoJ2NoaWxkcmVuJykucHVzaE9i
        amVjdHMoW3tuYW1lOiAnQWxsZWdyYSBCeXJvbicsIGFnZTogNX0sIHtuYW1l
        OiAnRWxpemFiZXRoIE1lZG9yYSBMZWlnaCcsIGFnZTogOH1dKTsKICBsb3Jk
        Qnlyb24uZ2V0KCdjaGlsZEFnZXMnKTsgLy8gWzcsIDUsIDhdCiAgYGBgCgog
        IEBtZXRob2QgY29tcHV0ZWQubWFwQnkKICBAZm9yIEVtYmVyCiAgQHBhcmFt
        IHtTdHJpbmd9IGRlcGVuZGVudEtleQogIEBwYXJhbSB7U3RyaW5nfSBwcm9w
        ZXJ0eUtleQogIEByZXR1cm4ge0VtYmVyLkNvbXB1dGVkUHJvcGVydHl9IGFu
        IGFycmF5IG1hcHBlZCB0byB0aGUgc3BlY2lmaWVkIGtleQoqLwpFbWJlci5j
        b21wdXRlZC5tYXBCeSA9IGZ1bmN0aW9uKGRlcGVuZGVudEtleSwgcHJvcGVy
        dHlLZXkpIHsKICB2YXIgY2FsbGJhY2sgPSBmdW5jdGlvbihpdGVtKSB7IHJl
        dHVybiBnZXQoaXRlbSwgcHJvcGVydHlLZXkpOyB9OwogIHJldHVybiBFbWJl
        ci5jb21wdXRlZC5tYXAoZGVwZW5kZW50S2V5ICsgJy5AZWFjaC4nICsgcHJv
        cGVydHlLZXksIGNhbGxiYWNrKTsKfTsKCi8qKgogIEBtZXRob2QgY29tcHV0
        ZWQubWFwUHJvcGVydHkKICBAZm9yIEVtYmVyCiAgQGRlcHJlY2F0ZWQgVXNl
        IGBFbWJlci5jb21wdXRlZC5tYXBCeWAgaW5zdGVhZAogIEBwYXJhbSBkZXBl
        bmRlbnRLZXkKICBAcGFyYW0gcHJvcGVydHlLZXkKKi8KRW1iZXIuY29tcHV0
        ZWQubWFwUHJvcGVydHkgPSBFbWJlci5jb21wdXRlZC5tYXBCeTsKCi8qKgog
        IEZpbHRlcnMgdGhlIGFycmF5IGJ5IHRoZSBjYWxsYmFjay4KCiAgVGhlIGNh
        bGxiYWNrIG1ldGhvZCB5b3UgcHJvdmlkZSBzaG91bGQgaGF2ZSB0aGUgZm9s
        bG93aW5nIHNpZ25hdHVyZToKCiAgYGBgamF2YXNjcmlwdAogIGZ1bmN0aW9u
        KGl0ZW0pOwogIGBgYAoKICAtIGBpdGVtYCBpcyB0aGUgY3VycmVudCBpdGVt
        IGluIHRoZSBpdGVyYXRpb24uCgogIEV4YW1wbGUKCiAgYGBgamF2YXNjcmlw
        dAogIEFwcC5IYW1wc3RlciA9IEVtYmVyLk9iamVjdC5leHRlbmQoewogICAg
        cmVtYWluaW5nQ2hvcmVzOiBFbWJlci5jb21wdXRlZC5maWx0ZXIoJ2Nob3Jl
        cycsIGZ1bmN0aW9uKGNob3JlKSB7CiAgICAgIHJldHVybiAhY2hvcmUuZG9u
        ZTsKICAgIH0pCiAgfSk7CgogIHZhciBoYW1wc3RlciA9IEFwcC5IYW1wc3Rl
        ci5jcmVhdGUoe2Nob3JlczogWwogICAge25hbWU6ICdjb29rJywgZG9uZTog
        dHJ1ZX0sCiAgICB7bmFtZTogJ2NsZWFuJywgZG9uZTogdHJ1ZX0sCiAgICB7
        bmFtZTogJ3dyaXRlIG1vcmUgdW5pdCB0ZXN0cycsIGRvbmU6IGZhbHNlfQog
        IF19KTsKICBoYW1wc3Rlci5nZXQoJ3JlbWFpbmluZ0Nob3JlcycpOyAvLyBb
        e25hbWU6ICd3cml0ZSBtb3JlIHVuaXQgdGVzdHMnLCBkb25lOiBmYWxzZX1d
        CiAgYGBgCgogIEBtZXRob2QgY29tcHV0ZWQuZmlsdGVyCiAgQGZvciBFbWJl
        cgogIEBwYXJhbSB7U3RyaW5nfSBkZXBlbmRlbnRLZXkKICBAcGFyYW0ge0Z1
        bmN0aW9ufSBjYWxsYmFjawogIEByZXR1cm4ge0VtYmVyLkNvbXB1dGVkUHJv
        cGVydHl9IHRoZSBmaWx0ZXJlZCBhcnJheQoqLwpFbWJlci5jb21wdXRlZC5m
        aWx0ZXIgPSBmdW5jdGlvbihkZXBlbmRlbnRLZXksIGNhbGxiYWNrKSB7CiAg
        dmFyIG9wdGlvbnMgPSB7CiAgICBpbml0aWFsaXplOiBmdW5jdGlvbiAoYXJy
        YXksIGNoYW5nZU1ldGEsIGluc3RhbmNlTWV0YSkgewogICAgICBpbnN0YW5j
        ZU1ldGEuZmlsdGVyZWRBcnJheUluZGV4ZXMgPSBuZXcgRW1iZXIuU3ViQXJy
        YXkoKTsKICAgIH0sCgogICAgYWRkZWRJdGVtOiBmdW5jdGlvbihhcnJheSwg
        aXRlbSwgY2hhbmdlTWV0YSwgaW5zdGFuY2VNZXRhKSB7CiAgICAgIHZhciBt
        YXRjaCA9ICEhY2FsbGJhY2suY2FsbCh0aGlzLCBpdGVtKSwKICAgICAgICAg
        IGZpbHRlckluZGV4ID0gaW5zdGFuY2VNZXRhLmZpbHRlcmVkQXJyYXlJbmRl
        eGVzLmFkZEl0ZW0oY2hhbmdlTWV0YS5pbmRleCwgbWF0Y2gpOwoKICAgICAg
        aWYgKG1hdGNoKSB7CiAgICAgICAgYXJyYXkuaW5zZXJ0QXQoZmlsdGVySW5k
        ZXgsIGl0ZW0pOwogICAgICB9CgogICAgICByZXR1cm4gYXJyYXk7CiAgICB9
        LAoKICAgIHJlbW92ZWRJdGVtOiBmdW5jdGlvbihhcnJheSwgaXRlbSwgY2hh
        bmdlTWV0YSwgaW5zdGFuY2VNZXRhKSB7CiAgICAgIHZhciBmaWx0ZXJJbmRl
        eCA9IGluc3RhbmNlTWV0YS5maWx0ZXJlZEFycmF5SW5kZXhlcy5yZW1vdmVJ
        dGVtKGNoYW5nZU1ldGEuaW5kZXgpOwoKICAgICAgaWYgKGZpbHRlckluZGV4
        ID4gLTEpIHsKICAgICAgICBhcnJheS5yZW1vdmVBdChmaWx0ZXJJbmRleCk7
        CiAgICAgIH0KCiAgICAgIHJldHVybiBhcnJheTsKICAgIH0KICB9OwoKICBy
        ZXR1cm4gRW1iZXIuYXJyYXlDb21wdXRlZChkZXBlbmRlbnRLZXksIG9wdGlv
        bnMpOwp9OwoKLyoqCiAgRmlsdGVycyB0aGUgYXJyYXkgYnkgdGhlIHByb3Bl
        cnR5IGFuZCB2YWx1ZQoKICBFeGFtcGxlCgogIGBgYGphdmFzY3JpcHQKICBB
        cHAuSGFtcHN0ZXIgPSBFbWJlci5PYmplY3QuZXh0ZW5kKHsKICAgIHJlbWFp
        bmluZ0Nob3JlczogRW1iZXIuY29tcHV0ZWQuZmlsdGVyQnkoJ2Nob3Jlcycs
        ICdkb25lJywgZmFsc2UpCiAgfSk7CgogIHZhciBoYW1wc3RlciA9IEFwcC5I
        YW1wc3Rlci5jcmVhdGUoe2Nob3JlczogWwogICAge25hbWU6ICdjb29rJywg
        ZG9uZTogdHJ1ZX0sCiAgICB7bmFtZTogJ2NsZWFuJywgZG9uZTogdHJ1ZX0s
        CiAgICB7bmFtZTogJ3dyaXRlIG1vcmUgdW5pdCB0ZXN0cycsIGRvbmU6IGZh
        bHNlfQogIF19KTsKICBoYW1wc3Rlci5nZXQoJ3JlbWFpbmluZ0Nob3Jlcycp
        OyAvLyBbe25hbWU6ICd3cml0ZSBtb3JlIHVuaXQgdGVzdHMnLCBkb25lOiBm
        YWxzZX1dCiAgYGBgCgogIEBtZXRob2QgY29tcHV0ZWQuZmlsdGVyQnkKICBA
        Zm9yIEVtYmVyCiAgQHBhcmFtIHtTdHJpbmd9IGRlcGVuZGVudEtleQogIEBw
        YXJhbSB7U3RyaW5nfSBwcm9wZXJ0eUtleQogIEBwYXJhbSB7U3RyaW5nfSB2
        YWx1ZQogIEByZXR1cm4ge0VtYmVyLkNvbXB1dGVkUHJvcGVydHl9IHRoZSBm
        aWx0ZXJlZCBhcnJheQoqLwpFbWJlci5jb21wdXRlZC5maWx0ZXJCeSA9IGZ1
        bmN0aW9uKGRlcGVuZGVudEtleSwgcHJvcGVydHlLZXksIHZhbHVlKSB7CiAg
        dmFyIGNhbGxiYWNrOwoKICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMikg
        ewogICAgY2FsbGJhY2sgPSBmdW5jdGlvbihpdGVtKSB7CiAgICAgIHJldHVy
        biBnZXQoaXRlbSwgcHJvcGVydHlLZXkpOwogICAgfTsKICB9IGVsc2Ugewog
        ICAgY2FsbGJhY2sgPSBmdW5jdGlvbihpdGVtKSB7CiAgICAgIHJldHVybiBn
        ZXQoaXRlbSwgcHJvcGVydHlLZXkpID09PSB2YWx1ZTsKICAgIH07CiAgfQoK
        ICByZXR1cm4gRW1iZXIuY29tcHV0ZWQuZmlsdGVyKGRlcGVuZGVudEtleSAr
        ICcuQGVhY2guJyArIHByb3BlcnR5S2V5LCBjYWxsYmFjayk7Cn07CgovKioK
        ICBAbWV0aG9kIGNvbXB1dGVkLmZpbHRlclByb3BlcnR5CiAgQGZvciBFbWJl
        cgogIEBwYXJhbSBkZXBlbmRlbnRLZXkKICBAcGFyYW0gcHJvcGVydHlLZXkK
        ICBAcGFyYW0gdmFsdWUKICBAZGVwcmVjYXRlZCBVc2UgYEVtYmVyLmNvbXB1
        dGVkLmZpbHRlckJ5YCBpbnN0ZWFkCiovCkVtYmVyLmNvbXB1dGVkLmZpbHRl
        clByb3BlcnR5ID0gRW1iZXIuY29tcHV0ZWQuZmlsdGVyQnk7CgovKioKICBB
        IGNvbXB1dGVkIHByb3BlcnR5IHdoaWNoIHJldHVybnMgYSBuZXcgYXJyYXkg
        d2l0aCBhbGwgdGhlIHVuaXF1ZQogIGVsZW1lbnRzIGZyb20gb25lIG9yIG1v
        cmUgZGVwZW5kZW50IGFycmF5cy4KCiAgRXhhbXBsZQoKICBgYGBqYXZhc2Ny
        aXB0CiAgQXBwLkhhbXBzdGVyID0gRW1iZXIuT2JqZWN0LmV4dGVuZCh7CiAg
        ICB1bmlxdWVGcnVpdHM6IEVtYmVyLmNvbXB1dGVkLnVuaXEoJ2ZydWl0cycp
        CiAgfSk7CgogIHZhciBoYW1wc3RlciA9IEFwcC5IYW1wc3Rlci5jcmVhdGUo
        e2ZydWl0czogWwogICAgJ2JhbmFuYScsCiAgICAnZ3JhcGUnLAogICAgJ2th
        bGUnLAogICAgJ2JhbmFuYScKICBdfSk7CiAgaGFtcHN0ZXIuZ2V0KCd1bmlx
        dWVGcnVpdHMnKTsgLy8gWydiYW5hbmEnLCAnZ3JhcGUnLCAna2FsZSddCiAg
        YGBgCgogIEBtZXRob2QgY29tcHV0ZWQudW5pcQogIEBmb3IgRW1iZXIKICBA
        cGFyYW0ge1N0cmluZ30gcHJvcGVydHlLZXkqCiAgQHJldHVybiB7RW1iZXIu
        Q29tcHV0ZWRQcm9wZXJ0eX0gY29tcHV0ZXMgYSBuZXcgYXJyYXkgd2l0aCBh
        bGwgdGhlCiAgdW5pcXVlIGVsZW1lbnRzIGZyb20gdGhlIGRlcGVuZGVudCBh
        cnJheQoqLwpFbWJlci5jb21wdXRlZC51bmlxID0gZnVuY3Rpb24oKSB7CiAg
        dmFyIGFyZ3MgPSBhX3NsaWNlLmNhbGwoYXJndW1lbnRzKTsKICBhcmdzLnB1
        c2goewogICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24oYXJyYXksIGNoYW5nZU1l
        dGEsIGluc3RhbmNlTWV0YSkgewogICAgICBpbnN0YW5jZU1ldGEuaXRlbUNv
        dW50cyA9IHt9OwogICAgfSwKCiAgICBhZGRlZEl0ZW06IGZ1bmN0aW9uKGFy
        cmF5LCBpdGVtLCBjaGFuZ2VNZXRhLCBpbnN0YW5jZU1ldGEpIHsKICAgICAg
        dmFyIGd1aWQgPSBndWlkRm9yKGl0ZW0pOwoKICAgICAgaWYgKCFpbnN0YW5j
        ZU1ldGEuaXRlbUNvdW50c1tndWlkXSkgewogICAgICAgIGluc3RhbmNlTWV0
        YS5pdGVtQ291bnRzW2d1aWRdID0gMTsKICAgICAgfSBlbHNlIHsKICAgICAg
        ICArK2luc3RhbmNlTWV0YS5pdGVtQ291bnRzW2d1aWRdOwogICAgICB9CiAg
        ICAgIGFycmF5LmFkZE9iamVjdChpdGVtKTsKICAgICAgcmV0dXJuIGFycmF5
        OwogICAgfSwKICAgIHJlbW92ZWRJdGVtOiBmdW5jdGlvbihhcnJheSwgaXRl
        bSwgXywgaW5zdGFuY2VNZXRhKSB7CiAgICAgIHZhciBndWlkID0gZ3VpZEZv
        cihpdGVtKSwKICAgICAgICAgIGl0ZW1Db3VudHMgPSBpbnN0YW5jZU1ldGEu
        aXRlbUNvdW50czsKCiAgICAgIGlmICgtLWl0ZW1Db3VudHNbZ3VpZF0gPT09
        IDApIHsKICAgICAgICBhcnJheS5yZW1vdmVPYmplY3QoaXRlbSk7CiAgICAg
        IH0KICAgICAgcmV0dXJuIGFycmF5OwogICAgfQogIH0pOwogIHJldHVybiBF
        bWJlci5hcnJheUNvbXB1dGVkLmFwcGx5KG51bGwsIGFyZ3MpOwp9OwoKLyoq
        CiAgQWxpYXMgZm9yIFtFbWJlci5jb21wdXRlZC51bmlxXSgvYXBpLyNtZXRo
        b2RfY29tcHV0ZWRfdW5pcSkuCgogIEBtZXRob2QgY29tcHV0ZWQudW5pb24K
        ICBAZm9yIEVtYmVyCiAgQHBhcmFtIHtTdHJpbmd9IHByb3BlcnR5S2V5Kgog
        IEByZXR1cm4ge0VtYmVyLkNvbXB1dGVkUHJvcGVydHl9IGNvbXB1dGVzIGEg
        bmV3IGFycmF5IHdpdGggYWxsIHRoZQogIHVuaXF1ZSBlbGVtZW50cyBmcm9t
        IHRoZSBkZXBlbmRlbnQgYXJyYXkKKi8KRW1iZXIuY29tcHV0ZWQudW5pb24g
        PSBFbWJlci5jb21wdXRlZC51bmlxOwoKLyoqCiAgQSBjb21wdXRlZCBwcm9w
        ZXJ0eSB3aGljaCByZXR1cm5zIGEgbmV3IGFycmF5IHdpdGggYWxsIHRoZSBk
        dXBsaWNhdGVkCiAgZWxlbWVudHMgZnJvbSB0d28gb3IgbW9yZSBkZXBlbmRl
        bnkgYXJyYXlzLgoKICBFeGFtcGxlCgogIGBgYGphdmFzY3JpcHQKICB2YXIg
        b2JqID0gRW1iZXIuT2JqZWN0LmNyZWF0ZVdpdGhNaXhpbnMoewogICAgYWRh
        RnJpZW5kczogWydDaGFybGVzIEJhYmJhZ2UnLCAnSm9obiBIb2Job3VzZScs
        ICdXaWxsaWFtIEtpbmcnLCAnTWFyeSBTb21lcnZpbGxlJ10sCiAgICBjaGFy
        bGVzRnJpZW5kczogWydXaWxsaWFtIEtpbmcnLCAnTWFyeSBTb21lcnZpbGxl
        JywgJ0FkYSBMb3ZlbGFjZScsICdHZW9yZ2UgUGVhY29jayddLAogICAgZnJp
        ZW5kc0luQ29tbW9uOiBFbWJlci5jb21wdXRlZC5pbnRlcnNlY3QoJ2FkYUZy
        aWVuZHMnLCAnY2hhcmxlc0ZyaWVuZHMnKQogIH0pOwoKICBvYmouZ2V0KCdm
        cmllbmRzSW5Db21tb24nKTsgLy8gWydXaWxsaWFtIEtpbmcnLCAnTWFyeSBT
        b21lcnZpbGxlJ10KICBgYGAKCiAgQG1ldGhvZCBjb21wdXRlZC5pbnRlcnNl
        Y3QKICBAZm9yIEVtYmVyCiAgQHBhcmFtIHtTdHJpbmd9IHByb3BlcnR5S2V5
        KgogIEByZXR1cm4ge0VtYmVyLkNvbXB1dGVkUHJvcGVydHl9IGNvbXB1dGVz
        IGEgbmV3IGFycmF5IHdpdGggYWxsIHRoZQogIGR1cGxpY2F0ZWQgZWxlbWVu
        dHMgZnJvbSB0aGUgZGVwZW5kZW50IGFycmF5cwoqLwpFbWJlci5jb21wdXRl
        ZC5pbnRlcnNlY3QgPSBmdW5jdGlvbiAoKSB7CiAgdmFyIGdldERlcGVuZGVu
        dEtleUd1aWRzID0gZnVuY3Rpb24gKGNoYW5nZU1ldGEpIHsKICAgIHJldHVy
        biBtYXAoY2hhbmdlTWV0YS5wcm9wZXJ0eS5fZGVwZW5kZW50S2V5cywgZnVu
        Y3Rpb24gKGRlcGVuZGVudEtleSkgewogICAgICByZXR1cm4gZ3VpZEZvcihk
        ZXBlbmRlbnRLZXkpOwogICAgfSk7CiAgfTsKCiAgdmFyIGFyZ3MgPSBhX3Ns
        aWNlLmNhbGwoYXJndW1lbnRzKTsKICBhcmdzLnB1c2goewogICAgaW5pdGlh
        bGl6ZTogZnVuY3Rpb24gKGFycmF5LCBjaGFuZ2VNZXRhLCBpbnN0YW5jZU1l
        dGEpIHsKICAgICAgaW5zdGFuY2VNZXRhLml0ZW1Db3VudHMgPSB7fTsKICAg
        IH0sCgogICAgYWRkZWRJdGVtOiBmdW5jdGlvbihhcnJheSwgaXRlbSwgY2hh
        bmdlTWV0YSwgaW5zdGFuY2VNZXRhKSB7CiAgICAgIHZhciBpdGVtR3VpZCA9
        IGd1aWRGb3IoaXRlbSksCiAgICAgICAgICBkZXBlbmRlbnRHdWlkcyA9IGdl
        dERlcGVuZGVudEtleUd1aWRzKGNoYW5nZU1ldGEpLAogICAgICAgICAgZGVw
        ZW5kZW50R3VpZCA9IGd1aWRGb3IoY2hhbmdlTWV0YS5hcnJheUNoYW5nZWQp
        LAogICAgICAgICAgbnVtYmVyT2ZEZXBlbmRlbnRBcnJheXMgPSBjaGFuZ2VN
        ZXRhLnByb3BlcnR5Ll9kZXBlbmRlbnRLZXlzLmxlbmd0aCwKICAgICAgICAg
        IGl0ZW1Db3VudHMgPSBpbnN0YW5jZU1ldGEuaXRlbUNvdW50czsKCiAgICAg
        IGlmICghaXRlbUNvdW50c1tpdGVtR3VpZF0pIHsgaXRlbUNvdW50c1tpdGVt
        R3VpZF0gPSB7fTsgfQogICAgICBpZiAoaXRlbUNvdW50c1tpdGVtR3VpZF1b
        ZGVwZW5kZW50R3VpZF0gPT09IHVuZGVmaW5lZCkgeyBpdGVtQ291bnRzW2l0
        ZW1HdWlkXVtkZXBlbmRlbnRHdWlkXSA9IDA7IH0KCiAgICAgIGlmICgrK2l0
        ZW1Db3VudHNbaXRlbUd1aWRdW2RlcGVuZGVudEd1aWRdID09PSAxICYmCiAg
        ICAgICAgICBudW1iZXJPZkRlcGVuZGVudEFycmF5cyA9PT0gRW1iZXIua2V5
        cyhpdGVtQ291bnRzW2l0ZW1HdWlkXSkubGVuZ3RoKSB7CgogICAgICAgIGFy
        cmF5LmFkZE9iamVjdChpdGVtKTsKICAgICAgfQogICAgICByZXR1cm4gYXJy
        YXk7CiAgICB9LAogICAgcmVtb3ZlZEl0ZW06IGZ1bmN0aW9uKGFycmF5LCBp
        dGVtLCBjaGFuZ2VNZXRhLCBpbnN0YW5jZU1ldGEpIHsKICAgICAgdmFyIGl0
        ZW1HdWlkID0gZ3VpZEZvcihpdGVtKSwKICAgICAgICAgIGRlcGVuZGVudEd1
        aWRzID0gZ2V0RGVwZW5kZW50S2V5R3VpZHMoY2hhbmdlTWV0YSksCiAgICAg
        ICAgICBkZXBlbmRlbnRHdWlkID0gZ3VpZEZvcihjaGFuZ2VNZXRhLmFycmF5
        Q2hhbmdlZCksCiAgICAgICAgICBudW1iZXJPZkRlcGVuZGVudEFycmF5cyA9
        IGNoYW5nZU1ldGEucHJvcGVydHkuX2RlcGVuZGVudEtleXMubGVuZ3RoLAog
        ICAgICAgICAgbnVtYmVyT2ZBcnJheXNJdGVtQXBwZWFyc0luLAogICAgICAg
        ICAgaXRlbUNvdW50cyA9IGluc3RhbmNlTWV0YS5pdGVtQ291bnRzOwoKICAg
        ICAgaWYgKGl0ZW1Db3VudHNbaXRlbUd1aWRdW2RlcGVuZGVudEd1aWRdID09
        PSB1bmRlZmluZWQpIHsgaXRlbUNvdW50c1tpdGVtR3VpZF1bZGVwZW5kZW50
        R3VpZF0gPSAwOyB9CiAgICAgIGlmICgtLWl0ZW1Db3VudHNbaXRlbUd1aWRd
        W2RlcGVuZGVudEd1aWRdID09PSAwKSB7CiAgICAgICAgZGVsZXRlIGl0ZW1D
        b3VudHNbaXRlbUd1aWRdW2RlcGVuZGVudEd1aWRdOwogICAgICAgIG51bWJl
        ck9mQXJyYXlzSXRlbUFwcGVhcnNJbiA9IEVtYmVyLmtleXMoaXRlbUNvdW50
        c1tpdGVtR3VpZF0pLmxlbmd0aDsKCiAgICAgICAgaWYgKG51bWJlck9mQXJy
        YXlzSXRlbUFwcGVhcnNJbiA9PT0gMCkgewogICAgICAgICAgZGVsZXRlIGl0
        ZW1Db3VudHNbaXRlbUd1aWRdOwogICAgICAgIH0KICAgICAgICBhcnJheS5y
        ZW1vdmVPYmplY3QoaXRlbSk7CiAgICAgIH0KICAgICAgcmV0dXJuIGFycmF5
        OwogICAgfQogIH0pOwogIHJldHVybiBFbWJlci5hcnJheUNvbXB1dGVkLmFw
        cGx5KG51bGwsIGFyZ3MpOwp9OwoKLyoqCiAgQSBjb21wdXRlZCBwcm9wZXJ0
        eSB3aGljaCByZXR1cm5zIGEgbmV3IGFycmF5IHdpdGggYWxsIHRoZQogIHBy
        b3BlcnRpZXMgZnJvbSB0aGUgZmlyc3QgZGVwZW5kZW50IGFycmF5IHRoYXQg
        YXJlIG5vdCBpbiB0aGUgc2Vjb25kCiAgZGVwZW5kZW50IGFycmF5LgoKICBF
        eGFtcGxlCgogIGBgYGphdmFzY3JpcHQKICBBcHAuSGFtcHN0ZXIgPSBFbWJl
        ci5PYmplY3QuZXh0ZW5kKHsKICAgIGxpa2VzOiBbJ2JhbmFuYScsICdncmFw
        ZScsICdrYWxlJ10sCiAgICB3YW50czogRW1iZXIuY29tcHV0ZWQuc2V0RGlm
        ZignbGlrZXMnLCAnZnJ1aXRzJykKICB9KTsKCiAgdmFyIGhhbXBzdGVyID0g
        QXBwLkhhbXBzdGVyLmNyZWF0ZSh7ZnJ1aXRzOiBbCiAgICAnZ3JhcGUnLAog
        ICAgJ2thbGUnLAogIF19KTsKICBoYW1wc3Rlci5nZXQoJ3dhbnRzJyk7IC8v
        IFsnYmFuYW5hJ10KICBgYGAKCiAgQG1ldGhvZCBjb21wdXRlZC5zZXREaWZm
        CiAgQGZvciBFbWJlcgogIEBwYXJhbSB7U3RyaW5nfSBzZXRBUHJvcGVydHkK
        ICBAcGFyYW0ge1N0cmluZ30gc2V0QlByb3BlcnR5CiAgQHJldHVybiB7RW1i
        ZXIuQ29tcHV0ZWRQcm9wZXJ0eX0gY29tcHV0ZXMgYSBuZXcgYXJyYXkgd2l0
        aCBhbGwgdGhlCiAgaXRlbXMgZnJvbSB0aGUgZmlyc3QgZGVwZW5kZW50IGFy
        cmF5IHRoYXQgYXJlIG5vdCBpbiB0aGUgc2Vjb25kCiAgZGVwZW5kZW50IGFy
        cmF5CiovCkVtYmVyLmNvbXB1dGVkLnNldERpZmYgPSBmdW5jdGlvbiAoc2V0
        QVByb3BlcnR5LCBzZXRCUHJvcGVydHkpIHsKICBpZiAoYXJndW1lbnRzLmxl
        bmd0aCAhPT0gMikgewogICAgdGhyb3cgbmV3IEVtYmVyLkVycm9yKCJzZXRE
        aWZmIHJlcXVpcmVzIGV4YWN0bHkgdHdvIGRlcGVuZGVudCBhcnJheXMuIik7
        CiAgfQogIHJldHVybiBFbWJlci5hcnJheUNvbXB1dGVkLmNhbGwobnVsbCwg
        c2V0QVByb3BlcnR5LCBzZXRCUHJvcGVydHksIHsKICAgIGFkZGVkSXRlbTog
        ZnVuY3Rpb24gKGFycmF5LCBpdGVtLCBjaGFuZ2VNZXRhLCBpbnN0YW5jZU1l
        dGEpIHsKICAgICAgdmFyIHNldEEgPSBnZXQodGhpcywgc2V0QVByb3BlcnR5
        KSwKICAgICAgICAgIHNldEIgPSBnZXQodGhpcywgc2V0QlByb3BlcnR5KTsK
        CiAgICAgIGlmIChjaGFuZ2VNZXRhLmFycmF5Q2hhbmdlZCA9PT0gc2V0QSkg
        ewogICAgICAgIGlmICghc2V0Qi5jb250YWlucyhpdGVtKSkgewogICAgICAg
        ICAgYXJyYXkuYWRkT2JqZWN0KGl0ZW0pOwogICAgICAgIH0KICAgICAgfSBl
        bHNlIHsKICAgICAgICBhcnJheS5yZW1vdmVPYmplY3QoaXRlbSk7CiAgICAg
        IH0KICAgICAgcmV0dXJuIGFycmF5OwogICAgfSwKCiAgICByZW1vdmVkSXRl
        bTogZnVuY3Rpb24gKGFycmF5LCBpdGVtLCBjaGFuZ2VNZXRhLCBpbnN0YW5j
        ZU1ldGEpIHsKICAgICAgdmFyIHNldEEgPSBnZXQodGhpcywgc2V0QVByb3Bl
        cnR5KSwKICAgICAgICAgIHNldEIgPSBnZXQodGhpcywgc2V0QlByb3BlcnR5
        KTsKCiAgICAgIGlmIChjaGFuZ2VNZXRhLmFycmF5Q2hhbmdlZCA9PT0gc2V0
        QikgewogICAgICAgIGlmIChzZXRBLmNvbnRhaW5zKGl0ZW0pKSB7CiAgICAg
        ICAgICBhcnJheS5hZGRPYmplY3QoaXRlbSk7CiAgICAgICAgfQogICAgICB9
        IGVsc2UgewogICAgICAgIGFycmF5LnJlbW92ZU9iamVjdChpdGVtKTsKICAg
        ICAgfQogICAgICByZXR1cm4gYXJyYXk7CiAgICB9CiAgfSk7Cn07CgpmdW5j
        dGlvbiBiaW5hcnlTZWFyY2goYXJyYXksIGl0ZW0sIGxvdywgaGlnaCkgewog
        IHZhciBtaWQsIG1pZEl0ZW0sIHJlcywgZ3VpZE1pZCwgZ3VpZEl0ZW07Cgog
        IGlmIChhcmd1bWVudHMubGVuZ3RoIDwgNCkgeyBoaWdoID0gZ2V0KGFycmF5
        LCAnbGVuZ3RoJyk7IH0KICBpZiAoYXJndW1lbnRzLmxlbmd0aCA8IDMpIHsg
        bG93ID0gMDsgfQoKICBpZiAobG93ID09PSBoaWdoKSB7CiAgICByZXR1cm4g
        bG93OwogIH0KCiAgbWlkID0gbG93ICsgTWF0aC5mbG9vcigoaGlnaCAtIGxv
        dykgLyAyKTsKICBtaWRJdGVtID0gYXJyYXkub2JqZWN0QXQobWlkKTsKCiAg
        Z3VpZE1pZCA9IF9ndWlkRm9yKG1pZEl0ZW0pOwogIGd1aWRJdGVtID0gX2d1
        aWRGb3IoaXRlbSk7CgogIGlmIChndWlkTWlkID09PSBndWlkSXRlbSkgewog
        ICAgcmV0dXJuIG1pZDsKICB9CgogIHJlcyA9IHRoaXMub3JkZXIobWlkSXRl
        bSwgaXRlbSk7CiAgaWYgKHJlcyA9PT0gMCkgewogICAgcmVzID0gZ3VpZE1p
        ZCA8IGd1aWRJdGVtID8gLTEgOiAxOwogIH0KCgogIGlmIChyZXMgPCAwKSB7
        CiAgICByZXR1cm4gdGhpcy5iaW5hcnlTZWFyY2goYXJyYXksIGl0ZW0sIG1p
        ZCsxLCBoaWdoKTsKICB9IGVsc2UgaWYgKHJlcyA+IDApIHsKICAgIHJldHVy
        biB0aGlzLmJpbmFyeVNlYXJjaChhcnJheSwgaXRlbSwgbG93LCBtaWQpOwog
        IH0KCiAgcmV0dXJuIG1pZDsKCiAgZnVuY3Rpb24gX2d1aWRGb3IoaXRlbSkg
        ewogICAgaWYgKEVtYmVyLk9iamVjdFByb3h5LmRldGVjdEluc3RhbmNlKGl0
        ZW0pKSB7CiAgICAgIHJldHVybiBndWlkRm9yKGdldChpdGVtLCAnY29udGVu
        dCcpKTsKICAgIH0KICAgIHJldHVybiBndWlkRm9yKGl0ZW0pOwogIH0KfQoK
        LyoqCiAgQSBjb21wdXRlZCBwcm9wZXJ0eSB3aGljaCByZXR1cm5zIGEgbmV3
        IGFycmF5IHdpdGggYWxsIHRoZQogIHByb3BlcnRpZXMgZnJvbSB0aGUgZmly
        c3QgZGVwZW5kZW50IGFycmF5IHNvcnRlZCBiYXNlZCBvbiBhIHByb3BlcnR5
        CiAgb3Igc29ydCBmdW5jdGlvbi4KCiAgVGhlIGNhbGxiYWNrIG1ldGhvZCB5
        b3UgcHJvdmlkZSBzaG91bGQgaGF2ZSB0aGUgZm9sbG93aW5nIHNpZ25hdHVy
        ZToKCiAgYGBgamF2YXNjcmlwdAogIGZ1bmN0aW9uKGl0ZW1BLCBpdGVtQik7
        CiAgYGBgCgogIC0gYGl0ZW1BYCB0aGUgZmlyc3QgaXRlbSB0byBjb21wYXJl
        LgogIC0gYGl0ZW1CYCB0aGUgc2Vjb25kIGl0ZW0gdG8gY29tcGFyZS4KCiAg
        VGhpcyBmdW5jdGlvbiBzaG91bGQgcmV0dXJuIGAtMWAgd2hlbiBgaXRlbUFg
        IHNob3VsZCBjb21lIGJlZm9yZQogIGBpdGVtQmAuIEl0IHNob3VsZCByZXR1
        cm4gYDFgIHdoZW4gYGl0ZW1BYCBzaG91bGQgY29tZSBhZnRlcgogIGBpdGVt
        QmAuIElmIHRoZSBgaXRlbUFgIGFuZCBgaXRlbUJgIGFyZSBlcXVhbCB0aGlz
        IGZ1bmN0aW9uIHNob3VsZCByZXR1cm4gYDBgLgoKICBFeGFtcGxlCgogIGBg
        YGphdmFzY3JpcHQKICB2YXIgVG9Eb0xpc3QgPSBFbWJlci5PYmplY3QuZXh0
        ZW5kKHsKICAgIHRvZG9zU29ydGluZzogWyduYW1lJ10sCiAgICBzb3J0ZWRU
        b2RvczogRW1iZXIuY29tcHV0ZWQuc29ydCgndG9kb3MnLCAndG9kb3NTb3J0
        aW5nJyksCiAgICBwcmlvcml0eVRvZG9zOiBFbWJlci5jb21wdXRlZC5zb3J0
        KCd0b2RvcycsIGZ1bmN0aW9uKGEsIGIpewogICAgICBpZiAoYS5wcmlvcml0
        eSA+IGIucHJpb3JpdHkpIHsKICAgICAgICByZXR1cm4gMTsKICAgICAgfSBl
        bHNlIGlmIChhLnByaW9yaXR5IDwgYi5wcmlvcml0eSkgewogICAgICAgIHJl
        dHVybiAtMTsKICAgICAgfQogICAgICByZXR1cm4gMDsKICAgIH0pLAogIH0p
        OwogIHZhciB0b2RvTGlzdCA9IFRvRG9MaXN0LmNyZWF0ZSh7dG9kb3M6IFsK
        ICAgIHtuYW1lOiAnVW5pdCBUZXN0JywgcHJpb3JpdHk6IDJ9LAogICAge25h
        bWU6ICdEb2N1bWVudGF0aW9uJywgcHJpb3JpdHk6IDN9LAogICAge25hbWU6
        ICdSZWxlYXNlJywgcHJpb3JpdHk6IDF9CiAgXX0pOwoKICB0b2RvTGlzdC5n
        ZXQoJ3NvcnRlZFRvZG9zJyk7IC8vIFt7bmFtZTonRG9jdW1lbnRhdGlvbics
        IHByaW9yaXR5OjN9LCB7bmFtZTonUmVsZWFzZScsIHByaW9yaXR5OjF9LCB7
        bmFtZTonVW5pdCBUZXN0JywgcHJpb3JpdHk6Mn1dCiAgdG9kb0xpc3QuZ2V0
        KCdwcmlvcml0eVRvZG9zJyk7IC8vIFt7bmFtZTonUmVsZWFzZScsIHByaW9y
        aXR5OjF9LCB7bmFtZTonVW5pdCBUZXN0JywgcHJpb3JpdHk6Mn0sIHtuYW1l
        OidEb2N1bWVudGF0aW9uJywgcHJpb3JpdHk6M31dCiAgYGBgCgogIEBtZXRo
        b2QgY29tcHV0ZWQuc29ydAogIEBmb3IgRW1iZXIKICBAcGFyYW0ge1N0cmlu
        Z30gZGVwZW5kZW50S2V5CiAgQHBhcmFtIHtTdHJpbmcgb3IgRnVuY3Rpb259
        IHNvcnREZWZpbml0aW9uIGEgZGVwZW5kZW50IGtleSB0byBhbgogIGFycmF5
        IG9mIHNvcnQgcHJvcGVydGllcyBvciBhIGZ1bmN0aW9uIHRvIHVzZSB3aGVu
        IHNvcnRpbmcKICBAcmV0dXJuIHtFbWJlci5Db21wdXRlZFByb3BlcnR5fSBj
        b21wdXRlcyBhIG5ldyBzb3J0ZWQgYXJyYXkgYmFzZWQKICBvbiB0aGUgc29y
        dCBwcm9wZXJ0eSBhcnJheSBvciBjYWxsYmFjayBmdW5jdGlvbgoqLwpFbWJl
        ci5jb21wdXRlZC5zb3J0ID0gZnVuY3Rpb24gKGl0ZW1zS2V5LCBzb3J0RGVm
        aW5pdGlvbikgewogIEVtYmVyLmFzc2VydCgiRW1iZXIuY29tcHV0ZWQuc29y
        dCByZXF1aXJlcyB0d28gYXJndW1lbnRzOiBhbiBhcnJheSBrZXkgdG8gc29y
        dCBhbmQgZWl0aGVyIGEgc29ydCBwcm9wZXJ0aWVzIGtleSBvciBzb3J0IGZ1
        bmN0aW9uIiwgYXJndW1lbnRzLmxlbmd0aCA9PT0gMik7CgogIHZhciBpbml0
        Rm4sIHNvcnRQcm9wZXJ0aWVzS2V5OwoKICBpZiAodHlwZW9mIHNvcnREZWZp
        bml0aW9uID09PSAnZnVuY3Rpb24nKSB7CiAgICBpbml0Rm4gPSBmdW5jdGlv
        biAoYXJyYXksIGNoYW5nZU1ldGEsIGluc3RhbmNlTWV0YSkgewogICAgICBp
        bnN0YW5jZU1ldGEub3JkZXIgPSBzb3J0RGVmaW5pdGlvbjsKICAgICAgaW5z
        dGFuY2VNZXRhLmJpbmFyeVNlYXJjaCA9IGJpbmFyeVNlYXJjaDsKICAgIH07
        CiAgfSBlbHNlIHsKICAgIHNvcnRQcm9wZXJ0aWVzS2V5ID0gc29ydERlZmlu
        aXRpb247CiAgICBpbml0Rm4gPSBmdW5jdGlvbiAoYXJyYXksIGNoYW5nZU1l
        dGEsIGluc3RhbmNlTWV0YSkgewogICAgICBmdW5jdGlvbiBzZXR1cFNvcnRQ
        cm9wZXJ0aWVzKCkgewogICAgICAgIHZhciBzb3J0UHJvcGVydHlEZWZpbml0
        aW9ucyA9IGdldCh0aGlzLCBzb3J0UHJvcGVydGllc0tleSksCiAgICAgICAg
        ICAgIHNvcnRQcm9wZXJ0eSwKICAgICAgICAgICAgc29ydFByb3BlcnRpZXMg
        PSBpbnN0YW5jZU1ldGEuc29ydFByb3BlcnRpZXMgPSBbXSwKICAgICAgICAg
        ICAgc29ydFByb3BlcnR5QXNjZW5kaW5nID0gaW5zdGFuY2VNZXRhLnNvcnRQ
        cm9wZXJ0eUFzY2VuZGluZyA9IHt9LAogICAgICAgICAgICBpZHgsCiAgICAg
        ICAgICAgIGFzYzsKCiAgICAgICAgRW1iZXIuYXNzZXJ0KCJDYW5ub3Qgc29y
        dDogJyIgKyBzb3J0UHJvcGVydGllc0tleSArICInIGlzIG5vdCBhbiBhcnJh
        eS4iLCBFbWJlci5pc0FycmF5KHNvcnRQcm9wZXJ0eURlZmluaXRpb25zKSk7
        CgogICAgICAgIGNoYW5nZU1ldGEucHJvcGVydHkuY2xlYXJJdGVtUHJvcGVy
        dHlLZXlzKGl0ZW1zS2V5KTsKCiAgICAgICAgZm9yRWFjaChzb3J0UHJvcGVy
        dHlEZWZpbml0aW9ucywgZnVuY3Rpb24gKHNvcnRQcm9wZXJ0eURlZmluaXRp
        b24pIHsKICAgICAgICAgIGlmICgoaWR4ID0gc29ydFByb3BlcnR5RGVmaW5p
        dGlvbi5pbmRleE9mKCc6JykpICE9PSAtMSkgewogICAgICAgICAgICBzb3J0
        UHJvcGVydHkgPSBzb3J0UHJvcGVydHlEZWZpbml0aW9uLnN1YnN0cmluZygw
        LCBpZHgpOwogICAgICAgICAgICBhc2MgPSBzb3J0UHJvcGVydHlEZWZpbml0
        aW9uLnN1YnN0cmluZyhpZHgrMSkudG9Mb3dlckNhc2UoKSAhPT0gJ2Rlc2Mn
        OwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgc29ydFByb3BlcnR5
        ID0gc29ydFByb3BlcnR5RGVmaW5pdGlvbjsKICAgICAgICAgICAgYXNjID0g
        dHJ1ZTsKICAgICAgICAgIH0KCiAgICAgICAgICBzb3J0UHJvcGVydGllcy5w
        dXNoKHNvcnRQcm9wZXJ0eSk7CiAgICAgICAgICBzb3J0UHJvcGVydHlBc2Nl
        bmRpbmdbc29ydFByb3BlcnR5XSA9IGFzYzsKICAgICAgICAgIGNoYW5nZU1l
        dGEucHJvcGVydHkuaXRlbVByb3BlcnR5S2V5KGl0ZW1zS2V5LCBzb3J0UHJv
        cGVydHkpOwogICAgICAgIH0pOwoKICAgICAgICBzb3J0UHJvcGVydHlEZWZp
        bml0aW9ucy5hZGRPYnNlcnZlcignQGVhY2gnLCB0aGlzLCB1cGRhdGVTb3J0
        UHJvcGVydGllc09uY2UpOwogICAgICB9CgogICAgICBmdW5jdGlvbiB1cGRh
        dGVTb3J0UHJvcGVydGllc09uY2UoKSB7CiAgICAgICAgRW1iZXIucnVuLm9u
        Y2UodGhpcywgdXBkYXRlU29ydFByb3BlcnRpZXMsIGNoYW5nZU1ldGEucHJv
        cGVydHlOYW1lKTsKICAgICAgfQoKICAgICAgZnVuY3Rpb24gdXBkYXRlU29y
        dFByb3BlcnRpZXMocHJvcGVydHlOYW1lKSB7CiAgICAgICAgc2V0dXBTb3J0
        UHJvcGVydGllcy5jYWxsKHRoaXMpOwogICAgICAgIGNoYW5nZU1ldGEucHJv
        cGVydHkucmVjb21wdXRlT25jZS5jYWxsKHRoaXMsIHByb3BlcnR5TmFtZSk7
        CiAgICAgIH0KCiAgICAgIEVtYmVyLmFkZE9ic2VydmVyKHRoaXMsIHNvcnRQ
        cm9wZXJ0aWVzS2V5LCB1cGRhdGVTb3J0UHJvcGVydGllc09uY2UpOwoKICAg
        ICAgc2V0dXBTb3J0UHJvcGVydGllcy5jYWxsKHRoaXMpOwoKCiAgICAgIGlu
        c3RhbmNlTWV0YS5vcmRlciA9IGZ1bmN0aW9uIChpdGVtQSwgaXRlbUIpIHsK
        ICAgICAgICB2YXIgc29ydFByb3BlcnR5LCByZXN1bHQsIGFzYzsKICAgICAg
        ICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuc29ydFByb3BlcnRpZXMubGVu
        Z3RoOyArK2kpIHsKICAgICAgICAgIHNvcnRQcm9wZXJ0eSA9IHRoaXMuc29y
        dFByb3BlcnRpZXNbaV07CiAgICAgICAgICByZXN1bHQgPSBFbWJlci5jb21w
        YXJlKGdldChpdGVtQSwgc29ydFByb3BlcnR5KSwgZ2V0KGl0ZW1CLCBzb3J0
        UHJvcGVydHkpKTsKCiAgICAgICAgICBpZiAocmVzdWx0ICE9PSAwKSB7CiAg
        ICAgICAgICAgIGFzYyA9IHRoaXMuc29ydFByb3BlcnR5QXNjZW5kaW5nW3Nv
        cnRQcm9wZXJ0eV07CiAgICAgICAgICAgIHJldHVybiBhc2MgPyByZXN1bHQg
        OiAoLTEgKiByZXN1bHQpOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAg
        ICAgcmV0dXJuIDA7CiAgICAgIH07CgogICAgICBpbnN0YW5jZU1ldGEuYmlu
        YXJ5U2VhcmNoID0gYmluYXJ5U2VhcmNoOwogICAgfTsKICB9CgogIHJldHVy
        biBFbWJlci5hcnJheUNvbXB1dGVkLmNhbGwobnVsbCwgaXRlbXNLZXksIHsK
        ICAgIGluaXRpYWxpemU6IGluaXRGbiwKCiAgICBhZGRlZEl0ZW06IGZ1bmN0
        aW9uIChhcnJheSwgaXRlbSwgY2hhbmdlTWV0YSwgaW5zdGFuY2VNZXRhKSB7
        CiAgICAgIHZhciBpbmRleCA9IGluc3RhbmNlTWV0YS5iaW5hcnlTZWFyY2go
        YXJyYXksIGl0ZW0pOwogICAgICBhcnJheS5pbnNlcnRBdChpbmRleCwgaXRl
        bSk7CiAgICAgIHJldHVybiBhcnJheTsKICAgIH0sCgogICAgcmVtb3ZlZEl0
        ZW06IGZ1bmN0aW9uIChhcnJheSwgaXRlbSwgY2hhbmdlTWV0YSwgaW5zdGFu
        Y2VNZXRhKSB7CiAgICAgIHZhciBwcm94eVByb3BlcnRpZXMsIGluZGV4LCBz
        ZWFyY2hJdGVtOwoKICAgICAgaWYgKGNoYW5nZU1ldGEucHJldmlvdXNWYWx1
        ZXMpIHsKICAgICAgICBwcm94eVByb3BlcnRpZXMgPSBtZXJnZSh7IGNvbnRl
        bnQ6IGl0ZW0gfSwgY2hhbmdlTWV0YS5wcmV2aW91c1ZhbHVlcyk7CgogICAg
        ICAgIHNlYXJjaEl0ZW0gPSBFbWJlci5PYmplY3RQcm94eS5jcmVhdGUocHJv
        eHlQcm9wZXJ0aWVzKTsKICAgICB9IGVsc2UgewogICAgICAgc2VhcmNoSXRl
        bSA9IGl0ZW07CiAgICAgfQoKICAgICAgaW5kZXggPSBpbnN0YW5jZU1ldGEu
        YmluYXJ5U2VhcmNoKGFycmF5LCBzZWFyY2hJdGVtKTsKICAgICAgYXJyYXku
        cmVtb3ZlQXQoaW5kZXgpOwogICAgICByZXR1cm4gYXJyYXk7CiAgICB9CiAg
        fSk7Cn07Cgp9KSgpOwoKCgooZnVuY3Rpb24oKSB7Ci8qKgogIEV4cG9zZSBS
        U1ZQIGltcGxlbWVudGF0aW9uCiAgCiAgRG9jdW1lbnRhdGlvbiBjYW4gYmUg
        Zm91bmQgaGVyZTogaHR0cHM6Ly9naXRodWIuY29tL3RpbGRlaW8vcnN2cC5q
        cy9ibG9iL21hc3Rlci9SRUFETUUubWQKCiAgQGNsYXNzIFJTVlAKICBAbmFt
        ZXNwYWNlIEVtYmVyCiAgQGNvbnN0cnVjdG9yCiovCkVtYmVyLlJTVlAgPSBy
        ZXF1aXJlTW9kdWxlKCdyc3ZwJyk7Cgp9KSgpOwoKCgooZnVuY3Rpb24oKSB7
        Ci8qKgpAbW9kdWxlIGVtYmVyCkBzdWJtb2R1bGUgZW1iZXItcnVudGltZQoq
        LwoKdmFyIFNUUklOR19EQVNIRVJJWkVfUkVHRVhQID0gKC9bIF9dL2cpOwp2
        YXIgU1RSSU5HX0RBU0hFUklaRV9DQUNIRSA9IHt9Owp2YXIgU1RSSU5HX0RF
        Q0FNRUxJWkVfUkVHRVhQID0gKC8oW2EtelxkXSkoW0EtWl0pL2cpOwp2YXIg
        U1RSSU5HX0NBTUVMSVpFX1JFR0VYUCA9ICgvKFwtfF98XC58XHMpKyguKT8v
        Zyk7CnZhciBTVFJJTkdfVU5ERVJTQ09SRV9SRUdFWFBfMSA9ICgvKFthLXpc
        ZF0pKFtBLVpdKykvZyk7CnZhciBTVFJJTkdfVU5ERVJTQ09SRV9SRUdFWFBf
        MiA9ICgvXC18XHMrL2cpOwoKLyoqCiAgRGVmaW5lcyB0aGUgaGFzaCBvZiBs
        b2NhbGl6ZWQgc3RyaW5ncyBmb3IgdGhlIGN1cnJlbnQgbGFuZ3VhZ2UuIFVz
        ZWQgYnkKICB0aGUgYEVtYmVyLlN0cmluZy5sb2MoKWAgaGVscGVyLiBUbyBs
        b2NhbGl6ZSwgYWRkIHN0cmluZyB2YWx1ZXMgdG8gdGhpcwogIGhhc2guCgog
        IEBwcm9wZXJ0eSBTVFJJTkdTCiAgQGZvciBFbWJlcgogIEB0eXBlIEhhc2gK
        Ki8KRW1iZXIuU1RSSU5HUyA9IHt9OwoKLyoqCiAgRGVmaW5lcyBzdHJpbmcg
        aGVscGVyIG1ldGhvZHMgaW5jbHVkaW5nIHN0cmluZyBmb3JtYXR0aW5nIGFu
        ZCBsb2NhbGl6YXRpb24uCiAgVW5sZXNzIGBFbWJlci5FWFRFTkRfUFJPVE9U
        WVBFUy5TdHJpbmdgIGlzIGBmYWxzZWAgdGhlc2UgbWV0aG9kcyB3aWxsIGFs
        c28gYmUKICBhZGRlZCB0byB0aGUgYFN0cmluZy5wcm90b3R5cGVgIGFzIHdl
        bGwuCgogIEBjbGFzcyBTdHJpbmcKICBAbmFtZXNwYWNlIEVtYmVyCiAgQHN0
        YXRpYwoqLwpFbWJlci5TdHJpbmcgPSB7CgogIC8qKgogICAgQXBwbHkgZm9y
        bWF0dGluZyBvcHRpb25zIHRvIHRoZSBzdHJpbmcuIFRoaXMgd2lsbCBsb29r
        IGZvciBvY2N1cnJlbmNlcwogICAgb2YgIiVAIiBpbiB5b3VyIHN0cmluZyBh
        bmQgc3Vic3RpdHV0ZSB0aGVtIHdpdGggdGhlIGFyZ3VtZW50cyB5b3UgcGFz
        cyBpbnRvCiAgICB0aGlzIG1ldGhvZC4gSWYgeW91IHdhbnQgdG8gY29udHJv
        bCB0aGUgc3BlY2lmaWMgb3JkZXIgb2YgcmVwbGFjZW1lbnQsCiAgICB5b3Ug
        Y2FuIGFkZCBhIG51bWJlciBhZnRlciB0aGUga2V5IGFzIHdlbGwgdG8gaW5k
        aWNhdGUgd2hpY2ggYXJndW1lbnQKICAgIHlvdSB3YW50IHRvIGluc2VydC4K
        CiAgICBPcmRlcmVkIGluc2VydGlvbnMgYXJlIG1vc3QgdXNlZnVsIHdoZW4g
        YnVpbGRpbmcgbG9jIHN0cmluZ3Mgd2hlcmUgdmFsdWVzCiAgICB5b3UgbmVl
        ZCB0byBpbnNlcnQgbWF5IGFwcGVhciBpbiBkaWZmZXJlbnQgb3JkZXJzLgoK
        ICAgIGBgYGphdmFzY3JpcHQKICAgICJIZWxsbyAlQCAlQCIuZm10KCdKb2hu
        JywgJ0RvZScpOyAgICAgLy8gIkhlbGxvIEpvaG4gRG9lIgogICAgIkhlbGxv
        ICVAMiwgJUAxIi5mbXQoJ0pvaG4nLCAnRG9lJyk7ICAvLyAiSGVsbG8gRG9l
        LCBKb2huIgogICAgYGBgCgogICAgQG1ldGhvZCBmbXQKICAgIEBwYXJhbSB7
        U3RyaW5nfSBzdHIgVGhlIHN0cmluZyB0byBmb3JtYXQKICAgIEBwYXJhbSB7
        QXJyYXl9IGZvcm1hdHMgQW4gYXJyYXkgb2YgcGFyYW1ldGVycyB0byBpbnRl
        cnBvbGF0ZSBpbnRvIHN0cmluZy4KICAgIEByZXR1cm4ge1N0cmluZ30gZm9y
        bWF0dGVkIHN0cmluZwogICovCiAgZm10OiBmdW5jdGlvbihzdHIsIGZvcm1h
        dHMpIHsKICAgIC8vIGZpcnN0LCByZXBsYWNlIGFueSBPUkRFUkVEIHJlcGxh
        Y2VtZW50cy4KICAgIHZhciBpZHggID0gMDsgLy8gdGhlIGN1cnJlbnQgaW5k
        ZXggZm9yIG5vbi1udW1lcmljYWwgcmVwbGFjZW1lbnRzCiAgICByZXR1cm4g
        c3RyLnJlcGxhY2UoLyVAKFswLTldKyk/L2csIGZ1bmN0aW9uKHMsIGFyZ0lu
        ZGV4KSB7CiAgICAgIGFyZ0luZGV4ID0gKGFyZ0luZGV4KSA/IHBhcnNlSW50
        KGFyZ0luZGV4LCAxMCkgLSAxIDogaWR4Kys7CiAgICAgIHMgPSBmb3JtYXRz
        W2FyZ0luZGV4XTsKICAgICAgcmV0dXJuIChzID09PSBudWxsKSA/ICcobnVs
        bCknIDogKHMgPT09IHVuZGVmaW5lZCkgPyAnJyA6IEVtYmVyLmluc3BlY3Qo
        cyk7CiAgICB9KSA7CiAgfSwKCiAgLyoqCiAgICBGb3JtYXRzIHRoZSBwYXNz
        ZWQgc3RyaW5nLCBidXQgZmlyc3QgbG9va3MgdXAgdGhlIHN0cmluZyBpbiB0
        aGUgbG9jYWxpemVkCiAgICBzdHJpbmdzIGhhc2guIFRoaXMgaXMgYSBjb252
        ZW5pZW50IHdheSB0byBsb2NhbGl6ZSB0ZXh0LiBTZWUKICAgIGBFbWJlci5T
        dHJpbmcuZm10KClgIGZvciBtb3JlIGluZm9ybWF0aW9uIG9uIGZvcm1hdHRp
        bmcuCgogICAgTm90ZSB0aGF0IGl0IGlzIHRyYWRpdGlvbmFsIGJ1dCBub3Qg
        cmVxdWlyZWQgdG8gcHJlZml4IGxvY2FsaXplZCBzdHJpbmcKICAgIGtleXMg
        d2l0aCBhbiB1bmRlcnNjb3JlIG9yIG90aGVyIGNoYXJhY3RlciBzbyB5b3Ug
        Y2FuIGVhc2lseSBpZGVudGlmeQogICAgbG9jYWxpemVkIHN0cmluZ3MuCgog
        ICAgYGBgamF2YXNjcmlwdAogICAgRW1iZXIuU1RSSU5HUyA9IHsKICAgICAg
        J19IZWxsbyBXb3JsZCc6ICdCb25qb3VyIGxlIG1vbmRlJywKICAgICAgJ19I
        ZWxsbyAlQCAlQCc6ICdCb25qb3VyICVAICVAJwogICAgfTsKCiAgICBFbWJl
        ci5TdHJpbmcubG9jKCJfSGVsbG8gV29ybGQiKTsgIC8vICdCb25qb3VyIGxl
        IG1vbmRlJzsKICAgIEVtYmVyLlN0cmluZy5sb2MoIl9IZWxsbyAlQCAlQCIs
        IFsiSm9obiIsICJTbWl0aCJdKTsgIC8vICJCb25qb3VyIEpvaG4gU21pdGgi
        OwogICAgYGBgCgogICAgQG1ldGhvZCBsb2MKICAgIEBwYXJhbSB7U3RyaW5n
        fSBzdHIgVGhlIHN0cmluZyB0byBmb3JtYXQKICAgIEBwYXJhbSB7QXJyYXl9
        IGZvcm1hdHMgT3B0aW9uYWwgYXJyYXkgb2YgcGFyYW1ldGVycyB0byBpbnRl
        cnBvbGF0ZSBpbnRvIHN0cmluZy4KICAgIEByZXR1cm4ge1N0cmluZ30gZm9y
        bWF0dGVkIHN0cmluZwogICovCiAgbG9jOiBmdW5jdGlvbihzdHIsIGZvcm1h
        dHMpIHsKICAgIHN0ciA9IEVtYmVyLlNUUklOR1Nbc3RyXSB8fCBzdHI7CiAg
        ICByZXR1cm4gRW1iZXIuU3RyaW5nLmZtdChzdHIsIGZvcm1hdHMpIDsKICB9
        LAoKICAvKioKICAgIFNwbGl0cyBhIHN0cmluZyBpbnRvIHNlcGFyYXRlIHVu
        aXRzIHNlcGFyYXRlZCBieSBzcGFjZXMsIGVsaW1pbmF0aW5nIGFueQogICAg
        ZW1wdHkgc3RyaW5ncyBpbiB0aGUgcHJvY2Vzcy4gVGhpcyBpcyBhIGNvbnZl
        bmllbmNlIG1ldGhvZCBmb3Igc3BsaXQgdGhhdAogICAgaXMgbW9zdGx5IHVz
        ZWZ1bCB3aGVuIGFwcGxpZWQgdG8gdGhlIGBTdHJpbmcucHJvdG90eXBlYC4K
        CiAgICBgYGBqYXZhc2NyaXB0CiAgICBFbWJlci5TdHJpbmcudygiYWxwaGEg
        YmV0YSBnYW1tYSIpLmZvckVhY2goZnVuY3Rpb24oa2V5KSB7CiAgICAgIGNv
        bnNvbGUubG9nKGtleSk7CiAgICB9KTsKCiAgICAvLyA+IGFscGhhCiAgICAv
        LyA+IGJldGEKICAgIC8vID4gZ2FtbWEKICAgIGBgYAoKICAgIEBtZXRob2Qg
        dwogICAgQHBhcmFtIHtTdHJpbmd9IHN0ciBUaGUgc3RyaW5nIHRvIHNwbGl0
        CiAgICBAcmV0dXJuIHtTdHJpbmd9IHNwbGl0IHN0cmluZwogICovCiAgdzog
        ZnVuY3Rpb24oc3RyKSB7IHJldHVybiBzdHIuc3BsaXQoL1xzKy8pOyB9LAoK
        ICAvKioKICAgIENvbnZlcnRzIGEgY2FtZWxpemVkIHN0cmluZyBpbnRvIGFs
        bCBsb3dlciBjYXNlIHNlcGFyYXRlZCBieSB1bmRlcnNjb3Jlcy4KCiAgICBg
        YGBqYXZhc2NyaXB0CiAgICAnaW5uZXJIVE1MJy5kZWNhbWVsaXplKCk7ICAg
        ICAgICAgICAvLyAnaW5uZXJfaHRtbCcKICAgICdhY3Rpb25fbmFtZScuZGVj
        YW1lbGl6ZSgpOyAgICAgICAgLy8gJ2FjdGlvbl9uYW1lJwogICAgJ2Nzcy1j
        bGFzcy1uYW1lJy5kZWNhbWVsaXplKCk7ICAgICAvLyAnY3NzLWNsYXNzLW5h
        bWUnCiAgICAnbXkgZmF2b3JpdGUgaXRlbXMnLmRlY2FtZWxpemUoKTsgIC8v
        ICdteSBmYXZvcml0ZSBpdGVtcycKICAgIGBgYAoKICAgIEBtZXRob2QgZGVj
        YW1lbGl6ZQogICAgQHBhcmFtIHtTdHJpbmd9IHN0ciBUaGUgc3RyaW5nIHRv
        IGRlY2FtZWxpemUuCiAgICBAcmV0dXJuIHtTdHJpbmd9IHRoZSBkZWNhbWVs
        aXplZCBzdHJpbmcuCiAgKi8KICBkZWNhbWVsaXplOiBmdW5jdGlvbihzdHIp
        IHsKICAgIHJldHVybiBzdHIucmVwbGFjZShTVFJJTkdfREVDQU1FTElaRV9S
        RUdFWFAsICckMV8kMicpLnRvTG93ZXJDYXNlKCk7CiAgfSwKCiAgLyoqCiAg
        ICBSZXBsYWNlcyB1bmRlcnNjb3Jlcywgc3BhY2VzLCBvciBjYW1lbENhc2Ug
        d2l0aCBkYXNoZXMuCgogICAgYGBgamF2YXNjcmlwdAogICAgJ2lubmVySFRN
        TCcuZGFzaGVyaXplKCk7ICAgICAgICAgIC8vICdpbm5lci1odG1sJwogICAg
        J2FjdGlvbl9uYW1lJy5kYXNoZXJpemUoKTsgICAgICAgIC8vICdhY3Rpb24t
        bmFtZScKICAgICdjc3MtY2xhc3MtbmFtZScuZGFzaGVyaXplKCk7ICAgICAv
        LyAnY3NzLWNsYXNzLW5hbWUnCiAgICAnbXkgZmF2b3JpdGUgaXRlbXMnLmRh
        c2hlcml6ZSgpOyAgLy8gJ215LWZhdm9yaXRlLWl0ZW1zJwogICAgYGBgCgog
        ICAgQG1ldGhvZCBkYXNoZXJpemUKICAgIEBwYXJhbSB7U3RyaW5nfSBzdHIg
        VGhlIHN0cmluZyB0byBkYXNoZXJpemUuCiAgICBAcmV0dXJuIHtTdHJpbmd9
        IHRoZSBkYXNoZXJpemVkIHN0cmluZy4KICAqLwogIGRhc2hlcml6ZTogZnVu
        Y3Rpb24oc3RyKSB7CiAgICB2YXIgY2FjaGUgPSBTVFJJTkdfREFTSEVSSVpF
        X0NBQ0hFLAogICAgICAgIGhpdCAgID0gY2FjaGUuaGFzT3duUHJvcGVydHko
        c3RyKSwKICAgICAgICByZXQ7CgogICAgaWYgKGhpdCkgewogICAgICByZXR1
        cm4gY2FjaGVbc3RyXTsKICAgIH0gZWxzZSB7CiAgICAgIHJldCA9IEVtYmVy
        LlN0cmluZy5kZWNhbWVsaXplKHN0cikucmVwbGFjZShTVFJJTkdfREFTSEVS
        SVpFX1JFR0VYUCwnLScpOwogICAgICBjYWNoZVtzdHJdID0gcmV0OwogICAg
        fQoKICAgIHJldHVybiByZXQ7CiAgfSwKCiAgLyoqCiAgICBSZXR1cm5zIHRo
        ZSBsb3dlckNhbWVsQ2FzZSBmb3JtIG9mIGEgc3RyaW5nLgoKICAgIGBgYGph
        dmFzY3JpcHQKICAgICdpbm5lckhUTUwnLmNhbWVsaXplKCk7ICAgICAgICAg
        IC8vICdpbm5lckhUTUwnCiAgICAnYWN0aW9uX25hbWUnLmNhbWVsaXplKCk7
        ICAgICAgICAvLyAnYWN0aW9uTmFtZScKICAgICdjc3MtY2xhc3MtbmFtZScu
        Y2FtZWxpemUoKTsgICAgIC8vICdjc3NDbGFzc05hbWUnCiAgICAnbXkgZmF2
        b3JpdGUgaXRlbXMnLmNhbWVsaXplKCk7ICAvLyAnbXlGYXZvcml0ZUl0ZW1z
        JwogICAgJ015IEZhdm9yaXRlIEl0ZW1zJy5jYW1lbGl6ZSgpOyAgLy8gJ215
        RmF2b3JpdGVJdGVtcycKICAgIGBgYAoKICAgIEBtZXRob2QgY2FtZWxpemUK
        ICAgIEBwYXJhbSB7U3RyaW5nfSBzdHIgVGhlIHN0cmluZyB0byBjYW1lbGl6
        ZS4KICAgIEByZXR1cm4ge1N0cmluZ30gdGhlIGNhbWVsaXplZCBzdHJpbmcu
        CiAgKi8KICBjYW1lbGl6ZTogZnVuY3Rpb24oc3RyKSB7CiAgICByZXR1cm4g
        c3RyLnJlcGxhY2UoU1RSSU5HX0NBTUVMSVpFX1JFR0VYUCwgZnVuY3Rpb24o
        bWF0Y2gsIHNlcGFyYXRvciwgY2hyKSB7CiAgICAgIHJldHVybiBjaHIgPyBj
        aHIudG9VcHBlckNhc2UoKSA6ICcnOwogICAgfSkucmVwbGFjZSgvXihbQS1a
        XSkvLCBmdW5jdGlvbihtYXRjaCwgc2VwYXJhdG9yLCBjaHIpIHsKICAgICAg
        cmV0dXJuIG1hdGNoLnRvTG93ZXJDYXNlKCk7CiAgICB9KTsKICB9LAoKICAv
        KioKICAgIFJldHVybnMgdGhlIFVwcGVyQ2FtZWxDYXNlIGZvcm0gb2YgYSBz
        dHJpbmcuCgogICAgYGBgamF2YXNjcmlwdAogICAgJ2lubmVySFRNTCcuY2xh
        c3NpZnkoKTsgICAgICAgICAgLy8gJ0lubmVySFRNTCcKICAgICdhY3Rpb25f
        bmFtZScuY2xhc3NpZnkoKTsgICAgICAgIC8vICdBY3Rpb25OYW1lJwogICAg
        J2Nzcy1jbGFzcy1uYW1lJy5jbGFzc2lmeSgpOyAgICAgLy8gJ0Nzc0NsYXNz
        TmFtZScKICAgICdteSBmYXZvcml0ZSBpdGVtcycuY2xhc3NpZnkoKTsgIC8v
        ICdNeUZhdm9yaXRlSXRlbXMnCiAgICBgYGAKCiAgICBAbWV0aG9kIGNsYXNz
        aWZ5CiAgICBAcGFyYW0ge1N0cmluZ30gc3RyIHRoZSBzdHJpbmcgdG8gY2xh
        c3NpZnkKICAgIEByZXR1cm4ge1N0cmluZ30gdGhlIGNsYXNzaWZpZWQgc3Ry
        aW5nCiAgKi8KICBjbGFzc2lmeTogZnVuY3Rpb24oc3RyKSB7CiAgICB2YXIg
        cGFydHMgPSBzdHIuc3BsaXQoIi4iKSwKICAgICAgICBvdXQgPSBbXTsKCiAg
        ICBmb3IgKHZhciBpPTAsIGw9cGFydHMubGVuZ3RoOyBpPGw7IGkrKykgewog
        ICAgICB2YXIgY2FtZWxpemVkID0gRW1iZXIuU3RyaW5nLmNhbWVsaXplKHBh
        cnRzW2ldKTsKICAgICAgb3V0LnB1c2goY2FtZWxpemVkLmNoYXJBdCgwKS50
        b1VwcGVyQ2FzZSgpICsgY2FtZWxpemVkLnN1YnN0cigxKSk7CiAgICB9Cgog
        ICAgcmV0dXJuIG91dC5qb2luKCIuIik7CiAgfSwKCiAgLyoqCiAgICBNb3Jl
        IGdlbmVyYWwgdGhhbiBkZWNhbWVsaXplLiBSZXR1cm5zIHRoZSBsb3dlclxf
        Y2FzZVxfYW5kXF91bmRlcnNjb3JlZAogICAgZm9ybSBvZiBhIHN0cmluZy4K
        CiAgICBgYGBqYXZhc2NyaXB0CiAgICAnaW5uZXJIVE1MJy51bmRlcnNjb3Jl
        KCk7ICAgICAgICAgIC8vICdpbm5lcl9odG1sJwogICAgJ2FjdGlvbl9uYW1l
        Jy51bmRlcnNjb3JlKCk7ICAgICAgICAvLyAnYWN0aW9uX25hbWUnCiAgICAn
        Y3NzLWNsYXNzLW5hbWUnLnVuZGVyc2NvcmUoKTsgICAgIC8vICdjc3NfY2xh
        c3NfbmFtZScKICAgICdteSBmYXZvcml0ZSBpdGVtcycudW5kZXJzY29yZSgp
        OyAgLy8gJ215X2Zhdm9yaXRlX2l0ZW1zJwogICAgYGBgCgogICAgQG1ldGhv
        ZCB1bmRlcnNjb3JlCiAgICBAcGFyYW0ge1N0cmluZ30gc3RyIFRoZSBzdHJp
        bmcgdG8gdW5kZXJzY29yZS4KICAgIEByZXR1cm4ge1N0cmluZ30gdGhlIHVu
        ZGVyc2NvcmVkIHN0cmluZy4KICAqLwogIHVuZGVyc2NvcmU6IGZ1bmN0aW9u
        KHN0cikgewogICAgcmV0dXJuIHN0ci5yZXBsYWNlKFNUUklOR19VTkRFUlND
        T1JFX1JFR0VYUF8xLCAnJDFfJDInKS4KICAgICAgcmVwbGFjZShTVFJJTkdf
        VU5ERVJTQ09SRV9SRUdFWFBfMiwgJ18nKS50b0xvd2VyQ2FzZSgpOwogIH0s
        CgogIC8qKgogICAgUmV0dXJucyB0aGUgQ2FwaXRhbGl6ZWQgZm9ybSBvZiBh
        IHN0cmluZwoKICAgIGBgYGphdmFzY3JpcHQKICAgICdpbm5lckhUTUwnLmNh
        cGl0YWxpemUoKSAgICAgICAgIC8vICdJbm5lckhUTUwnCiAgICAnYWN0aW9u
        X25hbWUnLmNhcGl0YWxpemUoKSAgICAgICAvLyAnQWN0aW9uX25hbWUnCiAg
        ICAnY3NzLWNsYXNzLW5hbWUnLmNhcGl0YWxpemUoKSAgICAvLyAnQ3NzLWNs
        YXNzLW5hbWUnCiAgICAnbXkgZmF2b3JpdGUgaXRlbXMnLmNhcGl0YWxpemUo
        KSAvLyAnTXkgZmF2b3JpdGUgaXRlbXMnCiAgICBgYGAKCiAgICBAbWV0aG9k
        IGNhcGl0YWxpemUKICAgIEBwYXJhbSB7U3RyaW5nfSBzdHIgVGhlIHN0cmlu
        ZyB0byBjYXBpdGFsaXplLgogICAgQHJldHVybiB7U3RyaW5nfSBUaGUgY2Fw
        aXRhbGl6ZWQgc3RyaW5nLgogICovCiAgY2FwaXRhbGl6ZTogZnVuY3Rpb24o
        c3RyKSB7CiAgICByZXR1cm4gc3RyLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgp
        ICsgc3RyLnN1YnN0cigxKTsKICB9Cgp9OwoKfSkoKTsKCgoKKGZ1bmN0aW9u
        KCkgewovKioKQG1vZHVsZSBlbWJlcgpAc3VibW9kdWxlIGVtYmVyLXJ1bnRp
        bWUKKi8KCgoKdmFyIGZtdCA9IEVtYmVyLlN0cmluZy5mbXQsCiAgICB3ICAg
        PSBFbWJlci5TdHJpbmcudywKICAgIGxvYyA9IEVtYmVyLlN0cmluZy5sb2Ms
        CiAgICBjYW1lbGl6ZSA9IEVtYmVyLlN0cmluZy5jYW1lbGl6ZSwKICAgIGRl
        Y2FtZWxpemUgPSBFbWJlci5TdHJpbmcuZGVjYW1lbGl6ZSwKICAgIGRhc2hl
        cml6ZSA9IEVtYmVyLlN0cmluZy5kYXNoZXJpemUsCiAgICB1bmRlcnNjb3Jl
        ID0gRW1iZXIuU3RyaW5nLnVuZGVyc2NvcmUsCiAgICBjYXBpdGFsaXplID0g
        RW1iZXIuU3RyaW5nLmNhcGl0YWxpemUsCiAgICBjbGFzc2lmeSA9IEVtYmVy
        LlN0cmluZy5jbGFzc2lmeTsKCmlmIChFbWJlci5FWFRFTkRfUFJPVE9UWVBF
        UyA9PT0gdHJ1ZSB8fCBFbWJlci5FWFRFTkRfUFJPVE9UWVBFUy5TdHJpbmcp
        IHsKCiAgLyoqCiAgICBTZWUgW0VtYmVyLlN0cmluZy5mbXRdKC9hcGkvY2xh
        c3Nlcy9FbWJlci5TdHJpbmcuaHRtbCNtZXRob2RfZm10KS4KCiAgICBAbWV0
        aG9kIGZtdAogICAgQGZvciBTdHJpbmcKICAqLwogIFN0cmluZy5wcm90b3R5
        cGUuZm10ID0gZnVuY3Rpb24oKSB7CiAgICByZXR1cm4gZm10KHRoaXMsIGFy
        Z3VtZW50cyk7CiAgfTsKCiAgLyoqCiAgICBTZWUgW0VtYmVyLlN0cmluZy53
        XSgvYXBpL2NsYXNzZXMvRW1iZXIuU3RyaW5nLmh0bWwjbWV0aG9kX3cpLgoK
        ICAgIEBtZXRob2QgdwogICAgQGZvciBTdHJpbmcKICAqLwogIFN0cmluZy5w
        cm90b3R5cGUudyA9IGZ1bmN0aW9uKCkgewogICAgcmV0dXJuIHcodGhpcyk7
        CiAgfTsKCiAgLyoqCiAgICBTZWUgW0VtYmVyLlN0cmluZy5sb2NdKC9hcGkv
        Y2xhc3Nlcy9FbWJlci5TdHJpbmcuaHRtbCNtZXRob2RfbG9jKS4KCiAgICBA
        bWV0aG9kIGxvYwogICAgQGZvciBTdHJpbmcKICAqLwogIFN0cmluZy5wcm90
        b3R5cGUubG9jID0gZnVuY3Rpb24oKSB7CiAgICByZXR1cm4gbG9jKHRoaXMs
        IGFyZ3VtZW50cyk7CiAgfTsKCiAgLyoqCiAgICBTZWUgW0VtYmVyLlN0cmlu
        Zy5jYW1lbGl6ZV0oL2FwaS9jbGFzc2VzL0VtYmVyLlN0cmluZy5odG1sI21l
        dGhvZF9jYW1lbGl6ZSkuCgogICAgQG1ldGhvZCBjYW1lbGl6ZQogICAgQGZv
        ciBTdHJpbmcKICAqLwogIFN0cmluZy5wcm90b3R5cGUuY2FtZWxpemUgPSBm
        dW5jdGlvbigpIHsKICAgIHJldHVybiBjYW1lbGl6ZSh0aGlzKTsKICB9OwoK
        ICAvKioKICAgIFNlZSBbRW1iZXIuU3RyaW5nLmRlY2FtZWxpemVdKC9hcGkv
        Y2xhc3Nlcy9FbWJlci5TdHJpbmcuaHRtbCNtZXRob2RfZGVjYW1lbGl6ZSku
        CgogICAgQG1ldGhvZCBkZWNhbWVsaXplCiAgICBAZm9yIFN0cmluZwogICov
        CiAgU3RyaW5nLnByb3RvdHlwZS5kZWNhbWVsaXplID0gZnVuY3Rpb24oKSB7
        CiAgICByZXR1cm4gZGVjYW1lbGl6ZSh0aGlzKTsKICB9OwoKICAvKioKICAg
        IFNlZSBbRW1iZXIuU3RyaW5nLmRhc2hlcml6ZV0oL2FwaS9jbGFzc2VzL0Vt
        YmVyLlN0cmluZy5odG1sI21ldGhvZF9kYXNoZXJpemUpLgoKICAgIEBtZXRo
        b2QgZGFzaGVyaXplCiAgICBAZm9yIFN0cmluZwogICovCiAgU3RyaW5nLnBy
        b3RvdHlwZS5kYXNoZXJpemUgPSBmdW5jdGlvbigpIHsKICAgIHJldHVybiBk
        YXNoZXJpemUodGhpcyk7CiAgfTsKCiAgLyoqCiAgICBTZWUgW0VtYmVyLlN0
        cmluZy51bmRlcnNjb3JlXSgvYXBpL2NsYXNzZXMvRW1iZXIuU3RyaW5nLmh0
        bWwjbWV0aG9kX3VuZGVyc2NvcmUpLgoKICAgIEBtZXRob2QgdW5kZXJzY29y
        ZQogICAgQGZvciBTdHJpbmcKICAqLwogIFN0cmluZy5wcm90b3R5cGUudW5k
        ZXJzY29yZSA9IGZ1bmN0aW9uKCkgewogICAgcmV0dXJuIHVuZGVyc2NvcmUo
        dGhpcyk7CiAgfTsKCiAgLyoqCiAgICBTZWUgW0VtYmVyLlN0cmluZy5jbGFz
        c2lmeV0oL2FwaS9jbGFzc2VzL0VtYmVyLlN0cmluZy5odG1sI21ldGhvZF9j
        bGFzc2lmeSkuCgogICAgQG1ldGhvZCBjbGFzc2lmeQogICAgQGZvciBTdHJp
        bmcKICAqLwogIFN0cmluZy5wcm90b3R5cGUuY2xhc3NpZnkgPSBmdW5jdGlv
        bigpIHsKICAgIHJldHVybiBjbGFzc2lmeSh0aGlzKTsKICB9OwoKICAvKioK
        ICAgIFNlZSBbRW1iZXIuU3RyaW5nLmNhcGl0YWxpemVdKC9hcGkvY2xhc3Nl
        cy9FbWJlci5TdHJpbmcuaHRtbCNtZXRob2RfY2FwaXRhbGl6ZSkuCgogICAg
        QG1ldGhvZCBjYXBpdGFsaXplCiAgICBAZm9yIFN0cmluZwogICovCiAgU3Ry
        aW5nLnByb3RvdHlwZS5jYXBpdGFsaXplID0gZnVuY3Rpb24oKSB7CiAgICBy
        ZXR1cm4gY2FwaXRhbGl6ZSh0aGlzKTsKICB9OwoKfQoKCn0pKCk7CgoKCihm
        dW5jdGlvbigpIHsKLyoqCkBtb2R1bGUgZW1iZXIKQHN1Ym1vZHVsZSBlbWJl
        ci1ydW50aW1lCiovCgp2YXIgYV9zbGljZSA9IEFycmF5LnByb3RvdHlwZS5z
        bGljZTsKCmlmIChFbWJlci5FWFRFTkRfUFJPVE9UWVBFUyA9PT0gdHJ1ZSB8
        fCBFbWJlci5FWFRFTkRfUFJPVE9UWVBFUy5GdW5jdGlvbikgewoKICAvKioK
        ICAgIFRoZSBgcHJvcGVydHlgIGV4dGVuc2lvbiBvZiBKYXZhc2NyaXB0J3Mg
        RnVuY3Rpb24gcHJvdG90eXBlIGlzIGF2YWlsYWJsZQogICAgd2hlbiBgRW1i
        ZXIuRVhURU5EX1BST1RPVFlQRVNgIG9yIGBFbWJlci5FWFRFTkRfUFJPVE9U
        WVBFUy5GdW5jdGlvbmAgaXMKICAgIGB0cnVlYCwgd2hpY2ggaXMgdGhlIGRl
        ZmF1bHQuCgogICAgQ29tcHV0ZWQgcHJvcGVydGllcyBhbGxvdyB5b3UgdG8g
        dHJlYXQgYSBmdW5jdGlvbiBsaWtlIGEgcHJvcGVydHk6CgogICAgYGBgamF2
        YXNjcmlwdAogICAgTXlBcHAuUHJlc2lkZW50ID0gRW1iZXIuT2JqZWN0LmV4
        dGVuZCh7CiAgICAgIGZpcnN0TmFtZTogJycsCiAgICAgIGxhc3ROYW1lOiAg
        JycsCgogICAgICBmdWxsTmFtZTogZnVuY3Rpb24oKSB7CiAgICAgICAgcmV0
        dXJuIHRoaXMuZ2V0KCdmaXJzdE5hbWUnKSArICcgJyArIHRoaXMuZ2V0KCds
        YXN0TmFtZScpOwoKICAgICAgICAvLyBDYWxsIHRoaXMgZmxhZyB0byBtYXJr
        IHRoZSBmdW5jdGlvbiBhcyBhIHByb3BlcnR5CiAgICAgIH0ucHJvcGVydHko
        KQogICAgfSk7CgogICAgdmFyIHByZXNpZGVudCA9IE15QXBwLlByZXNpZGVu
        dC5jcmVhdGUoewogICAgICBmaXJzdE5hbWU6ICJCYXJhY2siLAogICAgICBs
        YXN0TmFtZTogIk9iYW1hIgogICAgfSk7CgogICAgcHJlc2lkZW50LmdldCgn
        ZnVsbE5hbWUnKTsgICAgLy8gIkJhcmFjayBPYmFtYSIKICAgIGBgYAoKICAg
        IFRyZWF0aW5nIGEgZnVuY3Rpb24gbGlrZSBhIHByb3BlcnR5IGlzIHVzZWZ1
        bCBiZWNhdXNlIHRoZXkgY2FuIHdvcmsgd2l0aAogICAgYmluZGluZ3MsIGp1
        c3QgbGlrZSBhbnkgb3RoZXIgcHJvcGVydHkuCgogICAgTWFueSBjb21wdXRl
        ZCBwcm9wZXJ0aWVzIGhhdmUgZGVwZW5kZW5jaWVzIG9uIG90aGVyIHByb3Bl
        cnRpZXMuIEZvcgogICAgZXhhbXBsZSwgaW4gdGhlIGFib3ZlIGV4YW1wbGUs
        IHRoZSBgZnVsbE5hbWVgIHByb3BlcnR5IGRlcGVuZHMgb24KICAgIGBmaXJz
        dE5hbWVgIGFuZCBgbGFzdE5hbWVgIHRvIGRldGVybWluZSBpdHMgdmFsdWUu
        IFlvdSBjYW4gdGVsbCBFbWJlcgogICAgYWJvdXQgdGhlc2UgZGVwZW5kZW5j
        aWVzIGxpa2UgdGhpczoKCiAgICBgYGBqYXZhc2NyaXB0CiAgICBNeUFwcC5Q
        cmVzaWRlbnQgPSBFbWJlci5PYmplY3QuZXh0ZW5kKHsKICAgICAgZmlyc3RO
        YW1lOiAnJywKICAgICAgbGFzdE5hbWU6ICAnJywKCiAgICAgIGZ1bGxOYW1l
        OiBmdW5jdGlvbigpIHsKICAgICAgICByZXR1cm4gdGhpcy5nZXQoJ2ZpcnN0
        TmFtZScpICsgJyAnICsgdGhpcy5nZXQoJ2xhc3ROYW1lJyk7CgogICAgICAg
        IC8vIFRlbGwgRW1iZXIuanMgdGhhdCB0aGlzIGNvbXB1dGVkIHByb3BlcnR5
        IGRlcGVuZHMgb24gZmlyc3ROYW1lCiAgICAgICAgLy8gYW5kIGxhc3ROYW1l
        CiAgICAgIH0ucHJvcGVydHkoJ2ZpcnN0TmFtZScsICdsYXN0TmFtZScpCiAg
        ICB9KTsKICAgIGBgYAoKICAgIE1ha2Ugc3VyZSB5b3UgbGlzdCB0aGVzZSBk
        ZXBlbmRlbmNpZXMgc28gRW1iZXIga25vd3Mgd2hlbiB0byB1cGRhdGUKICAg
        IGJpbmRpbmdzIHRoYXQgY29ubmVjdCB0byBhIGNvbXB1dGVkIHByb3BlcnR5
        LiBDaGFuZ2luZyBhIGRlcGVuZGVuY3kKICAgIHdpbGwgbm90IGltbWVkaWF0
        ZWx5IHRyaWdnZXIgYW4gdXBkYXRlIG9mIHRoZSBjb21wdXRlZCBwcm9wZXJ0
        eSwgYnV0CiAgICB3aWxsIGluc3RlYWQgY2xlYXIgdGhlIGNhY2hlIHNvIHRo
        YXQgaXQgaXMgdXBkYXRlZCB3aGVuIHRoZSBuZXh0IGBnZXRgCiAgICBpcyBj
        YWxsZWQgb24gdGhlIHByb3BlcnR5LgoKICAgIFNlZSBbRW1iZXIuQ29tcHV0
        ZWRQcm9wZXJ0eV0oL2FwaS9jbGFzc2VzL0VtYmVyLkNvbXB1dGVkUHJvcGVy
        dHkuaHRtbCksIFtFbWJlci5jb21wdXRlZF0oL2FwaS8jbWV0aG9kX2NvbXB1
        dGVkKS4KCiAgICBAbWV0aG9kIHByb3BlcnR5CiAgICBAZm9yIEZ1bmN0aW9u
        CiAgKi8KICBGdW5jdGlvbi5wcm90b3R5cGUucHJvcGVydHkgPSBmdW5jdGlv
        bigpIHsKICAgIHZhciByZXQgPSBFbWJlci5jb21wdXRlZCh0aGlzKTsKICAg
        IHJldHVybiByZXQucHJvcGVydHkuYXBwbHkocmV0LCBhcmd1bWVudHMpOwog
        IH07CgogIC8qKgogICAgVGhlIGBvYnNlcnZlc2AgZXh0ZW5zaW9uIG9mIEph
        dmFzY3JpcHQncyBGdW5jdGlvbiBwcm90b3R5cGUgaXMgYXZhaWxhYmxlCiAg
        ICB3aGVuIGBFbWJlci5FWFRFTkRfUFJPVE9UWVBFU2Agb3IgYEVtYmVyLkVY
        VEVORF9QUk9UT1RZUEVTLkZ1bmN0aW9uYCBpcwogICAgdHJ1ZSwgd2hpY2gg
        aXMgdGhlIGRlZmF1bHQuCgogICAgWW91IGNhbiBvYnNlcnZlIHByb3BlcnR5
        IGNoYW5nZXMgc2ltcGx5IGJ5IGFkZGluZyB0aGUgYG9ic2VydmVzYAogICAg
        Y2FsbCB0byB0aGUgZW5kIG9mIHlvdXIgbWV0aG9kIGRlY2xhcmF0aW9ucyBp
        biBjbGFzc2VzIHRoYXQgeW91IHdyaXRlLgogICAgRm9yIGV4YW1wbGU6Cgog
        ICAgYGBgamF2YXNjcmlwdAogICAgRW1iZXIuT2JqZWN0LmV4dGVuZCh7CiAg
        ICAgIHZhbHVlT2JzZXJ2ZXI6IGZ1bmN0aW9uKCkgewogICAgICAgIC8vIEV4
        ZWN1dGVzIHdoZW5ldmVyIHRoZSAidmFsdWUiIHByb3BlcnR5IGNoYW5nZXMK
        ICAgICAgfS5vYnNlcnZlcygndmFsdWUnKQogICAgfSk7CiAgICBgYGAKCiAg
        ICBJbiB0aGUgZnV0dXJlIHRoaXMgbWV0aG9kIG1heSBiZWNvbWUgYXN5bmNo
        cm9ub3VzLiBJZiB5b3Ugd2FudCB0byBlbnN1cmUKICAgIHN5bmNocm9ub3Vz
        IGJlaGF2aW9yLCB1c2UgYG9ic2VydmVzSW1tZWRpYXRlbHlgLgoKICAgIFNl
        ZSBgRW1iZXIub2JzZXJ2ZXJgLgoKICAgIEBtZXRob2Qgb2JzZXJ2ZXMKICAg
        IEBmb3IgRnVuY3Rpb24KICAqLwogIEZ1bmN0aW9uLnByb3RvdHlwZS5vYnNl
        cnZlcyA9IGZ1bmN0aW9uKCkgewogICAgdGhpcy5fX2VtYmVyX29ic2VydmVz
        X18gPSBhX3NsaWNlLmNhbGwoYXJndW1lbnRzKTsKICAgIHJldHVybiB0aGlz
        OwogIH07CgogIC8qKgogICAgVGhlIGBvYnNlcnZlc0ltbWVkaWF0ZWx5YCBl
        eHRlbnNpb24gb2YgSmF2YXNjcmlwdCdzIEZ1bmN0aW9uIHByb3RvdHlwZSBp
        cwogICAgYXZhaWxhYmxlIHdoZW4gYEVtYmVyLkVYVEVORF9QUk9UT1RZUEVT
        YCBvcgogICAgYEVtYmVyLkVYVEVORF9QUk9UT1RZUEVTLkZ1bmN0aW9uYCBp
        cyB0cnVlLCB3aGljaCBpcyB0aGUgZGVmYXVsdC4KCiAgICBZb3UgY2FuIG9i
        c2VydmUgcHJvcGVydHkgY2hhbmdlcyBzaW1wbHkgYnkgYWRkaW5nIHRoZSBg
        b2JzZXJ2ZXNJbW1lZGlhdGVseWAKICAgIGNhbGwgdG8gdGhlIGVuZCBvZiB5
        b3VyIG1ldGhvZCBkZWNsYXJhdGlvbnMgaW4gY2xhc3NlcyB0aGF0IHlvdSB3
        cml0ZS4KICAgIEZvciBleGFtcGxlOgoKICAgIGBgYGphdmFzY3JpcHQKICAg
        IEVtYmVyLk9iamVjdC5leHRlbmQoewogICAgICB2YWx1ZU9ic2VydmVyOiBm
        dW5jdGlvbigpIHsKICAgICAgICAvLyBFeGVjdXRlcyBpbW1lZGlhdGVseSBh
        ZnRlciB0aGUgInZhbHVlIiBwcm9wZXJ0eSBjaGFuZ2VzCiAgICAgIH0ub2Jz
        ZXJ2ZXNJbW1lZGlhdGVseSgndmFsdWUnKQogICAgfSk7CiAgICBgYGAKCiAg
        ICBJbiB0aGUgZnV0dXJlLCBgb2JzZXJ2ZXNgIG1heSBiZWNvbWUgYXN5bmNo
        cm9ub3VzLiBJbiB0aGlzIGV2ZW50LAogICAgYG9ic2VydmVzSW1tZWRpYXRl
        bHlgIHdpbGwgbWFpbnRhaW4gdGhlIHN5bmNocm9ub3VzIGJlaGF2aW9yLgoK
        ICAgIFNlZSBgRW1iZXIuaW1tZWRpYXRlT2JzZXJ2ZXJgLgoKICAgIEBtZXRo
        b2Qgb2JzZXJ2ZXNJbW1lZGlhdGVseQogICAgQGZvciBGdW5jdGlvbgogICov
        CiAgRnVuY3Rpb24ucHJvdG90eXBlLm9ic2VydmVzSW1tZWRpYXRlbHkgPSBm
        dW5jdGlvbigpIHsKICAgIGZvciAodmFyIGk9MCwgbD1hcmd1bWVudHMubGVu
        Z3RoOyBpPGw7IGkrKykgewogICAgICB2YXIgYXJnID0gYXJndW1lbnRzW2ld
        OwogICAgICBFbWJlci5hc3NlcnQoIkltbWVkaWF0ZSBvYnNlcnZlcnMgbXVz
        dCBvYnNlcnZlIGludGVybmFsIHByb3BlcnRpZXMgb25seSwgbm90IHByb3Bl
        cnRpZXMgb24gb3RoZXIgb2JqZWN0cy4iLCBhcmcuaW5kZXhPZignLicpID09
        PSAtMSk7CiAgICB9CgogICAgcmV0dXJuIHRoaXMub2JzZXJ2ZXMuYXBwbHko
        dGhpcywgYXJndW1lbnRzKTsKICB9OwoKICAvKioKICAgIFRoZSBgb2JzZXJ2
        ZXNCZWZvcmVgIGV4dGVuc2lvbiBvZiBKYXZhc2NyaXB0J3MgRnVuY3Rpb24g
        cHJvdG90eXBlIGlzCiAgICBhdmFpbGFibGUgd2hlbiBgRW1iZXIuRVhURU5E
        X1BST1RPVFlQRVNgIG9yCiAgICBgRW1iZXIuRVhURU5EX1BST1RPVFlQRVMu
        RnVuY3Rpb25gIGlzIHRydWUsIHdoaWNoIGlzIHRoZSBkZWZhdWx0LgoKICAg
        IFlvdSBjYW4gZ2V0IG5vdGlmaWVkIHdoZW4gYSBwcm9wZXJ0eSBjaGFuZ2Ug
        aXMgYWJvdXQgdG8gaGFwcGVuIGJ5CiAgICBieSBhZGRpbmcgdGhlIGBvYnNl
        cnZlc0JlZm9yZWAgY2FsbCB0byB0aGUgZW5kIG9mIHlvdXIgbWV0aG9kCiAg
        ICBkZWNsYXJhdGlvbnMgaW4gY2xhc3NlcyB0aGF0IHlvdSB3cml0ZS4gRm9y
        IGV4YW1wbGU6CgogICAgYGBgamF2YXNjcmlwdAogICAgRW1iZXIuT2JqZWN0
        LmV4dGVuZCh7CiAgICAgIHZhbHVlT2JzZXJ2ZXI6IGZ1bmN0aW9uKCkgewog
        ICAgICAgIC8vIEV4ZWN1dGVzIHdoZW5ldmVyIHRoZSAidmFsdWUiIHByb3Bl
        cnR5IGlzIGFib3V0IHRvIGNoYW5nZQogICAgICB9Lm9ic2VydmVzQmVmb3Jl
        KCd2YWx1ZScpCiAgICB9KTsKICAgIGBgYAoKICAgIFNlZSBgRW1iZXIuYmVm
        b3JlT2JzZXJ2ZXJgLgoKICAgIEBtZXRob2Qgb2JzZXJ2ZXNCZWZvcmUKICAg
        IEBmb3IgRnVuY3Rpb24KICAqLwogIEZ1bmN0aW9uLnByb3RvdHlwZS5vYnNl
        cnZlc0JlZm9yZSA9IGZ1bmN0aW9uKCkgewogICAgdGhpcy5fX2VtYmVyX29i
        c2VydmVzQmVmb3JlX18gPSBhX3NsaWNlLmNhbGwoYXJndW1lbnRzKTsKICAg
        IHJldHVybiB0aGlzOwogIH07CgogIC8qKgogICAgVGhlIGBvbmAgZXh0ZW5z
        aW9uIG9mIEphdmFzY3JpcHQncyBGdW5jdGlvbiBwcm90b3R5cGUgaXMgYXZh
        aWxhYmxlCiAgICB3aGVuIGBFbWJlci5FWFRFTkRfUFJPVE9UWVBFU2Agb3Ig
        YEVtYmVyLkVYVEVORF9QUk9UT1RZUEVTLkZ1bmN0aW9uYCBpcwogICAgdHJ1
        ZSwgd2hpY2ggaXMgdGhlIGRlZmF1bHQuCgogICAgWW91IGNhbiBsaXN0ZW4g
        Zm9yIGV2ZW50cyBzaW1wbHkgYnkgYWRkaW5nIHRoZSBgb25gIGNhbGwgdG8g
        dGhlIGVuZCBvZgogICAgeW91ciBtZXRob2QgZGVjbGFyYXRpb25zIGluIGNs
        YXNzZXMgb3IgbWl4aW5zIHRoYXQgeW91IHdyaXRlLiBGb3IgZXhhbXBsZToK
        CiAgICBgYGBqYXZhc2NyaXB0CiAgICBFbWJlci5NaXhpbi5jcmVhdGUoewog
        ICAgICBkb1NvbWV0aGluZ1dpdGhFbGVtZW50OiBmdW5jdGlvbigpIHsKICAg
        ICAgICAvLyBFeGVjdXRlcyB3aGVuZXZlciB0aGUgImRpZEluc2VydEVsZW1l
        bnQiIGV2ZW50IGZpcmVzCiAgICAgIH0ub24oJ2RpZEluc2VydEVsZW1lbnQn
        KQogICAgfSk7CiAgICBgYGAKCiAgICBTZWUgYEVtYmVyLm9uYC4KCiAgICBA
        bWV0aG9kIG9uCiAgICBAZm9yIEZ1bmN0aW9uCiAgKi8KICBGdW5jdGlvbi5w
        cm90b3R5cGUub24gPSBmdW5jdGlvbigpIHsKICAgIHZhciBldmVudHMgPSBh
        X3NsaWNlLmNhbGwoYXJndW1lbnRzKTsKICAgIHRoaXMuX19lbWJlcl9saXN0
        ZW5zX18gPSBldmVudHM7CiAgICByZXR1cm4gdGhpczsKICB9Owp9CgoKfSko
        KTsKCgoKKGZ1bmN0aW9uKCkgewoKfSkoKTsKCgoKKGZ1bmN0aW9uKCkgewov
        KioKQG1vZHVsZSBlbWJlcgpAc3VibW9kdWxlIGVtYmVyLXJ1bnRpbWUKKi8K
        CgovKioKICBJbXBsZW1lbnRzIHNvbWUgc3RhbmRhcmQgbWV0aG9kcyBmb3Ig
        Y29tcGFyaW5nIG9iamVjdHMuIEFkZCB0aGlzIG1peGluIHRvCiAgYW55IGNs
        YXNzIHlvdSBjcmVhdGUgdGhhdCBjYW4gY29tcGFyZSBpdHMgaW5zdGFuY2Vz
        LgoKICBZb3Ugc2hvdWxkIGltcGxlbWVudCB0aGUgYGNvbXBhcmUoKWAgbWV0
        aG9kLgoKICBAY2xhc3MgQ29tcGFyYWJsZQogIEBuYW1lc3BhY2UgRW1iZXIK
        ICBAc2luY2UgRW1iZXIgMC45CiovCkVtYmVyLkNvbXBhcmFibGUgPSBFbWJl
        ci5NaXhpbi5jcmVhdGUoIC8qKiBAc2NvcGUgRW1iZXIuQ29tcGFyYWJsZS5w
        cm90b3R5cGUgKi97CgogIC8qKgogICAgT3ZlcnJpZGUgdG8gcmV0dXJuIHRo
        ZSByZXN1bHQgb2YgdGhlIGNvbXBhcmlzb24gb2YgdGhlIHR3byBwYXJhbWV0
        ZXJzLiBUaGUKICAgIGNvbXBhcmUgbWV0aG9kIHNob3VsZCByZXR1cm46Cgog
        ICAgLSBgLTFgIGlmIGBhIDwgYmAKICAgIC0gYDBgIGlmIGBhID09IGJgCiAg
        ICAtIGAxYCBpZiBgYSA+IGJgCgogICAgRGVmYXVsdCBpbXBsZW1lbnRhdGlv
        biByYWlzZXMgYW4gZXhjZXB0aW9uLgoKICAgIEBtZXRob2QgY29tcGFyZQog
        ICAgQHBhcmFtIGEge09iamVjdH0gdGhlIGZpcnN0IG9iamVjdCB0byBjb21w
        YXJlCiAgICBAcGFyYW0gYiB7T2JqZWN0fSB0aGUgc2Vjb25kIG9iamVjdCB0
        byBjb21wYXJlCiAgICBAcmV0dXJuIHtJbnRlZ2VyfSB0aGUgcmVzdWx0IG9m
        IHRoZSBjb21wYXJpc29uCiAgKi8KICBjb21wYXJlOiBFbWJlci5yZXF1aXJl
        ZChGdW5jdGlvbikKCn0pOwoKCn0pKCk7CgoKCihmdW5jdGlvbigpIHsKLyoq
        CkBtb2R1bGUgZW1iZXIKQHN1Ym1vZHVsZSBlbWJlci1ydW50aW1lCiovCgoK
        CnZhciBnZXQgPSBFbWJlci5nZXQsIHNldCA9IEVtYmVyLnNldDsKCi8qKgog
        IEltcGxlbWVudHMgc29tZSBzdGFuZGFyZCBtZXRob2RzIGZvciBjb3B5aW5n
        IGFuIG9iamVjdC4gQWRkIHRoaXMgbWl4aW4gdG8KICBhbnkgb2JqZWN0IHlv
        dSBjcmVhdGUgdGhhdCBjYW4gY3JlYXRlIGEgY29weSBvZiBpdHNlbGYuIFRo
        aXMgbWl4aW4gaXMKICBhZGRlZCBhdXRvbWF0aWNhbGx5IHRvIHRoZSBidWls
        dC1pbiBhcnJheS4KCiAgWW91IHNob3VsZCBnZW5lcmFsbHkgaW1wbGVtZW50
        IHRoZSBgY29weSgpYCBtZXRob2QgdG8gcmV0dXJuIGEgY29weSBvZiB0aGUK
        ICByZWNlaXZlci4KCiAgTm90ZSB0aGF0IGBmcm96ZW5Db3B5KClgIHdpbGwg
        b25seSB3b3JrIGlmIHlvdSBhbHNvIGltcGxlbWVudAogIGBFbWJlci5GcmVl
        emFibGVgLgoKICBAY2xhc3MgQ29weWFibGUKICBAbmFtZXNwYWNlIEVtYmVy
        CiAgQHNpbmNlIEVtYmVyIDAuOQoqLwpFbWJlci5Db3B5YWJsZSA9IEVtYmVy
        Lk1peGluLmNyZWF0ZSgvKiogQHNjb3BlIEVtYmVyLkNvcHlhYmxlLnByb3Rv
        dHlwZSAqLyB7CgogIC8qKgogICAgT3ZlcnJpZGUgdG8gcmV0dXJuIGEgY29w
        eSBvZiB0aGUgcmVjZWl2ZXIuIERlZmF1bHQgaW1wbGVtZW50YXRpb24gcmFp
        c2VzCiAgICBhbiBleGNlcHRpb24uCgogICAgQG1ldGhvZCBjb3B5CiAgICBA
        cGFyYW0ge0Jvb2xlYW59IGRlZXAgaWYgYHRydWVgLCBhIGRlZXAgY29weSBv
        ZiB0aGUgb2JqZWN0IHNob3VsZCBiZSBtYWRlCiAgICBAcmV0dXJuIHtPYmpl
        Y3R9IGNvcHkgb2YgcmVjZWl2ZXIKICAqLwogIGNvcHk6IEVtYmVyLnJlcXVp
        cmVkKEZ1bmN0aW9uKSwKCiAgLyoqCiAgICBJZiB0aGUgb2JqZWN0IGltcGxl
        bWVudHMgYEVtYmVyLkZyZWV6YWJsZWAsIHRoZW4gdGhpcyB3aWxsIHJldHVy
        biBhIG5ldwogICAgY29weSBpZiB0aGUgb2JqZWN0IGlzIG5vdCBmcm96ZW4g
        YW5kIHRoZSByZWNlaXZlciBpZiB0aGUgb2JqZWN0IGlzIGZyb3plbi4KCiAg
        ICBSYWlzZXMgYW4gZXhjZXB0aW9uIGlmIHlvdSB0cnkgdG8gY2FsbCB0aGlz
        IG1ldGhvZCBvbiBhIG9iamVjdCB0aGF0IGRvZXMKICAgIG5vdCBzdXBwb3J0
        IGZyZWV6aW5nLgoKICAgIFlvdSBzaG91bGQgdXNlIHRoaXMgbWV0aG9kIHdo
        ZW5ldmVyIHlvdSB3YW50IGEgY29weSBvZiBhIGZyZWV6YWJsZSBvYmplY3QK
        ICAgIHNpbmNlIGEgZnJlZXphYmxlIG9iamVjdCBjYW4gc2ltcGx5IHJldHVy
        biBpdHNlbGYgd2l0aG91dCBhY3R1YWxseQogICAgY29uc3VtaW5nIG1vcmUg
        bWVtb3J5LgoKICAgIEBtZXRob2QgZnJvemVuQ29weQogICAgQHJldHVybiB7
        T2JqZWN0fSBjb3B5IG9mIHJlY2VpdmVyIG9yIHJlY2VpdmVyCiAgKi8KICBm
        cm96ZW5Db3B5OiBmdW5jdGlvbigpIHsKICAgIGlmIChFbWJlci5GcmVlemFi
        bGUgJiYgRW1iZXIuRnJlZXphYmxlLmRldGVjdCh0aGlzKSkgewogICAgICBy
        ZXR1cm4gZ2V0KHRoaXMsICdpc0Zyb3plbicpID8gdGhpcyA6IHRoaXMuY29w
        eSgpLmZyZWV6ZSgpOwogICAgfSBlbHNlIHsKICAgICAgdGhyb3cgbmV3IEVt
        YmVyLkVycm9yKEVtYmVyLlN0cmluZy5mbXQoIiVAIGRvZXMgbm90IHN1cHBv
        cnQgZnJlZXppbmciLCBbdGhpc10pKTsKICAgIH0KICB9Cn0pOwoKfSkoKTsK
        CgoKKGZ1bmN0aW9uKCkgewovKioKQG1vZHVsZSBlbWJlcgpAc3VibW9kdWxl
        IGVtYmVyLXJ1bnRpbWUKKi8KCgp2YXIgZ2V0ID0gRW1iZXIuZ2V0LCBzZXQg
        PSBFbWJlci5zZXQ7CgovKioKICBUaGUgYEVtYmVyLkZyZWV6YWJsZWAgbWl4
        aW4gaW1wbGVtZW50cyBzb21lIGJhc2ljIG1ldGhvZHMgZm9yIG1hcmtpbmcg
        YW4KICBvYmplY3QgYXMgZnJvemVuLiBPbmNlIGFuIG9iamVjdCBpcyBmcm96
        ZW4gaXQgc2hvdWxkIGJlIHJlYWQgb25seS4gTm8gY2hhbmdlcwogIG1heSBi
        ZSBtYWRlIHRoZSBpbnRlcm5hbCBzdGF0ZSBvZiB0aGUgb2JqZWN0LgoKICAj
        IyBFbmZvcmNlbWVudAoKICBUbyBmdWxseSBzdXBwb3J0IGZyZWV6aW5nIGlu
        IHlvdXIgc3ViY2xhc3MsIHlvdSBtdXN0IGluY2x1ZGUgdGhpcyBtaXhpbiBh
        bmQKICBvdmVycmlkZSBhbnkgbWV0aG9kIHRoYXQgbWlnaHQgYWx0ZXIgYW55
        IHByb3BlcnR5IG9uIHRoZSBvYmplY3QgdG8gaW5zdGVhZAogIHJhaXNlIGFu
        IGV4Y2VwdGlvbi4gWW91IGNhbiBjaGVjayB0aGUgc3RhdGUgb2YgYW4gb2Jq
        ZWN0IGJ5IGNoZWNraW5nIHRoZQogIGBpc0Zyb3plbmAgcHJvcGVydHkuCgog
        IEFsdGhvdWdoIGZ1dHVyZSB2ZXJzaW9ucyBvZiBKYXZhU2NyaXB0IG1heSBz
        dXBwb3J0IGxhbmd1YWdlLWxldmVsIGZyZWV6aW5nCiAgb2JqZWN0IG9iamVj
        dHMsIHRoYXQgaXMgbm90IHRoZSBjYXNlIHRvZGF5LiBFdmVuIGlmIGFuIG9i
        amVjdCBpcyBmcmVlemFibGUsCiAgaXQgaXMgc3RpbGwgdGVjaG5pY2FsbHkg
        cG9zc2libGUgdG8gbW9kaWZ5IHRoZSBvYmplY3QsIGV2ZW4gdGhvdWdoIGl0
        IGNvdWxkCiAgYnJlYWsgb3RoZXIgcGFydHMgb2YgeW91ciBhcHBsaWNhdGlv
        biB0aGF0IGRvIG5vdCBleHBlY3QgYSBmcm96ZW4gb2JqZWN0IHRvCiAgY2hh
        bmdlLiBJdCBpcywgdGhlcmVmb3JlLCB2ZXJ5IGltcG9ydGFudCB0aGF0IHlv
        dSBhbHdheXMgcmVzcGVjdCB0aGUKICBgaXNGcm96ZW5gIHByb3BlcnR5IG9u
        IGFsbCBmcmVlemFibGUgb2JqZWN0cy4KCiAgIyMgRXhhbXBsZSBVc2FnZQoK
        ICBUaGUgZXhhbXBsZSBiZWxvdyBzaG93cyBhIHNpbXBsZSBvYmplY3QgdGhh
        dCBpbXBsZW1lbnQgdGhlIGBFbWJlci5GcmVlemFibGVgCiAgcHJvdG9jb2wu
        CgogIGBgYGphdmFzY3JpcHQKICBDb250YWN0ID0gRW1iZXIuT2JqZWN0LmV4
        dGVuZChFbWJlci5GcmVlemFibGUsIHsKICAgIGZpcnN0TmFtZTogbnVsbCwK
        ICAgIGxhc3ROYW1lOiBudWxsLAoKICAgIC8vIHN3YXBzIHRoZSBuYW1lcwog
        ICAgc3dhcE5hbWVzOiBmdW5jdGlvbigpIHsKICAgICAgaWYgKHRoaXMuZ2V0
        KCdpc0Zyb3plbicpKSB0aHJvdyBFbWJlci5GUk9aRU5fRVJST1I7CiAgICAg
        IHZhciB0bXAgPSB0aGlzLmdldCgnZmlyc3ROYW1lJyk7CiAgICAgIHRoaXMu
        c2V0KCdmaXJzdE5hbWUnLCB0aGlzLmdldCgnbGFzdE5hbWUnKSk7CiAgICAg
        IHRoaXMuc2V0KCdsYXN0TmFtZScsIHRtcCk7CiAgICAgIHJldHVybiB0aGlz
        OwogICAgfQoKICB9KTsKCiAgYyA9IENvbnRleHQuY3JlYXRlKHsgZmlyc3RO
        YW1lOiAiSm9obiIsIGxhc3ROYW1lOiAiRG9lIiB9KTsKICBjLnN3YXBOYW1l
        cygpOyAgLy8gcmV0dXJucyBjCiAgYy5mcmVlemUoKTsKICBjLnN3YXBOYW1l
        cygpOyAgLy8gRVhDRVBUSU9OCiAgYGBgCgogICMjIENvcHlpbmcKCiAgVXN1
        YWxseSB0aGUgYEVtYmVyLkZyZWV6YWJsZWAgcHJvdG9jb2wgaXMgaW1wbGVt
        ZW50ZWQgaW4gY29vcGVyYXRpb24gd2l0aCB0aGUKICBgRW1iZXIuQ29weWFi
        bGVgIHByb3RvY29sLCB3aGljaCBkZWZpbmVzIGEgYGZyb3plbkNvcHkoKWAg
        bWV0aG9kIHRoYXQgd2lsbAogIHJldHVybiBhIGZyb3plbiBvYmplY3QsIGlm
        IHRoZSBvYmplY3QgaW1wbGVtZW50cyB0aGlzIG1ldGhvZCBhcyB3ZWxsLgoK
        ICBAY2xhc3MgRnJlZXphYmxlCiAgQG5hbWVzcGFjZSBFbWJlcgogIEBzaW5j
        ZSBFbWJlciAwLjkKKi8KRW1iZXIuRnJlZXphYmxlID0gRW1iZXIuTWl4aW4u
        Y3JlYXRlKC8qKiBAc2NvcGUgRW1iZXIuRnJlZXphYmxlLnByb3RvdHlwZSAq
        LyB7CgogIC8qKgogICAgU2V0IHRvIGB0cnVlYCB3aGVuIHRoZSBvYmplY3Qg
        aXMgZnJvemVuLiBVc2UgdGhpcyBwcm9wZXJ0eSB0byBkZXRlY3QKICAgIHdo
        ZXRoZXIgeW91ciBvYmplY3QgaXMgZnJvemVuIG9yIG5vdC4KCiAgICBAcHJv
        cGVydHkgaXNGcm96ZW4KICAgIEB0eXBlIEJvb2xlYW4KICAqLwogIGlzRnJv
        emVuOiBmYWxzZSwKCiAgLyoqCiAgICBGcmVlemVzIHRoZSBvYmplY3QuIE9u
        Y2UgdGhpcyBtZXRob2QgaGFzIGJlZW4gY2FsbGVkIHRoZSBvYmplY3Qgc2hv
        dWxkCiAgICBubyBsb25nZXIgYWxsb3cgYW55IHByb3BlcnRpZXMgdG8gYmUg
        ZWRpdGVkLgoKICAgIEBtZXRob2QgZnJlZXplCiAgICBAcmV0dXJuIHtPYmpl
        Y3R9IHJlY2VpdmVyCiAgKi8KICBmcmVlemU6IGZ1bmN0aW9uKCkgewogICAg
        aWYgKGdldCh0aGlzLCAnaXNGcm96ZW4nKSkgcmV0dXJuIHRoaXM7CiAgICBz
        ZXQodGhpcywgJ2lzRnJvemVuJywgdHJ1ZSk7CiAgICByZXR1cm4gdGhpczsK
        ICB9Cgp9KTsKCkVtYmVyLkZST1pFTl9FUlJPUiA9ICJGcm96ZW4gb2JqZWN0
        IGNhbm5vdCBiZSBtb2RpZmllZC4iOwoKfSkoKTsKCgoKKGZ1bmN0aW9uKCkg
        ewovKioKQG1vZHVsZSBlbWJlcgpAc3VibW9kdWxlIGVtYmVyLXJ1bnRpbWUK
        Ki8KCnZhciBmb3JFYWNoID0gRW1iZXIuRW51bWVyYWJsZVV0aWxzLmZvckVh
        Y2g7CgovKioKICBUaGlzIG1peGluIGRlZmluZXMgdGhlIEFQSSBmb3IgbW9k
        aWZ5aW5nIGdlbmVyaWMgZW51bWVyYWJsZXMuIFRoZXNlIG1ldGhvZHMKICBj
        YW4gYmUgYXBwbGllZCB0byBhbiBvYmplY3QgcmVnYXJkbGVzcyBvZiB3aGV0
        aGVyIGl0IGlzIG9yZGVyZWQgb3IKICB1bm9yZGVyZWQuCgogIE5vdGUgdGhh
        dCBhbiBFbnVtZXJhYmxlIGNhbiBjaGFuZ2UgZXZlbiBpZiBpdCBkb2VzIG5v
        dCBpbXBsZW1lbnQgdGhpcyBtaXhpbi4KICBGb3IgZXhhbXBsZSwgYSBNYXBw
        ZWRFbnVtZXJhYmxlIGNhbm5vdCBiZSBkaXJlY3RseSBtb2RpZmllZCBidXQg
        aWYgaXRzCiAgdW5kZXJseWluZyBlbnVtZXJhYmxlIGNoYW5nZXMsIGl0IHdp
        bGwgY2hhbmdlIGFsc28uCgogICMjIEFkZGluZyBPYmplY3RzCgogIFRvIGFk
        ZCBhbiBvYmplY3QgdG8gYW4gZW51bWVyYWJsZSwgdXNlIHRoZSBgYWRkT2Jq
        ZWN0KClgIG1ldGhvZC4gVGhpcwogIG1ldGhvZCB3aWxsIG9ubHkgYWRkIHRo
        ZSBvYmplY3QgdG8gdGhlIGVudW1lcmFibGUgaWYgdGhlIG9iamVjdCBpcyBu
        b3QKICBhbHJlYWR5IHByZXNlbnQgYW5kIGlzIG9mIGEgdHlwZSBzdXBwb3J0
        ZWQgYnkgdGhlIGVudW1lcmFibGUuCgogIGBgYGphdmFzY3JpcHQKICBzZXQu
        YWRkT2JqZWN0KGNvbnRhY3QpOwogIGBgYAoKICAjIyBSZW1vdmluZyBPYmpl
        Y3RzCgogIFRvIHJlbW92ZSBhbiBvYmplY3QgZnJvbSBhbiBlbnVtZXJhYmxl
        LCB1c2UgdGhlIGByZW1vdmVPYmplY3QoKWAgbWV0aG9kLiBUaGlzCiAgd2ls
        bCBvbmx5IHJlbW92ZSB0aGUgb2JqZWN0IGlmIGl0IGlzIHByZXNlbnQgaW4g
        dGhlIGVudW1lcmFibGUsIG90aGVyd2lzZQogIHRoaXMgbWV0aG9kIGhhcyBu
        byBlZmZlY3QuCgogIGBgYGphdmFzY3JpcHQKICBzZXQucmVtb3ZlT2JqZWN0
        KGNvbnRhY3QpOwogIGBgYAoKICAjIyBJbXBsZW1lbnRpbmcgSW4gWW91ciBP
        d24gQ29kZQoKICBJZiB5b3UgYXJlIGltcGxlbWVudGluZyBhbiBvYmplY3Qg
        YW5kIHdhbnQgdG8gc3VwcG9ydCB0aGlzIEFQSSwganVzdCBpbmNsdWRlCiAg
        dGhpcyBtaXhpbiBpbiB5b3VyIGNsYXNzIGFuZCBpbXBsZW1lbnQgdGhlIHJl
        cXVpcmVkIG1ldGhvZHMuIEluIHlvdXIgdW5pdAogIHRlc3RzLCBiZSBzdXJl
        IHRvIGFwcGx5IHRoZSBFbWJlci5NdXRhYmxlRW51bWVyYWJsZVRlc3RzIHRv
        IHlvdXIgb2JqZWN0LgoKICBAY2xhc3MgTXV0YWJsZUVudW1lcmFibGUKICBA
        bmFtZXNwYWNlIEVtYmVyCiAgQHVzZXMgRW1iZXIuRW51bWVyYWJsZQoqLwpF
        bWJlci5NdXRhYmxlRW51bWVyYWJsZSA9IEVtYmVyLk1peGluLmNyZWF0ZShF
        bWJlci5FbnVtZXJhYmxlLCB7CgogIC8qKgogICAgX19SZXF1aXJlZC5fXyBZ
        b3UgbXVzdCBpbXBsZW1lbnQgdGhpcyBtZXRob2QgdG8gYXBwbHkgdGhpcyBt
        aXhpbi4KCiAgICBBdHRlbXB0cyB0byBhZGQgdGhlIHBhc3NlZCBvYmplY3Qg
        dG8gdGhlIHJlY2VpdmVyIGlmIHRoZSBvYmplY3QgaXMgbm90CiAgICBhbHJl
        YWR5IHByZXNlbnQgaW4gdGhlIGNvbGxlY3Rpb24uIElmIHRoZSBvYmplY3Qg
        aXMgcHJlc2VudCwgdGhpcyBtZXRob2QKICAgIGhhcyBubyBlZmZlY3QuCgog
        ICAgSWYgdGhlIHBhc3NlZCBvYmplY3QgaXMgb2YgYSB0eXBlIG5vdCBzdXBw
        b3J0ZWQgYnkgdGhlIHJlY2VpdmVyLAogICAgdGhlbiB0aGlzIG1ldGhvZCBz
        aG91bGQgcmFpc2UgYW4gZXhjZXB0aW9uLgoKICAgIEBtZXRob2QgYWRkT2Jq
        ZWN0CiAgICBAcGFyYW0ge09iamVjdH0gb2JqZWN0IFRoZSBvYmplY3QgdG8g
        YWRkIHRvIHRoZSBlbnVtZXJhYmxlLgogICAgQHJldHVybiB7T2JqZWN0fSB0
        aGUgcGFzc2VkIG9iamVjdAogICovCiAgYWRkT2JqZWN0OiBFbWJlci5yZXF1
        aXJlZChGdW5jdGlvbiksCgogIC8qKgogICAgQWRkcyBlYWNoIG9iamVjdCBp
        biB0aGUgcGFzc2VkIGVudW1lcmFibGUgdG8gdGhlIHJlY2VpdmVyLgoKICAg
        IEBtZXRob2QgYWRkT2JqZWN0cwogICAgQHBhcmFtIHtFbWJlci5FbnVtZXJh
        YmxlfSBvYmplY3RzIHRoZSBvYmplY3RzIHRvIGFkZC4KICAgIEByZXR1cm4g
        e09iamVjdH0gcmVjZWl2ZXIKICAqLwogIGFkZE9iamVjdHM6IGZ1bmN0aW9u
        KG9iamVjdHMpIHsKICAgIEVtYmVyLmJlZ2luUHJvcGVydHlDaGFuZ2VzKHRo
        aXMpOwogICAgZm9yRWFjaChvYmplY3RzLCBmdW5jdGlvbihvYmopIHsgdGhp
        cy5hZGRPYmplY3Qob2JqKTsgfSwgdGhpcyk7CiAgICBFbWJlci5lbmRQcm9w
        ZXJ0eUNoYW5nZXModGhpcyk7CiAgICByZXR1cm4gdGhpczsKICB9LAoKICAv
        KioKICAgIF9fUmVxdWlyZWQuX18gWW91IG11c3QgaW1wbGVtZW50IHRoaXMg
        bWV0aG9kIHRvIGFwcGx5IHRoaXMgbWl4aW4uCgogICAgQXR0ZW1wdHMgdG8g
        cmVtb3ZlIHRoZSBwYXNzZWQgb2JqZWN0IGZyb20gdGhlIHJlY2VpdmVyIGNv
        bGxlY3Rpb24gaWYgdGhlCiAgICBvYmplY3QgaXMgcHJlc2VudCBpbiB0aGUg
        Y29sbGVjdGlvbi4gSWYgdGhlIG9iamVjdCBpcyBub3QgcHJlc2VudCwKICAg
        IHRoaXMgbWV0aG9kIGhhcyBubyBlZmZlY3QuCgogICAgSWYgdGhlIHBhc3Nl
        ZCBvYmplY3QgaXMgb2YgYSB0eXBlIG5vdCBzdXBwb3J0ZWQgYnkgdGhlIHJl
        Y2VpdmVyLAogICAgdGhlbiB0aGlzIG1ldGhvZCBzaG91bGQgcmFpc2UgYW4g
        ZXhjZXB0aW9uLgoKICAgIEBtZXRob2QgcmVtb3ZlT2JqZWN0CiAgICBAcGFy
        YW0ge09iamVjdH0gb2JqZWN0IFRoZSBvYmplY3QgdG8gcmVtb3ZlIGZyb20g
        dGhlIGVudW1lcmFibGUuCiAgICBAcmV0dXJuIHtPYmplY3R9IHRoZSBwYXNz
        ZWQgb2JqZWN0CiAgKi8KICByZW1vdmVPYmplY3Q6IEVtYmVyLnJlcXVpcmVk
        KEZ1bmN0aW9uKSwKCgogIC8qKgogICAgUmVtb3ZlcyBlYWNoIG9iamVjdCBp
        biB0aGUgcGFzc2VkIGVudW1lcmFibGUgZnJvbSB0aGUgcmVjZWl2ZXIuCgog
        ICAgQG1ldGhvZCByZW1vdmVPYmplY3RzCiAgICBAcGFyYW0ge0VtYmVyLkVu
        dW1lcmFibGV9IG9iamVjdHMgdGhlIG9iamVjdHMgdG8gcmVtb3ZlCiAgICBA
        cmV0dXJuIHtPYmplY3R9IHJlY2VpdmVyCiAgKi8KICByZW1vdmVPYmplY3Rz
        OiBmdW5jdGlvbihvYmplY3RzKSB7CiAgICBFbWJlci5iZWdpblByb3BlcnR5
        Q2hhbmdlcyh0aGlzKTsKICAgIGZvckVhY2gob2JqZWN0cywgZnVuY3Rpb24o
        b2JqKSB7IHRoaXMucmVtb3ZlT2JqZWN0KG9iaik7IH0sIHRoaXMpOwogICAg
        RW1iZXIuZW5kUHJvcGVydHlDaGFuZ2VzKHRoaXMpOwogICAgcmV0dXJuIHRo
        aXM7CiAgfQoKfSk7Cgp9KSgpOwoKCgooZnVuY3Rpb24oKSB7Ci8qKgpAbW9k
        dWxlIGVtYmVyCkBzdWJtb2R1bGUgZW1iZXItcnVudGltZQoqLwovLyAuLi4u
        Li4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4u
        Li4uLi4uLi4uCi8vIENPTlNUQU5UUwovLwoKdmFyIE9VVF9PRl9SQU5HRV9F
        WENFUFRJT04gPSAiSW5kZXggb3V0IG9mIHJhbmdlIiA7CnZhciBFTVBUWSA9
        IFtdOwoKLy8gLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4u
        Li4uLi4uLi4uLi4uLi4uLi4uLi4uLgovLyBIRUxQRVJTCi8vCgp2YXIgZ2V0
        ID0gRW1iZXIuZ2V0LCBzZXQgPSBFbWJlci5zZXQ7CgovKioKICBUaGlzIG1p
        eGluIGRlZmluZXMgdGhlIEFQSSBmb3IgbW9kaWZ5aW5nIGFycmF5LWxpa2Ug
        b2JqZWN0cy4gVGhlc2UgbWV0aG9kcwogIGNhbiBiZSBhcHBsaWVkIG9ubHkg
        dG8gYSBjb2xsZWN0aW9uIHRoYXQga2VlcHMgaXRzIGl0ZW1zIGluIGFuIG9y
        ZGVyZWQgc2V0LgoKICBOb3RlIHRoYXQgYW4gQXJyYXkgY2FuIGNoYW5nZSBl
        dmVuIGlmIGl0IGRvZXMgbm90IGltcGxlbWVudCB0aGlzIG1peGluLgogIEZv
        ciBleGFtcGxlLCBvbmUgbWlnaHQgaW1wbGVtZW50IGEgU3BhcnNlQXJyYXkg
        dGhhdCBjYW5ub3QgYmUgZGlyZWN0bHkKICBtb2RpZmllZCwgYnV0IGlmIGl0
        cyB1bmRlcmx5aW5nIGVudW1lcmFibGUgY2hhbmdlcywgaXQgd2lsbCBjaGFu
        Z2UgYWxzby4KCiAgQGNsYXNzIE11dGFibGVBcnJheQogIEBuYW1lc3BhY2Ug
        RW1iZXIKICBAdXNlcyBFbWJlci5BcnJheQogIEB1c2VzIEVtYmVyLk11dGFi
        bGVFbnVtZXJhYmxlCiovCkVtYmVyLk11dGFibGVBcnJheSA9IEVtYmVyLk1p
        eGluLmNyZWF0ZShFbWJlci5BcnJheSwgRW1iZXIuTXV0YWJsZUVudW1lcmFi
        bGUsLyoqIEBzY29wZSBFbWJlci5NdXRhYmxlQXJyYXkucHJvdG90eXBlICov
        IHsKCiAgLyoqCiAgICBfX1JlcXVpcmVkLl9fIFlvdSBtdXN0IGltcGxlbWVu
        dCB0aGlzIG1ldGhvZCB0byBhcHBseSB0aGlzIG1peGluLgoKICAgIFRoaXMg
        aXMgb25lIG9mIHRoZSBwcmltaXRpdmVzIHlvdSBtdXN0IGltcGxlbWVudCB0
        byBzdXBwb3J0IGBFbWJlci5BcnJheWAuCiAgICBZb3Ugc2hvdWxkIHJlcGxh
        Y2UgYW10IG9iamVjdHMgc3RhcnRlZCBhdCBpZHggd2l0aCB0aGUgb2JqZWN0
        cyBpbiB0aGUKICAgIHBhc3NlZCBhcnJheS4gWW91IHNob3VsZCBhbHNvIGNh
        bGwgYHRoaXMuZW51bWVyYWJsZUNvbnRlbnREaWRDaGFuZ2UoKWAKCiAgICBA
        bWV0aG9kIHJlcGxhY2UKICAgIEBwYXJhbSB7TnVtYmVyfSBpZHggU3RhcnRp
        bmcgaW5kZXggaW4gdGhlIGFycmF5IHRvIHJlcGxhY2UuIElmCiAgICAgIGlk
        eCA+PSBsZW5ndGgsIHRoZW4gYXBwZW5kIHRvIHRoZSBlbmQgb2YgdGhlIGFy
        cmF5LgogICAgQHBhcmFtIHtOdW1iZXJ9IGFtdCBOdW1iZXIgb2YgZWxlbWVu
        dHMgdGhhdCBzaG91bGQgYmUgcmVtb3ZlZCBmcm9tCiAgICAgIHRoZSBhcnJh
        eSwgc3RhcnRpbmcgYXQgKmlkeCouCiAgICBAcGFyYW0ge0FycmF5fSBvYmpl
        Y3RzIEFuIGFycmF5IG9mIHplcm8gb3IgbW9yZSBvYmplY3RzIHRoYXQgc2hv
        dWxkIGJlCiAgICAgIGluc2VydGVkIGludG8gdGhlIGFycmF5IGF0ICppZHgq
        CiAgKi8KICByZXBsYWNlOiBFbWJlci5yZXF1aXJlZCgpLAoKICAvKioKICAg
        IFJlbW92ZSBhbGwgZWxlbWVudHMgZnJvbSBzZWxmLiBUaGlzIGlzIHVzZWZ1
        bCBpZiB5b3UKICAgIHdhbnQgdG8gcmV1c2UgYW4gZXhpc3RpbmcgYXJyYXkg
        d2l0aG91dCBoYXZpbmcgdG8gcmVjcmVhdGUgaXQuCgogICAgYGBgamF2YXNj
        cmlwdAogICAgdmFyIGNvbG9ycyA9IFsicmVkIiwgImdyZWVuIiwgImJsdWUi
        XTsKICAgIGNvbG9yLmxlbmd0aCgpOyAgIC8vICAzCiAgICBjb2xvcnMuY2xl
        YXIoKTsgICAvLyAgW10KICAgIGNvbG9ycy5sZW5ndGgoKTsgIC8vICAwCiAg
        ICBgYGAKCiAgICBAbWV0aG9kIGNsZWFyCiAgICBAcmV0dXJuIHtFbWJlci5B
        cnJheX0gQW4gZW1wdHkgQXJyYXkuCiAgKi8KICBjbGVhcjogZnVuY3Rpb24g
        KCkgewogICAgdmFyIGxlbiA9IGdldCh0aGlzLCAnbGVuZ3RoJyk7CiAgICBp
        ZiAobGVuID09PSAwKSByZXR1cm4gdGhpczsKICAgIHRoaXMucmVwbGFjZSgw
        LCBsZW4sIEVNUFRZKTsKICAgIHJldHVybiB0aGlzOwogIH0sCgogIC8qKgog
        ICAgVGhpcyB3aWxsIHVzZSB0aGUgcHJpbWl0aXZlIGByZXBsYWNlKClgIG1l
        dGhvZCB0byBpbnNlcnQgYW4gb2JqZWN0IGF0IHRoZQogICAgc3BlY2lmaWVk
        IGluZGV4LgoKICAgIGBgYGphdmFzY3JpcHQKICAgIHZhciBjb2xvcnMgPSBb
        InJlZCIsICJncmVlbiIsICJibHVlIl07CiAgICBjb2xvcnMuaW5zZXJ0QXQo
        MiwgInllbGxvdyIpOyAgLy8gWyJyZWQiLCAiZ3JlZW4iLCAieWVsbG93Iiwg
        ImJsdWUiXQogICAgY29sb3JzLmluc2VydEF0KDUsICJvcmFuZ2UiKTsgIC8v
        IEVycm9yOiBJbmRleCBvdXQgb2YgcmFuZ2UKICAgIGBgYAoKICAgIEBtZXRo
        b2QgaW5zZXJ0QXQKICAgIEBwYXJhbSB7TnVtYmVyfSBpZHggaW5kZXggb2Yg
        aW5zZXJ0IHRoZSBvYmplY3QgYXQuCiAgICBAcGFyYW0ge09iamVjdH0gb2Jq
        ZWN0IG9iamVjdCB0byBpbnNlcnQKICAgIEByZXR1cm4gdGhpcwogICovCiAg
        aW5zZXJ0QXQ6IGZ1bmN0aW9uKGlkeCwgb2JqZWN0KSB7CiAgICBpZiAoaWR4
        ID4gZ2V0KHRoaXMsICdsZW5ndGgnKSkgdGhyb3cgbmV3IEVtYmVyLkVycm9y
        KE9VVF9PRl9SQU5HRV9FWENFUFRJT04pIDsKICAgIHRoaXMucmVwbGFjZShp
        ZHgsIDAsIFtvYmplY3RdKSA7CiAgICByZXR1cm4gdGhpcyA7CiAgfSwKCiAg
        LyoqCiAgICBSZW1vdmUgYW4gb2JqZWN0IGF0IHRoZSBzcGVjaWZpZWQgaW5k
        ZXggdXNpbmcgdGhlIGByZXBsYWNlKClgIHByaW1pdGl2ZQogICAgbWV0aG9k
        LiBZb3UgY2FuIHBhc3MgZWl0aGVyIGEgc2luZ2xlIGluZGV4LCBvciBhIHN0
        YXJ0IGFuZCBhIGxlbmd0aC4KCiAgICBJZiB5b3UgcGFzcyBhIHN0YXJ0IGFu
        ZCBsZW5ndGggdGhhdCBpcyBiZXlvbmQgdGhlCiAgICBsZW5ndGggdGhpcyBt
        ZXRob2Qgd2lsbCB0aHJvdyBhbiBgT1VUX09GX1JBTkdFX0VYQ0VQVElPTmAK
        CiAgICBgYGBqYXZhc2NyaXB0CiAgICB2YXIgY29sb3JzID0gWyJyZWQiLCAi
        Z3JlZW4iLCAiYmx1ZSIsICJ5ZWxsb3ciLCAib3JhbmdlIl07CiAgICBjb2xv
        cnMucmVtb3ZlQXQoMCk7ICAgICAvLyBbImdyZWVuIiwgImJsdWUiLCAieWVs
        bG93IiwgIm9yYW5nZSJdCiAgICBjb2xvcnMucmVtb3ZlQXQoMiwgMik7ICAv
        LyBbImdyZWVuIiwgImJsdWUiXQogICAgY29sb3JzLnJlbW92ZUF0KDQsIDIp
        OyAgLy8gRXJyb3I6IEluZGV4IG91dCBvZiByYW5nZQogICAgYGBgCgogICAg
        QG1ldGhvZCByZW1vdmVBdAogICAgQHBhcmFtIHtOdW1iZXJ9IHN0YXJ0IGlu
        ZGV4LCBzdGFydCBvZiByYW5nZQogICAgQHBhcmFtIHtOdW1iZXJ9IGxlbiBs
        ZW5ndGggb2YgcGFzc2luZyByYW5nZQogICAgQHJldHVybiB7T2JqZWN0fSBy
        ZWNlaXZlcgogICovCiAgcmVtb3ZlQXQ6IGZ1bmN0aW9uKHN0YXJ0LCBsZW4p
        IHsKICAgIGlmICgnbnVtYmVyJyA9PT0gdHlwZW9mIHN0YXJ0KSB7CgogICAg
        ICBpZiAoKHN0YXJ0IDwgMCkgfHwgKHN0YXJ0ID49IGdldCh0aGlzLCAnbGVu
        Z3RoJykpKSB7CiAgICAgICAgdGhyb3cgbmV3IEVtYmVyLkVycm9yKE9VVF9P
        Rl9SQU5HRV9FWENFUFRJT04pOwogICAgICB9CgogICAgICAvLyBmYXN0IGNh
        c2UKICAgICAgaWYgKGxlbiA9PT0gdW5kZWZpbmVkKSBsZW4gPSAxOwogICAg
        ICB0aGlzLnJlcGxhY2Uoc3RhcnQsIGxlbiwgRU1QVFkpOwogICAgfQoKICAg
        IHJldHVybiB0aGlzIDsKICB9LAoKICAvKioKICAgIFB1c2ggdGhlIG9iamVj
        dCBvbnRvIHRoZSBlbmQgb2YgdGhlIGFycmF5LiBXb3JrcyBqdXN0IGxpa2Ug
        YHB1c2goKWAgYnV0IGl0CiAgICBpcyBLVk8tY29tcGxpYW50LgoKICAgIGBg
        YGphdmFzY3JpcHQKICAgIHZhciBjb2xvcnMgPSBbInJlZCIsICJncmVlbiIs
        ICJibHVlIl07CiAgICBjb2xvcnMucHVzaE9iamVjdCgiYmxhY2siKTsgICAg
        ICAgICAgICAgICAvLyBbInJlZCIsICJncmVlbiIsICJibHVlIiwgImJsYWNr
        Il0KICAgIGNvbG9ycy5wdXNoT2JqZWN0KFsieWVsbG93IiwgIm9yYW5nZSJd
        KTsgIC8vIFsicmVkIiwgImdyZWVuIiwgImJsdWUiLCAiYmxhY2siLCBbInll
        bGxvdyIsICJvcmFuZ2UiXV0KICAgIGBgYAoKICAgIEBtZXRob2QgcHVzaE9i
        amVjdAogICAgQHBhcmFtIHsqfSBvYmogb2JqZWN0IHRvIHB1c2gKICAgIEBy
        ZXR1cm4geyp9IHRoZSBzYW1lIG9iaiBwYXNzZWQgYXMgcGFyYW0KICAqLwog
        IHB1c2hPYmplY3Q6IGZ1bmN0aW9uKG9iaikgewogICAgdGhpcy5pbnNlcnRB
        dChnZXQodGhpcywgJ2xlbmd0aCcpLCBvYmopIDsKICAgIHJldHVybiBvYmog
        OwogIH0sCgogIC8qKgogICAgQWRkIHRoZSBvYmplY3RzIGluIHRoZSBwYXNz
        ZWQgbnVtZXJhYmxlIHRvIHRoZSBlbmQgb2YgdGhlIGFycmF5LiBEZWZlcnMK
        ICAgIG5vdGlmeWluZyBvYnNlcnZlcnMgb2YgdGhlIGNoYW5nZSB1bnRpbCBh
        bGwgb2JqZWN0cyBhcmUgYWRkZWQuCgogICAgYGBgamF2YXNjcmlwdAogICAg
        dmFyIGNvbG9ycyA9IFsicmVkIiwgImdyZWVuIiwgImJsdWUiXTsKICAgIGNv
        bG9ycy5wdXNoT2JqZWN0cyhbImJsYWNrIl0pOyAgICAgICAgICAgICAgIC8v
        IFsicmVkIiwgImdyZWVuIiwgImJsdWUiLCAiYmxhY2siXQogICAgY29sb3Jz
        LnB1c2hPYmplY3RzKFsieWVsbG93IiwgIm9yYW5nZSJdKTsgIC8vIFsicmVk
        IiwgImdyZWVuIiwgImJsdWUiLCAiYmxhY2siLCAieWVsbG93IiwgIm9yYW5n
        ZSJdCiAgICBgYGAKCiAgICBAbWV0aG9kIHB1c2hPYmplY3RzCiAgICBAcGFy
        YW0ge0VtYmVyLkVudW1lcmFibGV9IG9iamVjdHMgdGhlIG9iamVjdHMgdG8g
        YWRkCiAgICBAcmV0dXJuIHtFbWJlci5BcnJheX0gcmVjZWl2ZXIKICAqLwog
        IHB1c2hPYmplY3RzOiBmdW5jdGlvbihvYmplY3RzKSB7CiAgICBpZiAoIShF
        bWJlci5FbnVtZXJhYmxlLmRldGVjdChvYmplY3RzKSB8fCBFbWJlci5pc0Fy
        cmF5KG9iamVjdHMpKSkgewogICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCJN
        dXN0IHBhc3MgRW1iZXIuRW51bWVyYWJsZSB0byBFbWJlci5NdXRhYmxlQXJy
        YXkjcHVzaE9iamVjdHMiKTsKICAgIH0KICAgIHRoaXMucmVwbGFjZShnZXQo
        dGhpcywgJ2xlbmd0aCcpLCAwLCBvYmplY3RzKTsKICAgIHJldHVybiB0aGlz
        OwogIH0sCgogIC8qKgogICAgUG9wIG9iamVjdCBmcm9tIGFycmF5IG9yIG5p
        bCBpZiBub25lIGFyZSBsZWZ0LiBXb3JrcyBqdXN0IGxpa2UgYHBvcCgpYCBi
        dXQKICAgIGl0IGlzIEtWTy1jb21wbGlhbnQuCgogICAgYGBgamF2YXNjcmlw
        dAogICAgdmFyIGNvbG9ycyA9IFsicmVkIiwgImdyZWVuIiwgImJsdWUiXTsK
        ICAgIGNvbG9ycy5wb3BPYmplY3QoKTsgICAvLyAiYmx1ZSIKICAgIGNvbnNv
        bGUubG9nKGNvbG9ycyk7ICAvLyBbInJlZCIsICJncmVlbiJdCiAgICBgYGAK
        CiAgICBAbWV0aG9kIHBvcE9iamVjdAogICAgQHJldHVybiBvYmplY3QKICAq
        LwogIHBvcE9iamVjdDogZnVuY3Rpb24oKSB7CiAgICB2YXIgbGVuID0gZ2V0
        KHRoaXMsICdsZW5ndGgnKSA7CiAgICBpZiAobGVuID09PSAwKSByZXR1cm4g
        bnVsbCA7CgogICAgdmFyIHJldCA9IHRoaXMub2JqZWN0QXQobGVuLTEpIDsK
        ICAgIHRoaXMucmVtb3ZlQXQobGVuLTEsIDEpIDsKICAgIHJldHVybiByZXQg
        OwogIH0sCgogIC8qKgogICAgU2hpZnQgYW4gb2JqZWN0IGZyb20gc3RhcnQg
        b2YgYXJyYXkgb3IgbmlsIGlmIG5vbmUgYXJlIGxlZnQuIFdvcmtzIGp1c3QK
        ICAgIGxpa2UgYHNoaWZ0KClgIGJ1dCBpdCBpcyBLVk8tY29tcGxpYW50LgoK
        ICAgIGBgYGphdmFzY3JpcHQKICAgIHZhciBjb2xvcnMgPSBbInJlZCIsICJn
        cmVlbiIsICJibHVlIl07CiAgICBjb2xvcnMuc2hpZnRPYmplY3QoKTsgIC8v
        ICJyZWQiCiAgICBjb25zb2xlLmxvZyhjb2xvcnMpOyAgIC8vIFsiZ3JlZW4i
        LCAiYmx1ZSJdCiAgICBgYGAKCiAgICBAbWV0aG9kIHNoaWZ0T2JqZWN0CiAg
        ICBAcmV0dXJuIG9iamVjdAogICovCiAgc2hpZnRPYmplY3Q6IGZ1bmN0aW9u
        KCkgewogICAgaWYgKGdldCh0aGlzLCAnbGVuZ3RoJykgPT09IDApIHJldHVy
        biBudWxsIDsKICAgIHZhciByZXQgPSB0aGlzLm9iamVjdEF0KDApIDsKICAg
        IHRoaXMucmVtb3ZlQXQoMCkgOwogICAgcmV0dXJuIHJldCA7CiAgfSwKCiAg
        LyoqCiAgICBVbnNoaWZ0IGFuIG9iamVjdCB0byBzdGFydCBvZiBhcnJheS4g
        V29ya3MganVzdCBsaWtlIGB1bnNoaWZ0KClgIGJ1dCBpdCBpcwogICAgS1ZP
        LWNvbXBsaWFudC4KCiAgICBgYGBqYXZhc2NyaXB0CiAgICB2YXIgY29sb3Jz
        ID0gWyJyZWQiLCAiZ3JlZW4iLCAiYmx1ZSJdOwogICAgY29sb3JzLnVuc2hp
        ZnRPYmplY3QoInllbGxvdyIpOyAgICAgICAgICAgICAvLyBbInllbGxvdyIs
        ICJyZWQiLCAiZ3JlZW4iLCAiYmx1ZSJdCiAgICBjb2xvcnMudW5zaGlmdE9i
        amVjdChbImJsYWNrIiwgIndoaXRlIl0pOyAgIC8vIFtbImJsYWNrIiwgIndo
        aXRlIl0sICJ5ZWxsb3ciLCAicmVkIiwgImdyZWVuIiwgImJsdWUiXQogICAg
        YGBgCgogICAgQG1ldGhvZCB1bnNoaWZ0T2JqZWN0CiAgICBAcGFyYW0geyp9
        IG9iaiBvYmplY3QgdG8gdW5zaGlmdAogICAgQHJldHVybiB7Kn0gdGhlIHNh
        bWUgb2JqIHBhc3NlZCBhcyBwYXJhbQogICovCiAgdW5zaGlmdE9iamVjdDog
        ZnVuY3Rpb24ob2JqKSB7CiAgICB0aGlzLmluc2VydEF0KDAsIG9iaikgOwog
        ICAgcmV0dXJuIG9iaiA7CiAgfSwKCiAgLyoqCiAgICBBZGRzIHRoZSBuYW1l
        ZCBvYmplY3RzIHRvIHRoZSBiZWdpbm5pbmcgb2YgdGhlIGFycmF5LiBEZWZl
        cnMgbm90aWZ5aW5nCiAgICBvYnNlcnZlcnMgdW50aWwgYWxsIG9iamVjdHMg
        aGF2ZSBiZWVuIGFkZGVkLgoKICAgIGBgYGphdmFzY3JpcHQKICAgIHZhciBj
        b2xvcnMgPSBbInJlZCIsICJncmVlbiIsICJibHVlIl07CiAgICBjb2xvcnMu
        dW5zaGlmdE9iamVjdHMoWyJibGFjayIsICJ3aGl0ZSJdKTsgICAvLyBbImJs
        YWNrIiwgIndoaXRlIiwgInJlZCIsICJncmVlbiIsICJibHVlIl0KICAgIGNv
        bG9ycy51bnNoaWZ0T2JqZWN0cygieWVsbG93Iik7ICAgICAgICAgICAgIC8v
        IFR5cGUgRXJyb3I6ICd1bmRlZmluZWQnIGlzIG5vdCBhIGZ1bmN0aW9uCiAg
        ICBgYGAKCiAgICBAbWV0aG9kIHVuc2hpZnRPYmplY3RzCiAgICBAcGFyYW0g
        e0VtYmVyLkVudW1lcmFibGV9IG9iamVjdHMgdGhlIG9iamVjdHMgdG8gYWRk
        CiAgICBAcmV0dXJuIHtFbWJlci5BcnJheX0gcmVjZWl2ZXIKICAqLwogIHVu
        c2hpZnRPYmplY3RzOiBmdW5jdGlvbihvYmplY3RzKSB7CiAgICB0aGlzLnJl
        cGxhY2UoMCwgMCwgb2JqZWN0cyk7CiAgICByZXR1cm4gdGhpczsKICB9LAoK
        ICAvKioKICAgIFJldmVyc2Ugb2JqZWN0cyBpbiB0aGUgYXJyYXkuIFdvcmtz
        IGp1c3QgbGlrZSBgcmV2ZXJzZSgpYCBidXQgaXQgaXMKICAgIEtWTy1jb21w
        bGlhbnQuCgogICAgQG1ldGhvZCByZXZlcnNlT2JqZWN0cwogICAgQHJldHVy
        biB7RW1iZXIuQXJyYXl9IHJlY2VpdmVyCiAgICovCiAgcmV2ZXJzZU9iamVj
        dHM6IGZ1bmN0aW9uKCkgewogICAgdmFyIGxlbiA9IGdldCh0aGlzLCAnbGVu
        Z3RoJyk7CiAgICBpZiAobGVuID09PSAwKSByZXR1cm4gdGhpczsKICAgIHZh
        ciBvYmplY3RzID0gdGhpcy50b0FycmF5KCkucmV2ZXJzZSgpOwogICAgdGhp
        cy5yZXBsYWNlKDAsIGxlbiwgb2JqZWN0cyk7CiAgICByZXR1cm4gdGhpczsK
        ICB9LAoKICAvKioKICAgIFJlcGxhY2UgYWxsIHRoZSB0aGUgcmVjZWl2ZXIn
        cyBjb250ZW50IHdpdGggY29udGVudCBvZiB0aGUgYXJndW1lbnQuCiAgICBJ
        ZiBhcmd1bWVudCBpcyBhbiBlbXB0eSBhcnJheSByZWNlaXZlciB3aWxsIGJl
        IGNsZWFyZWQuCgogICAgYGBgamF2YXNjcmlwdAogICAgdmFyIGNvbG9ycyA9
        IFsicmVkIiwgImdyZWVuIiwgImJsdWUiXTsKICAgIGNvbG9ycy5zZXRPYmpl
        Y3RzKFsiYmxhY2siLCAid2hpdGUiXSk7ICAvLyBbImJsYWNrIiwgIndoaXRl
        Il0KICAgIGNvbG9ycy5zZXRPYmplY3RzKFtdKTsgICAgICAgICAgICAgICAg
        ICAvLyBbXQogICAgYGBgCgogICAgQG1ldGhvZCBzZXRPYmplY3RzCiAgICBA
        cGFyYW0ge0VtYmVyLkFycmF5fSBvYmplY3RzIGFycmF5IHdob3NlIGNvbnRl
        bnQgd2lsbCBiZSB1c2VkIGZvciByZXBsYWNpbmcKICAgICAgICB0aGUgY29u
        dGVudCBvZiB0aGUgcmVjZWl2ZXIKICAgIEByZXR1cm4ge0VtYmVyLkFycmF5
        fSByZWNlaXZlciB3aXRoIHRoZSBuZXcgY29udGVudAogICAqLwogIHNldE9i
        amVjdHM6IGZ1bmN0aW9uKG9iamVjdHMpIHsKICAgIGlmIChvYmplY3RzLmxl
        bmd0aCA9PT0gMCkgcmV0dXJuIHRoaXMuY2xlYXIoKTsKCiAgICB2YXIgbGVu
        ID0gZ2V0KHRoaXMsICdsZW5ndGgnKTsKICAgIHRoaXMucmVwbGFjZSgwLCBs
        ZW4sIG9iamVjdHMpOwogICAgcmV0dXJuIHRoaXM7CiAgfSwKCiAgLy8gLi4u
        Li4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4u
        Li4uLi4uLi4uLgogIC8vIElNUExFTUVOVCBFbWJlci5NdXRhYmxlRW51bWVy
        YWJsZQogIC8vCgogIHJlbW92ZU9iamVjdDogZnVuY3Rpb24ob2JqKSB7CiAg
        ICB2YXIgbG9jID0gZ2V0KHRoaXMsICdsZW5ndGgnKSB8fCAwOwogICAgd2hp
        bGUoLS1sb2MgPj0gMCkgewogICAgICB2YXIgY3VyT2JqZWN0ID0gdGhpcy5v
        YmplY3RBdChsb2MpIDsKICAgICAgaWYgKGN1ck9iamVjdCA9PT0gb2JqKSB0
        aGlzLnJlbW92ZUF0KGxvYykgOwogICAgfQogICAgcmV0dXJuIHRoaXMgOwog
        IH0sCgogIGFkZE9iamVjdDogZnVuY3Rpb24ob2JqKSB7CiAgICBpZiAoIXRo
        aXMuY29udGFpbnMob2JqKSkgdGhpcy5wdXNoT2JqZWN0KG9iaik7CiAgICBy
        ZXR1cm4gdGhpcyA7CiAgfQoKfSk7Cgp9KSgpOwoKCgooZnVuY3Rpb24oKSB7
        Ci8qKgpAbW9kdWxlIGVtYmVyCkBzdWJtb2R1bGUgZW1iZXItcnVudGltZQoq
        LwoKdmFyIGdldCA9IEVtYmVyLmdldCwKICAgIHNldCA9IEVtYmVyLnNldCwK
        ICAgIHNsaWNlID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLAogICAgZ2V0UHJv
        cGVydGllcyA9IEVtYmVyLmdldFByb3BlcnRpZXM7CgovKioKICAjIyBPdmVy
        dmlldwoKICBUaGlzIG1peGluIHByb3ZpZGVzIHByb3BlcnRpZXMgYW5kIHBy
        b3BlcnR5IG9ic2VydmluZyBmdW5jdGlvbmFsaXR5LCBjb3JlCiAgZmVhdHVy
        ZXMgb2YgdGhlIEVtYmVyIG9iamVjdCBtb2RlbC4KCiAgUHJvcGVydGllcyBh
        bmQgb2JzZXJ2ZXJzIGFsbG93IG9uZSBvYmplY3QgdG8gb2JzZXJ2ZSBjaGFu
        Z2VzIHRvIGEKICBwcm9wZXJ0eSBvbiBhbm90aGVyIG9iamVjdC4gVGhpcyBp
        cyBvbmUgb2YgdGhlIGZ1bmRhbWVudGFsIHdheXMgdGhhdAogIG1vZGVscywg
        Y29udHJvbGxlcnMgYW5kIHZpZXdzIGNvbW11bmljYXRlIHdpdGggZWFjaCBv
        dGhlciBpbiBhbiBFbWJlcgogIGFwcGxpY2F0aW9uLgoKICBBbnkgb2JqZWN0
        IHRoYXQgaGFzIHRoaXMgbWl4aW4gYXBwbGllZCBjYW4gYmUgdXNlZCBpbiBv
        YnNlcnZlcgogIG9wZXJhdGlvbnMuIFRoYXQgaW5jbHVkZXMgYEVtYmVyLk9i
        amVjdGAgYW5kIG1vc3Qgb2JqZWN0cyB5b3Ugd2lsbAogIGludGVyYWN0IHdp
        dGggYXMgeW91IHdyaXRlIHlvdXIgRW1iZXIgYXBwbGljYXRpb24uCgogIE5v
        dGUgdGhhdCB5b3Ugd2lsbCBub3QgZ2VuZXJhbGx5IGFwcGx5IHRoaXMgbWl4
        aW4gdG8gY2xhc3NlcyB5b3Vyc2VsZiwKICBidXQgeW91IHdpbGwgdXNlIHRo
        ZSBmZWF0dXJlcyBwcm92aWRlZCBieSB0aGlzIG1vZHVsZSBmcmVxdWVudGx5
        LCBzbyBpdAogIGlzIGltcG9ydGFudCB0byB1bmRlcnN0YW5kIGhvdyB0byB1
        c2UgaXQuCgogICMjIFVzaW5nIGBnZXQoKWAgYW5kIGBzZXQoKWAKCiAgQmVj
        YXVzZSBvZiBFbWJlcidzIHN1cHBvcnQgZm9yIGJpbmRpbmdzIGFuZCBvYnNl
        cnZlcnMsIHlvdSB3aWxsIGFsd2F5cwogIGFjY2VzcyBwcm9wZXJ0aWVzIHVz
        aW5nIHRoZSBnZXQgbWV0aG9kLCBhbmQgc2V0IHByb3BlcnRpZXMgdXNpbmcg
        dGhlCiAgc2V0IG1ldGhvZC4gVGhpcyBhbGxvd3MgdGhlIG9ic2VydmluZyBv
        YmplY3RzIHRvIGJlIG5vdGlmaWVkIGFuZAogIGNvbXB1dGVkIHByb3BlcnRp
        ZXMgdG8gYmUgaGFuZGxlZCBwcm9wZXJseS4KCiAgTW9yZSBkb2N1bWVudGF0
        aW9uIGFib3V0IGBnZXRgIGFuZCBgc2V0YCBhcmUgYmVsb3cuCgogICMjIE9i
        c2VydmluZyBQcm9wZXJ0eSBDaGFuZ2VzCgogIFlvdSB0eXBpY2FsbHkgb2Jz
        ZXJ2ZSBwcm9wZXJ0eSBjaGFuZ2VzIHNpbXBseSBieSBhZGRpbmcgdGhlIGBv
        YnNlcnZlc2AKICBjYWxsIHRvIHRoZSBlbmQgb2YgeW91ciBtZXRob2QgZGVj
        bGFyYXRpb25zIGluIGNsYXNzZXMgdGhhdCB5b3Ugd3JpdGUuCiAgRm9yIGV4
        YW1wbGU6CgogIGBgYGphdmFzY3JpcHQKICBFbWJlci5PYmplY3QuZXh0ZW5k
        KHsKICAgIHZhbHVlT2JzZXJ2ZXI6IGZ1bmN0aW9uKCkgewogICAgICAvLyBF
        eGVjdXRlcyB3aGVuZXZlciB0aGUgInZhbHVlIiBwcm9wZXJ0eSBjaGFuZ2Vz
        CiAgICB9Lm9ic2VydmVzKCd2YWx1ZScpCiAgfSk7CiAgYGBgCgogIEFsdGhv
        dWdoIHRoaXMgaXMgdGhlIG1vc3QgY29tbW9uIHdheSB0byBhZGQgYW4gb2Jz
        ZXJ2ZXIsIHRoaXMgY2FwYWJpbGl0eQogIGlzIGFjdHVhbGx5IGJ1aWx0IGlu
        dG8gdGhlIGBFbWJlci5PYmplY3RgIGNsYXNzIG9uIHRvcCBvZiB0d28gbWV0
        aG9kcwogIGRlZmluZWQgaW4gdGhpcyBtaXhpbjogYGFkZE9ic2VydmVyYCBh
        bmQgYHJlbW92ZU9ic2VydmVyYC4gWW91IGNhbiB1c2UKICB0aGVzZSB0d28g
        bWV0aG9kcyB0byBhZGQgYW5kIHJlbW92ZSBvYnNlcnZlcnMgeW91cnNlbGYg
        aWYgeW91IG5lZWQgdG8KICBkbyBzbyBhdCBydW50aW1lLgoKICBUbyBhZGQg
        YW4gb2JzZXJ2ZXIgZm9yIGEgcHJvcGVydHksIGNhbGw6CgogIGBgYGphdmFz
        Y3JpcHQKICBvYmplY3QuYWRkT2JzZXJ2ZXIoJ3Byb3BlcnR5S2V5JywgdGFy
        Z2V0T2JqZWN0LCB0YXJnZXRBY3Rpb24pCiAgYGBgCgogIFRoaXMgd2lsbCBj
        YWxsIHRoZSBgdGFyZ2V0QWN0aW9uYCBtZXRob2Qgb24gdGhlIGB0YXJnZXRP
        YmplY3RgIHdoZW5ldmVyCiAgdGhlIHZhbHVlIG9mIHRoZSBgcHJvcGVydHlL
        ZXlgIGNoYW5nZXMuCgogIE5vdGUgdGhhdCBpZiBgcHJvcGVydHlLZXlgIGlz
        IGEgY29tcHV0ZWQgcHJvcGVydHksIHRoZSBvYnNlcnZlciB3aWxsIGJlCiAg
        Y2FsbGVkIHdoZW4gYW55IG9mIHRoZSBwcm9wZXJ0eSBkZXBlbmRlbmNpZXMg
        YXJlIGNoYW5nZWQsIGV2ZW4gaWYgdGhlCiAgcmVzdWx0aW5nIHZhbHVlIG9m
        IHRoZSBjb21wdXRlZCBwcm9wZXJ0eSBpcyB1bmNoYW5nZWQuIFRoaXMgaXMg
        bmVjZXNzYXJ5CiAgYmVjYXVzZSBjb21wdXRlZCBwcm9wZXJ0aWVzIGFyZSBu
        b3QgY29tcHV0ZWQgdW50aWwgYGdldGAgaXMgY2FsbGVkLgoKICBAY2xhc3Mg
        T2JzZXJ2YWJsZQogIEBuYW1lc3BhY2UgRW1iZXIKKi8KRW1iZXIuT2JzZXJ2
        YWJsZSA9IEVtYmVyLk1peGluLmNyZWF0ZSh7CgogIC8qKgogICAgUmV0cmll
        dmVzIHRoZSB2YWx1ZSBvZiBhIHByb3BlcnR5IGZyb20gdGhlIG9iamVjdC4K
        CiAgICBUaGlzIG1ldGhvZCBpcyB1c3VhbGx5IHNpbWlsYXIgdG8gdXNpbmcg
        YG9iamVjdFtrZXlOYW1lXWAgb3IgYG9iamVjdC5rZXlOYW1lYCwKICAgIGhv
        d2V2ZXIgaXQgc3VwcG9ydHMgYm90aCBjb21wdXRlZCBwcm9wZXJ0aWVzIGFu
        ZCB0aGUgdW5rbm93blByb3BlcnR5CiAgICBoYW5kbGVyLgoKICAgIEJlY2F1
        c2UgYGdldGAgdW5pZmllcyB0aGUgc3ludGF4IGZvciBhY2Nlc3NpbmcgYWxs
        IHRoZXNlIGtpbmRzCiAgICBvZiBwcm9wZXJ0aWVzLCBpdCBjYW4gbWFrZSBt
        YW55IHJlZmFjdG9yaW5ncyBlYXNpZXIsIHN1Y2ggYXMgcmVwbGFjaW5nIGEK
        ICAgIHNpbXBsZSBwcm9wZXJ0eSB3aXRoIGEgY29tcHV0ZWQgcHJvcGVydHks
        IG9yIHZpY2UgdmVyc2EuCgogICAgIyMjIENvbXB1dGVkIFByb3BlcnRpZXMK
        CiAgICBDb21wdXRlZCBwcm9wZXJ0aWVzIGFyZSBtZXRob2RzIGRlZmluZWQg
        d2l0aCB0aGUgYHByb3BlcnR5YCBtb2RpZmllcgogICAgZGVjbGFyZWQgYXQg
        dGhlIGVuZCwgc3VjaCBhczoKCiAgICBgYGBqYXZhc2NyaXB0CiAgICBmdWxs
        TmFtZTogZnVuY3Rpb24oKSB7CiAgICAgIHJldHVybiB0aGlzLmdldEVhY2go
        J2ZpcnN0TmFtZScsICdsYXN0TmFtZScpLmNvbXBhY3QoKS5qb2luKCcgJyk7
        CiAgICB9LnByb3BlcnR5KCdmaXJzdE5hbWUnLCAnbGFzdE5hbWUnKQogICAg
        YGBgCgogICAgV2hlbiB5b3UgY2FsbCBgZ2V0YCBvbiBhIGNvbXB1dGVkIHBy
        b3BlcnR5LCB0aGUgZnVuY3Rpb24gd2lsbCBiZQogICAgY2FsbGVkIGFuZCB0
        aGUgcmV0dXJuIHZhbHVlIHdpbGwgYmUgcmV0dXJuZWQgaW5zdGVhZCBvZiB0
        aGUgZnVuY3Rpb24KICAgIGl0c2VsZi4KCiAgICAjIyMgVW5rbm93biBQcm9w
        ZXJ0aWVzCgogICAgTGlrZXdpc2UsIGlmIHlvdSB0cnkgdG8gY2FsbCBgZ2V0
        YCBvbiBhIHByb3BlcnR5IHdob3NlIHZhbHVlIGlzCiAgICBgdW5kZWZpbmVk
        YCwgdGhlIGB1bmtub3duUHJvcGVydHkoKWAgbWV0aG9kIHdpbGwgYmUgY2Fs
        bGVkIG9uIHRoZSBvYmplY3QuCiAgICBJZiB0aGlzIG1ldGhvZCByZXR1cm5z
        IGFueSB2YWx1ZSBvdGhlciB0aGFuIGB1bmRlZmluZWRgLCBpdCB3aWxsIGJl
        IHJldHVybmVkCiAgICBpbnN0ZWFkLiBUaGlzIGFsbG93cyB5b3UgdG8gaW1w
        bGVtZW50ICJ2aXJ0dWFsIiBwcm9wZXJ0aWVzIHRoYXQgYXJlCiAgICBub3Qg
        ZGVmaW5lZCB1cGZyb250LgoKICAgIEBtZXRob2QgZ2V0CiAgICBAcGFyYW0g
        e1N0cmluZ30ga2V5TmFtZSBUaGUgcHJvcGVydHkgdG8gcmV0cmlldmUKICAg
        IEByZXR1cm4ge09iamVjdH0gVGhlIHByb3BlcnR5IHZhbHVlIG9yIHVuZGVm
        aW5lZC4KICAqLwogIGdldDogZnVuY3Rpb24oa2V5TmFtZSkgewogICAgcmV0
        dXJuIGdldCh0aGlzLCBrZXlOYW1lKTsKICB9LAoKICAvKioKICAgIFRvIGdl
        dCBtdWx0aXBsZSBwcm9wZXJ0aWVzIGF0IG9uY2UsIGNhbGwgYGdldFByb3Bl
        cnRpZXNgCiAgICB3aXRoIGEgbGlzdCBvZiBzdHJpbmdzIG9yIGFuIGFycmF5
        OgoKICAgIGBgYGphdmFzY3JpcHQKICAgIHJlY29yZC5nZXRQcm9wZXJ0aWVz
        KCdmaXJzdE5hbWUnLCAnbGFzdE5hbWUnLCAnemlwQ29kZScpOyAgLy8geyBm
        aXJzdE5hbWU6ICdKb2huJywgbGFzdE5hbWU6ICdEb2UnLCB6aXBDb2RlOiAn
        MTAwMTEnIH0KICAgIGBgYAoKICAgIGlzIGVxdWl2YWxlbnQgdG86CgogICAg
        YGBgamF2YXNjcmlwdAogICAgcmVjb3JkLmdldFByb3BlcnRpZXMoWydmaXJz
        dE5hbWUnLCAnbGFzdE5hbWUnLCAnemlwQ29kZSddKTsgIC8vIHsgZmlyc3RO
        YW1lOiAnSm9obicsIGxhc3ROYW1lOiAnRG9lJywgemlwQ29kZTogJzEwMDEx
        JyB9CiAgICBgYGAKCiAgICBAbWV0aG9kIGdldFByb3BlcnRpZXMKICAgIEBw
        YXJhbSB7U3RyaW5nLi4ufEFycmF5fSBsaXN0IG9mIGtleXMgdG8gZ2V0CiAg
        ICBAcmV0dXJuIHtIYXNofQogICovCiAgZ2V0UHJvcGVydGllczogZnVuY3Rp
        b24oKSB7CiAgICByZXR1cm4gZ2V0UHJvcGVydGllcy5hcHBseShudWxsLCBb
        dGhpc10uY29uY2F0KHNsaWNlLmNhbGwoYXJndW1lbnRzKSkpOwogIH0sCgog
        IC8qKgogICAgU2V0cyB0aGUgcHJvdmlkZWQga2V5IG9yIHBhdGggdG8gdGhl
        IHZhbHVlLgoKICAgIFRoaXMgbWV0aG9kIGlzIGdlbmVyYWxseSB2ZXJ5IHNp
        bWlsYXIgdG8gY2FsbGluZyBgb2JqZWN0W2tleV0gPSB2YWx1ZWAgb3IKICAg
        IGBvYmplY3Qua2V5ID0gdmFsdWVgLCBleGNlcHQgdGhhdCBpdCBwcm92aWRl
        cyBzdXBwb3J0IGZvciBjb21wdXRlZAogICAgcHJvcGVydGllcywgdGhlIGBz
        ZXRVbmtub3duUHJvcGVydHkoKWAgbWV0aG9kIGFuZCBwcm9wZXJ0eSBvYnNl
        cnZlcnMuCgogICAgIyMjIENvbXB1dGVkIFByb3BlcnRpZXMKCiAgICBJZiB5
        b3UgdHJ5IHRvIHNldCBhIHZhbHVlIG9uIGEga2V5IHRoYXQgaGFzIGEgY29t
        cHV0ZWQgcHJvcGVydHkgaGFuZGxlcgogICAgZGVmaW5lZCAoc2VlIHRoZSBg
        Z2V0KClgIG1ldGhvZCBmb3IgYW4gZXhhbXBsZSksIHRoZW4gYHNldCgpYCB3
        aWxsIGNhbGwKICAgIHRoYXQgbWV0aG9kLCBwYXNzaW5nIGJvdGggdGhlIHZh
        bHVlIGFuZCBrZXkgaW5zdGVhZCBvZiBzaW1wbHkgY2hhbmdpbmcKICAgIHRo
        ZSB2YWx1ZSBpdHNlbGYuIFRoaXMgaXMgdXNlZnVsIGZvciB0aG9zZSB0aW1l
        cyB3aGVuIHlvdSBuZWVkIHRvCiAgICBpbXBsZW1lbnQgYSBwcm9wZXJ0eSB0
        aGF0IGlzIGNvbXBvc2VkIG9mIG9uZSBvciBtb3JlIG1lbWJlcgogICAgcHJv
        cGVydGllcy4KCiAgICAjIyMgVW5rbm93biBQcm9wZXJ0aWVzCgogICAgSWYg
        eW91IHRyeSB0byBzZXQgYSB2YWx1ZSBvbiBhIGtleSB0aGF0IGlzIHVuZGVm
        aW5lZCBpbiB0aGUgdGFyZ2V0CiAgICBvYmplY3QsIHRoZW4gdGhlIGBzZXRV
        bmtub3duUHJvcGVydHkoKWAgaGFuZGxlciB3aWxsIGJlIGNhbGxlZCBpbnN0
        ZWFkLiBUaGlzCiAgICBnaXZlcyB5b3UgYW4gb3Bwb3J0dW5pdHkgdG8gaW1w
        bGVtZW50IGNvbXBsZXggInZpcnR1YWwiIHByb3BlcnRpZXMgdGhhdAogICAg
        YXJlIG5vdCBwcmVkZWZpbmVkIG9uIHRoZSBvYmplY3QuIElmIGBzZXRVbmtu
        b3duUHJvcGVydHkoKWAgcmV0dXJucwogICAgdW5kZWZpbmVkLCB0aGVuIGBz
        ZXQoKWAgd2lsbCBzaW1wbHkgc2V0IHRoZSB2YWx1ZSBvbiB0aGUgb2JqZWN0
        LgoKICAgICMjIyBQcm9wZXJ0eSBPYnNlcnZlcnMKCiAgICBJbiBhZGRpdGlv
        biB0byBjaGFuZ2luZyB0aGUgcHJvcGVydHksIGBzZXQoKWAgd2lsbCBhbHNv
        IHJlZ2lzdGVyIGEgcHJvcGVydHkKICAgIGNoYW5nZSB3aXRoIHRoZSBvYmpl
        Y3QuIFVubGVzcyB5b3UgaGF2ZSBwbGFjZWQgdGhpcyBjYWxsIGluc2lkZSBv
        ZiBhCiAgICBgYmVnaW5Qcm9wZXJ0eUNoYW5nZXMoKWAgYW5kIGBlbmRQcm9w
        ZXJ0eUNoYW5nZXMoKSxgIGFueSAibG9jYWwiIG9ic2VydmVycwogICAgKGku
        ZS4gb2JzZXJ2ZXIgbWV0aG9kcyBkZWNsYXJlZCBvbiB0aGUgc2FtZSBvYmpl
        Y3QpLCB3aWxsIGJlIGNhbGxlZAogICAgaW1tZWRpYXRlbHkuIEFueSAicmVt
        b3RlIiBvYnNlcnZlcnMgKGkuZS4gb2JzZXJ2ZXIgbWV0aG9kcyBkZWNsYXJl
        ZCBvbgogICAgYW5vdGhlciBvYmplY3QpIHdpbGwgYmUgcGxhY2VkIGluIGEg
        cXVldWUgYW5kIGNhbGxlZCBhdCBhIGxhdGVyIHRpbWUgaW4gYQogICAgY29h
        bGVzY2VkIG1hbm5lci4KCiAgICAjIyMgQ2hhaW5pbmcKCiAgICBJbiBhZGRp
        dGlvbiB0byBwcm9wZXJ0eSBjaGFuZ2VzLCBgc2V0KClgIHJldHVybnMgdGhl
        IHZhbHVlIG9mIHRoZSBvYmplY3QKICAgIGl0c2VsZiBzbyB5b3UgY2FuIGRv
        IGNoYWluaW5nIGxpa2UgdGhpczoKCiAgICBgYGBqYXZhc2NyaXB0CiAgICBy
        ZWNvcmQuc2V0KCdmaXJzdE5hbWUnLCAnQ2hhcmxlcycpLnNldCgnbGFzdE5h
        bWUnLCAnSm9sbGV5Jyk7CiAgICBgYGAKCiAgICBAbWV0aG9kIHNldAogICAg
        QHBhcmFtIHtTdHJpbmd9IGtleU5hbWUgVGhlIHByb3BlcnR5IHRvIHNldAog
        ICAgQHBhcmFtIHtPYmplY3R9IHZhbHVlIFRoZSB2YWx1ZSB0byBzZXQgb3Ig
        YG51bGxgLgogICAgQHJldHVybiB7RW1iZXIuT2JzZXJ2YWJsZX0KICAqLwog
        IHNldDogZnVuY3Rpb24oa2V5TmFtZSwgdmFsdWUpIHsKICAgIHNldCh0aGlz
        LCBrZXlOYW1lLCB2YWx1ZSk7CiAgICByZXR1cm4gdGhpczsKICB9LAoKICAv
        KioKICAgIFRvIHNldCBtdWx0aXBsZSBwcm9wZXJ0aWVzIGF0IG9uY2UsIGNh
        bGwgYHNldFByb3BlcnRpZXNgCiAgICB3aXRoIGEgSGFzaDoKCiAgICBgYGBq
        YXZhc2NyaXB0CiAgICByZWNvcmQuc2V0UHJvcGVydGllcyh7IGZpcnN0TmFt
        ZTogJ0NoYXJsZXMnLCBsYXN0TmFtZTogJ0pvbGxleScgfSk7CiAgICBgYGAK
        CiAgICBAbWV0aG9kIHNldFByb3BlcnRpZXMKICAgIEBwYXJhbSB7SGFzaH0g
        aGFzaCB0aGUgaGFzaCBvZiBrZXlzIGFuZCB2YWx1ZXMgdG8gc2V0CiAgICBA
        cmV0dXJuIHtFbWJlci5PYnNlcnZhYmxlfQogICovCiAgc2V0UHJvcGVydGll
        czogZnVuY3Rpb24oaGFzaCkgewogICAgcmV0dXJuIEVtYmVyLnNldFByb3Bl
        cnRpZXModGhpcywgaGFzaCk7CiAgfSwKCiAgLyoqCiAgICBCZWdpbnMgYSBn
        cm91cGluZyBvZiBwcm9wZXJ0eSBjaGFuZ2VzLgoKICAgIFlvdSBjYW4gdXNl
        IHRoaXMgbWV0aG9kIHRvIGdyb3VwIHByb3BlcnR5IGNoYW5nZXMgc28gdGhh
        dCBub3RpZmljYXRpb25zCiAgICB3aWxsIG5vdCBiZSBzZW50IHVudGlsIHRo
        ZSBjaGFuZ2VzIGFyZSBmaW5pc2hlZC4gSWYgeW91IHBsYW4gdG8gbWFrZSBh
        CiAgICBsYXJnZSBudW1iZXIgb2YgY2hhbmdlcyB0byBhbiBvYmplY3QgYXQg
        b25lIHRpbWUsIHlvdSBzaG91bGQgY2FsbCB0aGlzCiAgICBtZXRob2QgYXQg
        dGhlIGJlZ2lubmluZyBvZiB0aGUgY2hhbmdlcyB0byBiZWdpbiBkZWZlcnJp
        bmcgY2hhbmdlCiAgICBub3RpZmljYXRpb25zLiBXaGVuIHlvdSBhcmUgZG9u
        ZSBtYWtpbmcgY2hhbmdlcywgY2FsbAogICAgYGVuZFByb3BlcnR5Q2hhbmdl
        cygpYCB0byBkZWxpdmVyIHRoZSBkZWZlcnJlZCBjaGFuZ2Ugbm90aWZpY2F0
        aW9ucyBhbmQgZW5kCiAgICBkZWZlcnJpbmcuCgogICAgQG1ldGhvZCBiZWdp
        blByb3BlcnR5Q2hhbmdlcwogICAgQHJldHVybiB7RW1iZXIuT2JzZXJ2YWJs
        ZX0KICAqLwogIGJlZ2luUHJvcGVydHlDaGFuZ2VzOiBmdW5jdGlvbigpIHsK
        ICAgIEVtYmVyLmJlZ2luUHJvcGVydHlDaGFuZ2VzKCk7CiAgICByZXR1cm4g
        dGhpczsKICB9LAoKICAvKioKICAgIEVuZHMgYSBncm91cGluZyBvZiBwcm9w
        ZXJ0eSBjaGFuZ2VzLgoKICAgIFlvdSBjYW4gdXNlIHRoaXMgbWV0aG9kIHRv
        IGdyb3VwIHByb3BlcnR5IGNoYW5nZXMgc28gdGhhdCBub3RpZmljYXRpb25z
        CiAgICB3aWxsIG5vdCBiZSBzZW50IHVudGlsIHRoZSBjaGFuZ2VzIGFyZSBm
        aW5pc2hlZC4gSWYgeW91IHBsYW4gdG8gbWFrZSBhCiAgICBsYXJnZSBudW1i
        ZXIgb2YgY2hhbmdlcyB0byBhbiBvYmplY3QgYXQgb25lIHRpbWUsIHlvdSBz
        aG91bGQgY2FsbAogICAgYGJlZ2luUHJvcGVydHlDaGFuZ2VzKClgIGF0IHRo
        ZSBiZWdpbm5pbmcgb2YgdGhlIGNoYW5nZXMgdG8gZGVmZXIgY2hhbmdlCiAg
        ICBub3RpZmljYXRpb25zLiBXaGVuIHlvdSBhcmUgZG9uZSBtYWtpbmcgY2hh
        bmdlcywgY2FsbCB0aGlzIG1ldGhvZCB0bwogICAgZGVsaXZlciB0aGUgZGVm
        ZXJyZWQgY2hhbmdlIG5vdGlmaWNhdGlvbnMgYW5kIGVuZCBkZWZlcnJpbmcu
        CgogICAgQG1ldGhvZCBlbmRQcm9wZXJ0eUNoYW5nZXMKICAgIEByZXR1cm4g
        e0VtYmVyLk9ic2VydmFibGV9CiAgKi8KICBlbmRQcm9wZXJ0eUNoYW5nZXM6
        IGZ1bmN0aW9uKCkgewogICAgRW1iZXIuZW5kUHJvcGVydHlDaGFuZ2VzKCk7
        CiAgICByZXR1cm4gdGhpczsKICB9LAoKICAvKioKICAgIE5vdGlmeSB0aGUg
        b2JzZXJ2ZXIgc3lzdGVtIHRoYXQgYSBwcm9wZXJ0eSBpcyBhYm91dCB0byBj
        aGFuZ2UuCgogICAgU29tZXRpbWVzIHlvdSBuZWVkIHRvIGNoYW5nZSBhIHZh
        bHVlIGRpcmVjdGx5IG9yIGluZGlyZWN0bHkgd2l0aG91dAogICAgYWN0dWFs
        bHkgY2FsbGluZyBgZ2V0KClgIG9yIGBzZXQoKWAgb24gaXQuIEluIHRoaXMg
        Y2FzZSwgeW91IGNhbiB1c2UgdGhpcwogICAgbWV0aG9kIGFuZCBgcHJvcGVy
        dHlEaWRDaGFuZ2UoKWAgaW5zdGVhZC4gQ2FsbGluZyB0aGVzZSB0d28gbWV0
        aG9kcwogICAgdG9nZXRoZXIgd2lsbCBub3RpZnkgYWxsIG9ic2VydmVycyB0
        aGF0IHRoZSBwcm9wZXJ0eSBoYXMgcG90ZW50aWFsbHkKICAgIGNoYW5nZWQg
        dmFsdWUuCgogICAgTm90ZSB0aGF0IHlvdSBtdXN0IGFsd2F5cyBjYWxsIGBw
        cm9wZXJ0eVdpbGxDaGFuZ2VgIGFuZCBgcHJvcGVydHlEaWRDaGFuZ2VgCiAg
        ICBhcyBhIHBhaXIuIElmIHlvdSBkbyBub3QsIGl0IG1heSBnZXQgdGhlIHBy
        b3BlcnR5IGNoYW5nZSBncm91cHMgb3V0IG9mCiAgICBvcmRlciBhbmQgY2F1
        c2Ugbm90aWZpY2F0aW9ucyB0byBiZSBkZWxpdmVyZWQgbW9yZSBvZnRlbiB0
        aGFuIHlvdSB3b3VsZAogICAgbGlrZS4KCiAgICBAbWV0aG9kIHByb3BlcnR5
        V2lsbENoYW5nZQogICAgQHBhcmFtIHtTdHJpbmd9IGtleU5hbWUgVGhlIHBy
        b3BlcnR5IGtleSB0aGF0IGlzIGFib3V0IHRvIGNoYW5nZS4KICAgIEByZXR1
        cm4ge0VtYmVyLk9ic2VydmFibGV9CiAgKi8KICBwcm9wZXJ0eVdpbGxDaGFu
        Z2U6IGZ1bmN0aW9uKGtleU5hbWUpIHsKICAgIEVtYmVyLnByb3BlcnR5V2ls
        bENoYW5nZSh0aGlzLCBrZXlOYW1lKTsKICAgIHJldHVybiB0aGlzOwogIH0s
        CgogIC8qKgogICAgTm90aWZ5IHRoZSBvYnNlcnZlciBzeXN0ZW0gdGhhdCBh
        IHByb3BlcnR5IGhhcyBqdXN0IGNoYW5nZWQuCgogICAgU29tZXRpbWVzIHlv
        dSBuZWVkIHRvIGNoYW5nZSBhIHZhbHVlIGRpcmVjdGx5IG9yIGluZGlyZWN0
        bHkgd2l0aG91dAogICAgYWN0dWFsbHkgY2FsbGluZyBgZ2V0KClgIG9yIGBz
        ZXQoKWAgb24gaXQuIEluIHRoaXMgY2FzZSwgeW91IGNhbiB1c2UgdGhpcwog
        ICAgbWV0aG9kIGFuZCBgcHJvcGVydHlXaWxsQ2hhbmdlKClgIGluc3RlYWQu
        IENhbGxpbmcgdGhlc2UgdHdvIG1ldGhvZHMKICAgIHRvZ2V0aGVyIHdpbGwg
        bm90aWZ5IGFsbCBvYnNlcnZlcnMgdGhhdCB0aGUgcHJvcGVydHkgaGFzIHBv
        dGVudGlhbGx5CiAgICBjaGFuZ2VkIHZhbHVlLgoKICAgIE5vdGUgdGhhdCB5
        b3UgbXVzdCBhbHdheXMgY2FsbCBgcHJvcGVydHlXaWxsQ2hhbmdlYCBhbmQg
        YHByb3BlcnR5RGlkQ2hhbmdlYAogICAgYXMgYSBwYWlyLiBJZiB5b3UgZG8g
        bm90LCBpdCBtYXkgZ2V0IHRoZSBwcm9wZXJ0eSBjaGFuZ2UgZ3JvdXBzIG91
        dCBvZgogICAgb3JkZXIgYW5kIGNhdXNlIG5vdGlmaWNhdGlvbnMgdG8gYmUg
        ZGVsaXZlcmVkIG1vcmUgb2Z0ZW4gdGhhbiB5b3Ugd291bGQKICAgIGxpa2Uu
        CgogICAgQG1ldGhvZCBwcm9wZXJ0eURpZENoYW5nZQogICAgQHBhcmFtIHtT
        dHJpbmd9IGtleU5hbWUgVGhlIHByb3BlcnR5IGtleSB0aGF0IGhhcyBqdXN0
        IGNoYW5nZWQuCiAgICBAcmV0dXJuIHtFbWJlci5PYnNlcnZhYmxlfQogICov
        CiAgcHJvcGVydHlEaWRDaGFuZ2U6IGZ1bmN0aW9uKGtleU5hbWUpIHsKICAg
        IEVtYmVyLnByb3BlcnR5RGlkQ2hhbmdlKHRoaXMsIGtleU5hbWUpOwogICAg
        cmV0dXJuIHRoaXM7CiAgfSwKCiAgLyoqCiAgICBDb252ZW5pZW5jZSBtZXRo
        b2QgdG8gY2FsbCBgcHJvcGVydHlXaWxsQ2hhbmdlYCBhbmQgYHByb3BlcnR5
        RGlkQ2hhbmdlYCBpbgogICAgc3VjY2Vzc2lvbi4KCiAgICBAbWV0aG9kIG5v
        dGlmeVByb3BlcnR5Q2hhbmdlCiAgICBAcGFyYW0ge1N0cmluZ30ga2V5TmFt
        ZSBUaGUgcHJvcGVydHkga2V5IHRvIGJlIG5vdGlmaWVkIGFib3V0LgogICAg
        QHJldHVybiB7RW1iZXIuT2JzZXJ2YWJsZX0KICAqLwogIG5vdGlmeVByb3Bl
        cnR5Q2hhbmdlOiBmdW5jdGlvbihrZXlOYW1lKSB7CiAgICB0aGlzLnByb3Bl
        cnR5V2lsbENoYW5nZShrZXlOYW1lKTsKICAgIHRoaXMucHJvcGVydHlEaWRD
        aGFuZ2Uoa2V5TmFtZSk7CiAgICByZXR1cm4gdGhpczsKICB9LAoKICBhZGRC
        ZWZvcmVPYnNlcnZlcjogZnVuY3Rpb24oa2V5LCB0YXJnZXQsIG1ldGhvZCkg
        ewogICAgRW1iZXIuYWRkQmVmb3JlT2JzZXJ2ZXIodGhpcywga2V5LCB0YXJn
        ZXQsIG1ldGhvZCk7CiAgfSwKCiAgLyoqCiAgICBBZGRzIGFuIG9ic2VydmVy
        IG9uIGEgcHJvcGVydHkuCgogICAgVGhpcyBpcyB0aGUgY29yZSBtZXRob2Qg
        dXNlZCB0byByZWdpc3RlciBhbiBvYnNlcnZlciBmb3IgYSBwcm9wZXJ0eS4K
        CiAgICBPbmNlIHlvdSBjYWxsIHRoaXMgbWV0aG9kLCBhbnkgdGltZSB0aGUg
        a2V5J3MgdmFsdWUgaXMgc2V0LCB5b3VyIG9ic2VydmVyCiAgICB3aWxsIGJl
        IG5vdGlmaWVkLiBOb3RlIHRoYXQgdGhlIG9ic2VydmVycyBhcmUgdHJpZ2dl
        cmVkIGFueSB0aW1lIHRoZQogICAgdmFsdWUgaXMgc2V0LCByZWdhcmRsZXNz
        IG9mIHdoZXRoZXIgaXQgaGFzIGFjdHVhbGx5IGNoYW5nZWQuIFlvdXIKICAg
        IG9ic2VydmVyIHNob3VsZCBiZSBwcmVwYXJlZCB0byBoYW5kbGUgdGhhdC4K
        CiAgICBZb3UgY2FuIGFsc28gcGFzcyBhbiBvcHRpb25hbCBjb250ZXh0IHBh
        cmFtZXRlciB0byB0aGlzIG1ldGhvZC4gVGhlCiAgICBjb250ZXh0IHdpbGwg
        YmUgcGFzc2VkIHRvIHlvdXIgb2JzZXJ2ZXIgbWV0aG9kIHdoZW5ldmVyIGl0
        IGlzIHRyaWdnZXJlZC4KICAgIE5vdGUgdGhhdCBpZiB5b3UgYWRkIHRoZSBz
        YW1lIHRhcmdldC9tZXRob2QgcGFpciBvbiBhIGtleSBtdWx0aXBsZSB0aW1l
        cwogICAgd2l0aCBkaWZmZXJlbnQgY29udGV4dCBwYXJhbWV0ZXJzLCB5b3Vy
        IG9ic2VydmVyIHdpbGwgb25seSBiZSBjYWxsZWQgb25jZQogICAgd2l0aCB0
        aGUgbGFzdCBjb250ZXh0IHlvdSBwYXNzZWQuCgogICAgIyMjIE9ic2VydmVy
        IE1ldGhvZHMKCiAgICBPYnNlcnZlciBtZXRob2RzIHlvdSBwYXNzIHNob3Vs
        ZCBnZW5lcmFsbHkgaGF2ZSB0aGUgZm9sbG93aW5nIHNpZ25hdHVyZSBpZgog
        ICAgeW91IGRvIG5vdCBwYXNzIGEgYGNvbnRleHRgIHBhcmFtZXRlcjoKCiAg
        ICBgYGBqYXZhc2NyaXB0CiAgICBmb29EaWRDaGFuZ2U6IGZ1bmN0aW9uKHNl
        bmRlciwga2V5LCB2YWx1ZSwgcmV2KSB7IH07CiAgICBgYGAKCiAgICBUaGUg
        c2VuZGVyIGlzIHRoZSBvYmplY3QgdGhhdCBjaGFuZ2VkLiBUaGUga2V5IGlz
        IHRoZSBwcm9wZXJ0eSB0aGF0CiAgICBjaGFuZ2VzLiBUaGUgdmFsdWUgcHJv
        cGVydHkgaXMgY3VycmVudGx5IHJlc2VydmVkIGFuZCB1bnVzZWQuIFRoZSBy
        ZXYKICAgIGlzIHRoZSBsYXN0IHByb3BlcnR5IHJldmlzaW9uIG9mIHRoZSBv
        YmplY3Qgd2hlbiBpdCBjaGFuZ2VkLCB3aGljaCB5b3UgY2FuCiAgICB1c2Ug
        dG8gZGV0ZWN0IGlmIHRoZSBrZXkgdmFsdWUgaGFzIHJlYWxseSBjaGFuZ2Vk
        IG9yIG5vdC4KCiAgICBJZiB5b3UgcGFzcyBhIGBjb250ZXh0YCBwYXJhbWV0
        ZXIsIHRoZSBjb250ZXh0IHdpbGwgYmUgcGFzc2VkIGJlZm9yZSB0aGUKICAg
        IHJldmlzaW9uIGxpa2Ugc286CgogICAgYGBgamF2YXNjcmlwdAogICAgZm9v
        RGlkQ2hhbmdlOiBmdW5jdGlvbihzZW5kZXIsIGtleSwgdmFsdWUsIGNvbnRl
        eHQsIHJldikgeyB9OwogICAgYGBgCgogICAgVXN1YWxseSB5b3Ugd2lsbCBu
        b3QgbmVlZCB0aGUgdmFsdWUsIGNvbnRleHQgb3IgcmV2aXNpb24gcGFyYW1l
        dGVycyBhdAogICAgdGhlIGVuZC4gSW4gdGhpcyBjYXNlLCBpdCBpcyBjb21t
        b24gdG8gd3JpdGUgb2JzZXJ2ZXIgbWV0aG9kcyB0aGF0IHRha2UKICAgIG9u
        bHkgYSBzZW5kZXIgYW5kIGtleSB2YWx1ZSBhcyBwYXJhbWV0ZXJzIG9yLCBp
        ZiB5b3UgYXJlbid0IGludGVyZXN0ZWQgaW4KICAgIGFueSBvZiB0aGVzZSB2
        YWx1ZXMsIHRvIHdyaXRlIGFuIG9ic2VydmVyIHRoYXQgaGFzIG5vIHBhcmFt
        ZXRlcnMgYXQgYWxsLgoKICAgIEBtZXRob2QgYWRkT2JzZXJ2ZXIKICAgIEBw
        YXJhbSB7U3RyaW5nfSBrZXkgVGhlIGtleSB0byBvYnNlcnZlcgogICAgQHBh
        cmFtIHtPYmplY3R9IHRhcmdldCBUaGUgdGFyZ2V0IG9iamVjdCB0byBpbnZv
        a2UKICAgIEBwYXJhbSB7U3RyaW5nfEZ1bmN0aW9ufSBtZXRob2QgVGhlIG1l
        dGhvZCB0byBpbnZva2UuCiAgICBAcmV0dXJuIHtFbWJlci5PYmplY3R9IHNl
        bGYKICAqLwogIGFkZE9ic2VydmVyOiBmdW5jdGlvbihrZXksIHRhcmdldCwg
        bWV0aG9kKSB7CiAgICBFbWJlci5hZGRPYnNlcnZlcih0aGlzLCBrZXksIHRh
        cmdldCwgbWV0aG9kKTsKICB9LAoKICAvKioKICAgIFJlbW92ZSBhbiBvYnNl
        cnZlciB5b3UgaGF2ZSBwcmV2aW91c2x5IHJlZ2lzdGVyZWQgb24gdGhpcyBv
        YmplY3QuIFBhc3MKICAgIHRoZSBzYW1lIGtleSwgdGFyZ2V0LCBhbmQgbWV0
        aG9kIHlvdSBwYXNzZWQgdG8gYGFkZE9ic2VydmVyKClgIGFuZCB5b3VyCiAg
        ICB0YXJnZXQgd2lsbCBubyBsb25nZXIgcmVjZWl2ZSBub3RpZmljYXRpb25z
        LgoKICAgIEBtZXRob2QgcmVtb3ZlT2JzZXJ2ZXIKICAgIEBwYXJhbSB7U3Ry
        aW5nfSBrZXkgVGhlIGtleSB0byBvYnNlcnZlcgogICAgQHBhcmFtIHtPYmpl
        Y3R9IHRhcmdldCBUaGUgdGFyZ2V0IG9iamVjdCB0byBpbnZva2UKICAgIEBw
        YXJhbSB7U3RyaW5nfEZ1bmN0aW9ufSBtZXRob2QgVGhlIG1ldGhvZCB0byBp
        bnZva2UuCiAgICBAcmV0dXJuIHtFbWJlci5PYnNlcnZhYmxlfSByZWNlaXZl
        cgogICovCiAgcmVtb3ZlT2JzZXJ2ZXI6IGZ1bmN0aW9uKGtleSwgdGFyZ2V0
        LCBtZXRob2QpIHsKICAgIEVtYmVyLnJlbW92ZU9ic2VydmVyKHRoaXMsIGtl
        eSwgdGFyZ2V0LCBtZXRob2QpOwogIH0sCgogIC8qKgogICAgUmV0dXJucyBg
        dHJ1ZWAgaWYgdGhlIG9iamVjdCBjdXJyZW50bHkgaGFzIG9ic2VydmVycyBy
        ZWdpc3RlcmVkIGZvciBhCiAgICBwYXJ0aWN1bGFyIGtleS4gWW91IGNhbiB1
        c2UgdGhpcyBtZXRob2QgdG8gcG90ZW50aWFsbHkgZGVmZXIgcGVyZm9ybWlu
        ZwogICAgYW4gZXhwZW5zaXZlIGFjdGlvbiB1bnRpbCBzb21lb25lIGJlZ2lu
        cyBvYnNlcnZpbmcgYSBwYXJ0aWN1bGFyIHByb3BlcnR5CiAgICBvbiB0aGUg
        b2JqZWN0LgoKICAgIEBtZXRob2QgaGFzT2JzZXJ2ZXJGb3IKICAgIEBwYXJh
        bSB7U3RyaW5nfSBrZXkgS2V5IHRvIGNoZWNrCiAgICBAcmV0dXJuIHtCb29s
        ZWFufQogICovCiAgaGFzT2JzZXJ2ZXJGb3I6IGZ1bmN0aW9uKGtleSkgewog
        ICAgcmV0dXJuIEVtYmVyLmhhc0xpc3RlbmVycyh0aGlzLCBrZXkrJzpjaGFu
        Z2UnKTsKICB9LAoKICAvKioKICAgIEBkZXByZWNhdGVkCiAgICBAbWV0aG9k
        IGdldFBhdGgKICAgIEBwYXJhbSB7U3RyaW5nfSBwYXRoIFRoZSBwcm9wZXJ0
        eSBwYXRoIHRvIHJldHJpZXZlCiAgICBAcmV0dXJuIHtPYmplY3R9IFRoZSBw
        cm9wZXJ0eSB2YWx1ZSBvciB1bmRlZmluZWQuCiAgKi8KICBnZXRQYXRoOiBm
        dW5jdGlvbihwYXRoKSB7CiAgICBFbWJlci5kZXByZWNhdGUoImdldFBhdGgg
        aXMgZGVwcmVjYXRlZCBzaW5jZSBnZXQgbm93IHN1cHBvcnRzIHBhdGhzIik7
        CiAgICByZXR1cm4gdGhpcy5nZXQocGF0aCk7CiAgfSwKCiAgLyoqCiAgICBA
        ZGVwcmVjYXRlZAogICAgQG1ldGhvZCBzZXRQYXRoCiAgICBAcGFyYW0ge1N0
        cmluZ30gcGF0aCBUaGUgcGF0aCB0byB0aGUgcHJvcGVydHkgdGhhdCB3aWxs
        IGJlIHNldAogICAgQHBhcmFtIHtPYmplY3R9IHZhbHVlIFRoZSB2YWx1ZSB0
        byBzZXQgb3IgYG51bGxgLgogICAgQHJldHVybiB7RW1iZXIuT2JzZXJ2YWJs
        ZX0KICAqLwogIHNldFBhdGg6IGZ1bmN0aW9uKHBhdGgsIHZhbHVlKSB7CiAg
        ICBFbWJlci5kZXByZWNhdGUoInNldFBhdGggaXMgZGVwcmVjYXRlZCBzaW5j
        ZSBzZXQgbm93IHN1cHBvcnRzIHBhdGhzIik7CiAgICByZXR1cm4gdGhpcy5z
        ZXQocGF0aCwgdmFsdWUpOwogIH0sCgogIC8qKgogICAgUmV0cmlldmVzIHRo
        ZSB2YWx1ZSBvZiBhIHByb3BlcnR5LCBvciBhIGRlZmF1bHQgdmFsdWUgaW4g
        dGhlIGNhc2UgdGhhdCB0aGUKICAgIHByb3BlcnR5IHJldHVybnMgYHVuZGVm
        aW5lZGAuCgogICAgYGBgamF2YXNjcmlwdAogICAgcGVyc29uLmdldFdpdGhE
        ZWZhdWx0KCdsYXN0TmFtZScsICdEb2UnKTsKICAgIGBgYAoKICAgIEBtZXRo
        b2QgZ2V0V2l0aERlZmF1bHQKICAgIEBwYXJhbSB7U3RyaW5nfSBrZXlOYW1l
        IFRoZSBuYW1lIG9mIHRoZSBwcm9wZXJ0eSB0byByZXRyaWV2ZQogICAgQHBh
        cmFtIHtPYmplY3R9IGRlZmF1bHRWYWx1ZSBUaGUgdmFsdWUgdG8gcmV0dXJu
        IGlmIHRoZSBwcm9wZXJ0eSB2YWx1ZSBpcyB1bmRlZmluZWQKICAgIEByZXR1
        cm4ge09iamVjdH0gVGhlIHByb3BlcnR5IHZhbHVlIG9yIHRoZSBkZWZhdWx0
        VmFsdWUuCiAgKi8KICBnZXRXaXRoRGVmYXVsdDogZnVuY3Rpb24oa2V5TmFt
        ZSwgZGVmYXVsdFZhbHVlKSB7CiAgICByZXR1cm4gRW1iZXIuZ2V0V2l0aERl
        ZmF1bHQodGhpcywga2V5TmFtZSwgZGVmYXVsdFZhbHVlKTsKICB9LAoKICAv
        KioKICAgIFNldCB0aGUgdmFsdWUgb2YgYSBwcm9wZXJ0eSB0byB0aGUgY3Vy
        cmVudCB2YWx1ZSBwbHVzIHNvbWUgYW1vdW50LgoKICAgIGBgYGphdmFzY3Jp
        cHQKICAgIHBlcnNvbi5pbmNyZW1lbnRQcm9wZXJ0eSgnYWdlJyk7CiAgICB0
        ZWFtLmluY3JlbWVudFByb3BlcnR5KCdzY29yZScsIDIpOwogICAgYGBgCgog
        ICAgQG1ldGhvZCBpbmNyZW1lbnRQcm9wZXJ0eQogICAgQHBhcmFtIHtTdHJp
        bmd9IGtleU5hbWUgVGhlIG5hbWUgb2YgdGhlIHByb3BlcnR5IHRvIGluY3Jl
        bWVudAogICAgQHBhcmFtIHtOdW1iZXJ9IGluY3JlbWVudCBUaGUgYW1vdW50
        IHRvIGluY3JlbWVudCBieS4gRGVmYXVsdHMgdG8gMQogICAgQHJldHVybiB7
        TnVtYmVyfSBUaGUgbmV3IHByb3BlcnR5IHZhbHVlCiAgKi8KICBpbmNyZW1l
        bnRQcm9wZXJ0eTogZnVuY3Rpb24oa2V5TmFtZSwgaW5jcmVtZW50KSB7CiAg
        ICBpZiAoRW1iZXIuaXNOb25lKGluY3JlbWVudCkpIHsgaW5jcmVtZW50ID0g
        MTsgfQogICAgRW1iZXIuYXNzZXJ0KCJNdXN0IHBhc3MgYSBudW1lcmljIHZh
        bHVlIHRvIGluY3JlbWVudFByb3BlcnR5IiwgKCFpc05hTihwYXJzZUZsb2F0
        KGluY3JlbWVudCkpICYmIGlzRmluaXRlKGluY3JlbWVudCkpKTsKICAgIHNl
        dCh0aGlzLCBrZXlOYW1lLCAoZ2V0KHRoaXMsIGtleU5hbWUpIHx8IDApICsg
        aW5jcmVtZW50KTsKICAgIHJldHVybiBnZXQodGhpcywga2V5TmFtZSk7CiAg
        fSwKCiAgLyoqCiAgICBTZXQgdGhlIHZhbHVlIG9mIGEgcHJvcGVydHkgdG8g
        dGhlIGN1cnJlbnQgdmFsdWUgbWludXMgc29tZSBhbW91bnQuCgogICAgYGBg
        amF2YXNjcmlwdAogICAgcGxheWVyLmRlY3JlbWVudFByb3BlcnR5KCdsaXZl
        cycpOwogICAgb3JjLmRlY3JlbWVudFByb3BlcnR5KCdoZWFsdGgnLCA1KTsK
        ICAgIGBgYAoKICAgIEBtZXRob2QgZGVjcmVtZW50UHJvcGVydHkKICAgIEBw
        YXJhbSB7U3RyaW5nfSBrZXlOYW1lIFRoZSBuYW1lIG9mIHRoZSBwcm9wZXJ0
        eSB0byBkZWNyZW1lbnQKICAgIEBwYXJhbSB7TnVtYmVyfSBkZWNyZW1lbnQg
        VGhlIGFtb3VudCB0byBkZWNyZW1lbnQgYnkuIERlZmF1bHRzIHRvIDEKICAg
        IEByZXR1cm4ge051bWJlcn0gVGhlIG5ldyBwcm9wZXJ0eSB2YWx1ZQogICov
        CiAgZGVjcmVtZW50UHJvcGVydHk6IGZ1bmN0aW9uKGtleU5hbWUsIGRlY3Jl
        bWVudCkgewogICAgaWYgKEVtYmVyLmlzTm9uZShkZWNyZW1lbnQpKSB7IGRl
        Y3JlbWVudCA9IDE7IH0KICAgIEVtYmVyLmFzc2VydCgiTXVzdCBwYXNzIGEg
        bnVtZXJpYyB2YWx1ZSB0byBkZWNyZW1lbnRQcm9wZXJ0eSIsICghaXNOYU4o
        cGFyc2VGbG9hdChkZWNyZW1lbnQpKSAmJiBpc0Zpbml0ZShkZWNyZW1lbnQp
        KSk7CiAgICBzZXQodGhpcywga2V5TmFtZSwgKGdldCh0aGlzLCBrZXlOYW1l
        KSB8fCAwKSAtIGRlY3JlbWVudCk7CiAgICByZXR1cm4gZ2V0KHRoaXMsIGtl
        eU5hbWUpOwogIH0sCgogIC8qKgogICAgU2V0IHRoZSB2YWx1ZSBvZiBhIGJv
        b2xlYW4gcHJvcGVydHkgdG8gdGhlIG9wcG9zaXRlIG9mIGl0J3MKICAgIGN1
        cnJlbnQgdmFsdWUuCgogICAgYGBgamF2YXNjcmlwdAogICAgc3RhcnNoaXAu
        dG9nZ2xlUHJvcGVydHkoJ3dhcnBEcml2ZUVuZ2FnZWQnKTsKICAgIGBgYAoK
        ICAgIEBtZXRob2QgdG9nZ2xlUHJvcGVydHkKICAgIEBwYXJhbSB7U3RyaW5n
        fSBrZXlOYW1lIFRoZSBuYW1lIG9mIHRoZSBwcm9wZXJ0eSB0byB0b2dnbGUK
        ICAgIEByZXR1cm4ge09iamVjdH0gVGhlIG5ldyBwcm9wZXJ0eSB2YWx1ZQog
        ICovCiAgdG9nZ2xlUHJvcGVydHk6IGZ1bmN0aW9uKGtleU5hbWUpIHsKICAg
        IHNldCh0aGlzLCBrZXlOYW1lLCAhZ2V0KHRoaXMsIGtleU5hbWUpKTsKICAg
        IHJldHVybiBnZXQodGhpcywga2V5TmFtZSk7CiAgfSwKCiAgLyoqCiAgICBS
        ZXR1cm5zIHRoZSBjYWNoZWQgdmFsdWUgb2YgYSBjb21wdXRlZCBwcm9wZXJ0
        eSwgaWYgaXQgZXhpc3RzLgogICAgVGhpcyBhbGxvd3MgeW91IHRvIGluc3Bl
        Y3QgdGhlIHZhbHVlIG9mIGEgY29tcHV0ZWQgcHJvcGVydHkKICAgIHdpdGhv
        dXQgYWNjaWRlbnRhbGx5IGludm9raW5nIGl0IGlmIGl0IGlzIGludGVuZGVk
        IHRvIGJlCiAgICBnZW5lcmF0ZWQgbGF6aWx5LgoKICAgIEBtZXRob2QgY2Fj
        aGVGb3IKICAgIEBwYXJhbSB7U3RyaW5nfSBrZXlOYW1lCiAgICBAcmV0dXJu
        IHtPYmplY3R9IFRoZSBjYWNoZWQgdmFsdWUgb2YgdGhlIGNvbXB1dGVkIHBy
        b3BlcnR5LCBpZiBhbnkKICAqLwogIGNhY2hlRm9yOiBmdW5jdGlvbihrZXlO
        YW1lKSB7CiAgICByZXR1cm4gRW1iZXIuY2FjaGVGb3IodGhpcywga2V5TmFt
        ZSk7CiAgfSwKCiAgLy8gaW50ZW5kZWQgZm9yIGRlYnVnZ2luZyBwdXJwb3Nl
        cwogIG9ic2VydmVyc0ZvcktleTogZnVuY3Rpb24oa2V5TmFtZSkgewogICAg
        cmV0dXJuIEVtYmVyLm9ic2VydmVyc0Zvcih0aGlzLCBrZXlOYW1lKTsKICB9
        Cn0pOwoKfSkoKTsKCgoKKGZ1bmN0aW9uKCkgewovKioKQG1vZHVsZSBlbWJl
        cgpAc3VibW9kdWxlIGVtYmVyLXJ1bnRpbWUKKi8KCnZhciBnZXQgPSBFbWJl
        ci5nZXQsIHNldCA9IEVtYmVyLnNldDsKCi8qKgpgRW1iZXIuVGFyZ2V0QWN0
        aW9uU3VwcG9ydGAgaXMgYSBtaXhpbiB0aGF0IGNhbiBiZSBpbmNsdWRlZCBp
        biBhIGNsYXNzCnRvIGFkZCBhIGB0cmlnZ2VyQWN0aW9uYCBtZXRob2Qgd2l0
        aCBzZW1hbnRpY3Mgc2ltaWxhciB0byB0aGUgSGFuZGxlYmFycwpge3thY3Rp
        b259fWAgaGVscGVyLiBJbiBub3JtYWwgRW1iZXIgdXNhZ2UsIHRoZSBge3th
        Y3Rpb259fWAgaGVscGVyIGlzCnVzdWFsbHkgdGhlIGJlc3QgY2hvaWNlLiBU
        aGlzIG1peGluIGlzIG1vc3Qgb2Z0ZW4gdXNlZnVsIHdoZW4geW91IGFyZQpk
        b2luZyBtb3JlIGNvbXBsZXggZXZlbnQgaGFuZGxpbmcgaW4gVmlldyBvYmpl
        Y3RzLgoKU2VlIGFsc28gYEVtYmVyLlZpZXdUYXJnZXRBY3Rpb25TdXBwb3J0
        YCwgd2hpY2ggaGFzCnZpZXctYXdhcmUgZGVmYXVsdHMgZm9yIHRhcmdldCBh
        bmQgYWN0aW9uQ29udGV4dC4KCkBjbGFzcyBUYXJnZXRBY3Rpb25TdXBwb3J0
        CkBuYW1lc3BhY2UgRW1iZXIKQGV4dGVuZHMgRW1iZXIuTWl4aW4KKi8KRW1i
        ZXIuVGFyZ2V0QWN0aW9uU3VwcG9ydCA9IEVtYmVyLk1peGluLmNyZWF0ZSh7
        CiAgdGFyZ2V0OiBudWxsLAogIGFjdGlvbjogbnVsbCwKICBhY3Rpb25Db250
        ZXh0OiBudWxsLAoKICB0YXJnZXRPYmplY3Q6IEVtYmVyLmNvbXB1dGVkKGZ1
        bmN0aW9uKCkgewogICAgdmFyIHRhcmdldCA9IGdldCh0aGlzLCAndGFyZ2V0
        Jyk7CgogICAgaWYgKEVtYmVyLnR5cGVPZih0YXJnZXQpID09PSAic3RyaW5n
        IikgewogICAgICB2YXIgdmFsdWUgPSBnZXQodGhpcywgdGFyZ2V0KTsKICAg
        ICAgaWYgKHZhbHVlID09PSB1bmRlZmluZWQpIHsgdmFsdWUgPSBnZXQoRW1i
        ZXIubG9va3VwLCB0YXJnZXQpOyB9CiAgICAgIHJldHVybiB2YWx1ZTsKICAg
        IH0gZWxzZSB7CiAgICAgIHJldHVybiB0YXJnZXQ7CiAgICB9CiAgfSkucHJv
        cGVydHkoJ3RhcmdldCcpLAoKICBhY3Rpb25Db250ZXh0T2JqZWN0OiBFbWJl
        ci5jb21wdXRlZChmdW5jdGlvbigpIHsKICAgIHZhciBhY3Rpb25Db250ZXh0
        ID0gZ2V0KHRoaXMsICdhY3Rpb25Db250ZXh0Jyk7CgogICAgaWYgKEVtYmVy
        LnR5cGVPZihhY3Rpb25Db250ZXh0KSA9PT0gInN0cmluZyIpIHsKICAgICAg
        dmFyIHZhbHVlID0gZ2V0KHRoaXMsIGFjdGlvbkNvbnRleHQpOwogICAgICBp
        ZiAodmFsdWUgPT09IHVuZGVmaW5lZCkgeyB2YWx1ZSA9IGdldChFbWJlci5s
        b29rdXAsIGFjdGlvbkNvbnRleHQpOyB9CiAgICAgIHJldHVybiB2YWx1ZTsK
        ICAgIH0gZWxzZSB7CiAgICAgIHJldHVybiBhY3Rpb25Db250ZXh0OwogICAg
        fQogIH0pLnByb3BlcnR5KCdhY3Rpb25Db250ZXh0JyksCgogIC8qKgogIFNl
        bmQgYW4gImFjdGlvbiIgd2l0aCBhbiAiYWN0aW9uQ29udGV4dCIgdG8gYSAi
        dGFyZ2V0Ii4gVGhlIGFjdGlvbiwgYWN0aW9uQ29udGV4dAogIGFuZCB0YXJn
        ZXQgd2lsbCBiZSByZXRyaWV2ZWQgZnJvbSBwcm9wZXJ0aWVzIG9mIHRoZSBv
        YmplY3QuIEZvciBleGFtcGxlOgoKICBgYGBqYXZhc2NyaXB0CiAgQXBwLlNh
        dmVCdXR0b25WaWV3ID0gRW1iZXIuVmlldy5leHRlbmQoRW1iZXIuVGFyZ2V0
        QWN0aW9uU3VwcG9ydCwgewogICAgdGFyZ2V0OiBFbWJlci5jb21wdXRlZC5h
        bGlhcygnY29udHJvbGxlcicpLAogICAgYWN0aW9uOiAnc2F2ZScsCiAgICBh
        Y3Rpb25Db250ZXh0OiBFbWJlci5jb21wdXRlZC5hbGlhcygnY29udGV4dCcp
        LAogICAgY2xpY2s6IGZ1bmN0aW9uKCkgewogICAgICB0aGlzLnRyaWdnZXJB
        Y3Rpb24oKTsgLy8gU2VuZHMgdGhlIGBzYXZlYCBhY3Rpb24sIGFsb25nIHdp
        dGggdGhlIGN1cnJlbnQgY29udGV4dAogICAgICAgICAgICAgICAgICAgICAg
        ICAgICAgLy8gdG8gdGhlIGN1cnJlbnQgY29udHJvbGxlcgogICAgfQogIH0p
        OwogIGBgYAoKICBUaGUgYHRhcmdldGAsIGBhY3Rpb25gLCBhbmQgYGFjdGlv
        bkNvbnRleHRgIGNhbiBiZSBwcm92aWRlZCBhcyBwcm9wZXJ0aWVzIG9mCiAg
        YW4gb3B0aW9uYWwgb2JqZWN0IGFyZ3VtZW50IHRvIGB0cmlnZ2VyQWN0aW9u
        YCBhcyB3ZWxsLgoKICBgYGBqYXZhc2NyaXB0CiAgQXBwLlNhdmVCdXR0b25W
        aWV3ID0gRW1iZXIuVmlldy5leHRlbmQoRW1iZXIuVGFyZ2V0QWN0aW9uU3Vw
        cG9ydCwgewogICAgY2xpY2s6IGZ1bmN0aW9uKCkgewogICAgICB0aGlzLnRy
        aWdnZXJBY3Rpb24oewogICAgICAgIGFjdGlvbjogJ3NhdmUnLAogICAgICAg
        IHRhcmdldDogdGhpcy5nZXQoJ2NvbnRyb2xsZXInKSwKICAgICAgICBhY3Rp
        b25Db250ZXh0OiB0aGlzLmdldCgnY29udGV4dCcpLAogICAgICB9KTsgLy8g
        U2VuZHMgdGhlIGBzYXZlYCBhY3Rpb24sIGFsb25nIHdpdGggdGhlIGN1cnJl
        bnQgY29udGV4dAogICAgICAgICAgLy8gdG8gdGhlIGN1cnJlbnQgY29udHJv
        bGxlcgogICAgfQogIH0pOwogIGBgYAoKICBUaGUgYGFjdGlvbkNvbnRleHRg
        IGRlZmF1bHRzIHRvIHRoZSBvYmplY3QgeW91IG1peGluZyBgVGFyZ2V0QWN0
        aW9uU3VwcG9ydGAgaW50by4KICBCdXQgYHRhcmdldGAgYW5kIGBhY3Rpb25g
        IG11c3QgYmUgc3BlY2lmaWVkIGVpdGhlciBhcyBwcm9wZXJ0aWVzIG9yIHdp
        dGggdGhlIGFyZ3VtZW50CiAgdG8gYHRyaWdnZXJBY3Rpb25gLCBvciBhIGNv
        bWJpbmF0aW9uOgoKICBgYGBqYXZhc2NyaXB0CiAgQXBwLlNhdmVCdXR0b25W
        aWV3ID0gRW1iZXIuVmlldy5leHRlbmQoRW1iZXIuVGFyZ2V0QWN0aW9uU3Vw
        cG9ydCwgewogICAgdGFyZ2V0OiBFbWJlci5jb21wdXRlZC5hbGlhcygnY29u
        dHJvbGxlcicpLAogICAgY2xpY2s6IGZ1bmN0aW9uKCkgewogICAgICB0aGlz
        LnRyaWdnZXJBY3Rpb24oewogICAgICAgIGFjdGlvbjogJ3NhdmUnCiAgICAg
        IH0pOyAvLyBTZW5kcyB0aGUgYHNhdmVgIGFjdGlvbiwgYWxvbmcgd2l0aCBh
        IHJlZmVyZW5jZSB0byBgdGhpc2AsCiAgICAgICAgICAvLyB0byB0aGUgY3Vy
        cmVudCBjb250cm9sbGVyCiAgICB9CiAgfSk7CiAgYGBgCgogIEBtZXRob2Qg
        dHJpZ2dlckFjdGlvbgogIEBwYXJhbSBvcHRzIHtIYXNofSAob3B0aW9uYWws
        IHdpdGggdGhlIG9wdGlvbmFsIGtleXMgYWN0aW9uLCB0YXJnZXQgYW5kL29y
        IGFjdGlvbkNvbnRleHQpCiAgQHJldHVybiB7Qm9vbGVhbn0gdHJ1ZSBpZiB0
        aGUgYWN0aW9uIHdhcyBzZW50IHN1Y2Nlc3NmdWxseSBhbmQgZGlkIG5vdCBy
        ZXR1cm4gZmFsc2UKICAqLwogIHRyaWdnZXJBY3Rpb246IGZ1bmN0aW9uKG9w
        dHMpIHsKICAgIG9wdHMgPSBvcHRzIHx8IHt9OwogICAgdmFyIGFjdGlvbiA9
        IG9wdHMuYWN0aW9uIHx8IGdldCh0aGlzLCAnYWN0aW9uJyksCiAgICAgICAg
        dGFyZ2V0ID0gb3B0cy50YXJnZXQgfHwgZ2V0KHRoaXMsICd0YXJnZXRPYmpl
        Y3QnKSwKICAgICAgICBhY3Rpb25Db250ZXh0ID0gb3B0cy5hY3Rpb25Db250
        ZXh0OwoKICAgIGZ1bmN0aW9uIGFyZ3Mob3B0aW9ucywgYWN0aW9uTmFtZSkg
        ewogICAgICB2YXIgcmV0ID0gW107CiAgICAgIGlmIChhY3Rpb25OYW1lKSB7
        IHJldC5wdXNoKGFjdGlvbk5hbWUpOyB9CgogICAgICByZXR1cm4gcmV0LmNv
        bmNhdChvcHRpb25zKTsKICAgIH0KCiAgICBpZiAodHlwZW9mIGFjdGlvbkNv
        bnRleHQgPT09ICd1bmRlZmluZWQnKSB7CiAgICAgIGFjdGlvbkNvbnRleHQg
        PSBnZXQodGhpcywgJ2FjdGlvbkNvbnRleHRPYmplY3QnKSB8fCB0aGlzOwog
        ICAgfQoKICAgIGlmICh0YXJnZXQgJiYgYWN0aW9uKSB7CiAgICAgIHZhciBy
        ZXQ7CgogICAgICBpZiAodGFyZ2V0LnNlbmQpIHsKICAgICAgICByZXQgPSB0
        YXJnZXQuc2VuZC5hcHBseSh0YXJnZXQsIGFyZ3MoYWN0aW9uQ29udGV4dCwg
        YWN0aW9uKSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgRW1iZXIuYXNzZXJ0
        KCJUaGUgYWN0aW9uICciICsgYWN0aW9uICsgIicgZGlkIG5vdCBleGlzdCBv
        biAiICsgdGFyZ2V0LCB0eXBlb2YgdGFyZ2V0W2FjdGlvbl0gPT09ICdmdW5j
        dGlvbicpOwogICAgICAgIHJldCA9IHRhcmdldFthY3Rpb25dLmFwcGx5KHRh
        cmdldCwgYXJncyhhY3Rpb25Db250ZXh0KSk7CiAgICAgIH0KCiAgICAgIGlm
        IChyZXQgIT09IGZhbHNlKSByZXQgPSB0cnVlOwoKICAgICAgcmV0dXJuIHJl
        dDsKICAgIH0gZWxzZSB7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KICB9
        Cn0pOwoKfSkoKTsKCgoKKGZ1bmN0aW9uKCkgewovKioKQG1vZHVsZSBlbWJl
        cgpAc3VibW9kdWxlIGVtYmVyLXJ1bnRpbWUKKi8KCi8qKgogIFRoaXMgbWl4
        aW4gYWxsb3dzIGZvciBFbWJlciBvYmplY3RzIHRvIHN1YnNjcmliZSB0byBh
        bmQgZW1pdCBldmVudHMuCgogIGBgYGphdmFzY3JpcHQKICBBcHAuUGVyc29u
        ID0gRW1iZXIuT2JqZWN0LmV4dGVuZChFbWJlci5FdmVudGVkLCB7CiAgICBn
        cmVldDogZnVuY3Rpb24oKSB7CiAgICAgIC8vIC4uLgogICAgICB0aGlzLnRy
        aWdnZXIoJ2dyZWV0Jyk7CiAgICB9CiAgfSk7CgogIHZhciBwZXJzb24gPSBB
        cHAuUGVyc29uLmNyZWF0ZSgpOwoKICBwZXJzb24ub24oJ2dyZWV0JywgZnVu
        Y3Rpb24oKSB7CiAgICBjb25zb2xlLmxvZygnT3VyIHBlcnNvbiBoYXMgZ3Jl
        ZXRlZCcpOwogIH0pOwoKICBwZXJzb24uZ3JlZXQoKTsKCiAgLy8gb3V0cHV0
        czogJ091ciBwZXJzb24gaGFzIGdyZWV0ZWQnCiAgYGBgCgogIFlvdSBjYW4g
        YWxzbyBjaGFpbiBtdWx0aXBsZSBldmVudCBzdWJzY3JpcHRpb25zOgoKICBg
        YGBqYXZhc2NyaXB0CiAgcGVyc29uLm9uKCdncmVldCcsIGZ1bmN0aW9uKCkg
        ewogICAgY29uc29sZS5sb2coJ091ciBwZXJzb24gaGFzIGdyZWV0ZWQnKTsK
        ICB9KS5vbmUoJ2dyZWV0JywgZnVuY3Rpb24oKSB7CiAgICBjb25zb2xlLmxv
        ZygnT2ZmZXIgb25lLXRpbWUgc3BlY2lhbCcpOwogIH0pLm9mZignZXZlbnQn
        LCB0aGlzLCBmb3JnZXRUaGlzKTsKICBgYGAKCiAgQGNsYXNzIEV2ZW50ZWQK
        ICBAbmFtZXNwYWNlIEVtYmVyCiAqLwpFbWJlci5FdmVudGVkID0gRW1iZXIu
        TWl4aW4uY3JlYXRlKHsKCiAgLyoqCiAgIFN1YnNjcmliZXMgdG8gYSBuYW1l
        ZCBldmVudCB3aXRoIGdpdmVuIGZ1bmN0aW9uLgoKICAgYGBgamF2YXNjcmlw
        dAogICBwZXJzb24ub24oJ2RpZExvYWQnLCBmdW5jdGlvbigpIHsKICAgICAv
        LyBmaXJlZCBvbmNlIHRoZSBwZXJzb24gaGFzIGxvYWRlZAogICB9KTsKICAg
        YGBgCgogICBBbiBvcHRpb25hbCB0YXJnZXQgY2FuIGJlIHBhc3NlZCBpbiBh
        cyB0aGUgMm5kIGFyZ3VtZW50IHRoYXQgd2lsbAogICBiZSBzZXQgYXMgdGhl
        ICJ0aGlzIiBmb3IgdGhlIGNhbGxiYWNrLiBUaGlzIGlzIGEgZ29vZCB3YXkg
        dG8gZ2l2ZSB5b3VyCiAgIGZ1bmN0aW9uIGFjY2VzcyB0byB0aGUgb2JqZWN0
        IHRyaWdnZXJpbmcgdGhlIGV2ZW50LiBXaGVuIHRoZSB0YXJnZXQKICAgcGFy
        YW1ldGVyIGlzIHVzZWQgdGhlIGNhbGxiYWNrIGJlY29tZXMgdGhlIHRoaXJk
        IGFyZ3VtZW50LgoKICAgQG1ldGhvZCBvbgogICBAcGFyYW0ge1N0cmluZ30g
        bmFtZSBUaGUgbmFtZSBvZiB0aGUgZXZlbnQKICAgQHBhcmFtIHtPYmplY3R9
        IFt0YXJnZXRdIFRoZSAidGhpcyIgYmluZGluZyBmb3IgdGhlIGNhbGxiYWNr
        CiAgIEBwYXJhbSB7RnVuY3Rpb259IG1ldGhvZCBUaGUgY2FsbGJhY2sgdG8g
        ZXhlY3V0ZQogICBAcmV0dXJuIHRoaXMKICAqLwogIG9uOiBmdW5jdGlvbihu
        YW1lLCB0YXJnZXQsIG1ldGhvZCkgewogICAgRW1iZXIuYWRkTGlzdGVuZXIo
        dGhpcywgbmFtZSwgdGFyZ2V0LCBtZXRob2QpOwogICAgcmV0dXJuIHRoaXM7
        CiAgfSwKCiAgLyoqCiAgICBTdWJzY3JpYmVzIGEgZnVuY3Rpb24gdG8gYSBu
        YW1lZCBldmVudCBhbmQgdGhlbiBjYW5jZWxzIHRoZSBzdWJzY3JpcHRpb24K
        ICAgIGFmdGVyIHRoZSBmaXJzdCB0aW1lIHRoZSBldmVudCBpcyB0cmlnZ2Vy
        ZWQuIEl0IGlzIGdvb2QgdG8gdXNlIGBgb25lYGAgd2hlbgogICAgeW91IG9u
        bHkgY2FyZSBhYm91dCB0aGUgZmlyc3QgdGltZSBhbiBldmVudCBoYXMgdGFr
        ZW4gcGxhY2UuCgogICAgVGhpcyBmdW5jdGlvbiB0YWtlcyBhbiBvcHRpb25h
        bCAybmQgYXJndW1lbnQgdGhhdCB3aWxsIGJlY29tZSB0aGUgInRoaXMiCiAg
        ICB2YWx1ZSBmb3IgdGhlIGNhbGxiYWNrLiBJZiB0aGlzIGFyZ3VtZW50IGlz
        IHBhc3NlZCB0aGVuIHRoZSAzcmQgYXJndW1lbnQKICAgIGJlY29tZXMgdGhl
        IGZ1bmN0aW9uLgoKICAgIEBtZXRob2Qgb25lCiAgICBAcGFyYW0ge1N0cmlu
        Z30gbmFtZSBUaGUgbmFtZSBvZiB0aGUgZXZlbnQKICAgIEBwYXJhbSB7T2Jq
        ZWN0fSBbdGFyZ2V0XSBUaGUgInRoaXMiIGJpbmRpbmcgZm9yIHRoZSBjYWxs
        YmFjawogICAgQHBhcmFtIHtGdW5jdGlvbn0gbWV0aG9kIFRoZSBjYWxsYmFj
        ayB0byBleGVjdXRlCiAgICBAcmV0dXJuIHRoaXMKICAqLwogIG9uZTogZnVu
        Y3Rpb24obmFtZSwgdGFyZ2V0LCBtZXRob2QpIHsKICAgIGlmICghbWV0aG9k
        KSB7CiAgICAgIG1ldGhvZCA9IHRhcmdldDsKICAgICAgdGFyZ2V0ID0gbnVs
        bDsKICAgIH0KCiAgICBFbWJlci5hZGRMaXN0ZW5lcih0aGlzLCBuYW1lLCB0
        YXJnZXQsIG1ldGhvZCwgdHJ1ZSk7CiAgICByZXR1cm4gdGhpczsKICB9LAoK
        ICAvKioKICAgIFRyaWdnZXJzIGEgbmFtZWQgZXZlbnQgZm9yIHRoZSBvYmpl
        Y3QuIEFueSBhZGRpdGlvbmFsIGFyZ3VtZW50cwogICAgd2lsbCBiZSBwYXNz
        ZWQgYXMgcGFyYW1ldGVycyB0byB0aGUgZnVuY3Rpb25zIHRoYXQgYXJlIHN1
        YnNjcmliZWQgdG8gdGhlCiAgICBldmVudC4KCiAgICBgYGBqYXZhc2NyaXB0
        CiAgICBwZXJzb24ub24oJ2RpZEVhdCcsIGZ1bmN0aW9uKGZvb2QpIHsKICAg
        ICAgY29uc29sZS5sb2coJ3BlcnNvbiBhdGUgc29tZSAnICsgZm9vZCk7CiAg
        ICB9KTsKCiAgICBwZXJzb24udHJpZ2dlcignZGlkRWF0JywgJ2Jyb2Njb2xp
        Jyk7CgogICAgLy8gb3V0cHV0czogcGVyc29uIGF0ZSBzb21lIGJyb2Njb2xp
        CiAgICBgYGAKICAgIEBtZXRob2QgdHJpZ2dlcgogICAgQHBhcmFtIHtTdHJp
        bmd9IG5hbWUgVGhlIG5hbWUgb2YgdGhlIGV2ZW50CiAgICBAcGFyYW0ge09i
        amVjdC4uLn0gYXJncyBPcHRpb25hbCBhcmd1bWVudHMgdG8gcGFzcyBvbgog
        ICovCiAgdHJpZ2dlcjogZnVuY3Rpb24obmFtZSkgewogICAgdmFyIGFyZ3Mg
        PSBbXSwgaSwgbDsKICAgIGZvciAoaSA9IDEsIGwgPSBhcmd1bWVudHMubGVu
        Z3RoOyBpIDwgbDsgaSsrKSB7CiAgICAgIGFyZ3MucHVzaChhcmd1bWVudHNb
        aV0pOwogICAgfQogICAgRW1iZXIuc2VuZEV2ZW50KHRoaXMsIG5hbWUsIGFy
        Z3MpOwogIH0sCgogIC8qKgogICAgQ2FuY2VscyBzdWJzY3JpcHRpb24gZm9y
        IGdpdmVuIG5hbWUsIHRhcmdldCwgYW5kIG1ldGhvZC4KCiAgICBAbWV0aG9k
        IG9mZgogICAgQHBhcmFtIHtTdHJpbmd9IG5hbWUgVGhlIG5hbWUgb2YgdGhl
        IGV2ZW50CiAgICBAcGFyYW0ge09iamVjdH0gdGFyZ2V0IFRoZSB0YXJnZXQg
        b2YgdGhlIHN1YnNjcmlwdGlvbgogICAgQHBhcmFtIHtGdW5jdGlvbn0gbWV0
        aG9kIFRoZSBmdW5jdGlvbiBvZiB0aGUgc3Vic2NyaXB0aW9uCiAgICBAcmV0
        dXJuIHRoaXMKICAqLwogIG9mZjogZnVuY3Rpb24obmFtZSwgdGFyZ2V0LCBt
        ZXRob2QpIHsKICAgIEVtYmVyLnJlbW92ZUxpc3RlbmVyKHRoaXMsIG5hbWUs
        IHRhcmdldCwgbWV0aG9kKTsKICAgIHJldHVybiB0aGlzOwogIH0sCgogIC8q
        KgogICAgQ2hlY2tzIHRvIHNlZSBpZiBvYmplY3QgaGFzIGFueSBzdWJzY3Jp
        cHRpb25zIGZvciBuYW1lZCBldmVudC4KCiAgICBAbWV0aG9kIGhhcwogICAg
        QHBhcmFtIHtTdHJpbmd9IG5hbWUgVGhlIG5hbWUgb2YgdGhlIGV2ZW50CiAg
        ICBAcmV0dXJuIHtCb29sZWFufSBkb2VzIHRoZSBvYmplY3QgaGF2ZSBhIHN1
        YnNjcmlwdGlvbiBmb3IgZXZlbnQKICAgKi8KICBoYXM6IGZ1bmN0aW9uKG5h
        bWUpIHsKICAgIHJldHVybiBFbWJlci5oYXNMaXN0ZW5lcnModGhpcywgbmFt
        ZSk7CiAgfQp9KTsKCn0pKCk7CgoKCihmdW5jdGlvbigpIHsKdmFyIFJTVlAg
        PSByZXF1aXJlTW9kdWxlKCJyc3ZwIik7CgpSU1ZQLmNvbmZpZ3VyZSgnYXN5
        bmMnLCBmdW5jdGlvbihjYWxsYmFjaywgcHJvbWlzZSkgewogIEVtYmVyLnJ1
        bi5zY2hlZHVsZSgnYWN0aW9ucycsIHByb21pc2UsIGNhbGxiYWNrLCBwcm9t
        aXNlKTsKfSk7CgovKioKQG1vZHVsZSBlbWJlcgpAc3VibW9kdWxlIGVtYmVy
        LXJ1bnRpbWUKKi8KCnZhciBnZXQgPSBFbWJlci5nZXQ7CgovKioKICBAY2xh
        c3MgRGVmZXJyZWQKICBAbmFtZXNwYWNlIEVtYmVyCiAqLwpFbWJlci5EZWZl
        cnJlZE1peGluID0gRW1iZXIuTWl4aW4uY3JlYXRlKHsKICAvKioKICAgIEFk
        ZCBoYW5kbGVycyB0byBiZSBjYWxsZWQgd2hlbiB0aGUgRGVmZXJyZWQgb2Jq
        ZWN0IGlzIHJlc29sdmVkIG9yIHJlamVjdGVkLgoKICAgIEBtZXRob2QgdGhl
        bgogICAgQHBhcmFtIHtGdW5jdGlvbn0gcmVzb2x2ZSBhIGNhbGxiYWNrIGZ1
        bmN0aW9uIHRvIGJlIGNhbGxlZCB3aGVuIGRvbmUKICAgIEBwYXJhbSB7RnVu
        Y3Rpb259IHJlamVjdCAgYSBjYWxsYmFjayBmdW5jdGlvbiB0byBiZSBjYWxs
        ZWQgd2hlbiBmYWlsZWQKICAqLwogIHRoZW46IGZ1bmN0aW9uKHJlc29sdmUs
        IHJlamVjdCkgewogICAgdmFyIGRlZmVycmVkLCBwcm9taXNlLCBlbnRpdHk7
        CgogICAgZW50aXR5ID0gdGhpczsKICAgIGRlZmVycmVkID0gZ2V0KHRoaXMs
        ICdfZGVmZXJyZWQnKTsKICAgIHByb21pc2UgPSBkZWZlcnJlZC5wcm9taXNl
        OwoKICAgIGZ1bmN0aW9uIGZ1bGZpbGxtZW50SGFuZGxlcihmdWxmaWxsbWVu
        dCkgewogICAgICBpZiAoZnVsZmlsbG1lbnQgPT09IHByb21pc2UpIHsKICAg
        ICAgICByZXR1cm4gcmVzb2x2ZShlbnRpdHkpOwogICAgICB9IGVsc2Ugewog
        ICAgICAgIHJldHVybiByZXNvbHZlKGZ1bGZpbGxtZW50KTsKICAgICAgfQog
        ICAgfQoKICAgIHJldHVybiBwcm9taXNlLnRoZW4ocmVzb2x2ZSAmJiBmdWxm
        aWxsbWVudEhhbmRsZXIsIHJlamVjdCk7CiAgfSwKCiAgLyoqCiAgICBSZXNv
        bHZlIGEgRGVmZXJyZWQgb2JqZWN0IGFuZCBjYWxsIGFueSBgZG9uZUNhbGxi
        YWNrc2Agd2l0aCB0aGUgZ2l2ZW4gYXJncy4KCiAgICBAbWV0aG9kIHJlc29s
        dmUKICAqLwogIHJlc29sdmU6IGZ1bmN0aW9uKHZhbHVlKSB7CiAgICB2YXIg
        ZGVmZXJyZWQsIHByb21pc2U7CgogICAgZGVmZXJyZWQgPSBnZXQodGhpcywg
        J19kZWZlcnJlZCcpOwogICAgcHJvbWlzZSA9IGRlZmVycmVkLnByb21pc2U7
        CgogICAgaWYgKHZhbHVlID09PSB0aGlzKSB7CiAgICAgIGRlZmVycmVkLnJl
        c29sdmUocHJvbWlzZSk7CiAgICB9IGVsc2UgewogICAgICBkZWZlcnJlZC5y
        ZXNvbHZlKHZhbHVlKTsKICAgIH0KICB9LAoKICAvKioKICAgIFJlamVjdCBh
        IERlZmVycmVkIG9iamVjdCBhbmQgY2FsbCBhbnkgYGZhaWxDYWxsYmFja3Ng
        IHdpdGggdGhlIGdpdmVuIGFyZ3MuCgogICAgQG1ldGhvZCByZWplY3QKICAq
        LwogIHJlamVjdDogZnVuY3Rpb24odmFsdWUpIHsKICAgIGdldCh0aGlzLCAn
        X2RlZmVycmVkJykucmVqZWN0KHZhbHVlKTsKICB9LAoKICBfZGVmZXJyZWQ6
        IEVtYmVyLmNvbXB1dGVkKGZ1bmN0aW9uKCkgewogICAgcmV0dXJuIFJTVlAu
        ZGVmZXIoKTsKICB9KQp9KTsKCgp9KSgpOwoKCgooZnVuY3Rpb24oKSB7Ci8q
        KgpAbW9kdWxlIGVtYmVyCkBzdWJtb2R1bGUgZW1iZXItcnVudGltZQoqLwoK
        dmFyIGdldCA9IEVtYmVyLmdldDsKCi8qKgogIFRoZSBgRW1iZXIuQWN0aW9u
        SGFuZGxlcmAgbWl4aW4gaW1wbGVtZW50cyBzdXBwb3J0IGZvciBtb3Zpbmcg
        YW4gYGFjdGlvbnNgCiAgcHJvcGVydHkgdG8gYW4gYF9hY3Rpb25zYCBwcm9w
        ZXJ0eSBhdCBleHRlbmQgdGltZSwgYW5kIGFkZGluZyBgX2FjdGlvbnNgCiAg
        dG8gdGhlIG9iamVjdCdzIG1lcmdlZFByb3BlcnRpZXMgbGlzdC4KCiAgYEVt
        YmVyLkFjdGlvbkhhbmRsZXJgIGlzIHVzZWQgaW50ZXJuYWxseSBieSBFbWJl
        ciBpbiAgYEVtYmVyLlZpZXdgLAogIGBFbWJlci5Db250cm9sbGVyYCwgYW5k
        IGBFbWJlci5Sb3V0ZWAuCgogIEBjbGFzcyBBY3Rpb25IYW5kbGVyCiAgQG5h
        bWVzcGFjZSBFbWJlcgoqLwpFbWJlci5BY3Rpb25IYW5kbGVyID0gRW1iZXIu
        TWl4aW4uY3JlYXRlKHsKICBtZXJnZWRQcm9wZXJ0aWVzOiBbJ19hY3Rpb25z
        J10sCgogIC8qKgogICAgQHByaXZhdGUKCiAgICBNb3ZlcyBgYWN0aW9uc2Ag
        dG8gYF9hY3Rpb25zYCBhdCBleHRlbmQgdGltZS4gTm90ZSB0aGF0IHRoaXMg
        Y3VycmVudGx5CiAgICBtb2RpZmllcyB0aGUgbWl4aW4gdGhlbXNlbHZlcywg
        d2hpY2ggaXMgdGVjaG5pY2FsbHkgZHViaW91cyBidXQKICAgIGlzIHByYWN0
        aWNhbGx5IG9mIGxpdHRsZSBjb25zZXF1ZW5jZS4gVGhpcyBtYXkgY2hhbmdl
        IGluIHRoZSBmdXR1cmUuCgogICAgQG1ldGhvZCB3aWxsTWVyZ2VNaXhpbgog
        ICovCiAgd2lsbE1lcmdlTWl4aW46IGZ1bmN0aW9uKHByb3BzKSB7CiAgICBp
        ZiAocHJvcHMuYWN0aW9ucyAmJiAhcHJvcHMuX2FjdGlvbnMpIHsKICAgICAg
        cHJvcHMuX2FjdGlvbnMgPSBFbWJlci5tZXJnZShwcm9wcy5fYWN0aW9ucyB8
        fCB7fSwgcHJvcHMuYWN0aW9ucyk7CiAgICAgIGRlbGV0ZSBwcm9wcy5hY3Rp
        b25zOwogICAgfQogIH0sCgogIHNlbmQ6IGZ1bmN0aW9uKGFjdGlvbk5hbWUp
        IHsKICAgIHZhciBhcmdzID0gW10uc2xpY2UuY2FsbChhcmd1bWVudHMsIDEp
        LCB0YXJnZXQ7CgogICAgaWYgKHRoaXMuX2FjdGlvbnMgJiYgdGhpcy5fYWN0
        aW9uc1thY3Rpb25OYW1lXSkgewogICAgICBpZiAodGhpcy5fYWN0aW9uc1th
        Y3Rpb25OYW1lXS5hcHBseSh0aGlzLCBhcmdzKSA9PT0gdHJ1ZSkgewogICAg
        ICAgIC8vIGhhbmRsZXIgcmV0dXJuZWQgdHJ1ZSwgc28gdGhpcyBhY3Rpb24g
        d2lsbCBidWJibGUKICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm47CiAg
        ICAgIH0KICAgIH0gZWxzZSBpZiAodGhpcy5kZXByZWNhdGVkU2VuZCAmJiB0
        aGlzLmRlcHJlY2F0ZWRTZW5kSGFuZGxlcyAmJiB0aGlzLmRlcHJlY2F0ZWRT
        ZW5kSGFuZGxlcyhhY3Rpb25OYW1lKSkgewogICAgICBpZiAodGhpcy5kZXBy
        ZWNhdGVkU2VuZC5hcHBseSh0aGlzLCBbXS5zbGljZS5jYWxsKGFyZ3VtZW50
        cykpID09PSB0cnVlKSB7CiAgICAgICAgLy8gaGFuZGxlciByZXR1cm4gdHJ1
        ZSwgc28gdGhpcyBhY3Rpb24gd2lsbCBidWJibGUKICAgICAgfSBlbHNlIHsK
        ICAgICAgICByZXR1cm47CiAgICAgIH0KICAgIH0KCiAgICBpZiAodGFyZ2V0
        ID0gZ2V0KHRoaXMsICd0YXJnZXQnKSkgewogICAgICBFbWJlci5hc3NlcnQo
        IlRoZSBgdGFyZ2V0YCBmb3IgIiArIHRoaXMgKyAiICgiICsgdGFyZ2V0ICsg
        IikgZG9lcyBub3QgaGF2ZSBhIGBzZW5kYCBtZXRob2QiLCB0eXBlb2YgdGFy
        Z2V0LnNlbmQgPT09ICdmdW5jdGlvbicpOwogICAgICB0YXJnZXQuc2VuZC5h
        cHBseSh0YXJnZXQsIGFyZ3VtZW50cyk7CiAgICB9CiAgfQoKfSk7Cgp9KSgp
        OwoKCgooZnVuY3Rpb24oKSB7CnZhciBzZXQgPSBFbWJlci5zZXQsIGdldCA9
        IEVtYmVyLmdldCwKICAgIHJlc29sdmUgPSBFbWJlci5SU1ZQLnJlc29sdmUs
        CiAgICByZXRocm93ID0gRW1iZXIuUlNWUC5yZXRocm93LAogICAgbm90ID0g
        RW1iZXIuY29tcHV0ZWQubm90LAogICAgb3IgPSBFbWJlci5jb21wdXRlZC5v
        cjsKCi8qKgogIEBtb2R1bGUgZW1iZXIKICBAc3VibW9kdWxlIGVtYmVyLXJ1
        bnRpbWUKICovCgpmdW5jdGlvbiBpbnN0YWxsUHJvbWlzZShwcm94eSwgcHJv
        bWlzZSkgewogIHByb21pc2UudGhlbihmdW5jdGlvbih2YWx1ZSkgewogICAg
        c2V0KHByb3h5LCAnaXNGdWxmaWxsZWQnLCB0cnVlKTsKICAgIHNldChwcm94
        eSwgJ2NvbnRlbnQnLCB2YWx1ZSk7CgogICAgcmV0dXJuIHZhbHVlOwogIH0s
        IGZ1bmN0aW9uKHJlYXNvbikgewogICAgc2V0KHByb3h5LCAnaXNSZWplY3Rl
        ZCcsIHRydWUpOwogICAgc2V0KHByb3h5LCAncmVhc29uJywgcmVhc29uKTsK
        ICB9KS5mYWlsKHJldGhyb3cpOwp9CgovKioKICBBIGxvdyBsZXZlbCBtaXhp
        biBtYWtpbmcgT2JqZWN0UHJveHksIE9iamVjdENvbnRyb2xsZXIgb3IgQXJy
        YXlDb250cm9sbGVyJ3MgcHJvbWlzZSBhd2FyZS4KCiAgYGBgamF2YXNjcmlw
        dAogIHZhciBPYmplY3RQcm9taXNlQ29udHJvbGxlciA9IEVtYmVyLk9iamVj
        dENvbnRyb2xsZXIuZXh0ZW5kKEVtYmVyLlByb21pc2VQcm94eU1peGluKTsK
        CiAgdmFyIGNvbnRyb2xsZXIgPSBPYmplY3RQcm9taXNlQ29udHJvbGxlci5j
        cmVhdGUoewogICAgcHJvbWlzZTogJC5nZXRKU09OKCcvc29tZS9yZW1vdGUv
        ZGF0YS5qc29uJykKICB9KTsKCiAgY29udHJvbGxlci50aGVuKGZ1bmN0aW9u
        KGpzb24pewogICAgIC8vIHRoZSBqc29uCiAgfSwgZnVuY3Rpb24ocmVhc29u
        KSB7CiAgICAgLy8gdGhlIHJlYXNvbiB3aHkgeW91IGhhdmUgbm8ganNvbgog
        IH0pOwogIGBgYAoKICB0aGUgY29udHJvbGxlciBoYXMgYmluZGFibGUgYXR0
        cmlidXRlcyB3aGljaAogIHRyYWNrIHRoZSBwcm9taXNlcyBsaWZlIGN5Y2xl
        CgogIGBgYGphdmFzY3JpcHQKICBjb250cm9sbGVyLmdldCgnaXNQZW5kaW5n
        JykgICAvLz0+IHRydWUKICBjb250cm9sbGVyLmdldCgnaXNTZXR0bGVkJykg
        IC8vPT4gZmFsc2UKICBjb250cm9sbGVyLmdldCgnaXNSZWplY3RlZCcpICAv
        Lz0+IGZhbHNlCiAgY29udHJvbGxlci5nZXQoJ2lzRnVsZmlsbGVkJykgLy89
        PiBmYWxzZQogIGBgYAoKICBXaGVuIHRoZSB0aGUgJC5nZXRKU09OIGNvbXBs
        ZXRlcywgYW5kIHRoZSBwcm9taXNlIGlzIGZ1bGZpbGxlZAogIHdpdGgganNv
        biwgdGhlIGxpZmUgY3ljbGUgYXR0cmlidXRlcyB3aWxsIHVwZGF0ZSBhY2Nv
        cmRpbmdseS4KCiAgYGBgamF2YXNjcmlwdAogIGNvbnRyb2xsZXIuZ2V0KCdp
        c1BlbmRpbmcnKSAgIC8vPT4gZmFsc2UKICBjb250cm9sbGVyLmdldCgnaXNT
        ZXR0bGVkJykgICAvLz0+IHRydWUKICBjb250cm9sbGVyLmdldCgnaXNSZWpl
        Y3RlZCcpICAvLz0+IGZhbHNlCiAgY29udHJvbGxlci5nZXQoJ2lzRnVsZmls
        bGVkJykgLy89PiB0cnVlCiAgYGBgCgogIEFzIHRoZSBjb250cm9sbGVyIGlz
        IGFuIE9iamVjdENvbnRyb2xsZXIsIGFuZCB0aGUganNvbiBub3cgaXRzIGNv
        bnRlbnQsCiAgYWxsIHRoZSBqc29uIHByb3BlcnRpZXMgd2lsbCBiZSBhdmFp
        bGFibGUgZGlyZWN0bHkgZnJvbSB0aGUgY29udHJvbGxlci4KCiAgYGBgamF2
        YXNjcmlwdAogIC8vIEFzc3VtaW5nIHRoZSBmb2xsb3dpbmcganNvbjoKICB7
        CiAgICBmaXJzdE5hbWU6ICdTdGVmYW4nLAogICAgbGFzdE5hbWU6ICdQZW5u
        ZXInCiAgfQoKICAvLyBib3RoIHByb3BlcnRpZXMgd2lsbCBhY2Nlc3NpYmxl
        IG9uIHRoZSBjb250cm9sbGVyCiAgY29udHJvbGxlci5nZXQoJ2ZpcnN0TmFt
        ZScpIC8vPT4gJ1N0ZWZhbicKICBjb250cm9sbGVyLmdldCgnbGFzdE5hbWUn
        KSAgLy89PiAnUGVubmVyJwogIGBgYAoKICBJZiB0aGUgY29udHJvbGxlciBp
        cyBiYWNraW5nIGEgdGVtcGxhdGUsIHRoZSBhdHRyaWJ1dGVzIGFyZSAKICBi
        aW5kYWJsZSBmcm9tIHdpdGhpbiB0aGF0IHRlbXBsYXRlCgogIGBgYGhhbmRs
        ZWJhcnMKICB7eyNpZiBpc1BlbmRpbmd9fQogICAgbG9hZGluZy4uLgogIHt7
        ZWxzZX19CiAgICBmaXJzdE5hbWU6IHt7Zmlyc3ROYW1lfX0KICAgIGxhc3RO
        YW1lOiB7e2xhc3ROYW1lfX0KICB7ey9pZn19CiAgYGBgCiAgQGNsYXNzIEVt
        YmVyLlByb21pc2VQcm94eU1peGluCiovCkVtYmVyLlByb21pc2VQcm94eU1p
        eGluID0gRW1iZXIuTWl4aW4uY3JlYXRlKHsKICByZWFzb246ICAgIG51bGws
        CiAgaXNQZW5kaW5nOiAgbm90KCdpc1NldHRsZWQnKS5yZWFkT25seSgpLAog
        IGlzU2V0dGxlZDogIG9yKCdpc1JlamVjdGVkJywgJ2lzRnVsZmlsbGVkJyku
        cmVhZE9ubHkoKSwKICBpc1JlamVjdGVkOiAgZmFsc2UsCiAgaXNGdWxmaWxs
        ZWQ6IGZhbHNlLAoKICBwcm9taXNlOiBFbWJlci5jb21wdXRlZChmdW5jdGlv
        bihrZXksIHByb21pc2UpIHsKICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID09
        PSAyKSB7CiAgICAgIHByb21pc2UgPSByZXNvbHZlKHByb21pc2UpOwogICAg
        ICBpbnN0YWxsUHJvbWlzZSh0aGlzLCBwcm9taXNlKTsKICAgICAgcmV0dXJu
        IHByb21pc2U7CiAgICB9IGVsc2UgewogICAgICB0aHJvdyBuZXcgRW1iZXIu
        RXJyb3IoIlByb21pc2VQcm94eSdzIHByb21pc2UgbXVzdCBiZSBzZXQiKTsK
        ICAgIH0KICB9KSwKCiAgdGhlbjogZnVuY3Rpb24oZnVsZmlsbCwgcmVqZWN0
        KSB7CiAgICByZXR1cm4gZ2V0KHRoaXMsICdwcm9taXNlJykudGhlbihmdWxm
        aWxsLCByZWplY3QpOwogIH0KfSk7CgoKfSkoKTsKCgoKKGZ1bmN0aW9uKCkg
        ewoKfSkoKTsKCgoKKGZ1bmN0aW9uKCkgewp2YXIgZ2V0ID0gRW1iZXIuZ2V0
        LAogICAgZm9yRWFjaCA9IEVtYmVyLkVudW1lcmFibGVVdGlscy5mb3JFYWNo
        LAogICAgUkVUQUlOID0gJ3InLAogICAgSU5TRVJUID0gJ2knLAogICAgREVM
        RVRFID0gJ2QnOwoKLyoqCiAgQW4gYEVtYmVyLlRyYWNrZWRBcnJheWAgdHJh
        Y2tzIGFycmF5IG9wZXJhdGlvbnMuICBJdCdzIHVzZWZ1bCB3aGVuIHlvdSB3
        YW50IHRvCiAgbGF6aWx5IGNvbXB1dGUgdGhlIGluZGV4ZXMgb2YgaXRlbXMg
        aW4gYW4gYXJyYXkgYWZ0ZXIgdGhleSd2ZSBiZWVuIHNoaWZ0ZWQgYnkKICBz
        dWJzZXF1ZW50IG9wZXJhdGlvbnMuCgogIEBjbGFzcyBUcmFja2VkQXJyYXkK
        ICBAbmFtZXNwYWNlIEVtYmVyCiAgQHBhcmFtIHthcnJheX0gW2l0ZW1zPVtd
        XSBUaGUgYXJyYXkgdG8gYmUgdHJhY2tlZC4gIFRoaXMgaXMgdXNlZCBqdXN0
        IHRvIGdldAogIHRoZSBpbml0aWFsIGl0ZW1zIGZvciB0aGUgc3RhcnRpbmcg
        c3RhdGUgb2YgcmV0YWluOm4uCiovCkVtYmVyLlRyYWNrZWRBcnJheSA9IGZ1
        bmN0aW9uIChpdGVtcykgewogIGlmIChhcmd1bWVudHMubGVuZ3RoIDwgMSkg
        eyBpdGVtcyA9IFtdOyB9CgogIHZhciBsZW5ndGggPSBnZXQoaXRlbXMsICds
        ZW5ndGgnKTsKCiAgaWYgKGxlbmd0aCkgewogICAgdGhpcy5fb3BlcmF0aW9u
        cyA9IFtuZXcgQXJyYXlPcGVyYXRpb24oUkVUQUlOLCBsZW5ndGgsIGl0ZW1z
        KV07CiAgfSBlbHNlIHsKICAgIHRoaXMuX29wZXJhdGlvbnMgPSBbXTsKICB9
        Cn07CgpFbWJlci5UcmFja2VkQXJyYXkuUkVUQUlOID0gUkVUQUlOOwpFbWJl
        ci5UcmFja2VkQXJyYXkuSU5TRVJUID0gSU5TRVJUOwpFbWJlci5UcmFja2Vk
        QXJyYXkuREVMRVRFID0gREVMRVRFOwoKRW1iZXIuVHJhY2tlZEFycmF5LnBy
        b3RvdHlwZSA9IHsKCiAgLyoqCiAgICBUcmFjayB0aGF0IGBuZXdJdGVtc2Ag
        d2VyZSBhZGRlZCB0byB0aGUgdHJhY2tlZCBhcnJheSBhdCBgaW5kZXhgLgoK
        ICAgIEBtZXRob2QgYWRkSXRlbXMKICAgIEBwYXJhbSBpbmRleAogICAgQHBh
        cmFtIG5ld0l0ZW1zCiAgKi8KICBhZGRJdGVtczogZnVuY3Rpb24gKGluZGV4
        LCBuZXdJdGVtcykgewogICAgdmFyIGNvdW50ID0gZ2V0KG5ld0l0ZW1zLCAn
        bGVuZ3RoJyk7CiAgICBpZiAoY291bnQgPCAxKSB7IHJldHVybjsgfQoKICAg
        IHZhciBtYXRjaCA9IHRoaXMuX2ZpbmRBcnJheU9wZXJhdGlvbihpbmRleCks
        CiAgICAgICAgYXJyYXlPcGVyYXRpb24gPSBtYXRjaC5vcGVyYXRpb24sCiAg
        ICAgICAgYXJyYXlPcGVyYXRpb25JbmRleCA9IG1hdGNoLmluZGV4LAogICAg
        ICAgIGFycmF5T3BlcmF0aW9uUmFuZ2VTdGFydCA9IG1hdGNoLnJhbmdlU3Rh
        cnQsCiAgICAgICAgY29tcG9zZUluZGV4LAogICAgICAgIHNwbGl0SW5kZXgs
        CiAgICAgICAgc3BsaXRJdGVtcywKICAgICAgICBzcGxpdEFycmF5T3BlcmF0
        aW9uLAogICAgICAgIG5ld0FycmF5T3BlcmF0aW9uOwoKICAgIG5ld0FycmF5
        T3BlcmF0aW9uID0gbmV3IEFycmF5T3BlcmF0aW9uKElOU0VSVCwgY291bnQs
        IG5ld0l0ZW1zKTsKCiAgICBpZiAoYXJyYXlPcGVyYXRpb24pIHsKICAgICAg
        aWYgKCFtYXRjaC5zcGxpdCkgewogICAgICAgIC8vIGluc2VydCBsZWZ0IG9m
        IGFycmF5T3BlcmF0aW9uCiAgICAgICAgdGhpcy5fb3BlcmF0aW9ucy5zcGxp
        Y2UoYXJyYXlPcGVyYXRpb25JbmRleCwgMCwgbmV3QXJyYXlPcGVyYXRpb24p
        OwogICAgICAgIGNvbXBvc2VJbmRleCA9IGFycmF5T3BlcmF0aW9uSW5kZXg7
        CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5fc3BsaXQoYXJyYXlPcGVy
        YXRpb25JbmRleCwgaW5kZXggLSBhcnJheU9wZXJhdGlvblJhbmdlU3RhcnQs
        IG5ld0FycmF5T3BlcmF0aW9uKTsKICAgICAgICBjb21wb3NlSW5kZXggPSBh
        cnJheU9wZXJhdGlvbkluZGV4ICsgMTsKICAgICAgfQogICAgfSBlbHNlIHsK
        ICAgICAgLy8gaW5zZXJ0IGF0IGVuZAogICAgICB0aGlzLl9vcGVyYXRpb25z
        LnB1c2gobmV3QXJyYXlPcGVyYXRpb24pOwogICAgICBjb21wb3NlSW5kZXgg
        PSBhcnJheU9wZXJhdGlvbkluZGV4OwogICAgfQoKICAgIHRoaXMuX2NvbXBv
        c2VJbnNlcnQoY29tcG9zZUluZGV4KTsKICB9LAoKICAvKioKICAgIFRyYWNr
        IHRoYXQgYGNvdW50YCBpdGVtcyB3ZXJlIHJlbW92ZWQgYXQgYGluZGV4YC4K
        CiAgICBAbWV0aG9kIHJlbW92ZUl0ZW1zCiAgICBAcGFyYW0gaW5kZXgKICAg
        IEBwYXJhbSBjb3VudAogICovCiAgcmVtb3ZlSXRlbXM6IGZ1bmN0aW9uIChp
        bmRleCwgY291bnQpIHsKICAgIGlmIChjb3VudCA8IDEpIHsgcmV0dXJuOyB9
        CgogICAgdmFyIG1hdGNoID0gdGhpcy5fZmluZEFycmF5T3BlcmF0aW9uKGlu
        ZGV4KSwKICAgICAgICBhcnJheU9wZXJhdGlvbiA9IG1hdGNoLm9wZXJhdGlv
        biwKICAgICAgICBhcnJheU9wZXJhdGlvbkluZGV4ID0gbWF0Y2guaW5kZXgs
        CiAgICAgICAgYXJyYXlPcGVyYXRpb25SYW5nZVN0YXJ0ID0gbWF0Y2gucmFu
        Z2VTdGFydCwKICAgICAgICBuZXdBcnJheU9wZXJhdGlvbiwKICAgICAgICBj
        b21wb3NlSW5kZXg7CgogICAgbmV3QXJyYXlPcGVyYXRpb24gPSBuZXcgQXJy
        YXlPcGVyYXRpb24oREVMRVRFLCBjb3VudCk7CiAgICBpZiAoIW1hdGNoLnNw
        bGl0KSB7CiAgICAgIC8vIGluc2VydCBsZWZ0IG9mIGFycmF5T3BlcmF0aW9u
        CiAgICAgIHRoaXMuX29wZXJhdGlvbnMuc3BsaWNlKGFycmF5T3BlcmF0aW9u
        SW5kZXgsIDAsIG5ld0FycmF5T3BlcmF0aW9uKTsKICAgICAgY29tcG9zZUlu
        ZGV4ID0gYXJyYXlPcGVyYXRpb25JbmRleDsKICAgIH0gZWxzZSB7CiAgICAg
        IHRoaXMuX3NwbGl0KGFycmF5T3BlcmF0aW9uSW5kZXgsIGluZGV4IC0gYXJy
        YXlPcGVyYXRpb25SYW5nZVN0YXJ0LCBuZXdBcnJheU9wZXJhdGlvbik7CiAg
        ICAgIGNvbXBvc2VJbmRleCA9IGFycmF5T3BlcmF0aW9uSW5kZXggKyAxOwog
        ICAgfQoKICAgIHJldHVybiB0aGlzLl9jb21wb3NlRGVsZXRlKGNvbXBvc2VJ
        bmRleCk7CiAgfSwKCiAgLyoqCiAgICBBcHBseSBhbGwgb3BlcmF0aW9ucywg
        cmVkdWNpbmcgdGhlbSB0byByZXRhaW46biwgZm9yIGBuYCwgdGhlIG51bWJl
        ciBvZgogICAgaXRlbXMgaW4gdGhlIGFycmF5LgoKICAgIGBjYWxsYmFja2Ag
        d2lsbCBiZSBjYWxsZWQgZm9yIGVhY2ggb3BlcmF0aW9uIGFuZCB3aWxsIGJl
        IHBhc3NlZCB0aGUgZm9sbG93aW5nIGFyZ3VtZW50czoKICAgICAgKiB7YXJy
        YXl9IGl0ZW1zIFRoZSBpdGVtcyBmb3IgdGhlIGdpdmVuIG9wZXJhdGlvbgog
        ICAgICAqIHtudW1iZXJ9IG9mZnNldCBUaGUgY29tcHV0ZWQgb2Zmc2V0IG9m
        IHRoZSBpdGVtcywgaWUgdGhlIGluZGV4IGluIHRoZQogICAgICBhcnJheSBv
        ZiB0aGUgZmlyc3QgaXRlbSBmb3IgdGhpcyBvcGVyYXRpb24uCiAgICAgICog
        e3N0cmluZ30gb3BlcmF0aW9uIFRoZSB0eXBlIG9mIHRoZSBvcGVyYXRpb24u
        ICBPbmUgb2YKICAgICAgYEVtYmVyLlRyYWNrZWRBcnJheS57UkVUQUlOLCBE
        RUxFVEUsIElOU0VSVH1gCgogICAgQG1ldGhvZCBhcHBseQogICAgQHBhcmFt
        IHtmdW5jdGlvbn0gY2FsbGJhY2sKICAqLwogIGFwcGx5OiBmdW5jdGlvbiAo
        Y2FsbGJhY2spIHsKICAgIHZhciBpdGVtcyA9IFtdLAogICAgICAgIG9mZnNl
        dCA9IDA7CgogICAgZm9yRWFjaCh0aGlzLl9vcGVyYXRpb25zLCBmdW5jdGlv
        biAoYXJyYXlPcGVyYXRpb24pIHsKICAgICAgY2FsbGJhY2soYXJyYXlPcGVy
        YXRpb24uaXRlbXMsIG9mZnNldCwgYXJyYXlPcGVyYXRpb24udHlwZSk7Cgog
        ICAgICBpZiAoYXJyYXlPcGVyYXRpb24udHlwZSAhPT0gREVMRVRFKSB7CiAg
        ICAgICAgb2Zmc2V0ICs9IGFycmF5T3BlcmF0aW9uLmNvdW50OwogICAgICAg
        IGl0ZW1zID0gaXRlbXMuY29uY2F0KGFycmF5T3BlcmF0aW9uLml0ZW1zKTsK
        ICAgICAgfQogICAgfSk7CgogICAgdGhpcy5fb3BlcmF0aW9ucyA9IFtuZXcg
        QXJyYXlPcGVyYXRpb24oUkVUQUlOLCBpdGVtcy5sZW5ndGgsIGl0ZW1zKV07
        CiAgfSwKCiAgLyoqCiAgICBSZXR1cm4gYW4gQXJyYXlPcGVyYXRpb25NYXRj
        aCBmb3IgdGhlIG9wZXJhdGlvbiB0aGF0IGNvbnRhaW5zIHRoZSBpdGVtIGF0
        IGBpbmRleGAuCgogICAgQG1ldGhvZCBfZmluZEFycmF5T3BlcmF0aW9uCgog
        ICAgQHBhcmFtIHtudW1iZXJ9IGluZGV4IHRoZSBpbmRleCBvZiB0aGUgaXRl
        bSB3aG9zZSBvcGVyYXRpb24gaW5mb3JtYXRpb24KICAgIHNob3VsZCBiZSBy
        ZXR1cm5lZC4KICAgIEBwcml2YXRlCiAgKi8KICBfZmluZEFycmF5T3BlcmF0
        aW9uOiBmdW5jdGlvbiAoaW5kZXgpIHsKICAgIHZhciBhcnJheU9wZXJhdGlv
        bkluZGV4LAogICAgICAgIGxlbiwKICAgICAgICBzcGxpdCA9IGZhbHNlLAog
        ICAgICAgIGFycmF5T3BlcmF0aW9uLAogICAgICAgIGFycmF5T3BlcmF0aW9u
        UmFuZ2VTdGFydCwKICAgICAgICBhcnJheU9wZXJhdGlvblJhbmdlRW5kOwoK
        ICAgIC8vIE9QVElNSVpFOiB3ZSBjb3VsZCBzZWFyY2ggdGhlc2UgZmFzdGVy
        IGlmIHdlIGtlcHQgYSBiYWxhbmNlZCB0cmVlLgogICAgLy8gZmluZCBsZWZ0
        bW9zdCBhcnJheU9wZXJhdGlvbiB0byB0aGUgcmlnaHQgb2YgYGluZGV4YAog
        ICAgZm9yIChhcnJheU9wZXJhdGlvbkluZGV4ID0gYXJyYXlPcGVyYXRpb25S
        YW5nZVN0YXJ0ID0gMCwgbGVuID0gdGhpcy5fb3BlcmF0aW9ucy5sZW5ndGg7
        IGFycmF5T3BlcmF0aW9uSW5kZXggPCBsZW47ICsrYXJyYXlPcGVyYXRpb25J
        bmRleCkgewogICAgICBhcnJheU9wZXJhdGlvbiA9IHRoaXMuX29wZXJhdGlv
        bnNbYXJyYXlPcGVyYXRpb25JbmRleF07CgogICAgICBpZiAoYXJyYXlPcGVy
        YXRpb24udHlwZSA9PT0gREVMRVRFKSB7IGNvbnRpbnVlOyB9CgogICAgICBh
        cnJheU9wZXJhdGlvblJhbmdlRW5kID0gYXJyYXlPcGVyYXRpb25SYW5nZVN0
        YXJ0ICsgYXJyYXlPcGVyYXRpb24uY291bnQgLSAxOwoKICAgICAgaWYgKGlu
        ZGV4ID09PSBhcnJheU9wZXJhdGlvblJhbmdlU3RhcnQpIHsKICAgICAgICBi
        cmVhazsKICAgICAgfSBlbHNlIGlmIChpbmRleCA+IGFycmF5T3BlcmF0aW9u
        UmFuZ2VTdGFydCAmJiBpbmRleCA8PSBhcnJheU9wZXJhdGlvblJhbmdlRW5k
        KSB7CiAgICAgICAgc3BsaXQgPSB0cnVlOwogICAgICAgIGJyZWFrOwogICAg
        ICB9IGVsc2UgewogICAgICAgIGFycmF5T3BlcmF0aW9uUmFuZ2VTdGFydCA9
        IGFycmF5T3BlcmF0aW9uUmFuZ2VFbmQgKyAxOwogICAgICB9CiAgICB9Cgog
        ICAgcmV0dXJuIG5ldyBBcnJheU9wZXJhdGlvbk1hdGNoKGFycmF5T3BlcmF0
        aW9uLCBhcnJheU9wZXJhdGlvbkluZGV4LCBzcGxpdCwgYXJyYXlPcGVyYXRp
        b25SYW5nZVN0YXJ0KTsKICB9LAoKICBfc3BsaXQ6IGZ1bmN0aW9uIChhcnJh
        eU9wZXJhdGlvbkluZGV4LCBzcGxpdEluZGV4LCBuZXdBcnJheU9wZXJhdGlv
        bikgewogICAgdmFyIGFycmF5T3BlcmF0aW9uID0gdGhpcy5fb3BlcmF0aW9u
        c1thcnJheU9wZXJhdGlvbkluZGV4XSwKICAgICAgICBzcGxpdEl0ZW1zID0g
        YXJyYXlPcGVyYXRpb24uaXRlbXMuc2xpY2Uoc3BsaXRJbmRleCksCiAgICAg
        ICAgc3BsaXRBcnJheU9wZXJhdGlvbiA9IG5ldyBBcnJheU9wZXJhdGlvbihh
        cnJheU9wZXJhdGlvbi50eXBlLCBzcGxpdEl0ZW1zLmxlbmd0aCwgc3BsaXRJ
        dGVtcyk7CgogICAgLy8gdHJ1bmNhdGUgTEhTCiAgICBhcnJheU9wZXJhdGlv
        bi5jb3VudCA9IHNwbGl0SW5kZXg7CiAgICBhcnJheU9wZXJhdGlvbi5pdGVt
        cyA9IGFycmF5T3BlcmF0aW9uLml0ZW1zLnNsaWNlKDAsIHNwbGl0SW5kZXgp
        OwoKICAgIHRoaXMuX29wZXJhdGlvbnMuc3BsaWNlKGFycmF5T3BlcmF0aW9u
        SW5kZXggKyAxLCAwLCBuZXdBcnJheU9wZXJhdGlvbiwgc3BsaXRBcnJheU9w
        ZXJhdGlvbik7CiAgfSwKCiAgLy8gc2VlIFN1YkFycmF5IGZvciBhIGJldHRl
        ciBpbXBsZW1lbnRhdGlvbi4KICBfY29tcG9zZUluc2VydDogZnVuY3Rpb24g
        KGluZGV4KSB7CiAgICB2YXIgbmV3QXJyYXlPcGVyYXRpb24gPSB0aGlzLl9v
        cGVyYXRpb25zW2luZGV4XSwKICAgICAgICBsZWZ0QXJyYXlPcGVyYXRpb24g
        PSB0aGlzLl9vcGVyYXRpb25zW2luZGV4LTFdLCAvLyBtYXkgYmUgdW5kZWZp
        bmVkCiAgICAgICAgcmlnaHRBcnJheU9wZXJhdGlvbiA9IHRoaXMuX29wZXJh
        dGlvbnNbaW5kZXgrMV0sIC8vIG1heSBiZSB1bmRlZmluZWQKICAgICAgICBs
        ZWZ0T3AgPSBsZWZ0QXJyYXlPcGVyYXRpb24gJiYgbGVmdEFycmF5T3BlcmF0
        aW9uLnR5cGUsCiAgICAgICAgcmlnaHRPcCA9IHJpZ2h0QXJyYXlPcGVyYXRp
        b24gJiYgcmlnaHRBcnJheU9wZXJhdGlvbi50eXBlOwoKICAgIGlmIChsZWZ0
        T3AgPT09IElOU0VSVCkgewogICAgICAgIC8vIG1lcmdlIGxlZnQKICAgICAg
        ICBsZWZ0QXJyYXlPcGVyYXRpb24uY291bnQgKz0gbmV3QXJyYXlPcGVyYXRp
        b24uY291bnQ7CiAgICAgICAgbGVmdEFycmF5T3BlcmF0aW9uLml0ZW1zID0g
        bGVmdEFycmF5T3BlcmF0aW9uLml0ZW1zLmNvbmNhdChuZXdBcnJheU9wZXJh
        dGlvbi5pdGVtcyk7CgogICAgICBpZiAocmlnaHRPcCA9PT0gSU5TRVJUKSB7
        CiAgICAgICAgLy8gYWxzbyBtZXJnZSByaWdodCAod2UgaGF2ZSBzcGxpdCBh
        biBpbnNlcnQgd2l0aCBhbiBpbnNlcnQpCiAgICAgICAgbGVmdEFycmF5T3Bl
        cmF0aW9uLmNvdW50ICs9IHJpZ2h0QXJyYXlPcGVyYXRpb24uY291bnQ7CiAg
        ICAgICAgbGVmdEFycmF5T3BlcmF0aW9uLml0ZW1zID0gbGVmdEFycmF5T3Bl
        cmF0aW9uLml0ZW1zLmNvbmNhdChyaWdodEFycmF5T3BlcmF0aW9uLml0ZW1z
        KTsKICAgICAgICB0aGlzLl9vcGVyYXRpb25zLnNwbGljZShpbmRleCwgMik7
        CiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy8gb25seSBtZXJnZSBsZWZ0CiAg
        ICAgICAgdGhpcy5fb3BlcmF0aW9ucy5zcGxpY2UoaW5kZXgsIDEpOwogICAg
        ICB9CiAgICB9IGVsc2UgaWYgKHJpZ2h0T3AgPT09IElOU0VSVCkgewogICAg
        ICAvLyBtZXJnZSByaWdodAogICAgICBuZXdBcnJheU9wZXJhdGlvbi5jb3Vu
        dCArPSByaWdodEFycmF5T3BlcmF0aW9uLmNvdW50OwogICAgICBuZXdBcnJh
        eU9wZXJhdGlvbi5pdGVtcyA9IG5ld0FycmF5T3BlcmF0aW9uLml0ZW1zLmNv
        bmNhdChyaWdodEFycmF5T3BlcmF0aW9uLml0ZW1zKTsKICAgICAgdGhpcy5f
        b3BlcmF0aW9ucy5zcGxpY2UoaW5kZXggKyAxLCAxKTsKICAgIH0KICB9LAoK
        ICBfY29tcG9zZURlbGV0ZTogZnVuY3Rpb24gKGluZGV4KSB7CiAgICB2YXIg
        YXJyYXlPcGVyYXRpb24gPSB0aGlzLl9vcGVyYXRpb25zW2luZGV4XSwKICAg
        ICAgICBkZWxldGVzVG9HbyA9IGFycmF5T3BlcmF0aW9uLmNvdW50LAogICAg
        ICAgIGxlZnRBcnJheU9wZXJhdGlvbiA9IHRoaXMuX29wZXJhdGlvbnNbaW5k
        ZXgtMV0sIC8vIG1heSBiZSB1bmRlZmluZWQKICAgICAgICBsZWZ0T3AgPSBs
        ZWZ0QXJyYXlPcGVyYXRpb24gJiYgbGVmdEFycmF5T3BlcmF0aW9uLnR5cGUs
        CiAgICAgICAgbmV4dEFycmF5T3BlcmF0aW9uLAogICAgICAgIG5leHRPcCwK
        ICAgICAgICBuZXh0Q291bnQsCiAgICAgICAgcmVtb3ZlTmV3QW5kTmV4dE9w
        ID0gZmFsc2UsCiAgICAgICAgcmVtb3ZlZEl0ZW1zID0gW107CgogICAgaWYg
        KGxlZnRPcCA9PT0gREVMRVRFKSB7CiAgICAgIGFycmF5T3BlcmF0aW9uID0g
        bGVmdEFycmF5T3BlcmF0aW9uOwogICAgICBpbmRleCAtPSAxOwogICAgfQoK
        ICAgIGZvciAodmFyIGkgPSBpbmRleCArIDE7IGRlbGV0ZXNUb0dvID4gMDsg
        KytpKSB7CiAgICAgIG5leHRBcnJheU9wZXJhdGlvbiA9IHRoaXMuX29wZXJh
        dGlvbnNbaV07CiAgICAgIG5leHRPcCA9IG5leHRBcnJheU9wZXJhdGlvbi50
        eXBlOwogICAgICBuZXh0Q291bnQgPSBuZXh0QXJyYXlPcGVyYXRpb24uY291
        bnQ7CgogICAgICBpZiAobmV4dE9wID09PSBERUxFVEUpIHsKICAgICAgICBh
        cnJheU9wZXJhdGlvbi5jb3VudCArPSBuZXh0Q291bnQ7CiAgICAgICAgY29u
        dGludWU7CiAgICAgIH0KCiAgICAgIGlmIChuZXh0Q291bnQgPiBkZWxldGVz
        VG9HbykgewogICAgICAgIC8vIGQ6MiB7cixpfTo1ICB3ZSByZWR1Y2UgdGhl
        IHJldGFpbiBvciBpbnNlcnQsIGJ1dCBpdCBzdGF5cwogICAgICAgIHJlbW92
        ZWRJdGVtcyA9IHJlbW92ZWRJdGVtcy5jb25jYXQobmV4dEFycmF5T3BlcmF0
        aW9uLml0ZW1zLnNwbGljZSgwLCBkZWxldGVzVG9HbykpOwogICAgICAgIG5l
        eHRBcnJheU9wZXJhdGlvbi5jb3VudCAtPSBkZWxldGVzVG9HbzsKCiAgICAg
        ICAgLy8gSW4gdGhlIGNhc2Ugd2hlcmUgd2UgdHJ1bmNhdGUgdGhlIGxhc3Qg
        YXJyYXlPcGVyYXRpb24sIHdlIGRvbid0IG5lZWQgdG8KICAgICAgICAvLyBy
        ZW1vdmUgaXQ7IGFsc28gdGhlIGRlbGV0ZXNUb0dvIHJlZHVjdGlvbiBpcyBu
        b3QgdGhlIGVudGlyZXR5IG9mCiAgICAgICAgLy8gbmV4dENvdW50CiAgICAg
        ICAgaSAtPSAxOwogICAgICAgIG5leHRDb3VudCA9IGRlbGV0ZXNUb0dvOwoK
        ICAgICAgICBkZWxldGVzVG9HbyA9IDA7CiAgICAgIH0gZWxzZSB7CiAgICAg
        ICAgaWYgKG5leHRDb3VudCA9PT0gZGVsZXRlc1RvR28pIHsKICAgICAgICAg
        IC8vIEhhbmRsZSBlZGdlIGNhc2Ugb2YgZDoyIGk6MiBpbiB3aGljaCBjYXNl
        IGJvdGggb3BlcmF0aW9ucyBnbyBhd2F5CiAgICAgICAgICAvLyBkdXJpbmcg
        Y29tcG9zaXRpb24uCiAgICAgICAgICByZW1vdmVOZXdBbmROZXh0T3AgPSB0
        cnVlOwogICAgICAgIH0KICAgICAgICByZW1vdmVkSXRlbXMgPSByZW1vdmVk
        SXRlbXMuY29uY2F0KG5leHRBcnJheU9wZXJhdGlvbi5pdGVtcyk7CiAgICAg
        ICAgZGVsZXRlc1RvR28gLT0gbmV4dENvdW50OwogICAgICB9CgogICAgICBp
        ZiAobmV4dE9wID09PSBJTlNFUlQpIHsKICAgICAgICAvLyBkOjIgaTozIHdp
        bGwgcmVzdWx0IGluIGRlbGV0ZSBnb2luZyBhd2F5CiAgICAgICAgYXJyYXlP
        cGVyYXRpb24uY291bnQgLT0gbmV4dENvdW50OwogICAgICB9CiAgICB9Cgog
        ICAgaWYgKGFycmF5T3BlcmF0aW9uLmNvdW50ID4gMCkgewogICAgICAvLyBj
        b21wb3NlIG91ciBuZXcgZGVsZXRlIHdpdGggcG9zc2libHkgc2V2ZXJhbCBv
        cGVyYXRpb25zIHRvIHRoZSByaWdodCBvZgogICAgICAvLyBkaXNwYXJhdGUg
        dHlwZXMKICAgICAgdGhpcy5fb3BlcmF0aW9ucy5zcGxpY2UoaW5kZXgrMSwg
        aS0xLWluZGV4KTsKICAgIH0gZWxzZSB7CiAgICAgIC8vIFRoZSBkZWxldGUg
        b3BlcmF0aW9uIGNhbiBnbyBhd2F5OyBpdCBoYXMgbWVyZWx5IHJlZHVjZWQg
        c29tZSBvdGhlcgogICAgICAvLyBvcGVyYXRpb24sIGFzIGluIGQ6MyBpOjQ7
        IGl0IG1heSBhbHNvIGhhdmUgZWxpbWluYXRlZCB0aGF0IG9wZXJhdGlvbiwK
        ICAgICAgLy8gYXMgaW4gZDozIGk6My4KICAgICAgdGhpcy5fb3BlcmF0aW9u
        cy5zcGxpY2UoaW5kZXgsIHJlbW92ZU5ld0FuZE5leHRPcCA/IDIgOiAxKTsK
        ICAgIH0KCiAgICByZXR1cm4gcmVtb3ZlZEl0ZW1zOwogIH0sCgogIHRvU3Ry
        aW5nOiBmdW5jdGlvbiAoKSB7CiAgICB2YXIgc3RyID0gIiI7CiAgICBmb3JF
        YWNoKHRoaXMuX29wZXJhdGlvbnMsIGZ1bmN0aW9uIChvcGVyYXRpb24pIHsK
        ICAgICAgc3RyICs9ICIgIiArIG9wZXJhdGlvbi50eXBlICsgIjoiICsgb3Bl
        cmF0aW9uLmNvdW50OwogICAgfSk7CiAgICByZXR1cm4gc3RyLnN1YnN0cmlu
        ZygxKTsKICB9Cn07CgovKioKICBJbnRlcm5hbCBkYXRhIHN0cnVjdHVyZSB0
        byByZXByZXNlbnQgYW4gYXJyYXkgb3BlcmF0aW9uLgoKICBAbWV0aG9kIEFy
        cmF5T3BlcmF0aW9uCiAgQHByaXZhdGUKICBAcHJvcGVydHkge3N0cmluZ30g
        dHlwZSBUaGUgdHlwZSBvZiB0aGUgb3BlcmF0aW9uLiAgT25lIG9mCiAgYEVt
        YmVyLlRyYWNrZWRBcnJheS57UkVUQUlOLCBJTlNFUlQsIERFTEVURX1gCiAg
        QHByb3BlcnR5IHtudW1iZXJ9IGNvdW50IFRoZSBudW1iZXIgb2YgaXRlbXMg
        aW4gdGhpcyBvcGVyYXRpb24uCiAgQHByb3BlcnR5IHthcnJheX0gaXRlbXMg
        VGhlIGl0ZW1zIG9mIHRoZSBvcGVyYXRpb24sIGlmIGluY2x1ZGVkLiAgUkVU
        QUlOIGFuZAogIElOU0VSVCBpbmNsdWRlIHRoZWlyIGl0ZW1zLCBERUxFVEUg
        ZG9lcyBub3QuCiovCmZ1bmN0aW9uIEFycmF5T3BlcmF0aW9uIChvcGVyYXRp
        b24sIGNvdW50LCBpdGVtcykgewogIHRoaXMudHlwZSA9IG9wZXJhdGlvbjsg
        Ly8gUkVUQUlOIHwgSU5TRVJUIHwgREVMRVRFCiAgdGhpcy5jb3VudCA9IGNv
        dW50OwogIHRoaXMuaXRlbXMgPSBpdGVtczsKfQoKLyoqCiAgSW50ZXJuYWwg
        ZGF0YSBzdHJ1Y3R1cmUgdXNlZCB0byBpbmNsdWRlIGluZm9ybWF0aW9uIHdo
        ZW4gbG9va2luZyB1cCBvcGVyYXRpb25zCiAgYnkgaXRlbSBpbmRleC4KCiAg
        QG1ldGhvZCBBcnJheU9wZXJhdGlvbk1hdGNoCiAgQHByaXZhdGUKICBAcHJv
        cGVydHkge0FycmF5T3BlcmF0aW9ufSBvcGVyYXRpb24KICBAcHJvcGVydHkg
        e251bWJlcn0gaW5kZXggVGhlIGluZGV4IG9mIGBvcGVyYXRpb25gIGluIHRo
        ZSBhcnJheSBvZiBvcGVyYXRpb25zLgogIEBwcm9wZXJ0eSB7Ym9vbGVhbn0g
        c3BsaXQgV2hldGhlciBvciBub3QgdGhlIGl0ZW0gaW5kZXggc2VhcmNoZWQg
        Zm9yIHdvdWxkCiAgcmVxdWlyZSBhIHNwbGl0IGZvciBhIG5ldyBvcGVyYXRp
        b24gdHlwZS4KICBAcHJvcGVydHkge251bWJlcn0gcmFuZ2VTdGFydCBUaGUg
        aW5kZXggb2YgdGhlIGZpcnN0IGl0ZW0gaW4gdGhlIG9wZXJhdGlvbiwKICB3
        aXRoIHJlc3BlY3QgdG8gdGhlIHRyYWNrZWQgYXJyYXkuICBUaGUgaW5kZXgg
        b2YgdGhlIGxhc3QgaXRlbSBjYW4gYmUgY29tcHV0ZWQKICBmcm9tIGByYW5n
        ZVN0YXJ0YCBhbmQgYG9wZXJhdGlvbi5jb3VudGAuCiovCmZ1bmN0aW9uIEFy
        cmF5T3BlcmF0aW9uTWF0Y2gob3BlcmF0aW9uLCBpbmRleCwgc3BsaXQsIHJh
        bmdlU3RhcnQpIHsKICB0aGlzLm9wZXJhdGlvbiA9IG9wZXJhdGlvbjsKICB0
        aGlzLmluZGV4ID0gaW5kZXg7CiAgdGhpcy5zcGxpdCA9IHNwbGl0OwogIHRo
        aXMucmFuZ2VTdGFydCA9IHJhbmdlU3RhcnQ7Cn0KCn0pKCk7CgoKCihmdW5j
        dGlvbigpIHsKdmFyIGdldCA9IEVtYmVyLmdldCwKICAgIGZvckVhY2ggPSBF
        bWJlci5FbnVtZXJhYmxlVXRpbHMuZm9yRWFjaCwKICAgIFJFVEFJTiA9ICdy
        JywKICAgIEZJTFRFUiA9ICdmJzsKCmZ1bmN0aW9uIE9wZXJhdGlvbiAodHlw
        ZSwgY291bnQpIHsKICB0aGlzLnR5cGUgPSB0eXBlOwogIHRoaXMuY291bnQg
        PSBjb3VudDsKfQoKLyoqCiAgQW4gYEVtYmVyLlN1YkFycmF5YCB0cmFja3Mg
        YW4gYXJyYXkgaW4gYSB3YXkgc2ltaWxhciB0bywgYnV0IG1vcmUgc3BlY2lh
        bGl6ZWQKICB0aGFuLCBgRW1iZXIuVHJhY2tlZEFycmF5YC4gIEl0IGlzIHVz
        ZWZ1bCBmb3Iga2VlcGluZyB0cmFjayBvZiB0aGUgaW5kZXhlcyBvZgogIGl0
        ZW1zIHdpdGhpbiBhIGZpbHRlcmVkIGFycmF5LgoKICBAY2xhc3MgU3ViQXJy
        YXkKICBAbmFtZXNwYWNlIEVtYmVyCiovCkVtYmVyLlN1YkFycmF5ID0gZnVu
        Y3Rpb24gKGxlbmd0aCkgewogIGlmIChhcmd1bWVudHMubGVuZ3RoIDwgMSkg
        eyBsZW5ndGggPSAwOyB9CgogIGlmIChsZW5ndGggPiAwKSB7CiAgICB0aGlz
        Ll9vcGVyYXRpb25zID0gW25ldyBPcGVyYXRpb24oUkVUQUlOLCBsZW5ndGgp
        XTsKICB9IGVsc2UgewogICAgdGhpcy5fb3BlcmF0aW9ucyA9IFtdOwogIH0K
        fTsKCkVtYmVyLlN1YkFycmF5LnByb3RvdHlwZSA9IHsKICAvKioKICAgIFRy
        YWNrIHRoYXQgYW4gaXRlbSB3YXMgYWRkZWQgdG8gdGhlIHRyYWNrZWQgYXJy
        YXkuCgogICAgQG1ldGhvZCBhZGRJdGVtCgogICAgQHBhcmFtIHtudW1iZXJ9
        IGluZGV4IFRoZSBpbmRleCBvZiB0aGUgaXRlbSBpbiB0aGUgdHJhY2tlZCBh
        cnJheS4KICAgIEBwYXJhbSB7Ym9vbGVhbn0gbWF0Y2ggYHRydWVgIGlmZiB0
        aGUgaXRlbSBpcyBpbmNsdWRlZCBpbiB0aGUgc3ViYXJyYXkuCgogICAgQHJl
        dHVybiB7bnVtYmVyfSBUaGUgaW5kZXggb2YgdGhlIGl0ZW0gaW4gdGhlIHN1
        YmFycmF5LgogICovCiAgYWRkSXRlbTogZnVuY3Rpb24oaW5kZXgsIG1hdGNo
        KSB7CiAgICB2YXIgcmV0dXJuVmFsdWUgPSAtMSwKICAgICAgICBpdGVtVHlw
        ZSA9IG1hdGNoID8gUkVUQUlOIDogRklMVEVSLAogICAgICAgIHNlbGYgPSB0
        aGlzOwoKICAgIHRoaXMuX2ZpbmRPcGVyYXRpb24oaW5kZXgsIGZ1bmN0aW9u
        KG9wZXJhdGlvbiwgb3BlcmF0aW9uSW5kZXgsIHJhbmdlU3RhcnQsIHJhbmdl
        RW5kLCBzZWVuSW5TdWJBcnJheSkgewogICAgICB2YXIgbmV3T3BlcmF0aW9u
        LCBzcGxpdE9wZXJhdGlvbjsKCiAgICAgIGlmIChpdGVtVHlwZSA9PT0gb3Bl
        cmF0aW9uLnR5cGUpIHsKICAgICAgICArK29wZXJhdGlvbi5jb3VudDsKICAg
        ICAgfSBlbHNlIGlmIChpbmRleCA9PT0gcmFuZ2VTdGFydCkgewogICAgICAg
        IC8vIGluc2VydCB0byB0aGUgbGVmdCBvZiBgb3BlcmF0aW9uYAogICAgICAg
        IHNlbGYuX29wZXJhdGlvbnMuc3BsaWNlKG9wZXJhdGlvbkluZGV4LCAwLCBu
        ZXcgT3BlcmF0aW9uKGl0ZW1UeXBlLCAxKSk7CiAgICAgIH0gZWxzZSB7CiAg
        ICAgICAgbmV3T3BlcmF0aW9uID0gbmV3IE9wZXJhdGlvbihpdGVtVHlwZSwg
        MSk7CiAgICAgICAgc3BsaXRPcGVyYXRpb24gPSBuZXcgT3BlcmF0aW9uKG9w
        ZXJhdGlvbi50eXBlLCByYW5nZUVuZCAtIGluZGV4ICsgMSk7CiAgICAgICAg
        b3BlcmF0aW9uLmNvdW50ID0gaW5kZXggLSByYW5nZVN0YXJ0OwoKICAgICAg
        ICBzZWxmLl9vcGVyYXRpb25zLnNwbGljZShvcGVyYXRpb25JbmRleCArIDEs
        IDAsIG5ld09wZXJhdGlvbiwgc3BsaXRPcGVyYXRpb24pOwogICAgICB9Cgog
        ICAgICBpZiAobWF0Y2gpIHsKICAgICAgICBpZiAob3BlcmF0aW9uLnR5cGUg
        PT09IFJFVEFJTikgewogICAgICAgICAgcmV0dXJuVmFsdWUgPSBzZWVuSW5T
        dWJBcnJheSArIChpbmRleCAtIHJhbmdlU3RhcnQpOwogICAgICAgIH0gZWxz
        ZSB7CiAgICAgICAgICByZXR1cm5WYWx1ZSA9IHNlZW5JblN1YkFycmF5Owog
        ICAgICAgIH0KICAgICAgfQoKICAgICAgc2VsZi5fY29tcG9zZUF0KG9wZXJh
        dGlvbkluZGV4KTsKICAgIH0sIGZ1bmN0aW9uKHNlZW5JblN1YkFycmF5KSB7
        CiAgICAgIHNlbGYuX29wZXJhdGlvbnMucHVzaChuZXcgT3BlcmF0aW9uKGl0
        ZW1UeXBlLCAxKSk7CgogICAgICBpZiAobWF0Y2gpIHsKICAgICAgICByZXR1
        cm5WYWx1ZSA9IHNlZW5JblN1YkFycmF5OwogICAgICB9CgogICAgICBzZWxm
        Ll9jb21wb3NlQXQoc2VsZi5fb3BlcmF0aW9ucy5sZW5ndGgtMSk7CiAgICB9
        KTsKCiAgICByZXR1cm4gcmV0dXJuVmFsdWU7CiAgfSwKCiAgLyoqCiAgICBU
        cmFjayB0aGF0IGFuIGl0ZW0gd2FzIHJlbW92ZWQgZnJvbSB0aGUgdHJhY2tl
        ZCBhcnJheS4KCiAgICBAbWV0aG9kIHJlbW92ZUl0ZW0KCiAgICBAcGFyYW0g
        e251bWJlcn0gaW5kZXggVGhlIGluZGV4IG9mIHRoZSBpdGVtIGluIHRoZSB0
        cmFja2VkIGFycmF5LgoKICAgIEByZXR1cm4ge251bWJlcn0gVGhlIGluZGV4
        IG9mIHRoZSBpdGVtIGluIHRoZSBzdWJhcnJheSwgb3IgYC0xYCBpZiB0aGUg
        aXRlbQogICAgd2FzIG5vdCBpbiB0aGUgc3ViYXJyYXkuCiAgKi8KICByZW1v
        dmVJdGVtOiBmdW5jdGlvbihpbmRleCkgewogICAgdmFyIHJldHVyblZhbHVl
        ID0gLTEsCiAgICAgICAgc2VsZiA9IHRoaXM7CgogICAgdGhpcy5fZmluZE9w
        ZXJhdGlvbihpbmRleCwgZnVuY3Rpb24gKG9wZXJhdGlvbiwgb3BlcmF0aW9u
        SW5kZXgsIHJhbmdlU3RhcnQsIHJhbmdlRW5kLCBzZWVuSW5TdWJBcnJheSkg
        ewogICAgICBpZiAob3BlcmF0aW9uLnR5cGUgPT09IFJFVEFJTikgewogICAg
        ICAgIHJldHVyblZhbHVlID0gc2VlbkluU3ViQXJyYXkgKyAoaW5kZXggLSBy
        YW5nZVN0YXJ0KTsKICAgICAgfQoKICAgICAgaWYgKG9wZXJhdGlvbi5jb3Vu
        dCA+IDEpIHsKICAgICAgICAtLW9wZXJhdGlvbi5jb3VudDsKICAgICAgfSBl
        bHNlIHsKICAgICAgICBzZWxmLl9vcGVyYXRpb25zLnNwbGljZShvcGVyYXRp
        b25JbmRleCwgMSk7CiAgICAgICAgc2VsZi5fY29tcG9zZUF0KG9wZXJhdGlv
        bkluZGV4KTsKICAgICAgfQogICAgfSwgZnVuY3Rpb24oKSB7CiAgICAgIHRo
        cm93IG5ldyBFbWJlci5FcnJvcigiQ2FuJ3QgcmVtb3ZlIGFuIGl0ZW0gdGhh
        dCBoYXMgbmV2ZXIgYmVlbiBhZGRlZC4iKTsKICAgIH0pOwoKICAgIHJldHVy
        biByZXR1cm5WYWx1ZTsKICB9LAoKCiAgX2ZpbmRPcGVyYXRpb246IGZ1bmN0
        aW9uIChpbmRleCwgZm91bmRDYWxsYmFjaywgbm90Rm91bmRDYWxsYmFjaykg
        ewogICAgdmFyIG9wZXJhdGlvbkluZGV4LAogICAgICAgIGxlbiwKICAgICAg
        ICBvcGVyYXRpb24sCiAgICAgICAgcmFuZ2VTdGFydCwKICAgICAgICByYW5n
        ZUVuZCwKICAgICAgICBzZWVuSW5TdWJBcnJheSA9IDA7CgogICAgLy8gT1BU
        SU1JWkU6IGNoYW5nZSB0byBiYWxhbmNlZCB0cmVlCiAgICAvLyBmaW5kIGxl
        ZnRtb3N0IG9wZXJhdGlvbiB0byB0aGUgcmlnaHQgb2YgYGluZGV4YAogICAg
        Zm9yIChvcGVyYXRpb25JbmRleCA9IHJhbmdlU3RhcnQgPSAwLCBsZW4gPSB0
        aGlzLl9vcGVyYXRpb25zLmxlbmd0aDsgb3BlcmF0aW9uSW5kZXggPCBsZW47
        IHJhbmdlU3RhcnQgPSByYW5nZUVuZCArIDEsICsrb3BlcmF0aW9uSW5kZXgp
        IHsKICAgICAgb3BlcmF0aW9uID0gdGhpcy5fb3BlcmF0aW9uc1tvcGVyYXRp
        b25JbmRleF07CiAgICAgIHJhbmdlRW5kID0gcmFuZ2VTdGFydCArIG9wZXJh
        dGlvbi5jb3VudCAtIDE7CgogICAgICBpZiAoaW5kZXggPj0gcmFuZ2VTdGFy
        dCAmJiBpbmRleCA8PSByYW5nZUVuZCkgewogICAgICAgIGZvdW5kQ2FsbGJh
        Y2sob3BlcmF0aW9uLCBvcGVyYXRpb25JbmRleCwgcmFuZ2VTdGFydCwgcmFu
        Z2VFbmQsIHNlZW5JblN1YkFycmF5KTsKICAgICAgICByZXR1cm47CiAgICAg
        IH0gZWxzZSBpZiAob3BlcmF0aW9uLnR5cGUgPT09IFJFVEFJTikgewogICAg
        ICAgIHNlZW5JblN1YkFycmF5ICs9IG9wZXJhdGlvbi5jb3VudDsKICAgICAg
        fQogICAgfQoKICAgIG5vdEZvdW5kQ2FsbGJhY2soc2VlbkluU3ViQXJyYXkp
        OwogIH0sCgogIF9jb21wb3NlQXQ6IGZ1bmN0aW9uKGluZGV4KSB7CiAgICB2
        YXIgb3AgPSB0aGlzLl9vcGVyYXRpb25zW2luZGV4XSwKICAgICAgICBvdGhl
        ck9wOwoKICAgIGlmICghb3ApIHsKICAgICAgLy8gQ29tcG9zaW5nIG91dCBv
        ZiBib3VuZHMgaXMgYSBuby1vcCwgYXMgd2hlbiByZW1vdmluZyB0aGUgbGFz
        dCBvcGVyYXRpb24KICAgICAgLy8gaW4gdGhlIGxpc3QuCiAgICAgIHJldHVy
        bjsKICAgIH0KCiAgICBpZiAoaW5kZXggPiAwKSB7CiAgICAgIG90aGVyT3Ag
        PSB0aGlzLl9vcGVyYXRpb25zW2luZGV4LTFdOwogICAgICBpZiAob3RoZXJP
        cC50eXBlID09PSBvcC50eXBlKSB7CiAgICAgICAgb3AuY291bnQgKz0gb3Ro
        ZXJPcC5jb3VudDsKICAgICAgICB0aGlzLl9vcGVyYXRpb25zLnNwbGljZShp
        bmRleC0xLCAxKTsKICAgICAgICAtLWluZGV4OwogICAgICB9CiAgICB9Cgog
        ICAgaWYgKGluZGV4IDwgdGhpcy5fb3BlcmF0aW9ucy5sZW5ndGgtMSkgewog
        ICAgICBvdGhlck9wID0gdGhpcy5fb3BlcmF0aW9uc1tpbmRleCsxXTsKICAg
        ICAgaWYgKG90aGVyT3AudHlwZSA9PT0gb3AudHlwZSkgewogICAgICAgIG9w
        LmNvdW50ICs9IG90aGVyT3AuY291bnQ7CiAgICAgICAgdGhpcy5fb3BlcmF0
        aW9ucy5zcGxpY2UoaW5kZXgrMSwgMSk7CiAgICAgIH0KICAgIH0KICB9Cn07
        Cgp9KSgpOwoKCgooZnVuY3Rpb24oKSB7CkVtYmVyLkNvbnRhaW5lciA9IHJl
        cXVpcmVNb2R1bGUoJ2NvbnRhaW5lcicpOwpFbWJlci5Db250YWluZXIuc2V0
        ID0gRW1iZXIuc2V0OwoKfSkoKTsKCgoKKGZ1bmN0aW9uKCkgewovKioKQG1v
        ZHVsZSBlbWJlcgpAc3VibW9kdWxlIGVtYmVyLXJ1bnRpbWUKKi8KCgovLyBO
        T1RFOiB0aGlzIG9iamVjdCBzaG91bGQgbmV2ZXIgYmUgaW5jbHVkZWQgZGly
        ZWN0bHkuIEluc3RlYWQgdXNlIGBFbWJlci5PYmplY3RgLgovLyBXZSBvbmx5
        IGRlZmluZSB0aGlzIHNlcGFyYXRlbHkgc28gdGhhdCBgRW1iZXIuU2V0YCBj
        YW4gZGVwZW5kIG9uIGl0LgoKCnZhciBzZXQgPSBFbWJlci5zZXQsIGdldCA9
        IEVtYmVyLmdldCwKICAgIG9fY3JlYXRlID0gRW1iZXIuY3JlYXRlLAogICAg
        b19kZWZpbmVQcm9wZXJ0eSA9IEVtYmVyLnBsYXRmb3JtLmRlZmluZVByb3Bl
        cnR5LAogICAgR1VJRF9LRVkgPSBFbWJlci5HVUlEX0tFWSwKICAgIGd1aWRG
        b3IgPSBFbWJlci5ndWlkRm9yLAogICAgZ2VuZXJhdGVHdWlkID0gRW1iZXIu
        Z2VuZXJhdGVHdWlkLAogICAgbWV0YSA9IEVtYmVyLm1ldGEsCiAgICByZXdh
        dGNoID0gRW1iZXIucmV3YXRjaCwKICAgIGZpbmlzaENoYWlucyA9IEVtYmVy
        LmZpbmlzaENoYWlucywKICAgIHNlbmRFdmVudCA9IEVtYmVyLnNlbmRFdmVu
        dCwKICAgIGRlc3Ryb3kgPSBFbWJlci5kZXN0cm95LAogICAgc2NoZWR1bGUg
        PSBFbWJlci5ydW4uc2NoZWR1bGUsCiAgICBNaXhpbiA9IEVtYmVyLk1peGlu
        LAogICAgYXBwbHlNaXhpbiA9IE1peGluLl9hcHBseSwKICAgIGZpbmlzaFBh
        cnRpYWwgPSBNaXhpbi5maW5pc2hQYXJ0aWFsLAogICAgcmVvcGVuID0gTWl4
        aW4ucHJvdG90eXBlLnJlb3BlbiwKICAgIE1BTkRBVE9SWV9TRVRURVIgPSBF
        bWJlci5FTlYuTUFOREFUT1JZX1NFVFRFUiwKICAgIGluZGV4T2YgPSBFbWJl
        ci5FbnVtZXJhYmxlVXRpbHMuaW5kZXhPZjsKCnZhciB1bmRlZmluZWREZXNj
        cmlwdG9yID0gewogIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICB3cml0YWJsZTog
        dHJ1ZSwKICBlbnVtZXJhYmxlOiBmYWxzZSwKICB2YWx1ZTogdW5kZWZpbmVk
        Cn07CgpmdW5jdGlvbiBtYWtlQ3RvcigpIHsKCiAgLy8gTm90ZTogYXZvaWQg
        YWNjZXNzaW5nIGFueSBwcm9wZXJ0aWVzIG9uIHRoZSBvYmplY3Qgc2luY2Ug
        aXQgbWFrZXMgdGhlCiAgLy8gbWV0aG9kIGEgbG90IGZhc3Rlci4gVGhpcyBp
        cyBnbHVlIGNvZGUgc28gd2Ugd2FudCBpdCB0byBiZSBhcyBmYXN0IGFzCiAg
        Ly8gcG9zc2libGUuCgogIHZhciB3YXNBcHBsaWVkID0gZmFsc2UsIGluaXRN
        aXhpbnMsIGluaXRQcm9wZXJ0aWVzOwoKICB2YXIgQ2xhc3MgPSBmdW5jdGlv
        bigpIHsKICAgIGlmICghd2FzQXBwbGllZCkgewogICAgICBDbGFzcy5wcm90
        bygpOyAvLyBwcmVwYXJlIHByb3RvdHlwZS4uLgogICAgfQogICAgb19kZWZp
        bmVQcm9wZXJ0eSh0aGlzLCBHVUlEX0tFWSwgdW5kZWZpbmVkRGVzY3JpcHRv
        cik7CiAgICBvX2RlZmluZVByb3BlcnR5KHRoaXMsICdfc3VwZXInLCB1bmRl
        ZmluZWREZXNjcmlwdG9yKTsKICAgIHZhciBtID0gbWV0YSh0aGlzKSwgcHJv
        dG8gPSBtLnByb3RvOwogICAgbS5wcm90byA9IHRoaXM7CiAgICBpZiAoaW5p
        dE1peGlucykgewogICAgICAvLyBjYXB0dXJlIGxvY2FsbHkgc28gd2UgY2Fu
        IGNsZWFyIHRoZSBjbG9zZWQgb3ZlciB2YXJpYWJsZQogICAgICB2YXIgbWl4
        aW5zID0gaW5pdE1peGluczsKICAgICAgaW5pdE1peGlucyA9IG51bGw7CiAg
        ICAgIHRoaXMucmVvcGVuLmFwcGx5KHRoaXMsIG1peGlucyk7CiAgICB9CiAg
        ICBpZiAoaW5pdFByb3BlcnRpZXMpIHsKICAgICAgLy8gY2FwdHVyZSBsb2Nh
        bGx5IHNvIHdlIGNhbiBjbGVhciB0aGUgY2xvc2VkIG92ZXIgdmFyaWFibGUK
        ICAgICAgdmFyIHByb3BzID0gaW5pdFByb3BlcnRpZXM7CiAgICAgIGluaXRQ
        cm9wZXJ0aWVzID0gbnVsbDsKCiAgICAgIHZhciBjb25jYXRlbmF0ZWRQcm9w
        ZXJ0aWVzID0gdGhpcy5jb25jYXRlbmF0ZWRQcm9wZXJ0aWVzOwoKICAgICAg
        Zm9yICh2YXIgaSA9IDAsIGwgPSBwcm9wcy5sZW5ndGg7IGkgPCBsOyBpKysp
        IHsKICAgICAgICB2YXIgcHJvcGVydGllcyA9IHByb3BzW2ldOwoKICAgICAg
        ICBFbWJlci5hc3NlcnQoIkVtYmVyLk9iamVjdC5jcmVhdGUgbm8gbG9uZ2Vy
        IHN1cHBvcnRzIG1peGluZyBpbiBvdGhlciBkZWZpbml0aW9ucywgdXNlIGNy
        ZWF0ZVdpdGhNaXhpbnMgaW5zdGVhZC4iLCAhKHByb3BlcnRpZXMgaW5zdGFu
        Y2VvZiBFbWJlci5NaXhpbikpOwoKICAgICAgICBpZiAocHJvcGVydGllcyA9
        PT0gbnVsbCB8fCB0eXBlb2YgcHJvcGVydGllcyAhPT0gJ29iamVjdCcpIHsK
        ICAgICAgICAgIEVtYmVyLmFzc2VydCgiRW1iZXIuT2JqZWN0LmNyZWF0ZSBv
        bmx5IGFjY2VwdHMgb2JqZWN0cy4iKTsKICAgICAgICAgIGNvbnRpbnVlOwog
        ICAgICAgIH0KCiAgICAgICAgdmFyIGtleU5hbWVzID0gRW1iZXIua2V5cyhw
        cm9wZXJ0aWVzKTsKICAgICAgICBmb3IgKHZhciBqID0gMCwgbGwgPSBrZXlO
        YW1lcy5sZW5ndGg7IGogPCBsbDsgaisrKSB7CiAgICAgICAgICB2YXIga2V5
        TmFtZSA9IGtleU5hbWVzW2pdOwogICAgICAgICAgaWYgKCFwcm9wZXJ0aWVz
        Lmhhc093blByb3BlcnR5KGtleU5hbWUpKSB7IGNvbnRpbnVlOyB9CgogICAg
        ICAgICAgdmFyIHZhbHVlID0gcHJvcGVydGllc1trZXlOYW1lXSwKICAgICAg
        ICAgICAgICBJU19CSU5ESU5HID0gRW1iZXIuSVNfQklORElORzsKCiAgICAg
        ICAgICBpZiAoSVNfQklORElORy50ZXN0KGtleU5hbWUpKSB7CiAgICAgICAg
        ICAgIHZhciBiaW5kaW5ncyA9IG0uYmluZGluZ3M7CiAgICAgICAgICAgIGlm
        ICghYmluZGluZ3MpIHsKICAgICAgICAgICAgICBiaW5kaW5ncyA9IG0uYmlu
        ZGluZ3MgPSB7fTsKICAgICAgICAgICAgfSBlbHNlIGlmICghbS5oYXNPd25Q
        cm9wZXJ0eSgnYmluZGluZ3MnKSkgewogICAgICAgICAgICAgIGJpbmRpbmdz
        ID0gbS5iaW5kaW5ncyA9IG9fY3JlYXRlKG0uYmluZGluZ3MpOwogICAgICAg
        ICAgICB9CiAgICAgICAgICAgIGJpbmRpbmdzW2tleU5hbWVdID0gdmFsdWU7
        CiAgICAgICAgICB9CgogICAgICAgICAgdmFyIGRlc2MgPSBtLmRlc2NzW2tl
        eU5hbWVdOwoKICAgICAgICAgIEVtYmVyLmFzc2VydCgiRW1iZXIuT2JqZWN0
        LmNyZWF0ZSBubyBsb25nZXIgc3VwcG9ydHMgZGVmaW5pbmcgY29tcHV0ZWQg
        cHJvcGVydGllcy4iLCAhKHZhbHVlIGluc3RhbmNlb2YgRW1iZXIuQ29tcHV0
        ZWRQcm9wZXJ0eSkpOwogICAgICAgICAgRW1iZXIuYXNzZXJ0KCJFbWJlci5P
        YmplY3QuY3JlYXRlIG5vIGxvbmdlciBzdXBwb3J0cyBkZWZpbmluZyBtZXRo
        b2RzIHRoYXQgY2FsbCBfc3VwZXIuIiwgISh0eXBlb2YgdmFsdWUgPT09ICdm
        dW5jdGlvbicgJiYgdmFsdWUudG9TdHJpbmcoKS5pbmRleE9mKCcuX3N1cGVy
        JykgIT09IC0xKSk7CiAgICAgICAgICBFbWJlci5hc3NlcnQoImBhY3Rpb25z
        YCBtdXN0IGJlIHByb3ZpZGVkIGF0IGV4dGVuZCB0aW1lLCBub3QgYXQgY3Jl
        YXRlIHRpbWUsIHdoZW4gRW1iZXIuQWN0aW9uSGFuZGxlciBpcyB1c2VkIChp
        LmUuIHZpZXdzLCBjb250cm9sbGVycyAmIHJvdXRlcykuIiwgISgoa2V5TmFt
        ZSA9PT0gJ2FjdGlvbnMnKSAmJiBFbWJlci5BY3Rpb25IYW5kbGVyLmRldGVj
        dCh0aGlzKSkpOwoKICAgICAgICAgIGlmIChjb25jYXRlbmF0ZWRQcm9wZXJ0
        aWVzICYmIGluZGV4T2YoY29uY2F0ZW5hdGVkUHJvcGVydGllcywga2V5TmFt
        ZSkgPj0gMCkgewogICAgICAgICAgICB2YXIgYmFzZVZhbHVlID0gdGhpc1tr
        ZXlOYW1lXTsKCiAgICAgICAgICAgIGlmIChiYXNlVmFsdWUpIHsKICAgICAg
        ICAgICAgICBpZiAoJ2Z1bmN0aW9uJyA9PT0gdHlwZW9mIGJhc2VWYWx1ZS5j
        b25jYXQpIHsKICAgICAgICAgICAgICAgIHZhbHVlID0gYmFzZVZhbHVlLmNv
        bmNhdCh2YWx1ZSk7CiAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAg
        ICAgICAgIHZhbHVlID0gRW1iZXIubWFrZUFycmF5KGJhc2VWYWx1ZSkuY29u
        Y2F0KHZhbHVlKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gZWxz
        ZSB7CiAgICAgICAgICAgICAgdmFsdWUgPSBFbWJlci5tYWtlQXJyYXkodmFs
        dWUpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CgogICAgICAgICAgaWYg
        KGRlc2MpIHsKICAgICAgICAgICAgZGVzYy5zZXQodGhpcywga2V5TmFtZSwg
        dmFsdWUpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgaWYgKHR5
        cGVvZiB0aGlzLnNldFVua25vd25Qcm9wZXJ0eSA9PT0gJ2Z1bmN0aW9uJyAm
        JiAhKGtleU5hbWUgaW4gdGhpcykpIHsKICAgICAgICAgICAgICB0aGlzLnNl
        dFVua25vd25Qcm9wZXJ0eShrZXlOYW1lLCB2YWx1ZSk7CiAgICAgICAgICAg
        IH0gZWxzZSBpZiAoTUFOREFUT1JZX1NFVFRFUikgewogICAgICAgICAgICAg
        IEVtYmVyLmRlZmluZVByb3BlcnR5KHRoaXMsIGtleU5hbWUsIG51bGwsIHZh
        bHVlKTsgLy8gc2V0dXAgbWFuZGF0b3J5IHNldHRlcgogICAgICAgICAgICB9
        IGVsc2UgewogICAgICAgICAgICAgIHRoaXNba2V5TmFtZV0gPSB2YWx1ZTsK
        ICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQog
        ICAgfQogICAgZmluaXNoUGFydGlhbCh0aGlzLCBtKTsKICAgIHRoaXMuaW5p
        dC5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgbS5wcm90byA9IHByb3Rv
        OwogICAgZmluaXNoQ2hhaW5zKHRoaXMpOwogICAgc2VuZEV2ZW50KHRoaXMs
        ICJpbml0Iik7CiAgfTsKCiAgQ2xhc3MudG9TdHJpbmcgPSBNaXhpbi5wcm90
        b3R5cGUudG9TdHJpbmc7CiAgQ2xhc3Mud2lsbFJlb3BlbiA9IGZ1bmN0aW9u
        KCkgewogICAgaWYgKHdhc0FwcGxpZWQpIHsKICAgICAgQ2xhc3MuUHJvdG90
        eXBlTWl4aW4gPSBNaXhpbi5jcmVhdGUoQ2xhc3MuUHJvdG90eXBlTWl4aW4p
        OwogICAgfQoKICAgIHdhc0FwcGxpZWQgPSBmYWxzZTsKICB9OwogIENsYXNz
        Ll9pbml0TWl4aW5zID0gZnVuY3Rpb24oYXJncykgeyBpbml0TWl4aW5zID0g
        YXJnczsgfTsKICBDbGFzcy5faW5pdFByb3BlcnRpZXMgPSBmdW5jdGlvbihh
        cmdzKSB7IGluaXRQcm9wZXJ0aWVzID0gYXJnczsgfTsKCiAgQ2xhc3MucHJv
        dG8gPSBmdW5jdGlvbigpIHsKICAgIHZhciBzdXBlcmNsYXNzID0gQ2xhc3Mu
        c3VwZXJjbGFzczsKICAgIGlmIChzdXBlcmNsYXNzKSB7IHN1cGVyY2xhc3Mu
        cHJvdG8oKTsgfQoKICAgIGlmICghd2FzQXBwbGllZCkgewogICAgICB3YXNB
        cHBsaWVkID0gdHJ1ZTsKICAgICAgQ2xhc3MuUHJvdG90eXBlTWl4aW4uYXBw
        bHlQYXJ0aWFsKENsYXNzLnByb3RvdHlwZSk7CiAgICAgIHJld2F0Y2goQ2xh
        c3MucHJvdG90eXBlKTsKICAgIH0KCiAgICByZXR1cm4gdGhpcy5wcm90b3R5
        cGU7CiAgfTsKCiAgcmV0dXJuIENsYXNzOwoKfQoKLyoqCiAgQGNsYXNzIENv
        cmVPYmplY3QKICBAbmFtZXNwYWNlIEVtYmVyCiovCnZhciBDb3JlT2JqZWN0
        ID0gbWFrZUN0b3IoKTsKQ29yZU9iamVjdC50b1N0cmluZyA9IGZ1bmN0aW9u
        KCkgeyByZXR1cm4gIkVtYmVyLkNvcmVPYmplY3QiOyB9OwoKQ29yZU9iamVj
        dC5Qcm90b3R5cGVNaXhpbiA9IE1peGluLmNyZWF0ZSh7CiAgcmVvcGVuOiBm
        dW5jdGlvbigpIHsKICAgIGFwcGx5TWl4aW4odGhpcywgYXJndW1lbnRzLCB0
        cnVlKTsKICAgIHJldHVybiB0aGlzOwogIH0sCgogIC8qKgogICAgQW4gb3Zl
        cnJpZGFibGUgbWV0aG9kIGNhbGxlZCB3aGVuIG9iamVjdHMgYXJlIGluc3Rh
        bnRpYXRlZC4gQnkgZGVmYXVsdCwKICAgIGRvZXMgbm90aGluZyB1bmxlc3Mg
        aXQgaXMgb3ZlcnJpZGRlbiBkdXJpbmcgY2xhc3MgZGVmaW5pdGlvbi4KCiAg
        ICBFeGFtcGxlOgoKICAgIGBgYGphdmFzY3JpcHQKICAgIEFwcC5QZXJzb24g
        PSBFbWJlci5PYmplY3QuZXh0ZW5kKHsKICAgICAgaW5pdDogZnVuY3Rpb24o
        KSB7CiAgICAgICAgdGhpcy5fc3VwZXIoKTsKICAgICAgICBhbGVydCgnTmFt
        ZSBpcyAnICsgdGhpcy5nZXQoJ25hbWUnKSk7CiAgICAgIH0KICAgIH0pOwoK
        ICAgIHZhciBzdGV2ZSA9IEFwcC5QZXJzb24uY3JlYXRlKHsKICAgICAgbmFt
        ZTogIlN0ZXZlIgogICAgfSk7CgogICAgLy8gYWxlcnRzICdOYW1lIGlzIFN0
        ZXZlJy4KICAgIGBgYAoKICAgIE5PVEU6IElmIHlvdSBkbyBvdmVycmlkZSBg
        aW5pdGAgZm9yIGEgZnJhbWV3b3JrIGNsYXNzIGxpa2UgYEVtYmVyLlZpZXdg
        IG9yCiAgICBgRW1iZXIuQXJyYXlDb250cm9sbGVyYCwgYmUgc3VyZSB0byBj
        YWxsIGB0aGlzLl9zdXBlcigpYCBpbiB5b3VyCiAgICBgaW5pdGAgZGVjbGFy
        YXRpb24hIElmIHlvdSBkb24ndCwgRW1iZXIgbWF5IG5vdCBoYXZlIGFuIG9w
        cG9ydHVuaXR5IHRvCiAgICBkbyBpbXBvcnRhbnQgc2V0dXAgd29yaywgYW5k
        IHlvdSdsbCBzZWUgc3RyYW5nZSBiZWhhdmlvciBpbiB5b3VyCiAgICBhcHBs
        aWNhdGlvbi4KCiAgICBAbWV0aG9kIGluaXQKICAqLwogIGluaXQ6IGZ1bmN0
        aW9uKCkge30sCgogIC8qKgogICAgRGVmaW5lcyB0aGUgcHJvcGVydGllcyB0
        aGF0IHdpbGwgYmUgY29uY2F0ZW5hdGVkIGZyb20gdGhlIHN1cGVyY2xhc3MK
        ICAgIChpbnN0ZWFkIG9mIG92ZXJyaWRkZW4pLgoKICAgIEJ5IGRlZmF1bHQs
        IHdoZW4geW91IGV4dGVuZCBhbiBFbWJlciBjbGFzcyBhIHByb3BlcnR5IGRl
        ZmluZWQgaW4KICAgIHRoZSBzdWJjbGFzcyBvdmVycmlkZXMgYSBwcm9wZXJ0
        eSB3aXRoIHRoZSBzYW1lIG5hbWUgdGhhdCBpcyBkZWZpbmVkCiAgICBpbiB0
        aGUgc3VwZXJjbGFzcy4gSG93ZXZlciwgdGhlcmUgYXJlIHNvbWUgY2FzZXMg
        d2hlcmUgaXQgaXMgcHJlZmVyYWJsZQogICAgdG8gYnVpbGQgdXAgYSBwcm9w
        ZXJ0eSdzIHZhbHVlIGJ5IGNvbWJpbmluZyB0aGUgc3VwZXJjbGFzcycgcHJv
        cGVydHkKICAgIHZhbHVlIHdpdGggdGhlIHN1YmNsYXNzJyB2YWx1ZS4gQW4g
        ZXhhbXBsZSBvZiB0aGlzIGluIHVzZSB3aXRoaW4gRW1iZXIKICAgIGlzIHRo
        ZSBgY2xhc3NOYW1lc2AgcHJvcGVydHkgb2YgYEVtYmVyLlZpZXdgLgoKICAg
        IEhlcmUgaXMgc29tZSBzYW1wbGUgY29kZSBzaG93aW5nIHRoZSBkaWZmZXJl
        bmNlIGJldHdlZW4gYSBjb25jYXRlbmF0ZWQKICAgIHByb3BlcnR5IGFuZCBh
        IG5vcm1hbCBvbmU6CgogICAgYGBgamF2YXNjcmlwdAogICAgQXBwLkJhclZp
        ZXcgPSBFbWJlci5WaWV3LmV4dGVuZCh7CiAgICAgIHNvbWVOb25Db25jYXRl
        bmF0ZWRQcm9wZXJ0eTogWydiYXInXSwKICAgICAgY2xhc3NOYW1lczogWydi
        YXInXQogICAgfSk7CgogICAgQXBwLkZvb0JhclZpZXcgPSBBcHAuQmFyVmll
        dy5leHRlbmQoewogICAgICBzb21lTm9uQ29uY2F0ZW5hdGVkUHJvcGVydHk6
        IFsnZm9vJ10sCiAgICAgIGNsYXNzTmFtZXM6IFsnZm9vJ10sCiAgICB9KTsK
        CiAgICB2YXIgZm9vQmFyVmlldyA9IEFwcC5Gb29CYXJWaWV3LmNyZWF0ZSgp
        OwogICAgZm9vQmFyVmlldy5nZXQoJ3NvbWVOb25Db25jYXRlbmF0ZWRQcm9w
        ZXJ0eScpOyAvLyBbJ2ZvbyddCiAgICBmb29CYXJWaWV3LmdldCgnY2xhc3NO
        YW1lcycpOyAvLyBbJ2VtYmVyLXZpZXcnLCAnYmFyJywgJ2ZvbyddCiAgICBg
        YGAKCiAgICBUaGlzIGJlaGF2aW9yIGV4dGVuZHMgdG8gb2JqZWN0IGNyZWF0
        aW9uIGFzIHdlbGwuIENvbnRpbnVpbmcgdGhlCiAgICBhYm92ZSBleGFtcGxl
        OgoKICAgIGBgYGphdmFzY3JpcHQKICAgIHZhciB2aWV3ID0gQXBwLkZvb0Jh
        clZpZXcuY3JlYXRlKHsKICAgICAgc29tZU5vbkNvbmNhdGVuYXRlZFByb3Bl
        cnR5OiBbJ2JheiddLAogICAgICBjbGFzc05hbWVzOiBbJ2JheiddCiAgICB9
        KQogICAgdmlldy5nZXQoJ3NvbWVOb25Db25jYXRlbmF0ZWRQcm9wZXJ0eScp
        OyAvLyBbJ2JheiddCiAgICB2aWV3LmdldCgnY2xhc3NOYW1lcycpOyAvLyBb
        J2VtYmVyLXZpZXcnLCAnYmFyJywgJ2ZvbycsICdiYXonXQogICAgYGBgCiAg
        ICBBZGRpbmcgYSBzaW5nbGUgcHJvcGVydHkgdGhhdCBpcyBub3QgYW4gYXJy
        YXkgd2lsbCBqdXN0IGFkZCBpdCBpbiB0aGUgYXJyYXk6CgogICAgYGBgamF2
        YXNjcmlwdAogICAgdmFyIHZpZXcgPSBBcHAuRm9vQmFyVmlldy5jcmVhdGUo
        ewogICAgICBjbGFzc05hbWVzOiAnYmF6JwogICAgfSkKICAgIHZpZXcuZ2V0
        KCdjbGFzc05hbWVzJyk7IC8vIFsnZW1iZXItdmlldycsICdiYXInLCAnZm9v
        JywgJ2JheiddCiAgICBgYGAKCiAgICBVc2luZyB0aGUgYGNvbmNhdGVuYXRl
        ZFByb3BlcnRpZXNgIHByb3BlcnR5LCB3ZSBjYW4gdGVsbCB0byBFbWJlciB0
        aGF0IG1peAogICAgdGhlIGNvbnRlbnQgb2YgdGhlIHByb3BlcnRpZXMuCgog
        ICAgSW4gYEVtYmVyLlZpZXdgIHRoZSBgY2xhc3NOYW1lQmluZGluZ3NgIGFu
        ZCBgYXR0cmlidXRlQmluZGluZ3NgIHByb3BlcnRpZXMKICAgIGFyZSBhbHNv
        IGNvbmNhdGVuYXRlZCwgaW4gYWRkaXRpb24gdG8gYGNsYXNzTmFtZXNgLgoK
        ICAgIFRoaXMgZmVhdHVyZSBpcyBhdmFpbGFibGUgZm9yIHlvdSB0byB1c2Ug
        dGhyb3VnaG91dCB0aGUgRW1iZXIgb2JqZWN0IG1vZGVsLAogICAgYWx0aG91
        Z2ggdHlwaWNhbCBhcHAgZGV2ZWxvcGVycyBhcmUgbGlrZWx5IHRvIHVzZSBp
        dCBpbmZyZXF1ZW50bHkuIFNpbmNlCiAgICBpdCBjaGFuZ2VzIGV4cGVjdGF0
        aW9ucyBhYm91dCBiZWhhdmlvciBvZiBwcm9wZXJ0aWVzLCB5b3Ugc2hvdWxk
        IHByb3Blcmx5CiAgICBkb2N1bWVudCBpdHMgdXNhZ2UgaW4gZWFjaCBpbmRp
        dmlkdWFsIGNvbmNhdGVuYXRlZCBwcm9wZXJ0eSAodG8gbm90CiAgICBtaXNs
        ZWFkIHlvdXIgdXNlcnMgdG8gdGhpbmsgdGhleSBjYW4gb3ZlcnJpZGUgdGhl
        IHByb3BlcnR5IGluIGEgc3ViY2xhc3MpLgoKICAgIEBwcm9wZXJ0eSBjb25j
        YXRlbmF0ZWRQcm9wZXJ0aWVzCiAgICBAdHlwZSBBcnJheQogICAgQGRlZmF1
        bHQgbnVsbAogICovCiAgY29uY2F0ZW5hdGVkUHJvcGVydGllczogbnVsbCwK
        CiAgLyoqCiAgICBEZXN0cm95ZWQgb2JqZWN0IHByb3BlcnR5IGZsYWcuCgog
        ICAgaWYgdGhpcyBwcm9wZXJ0eSBpcyBgdHJ1ZWAgdGhlIG9ic2VydmVycyBh
        bmQgYmluZGluZ3Mgd2VyZSBhbHJlYWR5CiAgICByZW1vdmVkIGJ5IHRoZSBl
        ZmZlY3Qgb2YgY2FsbGluZyB0aGUgYGRlc3Ryb3koKWAgbWV0aG9kLgoKICAg
        IEBwcm9wZXJ0eSBpc0Rlc3Ryb3llZAogICAgQGRlZmF1bHQgZmFsc2UKICAq
        LwogIGlzRGVzdHJveWVkOiBmYWxzZSwKCiAgLyoqCiAgICBEZXN0cnVjdGlv
        biBzY2hlZHVsZWQgZmxhZy4gVGhlIGBkZXN0cm95KClgIG1ldGhvZCBoYXMg
        YmVlbiBjYWxsZWQuCgogICAgVGhlIG9iamVjdCBzdGF5cyBpbnRhY3QgdW50
        aWwgdGhlIGVuZCBvZiB0aGUgcnVuIGxvb3AgYXQgd2hpY2ggcG9pbnQKICAg
        IHRoZSBgaXNEZXN0cm95ZWRgIGZsYWcgaXMgc2V0LgoKICAgIEBwcm9wZXJ0
        eSBpc0Rlc3Ryb3lpbmcKICAgIEBkZWZhdWx0IGZhbHNlCiAgKi8KICBpc0Rl
        c3Ryb3lpbmc6IGZhbHNlLAoKICAvKioKICAgIERlc3Ryb3lzIGFuIG9iamVj
        dCBieSBzZXR0aW5nIHRoZSBgaXNEZXN0cm95ZWRgIGZsYWcgYW5kIHJlbW92
        aW5nIGl0cwogICAgbWV0YWRhdGEsIHdoaWNoIGVmZmVjdGl2ZWx5IGRlc3Ry
        b3lzIG9ic2VydmVycyBhbmQgYmluZGluZ3MuCgogICAgSWYgeW91IHRyeSB0
        byBzZXQgYSBwcm9wZXJ0eSBvbiBhIGRlc3Ryb3llZCBvYmplY3QsIGFuIGV4
        Y2VwdGlvbiB3aWxsIGJlCiAgICByYWlzZWQuCgogICAgTm90ZSB0aGF0IGRl
        c3RydWN0aW9uIGlzIHNjaGVkdWxlZCBmb3IgdGhlIGVuZCBvZiB0aGUgcnVu
        IGxvb3AgYW5kIGRvZXMgbm90CiAgICBoYXBwZW4gaW1tZWRpYXRlbHkuICBJ
        dCB3aWxsIHNldCBhbiBpc0Rlc3Ryb3lpbmcgZmxhZyBpbW1lZGlhdGVseS4K
        CiAgICBAbWV0aG9kIGRlc3Ryb3kKICAgIEByZXR1cm4ge0VtYmVyLk9iamVj
        dH0gcmVjZWl2ZXIKICAqLwogIGRlc3Ryb3k6IGZ1bmN0aW9uKCkgewogICAg
        aWYgKHRoaXMuaXNEZXN0cm95aW5nKSB7IHJldHVybjsgfQogICAgdGhpcy5p
        c0Rlc3Ryb3lpbmcgPSB0cnVlOwoKICAgIHNjaGVkdWxlKCdhY3Rpb25zJywg
        dGhpcywgdGhpcy53aWxsRGVzdHJveSk7CiAgICBzY2hlZHVsZSgnZGVzdHJv
        eScsIHRoaXMsIHRoaXMuX3NjaGVkdWxlZERlc3Ryb3kpOwogICAgcmV0dXJu
        IHRoaXM7CiAgfSwKCiAgLyoqCiAgICBPdmVycmlkZSB0byBpbXBsZW1lbnQg
        dGVhcmRvd24uCgogICAgQG1ldGhvZCB3aWxsRGVzdHJveQogICAqLwogIHdp
        bGxEZXN0cm95OiBFbWJlci5LLAoKICAvKioKICAgIEBwcml2YXRlCgogICAg
        SW52b2tlZCBieSB0aGUgcnVuIGxvb3AgdG8gYWN0dWFsbHkgZGVzdHJveSB0
        aGUgb2JqZWN0LiBUaGlzIGlzCiAgICBzY2hlZHVsZWQgZm9yIGV4ZWN1dGlv
        biBieSB0aGUgYGRlc3Ryb3lgIG1ldGhvZC4KCiAgICBAbWV0aG9kIF9zY2hl
        ZHVsZWREZXN0cm95CiAgKi8KICBfc2NoZWR1bGVkRGVzdHJveTogZnVuY3Rp
        b24oKSB7CiAgICBpZiAodGhpcy5pc0Rlc3Ryb3llZCkgeyByZXR1cm47IH0K
        ICAgIGRlc3Ryb3kodGhpcyk7CiAgICB0aGlzLmlzRGVzdHJveWVkID0gdHJ1
        ZTsKICB9LAoKICBiaW5kOiBmdW5jdGlvbih0bywgZnJvbSkgewogICAgaWYg
        KCEoZnJvbSBpbnN0YW5jZW9mIEVtYmVyLkJpbmRpbmcpKSB7IGZyb20gPSBF
        bWJlci5CaW5kaW5nLmZyb20oZnJvbSk7IH0KICAgIGZyb20udG8odG8pLmNv
        bm5lY3QodGhpcyk7CiAgICByZXR1cm4gZnJvbTsKICB9LAoKICAvKioKICAg
        IFJldHVybnMgYSBzdHJpbmcgcmVwcmVzZW50YXRpb24gd2hpY2ggYXR0ZW1w
        dHMgdG8gcHJvdmlkZSBtb3JlIGluZm9ybWF0aW9uCiAgICB0aGFuIEphdmFz
        Y3JpcHQncyBgdG9TdHJpbmdgIHR5cGljYWxseSBkb2VzLCBpbiBhIGdlbmVy
        aWMgd2F5IGZvciBhbGwgRW1iZXIKICAgIG9iamVjdHMuCgogICAgICAgIEFw
        cC5QZXJzb24gPSBFbS5PYmplY3QuZXh0ZW5kKCkKICAgICAgICBwZXJzb24g
        PSBBcHAuUGVyc29uLmNyZWF0ZSgpCiAgICAgICAgcGVyc29uLnRvU3RyaW5n
        KCkgLy89PiAiPEFwcC5QZXJzb246ZW1iZXIxMDI0PiIKCiAgICBJZiB0aGUg
        b2JqZWN0J3MgY2xhc3MgaXMgbm90IGRlZmluZWQgb24gYW4gRW1iZXIgbmFt
        ZXNwYWNlLCBpdCB3aWxsCiAgICBpbmRpY2F0ZSBpdCBpcyBhIHN1YmNsYXNz
        IG9mIHRoZSByZWdpc3RlcmVkIHN1cGVyY2xhc3M6CgogICAgICAgIFN0dWRl
        bnQgPSBBcHAuUGVyc29uLmV4dGVuZCgpCiAgICAgICAgc3R1ZGVudCA9IFN0
        dWRlbnQuY3JlYXRlKCkKICAgICAgICBzdHVkZW50LnRvU3RyaW5nKCkgLy89
        PiAiPChzdWJjbGFzcyBvZiBBcHAuUGVyc29uKTplbWJlcjEwMjU+IgoKICAg
        IElmIHRoZSBtZXRob2QgYHRvU3RyaW5nRXh0ZW5zaW9uYCBpcyBkZWZpbmVk
        LCBpdHMgcmV0dXJuIHZhbHVlIHdpbGwgYmUKICAgIGluY2x1ZGVkIGluIHRo
        ZSBvdXRwdXQuCgogICAgICAgIEFwcC5UZWFjaGVyID0gQXBwLlBlcnNvbi5l
        eHRlbmQoewogICAgICAgICAgdG9TdHJpbmdFeHRlbnNpb246IGZ1bmN0aW9u
        KCkgewogICAgICAgICAgICByZXR1cm4gdGhpcy5nZXQoJ2Z1bGxOYW1lJyk7
        CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgICAgdGVhY2hlciA9IEFw
        cC5UZWFjaGVyLmNyZWF0ZSgpCiAgICAgICAgdGVhY2hlci50b1N0cmluZygp
        OyAvLz0+ICI8QXBwLlRlYWNoZXI6ZW1iZXIxMDI2OlRvbSBEYWxlPiIKCiAg
        ICBAbWV0aG9kIHRvU3RyaW5nCiAgICBAcmV0dXJuIHtTdHJpbmd9IHN0cmlu
        ZyByZXByZXNlbnRhdGlvbgogICovCiAgdG9TdHJpbmc6IGZ1bmN0aW9uIHRv
        U3RyaW5nKCkgewogICAgdmFyIGhhc1RvU3RyaW5nRXh0ZW5zaW9uID0gdHlw
        ZW9mIHRoaXMudG9TdHJpbmdFeHRlbnNpb24gPT09ICdmdW5jdGlvbicsCiAg
        ICAgICAgZXh0ZW5zaW9uID0gaGFzVG9TdHJpbmdFeHRlbnNpb24gPyAiOiIg
        KyB0aGlzLnRvU3RyaW5nRXh0ZW5zaW9uKCkgOiAnJzsKICAgIHZhciByZXQg
        PSAnPCcrdGhpcy5jb25zdHJ1Y3Rvci50b1N0cmluZygpKyc6JytndWlkRm9y
        KHRoaXMpK2V4dGVuc2lvbisnPic7CiAgICB0aGlzLnRvU3RyaW5nID0gbWFr
        ZVRvU3RyaW5nKHJldCk7CiAgICByZXR1cm4gcmV0OwogIH0KfSk7CgpDb3Jl
        T2JqZWN0LlByb3RvdHlwZU1peGluLm93bmVyQ29uc3RydWN0b3IgPSBDb3Jl
        T2JqZWN0OwoKZnVuY3Rpb24gbWFrZVRvU3RyaW5nKHJldCkgewogIHJldHVy
        biBmdW5jdGlvbigpIHsgcmV0dXJuIHJldDsgfTsKfQoKaWYgKEVtYmVyLmNv
        bmZpZy5vdmVycmlkZVByb3RvdHlwZU1peGluKSB7CiAgRW1iZXIuY29uZmln
        Lm92ZXJyaWRlUHJvdG90eXBlTWl4aW4oQ29yZU9iamVjdC5Qcm90b3R5cGVN
        aXhpbik7Cn0KCkNvcmVPYmplY3QuX19zdXBlcl9fID0gbnVsbDsKCnZhciBD
        bGFzc01peGluID0gTWl4aW4uY3JlYXRlKHsKCiAgQ2xhc3NNaXhpbjogRW1i
        ZXIucmVxdWlyZWQoKSwKCiAgUHJvdG90eXBlTWl4aW46IEVtYmVyLnJlcXVp
        cmVkKCksCgogIGlzQ2xhc3M6IHRydWUsCgogIGlzTWV0aG9kOiBmYWxzZSwK
        CiAgLyoqCiAgICBDcmVhdGVzIGEgbmV3IHN1YmNsYXNzLgoKICAgIGBgYGph
        dmFzY3JpcHQKICAgIEFwcC5QZXJzb24gPSBFbWJlci5PYmplY3QuZXh0ZW5k
        KHsKICAgICAgc2F5OiBmdW5jdGlvbih0aGluZykgewogICAgICAgIGFsZXJ0
        KHRoaW5nKTsKICAgICAgIH0KICAgIH0pOwogICAgYGBgCgogICAgVGhpcyBk
        ZWZpbmVzIGEgbmV3IHN1YmNsYXNzIG9mIEVtYmVyLk9iamVjdDogYEFwcC5Q
        ZXJzb25gLiBJdCBjb250YWlucyBvbmUgbWV0aG9kOiBgc2F5KClgLgoKICAg
        IFlvdSBjYW4gYWxzbyBjcmVhdGUgYSBzdWJjbGFzcyBmcm9tIGFueSBleGlz
        dGluZyBjbGFzcyBieSBjYWxsaW5nIGl0cyBgZXh0ZW5kKClgICBtZXRob2Qu
        IEZvciBleGFtcGxlLCB5b3UgbWlnaHQgd2FudCB0byBjcmVhdGUgYSBzdWJj
        bGFzcyBvZiBFbWJlcidzIGJ1aWx0LWluIGBFbWJlci5WaWV3YCBjbGFzczoK
        CiAgICBgYGBqYXZhc2NyaXB0CiAgICBBcHAuUGVyc29uVmlldyA9IEVtYmVy
        LlZpZXcuZXh0ZW5kKHsKICAgICAgdGFnTmFtZTogJ2xpJywKICAgICAgY2xh
        c3NOYW1lQmluZGluZ3M6IFsnaXNBZG1pbmlzdHJhdG9yJ10KICAgIH0pOwog
        ICAgYGBgCgogICAgV2hlbiBkZWZpbmluZyBhIHN1YmNsYXNzLCB5b3UgY2Fu
        IG92ZXJyaWRlIG1ldGhvZHMgYnV0IHN0aWxsIGFjY2VzcyB0aGUgaW1wbGVt
        ZW50YXRpb24gb2YgeW91ciBwYXJlbnQgY2xhc3MgYnkgY2FsbGluZyB0aGUg
        c3BlY2lhbCBgX3N1cGVyKClgIG1ldGhvZDoKCiAgICBgYGBqYXZhc2NyaXB0
        CiAgICBBcHAuUGVyc29uID0gRW1iZXIuT2JqZWN0LmV4dGVuZCh7CiAgICAg
        IHNheTogZnVuY3Rpb24odGhpbmcpIHsKICAgICAgICB2YXIgbmFtZSA9IHRo
        aXMuZ2V0KCduYW1lJyk7CiAgICAgICAgYWxlcnQobmFtZSArICcgc2F5czog
        JyArIHRoaW5nKTsKICAgICAgfQogICAgfSk7CgogICAgQXBwLlNvbGRpZXIg
        PSBBcHAuUGVyc29uLmV4dGVuZCh7CiAgICAgIHNheTogZnVuY3Rpb24odGhp
        bmcpIHsKICAgICAgICB0aGlzLl9zdXBlcih0aGluZyArICIsIHNpciEiKTsK
        ICAgICAgfSwKICAgICAgbWFyY2g6IGZ1bmN0aW9uKG51bWJlck9mSG91cnMp
        IHsKICAgICAgICBhbGVydCh0aGlzLmdldCgnbmFtZScpICsgJyBtYXJjaGVz
        IGZvciAnICsgbnVtYmVyT2ZIb3VycyArICcgaG91cnMuJykKICAgICAgfQog
        ICAgfSk7CgogICAgdmFyIHllaHVkYSA9IEFwcC5Tb2xkaWVyLmNyZWF0ZSh7
        CiAgICAgIG5hbWU6ICJZZWh1ZGEgS2F0eiIKICAgIH0pOwoKICAgIHllaHVk
        YS5zYXkoIlllcyIpOyAgLy8gYWxlcnRzICJZZWh1ZGEgS2F0eiBzYXlzOiBZ
        ZXMsIHNpciEiCiAgICBgYGAKCiAgICBUaGUgYGNyZWF0ZSgpYCBvbiBsaW5l
        ICMxNyBjcmVhdGVzIGFuICppbnN0YW5jZSogb2YgdGhlIGBBcHAuU29sZGll
        cmAgY2xhc3MuIFRoZSBgZXh0ZW5kKClgIG9uIGxpbmUgIzggY3JlYXRlcyBh
        ICpzdWJjbGFzcyogb2YgYEFwcC5QZXJzb25gLiBBbnkgaW5zdGFuY2Ugb2Yg
        dGhlIGBBcHAuUGVyc29uYCBjbGFzcyB3aWxsICpub3QqIGhhdmUgdGhlIGBt
        YXJjaCgpYCBtZXRob2QuCgogICAgWW91IGNhbiBhbHNvIHBhc3MgYEVtYmVy
        Lk1peGluYCBjbGFzc2VzIHRvIGFkZCBhZGRpdGlvbmFsIHByb3BlcnRpZXMg
        dG8gdGhlIHN1YmNsYXNzLgoKICAgIGBgYGphdmFzY3JpcHQKICAgIEFwcC5Q
        ZXJzb24gPSBFbWJlci5PYmplY3QuZXh0ZW5kKHsKICAgICAgc2F5OiBmdW5j
        dGlvbih0aGluZykgewogICAgICAgIGFsZXJ0KHRoaXMuZ2V0KCduYW1lJykg
        KyAnIHNheXM6ICcgKyB0aGluZyk7CiAgICAgIH0KICAgIH0pOwoKICAgIEFw
        cC5TaW5naW5nTWl4aW4gPSBFbWJlci5NaXhpbi5jcmVhdGUoewogICAgICBz
        aW5nOiBmdW5jdGlvbih0aGluZyl7CiAgICAgICAgYWxlcnQodGhpcy5nZXQo
        J25hbWUnKSArICcgc2luZ3M6IGxhIGxhIGxhICcgKyB0aGluZyk7CiAgICAg
        IH0KICAgIH0pOwoKICAgIEFwcC5Ccm9hZHdheVN0YXIgPSBBcHAuUGVyc29u
        LmV4dGVuZChBcHAuU2luZ2luZ01peGluLCB7CiAgICAgIGRhbmNlOiBmdW5j
        dGlvbigpIHsKICAgICAgICBhbGVydCh0aGlzLmdldCgnbmFtZScpICsgJyBk
        YW5jZXM6IHRhcCB0YXAgdGFwIHRhcCAnKTsKICAgICAgfQogICAgfSk7CiAg
        ICBgYGAKCiAgICBUaGUgYEFwcC5Ccm9hZHdheVN0YXJgIGNsYXNzIGNvbnRh
        aW5zIHRocmVlIG1ldGhvZHM6IGBzYXkoKWAsIGBzaW5nKClgLCBhbmQgYGRh
        bmNlKClgLgoKICAgIEBtZXRob2QgZXh0ZW5kCiAgICBAc3RhdGljCgogICAg
        QHBhcmFtIHtFbWJlci5NaXhpbn0gW21peGluc10qIE9uZSBvciBtb3JlIEVt
        YmVyLk1peGluIGNsYXNzZXMKICAgIEBwYXJhbSB7T2JqZWN0fSBbYXJndW1l
        bnRzXSogT2JqZWN0IGNvbnRhaW5pbmcgdmFsdWVzIHRvIHVzZSB3aXRoaW4g
        dGhlIG5ldyBjbGFzcwogICovCiAgZXh0ZW5kOiBmdW5jdGlvbigpIHsKICAg
        IHZhciBDbGFzcyA9IG1ha2VDdG9yKCksIHByb3RvOwogICAgQ2xhc3MuQ2xh
        c3NNaXhpbiA9IE1peGluLmNyZWF0ZSh0aGlzLkNsYXNzTWl4aW4pOwogICAg
        Q2xhc3MuUHJvdG90eXBlTWl4aW4gPSBNaXhpbi5jcmVhdGUodGhpcy5Qcm90
        b3R5cGVNaXhpbik7CgogICAgQ2xhc3MuQ2xhc3NNaXhpbi5vd25lckNvbnN0
        cnVjdG9yID0gQ2xhc3M7CiAgICBDbGFzcy5Qcm90b3R5cGVNaXhpbi5vd25l
        ckNvbnN0cnVjdG9yID0gQ2xhc3M7CgogICAgcmVvcGVuLmFwcGx5KENsYXNz
        LlByb3RvdHlwZU1peGluLCBhcmd1bWVudHMpOwoKICAgIENsYXNzLnN1cGVy
        Y2xhc3MgPSB0aGlzOwogICAgQ2xhc3MuX19zdXBlcl9fICA9IHRoaXMucHJv
        dG90eXBlOwoKICAgIHByb3RvID0gQ2xhc3MucHJvdG90eXBlID0gb19jcmVh
        dGUodGhpcy5wcm90b3R5cGUpOwogICAgcHJvdG8uY29uc3RydWN0b3IgPSBD
        bGFzczsKICAgIGdlbmVyYXRlR3VpZChwcm90bywgJ2VtYmVyJyk7CiAgICBt
        ZXRhKHByb3RvKS5wcm90byA9IHByb3RvOyAvLyB0aGlzIHdpbGwgZGlzYWJs
        ZSBvYnNlcnZlcnMgb24gcHJvdG90eXBlCgogICAgQ2xhc3MuQ2xhc3NNaXhp
        bi5hcHBseShDbGFzcyk7CiAgICByZXR1cm4gQ2xhc3M7CiAgfSwKCiAgLyoq
        CiAgICBFcXVpdmFsZW50IHRvIGRvaW5nIGBleHRlbmQoYXJndW1lbnRzKS5j
        cmVhdGUoKWAuCiAgICBJZiBwb3NzaWJsZSB1c2UgdGhlIG5vcm1hbCBgY3Jl
        YXRlYCBtZXRob2QgaW5zdGVhZC4KCiAgICBAbWV0aG9kIGNyZWF0ZVdpdGhN
        aXhpbnMKICAgIEBzdGF0aWMKICAgIEBwYXJhbSBbYXJndW1lbnRzXSoKICAq
        LwogIGNyZWF0ZVdpdGhNaXhpbnM6IGZ1bmN0aW9uKCkgewogICAgdmFyIEMg
        PSB0aGlzOwogICAgaWYgKGFyZ3VtZW50cy5sZW5ndGg+MCkgeyB0aGlzLl9p
        bml0TWl4aW5zKGFyZ3VtZW50cyk7IH0KICAgIHJldHVybiBuZXcgQygpOwog
        IH0sCgogIC8qKgogICAgQ3JlYXRlcyBhbiBpbnN0YW5jZSBvZiBhIGNsYXNz
        LiBBY2NlcHRzIGVpdGhlciBubyBhcmd1bWVudHMsIG9yIGFuIG9iamVjdAog
        ICAgY29udGFpbmluZyB2YWx1ZXMgdG8gaW5pdGlhbGl6ZSB0aGUgbmV3bHkg
        aW5zdGFudGlhdGVkIG9iamVjdCB3aXRoLgoKICAgIGBgYGphdmFzY3JpcHQK
        ICAgIEFwcC5QZXJzb24gPSBFbWJlci5PYmplY3QuZXh0ZW5kKHsKICAgICAg
        aGVsbG9Xb3JsZDogZnVuY3Rpb24oKSB7CiAgICAgICAgYWxlcnQoIkhpLCBt
        eSBuYW1lIGlzICIgKyB0aGlzLmdldCgnbmFtZScpKTsKICAgICAgfQogICAg
        fSk7CgogICAgdmFyIHRvbSA9IEFwcC5QZXJzb24uY3JlYXRlKHsKICAgICAg
        bmFtZTogJ1RvbSBEYWxlJwogICAgfSk7CgogICAgdG9tLmhlbGxvV29ybGQo
        KTsgLy8gYWxlcnRzICJIaSwgbXkgbmFtZSBpcyBUb20gRGFsZSIuCiAgICBg
        YGAKCiAgICBgY3JlYXRlYCB3aWxsIGNhbGwgdGhlIGBpbml0YCBmdW5jdGlv
        biBpZiBkZWZpbmVkIGR1cmluZwogICAgYEVtYmVyLkFueU9iamVjdC5leHRl
        bmRgCgogICAgSWYgbm8gYXJndW1lbnRzIGFyZSBwYXNzZWQgdG8gYGNyZWF0
        ZWAsIGl0IHdpbGwgbm90IHNldCB2YWx1ZXMgdG8gdGhlIG5ldwogICAgaW5z
        dGFuY2UgZHVyaW5nIGluaXRpYWxpemF0aW9uOgoKICAgIGBgYGphdmFzY3Jp
        cHQKICAgIHZhciBub05hbWUgPSBBcHAuUGVyc29uLmNyZWF0ZSgpOwogICAg
        bm9OYW1lLmhlbGxvV29ybGQoKTsgLy8gYWxlcnRzIHVuZGVmaW5lZAogICAg
        YGBgCgogICAgTk9URTogRm9yIHBlcmZvcm1hbmNlIHJlYXNvbnMsIHlvdSBj
        YW5ub3QgZGVjbGFyZSBtZXRob2RzIG9yIGNvbXB1dGVkCiAgICBwcm9wZXJ0
        aWVzIGR1cmluZyBgY3JlYXRlYC4gWW91IHNob3VsZCBpbnN0ZWFkIGRlY2xh
        cmUgbWV0aG9kcyBhbmQgY29tcHV0ZWQKICAgIHByb3BlcnRpZXMgd2hlbiB1
        c2luZyBgZXh0ZW5kYCBvciB1c2UgdGhlIGBjcmVhdGVXaXRoTWl4aW5zYCBz
        aG9ydGhhbmQuCgogICAgQG1ldGhvZCBjcmVhdGUKICAgIEBzdGF0aWMKICAg
        IEBwYXJhbSBbYXJndW1lbnRzXSoKICAqLwogIGNyZWF0ZTogZnVuY3Rpb24o
        KSB7CiAgICB2YXIgQyA9IHRoaXM7CiAgICBpZiAoYXJndW1lbnRzLmxlbmd0
        aD4wKSB7IHRoaXMuX2luaXRQcm9wZXJ0aWVzKGFyZ3VtZW50cyk7IH0KICAg
        IHJldHVybiBuZXcgQygpOwogIH0sCgogIC8qKgoKICAgIEF1Z21lbnRzIGEg
        Y29uc3RydWN0b3IncyBwcm90b3R5cGUgd2l0aCBhZGRpdGlvbmFsCiAgICBw
        cm9wZXJ0aWVzIGFuZCBmdW5jdGlvbnM6CgogICAgYGBgamF2YXNjcmlwdAog
        ICAgTXlPYmplY3QgPSBFbWJlci5PYmplY3QuZXh0ZW5kKHsKICAgICAgbmFt
        ZTogJ2FuIG9iamVjdCcKICAgIH0pOwoKICAgIG8gPSBNeU9iamVjdC5jcmVh
        dGUoKTsKICAgIG8uZ2V0KCduYW1lJyk7IC8vICdhbiBvYmplY3QnCgogICAg
        TXlPYmplY3QucmVvcGVuKHsKICAgICAgc2F5OiBmdW5jdGlvbihtc2cpewog
        ICAgICAgIGNvbnNvbGUubG9nKG1zZyk7CiAgICAgIH0KICAgIH0pCgogICAg
        bzIgPSBNeU9iamVjdC5jcmVhdGUoKTsKICAgIG8yLnNheSgiaGVsbG8iKTsg
        Ly8gbG9ncyAiaGVsbG8iCgogICAgby5zYXkoImdvb2RieWUiKTsgLy8gbG9n
        cyAiZ29vZGJ5ZSIKICAgIGBgYAoKICAgIFRvIGFkZCBmdW5jdGlvbnMgYW5k
        IHByb3BlcnRpZXMgdG8gdGhlIGNvbnN0cnVjdG9yIGl0c2VsZiwKICAgIHNl
        ZSBgcmVvcGVuQ2xhc3NgCgogICAgQG1ldGhvZCByZW9wZW4KICAqLwogIHJl
        b3BlbjogZnVuY3Rpb24oKSB7CiAgICB0aGlzLndpbGxSZW9wZW4oKTsKICAg
        IHJlb3Blbi5hcHBseSh0aGlzLlByb3RvdHlwZU1peGluLCBhcmd1bWVudHMp
        OwogICAgcmV0dXJuIHRoaXM7CiAgfSwKCiAgLyoqCiAgICBBdWdtZW50cyBh
        IGNvbnN0cnVjdG9yJ3Mgb3duIHByb3BlcnRpZXMgYW5kIGZ1bmN0aW9uczoK
        CiAgICBgYGBqYXZhc2NyaXB0CiAgICBNeU9iamVjdCA9IEVtYmVyLk9iamVj
        dC5leHRlbmQoewogICAgICBuYW1lOiAnYW4gb2JqZWN0JwogICAgfSk7CgoK
        ICAgIE15T2JqZWN0LnJlb3BlbkNsYXNzKHsKICAgICAgY2FuQnVpbGQ6IGZh
        bHNlCiAgICB9KTsKCiAgICBNeU9iamVjdC5jYW5CdWlsZDsgLy8gZmFsc2UK
        ICAgIG8gPSBNeU9iamVjdC5jcmVhdGUoKTsKICAgIGBgYAoKICAgIEluIG90
        aGVyIHdvcmRzLCB0aGlzIGNyZWF0ZXMgc3RhdGljIHByb3BlcnRpZXMgYW5k
        IGZ1bmN0aW9ucyBmb3IgdGhlIGNsYXNzLiBUaGVzZSBhcmUgb25seSBhdmFp
        bGFibGUgb24gdGhlIGNsYXNzCiAgICBhbmQgbm90IG9uIGFueSBpbnN0YW5j
        ZSBvZiB0aGF0IGNsYXNzLgoKICAgIGBgYGphdmFzY3JpcHQKICAgIEFwcC5Q
        ZXJzb24gPSBFbWJlci5PYmplY3QuZXh0ZW5kKHsKICAgICAgbmFtZSA6ICIi
        LAogICAgICBzYXlIZWxsbyA6IGZ1bmN0aW9uKCl7CiAgICAgICAgYWxlcnQo
        IkhlbGxvLiBNeSBuYW1lIGlzICIgKyB0aGlzLmdldCgnbmFtZScpKTsKICAg
        ICAgfQogICAgfSk7CgogICAgQXBwLlBlcnNvbi5yZW9wZW5DbGFzcyh7CiAg
        ICAgIHNwZWNpZXMgOiAiSG9tbyBzYXBpZW5zIiwKICAgICAgY3JlYXRlUGVy
        c29uOiBmdW5jdGlvbihuZXdQZXJzb25zTmFtZSl7CiAgICAgICAgcmV0dXJu
        IEFwcC5QZXJzb24uY3JlYXRlKHsKICAgICAgICAgIG5hbWU6bmV3UGVyc29u
        c05hbWUKICAgICAgICB9KTsKICAgICAgfQogICAgfSk7CgogICAgdmFyIHRv
        bSA9IEFwcC5QZXJzb24uY3JlYXRlKHsKICAgICAgbmFtZSA6ICJUb20gRGFs
        ZSIKICAgIH0pOwogICAgdmFyIHllaHVkYSA9IEFwcC5QZXJzb24uY3JlYXRl
        UGVyc29uKCJZZWh1ZGEgS2F0eiIpOwoKICAgIHRvbS5zYXlIZWxsbygpOyAv
        LyAiSGVsbG8uIE15IG5hbWUgaXMgVG9tIERhbGUiCiAgICB5ZWh1ZGEuc2F5
        SGVsbG8oKTsgLy8gIkhlbGxvLiBNeSBuYW1lIGlzIFllaHVkYSBLYXR6Igog
        ICAgYWxlcnQoQXBwLlBlcnNvbi5zcGVjaWVzKTsgLy8gIkhvbW8gc2FwaWVu
        cyIKICAgIGBgYAoKICAgIE5vdGUgdGhhdCBgc3BlY2llc2AgYW5kIGBjcmVh
        dGVQZXJzb25gIGFyZSAqbm90KiB2YWxpZCBvbiB0aGUgYHRvbWAgYW5kIGB5
        ZWh1ZGFgCiAgICB2YXJpYWJsZXMuIFRoZXkgYXJlIG9ubHkgdmFsaWQgb24g
        YEFwcC5QZXJzb25gLgoKICAgIFRvIGFkZCBmdW5jdGlvbnMgYW5kIHByb3Bl
        cnRpZXMgdG8gaW5zdGFuY2VzIG9mCiAgICBhIGNvbnN0cnVjdG9yIGJ5IGV4
        dGVuZGluZyB0aGUgY29uc3RydWN0b3IncyBwcm90b3R5cGUKICAgIHNlZSBg
        cmVvcGVuYAoKICAgIEBtZXRob2QgcmVvcGVuQ2xhc3MKICAqLwogIHJlb3Bl
        bkNsYXNzOiBmdW5jdGlvbigpIHsKICAgIHJlb3Blbi5hcHBseSh0aGlzLkNs
        YXNzTWl4aW4sIGFyZ3VtZW50cyk7CiAgICBhcHBseU1peGluKHRoaXMsIGFy
        Z3VtZW50cywgZmFsc2UpOwogICAgcmV0dXJuIHRoaXM7CiAgfSwKCiAgZGV0
        ZWN0OiBmdW5jdGlvbihvYmopIHsKICAgIGlmICgnZnVuY3Rpb24nICE9PSB0
        eXBlb2Ygb2JqKSB7IHJldHVybiBmYWxzZTsgfQogICAgd2hpbGUob2JqKSB7
        CiAgICAgIGlmIChvYmo9PT10aGlzKSB7IHJldHVybiB0cnVlOyB9CiAgICAg
        IG9iaiA9IG9iai5zdXBlcmNsYXNzOwogICAgfQogICAgcmV0dXJuIGZhbHNl
        OwogIH0sCgogIGRldGVjdEluc3RhbmNlOiBmdW5jdGlvbihvYmopIHsKICAg
        IHJldHVybiBvYmogaW5zdGFuY2VvZiB0aGlzOwogIH0sCgogIC8qKgogICAg
        SW4gc29tZSBjYXNlcywgeW91IG1heSB3YW50IHRvIGFubm90YXRlIGNvbXB1
        dGVkIHByb3BlcnRpZXMgd2l0aCBhZGRpdGlvbmFsCiAgICBtZXRhZGF0YSBh
        Ym91dCBob3cgdGhleSBmdW5jdGlvbiBvciB3aGF0IHZhbHVlcyB0aGV5IG9w
        ZXJhdGUgb24uIEZvcgogICAgZXhhbXBsZSwgY29tcHV0ZWQgcHJvcGVydHkg
        ZnVuY3Rpb25zIG1heSBjbG9zZSBvdmVyIHZhcmlhYmxlcyB0aGF0IGFyZSB0
        aGVuCiAgICBubyBsb25nZXIgYXZhaWxhYmxlIGZvciBpbnRyb3NwZWN0aW9u
        LgoKICAgIFlvdSBjYW4gcGFzcyBhIGhhc2ggb2YgdGhlc2UgdmFsdWVzIHRv
        IGEgY29tcHV0ZWQgcHJvcGVydHkgbGlrZSB0aGlzOgoKICAgIGBgYGphdmFz
        Y3JpcHQKICAgIHBlcnNvbjogZnVuY3Rpb24oKSB7CiAgICAgIHZhciBwZXJz
        b25JZCA9IHRoaXMuZ2V0KCdwZXJzb25JZCcpOwogICAgICByZXR1cm4gQXBw
        LlBlcnNvbi5jcmVhdGUoeyBpZDogcGVyc29uSWQgfSk7CiAgICB9LnByb3Bl
        cnR5KCkubWV0YSh7IHR5cGU6IEFwcC5QZXJzb24gfSkKICAgIGBgYAoKICAg
        IE9uY2UgeW91J3ZlIGRvbmUgdGhpcywgeW91IGNhbiByZXRyaWV2ZSB0aGUg
        dmFsdWVzIHNhdmVkIHRvIHRoZSBjb21wdXRlZAogICAgcHJvcGVydHkgZnJv
        bSB5b3VyIGNsYXNzIGxpa2UgdGhpczoKCiAgICBgYGBqYXZhc2NyaXB0CiAg
        ICBNeUNsYXNzLm1ldGFGb3JQcm9wZXJ0eSgncGVyc29uJyk7CiAgICBgYGAK
        CiAgICBUaGlzIHdpbGwgcmV0dXJuIHRoZSBvcmlnaW5hbCBoYXNoIHRoYXQg
        d2FzIHBhc3NlZCB0byBgbWV0YSgpYC4KCiAgICBAbWV0aG9kIG1ldGFGb3JQ
        cm9wZXJ0eQogICAgQHBhcmFtIGtleSB7U3RyaW5nfSBwcm9wZXJ0eSBuYW1l
        CiAgKi8KICBtZXRhRm9yUHJvcGVydHk6IGZ1bmN0aW9uKGtleSkgewogICAg
        dmFyIGRlc2MgPSBtZXRhKHRoaXMucHJvdG8oKSwgZmFsc2UpLmRlc2NzW2tl
        eV07CgogICAgRW1iZXIuYXNzZXJ0KCJtZXRhRm9yUHJvcGVydHkoKSBjb3Vs
        ZCBub3QgZmluZCBhIGNvbXB1dGVkIHByb3BlcnR5IHdpdGgga2V5ICciK2tl
        eSsiJy4iLCAhIWRlc2MgJiYgZGVzYyBpbnN0YW5jZW9mIEVtYmVyLkNvbXB1
        dGVkUHJvcGVydHkpOwogICAgcmV0dXJuIGRlc2MuX21ldGEgfHwge307CiAg
        fSwKCiAgLyoqCiAgICBJdGVyYXRlIG92ZXIgZWFjaCBjb21wdXRlZCBwcm9w
        ZXJ0eSBmb3IgdGhlIGNsYXNzLCBwYXNzaW5nIGl0cyBuYW1lCiAgICBhbmQg
        YW55IGFzc29jaWF0ZWQgbWV0YWRhdGEgKHNlZSBgbWV0YUZvclByb3BlcnR5
        YCkgdG8gdGhlIGNhbGxiYWNrLgoKICAgIEBtZXRob2QgZWFjaENvbXB1dGVk
        UHJvcGVydHkKICAgIEBwYXJhbSB7RnVuY3Rpb259IGNhbGxiYWNrCiAgICBA
        cGFyYW0ge09iamVjdH0gYmluZGluZwogICovCiAgZWFjaENvbXB1dGVkUHJv
        cGVydHk6IGZ1bmN0aW9uKGNhbGxiYWNrLCBiaW5kaW5nKSB7CiAgICB2YXIg
        cHJvdG8gPSB0aGlzLnByb3RvKCksCiAgICAgICAgZGVzY3MgPSBtZXRhKHBy
        b3RvKS5kZXNjcywKICAgICAgICBlbXB0eSA9IHt9LAogICAgICAgIHByb3Bl
        cnR5OwoKICAgIGZvciAodmFyIG5hbWUgaW4gZGVzY3MpIHsKICAgICAgcHJv
        cGVydHkgPSBkZXNjc1tuYW1lXTsKCiAgICAgIGlmIChwcm9wZXJ0eSBpbnN0
        YW5jZW9mIEVtYmVyLkNvbXB1dGVkUHJvcGVydHkpIHsKICAgICAgICBjYWxs
        YmFjay5jYWxsKGJpbmRpbmcgfHwgdGhpcywgbmFtZSwgcHJvcGVydHkuX21l
        dGEgfHwgZW1wdHkpOwogICAgICB9CiAgICB9CiAgfQoKfSk7CgpDbGFzc01p
        eGluLm93bmVyQ29uc3RydWN0b3IgPSBDb3JlT2JqZWN0OwoKaWYgKEVtYmVy
        LmNvbmZpZy5vdmVycmlkZUNsYXNzTWl4aW4pIHsKICBFbWJlci5jb25maWcu
        b3ZlcnJpZGVDbGFzc01peGluKENsYXNzTWl4aW4pOwp9CgpDb3JlT2JqZWN0
        LkNsYXNzTWl4aW4gPSBDbGFzc01peGluOwpDbGFzc01peGluLmFwcGx5KENv
        cmVPYmplY3QpOwoKRW1iZXIuQ29yZU9iamVjdCA9IENvcmVPYmplY3Q7Cgp9
        KSgpOwoKCgooZnVuY3Rpb24oKSB7Ci8qKgpAbW9kdWxlIGVtYmVyCkBzdWJt
        b2R1bGUgZW1iZXItcnVudGltZQoqLwoKLyoqCiAgYEVtYmVyLk9iamVjdGAg
        aXMgdGhlIG1haW4gYmFzZSBjbGFzcyBmb3IgYWxsIEVtYmVyIG9iamVjdHMu
        IEl0IGlzIGEgc3ViY2xhc3MKICBvZiBgRW1iZXIuQ29yZU9iamVjdGAgd2l0
        aCB0aGUgYEVtYmVyLk9ic2VydmFibGVgIG1peGluIGFwcGxpZWQuIEZvciBk
        ZXRhaWxzLAogIHNlZSB0aGUgZG9jdW1lbnRhdGlvbiBmb3IgZWFjaCBvZiB0
        aGVzZS4KCiAgQGNsYXNzIE9iamVjdAogIEBuYW1lc3BhY2UgRW1iZXIKICBA
        ZXh0ZW5kcyBFbWJlci5Db3JlT2JqZWN0CiAgQHVzZXMgRW1iZXIuT2JzZXJ2
        YWJsZQoqLwpFbWJlci5PYmplY3QgPSBFbWJlci5Db3JlT2JqZWN0LmV4dGVu
        ZChFbWJlci5PYnNlcnZhYmxlKTsKRW1iZXIuT2JqZWN0LnRvU3RyaW5nID0g
        ZnVuY3Rpb24oKSB7IHJldHVybiAiRW1iZXIuT2JqZWN0IjsgfTsKCn0pKCk7
        CgoKCihmdW5jdGlvbigpIHsKLyoqCkBtb2R1bGUgZW1iZXIKQHN1Ym1vZHVs
        ZSBlbWJlci1ydW50aW1lCiovCgp2YXIgZ2V0ID0gRW1iZXIuZ2V0LCBpbmRl
        eE9mID0gRW1iZXIuQXJyYXlQb2x5ZmlsbHMuaW5kZXhPZjsKCi8qKgogIEEg
        TmFtZXNwYWNlIGlzIGFuIG9iamVjdCB1c3VhbGx5IHVzZWQgdG8gY29udGFp
        biBvdGhlciBvYmplY3RzIG9yIG1ldGhvZHMKICBzdWNoIGFzIGFuIGFwcGxp
        Y2F0aW9uIG9yIGZyYW1ld29yay4gQ3JlYXRlIGEgbmFtZXNwYWNlIGFueXRp
        bWUgeW91IHdhbnQKICB0byBkZWZpbmUgb25lIG9mIHRoZXNlIG5ldyBjb250
        YWluZXJzLgoKICAjIEV4YW1wbGUgVXNhZ2UKCiAgYGBgamF2YXNjcmlwdAog
        IE15RnJhbWV3b3JrID0gRW1iZXIuTmFtZXNwYWNlLmNyZWF0ZSh7CiAgICBW
        RVJTSU9OOiAnMS4wLjAnCiAgfSk7CiAgYGBgCgogIEBjbGFzcyBOYW1lc3Bh
        Y2UKICBAbmFtZXNwYWNlIEVtYmVyCiAgQGV4dGVuZHMgRW1iZXIuT2JqZWN0
        CiovCnZhciBOYW1lc3BhY2UgPSBFbWJlci5OYW1lc3BhY2UgPSBFbWJlci5P
        YmplY3QuZXh0ZW5kKHsKICBpc05hbWVzcGFjZTogdHJ1ZSwKCiAgaW5pdDog
        ZnVuY3Rpb24oKSB7CiAgICBFbWJlci5OYW1lc3BhY2UuTkFNRVNQQUNFUy5w
        dXNoKHRoaXMpOwogICAgRW1iZXIuTmFtZXNwYWNlLlBST0NFU1NFRCA9IGZh
        bHNlOwogIH0sCgogIHRvU3RyaW5nOiBmdW5jdGlvbigpIHsKICAgIHZhciBu
        YW1lID0gZ2V0KHRoaXMsICduYW1lJyk7CiAgICBpZiAobmFtZSkgeyByZXR1
        cm4gbmFtZTsgfQoKICAgIGZpbmROYW1lc3BhY2VzKCk7CiAgICByZXR1cm4g
        dGhpc1tFbWJlci5HVUlEX0tFWSsnX25hbWUnXTsKICB9LAoKICBuYW1lQ2xh
        c3NlczogZnVuY3Rpb24oKSB7CiAgICBwcm9jZXNzTmFtZXNwYWNlKFt0aGlz
        LnRvU3RyaW5nKCldLCB0aGlzLCB7fSk7CiAgfSwKCiAgZGVzdHJveTogZnVu
        Y3Rpb24oKSB7CiAgICB2YXIgbmFtZXNwYWNlcyA9IEVtYmVyLk5hbWVzcGFj
        ZS5OQU1FU1BBQ0VTOwogICAgRW1iZXIubG9va3VwW3RoaXMudG9TdHJpbmco
        KV0gPSB1bmRlZmluZWQ7CiAgICBuYW1lc3BhY2VzLnNwbGljZShpbmRleE9m
        LmNhbGwobmFtZXNwYWNlcywgdGhpcyksIDEpOwogICAgdGhpcy5fc3VwZXIo
        KTsKICB9Cn0pOwoKTmFtZXNwYWNlLnJlb3BlbkNsYXNzKHsKICBOQU1FU1BB
        Q0VTOiBbRW1iZXJdLAogIE5BTUVTUEFDRVNfQllfSUQ6IHt9LAogIFBST0NF
        U1NFRDogZmFsc2UsCiAgcHJvY2Vzc0FsbDogcHJvY2Vzc0FsbE5hbWVzcGFj
        ZXMsCiAgYnlOYW1lOiBmdW5jdGlvbihuYW1lKSB7CiAgICBpZiAoIUVtYmVy
        LkJPT1RFRCkgewogICAgICBwcm9jZXNzQWxsTmFtZXNwYWNlcygpOwogICAg
        fQoKICAgIHJldHVybiBOQU1FU1BBQ0VTX0JZX0lEW25hbWVdOwogIH0KfSk7
        Cgp2YXIgTkFNRVNQQUNFU19CWV9JRCA9IE5hbWVzcGFjZS5OQU1FU1BBQ0VT
        X0JZX0lEOwoKdmFyIGhhc093blByb3AgPSAoe30pLmhhc093blByb3BlcnR5
        LAogICAgZ3VpZEZvciA9IEVtYmVyLmd1aWRGb3I7CgpmdW5jdGlvbiBwcm9j
        ZXNzTmFtZXNwYWNlKHBhdGhzLCByb290LCBzZWVuKSB7CiAgdmFyIGlkeCA9
        IHBhdGhzLmxlbmd0aDsKCiAgTkFNRVNQQUNFU19CWV9JRFtwYXRocy5qb2lu
        KCcuJyldID0gcm9vdDsKCiAgLy8gTG9vcCBvdmVyIGFsbCBvZiB0aGUga2V5
        cyBpbiB0aGUgbmFtZXNwYWNlLCBsb29raW5nIGZvciBjbGFzc2VzCiAgZm9y
        KHZhciBrZXkgaW4gcm9vdCkgewogICAgaWYgKCFoYXNPd25Qcm9wLmNhbGwo
        cm9vdCwga2V5KSkgeyBjb250aW51ZTsgfQogICAgdmFyIG9iaiA9IHJvb3Rb
        a2V5XTsKCiAgICAvLyBJZiB3ZSBhcmUgcHJvY2Vzc2luZyB0aGUgYEVtYmVy
        YCBuYW1lc3BhY2UsIGZvciBleGFtcGxlLCB0aGUKICAgIC8vIGBwYXRoc2Ag
        d2lsbCBzdGFydCB3aXRoIGBbIkVtYmVyIl1gLiBFdmVyeSBpdGVyYXRpb24g
        dGhyb3VnaAogICAgLy8gdGhlIGxvb3Agd2lsbCB1cGRhdGUgdGhlICoqc2Vj
        b25kKiogZWxlbWVudCBvZiB0aGlzIGxpc3Qgd2l0aAogICAgLy8gdGhlIGtl
        eSwgc28gcHJvY2Vzc2luZyBgRW1iZXIuVmlld2Agd2lsbCBtYWtlIHRoZSBB
        cnJheQogICAgLy8gYFsnRW1iZXInLCAnVmlldyddYC4KICAgIHBhdGhzW2lk
        eF0gPSBrZXk7CgogICAgLy8gSWYgd2UgaGF2ZSBmb3VuZCBhbiB1bnByb2Nl
        c3NlZCBjbGFzcwogICAgaWYgKG9iaiAmJiBvYmoudG9TdHJpbmcgPT09IGNs
        YXNzVG9TdHJpbmcpIHsKICAgICAgLy8gUmVwbGFjZSB0aGUgY2xhc3MnIGB0
        b1N0cmluZ2Agd2l0aCB0aGUgZG90LXNlcGFyYXRlZCBwYXRoCiAgICAgIC8v
        IGFuZCBzZXQgaXRzIGBOQU1FX0tFWWAKICAgICAgb2JqLnRvU3RyaW5nID0g
        bWFrZVRvU3RyaW5nKHBhdGhzLmpvaW4oJy4nKSk7CiAgICAgIG9ialtOQU1F
        X0tFWV0gPSBwYXRocy5qb2luKCcuJyk7CgogICAgLy8gU3VwcG9ydCBuZXN0
        ZWQgbmFtZXNwYWNlcwogICAgfSBlbHNlIGlmIChvYmogJiYgb2JqLmlzTmFt
        ZXNwYWNlKSB7CiAgICAgIC8vIFNraXAgYWxpYXNlZCBuYW1lc3BhY2VzCiAg
        ICAgIGlmIChzZWVuW2d1aWRGb3Iob2JqKV0pIHsgY29udGludWU7IH0KICAg
        ICAgc2VlbltndWlkRm9yKG9iaildID0gdHJ1ZTsKCiAgICAgIC8vIFByb2Nl
        c3MgdGhlIGNoaWxkIG5hbWVzcGFjZQogICAgICBwcm9jZXNzTmFtZXNwYWNl
        KHBhdGhzLCBvYmosIHNlZW4pOwogICAgfQogIH0KCiAgcGF0aHMubGVuZ3Ro
        ID0gaWR4OyAvLyBjdXQgb3V0IGxhc3QgaXRlbQp9CgpmdW5jdGlvbiBmaW5k
        TmFtZXNwYWNlcygpIHsKICB2YXIgTmFtZXNwYWNlID0gRW1iZXIuTmFtZXNw
        YWNlLCBsb29rdXAgPSBFbWJlci5sb29rdXAsIG9iaiwgaXNOYW1lc3BhY2U7
        CgogIGlmIChOYW1lc3BhY2UuUFJPQ0VTU0VEKSB7IHJldHVybjsgfQoKICBm
        b3IgKHZhciBwcm9wIGluIGxvb2t1cCkgewogICAgLy8gVGhlc2UgZG9uJ3Qg
        cmFpc2UgZXhjZXB0aW9ucyBidXQgY2FuIGNhdXNlIHdhcm5pbmdzCiAgICBp
        ZiAocHJvcCA9PT0gInBhcmVudCIgfHwgcHJvcCA9PT0gInRvcCIgfHwgcHJv
        cCA9PT0gImZyYW1lRWxlbWVudCIgfHwgcHJvcCA9PT0gIndlYmtpdFN0b3Jh
        Z2VJbmZvIikgeyBjb250aW51ZTsgfQoKICAgIC8vICBnZXQod2luZG93Lmds
        b2JhbFN0b3JhZ2UsICdpc05hbWVzcGFjZScpIHdvdWxkIHRyeSB0byByZWFk
        IHRoZSBzdG9yYWdlIGZvciBkb21haW4gaXNOYW1lc3BhY2UgYW5kIGNhdXNl
        IGV4Y2VwdGlvbiBpbiBGaXJlZm94LgogICAgLy8gZ2xvYmFsU3RvcmFnZSBp
        cyBhIHN0b3JhZ2Ugb2Jzb2xldGVkIGJ5IHRoZSBXaGF0V0cgc3RvcmFnZSBz
        cGVjaWZpY2F0aW9uLiBTZWUgaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5v
        cmcvZW4vRE9NL1N0b3JhZ2UjZ2xvYmFsU3RvcmFnZQogICAgaWYgKHByb3Ag
        PT09ICJnbG9iYWxTdG9yYWdlIiAmJiBsb29rdXAuU3RvcmFnZUxpc3QgJiYg
        bG9va3VwLmdsb2JhbFN0b3JhZ2UgaW5zdGFuY2VvZiBsb29rdXAuU3RvcmFn
        ZUxpc3QpIHsgY29udGludWU7IH0KICAgIC8vIFVuZm9ydHVuYXRlbHksIHNv
        bWUgdmVyc2lvbnMgb2YgSUUgZG9uJ3Qgc3VwcG9ydCB3aW5kb3cuaGFzT3du
        UHJvcGVydHkKICAgIGlmIChsb29rdXAuaGFzT3duUHJvcGVydHkgJiYgIWxv
        b2t1cC5oYXNPd25Qcm9wZXJ0eShwcm9wKSkgeyBjb250aW51ZTsgfQoKICAg
        IC8vIEF0IHRpbWVzIHdlIGFyZSBub3QgYWxsb3dlZCB0byBhY2Nlc3MgY2Vy
        dGFpbiBwcm9wZXJ0aWVzIGZvciBzZWN1cml0eSByZWFzb25zLgogICAgLy8g
        VGhlcmUgYXJlIGFsc28gdGltZXMgd2hlcmUgZXZlbiBpZiB3ZSBjYW4gYWNj
        ZXNzIHRoZW0sIHdlIGFyZSBub3QgYWxsb3dlZCB0byBhY2Nlc3MgdGhlaXIg
        cHJvcGVydGllcy4KICAgIHRyeSB7CiAgICAgIG9iaiA9IEVtYmVyLmxvb2t1
        cFtwcm9wXTsKICAgICAgaXNOYW1lc3BhY2UgPSBvYmogJiYgb2JqLmlzTmFt
        ZXNwYWNlOwogICAgfSBjYXRjaCAoZSkgewogICAgICBjb250aW51ZTsKICAg
        IH0KCiAgICBpZiAoaXNOYW1lc3BhY2UpIHsKICAgICAgRW1iZXIuZGVwcmVj
        YXRlKCJOYW1lc3BhY2VzIHNob3VsZCBub3QgYmVnaW4gd2l0aCBsb3dlcmNh
        c2UuIiwgL15bQS1aXS8udGVzdChwcm9wKSk7CiAgICAgIG9ialtOQU1FX0tF
        WV0gPSBwcm9wOwogICAgfQogIH0KfQoKdmFyIE5BTUVfS0VZID0gRW1iZXIu
        TkFNRV9LRVkgPSBFbWJlci5HVUlEX0tFWSArICdfbmFtZSc7CgpmdW5jdGlv
        biBzdXBlckNsYXNzU3RyaW5nKG1peGluKSB7CiAgdmFyIHN1cGVyY2xhc3Mg
        PSBtaXhpbi5zdXBlcmNsYXNzOwogIGlmIChzdXBlcmNsYXNzKSB7CiAgICBp
        ZiAoc3VwZXJjbGFzc1tOQU1FX0tFWV0pIHsgcmV0dXJuIHN1cGVyY2xhc3Nb
        TkFNRV9LRVldOyB9CiAgICBlbHNlIHsgcmV0dXJuIHN1cGVyQ2xhc3NTdHJp
        bmcoc3VwZXJjbGFzcyk7IH0KICB9IGVsc2UgewogICAgcmV0dXJuOwogIH0K
        fQoKZnVuY3Rpb24gY2xhc3NUb1N0cmluZygpIHsKICBpZiAoIUVtYmVyLkJP
        T1RFRCAmJiAhdGhpc1tOQU1FX0tFWV0pIHsKICAgIHByb2Nlc3NBbGxOYW1l
        c3BhY2VzKCk7CiAgfQoKICB2YXIgcmV0OwoKICBpZiAodGhpc1tOQU1FX0tF
        WV0pIHsKICAgIHJldCA9IHRoaXNbTkFNRV9LRVldOwogIH0gZWxzZSBpZiAo
        dGhpcy5fdG9TdHJpbmcpIHsKICAgIHJldCA9IHRoaXMuX3RvU3RyaW5nOyAK
        ICB9IGVsc2UgewogICAgdmFyIHN0ciA9IHN1cGVyQ2xhc3NTdHJpbmcodGhp
        cyk7CiAgICBpZiAoc3RyKSB7CiAgICAgIHJldCA9ICIoc3ViY2xhc3Mgb2Yg
        IiArIHN0ciArICIpIjsKICAgIH0gZWxzZSB7CiAgICAgIHJldCA9ICIodW5r
        bm93biBtaXhpbikiOwogICAgfQogICAgdGhpcy50b1N0cmluZyA9IG1ha2VU
        b1N0cmluZyhyZXQpOwogIH0KCiAgcmV0dXJuIHJldDsKfQoKZnVuY3Rpb24g
        cHJvY2Vzc0FsbE5hbWVzcGFjZXMoKSB7CiAgdmFyIHVucHJvY2Vzc2VkTmFt
        ZXNwYWNlcyA9ICFOYW1lc3BhY2UuUFJPQ0VTU0VELAogICAgICB1bnByb2Nl
        c3NlZE1peGlucyA9IEVtYmVyLmFueVVucHJvY2Vzc2VkTWl4aW5zOwoKICBp
        ZiAodW5wcm9jZXNzZWROYW1lc3BhY2VzKSB7CiAgICBmaW5kTmFtZXNwYWNl
        cygpOwogICAgTmFtZXNwYWNlLlBST0NFU1NFRCA9IHRydWU7CiAgfQoKICBp
        ZiAodW5wcm9jZXNzZWROYW1lc3BhY2VzIHx8IHVucHJvY2Vzc2VkTWl4aW5z
        KSB7CiAgICB2YXIgbmFtZXNwYWNlcyA9IE5hbWVzcGFjZS5OQU1FU1BBQ0VT
        LCBuYW1lc3BhY2U7CiAgICBmb3IgKHZhciBpPTAsIGw9bmFtZXNwYWNlcy5s
        ZW5ndGg7IGk8bDsgaSsrKSB7CiAgICAgIG5hbWVzcGFjZSA9IG5hbWVzcGFj
        ZXNbaV07CiAgICAgIHByb2Nlc3NOYW1lc3BhY2UoW25hbWVzcGFjZS50b1N0
        cmluZygpXSwgbmFtZXNwYWNlLCB7fSk7CiAgICB9CgogICAgRW1iZXIuYW55
        VW5wcm9jZXNzZWRNaXhpbnMgPSBmYWxzZTsKICB9Cn0KCmZ1bmN0aW9uIG1h
        a2VUb1N0cmluZyhyZXQpIHsKICByZXR1cm4gZnVuY3Rpb24oKSB7IHJldHVy
        biByZXQ7IH07Cn0KCkVtYmVyLk1peGluLnByb3RvdHlwZS50b1N0cmluZyA9
        IGNsYXNzVG9TdHJpbmc7Cgp9KSgpOwoKCgooZnVuY3Rpb24oKSB7CkVtYmVy
        LkFwcGxpY2F0aW9uID0gRW1iZXIuTmFtZXNwYWNlLmV4dGVuZCgpOwoKfSko
        KTsKCgoKKGZ1bmN0aW9uKCkgewovKioKQG1vZHVsZSBlbWJlcgpAc3VibW9k
        dWxlIGVtYmVyLXJ1bnRpbWUKKi8KCnZhciBPVVRfT0ZfUkFOR0VfRVhDRVBU
        SU9OID0gIkluZGV4IG91dCBvZiByYW5nZSI7CnZhciBFTVBUWSA9IFtdOwoK
        dmFyIGdldCA9IEVtYmVyLmdldCwgc2V0ID0gRW1iZXIuc2V0OwoKLyoqCiAg
        QW4gQXJyYXlQcm94eSB3cmFwcyBhbnkgb3RoZXIgb2JqZWN0IHRoYXQgaW1w
        bGVtZW50cyBgRW1iZXIuQXJyYXlgIGFuZC9vcgogIGBFbWJlci5NdXRhYmxl
        QXJyYXksYCBmb3J3YXJkaW5nIGFsbCByZXF1ZXN0cy4gVGhpcyBtYWtlcyBp
        dCB2ZXJ5IHVzZWZ1bCBmb3IKICBhIG51bWJlciBvZiBiaW5kaW5nIHVzZSBj
        YXNlcyBvciBvdGhlciBjYXNlcyB3aGVyZSBiZWluZyBhYmxlIHRvIHN3YXAK
        ICBvdXQgdGhlIHVuZGVybHlpbmcgYXJyYXkgaXMgdXNlZnVsLgoKICBBIHNp
        bXBsZSBleGFtcGxlIG9mIHVzYWdlOgoKICBgYGBqYXZhc2NyaXB0CiAgdmFy
        IHBldHMgPSBbJ2RvZycsICdjYXQnLCAnZmlzaCddOwogIHZhciBhcCA9IEVt
        YmVyLkFycmF5UHJveHkuY3JlYXRlKHsgY29udGVudDogRW1iZXIuQShwZXRz
        KSB9KTsKCiAgYXAuZ2V0KCdmaXJzdE9iamVjdCcpOyAgICAgICAgICAgICAg
        ICAgICAgICAgIC8vICdkb2cnCiAgYXAuc2V0KCdjb250ZW50JywgWydhbW9l
        YmEnLCAncGFyYW1lY2l1bSddKTsKICBhcC5nZXQoJ2ZpcnN0T2JqZWN0Jyk7
        ICAgICAgICAgICAgICAgICAgICAgICAgLy8gJ2Ftb2ViYScKICBgYGAKCiAg
        VGhpcyBjbGFzcyBjYW4gYWxzbyBiZSB1c2VmdWwgYXMgYSBsYXllciB0byB0
        cmFuc2Zvcm0gdGhlIGNvbnRlbnRzIG9mCiAgYW4gYXJyYXksIGFzIHRoZXkg
        YXJlIGFjY2Vzc2VkLiBUaGlzIGNhbiBiZSBkb25lIGJ5IG92ZXJyaWRpbmcK
        ICBgb2JqZWN0QXRDb250ZW50YDoKCiAgYGBgamF2YXNjcmlwdAogIHZhciBw
        ZXRzID0gWydkb2cnLCAnY2F0JywgJ2Zpc2gnXTsKICB2YXIgYXAgPSBFbWJl
        ci5BcnJheVByb3h5LmNyZWF0ZSh7CiAgICAgIGNvbnRlbnQ6IEVtYmVyLkEo
        cGV0cyksCiAgICAgIG9iamVjdEF0Q29udGVudDogZnVuY3Rpb24oaWR4KSB7
        CiAgICAgICAgICByZXR1cm4gdGhpcy5nZXQoJ2NvbnRlbnQnKS5vYmplY3RB
        dChpZHgpLnRvVXBwZXJDYXNlKCk7CiAgICAgIH0KICB9KTsKCiAgYXAuZ2V0
        KCdmaXJzdE9iamVjdCcpOyAvLyAuICdET0cnCiAgYGBgCgogIEBjbGFzcyBB
        cnJheVByb3h5CiAgQG5hbWVzcGFjZSBFbWJlcgogIEBleHRlbmRzIEVtYmVy
        Lk9iamVjdAogIEB1c2VzIEVtYmVyLk11dGFibGVBcnJheQoqLwpFbWJlci5B
        cnJheVByb3h5ID0gRW1iZXIuT2JqZWN0LmV4dGVuZChFbWJlci5NdXRhYmxl
        QXJyYXksLyoqIEBzY29wZSBFbWJlci5BcnJheVByb3h5LnByb3RvdHlwZSAq
        LyB7CgogIC8qKgogICAgVGhlIGNvbnRlbnQgYXJyYXkuIE11c3QgYmUgYW4g
        b2JqZWN0IHRoYXQgaW1wbGVtZW50cyBgRW1iZXIuQXJyYXlgIGFuZC9vcgog
        ICAgYEVtYmVyLk11dGFibGVBcnJheS5gCgogICAgQHByb3BlcnR5IGNvbnRl
        bnQKICAgIEB0eXBlIEVtYmVyLkFycmF5CiAgKi8KICBjb250ZW50OiBudWxs
        LAoKICAvKioKICAgVGhlIGFycmF5IHRoYXQgdGhlIHByb3h5IHByZXRlbmRz
        IHRvIGJlLiBJbiB0aGUgZGVmYXVsdCBgQXJyYXlQcm94eWAKICAgaW1wbGVt
        ZW50YXRpb24sIHRoaXMgYW5kIGBjb250ZW50YCBhcmUgdGhlIHNhbWUuIFN1
        YmNsYXNzZXMgb2YgYEFycmF5UHJveHlgCiAgIGNhbiBvdmVycmlkZSB0aGlz
        IHByb3BlcnR5IHRvIHByb3ZpZGUgdGhpbmdzIGxpa2Ugc29ydGluZyBhbmQg
        ZmlsdGVyaW5nLgoKICAgQHByb3BlcnR5IGFycmFuZ2VkQ29udGVudAogICov
        CiAgYXJyYW5nZWRDb250ZW50OiBFbWJlci5jb21wdXRlZC5hbGlhcygnY29u
        dGVudCcpLAoKICAvKioKICAgIFNob3VsZCBhY3R1YWxseSByZXRyaWV2ZSB0
        aGUgb2JqZWN0IGF0IHRoZSBzcGVjaWZpZWQgaW5kZXggZnJvbSB0aGUKICAg
        IGNvbnRlbnQuIFlvdSBjYW4gb3ZlcnJpZGUgdGhpcyBtZXRob2QgaW4gc3Vi
        Y2xhc3NlcyB0byB0cmFuc2Zvcm0gdGhlCiAgICBjb250ZW50IGl0ZW0gdG8g
        c29tZXRoaW5nIG5ldy4KCiAgICBUaGlzIG1ldGhvZCB3aWxsIG9ubHkgYmUg
        Y2FsbGVkIGlmIGNvbnRlbnQgaXMgbm9uLWBudWxsYC4KCiAgICBAbWV0aG9k
        IG9iamVjdEF0Q29udGVudAogICAgQHBhcmFtIHtOdW1iZXJ9IGlkeCBUaGUg
        aW5kZXggdG8gcmV0cmlldmUuCiAgICBAcmV0dXJuIHtPYmplY3R9IHRoZSB2
        YWx1ZSBvciB1bmRlZmluZWQgaWYgbm9uZSBmb3VuZAogICovCiAgb2JqZWN0
        QXRDb250ZW50OiBmdW5jdGlvbihpZHgpIHsKICAgIHJldHVybiBnZXQodGhp
        cywgJ2FycmFuZ2VkQ29udGVudCcpLm9iamVjdEF0KGlkeCk7CiAgfSwKCiAg
        LyoqCiAgICBTaG91bGQgYWN0dWFsbHkgcmVwbGFjZSB0aGUgc3BlY2lmaWVk
        IG9iamVjdHMgb24gdGhlIGNvbnRlbnQgYXJyYXkuCiAgICBZb3UgY2FuIG92
        ZXJyaWRlIHRoaXMgbWV0aG9kIGluIHN1YmNsYXNzZXMgdG8gdHJhbnNmb3Jt
        IHRoZSBjb250ZW50IGl0ZW0KICAgIGludG8gc29tZXRoaW5nIG5ldy4KCiAg
        ICBUaGlzIG1ldGhvZCB3aWxsIG9ubHkgYmUgY2FsbGVkIGlmIGNvbnRlbnQg
        aXMgbm9uLWBudWxsYC4KCiAgICBAbWV0aG9kIHJlcGxhY2VDb250ZW50CiAg
        ICBAcGFyYW0ge051bWJlcn0gaWR4IFRoZSBzdGFydGluZyBpbmRleAogICAg
        QHBhcmFtIHtOdW1iZXJ9IGFtdCBUaGUgbnVtYmVyIG9mIGl0ZW1zIHRvIHJl
        bW92ZSBmcm9tIHRoZSBjb250ZW50LgogICAgQHBhcmFtIHtBcnJheX0gb2Jq
        ZWN0cyBPcHRpb25hbCBhcnJheSBvZiBvYmplY3RzIHRvIGluc2VydCBvciBu
        dWxsIGlmIG5vCiAgICAgIG9iamVjdHMuCiAgICBAcmV0dXJuIHt2b2lkfQog
        ICovCiAgcmVwbGFjZUNvbnRlbnQ6IGZ1bmN0aW9uKGlkeCwgYW10LCBvYmpl
        Y3RzKSB7CiAgICBnZXQodGhpcywgJ2NvbnRlbnQnKS5yZXBsYWNlKGlkeCwg
        YW10LCBvYmplY3RzKTsKICB9LAoKICAvKioKICAgIEBwcml2YXRlCgogICAg
        SW52b2tlZCB3aGVuIHRoZSBjb250ZW50IHByb3BlcnR5IGlzIGFib3V0IHRv
        IGNoYW5nZS4gTm90aWZpZXMgb2JzZXJ2ZXJzIHRoYXQgdGhlCiAgICBlbnRp
        cmUgYXJyYXkgY29udGVudCB3aWxsIGNoYW5nZS4KCiAgICBAbWV0aG9kIF9j
        b250ZW50V2lsbENoYW5nZQogICovCiAgX2NvbnRlbnRXaWxsQ2hhbmdlOiBF
        bWJlci5iZWZvcmVPYnNlcnZlcihmdW5jdGlvbigpIHsKICAgIHRoaXMuX3Rl
        YXJkb3duQ29udGVudCgpOwogIH0sICdjb250ZW50JyksCgogIF90ZWFyZG93
        bkNvbnRlbnQ6IGZ1bmN0aW9uKCkgewogICAgdmFyIGNvbnRlbnQgPSBnZXQo
        dGhpcywgJ2NvbnRlbnQnKTsKCiAgICBpZiAoY29udGVudCkgewogICAgICBj
        b250ZW50LnJlbW92ZUFycmF5T2JzZXJ2ZXIodGhpcywgewogICAgICAgIHdp
        bGxDaGFuZ2U6ICdjb250ZW50QXJyYXlXaWxsQ2hhbmdlJywKICAgICAgICBk
        aWRDaGFuZ2U6ICdjb250ZW50QXJyYXlEaWRDaGFuZ2UnCiAgICAgIH0pOwog
        ICAgfQogIH0sCgogIGNvbnRlbnRBcnJheVdpbGxDaGFuZ2U6IEVtYmVyLkss
        CiAgY29udGVudEFycmF5RGlkQ2hhbmdlOiBFbWJlci5LLAoKICAvKioKICAg
        IEBwcml2YXRlCgogICAgSW52b2tlZCB3aGVuIHRoZSBjb250ZW50IHByb3Bl
        cnR5IGNoYW5nZXMuIE5vdGlmaWVzIG9ic2VydmVycyB0aGF0IHRoZQogICAg
        ZW50aXJlIGFycmF5IGNvbnRlbnQgaGFzIGNoYW5nZWQuCgogICAgQG1ldGhv
        ZCBfY29udGVudERpZENoYW5nZQogICovCiAgX2NvbnRlbnREaWRDaGFuZ2U6
        IEVtYmVyLm9ic2VydmVyKGZ1bmN0aW9uKCkgewogICAgdmFyIGNvbnRlbnQg
        PSBnZXQodGhpcywgJ2NvbnRlbnQnKTsKCiAgICBFbWJlci5hc3NlcnQoIkNh
        bid0IHNldCBBcnJheVByb3h5J3MgY29udGVudCB0byBpdHNlbGYiLCBjb250
        ZW50ICE9PSB0aGlzKTsKCiAgICB0aGlzLl9zZXR1cENvbnRlbnQoKTsKICB9
        LCAnY29udGVudCcpLAoKICBfc2V0dXBDb250ZW50OiBmdW5jdGlvbigpIHsK
        ICAgIHZhciBjb250ZW50ID0gZ2V0KHRoaXMsICdjb250ZW50Jyk7CgogICAg
        aWYgKGNvbnRlbnQpIHsKICAgICAgY29udGVudC5hZGRBcnJheU9ic2VydmVy
        KHRoaXMsIHsKICAgICAgICB3aWxsQ2hhbmdlOiAnY29udGVudEFycmF5V2ls
        bENoYW5nZScsCiAgICAgICAgZGlkQ2hhbmdlOiAnY29udGVudEFycmF5RGlk
        Q2hhbmdlJwogICAgICB9KTsKICAgIH0KICB9LAoKICBfYXJyYW5nZWRDb250
        ZW50V2lsbENoYW5nZTogRW1iZXIuYmVmb3JlT2JzZXJ2ZXIoZnVuY3Rpb24o
        KSB7CiAgICB2YXIgYXJyYW5nZWRDb250ZW50ID0gZ2V0KHRoaXMsICdhcnJh
        bmdlZENvbnRlbnQnKSwKICAgICAgICBsZW4gPSBhcnJhbmdlZENvbnRlbnQg
        PyBnZXQoYXJyYW5nZWRDb250ZW50LCAnbGVuZ3RoJykgOiAwOwoKICAgIHRo
        aXMuYXJyYW5nZWRDb250ZW50QXJyYXlXaWxsQ2hhbmdlKHRoaXMsIDAsIGxl
        biwgdW5kZWZpbmVkKTsKICAgIHRoaXMuYXJyYW5nZWRDb250ZW50V2lsbENo
        YW5nZSh0aGlzKTsKCiAgICB0aGlzLl90ZWFyZG93bkFycmFuZ2VkQ29udGVu
        dChhcnJhbmdlZENvbnRlbnQpOwogIH0sICdhcnJhbmdlZENvbnRlbnQnKSwK
        CiAgX2FycmFuZ2VkQ29udGVudERpZENoYW5nZTogRW1iZXIub2JzZXJ2ZXIo
        ZnVuY3Rpb24oKSB7CiAgICB2YXIgYXJyYW5nZWRDb250ZW50ID0gZ2V0KHRo
        aXMsICdhcnJhbmdlZENvbnRlbnQnKSwKICAgICAgICBsZW4gPSBhcnJhbmdl
        ZENvbnRlbnQgPyBnZXQoYXJyYW5nZWRDb250ZW50LCAnbGVuZ3RoJykgOiAw
        OwoKICAgIEVtYmVyLmFzc2VydCgiQ2FuJ3Qgc2V0IEFycmF5UHJveHkncyBj
        b250ZW50IHRvIGl0c2VsZiIsIGFycmFuZ2VkQ29udGVudCAhPT0gdGhpcyk7
        CgogICAgdGhpcy5fc2V0dXBBcnJhbmdlZENvbnRlbnQoKTsKCiAgICB0aGlz
        LmFycmFuZ2VkQ29udGVudERpZENoYW5nZSh0aGlzKTsKICAgIHRoaXMuYXJy
        YW5nZWRDb250ZW50QXJyYXlEaWRDaGFuZ2UodGhpcywgMCwgdW5kZWZpbmVk
        LCBsZW4pOwogIH0sICdhcnJhbmdlZENvbnRlbnQnKSwKCiAgX3NldHVwQXJy
        YW5nZWRDb250ZW50OiBmdW5jdGlvbigpIHsKICAgIHZhciBhcnJhbmdlZENv
        bnRlbnQgPSBnZXQodGhpcywgJ2FycmFuZ2VkQ29udGVudCcpOwoKICAgIGlm
        IChhcnJhbmdlZENvbnRlbnQpIHsKICAgICAgYXJyYW5nZWRDb250ZW50LmFk
        ZEFycmF5T2JzZXJ2ZXIodGhpcywgewogICAgICAgIHdpbGxDaGFuZ2U6ICdh
        cnJhbmdlZENvbnRlbnRBcnJheVdpbGxDaGFuZ2UnLAogICAgICAgIGRpZENo
        YW5nZTogJ2FycmFuZ2VkQ29udGVudEFycmF5RGlkQ2hhbmdlJwogICAgICB9
        KTsKICAgIH0KICB9LAoKICBfdGVhcmRvd25BcnJhbmdlZENvbnRlbnQ6IGZ1
        bmN0aW9uKCkgewogICAgdmFyIGFycmFuZ2VkQ29udGVudCA9IGdldCh0aGlz
        LCAnYXJyYW5nZWRDb250ZW50Jyk7CgogICAgaWYgKGFycmFuZ2VkQ29udGVu
        dCkgewogICAgICBhcnJhbmdlZENvbnRlbnQucmVtb3ZlQXJyYXlPYnNlcnZl
        cih0aGlzLCB7CiAgICAgICAgd2lsbENoYW5nZTogJ2FycmFuZ2VkQ29udGVu
        dEFycmF5V2lsbENoYW5nZScsCiAgICAgICAgZGlkQ2hhbmdlOiAnYXJyYW5n
        ZWRDb250ZW50QXJyYXlEaWRDaGFuZ2UnCiAgICAgIH0pOwogICAgfQogIH0s
        CgogIGFycmFuZ2VkQ29udGVudFdpbGxDaGFuZ2U6IEVtYmVyLkssCiAgYXJy
        YW5nZWRDb250ZW50RGlkQ2hhbmdlOiBFbWJlci5LLAoKICBvYmplY3RBdDog
        ZnVuY3Rpb24oaWR4KSB7CiAgICByZXR1cm4gZ2V0KHRoaXMsICdjb250ZW50
        JykgJiYgdGhpcy5vYmplY3RBdENvbnRlbnQoaWR4KTsKICB9LAoKICBsZW5n
        dGg6IEVtYmVyLmNvbXB1dGVkKGZ1bmN0aW9uKCkgewogICAgdmFyIGFycmFu
        Z2VkQ29udGVudCA9IGdldCh0aGlzLCAnYXJyYW5nZWRDb250ZW50Jyk7CiAg
        ICByZXR1cm4gYXJyYW5nZWRDb250ZW50ID8gZ2V0KGFycmFuZ2VkQ29udGVu
        dCwgJ2xlbmd0aCcpIDogMDsKICAgIC8vIE5vIGRlcGVuZGVuY2llcyBzaW5j
        ZSBFbnVtZXJhYmxlIG5vdGlmaWVzIGxlbmd0aCBvZiBjaGFuZ2UKICB9KSwK
        CiAgX3JlcGxhY2U6IGZ1bmN0aW9uKGlkeCwgYW10LCBvYmplY3RzKSB7CiAg
        ICB2YXIgY29udGVudCA9IGdldCh0aGlzLCAnY29udGVudCcpOwogICAgRW1i
        ZXIuYXNzZXJ0KCdUaGUgY29udGVudCBwcm9wZXJ0eSBvZiAnKyB0aGlzLmNv
        bnN0cnVjdG9yICsgJyBzaG91bGQgYmUgc2V0IGJlZm9yZSBtb2RpZnlpbmcg
        aXQnLCBjb250ZW50KTsKICAgIGlmIChjb250ZW50KSB0aGlzLnJlcGxhY2VD
        b250ZW50KGlkeCwgYW10LCBvYmplY3RzKTsKICAgIHJldHVybiB0aGlzOwog
        IH0sCgogIHJlcGxhY2U6IGZ1bmN0aW9uKCkgewogICAgaWYgKGdldCh0aGlz
        LCAnYXJyYW5nZWRDb250ZW50JykgPT09IGdldCh0aGlzLCAnY29udGVudCcp
        KSB7CiAgICAgIHRoaXMuX3JlcGxhY2UuYXBwbHkodGhpcywgYXJndW1lbnRz
        KTsKICAgIH0gZWxzZSB7CiAgICAgIHRocm93IG5ldyBFbWJlci5FcnJvcigi
        VXNpbmcgcmVwbGFjZSBvbiBhbiBhcnJhbmdlZCBBcnJheVByb3h5IGlzIG5v
        dCBhbGxvd2VkLiIpOwogICAgfQogIH0sCgogIF9pbnNlcnRBdDogZnVuY3Rp
        b24oaWR4LCBvYmplY3QpIHsKICAgIGlmIChpZHggPiBnZXQodGhpcywgJ2Nv
        bnRlbnQubGVuZ3RoJykpIHRocm93IG5ldyBFbWJlci5FcnJvcihPVVRfT0Zf
        UkFOR0VfRVhDRVBUSU9OKTsKICAgIHRoaXMuX3JlcGxhY2UoaWR4LCAwLCBb
        b2JqZWN0XSk7CiAgICByZXR1cm4gdGhpczsKICB9LAoKICBpbnNlcnRBdDog
        ZnVuY3Rpb24oaWR4LCBvYmplY3QpIHsKICAgIGlmIChnZXQodGhpcywgJ2Fy
        cmFuZ2VkQ29udGVudCcpID09PSBnZXQodGhpcywgJ2NvbnRlbnQnKSkgewog
        ICAgICByZXR1cm4gdGhpcy5faW5zZXJ0QXQoaWR4LCBvYmplY3QpOwogICAg
        fSBlbHNlIHsKICAgICAgdGhyb3cgbmV3IEVtYmVyLkVycm9yKCJVc2luZyBp
        bnNlcnRBdCBvbiBhbiBhcnJhbmdlZCBBcnJheVByb3h5IGlzIG5vdCBhbGxv
        d2VkLiIpOwogICAgfQogIH0sCgogIHJlbW92ZUF0OiBmdW5jdGlvbihzdGFy
        dCwgbGVuKSB7CiAgICBpZiAoJ251bWJlcicgPT09IHR5cGVvZiBzdGFydCkg
        ewogICAgICB2YXIgY29udGVudCA9IGdldCh0aGlzLCAnY29udGVudCcpLAog
        ICAgICAgICAgYXJyYW5nZWRDb250ZW50ID0gZ2V0KHRoaXMsICdhcnJhbmdl
        ZENvbnRlbnQnKSwKICAgICAgICAgIGluZGljZXMgPSBbXSwgaTsKCiAgICAg
        IGlmICgoc3RhcnQgPCAwKSB8fCAoc3RhcnQgPj0gZ2V0KHRoaXMsICdsZW5n
        dGgnKSkpIHsKICAgICAgICB0aHJvdyBuZXcgRW1iZXIuRXJyb3IoT1VUX09G
        X1JBTkdFX0VYQ0VQVElPTik7CiAgICAgIH0KCiAgICAgIGlmIChsZW4gPT09
        IHVuZGVmaW5lZCkgbGVuID0gMTsKCiAgICAgIC8vIEdldCBhIGxpc3Qgb2Yg
        aW5kaWNlcyBpbiBvcmlnaW5hbCBjb250ZW50IHRvIHJlbW92ZQogICAgICBm
        b3IgKGk9c3RhcnQ7IGk8c3RhcnQrbGVuOyBpKyspIHsKICAgICAgICAvLyBV
        c2UgYXJyYW5nZWRDb250ZW50IGhlcmUgc28gd2UgYXZvaWQgY29uZnVzaW9u
        IHdpdGggb2JqZWN0cyB0cmFuc2Zvcm1lZCBieSBvYmplY3RBdENvbnRlbnQK
        ICAgICAgICBpbmRpY2VzLnB1c2goY29udGVudC5pbmRleE9mKGFycmFuZ2Vk
        Q29udGVudC5vYmplY3RBdChpKSkpOwogICAgICB9CgogICAgICAvLyBSZXBs
        YWNlIGluIHJldmVyc2Ugb3JkZXIgc2luY2UgaW5kaWNlcyB3aWxsIGNoYW5n
        ZQogICAgICBpbmRpY2VzLnNvcnQoZnVuY3Rpb24oYSxiKSB7IHJldHVybiBi
        IC0gYTsgfSk7CgogICAgICBFbWJlci5iZWdpblByb3BlcnR5Q2hhbmdlcygp
        OwogICAgICBmb3IgKGk9MDsgaTxpbmRpY2VzLmxlbmd0aDsgaSsrKSB7CiAg
        ICAgICAgdGhpcy5fcmVwbGFjZShpbmRpY2VzW2ldLCAxLCBFTVBUWSk7CiAg
        ICAgIH0KICAgICAgRW1iZXIuZW5kUHJvcGVydHlDaGFuZ2VzKCk7CiAgICB9
        CgogICAgcmV0dXJuIHRoaXMgOwogIH0sCgogIHB1c2hPYmplY3Q6IGZ1bmN0
        aW9uKG9iaikgewogICAgdGhpcy5faW5zZXJ0QXQoZ2V0KHRoaXMsICdjb250
        ZW50Lmxlbmd0aCcpLCBvYmopIDsKICAgIHJldHVybiBvYmogOwogIH0sCgog
        IHB1c2hPYmplY3RzOiBmdW5jdGlvbihvYmplY3RzKSB7CiAgICBpZiAoIShF
        bWJlci5FbnVtZXJhYmxlLmRldGVjdChvYmplY3RzKSB8fCBFbWJlci5pc0Fy
        cmF5KG9iamVjdHMpKSkgewogICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCJN
        dXN0IHBhc3MgRW1iZXIuRW51bWVyYWJsZSB0byBFbWJlci5NdXRhYmxlQXJy
        YXkjcHVzaE9iamVjdHMiKTsKICAgIH0KICAgIHRoaXMuX3JlcGxhY2UoZ2V0
        KHRoaXMsICdsZW5ndGgnKSwgMCwgb2JqZWN0cyk7CiAgICByZXR1cm4gdGhp
        czsKICB9LAoKICBzZXRPYmplY3RzOiBmdW5jdGlvbihvYmplY3RzKSB7CiAg
        ICBpZiAob2JqZWN0cy5sZW5ndGggPT09IDApIHJldHVybiB0aGlzLmNsZWFy
        KCk7CgogICAgdmFyIGxlbiA9IGdldCh0aGlzLCAnbGVuZ3RoJyk7CiAgICB0
        aGlzLl9yZXBsYWNlKDAsIGxlbiwgb2JqZWN0cyk7CiAgICByZXR1cm4gdGhp
        czsKICB9LAoKICB1bnNoaWZ0T2JqZWN0OiBmdW5jdGlvbihvYmopIHsKICAg
        IHRoaXMuX2luc2VydEF0KDAsIG9iaikgOwogICAgcmV0dXJuIG9iaiA7CiAg
        fSwKCiAgdW5zaGlmdE9iamVjdHM6IGZ1bmN0aW9uKG9iamVjdHMpIHsKICAg
        IHRoaXMuX3JlcGxhY2UoMCwgMCwgb2JqZWN0cyk7CiAgICByZXR1cm4gdGhp
        czsKICB9LAoKICBzbGljZTogZnVuY3Rpb24oKSB7CiAgICB2YXIgYXJyID0g
        dGhpcy50b0FycmF5KCk7CiAgICByZXR1cm4gYXJyLnNsaWNlLmFwcGx5KGFy
        ciwgYXJndW1lbnRzKTsKICB9LAoKICBhcnJhbmdlZENvbnRlbnRBcnJheVdp
        bGxDaGFuZ2U6IGZ1bmN0aW9uKGl0ZW0sIGlkeCwgcmVtb3ZlZENudCwgYWRk
        ZWRDbnQpIHsKICAgIHRoaXMuYXJyYXlDb250ZW50V2lsbENoYW5nZShpZHgs
        IHJlbW92ZWRDbnQsIGFkZGVkQ250KTsKICB9LAoKICBhcnJhbmdlZENvbnRl
        bnRBcnJheURpZENoYW5nZTogZnVuY3Rpb24oaXRlbSwgaWR4LCByZW1vdmVk
        Q250LCBhZGRlZENudCkgewogICAgdGhpcy5hcnJheUNvbnRlbnREaWRDaGFu
        Z2UoaWR4LCByZW1vdmVkQ250LCBhZGRlZENudCk7CiAgfSwKCiAgaW5pdDog
        ZnVuY3Rpb24oKSB7CiAgICB0aGlzLl9zdXBlcigpOwogICAgdGhpcy5fc2V0
        dXBDb250ZW50KCk7CiAgICB0aGlzLl9zZXR1cEFycmFuZ2VkQ29udGVudCgp
        OwogIH0sCgogIHdpbGxEZXN0cm95OiBmdW5jdGlvbigpIHsKICAgIHRoaXMu
        X3RlYXJkb3duQXJyYW5nZWRDb250ZW50KCk7CiAgICB0aGlzLl90ZWFyZG93
        bkNvbnRlbnQoKTsKICB9Cn0pOwoKfSkoKTsKCgoKKGZ1bmN0aW9uKCkgewov
        KioKQG1vZHVsZSBlbWJlcgpAc3VibW9kdWxlIGVtYmVyLXJ1bnRpbWUKKi8K
        CnZhciBnZXQgPSBFbWJlci5nZXQsCiAgICBzZXQgPSBFbWJlci5zZXQsCiAg
        ICBmbXQgPSBFbWJlci5TdHJpbmcuZm10LAogICAgYWRkQmVmb3JlT2JzZXJ2
        ZXIgPSBFbWJlci5hZGRCZWZvcmVPYnNlcnZlciwKICAgIGFkZE9ic2VydmVy
        ID0gRW1iZXIuYWRkT2JzZXJ2ZXIsCiAgICByZW1vdmVCZWZvcmVPYnNlcnZl
        ciA9IEVtYmVyLnJlbW92ZUJlZm9yZU9ic2VydmVyLAogICAgcmVtb3ZlT2Jz
        ZXJ2ZXIgPSBFbWJlci5yZW1vdmVPYnNlcnZlciwKICAgIHByb3BlcnR5V2ls
        bENoYW5nZSA9IEVtYmVyLnByb3BlcnR5V2lsbENoYW5nZSwKICAgIHByb3Bl
        cnR5RGlkQ2hhbmdlID0gRW1iZXIucHJvcGVydHlEaWRDaGFuZ2UsCiAgICBt
        ZXRhID0gRW1iZXIubWV0YSwKICAgIGRlZmluZVByb3BlcnR5ID0gRW1iZXIu
        ZGVmaW5lUHJvcGVydHk7CgpmdW5jdGlvbiBjb250ZW50UHJvcGVydHlXaWxs
        Q2hhbmdlKGNvbnRlbnQsIGNvbnRlbnRLZXkpIHsKICB2YXIga2V5ID0gY29u
        dGVudEtleS5zbGljZSg4KTsgLy8gcmVtb3ZlICJjb250ZW50LiIKICBpZiAo
        a2V5IGluIHRoaXMpIHsgcmV0dXJuOyB9ICAvLyBpZiBzaGFkb3dlZCBpbiBw
        cm94eQogIHByb3BlcnR5V2lsbENoYW5nZSh0aGlzLCBrZXkpOwp9CgpmdW5j
        dGlvbiBjb250ZW50UHJvcGVydHlEaWRDaGFuZ2UoY29udGVudCwgY29udGVu
        dEtleSkgewogIHZhciBrZXkgPSBjb250ZW50S2V5LnNsaWNlKDgpOyAvLyBy
        ZW1vdmUgImNvbnRlbnQuIgogIGlmIChrZXkgaW4gdGhpcykgeyByZXR1cm47
        IH0gLy8gaWYgc2hhZG93ZWQgaW4gcHJveHkKICBwcm9wZXJ0eURpZENoYW5n
        ZSh0aGlzLCBrZXkpOwp9CgovKioKICBgRW1iZXIuT2JqZWN0UHJveHlgIGZv
        cndhcmRzIGFsbCBwcm9wZXJ0aWVzIG5vdCBkZWZpbmVkIGJ5IHRoZSBwcm94
        eSBpdHNlbGYKICB0byBhIHByb3hpZWQgYGNvbnRlbnRgIG9iamVjdC4KCiAg
        YGBgamF2YXNjcmlwdAogIG9iamVjdCA9IEVtYmVyLk9iamVjdC5jcmVhdGUo
        ewogICAgbmFtZTogJ0ZvbycKICB9KTsKCiAgcHJveHkgPSBFbWJlci5PYmpl
        Y3RQcm94eS5jcmVhdGUoewogICAgY29udGVudDogb2JqZWN0CiAgfSk7Cgog
        IC8vIEFjY2VzcyBhbmQgY2hhbmdlIGV4aXN0aW5nIHByb3BlcnRpZXMKICBw
        cm94eS5nZXQoJ25hbWUnKSAgICAgICAgICAvLyAnRm9vJwogIHByb3h5LnNl
        dCgnbmFtZScsICdCYXInKTsKICBvYmplY3QuZ2V0KCduYW1lJykgICAgICAg
        ICAvLyAnQmFyJwoKICAvLyBDcmVhdGUgbmV3ICdkZXNjcmlwdGlvbicgcHJv
        cGVydHkgb24gYG9iamVjdGAKICBwcm94eS5zZXQoJ2Rlc2NyaXB0aW9uJywg
        J0ZvbyBpcyBhIHdoaXpib28gYmF6Jyk7CiAgb2JqZWN0LmdldCgnZGVzY3Jp
        cHRpb24nKSAgLy8gJ0ZvbyBpcyBhIHdoaXpib28gYmF6JwogIGBgYAoKICBX
        aGlsZSBgY29udGVudGAgaXMgdW5zZXQsIHNldHRpbmcgYSBwcm9wZXJ0eSB0
        byBiZSBkZWxlZ2F0ZWQgd2lsbCB0aHJvdyBhbgogIEVycm9yLgoKICBgYGBq
        YXZhc2NyaXB0CiAgcHJveHkgPSBFbWJlci5PYmplY3RQcm94eS5jcmVhdGUo
        ewogICAgY29udGVudDogbnVsbCwKICAgIGZsYWc6IG51bGwKICB9KTsKICBw
        cm94eS5zZXQoJ2ZsYWcnLCB0cnVlKTsKICBwcm94eS5nZXQoJ2ZsYWcnKTsg
        ICAgICAgICAvLyB0cnVlCiAgcHJveHkuZ2V0KCdmb28nKTsgICAgICAgICAg
        Ly8gdW5kZWZpbmVkCiAgcHJveHkuc2V0KCdmb28nLCAnZGF0YScpOyAgLy8g
        dGhyb3dzIEVycm9yCiAgYGBgCgogIERlbGVnYXRlZCBwcm9wZXJ0aWVzIGNh
        biBiZSBib3VuZCB0byBhbmQgd2lsbCBjaGFuZ2Ugd2hlbiBjb250ZW50IGlz
        IHVwZGF0ZWQuCgogIENvbXB1dGVkIHByb3BlcnRpZXMgb24gdGhlIHByb3h5
        IGl0c2VsZiBjYW4gZGVwZW5kIG9uIGRlbGVnYXRlZCBwcm9wZXJ0aWVzLgoK
        ICBgYGBqYXZhc2NyaXB0CiAgUHJveHlXaXRoQ29tcHV0ZWRQcm9wZXJ0eSA9
        IEVtYmVyLk9iamVjdFByb3h5LmV4dGVuZCh7CiAgICBmdWxsTmFtZTogZnVu
        Y3Rpb24gKCkgewogICAgICB2YXIgZmlyc3ROYW1lID0gdGhpcy5nZXQoJ2Zp
        cnN0TmFtZScpLAogICAgICAgICAgbGFzdE5hbWUgPSB0aGlzLmdldCgnbGFz
        dE5hbWUnKTsKICAgICAgaWYgKGZpcnN0TmFtZSAmJiBsYXN0TmFtZSkgewog
        ICAgICAgIHJldHVybiBmaXJzdE5hbWUgKyAnICcgKyBsYXN0TmFtZTsKICAg
        ICAgfQogICAgICByZXR1cm4gZmlyc3ROYW1lIHx8IGxhc3ROYW1lOwogICAg
        fS5wcm9wZXJ0eSgnZmlyc3ROYW1lJywgJ2xhc3ROYW1lJykKICB9KTsKCiAg
        cHJveHkgPSBQcm94eVdpdGhDb21wdXRlZFByb3BlcnR5LmNyZWF0ZSgpOwoK
        ICBwcm94eS5nZXQoJ2Z1bGxOYW1lJyk7ICAvLyB1bmRlZmluZWQKICBwcm94
        eS5zZXQoJ2NvbnRlbnQnLCB7CiAgICBmaXJzdE5hbWU6ICdUb20nLCBsYXN0
        TmFtZTogJ0RhbGUnCiAgfSk7IC8vIHRyaWdnZXJzIHByb3BlcnR5IGNoYW5n
        ZSBmb3IgZnVsbE5hbWUgb24gcHJveHkKCiAgcHJveHkuZ2V0KCdmdWxsTmFt
        ZScpOyAgLy8gJ1RvbSBEYWxlJwogIGBgYAoKICBAY2xhc3MgT2JqZWN0UHJv
        eHkKICBAbmFtZXNwYWNlIEVtYmVyCiAgQGV4dGVuZHMgRW1iZXIuT2JqZWN0
        CiovCkVtYmVyLk9iamVjdFByb3h5ID0gRW1iZXIuT2JqZWN0LmV4dGVuZCgv
        KiogQHNjb3BlIEVtYmVyLk9iamVjdFByb3h5LnByb3RvdHlwZSAqLyB7CiAg
        LyoqCiAgICBUaGUgb2JqZWN0IHdob3NlIHByb3BlcnRpZXMgd2lsbCBiZSBm
        b3J3YXJkZWQuCgogICAgQHByb3BlcnR5IGNvbnRlbnQKICAgIEB0eXBlIEVt
        YmVyLk9iamVjdAogICAgQGRlZmF1bHQgbnVsbAogICovCiAgY29udGVudDog
        bnVsbCwKICBfY29udGVudERpZENoYW5nZTogRW1iZXIub2JzZXJ2ZXIoZnVu
        Y3Rpb24oKSB7CiAgICBFbWJlci5hc3NlcnQoIkNhbid0IHNldCBPYmplY3RQ
        cm94eSdzIGNvbnRlbnQgdG8gaXRzZWxmIiwgdGhpcy5nZXQoJ2NvbnRlbnQn
        KSAhPT0gdGhpcyk7CiAgfSwgJ2NvbnRlbnQnKSwKCiAgaXNUcnV0aHk6IEVt
        YmVyLmNvbXB1dGVkLmJvb2woJ2NvbnRlbnQnKSwKCiAgX2RlYnVnQ29udGFp
        bmVyS2V5OiBudWxsLAoKICB3aWxsV2F0Y2hQcm9wZXJ0eTogZnVuY3Rpb24g
        KGtleSkgewogICAgdmFyIGNvbnRlbnRLZXkgPSAnY29udGVudC4nICsga2V5
        OwogICAgYWRkQmVmb3JlT2JzZXJ2ZXIodGhpcywgY29udGVudEtleSwgbnVs
        bCwgY29udGVudFByb3BlcnR5V2lsbENoYW5nZSk7CiAgICBhZGRPYnNlcnZl
        cih0aGlzLCBjb250ZW50S2V5LCBudWxsLCBjb250ZW50UHJvcGVydHlEaWRD
        aGFuZ2UpOwogIH0sCgogIGRpZFVud2F0Y2hQcm9wZXJ0eTogZnVuY3Rpb24g
        KGtleSkgewogICAgdmFyIGNvbnRlbnRLZXkgPSAnY29udGVudC4nICsga2V5
        OwogICAgcmVtb3ZlQmVmb3JlT2JzZXJ2ZXIodGhpcywgY29udGVudEtleSwg
        bnVsbCwgY29udGVudFByb3BlcnR5V2lsbENoYW5nZSk7CiAgICByZW1vdmVP
        YnNlcnZlcih0aGlzLCBjb250ZW50S2V5LCBudWxsLCBjb250ZW50UHJvcGVy
        dHlEaWRDaGFuZ2UpOwogIH0sCgogIHVua25vd25Qcm9wZXJ0eTogZnVuY3Rp
        b24gKGtleSkgewogICAgdmFyIGNvbnRlbnQgPSBnZXQodGhpcywgJ2NvbnRl
        bnQnKTsKICAgIGlmIChjb250ZW50KSB7CiAgICAgIHJldHVybiBnZXQoY29u
        dGVudCwga2V5KTsKICAgIH0KICB9LAoKICBzZXRVbmtub3duUHJvcGVydHk6
        IGZ1bmN0aW9uIChrZXksIHZhbHVlKSB7CiAgICB2YXIgbSA9IG1ldGEodGhp
        cyk7CiAgICBpZiAobS5wcm90byA9PT0gdGhpcykgewogICAgICAvLyBpZiBt
        YXJrZWQgYXMgcHJvdG90eXBlIHRoZW4ganVzdCBkZWZpbmVQcm9wZXJ0eQog
        ICAgICAvLyByYXRoZXIgdGhhbiBkZWxlZ2F0ZQogICAgICBkZWZpbmVQcm9w
        ZXJ0eSh0aGlzLCBrZXksIG51bGwsIHZhbHVlKTsKICAgICAgcmV0dXJuIHZh
        bHVlOwogICAgfQoKICAgIHZhciBjb250ZW50ID0gZ2V0KHRoaXMsICdjb250
        ZW50Jyk7CiAgICBFbWJlci5hc3NlcnQoZm10KCJDYW5ub3QgZGVsZWdhdGUg
        c2V0KCclQCcsICVAKSB0byB0aGUgJ2NvbnRlbnQnIHByb3BlcnR5IG9mIG9i
        amVjdCBwcm94eSAlQDogaXRzICdjb250ZW50JyBpcyB1bmRlZmluZWQuIiwg
        W2tleSwgdmFsdWUsIHRoaXNdKSwgY29udGVudCk7CiAgICByZXR1cm4gc2V0
        KGNvbnRlbnQsIGtleSwgdmFsdWUpOwogIH0KCn0pOwoKfSkoKTsKCgoKKGZ1
        bmN0aW9uKCkgewovKioKQG1vZHVsZSBlbWJlcgpAc3VibW9kdWxlIGVtYmVy
        LXJ1bnRpbWUKKi8KCgp2YXIgc2V0ID0gRW1iZXIuc2V0LCBnZXQgPSBFbWJl
        ci5nZXQsIGd1aWRGb3IgPSBFbWJlci5ndWlkRm9yOwp2YXIgZm9yRWFjaCA9
        IEVtYmVyLkVudW1lcmFibGVVdGlscy5mb3JFYWNoLAogICAgaW5kZXhPZiA9
        IEVtYmVyLkFycmF5UG9seWZpbGxzLmluZGV4T2Y7Cgp2YXIgRWFjaEFycmF5
        ID0gRW1iZXIuT2JqZWN0LmV4dGVuZChFbWJlci5BcnJheSwgewoKICBpbml0
        OiBmdW5jdGlvbihjb250ZW50LCBrZXlOYW1lLCBvd25lcikgewogICAgdGhp
        cy5fc3VwZXIoKTsKICAgIHRoaXMuX2tleU5hbWUgPSBrZXlOYW1lOwogICAg
        dGhpcy5fb3duZXIgICA9IG93bmVyOwogICAgdGhpcy5fY29udGVudCA9IGNv
        bnRlbnQ7CiAgfSwKCiAgb2JqZWN0QXQ6IGZ1bmN0aW9uKGlkeCkgewogICAg
        dmFyIGl0ZW0gPSB0aGlzLl9jb250ZW50Lm9iamVjdEF0KGlkeCk7CiAgICBy
        ZXR1cm4gaXRlbSAmJiBnZXQoaXRlbSwgdGhpcy5fa2V5TmFtZSk7CiAgfSwK
        CiAgbGVuZ3RoOiBFbWJlci5jb21wdXRlZChmdW5jdGlvbigpIHsKICAgIHZh
        ciBjb250ZW50ID0gdGhpcy5fY29udGVudDsKICAgIHJldHVybiBjb250ZW50
        ID8gZ2V0KGNvbnRlbnQsICdsZW5ndGgnKSA6IDA7CiAgfSkKCn0pOwoKdmFy
        IElTX09CU0VSVkVSID0gL14uKzooYmVmb3JlfGNoYW5nZSkkLzsKCmZ1bmN0
        aW9uIGFkZE9ic2VydmVyRm9yQ29udGVudEtleShjb250ZW50LCBrZXlOYW1l
        LCBwcm94eSwgaWR4LCBsb2MpIHsKICB2YXIgb2JqZWN0cyA9IHByb3h5Ll9v
        YmplY3RzLCBndWlkOwogIGlmICghb2JqZWN0cykgb2JqZWN0cyA9IHByb3h5
        Ll9vYmplY3RzID0ge307CgogIHdoaWxlKC0tbG9jPj1pZHgpIHsKICAgIHZh
        ciBpdGVtID0gY29udGVudC5vYmplY3RBdChsb2MpOwogICAgaWYgKGl0ZW0p
        IHsKICAgICAgRW1iZXIuYXNzZXJ0KCdXaGVuIHVzaW5nIEBlYWNoIHRvIG9i
        c2VydmUgdGhlIGFycmF5ICcgKyBjb250ZW50ICsgJywgdGhlIGFycmF5IG11
        c3QgcmV0dXJuIGFuIG9iamVjdCcsIEVtYmVyLnR5cGVPZihpdGVtKSA9PT0g
        J2luc3RhbmNlJyB8fCBFbWJlci50eXBlT2YoaXRlbSkgPT09ICdvYmplY3Qn
        KTsKICAgICAgRW1iZXIuYWRkQmVmb3JlT2JzZXJ2ZXIoaXRlbSwga2V5TmFt
        ZSwgcHJveHksICdjb250ZW50S2V5V2lsbENoYW5nZScpOwogICAgICBFbWJl
        ci5hZGRPYnNlcnZlcihpdGVtLCBrZXlOYW1lLCBwcm94eSwgJ2NvbnRlbnRL
        ZXlEaWRDaGFuZ2UnKTsKCiAgICAgIC8vIGtlZXAgdHJhY2sgb2YgdGhlIGlu
        ZGV4IGVhY2ggaXRlbSB3YXMgZm91bmQgYXQgc28gd2UgY2FuIG1hcAogICAg
        ICAvLyBpdCBiYWNrIHdoZW4gdGhlIG9iaiBjaGFuZ2VzLgogICAgICBndWlk
        ID0gZ3VpZEZvcihpdGVtKTsKICAgICAgaWYgKCFvYmplY3RzW2d1aWRdKSBv
        YmplY3RzW2d1aWRdID0gW107CiAgICAgIG9iamVjdHNbZ3VpZF0ucHVzaChs
        b2MpOwogICAgfQogIH0KfQoKZnVuY3Rpb24gcmVtb3ZlT2JzZXJ2ZXJGb3JD
        b250ZW50S2V5KGNvbnRlbnQsIGtleU5hbWUsIHByb3h5LCBpZHgsIGxvYykg
        ewogIHZhciBvYmplY3RzID0gcHJveHkuX29iamVjdHM7CiAgaWYgKCFvYmpl
        Y3RzKSBvYmplY3RzID0gcHJveHkuX29iamVjdHMgPSB7fTsKICB2YXIgaW5k
        aWNpZXMsIGd1aWQ7CgogIHdoaWxlKC0tbG9jPj1pZHgpIHsKICAgIHZhciBp
        dGVtID0gY29udGVudC5vYmplY3RBdChsb2MpOwogICAgaWYgKGl0ZW0pIHsK
        ICAgICAgRW1iZXIucmVtb3ZlQmVmb3JlT2JzZXJ2ZXIoaXRlbSwga2V5TmFt
        ZSwgcHJveHksICdjb250ZW50S2V5V2lsbENoYW5nZScpOwogICAgICBFbWJl
        ci5yZW1vdmVPYnNlcnZlcihpdGVtLCBrZXlOYW1lLCBwcm94eSwgJ2NvbnRl
        bnRLZXlEaWRDaGFuZ2UnKTsKCiAgICAgIGd1aWQgPSBndWlkRm9yKGl0ZW0p
        OwogICAgICBpbmRpY2llcyA9IG9iamVjdHNbZ3VpZF07CiAgICAgIGluZGlj
        aWVzW2luZGV4T2YuY2FsbChpbmRpY2llcywgbG9jKV0gPSBudWxsOwogICAg
        fQogIH0KfQoKLyoqCiAgVGhpcyBpcyB0aGUgb2JqZWN0IGluc3RhbmNlIHJl
        dHVybmVkIHdoZW4geW91IGdldCB0aGUgYEBlYWNoYCBwcm9wZXJ0eSBvbiBh
        bgogIGFycmF5LiBJdCB1c2VzIHRoZSB1bmtub3duUHJvcGVydHkgaGFuZGxl
        ciB0byBhdXRvbWF0aWNhbGx5IGNyZWF0ZQogIEVhY2hBcnJheSBpbnN0YW5j
        ZXMgZm9yIHByb3BlcnR5IG5hbWVzLgoKICBAcHJpdmF0ZQogIEBjbGFzcyBF
        YWNoUHJveHkKICBAbmFtZXNwYWNlIEVtYmVyCiAgQGV4dGVuZHMgRW1iZXIu
        T2JqZWN0CiovCkVtYmVyLkVhY2hQcm94eSA9IEVtYmVyLk9iamVjdC5leHRl
        bmQoewoKICBpbml0OiBmdW5jdGlvbihjb250ZW50KSB7CiAgICB0aGlzLl9z
        dXBlcigpOwogICAgdGhpcy5fY29udGVudCA9IGNvbnRlbnQ7CiAgICBjb250
        ZW50LmFkZEFycmF5T2JzZXJ2ZXIodGhpcyk7CgogICAgLy8gaW4gY2FzZSBz
        b21lb25lIGlzIGFscmVhZHkgb2JzZXJ2aW5nIHNvbWUga2V5cyBtYWtlIHN1
        cmUgdGhleSBhcmUKICAgIC8vIGFkZGVkCiAgICBmb3JFYWNoKEVtYmVyLndh
        dGNoZWRFdmVudHModGhpcyksIGZ1bmN0aW9uKGV2ZW50TmFtZSkgewogICAg
        ICB0aGlzLmRpZEFkZExpc3RlbmVyKGV2ZW50TmFtZSk7CiAgICB9LCB0aGlz
        KTsKICB9LAoKICAvKioKICAgIFlvdSBjYW4gZGlyZWN0bHkgYWNjZXNzIG1h
        cHBlZCBwcm9wZXJ0aWVzIGJ5IHNpbXBseSByZXF1ZXN0aW5nIHRoZW0uCiAg
        ICBUaGUgYHVua25vd25Qcm9wZXJ0eWAgaGFuZGxlciB3aWxsIGdlbmVyYXRl
        IGFuIEVhY2hBcnJheSBvZiBlYWNoIGl0ZW0uCgogICAgQG1ldGhvZCB1bmtu
        b3duUHJvcGVydHkKICAgIEBwYXJhbSBrZXlOYW1lIHtTdHJpbmd9CiAgICBA
        cGFyYW0gdmFsdWUgeyp9CiAgKi8KICB1bmtub3duUHJvcGVydHk6IGZ1bmN0
        aW9uKGtleU5hbWUsIHZhbHVlKSB7CiAgICB2YXIgcmV0OwogICAgcmV0ID0g
        bmV3IEVhY2hBcnJheSh0aGlzLl9jb250ZW50LCBrZXlOYW1lLCB0aGlzKTsK
        ICAgIEVtYmVyLmRlZmluZVByb3BlcnR5KHRoaXMsIGtleU5hbWUsIG51bGws
        IHJldCk7CiAgICB0aGlzLmJlZ2luT2JzZXJ2aW5nQ29udGVudEtleShrZXlO
        YW1lKTsKICAgIHJldHVybiByZXQ7CiAgfSwKCiAgLy8gLi4uLi4uLi4uLi4u
        Li4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4u
        LgogIC8vIEFSUkFZIENIQU5HRVMKICAvLyBJbnZva2VzIHdoZW5ldmVyIHRo
        ZSBjb250ZW50IGFycmF5IGl0c2VsZiBjaGFuZ2VzLgoKICBhcnJheVdpbGxD
        aGFuZ2U6IGZ1bmN0aW9uKGNvbnRlbnQsIGlkeCwgcmVtb3ZlZENudCwgYWRk
        ZWRDbnQpIHsKICAgIHZhciBrZXlzID0gdGhpcy5fa2V5cywga2V5LCBsaW07
        CgogICAgbGltID0gcmVtb3ZlZENudD4wID8gaWR4K3JlbW92ZWRDbnQgOiAt
        MTsKICAgIEVtYmVyLmJlZ2luUHJvcGVydHlDaGFuZ2VzKHRoaXMpOwoKICAg
        IGZvcihrZXkgaW4ga2V5cykgewogICAgICBpZiAoIWtleXMuaGFzT3duUHJv
        cGVydHkoa2V5KSkgeyBjb250aW51ZTsgfQoKICAgICAgaWYgKGxpbT4wKSB7
        IHJlbW92ZU9ic2VydmVyRm9yQ29udGVudEtleShjb250ZW50LCBrZXksIHRo
        aXMsIGlkeCwgbGltKTsgfQoKICAgICAgRW1iZXIucHJvcGVydHlXaWxsQ2hh
        bmdlKHRoaXMsIGtleSk7CiAgICB9CgogICAgRW1iZXIucHJvcGVydHlXaWxs
        Q2hhbmdlKHRoaXMuX2NvbnRlbnQsICdAZWFjaCcpOwogICAgRW1iZXIuZW5k
        UHJvcGVydHlDaGFuZ2VzKHRoaXMpOwogIH0sCgogIGFycmF5RGlkQ2hhbmdl
        OiBmdW5jdGlvbihjb250ZW50LCBpZHgsIHJlbW92ZWRDbnQsIGFkZGVkQ250
        KSB7CiAgICB2YXIga2V5cyA9IHRoaXMuX2tleXMsIGxpbTsKCiAgICBsaW0g
        PSBhZGRlZENudD4wID8gaWR4K2FkZGVkQ250IDogLTE7CiAgICBFbWJlci5j
        aGFuZ2VQcm9wZXJ0aWVzKGZ1bmN0aW9uKCkgewogICAgICBmb3IodmFyIGtl
        eSBpbiBrZXlzKSB7CiAgICAgICAgaWYgKCFrZXlzLmhhc093blByb3BlcnR5
        KGtleSkpIHsgY29udGludWU7IH0KCiAgICAgICAgaWYgKGxpbT4wKSB7IGFk
        ZE9ic2VydmVyRm9yQ29udGVudEtleShjb250ZW50LCBrZXksIHRoaXMsIGlk
        eCwgbGltKTsgfQoKICAgICAgICBFbWJlci5wcm9wZXJ0eURpZENoYW5nZSh0
        aGlzLCBrZXkpOwogICAgICB9CgogICAgICBFbWJlci5wcm9wZXJ0eURpZENo
        YW5nZSh0aGlzLl9jb250ZW50LCAnQGVhY2gnKTsKICAgIH0sIHRoaXMpOwog
        IH0sCgogIC8vIC4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4u
        Li4uLi4uLi4uLi4uLi4uLi4uLi4uLi4KICAvLyBMSVNURU4gRk9SIE5FVyBP
        QlNFUlZFUlMgQU5EIE9USEVSIEVWRU5UIExJU1RFTkVSUwogIC8vIFN0YXJ0
        IG1vbml0b3Jpbmcga2V5cyBiYXNlZCBvbiB3aG8gaXMgbGlzdGVuaW5nLi4u
        CgogIGRpZEFkZExpc3RlbmVyOiBmdW5jdGlvbihldmVudE5hbWUpIHsKICAg
        IGlmIChJU19PQlNFUlZFUi50ZXN0KGV2ZW50TmFtZSkpIHsKICAgICAgdGhp
        cy5iZWdpbk9ic2VydmluZ0NvbnRlbnRLZXkoZXZlbnROYW1lLnNsaWNlKDAs
        IC03KSk7CiAgICB9CiAgfSwKCiAgZGlkUmVtb3ZlTGlzdGVuZXI6IGZ1bmN0
        aW9uKGV2ZW50TmFtZSkgewogICAgaWYgKElTX09CU0VSVkVSLnRlc3QoZXZl
        bnROYW1lKSkgewogICAgICB0aGlzLnN0b3BPYnNlcnZpbmdDb250ZW50S2V5
        KGV2ZW50TmFtZS5zbGljZSgwLCAtNykpOwogICAgfQogIH0sCgogIC8vIC4u
        Li4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4u
        Li4uLi4uLi4uLi4KICAvLyBDT05URU5UIEtFWSBPQlNFUlZJTkcKICAvLyBB
        Y3R1YWwgd2F0Y2gga2V5cyBvbiB0aGUgc291cmNlIGNvbnRlbnQuCgogIGJl
        Z2luT2JzZXJ2aW5nQ29udGVudEtleTogZnVuY3Rpb24oa2V5TmFtZSkgewog
        ICAgdmFyIGtleXMgPSB0aGlzLl9rZXlzOwogICAgaWYgKCFrZXlzKSBrZXlz
        ID0gdGhpcy5fa2V5cyA9IHt9OwogICAgaWYgKCFrZXlzW2tleU5hbWVdKSB7
        CiAgICAgIGtleXNba2V5TmFtZV0gPSAxOwogICAgICB2YXIgY29udGVudCA9
        IHRoaXMuX2NvbnRlbnQsCiAgICAgICAgICBsZW4gPSBnZXQoY29udGVudCwg
        J2xlbmd0aCcpOwogICAgICBhZGRPYnNlcnZlckZvckNvbnRlbnRLZXkoY29u
        dGVudCwga2V5TmFtZSwgdGhpcywgMCwgbGVuKTsKICAgIH0gZWxzZSB7CiAg
        ICAgIGtleXNba2V5TmFtZV0rKzsKICAgIH0KICB9LAoKICBzdG9wT2JzZXJ2
        aW5nQ29udGVudEtleTogZnVuY3Rpb24oa2V5TmFtZSkgewogICAgdmFyIGtl
        eXMgPSB0aGlzLl9rZXlzOwogICAgaWYgKGtleXMgJiYgKGtleXNba2V5TmFt
        ZV0+MCkgJiYgKC0ta2V5c1trZXlOYW1lXTw9MCkpIHsKICAgICAgdmFyIGNv
        bnRlbnQgPSB0aGlzLl9jb250ZW50LAogICAgICAgICAgbGVuICAgICA9IGdl
        dChjb250ZW50LCAnbGVuZ3RoJyk7CiAgICAgIHJlbW92ZU9ic2VydmVyRm9y
        Q29udGVudEtleShjb250ZW50LCBrZXlOYW1lLCB0aGlzLCAwLCBsZW4pOwog
        ICAgfQogIH0sCgogIGNvbnRlbnRLZXlXaWxsQ2hhbmdlOiBmdW5jdGlvbihv
        YmosIGtleU5hbWUpIHsKICAgIEVtYmVyLnByb3BlcnR5V2lsbENoYW5nZSh0
        aGlzLCBrZXlOYW1lKTsKICB9LAoKICBjb250ZW50S2V5RGlkQ2hhbmdlOiBm
        dW5jdGlvbihvYmosIGtleU5hbWUpIHsKICAgIEVtYmVyLnByb3BlcnR5RGlk
        Q2hhbmdlKHRoaXMsIGtleU5hbWUpOwogIH0KCn0pOwoKCgp9KSgpOwoKCgoo
        ZnVuY3Rpb24oKSB7Ci8qKgpAbW9kdWxlIGVtYmVyCkBzdWJtb2R1bGUgZW1i
        ZXItcnVudGltZQoqLwoKCnZhciBnZXQgPSBFbWJlci5nZXQsIHNldCA9IEVt
        YmVyLnNldCwgcmVwbGFjZSA9IEVtYmVyLkVudW1lcmFibGVVdGlscy5fcmVw
        bGFjZTsKCi8vIEFkZCBFbWJlci5BcnJheSB0byBBcnJheS5wcm90b3R5cGUu
        IFJlbW92ZSBtZXRob2RzIHdpdGggbmF0aXZlCi8vIGltcGxlbWVudGF0aW9u
        cyBhbmQgc3VwcGx5IHNvbWUgbW9yZSBvcHRpbWl6ZWQgdmVyc2lvbnMgb2Yg
        Z2VuZXJpYyBtZXRob2RzCi8vIGJlY2F1c2UgdGhleSBhcmUgc28gY29tbW9u
        Lgp2YXIgTmF0aXZlQXJyYXkgPSBFbWJlci5NaXhpbi5jcmVhdGUoRW1iZXIu
        TXV0YWJsZUFycmF5LCBFbWJlci5PYnNlcnZhYmxlLCBFbWJlci5Db3B5YWJs
        ZSwgewoKICAvLyBiZWNhdXNlIGxlbmd0aCBpcyBhIGJ1aWx0LWluIHByb3Bl
        cnR5IHdlIG5lZWQgdG8ga25vdyB0byBqdXN0IGdldCB0aGUKICAvLyBvcmln
        aW5hbCBwcm9wZXJ0eS4KICBnZXQ6IGZ1bmN0aW9uKGtleSkgewogICAgaWYg
        KGtleT09PSdsZW5ndGgnKSByZXR1cm4gdGhpcy5sZW5ndGg7CiAgICBlbHNl
        IGlmICgnbnVtYmVyJyA9PT0gdHlwZW9mIGtleSkgcmV0dXJuIHRoaXNba2V5
        XTsKICAgIGVsc2UgcmV0dXJuIHRoaXMuX3N1cGVyKGtleSk7CiAgfSwKCiAg
        b2JqZWN0QXQ6IGZ1bmN0aW9uKGlkeCkgewogICAgcmV0dXJuIHRoaXNbaWR4
        XTsKICB9LAoKICAvLyBwcmltaXRpdmUgZm9yIGFycmF5IHN1cHBvcnQuCiAg
        cmVwbGFjZTogZnVuY3Rpb24oaWR4LCBhbXQsIG9iamVjdHMpIHsKCiAgICBp
        ZiAodGhpcy5pc0Zyb3plbikgdGhyb3cgRW1iZXIuRlJPWkVOX0VSUk9SOwoK
        ICAgIC8vIGlmIHdlIHJlcGxhY2VkIGV4YWN0bHkgdGhlIHNhbWUgbnVtYmVy
        IG9mIGl0ZW1zLCB0aGVuIHBhc3Mgb25seSB0aGUKICAgIC8vIHJlcGxhY2Vk
        IHJhbmdlLiBPdGhlcndpc2UsIHBhc3MgdGhlIGZ1bGwgcmVtYWluaW5nIGFy
        cmF5IGxlbmd0aAogICAgLy8gc2luY2UgZXZlcnl0aGluZyBoYXMgc2hpZnRl
        ZAogICAgdmFyIGxlbiA9IG9iamVjdHMgPyBnZXQob2JqZWN0cywgJ2xlbmd0
        aCcpIDogMDsKICAgIHRoaXMuYXJyYXlDb250ZW50V2lsbENoYW5nZShpZHgs
        IGFtdCwgbGVuKTsKCiAgICBpZiAoIW9iamVjdHMgfHwgb2JqZWN0cy5sZW5n
        dGggPT09IDApIHsKICAgICAgdGhpcy5zcGxpY2UoaWR4LCBhbXQpOwogICAg
        fSBlbHNlIHsKICAgICAgcmVwbGFjZSh0aGlzLCBpZHgsIGFtdCwgb2JqZWN0
        cyk7CiAgICB9CgogICAgdGhpcy5hcnJheUNvbnRlbnREaWRDaGFuZ2UoaWR4
        LCBhbXQsIGxlbik7CiAgICByZXR1cm4gdGhpczsKICB9LAoKICAvLyBJZiB5
        b3UgYXNrIGZvciBhbiB1bmtub3duIHByb3BlcnR5LCB0aGVuIHRyeSB0byBj
        b2xsZWN0IHRoZSB2YWx1ZQogIC8vIGZyb20gbWVtYmVyIGl0ZW1zLgogIHVu
        a25vd25Qcm9wZXJ0eTogZnVuY3Rpb24oa2V5LCB2YWx1ZSkgewogICAgdmFy
        IHJldDsvLyA9IHRoaXMucmVkdWNlZFByb3BlcnR5KGtleSwgdmFsdWUpIDsK
        ICAgIGlmICgodmFsdWUgIT09IHVuZGVmaW5lZCkgJiYgcmV0ID09PSB1bmRl
        ZmluZWQpIHsKICAgICAgcmV0ID0gdGhpc1trZXldID0gdmFsdWU7CiAgICB9
        CiAgICByZXR1cm4gcmV0IDsKICB9LAoKICAvLyBJZiBicm93c2VyIGRpZCBu
        b3QgaW1wbGVtZW50IGluZGV4T2YgbmF0aXZlbHksIHRoZW4gb3ZlcnJpZGUg
        d2l0aAogIC8vIHNwZWNpYWxpemVkIHZlcnNpb24KICBpbmRleE9mOiBmdW5j
        dGlvbihvYmplY3QsIHN0YXJ0QXQpIHsKICAgIHZhciBpZHgsIGxlbiA9IHRo
        aXMubGVuZ3RoOwoKICAgIGlmIChzdGFydEF0ID09PSB1bmRlZmluZWQpIHN0
        YXJ0QXQgPSAwOwogICAgZWxzZSBzdGFydEF0ID0gKHN0YXJ0QXQgPCAwKSA/
        IE1hdGguY2VpbChzdGFydEF0KSA6IE1hdGguZmxvb3Ioc3RhcnRBdCk7CiAg
        ICBpZiAoc3RhcnRBdCA8IDApIHN0YXJ0QXQgKz0gbGVuOwoKICAgIGZvcihp
        ZHg9c3RhcnRBdDtpZHg8bGVuO2lkeCsrKSB7CiAgICAgIGlmICh0aGlzW2lk
        eF0gPT09IG9iamVjdCkgcmV0dXJuIGlkeCA7CiAgICB9CiAgICByZXR1cm4g
        LTE7CiAgfSwKCiAgbGFzdEluZGV4T2Y6IGZ1bmN0aW9uKG9iamVjdCwgc3Rh
        cnRBdCkgewogICAgdmFyIGlkeCwgbGVuID0gdGhpcy5sZW5ndGg7CgogICAg
        aWYgKHN0YXJ0QXQgPT09IHVuZGVmaW5lZCkgc3RhcnRBdCA9IGxlbi0xOwog
        ICAgZWxzZSBzdGFydEF0ID0gKHN0YXJ0QXQgPCAwKSA/IE1hdGguY2VpbChz
        dGFydEF0KSA6IE1hdGguZmxvb3Ioc3RhcnRBdCk7CiAgICBpZiAoc3RhcnRB
        dCA8IDApIHN0YXJ0QXQgKz0gbGVuOwoKICAgIGZvcihpZHg9c3RhcnRBdDtp
        ZHg+PTA7aWR4LS0pIHsKICAgICAgaWYgKHRoaXNbaWR4XSA9PT0gb2JqZWN0
        KSByZXR1cm4gaWR4IDsKICAgIH0KICAgIHJldHVybiAtMTsKICB9LAoKICBj
        b3B5OiBmdW5jdGlvbihkZWVwKSB7CiAgICBpZiAoZGVlcCkgewogICAgICBy
        ZXR1cm4gdGhpcy5tYXAoZnVuY3Rpb24oaXRlbSkgeyByZXR1cm4gRW1iZXIu
        Y29weShpdGVtLCB0cnVlKTsgfSk7CiAgICB9CgogICAgcmV0dXJuIHRoaXMu
        c2xpY2UoKTsKICB9Cn0pOwoKLy8gUmVtb3ZlIGFueSBtZXRob2RzIGltcGxl
        bWVudGVkIG5hdGl2ZWx5IHNvIHdlIGRvbid0IG92ZXJyaWRlIHRoZW0KdmFy
        IGlnbm9yZSA9IFsnbGVuZ3RoJ107CkVtYmVyLkVudW1lcmFibGVVdGlscy5m
        b3JFYWNoKE5hdGl2ZUFycmF5LmtleXMoKSwgZnVuY3Rpb24obWV0aG9kTmFt
        ZSkgewogIGlmIChBcnJheS5wcm90b3R5cGVbbWV0aG9kTmFtZV0pIGlnbm9y
        ZS5wdXNoKG1ldGhvZE5hbWUpOwp9KTsKCmlmIChpZ25vcmUubGVuZ3RoPjAp
        IHsKICBOYXRpdmVBcnJheSA9IE5hdGl2ZUFycmF5LndpdGhvdXQuYXBwbHko
        TmF0aXZlQXJyYXksIGlnbm9yZSk7Cn0KCi8qKgogIFRoZSBOYXRpdmVBcnJh
        eSBtaXhpbiBjb250YWlucyB0aGUgcHJvcGVydGllcyBuZWVkZWQgdG8gdG8g
        bWFrZSB0aGUgbmF0aXZlCiAgQXJyYXkgc3VwcG9ydCBFbWJlci5NdXRhYmxl
        QXJyYXkgYW5kIGFsbCBvZiBpdHMgZGVwZW5kZW50IEFQSXMuIFVubGVzcyB5
        b3UKICBoYXZlIGBFbWJlci5FWFRFTkRfUFJPVE9UWVBFU2Agb3IgYEVtYmVy
        LkVYVEVORF9QUk9UT1RZUEVTLkFycmF5YCBzZXQgdG8KICBmYWxzZSwgdGhp
        cyB3aWxsIGJlIGFwcGxpZWQgYXV0b21hdGljYWxseS4gT3RoZXJ3aXNlIHlv
        dSBjYW4gYXBwbHkgdGhlIG1peGluCiAgYXQgYW55dGltZSBieSBjYWxsaW5n
        IGBFbWJlci5OYXRpdmVBcnJheS5hY3RpdmF0ZWAuCgogIEBjbGFzcyBOYXRp
        dmVBcnJheQogIEBuYW1lc3BhY2UgRW1iZXIKICBAdXNlcyBFbWJlci5NdXRh
        YmxlQXJyYXkKICBAdXNlcyBFbWJlci5PYnNlcnZhYmxlCiAgQHVzZXMgRW1i
        ZXIuQ29weWFibGUKKi8KRW1iZXIuTmF0aXZlQXJyYXkgPSBOYXRpdmVBcnJh
        eTsKCi8qKgogIENyZWF0ZXMgYW4gYEVtYmVyLk5hdGl2ZUFycmF5YCBmcm9t
        IGFuIEFycmF5IGxpa2Ugb2JqZWN0LgogIERvZXMgbm90IG1vZGlmeSB0aGUg
        b3JpZ2luYWwgb2JqZWN0LiBFbWJlci5BIGlzIG5vdCBuZWVkZWQgaWYKICBg
        RW1iZXIuRVhURU5EX1BST1RPVFlQRVNgIGlzIGB0cnVlYCAodGhlIGRlZmF1
        bHQgdmFsdWUpLiBIb3dldmVyLAogIGl0IGlzIHJlY29tbWVuZGVkIHRoYXQg
        eW91IHVzZSBFbWJlci5BIHdoZW4gY3JlYXRpbmcgYWRkb25zIGZvcgogIGVt
        YmVyIG9yIHdoZW4geW91IGNhbiBub3QgZ2FyZW50ZWUgdGhhdCBgRW1iZXIu
        RVhURU5EX1BST1RPVFlQRVNgCiAgd2lsbCBiZSBgdHJ1ZWAuCgogIEV4YW1w
        bGUKCiAgYGBganMKICB2YXIgUGFnaW5hdGlvbiA9IEVtYmVyLkNvbGxlY3Rp
        b25WaWV3LmV4dGVuZCh7CiAgICB0YWdOYW1lOiAndWwnLAogICAgY2xhc3NO
        YW1lczogWydwYWdpbmF0aW9uJ10sCiAgICBpbml0OiBmdW5jdGlvbigpIHsK
        ICAgICAgdGhpcy5fc3VwZXIoKTsKICAgICAgaWYgKCF0aGlzLmdldCgnY29u
        dGVudCcpKSB7CiAgICAgICAgdGhpcy5zZXQoJ2NvbnRlbnQnLCBFbWJlci5B
        KFtdKSk7CiAgICAgIH0KICAgIH0KICB9KTsKICBgYGAKCiAgQG1ldGhvZCBB
        CiAgQGZvciBFbWJlcgogIEByZXR1cm4ge0VtYmVyLk5hdGl2ZUFycmF5fQoq
        LwpFbWJlci5BID0gZnVuY3Rpb24oYXJyKSB7CiAgaWYgKGFyciA9PT0gdW5k
        ZWZpbmVkKSB7IGFyciA9IFtdOyB9CiAgcmV0dXJuIEVtYmVyLkFycmF5LmRl
        dGVjdChhcnIpID8gYXJyIDogRW1iZXIuTmF0aXZlQXJyYXkuYXBwbHkoYXJy
        KTsKfTsKCi8qKgogIEFjdGl2YXRlcyB0aGUgbWl4aW4gb24gdGhlIEFycmF5
        LnByb3RvdHlwZSBpZiBub3QgYWxyZWFkeSBhcHBsaWVkLiBDYWxsaW5nCiAg
        dGhpcyBtZXRob2QgbW9yZSB0aGFuIG9uY2UgaXMgc2FmZS4gVGhpcyB3aWxs
        IGJlIGNhbGxlZCB3aGVuIGVtYmVyIGlzIGxvYWRlZAogIHVubGVzcyB5b3Ug
        aGF2ZSBgRW1iZXIuRVhURU5EX1BST1RPVFlQRVNgIG9yIGBFbWJlci5FWFRF
        TkRfUFJPVE9UWVBFUy5BcnJheWAKICBzZXQgdG8gYGZhbHNlYC4KCiAgRXhh
        bXBsZQoKICBgYGBqcwogIGlmIChFbWJlci5FWFRFTkRfUFJPVE9UWVBFUyA9
        PT0gdHJ1ZSB8fCBFbWJlci5FWFRFTkRfUFJPVE9UWVBFUy5BcnJheSkgewog
        ICAgRW1iZXIuTmF0aXZlQXJyYXkuYWN0aXZhdGUoKTsKICB9CiAgYGBgCgog
        IEBtZXRob2QgYWN0aXZhdGUKICBAZm9yIEVtYmVyLk5hdGl2ZUFycmF5CiAg
        QHN0YXRpYwogIEByZXR1cm4ge3ZvaWR9CiovCkVtYmVyLk5hdGl2ZUFycmF5
        LmFjdGl2YXRlID0gZnVuY3Rpb24oKSB7CiAgTmF0aXZlQXJyYXkuYXBwbHko
        QXJyYXkucHJvdG90eXBlKTsKCiAgRW1iZXIuQSA9IGZ1bmN0aW9uKGFycikg
        eyByZXR1cm4gYXJyIHx8IFtdOyB9Owp9OwoKaWYgKEVtYmVyLkVYVEVORF9Q
        Uk9UT1RZUEVTID09PSB0cnVlIHx8IEVtYmVyLkVYVEVORF9QUk9UT1RZUEVT
        LkFycmF5KSB7CiAgRW1iZXIuTmF0aXZlQXJyYXkuYWN0aXZhdGUoKTsKfQoK
        Cn0pKCk7CgoKCihmdW5jdGlvbigpIHsKLyoqCkBtb2R1bGUgZW1iZXIKQHN1
        Ym1vZHVsZSBlbWJlci1ydW50aW1lCiovCgp2YXIgZ2V0ID0gRW1iZXIuZ2V0
        LCBzZXQgPSBFbWJlci5zZXQsIGd1aWRGb3IgPSBFbWJlci5ndWlkRm9yLCBp
        c05vbmUgPSBFbWJlci5pc05vbmUsIGZtdCA9IEVtYmVyLlN0cmluZy5mbXQ7
        CgovKioKICBBbiB1bm9yZGVyZWQgY29sbGVjdGlvbiBvZiBvYmplY3RzLgoK
        ICBBIFNldCB3b3JrcyBhIGJpdCBsaWtlIGFuIGFycmF5IGV4Y2VwdCB0aGF0
        IGl0cyBpdGVtcyBhcmUgbm90IG9yZGVyZWQuIFlvdQogIGNhbiBjcmVhdGUg
        YSBzZXQgdG8gZWZmaWNpZW50bHkgdGVzdCBmb3IgbWVtYmVyc2hpcCBmb3Ig
        YW4gb2JqZWN0LiBZb3UgY2FuCiAgYWxzbyBpdGVyYXRlIHRocm91Z2ggYSBz
        ZXQganVzdCBsaWtlIGFuIGFycmF5LCBldmVuIGFjY2Vzc2luZyBvYmplY3Rz
        IGJ5CiAgaW5kZXgsIGhvd2V2ZXIgdGhlcmUgaXMgbm8gZ3VhcmFudGVlIGFz
        IHRvIHRoZWlyIG9yZGVyLgoKICBBbGwgU2V0cyBhcmUgb2JzZXJ2YWJsZSB2
        aWEgdGhlIEVudW1lcmFibGUgT2JzZXJ2ZXIgQVBJIC0gd2hpY2ggd29ya3MK
        ICBvbiBhbnkgZW51bWVyYWJsZSBvYmplY3QgaW5jbHVkaW5nIGJvdGggU2V0
        cyBhbmQgQXJyYXlzLgoKICAjIyBDcmVhdGluZyBhIFNldAoKICBZb3UgY2Fu
        IGNyZWF0ZSBhIHNldCBsaWtlIHlvdSB3b3VsZCBtb3N0IG9iamVjdHMgdXNp
        bmcKICBgbmV3IEVtYmVyLlNldCgpYC4gTW9zdCBuZXcgc2V0cyB5b3UgY3Jl
        YXRlIHdpbGwgYmUgZW1wdHksIGJ1dCB5b3UgY2FuCiAgYWxzbyBpbml0aWFs
        aXplIHRoZSBzZXQgd2l0aCBzb21lIGNvbnRlbnQgYnkgcGFzc2luZyBhbiBh
        cnJheSBvciBvdGhlcgogIGVudW1lcmFibGUgb2Ygb2JqZWN0cyB0byB0aGUg
        Y29uc3RydWN0b3IuCgogIEZpbmFsbHksIHlvdSBjYW4gcGFzcyBpbiBhbiBl
        eGlzdGluZyBzZXQgYW5kIHRoZSBzZXQgd2lsbCBiZSBjb3BpZWQuIFlvdQog
        IGNhbiBhbHNvIGNyZWF0ZSBhIGNvcHkgb2YgYSBzZXQgYnkgY2FsbGluZyBg
        RW1iZXIuU2V0I2NvcHkoKWAuCgogIGBgYGphdmFzY3JpcHQKICAvLyBjcmVh
        dGVzIGEgbmV3IGVtcHR5IHNldAogIHZhciBmb3VuZE5hbWVzID0gbmV3IEVt
        YmVyLlNldCgpOwoKICAvLyBjcmVhdGVzIGEgc2V0IHdpdGggZm91ciBuYW1l
        cyBpbiBpdC4KICB2YXIgbmFtZXMgPSBuZXcgRW1iZXIuU2V0KFsiQ2hhcmxl
        cyIsICJUb20iLCAiSnVhbiIsICJBbGV4Il0pOyAvLyA6UAoKICAvLyBjcmVh
        dGVzIGEgY29weSBvZiB0aGUgbmFtZXMgc2V0LgogIHZhciBuYW1lc0NvcHkg
        PSBuZXcgRW1iZXIuU2V0KG5hbWVzKTsKCiAgLy8gc2FtZSBhcyBhYm92ZS4K
        ICB2YXIgYW5vdGhlck5hbWVzQ29weSA9IG5hbWVzLmNvcHkoKTsKICBgYGAK
        CiAgIyMgQWRkaW5nL1JlbW92aW5nIE9iamVjdHMKCiAgWW91IGdlbmVyYWxs
        eSBhZGQgb3IgcmVtb3ZlIG9iamVjdHMgZnJvbSBhIHNldCB1c2luZyBgYWRk
        KClgIG9yCiAgYHJlbW92ZSgpYC4gWW91IGNhbiBhZGQgYW55IHR5cGUgb2Yg
        b2JqZWN0IGluY2x1ZGluZyBwcmltaXRpdmVzIHN1Y2ggYXMKICBudW1iZXJz
        LCBzdHJpbmdzLCBhbmQgYm9vbGVhbnMuCgogIFVubGlrZSBhcnJheXMsIG9i
        amVjdHMgY2FuIG9ubHkgZXhpc3Qgb25lIHRpbWUgaW4gYSBzZXQuIElmIHlv
        dSBjYWxsIGBhZGQoKWAKICBvbiBhIHNldCB3aXRoIHRoZSBzYW1lIG9iamVj
        dCBtdWx0aXBsZSB0aW1lcywgdGhlIG9iamVjdCB3aWxsIG9ubHkgYmUgYWRk
        ZWQKICBvbmNlLiBMaWtld2lzZSwgY2FsbGluZyBgcmVtb3ZlKClgIHdpdGgg
        dGhlIHNhbWUgb2JqZWN0IG11bHRpcGxlIHRpbWVzIHdpbGwKICByZW1vdmUg
        dGhlIG9iamVjdCB0aGUgZmlyc3QgdGltZSBhbmQgaGF2ZSBubyBlZmZlY3Qg
        b24gZnV0dXJlIGNhbGxzIHVudGlsCiAgeW91IGFkZCB0aGUgb2JqZWN0IHRv
        IHRoZSBzZXQgYWdhaW4uCgogIE5PVEU6IFlvdSBjYW5ub3QgYWRkL3JlbW92
        ZSBgbnVsbGAgb3IgYHVuZGVmaW5lZGAgdG8gYSBzZXQuIEFueSBhdHRlbXB0
        IHRvIGRvCiAgc28gd2lsbCBiZSBpZ25vcmVkLgoKICBJbiBhZGRpdGlvbiB0
        byBhZGQvcmVtb3ZlIHlvdSBjYW4gYWxzbyBjYWxsIGBwdXNoKClgL2Bwb3Ao
        KWAuIFB1c2ggYmVoYXZlcwogIGp1c3QgbGlrZSBgYWRkKClgIGJ1dCBgcG9w
        KClgLCB1bmxpa2UgYHJlbW92ZSgpYCB3aWxsIHBpY2sgYW4gYXJiaXRyYXJ5
        CiAgb2JqZWN0LCByZW1vdmUgaXQgYW5kIHJldHVybiBpdC4gVGhpcyBpcyBh
        IGdvb2Qgd2F5IHRvIHVzZSBhIHNldCBhcyBhIGpvYgogIHF1ZXVlIHdoZW4g
        eW91IGRvbid0IGNhcmUgd2hpY2ggb3JkZXIgdGhlIGpvYnMgYXJlIGV4ZWN1
        dGVkIGluLgoKICAjIyBUZXN0aW5nIGZvciBhbiBPYmplY3QKCiAgVG8gdGVz
        dCBmb3IgYW4gb2JqZWN0J3MgcHJlc2VuY2UgaW4gYSBzZXQgeW91IHNpbXBs
        eSBjYWxsCiAgYEVtYmVyLlNldCNjb250YWlucygpYC4KCiAgIyMgT2JzZXJ2
        aW5nIGNoYW5nZXMKCiAgV2hlbiB1c2luZyBgRW1iZXIuU2V0YCwgeW91IGNh
        biBvYnNlcnZlIHRoZSBgIltdImAgcHJvcGVydHkgdG8gYmUKICBhbGVydGVk
        IHdoZW5ldmVyIHRoZSBjb250ZW50IGNoYW5nZXMuIFlvdSBjYW4gYWxzbyBh
        ZGQgYW4gZW51bWVyYWJsZQogIG9ic2VydmVyIHRvIHRoZSBzZXQgdG8gYmUg
        bm90aWZpZWQgb2Ygc3BlY2lmaWMgb2JqZWN0cyB0aGF0IGFyZSBhZGRlZCBh
        bmQKICByZW1vdmVkIGZyb20gdGhlIHNldC4gU2VlIFtFbWJlci5FbnVtZXJh
        YmxlXSgvYXBpL2NsYXNzZXMvRW1iZXIuRW51bWVyYWJsZS5odG1sKQogIGZv
        ciBtb3JlIGluZm9ybWF0aW9uIG9uIGVudW1lcmFibGVzLgoKICBUaGlzIGlz
        IG9mdGVuIHVuaGVscGZ1bC4gSWYgeW91IGFyZSBmaWx0ZXJpbmcgc2V0cyBv
        ZiBvYmplY3RzLCBmb3IgaW5zdGFuY2UsCiAgaXQgaXMgdmVyeSBpbmVmZmlj
        aWVudCB0byByZS1maWx0ZXIgYWxsIG9mIHRoZSBpdGVtcyBlYWNoIHRpbWUg
        dGhlIHNldAogIGNoYW5nZXMuIEl0IHdvdWxkIGJlIGJldHRlciBpZiB5b3Ug
        Y291bGQganVzdCBhZGp1c3QgdGhlIGZpbHRlcmVkIHNldCBiYXNlZAogIG9u
        IHdoYXQgd2FzIGNoYW5nZWQgb24gdGhlIG9yaWdpbmFsIHNldC4gVGhlIHNh
        bWUgaXNzdWUgYXBwbGllcyB0byBtZXJnaW5nCiAgc2V0cywgYXMgd2VsbC4K
        CiAgIyMgT3RoZXIgTWV0aG9kcwoKICBgRW1iZXIuU2V0YCBwcmltYXJ5IGlt
        cGxlbWVudHMgb3RoZXIgbWl4aW4gQVBJcy4gRm9yIGEgY29tcGxldGUgcmVm
        ZXJlbmNlCiAgb24gdGhlIG1ldGhvZHMgeW91IHdpbGwgdXNlIHdpdGggYEVt
        YmVyLlNldGAsIHBsZWFzZSBjb25zdWx0IHRoZXNlIG1peGlucy4KICBUaGUg
        bW9zdCB1c2VmdWwgb25lcyB3aWxsIGJlIGBFbWJlci5FbnVtZXJhYmxlYCBh
        bmQKICBgRW1iZXIuTXV0YWJsZUVudW1lcmFibGVgIHdoaWNoIGltcGxlbWVu
        dCBtb3N0IG9mIHRoZSBjb21tb24gaXRlcmF0b3IKICBtZXRob2RzIHlvdSBh
        cmUgdXNlZCB0byBvbiBBcnJheS4KCiAgTm90ZSB0aGF0IHlvdSBjYW4gYWxz
        byB1c2UgdGhlIGBFbWJlci5Db3B5YWJsZWAgYW5kIGBFbWJlci5GcmVlemFi
        bGVgCiAgQVBJcyBvbiBgRW1iZXIuU2V0YCBhcyB3ZWxsLiBPbmNlIGEgc2V0
        IGlzIGZyb3plbiBpdCBjYW4gbm8gbG9uZ2VyIGJlCiAgbW9kaWZpZWQuIFRo
        ZSBiZW5lZml0IG9mIHRoaXMgaXMgdGhhdCB3aGVuIHlvdSBjYWxsIGBmcm96
        ZW5Db3B5KClgIG9uIGl0LAogIEVtYmVyIHdpbGwgYXZvaWQgbWFraW5nIGNv
        cGllcyBvZiB0aGUgc2V0LiBUaGlzIGFsbG93cyB5b3UgdG8gd3JpdGUKICBj
        b2RlIHRoYXQgY2FuIGtub3cgd2l0aCBjZXJ0YWludHkgd2hlbiB0aGUgdW5k
        ZXJseWluZyBzZXQgZGF0YSB3aWxsIG9yCiAgd2lsbCBub3QgYmUgbW9kaWZp
        ZWQuCgogIEBjbGFzcyBTZXQKICBAbmFtZXNwYWNlIEVtYmVyCiAgQGV4dGVu
        ZHMgRW1iZXIuQ29yZU9iamVjdAogIEB1c2VzIEVtYmVyLk11dGFibGVFbnVt
        ZXJhYmxlCiAgQHVzZXMgRW1iZXIuQ29weWFibGUKICBAdXNlcyBFbWJlci5G
        cmVlemFibGUKICBAc2luY2UgRW1iZXIgMC45CiovCkVtYmVyLlNldCA9IEVt
        YmVyLkNvcmVPYmplY3QuZXh0ZW5kKEVtYmVyLk11dGFibGVFbnVtZXJhYmxl
        LCBFbWJlci5Db3B5YWJsZSwgRW1iZXIuRnJlZXphYmxlLAogIC8qKiBAc2Nv
        cGUgRW1iZXIuU2V0LnByb3RvdHlwZSAqLyB7CgogIC8vIC4uLi4uLi4uLi4u
        Li4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4u
        Li4KICAvLyBJTVBMRU1FTlQgRU5VTUVSQUJMRSBBUElTCiAgLy8KCiAgLyoq
        CiAgICBUaGlzIHByb3BlcnR5IHdpbGwgY2hhbmdlIGFzIHRoZSBudW1iZXIg
        b2Ygb2JqZWN0cyBpbiB0aGUgc2V0IGNoYW5nZXMuCgogICAgQHByb3BlcnR5
        IGxlbmd0aAogICAgQHR5cGUgbnVtYmVyCiAgICBAZGVmYXVsdCAwCiAgKi8K
        ICBsZW5ndGg6IDAsCgogIC8qKgogICAgQ2xlYXJzIHRoZSBzZXQuIFRoaXMg
        aXMgdXNlZnVsIGlmIHlvdSB3YW50IHRvIHJldXNlIGFuIGV4aXN0aW5nIHNl
        dAogICAgd2l0aG91dCBoYXZpbmcgdG8gcmVjcmVhdGUgaXQuCgogICAgYGBg
        amF2YXNjcmlwdAogICAgdmFyIGNvbG9ycyA9IG5ldyBFbWJlci5TZXQoWyJy
        ZWQiLCAiZ3JlZW4iLCAiYmx1ZSJdKTsKICAgIGNvbG9ycy5sZW5ndGg7ICAv
        LyAzCiAgICBjb2xvcnMuY2xlYXIoKTsKICAgIGNvbG9ycy5sZW5ndGg7ICAv
        LyAwCiAgICBgYGAKCiAgICBAbWV0aG9kIGNsZWFyCiAgICBAcmV0dXJuIHtF
        bWJlci5TZXR9IEFuIGVtcHR5IFNldAogICovCiAgY2xlYXI6IGZ1bmN0aW9u
        KCkgewogICAgaWYgKHRoaXMuaXNGcm96ZW4pIHsgdGhyb3cgbmV3IEVtYmVy
        LkVycm9yKEVtYmVyLkZST1pFTl9FUlJPUik7IH0KCiAgICB2YXIgbGVuID0g
        Z2V0KHRoaXMsICdsZW5ndGgnKTsKICAgIGlmIChsZW4gPT09IDApIHsgcmV0
        dXJuIHRoaXM7IH0KCiAgICB2YXIgZ3VpZDsKCiAgICB0aGlzLmVudW1lcmFi
        bGVDb250ZW50V2lsbENoYW5nZShsZW4sIDApOwogICAgRW1iZXIucHJvcGVy
        dHlXaWxsQ2hhbmdlKHRoaXMsICdmaXJzdE9iamVjdCcpOwogICAgRW1iZXIu
        cHJvcGVydHlXaWxsQ2hhbmdlKHRoaXMsICdsYXN0T2JqZWN0Jyk7CgogICAg
        Zm9yICh2YXIgaT0wOyBpIDwgbGVuOyBpKyspIHsKICAgICAgZ3VpZCA9IGd1
        aWRGb3IodGhpc1tpXSk7CiAgICAgIGRlbGV0ZSB0aGlzW2d1aWRdOwogICAg
        ICBkZWxldGUgdGhpc1tpXTsKICAgIH0KCiAgICBzZXQodGhpcywgJ2xlbmd0
        aCcsIDApOwoKICAgIEVtYmVyLnByb3BlcnR5RGlkQ2hhbmdlKHRoaXMsICdm
        aXJzdE9iamVjdCcpOwogICAgRW1iZXIucHJvcGVydHlEaWRDaGFuZ2UodGhp
        cywgJ2xhc3RPYmplY3QnKTsKICAgIHRoaXMuZW51bWVyYWJsZUNvbnRlbnRE
        aWRDaGFuZ2UobGVuLCAwKTsKCiAgICByZXR1cm4gdGhpczsKICB9LAoKICAv
        KioKICAgIFJldHVybnMgdHJ1ZSBpZiB0aGUgcGFzc2VkIG9iamVjdCBpcyBh
        bHNvIGFuIGVudW1lcmFibGUgdGhhdCBjb250YWlucyB0aGUKICAgIHNhbWUg
        b2JqZWN0cyBhcyB0aGUgcmVjZWl2ZXIuCgogICAgYGBgamF2YXNjcmlwdAog
        ICAgdmFyIGNvbG9ycyA9IFsicmVkIiwgImdyZWVuIiwgImJsdWUiXSwKICAg
        ICAgICBzYW1lX2NvbG9ycyA9IG5ldyBFbWJlci5TZXQoY29sb3JzKTsKCiAg
        ICBzYW1lX2NvbG9ycy5pc0VxdWFsKGNvbG9ycyk7ICAgICAgICAgICAgICAg
        Ly8gdHJ1ZQogICAgc2FtZV9jb2xvcnMuaXNFcXVhbChbInB1cnBsZSIsICJi
        cm93biJdKTsgIC8vIGZhbHNlCiAgICBgYGAKCiAgICBAbWV0aG9kIGlzRXF1
        YWwKICAgIEBwYXJhbSB7RW1iZXIuU2V0fSBvYmogdGhlIG90aGVyIG9iamVj
        dC4KICAgIEByZXR1cm4ge0Jvb2xlYW59CiAgKi8KICBpc0VxdWFsOiBmdW5j
        dGlvbihvYmopIHsKICAgIC8vIGZhaWwgZmFzdAogICAgaWYgKCFFbWJlci5F
        bnVtZXJhYmxlLmRldGVjdChvYmopKSByZXR1cm4gZmFsc2U7CgogICAgdmFy
        IGxvYyA9IGdldCh0aGlzLCAnbGVuZ3RoJyk7CiAgICBpZiAoZ2V0KG9iaiwg
        J2xlbmd0aCcpICE9PSBsb2MpIHJldHVybiBmYWxzZTsKCiAgICB3aGlsZSgt
        LWxvYyA+PSAwKSB7CiAgICAgIGlmICghb2JqLmNvbnRhaW5zKHRoaXNbbG9j
        XSkpIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICByZXR1cm4gdHJ1ZTsKICB9
        LAoKICAvKioKICAgIEFkZHMgYW4gb2JqZWN0IHRvIHRoZSBzZXQuIE9ubHkg
        bm9uLWBudWxsYCBvYmplY3RzIGNhbiBiZSBhZGRlZCB0byBhIHNldAogICAg
        YW5kIHRob3NlIGNhbiBvbmx5IGJlIGFkZGVkIG9uY2UuIElmIHRoZSBvYmpl
        Y3QgaXMgYWxyZWFkeSBpbiB0aGUgc2V0IG9yCiAgICB0aGUgcGFzc2VkIHZh
        bHVlIGlzIG51bGwgdGhpcyBtZXRob2Qgd2lsbCBoYXZlIG5vIGVmZmVjdC4K
        CiAgICBUaGlzIGlzIGFuIGFsaWFzIGZvciBgRW1iZXIuTXV0YWJsZUVudW1l
        cmFibGUuYWRkT2JqZWN0KClgLgoKICAgIGBgYGphdmFzY3JpcHQKICAgIHZh
        ciBjb2xvcnMgPSBuZXcgRW1iZXIuU2V0KCk7CiAgICBjb2xvcnMuYWRkKCJi
        bHVlIik7ICAgICAvLyBbImJsdWUiXQogICAgY29sb3JzLmFkZCgiYmx1ZSIp
        OyAgICAgLy8gWyJibHVlIl0KICAgIGNvbG9ycy5hZGQoInJlZCIpOyAgICAg
        IC8vIFsiYmx1ZSIsICJyZWQiXQogICAgY29sb3JzLmFkZChudWxsKTsgICAg
        ICAgLy8gWyJibHVlIiwgInJlZCJdCiAgICBjb2xvcnMuYWRkKHVuZGVmaW5l
        ZCk7ICAvLyBbImJsdWUiLCAicmVkIl0KICAgIGBgYAoKICAgIEBtZXRob2Qg
        YWRkCiAgICBAcGFyYW0ge09iamVjdH0gb2JqIFRoZSBvYmplY3QgdG8gYWRk
        LgogICAgQHJldHVybiB7RW1iZXIuU2V0fSBUaGUgc2V0IGl0c2VsZi4KICAq
        LwogIGFkZDogRW1iZXIuYWxpYXNNZXRob2QoJ2FkZE9iamVjdCcpLAoKICAv
        KioKICAgIFJlbW92ZXMgdGhlIG9iamVjdCBmcm9tIHRoZSBzZXQgaWYgaXQg
        aXMgZm91bmQuIElmIHlvdSBwYXNzIGEgYG51bGxgIHZhbHVlCiAgICBvciBh
        biBvYmplY3QgdGhhdCBpcyBhbHJlYWR5IG5vdCBpbiB0aGUgc2V0LCB0aGlz
        IG1ldGhvZCB3aWxsIGhhdmUgbm8KICAgIGVmZmVjdC4gVGhpcyBpcyBhbiBh
        bGlhcyBmb3IgYEVtYmVyLk11dGFibGVFbnVtZXJhYmxlLnJlbW92ZU9iamVj
        dCgpYC4KCiAgICBgYGBqYXZhc2NyaXB0CiAgICB2YXIgY29sb3JzID0gbmV3
        IEVtYmVyLlNldChbInJlZCIsICJncmVlbiIsICJibHVlIl0pOwogICAgY29s
        b3JzLnJlbW92ZSgicmVkIik7ICAgICAvLyBbImJsdWUiLCAiZ3JlZW4iXQog
        ICAgY29sb3JzLnJlbW92ZSgicHVycGxlIik7ICAvLyBbImJsdWUiLCAiZ3Jl
        ZW4iXQogICAgY29sb3JzLnJlbW92ZShudWxsKTsgICAgICAvLyBbImJsdWUi
        LCAiZ3JlZW4iXQogICAgYGBgCgogICAgQG1ldGhvZCByZW1vdmUKICAgIEBw
        YXJhbSB7T2JqZWN0fSBvYmogVGhlIG9iamVjdCB0byByZW1vdmUKICAgIEBy
        ZXR1cm4ge0VtYmVyLlNldH0gVGhlIHNldCBpdHNlbGYuCiAgKi8KICByZW1v
        dmU6IEVtYmVyLmFsaWFzTWV0aG9kKCdyZW1vdmVPYmplY3QnKSwKCiAgLyoq
        CiAgICBSZW1vdmVzIHRoZSBsYXN0IGVsZW1lbnQgZnJvbSB0aGUgc2V0IGFu
        ZCByZXR1cm5zIGl0LCBvciBgbnVsbGAgaWYgaXQncyBlbXB0eS4KCiAgICBg
        YGBqYXZhc2NyaXB0CiAgICB2YXIgY29sb3JzID0gbmV3IEVtYmVyLlNldChb
        ImdyZWVuIiwgImJsdWUiXSk7CiAgICBjb2xvcnMucG9wKCk7ICAvLyAiYmx1
        ZSIKICAgIGNvbG9ycy5wb3AoKTsgIC8vICJncmVlbiIKICAgIGNvbG9ycy5w
        b3AoKTsgIC8vIG51bGwKICAgIGBgYAoKICAgIEBtZXRob2QgcG9wCiAgICBA
        cmV0dXJuIHtPYmplY3R9IFRoZSByZW1vdmVkIG9iamVjdCBmcm9tIHRoZSBz
        ZXQgb3IgbnVsbC4KICAqLwogIHBvcDogZnVuY3Rpb24oKSB7CiAgICBpZiAo
        Z2V0KHRoaXMsICdpc0Zyb3plbicpKSB0aHJvdyBuZXcgRW1iZXIuRXJyb3Io
        RW1iZXIuRlJPWkVOX0VSUk9SKTsKICAgIHZhciBvYmogPSB0aGlzLmxlbmd0
        aCA+IDAgPyB0aGlzW3RoaXMubGVuZ3RoLTFdIDogbnVsbDsKICAgIHRoaXMu
        cmVtb3ZlKG9iaik7CiAgICByZXR1cm4gb2JqOwogIH0sCgogIC8qKgogICAg
        SW5zZXJ0cyB0aGUgZ2l2ZW4gb2JqZWN0IG9uIHRvIHRoZSBlbmQgb2YgdGhl
        IHNldC4gSXQgcmV0dXJucwogICAgdGhlIHNldCBpdHNlbGYuCgogICAgVGhp
        cyBpcyBhbiBhbGlhcyBmb3IgYEVtYmVyLk11dGFibGVFbnVtZXJhYmxlLmFk
        ZE9iamVjdCgpYC4KCiAgICBgYGBqYXZhc2NyaXB0CiAgICB2YXIgY29sb3Jz
        ID0gbmV3IEVtYmVyLlNldCgpOwogICAgY29sb3JzLnB1c2goInJlZCIpOyAg
        IC8vIFsicmVkIl0KICAgIGNvbG9ycy5wdXNoKCJncmVlbiIpOyAvLyBbInJl
        ZCIsICJncmVlbiJdCiAgICBjb2xvcnMucHVzaCgiYmx1ZSIpOyAgLy8gWyJy
        ZWQiLCAiZ3JlZW4iLCAiYmx1ZSJdCiAgICBgYGAKCiAgICBAbWV0aG9kIHB1
        c2gKICAgIEByZXR1cm4ge0VtYmVyLlNldH0gVGhlIHNldCBpdHNlbGYuCiAg
        Ki8KICBwdXNoOiBFbWJlci5hbGlhc01ldGhvZCgnYWRkT2JqZWN0JyksCgog
        IC8qKgogICAgUmVtb3ZlcyB0aGUgbGFzdCBlbGVtZW50IGZyb20gdGhlIHNl
        dCBhbmQgcmV0dXJucyBpdCwgb3IgYG51bGxgIGlmIGl0J3MgZW1wdHkuCgog
        ICAgVGhpcyBpcyBhbiBhbGlhcyBmb3IgYEVtYmVyLlNldC5wb3AoKWAuCgog
        ICAgYGBgamF2YXNjcmlwdAogICAgdmFyIGNvbG9ycyA9IG5ldyBFbWJlci5T
        ZXQoWyJncmVlbiIsICJibHVlIl0pOwogICAgY29sb3JzLnNoaWZ0KCk7ICAv
        LyAiYmx1ZSIKICAgIGNvbG9ycy5zaGlmdCgpOyAgLy8gImdyZWVuIgogICAg
        Y29sb3JzLnNoaWZ0KCk7ICAvLyBudWxsCiAgICBgYGAKCiAgICBAbWV0aG9k
        IHNoaWZ0CiAgICBAcmV0dXJuIHtPYmplY3R9IFRoZSByZW1vdmVkIG9iamVj
        dCBmcm9tIHRoZSBzZXQgb3IgbnVsbC4KICAqLwogIHNoaWZ0OiBFbWJlci5h
        bGlhc01ldGhvZCgncG9wJyksCgogIC8qKgogICAgSW5zZXJ0cyB0aGUgZ2l2
        ZW4gb2JqZWN0IG9uIHRvIHRoZSBlbmQgb2YgdGhlIHNldC4gSXQgcmV0dXJu
        cwogICAgdGhlIHNldCBpdHNlbGYuCgogICAgVGhpcyBpcyBhbiBhbGlhcyBv
        ZiBgRW1iZXIuU2V0LnB1c2goKWAKCiAgICBgYGBqYXZhc2NyaXB0CiAgICB2
        YXIgY29sb3JzID0gbmV3IEVtYmVyLlNldCgpOwogICAgY29sb3JzLnVuc2hp
        ZnQoInJlZCIpOyAgICAvLyBbInJlZCJdCiAgICBjb2xvcnMudW5zaGlmdCgi
        Z3JlZW4iKTsgIC8vIFsicmVkIiwgImdyZWVuIl0KICAgIGNvbG9ycy51bnNo
        aWZ0KCJibHVlIik7ICAgLy8gWyJyZWQiLCAiZ3JlZW4iLCAiYmx1ZSJdCiAg
        ICBgYGAKCiAgICBAbWV0aG9kIHVuc2hpZnQKICAgIEByZXR1cm4ge0VtYmVy
        LlNldH0gVGhlIHNldCBpdHNlbGYuCiAgKi8KICB1bnNoaWZ0OiBFbWJlci5h
        bGlhc01ldGhvZCgncHVzaCcpLAoKICAvKioKICAgIEFkZHMgZWFjaCBvYmpl
        Y3QgaW4gdGhlIHBhc3NlZCBlbnVtZXJhYmxlIHRvIHRoZSBzZXQuCgogICAg
        VGhpcyBpcyBhbiBhbGlhcyBvZiBgRW1iZXIuTXV0YWJsZUVudW1lcmFibGUu
        YWRkT2JqZWN0cygpYAoKICAgIGBgYGphdmFzY3JpcHQKICAgIHZhciBjb2xv
        cnMgPSBuZXcgRW1iZXIuU2V0KCk7CiAgICBjb2xvcnMuYWRkRWFjaChbInJl
        ZCIsICJncmVlbiIsICJibHVlIl0pOyAgLy8gWyJyZWQiLCAiZ3JlZW4iLCAi
        Ymx1ZSJdCiAgICBgYGAKCiAgICBAbWV0aG9kIGFkZEVhY2gKICAgIEBwYXJh
        bSB7RW1iZXIuRW51bWVyYWJsZX0gb2JqZWN0cyB0aGUgb2JqZWN0cyB0byBh
        ZGQuCiAgICBAcmV0dXJuIHtFbWJlci5TZXR9IFRoZSBzZXQgaXRzZWxmLgog
        ICovCiAgYWRkRWFjaDogRW1iZXIuYWxpYXNNZXRob2QoJ2FkZE9iamVjdHMn
        KSwKCiAgLyoqCiAgICBSZW1vdmVzIGVhY2ggb2JqZWN0IGluIHRoZSBwYXNz
        ZWQgZW51bWVyYWJsZSB0byB0aGUgc2V0LgoKICAgIFRoaXMgaXMgYW4gYWxp
        YXMgb2YgYEVtYmVyLk11dGFibGVFbnVtZXJhYmxlLnJlbW92ZU9iamVjdHMo
        KWAKCiAgICBgYGBqYXZhc2NyaXB0CiAgICB2YXIgY29sb3JzID0gbmV3IEVt
        YmVyLlNldChbInJlZCIsICJncmVlbiIsICJibHVlIl0pOwogICAgY29sb3Jz
        LnJlbW92ZUVhY2goWyJyZWQiLCAiYmx1ZSJdKTsgIC8vICBbImdyZWVuIl0K
        ICAgIGBgYAoKICAgIEBtZXRob2QgcmVtb3ZlRWFjaAogICAgQHBhcmFtIHtF
        bWJlci5FbnVtZXJhYmxlfSBvYmplY3RzIHRoZSBvYmplY3RzIHRvIHJlbW92
        ZS4KICAgIEByZXR1cm4ge0VtYmVyLlNldH0gVGhlIHNldCBpdHNlbGYuCiAg
        Ki8KICByZW1vdmVFYWNoOiBFbWJlci5hbGlhc01ldGhvZCgncmVtb3ZlT2Jq
        ZWN0cycpLAoKICAvLyAuLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4u
        Li4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uCiAgLy8gUFJJVkFURSBFTlVN
        RVJBQkxFIFNVUFBPUlQKICAvLwoKICBpbml0OiBmdW5jdGlvbihpdGVtcykg
        ewogICAgdGhpcy5fc3VwZXIoKTsKICAgIGlmIChpdGVtcykgdGhpcy5hZGRP
        YmplY3RzKGl0ZW1zKTsKICB9LAoKICAvLyBpbXBsZW1lbnQgRW1iZXIuRW51
        bWVyYWJsZQogIG5leHRPYmplY3Q6IGZ1bmN0aW9uKGlkeCkgewogICAgcmV0
        dXJuIHRoaXNbaWR4XTsKICB9LAoKICAvLyBtb3JlIG9wdGltaXplZCB2ZXJz
        aW9uCiAgZmlyc3RPYmplY3Q6IEVtYmVyLmNvbXB1dGVkKGZ1bmN0aW9uKCkg
        ewogICAgcmV0dXJuIHRoaXMubGVuZ3RoID4gMCA/IHRoaXNbMF0gOiB1bmRl
        ZmluZWQ7CiAgfSksCgogIC8vIG1vcmUgb3B0aW1pemVkIHZlcnNpb24KICBs
        YXN0T2JqZWN0OiBFbWJlci5jb21wdXRlZChmdW5jdGlvbigpIHsKICAgIHJl
        dHVybiB0aGlzLmxlbmd0aCA+IDAgPyB0aGlzW3RoaXMubGVuZ3RoLTFdIDog
        dW5kZWZpbmVkOwogIH0pLAoKICAvLyBpbXBsZW1lbnRzIEVtYmVyLk11dGFi
        bGVFbnVtZXJhYmxlCiAgYWRkT2JqZWN0OiBmdW5jdGlvbihvYmopIHsKICAg
        IGlmIChnZXQodGhpcywgJ2lzRnJvemVuJykpIHRocm93IG5ldyBFbWJlci5F
        cnJvcihFbWJlci5GUk9aRU5fRVJST1IpOwogICAgaWYgKGlzTm9uZShvYmop
        KSByZXR1cm4gdGhpczsgLy8gbm90aGluZyB0byBkbwoKICAgIHZhciBndWlk
        ID0gZ3VpZEZvcihvYmopLAogICAgICAgIGlkeCAgPSB0aGlzW2d1aWRdLAog
        ICAgICAgIGxlbiAgPSBnZXQodGhpcywgJ2xlbmd0aCcpLAogICAgICAgIGFk
        ZGVkIDsKCiAgICBpZiAoaWR4Pj0wICYmIGlkeDxsZW4gJiYgKHRoaXNbaWR4
        XSA9PT0gb2JqKSkgcmV0dXJuIHRoaXM7IC8vIGFkZGVkCgogICAgYWRkZWQg
        PSBbb2JqXTsKCiAgICB0aGlzLmVudW1lcmFibGVDb250ZW50V2lsbENoYW5n
        ZShudWxsLCBhZGRlZCk7CiAgICBFbWJlci5wcm9wZXJ0eVdpbGxDaGFuZ2Uo
        dGhpcywgJ2xhc3RPYmplY3QnKTsKCiAgICBsZW4gPSBnZXQodGhpcywgJ2xl
        bmd0aCcpOwogICAgdGhpc1tndWlkXSA9IGxlbjsKICAgIHRoaXNbbGVuXSA9
        IG9iajsKICAgIHNldCh0aGlzLCAnbGVuZ3RoJywgbGVuKzEpOwoKICAgIEVt
        YmVyLnByb3BlcnR5RGlkQ2hhbmdlKHRoaXMsICdsYXN0T2JqZWN0Jyk7CiAg
        ICB0aGlzLmVudW1lcmFibGVDb250ZW50RGlkQ2hhbmdlKG51bGwsIGFkZGVk
        KTsKCiAgICByZXR1cm4gdGhpczsKICB9LAoKICAvLyBpbXBsZW1lbnRzIEVt
        YmVyLk11dGFibGVFbnVtZXJhYmxlCiAgcmVtb3ZlT2JqZWN0OiBmdW5jdGlv
        bihvYmopIHsKICAgIGlmIChnZXQodGhpcywgJ2lzRnJvemVuJykpIHRocm93
        IG5ldyBFbWJlci5FcnJvcihFbWJlci5GUk9aRU5fRVJST1IpOwogICAgaWYg
        KGlzTm9uZShvYmopKSByZXR1cm4gdGhpczsgLy8gbm90aGluZyB0byBkbwoK
        ICAgIHZhciBndWlkID0gZ3VpZEZvcihvYmopLAogICAgICAgIGlkeCAgPSB0
        aGlzW2d1aWRdLAogICAgICAgIGxlbiA9IGdldCh0aGlzLCAnbGVuZ3RoJyks
        CiAgICAgICAgaXNGaXJzdCA9IGlkeCA9PT0gMCwKICAgICAgICBpc0xhc3Qg
        PSBpZHggPT09IGxlbi0xLAogICAgICAgIGxhc3QsIHJlbW92ZWQ7CgoKICAg
        IGlmIChpZHg+PTAgJiYgaWR4PGxlbiAmJiAodGhpc1tpZHhdID09PSBvYmop
        KSB7CiAgICAgIHJlbW92ZWQgPSBbb2JqXTsKCiAgICAgIHRoaXMuZW51bWVy
        YWJsZUNvbnRlbnRXaWxsQ2hhbmdlKHJlbW92ZWQsIG51bGwpOwogICAgICBp
        ZiAoaXNGaXJzdCkgeyBFbWJlci5wcm9wZXJ0eVdpbGxDaGFuZ2UodGhpcywg
        J2ZpcnN0T2JqZWN0Jyk7IH0KICAgICAgaWYgKGlzTGFzdCkgIHsgRW1iZXIu
        cHJvcGVydHlXaWxsQ2hhbmdlKHRoaXMsICdsYXN0T2JqZWN0Jyk7IH0KCiAg
        ICAgIC8vIHN3YXAgaXRlbXMgLSBiYXNpY2FsbHkgbW92ZSB0aGUgaXRlbSB0
        byB0aGUgZW5kIHNvIGl0IGNhbiBiZSByZW1vdmVkCiAgICAgIGlmIChpZHgg
        PCBsZW4tMSkgewogICAgICAgIGxhc3QgPSB0aGlzW2xlbi0xXTsKICAgICAg
        ICB0aGlzW2lkeF0gPSBsYXN0OwogICAgICAgIHRoaXNbZ3VpZEZvcihsYXN0
        KV0gPSBpZHg7CiAgICAgIH0KCiAgICAgIGRlbGV0ZSB0aGlzW2d1aWRdOwog
        ICAgICBkZWxldGUgdGhpc1tsZW4tMV07CiAgICAgIHNldCh0aGlzLCAnbGVu
        Z3RoJywgbGVuLTEpOwoKICAgICAgaWYgKGlzRmlyc3QpIHsgRW1iZXIucHJv
        cGVydHlEaWRDaGFuZ2UodGhpcywgJ2ZpcnN0T2JqZWN0Jyk7IH0KICAgICAg
        aWYgKGlzTGFzdCkgIHsgRW1iZXIucHJvcGVydHlEaWRDaGFuZ2UodGhpcywg
        J2xhc3RPYmplY3QnKTsgfQogICAgICB0aGlzLmVudW1lcmFibGVDb250ZW50
        RGlkQ2hhbmdlKHJlbW92ZWQsIG51bGwpOwogICAgfQoKICAgIHJldHVybiB0
        aGlzOwogIH0sCgogIC8vIG9wdGltaXplZCB2ZXJzaW9uCiAgY29udGFpbnM6
        IGZ1bmN0aW9uKG9iaikgewogICAgcmV0dXJuIHRoaXNbZ3VpZEZvcihvYmop
        XT49MDsKICB9LAoKICBjb3B5OiBmdW5jdGlvbigpIHsKICAgIHZhciBDID0g
        dGhpcy5jb25zdHJ1Y3RvciwgcmV0ID0gbmV3IEMoKSwgbG9jID0gZ2V0KHRo
        aXMsICdsZW5ndGgnKTsKICAgIHNldChyZXQsICdsZW5ndGgnLCBsb2MpOwog
        ICAgd2hpbGUoLS1sb2M+PTApIHsKICAgICAgcmV0W2xvY10gPSB0aGlzW2xv
        Y107CiAgICAgIHJldFtndWlkRm9yKHRoaXNbbG9jXSldID0gbG9jOwogICAg
        fQogICAgcmV0dXJuIHJldDsKICB9LAoKICB0b1N0cmluZzogZnVuY3Rpb24o
        KSB7CiAgICB2YXIgbGVuID0gdGhpcy5sZW5ndGgsIGlkeCwgYXJyYXkgPSBb
        XTsKICAgIGZvcihpZHggPSAwOyBpZHggPCBsZW47IGlkeCsrKSB7CiAgICAg
        IGFycmF5W2lkeF0gPSB0aGlzW2lkeF07CiAgICB9CiAgICByZXR1cm4gZm10
        KCJFbWJlci5TZXQ8JUA+IiwgW2FycmF5LmpvaW4oJywnKV0pOwogIH0KCn0p
        OwoKfSkoKTsKCgoKKGZ1bmN0aW9uKCkgewp2YXIgRGVmZXJyZWRNaXhpbiA9
        IEVtYmVyLkRlZmVycmVkTWl4aW4sIC8vIG1peGlucy9kZWZlcnJlZAogICAg
        Z2V0ID0gRW1iZXIuZ2V0OwoKdmFyIERlZmVycmVkID0gRW1iZXIuT2JqZWN0
        LmV4dGVuZChEZWZlcnJlZE1peGluKTsKCkRlZmVycmVkLnJlb3BlbkNsYXNz
        KHsKICBwcm9taXNlOiBmdW5jdGlvbihjYWxsYmFjaywgYmluZGluZykgewog
        ICAgdmFyIGRlZmVycmVkID0gRGVmZXJyZWQuY3JlYXRlKCk7CiAgICBjYWxs
        YmFjay5jYWxsKGJpbmRpbmcsIGRlZmVycmVkKTsKICAgIHJldHVybiBkZWZl
        cnJlZDsKICB9Cn0pOwoKRW1iZXIuRGVmZXJyZWQgPSBEZWZlcnJlZDsKCn0p
        KCk7CgoKCihmdW5jdGlvbigpIHsKdmFyIGZvckVhY2ggPSBFbWJlci5BcnJh
        eVBvbHlmaWxscy5mb3JFYWNoOwoKLyoqCkBtb2R1bGUgZW1iZXIKQHN1Ym1v
        ZHVsZSBlbWJlci1ydW50aW1lCiovCgp2YXIgbG9hZEhvb2tzID0gRW1iZXIu
        RU5WLkVNQkVSX0xPQURfSE9PS1MgfHwge307CnZhciBsb2FkZWQgPSB7fTsK
        Ci8qKgoKRGV0ZWN0cyB3aGVuIGEgc3BlY2lmaWMgcGFja2FnZSBvZiBFbWJl
        ciAoZS5nLiAnRW1iZXIuSGFuZGxlYmFycycpCmhhcyBmdWxseSBsb2FkZWQg
        YW5kIGlzIGF2YWlsYWJsZSBmb3IgZXh0ZW5zaW9uLgoKVGhlIHByb3ZpZGVk
        IGBjYWxsYmFja2Agd2lsbCBiZSBjYWxsZWQgd2l0aCB0aGUgYG5hbWVgIHBh
        c3NlZApyZXNvbHZlZCBmcm9tIGEgc3RyaW5nIGludG8gdGhlIG9iamVjdDoK
        CmBgYGphdmFzY3JpcHQKRW1iZXIub25Mb2FkKCdFbWJlci5IYW5kbGViYXJz
        JyBmdW5jdGlvbihoYmFycyl7CiAgaGJhcnMucmVnaXN0ZXJIZWxwZXIoLi4u
        KTsKfSk7CmBgYAoKCkBtZXRob2Qgb25Mb2FkCkBmb3IgRW1iZXIKQHBhcmFt
        IG5hbWUge1N0cmluZ30gbmFtZSBvZiBob29rCkBwYXJhbSBjYWxsYmFjayB7
        RnVuY3Rpb259IGNhbGxiYWNrIHRvIGJlIGNhbGxlZAoqLwpFbWJlci5vbkxv
        YWQgPSBmdW5jdGlvbihuYW1lLCBjYWxsYmFjaykgewogIHZhciBvYmplY3Q7
        CgogIGxvYWRIb29rc1tuYW1lXSA9IGxvYWRIb29rc1tuYW1lXSB8fCBFbWJl
        ci5BKCk7CiAgbG9hZEhvb2tzW25hbWVdLnB1c2hPYmplY3QoY2FsbGJhY2sp
        OwoKICBpZiAob2JqZWN0ID0gbG9hZGVkW25hbWVdKSB7CiAgICBjYWxsYmFj
        ayhvYmplY3QpOwogIH0KfTsKCi8qKgoKQ2FsbGVkIHdoZW4gYW4gRW1iZXIu
        anMgcGFja2FnZSAoZS5nIEVtYmVyLkhhbmRsZWJhcnMpIGhhcyBmaW5pc2hl
        ZApsb2FkaW5nLiBUcmlnZ2VycyBhbnkgY2FsbGJhY2tzIHJlZ2lzdGVyZWQg
        Zm9yIHRoaXMgZXZlbnQuCgpAbWV0aG9kIHJ1bkxvYWRIb29rcwpAZm9yIEVt
        YmVyCkBwYXJhbSBuYW1lIHtTdHJpbmd9IG5hbWUgb2YgaG9vawpAcGFyYW0g
        b2JqZWN0IHtPYmplY3R9IG9iamVjdCB0byBwYXNzIHRvIGNhbGxiYWNrcwoq
        LwpFbWJlci5ydW5Mb2FkSG9va3MgPSBmdW5jdGlvbihuYW1lLCBvYmplY3Qp
        IHsKICBsb2FkZWRbbmFtZV0gPSBvYmplY3Q7CgogIGlmIChsb2FkSG9va3Nb
        bmFtZV0pIHsKICAgIGZvckVhY2guY2FsbChsb2FkSG9va3NbbmFtZV0sIGZ1
        bmN0aW9uKGNhbGxiYWNrKSB7CiAgICAgIGNhbGxiYWNrKG9iamVjdCk7CiAg
        ICB9KTsKICB9Cn07Cgp9KSgpOwoKCgooZnVuY3Rpb24oKSB7Cgp9KSgpOwoK
        CgooZnVuY3Rpb24oKSB7CnZhciBnZXQgPSBFbWJlci5nZXQ7CgovKioKQG1v
        ZHVsZSBlbWJlcgpAc3VibW9kdWxlIGVtYmVyLXJ1bnRpbWUKKi8KCi8qKgog
        IGBFbWJlci5Db250cm9sbGVyTWl4aW5gIHByb3ZpZGVzIGEgc3RhbmRhcmQg
        aW50ZXJmYWNlIGZvciBhbGwgY2xhc3NlcyB0aGF0CiAgY29tcG9zZSBFbWJl
        cidzIGNvbnRyb2xsZXIgbGF5ZXI6IGBFbWJlci5Db250cm9sbGVyYCwKICBg
        RW1iZXIuQXJyYXlDb250cm9sbGVyYCwgYW5kIGBFbWJlci5PYmplY3RDb250
        cm9sbGVyYC4KCiAgQGNsYXNzIENvbnRyb2xsZXJNaXhpbgogIEBuYW1lc3Bh
        Y2UgRW1iZXIKKi8KRW1iZXIuQ29udHJvbGxlck1peGluID0gRW1iZXIuTWl4
        aW4uY3JlYXRlKEVtYmVyLkFjdGlvbkhhbmRsZXIsIHsKICAvKiBkdWNrdHlw
        ZSBhcyBhIGNvbnRyb2xsZXIgKi8KICBpc0NvbnRyb2xsZXI6IHRydWUsCgog
        IC8qKgogICAgVGhlIG9iamVjdCB0byB3aGljaCBhY3Rpb25zIGZyb20gdGhl
        IHZpZXcgc2hvdWxkIGJlIHNlbnQuCgogICAgRm9yIGV4YW1wbGUsIHdoZW4g
        YSBIYW5kbGViYXJzIHRlbXBsYXRlIHVzZXMgdGhlIGB7e2FjdGlvbn19YCBo
        ZWxwZXIsCiAgICBpdCB3aWxsIGF0dGVtcHQgdG8gc2VuZCB0aGUgYWN0aW9u
        IHRvIHRoZSB2aWV3J3MgY29udHJvbGxlcidzIGB0YXJnZXRgLgoKICAgIEJ5
        IGRlZmF1bHQsIGEgY29udHJvbGxlcidzIGB0YXJnZXRgIGlzIHNldCB0byB0
        aGUgcm91dGVyIGFmdGVyIGl0IGlzCiAgICBpbnN0YW50aWF0ZWQgYnkgYEVt
        YmVyLkFwcGxpY2F0aW9uI2luaXRpYWxpemVgLgoKICAgIEBwcm9wZXJ0eSB0
        YXJnZXQKICAgIEBkZWZhdWx0IG51bGwKICAqLwogIHRhcmdldDogbnVsbCwK
        CiAgY29udGFpbmVyOiBudWxsLAoKICBwYXJlbnRDb250cm9sbGVyOiBudWxs
        LAoKICBzdG9yZTogbnVsbCwKCiAgbW9kZWw6IEVtYmVyLmNvbXB1dGVkLmFs
        aWFzKCdjb250ZW50JyksCgogIGRlcHJlY2F0ZWRTZW5kSGFuZGxlczogZnVu
        Y3Rpb24oYWN0aW9uTmFtZSkgewogICAgcmV0dXJuICEhdGhpc1thY3Rpb25O
        YW1lXTsKICB9LAoKICBkZXByZWNhdGVkU2VuZDogZnVuY3Rpb24oYWN0aW9u
        TmFtZSkgewogICAgdmFyIGFyZ3MgPSBbXS5zbGljZS5jYWxsKGFyZ3VtZW50
        cywgMSk7CiAgICBFbWJlci5hc3NlcnQoJycgKyB0aGlzICsgIiBoYXMgdGhl
        IGFjdGlvbiAiICsgYWN0aW9uTmFtZSArICIgYnV0IGl0IGlzIG5vdCBhIGZ1
        bmN0aW9uIiwgdHlwZW9mIHRoaXNbYWN0aW9uTmFtZV0gPT09ICdmdW5jdGlv
        bicpOwogICAgRW1iZXIuZGVwcmVjYXRlKCdBY3Rpb24gaGFuZGxlcnMgaW1w
        bGVtZW50ZWQgZGlyZWN0bHkgb24gY29udHJvbGxlcnMgYXJlIGRlcHJlY2F0
        ZWQgaW4gZmF2b3Igb2YgYWN0aW9uIGhhbmRsZXJzIG9uIGFuIGBhY3Rpb25z
        YCBvYmplY3QgKCcgKyBhY3Rpb25OYW1lICsgJyBvbiAnICsgdGhpcyArICcp
        JywgZmFsc2UpOwogICAgdGhpc1thY3Rpb25OYW1lXS5hcHBseSh0aGlzLCBh
        cmdzKTsKICAgIHJldHVybjsKICB9Cn0pOwoKLyoqCiAgQGNsYXNzIENvbnRy
        b2xsZXIKICBAbmFtZXNwYWNlIEVtYmVyCiAgQGV4dGVuZHMgRW1iZXIuT2Jq
        ZWN0CiAgQHVzZXMgRW1iZXIuQ29udHJvbGxlck1peGluCiovCkVtYmVyLkNv
        bnRyb2xsZXIgPSBFbWJlci5PYmplY3QuZXh0ZW5kKEVtYmVyLkNvbnRyb2xs
        ZXJNaXhpbik7Cgp9KSgpOwoKCgooZnVuY3Rpb24oKSB7Ci8qKgpAbW9kdWxl
        IGVtYmVyCkBzdWJtb2R1bGUgZW1iZXItcnVudGltZQoqLwoKdmFyIGdldCA9
        IEVtYmVyLmdldCwgc2V0ID0gRW1iZXIuc2V0LCBmb3JFYWNoID0gRW1iZXIu
        RW51bWVyYWJsZVV0aWxzLmZvckVhY2g7CgovKioKICBgRW1iZXIuU29ydGFi
        bGVNaXhpbmAgcHJvdmlkZXMgYSBzdGFuZGFyZCBpbnRlcmZhY2UgZm9yIGFy
        cmF5IHByb3hpZXMKICB0byBzcGVjaWZ5IGEgc29ydCBvcmRlciBhbmQgbWFp
        bnRhaW4gdGhpcyBzb3J0aW5nIHdoZW4gb2JqZWN0cyBhcmUgYWRkZWQsCiAg
        cmVtb3ZlZCwgb3IgdXBkYXRlZCB3aXRob3V0IGNoYW5naW5nIHRoZSBpbXBs
        aWNpdCBvcmRlciBvZiB0aGVpciB1bmRlcmx5aW5nCiAgY29udGVudCBhcnJh
        eToKCiAgYGBgamF2YXNjcmlwdAogIHNvbmdzID0gWwogICAge3RyYWNrTnVt
        YmVyOiA0LCB0aXRsZTogJ09iLUxhLURpLCBPYi1MYS1EYSd9LAogICAge3Ry
        YWNrTnVtYmVyOiAyLCB0aXRsZTogJ0JhY2sgaW4gdGhlIFUuUy5TLlIuJ30s
        CiAgICB7dHJhY2tOdW1iZXI6IDMsIHRpdGxlOiAnR2xhc3MgT25pb24nfSwK
        ICBdOwoKICBzb25nc0NvbnRyb2xsZXIgPSBFbWJlci5BcnJheUNvbnRyb2xs
        ZXIuY3JlYXRlKHsKICAgIGNvbnRlbnQ6IHNvbmdzLAogICAgc29ydFByb3Bl
        cnRpZXM6IFsndHJhY2tOdW1iZXInXSwKICAgIHNvcnRBc2NlbmRpbmc6IHRy
        dWUKICB9KTsKCiAgc29uZ3NDb250cm9sbGVyLmdldCgnZmlyc3RPYmplY3Qn
        KTsgIC8vIHt0cmFja051bWJlcjogMiwgdGl0bGU6ICdCYWNrIGluIHRoZSBV
        LlMuUy5SLid9CgogIHNvbmdzQ29udHJvbGxlci5hZGRPYmplY3Qoe3RyYWNr
        TnVtYmVyOiAxLCB0aXRsZTogJ0RlYXIgUHJ1ZGVuY2UnfSk7CiAgc29uZ3ND
        b250cm9sbGVyLmdldCgnZmlyc3RPYmplY3QnKTsgIC8vIHt0cmFja051bWJl
        cjogMSwgdGl0bGU6ICdEZWFyIFBydWRlbmNlJ30KICBgYGAKCiAgSWYgeW91
        IGFkZCBvciByZW1vdmUgdGhlIHByb3BlcnRpZXMgdG8gc29ydCBieSBvciBj
        aGFuZ2UgdGhlIHNvcnQgZGlyZWN0aW9uIHRoZSBjb250ZW50CiAgc29ydCBv
        cmRlciB3aWxsIGJlIGF1dG9tYXRpY2FsbHkgdXBkYXRlZC4KCiAgYGBgamF2
        YXNjcmlwdAogIHNvbmdzQ29udHJvbGxlci5zZXQoJ3NvcnRQcm9wZXJ0aWVz
        JywgWyd0aXRsZSddKTsKICBzb25nc0NvbnRyb2xsZXIuZ2V0KCdmaXJzdE9i
        amVjdCcpOyAvLyB7dHJhY2tOdW1iZXI6IDIsIHRpdGxlOiAnQmFjayBpbiB0
        aGUgVS5TLlMuUi4nfQoKICBzb25nc0NvbnRyb2xsZXIudG9nZ2xlUHJvcGVy
        dHkoJ3NvcnRBc2NlbmRpbmcnKTsKICBzb25nc0NvbnRyb2xsZXIuZ2V0KCdm
        aXJzdE9iamVjdCcpOyAvLyB7dHJhY2tOdW1iZXI6IDQsIHRpdGxlOiAnT2It
        TGEtRGksIE9iLUxhLURhJ30KICBgYGAKCiAgU29ydGFibGVNaXhpbiB3b3Jr
        cyBieSBzb3J0aW5nIHRoZSBhcnJhbmdlZENvbnRlbnQgYXJyYXksIHdoaWNo
        IGlzIHRoZSBhcnJheSB0aGF0CiAgYXJyYXlQcm94eSBkaXNwbGF5cy4gRHVl
        IHRvIHRoZSBmYWN0IHRoYXQgdGhlIHVuZGVybHlpbmcgJ2NvbnRlbnQnIGFy
        cmF5IGlzIG5vdCBjaGFuZ2VkLCB0aGF0CiAgYXJyYXkgd2lsbCBub3QgZGlz
        cGxheSB0aGUgc29ydGVkIGxpc3Q6CgogICBgYGBqYXZhc2NyaXB0CiAgc29u
        Z3NDb250cm9sbGVyLmdldCgnY29udGVudCcpLmdldCgnZmlyc3RPYmplY3Qn
        KTsgLy8gUmV0dXJucyB0aGUgdW5zb3J0ZWQgb3JpZ2luYWwgY29udGVudAog
        IHNvbmdzQ29udHJvbGxlci5nZXQoJ2ZpcnN0T2JqZWN0Jyk7IC8vIFJldHVy
        bnMgdGhlIHNvcnRlZCBjb250ZW50LgogIGBgYCAKICAKICBBbHRob3VnaCB0
        aGUgc29ydGVkIGNvbnRlbnQgY2FuIGFsc28gYmUgYWNjZXNzZWQgdGhyb3Vn
        aCB0aGUgYXJyYW5nZWRDb250ZW50IHByb3BlcnR5LAogIGl0IGlzIHByZWZl
        cmFibGUgdG8gdXNlIHRoZSBwcm94aWVkIGNsYXNzIGFuZCBub3QgdGhlIGFy
        cmFuZ2VkQ29udGVudCBhcnJheSBkaXJlY3RseS4KCiAgQGNsYXNzIFNvcnRh
        YmxlTWl4aW4KICBAbmFtZXNwYWNlIEVtYmVyCiAgQHVzZXMgRW1iZXIuTXV0
        YWJsZUVudW1lcmFibGUKKi8KRW1iZXIuU29ydGFibGVNaXhpbiA9IEVtYmVy
        Lk1peGluLmNyZWF0ZShFbWJlci5NdXRhYmxlRW51bWVyYWJsZSwgewoKICAv
        KioKICAgIFNwZWNpZmllcyB3aGljaCBwcm9wZXJ0aWVzIGRpY3RhdGUgdGhl
        IGFycmFuZ2VkQ29udGVudCdzIHNvcnQgb3JkZXIuCgogICAgV2hlbiBzcGVj
        aWZ5aW5nIG11bHRpcGxlIHByb3BlcnRpZXMgdGhlIHNvcnRpbmcgd2lsbCB1
        c2UgcHJvcGVydGllcwogICAgZnJvbSB0aGUgYHNvcnRQcm9wZXJ0aWVzYCBh
        cnJheSBwcmlvcml0aXplZCBmcm9tIGZpcnN0IHRvIGxhc3QuCgogICAgQHBy
        b3BlcnR5IHtBcnJheX0gc29ydFByb3BlcnRpZXMKICAqLwogIHNvcnRQcm9w
        ZXJ0aWVzOiBudWxsLAoKICAvKioKICAgIFNwZWNpZmllcyB0aGUgYXJyYW5n
        ZWRDb250ZW50J3Mgc29ydCBkaXJlY3Rpb24KCiAgICBAcHJvcGVydHkge0Jv
        b2xlYW59IHNvcnRBc2NlbmRpbmcKICAqLwogIHNvcnRBc2NlbmRpbmc6IHRy
        dWUsCgogIC8qKgogICAgVGhlIGZ1bmN0aW9uIHVzZWQgdG8gY29tcGFyZSB0
        d28gdmFsdWVzLiBZb3UgY2FuIG92ZXJyaWRlIHRoaXMgaWYgeW91CiAgICB3
        YW50IHRvIGRvIGN1c3RvbSBjb21wYXJpc29ucy4gRnVuY3Rpb25zIG11c3Qg
        YmUgb2YgdGhlIHR5cGUgZXhwZWN0ZWQgYnkKICAgIEFycmF5I3NvcnQsIGku
        ZS4KICAgICAgcmV0dXJuIDAgaWYgdGhlIHR3byBwYXJhbWV0ZXJzIGFyZSBl
        cXVhbCwKICAgICAgcmV0dXJuIGEgbmVnYXRpdmUgdmFsdWUgaWYgdGhlIGZp
        cnN0IHBhcmFtZXRlciBpcyBzbWFsbGVyIHRoYW4gdGhlIHNlY29uZCBvcgog
        ICAgICByZXR1cm4gYSBwb3NpdGl2ZSB2YWx1ZSBvdGhlcndpc2U6CgogICAg
        YGBgamF2YXNjcmlwdAogICAgZnVuY3Rpb24oeCx5KSB7IC8vIFRoZXNlIGFy
        ZSBhc3N1bWVkIHRvIGJlIGludGVnZXJzCiAgICAgIGlmICh4ID09PSB5KQog
        ICAgICAgIHJldHVybiAwOwogICAgICByZXR1cm4geCA8IHkgPyAtMSA6IDE7
        CiAgICB9CiAgICBgYGAKCiAgICBAcHJvcGVydHkgc29ydEZ1bmN0aW9uCiAg
        ICBAdHlwZSB7RnVuY3Rpb259CiAgICBAZGVmYXVsdCBFbWJlci5jb21wYXJl
        CiAgKi8KICBzb3J0RnVuY3Rpb246IEVtYmVyLmNvbXBhcmUsCgogIG9yZGVy
        Qnk6IGZ1bmN0aW9uKGl0ZW0xLCBpdGVtMikgewogICAgdmFyIHJlc3VsdCA9
        IDAsCiAgICAgICAgc29ydFByb3BlcnRpZXMgPSBnZXQodGhpcywgJ3NvcnRQ
        cm9wZXJ0aWVzJyksCiAgICAgICAgc29ydEFzY2VuZGluZyA9IGdldCh0aGlz
        LCAnc29ydEFzY2VuZGluZycpLAogICAgICAgIHNvcnRGdW5jdGlvbiA9IGdl
        dCh0aGlzLCAnc29ydEZ1bmN0aW9uJyk7CgogICAgRW1iZXIuYXNzZXJ0KCJ5
        b3UgbmVlZCB0byBkZWZpbmUgYHNvcnRQcm9wZXJ0aWVzYCIsICEhc29ydFBy
        b3BlcnRpZXMpOwoKICAgIGZvckVhY2goc29ydFByb3BlcnRpZXMsIGZ1bmN0
        aW9uKHByb3BlcnR5TmFtZSkgewogICAgICBpZiAocmVzdWx0ID09PSAwKSB7
        CiAgICAgICAgcmVzdWx0ID0gc29ydEZ1bmN0aW9uKGdldChpdGVtMSwgcHJv
        cGVydHlOYW1lKSwgZ2V0KGl0ZW0yLCBwcm9wZXJ0eU5hbWUpKTsKICAgICAg
        ICBpZiAoKHJlc3VsdCAhPT0gMCkgJiYgIXNvcnRBc2NlbmRpbmcpIHsKICAg
        ICAgICAgIHJlc3VsdCA9ICgtMSkgKiByZXN1bHQ7CiAgICAgICAgfQogICAg
        ICB9CiAgICB9KTsKCiAgICByZXR1cm4gcmVzdWx0OwogIH0sCgogIGRlc3Ry
        b3k6IGZ1bmN0aW9uKCkgewogICAgdmFyIGNvbnRlbnQgPSBnZXQodGhpcywg
        J2NvbnRlbnQnKSwKICAgICAgICBzb3J0UHJvcGVydGllcyA9IGdldCh0aGlz
        LCAnc29ydFByb3BlcnRpZXMnKTsKCiAgICBpZiAoY29udGVudCAmJiBzb3J0
        UHJvcGVydGllcykgewogICAgICBmb3JFYWNoKGNvbnRlbnQsIGZ1bmN0aW9u
        KGl0ZW0pIHsKICAgICAgICBmb3JFYWNoKHNvcnRQcm9wZXJ0aWVzLCBmdW5j
        dGlvbihzb3J0UHJvcGVydHkpIHsKICAgICAgICAgIEVtYmVyLnJlbW92ZU9i
        c2VydmVyKGl0ZW0sIHNvcnRQcm9wZXJ0eSwgdGhpcywgJ2NvbnRlbnRJdGVt
        U29ydFByb3BlcnR5RGlkQ2hhbmdlJyk7CiAgICAgICAgfSwgdGhpcyk7CiAg
        ICAgIH0sIHRoaXMpOwogICAgfQoKICAgIHJldHVybiB0aGlzLl9zdXBlcigp
        OwogIH0sCgogIGlzU29ydGVkOiBFbWJlci5jb21wdXRlZC5ib29sKCdzb3J0
        UHJvcGVydGllcycpLAoKICAvKioKICAgIE92ZXJyaWRlcyB0aGUgZGVmYXVs
        dCBhcnJhbmdlZENvbnRlbnQgZnJvbSBhcnJheVByb3h5IGluIG9yZGVyIHRv
        IHNvcnQgYnkgc29ydEZ1bmN0aW9uLgogICAgQWxzbyBzZXRzIHVwIG9ic2Vy
        dmVycyBmb3IgZWFjaCBzb3J0UHJvcGVydHkgb24gZWFjaCBpdGVtIGluIHRo
        ZSBjb250ZW50IEFycmF5LgogICAgCiAgICBAcHJvcGVydHkgYXJyYW5nZWRD
        b250ZW50CiAgKi8KCiAgYXJyYW5nZWRDb250ZW50OiBFbWJlci5jb21wdXRl
        ZCgnY29udGVudCcsICdzb3J0UHJvcGVydGllcy5AZWFjaCcsIGZ1bmN0aW9u
        KGtleSwgdmFsdWUpIHsKICAgIHZhciBjb250ZW50ID0gZ2V0KHRoaXMsICdj
        b250ZW50JyksCiAgICAgICAgaXNTb3J0ZWQgPSBnZXQodGhpcywgJ2lzU29y
        dGVkJyksCiAgICAgICAgc29ydFByb3BlcnRpZXMgPSBnZXQodGhpcywgJ3Nv
        cnRQcm9wZXJ0aWVzJyksCiAgICAgICAgc2VsZiA9IHRoaXM7CgogICAgaWYg
        KGNvbnRlbnQgJiYgaXNTb3J0ZWQpIHsKICAgICAgY29udGVudCA9IGNvbnRl
        bnQuc2xpY2UoKTsKICAgICAgY29udGVudC5zb3J0KGZ1bmN0aW9uKGl0ZW0x
        LCBpdGVtMikgewogICAgICAgIHJldHVybiBzZWxmLm9yZGVyQnkoaXRlbTEs
        IGl0ZW0yKTsKICAgICAgfSk7CiAgICAgIGZvckVhY2goY29udGVudCwgZnVu
        Y3Rpb24oaXRlbSkgewogICAgICAgIGZvckVhY2goc29ydFByb3BlcnRpZXMs
        IGZ1bmN0aW9uKHNvcnRQcm9wZXJ0eSkgewogICAgICAgICAgRW1iZXIuYWRk
        T2JzZXJ2ZXIoaXRlbSwgc29ydFByb3BlcnR5LCB0aGlzLCAnY29udGVudEl0
        ZW1Tb3J0UHJvcGVydHlEaWRDaGFuZ2UnKTsKICAgICAgICB9LCB0aGlzKTsK
        ICAgICAgfSwgdGhpcyk7CiAgICAgIHJldHVybiBFbWJlci5BKGNvbnRlbnQp
        OwogICAgfQoKICAgIHJldHVybiBjb250ZW50OwogIH0pLAoKICBfY29udGVu
        dFdpbGxDaGFuZ2U6IEVtYmVyLmJlZm9yZU9ic2VydmVyKGZ1bmN0aW9uKCkg
        ewogICAgdmFyIGNvbnRlbnQgPSBnZXQodGhpcywgJ2NvbnRlbnQnKSwKICAg
        ICAgICBzb3J0UHJvcGVydGllcyA9IGdldCh0aGlzLCAnc29ydFByb3BlcnRp
        ZXMnKTsKCiAgICBpZiAoY29udGVudCAmJiBzb3J0UHJvcGVydGllcykgewog
        ICAgICBmb3JFYWNoKGNvbnRlbnQsIGZ1bmN0aW9uKGl0ZW0pIHsKICAgICAg
        ICBmb3JFYWNoKHNvcnRQcm9wZXJ0aWVzLCBmdW5jdGlvbihzb3J0UHJvcGVy
        dHkpIHsKICAgICAgICAgIEVtYmVyLnJlbW92ZU9ic2VydmVyKGl0ZW0sIHNv
        cnRQcm9wZXJ0eSwgdGhpcywgJ2NvbnRlbnRJdGVtU29ydFByb3BlcnR5RGlk
        Q2hhbmdlJyk7CiAgICAgICAgfSwgdGhpcyk7CiAgICAgIH0sIHRoaXMpOwog
        ICAgfQoKICAgIHRoaXMuX3N1cGVyKCk7CiAgfSwgJ2NvbnRlbnQnKSwKCiAg
        c29ydEFzY2VuZGluZ1dpbGxDaGFuZ2U6IEVtYmVyLmJlZm9yZU9ic2VydmVy
        KGZ1bmN0aW9uKCkgewogICAgdGhpcy5fbGFzdFNvcnRBc2NlbmRpbmcgPSBn
        ZXQodGhpcywgJ3NvcnRBc2NlbmRpbmcnKTsKICB9LCAnc29ydEFzY2VuZGlu
        ZycpLAoKICBzb3J0QXNjZW5kaW5nRGlkQ2hhbmdlOiBFbWJlci5vYnNlcnZl
        cihmdW5jdGlvbigpIHsKICAgIGlmIChnZXQodGhpcywgJ3NvcnRBc2NlbmRp
        bmcnKSAhPT0gdGhpcy5fbGFzdFNvcnRBc2NlbmRpbmcpIHsKICAgICAgdmFy
        IGFycmFuZ2VkQ29udGVudCA9IGdldCh0aGlzLCAnYXJyYW5nZWRDb250ZW50
        Jyk7CiAgICAgIGFycmFuZ2VkQ29udGVudC5yZXZlcnNlT2JqZWN0cygpOwog
        ICAgfQogIH0sICdzb3J0QXNjZW5kaW5nJyksCgogIGNvbnRlbnRBcnJheVdp
        bGxDaGFuZ2U6IGZ1bmN0aW9uKGFycmF5LCBpZHgsIHJlbW92ZWRDb3VudCwg
        YWRkZWRDb3VudCkgewogICAgdmFyIGlzU29ydGVkID0gZ2V0KHRoaXMsICdp
        c1NvcnRlZCcpOwoKICAgIGlmIChpc1NvcnRlZCkgewogICAgICB2YXIgYXJy
        YW5nZWRDb250ZW50ID0gZ2V0KHRoaXMsICdhcnJhbmdlZENvbnRlbnQnKTsK
        ICAgICAgdmFyIHJlbW92ZWRPYmplY3RzID0gYXJyYXkuc2xpY2UoaWR4LCBp
        ZHgrcmVtb3ZlZENvdW50KTsKICAgICAgdmFyIHNvcnRQcm9wZXJ0aWVzID0g
        Z2V0KHRoaXMsICdzb3J0UHJvcGVydGllcycpOwoKICAgICAgZm9yRWFjaChy
        ZW1vdmVkT2JqZWN0cywgZnVuY3Rpb24oaXRlbSkgewogICAgICAgIGFycmFu
        Z2VkQ29udGVudC5yZW1vdmVPYmplY3QoaXRlbSk7CgogICAgICAgIGZvckVh
        Y2goc29ydFByb3BlcnRpZXMsIGZ1bmN0aW9uKHNvcnRQcm9wZXJ0eSkgewog
        ICAgICAgICAgRW1iZXIucmVtb3ZlT2JzZXJ2ZXIoaXRlbSwgc29ydFByb3Bl
        cnR5LCB0aGlzLCAnY29udGVudEl0ZW1Tb3J0UHJvcGVydHlEaWRDaGFuZ2Un
        KTsKICAgICAgICB9LCB0aGlzKTsKICAgICAgfSwgdGhpcyk7CiAgICB9Cgog
        ICAgcmV0dXJuIHRoaXMuX3N1cGVyKGFycmF5LCBpZHgsIHJlbW92ZWRDb3Vu
        dCwgYWRkZWRDb3VudCk7CiAgfSwKCiAgY29udGVudEFycmF5RGlkQ2hhbmdl
        OiBmdW5jdGlvbihhcnJheSwgaWR4LCByZW1vdmVkQ291bnQsIGFkZGVkQ291
        bnQpIHsKICAgIHZhciBpc1NvcnRlZCA9IGdldCh0aGlzLCAnaXNTb3J0ZWQn
        KSwKICAgICAgICBzb3J0UHJvcGVydGllcyA9IGdldCh0aGlzLCAnc29ydFBy
        b3BlcnRpZXMnKTsKCiAgICBpZiAoaXNTb3J0ZWQpIHsKICAgICAgdmFyIGFk
        ZGVkT2JqZWN0cyA9IGFycmF5LnNsaWNlKGlkeCwgaWR4K2FkZGVkQ291bnQp
        OwoKICAgICAgZm9yRWFjaChhZGRlZE9iamVjdHMsIGZ1bmN0aW9uKGl0ZW0p
        IHsKICAgICAgICB0aGlzLmluc2VydEl0ZW1Tb3J0ZWQoaXRlbSk7CgogICAg
        ICAgIGZvckVhY2goc29ydFByb3BlcnRpZXMsIGZ1bmN0aW9uKHNvcnRQcm9w
        ZXJ0eSkgewogICAgICAgICAgRW1iZXIuYWRkT2JzZXJ2ZXIoaXRlbSwgc29y
        dFByb3BlcnR5LCB0aGlzLCAnY29udGVudEl0ZW1Tb3J0UHJvcGVydHlEaWRD
        aGFuZ2UnKTsKICAgICAgICB9LCB0aGlzKTsKICAgICAgfSwgdGhpcyk7CiAg
        ICB9CgogICAgcmV0dXJuIHRoaXMuX3N1cGVyKGFycmF5LCBpZHgsIHJlbW92
        ZWRDb3VudCwgYWRkZWRDb3VudCk7CiAgfSwKCiAgaW5zZXJ0SXRlbVNvcnRl
        ZDogZnVuY3Rpb24oaXRlbSkgewogICAgdmFyIGFycmFuZ2VkQ29udGVudCA9
        IGdldCh0aGlzLCAnYXJyYW5nZWRDb250ZW50Jyk7CiAgICB2YXIgbGVuZ3Ro
        ID0gZ2V0KGFycmFuZ2VkQ29udGVudCwgJ2xlbmd0aCcpOwoKICAgIHZhciBp
        ZHggPSB0aGlzLl9iaW5hcnlTZWFyY2goaXRlbSwgMCwgbGVuZ3RoKTsKICAg
        IGFycmFuZ2VkQ29udGVudC5pbnNlcnRBdChpZHgsIGl0ZW0pOwogIH0sCgog
        IGNvbnRlbnRJdGVtU29ydFByb3BlcnR5RGlkQ2hhbmdlOiBmdW5jdGlvbihp
        dGVtKSB7CiAgICB2YXIgYXJyYW5nZWRDb250ZW50ID0gZ2V0KHRoaXMsICdh
        cnJhbmdlZENvbnRlbnQnKSwKICAgICAgICBvbGRJbmRleCA9IGFycmFuZ2Vk
        Q29udGVudC5pbmRleE9mKGl0ZW0pLAogICAgICAgIGxlZnRJdGVtID0gYXJy
        YW5nZWRDb250ZW50Lm9iamVjdEF0KG9sZEluZGV4IC0gMSksCiAgICAgICAg
        cmlnaHRJdGVtID0gYXJyYW5nZWRDb250ZW50Lm9iamVjdEF0KG9sZEluZGV4
        ICsgMSksCiAgICAgICAgbGVmdFJlc3VsdCA9IGxlZnRJdGVtICYmIHRoaXMu
        b3JkZXJCeShpdGVtLCBsZWZ0SXRlbSksCiAgICAgICAgcmlnaHRSZXN1bHQg
        PSByaWdodEl0ZW0gJiYgdGhpcy5vcmRlckJ5KGl0ZW0sIHJpZ2h0SXRlbSk7
        CgogICAgaWYgKGxlZnRSZXN1bHQgPCAwIHx8IHJpZ2h0UmVzdWx0ID4gMCkg
        ewogICAgICBhcnJhbmdlZENvbnRlbnQucmVtb3ZlT2JqZWN0KGl0ZW0pOwog
        ICAgICB0aGlzLmluc2VydEl0ZW1Tb3J0ZWQoaXRlbSk7CiAgICB9CiAgfSwK
        CiAgX2JpbmFyeVNlYXJjaDogZnVuY3Rpb24oaXRlbSwgbG93LCBoaWdoKSB7
        CiAgICB2YXIgbWlkLCBtaWRJdGVtLCByZXMsIGFycmFuZ2VkQ29udGVudDsK
        CiAgICBpZiAobG93ID09PSBoaWdoKSB7CiAgICAgIHJldHVybiBsb3c7CiAg
        ICB9CgogICAgYXJyYW5nZWRDb250ZW50ID0gZ2V0KHRoaXMsICdhcnJhbmdl
        ZENvbnRlbnQnKTsKCiAgICBtaWQgPSBsb3cgKyBNYXRoLmZsb29yKChoaWdo
        IC0gbG93KSAvIDIpOwogICAgbWlkSXRlbSA9IGFycmFuZ2VkQ29udGVudC5v
        YmplY3RBdChtaWQpOwoKICAgIHJlcyA9IHRoaXMub3JkZXJCeShtaWRJdGVt
        LCBpdGVtKTsKCiAgICBpZiAocmVzIDwgMCkgewogICAgICByZXR1cm4gdGhp
        cy5fYmluYXJ5U2VhcmNoKGl0ZW0sIG1pZCsxLCBoaWdoKTsKICAgIH0gZWxz
        ZSBpZiAocmVzID4gMCkgewogICAgICByZXR1cm4gdGhpcy5fYmluYXJ5U2Vh
        cmNoKGl0ZW0sIGxvdywgbWlkKTsKICAgIH0KCiAgICByZXR1cm4gbWlkOwog
        IH0KfSk7Cgp9KSgpOwoKCgooZnVuY3Rpb24oKSB7Ci8qKgpAbW9kdWxlIGVt
        YmVyCkBzdWJtb2R1bGUgZW1iZXItcnVudGltZQoqLwoKdmFyIGdldCA9IEVt
        YmVyLmdldCwgc2V0ID0gRW1iZXIuc2V0LCBmb3JFYWNoID0gRW1iZXIuRW51
        bWVyYWJsZVV0aWxzLmZvckVhY2gsCiAgICByZXBsYWNlID0gRW1iZXIuRW51
        bWVyYWJsZVV0aWxzLnJlcGxhY2U7CgovKioKICBgRW1iZXIuQXJyYXlDb250
        cm9sbGVyYCBwcm92aWRlcyBhIHdheSBmb3IgeW91IHRvIHB1Ymxpc2ggYSBj
        b2xsZWN0aW9uIG9mCiAgb2JqZWN0cyBzbyB0aGF0IHlvdSBjYW4gZWFzaWx5
        IGJpbmQgdG8gdGhlIGNvbGxlY3Rpb24gZnJvbSBhIEhhbmRsZWJhcnMKICBg
        I2VhY2hgIGhlbHBlciwgYW4gYEVtYmVyLkNvbGxlY3Rpb25WaWV3YCwgb3Ig
        b3RoZXIgY29udHJvbGxlcnMuCgogIFRoZSBhZHZhbnRhZ2Ugb2YgdXNpbmcg
        YW4gYEFycmF5Q29udHJvbGxlcmAgaXMgdGhhdCB5b3Ugb25seSBoYXZlIHRv
        IHNldCB1cAogIHlvdXIgdmlldyBiaW5kaW5ncyBvbmNlOyB0byBjaGFuZ2Ug
        d2hhdCdzIGRpc3BsYXllZCwgc2ltcGx5IHN3YXAgb3V0IHRoZQogIGBjb250
        ZW50YCBwcm9wZXJ0eSBvbiB0aGUgY29udHJvbGxlci4KCiAgRm9yIGV4YW1w
        bGUsIGltYWdpbmUgeW91IHdhbnRlZCB0byBkaXNwbGF5IGEgbGlzdCBvZiBp
        dGVtcyBmZXRjaGVkIHZpYSBhbiBYSFIKICByZXF1ZXN0LiBDcmVhdGUgYW4g
        YEVtYmVyLkFycmF5Q29udHJvbGxlcmAgYW5kIHNldCBpdHMgYGNvbnRlbnRg
        IHByb3BlcnR5OgoKICBgYGBqYXZhc2NyaXB0CiAgTXlBcHAubGlzdENvbnRy
        b2xsZXIgPSBFbWJlci5BcnJheUNvbnRyb2xsZXIuY3JlYXRlKCk7CgogICQu
        Z2V0KCdwZW9wbGUuanNvbicsIGZ1bmN0aW9uKGRhdGEpIHsKICAgIE15QXBw
        Lmxpc3RDb250cm9sbGVyLnNldCgnY29udGVudCcsIGRhdGEpOwogIH0pOwog
        IGBgYAoKICBUaGVuLCBjcmVhdGUgYSB2aWV3IHRoYXQgYmluZHMgdG8geW91
        ciBuZXcgY29udHJvbGxlcjoKCiAgYGBgaGFuZGxlYmFycwogIHt7I2VhY2gg
        TXlBcHAubGlzdENvbnRyb2xsZXJ9fQogICAge3tmaXJzdE5hbWV9fSB7e2xh
        c3ROYW1lfX0KICB7ey9lYWNofX0KICBgYGAKCiAgQWx0aG91Z2ggeW91IGFy
        ZSBiaW5kaW5nIHRvIHRoZSBjb250cm9sbGVyLCB0aGUgYmVoYXZpb3Igb2Yg
        dGhpcyBjb250cm9sbGVyCiAgaXMgdG8gcGFzcyB0aHJvdWdoIGFueSBtZXRo
        b2RzIG9yIHByb3BlcnRpZXMgdG8gdGhlIHVuZGVybHlpbmcgYXJyYXkuIFRo
        aXMKICBjYXBhYmlsaXR5IGNvbWVzIGZyb20gYEVtYmVyLkFycmF5UHJveHlg
        LCB3aGljaCB0aGlzIGNsYXNzIGluaGVyaXRzIGZyb20uCgogIFNvbWV0aW1l
        cyB5b3Ugd2FudCB0byBkaXNwbGF5IGNvbXB1dGVkIHByb3BlcnRpZXMgd2l0
        aGluIHRoZSBib2R5IG9mIGFuCiAgYCNlYWNoYCBoZWxwZXIgdGhhdCBkZXBl
        bmQgb24gdGhlIHVuZGVybHlpbmcgaXRlbXMgaW4gYGNvbnRlbnRgLCBidXQg
        YXJlIG5vdAogIHByZXNlbnQgb24gdGhvc2UgaXRlbXMuICAgVG8gZG8gdGhp
        cywgc2V0IGBpdGVtQ29udHJvbGxlcmAgdG8gdGhlIG5hbWUgb2YgYQogIGNv
        bnRyb2xsZXIgKHByb2JhYmx5IGFuIGBPYmplY3RDb250cm9sbGVyYCkgdGhh
        dCB3aWxsIHdyYXAgZWFjaCBpbmRpdmlkdWFsIGl0ZW0uCgogIEZvciBleGFt
        cGxlOgoKICBgYGBoYW5kbGViYXJzCiAgICB7eyNlYWNoIHBvc3QgaW4gY29u
        dHJvbGxlcn19CiAgICAgIDxsaT57e3RpdGxlfX0gKHt7dGl0bGVMZW5ndGh9
        fSBjaGFyYWN0ZXJzKTwvbGk+CiAgICB7ey9lYWNofX0KICBgYGAKCiAgYGBg
        amF2YXNjcmlwdAogIEFwcC5Qb3N0c0NvbnRyb2xsZXIgPSBFbWJlci5BcnJh
        eUNvbnRyb2xsZXIuZXh0ZW5kKHsKICAgIGl0ZW1Db250cm9sbGVyOiAncG9z
        dCcKICB9KTsKCiAgQXBwLlBvc3RDb250cm9sbGVyID0gRW1iZXIuT2JqZWN0
        Q29udHJvbGxlci5leHRlbmQoewogICAgLy8gdGhlIGB0aXRsZWAgcHJvcGVy
        dHkgd2lsbCBiZSBwcm94aWVkIHRvIHRoZSB1bmRlcmx5aW5nIHBvc3QuCgog
        ICAgdGl0bGVMZW5ndGg6IGZ1bmN0aW9uKCkgewogICAgICByZXR1cm4gdGhp
        cy5nZXQoJ3RpdGxlJykubGVuZ3RoOwogICAgfS5wcm9wZXJ0eSgndGl0bGUn
        KQogIH0pOwogIGBgYAoKICBJbiBzb21lIGNhc2VzIGl0IGlzIGhlbHBmdWwg
        dG8gcmV0dXJuIGEgZGlmZmVyZW50IGBpdGVtQ29udHJvbGxlcmAgZGVwZW5k
        aW5nCiAgb24gdGhlIHBhcnRpY3VsYXIgaXRlbS4gIFN1YmNsYXNzZXMgY2Fu
        IGRvIHRoaXMgYnkgb3ZlcnJpZGluZwogIGBsb29rdXBJdGVtQ29udHJvbGxl
        cmAuCgogIEZvciBleGFtcGxlOgoKICBgYGBqYXZhc2NyaXB0CiAgQXBwLk15
        QXJyYXlDb250cm9sbGVyID0gRW1iZXIuQXJyYXlDb250cm9sbGVyLmV4dGVu
        ZCh7CiAgICBsb29rdXBJdGVtQ29udHJvbGxlcjogZnVuY3Rpb24oIG9iamVj
        dCApIHsKICAgICAgaWYgKG9iamVjdC5nZXQoJ2lzU3BlY2lhbCcpKSB7CiAg
        ICAgICAgcmV0dXJuICJzcGVjaWFsIjsgLy8gdXNlIEFwcC5TcGVjaWFsQ29u
        dHJvbGxlcgogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiAicmVndWxh
        ciI7IC8vIHVzZSBBcHAuUmVndWxhckNvbnRyb2xsZXIKICAgICAgfQogICAg
        fQogIH0pOwogIGBgYAoKICBUaGUgaXRlbUNvbnRyb2xsZXIgaW5zdGFuY2Vz
        IHdpbGwgaGF2ZSBhIGBwYXJlbnRDb250cm9sbGVyYCBwcm9wZXJ0eSBzZXQg
        dG8KICBlaXRoZXIgdGhlIHRoZSBgcGFyZW50Q29udHJvbGxlcmAgcHJvcGVy
        dHkgb2YgdGhlIGBBcnJheUNvbnRyb2xsZXJgCiAgb3IgdG8gdGhlIGBBcnJh
        eUNvbnRyb2xsZXJgIGluc3RhbmNlIGl0c2VsZi4KCiAgQGNsYXNzIEFycmF5
        Q29udHJvbGxlcgogIEBuYW1lc3BhY2UgRW1iZXIKICBAZXh0ZW5kcyBFbWJl
        ci5BcnJheVByb3h5CiAgQHVzZXMgRW1iZXIuU29ydGFibGVNaXhpbgogIEB1
        c2VzIEVtYmVyLkNvbnRyb2xsZXJNaXhpbgoqLwoKRW1iZXIuQXJyYXlDb250
        cm9sbGVyID0gRW1iZXIuQXJyYXlQcm94eS5leHRlbmQoRW1iZXIuQ29udHJv
        bGxlck1peGluLAogIEVtYmVyLlNvcnRhYmxlTWl4aW4sIHsKCiAgLyoqCiAg
        ICBUaGUgY29udHJvbGxlciB1c2VkIHRvIHdyYXAgaXRlbXMsIGlmIGFueS4K
        CiAgICBAcHJvcGVydHkgaXRlbUNvbnRyb2xsZXIKICAgIEB0eXBlIFN0cmlu
        ZwogICAgQGRlZmF1bHQgbnVsbAogICovCiAgaXRlbUNvbnRyb2xsZXI6IG51
        bGwsCgogIC8qKgogICAgUmV0dXJuIHRoZSBuYW1lIG9mIHRoZSBjb250cm9s
        bGVyIHRvIHdyYXAgaXRlbXMsIG9yIGBudWxsYCBpZiBpdGVtcyBzaG91bGQK
        ICAgIGJlIHJldHVybmVkIGRpcmVjdGx5LiAgVGhlIGRlZmF1bHQgaW1wbGVt
        ZW50YXRpb24gc2ltcGx5IHJldHVybnMgdGhlCiAgICBgaXRlbUNvbnRyb2xs
        ZXJgIHByb3BlcnR5LCBidXQgc3ViY2xhc3NlcyBjYW4gb3ZlcnJpZGUgdGhp
        cyBtZXRob2QgdG8gcmV0dXJuCiAgICBkaWZmZXJlbnQgY29udHJvbGxlcnMg
        Zm9yIGRpZmZlcmVudCBvYmplY3RzLgoKICAgIEZvciBleGFtcGxlOgoKICAg
        IGBgYGphdmFzY3JpcHQKICAgIEFwcC5NeUFycmF5Q29udHJvbGxlciA9IEVt
        YmVyLkFycmF5Q29udHJvbGxlci5leHRlbmQoewogICAgICBsb29rdXBJdGVt
        Q29udHJvbGxlcjogZnVuY3Rpb24oIG9iamVjdCApIHsKICAgICAgICBpZiAo
        b2JqZWN0LmdldCgnaXNTcGVjaWFsJykpIHsKICAgICAgICAgIHJldHVybiAi
        c3BlY2lhbCI7IC8vIHVzZSBBcHAuU3BlY2lhbENvbnRyb2xsZXIKICAgICAg
        ICB9IGVsc2UgewogICAgICAgICAgcmV0dXJuICJyZWd1bGFyIjsgLy8gdXNl
        IEFwcC5SZWd1bGFyQ29udHJvbGxlcgogICAgICAgIH0KICAgICAgfQogICAg
        fSk7CiAgICBgYGAKCiAgICBAbWV0aG9kIGxvb2t1cEl0ZW1Db250cm9sbGVy
        CiAgICBAcGFyYW0ge09iamVjdH0gb2JqZWN0CiAgICBAcmV0dXJuIHtTdHJp
        bmd9CiAgKi8KICBsb29rdXBJdGVtQ29udHJvbGxlcjogZnVuY3Rpb24ob2Jq
        ZWN0KSB7CiAgICByZXR1cm4gZ2V0KHRoaXMsICdpdGVtQ29udHJvbGxlcicp
        OwogIH0sCgogIG9iamVjdEF0Q29udGVudDogZnVuY3Rpb24oaWR4KSB7CiAg
        ICB2YXIgbGVuZ3RoID0gZ2V0KHRoaXMsICdsZW5ndGgnKSwKICAgICAgICBh
        cnJhbmdlZENvbnRlbnQgPSBnZXQodGhpcywnYXJyYW5nZWRDb250ZW50Jyks
        CiAgICAgICAgb2JqZWN0ID0gYXJyYW5nZWRDb250ZW50ICYmIGFycmFuZ2Vk
        Q29udGVudC5vYmplY3RBdChpZHgpOwoKICAgIGlmIChpZHggPj0gMCAmJiBp
        ZHggPCBsZW5ndGgpIHsKICAgICAgdmFyIGNvbnRyb2xsZXJDbGFzcyA9IHRo
        aXMubG9va3VwSXRlbUNvbnRyb2xsZXIob2JqZWN0KTsKICAgICAgaWYgKGNv
        bnRyb2xsZXJDbGFzcykgewogICAgICAgIHJldHVybiB0aGlzLmNvbnRyb2xs
        ZXJBdChpZHgsIG9iamVjdCwgY29udHJvbGxlckNsYXNzKTsKICAgICAgfQog
        ICAgfQoKICAgIC8vIFdoZW4gYGNvbnRyb2xsZXJDbGFzc2AgaXMgZmFsc3ks
        IHdlIGhhdmUgbm90IG9wdGVkIGluIHRvIHVzaW5nIGl0ZW0KICAgIC8vIGNv
        bnRyb2xsZXJzLCBzbyByZXR1cm4gdGhlIG9iamVjdCBkaXJlY3RseS4KCiAg
        ICAvLyBXaGVuIHRoZSBpbmRleCBpcyBvdXQgb2YgcmFuZ2UsIHdlIHdhbnQg
        dG8gcmV0dXJuIHRoZSAib3V0IG9mIHJhbmdlIgogICAgLy8gdmFsdWUsIHdo
        YXRldmVyIHRoYXQgbWlnaHQgYmUuICBSYXRoZXIgdGhhbiBtYWtlIGFzc3Vt
        cHRpb25zCiAgICAvLyAoZS5nLiBndWVzc2luZyBgbnVsbGAgb3IgYHVuZGVm
        aW5lZGApIHdlIGRlZmVyIHRoaXMgdG8gYGFycmFuZ2VkQ29udGVudGAuCiAg
        ICByZXR1cm4gb2JqZWN0OwogIH0sCgogIGFycmFuZ2VkQ29udGVudERpZENo
        YW5nZTogZnVuY3Rpb24oKSB7CiAgICB0aGlzLl9zdXBlcigpOwogICAgdGhp
        cy5fcmVzZXRTdWJDb250cm9sbGVycygpOwogIH0sCgogIGFycmF5Q29udGVu
        dERpZENoYW5nZTogZnVuY3Rpb24oaWR4LCByZW1vdmVkQ250LCBhZGRlZENu
        dCkgewogICAgdmFyIHN1YkNvbnRyb2xsZXJzID0gZ2V0KHRoaXMsICdfc3Vi
        Q29udHJvbGxlcnMnKSwKICAgICAgICBzdWJDb250cm9sbGVyc1RvUmVtb3Zl
        ID0gc3ViQ29udHJvbGxlcnMuc2xpY2UoaWR4LCBpZHgrcmVtb3ZlZENudCk7
        CgogICAgZm9yRWFjaChzdWJDb250cm9sbGVyc1RvUmVtb3ZlLCBmdW5jdGlv
        bihzdWJDb250cm9sbGVyKSB7CiAgICAgIGlmIChzdWJDb250cm9sbGVyKSB7
        IHN1YkNvbnRyb2xsZXIuZGVzdHJveSgpOyB9CiAgICB9KTsKCiAgICByZXBs
        YWNlKHN1YkNvbnRyb2xsZXJzLCBpZHgsIHJlbW92ZWRDbnQsIG5ldyBBcnJh
        eShhZGRlZENudCkpOwoKICAgIC8vIFRoZSBzaGFkb3cgYXJyYXkgb2Ygc3Vi
        Y29udHJvbGxlcnMgbXVzdCBiZSB1cGRhdGVkIGJlZm9yZSB3ZSB0cmlnZ2Vy
        CiAgICAvLyBvYnNlcnZlcnMsIG90aGVyd2lzZSBvYnNlcnZlcnMgd2lsbCBn
        ZXQgdGhlIHdyb25nIHN1YmNvbnRhaW5lciB3aGVuCiAgICAvLyBjYWxsaW5n
        IGBvYmplY3RBdGAKICAgIHRoaXMuX3N1cGVyKGlkeCwgcmVtb3ZlZENudCwg
        YWRkZWRDbnQpOwogIH0sCgogIGluaXQ6IGZ1bmN0aW9uKCkgewogICAgdGhp
        cy5fc3VwZXIoKTsKCiAgICB0aGlzLnNldCgnX3N1YkNvbnRyb2xsZXJzJywg
        RW1iZXIuQSgpKTsKICB9LAoKICBjb250ZW50OiBFbWJlci5jb21wdXRlZChm
        dW5jdGlvbiAoKSB7CiAgICByZXR1cm4gRW1iZXIuQSgpOwogIH0pLAoKICBj
        b250cm9sbGVyQXQ6IGZ1bmN0aW9uKGlkeCwgb2JqZWN0LCBjb250cm9sbGVy
        Q2xhc3MpIHsKICAgIHZhciBjb250YWluZXIgPSBnZXQodGhpcywgJ2NvbnRh
        aW5lcicpLAogICAgICAgIHN1YkNvbnRyb2xsZXJzID0gZ2V0KHRoaXMsICdf
        c3ViQ29udHJvbGxlcnMnKSwKICAgICAgICBzdWJDb250cm9sbGVyID0gc3Vi
        Q29udHJvbGxlcnNbaWR4XSwKICAgICAgICBmYWN0b3J5LCBmdWxsTmFtZTsK
        CiAgICBpZiAoc3ViQ29udHJvbGxlcikgeyByZXR1cm4gc3ViQ29udHJvbGxl
        cjsgfQoKICAgIGZ1bGxOYW1lID0gImNvbnRyb2xsZXI6IiArIGNvbnRyb2xs
        ZXJDbGFzczsKCiAgICBpZiAoIWNvbnRhaW5lci5oYXMoZnVsbE5hbWUpKSB7
        CiAgICAgIHRocm93IG5ldyBFbWJlci5FcnJvcignQ291bGQgbm90IHJlc29s
        dmUgaXRlbUNvbnRyb2xsZXI6ICInICsgY29udHJvbGxlckNsYXNzICsgJyIn
        KTsKICAgIH0KCiAgICBzdWJDb250cm9sbGVyID0gY29udGFpbmVyLmxvb2t1
        cEZhY3RvcnkoZnVsbE5hbWUpLmNyZWF0ZSh7CiAgICAgIHRhcmdldDogdGhp
        cywKICAgICAgcGFyZW50Q29udHJvbGxlcjogZ2V0KHRoaXMsICdwYXJlbnRD
        b250cm9sbGVyJykgfHwgdGhpcywKICAgICAgY29udGVudDogb2JqZWN0CiAg
        ICB9KTsKCiAgICBzdWJDb250cm9sbGVyc1tpZHhdID0gc3ViQ29udHJvbGxl
        cjsKCiAgICByZXR1cm4gc3ViQ29udHJvbGxlcjsKICB9LAoKICBfc3ViQ29u
        dHJvbGxlcnM6IG51bGwsCgogIF9yZXNldFN1YkNvbnRyb2xsZXJzOiBmdW5j
        dGlvbigpIHsKICAgIHZhciBzdWJDb250cm9sbGVycyA9IGdldCh0aGlzLCAn
        X3N1YkNvbnRyb2xsZXJzJyk7CiAgICBpZiAoc3ViQ29udHJvbGxlcnMpIHsK
        ICAgICAgZm9yRWFjaChzdWJDb250cm9sbGVycywgZnVuY3Rpb24oc3ViQ29u
        dHJvbGxlcikgewogICAgICAgIGlmIChzdWJDb250cm9sbGVyKSB7IHN1YkNv
        bnRyb2xsZXIuZGVzdHJveSgpOyB9CiAgICAgIH0pOwogICAgfQoKICAgIHRo
        aXMuc2V0KCdfc3ViQ29udHJvbGxlcnMnLCBFbWJlci5BKCkpOwogIH0KfSk7
        Cgp9KSgpOwoKCgooZnVuY3Rpb24oKSB7Ci8qKgpAbW9kdWxlIGVtYmVyCkBz
        dWJtb2R1bGUgZW1iZXItcnVudGltZQoqLwoKLyoqCiAgYEVtYmVyLk9iamVj
        dENvbnRyb2xsZXJgIGlzIHBhcnQgb2YgRW1iZXIncyBDb250cm9sbGVyIGxh
        eWVyLiBJdCBpcyBpbnRlbmRlZAogIHRvIHdyYXAgYSBzaW5nbGUgb2JqZWN0
        LCBwcm94eWluZyB1bmhhbmRsZWQgYXR0ZW1wdHMgdG8gYGdldGAgYW5kIGBz
        ZXRgIHRvIHRoZSB1bmRlcmx5aW5nCiAgY29udGVudCBvYmplY3QsIGFuZCB0
        byBmb3J3YXJkIHVuaGFuZGxlZCBhY3Rpb24gYXR0ZW1wdHMgdG8gaXRzIGB0
        YXJnZXRgLgoKICBgRW1iZXIuT2JqZWN0Q29udHJvbGxlcmAgZGVyaXZlcyB0
        aGlzIGZ1bmN0aW9uYWxpdHkgZnJvbSBpdHMgc3VwZXJjbGFzcwogIGBFbWJl
        ci5PYmplY3RQcm94eWAgYW5kIHRoZSBgRW1iZXIuQ29udHJvbGxlck1peGlu
        YCBtaXhpbi4KCiAgQGNsYXNzIE9iamVjdENvbnRyb2xsZXIKICBAbmFtZXNw
        YWNlIEVtYmVyCiAgQGV4dGVuZHMgRW1iZXIuT2JqZWN0UHJveHkKICBAdXNl
        cyBFbWJlci5Db250cm9sbGVyTWl4aW4KKiovCkVtYmVyLk9iamVjdENvbnRy
        b2xsZXIgPSBFbWJlci5PYmplY3RQcm94eS5leHRlbmQoRW1iZXIuQ29udHJv
        bGxlck1peGluKTsKCn0pKCk7CgoKCihmdW5jdGlvbigpIHsKCn0pKCk7CgoK
        CihmdW5jdGlvbigpIHsKLyoqCkVtYmVyIFJ1bnRpbWUKCkBtb2R1bGUgZW1i
        ZXIKQHN1Ym1vZHVsZSBlbWJlci1ydW50aW1lCkByZXF1aXJlcyBlbWJlci1t
        ZXRhbAoqLwoKfSkoKTsKCihmdW5jdGlvbigpIHsKLyoqCkBtb2R1bGUgZW1i
        ZXIKQHN1Ym1vZHVsZSBlbWJlci12aWV3cwoqLwoKdmFyIGpRdWVyeSA9IEVt
        YmVyLmltcG9ydHMualF1ZXJ5OwpFbWJlci5hc3NlcnQoIkVtYmVyIFZpZXdz
        IHJlcXVpcmUgalF1ZXJ5IDEuNywgMS44LCAxLjksIDEuMTAsIG9yIDIuMCIs
        IGpRdWVyeSAmJiAoalF1ZXJ5KCkuanF1ZXJ5Lm1hdGNoKC9eKCgxXC4oN3w4
        fDl8MTApKXwyLjApKFwuXGQrKT8ocHJlfHJjXGQ/KT8vKSB8fCBFbWJlci5F
        TlYuRk9SQ0VfSlFVRVJZKSk7CgovKioKICBBbGlhcyBmb3IgalF1ZXJ5Cgog
        IEBtZXRob2QgJAogIEBmb3IgRW1iZXIKKi8KRW1iZXIuJCA9IGpRdWVyeTsK
        Cn0pKCk7CgoKCihmdW5jdGlvbigpIHsKLyoqCkBtb2R1bGUgZW1iZXIKQHN1
        Ym1vZHVsZSBlbWJlci12aWV3cwoqLwppZiAoRW1iZXIuJCkgewogIC8vIGh0
        dHA6Ly93d3cud2hhdHdnLm9yZy9zcGVjcy93ZWItYXBwcy9jdXJyZW50LXdv
        cmsvbXVsdGlwYWdlL2RuZC5odG1sI2RuZGV2ZW50cwogIHZhciBkcmFnRXZl
        bnRzID0gRW1iZXIuU3RyaW5nLncoJ2RyYWdzdGFydCBkcmFnIGRyYWdlbnRl
        ciBkcmFnbGVhdmUgZHJhZ292ZXIgZHJvcCBkcmFnZW5kJyk7CgogIC8vIENv
        cGllcyB0aGUgYGRhdGFUcmFuc2ZlcmAgcHJvcGVydHkgZnJvbSBhIGJyb3dz
        ZXIgZXZlbnQgb2JqZWN0IG9udG8gdGhlCiAgLy8galF1ZXJ5IGV2ZW50IG9i
        amVjdCBmb3IgdGhlIHNwZWNpZmllZCBldmVudHMKICBFbWJlci5FbnVtZXJh
        YmxlVXRpbHMuZm9yRWFjaChkcmFnRXZlbnRzLCBmdW5jdGlvbihldmVudE5h
        bWUpIHsKICAgIEVtYmVyLiQuZXZlbnQuZml4SG9va3NbZXZlbnROYW1lXSA9
        IHsgcHJvcHM6IFsnZGF0YVRyYW5zZmVyJ10gfTsKICB9KTsKfQoKfSkoKTsK
        CgoKKGZ1bmN0aW9uKCkgewovKioKQG1vZHVsZSBlbWJlcgpAc3VibW9kdWxl
        IGVtYmVyLXZpZXdzCiovCgovKiBCRUdJTiBNRVRBTU9SUEggSEVMUEVSUyAq
        LwoKLy8gSW50ZXJuZXQgRXhwbG9yZXIgcHJpb3IgdG8gOSBkb2VzIG5vdCBh
        bGxvdyBzZXR0aW5nIGlubmVySFRNTCBpZiB0aGUgZmlyc3QgZWxlbWVudAov
        LyBpcyBhICJ6ZXJvLXNjb3BlIiBlbGVtZW50LiBUaGlzIHByb2JsZW0gY2Fu
        IGJlIHdvcmtlZCBhcm91bmQgYnkgbWFraW5nCi8vIHRoZSBmaXJzdCBub2Rl
        IGFuIGludmlzaWJsZSB0ZXh0IG5vZGUuIFdlLCBsaWtlIE1vZGVybml6ciwg
        dXNlICZzaHk7Cgp2YXIgbmVlZHNTaHkgPSB0aGlzLmRvY3VtZW50ICYmIChm
        dW5jdGlvbigpIHsKICB2YXIgdGVzdEVsID0gZG9jdW1lbnQuY3JlYXRlRWxl
        bWVudCgnZGl2Jyk7CiAgdGVzdEVsLmlubmVySFRNTCA9ICI8ZGl2PjwvZGl2
        PiI7CiAgdGVzdEVsLmZpcnN0Q2hpbGQuaW5uZXJIVE1MID0gIjxzY3JpcHQ+
        PC9zY3JpcHQ+IjsKICByZXR1cm4gdGVzdEVsLmZpcnN0Q2hpbGQuaW5uZXJI
        VE1MID09PSAnJzsKfSkoKTsKCi8vIElFIDggKGFuZCBsaWtlbHkgZWFybGll
        cikgbGlrZXMgdG8gbW92ZSB3aGl0ZXNwYWNlIHByZWNlZWRpbmcKLy8gYSBz
        Y3JpcHQgdGFnIHRvIGFwcGVhciBhZnRlciBpdC4gVGhpcyBtZWFucyB0aGF0
        IHdlIGNhbgovLyBhY2NpZGVudGFsbHkgcmVtb3ZlIHdoaXRlc3BhY2Ugd2hl
        biB1cGRhdGluZyBhIG1vcnBoLgp2YXIgbW92ZXNXaGl0ZXNwYWNlID0gdGhp
        cy5kb2N1bWVudCAmJiAoZnVuY3Rpb24oKSB7CiAgdmFyIHRlc3RFbCA9IGRv
        Y3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwogIHRlc3RFbC5pbm5lckhU
        TUwgPSAiVGVzdDogPHNjcmlwdCB0eXBlPSd0ZXh0L3gtcGxhY2Vob2xkZXIn
        Pjwvc2NyaXB0PlZhbHVlIjsKICByZXR1cm4gdGVzdEVsLmNoaWxkTm9kZXNb
        MF0ubm9kZVZhbHVlID09PSAnVGVzdDonICYmCiAgICAgICAgICB0ZXN0RWwu
        Y2hpbGROb2Rlc1syXS5ub2RlVmFsdWUgPT09ICcgVmFsdWUnOwp9KSgpOwoK
        Ly8gVXNlIHRoaXMgdG8gZmluZCBjaGlsZHJlbiBieSBJRCBpbnN0ZWFkIG9m
        IHVzaW5nIGpRdWVyeQp2YXIgZmluZENoaWxkQnlJZCA9IGZ1bmN0aW9uKGVs
        ZW1lbnQsIGlkKSB7CiAgaWYgKGVsZW1lbnQuZ2V0QXR0cmlidXRlKCdpZCcp
        ID09PSBpZCkgeyByZXR1cm4gZWxlbWVudDsgfQoKICB2YXIgbGVuID0gZWxl
        bWVudC5jaGlsZE5vZGVzLmxlbmd0aCwgaWR4LCBub2RlLCBmb3VuZDsKICBm
        b3IgKGlkeD0wOyBpZHg8bGVuOyBpZHgrKykgewogICAgbm9kZSA9IGVsZW1l
        bnQuY2hpbGROb2Rlc1tpZHhdOwogICAgZm91bmQgPSBub2RlLm5vZGVUeXBl
        ID09PSAxICYmIGZpbmRDaGlsZEJ5SWQobm9kZSwgaWQpOwogICAgaWYgKGZv
        dW5kKSB7IHJldHVybiBmb3VuZDsgfQogIH0KfTsKCnZhciBzZXRJbm5lckhU
        TUxXaXRob3V0Rml4ID0gZnVuY3Rpb24oZWxlbWVudCwgaHRtbCkgewogIGlm
        IChuZWVkc1NoeSkgewogICAgaHRtbCA9ICcmc2h5OycgKyBodG1sOwogIH0K
        CiAgdmFyIG1hdGNoZXMgPSBbXTsKICBpZiAobW92ZXNXaGl0ZXNwYWNlKSB7
        CiAgICAvLyBSaWdodCBub3cgd2Ugb25seSBjaGVjayBmb3Igc2NyaXB0IHRh
        Z3Mgd2l0aCBpZHMgd2l0aCB0aGUKICAgIC8vIGdvYWwgb2YgdGFyZ2V0aW5n
        IG1vcnBocy4KICAgIGh0bWwgPSBodG1sLnJlcGxhY2UoLyhccyspKDxzY3Jp
        cHQgaWQ9JyhbXiddKyknKS9nLCBmdW5jdGlvbihtYXRjaCwgc3BhY2VzLCB0
        YWcsIGlkKSB7CiAgICAgIG1hdGNoZXMucHVzaChbaWQsIHNwYWNlc10pOwog
        ICAgICByZXR1cm4gdGFnOwogICAgfSk7CiAgfQoKICBlbGVtZW50LmlubmVy
        SFRNTCA9IGh0bWw7CgogIC8vIElmIHdlIGhhdmUgdG8gZG8gYW55IHdoaXRl
        c3BhY2UgYWRqdXN0bWVudHMgZG8gdGhlbSBub3cKICBpZiAobWF0Y2hlcy5s
        ZW5ndGggPiAwKSB7CiAgICB2YXIgbGVuID0gbWF0Y2hlcy5sZW5ndGgsIGlk
        eDsKICAgIGZvciAoaWR4PTA7IGlkeDxsZW47IGlkeCsrKSB7CiAgICAgIHZh
        ciBzY3JpcHQgPSBmaW5kQ2hpbGRCeUlkKGVsZW1lbnQsIG1hdGNoZXNbaWR4
        XVswXSksCiAgICAgICAgICBub2RlID0gZG9jdW1lbnQuY3JlYXRlVGV4dE5v
        ZGUobWF0Y2hlc1tpZHhdWzFdKTsKICAgICAgc2NyaXB0LnBhcmVudE5vZGUu
        aW5zZXJ0QmVmb3JlKG5vZGUsIHNjcmlwdCk7CiAgICB9CiAgfQoKICBpZiAo
        bmVlZHNTaHkpIHsKICAgIHZhciBzaHlFbGVtZW50ID0gZWxlbWVudC5maXJz
        dENoaWxkOwogICAgd2hpbGUgKHNoeUVsZW1lbnQubm9kZVR5cGUgPT09IDEg
        JiYgIXNoeUVsZW1lbnQubm9kZU5hbWUpIHsKICAgICAgc2h5RWxlbWVudCA9
        IHNoeUVsZW1lbnQuZmlyc3RDaGlsZDsKICAgIH0KICAgIGlmIChzaHlFbGVt
        ZW50Lm5vZGVUeXBlID09PSAzICYmIHNoeUVsZW1lbnQubm9kZVZhbHVlLmNo
        YXJBdCgwKSA9PT0gIlx1MDBBRCIpIHsKICAgICAgc2h5RWxlbWVudC5ub2Rl
        VmFsdWUgPSBzaHlFbGVtZW50Lm5vZGVWYWx1ZS5zbGljZSgxKTsKICAgIH0K
        ICB9Cn07CgovKiBFTkQgTUVUQU1PUlBIIEhFTFBFUlMgKi8KCgp2YXIgaW5u
        ZXJIVE1MVGFncyA9IHt9Owp2YXIgY2FuU2V0SW5uZXJIVE1MID0gZnVuY3Rp
        b24odGFnTmFtZSkgewogIGlmIChpbm5lckhUTUxUYWdzW3RhZ05hbWVdICE9
        PSB1bmRlZmluZWQpIHsKICAgIHJldHVybiBpbm5lckhUTUxUYWdzW3RhZ05h
        bWVdOwogIH0KCiAgdmFyIGNhblNldCA9IHRydWU7CgogIC8vIElFIDggYW5k
        IGVhcmxpZXIgZG9uJ3QgYWxsb3cgdXMgdG8gZG8gaW5uZXJIVE1MIG9uIHNl
        bGVjdAogIGlmICh0YWdOYW1lLnRvTG93ZXJDYXNlKCkgPT09ICdzZWxlY3Qn
        KSB7CiAgICB2YXIgZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzZWxl
        Y3QnKTsKICAgIHNldElubmVySFRNTFdpdGhvdXRGaXgoZWwsICc8b3B0aW9u
        IHZhbHVlPSJ0ZXN0Ij5UZXN0PC9vcHRpb24+Jyk7CiAgICBjYW5TZXQgPSBl
        bC5vcHRpb25zLmxlbmd0aCA9PT0gMTsKICB9CgogIGlubmVySFRNTFRhZ3Nb
        dGFnTmFtZV0gPSBjYW5TZXQ7CgogIHJldHVybiBjYW5TZXQ7Cn07Cgp2YXIg
        c2V0SW5uZXJIVE1MID0gZnVuY3Rpb24oZWxlbWVudCwgaHRtbCkgewogIHZh
        ciB0YWdOYW1lID0gZWxlbWVudC50YWdOYW1lOwoKICBpZiAoY2FuU2V0SW5u
        ZXJIVE1MKHRhZ05hbWUpKSB7CiAgICBzZXRJbm5lckhUTUxXaXRob3V0Rml4
        KGVsZW1lbnQsIGh0bWwpOwogIH0gZWxzZSB7CiAgICAvLyBGaXJlZm94IHZl
        cnNpb25zIDwgMTEgZG8gbm90IGhhdmUgc3VwcG9ydCBmb3IgZWxlbWVudC5v
        dXRlckhUTUwuCiAgICB2YXIgb3V0ZXJIVE1MID0gZWxlbWVudC5vdXRlckhU
        TUwgfHwgbmV3IFhNTFNlcmlhbGl6ZXIoKS5zZXJpYWxpemVUb1N0cmluZyhl
        bGVtZW50KTsKICAgIEVtYmVyLmFzc2VydCgiQ2FuJ3Qgc2V0IGlubmVySFRN
        TCBvbiAiK2VsZW1lbnQudGFnTmFtZSsiIGluIHRoaXMgYnJvd3NlciIsIG91
        dGVySFRNTCk7CgogICAgdmFyIHN0YXJ0VGFnID0gb3V0ZXJIVE1MLm1hdGNo
        KG5ldyBSZWdFeHAoIjwiK3RhZ05hbWUrIihbXj5dKik+IiwgJ2knKSlbMF0s
        CiAgICAgICAgZW5kVGFnID0gJzwvJyt0YWdOYW1lKyc+JzsKCiAgICB2YXIg
        d3JhcHBlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwogICAg
        c2V0SW5uZXJIVE1MV2l0aG91dEZpeCh3cmFwcGVyLCBzdGFydFRhZyArIGh0
        bWwgKyBlbmRUYWcpOwogICAgZWxlbWVudCA9IHdyYXBwZXIuZmlyc3RDaGls
        ZDsKICAgIHdoaWxlIChlbGVtZW50LnRhZ05hbWUgIT09IHRhZ05hbWUpIHsK
        ICAgICAgZWxlbWVudCA9IGVsZW1lbnQubmV4dFNpYmxpbmc7CiAgICB9CiAg
        fQoKICByZXR1cm4gZWxlbWVudDsKfTsKCmZ1bmN0aW9uIGlzU2ltcGxlQ2xp
        Y2soZXZlbnQpIHsKICB2YXIgbW9kaWZpZXIgPSBldmVudC5zaGlmdEtleSB8
        fCBldmVudC5tZXRhS2V5IHx8IGV2ZW50LmFsdEtleSB8fCBldmVudC5jdHJs
        S2V5LAogICAgICBzZWNvbmRhcnlDbGljayA9IGV2ZW50LndoaWNoID4gMTsg
        Ly8gSUU5IG1heSByZXR1cm4gdW5kZWZpbmVkCgogIHJldHVybiAhbW9kaWZp
        ZXIgJiYgIXNlY29uZGFyeUNsaWNrOwp9CgpFbWJlci5WaWV3VXRpbHMgPSB7
        CiAgc2V0SW5uZXJIVE1MOiBzZXRJbm5lckhUTUwsCiAgaXNTaW1wbGVDbGlj
        azogaXNTaW1wbGVDbGljawp9OwoKfSkoKTsKCgoKKGZ1bmN0aW9uKCkgewov
        KioKQG1vZHVsZSBlbWJlcgpAc3VibW9kdWxlIGVtYmVyLXZpZXdzCiovCgp2
        YXIgZ2V0ID0gRW1iZXIuZ2V0LCBzZXQgPSBFbWJlci5zZXQ7Cgp2YXIgQ2xh
        c3NTZXQgPSBmdW5jdGlvbigpIHsKICB0aGlzLnNlZW4gPSB7fTsKICB0aGlz
        Lmxpc3QgPSBbXTsKfTsKCkNsYXNzU2V0LnByb3RvdHlwZSA9IHsKICBhZGQ6
        IGZ1bmN0aW9uKHN0cmluZykgewogICAgaWYgKHN0cmluZyBpbiB0aGlzLnNl
        ZW4pIHsgcmV0dXJuOyB9CiAgICB0aGlzLnNlZW5bc3RyaW5nXSA9IHRydWU7
        CgogICAgdGhpcy5saXN0LnB1c2goc3RyaW5nKTsKICB9LAoKICB0b0RPTTog
        ZnVuY3Rpb24oKSB7CiAgICByZXR1cm4gdGhpcy5saXN0LmpvaW4oIiAiKTsK
        ICB9Cn07Cgp2YXIgQkFEX1RBR19OQU1FX1RFU1RfUkVHRVhQID0gL1teYS16
        QS1aMC05XC1dLzsKdmFyIEJBRF9UQUdfTkFNRV9SRVBMQUNFX1JFR0VYUCA9
        IC9bXmEtekEtWjAtOVwtXS9nOwoKZnVuY3Rpb24gc3RyaXBUYWdOYW1lKHRh
        Z05hbWUpIHsKICBpZiAoIXRhZ05hbWUpIHsKICAgIHJldHVybiB0YWdOYW1l
        OwogIH0KCiAgaWYgKCFCQURfVEFHX05BTUVfVEVTVF9SRUdFWFAudGVzdCh0
        YWdOYW1lKSkgewogICAgcmV0dXJuIHRhZ05hbWU7CiAgfQoKICByZXR1cm4g
        dGFnTmFtZS5yZXBsYWNlKEJBRF9UQUdfTkFNRV9SRVBMQUNFX1JFR0VYUCwg
        JycpOwp9Cgp2YXIgQkFEX0NIQVJTX1JFR0VYUCA9IC8mKD8hXHcrOyl8Wzw+
        IidgXS9nOwp2YXIgUE9TU0lCTEVfQ0hBUlNfUkVHRVhQID0gL1smPD4iJ2Bd
        LzsKCmZ1bmN0aW9uIGVzY2FwZUF0dHJpYnV0ZSh2YWx1ZSkgewogIC8vIFN0
        b2xlbiBzaGFtZWxlc3NseSBmcm9tIEhhbmRsZWJhcnMKCiAgdmFyIGVzY2Fw
        ZSA9IHsKICAgICI8IjogIiZsdDsiLAogICAgIj4iOiAiJmd0OyIsCiAgICAn
        Iic6ICImcXVvdDsiLAogICAgIiciOiAiJiN4Mjc7IiwKICAgICJgIjogIiYj
        eDYwOyIKICB9OwoKICB2YXIgZXNjYXBlQ2hhciA9IGZ1bmN0aW9uKGNocikg
        ewogICAgcmV0dXJuIGVzY2FwZVtjaHJdIHx8ICImYW1wOyI7CiAgfTsKCiAg
        dmFyIHN0cmluZyA9IHZhbHVlLnRvU3RyaW5nKCk7CgogIGlmKCFQT1NTSUJM
        RV9DSEFSU19SRUdFWFAudGVzdChzdHJpbmcpKSB7IHJldHVybiBzdHJpbmc7
        IH0KICByZXR1cm4gc3RyaW5nLnJlcGxhY2UoQkFEX0NIQVJTX1JFR0VYUCwg
        ZXNjYXBlQ2hhcik7Cn0KCi8vIElFIDYvNyBoYXZlIGJ1Z3MgYXJvbmQgc2V0
        dGluZyBuYW1lcyBvbiBpbnB1dHMgZHVyaW5nIGNyZWF0aW9uLgovLyBGcm9t
        IGh0dHA6Ly9tc2RuLm1pY3Jvc29mdC5jb20vZW4tdXMvbGlicmFyeS9pZS9t
        czUzNjM4OSh2PXZzLjg1KS5hc3B4OgovLyAiVG8gaW5jbHVkZSB0aGUgTkFN
        RSBhdHRyaWJ1dGUgYXQgcnVuIHRpbWUgb24gb2JqZWN0cyBjcmVhdGVkIHdp
        dGggdGhlIGNyZWF0ZUVsZW1lbnQgbWV0aG9kLCB1c2UgdGhlIGVUYWcuIgp2
        YXIgY2FuU2V0TmFtZU9uSW5wdXRzID0gKGZ1bmN0aW9uKCkgewogIHZhciBk
        aXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKSwKICAgICAgZWwg
        PSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcpOwoKICBlbC5zZXRB
        dHRyaWJ1dGUoJ25hbWUnLCAnZm9vJyk7CiAgZGl2LmFwcGVuZENoaWxkKGVs
        KTsKCiAgcmV0dXJuICEhZGl2LmlubmVySFRNTC5tYXRjaCgnZm9vJyk7Cn0p
        KCk7CgovKioKICBgRW1iZXIuUmVuZGVyQnVmZmVyYCBnYXRoZXJzIGluZm9y
        bWF0aW9uIHJlZ2FyZGluZyB0aGUgYSB2aWV3IGFuZCBnZW5lcmF0ZXMgdGhl
        CiAgZmluYWwgcmVwcmVzZW50YXRpb24uIGBFbWJlci5SZW5kZXJCdWZmZXJg
        IHdpbGwgZ2VuZXJhdGUgSFRNTCB3aGljaCBjYW4gYmUgcHVzaGVkCiAgdG8g
        dGhlIERPTS4KCiAgIGBgYGphdmFzY3JpcHQKICAgdmFyIGJ1ZmZlciA9IEVt
        YmVyLlJlbmRlckJ1ZmZlcignZGl2Jyk7CiAgYGBgCgogIEBjbGFzcyBSZW5k
        ZXJCdWZmZXIKICBAbmFtZXNwYWNlIEVtYmVyCiAgQGNvbnN0cnVjdG9yCiAg
        QHBhcmFtIHtTdHJpbmd9IHRhZ05hbWUgdGFnIG5hbWUgKHN1Y2ggYXMgJ2Rp
        dicgb3IgJ3AnKSB1c2VkIGZvciB0aGUgYnVmZmVyCiovCkVtYmVyLlJlbmRl
        ckJ1ZmZlciA9IGZ1bmN0aW9uKHRhZ05hbWUpIHsKICByZXR1cm4gbmV3IEVt
        YmVyLl9SZW5kZXJCdWZmZXIodGFnTmFtZSk7Cn07CgpFbWJlci5fUmVuZGVy
        QnVmZmVyID0gZnVuY3Rpb24odGFnTmFtZSkgewogIHRoaXMudGFnTmFtZXMg
        PSBbdGFnTmFtZSB8fCBudWxsXTsKICB0aGlzLmJ1ZmZlciA9ICIiOwp9OwoK
        RW1iZXIuX1JlbmRlckJ1ZmZlci5wcm90b3R5cGUgPQovKiogQHNjb3BlIEVt
        YmVyLlJlbmRlckJ1ZmZlci5wcm90b3R5cGUgKi8gewoKICAvLyBUaGUgcm9v
        dCB2aWV3J3MgZWxlbWVudAogIF9lbGVtZW50OiBudWxsLAoKICBfaGFzRWxl
        bWVudDogdHJ1ZSwKCiAgLyoqCiAgICBAcHJpdmF0ZQoKICAgIEFuIGludGVy
        bmFsIHNldCB1c2VkIHRvIGRlLWR1cGUgY2xhc3MgbmFtZXMgd2hlbiBgYWRk
        Q2xhc3MoKWAgaXMKICAgIHVzZWQuIEFmdGVyIGVhY2ggY2FsbCB0byBgYWRk
        Q2xhc3MoKWAsIHRoZSBgY2xhc3Nlc2AgcHJvcGVydHkKICAgIHdpbGwgYmUg
        dXBkYXRlZC4KCiAgICBAcHJvcGVydHkgZWxlbWVudENsYXNzZXMKICAgIEB0
        eXBlIEFycmF5CiAgICBAZGVmYXVsdCBbXQogICovCiAgZWxlbWVudENsYXNz
        ZXM6IG51bGwsCgogIC8qKgogICAgQXJyYXkgb2YgY2xhc3MgbmFtZXMgd2hp
        Y2ggd2lsbCBiZSBhcHBsaWVkIGluIHRoZSBjbGFzcyBhdHRyaWJ1dGUuCgog
        ICAgWW91IGNhbiB1c2UgYHNldENsYXNzZXMoKWAgdG8gc2V0IHRoaXMgcHJv
        cGVydHkgZGlyZWN0bHkuIElmIHlvdQogICAgdXNlIGBhZGRDbGFzcygpYCwg
        aXQgd2lsbCBiZSBtYWludGFpbmVkIGZvciB5b3UuCgogICAgQHByb3BlcnR5
        IGNsYXNzZXMKICAgIEB0eXBlIEFycmF5CiAgICBAZGVmYXVsdCBbXQogICov
        CiAgY2xhc3NlczogbnVsbCwKCiAgLyoqCiAgICBUaGUgaWQgaW4gb2YgdGhl
        IGVsZW1lbnQsIHRvIGJlIGFwcGxpZWQgaW4gdGhlIGlkIGF0dHJpYnV0ZS4K
        CiAgICBZb3Ugc2hvdWxkIG5vdCBzZXQgdGhpcyBwcm9wZXJ0eSB5b3Vyc2Vs
        ZiwgcmF0aGVyLCB5b3Ugc2hvdWxkIHVzZQogICAgdGhlIGBpZCgpYCBtZXRo
        b2Qgb2YgYEVtYmVyLlJlbmRlckJ1ZmZlcmAuCgogICAgQHByb3BlcnR5IGVs
        ZW1lbnRJZAogICAgQHR5cGUgU3RyaW5nCiAgICBAZGVmYXVsdCBudWxsCiAg
        Ki8KICBlbGVtZW50SWQ6IG51bGwsCgogIC8qKgogICAgQSBoYXNoIGtleWVk
        IG9uIHRoZSBuYW1lIG9mIHRoZSBhdHRyaWJ1dGUgYW5kIHdob3NlIHZhbHVl
        IHdpbGwgYmUKICAgIGFwcGxpZWQgdG8gdGhhdCBhdHRyaWJ1dGUuIEZvciBl
        eGFtcGxlLCBpZiB5b3Ugd2FudGVkIHRvIGFwcGx5IGEKICAgIGBkYXRhLXZp
        ZXc9IkZvby5iYXIiYCBwcm9wZXJ0eSB0byBhbiBlbGVtZW50LCB5b3Ugd291
        bGQgc2V0IHRoZQogICAgZWxlbWVudEF0dHJpYnV0ZXMgaGFzaCB0byBgeydk
        YXRhLXZpZXcnOidGb28uYmFyJ31gLgoKICAgIFlvdSBzaG91bGQgbm90IG1h
        aW50YWluIHRoaXMgaGFzaCB5b3Vyc2VsZiwgcmF0aGVyLCB5b3Ugc2hvdWxk
        IHVzZQogICAgdGhlIGBhdHRyKClgIG1ldGhvZCBvZiBgRW1iZXIuUmVuZGVy
        QnVmZmVyYC4KCiAgICBAcHJvcGVydHkgZWxlbWVudEF0dHJpYnV0ZXMKICAg
        IEB0eXBlIEhhc2gKICAgIEBkZWZhdWx0IHt9CiAgKi8KICBlbGVtZW50QXR0
        cmlidXRlczogbnVsbCwKCiAgLyoqCiAgICBBIGhhc2gga2V5ZWQgb24gdGhl
        IG5hbWUgb2YgdGhlIHByb3BlcnRpZXMgYW5kIHdob3NlIHZhbHVlIHdpbGwg
        YmUKICAgIGFwcGxpZWQgdG8gdGhhdCBwcm9wZXJ0eS4gRm9yIGV4YW1wbGUs
        IGlmIHlvdSB3YW50ZWQgdG8gYXBwbHkgYQogICAgYGNoZWNrZWQ9dHJ1ZWAg
        cHJvcGVydHkgdG8gYW4gZWxlbWVudCwgeW91IHdvdWxkIHNldCB0aGUKICAg
        IGVsZW1lbnRQcm9wZXJ0aWVzIGhhc2ggdG8gYHsnY2hlY2tlZCc6dHJ1ZX1g
        LgoKICAgIFlvdSBzaG91bGQgbm90IG1haW50YWluIHRoaXMgaGFzaCB5b3Vy
        c2VsZiwgcmF0aGVyLCB5b3Ugc2hvdWxkIHVzZQogICAgdGhlIGBwcm9wKClg
        IG1ldGhvZCBvZiBgRW1iZXIuUmVuZGVyQnVmZmVyYC4KCiAgICBAcHJvcGVy
        dHkgZWxlbWVudFByb3BlcnRpZXMKICAgIEB0eXBlIEhhc2gKICAgIEBkZWZh
        dWx0IHt9CiAgKi8KICBlbGVtZW50UHJvcGVydGllczogbnVsbCwKCiAgLyoq
        CiAgICBUaGUgdGFnbmFtZSBvZiB0aGUgZWxlbWVudCBhbiBpbnN0YW5jZSBv
        ZiBgRW1iZXIuUmVuZGVyQnVmZmVyYCByZXByZXNlbnRzLgoKICAgIFVzdWFs
        bHksIHRoaXMgZ2V0cyBzZXQgYXMgdGhlIGZpcnN0IHBhcmFtZXRlciB0byBg
        RW1iZXIuUmVuZGVyQnVmZmVyYC4gRm9yCiAgICBleGFtcGxlLCBpZiB5b3Ug
        d2FudGVkIHRvIGNyZWF0ZSBhIGBwYCB0YWcsIHRoZW4geW91IHdvdWxkIGNh
        bGwKCiAgICBgYGBqYXZhc2NyaXB0CiAgICBFbWJlci5SZW5kZXJCdWZmZXIo
        J3AnKQogICAgYGBgCgogICAgQHByb3BlcnR5IGVsZW1lbnRUYWcKICAgIEB0
        eXBlIFN0cmluZwogICAgQGRlZmF1bHQgbnVsbAogICovCiAgZWxlbWVudFRh
        ZzogbnVsbCwKCiAgLyoqCiAgICBBIGhhc2gga2V5ZWQgb24gdGhlIG5hbWUg
        b2YgdGhlIHN0eWxlIGF0dHJpYnV0ZSBhbmQgd2hvc2UgdmFsdWUgd2lsbAog
        ICAgYmUgYXBwbGllZCB0byB0aGF0IGF0dHJpYnV0ZS4gRm9yIGV4YW1wbGUs
        IGlmIHlvdSB3YW50ZWQgdG8gYXBwbHkgYQogICAgYGJhY2tncm91bmQtY29s
        b3I6YmxhY2s7YCBzdHlsZSB0byBhbiBlbGVtZW50LCB5b3Ugd291bGQgc2V0
        IHRoZQogICAgZWxlbWVudFN0eWxlIGhhc2ggdG8gYHsnYmFja2dyb3VuZC1j
        b2xvcic6J2JsYWNrJ31gLgoKICAgIFlvdSBzaG91bGQgbm90IG1haW50YWlu
        IHRoaXMgaGFzaCB5b3Vyc2VsZiwgcmF0aGVyLCB5b3Ugc2hvdWxkIHVzZQog
        ICAgdGhlIGBzdHlsZSgpYCBtZXRob2Qgb2YgYEVtYmVyLlJlbmRlckJ1ZmZl
        cmAuCgogICAgQHByb3BlcnR5IGVsZW1lbnRTdHlsZQogICAgQHR5cGUgSGFz
        aAogICAgQGRlZmF1bHQge30KICAqLwogIGVsZW1lbnRTdHlsZTogbnVsbCwK
        CiAgLyoqCiAgICBOZXN0ZWQgYFJlbmRlckJ1ZmZlcnNgIHdpbGwgc2V0IHRo
        aXMgdG8gdGhlaXIgcGFyZW50IGBSZW5kZXJCdWZmZXJgCiAgICBpbnN0YW5j
        ZS4KCiAgICBAcHJvcGVydHkgcGFyZW50QnVmZmVyCiAgICBAdHlwZSBFbWJl
        ci5fUmVuZGVyQnVmZmVyCiAgKi8KICBwYXJlbnRCdWZmZXI6IG51bGwsCgog
        IC8qKgogICAgQWRkcyBhIHN0cmluZyBvZiBIVE1MIHRvIHRoZSBgUmVuZGVy
        QnVmZmVyYC4KCiAgICBAbWV0aG9kIHB1c2gKICAgIEBwYXJhbSB7U3RyaW5n
        fSBzdHJpbmcgSFRNTCB0byBwdXNoIGludG8gdGhlIGJ1ZmZlcgogICAgQGNo
        YWluYWJsZQogICovCiAgcHVzaDogZnVuY3Rpb24oc3RyaW5nKSB7CiAgICB0
        aGlzLmJ1ZmZlciArPSBzdHJpbmc7CiAgICByZXR1cm4gdGhpczsKICB9LAoK
        ICAvKioKICAgIEFkZHMgYSBjbGFzcyB0byB0aGUgYnVmZmVyLCB3aGljaCB3
        aWxsIGJlIHJlbmRlcmVkIHRvIHRoZSBjbGFzcyBhdHRyaWJ1dGUuCgogICAg
        QG1ldGhvZCBhZGRDbGFzcwogICAgQHBhcmFtIHtTdHJpbmd9IGNsYXNzTmFt
        ZSBDbGFzcyBuYW1lIHRvIGFkZCB0byB0aGUgYnVmZmVyCiAgICBAY2hhaW5h
        YmxlCiAgKi8KICBhZGRDbGFzczogZnVuY3Rpb24oY2xhc3NOYW1lKSB7CiAg
        ICAvLyBsYXppbHkgY3JlYXRlIGVsZW1lbnRDbGFzc2VzCiAgICB0aGlzLmVs
        ZW1lbnRDbGFzc2VzID0gKHRoaXMuZWxlbWVudENsYXNzZXMgfHwgbmV3IENs
        YXNzU2V0KCkpOwogICAgdGhpcy5lbGVtZW50Q2xhc3Nlcy5hZGQoY2xhc3NO
        YW1lKTsKICAgIHRoaXMuY2xhc3NlcyA9IHRoaXMuZWxlbWVudENsYXNzZXMu
        bGlzdDsKCiAgICByZXR1cm4gdGhpczsKICB9LAoKICBzZXRDbGFzc2VzOiBm
        dW5jdGlvbihjbGFzc05hbWVzKSB7CiAgICB0aGlzLmNsYXNzZXMgPSBjbGFz
        c05hbWVzOwogIH0sCgogIC8qKgogICAgU2V0cyB0aGUgZWxlbWVudElEIHRv
        IGJlIHVzZWQgZm9yIHRoZSBlbGVtZW50LgoKICAgIEBtZXRob2QgaWQKICAg
        IEBwYXJhbSB7U3RyaW5nfSBpZAogICAgQGNoYWluYWJsZQogICovCiAgaWQ6
        IGZ1bmN0aW9uKGlkKSB7CiAgICB0aGlzLmVsZW1lbnRJZCA9IGlkOwogICAg
        cmV0dXJuIHRoaXM7CiAgfSwKCiAgLy8gZHVjayB0eXBlIGF0dHJpYnV0ZSBm
        dW5jdGlvbmFsaXR5IGxpa2UgalF1ZXJ5IHNvIGEgcmVuZGVyIGJ1ZmZlcgog
        IC8vIGNhbiBiZSB1c2VkIGxpa2UgYSBqUXVlcnkgb2JqZWN0IGluIGF0dHJp
        YnV0ZSBiaW5kaW5nIHNjZW5hcmlvcy4KCiAgLyoqCiAgICBBZGRzIGFuIGF0
        dHJpYnV0ZSB3aGljaCB3aWxsIGJlIHJlbmRlcmVkIHRvIHRoZSBlbGVtZW50
        LgoKICAgIEBtZXRob2QgYXR0cgogICAgQHBhcmFtIHtTdHJpbmd9IG5hbWUg
        VGhlIG5hbWUgb2YgdGhlIGF0dHJpYnV0ZQogICAgQHBhcmFtIHtTdHJpbmd9
        IHZhbHVlIFRoZSB2YWx1ZSB0byBhZGQgdG8gdGhlIGF0dHJpYnV0ZQogICAg
        QGNoYWluYWJsZQogICAgQHJldHVybiB7RW1iZXIuUmVuZGVyQnVmZmVyfFN0
        cmluZ30gdGhpcyBvciB0aGUgY3VycmVudCBhdHRyaWJ1dGUgdmFsdWUKICAq
        LwogIGF0dHI6IGZ1bmN0aW9uKG5hbWUsIHZhbHVlKSB7CiAgICB2YXIgYXR0
        cmlidXRlcyA9IHRoaXMuZWxlbWVudEF0dHJpYnV0ZXMgPSAodGhpcy5lbGVt
        ZW50QXR0cmlidXRlcyB8fCB7fSk7CgogICAgaWYgKGFyZ3VtZW50cy5sZW5n
        dGggPT09IDEpIHsKICAgICAgcmV0dXJuIGF0dHJpYnV0ZXNbbmFtZV07CiAg
        ICB9IGVsc2UgewogICAgICBhdHRyaWJ1dGVzW25hbWVdID0gdmFsdWU7CiAg
        ICB9CgogICAgcmV0dXJuIHRoaXM7CiAgfSwKCiAgLyoqCiAgICBSZW1vdmUg
        YW4gYXR0cmlidXRlIGZyb20gdGhlIGxpc3Qgb2YgYXR0cmlidXRlcyB0byBy
        ZW5kZXIuCgogICAgQG1ldGhvZCByZW1vdmVBdHRyCiAgICBAcGFyYW0ge1N0
        cmluZ30gbmFtZSBUaGUgbmFtZSBvZiB0aGUgYXR0cmlidXRlCiAgICBAY2hh
        aW5hYmxlCiAgKi8KICByZW1vdmVBdHRyOiBmdW5jdGlvbihuYW1lKSB7CiAg
        ICB2YXIgYXR0cmlidXRlcyA9IHRoaXMuZWxlbWVudEF0dHJpYnV0ZXM7CiAg
        ICBpZiAoYXR0cmlidXRlcykgeyBkZWxldGUgYXR0cmlidXRlc1tuYW1lXTsg
        fQoKICAgIHJldHVybiB0aGlzOwogIH0sCgogIC8qKgogICAgQWRkcyBhbiBw
        cm9wZXJ0eSB3aGljaCB3aWxsIGJlIHJlbmRlcmVkIHRvIHRoZSBlbGVtZW50
        LgoKICAgIEBtZXRob2QgcHJvcAogICAgQHBhcmFtIHtTdHJpbmd9IG5hbWUg
        VGhlIG5hbWUgb2YgdGhlIHByb3BlcnR5CiAgICBAcGFyYW0ge1N0cmluZ30g
        dmFsdWUgVGhlIHZhbHVlIHRvIGFkZCB0byB0aGUgcHJvcGVydHkKICAgIEBj
        aGFpbmFibGUKICAgIEByZXR1cm4ge0VtYmVyLlJlbmRlckJ1ZmZlcnxTdHJp
        bmd9IHRoaXMgb3IgdGhlIGN1cnJlbnQgcHJvcGVydHkgdmFsdWUKICAqLwog
        IHByb3A6IGZ1bmN0aW9uKG5hbWUsIHZhbHVlKSB7CiAgICB2YXIgcHJvcGVy
        dGllcyA9IHRoaXMuZWxlbWVudFByb3BlcnRpZXMgPSAodGhpcy5lbGVtZW50
        UHJvcGVydGllcyB8fCB7fSk7CgogICAgaWYgKGFyZ3VtZW50cy5sZW5ndGgg
        PT09IDEpIHsKICAgICAgcmV0dXJuIHByb3BlcnRpZXNbbmFtZV07CiAgICB9
        IGVsc2UgewogICAgICBwcm9wZXJ0aWVzW25hbWVdID0gdmFsdWU7CiAgICB9
        CgogICAgcmV0dXJuIHRoaXM7CiAgfSwKCiAgLyoqCiAgICBSZW1vdmUgYW4g
        cHJvcGVydHkgZnJvbSB0aGUgbGlzdCBvZiBwcm9wZXJ0aWVzIHRvIHJlbmRl
        ci4KCiAgICBAbWV0aG9kIHJlbW92ZVByb3AKICAgIEBwYXJhbSB7U3RyaW5n
        fSBuYW1lIFRoZSBuYW1lIG9mIHRoZSBwcm9wZXJ0eQogICAgQGNoYWluYWJs
        ZQogICovCiAgcmVtb3ZlUHJvcDogZnVuY3Rpb24obmFtZSkgewogICAgdmFy
        IHByb3BlcnRpZXMgPSB0aGlzLmVsZW1lbnRQcm9wZXJ0aWVzOwogICAgaWYg
        KHByb3BlcnRpZXMpIHsgZGVsZXRlIHByb3BlcnRpZXNbbmFtZV07IH0KCiAg
        ICByZXR1cm4gdGhpczsKICB9LAoKICAvKioKICAgIEFkZHMgYSBzdHlsZSB0
        byB0aGUgc3R5bGUgYXR0cmlidXRlIHdoaWNoIHdpbGwgYmUgcmVuZGVyZWQg
        dG8gdGhlIGVsZW1lbnQuCgogICAgQG1ldGhvZCBzdHlsZQogICAgQHBhcmFt
        IHtTdHJpbmd9IG5hbWUgTmFtZSBvZiB0aGUgc3R5bGUKICAgIEBwYXJhbSB7
        U3RyaW5nfSB2YWx1ZQogICAgQGNoYWluYWJsZQogICovCiAgc3R5bGU6IGZ1
        bmN0aW9uKG5hbWUsIHZhbHVlKSB7CiAgICB0aGlzLmVsZW1lbnRTdHlsZSA9
        ICh0aGlzLmVsZW1lbnRTdHlsZSB8fCB7fSk7CgogICAgdGhpcy5lbGVtZW50
        U3R5bGVbbmFtZV0gPSB2YWx1ZTsKICAgIHJldHVybiB0aGlzOwogIH0sCgog
        IGJlZ2luOiBmdW5jdGlvbih0YWdOYW1lKSB7CiAgICB0aGlzLnRhZ05hbWVz
        LnB1c2godGFnTmFtZSB8fCBudWxsKTsKICAgIHJldHVybiB0aGlzOwogIH0s
        CgogIHB1c2hPcGVuaW5nVGFnOiBmdW5jdGlvbigpIHsKICAgIHZhciB0YWdO
        YW1lID0gdGhpcy5jdXJyZW50VGFnTmFtZSgpOwogICAgaWYgKCF0YWdOYW1l
        KSB7IHJldHVybjsgfQoKICAgIGlmICh0aGlzLl9oYXNFbGVtZW50ICYmICF0
        aGlzLl9lbGVtZW50ICYmIHRoaXMuYnVmZmVyLmxlbmd0aCA9PT0gMCkgewog
        ICAgICB0aGlzLl9lbGVtZW50ID0gdGhpcy5nZW5lcmF0ZUVsZW1lbnQoKTsK
        ICAgICAgcmV0dXJuOwogICAgfQoKICAgIHZhciBidWZmZXIgPSB0aGlzLmJ1
        ZmZlciwKICAgICAgICBpZCA9IHRoaXMuZWxlbWVudElkLAogICAgICAgIGNs
        YXNzZXMgPSB0aGlzLmNsYXNzZXMsCiAgICAgICAgYXR0cnMgPSB0aGlzLmVs
        ZW1lbnRBdHRyaWJ1dGVzLAogICAgICAgIHByb3BzID0gdGhpcy5lbGVtZW50
        UHJvcGVydGllcywKICAgICAgICBzdHlsZSA9IHRoaXMuZWxlbWVudFN0eWxl
        LAogICAgICAgIGF0dHIsIHByb3A7CgogICAgYnVmZmVyICs9ICc8JyArIHN0
        cmlwVGFnTmFtZSh0YWdOYW1lKTsKCiAgICBpZiAoaWQpIHsKICAgICAgYnVm
        ZmVyICs9ICcgaWQ9IicgKyBlc2NhcGVBdHRyaWJ1dGUoaWQpICsgJyInOwog
        ICAgICB0aGlzLmVsZW1lbnRJZCA9IG51bGw7CiAgICB9CiAgICBpZiAoY2xh
        c3NlcykgewogICAgICBidWZmZXIgKz0gJyBjbGFzcz0iJyArIGVzY2FwZUF0
        dHJpYnV0ZShjbGFzc2VzLmpvaW4oJyAnKSkgKyAnIic7CiAgICAgIHRoaXMu
        Y2xhc3NlcyA9IG51bGw7CiAgICB9CgogICAgaWYgKHN0eWxlKSB7CiAgICAg
        IGJ1ZmZlciArPSAnIHN0eWxlPSInOwoKICAgICAgZm9yIChwcm9wIGluIHN0
        eWxlKSB7CiAgICAgICAgaWYgKHN0eWxlLmhhc093blByb3BlcnR5KHByb3Ap
        KSB7CiAgICAgICAgICBidWZmZXIgKz0gcHJvcCArICc6JyArIGVzY2FwZUF0
        dHJpYnV0ZShzdHlsZVtwcm9wXSkgKyAnOyc7CiAgICAgICAgfQogICAgICB9
        CgogICAgICBidWZmZXIgKz0gJyInOwoKICAgICAgdGhpcy5lbGVtZW50U3R5
        bGUgPSBudWxsOwogICAgfQoKICAgIGlmIChhdHRycykgewogICAgICBmb3Ig
        KGF0dHIgaW4gYXR0cnMpIHsKICAgICAgICBpZiAoYXR0cnMuaGFzT3duUHJv
        cGVydHkoYXR0cikpIHsKICAgICAgICAgIGJ1ZmZlciArPSAnICcgKyBhdHRy
        ICsgJz0iJyArIGVzY2FwZUF0dHJpYnV0ZShhdHRyc1thdHRyXSkgKyAnIic7
        CiAgICAgICAgfQogICAgICB9CgogICAgICB0aGlzLmVsZW1lbnRBdHRyaWJ1
        dGVzID0gbnVsbDsKICAgIH0KCiAgICBpZiAocHJvcHMpIHsKICAgICAgZm9y
        IChwcm9wIGluIHByb3BzKSB7CiAgICAgICAgaWYgKHByb3BzLmhhc093blBy
        b3BlcnR5KHByb3ApKSB7CiAgICAgICAgICB2YXIgdmFsdWUgPSBwcm9wc1tw
        cm9wXTsKICAgICAgICAgIGlmICh2YWx1ZSB8fCB0eXBlb2YodmFsdWUpID09
        PSAnbnVtYmVyJykgewogICAgICAgICAgICBpZiAodmFsdWUgPT09IHRydWUp
        IHsKICAgICAgICAgICAgICBidWZmZXIgKz0gJyAnICsgcHJvcCArICc9Iicg
        KyBwcm9wICsgJyInOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAg
        ICAgIGJ1ZmZlciArPSAnICcgKyBwcm9wICsgJz0iJyArIGVzY2FwZUF0dHJp
        YnV0ZShwcm9wc1twcm9wXSkgKyAnIic7CiAgICAgICAgICAgIH0KICAgICAg
        ICAgIH0KICAgICAgICB9CiAgICAgIH0KCiAgICAgIHRoaXMuZWxlbWVudFBy
        b3BlcnRpZXMgPSBudWxsOwogICAgfQoKICAgIGJ1ZmZlciArPSAnPic7CiAg
        ICB0aGlzLmJ1ZmZlciA9IGJ1ZmZlcjsKICB9LAoKICBwdXNoQ2xvc2luZ1Rh
        ZzogZnVuY3Rpb24oKSB7CiAgICB2YXIgdGFnTmFtZSA9IHRoaXMudGFnTmFt
        ZXMucG9wKCk7CiAgICBpZiAodGFnTmFtZSkgeyB0aGlzLmJ1ZmZlciArPSAn
        PC8nICsgc3RyaXBUYWdOYW1lKHRhZ05hbWUpICsgJz4nOyB9CiAgfSwKCiAg
        Y3VycmVudFRhZ05hbWU6IGZ1bmN0aW9uKCkgewogICAgcmV0dXJuIHRoaXMu
        dGFnTmFtZXNbdGhpcy50YWdOYW1lcy5sZW5ndGgtMV07CiAgfSwKCiAgZ2Vu
        ZXJhdGVFbGVtZW50OiBmdW5jdGlvbigpIHsKICAgIHZhciB0YWdOYW1lID0g
        dGhpcy50YWdOYW1lcy5wb3AoKSwgLy8gcG9wIHNpbmNlIHdlIGRvbid0IG5l
        ZWQgdG8gY2xvc2UKICAgICAgICBpZCA9IHRoaXMuZWxlbWVudElkLAogICAg
        ICAgIGNsYXNzZXMgPSB0aGlzLmNsYXNzZXMsCiAgICAgICAgYXR0cnMgPSB0
        aGlzLmVsZW1lbnRBdHRyaWJ1dGVzLAogICAgICAgIHByb3BzID0gdGhpcy5l
        bGVtZW50UHJvcGVydGllcywKICAgICAgICBzdHlsZSA9IHRoaXMuZWxlbWVu
        dFN0eWxlLAogICAgICAgIHN0eWxlQnVmZmVyID0gJycsIGF0dHIsIHByb3As
        IHRhZ1N0cmluZzsKCiAgICBpZiAoYXR0cnMgJiYgYXR0cnMubmFtZSAmJiAh
        Y2FuU2V0TmFtZU9uSW5wdXRzKSB7CiAgICAgIC8vIElFIGFsbG93cyBwYXNz
        aW5nIGEgdGFnIHRvIGNyZWF0ZUVsZW1lbnQuIFNlZSBub3RlIG9uIGBjYW5T
        ZXROYW1lT25JbnB1dHNgIGFib3ZlIGFzIHdlbGwuCiAgICAgIHRhZ1N0cmlu
        ZyA9ICc8JytzdHJpcFRhZ05hbWUodGFnTmFtZSkrJyBuYW1lPSInK2VzY2Fw
        ZUF0dHJpYnV0ZShhdHRycy5uYW1lKSsnIj4nOwogICAgfSBlbHNlIHsKICAg
        ICAgdGFnU3RyaW5nID0gdGFnTmFtZTsKICAgIH0KCiAgICB2YXIgZWxlbWVu
        dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQodGFnU3RyaW5nKSwKICAgICAg
        ICAkZWxlbWVudCA9IEVtYmVyLiQoZWxlbWVudCk7CgogICAgaWYgKGlkKSB7
        CiAgICAgICRlbGVtZW50LmF0dHIoJ2lkJywgaWQpOwogICAgICB0aGlzLmVs
        ZW1lbnRJZCA9IG51bGw7CiAgICB9CiAgICBpZiAoY2xhc3NlcykgewogICAg
        ICAkZWxlbWVudC5hdHRyKCdjbGFzcycsIGNsYXNzZXMuam9pbignICcpKTsK
        ICAgICAgdGhpcy5jbGFzc2VzID0gbnVsbDsKICAgIH0KCiAgICBpZiAoc3R5
        bGUpIHsKICAgICAgZm9yIChwcm9wIGluIHN0eWxlKSB7CiAgICAgICAgaWYg
        KHN0eWxlLmhhc093blByb3BlcnR5KHByb3ApKSB7CiAgICAgICAgICBzdHls
        ZUJ1ZmZlciArPSAocHJvcCArICc6JyArIHN0eWxlW3Byb3BdICsgJzsnKTsK
        ICAgICAgICB9CiAgICAgIH0KCiAgICAgICRlbGVtZW50LmF0dHIoJ3N0eWxl
        Jywgc3R5bGVCdWZmZXIpOwoKICAgICAgdGhpcy5lbGVtZW50U3R5bGUgPSBu
        dWxsOwogICAgfQoKICAgIGlmIChhdHRycykgewogICAgICBmb3IgKGF0dHIg
        aW4gYXR0cnMpIHsKICAgICAgICBpZiAoYXR0cnMuaGFzT3duUHJvcGVydHko
        YXR0cikpIHsKICAgICAgICAgICRlbGVtZW50LmF0dHIoYXR0ciwgYXR0cnNb
        YXR0cl0pOwogICAgICAgIH0KICAgICAgfQoKICAgICAgdGhpcy5lbGVtZW50
        QXR0cmlidXRlcyA9IG51bGw7CiAgICB9CgogICAgaWYgKHByb3BzKSB7CiAg
        ICAgIGZvciAocHJvcCBpbiBwcm9wcykgewogICAgICAgIGlmIChwcm9wcy5o
        YXNPd25Qcm9wZXJ0eShwcm9wKSkgewogICAgICAgICAgJGVsZW1lbnQucHJv
        cChwcm9wLCBwcm9wc1twcm9wXSk7CiAgICAgICAgfQogICAgICB9CgogICAg
        ICB0aGlzLmVsZW1lbnRQcm9wZXJ0aWVzID0gbnVsbDsKICAgIH0KCiAgICBy
        ZXR1cm4gZWxlbWVudDsKICB9LAoKICAvKioKICAgIEBtZXRob2QgZWxlbWVu
        dAogICAgQHJldHVybiB7RE9NRWxlbWVudH0gVGhlIGVsZW1lbnQgY29ycmVz
        cG9uZGluZyB0byB0aGUgZ2VuZXJhdGVkIEhUTUwKICAgICAgb2YgdGhpcyBi
        dWZmZXIKICAqLwogIGVsZW1lbnQ6IGZ1bmN0aW9uKCkgewogICAgdmFyIGh0
        bWwgPSB0aGlzLmlubmVyU3RyaW5nKCk7CgogICAgaWYgKGh0bWwpIHsKICAg
        ICAgdGhpcy5fZWxlbWVudCA9IEVtYmVyLlZpZXdVdGlscy5zZXRJbm5lckhU
        TUwodGhpcy5fZWxlbWVudCwgaHRtbCk7CiAgICB9CgogICAgcmV0dXJuIHRo
        aXMuX2VsZW1lbnQ7CiAgfSwKCiAgLyoqCiAgICBHZW5lcmF0ZXMgdGhlIEhU
        TUwgY29udGVudCBmb3IgdGhpcyBidWZmZXIuCgogICAgQG1ldGhvZCBzdHJp
        bmcKICAgIEByZXR1cm4ge1N0cmluZ30gVGhlIGdlbmVyYXRlZCBIVE1MCiAg
        Ki8KICBzdHJpbmc6IGZ1bmN0aW9uKCkgewogICAgaWYgKHRoaXMuX2hhc0Vs
        ZW1lbnQgJiYgdGhpcy5fZWxlbWVudCkgewogICAgICAvLyBGaXJlZm94IHZl
        cnNpb25zIDwgMTEgZG8gbm90IGhhdmUgc3VwcG9ydCBmb3IgZWxlbWVudC5v
        dXRlckhUTUwuCiAgICAgIHZhciB0aGlzRWxlbWVudCA9IHRoaXMuZWxlbWVu
        dCgpLCBvdXRlckhUTUwgPSB0aGlzRWxlbWVudC5vdXRlckhUTUw7CiAgICAg
        IGlmICh0eXBlb2Ygb3V0ZXJIVE1MID09PSAndW5kZWZpbmVkJykgewogICAg
        ICAgIHJldHVybiBFbWJlci4kKCc8ZGl2Lz4nKS5hcHBlbmQodGhpc0VsZW1l
        bnQpLmh0bWwoKTsKICAgICAgfQogICAgICByZXR1cm4gb3V0ZXJIVE1MOwog
        ICAgfSBlbHNlIHsKICAgICAgcmV0dXJuIHRoaXMuaW5uZXJTdHJpbmcoKTsK
        ICAgIH0KICB9LAoKICBpbm5lclN0cmluZzogZnVuY3Rpb24oKSB7CiAgICBy
        ZXR1cm4gdGhpcy5idWZmZXI7CiAgfQp9OwoKfSkoKTsKCgoKKGZ1bmN0aW9u
        KCkgewovKioKQG1vZHVsZSBlbWJlcgpAc3VibW9kdWxlIGVtYmVyLXZpZXdz
        CiovCgp2YXIgZ2V0ID0gRW1iZXIuZ2V0LCBzZXQgPSBFbWJlci5zZXQsIGZt
        dCA9IEVtYmVyLlN0cmluZy5mbXQ7CgovKioKICBgRW1iZXIuRXZlbnREaXNw
        YXRjaGVyYCBoYW5kbGVzIGRlbGVnYXRpbmcgYnJvd3NlciBldmVudHMgdG8g
        dGhlaXIKICBjb3JyZXNwb25kaW5nIGBFbWJlci5WaWV3cy5gIEZvciBleGFt
        cGxlLCB3aGVuIHlvdSBjbGljayBvbiBhIHZpZXcsCiAgYEVtYmVyLkV2ZW50
        RGlzcGF0Y2hlcmAgZW5zdXJlcyB0aGF0IHRoYXQgdmlldydzIGBtb3VzZURv
        d25gIG1ldGhvZCBnZXRzCiAgY2FsbGVkLgoKICBAY2xhc3MgRXZlbnREaXNw
        YXRjaGVyCiAgQG5hbWVzcGFjZSBFbWJlcgogIEBwcml2YXRlCiAgQGV4dGVu
        ZHMgRW1iZXIuT2JqZWN0CiovCkVtYmVyLkV2ZW50RGlzcGF0Y2hlciA9IEVt
        YmVyLk9iamVjdC5leHRlbmQoLyoqIEBzY29wZSBFbWJlci5FdmVudERpc3Bh
        dGNoZXIucHJvdG90eXBlICovewoKICAvKioKICAgIFRoZSBzZXQgb2YgZXZl
        bnRzIG5hbWVzIChhbmQgYXNzb2NpYXRlZCBoYW5kbGVyIGZ1bmN0aW9uIG5h
        bWVzKSB0byBiZSBzZXR1cAogICAgYW5kIGRpc3BhdGNoZWQgYnkgdGhlIGBF
        dmVudERpc3BhdGNoZXJgLiBDdXN0b20gZXZlbnRzIGNhbiBhZGRlZCB0byB0
        aGlzIGxpc3QgYXQgc2V0dXAKICAgIHRpbWUsIGdlbmVyYWxseSB2aWEgdGhl
        IGBFbWJlci5BcHBsaWNhdGlvbi5jdXN0b21FdmVudHNgIGhhc2guIE9ubHkg
        b3ZlcnJpZGUgdGhpcwogICAgZGVmYXVsdCBzZXQgdG8gcHJldmVudCB0aGUg
        RXZlbnREaXNwYXRjaGVyIGZyb20gbGlzdGVuaW5nIG9uIHNvbWUgZXZlbnRz
        IGFsbCB0b2dldGhlci4KCiAgICBUaGlzIHNldCB3aWxsIGJlIG1vZGlmaWVk
        IGJ5IGBzZXR1cGAgdG8gYWxzbyBpbmNsdWRlIGFueSBldmVudHMgYWRkZWQg
        YXQgdGhhdCB0aW1lLgoKICAgIEBwcm9wZXJ0eSBldmVudHMKICAgIEB0eXBl
        IE9iamVjdAogICovCiAgZXZlbnRzOiB7CiAgICB0b3VjaHN0YXJ0ICA6ICd0
        b3VjaFN0YXJ0JywKICAgIHRvdWNobW92ZSAgIDogJ3RvdWNoTW92ZScsCiAg
        ICB0b3VjaGVuZCAgICA6ICd0b3VjaEVuZCcsCiAgICB0b3VjaGNhbmNlbCA6
        ICd0b3VjaENhbmNlbCcsCiAgICBrZXlkb3duICAgICA6ICdrZXlEb3duJywK
        ICAgIGtleXVwICAgICAgIDogJ2tleVVwJywKICAgIGtleXByZXNzICAgIDog
        J2tleVByZXNzJywKICAgIG1vdXNlZG93biAgIDogJ21vdXNlRG93bicsCiAg
        ICBtb3VzZXVwICAgICA6ICdtb3VzZVVwJywKICAgIGNvbnRleHRtZW51IDog
        J2NvbnRleHRNZW51JywKICAgIGNsaWNrICAgICAgIDogJ2NsaWNrJywKICAg
        IGRibGNsaWNrICAgIDogJ2RvdWJsZUNsaWNrJywKICAgIG1vdXNlbW92ZSAg
        IDogJ21vdXNlTW92ZScsCiAgICBmb2N1c2luICAgICA6ICdmb2N1c0luJywK
        ICAgIGZvY3Vzb3V0ICAgIDogJ2ZvY3VzT3V0JywKICAgIG1vdXNlZW50ZXIg
        IDogJ21vdXNlRW50ZXInLAogICAgbW91c2VsZWF2ZSAgOiAnbW91c2VMZWF2
        ZScsCiAgICBzdWJtaXQgICAgICA6ICdzdWJtaXQnLAogICAgaW5wdXQgICAg
        ICAgOiAnaW5wdXQnLAogICAgY2hhbmdlICAgICAgOiAnY2hhbmdlJywKICAg
        IGRyYWdzdGFydCAgIDogJ2RyYWdTdGFydCcsCiAgICBkcmFnICAgICAgICA6
        ICdkcmFnJywKICAgIGRyYWdlbnRlciAgIDogJ2RyYWdFbnRlcicsCiAgICBk
        cmFnbGVhdmUgICA6ICdkcmFnTGVhdmUnLAogICAgZHJhZ292ZXIgICAgOiAn
        ZHJhZ092ZXInLAogICAgZHJvcCAgICAgICAgOiAnZHJvcCcsCiAgICBkcmFn
        ZW5kICAgICA6ICdkcmFnRW5kJwogIH0sCgogIC8qKgogICAgQHByaXZhdGUK
        CiAgICBUaGUgcm9vdCBET00gZWxlbWVudCB0byB3aGljaCBldmVudCBsaXN0
        ZW5lcnMgc2hvdWxkIGJlIGF0dGFjaGVkLiBFdmVudAogICAgbGlzdGVuZXJz
        IHdpbGwgYmUgYXR0YWNoZWQgdG8gdGhlIGRvY3VtZW50IHVubGVzcyB0aGlz
        IGlzIG92ZXJyaWRkZW4uCgogICAgQ2FuIGJlIHNwZWNpZmllZCBhcyBhIERP
        TUVsZW1lbnQgb3IgYSBzZWxlY3RvciBzdHJpbmcuCgogICAgVGhlIGRlZmF1
        bHQgYm9keSBpcyBhIHN0cmluZyBzaW5jZSB0aGlzIG1heSBiZSBldmFsdWF0
        ZWQgYmVmb3JlIGRvY3VtZW50LmJvZHkKICAgIGV4aXN0cyBpbiB0aGUgRE9N
        LgoKICAgIEBwcm9wZXJ0eSByb290RWxlbWVudAogICAgQHR5cGUgRE9NRWxl
        bWVudAogICAgQGRlZmF1bHQgJ2JvZHknCiAgKi8KICByb290RWxlbWVudDog
        J2JvZHknLAoKICAvKioKICAgIEBwcml2YXRlCgogICAgU2V0cyB1cCBldmVu
        dCBsaXN0ZW5lcnMgZm9yIHN0YW5kYXJkIGJyb3dzZXIgZXZlbnRzLgoKICAg
        IFRoaXMgd2lsbCBiZSBjYWxsZWQgYWZ0ZXIgdGhlIGJyb3dzZXIgc2VuZHMg
        YSBgRE9NQ29udGVudFJlYWR5YCBldmVudC4gQnkKICAgIGRlZmF1bHQsIGl0
        IHdpbGwgc2V0IHVwIGFsbCBvZiB0aGUgbGlzdGVuZXJzIG9uIHRoZSBkb2N1
        bWVudCBib2R5LiBJZiB5b3UKICAgIHdvdWxkIGxpa2UgdG8gcmVnaXN0ZXIg
        dGhlIGxpc3RlbmVycyBvbiBhIGRpZmZlcmVudCBlbGVtZW50LCBzZXQgdGhl
        IGV2ZW50CiAgICBkaXNwYXRjaGVyJ3MgYHJvb3RgIHByb3BlcnR5LgoKICAg
        IEBtZXRob2Qgc2V0dXAKICAgIEBwYXJhbSBhZGRlZEV2ZW50cyB7SGFzaH0K
        ICAqLwogIHNldHVwOiBmdW5jdGlvbihhZGRlZEV2ZW50cywgcm9vdEVsZW1l
        bnQpIHsKICAgIHZhciBldmVudCwgZXZlbnRzID0gZ2V0KHRoaXMsICdldmVu
        dHMnKTsKCiAgICBFbWJlci4kLmV4dGVuZChldmVudHMsIGFkZGVkRXZlbnRz
        IHx8IHt9KTsKCgogICAgaWYgKCFFbWJlci5pc05vbmUocm9vdEVsZW1lbnQp
        KSB7CiAgICAgIHNldCh0aGlzLCAncm9vdEVsZW1lbnQnLCByb290RWxlbWVu
        dCk7CiAgICB9CgogICAgcm9vdEVsZW1lbnQgPSBFbWJlci4kKGdldCh0aGlz
        LCAncm9vdEVsZW1lbnQnKSk7CgogICAgRW1iZXIuYXNzZXJ0KGZtdCgnWW91
        IGNhbm5vdCB1c2UgdGhlIHNhbWUgcm9vdCBlbGVtZW50ICglQCkgbXVsdGlw
        bGUgdGltZXMgaW4gYW4gRW1iZXIuQXBwbGljYXRpb24nLCBbcm9vdEVsZW1l
        bnQuc2VsZWN0b3IgfHwgcm9vdEVsZW1lbnRbMF0udGFnTmFtZV0pLCAhcm9v
        dEVsZW1lbnQuaXMoJy5lbWJlci1hcHBsaWNhdGlvbicpKTsKICAgIEVtYmVy
        LmFzc2VydCgnWW91IGNhbm5vdCBtYWtlIGEgbmV3IEVtYmVyLkFwcGxpY2F0
        aW9uIHVzaW5nIGEgcm9vdCBlbGVtZW50IHRoYXQgaXMgYSBkZXNjZW5kZW50
        IG9mIGFuIGV4aXN0aW5nIEVtYmVyLkFwcGxpY2F0aW9uJywgIXJvb3RFbGVt
        ZW50LmNsb3Nlc3QoJy5lbWJlci1hcHBsaWNhdGlvbicpLmxlbmd0aCk7CiAg
        ICBFbWJlci5hc3NlcnQoJ1lvdSBjYW5ub3QgbWFrZSBhIG5ldyBFbWJlci5B
        cHBsaWNhdGlvbiB1c2luZyBhIHJvb3QgZWxlbWVudCB0aGF0IGlzIGFuIGFu
        Y2VzdG9yIG9mIGFuIGV4aXN0aW5nIEVtYmVyLkFwcGxpY2F0aW9uJywgIXJv
        b3RFbGVtZW50LmZpbmQoJy5lbWJlci1hcHBsaWNhdGlvbicpLmxlbmd0aCk7
        CgogICAgcm9vdEVsZW1lbnQuYWRkQ2xhc3MoJ2VtYmVyLWFwcGxpY2F0aW9u
        Jyk7CgogICAgRW1iZXIuYXNzZXJ0KCdVbmFibGUgdG8gYWRkICJlbWJlci1h
        cHBsaWNhdGlvbiIgY2xhc3MgdG8gcm9vdEVsZW1lbnQuIE1ha2Ugc3VyZSB5
        b3Ugc2V0IHJvb3RFbGVtZW50IHRvIHRoZSBib2R5IG9yIGFuIGVsZW1lbnQg
        aW4gdGhlIGJvZHkuJywgcm9vdEVsZW1lbnQuaXMoJy5lbWJlci1hcHBsaWNh
        dGlvbicpKTsKCiAgICBmb3IgKGV2ZW50IGluIGV2ZW50cykgewogICAgICBp
        ZiAoZXZlbnRzLmhhc093blByb3BlcnR5KGV2ZW50KSkgewogICAgICAgIHRo
        aXMuc2V0dXBIYW5kbGVyKHJvb3RFbGVtZW50LCBldmVudCwgZXZlbnRzW2V2
        ZW50XSk7CiAgICAgIH0KICAgIH0KICB9LAoKICAvKioKICAgIEBwcml2YXRl
        CgogICAgUmVnaXN0ZXJzIGFuIGV2ZW50IGxpc3RlbmVyIG9uIHRoZSBkb2N1
        bWVudC4gSWYgdGhlIGdpdmVuIGV2ZW50IGlzCiAgICB0cmlnZ2VyZWQsIHRo
        ZSBwcm92aWRlZCBldmVudCBoYW5kbGVyIHdpbGwgYmUgdHJpZ2dlcmVkIG9u
        IHRoZSB0YXJnZXQgdmlldy4KCiAgICBJZiB0aGUgdGFyZ2V0IHZpZXcgZG9l
        cyBub3QgaW1wbGVtZW50IHRoZSBldmVudCBoYW5kbGVyLCBvciBpZiB0aGUg
        aGFuZGxlcgogICAgcmV0dXJucyBgZmFsc2VgLCB0aGUgcGFyZW50IHZpZXcg
        d2lsbCBiZSBjYWxsZWQuIFRoZSBldmVudCB3aWxsIGNvbnRpbnVlIHRvCiAg
        ICBidWJibGUgdG8gZWFjaCBzdWNjZXNzaXZlIHBhcmVudCB2aWV3IHVudGls
        IGl0IHJlYWNoZXMgdGhlIHRvcC4KCiAgICBGb3IgZXhhbXBsZSwgdG8gaGF2
        ZSB0aGUgYG1vdXNlRG93bmAgbWV0aG9kIGNhbGxlZCBvbiB0aGUgdGFyZ2V0
        IHZpZXcgd2hlbgogICAgYSBgbW91c2Vkb3duYCBldmVudCBpcyByZWNlaXZl
        ZCBmcm9tIHRoZSBicm93c2VyLCBkbyB0aGUgZm9sbG93aW5nOgoKICAgIGBg
        YGphdmFzY3JpcHQKICAgIHNldHVwSGFuZGxlcignbW91c2Vkb3duJywgJ21v
        dXNlRG93bicpOwogICAgYGBgCgogICAgQG1ldGhvZCBzZXR1cEhhbmRsZXIK
        ICAgIEBwYXJhbSB7RWxlbWVudH0gcm9vdEVsZW1lbnQKICAgIEBwYXJhbSB7
        U3RyaW5nfSBldmVudCB0aGUgYnJvd3Nlci1vcmlnaW5hdGVkIGV2ZW50IHRv
        IGxpc3RlbiB0bwogICAgQHBhcmFtIHtTdHJpbmd9IGV2ZW50TmFtZSB0aGUg
        bmFtZSBvZiB0aGUgbWV0aG9kIHRvIGNhbGwgb24gdGhlIHZpZXcKICAqLwog
        IHNldHVwSGFuZGxlcjogZnVuY3Rpb24ocm9vdEVsZW1lbnQsIGV2ZW50LCBl
        dmVudE5hbWUpIHsKICAgIHZhciBzZWxmID0gdGhpczsKCiAgICByb290RWxl
        bWVudC5vbihldmVudCArICcuZW1iZXInLCAnLmVtYmVyLXZpZXcnLCBmdW5j
        dGlvbihldnQsIHRyaWdnZXJpbmdNYW5hZ2VyKSB7CiAgICAgIHJldHVybiBF
        bWJlci5oYW5kbGVFcnJvcnMoZnVuY3Rpb24oKSB7CiAgICAgICAgdmFyIHZp
        ZXcgPSBFbWJlci5WaWV3LnZpZXdzW3RoaXMuaWRdLAogICAgICAgICAgICBy
        ZXN1bHQgPSB0cnVlLCBtYW5hZ2VyID0gbnVsbDsKCiAgICAgICAgbWFuYWdl
        ciA9IHNlbGYuX2ZpbmROZWFyZXN0RXZlbnRNYW5hZ2VyKHZpZXcsZXZlbnRO
        YW1lKTsKCiAgICAgICAgaWYgKG1hbmFnZXIgJiYgbWFuYWdlciAhPT0gdHJp
        Z2dlcmluZ01hbmFnZXIpIHsKICAgICAgICAgIHJlc3VsdCA9IHNlbGYuX2Rp
        c3BhdGNoRXZlbnQobWFuYWdlciwgZXZ0LCBldmVudE5hbWUsIHZpZXcpOwog
        ICAgICAgIH0gZWxzZSBpZiAodmlldykgewogICAgICAgICAgcmVzdWx0ID0g
        c2VsZi5fYnViYmxlRXZlbnQodmlldyxldnQsZXZlbnROYW1lKTsKICAgICAg
        ICB9IGVsc2UgewogICAgICAgICAgZXZ0LnN0b3BQcm9wYWdhdGlvbigpOwog
        ICAgICAgIH0KCiAgICAgICAgcmV0dXJuIHJlc3VsdDsKICAgICAgfSwgdGhp
        cyk7CiAgICB9KTsKCiAgICByb290RWxlbWVudC5vbihldmVudCArICcuZW1i
        ZXInLCAnW2RhdGEtZW1iZXItYWN0aW9uXScsIGZ1bmN0aW9uKGV2dCkgewog
        ICAgICByZXR1cm4gRW1iZXIuaGFuZGxlRXJyb3JzKGZ1bmN0aW9uKCkgewog
        ICAgICAgIHZhciBhY3Rpb25JZCA9IEVtYmVyLiQoZXZ0LmN1cnJlbnRUYXJn
        ZXQpLmF0dHIoJ2RhdGEtZW1iZXItYWN0aW9uJyksCiAgICAgICAgICAgIGFj
        dGlvbiAgID0gRW1iZXIuSGFuZGxlYmFycy5BY3Rpb25IZWxwZXIucmVnaXN0
        ZXJlZEFjdGlvbnNbYWN0aW9uSWRdOwoKICAgICAgICAvLyBXZSBoYXZlIHRv
        IGNoZWNrIGZvciBhY3Rpb24gaGVyZSBzaW5jZSBpbiBzb21lIGNhc2VzLCBq
        UXVlcnkgd2lsbCB0cmlnZ2VyCiAgICAgICAgLy8gYW4gZXZlbnQgb24gYHJl
        bW92ZUNoaWxkYCAoaS5lLiBmb2N1c291dCkgYWZ0ZXIgd2UndmUgYWxyZWFk
        eSB0b3JuIGRvd24gdGhlCiAgICAgICAgLy8gYWN0aW9uIGhhbmRsZXJzIGZv
        ciB0aGUgdmlldy4KICAgICAgICBpZiAoYWN0aW9uICYmIGFjdGlvbi5ldmVu
        dE5hbWUgPT09IGV2ZW50TmFtZSkgewogICAgICAgICAgcmV0dXJuIGFjdGlv
        bi5oYW5kbGVyKGV2dCk7CiAgICAgICAgfQogICAgICB9LCB0aGlzKTsKICAg
        IH0pOwogIH0sCgogIF9maW5kTmVhcmVzdEV2ZW50TWFuYWdlcjogZnVuY3Rp
        b24odmlldywgZXZlbnROYW1lKSB7CiAgICB2YXIgbWFuYWdlciA9IG51bGw7
        CgogICAgd2hpbGUgKHZpZXcpIHsKICAgICAgbWFuYWdlciA9IGdldCh2aWV3
        LCAnZXZlbnRNYW5hZ2VyJyk7CiAgICAgIGlmIChtYW5hZ2VyICYmIG1hbmFn
        ZXJbZXZlbnROYW1lXSkgeyBicmVhazsgfQoKICAgICAgdmlldyA9IGdldCh2
        aWV3LCAncGFyZW50VmlldycpOwogICAgfQoKICAgIHJldHVybiBtYW5hZ2Vy
        OwogIH0sCgogIF9kaXNwYXRjaEV2ZW50OiBmdW5jdGlvbihvYmplY3QsIGV2
        dCwgZXZlbnROYW1lLCB2aWV3KSB7CiAgICB2YXIgcmVzdWx0ID0gdHJ1ZTsK
        CiAgICB2YXIgaGFuZGxlciA9IG9iamVjdFtldmVudE5hbWVdOwogICAgaWYg
        KEVtYmVyLnR5cGVPZihoYW5kbGVyKSA9PT0gJ2Z1bmN0aW9uJykgewogICAg
        ICByZXN1bHQgPSBFbWJlci5ydW4oZnVuY3Rpb24oKSB7CiAgICAgICAgcmV0
        dXJuIGhhbmRsZXIuY2FsbChvYmplY3QsIGV2dCwgdmlldyk7CiAgICAgIH0p
        OwogICAgICAvLyBEbyBub3QgcHJldmVudERlZmF1bHQgaW4gZXZlbnRNYW5h
        Z2Vycy4KICAgICAgZXZ0LnN0b3BQcm9wYWdhdGlvbigpOwogICAgfQogICAg
        ZWxzZSB7CiAgICAgIHJlc3VsdCA9IHRoaXMuX2J1YmJsZUV2ZW50KHZpZXcs
        IGV2dCwgZXZlbnROYW1lKTsKICAgIH0KCiAgICByZXR1cm4gcmVzdWx0Owog
        IH0sCgogIF9idWJibGVFdmVudDogZnVuY3Rpb24odmlldywgZXZ0LCBldmVu
        dE5hbWUpIHsKICAgIHJldHVybiBFbWJlci5ydW4oZnVuY3Rpb24oKSB7CiAg
        ICAgIHJldHVybiB2aWV3LmhhbmRsZUV2ZW50KGV2ZW50TmFtZSwgZXZ0KTsK
        ICAgIH0pOwogIH0sCgogIGRlc3Ryb3k6IGZ1bmN0aW9uKCkgewogICAgdmFy
        IHJvb3RFbGVtZW50ID0gZ2V0KHRoaXMsICdyb290RWxlbWVudCcpOwogICAg
        RW1iZXIuJChyb290RWxlbWVudCkub2ZmKCcuZW1iZXInLCAnKionKS5yZW1v
        dmVDbGFzcygnZW1iZXItYXBwbGljYXRpb24nKTsKICAgIHJldHVybiB0aGlz
        Ll9zdXBlcigpOwogIH0KfSk7Cgp9KSgpOwoKCgooZnVuY3Rpb24oKSB7Ci8q
        KgpAbW9kdWxlIGVtYmVyCkBzdWJtb2R1bGUgZW1iZXItdmlld3MKKi8KCi8v
        IEFkZCBhIG5ldyBuYW1lZCBxdWV1ZSBmb3IgcmVuZGVyaW5nIHZpZXdzIHRo
        YXQgaGFwcGVucwovLyBhZnRlciBiaW5kaW5ncyBoYXZlIHN5bmNlZCwgYW5k
        IGEgcXVldWUgZm9yIHNjaGVkdWxpbmcgYWN0aW9ucwovLyB0aGF0IHRoYXQg
        c2hvdWxkIG9jY3VyIGFmdGVyIHZpZXcgcmVuZGVyaW5nLgp2YXIgcXVldWVz
        ID0gRW1iZXIucnVuLnF1ZXVlcywKICAgIGluZGV4T2YgPSBFbWJlci5BcnJh
        eVBvbHlmaWxscy5pbmRleE9mOwpxdWV1ZXMuc3BsaWNlKGluZGV4T2YuY2Fs
        bChxdWV1ZXMsICdhY3Rpb25zJykrMSwgMCwgJ3JlbmRlcicsICdhZnRlclJl
        bmRlcicpOwoKfSkoKTsKCgoKKGZ1bmN0aW9uKCkgewovKioKQG1vZHVsZSBl
        bWJlcgpAc3VibW9kdWxlIGVtYmVyLXZpZXdzCiovCgp2YXIgZ2V0ID0gRW1i
        ZXIuZ2V0LCBzZXQgPSBFbWJlci5zZXQ7CgovLyBPcmlnaW5hbCBjbGFzcyBk
        ZWNsYXJhdGlvbiBhbmQgZG9jdW1lbnRhdGlvbiBpbiBydW50aW1lL2xpYi9j
        b250cm9sbGVycy9jb250cm9sbGVyLmpzCi8vIE5PVEU6IEl0IG1heSBiZSBw
        b3NzaWJsZSB3aXRoIFlVSURvYyB0byBjb21iaW5lIGRvY3MgaW4gdHdvIGxv
        Y2F0aW9ucwoKLyoqCkFkZGl0aW9uYWwgbWV0aG9kcyBmb3IgdGhlIENvbnRy
        b2xsZXJNaXhpbgoKQGNsYXNzIENvbnRyb2xsZXJNaXhpbgpAbmFtZXNwYWNl
        IEVtYmVyCiovCkVtYmVyLkNvbnRyb2xsZXJNaXhpbi5yZW9wZW4oewogIHRh
        cmdldDogbnVsbCwKICBuYW1lc3BhY2U6IG51bGwsCiAgdmlldzogbnVsbCwK
        ICBjb250YWluZXI6IG51bGwsCiAgX2NoaWxkQ29udGFpbmVyczogbnVsbCwK
        CiAgaW5pdDogZnVuY3Rpb24oKSB7CiAgICB0aGlzLl9zdXBlcigpOwogICAg
        c2V0KHRoaXMsICdfY2hpbGRDb250YWluZXJzJywge30pOwogIH0sCgogIF9t
        b2RlbERpZENoYW5nZTogRW1iZXIub2JzZXJ2ZXIoZnVuY3Rpb24oKSB7CiAg
        ICB2YXIgY29udGFpbmVycyA9IGdldCh0aGlzLCAnX2NoaWxkQ29udGFpbmVy
        cycpOwoKICAgIGZvciAodmFyIHByb3AgaW4gY29udGFpbmVycykgewogICAg
        ICBpZiAoIWNvbnRhaW5lcnMuaGFzT3duUHJvcGVydHkocHJvcCkpIHsgY29u
        dGludWU7IH0KICAgICAgY29udGFpbmVyc1twcm9wXS5kZXN0cm95KCk7CiAg
        ICB9CgogICAgc2V0KHRoaXMsICdfY2hpbGRDb250YWluZXJzJywge30pOwog
        IH0sICdtb2RlbCcpCn0pOwoKfSkoKTsKCgoKKGZ1bmN0aW9uKCkgewoKfSko
        KTsKCgoKKGZ1bmN0aW9uKCkgewp2YXIgc3RhdGVzID0ge307CgovKioKQG1v
        ZHVsZSBlbWJlcgpAc3VibW9kdWxlIGVtYmVyLXZpZXdzCiovCgp2YXIgZ2V0
        ID0gRW1iZXIuZ2V0LCBzZXQgPSBFbWJlci5zZXQ7CnZhciBndWlkRm9yID0g
        RW1iZXIuZ3VpZEZvcjsKdmFyIGFfZm9yRWFjaCA9IEVtYmVyLkVudW1lcmFi
        bGVVdGlscy5mb3JFYWNoOwp2YXIgYV9hZGRPYmplY3QgPSBFbWJlci5FbnVt
        ZXJhYmxlVXRpbHMuYWRkT2JqZWN0Owp2YXIgbWV0YSA9IEVtYmVyLm1ldGE7
        Cgp2YXIgY2hpbGRWaWV3c1Byb3BlcnR5ID0gRW1iZXIuY29tcHV0ZWQoZnVu
        Y3Rpb24oKSB7CiAgdmFyIGNoaWxkVmlld3MgPSB0aGlzLl9jaGlsZFZpZXdz
        LCByZXQgPSBFbWJlci5BKCksIHZpZXcgPSB0aGlzOwoKICBhX2ZvckVhY2go
        Y2hpbGRWaWV3cywgZnVuY3Rpb24odmlldykgewogICAgdmFyIGN1cnJlbnRD
        aGlsZFZpZXdzOwogICAgaWYgKHZpZXcuaXNWaXJ0dWFsKSB7CiAgICAgIGlm
        IChjdXJyZW50Q2hpbGRWaWV3cyA9IGdldCh2aWV3LCAnY2hpbGRWaWV3cycp
        KSB7CiAgICAgICAgcmV0LnB1c2hPYmplY3RzKGN1cnJlbnRDaGlsZFZpZXdz
        KTsKICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgcmV0LnB1c2godmlldyk7
        CiAgICB9CiAgfSk7CgogIHJldC5yZXBsYWNlID0gZnVuY3Rpb24gKGlkeCwg
        cmVtb3ZlZENvdW50LCBhZGRlZFZpZXdzKSB7CiAgICBpZiAodmlldyBpbnN0
        YW5jZW9mIEVtYmVyLkNvbnRhaW5lclZpZXcpIHsKICAgICAgRW1iZXIuZGVw
        cmVjYXRlKCJNYW5pcHVsYXRpbmcgYW4gRW1iZXIuQ29udGFpbmVyVmlldyB0
        aHJvdWdoIGl0cyBjaGlsZFZpZXdzIHByb3BlcnR5IGlzIGRlcHJlY2F0ZWQu
        IFBsZWFzZSB1c2UgdGhlIENvbnRhaW5lclZpZXcgaW5zdGFuY2UgaXRzZWxm
        IGFzIGFuIEVtYmVyLk11dGFibGVBcnJheS4iKTsKICAgICAgcmV0dXJuIHZp
        ZXcucmVwbGFjZShpZHgsIHJlbW92ZWRDb3VudCwgYWRkZWRWaWV3cyk7CiAg
        ICB9CiAgICB0aHJvdyBuZXcgRW1iZXIuRXJyb3IoImNoaWxkVmlld3MgaXMg
        aW1tdXRhYmxlIik7CiAgfTsKCiAgcmV0dXJuIHJldDsKfSk7CgpFbWJlci53
        YXJuKCJUaGUgVklFV19QUkVTRVJWRVNfQ09OVEVYVCBmbGFnIGhhcyBiZWVu
        IHJlbW92ZWQgYW5kIHRoZSBmdW5jdGlvbmFsaXR5IGNhbiBubyBsb25nZXIg
        YmUgZGlzYWJsZWQuIiwgRW1iZXIuRU5WLlZJRVdfUFJFU0VSVkVTX0NPTlRF
        WFQgIT09IGZhbHNlKTsKCi8qKgogIEdsb2JhbCBoYXNoIG9mIHNoYXJlZCB0
        ZW1wbGF0ZXMuIFRoaXMgd2lsbCBhdXRvbWF0aWNhbGx5IGJlIHBvcHVsYXRl
        ZAogIGJ5IHRoZSBidWlsZCB0b29scyBzbyB0aGF0IHlvdSBjYW4gc3RvcmUg
        eW91ciBIYW5kbGViYXJzIHRlbXBsYXRlcyBpbgogIHNlcGFyYXRlIGZpbGVz
        IHRoYXQgZ2V0IGxvYWRlZCBpbnRvIEphdmFTY3JpcHQgYXQgYnVpbGR0aW1l
        LgoKICBAcHJvcGVydHkgVEVNUExBVEVTCiAgQGZvciBFbWJlcgogIEB0eXBl
        IEhhc2gKKi8KRW1iZXIuVEVNUExBVEVTID0ge307CgovKioKICBgRW1iZXIu
        Q29yZVZpZXdgIGlzIGFuIGFic3RyYWN0IGNsYXNzIHRoYXQgZXhpc3RzIHRv
        IGdpdmUgdmlldy1saWtlIGJlaGF2aW9yCiAgdG8gYm90aCBFbWJlcidzIG1h
        aW4gdmlldyBjbGFzcyBgRW1iZXIuVmlld2AgYW5kIG90aGVyIGNsYXNzZXMg
        bGlrZQogIGBFbWJlci5fU2ltcGxlTWV0YW1vcnBoVmlld2AgdGhhdCBkb24n
        dCBuZWVkIHRoZSBmdWxseSBmdW5jdGlvbmFsdGl5IG9mCiAgYEVtYmVyLlZp
        ZXdgLgoKICBVbmxlc3MgeW91IGhhdmUgc3BlY2lmaWMgbmVlZHMgZm9yIGBD
        b3JlVmlld2AsIHlvdSB3aWxsIHVzZSBgRW1iZXIuVmlld2AKICBpbiB5b3Vy
        IGFwcGxpY2F0aW9ucy4KCiAgQGNsYXNzIENvcmVWaWV3CiAgQG5hbWVzcGFj
        ZSBFbWJlcgogIEBleHRlbmRzIEVtYmVyLk9iamVjdAogIEB1c2VzIEVtYmVy
        LkV2ZW50ZWQKKi8KCkVtYmVyLkNvcmVWaWV3ID0gRW1iZXIuT2JqZWN0LmV4
        dGVuZChFbWJlci5FdmVudGVkLCBFbWJlci5BY3Rpb25IYW5kbGVyLCB7CiAg
        aXNWaWV3OiB0cnVlLAoKICBzdGF0ZXM6IHN0YXRlcywKCiAgaW5pdDogZnVu
        Y3Rpb24oKSB7CiAgICB0aGlzLl9zdXBlcigpOwogICAgdGhpcy50cmFuc2l0
        aW9uVG8oJ3ByZVJlbmRlcicpOwogIH0sCgogIC8qKgogICAgSWYgdGhlIHZp
        ZXcgaXMgY3VycmVudGx5IGluc2VydGVkIGludG8gdGhlIERPTSBvZiBhIHBh
        cmVudCB2aWV3LCB0aGlzCiAgICBwcm9wZXJ0eSB3aWxsIHBvaW50IHRvIHRo
        ZSBwYXJlbnQgb2YgdGhlIHZpZXcuCgogICAgQHByb3BlcnR5IHBhcmVudFZp
        ZXcKICAgIEB0eXBlIEVtYmVyLlZpZXcKICAgIEBkZWZhdWx0IG51bGwKICAq
        LwogIHBhcmVudFZpZXc6IEVtYmVyLmNvbXB1dGVkKGZ1bmN0aW9uKCkgewog
        ICAgdmFyIHBhcmVudCA9IHRoaXMuX3BhcmVudFZpZXc7CgogICAgaWYgKHBh
        cmVudCAmJiBwYXJlbnQuaXNWaXJ0dWFsKSB7CiAgICAgIHJldHVybiBnZXQo
        cGFyZW50LCAncGFyZW50VmlldycpOwogICAgfSBlbHNlIHsKICAgICAgcmV0
        dXJuIHBhcmVudDsKICAgIH0KICB9KS5wcm9wZXJ0eSgnX3BhcmVudFZpZXcn
        KSwKCiAgc3RhdGU6IG51bGwsCgogIF9wYXJlbnRWaWV3OiBudWxsLAoKICAv
        LyByZXR1cm4gdGhlIGN1cnJlbnQgdmlldywgbm90IGluY2x1ZGluZyB2aXJ0
        dWFsIHZpZXdzCiAgY29uY3JldGVWaWV3OiBFbWJlci5jb21wdXRlZChmdW5j
        dGlvbigpIHsKICAgIGlmICghdGhpcy5pc1ZpcnR1YWwpIHsgcmV0dXJuIHRo
        aXM7IH0KICAgIGVsc2UgeyByZXR1cm4gZ2V0KHRoaXMsICdwYXJlbnRWaWV3
        Jyk7IH0KICB9KS5wcm9wZXJ0eSgncGFyZW50VmlldycpLAoKICBpbnN0cnVt
        ZW50TmFtZTogJ2NvcmVfdmlldycsCgogIGluc3RydW1lbnREZXRhaWxzOiBm
        dW5jdGlvbihoYXNoKSB7CiAgICBoYXNoLm9iamVjdCA9IHRoaXMudG9TdHJp
        bmcoKTsKICB9LAoKICAvKioKICAgIEBwcml2YXRlCgogICAgSW52b2tlZCBi
        eSB0aGUgdmlldyBzeXN0ZW0gd2hlbiB0aGlzIHZpZXcgbmVlZHMgdG8gcHJv
        ZHVjZSBhbiBIVE1MCiAgICByZXByZXNlbnRhdGlvbi4gVGhpcyBtZXRob2Qg
        d2lsbCBjcmVhdGUgYSBuZXcgcmVuZGVyIGJ1ZmZlciwgaWYgbmVlZGVkLAog
        ICAgdGhlbiBhcHBseSBhbnkgZGVmYXVsdCBhdHRyaWJ1dGVzLCBzdWNoIGFz
        IGNsYXNzIG5hbWVzIGFuZCB2aXNpYmlsaXR5LgogICAgRmluYWxseSwgdGhl
        IGByZW5kZXIoKWAgbWV0aG9kIGlzIGludm9rZWQsIHdoaWNoIGlzIHJlc3Bv
        bnNpYmxlIGZvcgogICAgZG9pbmcgdGhlIGJ1bGsgb2YgdGhlIHJlbmRlcmlu
        Zy4KCiAgICBZb3Ugc2hvdWxkIG5vdCBuZWVkIHRvIG92ZXJyaWRlIHRoaXMg
        bWV0aG9kOyBpbnN0ZWFkLCBpbXBsZW1lbnQgdGhlCiAgICBgdGVtcGxhdGVg
        IHByb3BlcnR5LCBvciBpZiB5b3UgbmVlZCBtb3JlIGNvbnRyb2wsIG92ZXJy
        aWRlIHRoZSBgcmVuZGVyYAogICAgbWV0aG9kLgoKICAgIEBtZXRob2QgcmVu
        ZGVyVG9CdWZmZXIKICAgIEBwYXJhbSB7RW1iZXIuUmVuZGVyQnVmZmVyfSBi
        dWZmZXIgdGhlIHJlbmRlciBidWZmZXIuIElmIG5vIGJ1ZmZlciBpcwogICAg
        ICBwYXNzZWQsIGEgZGVmYXVsdCBidWZmZXIsIHVzaW5nIHRoZSBjdXJyZW50
        IHZpZXcncyBgdGFnTmFtZWAsIHdpbGwKICAgICAgYmUgdXNlZC4KICAqLwog
        IHJlbmRlclRvQnVmZmVyOiBmdW5jdGlvbihwYXJlbnRCdWZmZXIsIGJ1ZmZl
        ck9wZXJhdGlvbikgewogICAgdmFyIG5hbWUgPSAncmVuZGVyLicgKyB0aGlz
        Lmluc3RydW1lbnROYW1lLAogICAgICAgIGRldGFpbHMgPSB7fTsKCiAgICB0
        aGlzLmluc3RydW1lbnREZXRhaWxzKGRldGFpbHMpOwoKICAgIHJldHVybiBF
        bWJlci5pbnN0cnVtZW50KG5hbWUsIGRldGFpbHMsIGZ1bmN0aW9uKCkgewog
        ICAgICByZXR1cm4gdGhpcy5fcmVuZGVyVG9CdWZmZXIocGFyZW50QnVmZmVy
        LCBidWZmZXJPcGVyYXRpb24pOwogICAgfSwgdGhpcyk7CiAgfSwKCiAgX3Jl
        bmRlclRvQnVmZmVyOiBmdW5jdGlvbihwYXJlbnRCdWZmZXIsIGJ1ZmZlck9w
        ZXJhdGlvbikgewogICAgLy8gSWYgdGhpcyBpcyB0aGUgdG9wLW1vc3Qgdmll
        dywgc3RhcnQgYSBuZXcgYnVmZmVyLiBPdGhlcndpc2UsCiAgICAvLyBjcmVh
        dGUgYSBuZXcgYnVmZmVyIHJlbGF0aXZlIHRvIHRoZSBvcmlnaW5hbCB1c2lu
        ZyB0aGUKICAgIC8vIHByb3ZpZGVkIGJ1ZmZlciBvcGVyYXRpb24gKGZvciBl
        eGFtcGxlLCBgaW5zZXJ0QWZ0ZXJgIHdpbGwKICAgIC8vIGluc2VydCBhIG5l
        dyBidWZmZXIgYWZ0ZXIgdGhlICJwYXJlbnQgYnVmZmVyIikuCiAgICB2YXIg
        dGFnTmFtZSA9IHRoaXMudGFnTmFtZTsKCiAgICBpZiAodGFnTmFtZSA9PT0g
        bnVsbCB8fCB0YWdOYW1lID09PSB1bmRlZmluZWQpIHsKICAgICAgdGFnTmFt
        ZSA9ICdkaXYnOwogICAgfQoKICAgIHZhciBidWZmZXIgPSB0aGlzLmJ1ZmZl
        ciA9IHBhcmVudEJ1ZmZlciAmJiBwYXJlbnRCdWZmZXIuYmVnaW4odGFnTmFt
        ZSkgfHwgRW1iZXIuUmVuZGVyQnVmZmVyKHRhZ05hbWUpOwogICAgdGhpcy50
        cmFuc2l0aW9uVG8oJ2luQnVmZmVyJywgZmFsc2UpOwoKICAgIHRoaXMuYmVm
        b3JlUmVuZGVyKGJ1ZmZlcik7CiAgICB0aGlzLnJlbmRlcihidWZmZXIpOwog
        ICAgdGhpcy5hZnRlclJlbmRlcihidWZmZXIpOwoKICAgIHJldHVybiBidWZm
        ZXI7CiAgfSwKCiAgLyoqCiAgICBAcHJpdmF0ZQoKICAgIE92ZXJyaWRlIHRo
        ZSBkZWZhdWx0IGV2ZW50IGZpcmluZyBmcm9tIGBFbWJlci5FdmVudGVkYCB0
        bwogICAgYWxzbyBjYWxsIG1ldGhvZHMgd2l0aCB0aGUgZ2l2ZW4gbmFtZS4K
        CiAgICBAbWV0aG9kIHRyaWdnZXIKICAgIEBwYXJhbSBuYW1lIHtTdHJpbmd9
        CiAgKi8KICB0cmlnZ2VyOiBmdW5jdGlvbihuYW1lKSB7CiAgICB0aGlzLl9z
        dXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgdmFyIG1ldGhvZCA9
        IHRoaXNbbmFtZV07CiAgICBpZiAobWV0aG9kKSB7CiAgICAgIHZhciBhcmdz
        ID0gW10sIGksIGw7CiAgICAgIGZvciAoaSA9IDEsIGwgPSBhcmd1bWVudHMu
        bGVuZ3RoOyBpIDwgbDsgaSsrKSB7CiAgICAgICAgYXJncy5wdXNoKGFyZ3Vt
        ZW50c1tpXSk7CiAgICAgIH0KICAgICAgcmV0dXJuIG1ldGhvZC5hcHBseSh0
        aGlzLCBhcmdzKTsKICAgIH0KICB9LAoKICBkZXByZWNhdGVkU2VuZEhhbmRs
        ZXM6IGZ1bmN0aW9uKGFjdGlvbk5hbWUpIHsKICAgIHJldHVybiAhIXRoaXNb
        YWN0aW9uTmFtZV07CiAgfSwKCiAgZGVwcmVjYXRlZFNlbmQ6IGZ1bmN0aW9u
        KGFjdGlvbk5hbWUpIHsKICAgIHZhciBhcmdzID0gW10uc2xpY2UuY2FsbChh
        cmd1bWVudHMsIDEpOwogICAgRW1iZXIuYXNzZXJ0KCcnICsgdGhpcyArICIg
        aGFzIHRoZSBhY3Rpb24gIiArIGFjdGlvbk5hbWUgKyAiIGJ1dCBpdCBpcyBu
        b3QgYSBmdW5jdGlvbiIsIHR5cGVvZiB0aGlzW2FjdGlvbk5hbWVdID09PSAn
        ZnVuY3Rpb24nKTsKICAgIEVtYmVyLmRlcHJlY2F0ZSgnQWN0aW9uIGhhbmRs
        ZXJzIGltcGxlbWVudGVkIGRpcmVjdGx5IG9uIHZpZXdzIGFyZSBkZXByZWNh
        dGVkIGluIGZhdm9yIG9mIGFjdGlvbiBoYW5kbGVycyBvbiBhbiBgYWN0aW9u
        c2Agb2JqZWN0ICgnICsgYWN0aW9uTmFtZSArICcgb24gJyArIHRoaXMgKyAn
        KScsIGZhbHNlKTsKICAgIHRoaXNbYWN0aW9uTmFtZV0uYXBwbHkodGhpcywg
        YXJncyk7CiAgICByZXR1cm47CiAgfSwKCiAgaGFzOiBmdW5jdGlvbihuYW1l
        KSB7CiAgICByZXR1cm4gRW1iZXIudHlwZU9mKHRoaXNbbmFtZV0pID09PSAn
        ZnVuY3Rpb24nIHx8IHRoaXMuX3N1cGVyKG5hbWUpOwogIH0sCgogIGRlc3Ry
        b3k6IGZ1bmN0aW9uKCkgewogICAgdmFyIHBhcmVudCA9IHRoaXMuX3BhcmVu
        dFZpZXc7CgogICAgaWYgKCF0aGlzLl9zdXBlcigpKSB7IHJldHVybjsgfQoK
        ICAgIC8vIGRlc3Ryb3kgdGhlIGVsZW1lbnQgLS0gdGhpcyB3aWxsIGF2b2lk
        IGVhY2ggY2hpbGQgdmlldyBkZXN0cm95aW5nCiAgICAvLyB0aGUgZWxlbWVu
        dCBvdmVyIGFuZCBvdmVyIGFnYWluLi4uCiAgICBpZiAoIXRoaXMucmVtb3Zl
        ZEZyb21ET00pIHsgdGhpcy5kZXN0cm95RWxlbWVudCgpOyB9CgogICAgLy8g
        cmVtb3ZlIGZyb20gcGFyZW50IGlmIGZvdW5kLiBEb24ndCBjYWxsIHJlbW92
        ZUZyb21QYXJlbnQsCiAgICAvLyBhcyByZW1vdmVGcm9tUGFyZW50IHdpbGwg
        dHJ5IHRvIHJlbW92ZSB0aGUgZWxlbWVudCBmcm9tCiAgICAvLyB0aGUgRE9N
        IGFnYWluLgogICAgaWYgKHBhcmVudCkgeyBwYXJlbnQucmVtb3ZlQ2hpbGQo
        dGhpcyk7IH0KCiAgICB0aGlzLnRyYW5zaXRpb25UbygnZGVzdHJveWluZycs
        IGZhbHNlKTsKCiAgICByZXR1cm4gdGhpczsKICB9LAoKICBjbGVhclJlbmRl
        cmVkQ2hpbGRyZW46IEVtYmVyLkssCiAgdHJpZ2dlclJlY3Vyc2l2ZWx5OiBF
        bWJlci5LLAogIGludm9rZVJlY3Vyc2l2ZWx5OiBFbWJlci5LLAogIHRyYW5z
        aXRpb25UbzogRW1iZXIuSywKICBkZXN0cm95RWxlbWVudDogRW1iZXIuSwp9
        KTsKCnZhciBWaWV3Q29sbGVjdGlvbiA9IEVtYmVyLl9WaWV3Q29sbGVjdGlv
        biA9IGZ1bmN0aW9uKGluaXRpYWxWaWV3cykgewogIHZhciB2aWV3cyA9IHRo
        aXMudmlld3MgPSBpbml0aWFsVmlld3MgfHwgW107CiAgdGhpcy5sZW5ndGgg
        PSB2aWV3cy5sZW5ndGg7Cn07CgpWaWV3Q29sbGVjdGlvbi5wcm90b3R5cGUg
        PSB7CiAgbGVuZ3RoOiAwLAoKICB0cmlnZ2VyOiBmdW5jdGlvbihldmVudE5h
        bWUpIHsKICAgIHZhciB2aWV3cyA9IHRoaXMudmlld3MsIHZpZXc7CiAgICBm
        b3IgKHZhciBpID0gMCwgbCA9IHZpZXdzLmxlbmd0aDsgaSA8IGw7IGkrKykg
        ewogICAgICB2aWV3ID0gdmlld3NbaV07CiAgICAgIGlmICh2aWV3LnRyaWdn
        ZXIpIHsgdmlldy50cmlnZ2VyKGV2ZW50TmFtZSk7IH0KICAgIH0KICB9LAoK
        ICB0cmlnZ2VyUmVjdXJzaXZlbHk6IGZ1bmN0aW9uKGV2ZW50TmFtZSkgewog
        ICAgdmFyIHZpZXdzID0gdGhpcy52aWV3czsKICAgIGZvciAodmFyIGkgPSAw
        LCBsID0gdmlld3MubGVuZ3RoOyBpIDwgbDsgaSsrKSB7CiAgICAgIHZpZXdz
        W2ldLnRyaWdnZXJSZWN1cnNpdmVseShldmVudE5hbWUpOwogICAgfQogIH0s
        CgogIGludm9rZVJlY3Vyc2l2ZWx5OiBmdW5jdGlvbihmbikgewogICAgdmFy
        IHZpZXdzID0gdGhpcy52aWV3cywgdmlldzsKCiAgICBmb3IgKHZhciBpID0g
        MCwgbCA9IHZpZXdzLmxlbmd0aDsgaSA8IGw7IGkrKykgewogICAgICB2aWV3
        ID0gdmlld3NbaV07CiAgICAgIGZuKHZpZXcpOwogICAgfQogIH0sCgogIHRy
        YW5zaXRpb25UbzogZnVuY3Rpb24oc3RhdGUsIGNoaWxkcmVuKSB7CiAgICB2
        YXIgdmlld3MgPSB0aGlzLnZpZXdzOwogICAgZm9yICh2YXIgaSA9IDAsIGwg
        PSB2aWV3cy5sZW5ndGg7IGkgPCBsOyBpKyspIHsKICAgICAgdmlld3NbaV0u
        dHJhbnNpdGlvblRvKHN0YXRlLCBjaGlsZHJlbik7CiAgICB9CiAgfSwKCiAg
        cHVzaDogZnVuY3Rpb24oKSB7CiAgICB0aGlzLmxlbmd0aCArPSBhcmd1bWVu
        dHMubGVuZ3RoOwogICAgdmFyIHZpZXdzID0gdGhpcy52aWV3czsKICAgIHJl
        dHVybiB2aWV3cy5wdXNoLmFwcGx5KHZpZXdzLCBhcmd1bWVudHMpOwogIH0s
        CgogIG9iamVjdEF0OiBmdW5jdGlvbihpZHgpIHsKICAgIHJldHVybiB0aGlz
        LnZpZXdzW2lkeF07CiAgfSwKCiAgZm9yRWFjaDogZnVuY3Rpb24oY2FsbGJh
        Y2spIHsKICAgIHZhciB2aWV3cyA9IHRoaXMudmlld3M7CiAgICByZXR1cm4g
        YV9mb3JFYWNoKHZpZXdzLCBjYWxsYmFjayk7CiAgfSwKCiAgY2xlYXI6IGZ1
        bmN0aW9uKCkgewogICAgdGhpcy5sZW5ndGggPSAwOwogICAgdGhpcy52aWV3
        cy5sZW5ndGggPSAwOwogIH0KfTsKCnZhciBFTVBUWV9BUlJBWSA9IFtdOwoK
        LyoqCiAgYEVtYmVyLlZpZXdgIGlzIHRoZSBjbGFzcyBpbiBFbWJlciByZXNw
        b25zaWJsZSBmb3IgZW5jYXBzdWxhdGluZyB0ZW1wbGF0ZXMgb2YKICBIVE1M
        IGNvbnRlbnQsIGNvbWJpbmluZyB0ZW1wbGF0ZXMgd2l0aCBkYXRhIHRvIHJl
        bmRlciBhcyBzZWN0aW9ucyBvZiBhIHBhZ2UncwogIERPTSwgYW5kIHJlZ2lz
        dGVyaW5nIGFuZCByZXNwb25kaW5nIHRvIHVzZXItaW5pdGlhdGVkIGV2ZW50
        cy4KCiAgIyMgSFRNTCBUYWcKCiAgVGhlIGRlZmF1bHQgSFRNTCB0YWcgbmFt
        ZSB1c2VkIGZvciBhIHZpZXcncyBET00gcmVwcmVzZW50YXRpb24gaXMgYGRp
        dmAuIFRoaXMKICBjYW4gYmUgY3VzdG9taXplZCBieSBzZXR0aW5nIHRoZSBg
        dGFnTmFtZWAgcHJvcGVydHkuIFRoZSBmb2xsb3dpbmcgdmlldwogIGNsYXNz
        OgoKICBgYGBqYXZhc2NyaXB0CiAgUGFyYWdyYXBoVmlldyA9IEVtYmVyLlZp
        ZXcuZXh0ZW5kKHsKICAgIHRhZ05hbWU6ICdlbScKICB9KTsKICBgYGAKCiAg
        V291bGQgcmVzdWx0IGluIGluc3RhbmNlcyB3aXRoIHRoZSBmb2xsb3dpbmcg
        SFRNTDoKCiAgYGBgaHRtbAogIDxlbSBpZD0iZW1iZXIxIiBjbGFzcz0iZW1i
        ZXItdmlldyI+PC9lbT4KICBgYGAKCiAgIyMgSFRNTCBgY2xhc3NgIEF0dHJp
        YnV0ZQoKICBUaGUgSFRNTCBgY2xhc3NgIGF0dHJpYnV0ZSBvZiBhIHZpZXcn
        cyB0YWcgY2FuIGJlIHNldCBieSBwcm92aWRpbmcgYQogIGBjbGFzc05hbWVz
        YCBwcm9wZXJ0eSB0aGF0IGlzIHNldCB0byBhbiBhcnJheSBvZiBzdHJpbmdz
        OgoKICBgYGBqYXZhc2NyaXB0CiAgTXlWaWV3ID0gRW1iZXIuVmlldy5leHRl
        bmQoewogICAgY2xhc3NOYW1lczogWydteS1jbGFzcycsICdteS1vdGhlci1j
        bGFzcyddCiAgfSk7CiAgYGBgCgogIFdpbGwgcmVzdWx0IGluIHZpZXcgaW5z
        dGFuY2VzIHdpdGggYW4gSFRNTCByZXByZXNlbnRhdGlvbiBvZjoKCiAgYGBg
        aHRtbAogIDxkaXYgaWQ9ImVtYmVyMSIgY2xhc3M9ImVtYmVyLXZpZXcgbXkt
        Y2xhc3MgbXktb3RoZXItY2xhc3MiPjwvZGl2PgogIGBgYAoKICBgY2xhc3Ng
        IGF0dHJpYnV0ZSB2YWx1ZXMgY2FuIGFsc28gYmUgc2V0IGJ5IHByb3ZpZGlu
        ZyBhIGBjbGFzc05hbWVCaW5kaW5nc2AKICBwcm9wZXJ0eSBzZXQgdG8gYW4g
        YXJyYXkgb2YgcHJvcGVydGllcyBuYW1lcyBmb3IgdGhlIHZpZXcuIFRoZSBy
        ZXR1cm4gdmFsdWUKICBvZiB0aGVzZSBwcm9wZXJ0aWVzIHdpbGwgYmUgYWRk
        ZWQgYXMgcGFydCBvZiB0aGUgdmFsdWUgZm9yIHRoZSB2aWV3J3MgYGNsYXNz
        YAogIGF0dHJpYnV0ZS4gVGhlc2UgcHJvcGVydGllcyBjYW4gYmUgY29tcHV0
        ZWQgcHJvcGVydGllczoKCiAgYGBgamF2YXNjcmlwdAogIE15VmlldyA9IEVt
        YmVyLlZpZXcuZXh0ZW5kKHsKICAgIGNsYXNzTmFtZUJpbmRpbmdzOiBbJ3By
        b3BlcnR5QScsICdwcm9wZXJ0eUInXSwKICAgIHByb3BlcnR5QTogJ2Zyb20t
        YScsCiAgICBwcm9wZXJ0eUI6IGZ1bmN0aW9uKCkgewogICAgICBpZiAoc29t
        ZUxvZ2ljKSB7IHJldHVybiAnZnJvbS1iJzsgfQogICAgfS5wcm9wZXJ0eSgp
        CiAgfSk7CiAgYGBgCgogIFdpbGwgcmVzdWx0IGluIHZpZXcgaW5zdGFuY2Vz
        IHdpdGggYW4gSFRNTCByZXByZXNlbnRhdGlvbiBvZjoKCiAgYGBgaHRtbAog
        IDxkaXYgaWQ9ImVtYmVyMSIgY2xhc3M9ImVtYmVyLXZpZXcgZnJvbS1hIGZy
        b20tYiI+PC9kaXY+CiAgYGBgCgogIElmIHRoZSB2YWx1ZSBvZiBhIGNsYXNz
        IG5hbWUgYmluZGluZyByZXR1cm5zIGEgYm9vbGVhbiB0aGUgcHJvcGVydHkg
        bmFtZQogIGl0c2VsZiB3aWxsIGJlIHVzZWQgYXMgdGhlIGNsYXNzIG5hbWUg
        aWYgdGhlIHByb3BlcnR5IGlzIHRydWUuIFRoZSBjbGFzcyBuYW1lCiAgd2ls
        bCBub3QgYmUgYWRkZWQgaWYgdGhlIHZhbHVlIGlzIGBmYWxzZWAgb3IgYHVu
        ZGVmaW5lZGAuCgogIGBgYGphdmFzY3JpcHQKICBNeVZpZXcgPSBFbWJlci5W
        aWV3LmV4dGVuZCh7CiAgICBjbGFzc05hbWVCaW5kaW5nczogWydob3ZlcmVk
        J10sCiAgICBob3ZlcmVkOiB0cnVlCiAgfSk7CiAgYGBgCgogIFdpbGwgcmVz
        dWx0IGluIHZpZXcgaW5zdGFuY2VzIHdpdGggYW4gSFRNTCByZXByZXNlbnRh
        dGlvbiBvZjoKCiAgYGBgaHRtbAogIDxkaXYgaWQ9ImVtYmVyMSIgY2xhc3M9
        ImVtYmVyLXZpZXcgaG92ZXJlZCI+PC9kaXY+CiAgYGBgCgogIFdoZW4gdXNp
        bmcgYm9vbGVhbiBjbGFzcyBuYW1lIGJpbmRpbmdzIHlvdSBjYW4gc3VwcGx5
        IGEgc3RyaW5nIHZhbHVlIG90aGVyCiAgdGhhbiB0aGUgcHJvcGVydHkgbmFt
        ZSBmb3IgdXNlIGFzIHRoZSBgY2xhc3NgIEhUTUwgYXR0cmlidXRlIGJ5IGFw
        cGVuZGluZyB0aGUKICBwcmVmZXJyZWQgdmFsdWUgYWZ0ZXIgYSAiOiIgY2hh
        cmFjdGVyIHdoZW4gZGVmaW5pbmcgdGhlIGJpbmRpbmc6CgogIGBgYGphdmFz
        Y3JpcHQKICBNeVZpZXcgPSBFbWJlci5WaWV3LmV4dGVuZCh7CiAgICBjbGFz
        c05hbWVCaW5kaW5nczogWydhd2Vzb21lOnNvLXZlcnktY29vbCddLAogICAg
        YXdlc29tZTogdHJ1ZQogIH0pOwogIGBgYAoKICBXaWxsIHJlc3VsdCBpbiB2
        aWV3IGluc3RhbmNlcyB3aXRoIGFuIEhUTUwgcmVwcmVzZW50YXRpb24gb2Y6
        CgogIGBgYGh0bWwKICA8ZGl2IGlkPSJlbWJlcjEiIGNsYXNzPSJlbWJlci12
        aWV3IHNvLXZlcnktY29vbCI+PC9kaXY+CiAgYGBgCgogIEJvb2xlYW4gdmFs
        dWUgY2xhc3MgbmFtZSBiaW5kaW5ncyB3aG9zZSBwcm9wZXJ0eSBuYW1lcyBh
        cmUgaW4gYQogIGNhbWVsQ2FzZS1zdHlsZSBmb3JtYXQgd2lsbCBiZSBjb252
        ZXJ0ZWQgdG8gYSBkYXNoZXJpemVkIGZvcm1hdDoKCiAgYGBgamF2YXNjcmlw
        dAogIE15VmlldyA9IEVtYmVyLlZpZXcuZXh0ZW5kKHsKICAgIGNsYXNzTmFt
        ZUJpbmRpbmdzOiBbJ2lzVXJnZW50J10sCiAgICBpc1VyZ2VudDogdHJ1ZQog
        IH0pOwogIGBgYAoKICBXaWxsIHJlc3VsdCBpbiB2aWV3IGluc3RhbmNlcyB3
        aXRoIGFuIEhUTUwgcmVwcmVzZW50YXRpb24gb2Y6CgogIGBgYGh0bWwKICA8
        ZGl2IGlkPSJlbWJlcjEiIGNsYXNzPSJlbWJlci12aWV3IGlzLXVyZ2VudCI+
        PC9kaXY+CiAgYGBgCgogIENsYXNzIG5hbWUgYmluZGluZ3MgY2FuIGFsc28g
        cmVmZXIgdG8gb2JqZWN0IHZhbHVlcyB0aGF0IGFyZSBmb3VuZCBieQogIHRy
        YXZlcnNpbmcgYSBwYXRoIHJlbGF0aXZlIHRvIHRoZSB2aWV3IGl0c2VsZjoK
        CiAgYGBgamF2YXNjcmlwdAogIE15VmlldyA9IEVtYmVyLlZpZXcuZXh0ZW5k
        KHsKICAgIGNsYXNzTmFtZUJpbmRpbmdzOiBbJ21lc3NhZ2VzLmVtcHR5J10K
        ICAgIG1lc3NhZ2VzOiBFbWJlci5PYmplY3QuY3JlYXRlKHsKICAgICAgZW1w
        dHk6IHRydWUKICAgIH0pCiAgfSk7CiAgYGBgCgogIFdpbGwgcmVzdWx0IGlu
        IHZpZXcgaW5zdGFuY2VzIHdpdGggYW4gSFRNTCByZXByZXNlbnRhdGlvbiBv
        ZjoKCiAgYGBgaHRtbAogIDxkaXYgaWQ9ImVtYmVyMSIgY2xhc3M9ImVtYmVy
        LXZpZXcgZW1wdHkiPjwvZGl2PgogIGBgYAoKICBJZiB5b3Ugd2FudCB0byBh
        ZGQgYSBjbGFzcyBuYW1lIGZvciBhIHByb3BlcnR5IHdoaWNoIGV2YWx1YXRl
        cyB0byB0cnVlIGFuZAogIGFuZCBhIGRpZmZlcmVudCBjbGFzcyBuYW1lIGlm
        IGl0IGV2YWx1YXRlcyB0byBmYWxzZSwgeW91IGNhbiBwYXNzIGEgYmluZGlu
        ZwogIGxpa2UgdGhpczoKCiAgYGBgamF2YXNjcmlwdAogIC8vIEFwcGxpZXMg
        J2VuYWJsZWQnIGNsYXNzIHdoZW4gaXNFbmFibGVkIGlzIHRydWUgYW5kICdk
        aXNhYmxlZCcgd2hlbiBpc0VuYWJsZWQgaXMgZmFsc2UKICBFbWJlci5WaWV3
        LmV4dGVuZCh7CiAgICBjbGFzc05hbWVCaW5kaW5nczogWydpc0VuYWJsZWQ6
        ZW5hYmxlZDpkaXNhYmxlZCddCiAgICBpc0VuYWJsZWQ6IHRydWUKICB9KTsK
        ICBgYGAKCiAgV2lsbCByZXN1bHQgaW4gdmlldyBpbnN0YW5jZXMgd2l0aCBh
        biBIVE1MIHJlcHJlc2VudGF0aW9uIG9mOgoKICBgYGBodG1sCiAgPGRpdiBp
        ZD0iZW1iZXIxIiBjbGFzcz0iZW1iZXItdmlldyBlbmFibGVkIj48L2Rpdj4K
        ICBgYGAKCiAgV2hlbiBpc0VuYWJsZWQgaXMgYGZhbHNlYCwgdGhlIHJlc3Vs
        dGluZyBIVE1MIHJlcHJlbnNlbnRhdGlvbiBsb29rcyBsaWtlCiAgdGhpczoK
        CiAgYGBgaHRtbAogIDxkaXYgaWQ9ImVtYmVyMSIgY2xhc3M9ImVtYmVyLXZp
        ZXcgZGlzYWJsZWQiPjwvZGl2PgogIGBgYAoKICBUaGlzIHN5bnRheCBvZmZl
        cnMgdGhlIGNvbnZlbmllbmNlIHRvIGFkZCBhIGNsYXNzIGlmIGEgcHJvcGVy
        dHkgaXMgYGZhbHNlYDoKCiAgYGBgamF2YXNjcmlwdAogIC8vIEFwcGxpZXMg
        bm8gY2xhc3Mgd2hlbiBpc0VuYWJsZWQgaXMgdHJ1ZSBhbmQgY2xhc3MgJ2Rp
        c2FibGVkJyB3aGVuIGlzRW5hYmxlZCBpcyBmYWxzZQogIEVtYmVyLlZpZXcu
        ZXh0ZW5kKHsKICAgIGNsYXNzTmFtZUJpbmRpbmdzOiBbJ2lzRW5hYmxlZDo6
        ZGlzYWJsZWQnXQogICAgaXNFbmFibGVkOiB0cnVlCiAgfSk7CiAgYGBgCgog
        IFdpbGwgcmVzdWx0IGluIHZpZXcgaW5zdGFuY2VzIHdpdGggYW4gSFRNTCBy
        ZXByZXNlbnRhdGlvbiBvZjoKCiAgYGBgaHRtbAogIDxkaXYgaWQ9ImVtYmVy
        MSIgY2xhc3M9ImVtYmVyLXZpZXciPjwvZGl2PgogIGBgYAoKICBXaGVuIHRo
        ZSBgaXNFbmFibGVkYCBwcm9wZXJ0eSBvbiB0aGUgdmlldyBpcyBzZXQgdG8g
        YGZhbHNlYCwgaXQgd2lsbCByZXN1bHQKICBpbiB2aWV3IGluc3RhbmNlcyB3
        aXRoIGFuIEhUTUwgcmVwcmVzZW50YXRpb24gb2Y6CgogIGBgYGh0bWwKICA8
        ZGl2IGlkPSJlbWJlcjEiIGNsYXNzPSJlbWJlci12aWV3IGRpc2FibGVkIj48
        L2Rpdj4KICBgYGAKCiAgVXBkYXRlcyB0byB0aGUgdGhlIHZhbHVlIG9mIGEg
        Y2xhc3MgbmFtZSBiaW5kaW5nIHdpbGwgcmVzdWx0IGluIGF1dG9tYXRpYwog
        IHVwZGF0ZSBvZiB0aGUgIEhUTUwgYGNsYXNzYCBhdHRyaWJ1dGUgaW4gdGhl
        IHZpZXcncyByZW5kZXJlZCBIVE1MCiAgcmVwcmVzZW50YXRpb24uIElmIHRo
        ZSB2YWx1ZSBiZWNvbWVzIGBmYWxzZWAgb3IgYHVuZGVmaW5lZGAgdGhlIGNs
        YXNzIG5hbWUKICB3aWxsIGJlIHJlbW92ZWQuCgogIEJvdGggYGNsYXNzTmFt
        ZXNgIGFuZCBgY2xhc3NOYW1lQmluZGluZ3NgIGFyZSBjb25jYXRlbmF0ZWQg
        cHJvcGVydGllcy4gU2VlCiAgW0VtYmVyLk9iamVjdF0oL2FwaS9jbGFzc2Vz
        L0VtYmVyLk9iamVjdC5odG1sKSBkb2N1bWVudGF0aW9uIGZvciBtb3JlCiAg
        aW5mb3JtYXRpb24gYWJvdXQgY29uY2F0ZW5hdGVkIHByb3BlcnRpZXMuCgog
        ICMjIEhUTUwgQXR0cmlidXRlcwoKICBUaGUgSFRNTCBhdHRyaWJ1dGUgc2Vj
        dGlvbiBvZiBhIHZpZXcncyB0YWcgY2FuIGJlIHNldCBieSBwcm92aWRpbmcg
        YW4KICBgYXR0cmlidXRlQmluZGluZ3NgIHByb3BlcnR5IHNldCB0byBhbiBh
        cnJheSBvZiBwcm9wZXJ0eSBuYW1lcyBvbiB0aGUgdmlldy4KICBUaGUgcmV0
        dXJuIHZhbHVlIG9mIHRoZXNlIHByb3BlcnRpZXMgd2lsbCBiZSB1c2VkIGFz
        IHRoZSB2YWx1ZSBvZiB0aGUgdmlldydzCiAgSFRNTCBhc3NvY2lhdGVkIGF0
        dHJpYnV0ZToKCiAgYGBgamF2YXNjcmlwdAogIEFuY2hvclZpZXcgPSBFbWJl
        ci5WaWV3LmV4dGVuZCh7CiAgICB0YWdOYW1lOiAnYScsCiAgICBhdHRyaWJ1
        dGVCaW5kaW5nczogWydocmVmJ10sCiAgICBocmVmOiAnaHR0cDovL2dvb2ds
        ZS5jb20nCiAgfSk7CiAgYGBgCgogIFdpbGwgcmVzdWx0IGluIHZpZXcgaW5z
        dGFuY2VzIHdpdGggYW4gSFRNTCByZXByZXNlbnRhdGlvbiBvZjoKCiAgYGBg
        aHRtbAogIDxhIGlkPSJlbWJlcjEiIGNsYXNzPSJlbWJlci12aWV3IiBocmVm
        PSJodHRwOi8vZ29vZ2xlLmNvbSI+PC9hPgogIGBgYAoKICBJZiB0aGUgcmV0
        dXJuIHZhbHVlIG9mIGFuIGBhdHRyaWJ1dGVCaW5kaW5nc2AgbW9uaXRvcmVk
        IHByb3BlcnR5IGlzIGEgYm9vbGVhbgogIHRoZSBwcm9wZXJ0eSB3aWxsIGZv
        bGxvdyBIVE1MJ3MgcGF0dGVybiBvZiByZXBlYXRpbmcgdGhlIGF0dHJpYnV0
        ZSdzIG5hbWUgYXMKICBpdHMgdmFsdWU6CgogIGBgYGphdmFzY3JpcHQKICBN
        eVRleHRJbnB1dCA9IEVtYmVyLlZpZXcuZXh0ZW5kKHsKICAgIHRhZ05hbWU6
        ICdpbnB1dCcsCiAgICBhdHRyaWJ1dGVCaW5kaW5nczogWydkaXNhYmxlZCdd
        LAogICAgZGlzYWJsZWQ6IHRydWUKICB9KTsKICBgYGAKCiAgV2lsbCByZXN1
        bHQgaW4gdmlldyBpbnN0YW5jZXMgd2l0aCBhbiBIVE1MIHJlcHJlc2VudGF0
        aW9uIG9mOgoKICBgYGBodG1sCiAgPGlucHV0IGlkPSJlbWJlcjEiIGNsYXNz
        PSJlbWJlci12aWV3IiBkaXNhYmxlZD0iZGlzYWJsZWQiIC8+CiAgYGBgCgog
        IGBhdHRyaWJ1dGVCaW5kaW5nc2AgY2FuIHJlZmVyIHRvIGNvbXB1dGVkIHBy
        b3BlcnRpZXM6CgogIGBgYGphdmFzY3JpcHQKICBNeVRleHRJbnB1dCA9IEVt
        YmVyLlZpZXcuZXh0ZW5kKHsKICAgIHRhZ05hbWU6ICdpbnB1dCcsCiAgICBh
        dHRyaWJ1dGVCaW5kaW5nczogWydkaXNhYmxlZCddLAogICAgZGlzYWJsZWQ6
        IGZ1bmN0aW9uKCkgewogICAgICBpZiAoc29tZUxvZ2ljKSB7CiAgICAgICAg
        cmV0dXJuIHRydWU7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIGZh
        bHNlOwogICAgICB9CiAgICB9LnByb3BlcnR5KCkKICB9KTsKICBgYGAKCiAg
        VXBkYXRlcyB0byB0aGUgdGhlIHByb3BlcnR5IG9mIGFuIGF0dHJpYnV0ZSBi
        aW5kaW5nIHdpbGwgcmVzdWx0IGluIGF1dG9tYXRpYwogIHVwZGF0ZSBvZiB0
        aGUgIEhUTUwgYXR0cmlidXRlIGluIHRoZSB2aWV3J3MgcmVuZGVyZWQgSFRN
        TCByZXByZXNlbnRhdGlvbi4KCiAgYGF0dHJpYnV0ZUJpbmRpbmdzYCBpcyBh
        IGNvbmNhdGVuYXRlZCBwcm9wZXJ0eS4gU2VlIFtFbWJlci5PYmplY3RdKC9h
        cGkvY2xhc3Nlcy9FbWJlci5PYmplY3QuaHRtbCkKICBkb2N1bWVudGF0aW9u
        IGZvciBtb3JlIGluZm9ybWF0aW9uIGFib3V0IGNvbmNhdGVuYXRlZCBwcm9w
        ZXJ0aWVzLgoKICAjIyBUZW1wbGF0ZXMKCiAgVGhlIEhUTUwgY29udGVudHMg
        b2YgYSB2aWV3J3MgcmVuZGVyZWQgcmVwcmVzZW50YXRpb24gYXJlIGRldGVy
        bWluZWQgYnkgaXRzCiAgdGVtcGxhdGUuIFRlbXBsYXRlcyBjYW4gYmUgYW55
        IGZ1bmN0aW9uIHRoYXQgYWNjZXB0cyBhbiBvcHRpb25hbCBjb250ZXh0CiAg
        cGFyYW1ldGVyIGFuZCByZXR1cm5zIGEgc3RyaW5nIG9mIEhUTUwgdGhhdCB3
        aWxsIGJlIGluc2VydGVkIHdpdGhpbiB0aGUKICB2aWV3J3MgdGFnLiBNb3N0
        IHR5cGljYWxseSBpbiBFbWJlciB0aGlzIGZ1bmN0aW9uIHdpbGwgYmUgYSBj
        b21waWxlZAogIGBFbWJlci5IYW5kbGViYXJzYCB0ZW1wbGF0ZS4KCiAgYGBg
        amF2YXNjcmlwdAogIEFWaWV3ID0gRW1iZXIuVmlldy5leHRlbmQoewogICAg
        dGVtcGxhdGU6IEVtYmVyLkhhbmRsZWJhcnMuY29tcGlsZSgnSSBhbSB0aGUg
        dGVtcGxhdGUnKQogIH0pOwogIGBgYAoKICBXaWxsIHJlc3VsdCBpbiB2aWV3
        IGluc3RhbmNlcyB3aXRoIGFuIEhUTUwgcmVwcmVzZW50YXRpb24gb2Y6Cgog
        IGBgYGh0bWwKICA8ZGl2IGlkPSJlbWJlcjEiIGNsYXNzPSJlbWJlci12aWV3
        Ij5JIGFtIHRoZSB0ZW1wbGF0ZTwvZGl2PgogIGBgYAoKICBXaXRoaW4gYW4g
        RW1iZXIgYXBwbGljYXRpb24gaXMgbW9yZSBjb21tb24gdG8gZGVmaW5lIGEg
        SGFuZGxlYmFycyB0ZW1wbGF0ZXMgYXMKICBwYXJ0IG9mIGEgcGFnZToKCiAg
        YGBgaHRtbAogIDxzY3JpcHQgdHlwZT0ndGV4dC94LWhhbmRsZWJhcnMnIGRh
        dGEtdGVtcGxhdGUtbmFtZT0nc29tZS10ZW1wbGF0ZSc+CiAgICBIZWxsbwog
        IDwvc2NyaXB0PgogIGBgYAoKICBBbmQgYXNzb2NpYXRlIGl0IGJ5IG5hbWUg
        dXNpbmcgYSB2aWV3J3MgYHRlbXBsYXRlTmFtZWAgcHJvcGVydHk6CgogIGBg
        YGphdmFzY3JpcHQKICBBVmlldyA9IEVtYmVyLlZpZXcuZXh0ZW5kKHsKICAg
        IHRlbXBsYXRlTmFtZTogJ3NvbWUtdGVtcGxhdGUnCiAgfSk7CiAgYGBgCgog
        IFVzaW5nIGEgdmFsdWUgZm9yIGB0ZW1wbGF0ZU5hbWVgIHRoYXQgZG9lcyBu
        b3QgaGF2ZSBhIEhhbmRsZWJhcnMgdGVtcGxhdGUKICB3aXRoIGEgbWF0Y2hp
        bmcgYGRhdGEtdGVtcGxhdGUtbmFtZWAgYXR0cmlidXRlIHdpbGwgdGhyb3cg
        YW4gZXJyb3IuCgogIEZvciB2aWV3cyBjbGFzc2VzIHRoYXQgbWF5IGhhdmUg
        YSB0ZW1wbGF0ZSBsYXRlciBkZWZpbmVkIChlLmcuIGFzIHRoZSBibG9jawog
        IHBvcnRpb24gb2YgYSBge3t2aWV3fX1gIEhhbmRsZWJhcnMgaGVscGVyIGNh
        bGwgaW4gYW5vdGhlciB0ZW1wbGF0ZSBvciBpbgogIGEgc3ViY2xhc3MpLCB5
        b3UgY2FuIHByb3ZpZGUgYSBgZGVmYXVsdFRlbXBsYXRlYCBwcm9wZXJ0eSBz
        ZXQgdG8gY29tcGlsZWQKICB0ZW1wbGF0ZSBmdW5jdGlvbi4gSWYgYSB0ZW1w
        bGF0ZSBpcyBub3QgbGF0ZXIgcHJvdmlkZWQgZm9yIHRoZSB2aWV3IGluc3Rh
        bmNlCiAgdGhlIGBkZWZhdWx0VGVtcGxhdGVgIHZhbHVlIHdpbGwgYmUgdXNl
        ZDoKCiAgYGBgamF2YXNjcmlwdAogIEFWaWV3ID0gRW1iZXIuVmlldy5leHRl
        bmQoewogICAgZGVmYXVsdFRlbXBsYXRlOiBFbWJlci5IYW5kbGViYXJzLmNv
        bXBpbGUoJ0kgd2FzIHRoZSBkZWZhdWx0JyksCiAgICB0ZW1wbGF0ZTogbnVs
        bCwKICAgIHRlbXBsYXRlTmFtZTogbnVsbAogIH0pOwogIGBgYAoKICBXaWxs
        IHJlc3VsdCBpbiBpbnN0YW5jZXMgd2l0aCBhbiBIVE1MIHJlcHJlc2VudGF0
        aW9uIG9mOgoKICBgYGBodG1sCiAgPGRpdiBpZD0iZW1iZXIxIiBjbGFzcz0i
        ZW1iZXItdmlldyI+SSB3YXMgdGhlIGRlZmF1bHQ8L2Rpdj4KICBgYGAKCiAg
        SWYgYSBgdGVtcGxhdGVgIG9yIGB0ZW1wbGF0ZU5hbWVgIGlzIHByb3ZpZGVk
        IGl0IHdpbGwgdGFrZSBwcmVjZWRlbmNlIG92ZXIKICBgZGVmYXVsdFRlbXBs
        YXRlYDoKCiAgYGBgamF2YXNjcmlwdAogIEFWaWV3ID0gRW1iZXIuVmlldy5l
        eHRlbmQoewogICAgZGVmYXVsdFRlbXBsYXRlOiBFbWJlci5IYW5kbGViYXJz
        LmNvbXBpbGUoJ0kgd2FzIHRoZSBkZWZhdWx0JykKICB9KTsKCiAgYVZpZXcg
        PSBBVmlldy5jcmVhdGUoewogICAgdGVtcGxhdGU6IEVtYmVyLkhhbmRsZWJh
        cnMuY29tcGlsZSgnSSB3YXMgdGhlIHRlbXBsYXRlLCBub3QgZGVmYXVsdCcp
        CiAgfSk7CiAgYGBgCgogIFdpbGwgcmVzdWx0IGluIHRoZSBmb2xsb3dpbmcg
        SFRNTCByZXByZXNlbnRhdGlvbiB3aGVuIHJlbmRlcmVkOgoKICBgYGBodG1s
        CiAgPGRpdiBpZD0iZW1iZXIxIiBjbGFzcz0iZW1iZXItdmlldyI+SSB3YXMg
        dGhlIHRlbXBsYXRlLCBub3QgZGVmYXVsdDwvZGl2PgogIGBgYAoKICAjIyBW
        aWV3IENvbnRleHQKCiAgVGhlIGRlZmF1bHQgY29udGV4dCBvZiB0aGUgY29t
        cGlsZWQgdGVtcGxhdGUgaXMgdGhlIHZpZXcncyBjb250cm9sbGVyOgoKICBg
        YGBqYXZhc2NyaXB0CiAgQVZpZXcgPSBFbWJlci5WaWV3LmV4dGVuZCh7CiAg
        ICB0ZW1wbGF0ZTogRW1iZXIuSGFuZGxlYmFycy5jb21waWxlKCdIZWxsbyB7
        e2V4Y2l0ZWRHcmVldGluZ319JykKICB9KTsKCiAgYUNvbnRyb2xsZXIgPSBF
        bWJlci5PYmplY3QuY3JlYXRlKHsKICAgIGZpcnN0TmFtZTogJ0JhcnJ5JywK
        ICAgIGV4Y2l0ZWRHcmVldGluZzogZnVuY3Rpb24oKSB7CiAgICAgIHJldHVy
        biB0aGlzLmdldCgiY29udGVudC5maXJzdE5hbWUiKSArICIhISEiCiAgICB9
        LnByb3BlcnR5KCkKICB9KTsKCiAgYVZpZXcgPSBBVmlldy5jcmVhdGUoewog
        ICAgY29udHJvbGxlcjogYUNvbnRyb2xsZXIsCiAgfSk7CiAgYGBgCgogIFdp
        bGwgcmVzdWx0IGluIGFuIEhUTUwgcmVwcmVzZW50YXRpb24gb2Y6CgogIGBg
        YGh0bWwKICA8ZGl2IGlkPSJlbWJlcjEiIGNsYXNzPSJlbWJlci12aWV3Ij5I
        ZWxsbyBCYXJyeSEhITwvZGl2PgogIGBgYAoKICBBIGNvbnRleHQgY2FuIGFs
        c28gYmUgZXhwbGljaXRseSBzdXBwbGllZCB0aHJvdWdoIHRoZSB2aWV3J3Mg
        YGNvbnRleHRgCiAgcHJvcGVydHkuIElmIHRoZSB2aWV3IGhhcyBuZWl0aGVy
        IGBjb250ZXh0YCBub3IgYGNvbnRyb2xsZXJgIHByb3BlcnRpZXMsIHRoZQog
        IGBwYXJlbnRWaWV3YCdzIGNvbnRleHQgd2lsbCBiZSB1c2VkLgoKICAjIyBM
        YXlvdXRzCgogIFZpZXdzIGNhbiBoYXZlIGEgc2Vjb25kYXJ5IHRlbXBsYXRl
        IHRoYXQgd3JhcHMgdGhlaXIgbWFpbiB0ZW1wbGF0ZS4gTGlrZQogIHByaW1h
        cnkgdGVtcGxhdGVzLCBsYXlvdXRzIGNhbiBiZSBhbnkgZnVuY3Rpb24gdGhh
        dCAgYWNjZXB0cyBhbiBvcHRpb25hbAogIGNvbnRleHQgcGFyYW1ldGVyIGFu
        ZCByZXR1cm5zIGEgc3RyaW5nIG9mIEhUTUwgdGhhdCB3aWxsIGJlIGluc2Vy
        dGVkIGluc2lkZQogIHZpZXcncyB0YWcuIFZpZXdzIHdob3NlIEhUTUwgZWxl
        bWVudCBpcyBzZWxmIGNsb3NpbmcgKGUuZy4gYDxpbnB1dCAvPmApCiAgY2Fu
        bm90IGhhdmUgYSBsYXlvdXQgYW5kIHRoaXMgcHJvcGVydHkgd2lsbCBiZSBp
        Z25vcmVkLgoKICBNb3N0IHR5cGljYWxseSBpbiBFbWJlciBhIGxheW91dCB3
        aWxsIGJlIGEgY29tcGlsZWQgYEVtYmVyLkhhbmRsZWJhcnNgCiAgdGVtcGxh
        dGUuCgogIEEgdmlldydzIGxheW91dCBjYW4gYmUgc2V0IGRpcmVjdGx5IHdp
        dGggdGhlIGBsYXlvdXRgIHByb3BlcnR5IG9yIHJlZmVyZW5jZQogIGFuIGV4
        aXN0aW5nIEhhbmRsZWJhcnMgdGVtcGxhdGUgYnkgbmFtZSB3aXRoIHRoZSBg
        bGF5b3V0TmFtZWAgcHJvcGVydHkuCgogIEEgdGVtcGxhdGUgdXNlZCBhcyBh
        IGxheW91dCBtdXN0IGNvbnRhaW4gYSBzaW5nbGUgdXNlIG9mIHRoZSBIYW5k
        bGViYXJzCiAgYHt7eWllbGR9fWAgaGVscGVyLiBUaGUgSFRNTCBjb250ZW50
        cyBvZiBhIHZpZXcncyByZW5kZXJlZCBgdGVtcGxhdGVgIHdpbGwgYmUKICBp
        bnNlcnRlZCBhdCB0aGlzIGxvY2F0aW9uOgoKICBgYGBqYXZhc2NyaXB0CiAg
        QVZpZXdXaXRoTGF5b3V0ID0gRW1iZXIuVmlldy5leHRlbmQoewogICAgbGF5
        b3V0OiBFbWJlci5IYW5kbGViYXJzLmNvbXBpbGUoIjxkaXYgY2xhc3M9J215
        LWRlY29yYXRpdmUtY2xhc3MnPnt7eWllbGR9fTwvZGl2PiIpCiAgICB0ZW1w
        bGF0ZTogRW1iZXIuSGFuZGxlYmFycy5jb21waWxlKCJJIGdvdCB3cmFwcGVk
        IiksCiAgfSk7CiAgYGBgCgogIFdpbGwgcmVzdWx0IGluIHZpZXcgaW5zdGFu
        Y2VzIHdpdGggYW4gSFRNTCByZXByZXNlbnRhdGlvbiBvZjoKCiAgYGBgaHRt
        bAogIDxkaXYgaWQ9ImVtYmVyMSIgY2xhc3M9ImVtYmVyLXZpZXciPgogICAg
        PGRpdiBjbGFzcz0ibXktZGVjb3JhdGl2ZS1jbGFzcyI+CiAgICAgIEkgZ290
        IHdyYXBwZWQKICAgIDwvZGl2PgogIDwvZGl2PgogIGBgYAoKICBTZWUgW0Vt
        YmVyLkhhbmRsZWJhcnMuaGVscGVycy55aWVsZF0oL2FwaS9jbGFzc2VzL0Vt
        YmVyLkhhbmRsZWJhcnMuaGVscGVycy5odG1sI21ldGhvZF95aWVsZCkKICBm
        b3IgbW9yZSBpbmZvcm1hdGlvbi4KCiAgIyMgUmVzcG9uZGluZyB0byBCcm93
        c2VyIEV2ZW50cwoKICBWaWV3cyBjYW4gcmVzcG9uZCB0byB1c2VyLWluaXRp
        YXRlZCBldmVudHMgaW4gb25lIG9mIHRocmVlIHdheXM6IG1ldGhvZAogIGlt
        cGxlbWVudGF0aW9uLCB0aHJvdWdoIGFuIGV2ZW50IG1hbmFnZXIsIGFuZCB0
        aHJvdWdoIGB7e2FjdGlvbn19YCBoZWxwZXIgdXNlCiAgaW4gdGhlaXIgdGVt
        cGxhdGUgb3IgbGF5b3V0LgoKICAjIyMgTWV0aG9kIEltcGxlbWVudGF0aW9u
        CgogIFZpZXdzIGNhbiByZXNwb25kIHRvIHVzZXItaW5pdGlhdGVkIGV2ZW50
        cyBieSBpbXBsZW1lbnRpbmcgYSBtZXRob2QgdGhhdAogIG1hdGNoZXMgdGhl
        IGV2ZW50IG5hbWUuIEEgYGpRdWVyeS5FdmVudGAgb2JqZWN0IHdpbGwgYmUg
        cGFzc2VkIGFzIHRoZQogIGFyZ3VtZW50IHRvIHRoaXMgbWV0aG9kLgoKICBg
        YGBqYXZhc2NyaXB0CiAgQVZpZXcgPSBFbWJlci5WaWV3LmV4dGVuZCh7CiAg
        ICBjbGljazogZnVuY3Rpb24oZXZlbnQpIHsKICAgICAgLy8gd2lsbCBiZSBj
        YWxsZWQgd2hlbiB3aGVuIGFuIGluc3RhbmNlJ3MKICAgICAgLy8gcmVuZGVy
        ZWQgZWxlbWVudCBpcyBjbGlja2VkCiAgICB9CiAgfSk7CiAgYGBgCgogICMj
        IyBFdmVudCBNYW5hZ2VycwoKICBWaWV3cyBjYW4gZGVmaW5lIGFuIG9iamVj
        dCBhcyB0aGVpciBgZXZlbnRNYW5hZ2VyYCBwcm9wZXJ0eS4gVGhpcyBvYmpl
        Y3QgY2FuCiAgdGhlbiBpbXBsZW1lbnQgbWV0aG9kcyB0aGF0IG1hdGNoIHRo
        ZSBkZXNpcmVkIGV2ZW50IG5hbWVzLiBNYXRjaGluZyBldmVudHMKICB0aGF0
        IG9jY3VyIG9uIHRoZSB2aWV3J3MgcmVuZGVyZWQgSFRNTCBvciB0aGUgcmVu
        ZGVyZWQgSFRNTCBvZiBhbnkgb2YgaXRzIERPTQogIGRlc2NlbmRhbnRzIHdp
        bGwgdHJpZ2dlciB0aGlzIG1ldGhvZC4gQSBgalF1ZXJ5LkV2ZW50YCBvYmpl
        Y3Qgd2lsbCBiZSBwYXNzZWQKICBhcyB0aGUgZmlyc3QgYXJndW1lbnQgdG8g
        dGhlIG1ldGhvZCBhbmQgYW4gIGBFbWJlci5WaWV3YCBvYmplY3QgYXMgdGhl
        CiAgc2Vjb25kLiBUaGUgYEVtYmVyLlZpZXdgIHdpbGwgYmUgdGhlIHZpZXcg
        d2hvc2UgcmVuZGVyZWQgSFRNTCB3YXMgaW50ZXJhY3RlZAogIHdpdGguIFRo
        aXMgbWF5IGJlIHRoZSB2aWV3IHdpdGggdGhlIGBldmVudE1hbmFnZXJgIHBy
        b3BlcnR5IG9yIG9uZSBvZiBpdHMKICBkZXNjZW5kZW50IHZpZXdzLgoKICBg
        YGBqYXZhc2NyaXB0CiAgQVZpZXcgPSBFbWJlci5WaWV3LmV4dGVuZCh7CiAg
        ICBldmVudE1hbmFnZXI6IEVtYmVyLk9iamVjdC5jcmVhdGUoewogICAgICBk
        b3VibGVDbGljazogZnVuY3Rpb24oZXZlbnQsIHZpZXcpIHsKICAgICAgICAv
        LyB3aWxsIGJlIGNhbGxlZCB3aGVuIHdoZW4gYW4gaW5zdGFuY2UncwogICAg
        ICAgIC8vIHJlbmRlcmVkIGVsZW1lbnQgb3IgYW55IHJlbmRlcmluZwogICAg
        ICAgIC8vIG9mIHRoaXMgdmlld3MncyBkZXNjZW5kZW50CiAgICAgICAgLy8g
        ZWxlbWVudHMgaXMgY2xpY2tlZAogICAgICB9CiAgICB9KQogIH0pOwogIGBg
        YAoKICBBbiBldmVudCBkZWZpbmVkIGZvciBhbiBldmVudCBtYW5hZ2VyIHRh
        a2VzIHByZWNlZGVuY2Ugb3ZlciBldmVudHMgb2YgdGhlCiAgc2FtZSBuYW1l
        IGhhbmRsZWQgdGhyb3VnaCBtZXRob2RzIG9uIHRoZSB2aWV3LgoKICBgYGBq
        YXZhc2NyaXB0CiAgQVZpZXcgPSBFbWJlci5WaWV3LmV4dGVuZCh7CiAgICBt
        b3VzZUVudGVyOiBmdW5jdGlvbihldmVudCkgewogICAgICAvLyB3aWxsIG5l
        dmVyIHRyaWdnZXIuCiAgICB9LAogICAgZXZlbnRNYW5hZ2VyOiBFbWJlci5P
        YmplY3QuY3JlYXRlKHsKICAgICAgbW91c2VFbnRlcjogZnVuY3Rpb24oZXZl
        bnQsIHZpZXcpIHsKICAgICAgICAvLyB0YWtlcyBwcmVjZWRlbmNlIG92ZXIg
        QVZpZXcjbW91c2VFbnRlcgogICAgICB9CiAgICB9KQogIH0pOwogIGBgYAoK
        ICBTaW1pbGFybHkgYSB2aWV3J3MgZXZlbnQgbWFuYWdlciB3aWxsIHRha2Ug
        cHJlY2VkZW5jZSBmb3IgZXZlbnRzIG9mIGFueSB2aWV3cwogIHJlbmRlcmVk
        IGFzIGEgZGVzY2VuZGVudC4gQSBtZXRob2QgbmFtZSB0aGF0IG1hdGNoZXMg
        YW4gZXZlbnQgbmFtZSB3aWxsIG5vdAogIGJlIGNhbGxlZCBpZiB0aGUgdmll
        dyBpbnN0YW5jZSB3YXMgcmVuZGVyZWQgaW5zaWRlIHRoZSBIVE1MIHJlcHJl
        c2VudGF0aW9uIG9mCiAgYSB2aWV3IHRoYXQgaGFzIGFuIGBldmVudE1hbmFn
        ZXJgIHByb3BlcnR5IGRlZmluZWQgdGhhdCBoYW5kbGVzIGV2ZW50cyBvZiB0
        aGUKICBuYW1lLiBFdmVudHMgbm90IGhhbmRsZWQgYnkgdGhlIGV2ZW50IG1h
        bmFnZXIgd2lsbCBzdGlsbCB0cmlnZ2VyIG1ldGhvZCBjYWxscwogIG9uIHRo
        ZSBkZXNjZW5kZW50LgoKICBgYGBqYXZhc2NyaXB0CiAgT3V0ZXJWaWV3ID0g
        RW1iZXIuVmlldy5leHRlbmQoewogICAgdGVtcGxhdGU6IEVtYmVyLkhhbmRs
        ZWJhcnMuY29tcGlsZSgib3V0ZXIge3sjdmlldyBJbm5lclZpZXd9fWlubmVy
        e3svdmlld319IG91dGVyIiksCiAgICBldmVudE1hbmFnZXI6IEVtYmVyLk9i
        amVjdC5jcmVhdGUoewogICAgICBtb3VzZUVudGVyOiBmdW5jdGlvbihldmVu
        dCwgdmlldykgewogICAgICAgIC8vIHZpZXcgbWlnaHQgYmUgaW5zdGFuY2Ug
        b2YgZWl0aGVyCiAgICAgICAgLy8gT3V0ZXJWaWV3IG9yIElubmVyVmlldyBk
        ZXBlbmRpbmcgb24KICAgICAgICAvLyB3aGVyZSBvbiB0aGUgcGFnZSB0aGUg
        dXNlciBpbnRlcmFjdGlvbiBvY2N1cmVkCiAgICAgIH0KICAgIH0pCiAgfSk7
        CgogIElubmVyVmlldyA9IEVtYmVyLlZpZXcuZXh0ZW5kKHsKICAgIGNsaWNr
        OiBmdW5jdGlvbihldmVudCkgewogICAgICAvLyB3aWxsIGJlIGNhbGxlZCBp
        ZiByZW5kZXJlZCBpbnNpZGUKICAgICAgLy8gYW4gT3V0ZXJWaWV3IGJlY2F1
        c2UgT3V0ZXJWaWV3J3MKICAgICAgLy8gZXZlbnRNYW5hZ2VyIGRvZXNuJ3Qg
        aGFuZGxlIGNsaWNrIGV2ZW50cwogICAgfSwKICAgIG1vdXNlRW50ZXI6IGZ1
        bmN0aW9uKGV2ZW50KSB7CiAgICAgIC8vIHdpbGwgbmV2ZXIgYmUgY2FsbGVk
        IGlmIHJlbmRlcmVkIGluc2lkZQogICAgICAvLyBhbiBPdXRlclZpZXcuCiAg
        ICB9CiAgfSk7CiAgYGBgCgogICMjIyBIYW5kbGViYXJzIGB7e2FjdGlvbn19
        YCBIZWxwZXIKCiAgU2VlIFtIYW5kbGViYXJzLmhlbHBlcnMuYWN0aW9uXSgv
        YXBpL2NsYXNzZXMvRW1iZXIuSGFuZGxlYmFycy5oZWxwZXJzLmh0bWwjbWV0
        aG9kX2FjdGlvbikuCgogICMjIyBFdmVudCBOYW1lcwoKICBBbGwgb2YgdGhl
        IGV2ZW50IGhhbmRsaW5nIGFwcHJvYWNoZXMgZGVzY3JpYmVkIGFib3ZlIHJl
        c3BvbmQgdG8gdGhlIHNhbWUgc2V0CiAgb2YgZXZlbnRzLiBUaGUgbmFtZXMg
        b2YgdGhlIGJ1aWx0LWluIGV2ZW50cyBhcmUgbGlzdGVkIGJlbG93LiAoVGhl
        IGhhc2ggb2YKICBidWlsdC1pbiBldmVudHMgZXhpc3RzIGluIGBFbWJlci5F
        dmVudERpc3BhdGNoZXJgLikgQWRkaXRpb25hbCwgY3VzdG9tIGV2ZW50cwog
        IGNhbiBiZSByZWdpc3RlcmVkIGJ5IHVzaW5nIGBFbWJlci5BcHBsaWNhdGlv
        bi5jdXN0b21FdmVudHNgLgoKICBUb3VjaCBldmVudHM6CgogICogYHRvdWNo
        U3RhcnRgCiAgKiBgdG91Y2hNb3ZlYAogICogYHRvdWNoRW5kYAogICogYHRv
        dWNoQ2FuY2VsYAoKICBLZXlib2FyZCBldmVudHMKCiAgKiBga2V5RG93bmAK
        ICAqIGBrZXlVcGAKICAqIGBrZXlQcmVzc2AKCiAgTW91c2UgZXZlbnRzCgog
        ICogYG1vdXNlRG93bmAKICAqIGBtb3VzZVVwYAogICogYGNvbnRleHRNZW51
        YAogICogYGNsaWNrYAogICogYGRvdWJsZUNsaWNrYAogICogYG1vdXNlTW92
        ZWAKICAqIGBmb2N1c0luYAogICogYGZvY3VzT3V0YAogICogYG1vdXNlRW50
        ZXJgCiAgKiBgbW91c2VMZWF2ZWAKCiAgRm9ybSBldmVudHM6CgogICogYHN1
        Ym1pdGAKICAqIGBjaGFuZ2VgCiAgKiBgZm9jdXNJbmAKICAqIGBmb2N1c091
        dGAKICAqIGBpbnB1dGAKCiAgSFRNTDUgZHJhZyBhbmQgZHJvcCBldmVudHM6
        CgogICogYGRyYWdTdGFydGAKICAqIGBkcmFnYAogICogYGRyYWdFbnRlcmAK
        ICAqIGBkcmFnTGVhdmVgCiAgKiBgZHJvcGAKICAqIGBkcmFnRW5kYAoKICAj
        IyBIYW5kbGViYXJzIGB7e3ZpZXd9fWAgSGVscGVyCgogIE90aGVyIGBFbWJl
        ci5WaWV3YCBpbnN0YW5jZXMgY2FuIGJlIGluY2x1ZGVkIGFzIHBhcnQgb2Yg
        YSB2aWV3J3MgdGVtcGxhdGUgYnkKICB1c2luZyB0aGUgYHt7dmlld319YCBI
        YW5kbGViYXJzIGhlbHBlci4gU2VlIFtFbWJlci5IYW5kbGViYXJzLmhlbHBl
        cnMudmlld10oL2FwaS9jbGFzc2VzL0VtYmVyLkhhbmRsZWJhcnMuaGVscGVy
        cy5odG1sI21ldGhvZF92aWV3KQogIGZvciBhZGRpdGlvbmFsIGluZm9ybWF0
        aW9uLgoKICBAY2xhc3MgVmlldwogIEBuYW1lc3BhY2UgRW1iZXIKICBAZXh0
        ZW5kcyBFbWJlci5Db3JlVmlldwoqLwpFbWJlci5WaWV3ID0gRW1iZXIuQ29y
        ZVZpZXcuZXh0ZW5kKAovKiogQHNjb3BlIEVtYmVyLlZpZXcucHJvdG90eXBl
        ICovIHsKCiAgY29uY2F0ZW5hdGVkUHJvcGVydGllczogWydjbGFzc05hbWVz
        JywgJ2NsYXNzTmFtZUJpbmRpbmdzJywgJ2F0dHJpYnV0ZUJpbmRpbmdzJ10s
        CgogIC8qKgogICAgQHByb3BlcnR5IGlzVmlldwogICAgQHR5cGUgQm9vbGVh
        bgogICAgQGRlZmF1bHQgdHJ1ZQogICAgQGZpbmFsCiAgKi8KICBpc1ZpZXc6
        IHRydWUsCgogIC8vIC4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4u
        Li4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4KICAvLyBURU1QTEFURSBTVVBQ
        T1JUCiAgLy8KCiAgLyoqCiAgICBUaGUgbmFtZSBvZiB0aGUgdGVtcGxhdGUg
        dG8gbG9va3VwIGlmIG5vIHRlbXBsYXRlIGlzIHByb3ZpZGVkLgoKICAgIGBF
        bWJlci5WaWV3YCB3aWxsIGxvb2sgZm9yIGEgdGVtcGxhdGUgd2l0aCB0aGlz
        IG5hbWUgaW4gdGhpcyB2aWV3J3MKICAgIGB0ZW1wbGF0ZXNgIG9iamVjdC4g
        QnkgZGVmYXVsdCwgdGhpcyB3aWxsIGJlIGEgZ2xvYmFsIG9iamVjdAogICAg
        c2hhcmVkIGluIGBFbWJlci5URU1QTEFURVNgLgoKICAgIEBwcm9wZXJ0eSB0
        ZW1wbGF0ZU5hbWUKICAgIEB0eXBlIFN0cmluZwogICAgQGRlZmF1bHQgbnVs
        bAogICovCiAgdGVtcGxhdGVOYW1lOiBudWxsLAoKICAvKioKICAgIFRoZSBu
        YW1lIG9mIHRoZSBsYXlvdXQgdG8gbG9va3VwIGlmIG5vIGxheW91dCBpcyBw
        cm92aWRlZC4KCiAgICBgRW1iZXIuVmlld2Agd2lsbCBsb29rIGZvciBhIHRl
        bXBsYXRlIHdpdGggdGhpcyBuYW1lIGluIHRoaXMgdmlldydzCiAgICBgdGVt
        cGxhdGVzYCBvYmplY3QuIEJ5IGRlZmF1bHQsIHRoaXMgd2lsbCBiZSBhIGds
        b2JhbCBvYmplY3QKICAgIHNoYXJlZCBpbiBgRW1iZXIuVEVNUExBVEVTYC4K
        CiAgICBAcHJvcGVydHkgbGF5b3V0TmFtZQogICAgQHR5cGUgU3RyaW5nCiAg
        ICBAZGVmYXVsdCBudWxsCiAgKi8KICBsYXlvdXROYW1lOiBudWxsLAoKICAv
        KioKICAgIFRoZSBoYXNoIGluIHdoaWNoIHRvIGxvb2sgZm9yIGB0ZW1wbGF0
        ZU5hbWVgLgoKICAgIEBwcm9wZXJ0eSB0ZW1wbGF0ZXMKICAgIEB0eXBlIEVt
        YmVyLk9iamVjdAogICAgQGRlZmF1bHQgRW1iZXIuVEVNUExBVEVTCiAgKi8K
        ICB0ZW1wbGF0ZXM6IEVtYmVyLlRFTVBMQVRFUywKCiAgLyoqCiAgICBUaGUg
        dGVtcGxhdGUgdXNlZCB0byByZW5kZXIgdGhlIHZpZXcuIFRoaXMgc2hvdWxk
        IGJlIGEgZnVuY3Rpb24gdGhhdAogICAgYWNjZXB0cyBhbiBvcHRpb25hbCBj
        b250ZXh0IHBhcmFtZXRlciBhbmQgcmV0dXJucyBhIHN0cmluZyBvZiBIVE1M
        IHRoYXQKICAgIHdpbGwgYmUgaW5zZXJ0ZWQgaW50byB0aGUgRE9NIHJlbGF0
        aXZlIHRvIGl0cyBwYXJlbnQgdmlldy4KCiAgICBJbiBnZW5lcmFsLCB5b3Ug
        c2hvdWxkIHNldCB0aGUgYHRlbXBsYXRlTmFtZWAgcHJvcGVydHkgaW5zdGVh
        ZCBvZiBzZXR0aW5nCiAgICB0aGUgdGVtcGxhdGUgeW91cnNlbGYuCgogICAg
        QHByb3BlcnR5IHRlbXBsYXRlCiAgICBAdHlwZSBGdW5jdGlvbgogICovCiAg
        dGVtcGxhdGU6IEVtYmVyLmNvbXB1dGVkKGZ1bmN0aW9uKGtleSwgdmFsdWUp
        IHsKICAgIGlmICh2YWx1ZSAhPT0gdW5kZWZpbmVkKSB7IHJldHVybiB2YWx1
        ZTsgfQoKICAgIHZhciB0ZW1wbGF0ZU5hbWUgPSBnZXQodGhpcywgJ3RlbXBs
        YXRlTmFtZScpLAogICAgICAgIHRlbXBsYXRlID0gdGhpcy50ZW1wbGF0ZUZv
        ck5hbWUodGVtcGxhdGVOYW1lLCAndGVtcGxhdGUnKTsKCiAgICBFbWJlci5h
        c3NlcnQoIllvdSBzcGVjaWZpZWQgdGhlIHRlbXBsYXRlTmFtZSAiICsgdGVt
        cGxhdGVOYW1lICsgIiBmb3IgIiArIHRoaXMgKyAiLCBidXQgaXQgZGlkIG5v
        dCBleGlzdC4iLCAhdGVtcGxhdGVOYW1lIHx8IHRlbXBsYXRlKTsKCiAgICBy
        ZXR1cm4gdGVtcGxhdGUgfHwgZ2V0KHRoaXMsICdkZWZhdWx0VGVtcGxhdGUn
        KTsKICB9KS5wcm9wZXJ0eSgndGVtcGxhdGVOYW1lJyksCgogIC8qKgogICAg
        VGhlIGNvbnRyb2xsZXIgbWFuYWdpbmcgdGhpcyB2aWV3LiBJZiB0aGlzIHBy
        b3BlcnR5IGlzIHNldCwgaXQgd2lsbCBiZQogICAgbWFkZSBhdmFpbGFibGUg
        Zm9yIHVzZSBieSB0aGUgdGVtcGxhdGUuCgogICAgQHByb3BlcnR5IGNvbnRy
        b2xsZXIKICAgIEB0eXBlIE9iamVjdAogICovCiAgY29udHJvbGxlcjogRW1i
        ZXIuY29tcHV0ZWQoZnVuY3Rpb24oa2V5KSB7CiAgICB2YXIgcGFyZW50Vmll
        dyA9IGdldCh0aGlzLCAnX3BhcmVudFZpZXcnKTsKICAgIHJldHVybiBwYXJl
        bnRWaWV3ID8gZ2V0KHBhcmVudFZpZXcsICdjb250cm9sbGVyJykgOiBudWxs
        OwogIH0pLnByb3BlcnR5KCdfcGFyZW50VmlldycpLAoKICAvKioKICAgIEEg
        dmlldyBtYXkgY29udGFpbiBhIGxheW91dC4gQSBsYXlvdXQgaXMgYSByZWd1
        bGFyIHRlbXBsYXRlIGJ1dAogICAgc3VwZXJzZWRlcyB0aGUgYHRlbXBsYXRl
        YCBwcm9wZXJ0eSBkdXJpbmcgcmVuZGVyaW5nLiBJdCBpcyB0aGUKICAgIHJl
        c3BvbnNpYmlsaXR5IG9mIHRoZSBsYXlvdXQgdGVtcGxhdGUgdG8gcmV0cmll
        dmUgdGhlIGB0ZW1wbGF0ZWAKICAgIHByb3BlcnR5IGZyb20gdGhlIHZpZXcg
        KG9yIGFsdGVybmF0aXZlbHksIGNhbGwgYEhhbmRsZWJhcnMuaGVscGVycy55
        aWVsZGAsCiAgICBge3t5aWVsZH19YCkgdG8gcmVuZGVyIGl0IGluIHRoZSBj
        b3JyZWN0IGxvY2F0aW9uLgoKICAgIFRoaXMgaXMgdXNlZnVsIGZvciBhIHZp
        ZXcgdGhhdCBoYXMgYSBzaGFyZWQgd3JhcHBlciwgYnV0IHdoaWNoIGRlbGVn
        YXRlcwogICAgdGhlIHJlbmRlcmluZyBvZiB0aGUgY29udGVudHMgb2YgdGhl
        IHdyYXBwZXIgdG8gdGhlIGB0ZW1wbGF0ZWAgcHJvcGVydHkKICAgIG9uIGEg
        c3ViY2xhc3MuCgogICAgQHByb3BlcnR5IGxheW91dAogICAgQHR5cGUgRnVu
        Y3Rpb24KICAqLwogIGxheW91dDogRW1iZXIuY29tcHV0ZWQoZnVuY3Rpb24o
        a2V5KSB7CiAgICB2YXIgbGF5b3V0TmFtZSA9IGdldCh0aGlzLCAnbGF5b3V0
        TmFtZScpLAogICAgICAgIGxheW91dCA9IHRoaXMudGVtcGxhdGVGb3JOYW1l
        KGxheW91dE5hbWUsICdsYXlvdXQnKTsKCiAgICBFbWJlci5hc3NlcnQoIllv
        dSBzcGVjaWZpZWQgdGhlIGxheW91dE5hbWUgIiArIGxheW91dE5hbWUgKyAi
        IGZvciAiICsgdGhpcyArICIsIGJ1dCBpdCBkaWQgbm90IGV4aXN0LiIsICFs
        YXlvdXROYW1lIHx8IGxheW91dCk7CgogICAgcmV0dXJuIGxheW91dCB8fCBn
        ZXQodGhpcywgJ2RlZmF1bHRMYXlvdXQnKTsKICB9KS5wcm9wZXJ0eSgnbGF5
        b3V0TmFtZScpLAoKICBfeWllbGQ6IGZ1bmN0aW9uKGNvbnRleHQsIG9wdGlv
        bnMpIHsKICAgIHZhciB0ZW1wbGF0ZSA9IGdldCh0aGlzLCAndGVtcGxhdGUn
        KTsKICAgIGlmICh0ZW1wbGF0ZSkgeyB0ZW1wbGF0ZShjb250ZXh0LCBvcHRp
        b25zKTsgfQogIH0sCgogIHRlbXBsYXRlRm9yTmFtZTogZnVuY3Rpb24obmFt
        ZSwgdHlwZSkgewogICAgaWYgKCFuYW1lKSB7IHJldHVybjsgfQogICAgRW1i
        ZXIuYXNzZXJ0KCJ0ZW1wbGF0ZU5hbWVzIGFyZSBub3QgYWxsb3dlZCB0byBj
        b250YWluIHBlcmlvZHM6ICIrbmFtZSwgbmFtZS5pbmRleE9mKCcuJykgPT09
        IC0xKTsKCiAgICAvLyB0aGUgZGVmYXVsdENvbnRhaW5lciBpcyBkZXByZWNh
        dGVkCiAgICB2YXIgY29udGFpbmVyID0gdGhpcy5jb250YWluZXIgfHwgKEVt
        YmVyLkNvbnRhaW5lciAmJiBFbWJlci5Db250YWluZXIuZGVmYXVsdENvbnRh
        aW5lcik7CiAgICByZXR1cm4gY29udGFpbmVyICYmIGNvbnRhaW5lci5sb29r
        dXAoJ3RlbXBsYXRlOicgKyBuYW1lKTsKICB9LAoKICAvKioKICAgIFRoZSBv
        YmplY3QgZnJvbSB3aGljaCB0ZW1wbGF0ZXMgc2hvdWxkIGFjY2VzcyBwcm9w
        ZXJ0aWVzLgoKICAgIFRoaXMgb2JqZWN0IHdpbGwgYmUgcGFzc2VkIHRvIHRo
        ZSB0ZW1wbGF0ZSBmdW5jdGlvbiBlYWNoIHRpbWUgdGhlIHJlbmRlcgogICAg
        bWV0aG9kIGlzIGNhbGxlZCwgYnV0IGl0IGlzIHVwIHRvIHRoZSBpbmRpdmlk
        dWFsIGZ1bmN0aW9uIHRvIGRlY2lkZSB3aGF0CiAgICB0byBkbyB3aXRoIGl0
        LgoKICAgIEJ5IGRlZmF1bHQsIHRoaXMgd2lsbCBiZSB0aGUgdmlldydzIGNv
        bnRyb2xsZXIuCgogICAgQHByb3BlcnR5IGNvbnRleHQKICAgIEB0eXBlIE9i
        amVjdAogICovCiAgY29udGV4dDogRW1iZXIuY29tcHV0ZWQoZnVuY3Rpb24o
        a2V5LCB2YWx1ZSkgewogICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDIp
        IHsKICAgICAgc2V0KHRoaXMsICdfY29udGV4dCcsIHZhbHVlKTsKICAgICAg
        cmV0dXJuIHZhbHVlOwogICAgfSBlbHNlIHsKICAgICAgcmV0dXJuIGdldCh0
        aGlzLCAnX2NvbnRleHQnKTsKICAgIH0KICB9KS52b2xhdGlsZSgpLAoKICAv
        KioKICAgIEBwcml2YXRlCgogICAgUHJpdmF0ZSBjb3B5IG9mIHRoZSB2aWV3
        J3MgdGVtcGxhdGUgY29udGV4dC4gVGhpcyBjYW4gYmUgc2V0IGRpcmVjdGx5
        CiAgICBieSBIYW5kbGViYXJzIHdpdGhvdXQgdHJpZ2dlcmluZyB0aGUgb2Jz
        ZXJ2ZXIgdGhhdCBjYXVzZXMgdGhlIHZpZXcKICAgIHRvIGJlIHJlLXJlbmRl
        cmVkLgoKICAgIFRoZSBjb250ZXh0IG9mIGEgdmlldyBpcyBsb29rZWQgdXAg
        YXMgZm9sbG93czoKCiAgICAxLiBTdXBwbGllZCBjb250ZXh0ICh1c3VhbGx5
        IGJ5IEhhbmRsZWJhcnMpCiAgICAyLiBTcGVjaWZpZWQgY29udHJvbGxlcgog
        ICAgMy4gYHBhcmVudFZpZXdgJ3MgY29udGV4dCAoZm9yIGEgY2hpbGQgb2Yg
        YSBDb250YWluZXJWaWV3KQoKICAgIFRoZSBjb2RlIGluIEhhbmRsZWJhcnMg
        dGhhdCBvdmVycmlkZXMgdGhlIGBfY29udGV4dGAgcHJvcGVydHkgZmlyc3QK
        ICAgIGNoZWNrcyB0byBzZWUgd2hldGhlciB0aGUgdmlldyBoYXMgYSBzcGVj
        aWZpZWQgY29udHJvbGxlci4gVGhpcyBpcwogICAgc29tZXRoaW5nIG9mIGEg
        aGFjayBhbmQgc2hvdWxkIGJlIHJldmlzaXRlZC4KCiAgICBAcHJvcGVydHkg
        X2NvbnRleHQKICAqLwogIF9jb250ZXh0OiBFbWJlci5jb21wdXRlZChmdW5j
        dGlvbihrZXkpIHsKICAgIHZhciBwYXJlbnRWaWV3LCBjb250cm9sbGVyOwoK
        ICAgIGlmIChjb250cm9sbGVyID0gZ2V0KHRoaXMsICdjb250cm9sbGVyJykp
        IHsKICAgICAgcmV0dXJuIGNvbnRyb2xsZXI7CiAgICB9CgogICAgcGFyZW50
        VmlldyA9IHRoaXMuX3BhcmVudFZpZXc7CiAgICBpZiAocGFyZW50Vmlldykg
        ewogICAgICByZXR1cm4gZ2V0KHBhcmVudFZpZXcsICdfY29udGV4dCcpOwog
        ICAgfQoKICAgIHJldHVybiBudWxsOwogIH0pLAoKICAvKioKICAgIEBwcml2
        YXRlCgogICAgSWYgYSB2YWx1ZSB0aGF0IGFmZmVjdHMgdGVtcGxhdGUgcmVu
        ZGVyaW5nIGNoYW5nZXMsIHRoZSB2aWV3IHNob3VsZCBiZQogICAgcmUtcmVu
        ZGVyZWQgdG8gcmVmbGVjdCB0aGUgbmV3IHZhbHVlLgoKICAgIEBtZXRob2Qg
        X2NvbnRleHREaWRDaGFuZ2UKICAqLwogIF9jb250ZXh0RGlkQ2hhbmdlOiBF
        bWJlci5vYnNlcnZlcihmdW5jdGlvbigpIHsKICAgIHRoaXMucmVyZW5kZXIo
        KTsKICB9LCAnY29udGV4dCcpLAoKICAvKioKICAgIElmIGBmYWxzZWAsIHRo
        ZSB2aWV3IHdpbGwgYXBwZWFyIGhpZGRlbiBpbiBET00uCgogICAgQHByb3Bl
        cnR5IGlzVmlzaWJsZQogICAgQHR5cGUgQm9vbGVhbgogICAgQGRlZmF1bHQg
        bnVsbAogICovCiAgaXNWaXNpYmxlOiB0cnVlLAoKICAvKioKICAgIEBwcml2
        YXRlCgogICAgQXJyYXkgb2YgY2hpbGQgdmlld3MuIFlvdSBzaG91bGQgbmV2
        ZXIgZWRpdCB0aGlzIGFycmF5IGRpcmVjdGx5LgogICAgSW5zdGVhZCwgdXNl
        IGBhcHBlbmRDaGlsZGAgYW5kIGByZW1vdmVGcm9tUGFyZW50YC4KCiAgICBA
        cHJvcGVydHkgY2hpbGRWaWV3cwogICAgQHR5cGUgQXJyYXkKICAgIEBkZWZh
        dWx0IFtdCiAgKi8KICBjaGlsZFZpZXdzOiBjaGlsZFZpZXdzUHJvcGVydHks
        CgogIF9jaGlsZFZpZXdzOiBFTVBUWV9BUlJBWSwKCiAgLy8gV2hlbiBpdCdz
        IGEgdmlydHVhbCB2aWV3LCB3ZSBuZWVkIHRvIG5vdGlmeSB0aGUgcGFyZW50
        IHRoYXQgdGhlaXIKICAvLyBjaGlsZFZpZXdzIHdpbGwgY2hhbmdlLgogIF9j
        aGlsZFZpZXdzV2lsbENoYW5nZTogRW1iZXIuYmVmb3JlT2JzZXJ2ZXIoZnVu
        Y3Rpb24oKSB7CiAgICBpZiAodGhpcy5pc1ZpcnR1YWwpIHsKICAgICAgdmFy
        IHBhcmVudFZpZXcgPSBnZXQodGhpcywgJ3BhcmVudFZpZXcnKTsKICAgICAg
        aWYgKHBhcmVudFZpZXcpIHsgRW1iZXIucHJvcGVydHlXaWxsQ2hhbmdlKHBh
        cmVudFZpZXcsICdjaGlsZFZpZXdzJyk7IH0KICAgIH0KICB9LCAnY2hpbGRW
        aWV3cycpLAoKICAvLyBXaGVuIGl0J3MgYSB2aXJ0dWFsIHZpZXcsIHdlIG5l
        ZWQgdG8gbm90aWZ5IHRoZSBwYXJlbnQgdGhhdCB0aGVpcgogIC8vIGNoaWxk
        Vmlld3MgZGlkIGNoYW5nZS4KICBfY2hpbGRWaWV3c0RpZENoYW5nZTogRW1i
        ZXIub2JzZXJ2ZXIoZnVuY3Rpb24oKSB7CiAgICBpZiAodGhpcy5pc1ZpcnR1
        YWwpIHsKICAgICAgdmFyIHBhcmVudFZpZXcgPSBnZXQodGhpcywgJ3BhcmVu
        dFZpZXcnKTsKICAgICAgaWYgKHBhcmVudFZpZXcpIHsgRW1iZXIucHJvcGVy
        dHlEaWRDaGFuZ2UocGFyZW50VmlldywgJ2NoaWxkVmlld3MnKTsgfQogICAg
        fQogIH0sICdjaGlsZFZpZXdzJyksCgogIC8qKgogICAgUmV0dXJuIHRoZSBu
        ZWFyZXN0IGFuY2VzdG9yIHRoYXQgaXMgYW4gaW5zdGFuY2Ugb2YgdGhlIHBy
        b3ZpZGVkCiAgICBjbGFzcy4KCiAgICBAcHJvcGVydHkgbmVhcmVzdEluc3Rh
        bmNlT2YKICAgIEBwYXJhbSB7Q2xhc3N9IGtsYXNzIFN1YmNsYXNzIG9mIEVt
        YmVyLlZpZXcgKG9yIEVtYmVyLlZpZXcgaXRzZWxmKQogICAgQHJldHVybiBF
        bWJlci5WaWV3CiAgICBAZGVwcmVjYXRlZAogICovCiAgbmVhcmVzdEluc3Rh
        bmNlT2Y6IGZ1bmN0aW9uKGtsYXNzKSB7CiAgICBFbWJlci5kZXByZWNhdGUo
        Im5lYXJlc3RJbnN0YW5jZU9mIGlzIGRlcHJlY2F0ZWQgYW5kIHdpbGwgYmUg
        cmVtb3ZlZCBmcm9tIGZ1dHVyZSByZWxlYXNlcy4gVXNlIG5lYXJlc3RPZlR5
        cGUuIik7CiAgICB2YXIgdmlldyA9IGdldCh0aGlzLCAncGFyZW50Vmlldycp
        OwoKICAgIHdoaWxlICh2aWV3KSB7CiAgICAgIGlmICh2aWV3IGluc3RhbmNl
        b2Yga2xhc3MpIHsgcmV0dXJuIHZpZXc7IH0KICAgICAgdmlldyA9IGdldCh2
        aWV3LCAncGFyZW50VmlldycpOwogICAgfQogIH0sCgogIC8qKgogICAgUmV0
        dXJuIHRoZSBuZWFyZXN0IGFuY2VzdG9yIHRoYXQgaXMgYW4gaW5zdGFuY2Ug
        b2YgdGhlIHByb3ZpZGVkCiAgICBjbGFzcyBvciBtaXhpbi4KCiAgICBAcHJv
        cGVydHkgbmVhcmVzdE9mVHlwZQogICAgQHBhcmFtIHtDbGFzcyxNaXhpbn0g
        a2xhc3MgU3ViY2xhc3Mgb2YgRW1iZXIuVmlldyAob3IgRW1iZXIuVmlldyBp
        dHNlbGYpLAogICAgICAgICAgIG9yIGFuIGluc3RhbmNlIG9mIEVtYmVyLk1p
        eGluLgogICAgQHJldHVybiBFbWJlci5WaWV3CiAgKi8KICBuZWFyZXN0T2ZU
        eXBlOiBmdW5jdGlvbihrbGFzcykgewogICAgdmFyIHZpZXcgPSBnZXQodGhp
        cywgJ3BhcmVudFZpZXcnKSwKICAgICAgICBpc09mVHlwZSA9IGtsYXNzIGlu
        c3RhbmNlb2YgRW1iZXIuTWl4aW4gPwogICAgICAgICAgICAgICAgICAgZnVu
        Y3Rpb24odmlldykgeyByZXR1cm4ga2xhc3MuZGV0ZWN0KHZpZXcpOyB9IDoK
        ICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uKHZpZXcpIHsgcmV0dXJuIGts
        YXNzLmRldGVjdCh2aWV3LmNvbnN0cnVjdG9yKTsgfTsKCiAgICB3aGlsZSAo
        dmlldykgewogICAgICBpZiAoaXNPZlR5cGUodmlldykpIHsgcmV0dXJuIHZp
        ZXc7IH0KICAgICAgdmlldyA9IGdldCh2aWV3LCAncGFyZW50VmlldycpOwog
        ICAgfQogIH0sCgogIC8qKgogICAgUmV0dXJuIHRoZSBuZWFyZXN0IGFuY2Vz
        dG9yIHRoYXQgaGFzIGEgZ2l2ZW4gcHJvcGVydHkuCgogICAgQHByb3BlcnR5
        IG5lYXJlc3RXaXRoUHJvcGVydHkKICAgIEBwYXJhbSB7U3RyaW5nfSBwcm9w
        ZXJ0eSBBIHByb3BlcnR5IG5hbWUKICAgIEByZXR1cm4gRW1iZXIuVmlldwog
        ICovCiAgbmVhcmVzdFdpdGhQcm9wZXJ0eTogZnVuY3Rpb24ocHJvcGVydHkp
        IHsKICAgIHZhciB2aWV3ID0gZ2V0KHRoaXMsICdwYXJlbnRWaWV3Jyk7Cgog
        ICAgd2hpbGUgKHZpZXcpIHsKICAgICAgaWYgKHByb3BlcnR5IGluIHZpZXcp
        IHsgcmV0dXJuIHZpZXc7IH0KICAgICAgdmlldyA9IGdldCh2aWV3LCAncGFy
        ZW50VmlldycpOwogICAgfQogIH0sCgogIC8qKgogICAgUmV0dXJuIHRoZSBu
        ZWFyZXN0IGFuY2VzdG9yIHdob3NlIHBhcmVudCBpcyBhbiBpbnN0YW5jZSBv
        ZgogICAgYGtsYXNzYC4KCiAgICBAcHJvcGVydHkgbmVhcmVzdENoaWxkT2YK
        ICAgIEBwYXJhbSB7Q2xhc3N9IGtsYXNzIFN1YmNsYXNzIG9mIEVtYmVyLlZp
        ZXcgKG9yIEVtYmVyLlZpZXcgaXRzZWxmKQogICAgQHJldHVybiBFbWJlci5W
        aWV3CiAgKi8KICBuZWFyZXN0Q2hpbGRPZjogZnVuY3Rpb24oa2xhc3MpIHsK
        ICAgIHZhciB2aWV3ID0gZ2V0KHRoaXMsICdwYXJlbnRWaWV3Jyk7CgogICAg
        d2hpbGUgKHZpZXcpIHsKICAgICAgaWYgKGdldCh2aWV3LCAncGFyZW50Vmll
        dycpIGluc3RhbmNlb2Yga2xhc3MpIHsgcmV0dXJuIHZpZXc7IH0KICAgICAg
        dmlldyA9IGdldCh2aWV3LCAncGFyZW50VmlldycpOwogICAgfQogIH0sCgog
        IC8qKgogICAgQHByaXZhdGUKCiAgICBXaGVuIHRoZSBwYXJlbnQgdmlldyBj
        aGFuZ2VzLCByZWN1cnNpdmVseSBpbnZhbGlkYXRlIGBjb250cm9sbGVyYAoK
        ICAgIEBtZXRob2QgX3BhcmVudFZpZXdEaWRDaGFuZ2UKICAqLwogIF9wYXJl
        bnRWaWV3RGlkQ2hhbmdlOiBFbWJlci5vYnNlcnZlcihmdW5jdGlvbigpIHsK
        ICAgIGlmICh0aGlzLmlzRGVzdHJveWluZykgeyByZXR1cm47IH0KCiAgICB0
        aGlzLnRyaWdnZXIoJ3BhcmVudFZpZXdEaWRDaGFuZ2UnKTsKCiAgICBpZiAo
        Z2V0KHRoaXMsICdwYXJlbnRWaWV3LmNvbnRyb2xsZXInKSAmJiAhZ2V0KHRo
        aXMsICdjb250cm9sbGVyJykpIHsKICAgICAgdGhpcy5ub3RpZnlQcm9wZXJ0
        eUNoYW5nZSgnY29udHJvbGxlcicpOwogICAgfQogIH0sICdfcGFyZW50Vmll
        dycpLAoKICBfY29udHJvbGxlckRpZENoYW5nZTogRW1iZXIub2JzZXJ2ZXIo
        ZnVuY3Rpb24oKSB7CiAgICBpZiAodGhpcy5pc0Rlc3Ryb3lpbmcpIHsgcmV0
        dXJuOyB9CgogICAgdGhpcy5yZXJlbmRlcigpOwoKICAgIHRoaXMuZm9yRWFj
        aENoaWxkVmlldyhmdW5jdGlvbih2aWV3KSB7CiAgICAgIHZpZXcucHJvcGVy
        dHlEaWRDaGFuZ2UoJ2NvbnRyb2xsZXInKTsKICAgIH0pOwogIH0sICdjb250
        cm9sbGVyJyksCgogIGNsb25lS2V5d29yZHM6IGZ1bmN0aW9uKCkgewogICAg
        dmFyIHRlbXBsYXRlRGF0YSA9IGdldCh0aGlzLCAndGVtcGxhdGVEYXRhJyk7
        CgogICAgdmFyIGtleXdvcmRzID0gdGVtcGxhdGVEYXRhID8gRW1iZXIuY29w
        eSh0ZW1wbGF0ZURhdGEua2V5d29yZHMpIDoge307CiAgICBzZXQoa2V5d29y
        ZHMsICd2aWV3JywgZ2V0KHRoaXMsICdjb25jcmV0ZVZpZXcnKSk7CiAgICBz
        ZXQoa2V5d29yZHMsICdfdmlldycsIHRoaXMpOwogICAgc2V0KGtleXdvcmRz
        LCAnY29udHJvbGxlcicsIGdldCh0aGlzLCAnY29udHJvbGxlcicpKTsKCiAg
        ICByZXR1cm4ga2V5d29yZHM7CiAgfSwKCiAgLyoqCiAgICBDYWxsZWQgb24g
        eW91ciB2aWV3IHdoZW4gaXQgc2hvdWxkIHB1c2ggc3RyaW5ncyBvZiBIVE1M
        IGludG8gYQogICAgYEVtYmVyLlJlbmRlckJ1ZmZlcmAuIE1vc3QgdXNlcnMg
        d2lsbCB3YW50IHRvIG92ZXJyaWRlIHRoZSBgdGVtcGxhdGVgCiAgICBvciBg
        dGVtcGxhdGVOYW1lYCBwcm9wZXJ0aWVzIGluc3RlYWQgb2YgdGhpcyBtZXRo
        b2QuCgogICAgQnkgZGVmYXVsdCwgYEVtYmVyLlZpZXdgIHdpbGwgbG9vayBm
        b3IgYSBmdW5jdGlvbiBpbiB0aGUgYHRlbXBsYXRlYAogICAgcHJvcGVydHkg
        YW5kIGludm9rZSBpdCB3aXRoIHRoZSB2YWx1ZSBvZiBgY29udGV4dGAuIFRo
        ZSB2YWx1ZSBvZgogICAgYGNvbnRleHRgIHdpbGwgYmUgdGhlIHZpZXcncyBj
        b250cm9sbGVyIHVubGVzcyB5b3Ugb3ZlcnJpZGUgaXQuCgogICAgQG1ldGhv
        ZCByZW5kZXIKICAgIEBwYXJhbSB7RW1iZXIuUmVuZGVyQnVmZmVyfSBidWZm
        ZXIgVGhlIHJlbmRlciBidWZmZXIKICAqLwogIHJlbmRlcjogZnVuY3Rpb24o
        YnVmZmVyKSB7CiAgICAvLyBJZiB0aGlzIHZpZXcgaGFzIGEgbGF5b3V0LCBp
        dCBpcyB0aGUgcmVzcG9uc2liaWxpdHkgb2YgdGhlCiAgICAvLyB0aGUgbGF5
        b3V0IHRvIHJlbmRlciB0aGUgdmlldydzIHRlbXBsYXRlLiBPdGhlcndpc2Us
        IHJlbmRlciB0aGUgdGVtcGxhdGUKICAgIC8vIGRpcmVjdGx5LgogICAgdmFy
        IHRlbXBsYXRlID0gZ2V0KHRoaXMsICdsYXlvdXQnKSB8fCBnZXQodGhpcywg
        J3RlbXBsYXRlJyk7CgogICAgaWYgKHRlbXBsYXRlKSB7CiAgICAgIHZhciBj
        b250ZXh0ID0gZ2V0KHRoaXMsICdjb250ZXh0Jyk7CiAgICAgIHZhciBrZXl3
        b3JkcyA9IHRoaXMuY2xvbmVLZXl3b3JkcygpOwogICAgICB2YXIgb3V0cHV0
        OwoKICAgICAgdmFyIGRhdGEgPSB7CiAgICAgICAgdmlldzogdGhpcywKICAg
        ICAgICBidWZmZXI6IGJ1ZmZlciwKICAgICAgICBpc1JlbmRlckRhdGE6IHRy
        dWUsCiAgICAgICAga2V5d29yZHM6IGtleXdvcmRzLAogICAgICAgIGluc2lk
        ZUdyb3VwOiBnZXQodGhpcywgJ3RlbXBsYXRlRGF0YS5pbnNpZGVHcm91cCcp
        CiAgICAgIH07CgogICAgICAvLyBJbnZva2UgdGhlIHRlbXBsYXRlIHdpdGgg
        dGhlIHByb3ZpZGVkIHRlbXBsYXRlIGNvbnRleHQsIHdoaWNoCiAgICAgIC8v
        IGlzIHRoZSB2aWV3J3MgY29udHJvbGxlciBieSBkZWZhdWx0LiBBIGhhc2gg
        b2YgZGF0YSBpcyBhbHNvIHBhc3NlZCB0aGF0IHByb3ZpZGVzCiAgICAgIC8v
        IHRoZSB0ZW1wbGF0ZSB3aXRoIGFjY2VzcyB0byB0aGUgdmlldyBhbmQgcmVu
        ZGVyIGJ1ZmZlci4KCiAgICAgIEVtYmVyLmFzc2VydCgndGVtcGxhdGUgbXVz
        dCBiZSBhIGZ1bmN0aW9uLiBEaWQgeW91IG1lYW4gdG8gY2FsbCBFbWJlci5I
        YW5kbGViYXJzLmNvbXBpbGUoIi4uLiIpIG9yIHNwZWNpZnkgdGVtcGxhdGVO
        YW1lIGluc3RlYWQ/JywgdHlwZW9mIHRlbXBsYXRlID09PSAnZnVuY3Rpb24n
        KTsKICAgICAgLy8gVGhlIHRlbXBsYXRlIHNob3VsZCB3cml0ZSBkaXJlY3Rs
        eSB0byB0aGUgcmVuZGVyIGJ1ZmZlciBpbnN0ZWFkCiAgICAgIC8vIG9mIHJl
        dHVybmluZyBhIHN0cmluZy4KICAgICAgb3V0cHV0ID0gdGVtcGxhdGUoY29u
        dGV4dCwgeyBkYXRhOiBkYXRhIH0pOwoKICAgICAgLy8gSWYgdGhlIHRlbXBs
        YXRlIHJldHVybmVkIGEgc3RyaW5nIGluc3RlYWQgb2Ygd3JpdGluZyB0byB0
        aGUgYnVmZmVyLAogICAgICAvLyBwdXNoIHRoZSBzdHJpbmcgb250byB0aGUg
        YnVmZmVyLgogICAgICBpZiAob3V0cHV0ICE9PSB1bmRlZmluZWQpIHsgYnVm
        ZmVyLnB1c2gob3V0cHV0KTsgfQogICAgfQogIH0sCgogIC8qKgogICAgUmVu
        ZGVycyB0aGUgdmlldyBhZ2Fpbi4gVGhpcyB3aWxsIHdvcmsgcmVnYXJkbGVz
        cyBvZiB3aGV0aGVyIHRoZQogICAgdmlldyBpcyBhbHJlYWR5IGluIHRoZSBE
        T00gb3Igbm90LiBJZiB0aGUgdmlldyBpcyBpbiB0aGUgRE9NLCB0aGUKICAg
        IHJlbmRlcmluZyBwcm9jZXNzIHdpbGwgYmUgZGVmZXJyZWQgdG8gZ2l2ZSBi
        aW5kaW5ncyBhIGNoYW5jZQogICAgdG8gc3luY2hyb25pemUuCgogICAgSWYg
        Y2hpbGRyZW4gd2VyZSBhZGRlZCBkdXJpbmcgdGhlIHJlbmRlcmluZyBwcm9j
        ZXNzIHVzaW5nIGBhcHBlbmRDaGlsZGAsCiAgICBgcmVyZW5kZXJgIHdpbGwg
        cmVtb3ZlIHRoZW0sIGJlY2F1c2UgdGhleSB3aWxsIGJlIGFkZGVkIGFnYWlu
        CiAgICBpZiBuZWVkZWQgYnkgdGhlIG5leHQgYHJlbmRlcmAuCgogICAgSW4g
        Z2VuZXJhbCwgaWYgdGhlIGRpc3BsYXkgb2YgeW91ciB2aWV3IGNoYW5nZXMs
        IHlvdSBzaG91bGQgbW9kaWZ5CiAgICB0aGUgRE9NIGVsZW1lbnQgZGlyZWN0
        bHkgaW5zdGVhZCBvZiBtYW51YWxseSBjYWxsaW5nIGByZXJlbmRlcmAsIHdo
        aWNoIGNhbgogICAgYmUgc2xvdy4KCiAgICBAbWV0aG9kIHJlcmVuZGVyCiAg
        Ki8KICByZXJlbmRlcjogZnVuY3Rpb24oKSB7CiAgICByZXR1cm4gdGhpcy5j
        dXJyZW50U3RhdGUucmVyZW5kZXIodGhpcyk7CiAgfSwKCiAgY2xlYXJSZW5k
        ZXJlZENoaWxkcmVuOiBmdW5jdGlvbigpIHsKICAgIHZhciBsZW5ndGhCZWZv
        cmUgPSB0aGlzLmxlbmd0aEJlZm9yZVJlbmRlciwKICAgICAgICBsZW5ndGhB
        ZnRlciAgPSB0aGlzLmxlbmd0aEFmdGVyUmVuZGVyOwoKICAgIC8vIElmIHRo
        ZXJlIHdlcmUgY2hpbGQgdmlld3MgY3JlYXRlZCBkdXJpbmcgdGhlIGxhc3Qg
        Y2FsbCB0byByZW5kZXIoKSwKICAgIC8vIHJlbW92ZSB0aGVtIHVuZGVyIHRo
        ZSBhc3N1bXB0aW9uIHRoYXQgdGhleSB3aWxsIGJlIHJlLWNyZWF0ZWQgd2hl
        bgogICAgLy8gd2UgcmUtcmVuZGVyLgoKICAgIC8vIFZJRVctVE9ETzogVW5p
        dCB0ZXN0IHRoaXMgcGF0aC4KICAgIHZhciBjaGlsZFZpZXdzID0gdGhpcy5f
        Y2hpbGRWaWV3czsKICAgIGZvciAodmFyIGk9bGVuZ3RoQWZ0ZXItMTsgaT49
        bGVuZ3RoQmVmb3JlOyBpLS0pIHsKICAgICAgaWYgKGNoaWxkVmlld3NbaV0p
        IHsgY2hpbGRWaWV3c1tpXS5kZXN0cm95KCk7IH0KICAgIH0KICB9LAoKICAv
        KioKICAgIEBwcml2YXRlCgogICAgSXRlcmF0ZXMgb3ZlciB0aGUgdmlldydz
        IGBjbGFzc05hbWVCaW5kaW5nc2AgYXJyYXksIGluc2VydHMgdGhlIHZhbHVl
        CiAgICBvZiB0aGUgc3BlY2lmaWVkIHByb3BlcnR5IGludG8gdGhlIGBjbGFz
        c05hbWVzYCBhcnJheSwgdGhlbiBjcmVhdGVzIGFuCiAgICBvYnNlcnZlciB0
        byB1cGRhdGUgdGhlIHZpZXcncyBlbGVtZW50IGlmIHRoZSBib3VuZCBwcm9w
        ZXJ0eSBldmVyIGNoYW5nZXMKICAgIGluIHRoZSBmdXR1cmUuCgogICAgQG1l
        dGhvZCBfYXBwbHlDbGFzc05hbWVCaW5kaW5ncwogICovCiAgX2FwcGx5Q2xh
        c3NOYW1lQmluZGluZ3M6IGZ1bmN0aW9uKGNsYXNzQmluZGluZ3MpIHsKICAg
        IHZhciBjbGFzc05hbWVzID0gdGhpcy5jbGFzc05hbWVzLAogICAgZWxlbSwg
        bmV3Q2xhc3MsIGRhc2hlcml6ZWRDbGFzczsKCiAgICAvLyBMb29wIHRocm91
        Z2ggYWxsIG9mIHRoZSBjb25maWd1cmVkIGJpbmRpbmdzLiBUaGVzZSB3aWxs
        IGJlIGVpdGhlcgogICAgLy8gcHJvcGVydHkgbmFtZXMgKCdpc1VyZ2VudCcp
        IG9yIHByb3BlcnR5IHBhdGhzIHJlbGF0aXZlIHRvIHRoZSB2aWV3CiAgICAv
        LyAoJ2NvbnRlbnQuaXNVcmdlbnQnKQogICAgYV9mb3JFYWNoKGNsYXNzQmlu
        ZGluZ3MsIGZ1bmN0aW9uKGJpbmRpbmcpIHsKCiAgICAgIC8vIFZhcmlhYmxl
        IGluIHdoaWNoIHRoZSBvbGQgY2xhc3MgdmFsdWUgaXMgc2F2ZWQuIFRoZSBv
        YnNlcnZlciBmdW5jdGlvbgogICAgICAvLyBjbG9zZXMgb3ZlciB0aGlzIHZh
        cmlhYmxlLCBzbyBpdCBrbm93cyB3aGljaCBzdHJpbmcgdG8gcmVtb3ZlIHdo
        ZW4KICAgICAgLy8gdGhlIHByb3BlcnR5IGNoYW5nZXMuCiAgICAgIHZhciBv
        bGRDbGFzczsKICAgICAgLy8gRXh0cmFjdCBqdXN0IHRoZSBwcm9wZXJ0eSBu
        YW1lIGZyb20gYmluZGluZ3MgbGlrZSAnZm9vOmJhcicKICAgICAgdmFyIHBh
        cnNlZFBhdGggPSBFbWJlci5WaWV3Ll9wYXJzZVByb3BlcnR5UGF0aChiaW5k
        aW5nKTsKCiAgICAgIC8vIFNldCB1cCBhbiBvYnNlcnZlciBvbiB0aGUgY29u
        dGV4dC4gSWYgdGhlIHByb3BlcnR5IGNoYW5nZXMsIHRvZ2dsZSB0aGUKICAg
        ICAgLy8gY2xhc3MgbmFtZS4KICAgICAgdmFyIG9ic2VydmVyID0gZnVuY3Rp
        b24oKSB7CiAgICAgICAgLy8gR2V0IHRoZSBjdXJyZW50IHZhbHVlIG9mIHRo
        ZSBwcm9wZXJ0eQogICAgICAgIG5ld0NsYXNzID0gdGhpcy5fY2xhc3NTdHJp
        bmdGb3JQcm9wZXJ0eShiaW5kaW5nKTsKICAgICAgICBlbGVtID0gdGhpcy4k
        KCk7CgogICAgICAgIC8vIElmIHdlIGhhZCBwcmV2aW91c2x5IGFkZGVkIGEg
        Y2xhc3MgdG8gdGhlIGVsZW1lbnQsIHJlbW92ZSBpdC4KICAgICAgICBpZiAo
        b2xkQ2xhc3MpIHsKICAgICAgICAgIGVsZW0ucmVtb3ZlQ2xhc3Mob2xkQ2xh
        c3MpOwogICAgICAgICAgLy8gQWxzbyByZW1vdmUgZnJvbSBjbGFzc05hbWVz
        IHNvIHRoYXQgaWYgdGhlIHZpZXcgZ2V0cyByZXJlbmRlcmVkLAogICAgICAg
        ICAgLy8gdGhlIGNsYXNzIGRvZXNuJ3QgZ2V0IGFkZGVkIGJhY2sgdG8gdGhl
        IERPTS4KICAgICAgICAgIGNsYXNzTmFtZXMucmVtb3ZlT2JqZWN0KG9sZENs
        YXNzKTsKICAgICAgICB9CgogICAgICAgIC8vIElmIG5lY2Vzc2FyeSwgYWRk
        IGEgbmV3IGNsYXNzLiBNYWtlIHN1cmUgd2Uga2VlcCB0cmFjayBvZiBpdCBz
        bwogICAgICAgIC8vIGl0IGNhbiBiZSByZW1vdmVkIGluIHRoZSBmdXR1cmUu
        CiAgICAgICAgaWYgKG5ld0NsYXNzKSB7CiAgICAgICAgICBlbGVtLmFkZENs
        YXNzKG5ld0NsYXNzKTsKICAgICAgICAgIG9sZENsYXNzID0gbmV3Q2xhc3M7
        CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIG9sZENsYXNzID0gbnVsbDsK
        ICAgICAgICB9CiAgICAgIH07CgogICAgICAvLyBHZXQgdGhlIGNsYXNzIG5h
        bWUgZm9yIHRoZSBwcm9wZXJ0eSBhdCBpdHMgY3VycmVudCB2YWx1ZQogICAg
        ICBkYXNoZXJpemVkQ2xhc3MgPSB0aGlzLl9jbGFzc1N0cmluZ0ZvclByb3Bl
        cnR5KGJpbmRpbmcpOwoKICAgICAgaWYgKGRhc2hlcml6ZWRDbGFzcykgewog
        ICAgICAgIC8vIEVuc3VyZSB0aGF0IGl0IGdldHMgaW50byB0aGUgY2xhc3NO
        YW1lcyBhcnJheQogICAgICAgIC8vIHNvIGl0IGlzIGRpc3BsYXllZCB3aGVu
        IHdlIHJlbmRlci4KICAgICAgICBhX2FkZE9iamVjdChjbGFzc05hbWVzLCBk
        YXNoZXJpemVkQ2xhc3MpOwoKICAgICAgICAvLyBTYXZlIGEgcmVmZXJlbmNl
        IHRvIHRoZSBjbGFzcyBuYW1lIHNvIHdlIGNhbiByZW1vdmUgaXQKICAgICAg
        ICAvLyBpZiB0aGUgb2JzZXJ2ZXIgZmlyZXMuIFJlbWVtYmVyIHRoYXQgdGhp
        cyB2YXJpYWJsZSBoYXMKICAgICAgICAvLyBiZWVuIGNsb3NlZCBvdmVyIGJ5
        IHRoZSBvYnNlcnZlci4KICAgICAgICBvbGRDbGFzcyA9IGRhc2hlcml6ZWRD
        bGFzczsKICAgICAgfQoKICAgICAgdGhpcy5yZWdpc3Rlck9ic2VydmVyKHRo
        aXMsIHBhcnNlZFBhdGgucGF0aCwgb2JzZXJ2ZXIpOwogICAgICAvLyBSZW1v
        dmUgY2xhc3NOYW1lIHNvIHdoZW4gdGhlIHZpZXcgaXMgcmVyZW5kZXJlZCwK
        ICAgICAgLy8gdGhlIGNsYXNzTmFtZSBpcyBhZGRlZCBiYXNlZCBvbiBiaW5k
        aW5nIHJlZXZhbHVhdGlvbgogICAgICB0aGlzLm9uZSgnd2lsbENsZWFyUmVu
        ZGVyJywgZnVuY3Rpb24oKSB7CiAgICAgICAgaWYgKG9sZENsYXNzKSB7CiAg
        ICAgICAgICBjbGFzc05hbWVzLnJlbW92ZU9iamVjdChvbGRDbGFzcyk7CiAg
        ICAgICAgICBvbGRDbGFzcyA9IG51bGw7CiAgICAgICAgfQogICAgICB9KTsK
        CiAgICB9LCB0aGlzKTsKICB9LAoKICAvKioKICAgIEBwcml2YXRlCgogICAg
        SXRlcmF0ZXMgdGhyb3VnaCB0aGUgdmlldydzIGF0dHJpYnV0ZSBiaW5kaW5n
        cywgc2V0cyB1cCBvYnNlcnZlcnMgZm9yIGVhY2gsCiAgICB0aGVuIGFwcGxp
        ZXMgdGhlIGN1cnJlbnQgdmFsdWUgb2YgdGhlIGF0dHJpYnV0ZXMgdG8gdGhl
        IHBhc3NlZCByZW5kZXIgYnVmZmVyLgoKICAgIEBtZXRob2QgX2FwcGx5QXR0
        cmlidXRlQmluZGluZ3MKICAgIEBwYXJhbSB7RW1iZXIuUmVuZGVyQnVmZmVy
        fSBidWZmZXIKICAqLwogIF9hcHBseUF0dHJpYnV0ZUJpbmRpbmdzOiBmdW5j
        dGlvbihidWZmZXIsIGF0dHJpYnV0ZUJpbmRpbmdzKSB7CiAgICB2YXIgYXR0
        cmlidXRlVmFsdWUsIGVsZW07CgogICAgYV9mb3JFYWNoKGF0dHJpYnV0ZUJp
        bmRpbmdzLCBmdW5jdGlvbihiaW5kaW5nKSB7CiAgICAgIHZhciBzcGxpdCA9
        IGJpbmRpbmcuc3BsaXQoJzonKSwKICAgICAgICAgIHByb3BlcnR5ID0gc3Bs
        aXRbMF0sCiAgICAgICAgICBhdHRyaWJ1dGVOYW1lID0gc3BsaXRbMV0gfHwg
        cHJvcGVydHk7CgogICAgICAvLyBDcmVhdGUgYW4gb2JzZXJ2ZXIgdG8gYWRk
        L3JlbW92ZS9jaGFuZ2UgdGhlIGF0dHJpYnV0ZSBpZiB0aGUKICAgICAgLy8g
        SmF2YVNjcmlwdCBwcm9wZXJ0eSBjaGFuZ2VzLgogICAgICB2YXIgb2JzZXJ2
        ZXIgPSBmdW5jdGlvbigpIHsKICAgICAgICBlbGVtID0gdGhpcy4kKCk7Cgog
        ICAgICAgIGF0dHJpYnV0ZVZhbHVlID0gZ2V0KHRoaXMsIHByb3BlcnR5KTsK
        CiAgICAgICAgRW1iZXIuVmlldy5hcHBseUF0dHJpYnV0ZUJpbmRpbmdzKGVs
        ZW0sIGF0dHJpYnV0ZU5hbWUsIGF0dHJpYnV0ZVZhbHVlKTsKICAgICAgfTsK
        CiAgICAgIHRoaXMucmVnaXN0ZXJPYnNlcnZlcih0aGlzLCBwcm9wZXJ0eSwg
        b2JzZXJ2ZXIpOwoKICAgICAgLy8gRGV0ZXJtaW5lIHRoZSBjdXJyZW50IHZh
        bHVlIGFuZCBhZGQgaXQgdG8gdGhlIHJlbmRlciBidWZmZXIKICAgICAgLy8g
        aWYgbmVjZXNzYXJ5LgogICAgICBhdHRyaWJ1dGVWYWx1ZSA9IGdldCh0aGlz
        LCBwcm9wZXJ0eSk7CiAgICAgIEVtYmVyLlZpZXcuYXBwbHlBdHRyaWJ1dGVC
        aW5kaW5ncyhidWZmZXIsIGF0dHJpYnV0ZU5hbWUsIGF0dHJpYnV0ZVZhbHVl
        KTsKICAgIH0sIHRoaXMpOwogIH0sCgogIC8qKgogICAgQHByaXZhdGUKCiAg
        ICBHaXZlbiBhIHByb3BlcnR5IG5hbWUsIHJldHVybnMgYSBkYXNoZXJpemVk
        IHZlcnNpb24gb2YgdGhhdAogICAgcHJvcGVydHkgbmFtZSBpZiB0aGUgcHJv
        cGVydHkgZXZhbHVhdGVzIHRvIGEgbm9uLWZhbHN5IHZhbHVlLgoKICAgIEZv
        ciBleGFtcGxlLCBpZiB0aGUgdmlldyBoYXMgcHJvcGVydHkgYGlzVXJnZW50
        YCB0aGF0IGV2YWx1YXRlcyB0byB0cnVlLAogICAgcGFzc2luZyBgaXNVcmdl
        bnRgIHRvIHRoaXMgbWV0aG9kIHdpbGwgcmV0dXJuIGAiaXMtdXJnZW50ImAu
        CgogICAgQG1ldGhvZCBfY2xhc3NTdHJpbmdGb3JQcm9wZXJ0eQogICAgQHBh
        cmFtIHByb3BlcnR5CiAgKi8KICBfY2xhc3NTdHJpbmdGb3JQcm9wZXJ0eTog
        ZnVuY3Rpb24ocHJvcGVydHkpIHsKICAgIHZhciBwYXJzZWRQYXRoID0gRW1i
        ZXIuVmlldy5fcGFyc2VQcm9wZXJ0eVBhdGgocHJvcGVydHkpOwogICAgdmFy
        IHBhdGggPSBwYXJzZWRQYXRoLnBhdGg7CgogICAgdmFyIHZhbCA9IGdldCh0
        aGlzLCBwYXRoKTsKICAgIGlmICh2YWwgPT09IHVuZGVmaW5lZCAmJiBFbWJl
        ci5pc0dsb2JhbFBhdGgocGF0aCkpIHsKICAgICAgdmFsID0gZ2V0KEVtYmVy
        Lmxvb2t1cCwgcGF0aCk7CiAgICB9CgogICAgcmV0dXJuIEVtYmVyLlZpZXcu
        X2NsYXNzU3RyaW5nRm9yVmFsdWUocGF0aCwgdmFsLCBwYXJzZWRQYXRoLmNs
        YXNzTmFtZSwgcGFyc2VkUGF0aC5mYWxzeUNsYXNzTmFtZSk7CiAgfSwKCiAg
        Ly8gLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4u
        Li4uLi4uLi4uLi4uLi4uLgogIC8vIEVMRU1FTlQgU1VQUE9SVAogIC8vCgog
        IC8qKgogICAgUmV0dXJucyB0aGUgY3VycmVudCBET00gZWxlbWVudCBmb3Ig
        dGhlIHZpZXcuCgogICAgQHByb3BlcnR5IGVsZW1lbnQKICAgIEB0eXBlIERP
        TUVsZW1lbnQKICAqLwogIGVsZW1lbnQ6IEVtYmVyLmNvbXB1dGVkKGZ1bmN0
        aW9uKGtleSwgdmFsdWUpIHsKICAgIGlmICh2YWx1ZSAhPT0gdW5kZWZpbmVk
        KSB7CiAgICAgIHJldHVybiB0aGlzLmN1cnJlbnRTdGF0ZS5zZXRFbGVtZW50
        KHRoaXMsIHZhbHVlKTsKICAgIH0gZWxzZSB7CiAgICAgIHJldHVybiB0aGlz
        LmN1cnJlbnRTdGF0ZS5nZXRFbGVtZW50KHRoaXMpOwogICAgfQogIH0pLnBy
        b3BlcnR5KCdfcGFyZW50VmlldycpLAoKICAvKioKICAgIFJldHVybnMgYSBq
        UXVlcnkgb2JqZWN0IGZvciB0aGlzIHZpZXcncyBlbGVtZW50LiBJZiB5b3Ug
        cGFzcyBpbiBhIHNlbGVjdG9yCiAgICBzdHJpbmcsIHRoaXMgbWV0aG9kIHdp
        bGwgcmV0dXJuIGEgalF1ZXJ5IG9iamVjdCwgdXNpbmcgdGhlIGN1cnJlbnQg
        ZWxlbWVudAogICAgYXMgaXRzIGJ1ZmZlci4KCiAgICBGb3IgZXhhbXBsZSwg
        Y2FsbGluZyBgdmlldy4kKCdsaScpYCB3aWxsIHJldHVybiBhIGpRdWVyeSBv
        YmplY3QgY29udGFpbmluZwogICAgYWxsIG9mIHRoZSBgbGlgIGVsZW1lbnRz
        IGluc2lkZSB0aGUgRE9NIGVsZW1lbnQgb2YgdGhpcyB2aWV3LgoKICAgIEBt
        ZXRob2QgJAogICAgQHBhcmFtIHtTdHJpbmd9IFtzZWxlY3Rvcl0gYSBqUXVl
        cnktY29tcGF0aWJsZSBzZWxlY3RvciBzdHJpbmcKICAgIEByZXR1cm4ge2pR
        dWVyeX0gdGhlIGpRdWVyeSBvYmplY3QgZm9yIHRoZSBET00gbm9kZQogICov
        CiAgJDogZnVuY3Rpb24oc2VsKSB7CiAgICByZXR1cm4gdGhpcy5jdXJyZW50
        U3RhdGUuJCh0aGlzLCBzZWwpOwogIH0sCgogIG11dGF0ZUNoaWxkVmlld3M6
        IGZ1bmN0aW9uKGNhbGxiYWNrKSB7CiAgICB2YXIgY2hpbGRWaWV3cyA9IHRo
        aXMuX2NoaWxkVmlld3MsCiAgICAgICAgaWR4ID0gY2hpbGRWaWV3cy5sZW5n
        dGgsCiAgICAgICAgdmlldzsKCiAgICB3aGlsZSgtLWlkeCA+PSAwKSB7CiAg
        ICAgIHZpZXcgPSBjaGlsZFZpZXdzW2lkeF07CiAgICAgIGNhbGxiYWNrKHRo
        aXMsIHZpZXcsIGlkeCk7CiAgICB9CgogICAgcmV0dXJuIHRoaXM7CiAgfSwK
        CiAgZm9yRWFjaENoaWxkVmlldzogZnVuY3Rpb24oY2FsbGJhY2spIHsKICAg
        IHZhciBjaGlsZFZpZXdzID0gdGhpcy5fY2hpbGRWaWV3czsKCiAgICBpZiAo
        IWNoaWxkVmlld3MpIHsgcmV0dXJuIHRoaXM7IH0KCiAgICB2YXIgbGVuID0g
        Y2hpbGRWaWV3cy5sZW5ndGgsCiAgICAgICAgdmlldywgaWR4OwoKICAgIGZv
        ciAoaWR4ID0gMDsgaWR4IDwgbGVuOyBpZHgrKykgewogICAgICB2aWV3ID0g
        Y2hpbGRWaWV3c1tpZHhdOwogICAgICBjYWxsYmFjayh2aWV3KTsKICAgIH0K
        CiAgICByZXR1cm4gdGhpczsKICB9LAoKICAvKioKICAgIEFwcGVuZHMgdGhl
        IHZpZXcncyBlbGVtZW50IHRvIHRoZSBzcGVjaWZpZWQgcGFyZW50IGVsZW1l
        bnQuCgogICAgSWYgdGhlIHZpZXcgZG9lcyBub3QgaGF2ZSBhbiBIVE1MIHJl
        cHJlc2VudGF0aW9uIHlldCwgYGNyZWF0ZUVsZW1lbnQoKWAKICAgIHdpbGwg
        YmUgY2FsbGVkIGF1dG9tYXRpY2FsbHkuCgogICAgTm90ZSB0aGF0IHRoaXMg
        bWV0aG9kIGp1c3Qgc2NoZWR1bGVzIHRoZSB2aWV3IHRvIGJlIGFwcGVuZGVk
        OyB0aGUgRE9NCiAgICBlbGVtZW50IHdpbGwgbm90IGJlIGFwcGVuZGVkIHRv
        IHRoZSBnaXZlbiBlbGVtZW50IHVudGlsIGFsbCBiaW5kaW5ncyBoYXZlCiAg
        ICBmaW5pc2hlZCBzeW5jaHJvbml6aW5nLgoKICAgIFRoaXMgaXMgbm90IHR5
        cGljYWxseSBhIGZ1bmN0aW9uIHRoYXQgeW91IHdpbGwgbmVlZCB0byBjYWxs
        IGRpcmVjdGx5IHdoZW4KICAgIGJ1aWxkaW5nIHlvdXIgYXBwbGljYXRpb24u
        IFlvdSBtaWdodCBjb25zaWRlciB1c2luZyBgRW1iZXIuQ29udGFpbmVyVmll
        d2AKICAgIGluc3RlYWQuIElmIHlvdSBkbyBuZWVkIHRvIHVzZSBgYXBwZW5k
        VG9gLCBiZSBzdXJlIHRoYXQgdGhlIHRhcmdldCBlbGVtZW50CiAgICB5b3Ug
        YXJlIHByb3ZpZGluZyBpcyBhc3NvY2lhdGVkIHdpdGggYW4gYEVtYmVyLkFw
        cGxpY2F0aW9uYCBhbmQgZG9lcyBub3QKICAgIGhhdmUgYW4gYW5jZXN0b3Ig
        ZWxlbWVudCB0aGF0IGlzIGFzc29jaWF0ZWQgd2l0aCBhbiBFbWJlciB2aWV3
        LgoKICAgIEBtZXRob2QgYXBwZW5kVG8KICAgIEBwYXJhbSB7U3RyaW5nfERP
        TUVsZW1lbnR8alF1ZXJ5fSBBIHNlbGVjdG9yLCBlbGVtZW50LCBIVE1MIHN0
        cmluZywgb3IgalF1ZXJ5IG9iamVjdAogICAgQHJldHVybiB7RW1iZXIuVmll
        d30gcmVjZWl2ZXIKICAqLwogIGFwcGVuZFRvOiBmdW5jdGlvbih0YXJnZXQp
        IHsKICAgIC8vIFNjaGVkdWxlIHRoZSBET00gZWxlbWVudCB0byBiZSBjcmVh
        dGVkIGFuZCBhcHBlbmRlZCB0byB0aGUgZ2l2ZW4KICAgIC8vIGVsZW1lbnQg
        YWZ0ZXIgYmluZGluZ3MgaGF2ZSBzeW5jaHJvbml6ZWQuCiAgICB0aGlzLl9p
        bnNlcnRFbGVtZW50TGF0ZXIoZnVuY3Rpb24oKSB7CiAgICAgIEVtYmVyLmFz
        c2VydCgiWW91IHRyaWVkIHRvIGFwcGVuZCB0byAoIiArIHRhcmdldCArICIp
        IGJ1dCB0aGF0IGlzbid0IGluIHRoZSBET00iLCBFbWJlci4kKHRhcmdldCku
        bGVuZ3RoID4gMCk7CiAgICAgIEVtYmVyLmFzc2VydCgiWW91IGNhbm5vdCBh
        cHBlbmQgdG8gYW4gZXhpc3RpbmcgRW1iZXIuVmlldy4gQ29uc2lkZXIgdXNp
        bmcgRW1iZXIuQ29udGFpbmVyVmlldyBpbnN0ZWFkLiIsICFFbWJlci4kKHRh
        cmdldCkuaXMoJy5lbWJlci12aWV3JykgJiYgIUVtYmVyLiQodGFyZ2V0KS5w
        YXJlbnRzKCkuaXMoJy5lbWJlci12aWV3JykpOwogICAgICB0aGlzLiQoKS5h
        cHBlbmRUbyh0YXJnZXQpOwogICAgfSk7CgogICAgcmV0dXJuIHRoaXM7CiAg
        fSwKCiAgLyoqCiAgICBSZXBsYWNlcyB0aGUgY29udGVudCBvZiB0aGUgc3Bl
        Y2lmaWVkIHBhcmVudCBlbGVtZW50IHdpdGggdGhpcyB2aWV3J3MKICAgIGVs
        ZW1lbnQuIElmIHRoZSB2aWV3IGRvZXMgbm90IGhhdmUgYW4gSFRNTCByZXBy
        ZXNlbnRhdGlvbiB5ZXQsCiAgICBgY3JlYXRlRWxlbWVudCgpYCB3aWxsIGJl
        IGNhbGxlZCBhdXRvbWF0aWNhbGx5LgoKICAgIE5vdGUgdGhhdCB0aGlzIG1l
        dGhvZCBqdXN0IHNjaGVkdWxlcyB0aGUgdmlldyB0byBiZSBhcHBlbmRlZDsg
        dGhlIERPTQogICAgZWxlbWVudCB3aWxsIG5vdCBiZSBhcHBlbmRlZCB0byB0
        aGUgZ2l2ZW4gZWxlbWVudCB1bnRpbCBhbGwgYmluZGluZ3MgaGF2ZQogICAg
        ZmluaXNoZWQgc3luY2hyb25pemluZwoKICAgIEBtZXRob2QgcmVwbGFjZUlu
        CiAgICBAcGFyYW0ge1N0cmluZ3xET01FbGVtZW50fGpRdWVyeX0gQSBzZWxl
        Y3RvciwgZWxlbWVudCwgSFRNTCBzdHJpbmcsIG9yIGpRdWVyeSBvYmplY3QK
        ICAgIEByZXR1cm4ge0VtYmVyLlZpZXd9IHJlY2VpdmVkCiAgKi8KICByZXBs
        YWNlSW46IGZ1bmN0aW9uKHRhcmdldCkgewogICAgRW1iZXIuYXNzZXJ0KCJZ
        b3UgdHJpZWQgdG8gcmVwbGFjZSBpbiAoIiArIHRhcmdldCArICIpIGJ1dCB0
        aGF0IGlzbid0IGluIHRoZSBET00iLCBFbWJlci4kKHRhcmdldCkubGVuZ3Ro
        ID4gMCk7CiAgICBFbWJlci5hc3NlcnQoIllvdSBjYW5ub3QgcmVwbGFjZSBh
        biBleGlzdGluZyBFbWJlci5WaWV3LiBDb25zaWRlciB1c2luZyBFbWJlci5D
        b250YWluZXJWaWV3IGluc3RlYWQuIiwgIUVtYmVyLiQodGFyZ2V0KS5pcygn
        LmVtYmVyLXZpZXcnKSAmJiAhRW1iZXIuJCh0YXJnZXQpLnBhcmVudHMoKS5p
        cygnLmVtYmVyLXZpZXcnKSk7CgogICAgdGhpcy5faW5zZXJ0RWxlbWVudExh
        dGVyKGZ1bmN0aW9uKCkgewogICAgICBFbWJlci4kKHRhcmdldCkuZW1wdHko
        KTsKICAgICAgdGhpcy4kKCkuYXBwZW5kVG8odGFyZ2V0KTsKICAgIH0pOwoK
        ICAgIHJldHVybiB0aGlzOwogIH0sCgogIC8qKgogICAgQHByaXZhdGUKCiAg
        ICBTY2hlZHVsZXMgYSBET00gb3BlcmF0aW9uIHRvIG9jY3VyIGR1cmluZyB0
        aGUgbmV4dCByZW5kZXIgcGhhc2UuIFRoaXMKICAgIGVuc3VyZXMgdGhhdCBh
        bGwgYmluZGluZ3MgaGF2ZSBmaW5pc2hlZCBzeW5jaHJvbml6aW5nIGJlZm9y
        ZSB0aGUgdmlldyBpcwogICAgcmVuZGVyZWQuCgogICAgVG8gdXNlLCBwYXNz
        IGEgZnVuY3Rpb24gdGhhdCBwZXJmb3JtcyBhIERPTSBvcGVyYXRpb24uCgog
        ICAgQmVmb3JlIHlvdXIgZnVuY3Rpb24gaXMgY2FsbGVkLCB0aGlzIHZpZXcg
        YW5kIGFsbCBjaGlsZCB2aWV3cyB3aWxsIHJlY2VpdmUKICAgIHRoZSBgd2ls
        bEluc2VydEVsZW1lbnRgIGV2ZW50LiBBZnRlciB5b3VyIGZ1bmN0aW9uIGlz
        IGludm9rZWQsIHRoaXMgdmlldwogICAgYW5kIGFsbCBvZiBpdHMgY2hpbGQg
        dmlld3Mgd2lsbCByZWNlaXZlIHRoZSBgZGlkSW5zZXJ0RWxlbWVudGAgZXZl
        bnQuCgogICAgYGBgamF2YXNjcmlwdAogICAgdmlldy5faW5zZXJ0RWxlbWVu
        dExhdGVyKGZ1bmN0aW9uKCkgewogICAgICB0aGlzLmNyZWF0ZUVsZW1lbnQo
        KTsKICAgICAgdGhpcy4kKCkuYXBwZW5kVG8oJ2JvZHknKTsKICAgIH0pOwog
        ICAgYGBgCgogICAgQG1ldGhvZCBfaW5zZXJ0RWxlbWVudExhdGVyCiAgICBA
        cGFyYW0ge0Z1bmN0aW9ufSBmbiB0aGUgZnVuY3Rpb24gdGhhdCBpbnNlcnRz
        IHRoZSBlbGVtZW50IGludG8gdGhlIERPTQogICovCiAgX2luc2VydEVsZW1l
        bnRMYXRlcjogZnVuY3Rpb24oZm4pIHsKICAgIHRoaXMuX3NjaGVkdWxlZElu
        c2VydCA9IEVtYmVyLnJ1bi5zY2hlZHVsZU9uY2UoJ3JlbmRlcicsIHRoaXMs
        ICdfaW5zZXJ0RWxlbWVudCcsIGZuKTsKICB9LAoKICBfaW5zZXJ0RWxlbWVu
        dDogZnVuY3Rpb24gKGZuKSB7CiAgICB0aGlzLl9zY2hlZHVsZWRJbnNlcnQg
        PSBudWxsOwogICAgdGhpcy5jdXJyZW50U3RhdGUuaW5zZXJ0RWxlbWVudCh0
        aGlzLCBmbik7CiAgfSwKCiAgLyoqCiAgICBBcHBlbmRzIHRoZSB2aWV3J3Mg
        ZWxlbWVudCB0byB0aGUgZG9jdW1lbnQgYm9keS4gSWYgdGhlIHZpZXcgZG9l
        cwogICAgbm90IGhhdmUgYW4gSFRNTCByZXByZXNlbnRhdGlvbiB5ZXQsIGBj
        cmVhdGVFbGVtZW50KClgIHdpbGwgYmUgY2FsbGVkCiAgICBhdXRvbWF0aWNh
        bGx5LgoKICAgIElmIHlvdXIgYXBwbGljYXRpb24gdXNlcyB0aGUgYHJvb3RF
        bGVtZW50YCBwcm9wZXJ0eSwgeW91IG11c3QgYXBwZW5kCiAgICB0aGUgdmll
        dyB3aXRoaW4gdGhhdCBlbGVtZW50LiBSZW5kZXJpbmcgdmlld3Mgb3V0c2lk
        ZSBvZiB0aGUgYHJvb3RFbGVtZW50YAogICAgaXMgbm90IHN1cHBvcnRlZC4K
        CiAgICBOb3RlIHRoYXQgdGhpcyBtZXRob2QganVzdCBzY2hlZHVsZXMgdGhl
        IHZpZXcgdG8gYmUgYXBwZW5kZWQ7IHRoZSBET00KICAgIGVsZW1lbnQgd2ls
        bCBub3QgYmUgYXBwZW5kZWQgdG8gdGhlIGRvY3VtZW50IGJvZHkgdW50aWwg
        YWxsIGJpbmRpbmdzIGhhdmUKICAgIGZpbmlzaGVkIHN5bmNocm9uaXppbmcu
        CgogICAgQG1ldGhvZCBhcHBlbmQKICAgIEByZXR1cm4ge0VtYmVyLlZpZXd9
        IHJlY2VpdmVyCiAgKi8KICBhcHBlbmQ6IGZ1bmN0aW9uKCkgewogICAgcmV0
        dXJuIHRoaXMuYXBwZW5kVG8oZG9jdW1lbnQuYm9keSk7CiAgfSwKCiAgLyoq
        CiAgICBSZW1vdmVzIHRoZSB2aWV3J3MgZWxlbWVudCBmcm9tIHRoZSBlbGVt
        ZW50IHRvIHdoaWNoIGl0IGlzIGF0dGFjaGVkLgoKICAgIEBtZXRob2QgcmVt
        b3ZlCiAgICBAcmV0dXJuIHtFbWJlci5WaWV3fSByZWNlaXZlcgogICovCiAg
        cmVtb3ZlOiBmdW5jdGlvbigpIHsKICAgIC8vIFdoYXQgd2Ugc2hvdWxkIHJl
        YWxseSBkbyBoZXJlIGlzIHdhaXQgdW50aWwgdGhlIGVuZCBvZiB0aGUgcnVu
        IGxvb3AKICAgIC8vIHRvIGRldGVybWluZSBpZiB0aGUgZWxlbWVudCBoYXMg
        YmVlbiByZS1hcHBlbmRlZCB0byBhIGRpZmZlcmVudAogICAgLy8gZWxlbWVu
        dC4KICAgIC8vIEluIHRoZSBpbnRlcmltLCB3ZSB3aWxsIGp1c3QgcmUtcmVu
        ZGVyIGlmIHRoYXQgaGFwcGVucy4gSXQgaXMgbW9yZQogICAgLy8gaW1wb3J0
        YW50IHRoYW4gZWxlbWVudHMgZ2V0IGdhcmJhZ2UgY29sbGVjdGVkLgogICAg
        aWYgKCF0aGlzLnJlbW92ZWRGcm9tRE9NKSB7IHRoaXMuZGVzdHJveUVsZW1l
        bnQoKTsgfQogICAgdGhpcy5pbnZva2VSZWN1cnNpdmVseShmdW5jdGlvbih2
        aWV3KSB7CiAgICAgIGlmICh2aWV3LmNsZWFyUmVuZGVyZWRDaGlsZHJlbikg
        eyB2aWV3LmNsZWFyUmVuZGVyZWRDaGlsZHJlbigpOyB9CiAgICB9KTsKICB9
        LAoKICBlbGVtZW50SWQ6IG51bGwsCgogIC8qKgogICAgQXR0ZW1wdHMgdG8g
        ZGlzY292ZXIgdGhlIGVsZW1lbnQgaW4gdGhlIHBhcmVudCBlbGVtZW50LiBU
        aGUgZGVmYXVsdAogICAgaW1wbGVtZW50YXRpb24gbG9va3MgZm9yIGFuIGVs
        ZW1lbnQgd2l0aCBhbiBJRCBvZiBgZWxlbWVudElkYCAob3IgdGhlCiAgICB2
        aWV3J3MgZ3VpZCBpZiBgZWxlbWVudElkYCBpcyBudWxsKS4gWW91IGNhbiBv
        dmVycmlkZSB0aGlzIG1ldGhvZCB0bwogICAgcHJvdmlkZSB5b3VyIG93biBm
        b3JtIG9mIGxvb2t1cC4gRm9yIGV4YW1wbGUsIGlmIHlvdSB3YW50IHRvIGRp
        c2NvdmVyIHlvdXIKICAgIGVsZW1lbnQgdXNpbmcgYSBDU1MgY2xhc3MgbmFt
        ZSBpbnN0ZWFkIG9mIGFuIElELgoKICAgIEBtZXRob2QgZmluZEVsZW1lbnRJ
        blBhcmVudEVsZW1lbnQKICAgIEBwYXJhbSB7RE9NRWxlbWVudH0gcGFyZW50
        RWxlbWVudCBUaGUgcGFyZW50J3MgRE9NIGVsZW1lbnQKICAgIEByZXR1cm4g
        e0RPTUVsZW1lbnR9IFRoZSBkaXNjb3ZlcmVkIGVsZW1lbnQKICAqLwogIGZp
        bmRFbGVtZW50SW5QYXJlbnRFbGVtZW50OiBmdW5jdGlvbihwYXJlbnRFbGVt
        KSB7CiAgICB2YXIgaWQgPSAiIyIgKyB0aGlzLmVsZW1lbnRJZDsKICAgIHJl
        dHVybiBFbWJlci4kKGlkKVswXSB8fCBFbWJlci4kKGlkLCBwYXJlbnRFbGVt
        KVswXTsKICB9LAoKICAvKioKICAgIENyZWF0ZXMgYSBET00gcmVwcmVzZW50
        YXRpb24gb2YgdGhlIHZpZXcgYW5kIGFsbCBvZiBpdHMKICAgIGNoaWxkIHZp
        ZXdzIGJ5IHJlY3Vyc2l2ZWx5IGNhbGxpbmcgdGhlIGByZW5kZXIoKWAgbWV0
        aG9kLgoKICAgIEFmdGVyIHRoZSBlbGVtZW50IGhhcyBiZWVuIGNyZWF0ZWQs
        IGBkaWRJbnNlcnRFbGVtZW50YCB3aWxsCiAgICBiZSBjYWxsZWQgb24gdGhp
        cyB2aWV3IGFuZCBhbGwgb2YgaXRzIGNoaWxkIHZpZXdzLgoKICAgIEBtZXRo
        b2QgY3JlYXRlRWxlbWVudAogICAgQHJldHVybiB7RW1iZXIuVmlld30gcmVj
        ZWl2ZXIKICAqLwogIGNyZWF0ZUVsZW1lbnQ6IGZ1bmN0aW9uKCkgewogICAg
        aWYgKGdldCh0aGlzLCAnZWxlbWVudCcpKSB7IHJldHVybiB0aGlzOyB9Cgog
        ICAgdmFyIGJ1ZmZlciA9IHRoaXMucmVuZGVyVG9CdWZmZXIoKTsKICAgIHNl
        dCh0aGlzLCAnZWxlbWVudCcsIGJ1ZmZlci5lbGVtZW50KCkpOwoKICAgIHJl
        dHVybiB0aGlzOwogIH0sCgogIC8qKgogICAgQ2FsbGVkIHdoZW4gYSB2aWV3
        IGlzIGdvaW5nIHRvIGluc2VydCBhbiBlbGVtZW50IGludG8gdGhlIERPTS4K
        CiAgICBAZXZlbnQgd2lsbEluc2VydEVsZW1lbnQKICAqLwogIHdpbGxJbnNl
        cnRFbGVtZW50OiBFbWJlci5LLAoKICAvKioKICAgIENhbGxlZCB3aGVuIHRo
        ZSBlbGVtZW50IG9mIHRoZSB2aWV3IGhhcyBiZWVuIGluc2VydGVkIGludG8g
        dGhlIERPTQogICAgb3IgYWZ0ZXIgdGhlIHZpZXcgd2FzIHJlLXJlbmRlcmVk
        LiBPdmVycmlkZSB0aGlzIGZ1bmN0aW9uIHRvIGRvIGFueQogICAgc2V0IHVw
        IHRoYXQgcmVxdWlyZXMgYW4gZWxlbWVudCBpbiB0aGUgZG9jdW1lbnQgYm9k
        eS4KCiAgICBAZXZlbnQgZGlkSW5zZXJ0RWxlbWVudAogICovCiAgZGlkSW5z
        ZXJ0RWxlbWVudDogRW1iZXIuSywKCiAgLyoqCiAgICBDYWxsZWQgd2hlbiB0
        aGUgdmlldyBpcyBhYm91dCB0byByZXJlbmRlciwgYnV0IGJlZm9yZSBhbnl0
        aGluZyBoYXMKICAgIGJlZW4gdG9ybiBkb3duLiBUaGlzIGlzIGEgZ29vZCBv
        cHBvcnR1bml0eSB0byB0ZWFyIGRvd24gYW55IG1hbnVhbAogICAgb2JzZXJ2
        ZXJzIHlvdSBoYXZlIGluc3RhbGxlZCBiYXNlZCBvbiB0aGUgRE9NIHN0YXRl
        CgogICAgQGV2ZW50IHdpbGxDbGVhclJlbmRlcgogICovCiAgd2lsbENsZWFy
        UmVuZGVyOiBFbWJlci5LLAoKICAvKioKICAgIEBwcml2YXRlCgogICAgUnVu
        IHRoaXMgY2FsbGJhY2sgb24gdGhlIGN1cnJlbnQgdmlldyAodW5sZXNzIGlu
        Y2x1ZGVTZWxmIGlzIGZhbHNlKSBhbmQgcmVjdXJzaXZlbHkgb24gY2hpbGQg
        dmlld3MuCgogICAgQG1ldGhvZCBpbnZva2VSZWN1cnNpdmVseQogICAgQHBh
        cmFtIGZuIHtGdW5jdGlvbn0KICAgIEBwYXJhbSBpbmNsdWRlU2VsZiAob3B0
        aW9uYWwsIGRlZmF1bHQgdHJ1ZSkKICAqLwogIGludm9rZVJlY3Vyc2l2ZWx5
        OiBmdW5jdGlvbihmbiwgaW5jbHVkZVNlbGYpIHsKICAgIHZhciBjaGlsZFZp
        ZXdzID0gKGluY2x1ZGVTZWxmID09PSBmYWxzZSkgPyB0aGlzLl9jaGlsZFZp
        ZXdzIDogW3RoaXNdOwogICAgdmFyIGN1cnJlbnRWaWV3cywgdmlldywgY3Vy
        cmVudENoaWxkVmlld3M7CgogICAgd2hpbGUgKGNoaWxkVmlld3MubGVuZ3Ro
        KSB7CiAgICAgIGN1cnJlbnRWaWV3cyA9IGNoaWxkVmlld3Muc2xpY2UoKTsK
        ICAgICAgY2hpbGRWaWV3cyA9IFtdOwoKICAgICAgZm9yICh2YXIgaT0wLCBs
        PWN1cnJlbnRWaWV3cy5sZW5ndGg7IGk8bDsgaSsrKSB7CiAgICAgICAgdmll
        dyA9IGN1cnJlbnRWaWV3c1tpXTsKICAgICAgICBjdXJyZW50Q2hpbGRWaWV3
        cyA9IHZpZXcuX2NoaWxkVmlld3MgPyB2aWV3Ll9jaGlsZFZpZXdzLnNsaWNl
        KDApIDogbnVsbDsKICAgICAgICBmbih2aWV3KTsKICAgICAgICBpZiAoY3Vy
        cmVudENoaWxkVmlld3MpIHsKICAgICAgICAgIGNoaWxkVmlld3MucHVzaC5h
        cHBseShjaGlsZFZpZXdzLCBjdXJyZW50Q2hpbGRWaWV3cyk7CiAgICAgICAg
        fQogICAgICB9CiAgICB9CiAgfSwKCiAgdHJpZ2dlclJlY3Vyc2l2ZWx5OiBm
        dW5jdGlvbihldmVudE5hbWUpIHsKICAgIHZhciBjaGlsZFZpZXdzID0gW3Ro
        aXNdLCBjdXJyZW50Vmlld3MsIHZpZXcsIGN1cnJlbnRDaGlsZFZpZXdzOwoK
        ICAgIHdoaWxlIChjaGlsZFZpZXdzLmxlbmd0aCkgewogICAgICBjdXJyZW50
        Vmlld3MgPSBjaGlsZFZpZXdzLnNsaWNlKCk7CiAgICAgIGNoaWxkVmlld3Mg
        PSBbXTsKCiAgICAgIGZvciAodmFyIGk9MCwgbD1jdXJyZW50Vmlld3MubGVu
        Z3RoOyBpPGw7IGkrKykgewogICAgICAgIHZpZXcgPSBjdXJyZW50Vmlld3Nb
        aV07CiAgICAgICAgY3VycmVudENoaWxkVmlld3MgPSB2aWV3Ll9jaGlsZFZp
        ZXdzID8gdmlldy5fY2hpbGRWaWV3cy5zbGljZSgwKSA6IG51bGw7CiAgICAg
        ICAgaWYgKHZpZXcudHJpZ2dlcikgeyB2aWV3LnRyaWdnZXIoZXZlbnROYW1l
        KTsgfQogICAgICAgIGlmIChjdXJyZW50Q2hpbGRWaWV3cykgewogICAgICAg
        ICAgY2hpbGRWaWV3cy5wdXNoLmFwcGx5KGNoaWxkVmlld3MsIGN1cnJlbnRD
        aGlsZFZpZXdzKTsKICAgICAgICB9CgogICAgICB9CiAgICB9CiAgfSwKCiAg
        dmlld0hpZXJhcmNoeUNvbGxlY3Rpb246IGZ1bmN0aW9uKCkgewogICAgdmFy
        IGN1cnJlbnRWaWV3LCB2aWV3Q29sbGVjdGlvbiA9IG5ldyBWaWV3Q29sbGVj
        dGlvbihbdGhpc10pOwoKICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdmlld0Nv
        bGxlY3Rpb24ubGVuZ3RoOyBpKyspIHsKICAgICAgY3VycmVudFZpZXcgPSB2
        aWV3Q29sbGVjdGlvbi5vYmplY3RBdChpKTsKICAgICAgaWYgKGN1cnJlbnRW
        aWV3Ll9jaGlsZFZpZXdzKSB7CiAgICAgICAgdmlld0NvbGxlY3Rpb24ucHVz
        aC5hcHBseSh2aWV3Q29sbGVjdGlvbiwgY3VycmVudFZpZXcuX2NoaWxkVmll
        d3MpOwogICAgICB9CiAgICB9CgogICAgcmV0dXJuIHZpZXdDb2xsZWN0aW9u
        OwogIH0sCgogIC8qKgogICAgRGVzdHJveXMgYW55IGV4aXN0aW5nIGVsZW1l
        bnQgYWxvbmcgd2l0aCB0aGUgZWxlbWVudCBmb3IgYW55IGNoaWxkIHZpZXdz
        CiAgICBhcyB3ZWxsLiBJZiB0aGUgdmlldyBkb2VzIG5vdCBjdXJyZW50bHkg
        aGF2ZSBhIGVsZW1lbnQsIHRoZW4gdGhpcyBtZXRob2QKICAgIHdpbGwgZG8g
        bm90aGluZy4KCiAgICBJZiB5b3UgaW1wbGVtZW50IGB3aWxsRGVzdHJveUVs
        ZW1lbnQoKWAgb24geW91ciB2aWV3LCB0aGVuIHRoaXMgbWV0aG9kIHdpbGwK
        ICAgIGJlIGludm9rZWQgb24geW91ciB2aWV3IGJlZm9yZSB5b3VyIGVsZW1l
        bnQgaXMgZGVzdHJveWVkIHRvIGdpdmUgeW91IGEKICAgIGNoYW5jZSB0byBj
        bGVhbiB1cCBhbnkgZXZlbnQgaGFuZGxlcnMsIGV0Yy4KCiAgICBJZiB5b3Ug
        d3JpdGUgYSBgd2lsbERlc3Ryb3lFbGVtZW50KClgIGhhbmRsZXIsIHlvdSBj
        YW4gYXNzdW1lIHRoYXQgeW91cgogICAgYGRpZEluc2VydEVsZW1lbnQoKWAg
        aGFuZGxlciB3YXMgY2FsbGVkIGVhcmxpZXIgZm9yIHRoZSBzYW1lIGVsZW1l
        bnQuCgogICAgWW91IHNob3VsZCBub3QgY2FsbCBvciBvdmVycmlkZSB0aGlz
        IG1ldGhvZCB5b3Vyc2VsZiwgYnV0IHlvdSBtYXkKICAgIHdhbnQgdG8gaW1w
        bGVtZW50IHRoZSBhYm92ZSBjYWxsYmFja3MuCgogICAgQG1ldGhvZCBkZXN0
        cm95RWxlbWVudAogICAgQHJldHVybiB7RW1iZXIuVmlld30gcmVjZWl2ZXIK
        ICAqLwogIGRlc3Ryb3lFbGVtZW50OiBmdW5jdGlvbigpIHsKICAgIHJldHVy
        biB0aGlzLmN1cnJlbnRTdGF0ZS5kZXN0cm95RWxlbWVudCh0aGlzKTsKICB9
        LAoKICAvKioKICAgIENhbGxlZCB3aGVuIHRoZSBlbGVtZW50IG9mIHRoZSB2
        aWV3IGlzIGdvaW5nIHRvIGJlIGRlc3Ryb3llZC4gT3ZlcnJpZGUKICAgIHRo
        aXMgZnVuY3Rpb24gdG8gZG8gYW55IHRlYXJkb3duIHRoYXQgcmVxdWlyZXMg
        YW4gZWxlbWVudCwgbGlrZSByZW1vdmluZwogICAgZXZlbnQgbGlzdGVuZXJz
        LgoKICAgIEBldmVudCB3aWxsRGVzdHJveUVsZW1lbnQKICAqLwogIHdpbGxE
        ZXN0cm95RWxlbWVudDogRW1iZXIuSywKCiAgLyoqCiAgICBAcHJpdmF0ZQoK
        ICAgIFRyaWdnZXJzIHRoZSBgd2lsbERlc3Ryb3lFbGVtZW50YCBldmVudCAo
        d2hpY2ggaW52b2tlcyB0aGUKICAgIGB3aWxsRGVzdHJveUVsZW1lbnQoKWAg
        bWV0aG9kIGlmIGl0IGV4aXN0cykgb24gdGhpcyB2aWV3IGFuZCBhbGwgY2hp
        bGQKICAgIHZpZXdzLgoKICAgIEJlZm9yZSB0cmlnZ2VyaW5nIGB3aWxsRGVz
        dHJveUVsZW1lbnRgLCBpdCBmaXJzdCB0cmlnZ2VycyB0aGUKICAgIGB3aWxs
        Q2xlYXJSZW5kZXJgIGV2ZW50IHJlY3Vyc2l2ZWx5LgoKICAgIEBtZXRob2Qg
        X25vdGlmeVdpbGxEZXN0cm95RWxlbWVudAogICovCiAgX25vdGlmeVdpbGxE
        ZXN0cm95RWxlbWVudDogZnVuY3Rpb24oKSB7CiAgICB2YXIgdmlld0NvbGxl
        Y3Rpb24gPSB0aGlzLnZpZXdIaWVyYXJjaHlDb2xsZWN0aW9uKCk7CiAgICB2
        aWV3Q29sbGVjdGlvbi50cmlnZ2VyKCd3aWxsQ2xlYXJSZW5kZXInKTsKICAg
        IHZpZXdDb2xsZWN0aW9uLnRyaWdnZXIoJ3dpbGxEZXN0cm95RWxlbWVudCcp
        OwogICAgcmV0dXJuIHZpZXdDb2xsZWN0aW9uOwogIH0sCgogIC8qKgogICAg
        QHByaXZhdGUKCiAgICBJZiB0aGlzIHZpZXcncyBlbGVtZW50IGNoYW5nZXMs
        IHdlIG5lZWQgdG8gaW52YWxpZGF0ZSB0aGUgY2FjaGVzIG9mIG91cgogICAg
        Y2hpbGQgdmlld3Mgc28gdGhhdCB3ZSBkbyBub3QgcmV0YWluIHJlZmVyZW5j
        ZXMgdG8gRE9NIGVsZW1lbnRzIHRoYXQgYXJlCiAgICBubyBsb25nZXIgbmVl
        ZGVkLgoKICAgIEBtZXRob2QgX2VsZW1lbnREaWRDaGFuZ2UKICAqLwogIF9l
        bGVtZW50RGlkQ2hhbmdlOiBFbWJlci5vYnNlcnZlcihmdW5jdGlvbigpIHsK
        ICAgIHRoaXMuZm9yRWFjaENoaWxkVmlldyhmdW5jdGlvbih2aWV3KSB7CiAg
        ICAgIGRlbGV0ZSBtZXRhKHZpZXcpLmNhY2hlLmVsZW1lbnQ7CiAgICB9KTsK
        ICB9LCAnZWxlbWVudCcpLAoKICAvKioKICAgIENhbGxlZCB3aGVuIHRoZSBw
        YXJlbnRWaWV3IHByb3BlcnR5IGhhcyBjaGFuZ2VkLgoKICAgIEBldmVudCBw
        YXJlbnRWaWV3RGlkQ2hhbmdlCiAgKi8KICBwYXJlbnRWaWV3RGlkQ2hhbmdl
        OiBFbWJlci5LLAoKICBpbnN0cnVtZW50TmFtZTogJ3ZpZXcnLAoKICBpbnN0
        cnVtZW50RGV0YWlsczogZnVuY3Rpb24oaGFzaCkgewogICAgaGFzaC50ZW1w
        bGF0ZSA9IGdldCh0aGlzLCAndGVtcGxhdGVOYW1lJyk7CiAgICB0aGlzLl9z
        dXBlcihoYXNoKTsKICB9LAoKICBfcmVuZGVyVG9CdWZmZXI6IGZ1bmN0aW9u
        KHBhcmVudEJ1ZmZlciwgYnVmZmVyT3BlcmF0aW9uKSB7CiAgICB0aGlzLmxl
        bmd0aEJlZm9yZVJlbmRlciA9IHRoaXMuX2NoaWxkVmlld3MubGVuZ3RoOwog
        ICAgdmFyIGJ1ZmZlciA9IHRoaXMuX3N1cGVyKHBhcmVudEJ1ZmZlciwgYnVm
        ZmVyT3BlcmF0aW9uKTsKICAgIHRoaXMubGVuZ3RoQWZ0ZXJSZW5kZXIgPSB0
        aGlzLl9jaGlsZFZpZXdzLmxlbmd0aDsKCiAgICByZXR1cm4gYnVmZmVyOwog
        IH0sCgogIHJlbmRlclRvQnVmZmVySWZOZWVkZWQ6IGZ1bmN0aW9uIChidWZm
        ZXIpIHsKICAgIHJldHVybiB0aGlzLmN1cnJlbnRTdGF0ZS5yZW5kZXJUb0J1
        ZmZlcklmTmVlZGVkKHRoaXMsIGJ1ZmZlcik7CiAgfSwKCiAgYmVmb3JlUmVu
        ZGVyOiBmdW5jdGlvbihidWZmZXIpIHsKICAgIHRoaXMuYXBwbHlBdHRyaWJ1
        dGVzVG9CdWZmZXIoYnVmZmVyKTsKICAgIGJ1ZmZlci5wdXNoT3BlbmluZ1Rh
        ZygpOwogIH0sCgogIGFmdGVyUmVuZGVyOiBmdW5jdGlvbihidWZmZXIpIHsK
        ICAgIGJ1ZmZlci5wdXNoQ2xvc2luZ1RhZygpOwogIH0sCgogIGFwcGx5QXR0
        cmlidXRlc1RvQnVmZmVyOiBmdW5jdGlvbihidWZmZXIpIHsKICAgIC8vIENy
        ZWF0ZXMgb2JzZXJ2ZXJzIGZvciBhbGwgcmVnaXN0ZXJlZCBjbGFzcyBuYW1l
        IGFuZCBhdHRyaWJ1dGUgYmluZGluZ3MsCiAgICAvLyB0aGVuIGFkZHMgdGhl
        bSB0byB0aGUgZWxlbWVudC4KICAgIHZhciBjbGFzc05hbWVCaW5kaW5ncyA9
        IGdldCh0aGlzLCAnY2xhc3NOYW1lQmluZGluZ3MnKTsKICAgIGlmIChjbGFz
        c05hbWVCaW5kaW5ncy5sZW5ndGgpIHsKICAgICAgdGhpcy5fYXBwbHlDbGFz
        c05hbWVCaW5kaW5ncyhjbGFzc05hbWVCaW5kaW5ncyk7CiAgICB9CgogICAg
        Ly8gUGFzcyB0aGUgcmVuZGVyIGJ1ZmZlciBzbyB0aGUgbWV0aG9kIGNhbiBh
        cHBseSBhdHRyaWJ1dGVzIGRpcmVjdGx5LgogICAgLy8gVGhpcyBpc24ndCBu
        ZWVkZWQgZm9yIGNsYXNzIG5hbWUgYmluZGluZ3MgYmVjYXVzZSB0aGV5IHVz
        ZSB0aGUKICAgIC8vIGV4aXN0aW5nIGNsYXNzTmFtZXMgaW5mcmFzdHJ1Y3R1
        cmUuCiAgICB2YXIgYXR0cmlidXRlQmluZGluZ3MgPSBnZXQodGhpcywgJ2F0
        dHJpYnV0ZUJpbmRpbmdzJyk7CiAgICBpZiAoYXR0cmlidXRlQmluZGluZ3Mu
        bGVuZ3RoKSB7CiAgICAgIHRoaXMuX2FwcGx5QXR0cmlidXRlQmluZGluZ3Mo
        YnVmZmVyLCBhdHRyaWJ1dGVCaW5kaW5ncyk7CiAgICB9CgogICAgYnVmZmVy
        LnNldENsYXNzZXModGhpcy5jbGFzc05hbWVzKTsKICAgIGJ1ZmZlci5pZCh0
        aGlzLmVsZW1lbnRJZCk7CgogICAgdmFyIHJvbGUgPSBnZXQodGhpcywgJ2Fy
        aWFSb2xlJyk7CiAgICBpZiAocm9sZSkgewogICAgICBidWZmZXIuYXR0cign
        cm9sZScsIHJvbGUpOwogICAgfQoKICAgIGlmIChnZXQodGhpcywgJ2lzVmlz
        aWJsZScpID09PSBmYWxzZSkgewogICAgICBidWZmZXIuc3R5bGUoJ2Rpc3Bs
        YXknLCAnbm9uZScpOwogICAgfQogIH0sCgogIC8vIC4uLi4uLi4uLi4uLi4u
        Li4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4K
        ICAvLyBTVEFOREFSRCBSRU5ERVIgUFJPUEVSVElFUwogIC8vCgogIC8qKgog
        ICAgVGFnIG5hbWUgZm9yIHRoZSB2aWV3J3Mgb3V0ZXIgZWxlbWVudC4gVGhl
        IHRhZyBuYW1lIGlzIG9ubHkgdXNlZCB3aGVuIGFuCiAgICBlbGVtZW50IGlz
        IGZpcnN0IGNyZWF0ZWQuIElmIHlvdSBjaGFuZ2UgdGhlIGB0YWdOYW1lYCBm
        b3IgYW4gZWxlbWVudCwgeW91CiAgICBtdXN0IGRlc3Ryb3kgYW5kIHJlY3Jl
        YXRlIHRoZSB2aWV3IGVsZW1lbnQuCgogICAgQnkgZGVmYXVsdCwgdGhlIHJl
        bmRlciBidWZmZXIgd2lsbCB1c2UgYSBgPGRpdj5gIHRhZyBmb3Igdmlld3Mu
        CgogICAgQHByb3BlcnR5IHRhZ05hbWUKICAgIEB0eXBlIFN0cmluZwogICAg
        QGRlZmF1bHQgbnVsbAogICovCgogIC8vIFdlIGxlYXZlIHRoaXMgbnVsbCBi
        eSBkZWZhdWx0IHNvIHdlIGNhbiB0ZWxsIHRoZSBkaWZmZXJlbmNlIGJldHdl
        ZW4KICAvLyB0aGUgZGVmYXVsdCBjYXNlIGFuZCBhIHVzZXItc3BlY2lmaWVk
        IHRhZy4KICB0YWdOYW1lOiBudWxsLAoKICAvKioKICAgIFRoZSBXQUktQVJJ
        QSByb2xlIG9mIHRoZSBjb250cm9sIHJlcHJlc2VudGVkIGJ5IHRoaXMgdmll
        dy4gRm9yIGV4YW1wbGUsIGEKICAgIGJ1dHRvbiBtYXkgaGF2ZSBhIHJvbGUg
        b2YgdHlwZSAnYnV0dG9uJywgb3IgYSBwYW5lIG1heSBoYXZlIGEgcm9sZSBv
        ZgogICAgdHlwZSAnYWxlcnRkaWFsb2cnLiBUaGlzIHByb3BlcnR5IGlzIHVz
        ZWQgYnkgYXNzaXN0aXZlIHNvZnR3YXJlIHRvIGhlbHAKICAgIHZpc3VhbGx5
        IGNoYWxsZW5nZWQgdXNlcnMgbmF2aWdhdGUgcmljaCB3ZWIgYXBwbGljYXRp
        b25zLgoKICAgIFRoZSBmdWxsIGxpc3Qgb2YgdmFsaWQgV0FJLUFSSUEgcm9s
        ZXMgaXMgYXZhaWxhYmxlIGF0OgogICAgW2h0dHA6Ly93d3cudzMub3JnL1RS
        L3dhaS1hcmlhL3JvbGVzI3JvbGVzX2NhdGVnb3JpemF0aW9uXShodHRwOi8v
        d3d3LnczLm9yZy9UUi93YWktYXJpYS9yb2xlcyNyb2xlc19jYXRlZ29yaXph
        dGlvbikKCiAgICBAcHJvcGVydHkgYXJpYVJvbGUKICAgIEB0eXBlIFN0cmlu
        ZwogICAgQGRlZmF1bHQgbnVsbAogICovCiAgYXJpYVJvbGU6IG51bGwsCgog
        IC8qKgogICAgU3RhbmRhcmQgQ1NTIGNsYXNzIG5hbWVzIHRvIGFwcGx5IHRv
        IHRoZSB2aWV3J3Mgb3V0ZXIgZWxlbWVudC4gVGhpcwogICAgcHJvcGVydHkg
        YXV0b21hdGljYWxseSBpbmhlcml0cyBhbnkgY2xhc3MgbmFtZXMgZGVmaW5l
        ZCBieSB0aGUgdmlldydzCiAgICBzdXBlcmNsYXNzZXMgYXMgd2VsbC4KCiAg
        ICBAcHJvcGVydHkgY2xhc3NOYW1lcwogICAgQHR5cGUgQXJyYXkKICAgIEBk
        ZWZhdWx0IFsnZW1iZXItdmlldyddCiAgKi8KICBjbGFzc05hbWVzOiBbJ2Vt
        YmVyLXZpZXcnXSwKCiAgLyoqCiAgICBBIGxpc3Qgb2YgcHJvcGVydGllcyBv
        ZiB0aGUgdmlldyB0byBhcHBseSBhcyBjbGFzcyBuYW1lcy4gSWYgdGhlIHBy
        b3BlcnR5CiAgICBpcyBhIHN0cmluZyB2YWx1ZSwgdGhlIHZhbHVlIG9mIHRo
        YXQgc3RyaW5nIHdpbGwgYmUgYXBwbGllZCBhcyBhIGNsYXNzCiAgICBuYW1l
        LgoKICAgIGBgYGphdmFzY3JpcHQKICAgIC8vIEFwcGxpZXMgdGhlICdoaWdo
        JyBjbGFzcyB0byB0aGUgdmlldyBlbGVtZW50CiAgICBFbWJlci5WaWV3LmV4
        dGVuZCh7CiAgICAgIGNsYXNzTmFtZUJpbmRpbmdzOiBbJ3ByaW9yaXR5J10K
        ICAgICAgcHJpb3JpdHk6ICdoaWdoJwogICAgfSk7CiAgICBgYGAKCiAgICBJ
        ZiB0aGUgdmFsdWUgb2YgdGhlIHByb3BlcnR5IGlzIGEgQm9vbGVhbiwgdGhl
        IG5hbWUgb2YgdGhhdCBwcm9wZXJ0eSBpcwogICAgYWRkZWQgYXMgYSBkYXNo
        ZXJpemVkIGNsYXNzIG5hbWUuCgogICAgYGBgamF2YXNjcmlwdAogICAgLy8g
        QXBwbGllcyB0aGUgJ2lzLXVyZ2VudCcgY2xhc3MgdG8gdGhlIHZpZXcgZWxl
        bWVudAogICAgRW1iZXIuVmlldy5leHRlbmQoewogICAgICBjbGFzc05hbWVC
        aW5kaW5nczogWydpc1VyZ2VudCddCiAgICAgIGlzVXJnZW50OiB0cnVlCiAg
        ICB9KTsKICAgIGBgYAoKICAgIElmIHlvdSB3b3VsZCBwcmVmZXIgdG8gdXNl
        IGEgY3VzdG9tIHZhbHVlIGluc3RlYWQgb2YgdGhlIGRhc2hlcml6ZWQKICAg
        IHByb3BlcnR5IG5hbWUsIHlvdSBjYW4gcGFzcyBhIGJpbmRpbmcgbGlrZSB0
        aGlzOgoKICAgIGBgYGphdmFzY3JpcHQKICAgIC8vIEFwcGxpZXMgdGhlICd1
        cmdlbnQnIGNsYXNzIHRvIHRoZSB2aWV3IGVsZW1lbnQKICAgIEVtYmVyLlZp
        ZXcuZXh0ZW5kKHsKICAgICAgY2xhc3NOYW1lQmluZGluZ3M6IFsnaXNVcmdl
        bnQ6dXJnZW50J10KICAgICAgaXNVcmdlbnQ6IHRydWUKICAgIH0pOwogICAg
        YGBgCgogICAgVGhpcyBsaXN0IG9mIHByb3BlcnRpZXMgaXMgaW5oZXJpdGVk
        IGZyb20gdGhlIHZpZXcncyBzdXBlcmNsYXNzZXMgYXMgd2VsbC4KCiAgICBA
        cHJvcGVydHkgY2xhc3NOYW1lQmluZGluZ3MKICAgIEB0eXBlIEFycmF5CiAg
        ICBAZGVmYXVsdCBbXQogICovCiAgY2xhc3NOYW1lQmluZGluZ3M6IEVNUFRZ
        X0FSUkFZLAoKICAvKioKICAgIEEgbGlzdCBvZiBwcm9wZXJ0aWVzIG9mIHRo
        ZSB2aWV3IHRvIGFwcGx5IGFzIGF0dHJpYnV0ZXMuIElmIHRoZSBwcm9wZXJ0
        eSBpcwogICAgYSBzdHJpbmcgdmFsdWUsIHRoZSB2YWx1ZSBvZiB0aGF0IHN0
        cmluZyB3aWxsIGJlIGFwcGxpZWQgYXMgdGhlIGF0dHJpYnV0ZS4KCiAgICBg
        YGBqYXZhc2NyaXB0CiAgICAvLyBBcHBsaWVzIHRoZSB0eXBlIGF0dHJpYnV0
        ZSB0byB0aGUgZWxlbWVudAogICAgLy8gd2l0aCB0aGUgdmFsdWUgImJ1dHRv
        biIsIGxpa2UgPGRpdiB0eXBlPSJidXR0b24iPgogICAgRW1iZXIuVmlldy5l
        eHRlbmQoewogICAgICBhdHRyaWJ1dGVCaW5kaW5nczogWyd0eXBlJ10sCiAg
        ICAgIHR5cGU6ICdidXR0b24nCiAgICB9KTsKICAgIGBgYAoKICAgIElmIHRo
        ZSB2YWx1ZSBvZiB0aGUgcHJvcGVydHkgaXMgYSBCb29sZWFuLCB0aGUgbmFt
        ZSBvZiB0aGF0IHByb3BlcnR5IGlzCiAgICBhZGRlZCBhcyBhbiBhdHRyaWJ1
        dGUuCgogICAgYGBgamF2YXNjcmlwdAogICAgLy8gUmVuZGVycyBzb21ldGhp
        bmcgbGlrZSA8ZGl2IGVuYWJsZWQ9ImVuYWJsZWQiPgogICAgRW1iZXIuVmll
        dy5leHRlbmQoewogICAgICBhdHRyaWJ1dGVCaW5kaW5nczogWydlbmFibGVk
        J10sCiAgICAgIGVuYWJsZWQ6IHRydWUKICAgIH0pOwogICAgYGBgCgogICAg
        QHByb3BlcnR5IGF0dHJpYnV0ZUJpbmRpbmdzCiAgKi8KICBhdHRyaWJ1dGVC
        aW5kaW5nczogRU1QVFlfQVJSQVksCgogIC8vIC4uLi4uLi4uLi4uLi4uLi4u
        Li4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4KICAvLyBD
        T1JFIERJU1BMQVkgTUVUSE9EUwogIC8vCgogIC8qKgogICAgQHByaXZhdGUK
        CiAgICBTZXR1cCBhIHZpZXcsIGJ1dCBkbyBub3QgZmluaXNoIHdha2luZyBp
        dCB1cC4KICAgIC0gY29uZmlndXJlIGBjaGlsZFZpZXdzYAogICAgLSByZWdp
        c3RlciB0aGUgdmlldyB3aXRoIHRoZSBnbG9iYWwgdmlld3MgaGFzaCwgd2hp
        Y2ggaXMgdXNlZCBmb3IgZXZlbnQKICAgICAgZGlzcGF0Y2gKCiAgICBAbWV0
        aG9kIGluaXQKICAqLwogIGluaXQ6IGZ1bmN0aW9uKCkgewogICAgdGhpcy5l
        bGVtZW50SWQgPSB0aGlzLmVsZW1lbnRJZCB8fCBndWlkRm9yKHRoaXMpOwoK
        ICAgIHRoaXMuX3N1cGVyKCk7CgogICAgLy8gc2V0dXAgY2hpbGQgdmlld3Mu
        IGJlIHN1cmUgdG8gY2xvbmUgdGhlIGNoaWxkIHZpZXdzIGFycmF5IGZpcnN0
        CiAgICB0aGlzLl9jaGlsZFZpZXdzID0gdGhpcy5fY2hpbGRWaWV3cy5zbGlj
        ZSgpOwoKICAgIEVtYmVyLmFzc2VydCgiT25seSBhcnJheXMgYXJlIGFsbG93
        ZWQgZm9yICdjbGFzc05hbWVCaW5kaW5ncyciLCBFbWJlci50eXBlT2YodGhp
        cy5jbGFzc05hbWVCaW5kaW5ncykgPT09ICdhcnJheScpOwogICAgdGhpcy5j
        bGFzc05hbWVCaW5kaW5ncyA9IEVtYmVyLkEodGhpcy5jbGFzc05hbWVCaW5k
        aW5ncy5zbGljZSgpKTsKCiAgICBFbWJlci5hc3NlcnQoIk9ubHkgYXJyYXlz
        IGFyZSBhbGxvd2VkIGZvciAnY2xhc3NOYW1lcyciLCBFbWJlci50eXBlT2Yo
        dGhpcy5jbGFzc05hbWVzKSA9PT0gJ2FycmF5Jyk7CiAgICB0aGlzLmNsYXNz
        TmFtZXMgPSBFbWJlci5BKHRoaXMuY2xhc3NOYW1lcy5zbGljZSgpKTsKICB9
        LAoKICBhcHBlbmRDaGlsZDogZnVuY3Rpb24odmlldywgb3B0aW9ucykgewog
        ICAgcmV0dXJuIHRoaXMuY3VycmVudFN0YXRlLmFwcGVuZENoaWxkKHRoaXMs
        IHZpZXcsIG9wdGlvbnMpOwogIH0sCgogIC8qKgogICAgUmVtb3ZlcyB0aGUg
        Y2hpbGQgdmlldyBmcm9tIHRoZSBwYXJlbnQgdmlldy4KCiAgICBAbWV0aG9k
        IHJlbW92ZUNoaWxkCiAgICBAcGFyYW0ge0VtYmVyLlZpZXd9IHZpZXcKICAg
        IEByZXR1cm4ge0VtYmVyLlZpZXd9IHJlY2VpdmVyCiAgKi8KICByZW1vdmVD
        aGlsZDogZnVuY3Rpb24odmlldykgewogICAgLy8gSWYgd2UncmUgZGVzdHJv
        eWluZywgdGhlIGVudGlyZSBzdWJ0cmVlIHdpbGwgYmUKICAgIC8vIGZyZWVk
        LCBhbmQgdGhlIERPTSB3aWxsIGJlIGhhbmRsZWQgc2VwYXJhdGVseSwKICAg
        IC8vIHNvIG5vIG5lZWQgdG8gbWVzcyB3aXRoIGNoaWxkVmlld3MuCiAgICBp
        ZiAodGhpcy5pc0Rlc3Ryb3lpbmcpIHsgcmV0dXJuOyB9CgogICAgLy8gdXBk
        YXRlIHBhcmVudCBub2RlCiAgICBzZXQodmlldywgJ19wYXJlbnRWaWV3Jywg
        bnVsbCk7CgogICAgLy8gcmVtb3ZlIHZpZXcgZnJvbSBjaGlsZFZpZXdzIGFy
        cmF5LgogICAgdmFyIGNoaWxkVmlld3MgPSB0aGlzLl9jaGlsZFZpZXdzOwoK
        ICAgIEVtYmVyLkVudW1lcmFibGVVdGlscy5yZW1vdmVPYmplY3QoY2hpbGRW
        aWV3cywgdmlldyk7CgogICAgdGhpcy5wcm9wZXJ0eURpZENoYW5nZSgnY2hp
        bGRWaWV3cycpOyAvLyBIVUg/ISB3aGF0IGhhcHBlbmVkIHRvIHdpbGwgY2hh
        bmdlPwoKICAgIHJldHVybiB0aGlzOwogIH0sCgogIC8qKgogICAgUmVtb3Zl
        cyBhbGwgY2hpbGRyZW4gZnJvbSB0aGUgYHBhcmVudFZpZXdgLgoKICAgIEBt
        ZXRob2QgcmVtb3ZlQWxsQ2hpbGRyZW4KICAgIEByZXR1cm4ge0VtYmVyLlZp
        ZXd9IHJlY2VpdmVyCiAgKi8KICByZW1vdmVBbGxDaGlsZHJlbjogZnVuY3Rp
        b24oKSB7CiAgICByZXR1cm4gdGhpcy5tdXRhdGVDaGlsZFZpZXdzKGZ1bmN0
        aW9uKHBhcmVudFZpZXcsIHZpZXcpIHsKICAgICAgcGFyZW50Vmlldy5yZW1v
        dmVDaGlsZCh2aWV3KTsKICAgIH0pOwogIH0sCgogIGRlc3Ryb3lBbGxDaGls
        ZHJlbjogZnVuY3Rpb24oKSB7CiAgICByZXR1cm4gdGhpcy5tdXRhdGVDaGls
        ZFZpZXdzKGZ1bmN0aW9uKHBhcmVudFZpZXcsIHZpZXcpIHsKICAgICAgdmll
        dy5kZXN0cm95KCk7CiAgICB9KTsKICB9LAoKICAvKioKICAgIFJlbW92ZXMg
        dGhlIHZpZXcgZnJvbSBpdHMgYHBhcmVudFZpZXdgLCBpZiBvbmUgaXMgZm91
        bmQuIE90aGVyd2lzZQogICAgZG9lcyBub3RoaW5nLgoKICAgIEBtZXRob2Qg
        cmVtb3ZlRnJvbVBhcmVudAogICAgQHJldHVybiB7RW1iZXIuVmlld30gcmVj
        ZWl2ZXIKICAqLwogIHJlbW92ZUZyb21QYXJlbnQ6IGZ1bmN0aW9uKCkgewog
        ICAgdmFyIHBhcmVudCA9IHRoaXMuX3BhcmVudFZpZXc7CgogICAgLy8gUmVt
        b3ZlIERPTSBlbGVtZW50IGZyb20gcGFyZW50CiAgICB0aGlzLnJlbW92ZSgp
        OwoKICAgIGlmIChwYXJlbnQpIHsgcGFyZW50LnJlbW92ZUNoaWxkKHRoaXMp
        OyB9CiAgICByZXR1cm4gdGhpczsKICB9LAoKICAvKioKICAgIFlvdSBtdXN0
        IGNhbGwgYGRlc3Ryb3lgIG9uIGEgdmlldyB0byBkZXN0cm95IHRoZSB2aWV3
        IChhbmQgYWxsIG9mIGl0cwogICAgY2hpbGQgdmlld3MpLiBUaGlzIHdpbGwg
        cmVtb3ZlIHRoZSB2aWV3IGZyb20gYW55IHBhcmVudCBub2RlLCB0aGVuIG1h
        a2UKICAgIHN1cmUgdGhhdCB0aGUgRE9NIGVsZW1lbnQgbWFuYWdlZCBieSB0
        aGUgdmlldyBjYW4gYmUgcmVsZWFzZWQgYnkgdGhlCiAgICBtZW1vcnkgbWFu
        YWdlci4KCiAgICBAbWV0aG9kIGRlc3Ryb3kKICAqLwogIGRlc3Ryb3k6IGZ1
        bmN0aW9uKCkgewogICAgdmFyIGNoaWxkVmlld3MgPSB0aGlzLl9jaGlsZFZp
        ZXdzLAogICAgICAgIC8vIGdldCBwYXJlbnRWaWV3IGJlZm9yZSBjYWxsaW5n
        IHN1cGVyIGJlY2F1c2UgaXQnbGwgYmUgZGVzdHJveWVkCiAgICAgICAgbm9u
        VmlydHVhbFBhcmVudFZpZXcgPSBnZXQodGhpcywgJ3BhcmVudFZpZXcnKSwK
        ICAgICAgICB2aWV3TmFtZSA9IHRoaXMudmlld05hbWUsCiAgICAgICAgY2hp
        bGRMZW4sIGk7CgogICAgaWYgKCF0aGlzLl9zdXBlcigpKSB7IHJldHVybjsg
        fQoKICAgIGNoaWxkTGVuID0gY2hpbGRWaWV3cy5sZW5ndGg7CiAgICBmb3Ig
        KGk9Y2hpbGRMZW4tMTsgaT49MDsgaS0tKSB7CiAgICAgIGNoaWxkVmlld3Nb
        aV0ucmVtb3ZlZEZyb21ET00gPSB0cnVlOwogICAgfQoKICAgIC8vIHJlbW92
        ZSBmcm9tIG5vbi12aXJ0dWFsIHBhcmVudCB2aWV3IGlmIHZpZXdOYW1lIHdh
        cyBzcGVjaWZpZWQKICAgIGlmICh2aWV3TmFtZSAmJiBub25WaXJ0dWFsUGFy
        ZW50VmlldykgewogICAgICBub25WaXJ0dWFsUGFyZW50Vmlldy5zZXQodmll
        d05hbWUsIG51bGwpOwogICAgfQoKICAgIGNoaWxkTGVuID0gY2hpbGRWaWV3
        cy5sZW5ndGg7CiAgICBmb3IgKGk9Y2hpbGRMZW4tMTsgaT49MDsgaS0tKSB7
        CiAgICAgIGNoaWxkVmlld3NbaV0uZGVzdHJveSgpOwogICAgfQoKICAgIHJl
        dHVybiB0aGlzOwogIH0sCgogIC8qKgogICAgSW5zdGFudGlhdGVzIGEgdmll
        dyB0byBiZSBhZGRlZCB0byB0aGUgY2hpbGRWaWV3cyBhcnJheSBkdXJpbmcg
        dmlldwogICAgaW5pdGlhbGl6YXRpb24uIFlvdSBnZW5lcmFsbHkgd2lsbCBu
        b3QgY2FsbCB0aGlzIG1ldGhvZCBkaXJlY3RseSB1bmxlc3MKICAgIHlvdSBh
        cmUgb3ZlcnJpZGluZyBgY3JlYXRlQ2hpbGRWaWV3cygpYC4gTm90ZSB0aGF0
        IHRoaXMgbWV0aG9kIHdpbGwKICAgIGF1dG9tYXRpY2FsbHkgY29uZmlndXJl
        IHRoZSBjb3JyZWN0IHNldHRpbmdzIG9uIHRoZSBuZXcgdmlldyBpbnN0YW5j
        ZSB0bwogICAgYWN0IGFzIGEgY2hpbGQgb2YgdGhlIHBhcmVudC4KCiAgICBA
        bWV0aG9kIGNyZWF0ZUNoaWxkVmlldwogICAgQHBhcmFtIHtDbGFzc3xTdHJp
        bmd9IHZpZXdDbGFzcwogICAgQHBhcmFtIHtIYXNofSBbYXR0cnNdIEF0dHJp
        YnV0ZXMgdG8gYWRkCiAgICBAcmV0dXJuIHtFbWJlci5WaWV3fSBuZXcgaW5z
        dGFuY2UKICAqLwogIGNyZWF0ZUNoaWxkVmlldzogZnVuY3Rpb24odmlldywg
        YXR0cnMpIHsKICAgIGlmICghdmlldykgewogICAgICB0aHJvdyBuZXcgVHlw
        ZUVycm9yKCJjcmVhdGVDaGlsZFZpZXdzIGZpcnN0IGFyZ3VtZW50IG11c3Qg
        ZXhpc3QiKTsKICAgIH0KCiAgICBpZiAodmlldy5pc1ZpZXcgJiYgdmlldy5f
        cGFyZW50VmlldyA9PT0gdGhpcyAmJiB2aWV3LmNvbnRhaW5lciA9PT0gdGhp
        cy5jb250YWluZXIpIHsKICAgICAgcmV0dXJuIHZpZXc7CiAgICB9CgogICAg
        YXR0cnMgPSBhdHRycyB8fCB7fTsKICAgIGF0dHJzLl9wYXJlbnRWaWV3ID0g
        dGhpczsKCiAgICBpZiAoRW1iZXIuQ29yZVZpZXcuZGV0ZWN0KHZpZXcpKSB7
        CiAgICAgIGF0dHJzLnRlbXBsYXRlRGF0YSA9IGF0dHJzLnRlbXBsYXRlRGF0
        YSB8fCBnZXQodGhpcywgJ3RlbXBsYXRlRGF0YScpOwoKICAgICAgYXR0cnMu
        Y29udGFpbmVyID0gdGhpcy5jb250YWluZXI7CiAgICAgIHZpZXcgPSB2aWV3
        LmNyZWF0ZShhdHRycyk7CgogICAgICAvLyBkb24ndCBzZXQgdGhlIHByb3Bl
        cnR5IG9uIGEgdmlydHVhbCB2aWV3LCBhcyB0aGV5IGFyZSBpbnZpc2libGUg
        dG8KICAgICAgLy8gY29uc3VtZXJzIG9mIHRoZSB2aWV3IEFQSQogICAgICBp
        ZiAodmlldy52aWV3TmFtZSkgewogICAgICAgIHNldChnZXQodGhpcywgJ2Nv
        bmNyZXRlVmlldycpLCB2aWV3LnZpZXdOYW1lLCB2aWV3KTsKICAgICAgfQog
        ICAgfSBlbHNlIGlmICgnc3RyaW5nJyA9PT0gdHlwZW9mIHZpZXcpIHsKICAg
        ICAgdmFyIGZ1bGxOYW1lID0gJ3ZpZXc6JyArIHZpZXc7CiAgICAgIHZhciBW
        aWV3ID0gdGhpcy5jb250YWluZXIubG9va3VwRmFjdG9yeShmdWxsTmFtZSk7
        CgogICAgICBFbWJlci5hc3NlcnQoIkNvdWxkIG5vdCBmaW5kIHZpZXc6ICci
        ICsgZnVsbE5hbWUgKyAiJyIsICEhVmlldyk7CgogICAgICBhdHRycy50ZW1w
        bGF0ZURhdGEgPSBnZXQodGhpcywgJ3RlbXBsYXRlRGF0YScpOwogICAgICB2
        aWV3ID0gVmlldy5jcmVhdGUoYXR0cnMpOwogICAgfSBlbHNlIHsKICAgICAg
        RW1iZXIuYXNzZXJ0KCdZb3UgbXVzdCBwYXNzIGluc3RhbmNlIG9yIHN1YmNs
        YXNzIG9mIFZpZXcnLCB2aWV3LmlzVmlldyk7CiAgICAgIGF0dHJzLmNvbnRh
        aW5lciA9IHRoaXMuY29udGFpbmVyOwoKICAgICAgaWYgKCFnZXQodmlldywg
        J3RlbXBsYXRlRGF0YScpKSB7CiAgICAgICAgYXR0cnMudGVtcGxhdGVEYXRh
        ID0gZ2V0KHRoaXMsICd0ZW1wbGF0ZURhdGEnKTsKICAgICAgfQoKICAgICAg
        RW1iZXIuc2V0UHJvcGVydGllcyh2aWV3LCBhdHRycyk7CgogICAgfQoKICAg
        IHJldHVybiB2aWV3OwogIH0sCgogIGJlY2FtZVZpc2libGU6IEVtYmVyLkss
        CiAgYmVjYW1lSGlkZGVuOiBFbWJlci5LLAoKICAvKioKICAgIEBwcml2YXRl
        CgogICAgV2hlbiB0aGUgdmlldydzIGBpc1Zpc2libGVgIHByb3BlcnR5IGNo
        YW5nZXMsIHRvZ2dsZSB0aGUgdmlzaWJpbGl0eQogICAgZWxlbWVudCBvZiB0
        aGUgYWN0dWFsIERPTSBlbGVtZW50LgoKICAgIEBtZXRob2QgX2lzVmlzaWJs
        ZURpZENoYW5nZQogICovCiAgX2lzVmlzaWJsZURpZENoYW5nZTogRW1iZXIu
        b2JzZXJ2ZXIoZnVuY3Rpb24oKSB7CiAgICB2YXIgJGVsID0gdGhpcy4kKCk7
        CiAgICBpZiAoISRlbCkgeyByZXR1cm47IH0KCiAgICB2YXIgaXNWaXNpYmxl
        ID0gZ2V0KHRoaXMsICdpc1Zpc2libGUnKTsKCiAgICAkZWwudG9nZ2xlKGlz
        VmlzaWJsZSk7CgogICAgaWYgKHRoaXMuX2lzQW5jZXN0b3JIaWRkZW4oKSkg
        eyByZXR1cm47IH0KCiAgICBpZiAoaXNWaXNpYmxlKSB7CiAgICAgIHRoaXMu
        X25vdGlmeUJlY2FtZVZpc2libGUoKTsKICAgIH0gZWxzZSB7CiAgICAgIHRo
        aXMuX25vdGlmeUJlY2FtZUhpZGRlbigpOwogICAgfQogIH0sICdpc1Zpc2li
        bGUnKSwKCiAgX25vdGlmeUJlY2FtZVZpc2libGU6IGZ1bmN0aW9uKCkgewog
        ICAgdGhpcy50cmlnZ2VyKCdiZWNhbWVWaXNpYmxlJyk7CgogICAgdGhpcy5m
        b3JFYWNoQ2hpbGRWaWV3KGZ1bmN0aW9uKHZpZXcpIHsKICAgICAgdmFyIGlz
        VmlzaWJsZSA9IGdldCh2aWV3LCAnaXNWaXNpYmxlJyk7CgogICAgICBpZiAo
        aXNWaXNpYmxlIHx8IGlzVmlzaWJsZSA9PT0gbnVsbCkgewogICAgICAgIHZp
        ZXcuX25vdGlmeUJlY2FtZVZpc2libGUoKTsKICAgICAgfQogICAgfSk7CiAg
        fSwKCiAgX25vdGlmeUJlY2FtZUhpZGRlbjogZnVuY3Rpb24oKSB7CiAgICB0
        aGlzLnRyaWdnZXIoJ2JlY2FtZUhpZGRlbicpOwogICAgdGhpcy5mb3JFYWNo
        Q2hpbGRWaWV3KGZ1bmN0aW9uKHZpZXcpIHsKICAgICAgdmFyIGlzVmlzaWJs
        ZSA9IGdldCh2aWV3LCAnaXNWaXNpYmxlJyk7CgogICAgICBpZiAoaXNWaXNp
        YmxlIHx8IGlzVmlzaWJsZSA9PT0gbnVsbCkgewogICAgICAgIHZpZXcuX25v
        dGlmeUJlY2FtZUhpZGRlbigpOwogICAgICB9CiAgICB9KTsKICB9LAoKICBf
        aXNBbmNlc3RvckhpZGRlbjogZnVuY3Rpb24oKSB7CiAgICB2YXIgcGFyZW50
        ID0gZ2V0KHRoaXMsICdwYXJlbnRWaWV3Jyk7CgogICAgd2hpbGUgKHBhcmVu
        dCkgewogICAgICBpZiAoZ2V0KHBhcmVudCwgJ2lzVmlzaWJsZScpID09PSBm
        YWxzZSkgeyByZXR1cm4gdHJ1ZTsgfQoKICAgICAgcGFyZW50ID0gZ2V0KHBh
        cmVudCwgJ3BhcmVudFZpZXcnKTsKICAgIH0KCiAgICByZXR1cm4gZmFsc2U7
        CiAgfSwKCiAgY2xlYXJCdWZmZXI6IGZ1bmN0aW9uKCkgewogICAgdGhpcy5p
        bnZva2VSZWN1cnNpdmVseShmdW5jdGlvbih2aWV3KSB7CiAgICAgIHZpZXcu
        YnVmZmVyID0gbnVsbDsKICAgIH0pOwogIH0sCgogIHRyYW5zaXRpb25Ubzog
        ZnVuY3Rpb24oc3RhdGUsIGNoaWxkcmVuKSB7CiAgICB2YXIgcHJpb3JTdGF0
        ZSA9IHRoaXMuY3VycmVudFN0YXRlLAogICAgICAgIGN1cnJlbnRTdGF0ZSA9
        IHRoaXMuY3VycmVudFN0YXRlID0gdGhpcy5zdGF0ZXNbc3RhdGVdOwogICAg
        dGhpcy5zdGF0ZSA9IHN0YXRlOwoKICAgIGlmIChwcmlvclN0YXRlICYmIHBy
        aW9yU3RhdGUuZXhpdCkgeyBwcmlvclN0YXRlLmV4aXQodGhpcyk7IH0KICAg
        IGlmIChjdXJyZW50U3RhdGUuZW50ZXIpIHsgY3VycmVudFN0YXRlLmVudGVy
        KHRoaXMpOyB9CiAgICBpZiAoc3RhdGUgPT09ICdpbkRPTScpIHsgZGVsZXRl
        IEVtYmVyLm1ldGEodGhpcykuY2FjaGUuZWxlbWVudDsgfQoKICAgIGlmIChj
        aGlsZHJlbiAhPT0gZmFsc2UpIHsKICAgICAgdGhpcy5mb3JFYWNoQ2hpbGRW
        aWV3KGZ1bmN0aW9uKHZpZXcpIHsKICAgICAgICB2aWV3LnRyYW5zaXRpb25U
        byhzdGF0ZSk7CiAgICAgIH0pOwogICAgfQogIH0sCgogIC8vIC4uLi4uLi4u
        Li4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4u
        Li4KICAvLyBFVkVOVCBIQU5ETElORwogIC8vCgogIC8qKgogICAgQHByaXZh
        dGUKCiAgICBIYW5kbGUgZXZlbnRzIGZyb20gYEVtYmVyLkV2ZW50RGlzcGF0
        Y2hlcmAKCiAgICBAbWV0aG9kIGhhbmRsZUV2ZW50CiAgICBAcGFyYW0gZXZl
        bnROYW1lIHtTdHJpbmd9CiAgICBAcGFyYW0gZXZ0IHtFdmVudH0KICAqLwog
        IGhhbmRsZUV2ZW50OiBmdW5jdGlvbihldmVudE5hbWUsIGV2dCkgewogICAg
        cmV0dXJuIHRoaXMuY3VycmVudFN0YXRlLmhhbmRsZUV2ZW50KHRoaXMsIGV2
        ZW50TmFtZSwgZXZ0KTsKICB9LAoKICByZWdpc3Rlck9ic2VydmVyOiBmdW5j
        dGlvbihyb290LCBwYXRoLCB0YXJnZXQsIG9ic2VydmVyKSB7CiAgICBpZiAo
        IW9ic2VydmVyICYmICdmdW5jdGlvbicgPT09IHR5cGVvZiB0YXJnZXQpIHsK
        ICAgICAgb2JzZXJ2ZXIgPSB0YXJnZXQ7CiAgICAgIHRhcmdldCA9IG51bGw7
        CiAgICB9CgogICAgaWYgKCFyb290IHx8IHR5cGVvZiByb290ICE9PSAnb2Jq
        ZWN0JykgewogICAgICByZXR1cm47CiAgICB9CgogICAgdmFyIHZpZXcgPSB0
        aGlzLAogICAgICAgIHN0YXRlQ2hlY2tlZE9ic2VydmVyID0gZnVuY3Rpb24o
        KSB7CiAgICAgICAgICB2aWV3LmN1cnJlbnRTdGF0ZS5pbnZva2VPYnNlcnZl
        cih0aGlzLCBvYnNlcnZlcik7CiAgICAgICAgfSwKICAgICAgICBzY2hlZHVs
        ZWRPYnNlcnZlciA9IGZ1bmN0aW9uKCkgewogICAgICAgICAgRW1iZXIucnVu
        LnNjaGVkdWxlT25jZSgncmVuZGVyJywgdGhpcywgc3RhdGVDaGVja2VkT2Jz
        ZXJ2ZXIpOwogICAgICAgIH07CgogICAgRW1iZXIuYWRkT2JzZXJ2ZXIocm9v
        dCwgcGF0aCwgdGFyZ2V0LCBzY2hlZHVsZWRPYnNlcnZlcik7CgogICAgdGhp
        cy5vbmUoJ3dpbGxDbGVhclJlbmRlcicsIGZ1bmN0aW9uKCkgewogICAgICBF
        bWJlci5yZW1vdmVPYnNlcnZlcihyb290LCBwYXRoLCB0YXJnZXQsIHNjaGVk
        dWxlZE9ic2VydmVyKTsKICAgIH0pOwogIH0KCn0pOwoKLyoKICBEZXNjcmli
        ZSBob3cgdGhlIHNwZWNpZmllZCBhY3Rpb25zIHNob3VsZCBiZWhhdmUgaW4g
        dGhlIHZhcmlvdXMKICBzdGF0ZXMgdGhhdCBhIHZpZXcgY2FuIGV4aXN0IGlu
        LiBQb3NzaWJsZSBzdGF0ZXM6CgogICogcHJlUmVuZGVyOiB3aGVuIGEgdmll
        dyBpcyBmaXJzdCBpbnN0YW50aWF0ZWQsIGFuZCBhZnRlciBpdHMKICAgIGVs
        ZW1lbnQgd2FzIGRlc3Ryb3llZCwgaXQgaXMgaW4gdGhlIHByZVJlbmRlciBz
        dGF0ZQogICogaW5CdWZmZXI6IG9uY2UgYSB2aWV3IGhhcyBiZWVuIHJlbmRl
        cmVkLCBidXQgYmVmb3JlIGl0IGhhcwogICAgYmVlbiBpbnNlcnRlZCBpbnRv
        IHRoZSBET00sIGl0IGlzIGluIHRoZSBpbkJ1ZmZlciBzdGF0ZQogICogaW5E
        T006IG9uY2UgYSB2aWV3IGhhcyBiZWVuIGluc2VydGVkIGludG8gdGhlIERP
        TSBpdCBpcyBpbgogICAgdGhlIGluRE9NIHN0YXRlLiBBIHZpZXcgc3BlbmRz
        IHRoZSB2YXN0IG1ham9yaXR5IG9mIGl0cwogICAgZXhpc3RlbmNlIGluIHRo
        aXMgc3RhdGUuCiAgKiBkZXN0cm95ZWQ6IG9uY2UgYSB2aWV3IGhhcyBiZWVu
        IGRlc3Ryb3llZCAodXNpbmcgdGhlIGRlc3Ryb3kKICAgIG1ldGhvZCksIGl0
        IGlzIGluIHRoaXMgc3RhdGUuIE5vIGZ1cnRoZXIgYWN0aW9ucyBjYW4gYmUg
        aW52b2tlZAogICAgb24gYSBkZXN0cm95ZWQgdmlldy4KKi8KCiAgLy8gaW4g
        dGhlIGRlc3Ryb3llZCBzdGF0ZSwgZXZlcnl0aGluZyBpcyBpbGxlZ2FsCgog
        IC8vIGJlZm9yZSByZW5kZXJpbmcgaGFzIGJlZ3VuLCBhbGwgbGVnYWwgbWFu
        aXB1bGF0aW9ucyBhcmUgbm9vcHMuCgogIC8vIGluc2lkZSB0aGUgYnVmZmVy
        LCBsZWdhbCBtYW5pcHVsYXRpb25zIGFyZSBkb25lIG9uIHRoZSBidWZmZXIK
        CiAgLy8gb25jZSB0aGUgdmlldyBoYXMgYmVlbiBpbnNlcnRlZCBpbnRvIHRo
        ZSBET00sIGxlZ2FsIG1hbmlwdWxhdGlvbnMKICAvLyBhcmUgZG9uZSBvbiB0
        aGUgRE9NIGVsZW1lbnQuCgpmdW5jdGlvbiBub3RpZnlNdXRhdGlvbkxpc3Rl
        bmVycygpIHsKICBFbWJlci5ydW4ub25jZShFbWJlci5WaWV3LCAnbm90aWZ5
        TXV0YXRpb25MaXN0ZW5lcnMnKTsKfQoKdmFyIERPTU1hbmFnZXIgPSB7CiAg
        cHJlcGVuZDogZnVuY3Rpb24odmlldywgaHRtbCkgewogICAgdmlldy4kKCku
        cHJlcGVuZChodG1sKTsKICAgIG5vdGlmeU11dGF0aW9uTGlzdGVuZXJzKCk7
        CiAgfSwKCiAgYWZ0ZXI6IGZ1bmN0aW9uKHZpZXcsIGh0bWwpIHsKICAgIHZp
        ZXcuJCgpLmFmdGVyKGh0bWwpOwogICAgbm90aWZ5TXV0YXRpb25MaXN0ZW5l
        cnMoKTsKICB9LAoKICBodG1sOiBmdW5jdGlvbih2aWV3LCBodG1sKSB7CiAg
        ICB2aWV3LiQoKS5odG1sKGh0bWwpOwogICAgbm90aWZ5TXV0YXRpb25MaXN0
        ZW5lcnMoKTsKICB9LAoKICByZXBsYWNlOiBmdW5jdGlvbih2aWV3KSB7CiAg
        ICB2YXIgZWxlbWVudCA9IGdldCh2aWV3LCAnZWxlbWVudCcpOwoKICAgIHNl
        dCh2aWV3LCAnZWxlbWVudCcsIG51bGwpOwoKICAgIHZpZXcuX2luc2VydEVs
        ZW1lbnRMYXRlcihmdW5jdGlvbigpIHsKICAgICAgRW1iZXIuJChlbGVtZW50
        KS5yZXBsYWNlV2l0aChnZXQodmlldywgJ2VsZW1lbnQnKSk7CiAgICAgIG5v
        dGlmeU11dGF0aW9uTGlzdGVuZXJzKCk7CiAgICB9KTsKICB9LAoKICByZW1v
        dmU6IGZ1bmN0aW9uKHZpZXcpIHsKICAgIHZpZXcuJCgpLnJlbW92ZSgpOwog
        ICAgbm90aWZ5TXV0YXRpb25MaXN0ZW5lcnMoKTsKICB9LAoKICBlbXB0eTog
        ZnVuY3Rpb24odmlldykgewogICAgdmlldy4kKCkuZW1wdHkoKTsKICAgIG5v
        dGlmeU11dGF0aW9uTGlzdGVuZXJzKCk7CiAgfQp9OwoKRW1iZXIuVmlldy5y
        ZW9wZW4oewogIGRvbU1hbmFnZXI6IERPTU1hbmFnZXIKfSk7CgpFbWJlci5W
        aWV3LnJlb3BlbkNsYXNzKHsKCiAgLyoqCiAgICBAcHJpdmF0ZQoKICAgIFBh
        cnNlIGEgcGF0aCBhbmQgcmV0dXJuIGFuIG9iamVjdCB3aGljaCBob2xkcyB0
        aGUgcGFyc2VkIHByb3BlcnRpZXMuCgogICAgRm9yIGV4YW1wbGUgYSBwYXRo
        IGxpa2UgImNvbnRlbnQuaXNFbmFibGVkOmVuYWJsZWQ6ZGlzYWJsZWQiIHdp
        bGwgcmV0dXJuIHRoZQogICAgZm9sbG93aW5nIG9iamVjdDoKCiAgICBgYGBq
        YXZhc2NyaXB0CiAgICB7CiAgICAgIHBhdGg6ICJjb250ZW50LmlzRW5hYmxl
        ZCIsCiAgICAgIGNsYXNzTmFtZTogImVuYWJsZWQiLAogICAgICBmYWxzeUNs
        YXNzTmFtZTogImRpc2FibGVkIiwKICAgICAgY2xhc3NOYW1lczogIjplbmFi
        bGVkOmRpc2FibGVkIgogICAgfQogICAgYGBgCgogICAgQG1ldGhvZCBfcGFy
        c2VQcm9wZXJ0eVBhdGgKICAgIEBzdGF0aWMKICAqLwogIF9wYXJzZVByb3Bl
        cnR5UGF0aDogZnVuY3Rpb24ocGF0aCkgewogICAgdmFyIHNwbGl0ID0gcGF0
        aC5zcGxpdCgnOicpLAogICAgICAgIHByb3BlcnR5UGF0aCA9IHNwbGl0WzBd
        LAogICAgICAgIGNsYXNzTmFtZXMgPSAiIiwKICAgICAgICBjbGFzc05hbWUs
        CiAgICAgICAgZmFsc3lDbGFzc05hbWU7CgogICAgLy8gY2hlY2sgaWYgdGhl
        IHByb3BlcnR5IGlzIGRlZmluZWQgYXMgcHJvcDpjbGFzcyBvciBwcm9wOnRy
        dWVDbGFzczpmYWxzZUNsYXNzCiAgICBpZiAoc3BsaXQubGVuZ3RoID4gMSkg
        ewogICAgICBjbGFzc05hbWUgPSBzcGxpdFsxXTsKICAgICAgaWYgKHNwbGl0
        Lmxlbmd0aCA9PT0gMykgeyBmYWxzeUNsYXNzTmFtZSA9IHNwbGl0WzJdOyB9
        CgogICAgICBjbGFzc05hbWVzID0gJzonICsgY2xhc3NOYW1lOwogICAgICBp
        ZiAoZmFsc3lDbGFzc05hbWUpIHsgY2xhc3NOYW1lcyArPSAiOiIgKyBmYWxz
        eUNsYXNzTmFtZTsgfQogICAgfQoKICAgIHJldHVybiB7CiAgICAgIHBhdGg6
        IHByb3BlcnR5UGF0aCwKICAgICAgY2xhc3NOYW1lczogY2xhc3NOYW1lcywK
        ICAgICAgY2xhc3NOYW1lOiAoY2xhc3NOYW1lID09PSAnJykgPyB1bmRlZmlu
        ZWQgOiBjbGFzc05hbWUsCiAgICAgIGZhbHN5Q2xhc3NOYW1lOiBmYWxzeUNs
        YXNzTmFtZQogICAgfTsKICB9LAoKICAvKioKICAgIEBwcml2YXRlCgogICAg
        R2V0IHRoZSBjbGFzcyBuYW1lIGZvciBhIGdpdmVuIHZhbHVlLCBiYXNlZCBv
        biB0aGUgcGF0aCwgb3B0aW9uYWwKICAgIGBjbGFzc05hbWVgIGFuZCBvcHRp
        b25hbCBgZmFsc3lDbGFzc05hbWVgLgoKICAgIC0gaWYgYSBgY2xhc3NOYW1l
        YCBvciBgZmFsc3lDbGFzc05hbWVgIGhhcyBiZWVuIHNwZWNpZmllZDoKICAg
        ICAgLSBpZiB0aGUgdmFsdWUgaXMgdHJ1dGh5IGFuZCBgY2xhc3NOYW1lYCBo
        YXMgYmVlbiBzcGVjaWZpZWQsCiAgICAgICAgYGNsYXNzTmFtZWAgaXMgcmV0
        dXJuZWQKICAgICAgLSBpZiB0aGUgdmFsdWUgaXMgZmFsc3kgYW5kIGBmYWxz
        eUNsYXNzTmFtZWAgaGFzIGJlZW4gc3BlY2lmaWVkLAogICAgICAgIGBmYWxz
        eUNsYXNzTmFtZWAgaXMgcmV0dXJuZWQKICAgICAgLSBvdGhlcndpc2UgYG51
        bGxgIGlzIHJldHVybmVkCiAgICAtIGlmIHRoZSB2YWx1ZSBpcyBgdHJ1ZWAs
        IHRoZSBkYXNoZXJpemVkIGxhc3QgcGFydCBvZiB0aGUgc3VwcGxpZWQgcGF0
        aAogICAgICBpcyByZXR1cm5lZAogICAgLSBpZiB0aGUgdmFsdWUgaXMgbm90
        IGBmYWxzZWAsIGB1bmRlZmluZWRgIG9yIGBudWxsYCwgdGhlIGB2YWx1ZWAK
        ICAgICAgaXMgcmV0dXJuZWQKICAgIC0gaWYgbm9uZSBvZiB0aGUgYWJvdmUg
        cnVsZXMgYXBwbHksIGBudWxsYCBpcyByZXR1cm5lZAoKICAgIEBtZXRob2Qg
        X2NsYXNzU3RyaW5nRm9yVmFsdWUKICAgIEBwYXJhbSBwYXRoCiAgICBAcGFy
        YW0gdmFsCiAgICBAcGFyYW0gY2xhc3NOYW1lCiAgICBAcGFyYW0gZmFsc3lD
        bGFzc05hbWUKICAgIEBzdGF0aWMKICAqLwogIF9jbGFzc1N0cmluZ0ZvclZh
        bHVlOiBmdW5jdGlvbihwYXRoLCB2YWwsIGNsYXNzTmFtZSwgZmFsc3lDbGFz
        c05hbWUpIHsKICAgIC8vIFdoZW4gdXNpbmcgdGhlIGNvbG9uIHN5bnRheCwg
        ZXZhbHVhdGUgdGhlIHRydXRoaW5lc3Mgb3IgZmFsc2luZXNzCiAgICAvLyBv
        ZiB0aGUgdmFsdWUgdG8gZGV0ZXJtaW5lIHdoaWNoIGNsYXNzTmFtZSB0byBy
        ZXR1cm4KICAgIGlmIChjbGFzc05hbWUgfHwgZmFsc3lDbGFzc05hbWUpIHsK
        ICAgICAgaWYgKGNsYXNzTmFtZSAmJiAhIXZhbCkgewogICAgICAgIHJldHVy
        biBjbGFzc05hbWU7CgogICAgICB9IGVsc2UgaWYgKGZhbHN5Q2xhc3NOYW1l
        ICYmICF2YWwpIHsKICAgICAgICByZXR1cm4gZmFsc3lDbGFzc05hbWU7Cgog
        ICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiBudWxsOwogICAgICB9Cgog
        ICAgLy8gSWYgdmFsdWUgaXMgYSBCb29sZWFuIGFuZCB0cnVlLCByZXR1cm4g
        dGhlIGRhc2hlcml6ZWQgcHJvcGVydHkKICAgIC8vIG5hbWUuCiAgICB9IGVs
        c2UgaWYgKHZhbCA9PT0gdHJ1ZSkgewogICAgICAvLyBOb3JtYWxpemUgcHJv
        cGVydHkgcGF0aCB0byBiZSBzdWl0YWJsZSBmb3IgdXNlCiAgICAgIC8vIGFz
        IGEgY2xhc3MgbmFtZS4gRm9yIGV4YXBsZSwgY29udGVudC5mb28uYmFyQmF6
        CiAgICAgIC8vIGJlY29tZXMgYmFyLWJhei4KICAgICAgdmFyIHBhcnRzID0g
        cGF0aC5zcGxpdCgnLicpOwogICAgICByZXR1cm4gRW1iZXIuU3RyaW5nLmRh
        c2hlcml6ZShwYXJ0c1twYXJ0cy5sZW5ndGgtMV0pOwoKICAgIC8vIElmIHRo
        ZSB2YWx1ZSBpcyBub3QgZmFsc2UsIHVuZGVmaW5lZCwgb3IgbnVsbCwgcmV0
        dXJuIHRoZSBjdXJyZW50CiAgICAvLyB2YWx1ZSBvZiB0aGUgcHJvcGVydHku
        CiAgICB9IGVsc2UgaWYgKHZhbCAhPT0gZmFsc2UgJiYgdmFsICE9IG51bGwp
        IHsKICAgICAgcmV0dXJuIHZhbDsKCiAgICAvLyBOb3RoaW5nIHRvIGRpc3Bs
        YXkuIFJldHVybiBudWxsIHNvIHRoYXQgdGhlIG9sZCBjbGFzcyBpcyByZW1v
        dmVkCiAgICAvLyBidXQgbm8gbmV3IGNsYXNzIGlzIGFkZGVkLgogICAgfSBl
        bHNlIHsKICAgICAgcmV0dXJuIG51bGw7CiAgICB9CiAgfQp9KTsKCnZhciBt
        dXRhdGlvbiA9IEVtYmVyLk9iamVjdC5leHRlbmQoRW1iZXIuRXZlbnRlZCku
        Y3JlYXRlKCk7CgpFbWJlci5WaWV3LmFkZE11dGF0aW9uTGlzdGVuZXIgPSBm
        dW5jdGlvbihjYWxsYmFjaykgewogIG11dGF0aW9uLm9uKCdjaGFuZ2UnLCBj
        YWxsYmFjayk7Cn07CgpFbWJlci5WaWV3LnJlbW92ZU11dGF0aW9uTGlzdGVu
        ZXIgPSBmdW5jdGlvbihjYWxsYmFjaykgewogIG11dGF0aW9uLm9mZignY2hh
        bmdlJywgY2FsbGJhY2spOwp9OwoKRW1iZXIuVmlldy5ub3RpZnlNdXRhdGlv
        bkxpc3RlbmVycyA9IGZ1bmN0aW9uKCkgewogIG11dGF0aW9uLnRyaWdnZXIo
        J2NoYW5nZScpOwp9OwoKLyoqCiAgR2xvYmFsIHZpZXdzIGhhc2gKCiAgQHBy
        b3BlcnR5IHZpZXdzCiAgQHN0YXRpYwogIEB0eXBlIEhhc2gKKi8KRW1iZXIu
        Vmlldy52aWV3cyA9IHt9OwoKLy8gSWYgc29tZW9uZSBvdmVycmlkZXMgdGhl
        IGNoaWxkIHZpZXdzIGNvbXB1dGVkIHByb3BlcnR5IHdoZW4KLy8gZGVmaW5p
        bmcgdGhlaXIgY2xhc3MsIHdlIHdhbnQgdG8gYmUgYWJsZSB0byBwcm9jZXNz
        IHRoZSB1c2VyJ3MKLy8gc3VwcGxpZWQgY2hpbGRWaWV3cyBhbmQgdGhlbiBy
        ZXN0b3JlIHRoZSBvcmlnaW5hbCBjb21wdXRlZCBwcm9wZXJ0eQovLyBhdCB2
        aWV3IGluaXRpYWxpemF0aW9uIHRpbWUuIFRoaXMgaGFwcGVucyBpbiBFbWJl
        ci5Db250YWluZXJWaWV3J3MgaW5pdAovLyBtZXRob2QuCkVtYmVyLlZpZXcu
        Y2hpbGRWaWV3c1Byb3BlcnR5ID0gY2hpbGRWaWV3c1Byb3BlcnR5OwoKRW1i
        ZXIuVmlldy5hcHBseUF0dHJpYnV0ZUJpbmRpbmdzID0gZnVuY3Rpb24oZWxl
        bSwgbmFtZSwgdmFsdWUpIHsKICB2YXIgdHlwZSA9IEVtYmVyLnR5cGVPZih2
        YWx1ZSk7CgogIC8vIGlmIHRoaXMgY2hhbmdlcywgYWxzbyBjaGFuZ2UgdGhl
        IGxvZ2ljIGluIGVtYmVyLWhhbmRsZWJhcnMvbGliL2hlbHBlcnMvYmluZGlu
        Zy5qcwogIGlmIChuYW1lICE9PSAndmFsdWUnICYmICh0eXBlID09PSAnc3Ry
        aW5nJyB8fCAodHlwZSA9PT0gJ251bWJlcicgJiYgIWlzTmFOKHZhbHVlKSkp
        KSB7CiAgICBpZiAodmFsdWUgIT09IGVsZW0uYXR0cihuYW1lKSkgewogICAg
        ICBlbGVtLmF0dHIobmFtZSwgdmFsdWUpOwogICAgfQogIH0gZWxzZSBpZiAo
        bmFtZSA9PT0gJ3ZhbHVlJyB8fCB0eXBlID09PSAnYm9vbGVhbicpIHsKICAg
        IC8vIFdlIGNhbid0IHNldCBwcm9wZXJ0aWVzIHRvIHVuZGVmaW5lZCBvciBu
        dWxsCiAgICBpZiAoRW1iZXIuaXNOb25lKHZhbHVlKSkgeyB2YWx1ZSA9ICcn
        OyB9CgogICAgaWYgKHZhbHVlICE9PSBlbGVtLnByb3AobmFtZSkpIHsKICAg
        ICAgLy8gdmFsdWUgYW5kIGJvb2xlYW5zIHNob3VsZCBhbHdheXMgYmUgcHJv
        cGVydGllcwogICAgICBlbGVtLnByb3AobmFtZSwgdmFsdWUpOwogICAgfQog
        IH0gZWxzZSBpZiAoIXZhbHVlKSB7CiAgICBlbGVtLnJlbW92ZUF0dHIobmFt
        ZSk7CiAgfQp9OwoKRW1iZXIuVmlldy5zdGF0ZXMgPSBzdGF0ZXM7Cgp9KSgp
        OwoKCgooZnVuY3Rpb24oKSB7Ci8qKgpAbW9kdWxlIGVtYmVyCkBzdWJtb2R1
        bGUgZW1iZXItdmlld3MKKi8KCnZhciBnZXQgPSBFbWJlci5nZXQsIHNldCA9
        IEVtYmVyLnNldDsKCkVtYmVyLlZpZXcuc3RhdGVzLl9kZWZhdWx0ID0gewog
        IC8vIGFwcGVuZENoaWxkIGlzIG9ubHkgbGVnYWwgd2hpbGUgcmVuZGVyaW5n
        IHRoZSBidWZmZXIuCiAgYXBwZW5kQ2hpbGQ6IGZ1bmN0aW9uKCkgewogICAg
        dGhyb3cgIllvdSBjYW4ndCB1c2UgYXBwZW5kQ2hpbGQgb3V0c2lkZSBvZiB0
        aGUgcmVuZGVyaW5nIHByb2Nlc3MiOwogIH0sCgogICQ6IGZ1bmN0aW9uKCkg
        ewogICAgcmV0dXJuIHVuZGVmaW5lZDsKICB9LAoKICBnZXRFbGVtZW50OiBm
        dW5jdGlvbigpIHsKICAgIHJldHVybiBudWxsOwogIH0sCgogIC8vIEhhbmRs
        ZSBldmVudHMgZnJvbSBgRW1iZXIuRXZlbnREaXNwYXRjaGVyYAogIGhhbmRs
        ZUV2ZW50OiBmdW5jdGlvbigpIHsKICAgIHJldHVybiB0cnVlOyAvLyBjb250
        aW51ZSBldmVudCBwcm9wYWdhdGlvbgogIH0sCgogIGRlc3Ryb3lFbGVtZW50
        OiBmdW5jdGlvbih2aWV3KSB7CiAgICBzZXQodmlldywgJ2VsZW1lbnQnLCBu
        dWxsKTsKICAgIGlmICh2aWV3Ll9zY2hlZHVsZWRJbnNlcnQpIHsKICAgICAg
        RW1iZXIucnVuLmNhbmNlbCh2aWV3Ll9zY2hlZHVsZWRJbnNlcnQpOwogICAg
        ICB2aWV3Ll9zY2hlZHVsZWRJbnNlcnQgPSBudWxsOwogICAgfQogICAgcmV0
        dXJuIHZpZXc7CiAgfSwKCiAgcmVuZGVyVG9CdWZmZXJJZk5lZWRlZDogZnVu
        Y3Rpb24gKCkgewogICAgcmV0dXJuIGZhbHNlOwogIH0sCgogIHJlcmVuZGVy
        OiBFbWJlci5LLAogIGludm9rZU9ic2VydmVyOiBFbWJlci5LCn07Cgp9KSgp
        OwoKCgooZnVuY3Rpb24oKSB7Ci8qKgpAbW9kdWxlIGVtYmVyCkBzdWJtb2R1
        bGUgZW1iZXItdmlld3MKKi8KCnZhciBwcmVSZW5kZXIgPSBFbWJlci5WaWV3
        LnN0YXRlcy5wcmVSZW5kZXIgPSBFbWJlci5jcmVhdGUoRW1iZXIuVmlldy5z
        dGF0ZXMuX2RlZmF1bHQpOwoKRW1iZXIubWVyZ2UocHJlUmVuZGVyLCB7CiAg
        Ly8gYSB2aWV3IGxlYXZlcyB0aGUgcHJlUmVuZGVyIHN0YXRlIG9uY2UgaXRz
        IGVsZW1lbnQgaGFzIGJlZW4KICAvLyBjcmVhdGVkIChjcmVhdGVFbGVtZW50
        KS4KICBpbnNlcnRFbGVtZW50OiBmdW5jdGlvbih2aWV3LCBmbikgewogICAg
        dmlldy5jcmVhdGVFbGVtZW50KCk7CiAgICB2YXIgdmlld0NvbGxlY3Rpb24g
        PSB2aWV3LnZpZXdIaWVyYXJjaHlDb2xsZWN0aW9uKCk7CgogICAgdmlld0Nv
        bGxlY3Rpb24udHJpZ2dlcignd2lsbEluc2VydEVsZW1lbnQnKTsKCiAgICBm
        bi5jYWxsKHZpZXcpOwoKICAgIC8vIFdlIHRyYW5zaXRpb24gdG8gYGluRE9N
        YCBpZiB0aGUgZWxlbWVudCBleGlzdHMgaW4gdGhlIERPTQogICAgdmFyIGVs
        ZW1lbnQgPSB2aWV3LmdldCgnZWxlbWVudCcpOwogICAgd2hpbGUgKGVsZW1l
        bnQgPSBlbGVtZW50LnBhcmVudE5vZGUpIHsKICAgICAgaWYgKGVsZW1lbnQg
        PT09IGRvY3VtZW50KSB7CiAgICAgICAgdmlld0NvbGxlY3Rpb24udHJhbnNp
        dGlvblRvKCdpbkRPTScsIGZhbHNlKTsKICAgICAgICB2aWV3Q29sbGVjdGlv
        bi50cmlnZ2VyKCdkaWRJbnNlcnRFbGVtZW50Jyk7CiAgICAgIH0KICAgIH0K
        CiAgfSwKCiAgcmVuZGVyVG9CdWZmZXJJZk5lZWRlZDogZnVuY3Rpb24odmll
        dywgYnVmZmVyKSB7CiAgICB2aWV3LnJlbmRlclRvQnVmZmVyKGJ1ZmZlcik7
        CiAgICByZXR1cm4gdHJ1ZTsKICB9LAoKICBlbXB0eTogRW1iZXIuSywKCiAg
        c2V0RWxlbWVudDogZnVuY3Rpb24odmlldywgdmFsdWUpIHsKICAgIGlmICh2
        YWx1ZSAhPT0gbnVsbCkgewogICAgICB2aWV3LnRyYW5zaXRpb25UbygnaGFz
        RWxlbWVudCcpOwogICAgfQogICAgcmV0dXJuIHZhbHVlOwogIH0KfSk7Cgp9
        KSgpOwoKCgooZnVuY3Rpb24oKSB7Ci8qKgpAbW9kdWxlIGVtYmVyCkBzdWJt
        b2R1bGUgZW1iZXItdmlld3MKKi8KCnZhciBnZXQgPSBFbWJlci5nZXQsIHNl
        dCA9IEVtYmVyLnNldDsKCnZhciBpbkJ1ZmZlciA9IEVtYmVyLlZpZXcuc3Rh
        dGVzLmluQnVmZmVyID0gRW1iZXIuY3JlYXRlKEVtYmVyLlZpZXcuc3RhdGVz
        Ll9kZWZhdWx0KTsKCkVtYmVyLm1lcmdlKGluQnVmZmVyLCB7CiAgJDogZnVu
        Y3Rpb24odmlldywgc2VsKSB7CiAgICAvLyBpZiB3ZSBkb24ndCBoYXZlIGFu
        IGVsZW1lbnQgeWV0LCBzb21lb25lIGNhbGxpbmcgdGhpcy4kKCkgaXMKICAg
        IC8vIHRyeWluZyB0byB1cGRhdGUgYW4gZWxlbWVudCB0aGF0IGlzbid0IGlu
        IHRoZSBET00uIEluc3RlYWQsCiAgICAvLyByZXJlbmRlciB0aGUgdmlldyB0
        byBhbGxvdyB0aGUgcmVuZGVyIG1ldGhvZCB0byByZWZsZWN0IHRoZQogICAg
        Ly8gY2hhbmdlcy4KICAgIHZpZXcucmVyZW5kZXIoKTsKICAgIHJldHVybiBF
        bWJlci4kKCk7CiAgfSwKCiAgLy8gd2hlbiBhIHZpZXcgaXMgcmVuZGVyZWQg
        aW4gYSBidWZmZXIsIHJlcmVuZGVyaW5nIGl0IHNpbXBseQogIC8vIHJlcGxh
        Y2VzIHRoZSBleGlzdGluZyBidWZmZXIgd2l0aCBhIG5ldyBvbmUKICByZXJl
        bmRlcjogZnVuY3Rpb24odmlldykgewogICAgdGhyb3cgbmV3IEVtYmVyLkVy
        cm9yKCJTb21ldGhpbmcgeW91IGRpZCBjYXVzZWQgYSB2aWV3IHRvIHJlLXJl
        bmRlciBhZnRlciBpdCByZW5kZXJlZCBidXQgYmVmb3JlIGl0IHdhcyBpbnNl
        cnRlZCBpbnRvIHRoZSBET00uIik7CiAgfSwKCiAgLy8gd2hlbiBhIHZpZXcg
        aXMgcmVuZGVyZWQgaW4gYSBidWZmZXIsIGFwcGVuZGluZyBhIGNoaWxkCiAg
        Ly8gdmlldyB3aWxsIHJlbmRlciB0aGF0IHZpZXcgYW5kIGFwcGVuZCB0aGUg
        cmVzdWx0aW5nCiAgLy8gYnVmZmVyIGludG8gaXRzIGJ1ZmZlci4KICBhcHBl
        bmRDaGlsZDogZnVuY3Rpb24odmlldywgY2hpbGRWaWV3LCBvcHRpb25zKSB7
        CiAgICB2YXIgYnVmZmVyID0gdmlldy5idWZmZXIsIF9jaGlsZFZpZXdzID0g
        dmlldy5fY2hpbGRWaWV3czsKCiAgICBjaGlsZFZpZXcgPSB2aWV3LmNyZWF0
        ZUNoaWxkVmlldyhjaGlsZFZpZXcsIG9wdGlvbnMpOwogICAgaWYgKCFfY2hp
        bGRWaWV3cy5sZW5ndGgpIHsgX2NoaWxkVmlld3MgPSB2aWV3Ll9jaGlsZFZp
        ZXdzID0gX2NoaWxkVmlld3Muc2xpY2UoKTsgfQogICAgX2NoaWxkVmlld3Mu
        cHVzaChjaGlsZFZpZXcpOwoKICAgIGNoaWxkVmlldy5yZW5kZXJUb0J1ZmZl
        cihidWZmZXIpOwoKICAgIHZpZXcucHJvcGVydHlEaWRDaGFuZ2UoJ2NoaWxk
        Vmlld3MnKTsKCiAgICByZXR1cm4gY2hpbGRWaWV3OwogIH0sCgogIC8vIHdo
        ZW4gYSB2aWV3IGlzIHJlbmRlcmVkIGluIGEgYnVmZmVyLCBkZXN0cm95aW5n
        IHRoZQogIC8vIGVsZW1lbnQgd2lsbCBzaW1wbHkgZGVzdHJveSB0aGUgYnVm
        ZmVyIGFuZCBwdXQgdGhlCiAgLy8gc3RhdGUgYmFjayBpbnRvIHRoZSBwcmVS
        ZW5kZXIgc3RhdGUuCiAgZGVzdHJveUVsZW1lbnQ6IGZ1bmN0aW9uKHZpZXcp
        IHsKICAgIHZpZXcuY2xlYXJCdWZmZXIoKTsKICAgIHZhciB2aWV3Q29sbGVj
        dGlvbiA9IHZpZXcuX25vdGlmeVdpbGxEZXN0cm95RWxlbWVudCgpOwogICAg
        dmlld0NvbGxlY3Rpb24udHJhbnNpdGlvblRvKCdwcmVSZW5kZXInLCBmYWxz
        ZSk7CgogICAgcmV0dXJuIHZpZXc7CiAgfSwKCiAgZW1wdHk6IGZ1bmN0aW9u
        KCkgewogICAgRW1iZXIuYXNzZXJ0KCJFbXB0eWluZyBhIHZpZXcgaW4gdGhl
        IGluQnVmZmVyIHN0YXRlIGlzIG5vdCBhbGxvd2VkIGFuZCBzaG91bGQgbm90
        IGhhcHBlbiB1bmRlciBub3JtYWwgY2lyY3Vtc3RhbmNlcy4gTW9zdCBsaWtl
        bHkgdGhlcmUgaXMgYSBidWcgaW4geW91ciBhcHBsaWNhdGlvbi4gVGhpcyBt
        YXkgYmUgZHVlIHRvIGV4Y2Vzc2l2ZSBwcm9wZXJ0eSBjaGFuZ2Ugbm90aWZp
        Y2F0aW9ucy4iKTsKICB9LAoKICByZW5kZXJUb0J1ZmZlcklmTmVlZGVkOiBm
        dW5jdGlvbiAodmlldywgYnVmZmVyKSB7CiAgICByZXR1cm4gZmFsc2U7CiAg
        fSwKCiAgLy8gSXQgc2hvdWxkIGJlIGltcG9zc2libGUgZm9yIGEgcmVuZGVy
        ZWQgdmlldyB0byBiZSBzY2hlZHVsZWQgZm9yCiAgLy8gaW5zZXJ0aW9uLgog
        IGluc2VydEVsZW1lbnQ6IGZ1bmN0aW9uKCkgewogICAgdGhyb3cgIllvdSBj
        YW4ndCBpbnNlcnQgYW4gZWxlbWVudCB0aGF0IGhhcyBhbHJlYWR5IGJlZW4g
        cmVuZGVyZWQiOwogIH0sCgogIHNldEVsZW1lbnQ6IGZ1bmN0aW9uKHZpZXcs
        IHZhbHVlKSB7CiAgICBpZiAodmFsdWUgPT09IG51bGwpIHsKICAgICAgdmll
        dy50cmFuc2l0aW9uVG8oJ3ByZVJlbmRlcicpOwogICAgfSBlbHNlIHsKICAg
        ICAgdmlldy5jbGVhckJ1ZmZlcigpOwogICAgICB2aWV3LnRyYW5zaXRpb25U
        bygnaGFzRWxlbWVudCcpOwogICAgfQoKICAgIHJldHVybiB2YWx1ZTsKICB9
        LAoKICBpbnZva2VPYnNlcnZlcjogZnVuY3Rpb24odGFyZ2V0LCBvYnNlcnZl
        cikgewogICAgb2JzZXJ2ZXIuY2FsbCh0YXJnZXQpOwogIH0KfSk7CgoKfSko
        KTsKCgoKKGZ1bmN0aW9uKCkgewovKioKQG1vZHVsZSBlbWJlcgpAc3VibW9k
        dWxlIGVtYmVyLXZpZXdzCiovCgp2YXIgZ2V0ID0gRW1iZXIuZ2V0LCBzZXQg
        PSBFbWJlci5zZXQ7Cgp2YXIgaGFzRWxlbWVudCA9IEVtYmVyLlZpZXcuc3Rh
        dGVzLmhhc0VsZW1lbnQgPSBFbWJlci5jcmVhdGUoRW1iZXIuVmlldy5zdGF0
        ZXMuX2RlZmF1bHQpOwoKRW1iZXIubWVyZ2UoaGFzRWxlbWVudCwgewogICQ6
        IGZ1bmN0aW9uKHZpZXcsIHNlbCkgewogICAgdmFyIGVsZW0gPSBnZXQodmll
        dywgJ2VsZW1lbnQnKTsKICAgIHJldHVybiBzZWwgPyBFbWJlci4kKHNlbCwg
        ZWxlbSkgOiBFbWJlci4kKGVsZW0pOwogIH0sCgogIGdldEVsZW1lbnQ6IGZ1
        bmN0aW9uKHZpZXcpIHsKICAgIHZhciBwYXJlbnQgPSBnZXQodmlldywgJ3Bh
        cmVudFZpZXcnKTsKICAgIGlmIChwYXJlbnQpIHsgcGFyZW50ID0gZ2V0KHBh
        cmVudCwgJ2VsZW1lbnQnKTsgfQogICAgaWYgKHBhcmVudCkgeyByZXR1cm4g
        dmlldy5maW5kRWxlbWVudEluUGFyZW50RWxlbWVudChwYXJlbnQpOyB9CiAg
        ICByZXR1cm4gRW1iZXIuJCgiIyIgKyBnZXQodmlldywgJ2VsZW1lbnRJZCcp
        KVswXTsKICB9LAoKICBzZXRFbGVtZW50OiBmdW5jdGlvbih2aWV3LCB2YWx1
        ZSkgewogICAgaWYgKHZhbHVlID09PSBudWxsKSB7CiAgICAgIHZpZXcudHJh
        bnNpdGlvblRvKCdwcmVSZW5kZXInKTsKICAgIH0gZWxzZSB7CiAgICAgIHRo
        cm93ICJZb3UgY2Fubm90IHNldCBhbiBlbGVtZW50IHRvIGEgbm9uLW51bGwg
        dmFsdWUgd2hlbiB0aGUgZWxlbWVudCBpcyBhbHJlYWR5IGluIHRoZSBET00u
        IjsKICAgIH0KCiAgICByZXR1cm4gdmFsdWU7CiAgfSwKCiAgLy8gb25jZSB0
        aGUgdmlldyBoYXMgYmVlbiBpbnNlcnRlZCBpbnRvIHRoZSBET00sIHJlcmVu
        ZGVyaW5nIGlzCiAgLy8gZGVmZXJyZWQgdG8gYWxsb3cgYmluZGluZ3MgdG8g
        c3luY2hyb25pemUuCiAgcmVyZW5kZXI6IGZ1bmN0aW9uKHZpZXcpIHsKICAg
        IHZpZXcudHJpZ2dlclJlY3Vyc2l2ZWx5KCd3aWxsQ2xlYXJSZW5kZXInKTsK
        CiAgICB2aWV3LmNsZWFyUmVuZGVyZWRDaGlsZHJlbigpOwoKICAgIHZpZXcu
        ZG9tTWFuYWdlci5yZXBsYWNlKHZpZXcpOwogICAgcmV0dXJuIHZpZXc7CiAg
        fSwKCiAgLy8gb25jZSB0aGUgdmlldyBpcyBhbHJlYWR5IGluIHRoZSBET00s
        IGRlc3Ryb3lpbmcgaXQgcmVtb3ZlcyBpdAogIC8vIGZyb20gdGhlIERPTSwg
        bnVrZXMgaXRzIGVsZW1lbnQsIGFuZCBwdXRzIGl0IGJhY2sgaW50byB0aGUK
        ICAvLyBwcmVSZW5kZXIgc3RhdGUgaWYgaW5ET00uCgogIGRlc3Ryb3lFbGVt
        ZW50OiBmdW5jdGlvbih2aWV3KSB7CiAgICB2aWV3Ll9ub3RpZnlXaWxsRGVz
        dHJveUVsZW1lbnQoKTsKICAgIHZpZXcuZG9tTWFuYWdlci5yZW1vdmUodmll
        dyk7CiAgICBzZXQodmlldywgJ2VsZW1lbnQnLCBudWxsKTsKICAgIGlmICh2
        aWV3Ll9zY2hlZHVsZWRJbnNlcnQpIHsKICAgICAgRW1iZXIucnVuLmNhbmNl
        bCh2aWV3Ll9zY2hlZHVsZWRJbnNlcnQpOwogICAgICB2aWV3Ll9zY2hlZHVs
        ZWRJbnNlcnQgPSBudWxsOwogICAgfQogICAgcmV0dXJuIHZpZXc7CiAgfSwK
        CiAgZW1wdHk6IGZ1bmN0aW9uKHZpZXcpIHsKICAgIHZhciBfY2hpbGRWaWV3
        cyA9IHZpZXcuX2NoaWxkVmlld3MsIGxlbiwgaWR4OwogICAgaWYgKF9jaGls
        ZFZpZXdzKSB7CiAgICAgIGxlbiA9IF9jaGlsZFZpZXdzLmxlbmd0aDsKICAg
        ICAgZm9yIChpZHggPSAwOyBpZHggPCBsZW47IGlkeCsrKSB7CiAgICAgICAg
        X2NoaWxkVmlld3NbaWR4XS5fbm90aWZ5V2lsbERlc3Ryb3lFbGVtZW50KCk7
        CiAgICAgIH0KICAgIH0KICAgIHZpZXcuZG9tTWFuYWdlci5lbXB0eSh2aWV3
        KTsKICB9LAoKICAvLyBIYW5kbGUgZXZlbnRzIGZyb20gYEVtYmVyLkV2ZW50
        RGlzcGF0Y2hlcmAKICBoYW5kbGVFdmVudDogZnVuY3Rpb24odmlldywgZXZl
        bnROYW1lLCBldnQpIHsKICAgIGlmICh2aWV3LmhhcyhldmVudE5hbWUpKSB7
        CiAgICAgIC8vIEhhbmRsZXIgc2hvdWxkIGJlIGFibGUgdG8gcmUtZGlzcGF0
        Y2ggZXZlbnRzLCBzbyB3ZSBkb24ndAogICAgICAvLyBwcmV2ZW50RGVmYXVs
        dCBvciBzdG9wUHJvcGFnYXRpb24uCiAgICAgIHJldHVybiB2aWV3LnRyaWdn
        ZXIoZXZlbnROYW1lLCBldnQpOwogICAgfSBlbHNlIHsKICAgICAgcmV0dXJu
        IHRydWU7IC8vIGNvbnRpbnVlIGV2ZW50IHByb3BhZ2F0aW9uCiAgICB9CiAg
        fSwKCiAgaW52b2tlT2JzZXJ2ZXI6IGZ1bmN0aW9uKHRhcmdldCwgb2JzZXJ2
        ZXIpIHsKICAgIG9ic2VydmVyLmNhbGwodGFyZ2V0KTsKICB9Cn0pOwoKdmFy
        IGluRE9NID0gRW1iZXIuVmlldy5zdGF0ZXMuaW5ET00gPSBFbWJlci5jcmVh
        dGUoaGFzRWxlbWVudCk7CgpFbWJlci5tZXJnZShpbkRPTSwgewogIGVudGVy
        OiBmdW5jdGlvbih2aWV3KSB7CiAgICAvLyBSZWdpc3RlciB0aGUgdmlldyBm
        b3IgZXZlbnQgaGFuZGxpbmcuIFRoaXMgaGFzaCBpcyB1c2VkIGJ5CiAgICAv
        LyBFbWJlci5FdmVudERpc3BhdGNoZXIgdG8gZGlzcGF0Y2ggaW5jb21pbmcg
        ZXZlbnRzLgogICAgaWYgKCF2aWV3LmlzVmlydHVhbCkgewogICAgICBFbWJl
        ci5hc3NlcnQoIkF0dGVtcHRlZCB0byByZWdpc3RlciBhIHZpZXcgd2l0aCBh
        biBpZCBhbHJlYWR5IGluIHVzZTogIit2aWV3LmVsZW1lbnRJZCwgIUVtYmVy
        LlZpZXcudmlld3Nbdmlldy5lbGVtZW50SWRdKTsKICAgICAgRW1iZXIuVmll
        dy52aWV3c1t2aWV3LmVsZW1lbnRJZF0gPSB2aWV3OwogICAgfQoKICAgIHZp
        ZXcuYWRkQmVmb3JlT2JzZXJ2ZXIoJ2VsZW1lbnRJZCcsIGZ1bmN0aW9uKCkg
        ewogICAgICB0aHJvdyBuZXcgRW1iZXIuRXJyb3IoIkNoYW5naW5nIGEgdmll
        dydzIGVsZW1lbnRJZCBhZnRlciBjcmVhdGlvbiBpcyBub3QgYWxsb3dlZCIp
        OwogICAgfSk7CiAgfSwKCiAgZXhpdDogZnVuY3Rpb24odmlldykgewogICAg
        aWYgKCF0aGlzLmlzVmlydHVhbCkgZGVsZXRlIEVtYmVyLlZpZXcudmlld3Nb
        dmlldy5lbGVtZW50SWRdOwogIH0sCgogIGluc2VydEVsZW1lbnQ6IGZ1bmN0
        aW9uKHZpZXcsIGZuKSB7CiAgICB0aHJvdyAiWW91IGNhbid0IGluc2VydCBh
        biBlbGVtZW50IGludG8gdGhlIERPTSB0aGF0IGhhcyBhbHJlYWR5IGJlZW4g
        aW5zZXJ0ZWQiOwogIH0KfSk7Cgp9KSgpOwoKCgooZnVuY3Rpb24oKSB7Ci8q
        KgpAbW9kdWxlIGVtYmVyCkBzdWJtb2R1bGUgZW1iZXItdmlld3MKKi8KCnZh
        ciBkZXN0cm95aW5nRXJyb3IgPSAiWW91IGNhbid0IGNhbGwgJUAgb24gYSB2
        aWV3IGJlaW5nIGRlc3Ryb3llZCIsIGZtdCA9IEVtYmVyLlN0cmluZy5mbXQ7
        Cgp2YXIgZGVzdHJveWluZyA9IEVtYmVyLlZpZXcuc3RhdGVzLmRlc3Ryb3lp
        bmcgPSBFbWJlci5jcmVhdGUoRW1iZXIuVmlldy5zdGF0ZXMuX2RlZmF1bHQp
        OwoKRW1iZXIubWVyZ2UoZGVzdHJveWluZywgewogIGFwcGVuZENoaWxkOiBm
        dW5jdGlvbigpIHsKICAgIHRocm93IGZtdChkZXN0cm95aW5nRXJyb3IsIFsn
        YXBwZW5kQ2hpbGQnXSk7CiAgfSwKICByZXJlbmRlcjogZnVuY3Rpb24oKSB7
        CiAgICB0aHJvdyBmbXQoZGVzdHJveWluZ0Vycm9yLCBbJ3JlcmVuZGVyJ10p
        OwogIH0sCiAgZGVzdHJveUVsZW1lbnQ6IGZ1bmN0aW9uKCkgewogICAgdGhy
        b3cgZm10KGRlc3Ryb3lpbmdFcnJvciwgWydkZXN0cm95RWxlbWVudCddKTsK
        ICB9LAogIGVtcHR5OiBmdW5jdGlvbigpIHsKICAgIHRocm93IGZtdChkZXN0
        cm95aW5nRXJyb3IsIFsnZW1wdHknXSk7CiAgfSwKCiAgc2V0RWxlbWVudDog
        ZnVuY3Rpb24oKSB7CiAgICB0aHJvdyBmbXQoZGVzdHJveWluZ0Vycm9yLCBb
        InNldCgnZWxlbWVudCcsIC4uLikiXSk7CiAgfSwKCiAgcmVuZGVyVG9CdWZm
        ZXJJZk5lZWRlZDogZnVuY3Rpb24oKSB7CiAgICByZXR1cm4gZmFsc2U7CiAg
        fSwKCiAgLy8gU2luY2UgZWxlbWVudCBpbnNlcnRpb24gaXMgc2NoZWR1bGVk
        LCBkb24ndCBkbyBhbnl0aGluZyBpZgogIC8vIHRoZSB2aWV3IGhhcyBiZWVu
        IGRlc3Ryb3llZCBiZXR3ZWVuIHNjaGVkdWxpbmcgYW5kIGV4ZWN1dGlvbgog
        IGluc2VydEVsZW1lbnQ6IEVtYmVyLksKfSk7CgoKfSkoKTsKCgoKKGZ1bmN0
        aW9uKCkgewpFbWJlci5WaWV3LmNsb25lU3RhdGVzID0gZnVuY3Rpb24oZnJv
        bSkgewogIHZhciBpbnRvID0ge307CgogIGludG8uX2RlZmF1bHQgPSB7fTsK
        ICBpbnRvLnByZVJlbmRlciA9IEVtYmVyLmNyZWF0ZShpbnRvLl9kZWZhdWx0
        KTsKICBpbnRvLmRlc3Ryb3lpbmcgPSBFbWJlci5jcmVhdGUoaW50by5fZGVm
        YXVsdCk7CiAgaW50by5pbkJ1ZmZlciA9IEVtYmVyLmNyZWF0ZShpbnRvLl9k
        ZWZhdWx0KTsKICBpbnRvLmhhc0VsZW1lbnQgPSBFbWJlci5jcmVhdGUoaW50
        by5fZGVmYXVsdCk7CiAgaW50by5pbkRPTSA9IEVtYmVyLmNyZWF0ZShpbnRv
        Lmhhc0VsZW1lbnQpOwoKICBmb3IgKHZhciBzdGF0ZU5hbWUgaW4gZnJvbSkg
        ewogICAgaWYgKCFmcm9tLmhhc093blByb3BlcnR5KHN0YXRlTmFtZSkpIHsg
        Y29udGludWU7IH0KICAgIEVtYmVyLm1lcmdlKGludG9bc3RhdGVOYW1lXSwg
        ZnJvbVtzdGF0ZU5hbWVdKTsKICB9CgogIHJldHVybiBpbnRvOwp9OwoKfSko
        KTsKCgoKKGZ1bmN0aW9uKCkgewp2YXIgc3RhdGVzID0gRW1iZXIuVmlldy5j
        bG9uZVN0YXRlcyhFbWJlci5WaWV3LnN0YXRlcyk7CgovKioKQG1vZHVsZSBl
        bWJlcgpAc3VibW9kdWxlIGVtYmVyLXZpZXdzCiovCgp2YXIgZ2V0ID0gRW1i
        ZXIuZ2V0LCBzZXQgPSBFbWJlci5zZXQ7CnZhciBmb3JFYWNoID0gRW1iZXIu
        RW51bWVyYWJsZVV0aWxzLmZvckVhY2g7CnZhciBWaWV3Q29sbGVjdGlvbiA9
        IEVtYmVyLl9WaWV3Q29sbGVjdGlvbjsKCi8qKgogIEEgYENvbnRhaW5lclZp
        ZXdgIGlzIGFuIGBFbWJlci5WaWV3YCBzdWJjbGFzcyB0aGF0IGltcGxlbWVu
        dHMgYEVtYmVyLk11dGFibGVBcnJheWAKICBhbGxvd2luZyBwcm9ncmFtYXRp
        YyBtYW5hZ2VtZW50IG9mIGl0cyBjaGlsZCB2aWV3cy4KCiAgIyMgU2V0dGlu
        ZyBJbml0aWFsIENoaWxkIFZpZXdzCgogIFRoZSBpbml0aWFsIGFycmF5IG9m
        IGNoaWxkIHZpZXdzIGNhbiBiZSBzZXQgaW4gb25lIG9mIHR3byB3YXlzLiBZ
        b3UgY2FuCiAgcHJvdmlkZSBhIGBjaGlsZFZpZXdzYCBwcm9wZXJ0eSBhdCBj
        cmVhdGlvbiB0aW1lIHRoYXQgY29udGFpbnMgaW5zdGFuY2Ugb2YKICBgRW1i
        ZXIuVmlld2A6CgogIGBgYGphdmFzY3JpcHQKICBhQ29udGFpbmVyID0gRW1i
        ZXIuQ29udGFpbmVyVmlldy5jcmVhdGUoewogICAgY2hpbGRWaWV3czogW0Vt
        YmVyLlZpZXcuY3JlYXRlKCksIEVtYmVyLlZpZXcuY3JlYXRlKCldCiAgfSk7
        CiAgYGBgCgogIFlvdSBjYW4gYWxzbyBwcm92aWRlIGEgbGlzdCBvZiBwcm9w
        ZXJ0eSBuYW1lcyB3aG9zZSB2YWx1ZXMgYXJlIGluc3RhbmNlcyBvZgogIGBF
        bWJlci5WaWV3YDoKCiAgYGBgamF2YXNjcmlwdAogIGFDb250YWluZXIgPSBF
        bWJlci5Db250YWluZXJWaWV3LmNyZWF0ZSh7CiAgICBjaGlsZFZpZXdzOiBb
        J2FWaWV3JywgJ2JWaWV3JywgJ2NWaWV3J10sCiAgICBhVmlldzogRW1iZXIu
        Vmlldy5jcmVhdGUoKSwKICAgIGJWaWV3OiBFbWJlci5WaWV3LmNyZWF0ZSgp
        LAogICAgY1ZpZXc6IEVtYmVyLlZpZXcuY3JlYXRlKCkKICB9KTsKICBgYGAK
        CiAgVGhlIHR3byBzdHJhdGVnaWVzIGNhbiBiZSBjb21iaW5lZDoKCiAgYGBg
        amF2YXNjcmlwdAogIGFDb250YWluZXIgPSBFbWJlci5Db250YWluZXJWaWV3
        LmNyZWF0ZSh7CiAgICBjaGlsZFZpZXdzOiBbJ2FWaWV3JywgRW1iZXIuVmll
        dy5jcmVhdGUoKV0sCiAgICBhVmlldzogRW1iZXIuVmlldy5jcmVhdGUoKQog
        IH0pOwogIGBgYAoKICBFYWNoIGNoaWxkIHZpZXcncyByZW5kZXJpbmcgd2ls
        bCBiZSBpbnNlcnRlZCBpbnRvIHRoZSBjb250YWluZXIncyByZW5kZXJlZAog
        IEhUTUwgaW4gdGhlIHNhbWUgb3JkZXIgYXMgaXRzIHBvc2l0aW9uIGluIHRo
        ZSBgY2hpbGRWaWV3c2AgcHJvcGVydHkuCgogICMjIEFkZGluZyBhbmQgUmVt
        b3ZpbmcgQ2hpbGQgVmlld3MKCiAgVGhlIGNvbnRhaW5lciB2aWV3IGltcGxl
        bWVudHMgYEVtYmVyLk11dGFibGVBcnJheWAgYWxsb3dpbmcgcHJvZ3JhbWF0
        aWMgbWFuYWdlbWVudCBvZiBpdHMgY2hpbGQgdmlld3MuCgogIFRvIHJlbW92
        ZSBhIHZpZXcsIHBhc3MgdGhhdCB2aWV3IGludG8gYSBgcmVtb3ZlT2JqZWN0
        YCBjYWxsIG9uIHRoZSBjb250YWluZXIgdmlldy4KCiAgR2l2ZW4gYW4gZW1w
        dHkgYDxib2R5PmAgdGhlIGZvbGxvd2luZyBjb2RlCgogIGBgYGphdmFzY3Jp
        cHQKICBhQ29udGFpbmVyID0gRW1iZXIuQ29udGFpbmVyVmlldy5jcmVhdGUo
        ewogICAgY2xhc3NOYW1lczogWyd0aGUtY29udGFpbmVyJ10sCiAgICBjaGls
        ZFZpZXdzOiBbJ2FWaWV3JywgJ2JWaWV3J10sCiAgICBhVmlldzogRW1iZXIu
        Vmlldy5jcmVhdGUoewogICAgICB0ZW1wbGF0ZTogRW1iZXIuSGFuZGxlYmFy
        cy5jb21waWxlKCJBIikKICAgIH0pLAogICAgYlZpZXc6IEVtYmVyLlZpZXcu
        Y3JlYXRlKHsKICAgICAgdGVtcGxhdGU6IEVtYmVyLkhhbmRsZWJhcnMuY29t
        cGlsZSgiQiIpCiAgICB9KQogIH0pOwoKICBhQ29udGFpbmVyLmFwcGVuZFRv
        KCdib2R5Jyk7CiAgYGBgCgogIFJlc3VsdHMgaW4gdGhlIEhUTUwKCiAgYGBg
        aHRtbAogIDxkaXYgY2xhc3M9ImVtYmVyLXZpZXcgdGhlLWNvbnRhaW5lciI+
        CiAgICA8ZGl2IGNsYXNzPSJlbWJlci12aWV3Ij5BPC9kaXY+CiAgICA8ZGl2
        IGNsYXNzPSJlbWJlci12aWV3Ij5CPC9kaXY+CiAgPC9kaXY+CiAgYGBgCgog
        IFJlbW92aW5nIGEgdmlldwoKICBgYGBqYXZhc2NyaXB0CiAgYUNvbnRhaW5l
        ci50b0FycmF5KCk7ICAvLyBbYUNvbnRhaW5lci5hVmlldywgYUNvbnRhaW5l
        ci5iVmlld10KICBhQ29udGFpbmVyLnJlbW92ZU9iamVjdChhQ29udGFpbmVy
        LmdldCgnYlZpZXcnKSk7CiAgYUNvbnRhaW5lci50b0FycmF5KCk7ICAvLyBb
        YUNvbnRhaW5lci5hVmlld10KICBgYGAKCiAgV2lsbCByZXN1bHQgaW4gdGhl
        IGZvbGxvd2luZyBIVE1MCgogIGBgYGh0bWwKICA8ZGl2IGNsYXNzPSJlbWJl
        ci12aWV3IHRoZS1jb250YWluZXIiPgogICAgPGRpdiBjbGFzcz0iZW1iZXIt
        dmlldyI+QTwvZGl2PgogIDwvZGl2PgogIGBgYAoKICBTaW1pbGFybHksIGFk
        ZGluZyBhIGNoaWxkIHZpZXcgaXMgYWNjb21wbGlzaGVkIGJ5IGFkZGluZyBg
        RW1iZXIuVmlld2AgaW5zdGFuY2VzIHRvIHRoZQogIGNvbnRhaW5lciB2aWV3
        LgoKICBHaXZlbiBhbiBlbXB0eSBgPGJvZHk+YCB0aGUgZm9sbG93aW5nIGNv
        ZGUKCiAgYGBgamF2YXNjcmlwdAogIGFDb250YWluZXIgPSBFbWJlci5Db250
        YWluZXJWaWV3LmNyZWF0ZSh7CiAgICBjbGFzc05hbWVzOiBbJ3RoZS1jb250
        YWluZXInXSwKICAgIGNoaWxkVmlld3M6IFsnYVZpZXcnLCAnYlZpZXcnXSwK
        ICAgIGFWaWV3OiBFbWJlci5WaWV3LmNyZWF0ZSh7CiAgICAgIHRlbXBsYXRl
        OiBFbWJlci5IYW5kbGViYXJzLmNvbXBpbGUoIkEiKQogICAgfSksCiAgICBi
        VmlldzogRW1iZXIuVmlldy5jcmVhdGUoewogICAgICB0ZW1wbGF0ZTogRW1i
        ZXIuSGFuZGxlYmFycy5jb21waWxlKCJCIikKICAgIH0pCiAgfSk7CgogIGFD
        b250YWluZXIuYXBwZW5kVG8oJ2JvZHknKTsKICBgYGAKCiAgUmVzdWx0cyBp
        biB0aGUgSFRNTAoKICBgYGBodG1sCiAgPGRpdiBjbGFzcz0iZW1iZXItdmll
        dyB0aGUtY29udGFpbmVyIj4KICAgIDxkaXYgY2xhc3M9ImVtYmVyLXZpZXci
        PkE8L2Rpdj4KICAgIDxkaXYgY2xhc3M9ImVtYmVyLXZpZXciPkI8L2Rpdj4K
        ICA8L2Rpdj4KICBgYGAKCiAgQWRkaW5nIGEgdmlldwoKICBgYGBqYXZhc2Ny
        aXB0CiAgQW5vdGhlclZpZXdDbGFzcyA9IEVtYmVyLlZpZXcuZXh0ZW5kKHsK
        ICAgIHRlbXBsYXRlOiBFbWJlci5IYW5kbGViYXJzLmNvbXBpbGUoIkFub3Ro
        ZXIgdmlldyIpCiAgfSk7CgogIGFDb250YWluZXIudG9BcnJheSgpOyAgLy8g
        W2FDb250YWluZXIuYVZpZXcsIGFDb250YWluZXIuYlZpZXddCiAgYUNvbnRh
        aW5lci5wdXNoT2JqZWN0KEFub3RoZXJWaWV3Q2xhc3MuY3JlYXRlKCkpOwog
        IGFDb250YWluZXIudG9BcnJheSgpOyAvLyBbYUNvbnRhaW5lci5hVmlldywg
        YUNvbnRhaW5lci5iVmlldywgPEFub3RoZXJWaWV3Q2xhc3MgaW5zdGFuY2U+
        XQogIGBgYAoKICBXaWxsIHJlc3VsdCBpbiB0aGUgZm9sbG93aW5nIEhUTUwK
        CiAgYGBgaHRtbAogIDxkaXYgY2xhc3M9ImVtYmVyLXZpZXcgdGhlLWNvbnRh
        aW5lciI+CiAgICA8ZGl2IGNsYXNzPSJlbWJlci12aWV3Ij5BPC9kaXY+CiAg
        ICA8ZGl2IGNsYXNzPSJlbWJlci12aWV3Ij5CPC9kaXY+CiAgICA8ZGl2IGNs
        YXNzPSJlbWJlci12aWV3Ij5Bbm90aGVyIHZpZXc8L2Rpdj4KICA8L2Rpdj4K
        ICBgYGAKCiAgIyMgVGVtcGxhdGVzIGFuZCBMYXlvdXQKCiAgQSBgdGVtcGxh
        dGVgLCBgdGVtcGxhdGVOYW1lYCwgYGRlZmF1bHRUZW1wbGF0ZWAsIGBsYXlv
        dXRgLCBgbGF5b3V0TmFtZWAgb3IKICBgZGVmYXVsdExheW91dGAgcHJvcGVy
        dHkgb24gYSBjb250YWluZXIgdmlldyB3aWxsIG5vdCByZXN1bHQgaW4gdGhl
        IHRlbXBsYXRlCiAgb3IgbGF5b3V0IGJlaW5nIHJlbmRlcmVkLiBUaGUgSFRN
        TCBjb250ZW50cyBvZiBhIGBFbWJlci5Db250YWluZXJWaWV3YCdzIERPTQog
        IHJlcHJlc2VudGF0aW9uIHdpbGwgb25seSBiZSB0aGUgcmVuZGVyZWQgSFRN
        TCBvZiBpdHMgY2hpbGQgdmlld3MuCgogIEBjbGFzcyBDb250YWluZXJWaWV3
        CiAgQG5hbWVzcGFjZSBFbWJlcgogIEBleHRlbmRzIEVtYmVyLlZpZXcKKi8K
        RW1iZXIuQ29udGFpbmVyVmlldyA9IEVtYmVyLlZpZXcuZXh0ZW5kKEVtYmVy
        Lk11dGFibGVBcnJheSwgewogIHN0YXRlczogc3RhdGVzLAoKICBpbml0OiBm
        dW5jdGlvbigpIHsKICAgIHRoaXMuX3N1cGVyKCk7CgogICAgdmFyIGNoaWxk
        Vmlld3MgPSBnZXQodGhpcywgJ2NoaWxkVmlld3MnKTsKCiAgICAvLyByZWRl
        ZmluZSB2aWV3J3MgY2hpbGRWaWV3cyBwcm9wZXJ0eSB0aGF0IHdhcyBvYmxp
        dGVyYXRlZAogICAgRW1iZXIuZGVmaW5lUHJvcGVydHkodGhpcywgJ2NoaWxk
        Vmlld3MnLCBFbWJlci5WaWV3LmNoaWxkVmlld3NQcm9wZXJ0eSk7CgogICAg
        dmFyIF9jaGlsZFZpZXdzID0gdGhpcy5fY2hpbGRWaWV3czsKCiAgICBmb3JF
        YWNoKGNoaWxkVmlld3MsIGZ1bmN0aW9uKHZpZXdOYW1lLCBpZHgpIHsKICAg
        ICAgdmFyIHZpZXc7CgogICAgICBpZiAoJ3N0cmluZycgPT09IHR5cGVvZiB2
        aWV3TmFtZSkgewogICAgICAgIHZpZXcgPSBnZXQodGhpcywgdmlld05hbWUp
        OwogICAgICAgIHZpZXcgPSB0aGlzLmNyZWF0ZUNoaWxkVmlldyh2aWV3KTsK
        ICAgICAgICBzZXQodGhpcywgdmlld05hbWUsIHZpZXcpOwogICAgICB9IGVs
        c2UgewogICAgICAgIHZpZXcgPSB0aGlzLmNyZWF0ZUNoaWxkVmlldyh2aWV3
        TmFtZSk7CiAgICAgIH0KCiAgICAgIF9jaGlsZFZpZXdzW2lkeF0gPSB2aWV3
        OwogICAgfSwgdGhpcyk7CgogICAgdmFyIGN1cnJlbnRWaWV3ID0gZ2V0KHRo
        aXMsICdjdXJyZW50VmlldycpOwogICAgaWYgKGN1cnJlbnRWaWV3KSB7CiAg
        ICAgIGlmICghX2NoaWxkVmlld3MubGVuZ3RoKSB7IF9jaGlsZFZpZXdzID0g
        dGhpcy5fY2hpbGRWaWV3cyA9IHRoaXMuX2NoaWxkVmlld3Muc2xpY2UoKTsg
        fQogICAgICBfY2hpbGRWaWV3cy5wdXNoKHRoaXMuY3JlYXRlQ2hpbGRWaWV3
        KGN1cnJlbnRWaWV3KSk7CiAgICB9CiAgfSwKCiAgcmVwbGFjZTogZnVuY3Rp
        b24oaWR4LCByZW1vdmVkQ291bnQsIGFkZGVkVmlld3MpIHsKICAgIHZhciBh
        ZGRlZENvdW50ID0gYWRkZWRWaWV3cyA/IGdldChhZGRlZFZpZXdzLCAnbGVu
        Z3RoJykgOiAwOwogICAgdmFyIHNlbGYgPSB0aGlzOwogICAgRW1iZXIuYXNz
        ZXJ0KCJZb3UgY2FuJ3QgYWRkIGEgY2hpbGQgdG8gYSBjb250YWluZXIgdGhh
        dCBpcyBhbHJlYWR5IGEgY2hpbGQgb2YgYW5vdGhlciB2aWV3IiwgRW1iZXIu
        QShhZGRlZFZpZXdzKS5ldmVyeShmdW5jdGlvbihpdGVtKSB7IHJldHVybiAh
        Z2V0KGl0ZW0sICdfcGFyZW50VmlldycpIHx8IGdldChpdGVtLCAnX3BhcmVu
        dFZpZXcnKSA9PT0gc2VsZjsgfSkpOwoKICAgIHRoaXMuYXJyYXlDb250ZW50
        V2lsbENoYW5nZShpZHgsIHJlbW92ZWRDb3VudCwgYWRkZWRDb3VudCk7CiAg
        ICB0aGlzLmNoaWxkVmlld3NXaWxsQ2hhbmdlKHRoaXMuX2NoaWxkVmlld3Ms
        IGlkeCwgcmVtb3ZlZENvdW50KTsKCiAgICBpZiAoYWRkZWRDb3VudCA9PT0g
        MCkgewogICAgICB0aGlzLl9jaGlsZFZpZXdzLnNwbGljZShpZHgsIHJlbW92
        ZWRDb3VudCkgOwogICAgfSBlbHNlIHsKICAgICAgdmFyIGFyZ3MgPSBbaWR4
        LCByZW1vdmVkQ291bnRdLmNvbmNhdChhZGRlZFZpZXdzKTsKICAgICAgaWYg
        KGFkZGVkVmlld3MubGVuZ3RoICYmICF0aGlzLl9jaGlsZFZpZXdzLmxlbmd0
        aCkgeyB0aGlzLl9jaGlsZFZpZXdzID0gdGhpcy5fY2hpbGRWaWV3cy5zbGlj
        ZSgpOyB9CiAgICAgIHRoaXMuX2NoaWxkVmlld3Muc3BsaWNlLmFwcGx5KHRo
        aXMuX2NoaWxkVmlld3MsIGFyZ3MpOwogICAgfQoKICAgIHRoaXMuYXJyYXlD
        b250ZW50RGlkQ2hhbmdlKGlkeCwgcmVtb3ZlZENvdW50LCBhZGRlZENvdW50
        KTsKICAgIHRoaXMuY2hpbGRWaWV3c0RpZENoYW5nZSh0aGlzLl9jaGlsZFZp
        ZXdzLCBpZHgsIHJlbW92ZWRDb3VudCwgYWRkZWRDb3VudCk7CgogICAgcmV0
        dXJuIHRoaXM7CiAgfSwKCiAgb2JqZWN0QXQ6IGZ1bmN0aW9uKGlkeCkgewog
        ICAgcmV0dXJuIHRoaXMuX2NoaWxkVmlld3NbaWR4XTsKICB9LAoKICBsZW5n
        dGg6IEVtYmVyLmNvbXB1dGVkKGZ1bmN0aW9uICgpIHsKICAgIHJldHVybiB0
        aGlzLl9jaGlsZFZpZXdzLmxlbmd0aDsKICB9KS52b2xhdGlsZSgpLAoKICAv
        KioKICAgIEBwcml2YXRlCgogICAgSW5zdHJ1Y3RzIGVhY2ggY2hpbGQgdmll
        dyB0byByZW5kZXIgdG8gdGhlIHBhc3NlZCByZW5kZXIgYnVmZmVyLgoKICAg
        IEBtZXRob2QgcmVuZGVyCiAgICBAcGFyYW0ge0VtYmVyLlJlbmRlckJ1ZmZl
        cn0gYnVmZmVyIHRoZSBidWZmZXIgdG8gcmVuZGVyIHRvCiAgKi8KICByZW5k
        ZXI6IGZ1bmN0aW9uKGJ1ZmZlcikgewogICAgdGhpcy5mb3JFYWNoQ2hpbGRW
        aWV3KGZ1bmN0aW9uKHZpZXcpIHsKICAgICAgdmlldy5yZW5kZXJUb0J1ZmZl
        cihidWZmZXIpOwogICAgfSk7CiAgfSwKCiAgaW5zdHJ1bWVudE5hbWU6ICdj
        b250YWluZXInLAoKICAvKioKICAgIEBwcml2YXRlCgogICAgV2hlbiBhIGNo
        aWxkIHZpZXcgaXMgcmVtb3ZlZCwgZGVzdHJveSBpdHMgZWxlbWVudCBzbyB0
        aGF0CiAgICBpdCBpcyByZW1vdmVkIGZyb20gdGhlIERPTS4KCiAgICBUaGUg
        YXJyYXkgb2JzZXJ2ZXIgdGhhdCB0cmlnZ2VycyB0aGlzIGFjdGlvbiBpcyBz
        ZXQgdXAgaW4gdGhlCiAgICBgcmVuZGVyVG9CdWZmZXJgIG1ldGhvZC4KCiAg
        ICBAbWV0aG9kIGNoaWxkVmlld3NXaWxsQ2hhbmdlCiAgICBAcGFyYW0ge0Vt
        YmVyLkFycmF5fSB2aWV3cyB0aGUgY2hpbGQgdmlld3MgYXJyYXkgYmVmb3Jl
        IG11dGF0aW9uCiAgICBAcGFyYW0ge051bWJlcn0gc3RhcnQgdGhlIHN0YXJ0
        IHBvc2l0aW9uIG9mIHRoZSBtdXRhdGlvbgogICAgQHBhcmFtIHtOdW1iZXJ9
        IHJlbW92ZWQgdGhlIG51bWJlciBvZiBjaGlsZCB2aWV3cyByZW1vdmVkCiAg
        KiovCiAgY2hpbGRWaWV3c1dpbGxDaGFuZ2U6IGZ1bmN0aW9uKHZpZXdzLCBz
        dGFydCwgcmVtb3ZlZCkgewogICAgdGhpcy5wcm9wZXJ0eVdpbGxDaGFuZ2Uo
        J2NoaWxkVmlld3MnKTsKCiAgICBpZiAocmVtb3ZlZCA+IDApIHsKICAgICAg
        dmFyIGNoYW5nZWRWaWV3cyA9IHZpZXdzLnNsaWNlKHN0YXJ0LCBzdGFydCty
        ZW1vdmVkKTsKICAgICAgLy8gdHJhbnNpdGlvbiB0byBwcmVSZW5kZXIgYmVm
        b3JlIGNsZWFyaW5nIHBhcmVudFZpZXcKICAgICAgdGhpcy5jdXJyZW50U3Rh
        dGUuY2hpbGRWaWV3c1dpbGxDaGFuZ2UodGhpcywgdmlld3MsIHN0YXJ0LCBy
        ZW1vdmVkKTsKICAgICAgdGhpcy5pbml0aWFsaXplVmlld3MoY2hhbmdlZFZp
        ZXdzLCBudWxsLCBudWxsKTsKICAgIH0KICB9LAoKICByZW1vdmVDaGlsZDog
        ZnVuY3Rpb24oY2hpbGQpIHsKICAgIHRoaXMucmVtb3ZlT2JqZWN0KGNoaWxk
        KTsKICAgIHJldHVybiB0aGlzOwogIH0sCgogIC8qKgogICAgQHByaXZhdGUK
        CiAgICBXaGVuIGEgY2hpbGQgdmlldyBpcyBhZGRlZCwgbWFrZSBzdXJlIHRo
        ZSBET00gZ2V0cyB1cGRhdGVkIGFwcHJvcHJpYXRlbHkuCgogICAgSWYgdGhl
        IHZpZXcgaGFzIGFscmVhZHkgcmVuZGVyZWQgYW4gZWxlbWVudCwgd2UgdGVs
        bCB0aGUgY2hpbGQgdmlldyB0bwogICAgY3JlYXRlIGFuIGVsZW1lbnQgYW5k
        IGluc2VydCBpdCBpbnRvIHRoZSBET00uIElmIHRoZSBlbmNsb3NpbmcgY29u
        dGFpbmVyCiAgICB2aWV3IGhhcyBhbHJlYWR5IHdyaXR0ZW4gdG8gYSBidWZm
        ZXIsIGJ1dCBub3QgeWV0IGNvbnZlcnRlZCB0aGF0IGJ1ZmZlcgogICAgaW50
        byBhbiBlbGVtZW50LCB3ZSBpbnNlcnQgdGhlIHN0cmluZyByZXByZXNlbnRh
        dGlvbiBvZiB0aGUgY2hpbGQgaW50byB0aGUKICAgIGFwcHJvcHJpYXRlIHBs
        YWNlIGluIHRoZSBidWZmZXIuCgogICAgQG1ldGhvZCBjaGlsZFZpZXdzRGlk
        Q2hhbmdlCiAgICBAcGFyYW0ge0VtYmVyLkFycmF5fSB2aWV3cyB0aGUgYXJy
        YXkgb2YgY2hpbGQgdmlld3MgYWZ0ZSB0aGUgbXV0YXRpb24gaGFzIG9jY3Vy
        cmVkCiAgICBAcGFyYW0ge051bWJlcn0gc3RhcnQgdGhlIHN0YXJ0IHBvc2l0
        aW9uIG9mIHRoZSBtdXRhdGlvbgogICAgQHBhcmFtIHtOdW1iZXJ9IHJlbW92
        ZWQgdGhlIG51bWJlciBvZiBjaGlsZCB2aWV3cyByZW1vdmVkCiAgICBAcGFy
        YW0ge051bWJlcn0gdGhlIG51bWJlciBvZiBjaGlsZCB2aWV3cyBhZGRlZAog
        ICovCiAgY2hpbGRWaWV3c0RpZENoYW5nZTogZnVuY3Rpb24odmlld3MsIHN0
        YXJ0LCByZW1vdmVkLCBhZGRlZCkgewogICAgaWYgKGFkZGVkID4gMCkgewog
        ICAgICB2YXIgY2hhbmdlZFZpZXdzID0gdmlld3Muc2xpY2Uoc3RhcnQsIHN0
        YXJ0K2FkZGVkKTsKICAgICAgdGhpcy5pbml0aWFsaXplVmlld3MoY2hhbmdl
        ZFZpZXdzLCB0aGlzLCBnZXQodGhpcywgJ3RlbXBsYXRlRGF0YScpKTsKICAg
        ICAgdGhpcy5jdXJyZW50U3RhdGUuY2hpbGRWaWV3c0RpZENoYW5nZSh0aGlz
        LCB2aWV3cywgc3RhcnQsIGFkZGVkKTsKICAgIH0KICAgIHRoaXMucHJvcGVy
        dHlEaWRDaGFuZ2UoJ2NoaWxkVmlld3MnKTsKICB9LAoKICBpbml0aWFsaXpl
        Vmlld3M6IGZ1bmN0aW9uKHZpZXdzLCBwYXJlbnRWaWV3LCB0ZW1wbGF0ZURh
        dGEpIHsKICAgIGZvckVhY2godmlld3MsIGZ1bmN0aW9uKHZpZXcpIHsKICAg
        ICAgc2V0KHZpZXcsICdfcGFyZW50VmlldycsIHBhcmVudFZpZXcpOwoKICAg
        ICAgaWYgKCF2aWV3LmNvbnRhaW5lciAmJiBwYXJlbnRWaWV3KSB7CiAgICAg
        ICAgc2V0KHZpZXcsICdjb250YWluZXInLCBwYXJlbnRWaWV3LmNvbnRhaW5l
        cik7CiAgICAgIH0KCiAgICAgIGlmICghZ2V0KHZpZXcsICd0ZW1wbGF0ZURh
        dGEnKSkgewogICAgICAgIHNldCh2aWV3LCAndGVtcGxhdGVEYXRhJywgdGVt
        cGxhdGVEYXRhKTsKICAgICAgfQogICAgfSk7CiAgfSwKCiAgY3VycmVudFZp
        ZXc6IG51bGwsCgogIF9jdXJyZW50Vmlld1dpbGxDaGFuZ2U6IEVtYmVyLmJl
        Zm9yZU9ic2VydmVyKGZ1bmN0aW9uKCkgewogICAgdmFyIGN1cnJlbnRWaWV3
        ID0gZ2V0KHRoaXMsICdjdXJyZW50VmlldycpOwogICAgaWYgKGN1cnJlbnRW
        aWV3KSB7CiAgICAgIGN1cnJlbnRWaWV3LmRlc3Ryb3koKTsKICAgIH0KICB9
        LCAnY3VycmVudFZpZXcnKSwKCiAgX2N1cnJlbnRWaWV3RGlkQ2hhbmdlOiBF
        bWJlci5vYnNlcnZlcihmdW5jdGlvbigpIHsKICAgIHZhciBjdXJyZW50Vmll
        dyA9IGdldCh0aGlzLCAnY3VycmVudFZpZXcnKTsKICAgIGlmIChjdXJyZW50
        VmlldykgewogICAgICBFbWJlci5hc3NlcnQoIllvdSB0cmllZCB0byBzZXQg
        YSBjdXJyZW50IHZpZXcgdGhhdCBhbHJlYWR5IGhhcyBhIHBhcmVudC4gTWFr
        ZSBzdXJlIHlvdSBkb24ndCBoYXZlIG11bHRpcGxlIG91dGxldHMgaW4gdGhl
        IHNhbWUgdmlldy4iLCAhZ2V0KGN1cnJlbnRWaWV3LCAnX3BhcmVudFZpZXcn
        KSk7CiAgICAgIHRoaXMucHVzaE9iamVjdChjdXJyZW50Vmlldyk7CiAgICB9
        CiAgfSwgJ2N1cnJlbnRWaWV3JyksCgogIF9lbnN1cmVDaGlsZHJlbkFyZUlu
        RE9NOiBmdW5jdGlvbiAoKSB7CiAgICB0aGlzLmN1cnJlbnRTdGF0ZS5lbnN1
        cmVDaGlsZHJlbkFyZUluRE9NKHRoaXMpOwogIH0KfSk7CgpFbWJlci5tZXJn
        ZShzdGF0ZXMuX2RlZmF1bHQsIHsKICBjaGlsZFZpZXdzV2lsbENoYW5nZTog
        RW1iZXIuSywKICBjaGlsZFZpZXdzRGlkQ2hhbmdlOiBFbWJlci5LLAogIGVu
        c3VyZUNoaWxkcmVuQXJlSW5ET006IEVtYmVyLksKfSk7CgpFbWJlci5tZXJn
        ZShzdGF0ZXMuaW5CdWZmZXIsIHsKICBjaGlsZFZpZXdzRGlkQ2hhbmdlOiBm
        dW5jdGlvbihwYXJlbnRWaWV3LCB2aWV3cywgc3RhcnQsIGFkZGVkKSB7CiAg
        ICB0aHJvdyBuZXcgRW1iZXIuRXJyb3IoJ1lvdSBjYW5ub3QgbW9kaWZ5IGNo
        aWxkIHZpZXdzIHdoaWxlIGluIHRoZSBpbkJ1ZmZlciBzdGF0ZScpOwogIH0K
        fSk7CgpFbWJlci5tZXJnZShzdGF0ZXMuaGFzRWxlbWVudCwgewogIGNoaWxk
        Vmlld3NXaWxsQ2hhbmdlOiBmdW5jdGlvbih2aWV3LCB2aWV3cywgc3RhcnQs
        IHJlbW92ZWQpIHsKICAgIGZvciAodmFyIGk9c3RhcnQ7IGk8c3RhcnQrcmVt
        b3ZlZDsgaSsrKSB7CiAgICAgIHZpZXdzW2ldLnJlbW92ZSgpOwogICAgfQog
        IH0sCgogIGNoaWxkVmlld3NEaWRDaGFuZ2U6IGZ1bmN0aW9uKHZpZXcsIHZp
        ZXdzLCBzdGFydCwgYWRkZWQpIHsKICAgIEVtYmVyLnJ1bi5zY2hlZHVsZU9u
        Y2UoJ3JlbmRlcicsIHZpZXcsICdfZW5zdXJlQ2hpbGRyZW5BcmVJbkRPTScp
        OwogIH0sCgogIGVuc3VyZUNoaWxkcmVuQXJlSW5ET006IGZ1bmN0aW9uKHZp
        ZXcpIHsKICAgIHZhciBjaGlsZFZpZXdzID0gdmlldy5fY2hpbGRWaWV3cywg
        aSwgbGVuLCBjaGlsZFZpZXcsIHByZXZpb3VzLCBidWZmZXIsIHZpZXdDb2xs
        ZWN0aW9uID0gbmV3IFZpZXdDb2xsZWN0aW9uKCk7CgogICAgZm9yIChpID0g
        MCwgbGVuID0gY2hpbGRWaWV3cy5sZW5ndGg7IGkgPCBsZW47IGkrKykgewog
        ICAgICBjaGlsZFZpZXcgPSBjaGlsZFZpZXdzW2ldOwoKICAgICAgaWYgKCFi
        dWZmZXIpIHsgYnVmZmVyID0gRW1iZXIuUmVuZGVyQnVmZmVyKCk7IGJ1ZmZl
        ci5faGFzRWxlbWVudCA9IGZhbHNlOyB9CgogICAgICBpZiAoY2hpbGRWaWV3
        LnJlbmRlclRvQnVmZmVySWZOZWVkZWQoYnVmZmVyKSkgewogICAgICAgIHZp
        ZXdDb2xsZWN0aW9uLnB1c2goY2hpbGRWaWV3KTsKICAgICAgfSBlbHNlIGlm
        ICh2aWV3Q29sbGVjdGlvbi5sZW5ndGgpIHsKICAgICAgICBpbnNlcnRWaWV3
        Q29sbGVjdGlvbih2aWV3LCB2aWV3Q29sbGVjdGlvbiwgcHJldmlvdXMsIGJ1
        ZmZlcik7CiAgICAgICAgYnVmZmVyID0gbnVsbDsKICAgICAgICBwcmV2aW91
        cyA9IGNoaWxkVmlldzsKICAgICAgICB2aWV3Q29sbGVjdGlvbi5jbGVhcigp
        OwogICAgICB9IGVsc2UgewogICAgICAgIHByZXZpb3VzID0gY2hpbGRWaWV3
        OwogICAgICB9CiAgICB9CgogICAgaWYgKHZpZXdDb2xsZWN0aW9uLmxlbmd0
        aCkgewogICAgICBpbnNlcnRWaWV3Q29sbGVjdGlvbih2aWV3LCB2aWV3Q29s
        bGVjdGlvbiwgcHJldmlvdXMsIGJ1ZmZlcik7CiAgICB9CiAgfQp9KTsKCmZ1
        bmN0aW9uIGluc2VydFZpZXdDb2xsZWN0aW9uKHZpZXcsIHZpZXdDb2xsZWN0
        aW9uLCBwcmV2aW91cywgYnVmZmVyKSB7CiAgdmlld0NvbGxlY3Rpb24udHJp
        Z2dlclJlY3Vyc2l2ZWx5KCd3aWxsSW5zZXJ0RWxlbWVudCcpOwoKICBpZiAo
        cHJldmlvdXMpIHsKICAgIHByZXZpb3VzLmRvbU1hbmFnZXIuYWZ0ZXIocHJl
        dmlvdXMsIGJ1ZmZlci5zdHJpbmcoKSk7CiAgfSBlbHNlIHsKICAgIHZpZXcu
        ZG9tTWFuYWdlci5wcmVwZW5kKHZpZXcsIGJ1ZmZlci5zdHJpbmcoKSk7CiAg
        fQoKICB2aWV3Q29sbGVjdGlvbi5mb3JFYWNoKGZ1bmN0aW9uKHYpIHsKICAg
        IHYudHJhbnNpdGlvblRvKCdpbkRPTScpOwogICAgdi5wcm9wZXJ0eURpZENo
        YW5nZSgnZWxlbWVudCcpOwogICAgdi50cmlnZ2VyUmVjdXJzaXZlbHkoJ2Rp
        ZEluc2VydEVsZW1lbnQnKTsKICB9KTsKfQoKCn0pKCk7CgoKCihmdW5jdGlv
        bigpIHsKLyoqCkBtb2R1bGUgZW1iZXIKQHN1Ym1vZHVsZSBlbWJlci12aWV3
        cwoqLwoKdmFyIGdldCA9IEVtYmVyLmdldCwgc2V0ID0gRW1iZXIuc2V0LCBm
        bXQgPSBFbWJlci5TdHJpbmcuZm10OwoKLyoqCiAgYEVtYmVyLkNvbGxlY3Rp
        b25WaWV3YCBpcyBhbiBgRW1iZXIuVmlld2AgZGVzY2VuZGVudCByZXNwb25z
        aWJsZSBmb3IgbWFuYWdpbmcKICBhIGNvbGxlY3Rpb24gKGFuIGFycmF5IG9y
        IGFycmF5LWxpa2Ugb2JqZWN0KSBieSBtYWludGFpbmluZyBhIGNoaWxkIHZp
        ZXcgb2JqZWN0CiAgYW5kIGFzc29jaWF0ZWQgRE9NIHJlcHJlc2VudGF0aW9u
        IGZvciBlYWNoIGl0ZW0gaW4gdGhlIGFycmF5IGFuZCBlbnN1cmluZwogIHRo
        YXQgY2hpbGQgdmlld3MgYW5kIHRoZWlyIGFzc29jaWF0ZWQgcmVuZGVyZWQg
        SFRNTCBhcmUgdXBkYXRlZCB3aGVuIGl0ZW1zIGluCiAgdGhlIGFycmF5IGFy
        ZSBhZGRlZCwgcmVtb3ZlZCwgb3IgcmVwbGFjZWQuCgogICMjIFNldHRpbmcg
        Y29udGVudAoKICBUaGUgbWFuYWdlZCBjb2xsZWN0aW9uIG9mIG9iamVjdHMg
        aXMgcmVmZXJlbmNlZCBhcyB0aGUgYEVtYmVyLkNvbGxlY3Rpb25WaWV3YAog
        IGluc3RhbmNlJ3MgYGNvbnRlbnRgIHByb3BlcnR5LgoKICBgYGBqYXZhc2Ny
        aXB0CiAgc29tZUl0ZW1zVmlldyA9IEVtYmVyLkNvbGxlY3Rpb25WaWV3LmNy
        ZWF0ZSh7CiAgICBjb250ZW50OiBbJ0EnLCAnQicsJ0MnXQogIH0pCiAgYGBg
        CgogIFRoZSB2aWV3IGZvciBlYWNoIGl0ZW0gaW4gdGhlIGNvbGxlY3Rpb24g
        d2lsbCBoYXZlIGl0cyBgY29udGVudGAgcHJvcGVydHkgc2V0CiAgdG8gdGhl
        IGl0ZW0uCgogICMjIFNwZWNpZnlpbmcgaXRlbVZpZXdDbGFzcwoKICBCeSBk
        ZWZhdWx0IHRoZSB2aWV3IGNsYXNzIGZvciBlYWNoIGl0ZW0gaW4gdGhlIG1h
        bmFnZWQgY29sbGVjdGlvbiB3aWxsIGJlIGFuCiAgaW5zdGFuY2Ugb2YgYEVt
        YmVyLlZpZXdgLiBZb3UgY2FuIHN1cHBseSBhIGRpZmZlcmVudCBjbGFzcyBi
        eSBzZXR0aW5nIHRoZQogIGBDb2xsZWN0aW9uVmlld2AncyBgaXRlbVZpZXdD
        bGFzc2AgcHJvcGVydHkuCgogIEdpdmVuIGFuIGVtcHR5IGA8Ym9keT5gIGFu
        ZCB0aGUgZm9sbG93aW5nIGNvZGU6CgogIGBgYGphdmFzY3JpcHQKICBzb21l
        SXRlbXNWaWV3ID0gRW1iZXIuQ29sbGVjdGlvblZpZXcuY3JlYXRlKHsKICAg
        IGNsYXNzTmFtZXM6IFsnYS1jb2xsZWN0aW9uJ10sCiAgICBjb250ZW50OiBb
        J0EnLCdCJywnQyddLAogICAgaXRlbVZpZXdDbGFzczogRW1iZXIuVmlldy5l
        eHRlbmQoewogICAgICB0ZW1wbGF0ZTogRW1iZXIuSGFuZGxlYmFycy5jb21w
        aWxlKCJ0aGUgbGV0dGVyOiB7e3ZpZXcuY29udGVudH19IikKICAgIH0pCiAg
        fSk7CgogIHNvbWVJdGVtc1ZpZXcuYXBwZW5kVG8oJ2JvZHknKTsKICBgYGAK
        CiAgV2lsbCByZXN1bHQgaW4gdGhlIGZvbGxvd2luZyBIVE1MIHN0cnVjdHVy
        ZQoKICBgYGBodG1sCiAgPGRpdiBjbGFzcz0iZW1iZXItdmlldyBhLWNvbGxl
        Y3Rpb24iPgogICAgPGRpdiBjbGFzcz0iZW1iZXItdmlldyI+dGhlIGxldHRl
        cjogQTwvZGl2PgogICAgPGRpdiBjbGFzcz0iZW1iZXItdmlldyI+dGhlIGxl
        dHRlcjogQjwvZGl2PgogICAgPGRpdiBjbGFzcz0iZW1iZXItdmlldyI+dGhl
        IGxldHRlcjogQzwvZGl2PgogIDwvZGl2PgogIGBgYAoKICAjIyBBdXRvbWF0
        aWMgbWF0Y2hpbmcgb2YgcGFyZW50L2NoaWxkIHRhZ05hbWVzCgogIFNldHRp
        bmcgdGhlIGB0YWdOYW1lYCBwcm9wZXJ0eSBvZiBhIGBDb2xsZWN0aW9uVmll
        d2AgdG8gYW55IG9mCiAgInVsIiwgIm9sIiwgInRhYmxlIiwgInRoZWFkIiwg
        InRib2R5IiwgInRmb290IiwgInRyIiwgb3IgInNlbGVjdCIgd2lsbCByZXN1
        bHQKICBpbiB0aGUgaXRlbSB2aWV3cyByZWNlaXZpbmcgYW4gYXBwcm9wcmlh
        dGVseSBtYXRjaGVkIGB0YWdOYW1lYCBwcm9wZXJ0eS4KCiAgR2l2ZW4gYW4g
        ZW1wdHkgYDxib2R5PmAgYW5kIHRoZSBmb2xsb3dpbmcgY29kZToKCiAgYGBg
        amF2YXNjcmlwdAogIGFuVW5kb3JkZXJlZExpc3RWaWV3ID0gRW1iZXIuQ29s
        bGVjdGlvblZpZXcuY3JlYXRlKHsKICAgIHRhZ05hbWU6ICd1bCcsCiAgICBj
        b250ZW50OiBbJ0EnLCdCJywnQyddLAogICAgaXRlbVZpZXdDbGFzczogRW1i
        ZXIuVmlldy5leHRlbmQoewogICAgICB0ZW1wbGF0ZTogRW1iZXIuSGFuZGxl
        YmFycy5jb21waWxlKCJ0aGUgbGV0dGVyOiB7e3ZpZXcuY29udGVudH19IikK
        ICAgIH0pCiAgfSk7CgogIGFuVW5kb3JkZXJlZExpc3RWaWV3LmFwcGVuZFRv
        KCdib2R5Jyk7CiAgYGBgCgogIFdpbGwgcmVzdWx0IGluIHRoZSBmb2xsb3dp
        bmcgSFRNTCBzdHJ1Y3R1cmUKCiAgYGBgaHRtbAogIDx1bCBjbGFzcz0iZW1i
        ZXItdmlldyBhLWNvbGxlY3Rpb24iPgogICAgPGxpIGNsYXNzPSJlbWJlci12
        aWV3Ij50aGUgbGV0dGVyOiBBPC9saT4KICAgIDxsaSBjbGFzcz0iZW1iZXIt
        dmlldyI+dGhlIGxldHRlcjogQjwvbGk+CiAgICA8bGkgY2xhc3M9ImVtYmVy
        LXZpZXciPnRoZSBsZXR0ZXI6IEM8L2xpPgogIDwvdWw+CiAgYGBgCgogIEFk
        ZGl0aW9uYWwgYHRhZ05hbWVgIHBhaXJzIGNhbiBiZSBwcm92aWRlZCBieSBh
        ZGRpbmcgdG8KICBgRW1iZXIuQ29sbGVjdGlvblZpZXcuQ09OVEFJTkVSX01B
        UCBgCgogIGBgYGphdmFzY3JpcHQKICBFbWJlci5Db2xsZWN0aW9uVmlldy5D
        T05UQUlORVJfTUFQWydhcnRpY2xlJ10gPSAnc2VjdGlvbicKICBgYGAKCiAg
        IyMgUHJvZ3JhbWF0aWMgY3JlYXRpb24gb2YgY2hpbGQgdmlld3MKCiAgRm9y
        IGNhc2VzIHdoZXJlIGFkZGl0aW9uYWwgY3VzdG9taXphdGlvbiBiZXlvbmQg
        dGhlIHVzZSBvZiBhIHNpbmdsZQogIGBpdGVtVmlld0NsYXNzYCBvciBgdGFn
        TmFtZWAgbWF0Y2hpbmcgaXMgcmVxdWlyZWQgQ29sbGVjdGlvblZpZXcncwog
        IGBjcmVhdGVDaGlsZFZpZXdgIG1ldGhvZCBjYW4gYmUgb3ZlcmlkZGVuOgoK
        ICBgYGBqYXZhc2NyaXB0CiAgQ3VzdG9tQ29sbGVjdGlvblZpZXcgPSBFbWJl
        ci5Db2xsZWN0aW9uVmlldy5leHRlbmQoewogICAgY3JlYXRlQ2hpbGRWaWV3
        OiBmdW5jdGlvbih2aWV3Q2xhc3MsIGF0dHJzKSB7CiAgICAgIGlmIChhdHRy
        cy5jb250ZW50LmtpbmQgPT0gJ2FsYnVtJykgewogICAgICAgIHZpZXdDbGFz
        cyA9IEFwcC5BbGJ1bVZpZXc7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdmll
        d0NsYXNzID0gQXBwLlNvbmdWaWV3OwogICAgICB9CiAgICAgIHJldHVybiB0
        aGlzLl9zdXBlcih2aWV3Q2xhc3MsIGF0dHJzKTsKICAgIH0KICB9KTsKICBg
        YGAKCiAgIyMgRW1wdHkgVmlldwoKICBZb3UgY2FuIHByb3ZpZGUgYW4gYEVt
        YmVyLlZpZXdgIHN1YmNsYXNzIHRvIHRoZSBgRW1iZXIuQ29sbGVjdGlvblZp
        ZXdgCiAgaW5zdGFuY2UgYXMgaXRzIGBlbXB0eVZpZXdgIHByb3BlcnR5LiBJ
        ZiB0aGUgYGNvbnRlbnRgIHByb3BlcnR5IG9mIGEKICBgQ29sbGVjdGlvblZp
        ZXdgIGlzIHNldCB0byBgbnVsbGAgb3IgYW4gZW1wdHkgYXJyYXksIGFuIGlu
        c3RhbmNlIG9mIHRoaXMgdmlldwogIHdpbGwgYmUgdGhlIGBDb2xsZWN0aW9u
        Vmlld2BzIG9ubHkgY2hpbGQuCgogIGBgYGphdmFzY3JpcHQKICBhTGlzdFdp
        dGhOb3RoaW5nID0gRW1iZXIuQ29sbGVjdGlvblZpZXcuY3JlYXRlKHsKICAg
        IGNsYXNzTmFtZXM6IFsnbm90aGluZyddCiAgICBjb250ZW50OiBudWxsLAog
        ICAgZW1wdHlWaWV3OiBFbWJlci5WaWV3LmV4dGVuZCh7CiAgICAgIHRlbXBs
        YXRlOiBFbWJlci5IYW5kbGViYXJzLmNvbXBpbGUoIlRoZSBjb2xsZWN0aW9u
        IGlzIGVtcHR5IikKICAgIH0pCiAgfSk7CgogIGFMaXN0V2l0aE5vdGhpbmcu
        YXBwZW5kVG8oJ2JvZHknKTsKICBgYGAKCiAgV2lsbCByZXN1bHQgaW4gdGhl
        IGZvbGxvd2luZyBIVE1MIHN0cnVjdHVyZQoKICBgYGBodG1sCiAgPGRpdiBj
        bGFzcz0iZW1iZXItdmlldyBub3RoaW5nIj4KICAgIDxkaXYgY2xhc3M9ImVt
        YmVyLXZpZXciPgogICAgICBUaGUgY29sbGVjdGlvbiBpcyBlbXB0eQogICAg
        PC9kaXY+CiAgPC9kaXY+CiAgYGBgCgogICMjIEFkZGluZyBhbmQgUmVtb3Zp
        bmcgaXRlbXMKCiAgVGhlIGBjaGlsZFZpZXdzYCBwcm9wZXJ0eSBvZiBhIGBD
        b2xsZWN0aW9uVmlld2Agc2hvdWxkIG5vdCBiZSBkaXJlY3RseQogIG1hbmlw
        dWxhdGVkLiBJbnN0ZWFkLCBhZGQsIHJlbW92ZSwgcmVwbGFjZSBpdGVtcyBm
        cm9tIGl0cyBgY29udGVudGAgcHJvcGVydHkuCiAgVGhpcyB3aWxsIHRyaWdn
        ZXIgYXBwcm9wcmlhdGUgY2hhbmdlcyB0byBpdHMgcmVuZGVyZWQgSFRNTC4K
        CgogIEBjbGFzcyBDb2xsZWN0aW9uVmlldwogIEBuYW1lc3BhY2UgRW1iZXIK
        ICBAZXh0ZW5kcyBFbWJlci5Db250YWluZXJWaWV3CiAgQHNpbmNlIEVtYmVy
        IDAuOQoqLwpFbWJlci5Db2xsZWN0aW9uVmlldyA9IEVtYmVyLkNvbnRhaW5l
        clZpZXcuZXh0ZW5kKC8qKiBAc2NvcGUgRW1iZXIuQ29sbGVjdGlvblZpZXcu
        cHJvdG90eXBlICovIHsKCiAgLyoqCiAgICBBIGxpc3Qgb2YgaXRlbXMgdG8g
        YmUgZGlzcGxheWVkIGJ5IHRoZSBgRW1iZXIuQ29sbGVjdGlvblZpZXdgLgoK
        ICAgIEBwcm9wZXJ0eSBjb250ZW50CiAgICBAdHlwZSBFbWJlci5BcnJheQog
        ICAgQGRlZmF1bHQgbnVsbAogICovCiAgY29udGVudDogbnVsbCwKCiAgLyoq
        CiAgICBAcHJpdmF0ZQoKICAgIFRoaXMgcHJvdmlkZXMgbWV0YWRhdGEgYWJv
        dXQgd2hhdCBraW5kIG9mIGVtcHR5IHZpZXcgY2xhc3MgdGhpcwogICAgY29s
        bGVjdGlvbiB3b3VsZCBsaWtlIGlmIGl0IGlzIGJlaW5nIGluc3RhbnRpYXRl
        ZCBmcm9tIGFub3RoZXIKICAgIHN5c3RlbSAobGlrZSBIYW5kbGViYXJzKQoK
        ICAgIEBwcm9wZXJ0eSBlbXB0eVZpZXdDbGFzcwogICovCiAgZW1wdHlWaWV3
        Q2xhc3M6IEVtYmVyLlZpZXcsCgogIC8qKgogICAgQW4gb3B0aW9uYWwgdmll
        dyB0byBkaXNwbGF5IGlmIGNvbnRlbnQgaXMgc2V0IHRvIGFuIGVtcHR5IGFy
        cmF5LgoKICAgIEBwcm9wZXJ0eSBlbXB0eVZpZXcKICAgIEB0eXBlIEVtYmVy
        LlZpZXcKICAgIEBkZWZhdWx0IG51bGwKICAqLwogIGVtcHR5VmlldzogbnVs
        bCwKCiAgLyoqCiAgICBAcHJvcGVydHkgaXRlbVZpZXdDbGFzcwogICAgQHR5
        cGUgRW1iZXIuVmlldwogICAgQGRlZmF1bHQgRW1iZXIuVmlldwogICovCiAg
        aXRlbVZpZXdDbGFzczogRW1iZXIuVmlldywKCiAgLyoqCiAgICBTZXR1cCBh
        IENvbGxlY3Rpb25WaWV3CgogICAgQG1ldGhvZCBpbml0CiAgKi8KICBpbml0
        OiBmdW5jdGlvbigpIHsKICAgIHZhciByZXQgPSB0aGlzLl9zdXBlcigpOwog
        ICAgdGhpcy5fY29udGVudERpZENoYW5nZSgpOwogICAgcmV0dXJuIHJldDsK
        ICB9LAoKICAvKioKICAgIEBwcml2YXRlCgogICAgSW52b2tlZCB3aGVuIHRo
        ZSBjb250ZW50IHByb3BlcnR5IGlzIGFib3V0IHRvIGNoYW5nZS4gTm90aWZp
        ZXMgb2JzZXJ2ZXJzIHRoYXQgdGhlCiAgICBlbnRpcmUgYXJyYXkgY29udGVu
        dCB3aWxsIGNoYW5nZS4KCiAgICBAbWV0aG9kIF9jb250ZW50V2lsbENoYW5n
        ZQogICovCiAgX2NvbnRlbnRXaWxsQ2hhbmdlOiBFbWJlci5iZWZvcmVPYnNl
        cnZlcihmdW5jdGlvbigpIHsKICAgIHZhciBjb250ZW50ID0gdGhpcy5nZXQo
        J2NvbnRlbnQnKTsKCiAgICBpZiAoY29udGVudCkgeyBjb250ZW50LnJlbW92
        ZUFycmF5T2JzZXJ2ZXIodGhpcyk7IH0KICAgIHZhciBsZW4gPSBjb250ZW50
        ID8gZ2V0KGNvbnRlbnQsICdsZW5ndGgnKSA6IDA7CiAgICB0aGlzLmFycmF5
        V2lsbENoYW5nZShjb250ZW50LCAwLCBsZW4pOwogIH0sICdjb250ZW50Jyks
        CgogIC8qKgogICAgQHByaXZhdGUKCiAgICBDaGVjayB0byBtYWtlIHN1cmUg
        dGhhdCB0aGUgY29udGVudCBoYXMgY2hhbmdlZCwgYW5kIGlmIHNvLAogICAg
        dXBkYXRlIHRoZSBjaGlsZHJlbiBkaXJlY3RseS4gVGhpcyBpcyBhbHdheXMg
        c2NoZWR1bGVkCiAgICBhc3luY2hyb25vdXNseSwgdG8gYWxsb3cgdGhlIGVs
        ZW1lbnQgdG8gYmUgY3JlYXRlZCBiZWZvcmUKICAgIGJpbmRpbmdzIGhhdmUg
        c3luY2hyb25pemVkIGFuZCB2aWNlIHZlcnNhLgoKICAgIEBtZXRob2QgX2Nv
        bnRlbnREaWRDaGFuZ2UKICAqLwogIF9jb250ZW50RGlkQ2hhbmdlOiBFbWJl
        ci5vYnNlcnZlcihmdW5jdGlvbigpIHsKICAgIHZhciBjb250ZW50ID0gZ2V0
        KHRoaXMsICdjb250ZW50Jyk7CgogICAgaWYgKGNvbnRlbnQpIHsKICAgICAg
        dGhpcy5fYXNzZXJ0QXJyYXlMaWtlKGNvbnRlbnQpOwogICAgICBjb250ZW50
        LmFkZEFycmF5T2JzZXJ2ZXIodGhpcyk7CiAgICB9CgogICAgdmFyIGxlbiA9
        IGNvbnRlbnQgPyBnZXQoY29udGVudCwgJ2xlbmd0aCcpIDogMDsKICAgIHRo
        aXMuYXJyYXlEaWRDaGFuZ2UoY29udGVudCwgMCwgbnVsbCwgbGVuKTsKICB9
        LCAnY29udGVudCcpLAoKICAvKioKICAgIEBwcml2YXRlCgogICAgRW5zdXJl
        IHRoYXQgdGhlIGNvbnRlbnQgaW1wbGVtZW50cyBFbWJlci5BcnJheQoKICAg
        IEBtZXRob2QgX2Fzc2VydEFycmF5TGlrZQogICovCiAgX2Fzc2VydEFycmF5
        TGlrZTogZnVuY3Rpb24oY29udGVudCkgewogICAgRW1iZXIuYXNzZXJ0KGZt
        dCgiYW4gRW1iZXIuQ29sbGVjdGlvblZpZXcncyBjb250ZW50IG11c3QgaW1w
        bGVtZW50IEVtYmVyLkFycmF5LiBZb3UgcGFzc2VkICVAIiwgW2NvbnRlbnRd
        KSwgRW1iZXIuQXJyYXkuZGV0ZWN0KGNvbnRlbnQpKTsKICB9LAoKICAvKioK
        ICAgIFJlbW92ZXMgdGhlIGNvbnRlbnQgYW5kIGNvbnRlbnQgb2JzZXJ2ZXJz
        LgoKICAgIEBtZXRob2QgZGVzdHJveQogICovCiAgZGVzdHJveTogZnVuY3Rp
        b24oKSB7CiAgICBpZiAoIXRoaXMuX3N1cGVyKCkpIHsgcmV0dXJuOyB9Cgog
        ICAgdmFyIGNvbnRlbnQgPSBnZXQodGhpcywgJ2NvbnRlbnQnKTsKICAgIGlm
        IChjb250ZW50KSB7IGNvbnRlbnQucmVtb3ZlQXJyYXlPYnNlcnZlcih0aGlz
        KTsgfQoKICAgIGlmICh0aGlzLl9jcmVhdGVkRW1wdHlWaWV3KSB7CiAgICAg
        IHRoaXMuX2NyZWF0ZWRFbXB0eVZpZXcuZGVzdHJveSgpOwogICAgfQoKICAg
        IHJldHVybiB0aGlzOwogIH0sCgogIC8qKgogICAgQ2FsbGVkIHdoZW4gYSBt
        dXRhdGlvbiB0byB0aGUgdW5kZXJseWluZyBjb250ZW50IGFycmF5IHdpbGwg
        b2NjdXIuCgogICAgVGhpcyBtZXRob2Qgd2lsbCByZW1vdmUgYW55IHZpZXdz
        IHRoYXQgYXJlIG5vIGxvbmdlciBpbiB0aGUgdW5kZXJseWluZwogICAgY29u
        dGVudCBhcnJheS4KCiAgICBJbnZva2VzIHdoZW5ldmVyIHRoZSBjb250ZW50
        IGFycmF5IGl0c2VsZiB3aWxsIGNoYW5nZS4KCiAgICBAbWV0aG9kIGFycmF5
        V2lsbENoYW5nZQogICAgQHBhcmFtIHtBcnJheX0gY29udGVudCB0aGUgbWFu
        YWdlZCBjb2xsZWN0aW9uIG9mIG9iamVjdHMKICAgIEBwYXJhbSB7TnVtYmVy
        fSBzdGFydCB0aGUgaW5kZXggYXQgd2hpY2ggdGhlIGNoYW5nZXMgd2lsbCBv
        Y2N1cnIKICAgIEBwYXJhbSB7TnVtYmVyfSByZW1vdmVkIG51bWJlciBvZiBv
        YmplY3QgdG8gYmUgcmVtb3ZlZCBmcm9tIGNvbnRlbnQKICAqLwogIGFycmF5
        V2lsbENoYW5nZTogZnVuY3Rpb24oY29udGVudCwgc3RhcnQsIHJlbW92ZWRD
        b3VudCkgewogICAgLy8gSWYgdGhlIGNvbnRlbnRzIHdlcmUgZW1wdHkgYmVm
        b3JlIGFuZCB0aGlzIHRlbXBsYXRlIGNvbGxlY3Rpb24gaGFzIGFuCiAgICAv
        LyBlbXB0eSB2aWV3IHJlbW92ZSBpdCBub3cuCiAgICB2YXIgZW1wdHlWaWV3
        ID0gZ2V0KHRoaXMsICdlbXB0eVZpZXcnKTsKICAgIGlmIChlbXB0eVZpZXcg
        JiYgZW1wdHlWaWV3IGluc3RhbmNlb2YgRW1iZXIuVmlldykgewogICAgICBl
        bXB0eVZpZXcucmVtb3ZlRnJvbVBhcmVudCgpOwogICAgfQoKICAgIC8vIExv
        b3AgdGhyb3VnaCBjaGlsZCB2aWV3cyB0aGF0IGNvcnJlc3BvbmQgd2l0aCB0
        aGUgcmVtb3ZlZCBpdGVtcy4KICAgIC8vIE5vdGUgdGhhdCB3ZSBsb29wIGZy
        b20gdGhlIGVuZCBvZiB0aGUgYXJyYXkgdG8gdGhlIGJlZ2lubmluZyBiZWNh
        dXNlCiAgICAvLyB3ZSBhcmUgbXV0YXRpbmcgaXQgYXMgd2UgZ28uCiAgICB2
        YXIgY2hpbGRWaWV3cyA9IHRoaXMuX2NoaWxkVmlld3MsIGNoaWxkVmlldywg
        aWR4LCBsZW47CgogICAgbGVuID0gdGhpcy5fY2hpbGRWaWV3cy5sZW5ndGg7
        CgogICAgdmFyIHJlbW92aW5nQWxsID0gcmVtb3ZlZENvdW50ID09PSBsZW47
        CgogICAgaWYgKHJlbW92aW5nQWxsKSB7CiAgICAgIHRoaXMuY3VycmVudFN0
        YXRlLmVtcHR5KHRoaXMpOwogICAgICB0aGlzLmludm9rZVJlY3Vyc2l2ZWx5
        KGZ1bmN0aW9uKHZpZXcpIHsKICAgICAgICB2aWV3LnJlbW92ZWRGcm9tRE9N
        ID0gdHJ1ZTsKICAgICAgfSwgZmFsc2UpOwogICAgfQoKICAgIGZvciAoaWR4
        ID0gc3RhcnQgKyByZW1vdmVkQ291bnQgLSAxOyBpZHggPj0gc3RhcnQ7IGlk
        eC0tKSB7CiAgICAgIGNoaWxkVmlldyA9IGNoaWxkVmlld3NbaWR4XTsKICAg
        ICAgY2hpbGRWaWV3LmRlc3Ryb3koKTsKICAgIH0KICB9LAoKICAvKioKICAg
        IENhbGxlZCB3aGVuIGEgbXV0YXRpb24gdG8gdGhlIHVuZGVybHlpbmcgY29u
        dGVudCBhcnJheSBvY2N1cnMuCgogICAgVGhpcyBtZXRob2Qgd2lsbCByZXBs
        YXkgdGhhdCBtdXRhdGlvbiBhZ2FpbnN0IHRoZSB2aWV3cyB0aGF0IGNvbXBv
        c2UgdGhlCiAgICBgRW1iZXIuQ29sbGVjdGlvblZpZXdgLCBlbnN1cmluZyB0
        aGF0IHRoZSB2aWV3IHJlZmxlY3RzIHRoZSBtb2RlbC4KCiAgICBUaGlzIGFy
        cmF5IG9ic2VydmVyIGlzIGFkZGVkIGluIGBjb250ZW50RGlkQ2hhbmdlYC4K
        CiAgICBAbWV0aG9kIGFycmF5RGlkQ2hhbmdlCiAgICBAcGFyYW0ge0FycmF5
        fSBjb250ZW50IHRoZSBtYW5hZ2VkIGNvbGxlY3Rpb24gb2Ygb2JqZWN0cwog
        ICAgQHBhcmFtIHtOdW1iZXJ9IHN0YXJ0IHRoZSBpbmRleCBhdCB3aGljaCB0
        aGUgY2hhbmdlcyBvY2N1cnJlZAogICAgQHBhcmFtIHtOdW1iZXJ9IHJlbW92
        ZWQgbnVtYmVyIG9mIG9iamVjdCByZW1vdmVkIGZyb20gY29udGVudAogICAg
        QHBhcmFtIHtOdW1iZXJ9IGFkZGVkIG51bWJlciBvZiBvYmplY3QgYWRkZWQg
        dG8gY29udGVudAogICovCiAgYXJyYXlEaWRDaGFuZ2U6IGZ1bmN0aW9uKGNv
        bnRlbnQsIHN0YXJ0LCByZW1vdmVkLCBhZGRlZCkgewogICAgdmFyIGFkZGVk
        Vmlld3MgPSBbXSwgdmlldywgaXRlbSwgaWR4LCBsZW4sIGl0ZW1WaWV3Q2xh
        c3MsCiAgICAgIGVtcHR5VmlldzsKCiAgICBsZW4gPSBjb250ZW50ID8gZ2V0
        KGNvbnRlbnQsICdsZW5ndGgnKSA6IDA7CgogICAgaWYgKGxlbikgewogICAg
        ICBpdGVtVmlld0NsYXNzID0gZ2V0KHRoaXMsICdpdGVtVmlld0NsYXNzJyk7
        CgogICAgICBpZiAoJ3N0cmluZycgPT09IHR5cGVvZiBpdGVtVmlld0NsYXNz
        KSB7CiAgICAgICAgaXRlbVZpZXdDbGFzcyA9IGdldChpdGVtVmlld0NsYXNz
        KSB8fCBpdGVtVmlld0NsYXNzOwogICAgICB9CgogICAgICBFbWJlci5hc3Nl
        cnQoZm10KCJpdGVtVmlld0NsYXNzIG11c3QgYmUgYSBzdWJjbGFzcyBvZiBF
        bWJlci5WaWV3LCBub3QgJUAiLCBbaXRlbVZpZXdDbGFzc10pLCAnc3RyaW5n
        JyA9PT0gdHlwZW9mIGl0ZW1WaWV3Q2xhc3MgfHwgRW1iZXIuVmlldy5kZXRl
        Y3QoaXRlbVZpZXdDbGFzcykpOwoKICAgICAgZm9yIChpZHggPSBzdGFydDsg
        aWR4IDwgc3RhcnQrYWRkZWQ7IGlkeCsrKSB7CiAgICAgICAgaXRlbSA9IGNv
        bnRlbnQub2JqZWN0QXQoaWR4KTsKCiAgICAgICAgdmlldyA9IHRoaXMuY3Jl
        YXRlQ2hpbGRWaWV3KGl0ZW1WaWV3Q2xhc3MsIHsKICAgICAgICAgIGNvbnRl
        bnQ6IGl0ZW0sCiAgICAgICAgICBjb250ZW50SW5kZXg6IGlkeAogICAgICAg
        IH0pOwoKICAgICAgICBhZGRlZFZpZXdzLnB1c2godmlldyk7CiAgICAgIH0K
        ICAgIH0gZWxzZSB7CiAgICAgIGVtcHR5VmlldyA9IGdldCh0aGlzLCAnZW1w
        dHlWaWV3Jyk7CgogICAgICBpZiAoIWVtcHR5VmlldykgeyByZXR1cm47IH0K
        CiAgICAgIGlmICgnc3RyaW5nJyA9PT0gdHlwZW9mIGVtcHR5Vmlldykgewog
        ICAgICAgIGVtcHR5VmlldyA9IGdldChlbXB0eVZpZXcpIHx8IGVtcHR5Vmll
        dzsKICAgICAgfQoKICAgICAgZW1wdHlWaWV3ID0gdGhpcy5jcmVhdGVDaGls
        ZFZpZXcoZW1wdHlWaWV3KTsKICAgICAgYWRkZWRWaWV3cy5wdXNoKGVtcHR5
        Vmlldyk7CiAgICAgIHNldCh0aGlzLCAnZW1wdHlWaWV3JywgZW1wdHlWaWV3
        KTsKCiAgICAgIGlmIChFbWJlci5Db3JlVmlldy5kZXRlY3QoZW1wdHlWaWV3
        KSkgewogICAgICAgIHRoaXMuX2NyZWF0ZWRFbXB0eVZpZXcgPSBlbXB0eVZp
        ZXc7CiAgICAgIH0KICAgIH0KCiAgICB0aGlzLnJlcGxhY2Uoc3RhcnQsIDAs
        IGFkZGVkVmlld3MpOwogIH0sCgogIC8qKgogICAgSW5zdGFudGlhdGVzIGEg
        dmlldyB0byBiZSBhZGRlZCB0byB0aGUgY2hpbGRWaWV3cyBhcnJheSBkdXJp
        bmcgdmlldwogICAgaW5pdGlhbGl6YXRpb24uIFlvdSBnZW5lcmFsbHkgd2ls
        bCBub3QgY2FsbCB0aGlzIG1ldGhvZCBkaXJlY3RseSB1bmxlc3MKICAgIHlv
        dSBhcmUgb3ZlcnJpZGluZyBgY3JlYXRlQ2hpbGRWaWV3cygpYC4gTm90ZSB0
        aGF0IHRoaXMgbWV0aG9kIHdpbGwKICAgIGF1dG9tYXRpY2FsbHkgY29uZmln
        dXJlIHRoZSBjb3JyZWN0IHNldHRpbmdzIG9uIHRoZSBuZXcgdmlldyBpbnN0
        YW5jZSB0bwogICAgYWN0IGFzIGEgY2hpbGQgb2YgdGhlIHBhcmVudC4KCiAg
        ICBUaGUgdGFnIG5hbWUgZm9yIHRoZSB2aWV3IHdpbGwgYmUgc2V0IHRvIHRo
        ZSB0YWdOYW1lIG9mIHRoZSB2aWV3Q2xhc3MKICAgIHBhc3NlZCBpbi4KCiAg
        ICBAbWV0aG9kIGNyZWF0ZUNoaWxkVmlldwogICAgQHBhcmFtIHtDbGFzc30g
        dmlld0NsYXNzCiAgICBAcGFyYW0ge0hhc2h9IFthdHRyc10gQXR0cmlidXRl
        cyB0byBhZGQKICAgIEByZXR1cm4ge0VtYmVyLlZpZXd9IG5ldyBpbnN0YW5j
        ZQogICovCiAgY3JlYXRlQ2hpbGRWaWV3OiBmdW5jdGlvbih2aWV3LCBhdHRy
        cykgewogICAgdmlldyA9IHRoaXMuX3N1cGVyKHZpZXcsIGF0dHJzKTsKCiAg
        ICB2YXIgaXRlbVRhZ05hbWUgPSBnZXQodmlldywgJ3RhZ05hbWUnKTsKCiAg
        ICBpZiAoaXRlbVRhZ05hbWUgPT09IG51bGwgfHwgaXRlbVRhZ05hbWUgPT09
        IHVuZGVmaW5lZCkgewogICAgICBpdGVtVGFnTmFtZSA9IEVtYmVyLkNvbGxl
        Y3Rpb25WaWV3LkNPTlRBSU5FUl9NQVBbZ2V0KHRoaXMsICd0YWdOYW1lJyld
        OwogICAgICBzZXQodmlldywgJ3RhZ05hbWUnLCBpdGVtVGFnTmFtZSk7CiAg
        ICB9CgogICAgcmV0dXJuIHZpZXc7CiAgfQp9KTsKCi8qKgogIEEgbWFwIG9m
        IHBhcmVudCB0YWdzIHRvIHRoZWlyIGRlZmF1bHQgY2hpbGQgdGFncy4gWW91
        IGNhbiBhZGQKICBhZGRpdGlvbmFsIHBhcmVudCB0YWdzIGlmIHlvdSB3YW50
        IGNvbGxlY3Rpb24gdmlld3MgdGhhdCB1c2UKICBhIHBhcnRpY3VsYXIgcGFy
        ZW50IHRhZyB0byBkZWZhdWx0IHRvIGEgY2hpbGQgdGFnLgoKICBAcHJvcGVy
        dHkgQ09OVEFJTkVSX01BUAogIEB0eXBlIEhhc2gKICBAc3RhdGljCiAgQGZp
        bmFsCiovCkVtYmVyLkNvbGxlY3Rpb25WaWV3LkNPTlRBSU5FUl9NQVAgPSB7
        CiAgdWw6ICdsaScsCiAgb2w6ICdsaScsCiAgdGFibGU6ICd0cicsCiAgdGhl
        YWQ6ICd0cicsCiAgdGJvZHk6ICd0cicsCiAgdGZvb3Q6ICd0cicsCiAgdHI6
        ICd0ZCcsCiAgc2VsZWN0OiAnb3B0aW9uJwp9OwoKfSkoKTsKCgoKKGZ1bmN0
        aW9uKCkgewp2YXIgZ2V0ID0gRW1iZXIuZ2V0LCBzZXQgPSBFbWJlci5zZXQs
        IGlzTm9uZSA9IEVtYmVyLmlzTm9uZSwKICAgIGFfc2xpY2UgPSBBcnJheS5w
        cm90b3R5cGUuc2xpY2U7CgoKLyoqCkBtb2R1bGUgZW1iZXIKQHN1Ym1vZHVs
        ZSBlbWJlci12aWV3cwoqLwoKLyoqCiAgQW4gYEVtYmVyLkNvbXBvbmVudGAg
        aXMgYSB2aWV3IHRoYXQgaXMgY29tcGxldGVseQogIGlzb2xhdGVkLiBQcm9w
        ZXJ0eSBhY2Nlc3MgaW4gaXRzIHRlbXBsYXRlcyBnbwogIHRvIHRoZSB2aWV3
        IG9iamVjdCBhbmQgYWN0aW9ucyBhcmUgdGFyZ2V0ZWQgYXQKICB0aGUgdmll
        dyBvYmplY3QuIFRoZXJlIGlzIG5vIGFjY2VzcyB0byB0aGUKICBzdXJyb3Vu
        ZGluZyBjb250ZXh0IG9yIG91dGVyIGNvbnRyb2xsZXI7IGFsbAogIGNvbnRl
        eHR1YWwgaW5mb3JtYXRpb24gaXMgcGFzc2VkIGluLgoKICBUaGUgZWFzaWVz
        dCB3YXkgdG8gY3JlYXRlIGFuIGBFbWJlci5Db21wb25lbnRgIGlzIHZpYQog
        IGEgdGVtcGxhdGUuIElmIHlvdSBuYW1lIGEgdGVtcGxhdGUKICBgY29tcG9u
        ZW50cy9teS1mb29gLCB5b3Ugd2lsbCBiZSBhYmxlIHRvIHVzZQogIGB7e215
        LWZvb319YCBpbiBvdGhlciB0ZW1wbGF0ZXMsIHdoaWNoIHdpbGwgbWFrZQog
        IGFuIGluc3RhbmNlIG9mIHRoZSBpc29sYXRlZCBjb21wb25lbnQuCgogIGBg
        YGh0bWwKICB7e2FwcC1wcm9maWxlIHBlcnNvbj1jdXJyZW50VXNlcn19CiAg
        YGBgCgogIGBgYGh0bWwKICA8IS0tIGFwcC1wcm9maWxlIHRlbXBsYXRlIC0t
        PgogIDxoMT57e3BlcnNvbi50aXRsZX19PC9oMT4KICA8aW1nIHt7YmluZC1h
        dHRyIHNyYz1wZXJzb24uYXZhdGFyfX0+CiAgPHAgY2xhc3M9J3NpZ25hdHVy
        ZSc+e3twZXJzb24uc2lnbmF0dXJlfX08L3A+CiAgYGBgCgogIFlvdSBjYW4g
        YWxzbyB1c2UgYHlpZWxkYCBpbnNpZGUgYSB0ZW1wbGF0ZSB0bwogIGluY2x1
        ZGUgdGhlICoqY29udGVudHMqKiBvZiB0aGUgY3VzdG9tIHRhZzoKCiAgYGBg
        aHRtbAogIHt7I2FwcC1wcm9maWxlIHBlcnNvbj1jdXJyZW50VXNlcn19CiAg
        ICA8cD5BZG1pbiBtb2RlPC9wPgogIHt7L2FwcC1wcm9maWxlfX0KICBgYGAK
        CiAgYGBgaHRtbAogIDwhLS0gYXBwLXByb2ZpbGUgdGVtcGxhdGUgLS0+CiAg
        PGgxPnt7cGVyc29uLnRpdGxlfX08L2gxPgogIHt7eWllbGR9fSA8IS0tIGJs
        b2NrIGNvbnRlbnRzIC0tPgogIGBgYAoKICBJZiB5b3Ugd2FudCB0byBjdXN0
        b21pemUgdGhlIGNvbXBvbmVudCwgaW4gb3JkZXIgdG8KICBoYW5kbGUgZXZl
        bnRzIG9yIGFjdGlvbnMsIHlvdSBpbXBsZW1lbnQgYSBzdWJjbGFzcwogIG9m
        IGBFbWJlci5Db21wb25lbnRgIG5hbWVkIGFmdGVyIHRoZSBuYW1lIG9mIHRo
        ZQogIGNvbXBvbmVudC4gTm90ZSB0aGF0IGBDb21wb25lbnRgIG5lZWRzIHRv
        IGJlIGFwcGVuZGVkIHRvIHRoZSBuYW1lIG9mCiAgeW91ciBzdWJjbGFzcyBs
        aWtlIGBBcHBQcm9maWxlQ29tcG9uZW50YC4KCiAgRm9yIGV4YW1wbGUsIHlv
        dSBjb3VsZCBpbXBsZW1lbnQgdGhlIGFjdGlvbgogIGBoZWxsb2AgZm9yIHRo
        ZSBgYXBwLXByb2ZpbGVgIGNvbXBvbmVudDoKCiAgYGBgamF2YXNjcmlwdAog
        IEFwcC5BcHBQcm9maWxlQ29tcG9uZW50ID0gRW1iZXIuQ29tcG9uZW50LmV4
        dGVuZCh7CiAgICBhY3Rpb25zOiB7CiAgICAgIGhlbGxvOiBmdW5jdGlvbihu
        YW1lKSB7CiAgICAgICAgY29uc29sZS5sb2coIkhlbGxvIiwgbmFtZSk7CiAg
        ICAgIH0KICAgIH0KICB9KTsKICBgYGAKCiAgQW5kIHRoZW4gdXNlIGl0IGlu
        IHRoZSBjb21wb25lbnQncyB0ZW1wbGF0ZToKCiAgYGBgaHRtbAogIDwhLS0g
        YXBwLXByb2ZpbGUgdGVtcGxhdGUgLS0+CgogIDxoMT57e3BlcnNvbi50aXRs
        ZX19PC9oMT4KICB7e3lpZWxkfX0gPCEtLSBibG9jayBjb250ZW50cyAtLT4K
        CiAgPGJ1dHRvbiB7e2FjdGlvbiAnaGVsbG8nIHBlcnNvbi5uYW1lfX0+CiAg
        ICBTYXkgSGVsbG8gdG8ge3twZXJzb24ubmFtZX19CiAgPC9idXR0b24+CiAg
        YGBgCgogIENvbXBvbmVudHMgbXVzdCBoYXZlIGEgYC1gIGluIHRoZWlyIG5h
        bWUgdG8gYXZvaWQKICBjb25mbGljdHMgd2l0aCBidWlsdC1pbiBjb250cm9s
        cyB0aGF0IHdyYXAgSFRNTAogIGVsZW1lbnRzLiBUaGlzIGlzIGNvbnNpc3Rl
        bnQgd2l0aCB0aGUgc2FtZQogIHJlcXVpcmVtZW50IGluIHdlYiBjb21wb25l
        bnRzLgoKICBAY2xhc3MgQ29tcG9uZW50CiAgQG5hbWVzcGFjZSBFbWJlcgog
        IEBleHRlbmRzIEVtYmVyLlZpZXcKKi8KRW1iZXIuQ29tcG9uZW50ID0gRW1i
        ZXIuVmlldy5leHRlbmQoRW1iZXIuVGFyZ2V0QWN0aW9uU3VwcG9ydCwgewog
        IGluaXQ6IGZ1bmN0aW9uKCkgewogICAgdGhpcy5fc3VwZXIoKTsKICAgIHNl
        dCh0aGlzLCAnY29udGV4dCcsIHRoaXMpOwogICAgc2V0KHRoaXMsICdjb250
        cm9sbGVyJywgdGhpcyk7CiAgfSwKCiAgLy8gZHVyaW5nIHJlbmRlciwgaXNv
        bGF0ZSBrZXl3b3JkcwogIGNsb25lS2V5d29yZHM6IGZ1bmN0aW9uKCkgewog
        ICAgcmV0dXJuIHsKICAgICAgdmlldzogdGhpcywKICAgICAgY29udHJvbGxl
        cjogdGhpcwogICAgfTsKICB9LAoKICBfeWllbGQ6IGZ1bmN0aW9uKGNvbnRl
        eHQsIG9wdGlvbnMpIHsKICAgIHZhciB2aWV3ID0gb3B0aW9ucy5kYXRhLnZp
        ZXcsCiAgICAgICAgcGFyZW50VmlldyA9IHRoaXMuX3BhcmVudFZpZXcsCiAg
        ICAgICAgdGVtcGxhdGUgPSBnZXQodGhpcywgJ3RlbXBsYXRlJyk7CgogICAg
        aWYgKHRlbXBsYXRlKSB7CiAgICAgIEVtYmVyLmFzc2VydCgiQSBDb21wb25l
        bnQgbXVzdCBoYXZlIGEgcGFyZW50IHZpZXcgaW4gb3JkZXIgdG8geWllbGQu
        IiwgcGFyZW50Vmlldyk7CgogICAgICB2aWV3LmFwcGVuZENoaWxkKEVtYmVy
        LlZpZXcsIHsKICAgICAgICBpc1ZpcnR1YWw6IHRydWUsCiAgICAgICAgdGFn
        TmFtZTogJycsCiAgICAgICAgX2NvbnRleHRWaWV3OiBwYXJlbnRWaWV3LAog
        ICAgICAgIHRlbXBsYXRlOiB0ZW1wbGF0ZSwKICAgICAgICBjb250ZXh0OiBn
        ZXQocGFyZW50VmlldywgJ2NvbnRleHQnKSwKICAgICAgICBjb250cm9sbGVy
        OiBnZXQocGFyZW50VmlldywgJ2NvbnRyb2xsZXInKSwKICAgICAgICB0ZW1w
        bGF0ZURhdGE6IHsga2V5d29yZHM6IHBhcmVudFZpZXcuY2xvbmVLZXl3b3Jk
        cygpIH0KICAgICAgfSk7CiAgICB9CiAgfSwKCiAgLyoqCiAgICBJZiB0aGUg
        Y29tcG9uZW50IGlzIGN1cnJlbnRseSBpbnNlcnRlZCBpbnRvIHRoZSBET00g
        b2YgYSBwYXJlbnQgdmlldywgdGhpcwogICAgcHJvcGVydHkgd2lsbCBwb2lu
        dCB0byB0aGUgY29udHJvbGxlciBvZiB0aGUgcGFyZW50IHZpZXcuCgogICAg
        QHByb3BlcnR5IHRhcmdldE9iamVjdAogICAgQHR5cGUgRW1iZXIuQ29udHJv
        bGxlcgogICAgQGRlZmF1bHQgbnVsbAogICovCiAgdGFyZ2V0T2JqZWN0OiBF
        bWJlci5jb21wdXRlZChmdW5jdGlvbihrZXkpIHsKICAgIHZhciBwYXJlbnRW
        aWV3ID0gZ2V0KHRoaXMsICdfcGFyZW50VmlldycpOwogICAgcmV0dXJuIHBh
        cmVudFZpZXcgPyBnZXQocGFyZW50VmlldywgJ2NvbnRyb2xsZXInKSA6IG51
        bGw7CiAgfSkucHJvcGVydHkoJ19wYXJlbnRWaWV3JyksCgogIC8qKgogICAg
        U2VuZHMgYW4gYWN0aW9uIHRvIGNvbXBvbmVudCdzIGNvbnRyb2xsZXIuIEEg
        Y29tcG9uZW50IGluaGVyaXRzIGl0cwogICAgY29udHJvbGxlciBmcm9tIHRo
        ZSBjb250ZXh0IGluIHdoaWNoIGl0IGlzIHVzZWQuCgogICAgQnkgZGVmYXVs
        dCwgY2FsbGluZyBgc2VuZEFjdGlvbigpYCB3aWxsIHNlbmQgYW4gYWN0aW9u
        IHdpdGggdGhlIG5hbWUKICAgIG9mIHRoZSBjb21wb25lbnQncyBgYWN0aW9u
        YCBwcm9wZXJ0eS4KCiAgICBGb3IgZXhhbXBsZSwgaWYgdGhlIGNvbXBvbmVu
        dCBoYWQgYSBwcm9wZXJ0eSBgYWN0aW9uYCB3aXRoIHRoZSB2YWx1ZQogICAg
        YCJhZGRJdGVtImAsIGNhbGxpbmcgYHNlbmRBY3Rpb24oKWAgd291bGQgc2Vu
        ZCB0aGUgYGFkZEl0ZW1gIGFjdGlvbgogICAgdG8gdGhlIGNvbXBvbmVudCdz
        IGNvbnRyb2xsZXIuCgogICAgSWYgeW91IHByb3ZpZGUgdGhlIGBhY3Rpb25g
        IGFyZ3VtZW50IHRvIGBzZW5kQWN0aW9uKClgLCB0aGF0IGtleSB3aWxsCiAg
        ICBiZSB1c2VkIHRvIGxvb2sgdXAgdGhlIGFjdGlvbiBuYW1lLgoKICAgIEZv
        ciBleGFtcGxlLCBpZiB0aGUgY29tcG9uZW50IGhhZCBhIHByb3BlcnR5IGBw
        bGF5aW5nYCB3aXRoIHRoZSB2YWx1ZQogICAgYGRpZFN0YXJ0UGxheWluZ2As
        IGNhbGxpbmcgYHNlbmRBY3Rpb24oJ3BsYXlpbmcnKWAgd291bGQgc2VuZCB0
        aGUKICAgIGBkaWRTdGFydFBsYXlpbmdgIGFjdGlvbiB0byB0aGUgY29tcG9u
        ZW50J3MgY29udHJvbGxlci4KCiAgICBXaGV0aGVyIG9yIG5vdCB5b3UgYXJl
        IHVzaW5nIHRoZSBkZWZhdWx0IGFjdGlvbiBvciBhIG5hbWVkIGFjdGlvbiwg
        aWYKICAgIHRoZSBhY3Rpb24gbmFtZSBpcyBub3QgZGVmaW5lZCBvbiB0aGUg
        Y29tcG9uZW50LCBjYWxsaW5nIGBzZW5kQWN0aW9uKClgCiAgICBkb2VzIG5v
        dCBoYXZlIGFueSBlZmZlY3QuCgogICAgRm9yIGV4YW1wbGUsIGlmIHlvdSBj
        YWxsIGBzZW5kQWN0aW9uKClgIG9uIGEgY29tcG9uZW50IHRoYXQgZG9lcyBu
        b3QgaGF2ZQogICAgYW4gYGFjdGlvbmAgcHJvcGVydHkgZGVmaW5lZCwgbm8g
        YWN0aW9uIHdpbGwgYmUgc2VudCB0byB0aGUgY29udHJvbGxlciwKICAgIG5v
        ciB3aWxsIGFuIGV4Y2VwdGlvbiBiZSByYWlzZWQuCgogICAgWW91IGNhbiBz
        ZW5kIGEgY29udGV4dCBvYmplY3Qgd2l0aCB0aGUgYWN0aW9uIGJ5IHN1cHBs
        eWluZyB0aGUgYGNvbnRleHRgCiAgICBhcmd1bWVudC4gVGhlIGNvbnRleHQg
        d2lsbCBiZSBzdXBwbGllZCBhcyB0aGUgZmlyc3QgYXJndW1lbnQgaW4gdGhl
        CiAgICB0YXJnZXQncyBhY3Rpb24gbWV0aG9kLiBFeGFtcGxlOgoKICAgIGBg
        YGphdmFzY3JpcHQKICAgIEFwcC5NeVRyZWVDb21wb25lbnQgPSBFbWJlci5D
        b21wb25lbnQuZXh0ZW5kKHsKICAgICAgY2xpY2s6IGZ1bmN0aW9uKCkgewog
        ICAgICAgIHRoaXMuc2VuZEFjdGlvbignZGlkQ2xpY2tUcmVlTm9kZScsIHRo
        aXMuZ2V0KCdub2RlJykpOwogICAgICB9CiAgICB9KTsKCiAgICBBcHAuQ2F0
        ZWdvcmllc0NvbnRyb2xsZXIgPSBFbWJlci5Db250cm9sbGVyLmV4dGVuZCh7
        CiAgICAgIGFjdGlvbnM6IHsKICAgICAgICBkaWRDbGlja0NhdGVnb3J5OiBm
        dW5jdGlvbihjYXRlZ29yeSkgewogICAgICAgICAgLy9EbyBzb21ldGhpbmcg
        d2l0aCB0aGUgbm9kZS9jYXRlZ29yeSB0aGF0IHdhcyBjbGlja2VkCiAgICAg
        ICAgfQogICAgICB9CiAgICB9KTsKICAgIGBgYAoKICAgIGBgYGhhbmRsZWJh
        cnMKICAgIHt7ISBjYXRlZ29yaWVzLmhic319CiAgICB7e215LXRyZWUgZGlk
        Q2xpY2tUcmVlTm9kZT0nZGlkQ2xpY2tDYXRlZ29yeSd9fQogICAgYGBgCgog
        ICAgQG1ldGhvZCBzZW5kQWN0aW9uCiAgICBAcGFyYW0gW2FjdGlvbl0ge1N0
        cmluZ30gdGhlIGFjdGlvbiB0byB0cmlnZ2VyCiAgICBAcGFyYW0gW2NvbnRl
        eHRdIHsqfSBhIGNvbnRleHQgdG8gc2VuZCB3aXRoIHRoZSBhY3Rpb24KICAq
        LwogIHNlbmRBY3Rpb246IGZ1bmN0aW9uKGFjdGlvbikgewogICAgdmFyIGFj
        dGlvbk5hbWUsCiAgICAgICAgY29udGV4dHMgPSBhX3NsaWNlLmNhbGwoYXJn
        dW1lbnRzLCAxKTsKCiAgICAvLyBTZW5kIHRoZSBkZWZhdWx0IGFjdGlvbgog
        ICAgaWYgKGFjdGlvbiA9PT0gdW5kZWZpbmVkKSB7CiAgICAgIGFjdGlvbk5h
        bWUgPSBnZXQodGhpcywgJ2FjdGlvbicpOwogICAgICBFbWJlci5hc3NlcnQo
        IlRoZSBkZWZhdWx0IGFjdGlvbiB3YXMgdHJpZ2dlcmVkIG9uIHRoZSBjb21w
        b25lbnQgIiArIHRoaXMudG9TdHJpbmcoKSArICIsIGJ1dCB0aGUgYWN0aW9u
        IG5hbWUgKCIgKyBhY3Rpb25OYW1lICsgIikgd2FzIG5vdCBhIHN0cmluZy4i
        LCBpc05vbmUoYWN0aW9uTmFtZSkgfHwgdHlwZW9mIGFjdGlvbk5hbWUgPT09
        ICdzdHJpbmcnKTsKICAgIH0gZWxzZSB7CiAgICAgIGFjdGlvbk5hbWUgPSBn
        ZXQodGhpcywgYWN0aW9uKTsKICAgICAgRW1iZXIuYXNzZXJ0KCJUaGUgIiAr
        IGFjdGlvbiArICIgYWN0aW9uIHdhcyB0cmlnZ2VyZWQgb24gdGhlIGNvbXBv
        bmVudCAiICsgdGhpcy50b1N0cmluZygpICsgIiwgYnV0IHRoZSBhY3Rpb24g
        bmFtZSAoIiArIGFjdGlvbk5hbWUgKyAiKSB3YXMgbm90IGEgc3RyaW5nLiIs
        IGlzTm9uZShhY3Rpb25OYW1lKSB8fCB0eXBlb2YgYWN0aW9uTmFtZSA9PT0g
        J3N0cmluZycpOwogICAgfQoKICAgIC8vIElmIG5vIGFjdGlvbiBuYW1lIGZv
        ciB0aGF0IGFjdGlvbiBjb3VsZCBiZSBmb3VuZCwganVzdCBhYm9ydC4KICAg
        IGlmIChhY3Rpb25OYW1lID09PSB1bmRlZmluZWQpIHsgcmV0dXJuOyB9Cgog
        ICAgdGhpcy50cmlnZ2VyQWN0aW9uKHsKICAgICAgYWN0aW9uOiBhY3Rpb25O
        YW1lLAogICAgICBhY3Rpb25Db250ZXh0OiBjb250ZXh0cwogICAgfSk7CiAg
        fQp9KTsKCn0pKCk7CgoKCihmdW5jdGlvbigpIHsKCn0pKCk7CgoKCihmdW5j
        dGlvbigpIHsKLyoqCmBFbWJlci5WaWV3VGFyZ2V0QWN0aW9uU3VwcG9ydGAg
        aXMgYSBtaXhpbiB0aGF0IGNhbiBiZSBpbmNsdWRlZCBpbiBhCnZpZXcgY2xh
        c3MgdG8gYWRkIGEgYHRyaWdnZXJBY3Rpb25gIG1ldGhvZCB3aXRoIHNlbWFu
        dGljcyBzaW1pbGFyIHRvCnRoZSBIYW5kbGViYXJzIGB7e2FjdGlvbn19YCBo
        ZWxwZXIuIEl0IHByb3ZpZGVzIGludGVsbGlnZW50IGRlZmF1bHRzCmZvciB0
        aGUgYWN0aW9uJ3MgdGFyZ2V0OiB0aGUgdmlldydzIGNvbnRyb2xsZXI7IGFu
        ZCB0aGUgY29udGV4dCB0aGF0IGlzCnNlbnQgd2l0aCB0aGUgYWN0aW9uOiB0
        aGUgdmlldydzIGNvbnRleHQuCgpOb3RlOiBJbiBub3JtYWwgRW1iZXIgdXNh
        Z2UsIHRoZSBge3thY3Rpb259fWAgaGVscGVyIGlzIHVzdWFsbHkgdGhlIGJl
        c3QKY2hvaWNlLiBUaGlzIG1peGluIGlzIG1vc3Qgb2Z0ZW4gdXNlZnVsIHdo
        ZW4geW91IGFyZSBkb2luZyBtb3JlIGNvbXBsZXgKZXZlbnQgaGFuZGxpbmcg
        aW4gY3VzdG9tIFZpZXcgc3ViY2xhc3Nlcy4KCkZvciBleGFtcGxlOgoKYGBg
        amF2YXNjcmlwdApBcHAuU2F2ZUJ1dHRvblZpZXcgPSBFbWJlci5WaWV3LmV4
        dGVuZChFbWJlci5WaWV3VGFyZ2V0QWN0aW9uU3VwcG9ydCwgewogIGFjdGlv
        bjogJ3NhdmUnLAogIGNsaWNrOiBmdW5jdGlvbigpIHsKICAgIHRoaXMudHJp
        Z2dlckFjdGlvbigpOyAvLyBTZW5kcyB0aGUgYHNhdmVgIGFjdGlvbiwgYWxv
        bmcgd2l0aCB0aGUgY3VycmVudCBjb250ZXh0CiAgICAgICAgICAgICAgICAg
        ICAgICAgICAgLy8gdG8gdGhlIGN1cnJlbnQgY29udHJvbGxlcgogIH0KfSk7
        CmBgYAoKVGhlIGBhY3Rpb25gIGNhbiBiZSBwcm92aWRlZCBhcyBwcm9wZXJ0
        aWVzIG9mIGFuIG9wdGlvbmFsIG9iamVjdCBhcmd1bWVudAp0byBgdHJpZ2dl
        ckFjdGlvbmAgYXMgd2VsbC4KCmBgYGphdmFzY3JpcHQKQXBwLlNhdmVCdXR0
        b25WaWV3ID0gRW1iZXIuVmlldy5leHRlbmQoRW1iZXIuVmlld1RhcmdldEFj
        dGlvblN1cHBvcnQsIHsKICBjbGljazogZnVuY3Rpb24oKSB7CiAgICB0aGlz
        LnRyaWdnZXJBY3Rpb24oewogICAgICBhY3Rpb246ICdzYXZlJwogICAgfSk7
        IC8vIFNlbmRzIHRoZSBgc2F2ZWAgYWN0aW9uLCBhbG9uZyB3aXRoIHRoZSBj
        dXJyZW50IGNvbnRleHQKICAgICAgICAvLyB0byB0aGUgY3VycmVudCBjb250
        cm9sbGVyCiAgfQp9KTsKYGBgCgpAY2xhc3MgVmlld1RhcmdldEFjdGlvblN1
        cHBvcnQKQG5hbWVzcGFjZSBFbWJlcgpAZXh0ZW5kcyBFbWJlci5UYXJnZXRB
        Y3Rpb25TdXBwb3J0CiovCkVtYmVyLlZpZXdUYXJnZXRBY3Rpb25TdXBwb3J0
        ID0gRW1iZXIuTWl4aW4uY3JlYXRlKEVtYmVyLlRhcmdldEFjdGlvblN1cHBv
        cnQsIHsKICAvKioKICBAcHJvcGVydHkgdGFyZ2V0CiAgKi8KICB0YXJnZXQ6
        IEVtYmVyLmNvbXB1dGVkLmFsaWFzKCdjb250cm9sbGVyJyksCiAgLyoqCiAg
        QHByb3BlcnR5IGFjdGlvbkNvbnRleHQKICAqLwogIGFjdGlvbkNvbnRleHQ6
        IEVtYmVyLmNvbXB1dGVkLmFsaWFzKCdjb250ZXh0JykKfSk7Cgp9KSgpOwoK
        CgooZnVuY3Rpb24oKSB7Cgp9KSgpOwoKCgooZnVuY3Rpb24oKSB7Ci8qKgpF
        bWJlciBWaWV3cwoKQG1vZHVsZSBlbWJlcgpAc3VibW9kdWxlIGVtYmVyLXZp
        ZXdzCkByZXF1aXJlcyBlbWJlci1ydW50aW1lCkBtYWluIGVtYmVyLXZpZXdz
        CiovCgp9KSgpOwoKKGZ1bmN0aW9uKCkgewpkZWZpbmUoIm1ldGFtb3JwaCIs
        CiAgW10sCiAgZnVuY3Rpb24oKSB7CiAgICAidXNlIHN0cmljdCI7CiAgICAv
        LyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
        PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQogICAgLy8gUHJvamVj
        dDogICBtZXRhbW9ycGgKICAgIC8vIENvcHlyaWdodDogwqkyMDExIE15IENv
        bXBhbnkgSW5jLiBBbGwgcmlnaHRzIHJlc2VydmVkLgogICAgLy8gPT09PT09
        PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
        PT09PT09PT09PT09PT09PT09PT09PT0KCiAgICB2YXIgSyA9IGZ1bmN0aW9u
        KCkge30sCiAgICAgICAgZ3VpZCA9IDAsCiAgICAgICAgZG9jdW1lbnQgPSB0
        aGlzLmRvY3VtZW50LAogICAgICAgIGRpc2FibGVSYW5nZSA9ICgndW5kZWZp
        bmVkJyA9PT0gdHlwZW9mIEVOViA/IHt9IDogRU5WKS5ESVNBQkxFX1JBTkdF
        X0FQSSwKCiAgICAgICAgLy8gRmVhdHVyZS1kZXRlY3QgdGhlIFczQyByYW5n
        ZSBBUEksIHRoZSBleHRlbmRlZCBjaGVjayBpcyBmb3IgSUU5IHdoaWNoIG9u
        bHkgcGFydGlhbGx5IHN1cHBvcnRzIHJhbmdlcwogICAgICAgIHN1cHBvcnRz
        UmFuZ2UgPSAoIWRpc2FibGVSYW5nZSkgJiYgZG9jdW1lbnQgJiYgKCdjcmVh
        dGVSYW5nZScgaW4gZG9jdW1lbnQpICYmICh0eXBlb2YgUmFuZ2UgIT09ICd1
        bmRlZmluZWQnKSAmJiBSYW5nZS5wcm90b3R5cGUuY3JlYXRlQ29udGV4dHVh
        bEZyYWdtZW50LAoKICAgICAgICAvLyBJbnRlcm5ldCBFeHBsb3JlciBwcmlv
        ciB0byA5IGRvZXMgbm90IGFsbG93IHNldHRpbmcgaW5uZXJIVE1MIGlmIHRo
        ZSBmaXJzdCBlbGVtZW50CiAgICAgICAgLy8gaXMgYSAiemVyby1zY29wZSIg
        ZWxlbWVudC4gVGhpcyBwcm9ibGVtIGNhbiBiZSB3b3JrZWQgYXJvdW5kIGJ5
        IG1ha2luZwogICAgICAgIC8vIHRoZSBmaXJzdCBub2RlIGFuIGludmlzaWJs
        ZSB0ZXh0IG5vZGUuIFdlLCBsaWtlIE1vZGVybml6ciwgdXNlICZzaHk7CiAg
        ICAgICAgbmVlZHNTaHkgPSBkb2N1bWVudCAmJiAoZnVuY3Rpb24oKSB7CiAg
        ICAgICAgICB2YXIgdGVzdEVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgn
        ZGl2Jyk7CiAgICAgICAgICB0ZXN0RWwuaW5uZXJIVE1MID0gIjxkaXY+PC9k
        aXY+IjsKICAgICAgICAgIHRlc3RFbC5maXJzdENoaWxkLmlubmVySFRNTCA9
        ICI8c2NyaXB0Pjwvc2NyaXB0PiI7CiAgICAgICAgICByZXR1cm4gdGVzdEVs
        LmZpcnN0Q2hpbGQuaW5uZXJIVE1MID09PSAnJzsKICAgICAgICB9KSgpLAoK
        CiAgICAgICAgLy8gSUUgOCAoYW5kIGxpa2VseSBlYXJsaWVyKSBsaWtlcyB0
        byBtb3ZlIHdoaXRlc3BhY2UgcHJlY2VlZGluZwogICAgICAgIC8vIGEgc2Ny
        aXB0IHRhZyB0byBhcHBlYXIgYWZ0ZXIgaXQuIFRoaXMgbWVhbnMgdGhhdCB3
        ZSBjYW4KICAgICAgICAvLyBhY2NpZGVudGFsbHkgcmVtb3ZlIHdoaXRlc3Bh
        Y2Ugd2hlbiB1cGRhdGluZyBhIG1vcnBoLgogICAgICAgIG1vdmVzV2hpdGVz
        cGFjZSA9IGRvY3VtZW50ICYmIChmdW5jdGlvbigpIHsKICAgICAgICAgIHZh
        ciB0ZXN0RWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKICAg
        ICAgICAgIHRlc3RFbC5pbm5lckhUTUwgPSAiVGVzdDogPHNjcmlwdCB0eXBl
        PSd0ZXh0L3gtcGxhY2Vob2xkZXInPjwvc2NyaXB0PlZhbHVlIjsKICAgICAg
        ICAgIHJldHVybiB0ZXN0RWwuY2hpbGROb2Rlc1swXS5ub2RlVmFsdWUgPT09
        ICdUZXN0OicgJiYKICAgICAgICAgICAgICAgICAgdGVzdEVsLmNoaWxkTm9k
        ZXNbMl0ubm9kZVZhbHVlID09PSAnIFZhbHVlJzsKICAgICAgICB9KSgpOwoK
        ICAgIC8vIENvbnN0cnVjdG9yIHRoYXQgc3VwcG9ydHMgZWl0aGVyIE1ldGFt
        b3JwaCgnZm9vJykgb3IgbmV3CiAgICAvLyBNZXRhbW9ycGgoJ2ZvbycpOwog
        ICAgLy8KICAgIC8vIFRha2VzIGEgc3RyaW5nIG9mIEhUTUwgYXMgdGhlIGFy
        Z3VtZW50LgoKICAgIHZhciBNZXRhbW9ycGggPSBmdW5jdGlvbihodG1sKSB7
        CiAgICAgIHZhciBzZWxmOwoKICAgICAgaWYgKHRoaXMgaW5zdGFuY2VvZiBN
        ZXRhbW9ycGgpIHsKICAgICAgICBzZWxmID0gdGhpczsKICAgICAgfSBlbHNl
        IHsKICAgICAgICBzZWxmID0gbmV3IEsoKTsKICAgICAgfQoKICAgICAgc2Vs
        Zi5pbm5lckhUTUwgPSBodG1sOwogICAgICB2YXIgbXlHdWlkID0gJ21ldGFt
        b3JwaC0nKyhndWlkKyspOwogICAgICBzZWxmLnN0YXJ0ID0gbXlHdWlkICsg
        Jy1zdGFydCc7CiAgICAgIHNlbGYuZW5kID0gbXlHdWlkICsgJy1lbmQnOwoK
        ICAgICAgcmV0dXJuIHNlbGY7CiAgICB9OwoKICAgIEsucHJvdG90eXBlID0g
        TWV0YW1vcnBoLnByb3RvdHlwZTsKCiAgICB2YXIgcmFuZ2VGb3IsIGh0bWxG
        dW5jLCByZW1vdmVGdW5jLCBvdXRlckhUTUxGdW5jLCBhcHBlbmRUb0Z1bmMs
        IGFmdGVyRnVuYywgcHJlcGVuZEZ1bmMsIHN0YXJ0VGFnRnVuYywgZW5kVGFn
        RnVuYzsKCiAgICBvdXRlckhUTUxGdW5jID0gZnVuY3Rpb24oKSB7CiAgICAg
        IHJldHVybiB0aGlzLnN0YXJ0VGFnKCkgKyB0aGlzLmlubmVySFRNTCArIHRo
        aXMuZW5kVGFnKCk7CiAgICB9OwoKICAgIHN0YXJ0VGFnRnVuYyA9IGZ1bmN0
        aW9uKCkgewogICAgICAvKgogICAgICAgKiBXZSByZXBsYWNlIGNoZXZyb24g
        YnkgaXRzIGhleCBjb2RlIGluIG9yZGVyIHRvIHByZXZlbnQgZXNjYXBpbmcg
        cHJvYmxlbXMuCiAgICAgICAqIENoZWNrIHRoaXMgdGhyZWFkIGZvciBtb3Jl
        IGV4cGxhaW5hdGlvbjoKICAgICAgICogaHR0cDovL3N0YWNrb3ZlcmZsb3cu
        Y29tL3F1ZXN0aW9ucy84MjMxMDQ4L3doeS11c2UteDNjLWluc3RlYWQtb2Yt
        d2hlbi1nZW5lcmF0aW5nLWh0bWwtZnJvbS1qYXZhc2NyaXB0CiAgICAgICAq
        LwogICAgICByZXR1cm4gIjxzY3JpcHQgaWQ9JyIgKyB0aGlzLnN0YXJ0ICsg
        IicgdHlwZT0ndGV4dC94LXBsYWNlaG9sZGVyJz5ceDNDL3NjcmlwdD4iOwog
        ICAgfTsKCiAgICBlbmRUYWdGdW5jID0gZnVuY3Rpb24oKSB7CiAgICAgIC8q
        CiAgICAgICAqIFdlIHJlcGxhY2UgY2hldnJvbiBieSBpdHMgaGV4IGNvZGUg
        aW4gb3JkZXIgdG8gcHJldmVudCBlc2NhcGluZyBwcm9ibGVtcy4KICAgICAg
        ICogQ2hlY2sgdGhpcyB0aHJlYWQgZm9yIG1vcmUgZXhwbGFpbmF0aW9uOgog
        ICAgICAgKiBodHRwOi8vc3RhY2tvdmVyZmxvdy5jb20vcXVlc3Rpb25zLzgy
        MzEwNDgvd2h5LXVzZS14M2MtaW5zdGVhZC1vZi13aGVuLWdlbmVyYXRpbmct
        aHRtbC1mcm9tLWphdmFzY3JpcHQKICAgICAgICovCiAgICAgIHJldHVybiAi
        PHNjcmlwdCBpZD0nIiArIHRoaXMuZW5kICsgIicgdHlwZT0ndGV4dC94LXBs
        YWNlaG9sZGVyJz5ceDNDL3NjcmlwdD4iOwogICAgfTsKCiAgICAvLyBJZiB3
        ZSBoYXZlIHRoZSBXM0MgcmFuZ2UgQVBJLCB0aGlzIHByb2Nlc3MgaXMgcmVs
        YXRpdmVseSBzdHJhaWdodCBmb3J3YXJkLgogICAgaWYgKHN1cHBvcnRzUmFu
        Z2UpIHsKCiAgICAgIC8vIEdldCBhIHJhbmdlIGZvciB0aGUgY3VycmVudCBt
        b3JwaC4gT3B0aW9uYWxseSBpbmNsdWRlIHRoZSBzdGFydGluZyBhbmQKICAg
        ICAgLy8gZW5kaW5nIHBsYWNlaG9sZGVycy4KICAgICAgcmFuZ2VGb3IgPSBm
        dW5jdGlvbihtb3JwaCwgb3V0ZXJUb28pIHsKICAgICAgICB2YXIgcmFuZ2Ug
        PSBkb2N1bWVudC5jcmVhdGVSYW5nZSgpOwogICAgICAgIHZhciBiZWZvcmUg
        PSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChtb3JwaC5zdGFydCk7CiAgICAg
        ICAgdmFyIGFmdGVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQobW9ycGgu
        ZW5kKTsKCiAgICAgICAgaWYgKG91dGVyVG9vKSB7CiAgICAgICAgICByYW5n
        ZS5zZXRTdGFydEJlZm9yZShiZWZvcmUpOwogICAgICAgICAgcmFuZ2Uuc2V0
        RW5kQWZ0ZXIoYWZ0ZXIpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBy
        YW5nZS5zZXRTdGFydEFmdGVyKGJlZm9yZSk7CiAgICAgICAgICByYW5nZS5z
        ZXRFbmRCZWZvcmUoYWZ0ZXIpOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJu
        IHJhbmdlOwogICAgICB9OwoKICAgICAgaHRtbEZ1bmMgPSBmdW5jdGlvbiho
        dG1sLCBvdXRlclRvbykgewogICAgICAgIC8vIGdldCBhIHJhbmdlIGZvciB0
        aGUgY3VycmVudCBtZXRhbW9ycGggb2JqZWN0CiAgICAgICAgdmFyIHJhbmdl
        ID0gcmFuZ2VGb3IodGhpcywgb3V0ZXJUb28pOwoKICAgICAgICAvLyBkZWxl
        dGUgdGhlIGNvbnRlbnRzIG9mIHRoZSByYW5nZSwgd2hpY2ggd2lsbCBiZSB0
        aGUKICAgICAgICAvLyBub2RlcyBiZXR3ZWVuIHRoZSBzdGFydGluZyBhbmQg
        ZW5kaW5nIHBsYWNlaG9sZGVyLgogICAgICAgIHJhbmdlLmRlbGV0ZUNvbnRl
        bnRzKCk7CgogICAgICAgIC8vIGNyZWF0ZSBhIG5ldyBkb2N1bWVudCBmcmFn
        bWVudCBmb3IgdGhlIEhUTUwKICAgICAgICB2YXIgZnJhZ21lbnQgPSByYW5n
        ZS5jcmVhdGVDb250ZXh0dWFsRnJhZ21lbnQoaHRtbCk7CgogICAgICAgIC8v
        IGluc2VydCB0aGUgZnJhZ21lbnQgaW50byB0aGUgcmFuZ2UKICAgICAgICBy
        YW5nZS5pbnNlcnROb2RlKGZyYWdtZW50KTsKICAgICAgfTsKCiAgICAgIC8q
        KgogICAgICAqIEBwdWJsaWMKICAgICAgKiAKICAgICAgKiBSZW1vdmUgdGhp
        cyBvYmplY3QgKGluY2x1ZGluZyBzdGFydGluZyBhbmQgZW5kaW5nCiAgICAg
        ICogcGxhY2Vob2xkZXJzKS4KICAgICAgKgogICAgICAqIEBtZXRob2QgcmVt
        b3ZlCiAgICAgICovCiAgICAgIHJlbW92ZUZ1bmMgPSBmdW5jdGlvbigpIHsK
        ICAgICAgICAvLyBnZXQgYSByYW5nZSBmb3IgdGhlIGN1cnJlbnQgbWV0YW1v
        cnBoIG9iamVjdCBpbmNsdWRpbmcKICAgICAgICAvLyB0aGUgc3RhcnRpbmcg
        YW5kIGVuZGluZyBwbGFjZWhvbGRlcnMuCiAgICAgICAgdmFyIHJhbmdlID0g
        cmFuZ2VGb3IodGhpcywgdHJ1ZSk7CgogICAgICAgIC8vIGRlbGV0ZSB0aGUg
        ZW50aXJlIHJhbmdlLgogICAgICAgIHJhbmdlLmRlbGV0ZUNvbnRlbnRzKCk7
        CiAgICAgIH07CgogICAgICBhcHBlbmRUb0Z1bmMgPSBmdW5jdGlvbihub2Rl
        KSB7CiAgICAgICAgdmFyIHJhbmdlID0gZG9jdW1lbnQuY3JlYXRlUmFuZ2Uo
        KTsKICAgICAgICByYW5nZS5zZXRTdGFydChub2RlKTsKICAgICAgICByYW5n
        ZS5jb2xsYXBzZShmYWxzZSk7CiAgICAgICAgdmFyIGZyYWcgPSByYW5nZS5j
        cmVhdGVDb250ZXh0dWFsRnJhZ21lbnQodGhpcy5vdXRlckhUTUwoKSk7CiAg
        ICAgICAgbm9kZS5hcHBlbmRDaGlsZChmcmFnKTsKICAgICAgfTsKCiAgICAg
        IGFmdGVyRnVuYyA9IGZ1bmN0aW9uKGh0bWwpIHsKICAgICAgICB2YXIgcmFu
        Z2UgPSBkb2N1bWVudC5jcmVhdGVSYW5nZSgpOwogICAgICAgIHZhciBhZnRl
        ciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHRoaXMuZW5kKTsKCiAgICAg
        ICAgcmFuZ2Uuc2V0U3RhcnRBZnRlcihhZnRlcik7CiAgICAgICAgcmFuZ2Uu
        c2V0RW5kQWZ0ZXIoYWZ0ZXIpOwoKICAgICAgICB2YXIgZnJhZ21lbnQgPSBy
        YW5nZS5jcmVhdGVDb250ZXh0dWFsRnJhZ21lbnQoaHRtbCk7CiAgICAgICAg
        cmFuZ2UuaW5zZXJ0Tm9kZShmcmFnbWVudCk7CiAgICAgIH07CgogICAgICBw
        cmVwZW5kRnVuYyA9IGZ1bmN0aW9uKGh0bWwpIHsKICAgICAgICB2YXIgcmFu
        Z2UgPSBkb2N1bWVudC5jcmVhdGVSYW5nZSgpOwogICAgICAgIHZhciBzdGFy
        dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHRoaXMuc3RhcnQpOwoKICAg
        ICAgICByYW5nZS5zZXRTdGFydEFmdGVyKHN0YXJ0KTsKICAgICAgICByYW5n
        ZS5zZXRFbmRBZnRlcihzdGFydCk7CgogICAgICAgIHZhciBmcmFnbWVudCA9
        IHJhbmdlLmNyZWF0ZUNvbnRleHR1YWxGcmFnbWVudChodG1sKTsKICAgICAg
        ICByYW5nZS5pbnNlcnROb2RlKGZyYWdtZW50KTsKICAgICAgfTsKCiAgICB9
        IGVsc2UgewogICAgICAvKgogICAgICAgKiBUaGlzIGNvZGUgaXMgbW9zdGx5
        IHRha2VuIGZyb20galF1ZXJ5LCB3aXRoIG9uZSBleGNlcHRpb24uIEluIGpR
        dWVyeSdzIGNhc2UsIHdlCiAgICAgICAqIGhhdmUgc29tZSBIVE1MIGFuZCB3
        ZSBuZWVkIHRvIGZpZ3VyZSBvdXQgaG93IHRvIGNvbnZlcnQgaXQgaW50byBz
        b21lIG5vZGVzLgogICAgICAgKgogICAgICAgKiBJbiB0aGlzIGNhc2UsIGpR
        dWVyeSBuZWVkcyB0byBzY2FuIHRoZSBIVE1MIGxvb2tpbmcgZm9yIGFuIG9w
        ZW5pbmcgdGFnIGFuZCB1c2UKICAgICAgICogdGhhdCBhcyB0aGUga2V5IGZv
        ciB0aGUgd3JhcCBtYXAuIEluIG91ciBjYXNlLCB3ZSBrbm93IHRoZSBwYXJl
        bnQgbm9kZSwgYW5kCiAgICAgICAqIGNhbiB1c2UgaXRzIHR5cGUgYXMgdGhl
        IGtleSBmb3IgdGhlIHdyYXAgbWFwLgogICAgICAgKiovCiAgICAgIHZhciB3
        cmFwTWFwID0gewogICAgICAgIHNlbGVjdDogWyAxLCAiPHNlbGVjdCBtdWx0
        aXBsZT0nbXVsdGlwbGUnPiIsICI8L3NlbGVjdD4iIF0sCiAgICAgICAgZmll
        bGRzZXQ6IFsgMSwgIjxmaWVsZHNldD4iLCAiPC9maWVsZHNldD4iIF0sCiAg
        ICAgICAgdGFibGU6IFsgMSwgIjx0YWJsZT4iLCAiPC90YWJsZT4iIF0sCiAg
        ICAgICAgdGJvZHk6IFsgMiwgIjx0YWJsZT48dGJvZHk+IiwgIjwvdGJvZHk+
        PC90YWJsZT4iIF0sCiAgICAgICAgdHI6IFsgMywgIjx0YWJsZT48dGJvZHk+
        PHRyPiIsICI8L3RyPjwvdGJvZHk+PC90YWJsZT4iIF0sCiAgICAgICAgY29s
        Z3JvdXA6IFsgMiwgIjx0YWJsZT48dGJvZHk+PC90Ym9keT48Y29sZ3JvdXA+
        IiwgIjwvY29sZ3JvdXA+PC90YWJsZT4iIF0sCiAgICAgICAgbWFwOiBbIDEs
        ICI8bWFwPiIsICI8L21hcD4iIF0sCiAgICAgICAgX2RlZmF1bHQ6IFsgMCwg
        IiIsICIiIF0KICAgICAgfTsKCiAgICAgIHZhciBmaW5kQ2hpbGRCeUlkID0g
        ZnVuY3Rpb24oZWxlbWVudCwgaWQpIHsKICAgICAgICBpZiAoZWxlbWVudC5n
        ZXRBdHRyaWJ1dGUoJ2lkJykgPT09IGlkKSB7IHJldHVybiBlbGVtZW50OyB9
        CgogICAgICAgIHZhciBsZW4gPSBlbGVtZW50LmNoaWxkTm9kZXMubGVuZ3Ro
        LCBpZHgsIG5vZGUsIGZvdW5kOwogICAgICAgIGZvciAoaWR4PTA7IGlkeDxs
        ZW47IGlkeCsrKSB7CiAgICAgICAgICBub2RlID0gZWxlbWVudC5jaGlsZE5v
        ZGVzW2lkeF07CiAgICAgICAgICBmb3VuZCA9IG5vZGUubm9kZVR5cGUgPT09
        IDEgJiYgZmluZENoaWxkQnlJZChub2RlLCBpZCk7CiAgICAgICAgICBpZiAo
        Zm91bmQpIHsgcmV0dXJuIGZvdW5kOyB9CiAgICAgICAgfQogICAgICB9OwoK
        ICAgICAgdmFyIHNldElubmVySFRNTCA9IGZ1bmN0aW9uKGVsZW1lbnQsIGh0
        bWwpIHsKICAgICAgICB2YXIgbWF0Y2hlcyA9IFtdOwogICAgICAgIGlmICht
        b3Zlc1doaXRlc3BhY2UpIHsKICAgICAgICAgIC8vIFJpZ2h0IG5vdyB3ZSBv
        bmx5IGNoZWNrIGZvciBzY3JpcHQgdGFncyB3aXRoIGlkcyB3aXRoIHRoZQog
        ICAgICAgICAgLy8gZ29hbCBvZiB0YXJnZXRpbmcgbW9ycGhzLgogICAgICAg
        ICAgaHRtbCA9IGh0bWwucmVwbGFjZSgvKFxzKykoPHNjcmlwdCBpZD0nKFte
        J10rKScpL2csIGZ1bmN0aW9uKG1hdGNoLCBzcGFjZXMsIHRhZywgaWQpIHsK
        ICAgICAgICAgICAgbWF0Y2hlcy5wdXNoKFtpZCwgc3BhY2VzXSk7CiAgICAg
        ICAgICAgIHJldHVybiB0YWc7CiAgICAgICAgICB9KTsKICAgICAgICB9Cgog
        ICAgICAgIGVsZW1lbnQuaW5uZXJIVE1MID0gaHRtbDsKCiAgICAgICAgLy8g
        SWYgd2UgaGF2ZSB0byBkbyBhbnkgd2hpdGVzcGFjZSBhZGp1c3RtZW50cyBk
        byB0aGVtIG5vdwogICAgICAgIGlmIChtYXRjaGVzLmxlbmd0aCA+IDApIHsK
        ICAgICAgICAgIHZhciBsZW4gPSBtYXRjaGVzLmxlbmd0aCwgaWR4OwogICAg
        ICAgICAgZm9yIChpZHg9MDsgaWR4PGxlbjsgaWR4KyspIHsKICAgICAgICAg
        ICAgdmFyIHNjcmlwdCA9IGZpbmRDaGlsZEJ5SWQoZWxlbWVudCwgbWF0Y2hl
        c1tpZHhdWzBdKSwKICAgICAgICAgICAgICAgIG5vZGUgPSBkb2N1bWVudC5j
        cmVhdGVUZXh0Tm9kZShtYXRjaGVzW2lkeF1bMV0pOwogICAgICAgICAgICBz
        Y3JpcHQucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUobm9kZSwgc2NyaXB0KTsK
        ICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH07CgogICAgICAvKgogICAg
        ICAgKiBHaXZlbiBhIHBhcmVudCBub2RlIGFuZCBzb21lIEhUTUwsIGdlbmVy
        YXRlIGEgc2V0IG9mIG5vZGVzLiBSZXR1cm4gdGhlIGZpcnN0CiAgICAgICAq
        IG5vZGUsIHdoaWNoIHdpbGwgYWxsb3cgdXMgdG8gdHJhdmVyc2UgdGhlIHJl
        c3QgdXNpbmcgbmV4dFNpYmxpbmcuCiAgICAgICAqCiAgICAgICAqIFdlIG5l
        ZWQgdG8gZG8gdGhpcyBiZWNhdXNlIGlubmVySFRNTCBpbiBJRSBkb2VzIG5v
        dCByZWFsbHkgcGFyc2UgdGhlIG5vZGVzLgogICAgICAgKi8KICAgICAgdmFy
        IGZpcnN0Tm9kZUZvciA9IGZ1bmN0aW9uKHBhcmVudE5vZGUsIGh0bWwpIHsK
        ICAgICAgICB2YXIgYXJyID0gd3JhcE1hcFtwYXJlbnROb2RlLnRhZ05hbWUu
        dG9Mb3dlckNhc2UoKV0gfHwgd3JhcE1hcC5fZGVmYXVsdDsKICAgICAgICB2
        YXIgZGVwdGggPSBhcnJbMF0sIHN0YXJ0ID0gYXJyWzFdLCBlbmQgPSBhcnJb
        Ml07CgogICAgICAgIGlmIChuZWVkc1NoeSkgeyBodG1sID0gJyZzaHk7Jyto
        dG1sOyB9CgogICAgICAgIHZhciBlbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRl
        RWxlbWVudCgnZGl2Jyk7CgogICAgICAgIHNldElubmVySFRNTChlbGVtZW50
        LCBzdGFydCArIGh0bWwgKyBlbmQpOwoKICAgICAgICBmb3IgKHZhciBpPTA7
        IGk8PWRlcHRoOyBpKyspIHsKICAgICAgICAgIGVsZW1lbnQgPSBlbGVtZW50
        LmZpcnN0Q2hpbGQ7CiAgICAgICAgfQoKICAgICAgICAvLyBMb29rIGZvciAm
        c2h5OyB0byByZW1vdmUgaXQuCiAgICAgICAgaWYgKG5lZWRzU2h5KSB7CiAg
        ICAgICAgICB2YXIgc2h5RWxlbWVudCA9IGVsZW1lbnQ7CgogICAgICAgICAg
        Ly8gU29tZXRpbWVzIHdlIGdldCBuYW1lbGVzcyBlbGVtZW50cyB3aXRoIHRo
        ZSBzaHkgaW5zaWRlCiAgICAgICAgICB3aGlsZSAoc2h5RWxlbWVudC5ub2Rl
        VHlwZSA9PT0gMSAmJiAhc2h5RWxlbWVudC5ub2RlTmFtZSkgewogICAgICAg
        ICAgICBzaHlFbGVtZW50ID0gc2h5RWxlbWVudC5maXJzdENoaWxkOwogICAg
        ICAgICAgfQoKICAgICAgICAgIC8vIEF0IHRoaXMgcG9pbnQgaXQncyB0aGUg
        YWN0dWFsIHVuaWNvZGUgY2hhcmFjdGVyLgogICAgICAgICAgaWYgKHNoeUVs
        ZW1lbnQubm9kZVR5cGUgPT09IDMgJiYgc2h5RWxlbWVudC5ub2RlVmFsdWUu
        Y2hhckF0KDApID09PSAiXHUwMEFEIikgewogICAgICAgICAgICBzaHlFbGVt
        ZW50Lm5vZGVWYWx1ZSA9IHNoeUVsZW1lbnQubm9kZVZhbHVlLnNsaWNlKDEp
        OwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIGVsZW1l
        bnQ7CiAgICAgIH07CgogICAgICAvKgogICAgICAgKiBJbiBzb21lIGNhc2Vz
        LCBJbnRlcm5ldCBFeHBsb3JlciBjYW4gY3JlYXRlIGFuIGFub255bW91cyBu
        b2RlIGluCiAgICAgICAqIHRoZSBoaWVyYXJjaHkgd2l0aCBubyB0YWdOYW1l
        LiBZb3UgY2FuIGNyZWF0ZSB0aGlzIHNjZW5hcmlvIHZpYToKICAgICAgICoK
        ICAgICAgICogICAgIGRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRp
        diIpOwogICAgICAgKiAgICAgZGl2LmlubmVySFRNTCA9ICI8dGFibGU+JnNo
        eTxzY3JpcHQ+PC9zY3JpcHQ+PHRyPjx0ZD5oaTwvdGQ+PC90cj48L3RhYmxl
        PiI7CiAgICAgICAqICAgICBkaXYuZmlyc3RDaGlsZC5maXJzdENoaWxkLnRh
        Z05hbWUgLy89PiAiIgogICAgICAgKgogICAgICAgKiBJZiBvdXIgc2NyaXB0
        IG1hcmtlcnMgYXJlIGluc2lkZSBzdWNoIGEgbm9kZSwgd2UgbmVlZCB0byBm
        aW5kIHRoYXQKICAgICAgICogbm9kZSBhbmQgdXNlICppdCogYXMgdGhlIG1h
        cmtlci4KICAgICAgICovCiAgICAgIHZhciByZWFsTm9kZSA9IGZ1bmN0aW9u
        KHN0YXJ0KSB7CiAgICAgICAgd2hpbGUgKHN0YXJ0LnBhcmVudE5vZGUudGFn
        TmFtZSA9PT0gIiIpIHsKICAgICAgICAgIHN0YXJ0ID0gc3RhcnQucGFyZW50
        Tm9kZTsKICAgICAgICB9CgogICAgICAgIHJldHVybiBzdGFydDsKICAgICAg
        fTsKCiAgICAgIC8qCiAgICAgICAqIFdoZW4gYXV0b21hdGljYWxseSBhZGRp
        bmcgYSB0Ym9keSwgSW50ZXJuZXQgRXhwbG9yZXIgaW5zZXJ0cyB0aGUKICAg
        ICAgICogdGJvZHkgaW1tZWRpYXRlbHkgYmVmb3JlIHRoZSBmaXJzdCA8dHI+
        LiBPdGhlciBicm93c2VycyBjcmVhdGUgaXQKICAgICAgICogYmVmb3JlIHRo
        ZSBmaXJzdCBub2RlLCBubyBtYXR0ZXIgd2hhdC4KICAgICAgICoKICAgICAg
        ICogVGhpcyBtZWFucyB0aGUgdGhlIGZvbGxvd2luZyBjb2RlOgogICAgICAg
        KgogICAgICAgKiAgICAgZGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgi
        ZGl2Iik7CiAgICAgICAqICAgICBkaXYuaW5uZXJIVE1MID0gIjx0YWJsZT48
        c2NyaXB0IGlkPSdmaXJzdCc+PC9zY3JpcHQ+PHRyPjx0ZD5oaTwvdGQ+PC90
        cj48c2NyaXB0IGlkPSdsYXN0Jz48L3NjcmlwdD48L3RhYmxlPgogICAgICAg
        KgogICAgICAgKiBHZW5lcmF0ZXMgdGhlIGZvbGxvd2luZyBET00gaW4gSUU6
        CiAgICAgICAqCiAgICAgICAqICAgICArIGRpdgogICAgICAgKiAgICAgICAr
        IHRhYmxlCiAgICAgICAqICAgICAgICAgLSBzY3JpcHQgaWQ9J2ZpcnN0Jwog
        ICAgICAgKiAgICAgICAgICsgdGJvZHkKICAgICAgICogICAgICAgICAgICsg
        dHIKICAgICAgICogICAgICAgICAgICAgKyB0ZAogICAgICAgKiAgICAgICAg
        ICAgICAgIC0gImhpIgogICAgICAgKiAgICAgICAgICAgLSBzY3JpcHQgaWQ9
        J2xhc3QnCiAgICAgICAqCiAgICAgICAqIFdoaWNoIG1lYW5zIHRoYXQgdGhl
        IHR3byBzY3JpcHQgdGFncywgZXZlbiB0aG91Z2ggdGhleSB3ZXJlCiAgICAg
        ICAqIGluc2VydGVkIGF0IHRoZSBzYW1lIHBvaW50IGluIHRoZSBoaWVyYXJj
        aHkgaW4gdGhlIG9yaWdpbmFsCiAgICAgICAqIEhUTUwsIG5vdyBoYXZlIGRp
        ZmZlcmVudCBwYXJlbnRzLgogICAgICAgKgogICAgICAgKiBUaGlzIGNvZGUg
        cmVwYXJlbnRzIHRoZSBmaXJzdCBzY3JpcHQgdGFnIGJ5IG1ha2luZyBpdCB0
        aGUgdGJvZHkncwogICAgICAgKiBmaXJzdCBjaGlsZC4KICAgICAgICoKICAg
        ICAgICovCiAgICAgIHZhciBmaXhQYXJlbnRhZ2UgPSBmdW5jdGlvbihzdGFy
        dCwgZW5kKSB7CiAgICAgICAgaWYgKHN0YXJ0LnBhcmVudE5vZGUgIT09IGVu
        ZC5wYXJlbnROb2RlKSB7CiAgICAgICAgICBlbmQucGFyZW50Tm9kZS5pbnNl
        cnRCZWZvcmUoc3RhcnQsIGVuZC5wYXJlbnROb2RlLmZpcnN0Q2hpbGQpOwog
        ICAgICAgIH0KICAgICAgfTsKCiAgICAgIGh0bWxGdW5jID0gZnVuY3Rpb24o
        aHRtbCwgb3V0ZXJUb28pIHsKICAgICAgICAvLyBnZXQgdGhlIHJlYWwgc3Rh
        cnRpbmcgbm9kZS4gc2VlIHJlYWxOb2RlIGZvciBkZXRhaWxzLgogICAgICAg
        IHZhciBzdGFydCA9IHJlYWxOb2RlKGRvY3VtZW50LmdldEVsZW1lbnRCeUlk
        KHRoaXMuc3RhcnQpKTsKICAgICAgICB2YXIgZW5kID0gZG9jdW1lbnQuZ2V0
        RWxlbWVudEJ5SWQodGhpcy5lbmQpOwogICAgICAgIHZhciBwYXJlbnROb2Rl
        ID0gZW5kLnBhcmVudE5vZGU7CiAgICAgICAgdmFyIG5vZGUsIG5leHRTaWJs
        aW5nLCBsYXN0OwoKICAgICAgICAvLyBtYWtlIHN1cmUgdGhhdCB0aGUgc3Rh
        cnQgYW5kIGVuZCBub2RlcyBzaGFyZSB0aGUgc2FtZQogICAgICAgIC8vIHBh
        cmVudC4gSWYgbm90LCBmaXggaXQuCiAgICAgICAgZml4UGFyZW50YWdlKHN0
        YXJ0LCBlbmQpOwoKICAgICAgICAvLyByZW1vdmUgYWxsIG9mIHRoZSBub2Rl
        cyBhZnRlciB0aGUgc3RhcnRpbmcgcGxhY2Vob2xkZXIgYW5kCiAgICAgICAg
        Ly8gYmVmb3JlIHRoZSBlbmRpbmcgcGxhY2Vob2xkZXIuCiAgICAgICAgbm9k
        ZSA9IHN0YXJ0Lm5leHRTaWJsaW5nOwogICAgICAgIHdoaWxlIChub2RlKSB7
        CiAgICAgICAgICBuZXh0U2libGluZyA9IG5vZGUubmV4dFNpYmxpbmc7CiAg
        ICAgICAgICBsYXN0ID0gbm9kZSA9PT0gZW5kOwoKICAgICAgICAgIC8vIGlm
        IHRoaXMgaXMgdGhlIGxhc3Qgbm9kZSwgYW5kIHdlIHdhbnQgdG8gcmVtb3Zl
        IGl0IGFzIHdlbGwsCiAgICAgICAgICAvLyBzZXQgdGhlIGBlbmRgIG5vZGUg
        dG8gdGhlIG5leHQgc2libGluZy4gVGhpcyBpcyBiZWNhdXNlCiAgICAgICAg
        ICAvLyBmb3IgdGhlIHJlc3Qgb2YgdGhlIGZ1bmN0aW9uLCB3ZSBpbnNlcnQg
        dGhlIG5ldyBub2RlcwogICAgICAgICAgLy8gYmVmb3JlIHRoZSBlbmQgKG5v
        dGUgdGhhdCBpbnNlcnRCZWZvcmUobm9kZSwgbnVsbCkgaXMKICAgICAgICAg
        IC8vIHRoZSBzYW1lIGFzIGFwcGVuZENoaWxkKG5vZGUpKS4KICAgICAgICAg
        IC8vCiAgICAgICAgICAvLyBpZiB3ZSBkbyBub3Qgd2FudCB0byByZW1vdmUg
        aXQsIGp1c3QgYnJlYWsuCiAgICAgICAgICBpZiAobGFzdCkgewogICAgICAg
        ICAgICBpZiAob3V0ZXJUb28pIHsgZW5kID0gbm9kZS5uZXh0U2libGluZzsg
        fSBlbHNlIHsgYnJlYWs7IH0KICAgICAgICAgIH0KCiAgICAgICAgICBub2Rl
        LnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQobm9kZSk7CgogICAgICAgICAgLy8g
        aWYgdGhpcyBpcyB0aGUgbGFzdCBub2RlIGFuZCB3ZSBkaWRuJ3QgYnJlYWsg
        YmVmb3JlCiAgICAgICAgICAvLyAoYmVjYXVzZSB3ZSB3YW50ZWQgdG8gcmVt
        b3ZlIHRoZSBvdXRlciBub2RlcyksIGJyZWFrCiAgICAgICAgICAvLyBub3cu
        CiAgICAgICAgICBpZiAobGFzdCkgeyBicmVhazsgfQoKICAgICAgICAgIG5v
        ZGUgPSBuZXh0U2libGluZzsKICAgICAgICB9CgogICAgICAgIC8vIGdldCB0
        aGUgZmlyc3Qgbm9kZSBmb3IgdGhlIEhUTUwgc3RyaW5nLCBldmVuIGluIGNh
        c2VzIGxpa2UKICAgICAgICAvLyB0YWJsZXMgYW5kIGxpc3RzIHdoZXJlIGEg
        c2ltcGxlIGlubmVySFRNTCBvbiBhIGRpdiB3b3VsZAogICAgICAgIC8vIHN3
        YWxsb3cgc29tZSBvZiB0aGUgY29udGVudC4KICAgICAgICBub2RlID0gZmly
        c3ROb2RlRm9yKHN0YXJ0LnBhcmVudE5vZGUsIGh0bWwpOwoKICAgICAgICAv
        LyBjb3B5IHRoZSBub2RlcyBmb3IgdGhlIEhUTUwgYmV0d2VlbiB0aGUgc3Rh
        cnRpbmcgYW5kIGVuZGluZwogICAgICAgIC8vIHBsYWNlaG9sZGVyLgogICAg
        ICAgIHdoaWxlIChub2RlKSB7CiAgICAgICAgICBuZXh0U2libGluZyA9IG5v
        ZGUubmV4dFNpYmxpbmc7CiAgICAgICAgICBwYXJlbnROb2RlLmluc2VydEJl
        Zm9yZShub2RlLCBlbmQpOwogICAgICAgICAgbm9kZSA9IG5leHRTaWJsaW5n
        OwogICAgICAgIH0KICAgICAgfTsKCiAgICAgIC8vIHJlbW92ZSB0aGUgbm9k
        ZXMgaW4gdGhlIERPTSByZXByZXNlbnRpbmcgdGhpcyBtZXRhbW9ycGguCiAg
        ICAgIC8vCiAgICAgIC8vIHRoaXMgaW5jbHVkZXMgdGhlIHN0YXJ0aW5nIGFu
        ZCBlbmRpbmcgcGxhY2Vob2xkZXJzLgogICAgICByZW1vdmVGdW5jID0gZnVu
        Y3Rpb24oKSB7CiAgICAgICAgdmFyIHN0YXJ0ID0gcmVhbE5vZGUoZG9jdW1l
        bnQuZ2V0RWxlbWVudEJ5SWQodGhpcy5zdGFydCkpOwogICAgICAgIHZhciBl
        bmQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0aGlzLmVuZCk7CgogICAg
        ICAgIHRoaXMuaHRtbCgnJyk7CiAgICAgICAgc3RhcnQucGFyZW50Tm9kZS5y
        ZW1vdmVDaGlsZChzdGFydCk7CiAgICAgICAgZW5kLnBhcmVudE5vZGUucmVt
        b3ZlQ2hpbGQoZW5kKTsKICAgICAgfTsKCiAgICAgIGFwcGVuZFRvRnVuYyA9
        IGZ1bmN0aW9uKHBhcmVudE5vZGUpIHsKICAgICAgICB2YXIgbm9kZSA9IGZp
        cnN0Tm9kZUZvcihwYXJlbnROb2RlLCB0aGlzLm91dGVySFRNTCgpKTsKICAg
        ICAgICB2YXIgbmV4dFNpYmxpbmc7CgogICAgICAgIHdoaWxlIChub2RlKSB7
        CiAgICAgICAgICBuZXh0U2libGluZyA9IG5vZGUubmV4dFNpYmxpbmc7CiAg
        ICAgICAgICBwYXJlbnROb2RlLmFwcGVuZENoaWxkKG5vZGUpOwogICAgICAg
        ICAgbm9kZSA9IG5leHRTaWJsaW5nOwogICAgICAgIH0KICAgICAgfTsKCiAg
        ICAgIGFmdGVyRnVuYyA9IGZ1bmN0aW9uKGh0bWwpIHsKICAgICAgICAvLyBn
        ZXQgdGhlIHJlYWwgc3RhcnRpbmcgbm9kZS4gc2VlIHJlYWxOb2RlIGZvciBk
        ZXRhaWxzLgogICAgICAgIHZhciBlbmQgPSBkb2N1bWVudC5nZXRFbGVtZW50
        QnlJZCh0aGlzLmVuZCk7CiAgICAgICAgdmFyIGluc2VydEJlZm9yZSA9IGVu
        ZC5uZXh0U2libGluZzsKICAgICAgICB2YXIgcGFyZW50Tm9kZSA9IGVuZC5w
        YXJlbnROb2RlOwogICAgICAgIHZhciBuZXh0U2libGluZzsKICAgICAgICB2
        YXIgbm9kZTsKCiAgICAgICAgLy8gZ2V0IHRoZSBmaXJzdCBub2RlIGZvciB0
        aGUgSFRNTCBzdHJpbmcsIGV2ZW4gaW4gY2FzZXMgbGlrZQogICAgICAgIC8v
        IHRhYmxlcyBhbmQgbGlzdHMgd2hlcmUgYSBzaW1wbGUgaW5uZXJIVE1MIG9u
        IGEgZGl2IHdvdWxkCiAgICAgICAgLy8gc3dhbGxvdyBzb21lIG9mIHRoZSBj
        b250ZW50LgogICAgICAgIG5vZGUgPSBmaXJzdE5vZGVGb3IocGFyZW50Tm9k
        ZSwgaHRtbCk7CgogICAgICAgIC8vIGNvcHkgdGhlIG5vZGVzIGZvciB0aGUg
        SFRNTCBiZXR3ZWVuIHRoZSBzdGFydGluZyBhbmQgZW5kaW5nCiAgICAgICAg
        Ly8gcGxhY2Vob2xkZXIuCiAgICAgICAgd2hpbGUgKG5vZGUpIHsKICAgICAg
        ICAgIG5leHRTaWJsaW5nID0gbm9kZS5uZXh0U2libGluZzsKICAgICAgICAg
        IHBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKG5vZGUsIGluc2VydEJlZm9yZSk7
        CiAgICAgICAgICBub2RlID0gbmV4dFNpYmxpbmc7CiAgICAgICAgfQogICAg
        ICB9OwoKICAgICAgcHJlcGVuZEZ1bmMgPSBmdW5jdGlvbihodG1sKSB7CiAg
        ICAgICAgdmFyIHN0YXJ0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodGhp
        cy5zdGFydCk7CiAgICAgICAgdmFyIHBhcmVudE5vZGUgPSBzdGFydC5wYXJl
        bnROb2RlOwogICAgICAgIHZhciBuZXh0U2libGluZzsKICAgICAgICB2YXIg
        bm9kZTsKCiAgICAgICAgbm9kZSA9IGZpcnN0Tm9kZUZvcihwYXJlbnROb2Rl
        LCBodG1sKTsKICAgICAgICB2YXIgaW5zZXJ0QmVmb3JlID0gc3RhcnQubmV4
        dFNpYmxpbmc7CgogICAgICAgIHdoaWxlIChub2RlKSB7CiAgICAgICAgICBu
        ZXh0U2libGluZyA9IG5vZGUubmV4dFNpYmxpbmc7CiAgICAgICAgICBwYXJl
        bnROb2RlLmluc2VydEJlZm9yZShub2RlLCBpbnNlcnRCZWZvcmUpOwogICAg
        ICAgICAgbm9kZSA9IG5leHRTaWJsaW5nOwogICAgICAgIH0KICAgICAgfTsK
        ICAgIH0KCiAgICBNZXRhbW9ycGgucHJvdG90eXBlLmh0bWwgPSBmdW5jdGlv
        bihodG1sKSB7CiAgICAgIHRoaXMuY2hlY2tSZW1vdmVkKCk7CiAgICAgIGlm
        IChodG1sID09PSB1bmRlZmluZWQpIHsgcmV0dXJuIHRoaXMuaW5uZXJIVE1M
        OyB9CgogICAgICBodG1sRnVuYy5jYWxsKHRoaXMsIGh0bWwpOwoKICAgICAg
        dGhpcy5pbm5lckhUTUwgPSBodG1sOwogICAgfTsKCiAgICBNZXRhbW9ycGgu
        cHJvdG90eXBlLnJlcGxhY2VXaXRoID0gZnVuY3Rpb24oaHRtbCkgewogICAg
        ICB0aGlzLmNoZWNrUmVtb3ZlZCgpOwogICAgICBodG1sRnVuYy5jYWxsKHRo
        aXMsIGh0bWwsIHRydWUpOwogICAgfTsKCiAgICBNZXRhbW9ycGgucHJvdG90
        eXBlLnJlbW92ZSA9IHJlbW92ZUZ1bmM7CiAgICBNZXRhbW9ycGgucHJvdG90
        eXBlLm91dGVySFRNTCA9IG91dGVySFRNTEZ1bmM7CiAgICBNZXRhbW9ycGgu
        cHJvdG90eXBlLmFwcGVuZFRvID0gYXBwZW5kVG9GdW5jOwogICAgTWV0YW1v
        cnBoLnByb3RvdHlwZS5hZnRlciA9IGFmdGVyRnVuYzsKICAgIE1ldGFtb3Jw
        aC5wcm90b3R5cGUucHJlcGVuZCA9IHByZXBlbmRGdW5jOwogICAgTWV0YW1v
        cnBoLnByb3RvdHlwZS5zdGFydFRhZyA9IHN0YXJ0VGFnRnVuYzsKICAgIE1l
        dGFtb3JwaC5wcm90b3R5cGUuZW5kVGFnID0gZW5kVGFnRnVuYzsKCiAgICBN
        ZXRhbW9ycGgucHJvdG90eXBlLmlzUmVtb3ZlZCA9IGZ1bmN0aW9uKCkgewog
        ICAgICB2YXIgYmVmb3JlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodGhp
        cy5zdGFydCk7CiAgICAgIHZhciBhZnRlciA9IGRvY3VtZW50LmdldEVsZW1l
        bnRCeUlkKHRoaXMuZW5kKTsKCiAgICAgIHJldHVybiAhYmVmb3JlIHx8ICFh
        ZnRlcjsKICAgIH07CgogICAgTWV0YW1vcnBoLnByb3RvdHlwZS5jaGVja1Jl
        bW92ZWQgPSBmdW5jdGlvbigpIHsKICAgICAgaWYgKHRoaXMuaXNSZW1vdmVk
        KCkpIHsKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoIkNhbm5vdCBwZXJmb3Jt
        IG9wZXJhdGlvbnMgb24gYSBNZXRhbW9ycGggdGhhdCBpcyBub3QgaW4gdGhl
        IERPTS4iKTsKICAgICAgfQogICAgfTsKCiAgICByZXR1cm4gTWV0YW1vcnBo
        OwogIH0pOwoKfSkoKTsKCihmdW5jdGlvbigpIHsKLyoqCkBtb2R1bGUgZW1i
        ZXIKQHN1Ym1vZHVsZSBlbWJlci1oYW5kbGViYXJzLWNvbXBpbGVyCiovCgov
        LyBFbGltaW5hdGUgZGVwZW5kZW5jeSBvbiBhbnkgRW1iZXIgdG8gc2ltcGxp
        ZnkgcHJlY29tcGlsYXRpb24gd29ya2Zsb3cKdmFyIG9iamVjdENyZWF0ZSA9
        IE9iamVjdC5jcmVhdGUgfHwgZnVuY3Rpb24ocGFyZW50KSB7CiAgZnVuY3Rp
        b24gRigpIHt9CiAgRi5wcm90b3R5cGUgPSBwYXJlbnQ7CiAgcmV0dXJuIG5l
        dyBGKCk7Cn07Cgp2YXIgSGFuZGxlYmFycyA9IHRoaXMuSGFuZGxlYmFycyB8
        fCAoRW1iZXIuaW1wb3J0cyAmJiBFbWJlci5pbXBvcnRzLkhhbmRsZWJhcnMp
        OwppZiAoIUhhbmRsZWJhcnMgJiYgdHlwZW9mIHJlcXVpcmUgPT09ICdmdW5j
        dGlvbicpIHsKICBIYW5kbGViYXJzID0gcmVxdWlyZSgnaGFuZGxlYmFycycp
        Owp9CgpFbWJlci5hc3NlcnQoIkVtYmVyIEhhbmRsZWJhcnMgcmVxdWlyZXMg
        SGFuZGxlYmFycyB2ZXJzaW9uIDEuMC4wLiBJbmNsdWRlIGEgU0NSSVBUIHRh
        ZyBpbiB0aGUgSFRNTCBIRUFEIGxpbmtpbmcgdG8gdGhlIEhhbmRsZWJhcnMg
        ZmlsZSBiZWZvcmUgeW91IGxpbmsgdG8gRW1iZXIuIiwgSGFuZGxlYmFycyk7
        CkVtYmVyLmFzc2VydCgiRW1iZXIgSGFuZGxlYmFycyByZXF1aXJlcyBIYW5k
        bGViYXJzIHZlcnNpb24gMS4wLjAsIENPTVBJTEVSX1JFVklTSU9OIGV4cGVj
        dGVkOiA0LCBnb3Q6ICIgKyAgSGFuZGxlYmFycy5DT01QSUxFUl9SRVZJU0lP
        TiArICIgLSBQbGVhc2Ugbm90ZTogQnVpbGRzIG9mIG1hc3RlciBtYXkgaGF2
        ZSBvdGhlciBDT01QSUxFUl9SRVZJU0lPTiB2YWx1ZXMuIiwgSGFuZGxlYmFy
        cy5DT01QSUxFUl9SRVZJU0lPTiA9PT0gNCk7CgovKioKICBQcmVwYXJlcyB0
        aGUgSGFuZGxlYmFycyB0ZW1wbGF0aW5nIGxpYnJhcnkgZm9yIHVzZSBpbnNp
        ZGUgRW1iZXIncyB2aWV3CiAgc3lzdGVtLgoKICBUaGUgYEVtYmVyLkhhbmRs
        ZWJhcnNgIG9iamVjdCBpcyB0aGUgc3RhbmRhcmQgSGFuZGxlYmFycyBsaWJy
        YXJ5LCBleHRlbmRlZCB0bwogIHVzZSBFbWJlcidzIGBnZXQoKWAgbWV0aG9k
        IGluc3RlYWQgb2YgZGlyZWN0IHByb3BlcnR5IGFjY2Vzcywgd2hpY2ggYWxs
        b3dzCiAgY29tcHV0ZWQgcHJvcGVydGllcyB0byBiZSB1c2VkIGluc2lkZSB0
        ZW1wbGF0ZXMuCgogIFRvIGNyZWF0ZSBhbiBgRW1iZXIuSGFuZGxlYmFyc2Ag
        dGVtcGxhdGUsIGNhbGwgYEVtYmVyLkhhbmRsZWJhcnMuY29tcGlsZSgpYC4K
        ICBUaGlzIHdpbGwgcmV0dXJuIGEgZnVuY3Rpb24gdGhhdCBjYW4gYmUgdXNl
        ZCBieSBgRW1iZXIuVmlld2AgZm9yIHJlbmRlcmluZy4KCiAgQGNsYXNzIEhh
        bmRsZWJhcnMKICBAbmFtZXNwYWNlIEVtYmVyCiovCkVtYmVyLkhhbmRsZWJh
        cnMgPSBvYmplY3RDcmVhdGUoSGFuZGxlYmFycyk7CgovKioKICBSZWdpc3Rl
        ciBhIGJvdW5kIGhlbHBlciBvciBjdXN0b20gdmlldyBoZWxwZXIuCgogICMj
        IFNpbXBsZSBib3VuZCBoZWxwZXIgZXhhbXBsZQoKICBgYGBqYXZhc2NyaXB0
        CiAgRW1iZXIuSGFuZGxlYmFycy5oZWxwZXIoJ2NhcGl0YWxpemUnLCBmdW5j
        dGlvbih2YWx1ZSkgewogICAgcmV0dXJuIHZhbHVlLnRvVXBwZXJDYXNlKCk7
        CiAgfSk7CiAgYGBgCgogIFRoZSBhYm92ZSBib3VuZCBoZWxwZXIgY2FuIGJl
        IHVzZWQgaW5zaWRlIG9mIHRlbXBsYXRlcyBhcyBmb2xsb3dzOgoKICBgYGBo
        YW5kbGViYXJzCiAge3tjYXBpdGFsaXplIG5hbWV9fQogIGBgYAoKICBJbiB0
        aGlzIGNhc2UsIHdoZW4gdGhlIGBuYW1lYCBwcm9wZXJ0eSBvZiB0aGUgdGVt
        cGxhdGUncyBjb250ZXh0IGNoYW5nZXMsCiAgdGhlIHJlbmRlcmVkIHZhbHVl
        IG9mIHRoZSBoZWxwZXIgd2lsbCB1cGRhdGUgdG8gcmVmbGVjdCB0aGlzIGNo
        YW5nZS4KCiAgRm9yIG1vcmUgZXhhbXBsZXMgb2YgYm91bmQgaGVscGVycywg
        c2VlIGRvY3VtZW50YXRpb24gZm9yCiAgYEVtYmVyLkhhbmRsZWJhcnMucmVn
        aXN0ZXJCb3VuZEhlbHBlcmAuCgogICMjIEN1c3RvbSB2aWV3IGhlbHBlciBl
        eGFtcGxlCgogIEFzc3VtaW5nIGEgdmlldyBzdWJjbGFzcyBuYW1lZCBgQXBw
        LkNhbGVuZGFyVmlld2Agd2VyZSBkZWZpbmVkLCBhIGhlbHBlcgogIGZvciBy
        ZW5kZXJpbmcgaW5zdGFuY2VzIG9mIHRoaXMgdmlldyBjb3VsZCBiZSByZWdp
        c3RlcmVkIGFzIGZvbGxvd3M6CgogIGBgYGphdmFzY3JpcHQKICBFbWJlci5I
        YW5kbGViYXJzLmhlbHBlcignY2FsZW5kYXInLCBBcHAuQ2FsZW5kYXJWaWV3
        KToKICBgYGAKCiAgVGhlIGFib3ZlIGJvdW5kIGhlbHBlciBjYW4gYmUgdXNl
        ZCBpbnNpZGUgb2YgdGVtcGxhdGVzIGFzIGZvbGxvd3M6CgogIGBgYGhhbmRs
        ZWJhcnMKICB7e2NhbGVuZGFyfX0KICBgYGAKCiAgV2hpY2ggaXMgZnVuY3Rp
        b25hbGx5IGVxdWl2YWxlbnQgdG86CgogIGBgYGhhbmRsZWJhcnMKICB7e3Zp
        ZXcgQXBwLkNhbGVuZGFyVmlld319CiAgYGBgCgogIE9wdGlvbnMgaW4gdGhl
        IGhlbHBlciB3aWxsIGJlIHBhc3NlZCB0byB0aGUgdmlldyBpbiBleGFjdGx5
        IHRoZSBzYW1lCiAgbWFubmVyIGFzIHdpdGggdGhlIGB2aWV3YCBoZWxwZXIu
        CgogIEBtZXRob2QgaGVscGVyCiAgQGZvciBFbWJlci5IYW5kbGViYXJzCiAg
        QHBhcmFtIHtTdHJpbmd9IG5hbWUKICBAcGFyYW0ge0Z1bmN0aW9ufEVtYmVy
        LlZpZXd9IGZ1bmN0aW9uIG9yIHZpZXcgY2xhc3MgY29uc3RydWN0b3IKICBA
        cGFyYW0ge1N0cmluZ30gZGVwZW5kZW50S2V5cyoKKi8KRW1iZXIuSGFuZGxl
        YmFycy5oZWxwZXIgPSBmdW5jdGlvbihuYW1lLCB2YWx1ZSkgewogIEVtYmVy
        LmFzc2VydCgiWW91IHRyaWVkIHRvIHJlZ2lzdGVyIGEgY29tcG9uZW50IG5h
        bWVkICciICsgbmFtZSArICInLCBidXQgY29tcG9uZW50IG5hbWVzIG11c3Qg
        aW5jbHVkZSBhICctJyIsICFFbWJlci5Db21wb25lbnQuZGV0ZWN0KHZhbHVl
        KSB8fCBuYW1lLm1hdGNoKC8tLykpOwoKICBpZiAoRW1iZXIuVmlldy5kZXRl
        Y3QodmFsdWUpKSB7CiAgICBFbWJlci5IYW5kbGViYXJzLnJlZ2lzdGVySGVs
        cGVyKG5hbWUsIGZ1bmN0aW9uKG9wdGlvbnMpIHsKICAgICAgRW1iZXIuYXNz
        ZXJ0KCJZb3UgY2FuIG9ubHkgcGFzcyBhdHRyaWJ1dGVzIChzdWNoIGFzIG5h
        bWU9dmFsdWUpIG5vdCBiYXJlIHZhbHVlcyB0byBhIGhlbHBlciBmb3IgYSBW
        aWV3IiwgYXJndW1lbnRzLmxlbmd0aCA8IDIpOwogICAgICByZXR1cm4gRW1i
        ZXIuSGFuZGxlYmFycy5oZWxwZXJzLnZpZXcuY2FsbCh0aGlzLCB2YWx1ZSwg
        b3B0aW9ucyk7CiAgICB9KTsKICB9IGVsc2UgewogICAgRW1iZXIuSGFuZGxl
        YmFycy5yZWdpc3RlckJvdW5kSGVscGVyLmFwcGx5KG51bGwsIGFyZ3VtZW50
        cyk7CiAgfQp9OwoKLyoqCkBjbGFzcyBoZWxwZXJzCkBuYW1lc3BhY2UgRW1i
        ZXIuSGFuZGxlYmFycwoqLwpFbWJlci5IYW5kbGViYXJzLmhlbHBlcnMgPSBv
        YmplY3RDcmVhdGUoSGFuZGxlYmFycy5oZWxwZXJzKTsKCi8qKgogIE92ZXJy
        aWRlIHRoZSB0aGUgb3Bjb2RlIGNvbXBpbGVyIGFuZCBKYXZhU2NyaXB0IGNv
        bXBpbGVyIGZvciBIYW5kbGViYXJzLgoKICBAY2xhc3MgQ29tcGlsZXIKICBA
        bmFtZXNwYWNlIEVtYmVyLkhhbmRsZWJhcnMKICBAcHJpdmF0ZQogIEBjb25z
        dHJ1Y3RvcgoqLwpFbWJlci5IYW5kbGViYXJzLkNvbXBpbGVyID0gZnVuY3Rp
        b24oKSB7fTsKCi8vIEhhbmRsZWJhcnMuQ29tcGlsZXIgZG9lc24ndCBleGlz
        dCBpbiBydW50aW1lLW9ubHkKaWYgKEhhbmRsZWJhcnMuQ29tcGlsZXIpIHsK
        ICBFbWJlci5IYW5kbGViYXJzLkNvbXBpbGVyLnByb3RvdHlwZSA9IG9iamVj
        dENyZWF0ZShIYW5kbGViYXJzLkNvbXBpbGVyLnByb3RvdHlwZSk7Cn0KCkVt
        YmVyLkhhbmRsZWJhcnMuQ29tcGlsZXIucHJvdG90eXBlLmNvbXBpbGVyID0g
        RW1iZXIuSGFuZGxlYmFycy5Db21waWxlcjsKCi8qKgogIEBjbGFzcyBKYXZh
        U2NyaXB0Q29tcGlsZXIKICBAbmFtZXNwYWNlIEVtYmVyLkhhbmRsZWJhcnMK
        ICBAcHJpdmF0ZQogIEBjb25zdHJ1Y3RvcgoqLwpFbWJlci5IYW5kbGViYXJz
        LkphdmFTY3JpcHRDb21waWxlciA9IGZ1bmN0aW9uKCkge307CgovLyBIYW5k
        bGViYXJzLkphdmFTY3JpcHRDb21waWxlciBkb2Vzbid0IGV4aXN0IGluIHJ1
        bnRpbWUtb25seQppZiAoSGFuZGxlYmFycy5KYXZhU2NyaXB0Q29tcGlsZXIp
        IHsKICBFbWJlci5IYW5kbGViYXJzLkphdmFTY3JpcHRDb21waWxlci5wcm90
        b3R5cGUgPSBvYmplY3RDcmVhdGUoSGFuZGxlYmFycy5KYXZhU2NyaXB0Q29t
        cGlsZXIucHJvdG90eXBlKTsKICBFbWJlci5IYW5kbGViYXJzLkphdmFTY3Jp
        cHRDb21waWxlci5wcm90b3R5cGUuY29tcGlsZXIgPSBFbWJlci5IYW5kbGVi
        YXJzLkphdmFTY3JpcHRDb21waWxlcjsKfQoKCkVtYmVyLkhhbmRsZWJhcnMu
        SmF2YVNjcmlwdENvbXBpbGVyLnByb3RvdHlwZS5uYW1lc3BhY2UgPSAiRW1i
        ZXIuSGFuZGxlYmFycyI7CgpFbWJlci5IYW5kbGViYXJzLkphdmFTY3JpcHRD
        b21waWxlci5wcm90b3R5cGUuaW5pdGlhbGl6ZUJ1ZmZlciA9IGZ1bmN0aW9u
        KCkgewogIHJldHVybiAiJyciOwp9OwoKLyoqCiAgQHByaXZhdGUKCiAgT3Zl
        cnJpZGUgdGhlIGRlZmF1bHQgYnVmZmVyIGZvciBFbWJlciBIYW5kbGViYXJz
        LiBCeSBkZWZhdWx0LCBIYW5kbGViYXJzCiAgY3JlYXRlcyBhbiBlbXB0eSBT
        dHJpbmcgYXQgdGhlIGJlZ2lubmluZyBvZiBlYWNoIGludm9jYXRpb24gYW5k
        IGFwcGVuZHMgdG8KICBpdC4gRW1iZXIncyBIYW5kbGViYXJzIG92ZXJyaWRl
        cyB0aGlzIHRvIGFwcGVuZCB0byBhIHNpbmdsZSBzaGFyZWQgYnVmZmVyLgoK
        ICBAbWV0aG9kIGFwcGVuZFRvQnVmZmVyCiAgQHBhcmFtIHN0cmluZyB7U3Ry
        aW5nfQoqLwpFbWJlci5IYW5kbGViYXJzLkphdmFTY3JpcHRDb21waWxlci5w
        cm90b3R5cGUuYXBwZW5kVG9CdWZmZXIgPSBmdW5jdGlvbihzdHJpbmcpIHsK
        ICByZXR1cm4gImRhdGEuYnVmZmVyLnB1c2goIitzdHJpbmcrIik7IjsKfTsK
        CnZhciBwcmVmaXggPSAiZW1iZXIiICsgKCtuZXcgRGF0ZSgpKSwgaW5jciA9
        IDE7CgovKioKICBAcHJpdmF0ZQoKICBSZXdyaXRlIHNpbXBsZSBtdXN0YWNo
        ZXMgZnJvbSBge3tmb299fWAgdG8gYHt7YmluZCAiZm9vIn19YC4gVGhpcyBt
        ZWFucyB0aGF0CiAgYWxsIHNpbXBsZSBtdXN0YWNoZXMgaW4gRW1iZXIncyBI
        YW5kbGViYXJzIHdpbGwgYWxzbyBzZXQgdXAgYW4gb2JzZXJ2ZXIgdG8KICBr
        ZWVwIHRoZSBET00gdXAgdG8gZGF0ZSB3aGVuIHRoZSB1bmRlcmx5aW5nIHBy
        b3BlcnR5IGNoYW5nZXMuCgogIEBtZXRob2QgbXVzdGFjaGUKICBAZm9yIEVt
        YmVyLkhhbmRsZWJhcnMuQ29tcGlsZXIKICBAcGFyYW0gbXVzdGFjaGUKKi8K
        RW1iZXIuSGFuZGxlYmFycy5Db21waWxlci5wcm90b3R5cGUubXVzdGFjaGUg
        PSBmdW5jdGlvbihtdXN0YWNoZSkgewogIGlmIChtdXN0YWNoZS5pc0hlbHBl
        ciAmJiBtdXN0YWNoZS5pZC5zdHJpbmcgPT09ICdjb250cm9sJykgewogICAg
        bXVzdGFjaGUuaGFzaCA9IG11c3RhY2hlLmhhc2ggfHwgbmV3IEhhbmRsZWJh
        cnMuQVNULkhhc2hOb2RlKFtdKTsKICAgIG11c3RhY2hlLmhhc2gucGFpcnMu
        cHVzaChbImNvbnRyb2xJRCIsIG5ldyBIYW5kbGViYXJzLkFTVC5TdHJpbmdO
        b2RlKHByZWZpeCArIGluY3IrKyldKTsKICB9IGVsc2UgaWYgKG11c3RhY2hl
        LnBhcmFtcy5sZW5ndGggfHwgbXVzdGFjaGUuaGFzaCkgewogICAgLy8gbm8g
        Y2hhbmdlcyByZXF1aXJlZAogIH0gZWxzZSB7CiAgICB2YXIgaWQgPSBuZXcg
        SGFuZGxlYmFycy5BU1QuSWROb2RlKFt7IHBhcnQ6ICdfdHJpYWdlTXVzdGFj
        aGUnIH1dKTsKCiAgICAvLyBVcGRhdGUgdGhlIG11c3RhY2hlIG5vZGUgdG8g
        aW5jbHVkZSBhIGhhc2ggdmFsdWUgaW5kaWNhdGluZyB3aGV0aGVyIHRoZSBv
        cmlnaW5hbCBub2RlCiAgICAvLyB3YXMgZXNjYXBlZC4gVGhpcyB3aWxsIGFs
        bG93IHVzIHRvIHByb3Blcmx5IGVzY2FwZSB2YWx1ZXMgd2hlbiB0aGUgdW5k
        ZXJseWluZyB2YWx1ZQogICAgLy8gY2hhbmdlcyBhbmQgd2UgbmVlZCB0byBy
        ZS1yZW5kZXIgdGhlIHZhbHVlLgogICAgaWYgKCFtdXN0YWNoZS5lc2NhcGVk
        KSB7CiAgICAgIG11c3RhY2hlLmhhc2ggPSBtdXN0YWNoZS5oYXNoIHx8IG5l
        dyBIYW5kbGViYXJzLkFTVC5IYXNoTm9kZShbXSk7CiAgICAgIG11c3RhY2hl
        Lmhhc2gucGFpcnMucHVzaChbInVuZXNjYXBlZCIsIG5ldyBIYW5kbGViYXJz
        LkFTVC5TdHJpbmdOb2RlKCJ0cnVlIildKTsKICAgIH0KICAgIG11c3RhY2hl
        ID0gbmV3IEhhbmRsZWJhcnMuQVNULk11c3RhY2hlTm9kZShbaWRdLmNvbmNh
        dChbbXVzdGFjaGUuaWRdKSwgbXVzdGFjaGUuaGFzaCwgIW11c3RhY2hlLmVz
        Y2FwZWQpOwogIH0KCiAgcmV0dXJuIEhhbmRsZWJhcnMuQ29tcGlsZXIucHJv
        dG90eXBlLm11c3RhY2hlLmNhbGwodGhpcywgbXVzdGFjaGUpOwp9OwoKLyoq
        CiAgVXNlZCBmb3IgcHJlY29tcGlsYXRpb24gb2YgRW1iZXIgSGFuZGxlYmFy
        cyB0ZW1wbGF0ZXMuIFRoaXMgd2lsbCBub3QgYmUgdXNlZAogIGR1cmluZyBu
        b3JtYWwgYXBwIGV4ZWN1dGlvbi4KCiAgQG1ldGhvZCBwcmVjb21waWxlCiAg
        QGZvciBFbWJlci5IYW5kbGViYXJzCiAgQHN0YXRpYwogIEBwYXJhbSB7U3Ry
        aW5nfSBzdHJpbmcgVGhlIHRlbXBsYXRlIHRvIHByZWNvbXBpbGUKKi8KRW1i
        ZXIuSGFuZGxlYmFycy5wcmVjb21waWxlID0gZnVuY3Rpb24oc3RyaW5nKSB7
        CiAgdmFyIGFzdCA9IEhhbmRsZWJhcnMucGFyc2Uoc3RyaW5nKTsKCiAgdmFy
        IG9wdGlvbnMgPSB7CiAgICBrbm93bkhlbHBlcnM6IHsKICAgICAgYWN0aW9u
        OiB0cnVlLAogICAgICB1bmJvdW5kOiB0cnVlLAogICAgICBiaW5kQXR0cjog
        dHJ1ZSwKICAgICAgdGVtcGxhdGU6IHRydWUsCiAgICAgIHZpZXc6IHRydWUs
        CiAgICAgIF90cmlhZ2VNdXN0YWNoZTogdHJ1ZQogICAgfSwKICAgIGRhdGE6
        IHRydWUsCiAgICBzdHJpbmdQYXJhbXM6IHRydWUKICB9OwoKICB2YXIgZW52
        aXJvbm1lbnQgPSBuZXcgRW1iZXIuSGFuZGxlYmFycy5Db21waWxlcigpLmNv
        bXBpbGUoYXN0LCBvcHRpb25zKTsKICByZXR1cm4gbmV3IEVtYmVyLkhhbmRs
        ZWJhcnMuSmF2YVNjcmlwdENvbXBpbGVyKCkuY29tcGlsZShlbnZpcm9ubWVu
        dCwgb3B0aW9ucywgdW5kZWZpbmVkLCB0cnVlKTsKfTsKCi8vIFdlIGRvbid0
        IHN1cHBvcnQgdGhpcyBmb3IgSGFuZGxlYmFycyBydW50aW1lLW9ubHkKaWYg
        KEhhbmRsZWJhcnMuY29tcGlsZSkgewogIC8qKgogICAgVGhlIGVudHJ5IHBv
        aW50IGZvciBFbWJlciBIYW5kbGViYXJzLiBUaGlzIHJlcGxhY2VzIHRoZSBk
        ZWZhdWx0CiAgICBgSGFuZGxlYmFycy5jb21waWxlYCBhbmQgdHVybnMgb24g
        dGVtcGxhdGUtbG9jYWwgZGF0YSBhbmQgU3RyaW5nCiAgICBwYXJhbWV0ZXJz
        LgoKICAgIEBtZXRob2QgY29tcGlsZQogICAgQGZvciBFbWJlci5IYW5kbGVi
        YXJzCiAgICBAc3RhdGljCiAgICBAcGFyYW0ge1N0cmluZ30gc3RyaW5nIFRo
        ZSB0ZW1wbGF0ZSB0byBjb21waWxlCiAgICBAcmV0dXJuIHtGdW5jdGlvbn0K
        ICAqLwogIEVtYmVyLkhhbmRsZWJhcnMuY29tcGlsZSA9IGZ1bmN0aW9uKHN0
        cmluZykgewogICAgdmFyIGFzdCA9IEhhbmRsZWJhcnMucGFyc2Uoc3RyaW5n
        KTsKICAgIHZhciBvcHRpb25zID0geyBkYXRhOiB0cnVlLCBzdHJpbmdQYXJh
        bXM6IHRydWUgfTsKICAgIHZhciBlbnZpcm9ubWVudCA9IG5ldyBFbWJlci5I
        YW5kbGViYXJzLkNvbXBpbGVyKCkuY29tcGlsZShhc3QsIG9wdGlvbnMpOwog
        ICAgdmFyIHRlbXBsYXRlU3BlYyA9IG5ldyBFbWJlci5IYW5kbGViYXJzLkph
        dmFTY3JpcHRDb21waWxlcigpLmNvbXBpbGUoZW52aXJvbm1lbnQsIG9wdGlv
        bnMsIHVuZGVmaW5lZCwgdHJ1ZSk7CgogICAgdmFyIHRlbXBsYXRlID0gRW1i
        ZXIuSGFuZGxlYmFycy50ZW1wbGF0ZSh0ZW1wbGF0ZVNwZWMpOwogICAgdGVt
        cGxhdGUuaXNNZXRob2QgPSBmYWxzZTsgLy9NYWtlIHN1cmUgd2UgZG9uJ3Qg
        d3JhcCB0ZW1wbGF0ZXMgd2l0aCAuX3N1cGVyCgogICAgcmV0dXJuIHRlbXBs
        YXRlOwogIH07Cn0KCgp9KSgpOwoKKGZ1bmN0aW9uKCkgewp2YXIgc2xpY2Ug
        PSBBcnJheS5wcm90b3R5cGUuc2xpY2U7CgovKioKICBAcHJpdmF0ZQoKICBJ
        ZiBhIHBhdGggc3RhcnRzIHdpdGggYSByZXNlcnZlZCBrZXl3b3JkLCByZXR1
        cm5zIHRoZSByb290CiAgdGhhdCBzaG91bGQgYmUgdXNlZC4KCiAgQG1ldGhv
        ZCBub3JtYWxpemVQYXRoCiAgQGZvciBFbWJlcgogIEBwYXJhbSByb290IHtP
        YmplY3R9CiAgQHBhcmFtIHBhdGgge1N0cmluZ30KICBAcGFyYW0gZGF0YSB7
        SGFzaH0KKi8KdmFyIG5vcm1hbGl6ZVBhdGggPSBFbWJlci5IYW5kbGViYXJz
        Lm5vcm1hbGl6ZVBhdGggPSBmdW5jdGlvbihyb290LCBwYXRoLCBkYXRhKSB7
        CiAgdmFyIGtleXdvcmRzID0gKGRhdGEgJiYgZGF0YS5rZXl3b3JkcykgfHwg
        e30sCiAgICAgIGtleXdvcmQsIGlzS2V5d29yZDsKCiAgLy8gR2V0IHRoZSBm
        aXJzdCBzZWdtZW50IG9mIHRoZSBwYXRoLiBGb3IgZXhhbXBsZSwgaWYgdGhl
        CiAgLy8gcGF0aCBpcyAiZm9vLmJhci5iYXoiLCByZXR1cm5zICJmb28iLgog
        IGtleXdvcmQgPSBwYXRoLnNwbGl0KCcuJywgMSlbMF07CgogIC8vIFRlc3Qg
        dG8gc2VlIGlmIHRoZSBmaXJzdCBwYXRoIGlzIGEga2V5d29yZCB0aGF0IGhh
        cyBiZWVuCiAgLy8gcGFzc2VkIGFsb25nIGluIHRoZSB2aWV3J3MgZGF0YSBo
        YXNoLiBJZiBzbywgd2Ugd2lsbCB0cmVhdAogIC8vIHRoYXQgb2JqZWN0IGFz
        IHRoZSBuZXcgcm9vdC4KICBpZiAoa2V5d29yZHMuaGFzT3duUHJvcGVydHko
        a2V5d29yZCkpIHsKICAgIC8vIExvb2sgdXAgdGhlIHZhbHVlIGluIHRoZSB0
        ZW1wbGF0ZSdzIGRhdGEgaGFzaC4KICAgIHJvb3QgPSBrZXl3b3Jkc1trZXl3
        b3JkXTsKICAgIGlzS2V5d29yZCA9IHRydWU7CgogICAgLy8gSGFuZGxlIGNh
        c2VzIHdoZXJlIHRoZSBlbnRpcmUgcGF0aCBpcyB0aGUgcmVzZXJ2ZWQKICAg
        IC8vIHdvcmQuIEluIHRoYXQgY2FzZSwgcmV0dXJuIHRoZSBvYmplY3QgaXRz
        ZWxmLgogICAgaWYgKHBhdGggPT09IGtleXdvcmQpIHsKICAgICAgcGF0aCA9
        ICcnOwogICAgfSBlbHNlIHsKICAgICAgLy8gU3RyaXAgdGhlIGtleXdvcmQg
        ZnJvbSB0aGUgcGF0aCBhbmQgbG9vayB1cAogICAgICAvLyB0aGUgcmVtYWlu
        ZGVyIGZyb20gdGhlIG5ld2x5IGZvdW5kIHJvb3QuCiAgICAgIHBhdGggPSBw
        YXRoLnN1YnN0cihrZXl3b3JkLmxlbmd0aCsxKTsKICAgIH0KICB9CgogIHJl
        dHVybiB7IHJvb3Q6IHJvb3QsIHBhdGg6IHBhdGgsIGlzS2V5d29yZDogaXNL
        ZXl3b3JkIH07Cn07CgoKLyoqCiAgTG9va3VwIGJvdGggb24gcm9vdCBhbmQg
        b24gd2luZG93LiBJZiB0aGUgcGF0aCBzdGFydHMgd2l0aAogIGEga2V5d29y
        ZCwgdGhlIGNvcnJlc3BvbmRpbmcgb2JqZWN0IHdpbGwgYmUgbG9va2VkIHVw
        IGluIHRoZQogIHRlbXBsYXRlJ3MgZGF0YSBoYXNoIGFuZCB1c2VkIHRvIHJl
        c29sdmUgdGhlIHBhdGguCgogIEBtZXRob2QgZ2V0CiAgQGZvciBFbWJlci5I
        YW5kbGViYXJzCiAgQHBhcmFtIHtPYmplY3R9IHJvb3QgVGhlIG9iamVjdCB0
        byBsb29rIHVwIHRoZSBwcm9wZXJ0eSBvbgogIEBwYXJhbSB7U3RyaW5nfSBw
        YXRoIFRoZSBwYXRoIHRvIGJlIGxvb2tlZHVwCiAgQHBhcmFtIHtPYmplY3R9
        IG9wdGlvbnMgVGhlIHRlbXBsYXRlJ3Mgb3B0aW9uIGhhc2gKKi8KdmFyIGhh
        bmRsZWJhcnNHZXQgPSBFbWJlci5IYW5kbGViYXJzLmdldCA9IGZ1bmN0aW9u
        KHJvb3QsIHBhdGgsIG9wdGlvbnMpIHsKICB2YXIgZGF0YSA9IG9wdGlvbnMg
        JiYgb3B0aW9ucy5kYXRhLAogICAgICBub3JtYWxpemVkUGF0aCA9IG5vcm1h
        bGl6ZVBhdGgocm9vdCwgcGF0aCwgZGF0YSksCiAgICAgIHZhbHVlOwoKICAv
        LyBJbiBjYXNlcyB3aGVyZSB0aGUgcGF0aCBiZWdpbnMgd2l0aCBhIGtleXdv
        cmQsIGNoYW5nZSB0aGUKICAvLyByb290IHRvIHRoZSB2YWx1ZSByZXByZXNl
        bnRlZCBieSB0aGF0IGtleXdvcmQsIGFuZCBlbnN1cmUKICAvLyB0aGUgcGF0
        aCBpcyByZWxhdGl2ZSB0byBpdC4KICByb290ID0gbm9ybWFsaXplZFBhdGgu
        cm9vdDsKICBwYXRoID0gbm9ybWFsaXplZFBhdGgucGF0aDsKCiAgdmFsdWUg
        PSBFbWJlci5nZXQocm9vdCwgcGF0aCk7CgogIC8vIElmIHRoZSBwYXRoIHN0
        YXJ0cyB3aXRoIGEgY2FwaXRhbCBsZXR0ZXIsIGxvb2sgaXQgdXAgb24gRW1i
        ZXIubG9va3VwLAogIC8vIHdoaWNoIGRlZmF1bHRzIHRvIHRoZSBgd2luZG93
        YCBvYmplY3QgaW4gYnJvd3NlcnMuCiAgaWYgKHZhbHVlID09PSB1bmRlZmlu
        ZWQgJiYgcm9vdCAhPT0gRW1iZXIubG9va3VwICYmIEVtYmVyLmlzR2xvYmFs
        UGF0aChwYXRoKSkgewogICAgdmFsdWUgPSBFbWJlci5nZXQoRW1iZXIubG9v
        a3VwLCBwYXRoKTsKICB9CiAgcmV0dXJuIHZhbHVlOwp9OwpFbWJlci5IYW5k
        bGViYXJzLmdldFBhdGggPSBFbWJlci5kZXByZWNhdGVGdW5jKCdgRW1iZXIu
        SGFuZGxlYmFycy5nZXRQYXRoYCBoYXMgYmVlbiBjaGFuZ2VkIHRvIGBFbWJl
        ci5IYW5kbGViYXJzLmdldGAgZm9yIGNvbnNpc3RlbmN5LicsIEVtYmVyLkhh
        bmRsZWJhcnMuZ2V0KTsKCkVtYmVyLkhhbmRsZWJhcnMucmVzb2x2ZVBhcmFt
        cyA9IGZ1bmN0aW9uKGNvbnRleHQsIHBhcmFtcywgb3B0aW9ucykgewogIHZh
        ciByZXNvbHZlZFBhcmFtcyA9IFtdLCB0eXBlcyA9IG9wdGlvbnMudHlwZXMs
        IHBhcmFtLCB0eXBlOwoKICBmb3IgKHZhciBpPTAsIGw9cGFyYW1zLmxlbmd0
        aDsgaTxsOyBpKyspIHsKICAgIHBhcmFtID0gcGFyYW1zW2ldOwogICAgdHlw
        ZSA9IHR5cGVzW2ldOwoKICAgIGlmICh0eXBlID09PSAnSUQnKSB7CiAgICAg
        IHJlc29sdmVkUGFyYW1zLnB1c2goaGFuZGxlYmFyc0dldChjb250ZXh0LCBw
        YXJhbSwgb3B0aW9ucykpOwogICAgfSBlbHNlIHsKICAgICAgcmVzb2x2ZWRQ
        YXJhbXMucHVzaChwYXJhbSk7CiAgICB9CiAgfQoKICByZXR1cm4gcmVzb2x2
        ZWRQYXJhbXM7Cn07CgpFbWJlci5IYW5kbGViYXJzLnJlc29sdmVIYXNoID0g
        ZnVuY3Rpb24oY29udGV4dCwgaGFzaCwgb3B0aW9ucykgewogIHZhciByZXNv
        bHZlZEhhc2ggPSB7fSwgdHlwZXMgPSBvcHRpb25zLmhhc2hUeXBlcywgdHlw
        ZTsKCiAgZm9yICh2YXIga2V5IGluIGhhc2gpIHsKICAgIGlmICghaGFzaC5o
        YXNPd25Qcm9wZXJ0eShrZXkpKSB7IGNvbnRpbnVlOyB9CgogICAgdHlwZSA9
        IHR5cGVzW2tleV07CgogICAgaWYgKHR5cGUgPT09ICdJRCcpIHsKICAgICAg
        cmVzb2x2ZWRIYXNoW2tleV0gPSBoYW5kbGViYXJzR2V0KGNvbnRleHQsIGhh
        c2hba2V5XSwgb3B0aW9ucyk7CiAgICB9IGVsc2UgewogICAgICByZXNvbHZl
        ZEhhc2hba2V5XSA9IGhhc2hba2V5XTsKICAgIH0KICB9CgogIHJldHVybiBy
        ZXNvbHZlZEhhc2g7Cn07CgovKioKICBAcHJpdmF0ZQoKICBSZWdpc3RlcnMg
        YSBoZWxwZXIgaW4gSGFuZGxlYmFycyB0aGF0IHdpbGwgYmUgY2FsbGVkIGlm
        IG5vIHByb3BlcnR5IHdpdGggdGhlCiAgZ2l2ZW4gbmFtZSBjYW4gYmUgZm91
        bmQgb24gdGhlIGN1cnJlbnQgY29udGV4dCBvYmplY3QsIGFuZCBubyBoZWxw
        ZXIgd2l0aAogIHRoYXQgbmFtZSBpcyByZWdpc3RlcmVkLgoKICBUaGlzIHRo
        cm93cyBhbiBleGNlcHRpb24gd2l0aCBhIG1vcmUgaGVscGZ1bCBlcnJvciBt
        ZXNzYWdlIHNvIHRoZSB1c2VyIGNhbgogIHRyYWNrIGRvd24gd2hlcmUgdGhl
        IHByb2JsZW0gaXMgaGFwcGVuaW5nLgoKICBAbWV0aG9kIGhlbHBlck1pc3Np
        bmcKICBAZm9yIEVtYmVyLkhhbmRsZWJhcnMuaGVscGVycwogIEBwYXJhbSB7
        U3RyaW5nfSBwYXRoCiAgQHBhcmFtIHtIYXNofSBvcHRpb25zCiovCkVtYmVy
        LkhhbmRsZWJhcnMucmVnaXN0ZXJIZWxwZXIoJ2hlbHBlck1pc3NpbmcnLCBm
        dW5jdGlvbihwYXRoLCBvcHRpb25zKSB7CiAgdmFyIGVycm9yLCB2aWV3ID0g
        IiI7CgogIGVycm9yID0gIiVAIEhhbmRsZWJhcnMgZXJyb3I6IENvdWxkIG5v
        dCBmaW5kIHByb3BlcnR5ICclQCcgb24gb2JqZWN0ICVALiI7CiAgaWYgKG9w
        dGlvbnMuZGF0YSkgewogICAgdmlldyA9IG9wdGlvbnMuZGF0YS52aWV3Owog
        IH0KICB0aHJvdyBuZXcgRW1iZXIuRXJyb3IoRW1iZXIuU3RyaW5nLmZtdChl
        cnJvciwgW3ZpZXcsIHBhdGgsIHRoaXNdKSk7Cn0pOwoKLyoqCiAgUmVnaXN0
        ZXIgYSBib3VuZCBoYW5kbGViYXJzIGhlbHBlci4gQm91bmQgaGVscGVycyBi
        ZWhhdmUgc2ltaWxhcmx5IHRvIHJlZ3VsYXIKICBoYW5kbGViYXJzIGhlbHBl
        cnMsIHdpdGggdGhlIGFkZGVkIGFiaWxpdHkgdG8gcmUtcmVuZGVyIHdoZW4g
        dGhlIHVuZGVybHlpbmcgZGF0YQogIGNoYW5nZXMuCgogICMjIFNpbXBsZSBl
        eGFtcGxlCgogIGBgYGphdmFzY3JpcHQKICBFbWJlci5IYW5kbGViYXJzLnJl
        Z2lzdGVyQm91bmRIZWxwZXIoJ2NhcGl0YWxpemUnLCBmdW5jdGlvbih2YWx1
        ZSkgewogICAgcmV0dXJuIHZhbHVlLnRvVXBwZXJDYXNlKCk7CiAgfSk7CiAg
        YGBgCgogIFRoZSBhYm92ZSBib3VuZCBoZWxwZXIgY2FuIGJlIHVzZWQgaW5z
        aWRlIG9mIHRlbXBsYXRlcyBhcyBmb2xsb3dzOgoKICBgYGBoYW5kbGViYXJz
        CiAge3tjYXBpdGFsaXplIG5hbWV9fQogIGBgYAoKICBJbiB0aGlzIGNhc2Us
        IHdoZW4gdGhlIGBuYW1lYCBwcm9wZXJ0eSBvZiB0aGUgdGVtcGxhdGUncyBj
        b250ZXh0IGNoYW5nZXMsCiAgdGhlIHJlbmRlcmVkIHZhbHVlIG9mIHRoZSBo
        ZWxwZXIgd2lsbCB1cGRhdGUgdG8gcmVmbGVjdCB0aGlzIGNoYW5nZS4KCiAg
        IyMgRXhhbXBsZSB3aXRoIG9wdGlvbnMKCiAgTGlrZSBub3JtYWwgaGFuZGxl
        YmFycyBoZWxwZXJzLCBib3VuZCBoZWxwZXJzIGhhdmUgYWNjZXNzIHRvIHRo
        ZSBvcHRpb25zCiAgcGFzc2VkIGludG8gdGhlIGhlbHBlciBjYWxsLgoKICBg
        YGBqYXZhc2NyaXB0CiAgRW1iZXIuSGFuZGxlYmFycy5yZWdpc3RlckJvdW5k
        SGVscGVyKCdyZXBlYXQnLCBmdW5jdGlvbih2YWx1ZSwgb3B0aW9ucykgewog
        ICAgdmFyIGNvdW50ID0gb3B0aW9ucy5oYXNoLmNvdW50OwogICAgdmFyIGEg
        PSBbXTsKICAgIHdoaWxlKGEubGVuZ3RoIDwgY291bnQpIHsKICAgICAgICBh
        LnB1c2godmFsdWUpOwogICAgfQogICAgcmV0dXJuIGEuam9pbignJyk7CiAg
        fSk7CiAgYGBgCgogIFRoaXMgaGVscGVyIGNvdWxkIGJlIHVzZWQgaW4gYSB0
        ZW1wbGF0ZSBhcyBmb2xsb3dzOgoKICBgYGBoYW5kbGViYXJzCiAge3tyZXBl
        YXQgdGV4dCBjb3VudD0zfX0KICBgYGAKCiAgIyMgRXhhbXBsZSB3aXRoIGJv
        dW5kIG9wdGlvbnMKCiAgQm91bmQgaGFzaCBvcHRpb25zIGFyZSBhbHNvIHN1
        cHBvcnRlZC4gRXhhbXBsZToKCiAgYGBgaGFuZGxlYmFycwogIHt7cmVwZWF0
        IHRleHQgY291bnRCaW5kaW5nPSJudW1SZXBlYXRzIn19CiAgYGBgCgogIElu
        IHRoaXMgZXhhbXBsZSwgY291bnQgd2lsbCBiZSBib3VuZCB0byB0aGUgdmFs
        dWUgb2YKICB0aGUgYG51bVJlcGVhdHNgIHByb3BlcnR5IG9uIHRoZSBjb250
        ZXh0LiBJZiB0aGF0IHByb3BlcnR5CiAgY2hhbmdlcywgdGhlIGhlbHBlciB3
        aWxsIGJlIHJlLXJlbmRlcmVkLgoKICAjIyBFeGFtcGxlIHdpdGggZXh0cmEg
        ZGVwZW5kZW5jaWVzCgogIFRoZSBgRW1iZXIuSGFuZGxlYmFycy5yZWdpc3Rl
        ckJvdW5kSGVscGVyYCBtZXRob2QgdGFrZXMgYSB2YXJpYWJsZSBsZW5ndGgK
        ICB0aGlyZCBwYXJhbWV0ZXIgd2hpY2ggaW5kaWNhdGVzIGV4dHJhIGRlcGVu
        ZGVuY2llcyBvbiB0aGUgcGFzc2VkIGluIHZhbHVlLgogIFRoaXMgYWxsb3dz
        IHRoZSBoYW5kbGViYXJzIGhlbHBlciB0byB1cGRhdGUgd2hlbiB0aGVzZSBk
        ZXBlbmRlbmNpZXMgY2hhbmdlLgoKICBgYGBqYXZhc2NyaXB0CiAgRW1iZXIu
        SGFuZGxlYmFycy5yZWdpc3RlckJvdW5kSGVscGVyKCdjYXBpdGFsaXplTmFt
        ZScsIGZ1bmN0aW9uKHZhbHVlKSB7CiAgICByZXR1cm4gdmFsdWUuZ2V0KCdu
        YW1lJykudG9VcHBlckNhc2UoKTsKICB9LCAnbmFtZScpOwogIGBgYAoKICAj
        IyBFeGFtcGxlIHdpdGggbXVsdGlwbGUgYm91bmQgcHJvcGVydGllcwoKICBg
        RW1iZXIuSGFuZGxlYmFycy5yZWdpc3RlckJvdW5kSGVscGVyYCBzdXBwb3J0
        cyBiaW5kaW5nIHRvCiAgbXVsdGlwbGUgcHJvcGVydGllcywgZS5nLjoKCiAg
        YGBgamF2YXNjcmlwdAogIEVtYmVyLkhhbmRsZWJhcnMucmVnaXN0ZXJCb3Vu
        ZEhlbHBlcignY29uY2F0ZW5hdGUnLCBmdW5jdGlvbigpIHsKICAgIHZhciB2
        YWx1ZXMgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMs
        IDAsIC0xKTsKICAgIHJldHVybiB2YWx1ZXMuam9pbignfHwnKTsKICB9KTsK
        ICBgYGAKCiAgV2hpY2ggYWxsb3dzIGZvciB0ZW1wbGF0ZSBzeW50YXggc3Vj
        aCBhcyBge3tjb25jYXRlbmF0ZSBwcm9wMSBwcm9wMn19YCBvcgogIGB7e2Nv
        bmNhdGVuYXRlIHByb3AxIHByb3AyIHByb3AzfX1gLiBJZiBhbnkgb2YgdGhl
        IHByb3BlcnRpZXMgY2hhbmdlLAogIHRoZSBoZWxwciB3aWxsIHJlLXJlbmRl
        ci4gIE5vdGUgdGhhdCBkZXBlbmRlbmN5IGtleXMgY2Fubm90IGJlCiAgdXNp
        bmcgaW4gY29uanVuY3Rpb24gd2l0aCBtdWx0aS1wcm9wZXJ0eSBoZWxwZXJz
        LCBzaW5jZSBpdCBpcyBhbWJpZ3VvdXMKICB3aGljaCBwcm9wZXJ0eSB0aGUg
        ZGVwZW5kZW50IGtleXMgd291bGQgYmVsb25nIHRvLgoKICAjIyBVc2Ugd2l0
        aCB1bmJvdW5kIGhlbHBlcgoKICBUaGUgYHt7dW5ib3VuZH19YCBoZWxwZXIg
        Y2FuIGJlIHVzZWQgd2l0aCBib3VuZCBoZWxwZXIgaW52b2NhdGlvbnMKICB0
        byByZW5kZXIgdGhlbSBpbiB0aGVpciB1bmJvdW5kIGZvcm0sIGUuZy4KCiAg
        YGBgaGFuZGxlYmFycwogIHt7dW5ib3VuZCBjYXBpdGFsaXplIG5hbWV9fQog
        IGBgYAoKICBJbiB0aGlzIGV4YW1wbGUsIGlmIHRoZSBuYW1lIHByb3BlcnR5
        IGNoYW5nZXMsIHRoZSBoZWxwZXIKICB3aWxsIG5vdCByZS1yZW5kZXIuCgog
        ICMjIFVzZSB3aXRoIGJsb2NrcyBub3Qgc3VwcG9ydGVkCgogIEJvdW5kIGhl
        bHBlcnMgZG8gbm90IHN1cHBvcnQgdXNlIHdpdGggSGFuZGxlYmFycyBibG9j
        a3Mgb3IKICB0aGUgYWRkaXRpb24gb2YgY2hpbGQgdmlld3Mgb2YgYW55IGtp
        bmQuCgogIEBtZXRob2QgcmVnaXN0ZXJCb3VuZEhlbHBlcgogIEBmb3IgRW1i
        ZXIuSGFuZGxlYmFycwogIEBwYXJhbSB7U3RyaW5nfSBuYW1lCiAgQHBhcmFt
        IHtGdW5jdGlvbn0gZnVuY3Rpb24KICBAcGFyYW0ge1N0cmluZ30gZGVwZW5k
        ZW50S2V5cyoKKi8KRW1iZXIuSGFuZGxlYmFycy5yZWdpc3RlckJvdW5kSGVs
        cGVyID0gZnVuY3Rpb24obmFtZSwgZm4pIHsKICB2YXIgZGVwZW5kZW50S2V5
        cyA9IHNsaWNlLmNhbGwoYXJndW1lbnRzLCAyKTsKCiAgZnVuY3Rpb24gaGVs
        cGVyKCkgewogICAgdmFyIHByb3BlcnRpZXMgPSBzbGljZS5jYWxsKGFyZ3Vt
        ZW50cywgMCwgLTEpLAogICAgICBudW1Qcm9wZXJ0aWVzID0gcHJvcGVydGll
        cy5sZW5ndGgsCiAgICAgIG9wdGlvbnMgPSBhcmd1bWVudHNbYXJndW1lbnRz
        Lmxlbmd0aCAtIDFdLAogICAgICBub3JtYWxpemVkUHJvcGVydGllcyA9IFtd
        LAogICAgICB0eXBlcyA9IG9wdGlvbnMudHlwZXMsCiAgICAgIGRhdGEgPSBv
        cHRpb25zLmRhdGEsCiAgICAgIGhhc2ggPSBvcHRpb25zLmhhc2gsCiAgICAg
        IHZpZXcgPSBkYXRhLnZpZXcsCiAgICAgIGNvbnRleHRzID0gb3B0aW9ucy5j
        b250ZXh0cywKICAgICAgY3VycmVudENvbnRleHQgPSAoY29udGV4dHMgJiYg
        Y29udGV4dHMubGVuZ3RoKSA/IGNvbnRleHRzWzBdIDogdGhpcywKICAgICAg
        cHJlZml4UGF0aEZvckRlcGVuZGVudEtleXMgPSAnJywKICAgICAgbG9jLCBs
        ZW4sIGhhc2hPcHRpb24sCiAgICAgIGJvdW5kT3B0aW9uLCBwcm9wZXJ0eSwK
        ICAgICAgbm9ybWFsaXplZFZhbHVlID0gRW1iZXIuX1NpbXBsZUhhbmRsZWJh
        cnNWaWV3LnByb3RvdHlwZS5ub3JtYWxpemVkVmFsdWU7CgogICAgRW1iZXIu
        YXNzZXJ0KCJyZWdpc3RlckJvdW5kSGVscGVyLWdlbmVyYXRlZCBoZWxwZXJz
        IGRvIG5vdCBzdXBwb3J0IHVzZSB3aXRoIEhhbmRsZWJhcnMgYmxvY2tzLiIs
        ICFvcHRpb25zLmZuKTsKCiAgICAvLyBEZXRlY3QgYm91bmQgb3B0aW9ucyAo
        ZS5nLiBjb3VudEJpbmRpbmc9Im90aGVyQ291bnQiKQogICAgdmFyIGJvdW5k
        T3B0aW9ucyA9IGhhc2guYm91bmRPcHRpb25zID0ge307CiAgICBmb3IgKGhh
        c2hPcHRpb24gaW4gaGFzaCkgewogICAgICBpZiAoRW1iZXIuSVNfQklORElO
        Ry50ZXN0KGhhc2hPcHRpb24pKSB7CiAgICAgICAgLy8gTG9wIG9mZiAnQmlu
        ZGluZycgc3VmZml4LgogICAgICAgIGJvdW5kT3B0aW9uc1toYXNoT3B0aW9u
        LnNsaWNlKDAsIC03KV0gPSBoYXNoW2hhc2hPcHRpb25dOwogICAgICB9CiAg
        ICB9CgogICAgLy8gRXhwb3NlIHByb3BlcnR5IG5hbWVzIG9uIGRhdGEucHJv
        cGVydGllcyBvYmplY3QuCiAgICB2YXIgd2F0Y2hlZFByb3BlcnRpZXMgPSBb
        XTsKICAgIGRhdGEucHJvcGVydGllcyA9IFtdOwogICAgZm9yIChsb2MgPSAw
        OyBsb2MgPCBudW1Qcm9wZXJ0aWVzOyArK2xvYykgewogICAgICBkYXRhLnBy
        b3BlcnRpZXMucHVzaChwcm9wZXJ0aWVzW2xvY10pOwogICAgICBpZiAodHlw
        ZXNbbG9jXSA9PT0gJ0lEJykgewogICAgICAgIHZhciBub3JtYWxpemVkUHJv
        cCA9IG5vcm1hbGl6ZVBhdGgoY3VycmVudENvbnRleHQsIHByb3BlcnRpZXNb
        bG9jXSwgZGF0YSk7CiAgICAgICAgbm9ybWFsaXplZFByb3BlcnRpZXMucHVz
        aChub3JtYWxpemVkUHJvcCk7CiAgICAgICAgd2F0Y2hlZFByb3BlcnRpZXMu
        cHVzaChub3JtYWxpemVkUHJvcCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAg
        bm9ybWFsaXplZFByb3BlcnRpZXMucHVzaChudWxsKTsKICAgICAgfQogICAg
        fQoKICAgIC8vIEhhbmRsZSBjYXNlIHdoZW4gaGVscGVyIGludm9jYXRpb24g
        aXMgcHJlY2VkZWQgYnkgYHVuYm91bmRgLCBlLmcuCiAgICAvLyB7e3VuYm91
        bmQgbXlIZWxwZXIgZm9vfX0KICAgIGlmIChkYXRhLmlzVW5ib3VuZCkgewog
        ICAgICByZXR1cm4gZXZhbHVhdGVVbmJvdW5kSGVscGVyKHRoaXMsIGZuLCBu
        b3JtYWxpemVkUHJvcGVydGllcywgb3B0aW9ucyk7CiAgICB9CgogICAgdmFy
        IGJpbmRWaWV3ID0gbmV3IEVtYmVyLl9TaW1wbGVIYW5kbGViYXJzVmlldyhu
        dWxsLCBudWxsLCAhb3B0aW9ucy5oYXNoLnVuZXNjYXBlZCwgb3B0aW9ucy5k
        YXRhKTsKCiAgICAvLyBPdmVycmlkZSBTaW1wbGVIYW5kbGViYXJzVmlldydz
        IG1ldGhvZCBmb3IgZ2VuZXJhdGluZyB0aGUgdmlldydzIGNvbnRlbnQuCiAg
        ICBiaW5kVmlldy5ub3JtYWxpemVkVmFsdWUgPSBmdW5jdGlvbigpIHsKICAg
        ICAgdmFyIGFyZ3MgPSBbXSwgYm91bmRPcHRpb247CgogICAgICAvLyBDb3B5
        IG92ZXIgYm91bmQgaGFzaCBvcHRpb25zLgogICAgICBmb3IgKGJvdW5kT3B0
        aW9uIGluIGJvdW5kT3B0aW9ucykgewogICAgICAgIGlmICghYm91bmRPcHRp
        b25zLmhhc093blByb3BlcnR5KGJvdW5kT3B0aW9uKSkgeyBjb250aW51ZTsg
        fQogICAgICAgIHByb3BlcnR5ID0gbm9ybWFsaXplUGF0aChjdXJyZW50Q29u
        dGV4dCwgYm91bmRPcHRpb25zW2JvdW5kT3B0aW9uXSwgZGF0YSk7CiAgICAg
        ICAgYmluZFZpZXcucGF0aCA9IHByb3BlcnR5LnBhdGg7CiAgICAgICAgYmlu
        ZFZpZXcucGF0aFJvb3QgPSBwcm9wZXJ0eS5yb290OwogICAgICAgIGhhc2hb
        Ym91bmRPcHRpb25dID0gbm9ybWFsaXplZFZhbHVlLmNhbGwoYmluZFZpZXcp
        OwogICAgICB9CgogICAgICBmb3IgKGxvYyA9IDA7IGxvYyA8IG51bVByb3Bl
        cnRpZXM7ICsrbG9jKSB7CiAgICAgICAgcHJvcGVydHkgPSBub3JtYWxpemVk
        UHJvcGVydGllc1tsb2NdOwogICAgICAgIGlmIChwcm9wZXJ0eSkgewogICAg
        ICAgICAgYmluZFZpZXcucGF0aCA9IHByb3BlcnR5LnBhdGg7CiAgICAgICAg
        ICBiaW5kVmlldy5wYXRoUm9vdCA9IHByb3BlcnR5LnJvb3Q7CiAgICAgICAg
        ICBhcmdzLnB1c2gobm9ybWFsaXplZFZhbHVlLmNhbGwoYmluZFZpZXcpKTsK
        ICAgICAgICB9IGVsc2UgewogICAgICAgICAgYXJncy5wdXNoKHByb3BlcnRp
        ZXNbbG9jXSk7CiAgICAgICAgfQogICAgICB9CiAgICAgIGFyZ3MucHVzaChv
        cHRpb25zKTsKCiAgICAgIC8vIFJ1biB0aGUgc3VwcGxpZWQgaGVscGVyIGZ1
        bmN0aW9uLgogICAgICByZXR1cm4gZm4uYXBwbHkoY3VycmVudENvbnRleHQs
        IGFyZ3MpOwogICAgfTsKCiAgICB2aWV3LmFwcGVuZENoaWxkKGJpbmRWaWV3
        KTsKCiAgICAvLyBBc3NlbWJsZSBsaXN0IG9mIHdhdGNoZWQgcHJvcGVydGll
        cyB0aGF0J2xsIHJlLXJlbmRlciB0aGlzIGhlbHBlci4KICAgIGZvciAoYm91
        bmRPcHRpb24gaW4gYm91bmRPcHRpb25zKSB7CiAgICAgIGlmIChib3VuZE9w
        dGlvbnMuaGFzT3duUHJvcGVydHkoYm91bmRPcHRpb24pKSB7CiAgICAgICAg
        d2F0Y2hlZFByb3BlcnRpZXMucHVzaChub3JtYWxpemVQYXRoKGN1cnJlbnRD
        b250ZXh0LCBib3VuZE9wdGlvbnNbYm91bmRPcHRpb25dLCBkYXRhKSk7CiAg
        ICAgIH0KICAgIH0KCiAgICAvLyBPYnNlcnZlIGVhY2ggcHJvcGVydHkuCiAg
        ICBmb3IgKGxvYyA9IDAsIGxlbiA9IHdhdGNoZWRQcm9wZXJ0aWVzLmxlbmd0
        aDsgbG9jIDwgbGVuOyArK2xvYykgewogICAgICBwcm9wZXJ0eSA9IHdhdGNo
        ZWRQcm9wZXJ0aWVzW2xvY107CiAgICAgIHZpZXcucmVnaXN0ZXJPYnNlcnZl
        cihwcm9wZXJ0eS5yb290LCBwcm9wZXJ0eS5wYXRoLCBiaW5kVmlldywgYmlu
        ZFZpZXcucmVyZW5kZXIpOwogICAgfQoKICAgIGlmICh0eXBlc1swXSAhPT0g
        J0lEJyB8fCBub3JtYWxpemVkUHJvcGVydGllcy5sZW5ndGggPT09IDApIHsK
        ICAgICAgcmV0dXJuOwogICAgfQoKICAgIC8vIEFkZCBkZXBlbmRlbnQga2V5
        IG9ic2VydmVycyB0byB0aGUgZmlyc3QgcGFyYW0KICAgIHZhciBub3JtYWxp
        emVkID0gbm9ybWFsaXplZFByb3BlcnRpZXNbMF0sCiAgICAgICAgcGF0aFJv
        b3QgPSBub3JtYWxpemVkLnJvb3QsCiAgICAgICAgcGF0aCA9IG5vcm1hbGl6
        ZWQucGF0aDsKCiAgICBpZighRW1iZXIuaXNFbXB0eShwYXRoKSkgewogICAg
        ICBwcmVmaXhQYXRoRm9yRGVwZW5kZW50S2V5cyA9IHBhdGggKyAnLic7CiAg
        ICB9CiAgICBmb3IgKHZhciBpPTAsIGw9ZGVwZW5kZW50S2V5cy5sZW5ndGg7
        IGk8bDsgaSsrKSB7CiAgICAgIHZpZXcucmVnaXN0ZXJPYnNlcnZlcihwYXRo
        Um9vdCwgcHJlZml4UGF0aEZvckRlcGVuZGVudEtleXMgKyBkZXBlbmRlbnRL
        ZXlzW2ldLCBiaW5kVmlldywgYmluZFZpZXcucmVyZW5kZXIpOwogICAgfQog
        IH0KCiAgaGVscGVyLl9yYXdGdW5jdGlvbiA9IGZuOwogIEVtYmVyLkhhbmRs
        ZWJhcnMucmVnaXN0ZXJIZWxwZXIobmFtZSwgaGVscGVyKTsKfTsKCi8qKgog
        IEBwcml2YXRlCgogIFJlbmRlcnMgdGhlIHVuYm91bmQgZm9ybSBvZiBhbiBv
        dGhlcndpc2UgYm91bmQgaGVscGVyIGZ1bmN0aW9uLgoKICBAbWV0aG9kIGV2
        YWx1YXRlVW5ib3VuZEhlbHBlcgogIEBwYXJhbSB7RnVuY3Rpb259IGZuCiAg
        QHBhcmFtIHtPYmplY3R9IGNvbnRleHQKICBAcGFyYW0ge0FycmF5fSBub3Jt
        YWxpemVkUHJvcGVydGllcwogIEBwYXJhbSB7U3RyaW5nfSBvcHRpb25zCiov
        CmZ1bmN0aW9uIGV2YWx1YXRlVW5ib3VuZEhlbHBlcihjb250ZXh0LCBmbiwg
        bm9ybWFsaXplZFByb3BlcnRpZXMsIG9wdGlvbnMpIHsKICB2YXIgYXJncyA9
        IFtdLCBoYXNoID0gb3B0aW9ucy5oYXNoLCBib3VuZE9wdGlvbnMgPSBoYXNo
        LmJvdW5kT3B0aW9ucywgbG9jLCBsZW4sIHByb3BlcnR5LCBib3VuZE9wdGlv
        bjsKCiAgZm9yIChib3VuZE9wdGlvbiBpbiBib3VuZE9wdGlvbnMpIHsKICAg
        IGlmICghYm91bmRPcHRpb25zLmhhc093blByb3BlcnR5KGJvdW5kT3B0aW9u
        KSkgeyBjb250aW51ZTsgfQogICAgaGFzaFtib3VuZE9wdGlvbl0gPSBFbWJl
        ci5IYW5kbGViYXJzLmdldChjb250ZXh0LCBib3VuZE9wdGlvbnNbYm91bmRP
        cHRpb25dLCBvcHRpb25zKTsKICB9CgogIGZvcihsb2MgPSAwLCBsZW4gPSBu
        b3JtYWxpemVkUHJvcGVydGllcy5sZW5ndGg7IGxvYyA8IGxlbjsgKytsb2Mp
        IHsKICAgIHByb3BlcnR5ID0gbm9ybWFsaXplZFByb3BlcnRpZXNbbG9jXTsK
        ICAgIGFyZ3MucHVzaChFbWJlci5IYW5kbGViYXJzLmdldChwcm9wZXJ0eS5y
        b290LCBwcm9wZXJ0eS5wYXRoLCBvcHRpb25zKSk7CiAgfQogIGFyZ3MucHVz
        aChvcHRpb25zKTsKICByZXR1cm4gZm4uYXBwbHkoY29udGV4dCwgYXJncyk7
        Cn0KCi8qKgogIEBwcml2YXRlCgogIE92ZXJyaWRlcyBIYW5kbGViYXJzLnRl
        bXBsYXRlIHNvIHRoYXQgd2UgY2FuIGRpc3Rpbmd1aXNoCiAgdXNlci1jcmVh
        dGVkLCB0b3AtbGV2ZWwgdGVtcGxhdGVzIGZyb20gaW5uZXIgY29udGV4dHMu
        CgogIEBtZXRob2QgdGVtcGxhdGUKICBAZm9yIEVtYmVyLkhhbmRsZWJhcnMK
        ICBAcGFyYW0ge1N0cmluZ30gdGVtcGxhdGUgc3BlYwoqLwpFbWJlci5IYW5k
        bGViYXJzLnRlbXBsYXRlID0gZnVuY3Rpb24oc3BlYykgewogIHZhciB0ID0g
        SGFuZGxlYmFycy50ZW1wbGF0ZShzcGVjKTsKICB0LmlzVG9wID0gdHJ1ZTsK
        ICByZXR1cm4gdDsKfTsKCn0pKCk7CgoKCihmdW5jdGlvbigpIHsKLyoqCiAg
        TWFyayBhIHN0cmluZyBhcyBzYWZlIGZvciB1bmVzY2FwZWQgb3V0cHV0IHdp
        dGggSGFuZGxlYmFycy4gSWYgeW91CiAgcmV0dXJuIEhUTUwgZnJvbSBhIEhh
        bmRsZWJhcnMgaGVscGVyLCB1c2UgdGhpcyBmdW5jdGlvbiB0bwogIGVuc3Vy
        ZSBIYW5kbGViYXJzIGRvZXMgbm90IGVzY2FwZSB0aGUgSFRNTC4KCiAgYGBg
        amF2YXNjcmlwdAogIEVtYmVyLlN0cmluZy5odG1sU2FmZSgnPGRpdj5zb21l
        U3RyaW5nPC9kaXY+JykKICBgYGAKCiAgQG1ldGhvZCBodG1sU2FmZQogIEBm
        b3IgRW1iZXIuU3RyaW5nCiAgQHN0YXRpYwogIEByZXR1cm4ge0hhbmRsZWJh
        cnMuU2FmZVN0cmluZ30gYSBzdHJpbmcgdGhhdCB3aWxsIG5vdCBiZSBodG1s
        IGVzY2FwZWQgYnkgSGFuZGxlYmFycwoqLwpFbWJlci5TdHJpbmcuaHRtbFNh
        ZmUgPSBmdW5jdGlvbihzdHIpIHsKICByZXR1cm4gbmV3IEhhbmRsZWJhcnMu
        U2FmZVN0cmluZyhzdHIpOwp9OwoKdmFyIGh0bWxTYWZlID0gRW1iZXIuU3Ry
        aW5nLmh0bWxTYWZlOwoKaWYgKEVtYmVyLkVYVEVORF9QUk9UT1RZUEVTID09
        PSB0cnVlIHx8IEVtYmVyLkVYVEVORF9QUk9UT1RZUEVTLlN0cmluZykgewoK
        ICAvKioKICAgIE1hcmsgYSBzdHJpbmcgYXMgYmVpbmcgc2FmZSBmb3IgdW5l
        c2NhcGVkIG91dHB1dCB3aXRoIEhhbmRsZWJhcnMuCgogICAgYGBgamF2YXNj
        cmlwdAogICAgJzxkaXY+c29tZVN0cmluZzwvZGl2PicuaHRtbFNhZmUoKQog
        ICAgYGBgCgogICAgU2VlIFtFbWJlci5TdHJpbmcuaHRtbFNhZmVdKC9hcGkv
        Y2xhc3Nlcy9FbWJlci5TdHJpbmcuaHRtbCNtZXRob2RfaHRtbFNhZmUpLgoK
        ICAgIEBtZXRob2QgaHRtbFNhZmUKICAgIEBmb3IgU3RyaW5nCiAgICBAcmV0
        dXJuIHtIYW5kbGViYXJzLlNhZmVTdHJpbmd9IGEgc3RyaW5nIHRoYXQgd2ls
        bCBub3QgYmUgaHRtbCBlc2NhcGVkIGJ5IEhhbmRsZWJhcnMKICAqLwogIFN0
        cmluZy5wcm90b3R5cGUuaHRtbFNhZmUgPSBmdW5jdGlvbigpIHsKICAgIHJl
        dHVybiBodG1sU2FmZSh0aGlzKTsKICB9Owp9Cgp9KSgpOwoKCgooZnVuY3Rp
        b24oKSB7CkVtYmVyLkhhbmRsZWJhcnMucmVzb2x2ZVBhdGhzID0gZnVuY3Rp
        b24ob3B0aW9ucykgewogIHZhciByZXQgPSBbXSwKICAgICAgY29udGV4dHMg
        PSBvcHRpb25zLmNvbnRleHRzLAogICAgICByb290cyA9IG9wdGlvbnMucm9v
        dHMsCiAgICAgIGRhdGEgPSBvcHRpb25zLmRhdGE7CgogIGZvciAodmFyIGk9
        MCwgbD1jb250ZXh0cy5sZW5ndGg7IGk8bDsgaSsrKSB7CiAgICByZXQucHVz
        aCggRW1iZXIuSGFuZGxlYmFycy5nZXQocm9vdHNbaV0sIGNvbnRleHRzW2ld
        LCB7IGRhdGE6IGRhdGEgfSkgKTsKICB9CgogIHJldHVybiByZXQ7Cn07Cgp9
        KSgpOwoKCgooZnVuY3Rpb24oKSB7Ci8qanNoaW50IG5ld2NhcDpmYWxzZSov
        Ci8qKgpAbW9kdWxlIGVtYmVyCkBzdWJtb2R1bGUgZW1iZXItaGFuZGxlYmFy
        cwoqLwoKdmFyIHNldCA9IEVtYmVyLnNldCwgZ2V0ID0gRW1iZXIuZ2V0Owp2
        YXIgTWV0YW1vcnBoID0gcmVxdWlyZU1vZHVsZSgnbWV0YW1vcnBoJyk7Cgpm
        dW5jdGlvbiBub3RpZnlNdXRhdGlvbkxpc3RlbmVycygpIHsKICBFbWJlci5y
        dW4ub25jZShFbWJlci5WaWV3LCAnbm90aWZ5TXV0YXRpb25MaXN0ZW5lcnMn
        KTsKfQoKLy8gRE9NTWFuYWdlciBzaG91bGQganVzdCBhYnN0cmFjdCBkb20g
        bWFuaXB1bGF0aW9uIGJldHdlZW4ganF1ZXJ5IGFuZCBtZXRhbW9ycGgKdmFy
        IERPTU1hbmFnZXIgPSB7CiAgcmVtb3ZlOiBmdW5jdGlvbih2aWV3KSB7CiAg
        ICB2aWV3Lm1vcnBoLnJlbW92ZSgpOwogICAgbm90aWZ5TXV0YXRpb25MaXN0
        ZW5lcnMoKTsKICB9LAoKICBwcmVwZW5kOiBmdW5jdGlvbih2aWV3LCBodG1s
        KSB7CiAgICB2aWV3Lm1vcnBoLnByZXBlbmQoaHRtbCk7CiAgICBub3RpZnlN
        dXRhdGlvbkxpc3RlbmVycygpOwogIH0sCgogIGFmdGVyOiBmdW5jdGlvbih2
        aWV3LCBodG1sKSB7CiAgICB2aWV3Lm1vcnBoLmFmdGVyKGh0bWwpOwogICAg
        bm90aWZ5TXV0YXRpb25MaXN0ZW5lcnMoKTsKICB9LAoKICBodG1sOiBmdW5j
        dGlvbih2aWV3LCBodG1sKSB7CiAgICB2aWV3Lm1vcnBoLmh0bWwoaHRtbCk7
        CiAgICBub3RpZnlNdXRhdGlvbkxpc3RlbmVycygpOwogIH0sCgogIC8vIFRo
        aXMgaXMgbWVzc2VkIHVwLgogIHJlcGxhY2U6IGZ1bmN0aW9uKHZpZXcpIHsK
        ICAgIHZhciBtb3JwaCA9IHZpZXcubW9ycGg7CgogICAgdmlldy50cmFuc2l0
        aW9uVG8oJ3ByZVJlbmRlcicpOwoKICAgIEVtYmVyLnJ1bi5zY2hlZHVsZSgn
        cmVuZGVyJywgdGhpcywgZnVuY3Rpb24oKSB7CiAgICAgIGlmICh2aWV3Lmlz
        RGVzdHJveWluZykgeyByZXR1cm47IH0KCiAgICAgIHZpZXcuY2xlYXJSZW5k
        ZXJlZENoaWxkcmVuKCk7CiAgICAgIHZhciBidWZmZXIgPSB2aWV3LnJlbmRl
        clRvQnVmZmVyKCk7CgogICAgICB2aWV3Lmludm9rZVJlY3Vyc2l2ZWx5KGZ1
        bmN0aW9uKHZpZXcpIHsKICAgICAgICB2aWV3LnByb3BlcnR5V2lsbENoYW5n
        ZSgnZWxlbWVudCcpOwogICAgICB9KTsKICAgICAgdmlldy50cmlnZ2VyUmVj
        dXJzaXZlbHkoJ3dpbGxJbnNlcnRFbGVtZW50Jyk7CgogICAgICBtb3JwaC5y
        ZXBsYWNlV2l0aChidWZmZXIuc3RyaW5nKCkpOwogICAgICB2aWV3LnRyYW5z
        aXRpb25UbygnaW5ET00nKTsKCiAgICAgIHZpZXcuaW52b2tlUmVjdXJzaXZl
        bHkoZnVuY3Rpb24odmlldykgewogICAgICAgIHZpZXcucHJvcGVydHlEaWRD
        aGFuZ2UoJ2VsZW1lbnQnKTsKICAgICAgfSk7CiAgICAgIHZpZXcudHJpZ2dl
        clJlY3Vyc2l2ZWx5KCdkaWRJbnNlcnRFbGVtZW50Jyk7CgogICAgICBub3Rp
        ZnlNdXRhdGlvbkxpc3RlbmVycygpOwogICAgfSk7CiAgfSwKCiAgZW1wdHk6
        IGZ1bmN0aW9uKHZpZXcpIHsKICAgIHZpZXcubW9ycGguaHRtbCgiIik7CiAg
        ICBub3RpZnlNdXRhdGlvbkxpc3RlbmVycygpOwogIH0KfTsKCi8vIFRoZSBg
        bW9ycGhgIGFuZCBgb3V0ZXJIVE1MYCBwcm9wZXJ0aWVzIGFyZSBpbnRlcm5h
        bCBvbmx5Ci8vIGFuZCBub3Qgb2JzZXJ2YWJsZS4KCi8qKgogIEBjbGFzcyBf
        TWV0YW1vcnBoCiAgQG5hbWVzcGFjZSBFbWJlcgogIEBwcml2YXRlCiovCkVt
        YmVyLl9NZXRhbW9ycGggPSBFbWJlci5NaXhpbi5jcmVhdGUoewogIGlzVmly
        dHVhbDogdHJ1ZSwKICB0YWdOYW1lOiAnJywKCiAgaW5zdHJ1bWVudE5hbWU6
        ICdtZXRhbW9ycGgnLAoKICBpbml0OiBmdW5jdGlvbigpIHsKICAgIHRoaXMu
        X3N1cGVyKCk7CiAgICB0aGlzLm1vcnBoID0gTWV0YW1vcnBoKCk7CiAgICBF
        bWJlci5kZXByZWNhdGUoJ1N1cHBseWluZyBhIHRhZ05hbWUgdG8gTWV0YW1v
        cnBoIHZpZXdzIGlzIHVucmVsaWFibGUgYW5kIGlzIGRlcHJlY2F0ZWQuIFlv
        dSBtYXkgYmUgc2V0dGluZyB0aGUgdGFnTmFtZSBvbiBhIEhhbmRsZWJhcnMg
        aGVscGVyIHRoYXQgY3JlYXRlcyBhIE1ldGFtb3JwaC4nLCAhdGhpcy50YWdO
        YW1lKTsKICB9LAoKICBiZWZvcmVSZW5kZXI6IGZ1bmN0aW9uKGJ1ZmZlcikg
        ewogICAgYnVmZmVyLnB1c2godGhpcy5tb3JwaC5zdGFydFRhZygpKTsKICAg
        IGJ1ZmZlci5wdXNoT3BlbmluZ1RhZygpOwogIH0sCgogIGFmdGVyUmVuZGVy
        OiBmdW5jdGlvbihidWZmZXIpIHsKICAgIGJ1ZmZlci5wdXNoQ2xvc2luZ1Rh
        ZygpOwogICAgYnVmZmVyLnB1c2godGhpcy5tb3JwaC5lbmRUYWcoKSk7CiAg
        fSwKCiAgY3JlYXRlRWxlbWVudDogZnVuY3Rpb24oKSB7CiAgICB2YXIgYnVm
        ZmVyID0gdGhpcy5yZW5kZXJUb0J1ZmZlcigpOwogICAgdGhpcy5vdXRlckhU
        TUwgPSBidWZmZXIuc3RyaW5nKCk7CiAgICB0aGlzLmNsZWFyQnVmZmVyKCk7
        CiAgfSwKCiAgZG9tTWFuYWdlcjogRE9NTWFuYWdlcgp9KTsKCi8qKgogIEBj
        bGFzcyBfTWV0YW1vcnBoVmlldwogIEBuYW1lc3BhY2UgRW1iZXIKICBAZXh0
        ZW5kcyBFbWJlci5WaWV3CiAgQHVzZXMgRW1iZXIuX01ldGFtb3JwaAogIEBw
        cml2YXRlCiovCkVtYmVyLl9NZXRhbW9ycGhWaWV3ID0gRW1iZXIuVmlldy5l
        eHRlbmQoRW1iZXIuX01ldGFtb3JwaCk7CgovKioKICBAY2xhc3MgX1NpbXBs
        ZU1ldGFtb3JwaFZpZXcKICBAbmFtZXNwYWNlIEVtYmVyCiAgQGV4dGVuZHMg
        RW1iZXIuQ29yZVZpZXcKICBAdXNlcyBFbWJlci5fTWV0YW1vcnBoCiAgQHBy
        aXZhdGUKKi8KRW1iZXIuX1NpbXBsZU1ldGFtb3JwaFZpZXcgPSBFbWJlci5D
        b3JlVmlldy5leHRlbmQoRW1iZXIuX01ldGFtb3JwaCk7CgoKfSkoKTsKCgoK
        KGZ1bmN0aW9uKCkgewovKmdsb2JhbHMgSGFuZGxlYmFycyAqLwovKmpzaGlu
        dCBuZXdjYXA6ZmFsc2UqLwovKioKQG1vZHVsZSBlbWJlcgpAc3VibW9kdWxl
        IGVtYmVyLWhhbmRsZWJhcnMKKi8KCnZhciBnZXQgPSBFbWJlci5nZXQsIHNl
        dCA9IEVtYmVyLnNldCwgaGFuZGxlYmFyc0dldCA9IEVtYmVyLkhhbmRsZWJh
        cnMuZ2V0Owp2YXIgTWV0YW1vcnBoID0gcmVxdWlyZU1vZHVsZSgnbWV0YW1v
        cnBoJyk7CmZ1bmN0aW9uIFNpbXBsZUhhbmRsZWJhcnNWaWV3KHBhdGgsIHBh
        dGhSb290LCBpc0VzY2FwZWQsIHRlbXBsYXRlRGF0YSkgewogIHRoaXMucGF0
        aCA9IHBhdGg7CiAgdGhpcy5wYXRoUm9vdCA9IHBhdGhSb290OwogIHRoaXMu
        aXNFc2NhcGVkID0gaXNFc2NhcGVkOwogIHRoaXMudGVtcGxhdGVEYXRhID0g
        dGVtcGxhdGVEYXRhOwoKICB0aGlzLm1vcnBoID0gTWV0YW1vcnBoKCk7CiAg
        dGhpcy5zdGF0ZSA9ICdwcmVSZW5kZXInOwogIHRoaXMudXBkYXRlSWQgPSBu
        dWxsOwogIHRoaXMuX3BhcmVudFZpZXcgPSBudWxsOwogIHRoaXMuYnVmZmVy
        ID0gbnVsbDsKfQoKRW1iZXIuX1NpbXBsZUhhbmRsZWJhcnNWaWV3ID0gU2lt
        cGxlSGFuZGxlYmFyc1ZpZXc7CgpTaW1wbGVIYW5kbGViYXJzVmlldy5wcm90
        b3R5cGUgPSB7CiAgaXNWaXJ0dWFsOiB0cnVlLAogIGlzVmlldzogdHJ1ZSwK
        CiAgZGVzdHJveTogZnVuY3Rpb24gKCkgewogICAgaWYgKHRoaXMudXBkYXRl
        SWQpIHsKICAgICAgRW1iZXIucnVuLmNhbmNlbCh0aGlzLnVwZGF0ZUlkKTsK
        ICAgICAgdGhpcy51cGRhdGVJZCA9IG51bGw7CiAgICB9CiAgICBpZiAodGhp
        cy5fcGFyZW50VmlldykgewogICAgICB0aGlzLl9wYXJlbnRWaWV3LnJlbW92
        ZUNoaWxkKHRoaXMpOwogICAgfQogICAgdGhpcy5tb3JwaCA9IG51bGw7CiAg
        ICB0aGlzLnN0YXRlID0gJ2Rlc3Ryb3llZCc7CiAgfSwKCiAgcHJvcGVydHlX
        aWxsQ2hhbmdlOiBFbWJlci5LLAoKICBwcm9wZXJ0eURpZENoYW5nZTogRW1i
        ZXIuSywKCiAgbm9ybWFsaXplZFZhbHVlOiBmdW5jdGlvbigpIHsKICAgIHZh
        ciBwYXRoID0gdGhpcy5wYXRoLAogICAgICAgIHBhdGhSb290ID0gdGhpcy5w
        YXRoUm9vdCwKICAgICAgICByZXN1bHQsIHRlbXBsYXRlRGF0YTsKCiAgICAv
        LyBVc2UgdGhlIHBhdGhSb290IGFzIHRoZSByZXN1bHQgaWYgbm8gcGF0aCBp
        cyBwcm92aWRlZC4gVGhpcwogICAgLy8gaGFwcGVucyBpZiB0aGUgcGF0aCBp
        cyBgdGhpc2AsIHdoaWNoIGdldHMgbm9ybWFsaXplZCBpbnRvCiAgICAvLyBh
        IGBwYXRoUm9vdGAgb2YgdGhlIGN1cnJlbnQgSGFuZGxlYmFycyBjb250ZXh0
        IGFuZCBhIHBhdGgKICAgIC8vIG9mIGAnJ2AuCiAgICBpZiAocGF0aCA9PT0g
        JycpIHsKICAgICAgcmVzdWx0ID0gcGF0aFJvb3Q7CiAgICB9IGVsc2Ugewog
        ICAgICB0ZW1wbGF0ZURhdGEgPSB0aGlzLnRlbXBsYXRlRGF0YTsKICAgICAg
        cmVzdWx0ID0gaGFuZGxlYmFyc0dldChwYXRoUm9vdCwgcGF0aCwgeyBkYXRh
        OiB0ZW1wbGF0ZURhdGEgfSk7CiAgICB9CgogICAgcmV0dXJuIHJlc3VsdDsK
        ICB9LAoKICByZW5kZXJUb0J1ZmZlcjogZnVuY3Rpb24oYnVmZmVyKSB7CiAg
        ICB2YXIgc3RyaW5nID0gJyc7CgogICAgc3RyaW5nICs9IHRoaXMubW9ycGgu
        c3RhcnRUYWcoKTsKICAgIHN0cmluZyArPSB0aGlzLnJlbmRlcigpOwogICAg
        c3RyaW5nICs9IHRoaXMubW9ycGguZW5kVGFnKCk7CgogICAgYnVmZmVyLnB1
        c2goc3RyaW5nKTsKICB9LAoKICByZW5kZXI6IGZ1bmN0aW9uKCkgewogICAg
        Ly8gSWYgbm90IGludm9rZWQgdmlhIGEgdHJpcGxlLW11c3RhY2hlICh7e3tm
        b299fX0pLCBlc2NhcGUKICAgIC8vIHRoZSBjb250ZW50IG9mIHRoZSB0ZW1w
        bGF0ZS4KICAgIHZhciBlc2NhcGUgPSB0aGlzLmlzRXNjYXBlZDsKICAgIHZh
        ciByZXN1bHQgPSB0aGlzLm5vcm1hbGl6ZWRWYWx1ZSgpOwoKICAgIGlmIChy
        ZXN1bHQgPT09IG51bGwgfHwgcmVzdWx0ID09PSB1bmRlZmluZWQpIHsKICAg
        ICAgcmVzdWx0ID0gIiI7CiAgICB9IGVsc2UgaWYgKCEocmVzdWx0IGluc3Rh
        bmNlb2YgSGFuZGxlYmFycy5TYWZlU3RyaW5nKSkgewogICAgICByZXN1bHQg
        PSBTdHJpbmcocmVzdWx0KTsKICAgIH0KCiAgICBpZiAoZXNjYXBlKSB7IHJl
        c3VsdCA9IEhhbmRsZWJhcnMuVXRpbHMuZXNjYXBlRXhwcmVzc2lvbihyZXN1
        bHQpOyB9CiAgICByZXR1cm4gcmVzdWx0OwogIH0sCgogIHJlcmVuZGVyOiBm
        dW5jdGlvbigpIHsKICAgIHN3aXRjaCh0aGlzLnN0YXRlKSB7CiAgICAgIGNh
        c2UgJ3ByZVJlbmRlcic6CiAgICAgIGNhc2UgJ2Rlc3Ryb3llZCc6CiAgICAg
        ICAgYnJlYWs7CiAgICAgIGNhc2UgJ2luQnVmZmVyJzoKICAgICAgICB0aHJv
        dyBuZXcgRW1iZXIuRXJyb3IoIlNvbWV0aGluZyB5b3UgZGlkIHRyaWVkIHRv
        IHJlcGxhY2UgYW4ge3tleHByZXNzaW9ufX0gYmVmb3JlIGl0IHdhcyBpbnNl
        cnRlZCBpbnRvIHRoZSBET00uIik7CiAgICAgIGNhc2UgJ2hhc0VsZW1lbnQn
        OgogICAgICBjYXNlICdpbkRPTSc6CiAgICAgICAgdGhpcy51cGRhdGVJZCA9
        IEVtYmVyLnJ1bi5zY2hlZHVsZU9uY2UoJ3JlbmRlcicsIHRoaXMsICd1cGRh
        dGUnKTsKICAgICAgICBicmVhazsKICAgIH0KCiAgICByZXR1cm4gdGhpczsK
        ICB9LAoKICB1cGRhdGU6IGZ1bmN0aW9uICgpIHsKICAgIHRoaXMudXBkYXRl
        SWQgPSBudWxsOwogICAgdGhpcy5tb3JwaC5odG1sKHRoaXMucmVuZGVyKCkp
        OwogIH0sCgogIHRyYW5zaXRpb25UbzogZnVuY3Rpb24oc3RhdGUpIHsKICAg
        IHRoaXMuc3RhdGUgPSBzdGF0ZTsKICB9Cn07Cgp2YXIgc3RhdGVzID0gRW1i
        ZXIuVmlldy5jbG9uZVN0YXRlcyhFbWJlci5WaWV3LnN0YXRlcyksIG1lcmdl
        ID0gRW1iZXIubWVyZ2U7CgptZXJnZShzdGF0ZXMuX2RlZmF1bHQsIHsKICBy
        ZXJlbmRlcklmTmVlZGVkOiBFbWJlci5LCn0pOwoKbWVyZ2Uoc3RhdGVzLmlu
        RE9NLCB7CiAgcmVyZW5kZXJJZk5lZWRlZDogZnVuY3Rpb24odmlldykgewog
        ICAgaWYgKHZpZXcubm9ybWFsaXplZFZhbHVlKCkgIT09IHZpZXcuX2xhc3RO
        b3JtYWxpemVkVmFsdWUpIHsKICAgICAgdmlldy5yZXJlbmRlcigpOwogICAg
        fQogIH0KfSk7CgovKioKICBgRW1iZXIuX0hhbmRsZWJhcnNCb3VuZFZpZXdg
        IGlzIGEgcHJpdmF0ZSB2aWV3IGNyZWF0ZWQgYnkgdGhlIEhhbmRsZWJhcnMK
        ICBge3tiaW5kfX1gIGhlbHBlcnMgdGhhdCBpcyB1c2VkIHRvIGtlZXAgdHJh
        Y2sgb2YgYm91bmQgcHJvcGVydGllcy4KCiAgRXZlcnkgdGltZSBhIHByb3Bl
        cnR5IGlzIGJvdW5kIHVzaW5nIGEgYHt7bXVzdGFjaGV9fWAsIGFuIGFub255
        bW91cyBzdWJjbGFzcwogIG9mIGBFbWJlci5fSGFuZGxlYmFyc0JvdW5kVmll
        d2AgaXMgY3JlYXRlZCB3aXRoIHRoZSBhcHByb3ByaWF0ZSBzdWItdGVtcGxh
        dGUKICBhbmQgY29udGV4dCBzZXQgdXAuIFdoZW4gdGhlIGFzc29jaWF0ZWQg
        cHJvcGVydHkgY2hhbmdlcywganVzdCB0aGUgdGVtcGxhdGUKICBmb3IgdGhp
        cyB2aWV3IHdpbGwgcmUtcmVuZGVyLgoKICBAY2xhc3MgX0hhbmRsZWJhcnNC
        b3VuZFZpZXcKICBAbmFtZXNwYWNlIEVtYmVyCiAgQGV4dGVuZHMgRW1iZXIu
        X01ldGFtb3JwaFZpZXcKICBAcHJpdmF0ZQoqLwpFbWJlci5fSGFuZGxlYmFy
        c0JvdW5kVmlldyA9IEVtYmVyLl9NZXRhbW9ycGhWaWV3LmV4dGVuZCh7CiAg
        aW5zdHJ1bWVudE5hbWU6ICdib3VuZEhhbmRsZWJhcnMnLAogIHN0YXRlczog
        c3RhdGVzLAoKICAvKioKICAgIFRoZSBmdW5jdGlvbiB1c2VkIHRvIGRldGVy
        bWluZSBpZiB0aGUgYGRpc3BsYXlUZW1wbGF0ZWAgb3IKICAgIGBpbnZlcnNl
        VGVtcGxhdGVgIHNob3VsZCBiZSByZW5kZXJlZC4gVGhpcyBzaG91bGQgYmUg
        YSBmdW5jdGlvbiB0aGF0IHRha2VzCiAgICBhIHZhbHVlIGFuZCByZXR1cm5z
        IGEgQm9vbGVhbi4KCiAgICBAcHJvcGVydHkgc2hvdWxkRGlzcGxheUZ1bmMK
        ICAgIEB0eXBlIEZ1bmN0aW9uCiAgICBAZGVmYXVsdCBudWxsCiAgKi8KICBz
        aG91bGREaXNwbGF5RnVuYzogbnVsbCwKCiAgLyoqCiAgICBXaGV0aGVyIHRo
        ZSB0ZW1wbGF0ZSByZW5kZXJlZCBieSB0aGlzIHZpZXcgZ2V0cyBwYXNzZWQg
        dGhlIGNvbnRleHQgb2JqZWN0CiAgICBvZiBpdHMgcGFyZW50IHRlbXBsYXRl
        LCBvciBnZXRzIHBhc3NlZCB0aGUgdmFsdWUgb2YgcmV0cmlldmluZyBgcGF0
        aGAKICAgIGZyb20gdGhlIGBwYXRoUm9vdGAuCgogICAgRm9yIGV4YW1wbGUs
        IHRoaXMgaXMgdHJ1ZSB3aGVuIHVzaW5nIHRoZSBge3sjaWZ9fWAgaGVscGVy
        LCBiZWNhdXNlIHRoZQogICAgdGVtcGxhdGUgaW5zaWRlIHRoZSBoZWxwZXIg
        c2hvdWxkIGxvb2sgdXAgcHJvcGVydGllcyByZWxhdGl2ZSB0byB0aGUgc2Ft
        ZQogICAgb2JqZWN0IGFzIG91dHNpZGUgdGhlIGJsb2NrLiBUaGlzIHdvdWxk
        IGJlIGBmYWxzZWAgd2hlbiB1c2VkIHdpdGggYHt7I3dpdGgKICAgIGZvb319
        YCBiZWNhdXNlIHRoZSB0ZW1wbGF0ZSBzaG91bGQgcmVjZWl2ZSB0aGUgb2Jq
        ZWN0IGZvdW5kIGJ5IGV2YWx1YXRpbmcKICAgIGBmb29gLgoKICAgIEBwcm9w
        ZXJ0eSBwcmVzZXJ2ZUNvbnRleHQKICAgIEB0eXBlIEJvb2xlYW4KICAgIEBk
        ZWZhdWx0IGZhbHNlCiAgKi8KICBwcmVzZXJ2ZUNvbnRleHQ6IGZhbHNlLAoK
        ICAvKioKICAgIElmIGBwcmVzZXJ2ZUNvbnRleHRgIGlzIHRydWUsIHRoaXMg
        aXMgdGhlIG9iamVjdCB0aGF0IHdpbGwgYmUgdXNlZAogICAgdG8gcmVuZGVy
        IHRoZSB0ZW1wbGF0ZS4KCiAgICBAcHJvcGVydHkgcHJldmlvdXNDb250ZXh0
        CiAgICBAdHlwZSBPYmplY3QKICAqLwogIHByZXZpb3VzQ29udGV4dDogbnVs
        bCwKCiAgLyoqCiAgICBUaGUgdGVtcGxhdGUgdG8gcmVuZGVyIHdoZW4gYHNo
        b3VsZERpc3BsYXlGdW5jYCBldmFsdWF0ZXMgdG8gYHRydWVgLgoKICAgIEBw
        cm9wZXJ0eSBkaXNwbGF5VGVtcGxhdGUKICAgIEB0eXBlIEZ1bmN0aW9uCiAg
        ICBAZGVmYXVsdCBudWxsCiAgKi8KICBkaXNwbGF5VGVtcGxhdGU6IG51bGws
        CgogIC8qKgogICAgVGhlIHRlbXBsYXRlIHRvIHJlbmRlciB3aGVuIGBzaG91
        bGREaXNwbGF5RnVuY2AgZXZhbHVhdGVzIHRvIGBmYWxzZWAuCgogICAgQHBy
        b3BlcnR5IGludmVyc2VUZW1wbGF0ZQogICAgQHR5cGUgRnVuY3Rpb24KICAg
        IEBkZWZhdWx0IG51bGwKICAqLwogIGludmVyc2VUZW1wbGF0ZTogbnVsbCwK
        CgogIC8qKgogICAgVGhlIHBhdGggdG8gbG9vayB1cCBvbiBgcGF0aFJvb3Rg
        IHRoYXQgaXMgcGFzc2VkIHRvCiAgICBgc2hvdWxkRGlzcGxheUZ1bmNgIHRv
        IGRldGVybWluZSB3aGljaCB0ZW1wbGF0ZSB0byByZW5kZXIuCgogICAgSW4g
        YWRkaXRpb24sIGlmIGBwcmVzZXJ2ZUNvbnRleHRgIGlzIGBmYWxzZSxgIHRo
        ZSBvYmplY3QgYXQgdGhpcyBwYXRoIHdpbGwKICAgIGJlIHBhc3NlZCB0byB0
        aGUgdGVtcGxhdGUgd2hlbiByZW5kZXJpbmcuCgogICAgQHByb3BlcnR5IHBh
        dGgKICAgIEB0eXBlIFN0cmluZwogICAgQGRlZmF1bHQgbnVsbAogICovCiAg
        cGF0aDogbnVsbCwKCiAgLyoqCiAgICBUaGUgb2JqZWN0IGZyb20gd2hpY2gg
        dGhlIGBwYXRoYCB3aWxsIGJlIGxvb2tlZCB1cC4gU29tZXRpbWVzIHRoaXMg
        aXMgdGhlCiAgICBzYW1lIGFzIHRoZSBgcHJldmlvdXNDb250ZXh0YCwgYnV0
        IGluIGNhc2VzIHdoZXJlIHRoaXMgdmlldyBoYXMgYmVlbgogICAgZ2VuZXJh
        dGVkIGZvciBwYXRocyB0aGF0IHN0YXJ0IHdpdGggYSBrZXl3b3JkIHN1Y2gg
        YXMgYHZpZXdgIG9yCiAgICBgY29udHJvbGxlcmAsIHRoZSBwYXRoIHJvb3Qg
        d2lsbCBiZSB0aGF0IHJlc29sdmVkIG9iamVjdC4KCiAgICBAcHJvcGVydHkg
        cGF0aFJvb3QKICAgIEB0eXBlIE9iamVjdAogICovCiAgcGF0aFJvb3Q6IG51
        bGwsCgogIG5vcm1hbGl6ZWRWYWx1ZTogZnVuY3Rpb24oKSB7CiAgICB2YXIg
        cGF0aCA9IGdldCh0aGlzLCAncGF0aCcpLAogICAgICAgIHBhdGhSb290ICA9
        IGdldCh0aGlzLCAncGF0aFJvb3QnKSwKICAgICAgICB2YWx1ZU5vcm1hbGl6
        ZXIgPSBnZXQodGhpcywgJ3ZhbHVlTm9ybWFsaXplckZ1bmMnKSwKICAgICAg
        ICByZXN1bHQsIHRlbXBsYXRlRGF0YTsKCiAgICAvLyBVc2UgdGhlIHBhdGhS
        b290IGFzIHRoZSByZXN1bHQgaWYgbm8gcGF0aCBpcyBwcm92aWRlZC4gVGhp
        cwogICAgLy8gaGFwcGVucyBpZiB0aGUgcGF0aCBpcyBgdGhpc2AsIHdoaWNo
        IGdldHMgbm9ybWFsaXplZCBpbnRvCiAgICAvLyBhIGBwYXRoUm9vdGAgb2Yg
        dGhlIGN1cnJlbnQgSGFuZGxlYmFycyBjb250ZXh0IGFuZCBhIHBhdGgKICAg
        IC8vIG9mIGAnJ2AuCiAgICBpZiAocGF0aCA9PT0gJycpIHsKICAgICAgcmVz
        dWx0ID0gcGF0aFJvb3Q7CiAgICB9IGVsc2UgewogICAgICB0ZW1wbGF0ZURh
        dGEgPSBnZXQodGhpcywgJ3RlbXBsYXRlRGF0YScpOwogICAgICByZXN1bHQg
        PSBoYW5kbGViYXJzR2V0KHBhdGhSb290LCBwYXRoLCB7IGRhdGE6IHRlbXBs
        YXRlRGF0YSB9KTsKICAgIH0KCiAgICByZXR1cm4gdmFsdWVOb3JtYWxpemVy
        ID8gdmFsdWVOb3JtYWxpemVyKHJlc3VsdCkgOiByZXN1bHQ7CiAgfSwKCiAg
        cmVyZW5kZXJJZk5lZWRlZDogZnVuY3Rpb24oKSB7CiAgICB0aGlzLmN1cnJl
        bnRTdGF0ZS5yZXJlbmRlcklmTmVlZGVkKHRoaXMpOwogIH0sCgogIC8qKgog
        ICAgRGV0ZXJtaW5lcyB3aGljaCB0ZW1wbGF0ZSB0byBpbnZva2UsIHNldHMg
        dXAgdGhlIGNvcnJlY3Qgc3RhdGUgYmFzZWQgb24KICAgIHRoYXQgbG9naWMs
        IHRoZW4gaW52b2tlcyB0aGUgZGVmYXVsdCBgRW1iZXIuVmlld2AgYHJlbmRl
        cmAgaW1wbGVtZW50YXRpb24uCgogICAgVGhpcyBtZXRob2Qgd2lsbCBmaXJz
        dCBsb29rIHVwIHRoZSBgcGF0aGAga2V5IG9uIGBwYXRoUm9vdGAsCiAgICB0
        aGVuIHBhc3MgdGhhdCB2YWx1ZSB0byB0aGUgYHNob3VsZERpc3BsYXlGdW5j
        YCBmdW5jdGlvbi4gSWYgdGhhdCByZXR1cm5zCiAgICBgdHJ1ZSxgIHRoZSBg
        ZGlzcGxheVRlbXBsYXRlYCBmdW5jdGlvbiB3aWxsIGJlIHJlbmRlcmVkIHRv
        IERPTS4gT3RoZXJ3aXNlLAogICAgYGludmVyc2VUZW1wbGF0ZWAsIGlmIHNw
        ZWNpZmllZCwgd2lsbCBiZSByZW5kZXJlZC4KCiAgICBGb3IgZXhhbXBsZSwg
        aWYgdGhpcyBgRW1iZXIuX0hhbmRsZWJhcnNCb3VuZFZpZXdgIHJlcHJlc2Vu
        dGVkIHRoZSBge3sjd2l0aAogICAgZm9vfX1gIGhlbHBlciwgaXQgd291bGQg
        bG9vayB1cCB0aGUgYGZvb2AgcHJvcGVydHkgb2YgaXRzIGNvbnRleHQsIGFu
        ZAogICAgYHNob3VsZERpc3BsYXlGdW5jYCB3b3VsZCBhbHdheXMgcmV0dXJu
        IHRydWUuIFRoZSBvYmplY3QgZm91bmQgYnkgbG9va2luZwogICAgdXAgYGZv
        b2Agd291bGQgYmUgcGFzc2VkIHRvIGBkaXNwbGF5VGVtcGxhdGVgLgoKICAg
        IEBtZXRob2QgcmVuZGVyCiAgICBAcGFyYW0ge0VtYmVyLlJlbmRlckJ1ZmZl
        cn0gYnVmZmVyCiAgKi8KICByZW5kZXI6IGZ1bmN0aW9uKGJ1ZmZlcikgewog
        ICAgLy8gSWYgbm90IGludm9rZWQgdmlhIGEgdHJpcGxlLW11c3RhY2hlICh7
        e3tmb299fX0pLCBlc2NhcGUKICAgIC8vIHRoZSBjb250ZW50IG9mIHRoZSB0
        ZW1wbGF0ZS4KICAgIHZhciBlc2NhcGUgPSBnZXQodGhpcywgJ2lzRXNjYXBl
        ZCcpOwoKICAgIHZhciBzaG91bGREaXNwbGF5ID0gZ2V0KHRoaXMsICdzaG91
        bGREaXNwbGF5RnVuYycpLAogICAgICAgIHByZXNlcnZlQ29udGV4dCA9IGdl
        dCh0aGlzLCAncHJlc2VydmVDb250ZXh0JyksCiAgICAgICAgY29udGV4dCA9
        IGdldCh0aGlzLCAncHJldmlvdXNDb250ZXh0Jyk7CgogICAgdmFyIGludmVy
        c2VUZW1wbGF0ZSA9IGdldCh0aGlzLCAnaW52ZXJzZVRlbXBsYXRlJyksCiAg
        ICAgICAgZGlzcGxheVRlbXBsYXRlID0gZ2V0KHRoaXMsICdkaXNwbGF5VGVt
        cGxhdGUnKTsKCiAgICB2YXIgcmVzdWx0ID0gdGhpcy5ub3JtYWxpemVkVmFs
        dWUoKTsKICAgIHRoaXMuX2xhc3ROb3JtYWxpemVkVmFsdWUgPSByZXN1bHQ7
        CgogICAgLy8gRmlyc3QsIHRlc3QgdGhlIGNvbmRpdGlvbmFsIHRvIHNlZSBp
        ZiB3ZSBzaG91bGQKICAgIC8vIHJlbmRlciB0aGUgdGVtcGxhdGUgb3Igbm90
        LgogICAgaWYgKHNob3VsZERpc3BsYXkocmVzdWx0KSkgewogICAgICBzZXQo
        dGhpcywgJ3RlbXBsYXRlJywgZGlzcGxheVRlbXBsYXRlKTsKCiAgICAgIC8v
        IElmIHdlIGFyZSBwcmVzZXJ2aW5nIHRoZSBjb250ZXh0IChmb3IgZXhhbXBs
        ZSwgaWYgdGhpcwogICAgICAvLyBpcyBhbiAjaWYgYmxvY2ssIGNhbGwgdGhl
        IHRlbXBsYXRlIHdpdGggdGhlIHNhbWUgb2JqZWN0LgogICAgICBpZiAocHJl
        c2VydmVDb250ZXh0KSB7CiAgICAgICAgc2V0KHRoaXMsICdfY29udGV4dCcs
        IGNvbnRleHQpOwogICAgICB9IGVsc2UgewogICAgICAvLyBPdGhlcndpc2Us
        IGRldGVybWluZSBpZiB0aGlzIGlzIGEgYmxvY2sgYmluZCBvciBub3QuCiAg
        ICAgIC8vIElmIHNvLCBwYXNzIHRoZSBzcGVjaWZpZWQgb2JqZWN0IHRvIHRo
        ZSB0ZW1wbGF0ZQogICAgICAgIGlmIChkaXNwbGF5VGVtcGxhdGUpIHsKICAg
        ICAgICAgIHNldCh0aGlzLCAnX2NvbnRleHQnLCByZXN1bHQpOwogICAgICAg
        IH0gZWxzZSB7CiAgICAgICAgLy8gVGhpcyBpcyBub3QgYSBiaW5kIGJsb2Nr
        LCBqdXN0IHB1c2ggdGhlIHJlc3VsdCBvZiB0aGUKICAgICAgICAvLyBleHBy
        ZXNzaW9uIHRvIHRoZSByZW5kZXIgY29udGV4dCBhbmQgcmV0dXJuLgogICAg
        ICAgICAgaWYgKHJlc3VsdCA9PT0gbnVsbCB8fCByZXN1bHQgPT09IHVuZGVm
        aW5lZCkgewogICAgICAgICAgICByZXN1bHQgPSAiIjsKICAgICAgICAgIH0g
        ZWxzZSBpZiAoIShyZXN1bHQgaW5zdGFuY2VvZiBIYW5kbGViYXJzLlNhZmVT
        dHJpbmcpKSB7CiAgICAgICAgICAgIHJlc3VsdCA9IFN0cmluZyhyZXN1bHQp
        OwogICAgICAgICAgfQoKICAgICAgICAgIGlmIChlc2NhcGUpIHsgcmVzdWx0
        ID0gSGFuZGxlYmFycy5VdGlscy5lc2NhcGVFeHByZXNzaW9uKHJlc3VsdCk7
        IH0KICAgICAgICAgIGJ1ZmZlci5wdXNoKHJlc3VsdCk7CiAgICAgICAgICBy
        ZXR1cm47CiAgICAgICAgfQogICAgICB9CiAgICB9IGVsc2UgaWYgKGludmVy
        c2VUZW1wbGF0ZSkgewogICAgICBzZXQodGhpcywgJ3RlbXBsYXRlJywgaW52
        ZXJzZVRlbXBsYXRlKTsKCiAgICAgIGlmIChwcmVzZXJ2ZUNvbnRleHQpIHsK
        ICAgICAgICBzZXQodGhpcywgJ19jb250ZXh0JywgY29udGV4dCk7CiAgICAg
        IH0gZWxzZSB7CiAgICAgICAgc2V0KHRoaXMsICdfY29udGV4dCcsIHJlc3Vs
        dCk7CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIHNldCh0aGlzLCAndGVt
        cGxhdGUnLCBmdW5jdGlvbigpIHsgcmV0dXJuICcnOyB9KTsKICAgIH0KCiAg
        ICByZXR1cm4gdGhpcy5fc3VwZXIoYnVmZmVyKTsKICB9Cn0pOwoKfSkoKTsK
        CgoKKGZ1bmN0aW9uKCkgewovKioKQG1vZHVsZSBlbWJlcgpAc3VibW9kdWxl
        IGVtYmVyLWhhbmRsZWJhcnMKKi8KCnZhciBnZXQgPSBFbWJlci5nZXQsIHNl
        dCA9IEVtYmVyLnNldCwgZm10ID0gRW1iZXIuU3RyaW5nLmZtdDsKdmFyIGhh
        bmRsZWJhcnNHZXQgPSBFbWJlci5IYW5kbGViYXJzLmdldCwgbm9ybWFsaXpl
        UGF0aCA9IEVtYmVyLkhhbmRsZWJhcnMubm9ybWFsaXplUGF0aDsKdmFyIGZv
        ckVhY2ggPSBFbWJlci5BcnJheVBvbHlmaWxscy5mb3JFYWNoOwoKdmFyIEVt
        YmVySGFuZGxlYmFycyA9IEVtYmVyLkhhbmRsZWJhcnMsIGhlbHBlcnMgPSBF
        bWJlckhhbmRsZWJhcnMuaGVscGVyczsKCmZ1bmN0aW9uIGV4aXN0cyh2YWx1
        ZSkgewogIHJldHVybiAhRW1iZXIuaXNOb25lKHZhbHVlKTsKfQoKLy8gQmlu
        ZHMgYSBwcm9wZXJ0eSBpbnRvIHRoZSBET00uIFRoaXMgd2lsbCBjcmVhdGUg
        YSBob29rIGluIERPTSB0aGF0IHRoZQovLyBLVk8gc3lzdGVtIHdpbGwgbG9v
        ayBmb3IgYW5kIHVwZGF0ZSBpZiB0aGUgcHJvcGVydHkgY2hhbmdlcy4KZnVu
        Y3Rpb24gYmluZChwcm9wZXJ0eSwgb3B0aW9ucywgcHJlc2VydmVDb250ZXh0
        LCBzaG91bGREaXNwbGF5LCB2YWx1ZU5vcm1hbGl6ZXIsIGNoaWxkUHJvcGVy
        dGllcykgewogIHZhciBkYXRhID0gb3B0aW9ucy5kYXRhLAogICAgICBmbiA9
        IG9wdGlvbnMuZm4sCiAgICAgIGludmVyc2UgPSBvcHRpb25zLmludmVyc2Us
        CiAgICAgIHZpZXcgPSBkYXRhLnZpZXcsCiAgICAgIGN1cnJlbnRDb250ZXh0
        ID0gdGhpcywKICAgICAgbm9ybWFsaXplZCwgb2JzZXJ2ZXIsIGk7CgogIG5v
        cm1hbGl6ZWQgPSBub3JtYWxpemVQYXRoKGN1cnJlbnRDb250ZXh0LCBwcm9w
        ZXJ0eSwgZGF0YSk7CgogIC8vIFNldCB1cCBvYnNlcnZlcnMgZm9yIG9ic2Vy
        dmFibGUgb2JqZWN0cwogIGlmICgnb2JqZWN0JyA9PT0gdHlwZW9mIHRoaXMp
        IHsKICAgIGlmIChkYXRhLmluc2lkZUdyb3VwKSB7CiAgICAgIG9ic2VydmVy
        ID0gZnVuY3Rpb24oKSB7CiAgICAgICAgRW1iZXIucnVuLm9uY2Uodmlldywg
        J3JlcmVuZGVyJyk7CiAgICAgIH07CgogICAgICB2YXIgdGVtcGxhdGUsIGNv
        bnRleHQsIHJlc3VsdCA9IGhhbmRsZWJhcnNHZXQoY3VycmVudENvbnRleHQs
        IHByb3BlcnR5LCBvcHRpb25zKTsKCiAgICAgIHJlc3VsdCA9IHZhbHVlTm9y
        bWFsaXplciA/IHZhbHVlTm9ybWFsaXplcihyZXN1bHQpIDogcmVzdWx0OwoK
        ICAgICAgY29udGV4dCA9IHByZXNlcnZlQ29udGV4dCA/IGN1cnJlbnRDb250
        ZXh0IDogcmVzdWx0OwogICAgICBpZiAoc2hvdWxkRGlzcGxheShyZXN1bHQp
        KSB7CiAgICAgICAgdGVtcGxhdGUgPSBmbjsKICAgICAgfSBlbHNlIGlmIChp
        bnZlcnNlKSB7CiAgICAgICAgdGVtcGxhdGUgPSBpbnZlcnNlOwogICAgICB9
        CgogICAgICB0ZW1wbGF0ZShjb250ZXh0LCB7IGRhdGE6IG9wdGlvbnMuZGF0
        YSB9KTsKICAgIH0gZWxzZSB7CiAgICAgIC8vIENyZWF0ZSB0aGUgdmlldyB0
        aGF0IHdpbGwgd3JhcCB0aGUgb3V0cHV0IG9mIHRoaXMgdGVtcGxhdGUvcHJv
        cGVydHkKICAgICAgLy8gYW5kIGFkZCBpdCB0byB0aGUgbmVhcmVzdCB2aWV3
        J3MgY2hpbGRWaWV3cyBhcnJheS4KICAgICAgLy8gU2VlIHRoZSBkb2N1bWVu
        dGF0aW9uIG9mIEVtYmVyLl9IYW5kbGViYXJzQm91bmRWaWV3IGZvciBtb3Jl
        LgogICAgICB2YXIgYmluZFZpZXcgPSB2aWV3LmNyZWF0ZUNoaWxkVmlldyhF
        bWJlci5fSGFuZGxlYmFyc0JvdW5kVmlldywgewogICAgICAgIHByZXNlcnZl
        Q29udGV4dDogcHJlc2VydmVDb250ZXh0LAogICAgICAgIHNob3VsZERpc3Bs
        YXlGdW5jOiBzaG91bGREaXNwbGF5LAogICAgICAgIHZhbHVlTm9ybWFsaXpl
        ckZ1bmM6IHZhbHVlTm9ybWFsaXplciwKICAgICAgICBkaXNwbGF5VGVtcGxh
        dGU6IGZuLAogICAgICAgIGludmVyc2VUZW1wbGF0ZTogaW52ZXJzZSwKICAg
        ICAgICBwYXRoOiBwcm9wZXJ0eSwKICAgICAgICBwYXRoUm9vdDogY3VycmVu
        dENvbnRleHQsCiAgICAgICAgcHJldmlvdXNDb250ZXh0OiBjdXJyZW50Q29u
        dGV4dCwKICAgICAgICBpc0VzY2FwZWQ6ICFvcHRpb25zLmhhc2gudW5lc2Nh
        cGVkLAogICAgICAgIHRlbXBsYXRlRGF0YTogb3B0aW9ucy5kYXRhCiAgICAg
        IH0pOwoKICAgICAgdmlldy5hcHBlbmRDaGlsZChiaW5kVmlldyk7CgogICAg
        ICBvYnNlcnZlciA9IGZ1bmN0aW9uKCkgewogICAgICAgIEVtYmVyLnJ1bi5z
        Y2hlZHVsZU9uY2UoJ3JlbmRlcicsIGJpbmRWaWV3LCAncmVyZW5kZXJJZk5l
        ZWRlZCcpOwogICAgICB9OwogICAgfQoKICAgIC8vIE9ic2VydmVzIHRoZSBn
        aXZlbiBwcm9wZXJ0eSBvbiB0aGUgY29udGV4dCBhbmQKICAgIC8vIHRlbGxz
        IHRoZSBFbWJlci5fSGFuZGxlYmFyc0JvdW5kVmlldyB0byByZS1yZW5kZXIu
        IElmIHByb3BlcnR5CiAgICAvLyBpcyBhbiBlbXB0eSBzdHJpbmcsIHdlIGFy
        ZSBwcmludGluZyB0aGUgY3VycmVudCBjb250ZXh0CiAgICAvLyBvYmplY3Qg
        KHt7dGhpc319KSBzbyB1cGRhdGluZyBpdCBpcyBub3Qgb3VyIHJlc3BvbnNp
        YmlsaXR5LgogICAgaWYgKG5vcm1hbGl6ZWQucGF0aCAhPT0gJycpIHsKICAg
        ICAgdmlldy5yZWdpc3Rlck9ic2VydmVyKG5vcm1hbGl6ZWQucm9vdCwgbm9y
        bWFsaXplZC5wYXRoLCBvYnNlcnZlcik7CiAgICAgIGlmIChjaGlsZFByb3Bl
        cnRpZXMpIHsKICAgICAgICBmb3IgKGk9MDsgaTxjaGlsZFByb3BlcnRpZXMu
        bGVuZ3RoOyBpKyspIHsKICAgICAgICAgIHZpZXcucmVnaXN0ZXJPYnNlcnZl
        cihub3JtYWxpemVkLnJvb3QsIG5vcm1hbGl6ZWQucGF0aCsnLicrY2hpbGRQ
        cm9wZXJ0aWVzW2ldLCBvYnNlcnZlcik7CiAgICAgICAgfQogICAgICB9CiAg
        ICB9CiAgfSBlbHNlIHsKICAgIC8vIFRoZSBvYmplY3QgaXMgbm90IG9ic2Vy
        dmFibGUsIHNvIGp1c3QgcmVuZGVyIGl0IG91dCBhbmQKICAgIC8vIGJlIGRv
        bmUgd2l0aCBpdC4KICAgIGRhdGEuYnVmZmVyLnB1c2goaGFuZGxlYmFyc0dl
        dChjdXJyZW50Q29udGV4dCwgcHJvcGVydHksIG9wdGlvbnMpKTsKICB9Cn0K
        CmZ1bmN0aW9uIHNpbXBsZUJpbmQoY3VycmVudENvbnRleHQsIHByb3BlcnR5
        LCBvcHRpb25zKSB7CiAgdmFyIGRhdGEgPSBvcHRpb25zLmRhdGEsCiAgICAg
        IHZpZXcgPSBkYXRhLnZpZXcsCiAgICAgIG5vcm1hbGl6ZWQsIG9ic2VydmVy
        LCBwYXRoUm9vdCwgb3V0cHV0OwoKICBub3JtYWxpemVkID0gbm9ybWFsaXpl
        UGF0aChjdXJyZW50Q29udGV4dCwgcHJvcGVydHksIGRhdGEpOwogIHBhdGhS
        b290ID0gbm9ybWFsaXplZC5yb290OwoKICAvLyBTZXQgdXAgb2JzZXJ2ZXJz
        IGZvciBvYnNlcnZhYmxlIG9iamVjdHMKICBpZiAocGF0aFJvb3QgJiYgKCdv
        YmplY3QnID09PSB0eXBlb2YgcGF0aFJvb3QpKSB7CiAgICBpZiAoZGF0YS5p
        bnNpZGVHcm91cCkgewogICAgICBvYnNlcnZlciA9IGZ1bmN0aW9uKCkgewog
        ICAgICAgIEVtYmVyLnJ1bi5vbmNlKHZpZXcsICdyZXJlbmRlcicpOwogICAg
        ICB9OwoKICAgICAgdmFyIHJlc3VsdCA9IGhhbmRsZWJhcnNHZXQoY3VycmVu
        dENvbnRleHQsIHByb3BlcnR5LCBvcHRpb25zKTsKICAgICAgaWYgKHJlc3Vs
        dCA9PT0gbnVsbCB8fCByZXN1bHQgPT09IHVuZGVmaW5lZCkgeyByZXN1bHQg
        PSAiIjsgfQogICAgICBkYXRhLmJ1ZmZlci5wdXNoKHJlc3VsdCk7CiAgICB9
        IGVsc2UgewogICAgICB2YXIgYmluZFZpZXcgPSBuZXcgRW1iZXIuX1NpbXBs
        ZUhhbmRsZWJhcnNWaWV3KAogICAgICAgIHByb3BlcnR5LCBjdXJyZW50Q29u
        dGV4dCwgIW9wdGlvbnMuaGFzaC51bmVzY2FwZWQsIG9wdGlvbnMuZGF0YQog
        ICAgICApOwoKICAgICAgYmluZFZpZXcuX3BhcmVudFZpZXcgPSB2aWV3Owog
        ICAgICB2aWV3LmFwcGVuZENoaWxkKGJpbmRWaWV3KTsKCiAgICAgIG9ic2Vy
        dmVyID0gZnVuY3Rpb24oKSB7CiAgICAgICAgRW1iZXIucnVuLnNjaGVkdWxl
        T25jZSgncmVuZGVyJywgYmluZFZpZXcsICdyZXJlbmRlcicpOwogICAgICB9
        OwogICAgfQoKICAgIC8vIE9ic2VydmVzIHRoZSBnaXZlbiBwcm9wZXJ0eSBv
        biB0aGUgY29udGV4dCBhbmQKICAgIC8vIHRlbGxzIHRoZSBFbWJlci5fSGFu
        ZGxlYmFyc0JvdW5kVmlldyB0byByZS1yZW5kZXIuIElmIHByb3BlcnR5CiAg
        ICAvLyBpcyBhbiBlbXB0eSBzdHJpbmcsIHdlIGFyZSBwcmludGluZyB0aGUg
        Y3VycmVudCBjb250ZXh0CiAgICAvLyBvYmplY3QgKHt7dGhpc319KSBzbyB1
        cGRhdGluZyBpdCBpcyBub3Qgb3VyIHJlc3BvbnNpYmlsaXR5LgogICAgaWYg
        KG5vcm1hbGl6ZWQucGF0aCAhPT0gJycpIHsKICAgICAgdmlldy5yZWdpc3Rl
        ck9ic2VydmVyKG5vcm1hbGl6ZWQucm9vdCwgbm9ybWFsaXplZC5wYXRoLCBv
        YnNlcnZlcik7CiAgICB9CiAgfSBlbHNlIHsKICAgIC8vIFRoZSBvYmplY3Qg
        aXMgbm90IG9ic2VydmFibGUsIHNvIGp1c3QgcmVuZGVyIGl0IG91dCBhbmQK
        ICAgIC8vIGJlIGRvbmUgd2l0aCBpdC4KICAgIG91dHB1dCA9IGhhbmRsZWJh
        cnNHZXQoY3VycmVudENvbnRleHQsIHByb3BlcnR5LCBvcHRpb25zKTsKICAg
        IGRhdGEuYnVmZmVyLnB1c2goKG91dHB1dCA9PT0gbnVsbCB8fCB0eXBlb2Yg
        b3V0cHV0ID09PSAndW5kZWZpbmVkJykgPyAnJyA6IG91dHB1dCk7CiAgfQp9
        CgovKioKICBAcHJpdmF0ZQoKICAnX3RyaWFnZU11c3RhY2hlJyBpcyB1c2Vk
        IGludGVybmFsbHkgc2VsZWN0IGJldHdlZW4gYSBiaW5kaW5nIGFuZCBoZWxw
        ZXIgZm9yCiAgdGhlIGdpdmVuIGNvbnRleHQuIFVudGlsIHRoaXMgcG9pbnQs
        IGl0IHdvdWxkIGJlIGhhcmQgdG8gZGV0ZXJtaW5lIGlmIHRoZQogIG11c3Rh
        Y2hlIGlzIGEgcHJvcGVydHkgcmVmZXJlbmNlIG9yIGEgcmVndWxhciBoZWxw
        ZXIgcmVmZXJlbmNlLiBUaGlzIHRyaWFnZQogIGhlbHBlciByZXNvbHZlcyB0
        aGF0LgoKICBUaGlzIHdvdWxkIG5vdCBiZSB0eXBpY2FsbHkgaW52b2tlZCBi
        eSBkaXJlY3RseS4KCiAgQG1ldGhvZCBfdHJpYWdlTXVzdGFjaGUKICBAZm9y
        IEVtYmVyLkhhbmRsZWJhcnMuaGVscGVycwogIEBwYXJhbSB7U3RyaW5nfSBw
        cm9wZXJ0eSBQcm9wZXJ0eS9oZWxwZXJJRCB0byB0cmlhZ2UKICBAcGFyYW0g
        e0Z1bmN0aW9ufSBmbiBDb250ZXh0IHRvIHByb3ZpZGUgZm9yIHJlbmRlcmlu
        ZwogIEByZXR1cm4ge1N0cmluZ30gSFRNTCBzdHJpbmcKKi8KRW1iZXJIYW5k
        bGViYXJzLnJlZ2lzdGVySGVscGVyKCdfdHJpYWdlTXVzdGFjaGUnLCBmdW5j
        dGlvbihwcm9wZXJ0eSwgZm4pIHsKICBFbWJlci5hc3NlcnQoIllvdSBjYW5u
        b3QgcGFzcyBtb3JlIHRoYW4gb25lIGFyZ3VtZW50IHRvIHRoZSBfdHJpYWdl
        TXVzdGFjaGUgaGVscGVyIiwgYXJndW1lbnRzLmxlbmd0aCA8PSAyKTsKICBp
        ZiAoaGVscGVyc1twcm9wZXJ0eV0pIHsKICAgIHJldHVybiBoZWxwZXJzW3By
        b3BlcnR5XS5jYWxsKHRoaXMsIGZuKTsKICB9CiAgZWxzZSB7CiAgICByZXR1
        cm4gaGVscGVycy5iaW5kLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgfQp9
        KTsKCi8qKgogIEBwcml2YXRlCgogIGBiaW5kYCBjYW4gYmUgdXNlZCB0byBk
        aXNwbGF5IGEgdmFsdWUsIHRoZW4gdXBkYXRlIHRoYXQgdmFsdWUgaWYgaXQK
        ICBjaGFuZ2VzLiBGb3IgZXhhbXBsZSwgaWYgeW91IHdhbnRlZCB0byBwcmlu
        dCB0aGUgYHRpdGxlYCBwcm9wZXJ0eSBvZgogIGBjb250ZW50YDoKCiAgYGBg
        aGFuZGxlYmFycwogIHt7YmluZCAiY29udGVudC50aXRsZSJ9fQogIGBgYAoK
        ICBUaGlzIHdpbGwgcmV0dXJuIHRoZSBgdGl0bGVgIHByb3BlcnR5IGFzIGEg
        c3RyaW5nLCB0aGVuIGNyZWF0ZSBhIG5ldyBvYnNlcnZlcgogIGF0IHRoZSBz
        cGVjaWZpZWQgcGF0aC4gSWYgaXQgY2hhbmdlcywgaXQgd2lsbCB1cGRhdGUg
        dGhlIHZhbHVlIGluIERPTS4gTm90ZQogIHRoYXQgaWYgeW91IG5lZWQgdG8g
        c3VwcG9ydCBJRTcgYW5kIElFOCB5b3UgbXVzdCBtb2RpZnkgdGhlIG1vZGVs
        IG9iamVjdHMKICBwcm9wZXJ0aWVzIHVzaW5nIGBFbWJlci5nZXQoKWAgYW5k
        IGBFbWJlci5zZXQoKWAgZm9yIHRoaXMgdG8gd29yayBhcyBpdAogIHJlbGll
        cyBvbiBFbWJlcidzIEtWTyBzeXN0ZW0uIEZvciBhbGwgb3RoZXIgYnJvd3Nl
        cnMgdGhpcyB3aWxsIGJlIGhhbmRsZWQgZm9yCiAgeW91IGF1dG9tYXRpY2Fs
        bHkuCgogIEBtZXRob2QgYmluZAogIEBmb3IgRW1iZXIuSGFuZGxlYmFycy5o
        ZWxwZXJzCiAgQHBhcmFtIHtTdHJpbmd9IHByb3BlcnR5IFByb3BlcnR5IHRv
        IGJpbmQKICBAcGFyYW0ge0Z1bmN0aW9ufSBmbiBDb250ZXh0IHRvIHByb3Zp
        ZGUgZm9yIHJlbmRlcmluZwogIEByZXR1cm4ge1N0cmluZ30gSFRNTCBzdHJp
        bmcKKi8KRW1iZXJIYW5kbGViYXJzLnJlZ2lzdGVySGVscGVyKCdiaW5kJywg
        ZnVuY3Rpb24ocHJvcGVydHksIG9wdGlvbnMpIHsKICBFbWJlci5hc3NlcnQo
        IllvdSBjYW5ub3QgcGFzcyBtb3JlIHRoYW4gb25lIGFyZ3VtZW50IHRvIHRo
        ZSBiaW5kIGhlbHBlciIsIGFyZ3VtZW50cy5sZW5ndGggPD0gMik7CgogIHZh
        ciBjb250ZXh0ID0gKG9wdGlvbnMuY29udGV4dHMgJiYgb3B0aW9ucy5jb250
        ZXh0cy5sZW5ndGgpID8gb3B0aW9ucy5jb250ZXh0c1swXSA6IHRoaXM7Cgog
        IGlmICghb3B0aW9ucy5mbikgewogICAgcmV0dXJuIHNpbXBsZUJpbmQoY29u
        dGV4dCwgcHJvcGVydHksIG9wdGlvbnMpOwogIH0KCiAgcmV0dXJuIGJpbmQu
        Y2FsbChjb250ZXh0LCBwcm9wZXJ0eSwgb3B0aW9ucywgZmFsc2UsIGV4aXN0
        cyk7Cn0pOwoKLyoqCiAgQHByaXZhdGUKCiAgVXNlIHRoZSBgYm91bmRJZmAg
        aGVscGVyIHRvIGNyZWF0ZSBhIGNvbmRpdGlvbmFsIHRoYXQgcmUtZXZhbHVh
        dGVzCiAgd2hlbmV2ZXIgdGhlIHRydXRoaW5lc3Mgb2YgdGhlIGJvdW5kIHZh
        bHVlIGNoYW5nZXMuCgogIGBgYGhhbmRsZWJhcnMKICB7eyNib3VuZElmICJj
        b250ZW50LnNob3VsZERpc3BsYXlUaXRsZSJ9fQogICAge3tjb250ZW50LnRp
        dGxlfX0KICB7ey9ib3VuZElmfX0KICBgYGAKCiAgQG1ldGhvZCBib3VuZElm
        CiAgQGZvciBFbWJlci5IYW5kbGViYXJzLmhlbHBlcnMKICBAcGFyYW0ge1N0
        cmluZ30gcHJvcGVydHkgUHJvcGVydHkgdG8gYmluZAogIEBwYXJhbSB7RnVu
        Y3Rpb259IGZuIENvbnRleHQgdG8gcHJvdmlkZSBmb3IgcmVuZGVyaW5nCiAg
        QHJldHVybiB7U3RyaW5nfSBIVE1MIHN0cmluZwoqLwpFbWJlckhhbmRsZWJh
        cnMucmVnaXN0ZXJIZWxwZXIoJ2JvdW5kSWYnLCBmdW5jdGlvbihwcm9wZXJ0
        eSwgZm4pIHsKICB2YXIgY29udGV4dCA9IChmbi5jb250ZXh0cyAmJiBmbi5j
        b250ZXh0cy5sZW5ndGgpID8gZm4uY29udGV4dHNbMF0gOiB0aGlzOwogIHZh
        ciBmdW5jID0gZnVuY3Rpb24ocmVzdWx0KSB7CiAgICB2YXIgdHJ1dGh5ID0g
        cmVzdWx0ICYmIGdldChyZXN1bHQsICdpc1RydXRoeScpOwogICAgaWYgKHR5
        cGVvZiB0cnV0aHkgPT09ICdib29sZWFuJykgeyByZXR1cm4gdHJ1dGh5OyB9
        CgogICAgaWYgKEVtYmVyLmlzQXJyYXkocmVzdWx0KSkgewogICAgICByZXR1
        cm4gZ2V0KHJlc3VsdCwgJ2xlbmd0aCcpICE9PSAwOwogICAgfSBlbHNlIHsK
        ICAgICAgcmV0dXJuICEhcmVzdWx0OwogICAgfQogIH07CgogIHJldHVybiBi
        aW5kLmNhbGwoY29udGV4dCwgcHJvcGVydHksIGZuLCB0cnVlLCBmdW5jLCBm
        dW5jLCBbJ2lzVHJ1dGh5JywgJ2xlbmd0aCddKTsKfSk7CgovKioKICBAbWV0
        aG9kIHdpdGgKICBAZm9yIEVtYmVyLkhhbmRsZWJhcnMuaGVscGVycwogIEBw
        YXJhbSB7RnVuY3Rpb259IGNvbnRleHQKICBAcGFyYW0ge0hhc2h9IG9wdGlv
        bnMKICBAcmV0dXJuIHtTdHJpbmd9IEhUTUwgc3RyaW5nCiovCkVtYmVySGFu
        ZGxlYmFycy5yZWdpc3RlckhlbHBlcignd2l0aCcsIGZ1bmN0aW9uKGNvbnRl
        eHQsIG9wdGlvbnMpIHsKICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gNCkg
        ewogICAgdmFyIGtleXdvcmROYW1lLCBwYXRoLCByb290UGF0aCwgbm9ybWFs
        aXplZDsKCiAgICBFbWJlci5hc3NlcnQoIklmIHlvdSBwYXNzIG1vcmUgdGhh
        biBvbmUgYXJndW1lbnQgdG8gdGhlIHdpdGggaGVscGVyLCBpdCBtdXN0IGJl
        IGluIHRoZSBmb3JtICN3aXRoIGZvbyBhcyBiYXIiLCBhcmd1bWVudHNbMV0g
        PT09ICJhcyIpOwogICAgb3B0aW9ucyA9IGFyZ3VtZW50c1szXTsKICAgIGtl
        eXdvcmROYW1lID0gYXJndW1lbnRzWzJdOwogICAgcGF0aCA9IGFyZ3VtZW50
        c1swXTsKCiAgICBFbWJlci5hc3NlcnQoIllvdSBtdXN0IHBhc3MgYSBibG9j
        ayB0byB0aGUgd2l0aCBoZWxwZXIiLCBvcHRpb25zLmZuICYmIG9wdGlvbnMu
        Zm4gIT09IEhhbmRsZWJhcnMuVk0ubm9vcCk7CgogICAgaWYgKEVtYmVyLmlz
        R2xvYmFsUGF0aChwYXRoKSkgewogICAgICBFbWJlci5iaW5kKG9wdGlvbnMu
        ZGF0YS5rZXl3b3Jkcywga2V5d29yZE5hbWUsIHBhdGgpOwogICAgfSBlbHNl
        IHsKICAgICAgbm9ybWFsaXplZCA9IG5vcm1hbGl6ZVBhdGgodGhpcywgcGF0
        aCwgb3B0aW9ucy5kYXRhKTsKICAgICAgcGF0aCA9IG5vcm1hbGl6ZWQucGF0
        aDsKICAgICAgcm9vdFBhdGggPSBub3JtYWxpemVkLnJvb3Q7CgogICAgICAv
        LyBUaGlzIGlzIGEgd29ya2Fyb3VuZCBmb3IgdGhlIGZhY3QgdGhhdCB5b3Ug
        Y2Fubm90IGJpbmQgc2VwYXJhdGUgb2JqZWN0cwogICAgICAvLyB0b2dldGhl
        ci4gV2hlbiB3ZSBpbXBsZW1lbnQgdGhhdCBmdW5jdGlvbmFsaXR5LCB3ZSBz
        aG91bGQgdXNlIGl0IGhlcmUuCiAgICAgIHZhciBjb250ZXh0S2V5ID0gRW1i
        ZXIuJC5leHBhbmRvICsgRW1iZXIuZ3VpZEZvcihyb290UGF0aCk7CiAgICAg
        IG9wdGlvbnMuZGF0YS5rZXl3b3Jkc1tjb250ZXh0S2V5XSA9IHJvb3RQYXRo
        OwoKICAgICAgLy8gaWYgdGhlIHBhdGggaXMgJycgKCJ0aGlzIiksIGp1c3Qg
        YmluZCBkaXJlY3RseSB0byB0aGUgY3VycmVudCBjb250ZXh0CiAgICAgIHZh
        ciBjb250ZXh0UGF0aCA9IHBhdGggPyBjb250ZXh0S2V5ICsgJy4nICsgcGF0
        aCA6IGNvbnRleHRLZXk7CiAgICAgIEVtYmVyLmJpbmQob3B0aW9ucy5kYXRh
        LmtleXdvcmRzLCBrZXl3b3JkTmFtZSwgY29udGV4dFBhdGgpOwogICAgfQoK
        ICAgIHJldHVybiBiaW5kLmNhbGwodGhpcywgcGF0aCwgb3B0aW9ucywgdHJ1
        ZSwgZXhpc3RzKTsKICB9IGVsc2UgewogICAgRW1iZXIuYXNzZXJ0KCJZb3Ug
        bXVzdCBwYXNzIGV4YWN0bHkgb25lIGFyZ3VtZW50IHRvIHRoZSB3aXRoIGhl
        bHBlciIsIGFyZ3VtZW50cy5sZW5ndGggPT09IDIpOwogICAgRW1iZXIuYXNz
        ZXJ0KCJZb3UgbXVzdCBwYXNzIGEgYmxvY2sgdG8gdGhlIHdpdGggaGVscGVy
        Iiwgb3B0aW9ucy5mbiAmJiBvcHRpb25zLmZuICE9PSBIYW5kbGViYXJzLlZN
        Lm5vb3ApOwogICAgcmV0dXJuIGhlbHBlcnMuYmluZC5jYWxsKG9wdGlvbnMu
        Y29udGV4dHNbMF0sIGNvbnRleHQsIG9wdGlvbnMpOwogIH0KfSk7CgoKLyoq
        CiAgU2VlIFtib3VuZElmXSgvYXBpL2NsYXNzZXMvRW1iZXIuSGFuZGxlYmFy
        cy5oZWxwZXJzLmh0bWwjbWV0aG9kX2JvdW5kSWYpCgogIEBtZXRob2QgaWYK
        ICBAZm9yIEVtYmVyLkhhbmRsZWJhcnMuaGVscGVycwogIEBwYXJhbSB7RnVu
        Y3Rpb259IGNvbnRleHQKICBAcGFyYW0ge0hhc2h9IG9wdGlvbnMKICBAcmV0
        dXJuIHtTdHJpbmd9IEhUTUwgc3RyaW5nCiovCkVtYmVySGFuZGxlYmFycy5y
        ZWdpc3RlckhlbHBlcignaWYnLCBmdW5jdGlvbihjb250ZXh0LCBvcHRpb25z
        KSB7CiAgRW1iZXIuYXNzZXJ0KCJZb3UgbXVzdCBwYXNzIGV4YWN0bHkgb25l
        IGFyZ3VtZW50IHRvIHRoZSBpZiBoZWxwZXIiLCBhcmd1bWVudHMubGVuZ3Ro
        ID09PSAyKTsKICBFbWJlci5hc3NlcnQoIllvdSBtdXN0IHBhc3MgYSBibG9j
        ayB0byB0aGUgaWYgaGVscGVyIiwgb3B0aW9ucy5mbiAmJiBvcHRpb25zLmZu
        ICE9PSBIYW5kbGViYXJzLlZNLm5vb3ApOwoKICByZXR1cm4gaGVscGVycy5i
        b3VuZElmLmNhbGwob3B0aW9ucy5jb250ZXh0c1swXSwgY29udGV4dCwgb3B0
        aW9ucyk7Cn0pOwoKLyoqCiAgQG1ldGhvZCB1bmxlc3MKICBAZm9yIEVtYmVy
        LkhhbmRsZWJhcnMuaGVscGVycwogIEBwYXJhbSB7RnVuY3Rpb259IGNvbnRl
        eHQKICBAcGFyYW0ge0hhc2h9IG9wdGlvbnMKICBAcmV0dXJuIHtTdHJpbmd9
        IEhUTUwgc3RyaW5nCiovCkVtYmVySGFuZGxlYmFycy5yZWdpc3RlckhlbHBl
        cigndW5sZXNzJywgZnVuY3Rpb24oY29udGV4dCwgb3B0aW9ucykgewogIEVt
        YmVyLmFzc2VydCgiWW91IG11c3QgcGFzcyBleGFjdGx5IG9uZSBhcmd1bWVu
        dCB0byB0aGUgdW5sZXNzIGhlbHBlciIsIGFyZ3VtZW50cy5sZW5ndGggPT09
        IDIpOwogIEVtYmVyLmFzc2VydCgiWW91IG11c3QgcGFzcyBhIGJsb2NrIHRv
        IHRoZSB1bmxlc3MgaGVscGVyIiwgb3B0aW9ucy5mbiAmJiBvcHRpb25zLmZu
        ICE9PSBIYW5kbGViYXJzLlZNLm5vb3ApOwoKICB2YXIgZm4gPSBvcHRpb25z
        LmZuLCBpbnZlcnNlID0gb3B0aW9ucy5pbnZlcnNlOwoKICBvcHRpb25zLmZu
        ID0gaW52ZXJzZTsKICBvcHRpb25zLmludmVyc2UgPSBmbjsKCiAgcmV0dXJu
        IGhlbHBlcnMuYm91bmRJZi5jYWxsKG9wdGlvbnMuY29udGV4dHNbMF0sIGNv
        bnRleHQsIG9wdGlvbnMpOwp9KTsKCi8qKgogIGBiaW5kLWF0dHJgIGFsbG93
        cyB5b3UgdG8gY3JlYXRlIGEgYmluZGluZyBiZXR3ZWVuIERPTSBlbGVtZW50
        IGF0dHJpYnV0ZXMgYW5kCiAgRW1iZXIgb2JqZWN0cy4gRm9yIGV4YW1wbGU6
        CgogIGBgYGhhbmRsZWJhcnMKICA8aW1nIHt7YmluZC1hdHRyIHNyYz0iaW1h
        Z2VVcmwiIGFsdD0iaW1hZ2VUaXRsZSJ9fT4KICBgYGAKCiAgVGhlIGFib3Zl
        IGhhbmRsZWJhcnMgdGVtcGxhdGUgd2lsbCBmaWxsIHRoZSBgPGltZz5gJ3Mg
        YHNyY2AgYXR0cmlidXRlIHdpbGwKICB0aGUgdmFsdWUgb2YgdGhlIHByb3Bl
        cnR5IHJlZmVyZW5jZWQgd2l0aCBgImltYWdlVXJsImAgYW5kIGl0cyBgYWx0
        YAogIGF0dHJpYnV0ZSB3aXRoIHRoZSB2YWx1ZSBvZiB0aGUgcHJvcGVydHkg
        cmVmZXJlbmNlZCB3aXRoIGAiaW1hZ2VUaXRsZSJgLgoKICBJZiB0aGUgcmVu
        ZGVyaW5nIGNvbnRleHQgb2YgdGhpcyB0ZW1wbGF0ZSBpcyB0aGUgZm9sbG93
        aW5nIG9iamVjdDoKCiAgYGBgamF2YXNjcmlwdAogIHsKICAgIGltYWdlVXJs
        OiAnaHR0cDovL2xvbGNhdHMuaW5mby9oYXotYS1mdW5ueScsCiAgICBpbWFn
        ZVRpdGxlOiAnQSBodW1vcm91cyBpbWFnZSBvZiBhIGNhdCcKICB9CiAgYGBg
        CgogIFRoZSByZXN1bHRpbmcgSFRNTCBvdXRwdXQgd2lsbCBiZToKCiAgYGBg
        aHRtbAogIDxpbWcgc3JjPSJodHRwOi8vbG9sY2F0cy5pbmZvL2hhei1hLWZ1
        bm55IiBhbHQ9IkEgaHVtb3JvdXMgaW1hZ2Ugb2YgYSBjYXQiPgogIGBgYAoK
        ICBgYmluZC1hdHRyYCBjYW5ub3QgcmVkZWNsYXJlIGV4aXN0aW5nIERPTSBl
        bGVtZW50IGF0dHJpYnV0ZXMuIFRoZSB1c2Ugb2YgYHNyY2AKICBpbiB0aGUg
        Zm9sbG93aW5nIGBiaW5kLWF0dHJgIGV4YW1wbGUgd2lsbCBiZSBpZ25vcmVk
        IGFuZCB0aGUgaGFyZCBjb2RlZCB2YWx1ZQogIG9mIGBzcmM9Ii9mYWlsd2hh
        bGUuZ2lmImAgd2lsbCB0YWtlIHByZWNlZGVuY2U6CgogIGBgYGhhbmRsZWJh
        cnMKICA8aW1nIHNyYz0iL2ZhaWx3aGFsZS5naWYiIHt7YmluZC1hdHRyIHNy
        Yz0iaW1hZ2VVcmwiIGFsdD0iaW1hZ2VUaXRsZSJ9fT4KICBgYGAKCiAgIyMj
        IGBiaW5kLWF0dHJgIGFuZCB0aGUgYGNsYXNzYCBhdHRyaWJ1dGUKCiAgYGJp
        bmQtYXR0cmAgc3VwcG9ydHMgYSBzcGVjaWFsIHN5bnRheCBmb3IgaGFuZGxp
        bmcgYSBudW1iZXIgb2YgY2FzZXMgdW5pcXVlCiAgdG8gdGhlIGBjbGFzc2Ag
        RE9NIGVsZW1lbnQgYXR0cmlidXRlLiBUaGUgYGNsYXNzYCBhdHRyaWJ1dGUg
        Y29tYmluZXMKICBtdWx0aXBsZSBkaXNjcmVldCB2YWx1ZXMgaW50byBhIHNp
        bmdsZSBhdHRyaWJ1dGUgYXMgYSBzcGFjZS1kZWxpbWl0ZWQKICBsaXN0IG9m
        IHN0cmluZ3MuIEVhY2ggc3RyaW5nIGNhbiBiZToKCiAgKiBhIHN0cmluZyBy
        ZXR1cm4gdmFsdWUgb2YgYW4gb2JqZWN0J3MgcHJvcGVydHkuCiAgKiBhIGJv
        b2xlYW4gcmV0dXJuIHZhbHVlIG9mIGFuIG9iamVjdCdzIHByb3BlcnR5CiAg
        KiBhIGhhcmQtY29kZWQgdmFsdWUKCiAgQSBzdHJpbmcgcmV0dXJuIHZhbHVl
        IHdvcmtzIGlkZW50aWNhbGx5IHRvIG90aGVyIHVzZXMgb2YgYGJpbmQtYXR0
        cmAuIFRoZQogIHJldHVybiB2YWx1ZSBvZiB0aGUgcHJvcGVydHkgd2lsbCBi
        ZWNvbWUgdGhlIHZhbHVlIG9mIHRoZSBhdHRyaWJ1dGUuIEZvcgogIGV4YW1w
        bGUsIHRoZSBmb2xsb3dpbmcgdmlldyBhbmQgdGVtcGxhdGU6CgogIGBgYGph
        dmFzY3JpcHQKICAgIEFWaWV3ID0gRW1iZXIuVmlldy5leHRlbmQoewogICAg
        ICBzb21lUHJvcGVydHk6IGZ1bmN0aW9uKCkgewogICAgICAgIHJldHVybiAi
        YVZhbHVlIjsKICAgICAgfS5wcm9wZXJ0eSgpCiAgICB9KQogIGBgYAoKICBg
        YGBoYW5kbGViYXJzCiAgPGltZyB7e2JpbmQtYXR0ciBjbGFzcz0idmlldy5z
        b21lUHJvcGVydHl9fT4KICBgYGAKCiAgUmVzdWx0IGluIHRoZSBmb2xsb3dp
        bmcgcmVuZGVyZWQgb3V0cHV0OgoKICBgYGBodG1sCiAgPGltZyBjbGFzcz0i
        YVZhbHVlIj4KICBgYGAKCiAgQSBib29sZWFuIHJldHVybiB2YWx1ZSB3aWxs
        IGluc2VydCBhIHNwZWNpZmllZCBjbGFzcyBuYW1lIGlmIHRoZSBwcm9wZXJ0
        eQogIHJldHVybnMgYHRydWVgIGFuZCByZW1vdmUgdGhlIGNsYXNzIG5hbWUg
        aWYgdGhlIHByb3BlcnR5IHJldHVybnMgYGZhbHNlYC4KCiAgQSBjbGFzcyBu
        YW1lIGlzIHByb3ZpZGVkIHZpYSB0aGUgc3ludGF4CiAgYHNvbWVQcm9wZXJ0
        eU5hbWU6Y2xhc3MtbmFtZS1pZi10cnVlYC4KCiAgYGBgamF2YXNjcmlwdAog
        IEFWaWV3ID0gRW1iZXIuVmlldy5leHRlbmQoewogICAgc29tZUJvb2w6IHRy
        dWUKICB9KQogIGBgYAoKICBgYGBoYW5kbGViYXJzCiAgPGltZyB7e2JpbmQt
        YXR0ciBjbGFzcz0idmlldy5zb21lQm9vbDpjbGFzcy1uYW1lLWlmLXRydWUi
        fX0+CiAgYGBgCgogIFJlc3VsdCBpbiB0aGUgZm9sbG93aW5nIHJlbmRlcmVk
        IG91dHB1dDoKCiAgYGBgaHRtbAogIDxpbWcgY2xhc3M9ImNsYXNzLW5hbWUt
        aWYtdHJ1ZSI+CiAgYGBgCgogIEFuIGFkZGl0aW9uYWwgc2VjdGlvbiBvZiB0
        aGUgYmluZGluZyBjYW4gYmUgcHJvdmlkZWQgaWYgeW91IHdhbnQgdG8KICBy
        ZXBsYWNlIHRoZSBleGlzdGluZyBjbGFzcyBpbnN0ZWFkIG9mIHJlbW92aW5n
        IGl0IHdoZW4gdGhlIGJvb2xlYW4KICB2YWx1ZSBjaGFuZ2VzOgoKICBgYGBo
        YW5kbGViYXJzCiAgPGltZyB7e2JpbmQtYXR0ciBjbGFzcz0idmlldy5zb21l
        Qm9vbDpjbGFzcy1uYW1lLWlmLXRydWU6Y2xhc3MtbmFtZS1pZi1mYWxzZSJ9
        fT4KICBgYGAKCiAgQSBoYXJkLWNvZGVkIHZhbHVlIGNhbiBiZSB1c2VkIGJ5
        IHByZXBlbmRpbmcgYDpgIHRvIHRoZSBkZXNpcmVkCiAgY2xhc3MgbmFtZTog
        YDpjbGFzcy1uYW1lLXRvLWFsd2F5cy1hcHBseWAuCgogIGBgYGhhbmRsZWJh
        cnMKICA8aW1nIHt7YmluZC1hdHRyIGNsYXNzPSI6Y2xhc3MtbmFtZS10by1h
        bHdheXMtYXBwbHkifX0+CiAgYGBgCgogIFJlc3VsdHMgaW4gdGhlIGZvbGxv
        d2luZyByZW5kZXJlZCBvdXRwdXQ6CgogIGBgYGh0bWwKICA8aW1nIGNsYXNz
        PSJjbGFzcy1uYW1lLXRvLWFsd2F5cy1hcHBseSI+CiAgYGBgCgogIEFsbCB0
        aHJlZSBzdHJhdGVnaWVzIC0gc3RyaW5nIHJldHVybiB2YWx1ZSwgYm9vbGVh
        biByZXR1cm4gdmFsdWUsIGFuZAogIGhhcmQtY29kZWQgdmFsdWUg4oCTIGNh
        biBiZSBjb21iaW5lZCBpbiBhIHNpbmdsZSBkZWNsYXJhdGlvbjoKCiAgYGBg
        aGFuZGxlYmFycwogIDxpbWcge3tiaW5kLWF0dHIgY2xhc3M9IjpjbGFzcy1u
        YW1lLXRvLWFsd2F5cy1hcHBseSB2aWV3LnNvbWVCb29sOmNsYXNzLW5hbWUt
        aWYtdHJ1ZSB2aWV3LnNvbWVQcm9wZXJ0eSJ9fT4KICBgYGAKCiAgQG1ldGhv
        ZCBiaW5kLWF0dHIKICBAZm9yIEVtYmVyLkhhbmRsZWJhcnMuaGVscGVycwog
        IEBwYXJhbSB7SGFzaH0gb3B0aW9ucwogIEByZXR1cm4ge1N0cmluZ30gSFRN
        TCBzdHJpbmcKKi8KRW1iZXJIYW5kbGViYXJzLnJlZ2lzdGVySGVscGVyKCdi
        aW5kLWF0dHInLCBmdW5jdGlvbihvcHRpb25zKSB7CgogIHZhciBhdHRycyA9
        IG9wdGlvbnMuaGFzaDsKCiAgRW1iZXIuYXNzZXJ0KCJZb3UgbXVzdCBzcGVj
        aWZ5IGF0IGxlYXN0IG9uZSBoYXNoIGFyZ3VtZW50IHRvIGJpbmQtYXR0ciIs
        ICEhRW1iZXIua2V5cyhhdHRycykubGVuZ3RoKTsKCiAgdmFyIHZpZXcgPSBv
        cHRpb25zLmRhdGEudmlldzsKICB2YXIgcmV0ID0gW107CiAgdmFyIGN0eCA9
        IHRoaXM7CgogIC8vIEdlbmVyYXRlIGEgdW5pcXVlIGlkIGZvciB0aGlzIGVs
        ZW1lbnQuIFRoaXMgd2lsbCBiZSBhZGRlZCBhcyBhCiAgLy8gZGF0YSBhdHRy
        aWJ1dGUgdG8gdGhlIGVsZW1lbnQgc28gaXQgY2FuIGJlIGxvb2tlZCB1cCB3
        aGVuCiAgLy8gdGhlIGJvdW5kIHByb3BlcnR5IGNoYW5nZXMuCiAgdmFyIGRh
        dGFJZCA9ICsrRW1iZXIudXVpZDsKCiAgLy8gSGFuZGxlIGNsYXNzZXMgZGlm
        ZmVyZW50bHksIGFzIHdlIGNhbiBiaW5kIG11bHRpcGxlIGNsYXNzZXMKICB2
        YXIgY2xhc3NCaW5kaW5ncyA9IGF0dHJzWydjbGFzcyddOwogIGlmIChjbGFz
        c0JpbmRpbmdzICE9IG51bGwpIHsKICAgIHZhciBjbGFzc1Jlc3VsdHMgPSBF
        bWJlckhhbmRsZWJhcnMuYmluZENsYXNzZXModGhpcywgY2xhc3NCaW5kaW5n
        cywgdmlldywgZGF0YUlkLCBvcHRpb25zKTsKCiAgICByZXQucHVzaCgnY2xh
        c3M9IicgKyBIYW5kbGViYXJzLlV0aWxzLmVzY2FwZUV4cHJlc3Npb24oY2xh
        c3NSZXN1bHRzLmpvaW4oJyAnKSkgKyAnIicpOwogICAgZGVsZXRlIGF0dHJz
        WydjbGFzcyddOwogIH0KCiAgdmFyIGF0dHJLZXlzID0gRW1iZXIua2V5cyhh
        dHRycyk7CgogIC8vIEZvciBlYWNoIGF0dHJpYnV0ZSBwYXNzZWQsIGNyZWF0
        ZSBhbiBvYnNlcnZlciBhbmQgZW1pdCB0aGUKICAvLyBjdXJyZW50IHZhbHVl
        IG9mIHRoZSBwcm9wZXJ0eSBhcyBhbiBhdHRyaWJ1dGUuCiAgZm9yRWFjaC5j
        YWxsKGF0dHJLZXlzLCBmdW5jdGlvbihhdHRyKSB7CiAgICB2YXIgcGF0aCA9
        IGF0dHJzW2F0dHJdLAogICAgICAgIG5vcm1hbGl6ZWQ7CgogICAgRW1iZXIu
        YXNzZXJ0KGZtdCgiWW91IG11c3QgcHJvdmlkZSBhbiBleHByZXNzaW9uIGFz
        IHRoZSB2YWx1ZSBvZiBib3VuZCBhdHRyaWJ1dGUuIFlvdSBzcGVjaWZpZWQ6
        ICVAPSVAIiwgW2F0dHIsIHBhdGhdKSwgdHlwZW9mIHBhdGggPT09ICdzdHJp
        bmcnKTsKCiAgICBub3JtYWxpemVkID0gbm9ybWFsaXplUGF0aChjdHgsIHBh
        dGgsIG9wdGlvbnMuZGF0YSk7CgogICAgdmFyIHZhbHVlID0gKHBhdGggPT09
        ICd0aGlzJykgPyBub3JtYWxpemVkLnJvb3QgOiBoYW5kbGViYXJzR2V0KGN0
        eCwgcGF0aCwgb3B0aW9ucyksCiAgICAgICAgdHlwZSA9IEVtYmVyLnR5cGVP
        Zih2YWx1ZSk7CgogICAgRW1iZXIuYXNzZXJ0KGZtdCgiQXR0cmlidXRlcyBt
        dXN0IGJlIG51bWJlcnMsIHN0cmluZ3Mgb3IgYm9vbGVhbnMsIG5vdCAlQCIs
        IFt2YWx1ZV0pLCB2YWx1ZSA9PT0gbnVsbCB8fCB2YWx1ZSA9PT0gdW5kZWZp
        bmVkIHx8IHR5cGUgPT09ICdudW1iZXInIHx8IHR5cGUgPT09ICdzdHJpbmcn
        IHx8IHR5cGUgPT09ICdib29sZWFuJyk7CgogICAgdmFyIG9ic2VydmVyLCBp
        bnZva2VyOwoKICAgIG9ic2VydmVyID0gZnVuY3Rpb24gb2JzZXJ2ZXIoKSB7
        CiAgICAgIHZhciByZXN1bHQgPSBoYW5kbGViYXJzR2V0KGN0eCwgcGF0aCwg
        b3B0aW9ucyk7CgogICAgICBFbWJlci5hc3NlcnQoZm10KCJBdHRyaWJ1dGVz
        IG11c3QgYmUgbnVtYmVycywgc3RyaW5ncyBvciBib29sZWFucywgbm90ICVA
        IiwgW3Jlc3VsdF0pLCByZXN1bHQgPT09IG51bGwgfHwgcmVzdWx0ID09PSB1
        bmRlZmluZWQgfHwgdHlwZW9mIHJlc3VsdCA9PT0gJ251bWJlcicgfHwgdHlw
        ZW9mIHJlc3VsdCA9PT0gJ3N0cmluZycgfHwgdHlwZW9mIHJlc3VsdCA9PT0g
        J2Jvb2xlYW4nKTsKCiAgICAgIHZhciBlbGVtID0gdmlldy4kKCJbZGF0YS1i
        aW5kYXR0ci0iICsgZGF0YUlkICsgIj0nIiArIGRhdGFJZCArICInXSIpOwoK
        ICAgICAgLy8gSWYgd2UgYXJlbid0IGFibGUgdG8gZmluZCB0aGUgZWxlbWVu
        dCwgaXQgbWVhbnMgdGhlIGVsZW1lbnQKICAgICAgLy8gdG8gd2hpY2ggd2Ug
        d2VyZSBib3VuZCBoYXMgYmVlbiByZW1vdmVkIGZyb20gdGhlIHZpZXcuCiAg
        ICAgIC8vIEluIHRoYXQgY2FzZSwgd2UgY2FuIGFzc3VtZSB0aGUgdGVtcGxh
        dGUgaGFzIGJlZW4gcmUtcmVuZGVyZWQKICAgICAgLy8gYW5kIHdlIG5lZWQg
        dG8gY2xlYW4gdXAgdGhlIG9ic2VydmVyLgogICAgICBpZiAoIWVsZW0gfHwg
        ZWxlbS5sZW5ndGggPT09IDApIHsKICAgICAgICBFbWJlci5yZW1vdmVPYnNl
        cnZlcihub3JtYWxpemVkLnJvb3QsIG5vcm1hbGl6ZWQucGF0aCwgaW52b2tl
        cik7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBFbWJlci5WaWV3
        LmFwcGx5QXR0cmlidXRlQmluZGluZ3MoZWxlbSwgYXR0ciwgcmVzdWx0KTsK
        ICAgIH07CgogICAgLy8gQWRkIGFuIG9ic2VydmVyIHRvIHRoZSB2aWV3IGZv
        ciB3aGVuIHRoZSBwcm9wZXJ0eSBjaGFuZ2VzLgogICAgLy8gV2hlbiB0aGUg
        b2JzZXJ2ZXIgZmlyZXMsIGZpbmQgdGhlIGVsZW1lbnQgdXNpbmcgdGhlCiAg
        ICAvLyB1bmlxdWUgZGF0YSBpZCBhbmQgdXBkYXRlIHRoZSBhdHRyaWJ1dGUg
        dG8gdGhlIG5ldyB2YWx1ZS4KICAgIC8vIE5vdGU6IGRvbid0IGFkZCBvYnNl
        cnZlciB3aGVuIHBhdGggaXMgJ3RoaXMnIG9yIHBhdGgKICAgIC8vIGlzIHdo
        b2xlIGtleXdvcmQgZS5nLiB7eyNlYWNoIHggaW4gbGlzdH19IC4uLiB7e2Jp
        bmQtYXR0ciBhdHRyPSJ4In19CiAgICBpZiAocGF0aCAhPT0gJ3RoaXMnICYm
        ICEobm9ybWFsaXplZC5pc0tleXdvcmQgJiYgbm9ybWFsaXplZC5wYXRoID09
        PSAnJyApKSB7CiAgICAgIHZpZXcucmVnaXN0ZXJPYnNlcnZlcihub3JtYWxp
        emVkLnJvb3QsIG5vcm1hbGl6ZWQucGF0aCwgb2JzZXJ2ZXIpOwogICAgfQoK
        ICAgIC8vIGlmIHRoaXMgY2hhbmdlcywgYWxzbyBjaGFuZ2UgdGhlIGxvZ2lj
        IGluIGVtYmVyLXZpZXdzL2xpYi92aWV3cy92aWV3LmpzCiAgICBpZiAoKHR5
        cGUgPT09ICdzdHJpbmcnIHx8ICh0eXBlID09PSAnbnVtYmVyJyAmJiAhaXNO
        YU4odmFsdWUpKSkpIHsKICAgICAgcmV0LnB1c2goYXR0ciArICc9IicgKyBI
        YW5kbGViYXJzLlV0aWxzLmVzY2FwZUV4cHJlc3Npb24odmFsdWUpICsgJyIn
        KTsKICAgIH0gZWxzZSBpZiAodmFsdWUgJiYgdHlwZSA9PT0gJ2Jvb2xlYW4n
        KSB7CiAgICAgIC8vIFRoZSBkZXZlbG9wZXIgY29udHJvbHMgdGhlIGF0dHIg
        bmFtZSwgc28gaXQgc2hvdWxkIGFsd2F5cyBiZSBzYWZlCiAgICAgIHJldC5w
        dXNoKGF0dHIgKyAnPSInICsgYXR0ciArICciJyk7CiAgICB9CiAgfSwgdGhp
        cyk7CgogIC8vIEFkZCB0aGUgdW5pcXVlIGlkZW50aWZpZXIKICAvLyBOT1RF
        OiBXZSB1c2UgYWxsIGxvd2VyLWNhc2Ugc2luY2UgRmlyZWZveCBoYXMgcHJv
        YmxlbXMgd2l0aCBtaXhlZCBjYXNlIGluIFNWRwogIHJldC5wdXNoKCdkYXRh
        LWJpbmRhdHRyLScgKyBkYXRhSWQgKyAnPSInICsgZGF0YUlkICsgJyInKTsK
        ICByZXR1cm4gbmV3IEVtYmVySGFuZGxlYmFycy5TYWZlU3RyaW5nKHJldC5q
        b2luKCcgJykpOwp9KTsKCi8qKgogIFNlZSBgYmluZC1hdHRyYAoKICBAbWV0
        aG9kIGJpbmRBdHRyCiAgQGZvciBFbWJlci5IYW5kbGViYXJzLmhlbHBlcnMK
        ICBAZGVwcmVjYXRlZAogIEBwYXJhbSB7RnVuY3Rpb259IGNvbnRleHQKICBA
        cGFyYW0ge0hhc2h9IG9wdGlvbnMKICBAcmV0dXJuIHtTdHJpbmd9IEhUTUwg
        c3RyaW5nCiovCkVtYmVySGFuZGxlYmFycy5yZWdpc3RlckhlbHBlcignYmlu
        ZEF0dHInLCBFbWJlckhhbmRsZWJhcnMuaGVscGVyc1snYmluZC1hdHRyJ10p
        OwoKLyoqCiAgQHByaXZhdGUKCiAgSGVscGVyIHRoYXQsIGdpdmVuIGEgc3Bh
        Y2Utc2VwYXJhdGVkIHN0cmluZyBvZiBwcm9wZXJ0eSBwYXRocyBhbmQgYSBj
        b250ZXh0LAogIHJldHVybnMgYW4gYXJyYXkgb2YgY2xhc3MgbmFtZXMuIENh
        bGxpbmcgdGhpcyBtZXRob2QgYWxzbyBoYXMgdGhlIHNpZGUKICBlZmZlY3Qg
        b2Ygc2V0dGluZyB1cCBvYnNlcnZlcnMgYXQgdGhvc2UgcHJvcGVydHkgcGF0
        aHMsIHN1Y2ggdGhhdCBpZiB0aGV5CiAgY2hhbmdlLCB0aGUgY29ycmVjdCBj
        bGFzcyBuYW1lIHdpbGwgYmUgcmVhcHBsaWVkIHRvIHRoZSBET00gZWxlbWVu
        dC4KCiAgRm9yIGV4YW1wbGUsIGlmIHlvdSBwYXNzIHRoZSBzdHJpbmcgImZv
        b0JhciIsIGl0IHdpbGwgZmlyc3QgbG9vayB1cCB0aGUKICAiZm9vQmFyIiB2
        YWx1ZSBvZiB0aGUgY29udGV4dC4gSWYgdGhhdCB2YWx1ZSBpcyB0cnVlLCBp
        dCB3aWxsIGFkZCB0aGUKICAiZm9vLWJhciIgY2xhc3MgdG8gdGhlIGN1cnJl
        bnQgZWxlbWVudCAoaS5lLiwgdGhlIGRhc2hlcml6ZWQgZm9ybSBvZgogICJm
        b29CYXIiKS4gSWYgdGhlIHZhbHVlIGlzIGEgc3RyaW5nLCBpdCB3aWxsIGFk
        ZCB0aGF0IHN0cmluZyBhcyB0aGUgY2xhc3MuCiAgT3RoZXJ3aXNlLCBpdCB3
        aWxsIG5vdCBhZGQgYW55IG5ldyBjbGFzcyBuYW1lLgoKICBAbWV0aG9kIGJp
        bmRDbGFzc2VzCiAgQGZvciBFbWJlci5IYW5kbGViYXJzCiAgQHBhcmFtIHtF
        bWJlci5PYmplY3R9IGNvbnRleHQgVGhlIGNvbnRleHQgZnJvbSB3aGljaCB0
        byBsb29rdXAgcHJvcGVydGllcwogIEBwYXJhbSB7U3RyaW5nfSBjbGFzc0Jp
        bmRpbmdzIEEgc3RyaW5nLCBzcGFjZS1zZXBhcmF0ZWQsIG9mIGNsYXNzIGJp
        bmRpbmdzCiAgICB0byB1c2UKICBAcGFyYW0ge0VtYmVyLlZpZXd9IHZpZXcg
        VGhlIHZpZXcgaW4gd2hpY2ggb2JzZXJ2ZXJzIHNob3VsZCBsb29rIGZvciB0
        aGUKICAgIGVsZW1lbnQgdG8gdXBkYXRlCiAgQHBhcmFtIHtTcnRpbmd9IGJp
        bmRBdHRySWQgT3B0aW9uYWwgYmluZEF0dHIgaWQgdXNlZCB0byBsb29rdXAg
        ZWxlbWVudHMKICBAcmV0dXJuIHtBcnJheX0gQW4gYXJyYXkgb2YgY2xhc3Mg
        bmFtZXMgdG8gYWRkCiovCkVtYmVySGFuZGxlYmFycy5iaW5kQ2xhc3NlcyA9
        IGZ1bmN0aW9uKGNvbnRleHQsIGNsYXNzQmluZGluZ3MsIHZpZXcsIGJpbmRB
        dHRySWQsIG9wdGlvbnMpIHsKICB2YXIgcmV0ID0gW10sIG5ld0NsYXNzLCB2
        YWx1ZSwgZWxlbTsKCiAgLy8gSGVscGVyIG1ldGhvZCB0byByZXRyaWV2ZSB0
        aGUgcHJvcGVydHkgZnJvbSB0aGUgY29udGV4dCBhbmQKICAvLyBkZXRlcm1p
        bmUgd2hpY2ggY2xhc3Mgc3RyaW5nIHRvIHJldHVybiwgYmFzZWQgb24gd2hl
        dGhlciBpdCBpcwogIC8vIGEgQm9vbGVhbiBvciBub3QuCiAgdmFyIGNsYXNz
        U3RyaW5nRm9yUGF0aCA9IGZ1bmN0aW9uKHJvb3QsIHBhcnNlZFBhdGgsIG9w
        dGlvbnMpIHsKICAgIHZhciB2YWwsCiAgICAgICAgcGF0aCA9IHBhcnNlZFBh
        dGgucGF0aDsKCiAgICBpZiAocGF0aCA9PT0gJ3RoaXMnKSB7CiAgICAgIHZh
        bCA9IHJvb3Q7CiAgICB9IGVsc2UgaWYgKHBhdGggPT09ICcnKSB7CiAgICAg
        IHZhbCA9IHRydWU7CiAgICB9IGVsc2UgewogICAgICB2YWwgPSBoYW5kbGVi
        YXJzR2V0KHJvb3QsIHBhdGgsIG9wdGlvbnMpOwogICAgfQoKICAgIHJldHVy
        biBFbWJlci5WaWV3Ll9jbGFzc1N0cmluZ0ZvclZhbHVlKHBhdGgsIHZhbCwg
        cGFyc2VkUGF0aC5jbGFzc05hbWUsIHBhcnNlZFBhdGguZmFsc3lDbGFzc05h
        bWUpOwogIH07CgogIC8vIEZvciBlYWNoIHByb3BlcnR5IHBhc3NlZCwgbG9v
        cCB0aHJvdWdoIGFuZCBzZXR1cAogIC8vIGFuIG9ic2VydmVyLgogIGZvckVh
        Y2guY2FsbChjbGFzc0JpbmRpbmdzLnNwbGl0KCcgJyksIGZ1bmN0aW9uKGJp
        bmRpbmcpIHsKCiAgICAvLyBWYXJpYWJsZSBpbiB3aGljaCB0aGUgb2xkIGNs
        YXNzIHZhbHVlIGlzIHNhdmVkLiBUaGUgb2JzZXJ2ZXIgZnVuY3Rpb24KICAg
        IC8vIGNsb3NlcyBvdmVyIHRoaXMgdmFyaWFibGUsIHNvIGl0IGtub3dzIHdo
        aWNoIHN0cmluZyB0byByZW1vdmUgd2hlbgogICAgLy8gdGhlIHByb3BlcnR5
        IGNoYW5nZXMuCiAgICB2YXIgb2xkQ2xhc3M7CgogICAgdmFyIG9ic2VydmVy
        LCBpbnZva2VyOwoKICAgIHZhciBwYXJzZWRQYXRoID0gRW1iZXIuVmlldy5f
        cGFyc2VQcm9wZXJ0eVBhdGgoYmluZGluZyksCiAgICAgICAgcGF0aCA9IHBh
        cnNlZFBhdGgucGF0aCwKICAgICAgICBwYXRoUm9vdCA9IGNvbnRleHQsCiAg
        ICAgICAgbm9ybWFsaXplZDsKCiAgICBpZiAocGF0aCAhPT0gJycgJiYgcGF0
        aCAhPT0gJ3RoaXMnKSB7CiAgICAgIG5vcm1hbGl6ZWQgPSBub3JtYWxpemVQ
        YXRoKGNvbnRleHQsIHBhdGgsIG9wdGlvbnMuZGF0YSk7CgogICAgICBwYXRo
        Um9vdCA9IG5vcm1hbGl6ZWQucm9vdDsKICAgICAgcGF0aCA9IG5vcm1hbGl6
        ZWQucGF0aDsKICAgIH0KCiAgICAvLyBTZXQgdXAgYW4gb2JzZXJ2ZXIgb24g
        dGhlIGNvbnRleHQuIElmIHRoZSBwcm9wZXJ0eSBjaGFuZ2VzLCB0b2dnbGUg
        dGhlCiAgICAvLyBjbGFzcyBuYW1lLgogICAgb2JzZXJ2ZXIgPSBmdW5jdGlv
        bigpIHsKICAgICAgLy8gR2V0IHRoZSBjdXJyZW50IHZhbHVlIG9mIHRoZSBw
        cm9wZXJ0eQogICAgICBuZXdDbGFzcyA9IGNsYXNzU3RyaW5nRm9yUGF0aChj
        b250ZXh0LCBwYXJzZWRQYXRoLCBvcHRpb25zKTsKICAgICAgZWxlbSA9IGJp
        bmRBdHRySWQgPyB2aWV3LiQoIltkYXRhLWJpbmRhdHRyLSIgKyBiaW5kQXR0
        cklkICsgIj0nIiArIGJpbmRBdHRySWQgKyAiJ10iKSA6IHZpZXcuJCgpOwoK
        ICAgICAgLy8gSWYgd2UgY2FuJ3QgZmluZCB0aGUgZWxlbWVudCBhbnltb3Jl
        LCBhIHBhcmVudCB0ZW1wbGF0ZSBoYXMgYmVlbgogICAgICAvLyByZS1yZW5k
        ZXJlZCBhbmQgd2UndmUgYmVlbiBudWtlZC4gUmVtb3ZlIHRoZSBvYnNlcnZl
        ci4KICAgICAgaWYgKCFlbGVtIHx8IGVsZW0ubGVuZ3RoID09PSAwKSB7CiAg
        ICAgICAgRW1iZXIucmVtb3ZlT2JzZXJ2ZXIocGF0aFJvb3QsIHBhdGgsIGlu
        dm9rZXIpOwogICAgICB9IGVsc2UgewogICAgICAgIC8vIElmIHdlIGhhZCBw
        cmV2aW91c2x5IGFkZGVkIGEgY2xhc3MgdG8gdGhlIGVsZW1lbnQsIHJlbW92
        ZSBpdC4KICAgICAgICBpZiAob2xkQ2xhc3MpIHsKICAgICAgICAgIGVsZW0u
        cmVtb3ZlQ2xhc3Mob2xkQ2xhc3MpOwogICAgICAgIH0KCiAgICAgICAgLy8g
        SWYgbmVjZXNzYXJ5LCBhZGQgYSBuZXcgY2xhc3MuIE1ha2Ugc3VyZSB3ZSBr
        ZWVwIHRyYWNrIG9mIGl0IHNvCiAgICAgICAgLy8gaXQgY2FuIGJlIHJlbW92
        ZWQgaW4gdGhlIGZ1dHVyZS4KICAgICAgICBpZiAobmV3Q2xhc3MpIHsKICAg
        ICAgICAgIGVsZW0uYWRkQ2xhc3MobmV3Q2xhc3MpOwogICAgICAgICAgb2xk
        Q2xhc3MgPSBuZXdDbGFzczsKICAgICAgICB9IGVsc2UgewogICAgICAgICAg
        b2xkQ2xhc3MgPSBudWxsOwogICAgICAgIH0KICAgICAgfQogICAgfTsKCiAg
        ICBpZiAocGF0aCAhPT0gJycgJiYgcGF0aCAhPT0gJ3RoaXMnKSB7CiAgICAg
        IHZpZXcucmVnaXN0ZXJPYnNlcnZlcihwYXRoUm9vdCwgcGF0aCwgb2JzZXJ2
        ZXIpOwogICAgfQoKICAgIC8vIFdlJ3ZlIGFscmVhZHkgc2V0dXAgdGhlIG9i
        c2VydmVyOyBub3cgd2UganVzdCBuZWVkIHRvIGZpZ3VyZSBvdXQgdGhlCiAg
        ICAvLyBjb3JyZWN0IGJlaGF2aW9yIHJpZ2h0IG5vdyBvbiB0aGUgZmlyc3Qg
        cGFzcyB0aHJvdWdoLgogICAgdmFsdWUgPSBjbGFzc1N0cmluZ0ZvclBhdGgo
        Y29udGV4dCwgcGFyc2VkUGF0aCwgb3B0aW9ucyk7CgogICAgaWYgKHZhbHVl
        KSB7CiAgICAgIHJldC5wdXNoKHZhbHVlKTsKCiAgICAgIC8vIE1ha2Ugc3Vy
        ZSB3ZSBzYXZlIHRoZSBjdXJyZW50IHZhbHVlIHNvIHRoYXQgaXQgY2FuIGJl
        IHJlbW92ZWQgaWYgdGhlCiAgICAgIC8vIG9ic2VydmVyIGZpcmVzLgogICAg
        ICBvbGRDbGFzcyA9IHZhbHVlOwogICAgfQogIH0pOwoKICByZXR1cm4gcmV0
        Owp9OwoKCn0pKCk7CgoKCihmdW5jdGlvbigpIHsKLypnbG9iYWxzIEhhbmRs
        ZWJhcnMgKi8KCi8vIFRPRE86IERvbid0IHJlcXVpcmUgdGhlIGVudGlyZSBt
        b2R1bGUKLyoqCkBtb2R1bGUgZW1iZXIKQHN1Ym1vZHVsZSBlbWJlci1oYW5k
        bGViYXJzCiovCgp2YXIgZ2V0ID0gRW1iZXIuZ2V0LCBzZXQgPSBFbWJlci5z
        ZXQ7CnZhciBFbWJlckhhbmRsZWJhcnMgPSBFbWJlci5IYW5kbGViYXJzOwp2
        YXIgTE9XRVJDQVNFX0FfWiA9IC9eW2Etel0vOwp2YXIgVklFV19QUkVGSVgg
        PSAvXnZpZXdcLi87CgpmdW5jdGlvbiBtYWtlQmluZGluZ3ModGhpc0NvbnRl
        eHQsIG9wdGlvbnMpIHsKICB2YXIgaGFzaCA9IG9wdGlvbnMuaGFzaCwKICAg
        ICAgaGFzaFR5cGUgPSBvcHRpb25zLmhhc2hUeXBlczsKCiAgZm9yICh2YXIg
        cHJvcCBpbiBoYXNoKSB7CiAgICBpZiAoaGFzaFR5cGVbcHJvcF0gPT09ICdJ
        RCcpIHsKCiAgICAgIHZhciB2YWx1ZSA9IGhhc2hbcHJvcF07CgogICAgICBp
        ZiAoRW1iZXIuSVNfQklORElORy50ZXN0KHByb3ApKSB7CiAgICAgICAgRW1i
        ZXIud2FybigiWW91J3JlIGF0dGVtcHRpbmcgdG8gcmVuZGVyIGEgdmlldyBi
        eSBwYXNzaW5nICIgKyBwcm9wICsgIj0iICsgdmFsdWUgKyAiIHRvIGEgdmll
        dyBoZWxwZXIsIGJ1dCB0aGlzIHN5bnRheCBpcyBhbWJpZ3VvdXMuIFlvdSBz
        aG91bGQgZWl0aGVyIHN1cnJvdW5kICIgKyB2YWx1ZSArICIgaW4gcXVvdGVz
        IG9yIHJlbW92ZSBgQmluZGluZ2AgZnJvbSAiICsgcHJvcCArICIuIik7CiAg
        ICAgIH0gZWxzZSB7CiAgICAgICAgaGFzaFtwcm9wICsgJ0JpbmRpbmcnXSA9
        IHZhbHVlOwogICAgICAgIGhhc2hUeXBlW3Byb3AgKyAnQmluZGluZyddID0g
        J1NUUklORyc7CiAgICAgICAgZGVsZXRlIGhhc2hbcHJvcF07CiAgICAgICAg
        ZGVsZXRlIGhhc2hUeXBlW3Byb3BdOwogICAgICB9CiAgICB9CiAgfQoKICBp
        ZiAoaGFzaC5oYXNPd25Qcm9wZXJ0eSgnaWRCaW5kaW5nJykpIHsKICAgIC8v
        IGlkIGNhbid0IGJlIGJvdW5kLCBzbyBqdXN0IHBlcmZvcm0gb25lLXRpbWUg
        bG9va3VwLgogICAgaGFzaC5pZCA9IEVtYmVySGFuZGxlYmFycy5nZXQodGhp
        c0NvbnRleHQsIGhhc2guaWRCaW5kaW5nLCBvcHRpb25zKTsKICAgIGhhc2hU
        eXBlLmlkID0gJ1NUUklORyc7CiAgICBkZWxldGUgaGFzaC5pZEJpbmRpbmc7
        CiAgICBkZWxldGUgaGFzaFR5cGUuaWRCaW5kaW5nOwogIH0KfQoKRW1iZXJI
        YW5kbGViYXJzLlZpZXdIZWxwZXIgPSBFbWJlci5PYmplY3QuY3JlYXRlKHsK
        CiAgcHJvcGVydGllc0Zyb21IVE1MT3B0aW9uczogZnVuY3Rpb24ob3B0aW9u
        cywgdGhpc0NvbnRleHQpIHsKICAgIHZhciBoYXNoID0gb3B0aW9ucy5oYXNo
        LCBkYXRhID0gb3B0aW9ucy5kYXRhOwogICAgdmFyIGV4dGVuc2lvbnMgPSB7
        fSwKICAgICAgICBjbGFzc2VzID0gaGFzaFsnY2xhc3MnXSwKICAgICAgICBk
        dXAgPSBmYWxzZTsKCiAgICBpZiAoaGFzaC5pZCkgewogICAgICBleHRlbnNp
        b25zLmVsZW1lbnRJZCA9IGhhc2guaWQ7CiAgICAgIGR1cCA9IHRydWU7CiAg
        ICB9CgogICAgaWYgKGhhc2gudGFnKSB7CiAgICAgIGV4dGVuc2lvbnMudGFn
        TmFtZSA9IGhhc2gudGFnOwogICAgICBkdXAgPSB0cnVlOwogICAgfQoKICAg
        IGlmIChjbGFzc2VzKSB7CiAgICAgIGNsYXNzZXMgPSBjbGFzc2VzLnNwbGl0
        KCcgJyk7CiAgICAgIGV4dGVuc2lvbnMuY2xhc3NOYW1lcyA9IGNsYXNzZXM7
        CiAgICAgIGR1cCA9IHRydWU7CiAgICB9CgogICAgaWYgKGhhc2guY2xhc3NC
        aW5kaW5nKSB7CiAgICAgIGV4dGVuc2lvbnMuY2xhc3NOYW1lQmluZGluZ3Mg
        PSBoYXNoLmNsYXNzQmluZGluZy5zcGxpdCgnICcpOwogICAgICBkdXAgPSB0
        cnVlOwogICAgfQoKICAgIGlmIChoYXNoLmNsYXNzTmFtZUJpbmRpbmdzKSB7
        CiAgICAgIGlmIChleHRlbnNpb25zLmNsYXNzTmFtZUJpbmRpbmdzID09PSB1
        bmRlZmluZWQpIGV4dGVuc2lvbnMuY2xhc3NOYW1lQmluZGluZ3MgPSBbXTsK
        ICAgICAgZXh0ZW5zaW9ucy5jbGFzc05hbWVCaW5kaW5ncyA9IGV4dGVuc2lv
        bnMuY2xhc3NOYW1lQmluZGluZ3MuY29uY2F0KGhhc2guY2xhc3NOYW1lQmlu
        ZGluZ3Muc3BsaXQoJyAnKSk7CiAgICAgIGR1cCA9IHRydWU7CiAgICB9Cgog
        ICAgaWYgKGhhc2guYXR0cmlidXRlQmluZGluZ3MpIHsKICAgICAgRW1iZXIu
        YXNzZXJ0KCJTZXR0aW5nICdhdHRyaWJ1dGVCaW5kaW5ncycgdmlhIEhhbmRs
        ZWJhcnMgaXMgbm90IGFsbG93ZWQuIFBsZWFzZSBzdWJjbGFzcyBFbWJlci5W
        aWV3IGFuZCBzZXQgaXQgdGhlcmUgaW5zdGVhZC4iKTsKICAgICAgZXh0ZW5z
        aW9ucy5hdHRyaWJ1dGVCaW5kaW5ncyA9IG51bGw7CiAgICAgIGR1cCA9IHRy
        dWU7CiAgICB9CgogICAgaWYgKGR1cCkgewogICAgICBoYXNoID0gRW1iZXIu
        JC5leHRlbmQoe30sIGhhc2gpOwogICAgICBkZWxldGUgaGFzaC5pZDsKICAg
        ICAgZGVsZXRlIGhhc2gudGFnOwogICAgICBkZWxldGUgaGFzaFsnY2xhc3Mn
        XTsKICAgICAgZGVsZXRlIGhhc2guY2xhc3NCaW5kaW5nOwogICAgfQoKICAg
        IC8vIFNldCB0aGUgcHJvcGVyIGNvbnRleHQgZm9yIGFsbCBiaW5kaW5ncyBw
        YXNzZWQgdG8gdGhlIGhlbHBlci4gVGhpcyBhcHBsaWVzIHRvIHJlZ3VsYXIg
        YXR0cmlidXRlIGJpbmRpbmdzCiAgICAvLyBhcyB3ZWxsIGFzIGNsYXNzIG5h
        bWUgYmluZGluZ3MuIElmIHRoZSBiaW5kaW5ncyBhcmUgbG9jYWwsIG1ha2Ug
        dGhlbSByZWxhdGl2ZSB0byB0aGUgY3VycmVudCBjb250ZXh0CiAgICAvLyBp
        bnN0ZWFkIG9mIHRoZSB2aWV3LgogICAgdmFyIHBhdGg7CgogICAgLy8gRXZh
        bHVhdGUgdGhlIGNvbnRleHQgb2YgcmVndWxhciBhdHRyaWJ1dGUgYmluZGlu
        Z3M6CiAgICBmb3IgKHZhciBwcm9wIGluIGhhc2gpIHsKICAgICAgaWYgKCFo
        YXNoLmhhc093blByb3BlcnR5KHByb3ApKSB7IGNvbnRpbnVlOyB9CgogICAg
        ICAvLyBUZXN0IGlmIHRoZSBwcm9wZXJ0eSBlbmRzIGluICJCaW5kaW5nIgog
        ICAgICBpZiAoRW1iZXIuSVNfQklORElORy50ZXN0KHByb3ApICYmIHR5cGVv
        ZiBoYXNoW3Byb3BdID09PSAnc3RyaW5nJykgewogICAgICAgIHBhdGggPSB0
        aGlzLmNvbnRleHR1YWxpemVCaW5kaW5nUGF0aChoYXNoW3Byb3BdLCBkYXRh
        KTsKICAgICAgICBpZiAocGF0aCkgeyBoYXNoW3Byb3BdID0gcGF0aDsgfQog
        ICAgICB9CiAgICB9CgogICAgLy8gRXZhbHVhdGUgdGhlIGNvbnRleHQgb2Yg
        Y2xhc3MgbmFtZSBiaW5kaW5nczoKICAgIGlmIChleHRlbnNpb25zLmNsYXNz
        TmFtZUJpbmRpbmdzKSB7CiAgICAgIGZvciAodmFyIGIgaW4gZXh0ZW5zaW9u
        cy5jbGFzc05hbWVCaW5kaW5ncykgewogICAgICAgIHZhciBmdWxsID0gZXh0
        ZW5zaW9ucy5jbGFzc05hbWVCaW5kaW5nc1tiXTsKICAgICAgICBpZiAodHlw
        ZW9mIGZ1bGwgPT09ICdzdHJpbmcnKSB7CiAgICAgICAgICAvLyBDb250ZXh0
        dWFsaXplIHRoZSBwYXRoIG9mIGNsYXNzTmFtZUJpbmRpbmcgc28gdGhpczoK
        ICAgICAgICAgIC8vCiAgICAgICAgICAvLyAgICAgY2xhc3NOYW1lQmluZGlu
        Zz0iaXNHcmVlbjpncmVlbiIKICAgICAgICAgIC8vCiAgICAgICAgICAvLyBp
        cyBjb252ZXJ0ZWQgdG8gdGhpczoKICAgICAgICAgIC8vCiAgICAgICAgICAv
        LyAgICAgY2xhc3NOYW1lQmluZGluZz0iX3BhcmVudFZpZXcuY29udGV4dC5p
        c0dyZWVuOmdyZWVuIgogICAgICAgICAgdmFyIHBhcnNlZFBhdGggPSBFbWJl
        ci5WaWV3Ll9wYXJzZVByb3BlcnR5UGF0aChmdWxsKTsKICAgICAgICAgIHBh
        dGggPSB0aGlzLmNvbnRleHR1YWxpemVCaW5kaW5nUGF0aChwYXJzZWRQYXRo
        LnBhdGgsIGRhdGEpOwogICAgICAgICAgaWYgKHBhdGgpIHsgZXh0ZW5zaW9u
        cy5jbGFzc05hbWVCaW5kaW5nc1tiXSA9IHBhdGggKyBwYXJzZWRQYXRoLmNs
        YXNzTmFtZXM7IH0KICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICByZXR1
        cm4gRW1iZXIuJC5leHRlbmQoaGFzaCwgZXh0ZW5zaW9ucyk7CiAgfSwKCiAg
        Ly8gVHJhbnNmb3JtIGJpbmRpbmdzIGZyb20gdGhlIGN1cnJlbnQgY29udGV4
        dCB0byBhIGNvbnRleHQgdGhhdCBjYW4gYmUgZXZhbHVhdGVkIHdpdGhpbiB0
        aGUgdmlldy4KICAvLyBSZXR1cm5zIG51bGwgaWYgdGhlIHBhdGggc2hvdWxk
        bid0IGJlIGNoYW5nZWQuCiAgLy8KICAvLyBUT0RPOiBjb25zaWRlciB0aGUg
        YWRkaXRpb24gb2YgYSBwcmVmaXggdGhhdCB3b3VsZCBhbGxvdyB0aGlzIG1l
        dGhvZCB0byByZXR1cm4gYHBhdGhgLgogIGNvbnRleHR1YWxpemVCaW5kaW5n
        UGF0aDogZnVuY3Rpb24ocGF0aCwgZGF0YSkgewogICAgdmFyIG5vcm1hbGl6
        ZWQgPSBFbWJlci5IYW5kbGViYXJzLm5vcm1hbGl6ZVBhdGgobnVsbCwgcGF0
        aCwgZGF0YSk7CiAgICBpZiAobm9ybWFsaXplZC5pc0tleXdvcmQpIHsKICAg
        ICAgcmV0dXJuICd0ZW1wbGF0ZURhdGEua2V5d29yZHMuJyArIHBhdGg7CiAg
        ICB9IGVsc2UgaWYgKEVtYmVyLmlzR2xvYmFsUGF0aChwYXRoKSkgewogICAg
        ICByZXR1cm4gbnVsbDsKICAgIH0gZWxzZSBpZiAocGF0aCA9PT0gJ3RoaXMn
        KSB7CiAgICAgIHJldHVybiAnX3BhcmVudFZpZXcuY29udGV4dCc7CiAgICB9
        IGVsc2UgewogICAgICByZXR1cm4gJ19wYXJlbnRWaWV3LmNvbnRleHQuJyAr
        IHBhdGg7CiAgICB9CiAgfSwKCiAgaGVscGVyOiBmdW5jdGlvbih0aGlzQ29u
        dGV4dCwgcGF0aCwgb3B0aW9ucykgewogICAgdmFyIGRhdGEgPSBvcHRpb25z
        LmRhdGEsCiAgICAgICAgZm4gPSBvcHRpb25zLmZuLAogICAgICAgIG5ld1Zp
        ZXc7CgogICAgbWFrZUJpbmRpbmdzKHRoaXNDb250ZXh0LCBvcHRpb25zKTsK
        CiAgICBpZiAoJ3N0cmluZycgPT09IHR5cGVvZiBwYXRoKSB7CgogICAgICAv
        LyBUT0RPOiB0aGlzIGlzIGEgbGFtZSBjb25kaXRpb25hbCwgdGhpcyBzaG91
        bGQgbGlrZWx5IGNoYW5nZQogICAgICAvLyBidXQgc29tZXRoaW5nIGFsb25n
        IHRoZXNlIGxpbmVzIHdpbGwgbGlrZWx5IG5lZWQgdG8gYmUgYWRkZWQKICAg
        ICAgLy8gYXMgZGVwcmVjYXRpb24gd2FybmluZ3MKICAgICAgLy8KICAgICAg
        aWYgKG9wdGlvbnMudHlwZXNbMF0gPT09ICdTVFJJTkcnICYmIExPV0VSQ0FT
        RV9BX1oudGVzdChwYXRoKSAmJiAhVklFV19QUkVGSVgudGVzdChwYXRoKSkg
        ewogICAgICAgIEVtYmVyLmFzc2VydCgiVmlldyByZXF1aXJlcyBhIGNvbnRh
        aW5lciIsICEhZGF0YS52aWV3LmNvbnRhaW5lcik7CiAgICAgICAgbmV3Vmll
        dyA9IGRhdGEudmlldy5jb250YWluZXIubG9va3VwRmFjdG9yeSgndmlldzon
        ICsgcGF0aCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgbmV3VmlldyA9IEVt
        YmVySGFuZGxlYmFycy5nZXQodGhpc0NvbnRleHQsIHBhdGgsIG9wdGlvbnMp
        OwogICAgICB9CgogICAgICBFbWJlci5hc3NlcnQoIlVuYWJsZSB0byBmaW5k
        IHZpZXcgYXQgcGF0aCAnIiArIHBhdGggKyAiJyIsICEhbmV3Vmlldyk7CiAg
        ICB9IGVsc2UgewogICAgICBuZXdWaWV3ID0gcGF0aDsKICAgIH0KCiAgICBF
        bWJlci5hc3NlcnQoRW1iZXIuU3RyaW5nLmZtdCgnWW91IG11c3QgcGFzcyBh
        IHZpZXcgdG8gdGhlICN2aWV3IGhlbHBlciwgbm90ICVAICglQCknLCBbcGF0
        aCwgbmV3Vmlld10pLCBFbWJlci5WaWV3LmRldGVjdChuZXdWaWV3KSB8fCBF
        bWJlci5WaWV3LmRldGVjdEluc3RhbmNlKG5ld1ZpZXcpKTsKCiAgICB2YXIg
        dmlld09wdGlvbnMgPSB0aGlzLnByb3BlcnRpZXNGcm9tSFRNTE9wdGlvbnMo
        b3B0aW9ucywgdGhpc0NvbnRleHQpOwogICAgdmFyIGN1cnJlbnRWaWV3ID0g
        ZGF0YS52aWV3OwogICAgdmlld09wdGlvbnMudGVtcGxhdGVEYXRhID0gZGF0
        YTsKICAgIHZhciBuZXdWaWV3UHJvdG8gPSBuZXdWaWV3LnByb3RvID8gbmV3
        Vmlldy5wcm90bygpIDogbmV3VmlldzsKCiAgICBpZiAoZm4pIHsKICAgICAg
        RW1iZXIuYXNzZXJ0KCJZb3UgY2Fubm90IHByb3ZpZGUgYSB0ZW1wbGF0ZSBi
        bG9jayBpZiB5b3UgYWxzbyBzcGVjaWZpZWQgYSB0ZW1wbGF0ZU5hbWUiLCAh
        Z2V0KHZpZXdPcHRpb25zLCAndGVtcGxhdGVOYW1lJykgJiYgIWdldChuZXdW
        aWV3UHJvdG8sICd0ZW1wbGF0ZU5hbWUnKSk7CiAgICAgIHZpZXdPcHRpb25z
        LnRlbXBsYXRlID0gZm47CiAgICB9CgogICAgLy8gV2Ugb25seSB3YW50IHRv
        IG92ZXJyaWRlIHRoZSBgX2NvbnRleHRgIGNvbXB1dGVkIHByb3BlcnR5IGlm
        IHRoZXJlIGlzCiAgICAvLyBubyBzcGVjaWZpZWQgY29udHJvbGxlci4gU2Vl
        IFZpZXcjX2NvbnRleHQgZm9yIG1vcmUgaW5mb3JtYXRpb24uCiAgICBpZiAo
        IW5ld1ZpZXdQcm90by5jb250cm9sbGVyICYmICFuZXdWaWV3UHJvdG8uY29u
        dHJvbGxlckJpbmRpbmcgJiYgIXZpZXdPcHRpb25zLmNvbnRyb2xsZXIgJiYg
        IXZpZXdPcHRpb25zLmNvbnRyb2xsZXJCaW5kaW5nKSB7CiAgICAgIHZpZXdP
        cHRpb25zLl9jb250ZXh0ID0gdGhpc0NvbnRleHQ7CiAgICB9CgogICAgY3Vy
        cmVudFZpZXcuYXBwZW5kQ2hpbGQobmV3Vmlldywgdmlld09wdGlvbnMpOwog
        IH0KfSk7CgovKioKICBge3t2aWV3fX1gIGluc2VydHMgYSBuZXcgaW5zdGFu
        Y2Ugb2YgYEVtYmVyLlZpZXdgIGludG8gYSB0ZW1wbGF0ZSBwYXNzaW5nIGl0
        cwogIG9wdGlvbnMgdG8gdGhlIGBFbWJlci5WaWV3YCdzIGBjcmVhdGVgIG1l
        dGhvZCBhbmQgdXNpbmcgdGhlIHN1cHBsaWVkIGJsb2NrIGFzCiAgdGhlIHZp
        ZXcncyBvd24gdGVtcGxhdGUuCgogIEFuIGVtcHR5IGA8Ym9keT5gIGFuZCB0
        aGUgZm9sbG93aW5nIHRlbXBsYXRlOgoKICBgYGBoYW5kbGViYXJzCiAgQSBz
        cGFuOgogIHt7I3ZpZXcgdGFnTmFtZT0ic3BhbiJ9fQogICAgaGVsbG8uCiAg
        e3svdmlld319CiAgYGBgCgogIFdpbGwgcmVzdWx0IGluIEhUTUwgc3RydWN0
        dXJlOgoKICBgYGBodG1sCiAgPGJvZHk+CiAgICA8IS0tIE5vdGU6IHRoZSBo
        YW5kbGViYXJzIHRlbXBsYXRlIHNjcmlwdAogICAgICAgICBhbHNvIHJlc3Vs
        dHMgaW4gYSByZW5kZXJlZCBFbWJlci5WaWV3CiAgICAgICAgIHdoaWNoIGlz
        IHRoZSBvdXRlciA8ZGl2PiBoZXJlIC0tPgoKICAgIDxkaXYgY2xhc3M9ImVt
        YmVyLXZpZXciPgogICAgICBBIHNwYW46CiAgICAgIDxzcGFuIGlkPSJlbWJl
        cjEiIGNsYXNzPSJlbWJlci12aWV3Ij4KICAgICAgICBIZWxsby4KICAgICAg
        PC9zcGFuPgogICAgPC9kaXY+CiAgPC9ib2R5PgogIGBgYAoKICAjIyMgYHBh
        cmVudFZpZXdgIHNldHRpbmcKCiAgVGhlIGBwYXJlbnRWaWV3YCBwcm9wZXJ0
        eSBvZiB0aGUgbmV3IGBFbWJlci5WaWV3YCBpbnN0YW5jZSBjcmVhdGVkIHRo
        cm91Z2gKICBge3t2aWV3fX1gIHdpbGwgYmUgc2V0IHRvIHRoZSBgRW1iZXIu
        Vmlld2AgaW5zdGFuY2Ugb2YgdGhlIHRlbXBsYXRlIHdoZXJlCiAgYHt7dmll
        d319YCB3YXMgY2FsbGVkLgoKICBgYGBqYXZhc2NyaXB0CiAgYVZpZXcgPSBF
        bWJlci5WaWV3LmNyZWF0ZSh7CiAgICB0ZW1wbGF0ZTogRW1iZXIuSGFuZGxl
        YmFycy5jb21waWxlKCJ7eyN2aWV3fX0gbXkgcGFyZW50OiB7e3BhcmVudFZp
        ZXcuZWxlbWVudElkfX0ge3svdmlld319IikKICB9KTsKCiAgYVZpZXcuYXBw
        ZW5kVG8oJ2JvZHknKTsKICBgYGAKCiAgV2lsbCByZXN1bHQgaW4gSFRNTCBz
        dHJ1Y3R1cmU6CgogIGBgYGh0bWwKICA8ZGl2IGlkPSJlbWJlcjEiIGNsYXNz
        PSJlbWJlci12aWV3Ij4KICAgIDxkaXYgaWQ9ImVtYmVyMiIgY2xhc3M9ImVt
        YmVyLXZpZXciPgogICAgICBteSBwYXJlbnQ6IGVtYmVyMQogICAgPC9kaXY+
        CiAgPC9kaXY+CiAgYGBgCgogICMjIyBTZXR0aW5nIENTUyBpZCBhbmQgY2xh
        c3MgYXR0cmlidXRlcwoKICBUaGUgSFRNTCBgaWRgIGF0dHJpYnV0ZSBjYW4g
        YmUgc2V0IG9uIHRoZSBge3t2aWV3fX1gJ3MgcmVzdWx0aW5nIGVsZW1lbnQg
        d2l0aAogIHRoZSBgaWRgIG9wdGlvbi4gVGhpcyBvcHRpb24gd2lsbCBfbm90
        XyBiZSBwYXNzZWQgdG8gYEVtYmVyLlZpZXcuY3JlYXRlYC4KCiAgYGBgaGFu
        ZGxlYmFycwogIHt7I3ZpZXcgdGFnTmFtZT0ic3BhbiIgaWQ9ImEtY3VzdG9t
        LWlkIn19CiAgICBoZWxsby4KICB7ey92aWV3fX0KICBgYGAKCiAgUmVzdWx0
        cyBpbiB0aGUgZm9sbG93aW5nIEhUTUwgc3RydWN0dXJlOgoKICBgYGBodG1s
        CiAgPGRpdiBjbGFzcz0iZW1iZXItdmlldyI+CiAgICA8c3BhbiBpZD0iYS1j
        dXN0b20taWQiIGNsYXNzPSJlbWJlci12aWV3Ij4KICAgICAgaGVsbG8uCiAg
        ICA8L3NwYW4+CiAgPC9kaXY+CiAgYGBgCgogIFRoZSBIVE1MIGBjbGFzc2Ag
        YXR0cmlidXRlIGNhbiBiZSBzZXQgb24gdGhlIGB7e3ZpZXd9fWAncyByZXN1
        bHRpbmcgZWxlbWVudAogIHdpdGggdGhlIGBjbGFzc2Agb3IgYGNsYXNzTmFt
        ZUJpbmRpbmdzYCBvcHRpb25zLiBUaGUgYGNsYXNzYCBvcHRpb24gd2lsbAog
        IGRpcmVjdGx5IHNldCB0aGUgQ1NTIGBjbGFzc2AgYXR0cmlidXRlIGFuZCB3
        aWxsIG5vdCBiZSBwYXNzZWQgdG8KICBgRW1iZXIuVmlldy5jcmVhdGVgLiBg
        Y2xhc3NOYW1lQmluZGluZ3NgIHdpbGwgYmUgcGFzc2VkIHRvIGBjcmVhdGVg
        IGFuZCB1c2UKICBgRW1iZXIuVmlld2AncyBjbGFzcyBuYW1lIGJpbmRpbmcg
        ZnVuY3Rpb25hbGl0eToKCiAgYGBgaGFuZGxlYmFycwogIHt7I3ZpZXcgdGFn
        TmFtZT0ic3BhbiIgY2xhc3M9ImEtY3VzdG9tLWNsYXNzIn19CiAgICBoZWxs
        by4KICB7ey92aWV3fX0KICBgYGAKCiAgUmVzdWx0cyBpbiB0aGUgZm9sbG93
        aW5nIEhUTUwgc3RydWN0dXJlOgoKICBgYGBodG1sCiAgPGRpdiBjbGFzcz0i
        ZW1iZXItdmlldyI+CiAgICA8c3BhbiBpZD0iZW1iZXIyIiBjbGFzcz0iZW1i
        ZXItdmlldyBhLWN1c3RvbS1jbGFzcyI+CiAgICAgIGhlbGxvLgogICAgPC9z
        cGFuPgogIDwvZGl2PgogIGBgYAoKICAjIyMgU3VwcGx5aW5nIGEgZGlmZmVy
        ZW50IHZpZXcgY2xhc3MKCiAgYHt7dmlld319YCBjYW4gdGFrZSBhbiBvcHRp
        b25hbCBmaXJzdCBhcmd1bWVudCBiZWZvcmUgaXRzIHN1cHBsaWVkIG9wdGlv
        bnMgdG8KICBzcGVjaWZ5IGEgcGF0aCB0byBhIGN1c3RvbSB2aWV3IGNsYXNz
        LgoKICBgYGBoYW5kbGViYXJzCiAge3sjdmlldyAiTXlBcHAuQ3VzdG9tVmll
        dyJ9fQogICAgaGVsbG8uCiAge3svdmlld319CiAgYGBgCgogIFRoZSBmaXJz
        dCBhcmd1bWVudCBjYW4gYWxzbyBiZSBhIHJlbGF0aXZlIHBhdGggYWNjZXNz
        aWJsZSBmcm9tIHRoZSBjdXJyZW50CiAgY29udGV4dC4KCiAgYGBgamF2YXNj
        cmlwdAogIE15QXBwID0gRW1iZXIuQXBwbGljYXRpb24uY3JlYXRlKHt9KTsK
        ICBNeUFwcC5PdXRlclZpZXcgPSBFbWJlci5WaWV3LmV4dGVuZCh7CiAgICBp
        bm5lclZpZXdDbGFzczogRW1iZXIuVmlldy5leHRlbmQoewogICAgICBjbGFz
        c05hbWVzOiBbJ2EtY3VzdG9tLXZpZXctY2xhc3MtYXMtcHJvcGVydHknXQog
        ICAgfSksCiAgICB0ZW1wbGF0ZTogRW1iZXIuSGFuZGxlYmFycy5jb21waWxl
        KCd7eyN2aWV3ICJ2aWV3LmlubmVyVmlld0NsYXNzIn19IGhpIHt7L3ZpZXd9
        fScpCiAgfSk7CgogIE15QXBwLk91dGVyVmlldy5jcmVhdGUoKS5hcHBlbmRU
        bygnYm9keScpOwogIGBgYAoKICBXaWxsIHJlc3VsdCBpbiB0aGUgZm9sbG93
        aW5nIEhUTUw6CgogIGBgYGh0bWwKICA8ZGl2IGlkPSJlbWJlcjEiIGNsYXNz
        PSJlbWJlci12aWV3Ij4KICAgIDxkaXYgaWQ9ImVtYmVyMiIgY2xhc3M9ImVt
        YmVyLXZpZXcgYS1jdXN0b20tdmlldy1jbGFzcy1hcy1wcm9wZXJ0eSI+CiAg
        ICAgIGhpCiAgICA8L2Rpdj4KICA8L2Rpdj4KICBgYGAKCiAgIyMjIEJsb2Nr
        bGVzcyB1c2UKCiAgSWYgeW91IHN1cHBseSBhIGN1c3RvbSBgRW1iZXIuVmll
        d2Agc3ViY2xhc3MgdGhhdCBzcGVjaWZpZXMgaXRzIG93biB0ZW1wbGF0ZQog
        IG9yIHByb3ZpZGUgYSBgdGVtcGxhdGVOYW1lYCBvcHRpb24gdG8gYHt7dmll
        d319YCBpdCBjYW4gYmUgdXNlZCB3aXRob3V0CiAgc3VwcGx5aW5nIGEgYmxv
        Y2suIEF0dGVtcHRzIHRvIHVzZSBib3RoIGEgYHRlbXBsYXRlTmFtZWAgb3B0
        aW9uIGFuZCBzdXBwbHkgYQogIGJsb2NrIHdpbGwgdGhyb3cgYW4gZXJyb3Iu
        CgogIGBgYGhhbmRsZWJhcnMKICB7e3ZpZXcgIk15QXBwLlZpZXdXaXRoQVRl
        bXBsYXRlRGVmaW5lZCJ9fQogIGBgYAoKICAjIyMgYHZpZXdOYW1lYCBwcm9w
        ZXJ0eQoKICBZb3UgY2FuIHN1cHBseSBhIGB2aWV3TmFtZWAgb3B0aW9uIHRv
        IGB7e3ZpZXd9fWAuIFRoZSBgRW1iZXIuVmlld2AgaW5zdGFuY2UKICB3aWxs
        IGJlIHJlZmVyZW5jZWQgYXMgYSBwcm9wZXJ0eSBvZiBpdHMgcGFyZW50IHZp
        ZXcgYnkgdGhpcyBuYW1lLgoKICBgYGBqYXZhc2NyaXB0CiAgYVZpZXcgPSBF
        bWJlci5WaWV3LmNyZWF0ZSh7CiAgICB0ZW1wbGF0ZTogRW1iZXIuSGFuZGxl
        YmFycy5jb21waWxlKCd7eyN2aWV3IHZpZXdOYW1lPSJhQ2hpbGRCeU5hbWUi
        fX0gaGkge3svdmlld319JykKICB9KTsKCiAgYVZpZXcuYXBwZW5kVG8oJ2Jv
        ZHknKTsKICBhVmlldy5nZXQoJ2FDaGlsZEJ5TmFtZScpIC8vIHRoZSBpbnN0
        YW5jZSBvZiBFbWJlci5WaWV3IGNyZWF0ZWQgYnkge3t2aWV3fX0gaGVscGVy
        CiAgYGBgCgogIEBtZXRob2QgdmlldwogIEBmb3IgRW1iZXIuSGFuZGxlYmFy
        cy5oZWxwZXJzCiAgQHBhcmFtIHtTdHJpbmd9IHBhdGgKICBAcGFyYW0ge0hh
        c2h9IG9wdGlvbnMKICBAcmV0dXJuIHtTdHJpbmd9IEhUTUwgc3RyaW5nCiov
        CkVtYmVySGFuZGxlYmFycy5yZWdpc3RlckhlbHBlcigndmlldycsIGZ1bmN0
        aW9uKHBhdGgsIG9wdGlvbnMpIHsKICBFbWJlci5hc3NlcnQoIlRoZSB2aWV3
        IGhlbHBlciBvbmx5IHRha2VzIGEgc2luZ2xlIGFyZ3VtZW50IiwgYXJndW1l
        bnRzLmxlbmd0aCA8PSAyKTsKCiAgLy8gSWYgbm8gcGF0aCBpcyBwcm92aWRl
        ZCwgdHJlYXQgcGF0aCBwYXJhbSBhcyBvcHRpb25zLgogIGlmIChwYXRoICYm
        IHBhdGguZGF0YSAmJiBwYXRoLmRhdGEuaXNSZW5kZXJEYXRhKSB7CiAgICBv
        cHRpb25zID0gcGF0aDsKICAgIHBhdGggPSAiRW1iZXIuVmlldyI7CiAgfQoK
        ICByZXR1cm4gRW1iZXJIYW5kbGViYXJzLlZpZXdIZWxwZXIuaGVscGVyKHRo
        aXMsIHBhdGgsIG9wdGlvbnMpOwp9KTsKCgp9KSgpOwoKCgooZnVuY3Rpb24o
        KSB7Ci8qZ2xvYmFscyBIYW5kbGViYXJzICovCgovLyBUT0RPOiBEb24ndCBy
        ZXF1aXJlIGFsbCBvZiB0aGlzIG1vZHVsZQovKioKQG1vZHVsZSBlbWJlcgpA
        c3VibW9kdWxlIGVtYmVyLWhhbmRsZWJhcnMKKi8KCnZhciBnZXQgPSBFbWJl
        ci5nZXQsIGhhbmRsZWJhcnNHZXQgPSBFbWJlci5IYW5kbGViYXJzLmdldCwg
        Zm10ID0gRW1iZXIuU3RyaW5nLmZtdDsKCi8qKgogIGB7e2NvbGxlY3Rpb259
        fWAgaXMgYSBgRW1iZXIuSGFuZGxlYmFyc2AgaGVscGVyIGZvciBhZGRpbmcg
        aW5zdGFuY2VzIG9mCiAgYEVtYmVyLkNvbGxlY3Rpb25WaWV3YCB0byBhIHRl
        bXBsYXRlLiBTZWUgW0VtYmVyLkNvbGxlY3Rpb25WaWV3XSgvYXBpL2NsYXNz
        ZXMvRW1iZXIuQ29sbGVjdGlvblZpZXcuaHRtbCkKICAgZm9yIGFkZGl0aW9u
        YWwgaW5mb3JtYXRpb24gb24gaG93IGEgYENvbGxlY3Rpb25WaWV3YCBmdW5j
        dGlvbnMuCgogIGB7e2NvbGxlY3Rpb259fWAncyBwcmltYXJ5IHVzZSBpcyBh
        cyBhIGJsb2NrIGhlbHBlciB3aXRoIGEgYGNvbnRlbnRCaW5kaW5nYAogIG9w
        dGlvbiBwb2ludGluZyB0b3dhcmRzIGFuIGBFbWJlci5BcnJheWAtY29tcGF0
        aWJsZSBvYmplY3QuIEFuIGBFbWJlci5WaWV3YAogIGluc3RhbmNlIHdpbGwg
        YmUgY3JlYXRlZCBmb3IgZWFjaCBpdGVtIGluIGl0cyBgY29udGVudGAgcHJv
        cGVydHkuIEVhY2ggdmlldwogIHdpbGwgaGF2ZSBpdHMgb3duIGBjb250ZW50
        YCBwcm9wZXJ0eSBzZXQgdG8gdGhlIGFwcHJvcHJpYXRlIGl0ZW0gaW4gdGhl
        CiAgY29sbGVjdGlvbi4KCiAgVGhlIHByb3ZpZGVkIGJsb2NrIHdpbGwgYmUg
        YXBwbGllZCBhcyB0aGUgdGVtcGxhdGUgZm9yIGVhY2ggaXRlbSdzIHZpZXcu
        CgogIEdpdmVuIGFuIGVtcHR5IGA8Ym9keT5gIHRoZSBmb2xsb3dpbmcgdGVt
        cGxhdGU6CgogIGBgYGhhbmRsZWJhcnMKICB7eyNjb2xsZWN0aW9uIGNvbnRl
        bnRCaW5kaW5nPSJBcHAuaXRlbXMifX0KICAgIEhpIHt7dmlldy5jb250ZW50
        Lm5hbWV9fQogIHt7L2NvbGxlY3Rpb259fQogIGBgYAoKICBBbmQgdGhlIGZv
        bGxvd2luZyBhcHBsaWNhdGlvbiBjb2RlCgogIGBgYGphdmFzY3JpcHQKICBB
        cHAgPSBFbWJlci5BcHBsaWNhdGlvbi5jcmVhdGUoKQogIEFwcC5pdGVtcyA9
        IFsKICAgIEVtYmVyLk9iamVjdC5jcmVhdGUoe25hbWU6ICdEYXZlJ30pLAog
        ICAgRW1iZXIuT2JqZWN0LmNyZWF0ZSh7bmFtZTogJ01hcnknfSksCiAgICBF
        bWJlci5PYmplY3QuY3JlYXRlKHtuYW1lOiAnU2FyYSd9KQogIF0KICBgYGAK
        CiAgV2lsbCByZXN1bHQgaW4gdGhlIEhUTUwgc3RydWN0dXJlIGJlbG93Cgog
        IGBgYGh0bWwKICA8ZGl2IGNsYXNzPSJlbWJlci12aWV3Ij4KICAgIDxkaXYg
        Y2xhc3M9ImVtYmVyLXZpZXciPkhpIERhdmU8L2Rpdj4KICAgIDxkaXYgY2xh
        c3M9ImVtYmVyLXZpZXciPkhpIE1hcnk8L2Rpdj4KICAgIDxkaXYgY2xhc3M9
        ImVtYmVyLXZpZXciPkhpIFNhcmE8L2Rpdj4KICA8L2Rpdj4KICBgYGAKCiAg
        IyMjIEJsb2NrbGVzcyBVc2UKCiAgSWYgeW91IHByb3ZpZGUgYW4gYGl0ZW1W
        aWV3Q2xhc3NgIG9wdGlvbiB0aGF0IGhhcyBpdHMgb3duIGB0ZW1wbGF0ZWAg
        eW91IGNhbgogIG9taXQgdGhlIGJsb2NrLgoKICBUaGUgZm9sbG93aW5nIHRl
        bXBsYXRlOgoKICBgYGBoYW5kbGViYXJzCiAge3tjb2xsZWN0aW9uIGNvbnRl
        bnRCaW5kaW5nPSJBcHAuaXRlbXMiIGl0ZW1WaWV3Q2xhc3M9IkFwcC5Bbkl0
        ZW1WaWV3In19CiAgYGBgCgogIEFuZCBhcHBsaWNhdGlvbiBjb2RlCgogIGBg
        YGphdmFzY3JpcHQKICBBcHAgPSBFbWJlci5BcHBsaWNhdGlvbi5jcmVhdGUo
        KTsKICBBcHAuaXRlbXMgPSBbCiAgICBFbWJlci5PYmplY3QuY3JlYXRlKHtu
        YW1lOiAnRGF2ZSd9KSwKICAgIEVtYmVyLk9iamVjdC5jcmVhdGUoe25hbWU6
        ICdNYXJ5J30pLAogICAgRW1iZXIuT2JqZWN0LmNyZWF0ZSh7bmFtZTogJ1Nh
        cmEnfSkKICBdOwoKICBBcHAuQW5JdGVtVmlldyA9IEVtYmVyLlZpZXcuZXh0
        ZW5kKHsKICAgIHRlbXBsYXRlOiBFbWJlci5IYW5kbGViYXJzLmNvbXBpbGUo
        IkdyZWV0aW5ncyB7e3ZpZXcuY29udGVudC5uYW1lfX0iKQogIH0pOwogIGBg
        YAoKICBXaWxsIHJlc3VsdCBpbiB0aGUgSFRNTCBzdHJ1Y3R1cmUgYmVsb3cK
        CiAgYGBgaHRtbAogIDxkaXYgY2xhc3M9ImVtYmVyLXZpZXciPgogICAgPGRp
        diBjbGFzcz0iZW1iZXItdmlldyI+R3JlZXRpbmdzIERhdmU8L2Rpdj4KICAg
        IDxkaXYgY2xhc3M9ImVtYmVyLXZpZXciPkdyZWV0aW5ncyBNYXJ5PC9kaXY+
        CiAgICA8ZGl2IGNsYXNzPSJlbWJlci12aWV3Ij5HcmVldGluZ3MgU2FyYTwv
        ZGl2PgogIDwvZGl2PgogIGBgYAoKICAjIyMgU3BlY2lmeWluZyBhIENvbGxl
        Y3Rpb25WaWV3IHN1YmNsYXNzCgogIEJ5IGRlZmF1bHQgdGhlIGB7e2NvbGxl
        Y3Rpb259fWAgaGVscGVyIHdpbGwgY3JlYXRlIGFuIGluc3RhbmNlIG9mCiAg
        YEVtYmVyLkNvbGxlY3Rpb25WaWV3YC4gWW91IGNhbiBzdXBwbHkgYSBgRW1i
        ZXIuQ29sbGVjdGlvblZpZXdgIHN1YmNsYXNzIHRvCiAgdGhlIGhlbHBlciBi
        eSBwYXNzaW5nIGl0IGFzIHRoZSBmaXJzdCBhcmd1bWVudDoKCiAgYGBgaGFu
        ZGxlYmFycwogIHt7I2NvbGxlY3Rpb24gQXBwLk15Q3VzdG9tQ29sbGVjdGlv
        bkNsYXNzIGNvbnRlbnRCaW5kaW5nPSJBcHAuaXRlbXMifX0KICAgIEhpIHt7
        dmlldy5jb250ZW50Lm5hbWV9fQogIHt7L2NvbGxlY3Rpb259fQogIGBgYAoK
        ICAjIyMgRm9yd2FyZGVkIGBpdGVtLipgLW5hbWVkIE9wdGlvbnMKCiAgQXMg
        d2l0aCB0aGUgYHt7dmlld319YCwgaGVscGVyIG9wdGlvbnMgcGFzc2VkIHRv
        IHRoZSBge3tjb2xsZWN0aW9ufX1gIHdpbGwgYmUKICBzZXQgb24gdGhlIHJl
        c3VsdGluZyBgRW1iZXIuQ29sbGVjdGlvblZpZXdgIGFzIHByb3BlcnRpZXMu
        IEFkZGl0aW9uYWxseSwKICBvcHRpb25zIHByZWZpeGVkIHdpdGggYGl0ZW1g
        IHdpbGwgYmUgYXBwbGllZCB0byB0aGUgdmlld3MgcmVuZGVyZWQgZm9yIGVh
        Y2gKICBpdGVtIChub3RlIHRoZSBjYW1lbGNhc2luZyk6CgogIGBgYGhhbmRs
        ZWJhcnMKICB7eyNjb2xsZWN0aW9uIGNvbnRlbnRCaW5kaW5nPSJBcHAuaXRl
        bXMiCiAgICAgICAgICAgICAgICBpdGVtVGFnTmFtZT0icCIKICAgICAgICAg
        ICAgICAgIGl0ZW1DbGFzc05hbWVzPSJncmVldGluZyJ9fQogICAgSG93ZHkg
        e3t2aWV3LmNvbnRlbnQubmFtZX19CiAge3svY29sbGVjdGlvbn19CiAgYGBg
        CgogIFdpbGwgcmVzdWx0IGluIHRoZSBmb2xsb3dpbmcgSFRNTCBzdHJ1Y3R1
        cmU6CgogIGBgYGh0bWwKICA8ZGl2IGNsYXNzPSJlbWJlci12aWV3Ij4KICAg
        IDxwIGNsYXNzPSJlbWJlci12aWV3IGdyZWV0aW5nIj5Ib3dkeSBEYXZlPC9w
        PgogICAgPHAgY2xhc3M9ImVtYmVyLXZpZXcgZ3JlZXRpbmciPkhvd2R5IE1h
        cnk8L3A+CiAgICA8cCBjbGFzcz0iZW1iZXItdmlldyBncmVldGluZyI+SG93
        ZHkgU2FyYTwvcD4KICA8L2Rpdj4KICBgYGAKCiAgQG1ldGhvZCBjb2xsZWN0
        aW9uCiAgQGZvciBFbWJlci5IYW5kbGViYXJzLmhlbHBlcnMKICBAcGFyYW0g
        e1N0cmluZ30gcGF0aAogIEBwYXJhbSB7SGFzaH0gb3B0aW9ucwogIEByZXR1
        cm4ge1N0cmluZ30gSFRNTCBzdHJpbmcKICBAZGVwcmVjYXRlZCBVc2UgYHt7
        ZWFjaH19YCBoZWxwZXIgaW5zdGVhZC4KKi8KRW1iZXIuSGFuZGxlYmFycy5y
        ZWdpc3RlckhlbHBlcignY29sbGVjdGlvbicsIGZ1bmN0aW9uKHBhdGgsIG9w
        dGlvbnMpIHsKICBFbWJlci5kZXByZWNhdGUoIlVzaW5nIHRoZSB7e2NvbGxl
        Y3Rpb259fSBoZWxwZXIgd2l0aG91dCBzcGVjaWZ5aW5nIGEgY2xhc3MgaGFz
        IGJlZW4gZGVwcmVjYXRlZCBhcyB0aGUge3tlYWNofX0gaGVscGVyIG5vdyBz
        dXBwb3J0cyB0aGUgc2FtZSBmdW5jdGlvbmFsaXR5LiIsIHBhdGggIT09ICdj
        b2xsZWN0aW9uJyk7CgogIC8vIElmIG5vIHBhdGggaXMgcHJvdmlkZWQsIHRy
        ZWF0IHBhdGggcGFyYW0gYXMgb3B0aW9ucy4KICBpZiAocGF0aCAmJiBwYXRo
        LmRhdGEgJiYgcGF0aC5kYXRhLmlzUmVuZGVyRGF0YSkgewogICAgb3B0aW9u
        cyA9IHBhdGg7CiAgICBwYXRoID0gdW5kZWZpbmVkOwogICAgRW1iZXIuYXNz
        ZXJ0KCJZb3UgY2Fubm90IHBhc3MgbW9yZSB0aGFuIG9uZSBhcmd1bWVudCB0
        byB0aGUgY29sbGVjdGlvbiBoZWxwZXIiLCBhcmd1bWVudHMubGVuZ3RoID09
        PSAxKTsKICB9IGVsc2UgewogICAgRW1iZXIuYXNzZXJ0KCJZb3UgY2Fubm90
        IHBhc3MgbW9yZSB0aGFuIG9uZSBhcmd1bWVudCB0byB0aGUgY29sbGVjdGlv
        biBoZWxwZXIiLCBhcmd1bWVudHMubGVuZ3RoID09PSAyKTsKICB9CgogIHZh
        ciBmbiA9IG9wdGlvbnMuZm47CiAgdmFyIGRhdGEgPSBvcHRpb25zLmRhdGE7
        CiAgdmFyIGludmVyc2UgPSBvcHRpb25zLmludmVyc2U7CiAgdmFyIHZpZXcg
        PSBvcHRpb25zLmRhdGEudmlldzsKCiAgLy8gSWYgcGFzc2VkIGEgcGF0aCBz
        dHJpbmcsIGNvbnZlcnQgdGhhdCBpbnRvIGFuIG9iamVjdC4KICAvLyBPdGhl
        cndpc2UsIGp1c3QgZGVmYXVsdCB0byB0aGUgc3RhbmRhcmQgY2xhc3MuCiAg
        dmFyIGNvbGxlY3Rpb25DbGFzczsKICBjb2xsZWN0aW9uQ2xhc3MgPSBwYXRo
        ID8gaGFuZGxlYmFyc0dldCh0aGlzLCBwYXRoLCBvcHRpb25zKSA6IEVtYmVy
        LkNvbGxlY3Rpb25WaWV3OwogIEVtYmVyLmFzc2VydChmbXQoIiVAICNjb2xs
        ZWN0aW9uOiBDb3VsZCBub3QgZmluZCBjb2xsZWN0aW9uIGNsYXNzICVAIiwg
        W2RhdGEudmlldywgcGF0aF0pLCAhIWNvbGxlY3Rpb25DbGFzcyk7CgogIHZh
        ciBoYXNoID0gb3B0aW9ucy5oYXNoLCBpdGVtSGFzaCA9IHt9LCBtYXRjaDsK
        CiAgLy8gRXh0cmFjdCBpdGVtIHZpZXcgY2xhc3MgaWYgcHJvdmlkZWQgZWxz
        ZSBkZWZhdWx0IHRvIHRoZSBzdGFuZGFyZCBjbGFzcwogIHZhciBjb2xsZWN0
        aW9uUHJvdG90eXBlID0gY29sbGVjdGlvbkNsYXNzLnByb3RvKCksCiAgICAg
        IGl0ZW1WaWV3Q2xhc3M7CgogIGlmIChoYXNoLml0ZW1WaWV3KSB7CiAgICB2
        YXIgY29udHJvbGxlciA9IGRhdGEua2V5d29yZHMuY29udHJvbGxlcjsKICAg
        IEVtYmVyLmFzc2VydCgnWW91IHNwZWNpZmllZCBhbiBpdGVtVmlldywgYnV0
        IHRoZSBjdXJyZW50IGNvbnRleHQgaGFzIG5vIGNvbnRhaW5lciB0byBsb29r
        IHRoZSBpdGVtVmlldyB1cCBpbi4gVGhpcyBwcm9iYWJseSBtZWFucyB0aGF0
        IHlvdSBjcmVhdGVkIGEgdmlldyBtYW51YWxseSwgaW5zdGVhZCBvZiB0aHJv
        dWdoIHRoZSBjb250YWluZXIuIEluc3RlYWQsIHVzZSBjb250YWluZXIubG9v
        a3VwKCJ2aWV3OnZpZXdOYW1lIiksIHdoaWNoIHdpbGwgcHJvcGVybHkgaW5z
        dGFudGlhdGUgeW91ciB2aWV3LicsIGNvbnRyb2xsZXIgJiYgY29udHJvbGxl
        ci5jb250YWluZXIpOwogICAgdmFyIGNvbnRhaW5lciA9IGNvbnRyb2xsZXIu
        Y29udGFpbmVyOwogICAgaXRlbVZpZXdDbGFzcyA9IGNvbnRhaW5lci5yZXNv
        bHZlKCd2aWV3OicgKyBFbWJlci5TdHJpbmcuY2FtZWxpemUoaGFzaC5pdGVt
        VmlldykpOwogICAgRW1iZXIuYXNzZXJ0KCdZb3Ugc3BlY2lmaWVkIHRoZSBp
        dGVtVmlldyAnICsgaGFzaC5pdGVtVmlldyArICIsIGJ1dCBpdCB3YXMgbm90
        IGZvdW5kIGF0ICIgKyBjb250YWluZXIuZGVzY3JpYmUoInZpZXc6IiArIGhh
        c2guaXRlbVZpZXcpICsgIiAoYW5kIGl0IHdhcyBub3QgcmVnaXN0ZXJlZCBp
        biB0aGUgY29udGFpbmVyKSIsICEhaXRlbVZpZXdDbGFzcyk7CiAgfSBlbHNl
        IGlmIChoYXNoLml0ZW1WaWV3Q2xhc3MpIHsKICAgIGl0ZW1WaWV3Q2xhc3Mg
        PSBoYW5kbGViYXJzR2V0KGNvbGxlY3Rpb25Qcm90b3R5cGUsIGhhc2guaXRl
        bVZpZXdDbGFzcywgb3B0aW9ucyk7CiAgfSBlbHNlIHsKICAgIGl0ZW1WaWV3
        Q2xhc3MgPSBjb2xsZWN0aW9uUHJvdG90eXBlLml0ZW1WaWV3Q2xhc3M7CiAg
        fQoKICBFbWJlci5hc3NlcnQoZm10KCIlQCAjY29sbGVjdGlvbjogQ291bGQg
        bm90IGZpbmQgaXRlbVZpZXdDbGFzcyAlQCIsIFtkYXRhLnZpZXcsIGl0ZW1W
        aWV3Q2xhc3NdKSwgISFpdGVtVmlld0NsYXNzKTsKCiAgZGVsZXRlIGhhc2gu
        aXRlbVZpZXdDbGFzczsKICBkZWxldGUgaGFzaC5pdGVtVmlldzsKCiAgLy8g
        R28gdGhyb3VnaCBvcHRpb25zIHBhc3NlZCB0byB0aGUge3tjb2xsZWN0aW9u
        fX0gaGVscGVyIGFuZCBleHRyYWN0IG9wdGlvbnMKICAvLyB0aGF0IGNvbmZp
        Z3VyZSBpdGVtIHZpZXdzIGluc3RlYWQgb2YgdGhlIGNvbGxlY3Rpb24gaXRz
        ZWxmLgogIGZvciAodmFyIHByb3AgaW4gaGFzaCkgewogICAgaWYgKGhhc2gu
        aGFzT3duUHJvcGVydHkocHJvcCkpIHsKICAgICAgbWF0Y2ggPSBwcm9wLm1h
        dGNoKC9eaXRlbSguKSguKikkLyk7CgogICAgICBpZiAobWF0Y2ggJiYgcHJv
        cCAhPT0gJ2l0ZW1Db250cm9sbGVyJykgewogICAgICAgIC8vIENvbnZlcnQg
        aXRlbVNob3VsZEZvbyAtPiBzaG91bGRGb28KICAgICAgICBpdGVtSGFzaFtt
        YXRjaFsxXS50b0xvd2VyQ2FzZSgpICsgbWF0Y2hbMl1dID0gaGFzaFtwcm9w
        XTsKICAgICAgICAvLyBEZWxldGUgZnJvbSBoYXNoIGFzIHRoaXMgd2lsbCBl
        bmQgdXAgZ2V0dGluZyBwYXNzZWQgdG8gdGhlCiAgICAgICAgLy8ge3t2aWV3
        fX0gaGVscGVyIG1ldGhvZC4KICAgICAgICBkZWxldGUgaGFzaFtwcm9wXTsK
        ICAgICAgfQogICAgfQogIH0KCiAgaWYgKGZuKSB7CiAgICBpdGVtSGFzaC50
        ZW1wbGF0ZSA9IGZuOwogICAgZGVsZXRlIG9wdGlvbnMuZm47CiAgfQoKICB2
        YXIgZW1wdHlWaWV3Q2xhc3M7CiAgaWYgKGludmVyc2UgJiYgaW52ZXJzZSAh
        PT0gSGFuZGxlYmFycy5WTS5ub29wKSB7CiAgICBlbXB0eVZpZXdDbGFzcyA9
        IGdldChjb2xsZWN0aW9uUHJvdG90eXBlLCAnZW1wdHlWaWV3Q2xhc3MnKTsK
        ICAgIGVtcHR5Vmlld0NsYXNzID0gZW1wdHlWaWV3Q2xhc3MuZXh0ZW5kKHsK
        ICAgICAgICAgIHRlbXBsYXRlOiBpbnZlcnNlLAogICAgICAgICAgdGFnTmFt
        ZTogaXRlbUhhc2gudGFnTmFtZQogICAgfSk7CiAgfSBlbHNlIGlmIChoYXNo
        LmVtcHR5Vmlld0NsYXNzKSB7CiAgICBlbXB0eVZpZXdDbGFzcyA9IGhhbmRs
        ZWJhcnNHZXQodGhpcywgaGFzaC5lbXB0eVZpZXdDbGFzcywgb3B0aW9ucyk7
        CiAgfQogIGlmIChlbXB0eVZpZXdDbGFzcykgeyBoYXNoLmVtcHR5VmlldyA9
        IGVtcHR5Vmlld0NsYXNzOyB9CgogIGlmICghaGFzaC5rZXl3b3JkKSB7CiAg
        ICBpdGVtSGFzaC5fY29udGV4dCA9IEVtYmVyLmNvbXB1dGVkLmFsaWFzKCdj
        b250ZW50Jyk7CiAgfQoKICB2YXIgdmlld09wdGlvbnMgPSBFbWJlci5IYW5k
        bGViYXJzLlZpZXdIZWxwZXIucHJvcGVydGllc0Zyb21IVE1MT3B0aW9ucyh7
        IGRhdGE6IGRhdGEsIGhhc2g6IGl0ZW1IYXNoIH0sIHRoaXMpOwogIGhhc2gu
        aXRlbVZpZXdDbGFzcyA9IGl0ZW1WaWV3Q2xhc3MuZXh0ZW5kKHZpZXdPcHRp
        b25zKTsKCiAgcmV0dXJuIEVtYmVyLkhhbmRsZWJhcnMuaGVscGVycy52aWV3
        LmNhbGwodGhpcywgY29sbGVjdGlvbkNsYXNzLCBvcHRpb25zKTsKfSk7CgoK
        fSkoKTsKCgoKKGZ1bmN0aW9uKCkgewovKmdsb2JhbHMgSGFuZGxlYmFycyAq
        LwovKioKQG1vZHVsZSBlbWJlcgpAc3VibW9kdWxlIGVtYmVyLWhhbmRsZWJh
        cnMKKi8KCnZhciBoYW5kbGViYXJzR2V0ID0gRW1iZXIuSGFuZGxlYmFycy5n
        ZXQ7CgovKioKICBgdW5ib3VuZGAgYWxsb3dzIHlvdSB0byBvdXRwdXQgYSBw
        cm9wZXJ0eSB3aXRob3V0IGJpbmRpbmcuICpJbXBvcnRhbnQ6KiBUaGUKICBv
        dXRwdXQgd2lsbCBub3QgYmUgdXBkYXRlZCBpZiB0aGUgcHJvcGVydHkgY2hh
        bmdlcy4gVXNlIHdpdGggY2F1dGlvbi4KCiAgYGBgaGFuZGxlYmFycwogIDxk
        aXY+e3t1bmJvdW5kIHNvbWVQcm9wZXJ0eVRoYXREb2VzbnRDaGFuZ2V9fTwv
        ZGl2PgogIGBgYAoKICBgdW5ib3VuZGAgY2FuIGFsc28gYmUgdXNlZCBpbiBj
        b25qdW5jdGlvbiB3aXRoIGEgYm91bmQgaGVscGVyIHRvCiAgcmVuZGVyIGl0
        IGluIGl0cyB1bmJvdW5kIGZvcm06CgogIGBgYGhhbmRsZWJhcnMKICA8ZGl2
        Pnt7dW5ib3VuZCBoZWxwZXJOYW1lIHNvbWVQcm9wZXJ0eVRoYXREb2VzbnRD
        aGFuZ2V9fTwvZGl2PgogIGBgYAoKICBAbWV0aG9kIHVuYm91bmQKICBAZm9y
        IEVtYmVyLkhhbmRsZWJhcnMuaGVscGVycwogIEBwYXJhbSB7U3RyaW5nfSBw
        cm9wZXJ0eQogIEByZXR1cm4ge1N0cmluZ30gSFRNTCBzdHJpbmcKKi8KRW1i
        ZXIuSGFuZGxlYmFycy5yZWdpc3RlckhlbHBlcigndW5ib3VuZCcsIGZ1bmN0
        aW9uKHByb3BlcnR5LCBmbikgewogIHZhciBvcHRpb25zID0gYXJndW1lbnRz
        W2FyZ3VtZW50cy5sZW5ndGggLSAxXSwgaGVscGVyLCBjb250ZXh0LCBvdXQ7
        CgogIGlmIChhcmd1bWVudHMubGVuZ3RoID4gMikgewogICAgLy8gVW5ib3Vu
        ZCBoZWxwZXIgY2FsbC4KICAgIG9wdGlvbnMuZGF0YS5pc1VuYm91bmQgPSB0
        cnVlOwogICAgaGVscGVyID0gRW1iZXIuSGFuZGxlYmFycy5oZWxwZXJzW2Fy
        Z3VtZW50c1swXV0gfHwgRW1iZXIuSGFuZGxlYmFycy5oZWxwZXJNaXNzaW5n
        OwogICAgb3V0ID0gaGVscGVyLmFwcGx5KHRoaXMsIEFycmF5LnByb3RvdHlw
        ZS5zbGljZS5jYWxsKGFyZ3VtZW50cywgMSkpOwogICAgZGVsZXRlIG9wdGlv
        bnMuZGF0YS5pc1VuYm91bmQ7CiAgICByZXR1cm4gb3V0OwogIH0KCiAgY29u
        dGV4dCA9IChmbi5jb250ZXh0cyAmJiBmbi5jb250ZXh0cy5sZW5ndGgpID8g
        Zm4uY29udGV4dHNbMF0gOiB0aGlzOwogIHJldHVybiBoYW5kbGViYXJzR2V0
        KGNvbnRleHQsIHByb3BlcnR5LCBmbik7Cn0pOwoKfSkoKTsKCgoKKGZ1bmN0
        aW9uKCkgewovKmpzaGludCBkZWJ1Zzp0cnVlKi8KLyoqCkBtb2R1bGUgZW1i
        ZXIKQHN1Ym1vZHVsZSBlbWJlci1oYW5kbGViYXJzCiovCgp2YXIgaGFuZGxl
        YmFyc0dldCA9IEVtYmVyLkhhbmRsZWJhcnMuZ2V0LCBub3JtYWxpemVQYXRo
        ID0gRW1iZXIuSGFuZGxlYmFycy5ub3JtYWxpemVQYXRoOwoKLyoqCiAgYGxv
        Z2AgYWxsb3dzIHlvdSB0byBvdXRwdXQgdGhlIHZhbHVlIG9mIGEgdmFyaWFi
        bGUgaW4gdGhlIGN1cnJlbnQgcmVuZGVyaW5nCiAgY29udGV4dC4KCiAgYGBg
        aGFuZGxlYmFycwogIHt7bG9nIG15VmFyaWFibGV9fQogIGBgYAoKICBAbWV0
        aG9kIGxvZwogIEBmb3IgRW1iZXIuSGFuZGxlYmFycy5oZWxwZXJzCiAgQHBh
        cmFtIHtTdHJpbmd9IHByb3BlcnR5CiovCkVtYmVyLkhhbmRsZWJhcnMucmVn
        aXN0ZXJIZWxwZXIoJ2xvZycsIGZ1bmN0aW9uKHByb3BlcnR5LCBvcHRpb25z
        KSB7CiAgdmFyIGNvbnRleHQgPSAob3B0aW9ucy5jb250ZXh0cyAmJiBvcHRp
        b25zLmNvbnRleHRzLmxlbmd0aCkgPyBvcHRpb25zLmNvbnRleHRzWzBdIDog
        dGhpcywKICAgICAgbm9ybWFsaXplZCA9IG5vcm1hbGl6ZVBhdGgoY29udGV4
        dCwgcHJvcGVydHksIG9wdGlvbnMuZGF0YSksCiAgICAgIHBhdGhSb290ID0g
        bm9ybWFsaXplZC5yb290LAogICAgICBwYXRoID0gbm9ybWFsaXplZC5wYXRo
        LAogICAgICB2YWx1ZSA9IChwYXRoID09PSAndGhpcycpID8gcGF0aFJvb3Qg
        OiBoYW5kbGViYXJzR2V0KHBhdGhSb290LCBwYXRoLCBvcHRpb25zKTsKICBF
        bWJlci5Mb2dnZXIubG9nKHZhbHVlKTsKfSk7CgovKioKICBFeGVjdXRlIHRo
        ZSBgZGVidWdnZXJgIHN0YXRlbWVudCBpbiB0aGUgY3VycmVudCBjb250ZXh0
        LgoKICBgYGBoYW5kbGViYXJzCiAge3tkZWJ1Z2dlcn19CiAgYGBgCgogIEBt
        ZXRob2QgZGVidWdnZXIKICBAZm9yIEVtYmVyLkhhbmRsZWJhcnMuaGVscGVy
        cwogIEBwYXJhbSB7U3RyaW5nfSBwcm9wZXJ0eQoqLwpFbWJlci5IYW5kbGVi
        YXJzLnJlZ2lzdGVySGVscGVyKCdkZWJ1Z2dlcicsIGZ1bmN0aW9uKG9wdGlv
        bnMpIHsKICBkZWJ1Z2dlcjsKfSk7Cgp9KSgpOwoKCgooZnVuY3Rpb24oKSB7
        Ci8qKgpAbW9kdWxlIGVtYmVyCkBzdWJtb2R1bGUgZW1iZXItaGFuZGxlYmFy
        cwoqLwoKdmFyIGdldCA9IEVtYmVyLmdldCwgc2V0ID0gRW1iZXIuc2V0OwoK
        RW1iZXIuSGFuZGxlYmFycy5FYWNoVmlldyA9IEVtYmVyLkNvbGxlY3Rpb25W
        aWV3LmV4dGVuZChFbWJlci5fTWV0YW1vcnBoLCB7CiAgaW5pdDogZnVuY3Rp
        b24oKSB7CiAgICB2YXIgaXRlbUNvbnRyb2xsZXIgPSBnZXQodGhpcywgJ2l0
        ZW1Db250cm9sbGVyJyk7CiAgICB2YXIgYmluZGluZzsKCiAgICBpZiAoaXRl
        bUNvbnRyb2xsZXIpIHsKICAgICAgdmFyIGNvbnRyb2xsZXIgPSBnZXQodGhp
        cywgJ2NvbnRyb2xsZXIuY29udGFpbmVyJykubG9va3VwRmFjdG9yeSgnY29u
        dHJvbGxlcjphcnJheScpLmNyZWF0ZSh7CiAgICAgICAgcGFyZW50Q29udHJv
        bGxlcjogZ2V0KHRoaXMsICdjb250cm9sbGVyJyksCiAgICAgICAgaXRlbUNv
        bnRyb2xsZXI6IGl0ZW1Db250cm9sbGVyLAogICAgICAgIHRhcmdldDogZ2V0
        KHRoaXMsICdjb250cm9sbGVyJyksCiAgICAgICAgX2VhY2hWaWV3OiB0aGlz
        CiAgICAgIH0pOwoKICAgICAgdGhpcy5kaXNhYmxlQ29udGVudE9ic2VydmVy
        cyhmdW5jdGlvbigpIHsKICAgICAgICBzZXQodGhpcywgJ2NvbnRlbnQnLCBj
        b250cm9sbGVyKTsKICAgICAgICBiaW5kaW5nID0gbmV3IEVtYmVyLkJpbmRp
        bmcoJ2NvbnRlbnQnLCAnX2VhY2hWaWV3LmRhdGFTb3VyY2UnKS5vbmVXYXko
        KTsKICAgICAgICBiaW5kaW5nLmNvbm5lY3QoY29udHJvbGxlcik7CiAgICAg
        IH0pOwoKICAgICAgc2V0KHRoaXMsICdfYXJyYXlDb250cm9sbGVyJywgY29u
        dHJvbGxlcik7CiAgICB9IGVsc2UgewogICAgICB0aGlzLmRpc2FibGVDb250
        ZW50T2JzZXJ2ZXJzKGZ1bmN0aW9uKCkgewogICAgICAgIGJpbmRpbmcgPSBu
        ZXcgRW1iZXIuQmluZGluZygnY29udGVudCcsICdkYXRhU291cmNlJykub25l
        V2F5KCk7CiAgICAgICAgYmluZGluZy5jb25uZWN0KHRoaXMpOwogICAgICB9
        KTsKICAgIH0KCiAgICByZXR1cm4gdGhpcy5fc3VwZXIoKTsKICB9LAoKICBf
        YXNzZXJ0QXJyYXlMaWtlOiBmdW5jdGlvbihjb250ZW50KSB7CiAgICBFbWJl
        ci5hc3NlcnQoIlRoZSB2YWx1ZSB0aGF0ICNlYWNoIGxvb3BzIG92ZXIgbXVz
        dCBiZSBhbiBBcnJheS4gWW91IHBhc3NlZCAiICsgY29udGVudC5jb25zdHJ1
        Y3RvciArICIsIGJ1dCBpdCBzaG91bGQgaGF2ZSBiZWVuIGFuIEFycmF5Q29u
        dHJvbGxlciIsICFFbWJlci5Db250cm9sbGVyTWl4aW4uZGV0ZWN0KGNvbnRl
        bnQpIHx8IChjb250ZW50ICYmIGNvbnRlbnQuaXNHZW5lcmF0ZWQpIHx8IGNv
        bnRlbnQgaW5zdGFuY2VvZiBFbWJlci5BcnJheUNvbnRyb2xsZXIpOwogICAg
        RW1iZXIuYXNzZXJ0KCJUaGUgdmFsdWUgdGhhdCAjZWFjaCBsb29wcyBvdmVy
        IG11c3QgYmUgYW4gQXJyYXkuIFlvdSBwYXNzZWQgIiArICgoRW1iZXIuQ29u
        dHJvbGxlck1peGluLmRldGVjdChjb250ZW50KSAmJiBjb250ZW50LmdldCgn
        bW9kZWwnKSAhPT0gdW5kZWZpbmVkKSA/ICgiIiArIGNvbnRlbnQuZ2V0KCdt
        b2RlbCcpICsgIiAod3JhcHBlZCBpbiAiICsgY29udGVudCArICIpIikgOiAo
        IiIgKyBjb250ZW50KSksIEVtYmVyLkFycmF5LmRldGVjdChjb250ZW50KSk7
        CiAgfSwKCiAgZGlzYWJsZUNvbnRlbnRPYnNlcnZlcnM6IGZ1bmN0aW9uKGNh
        bGxiYWNrKSB7CiAgICBFbWJlci5yZW1vdmVCZWZvcmVPYnNlcnZlcih0aGlz
        LCAnY29udGVudCcsIG51bGwsICdfY29udGVudFdpbGxDaGFuZ2UnKTsKICAg
        IEVtYmVyLnJlbW92ZU9ic2VydmVyKHRoaXMsICdjb250ZW50JywgbnVsbCwg
        J19jb250ZW50RGlkQ2hhbmdlJyk7CgogICAgY2FsbGJhY2suY2FsbCh0aGlz
        KTsKCiAgICBFbWJlci5hZGRCZWZvcmVPYnNlcnZlcih0aGlzLCAnY29udGVu
        dCcsIG51bGwsICdfY29udGVudFdpbGxDaGFuZ2UnKTsKICAgIEVtYmVyLmFk
        ZE9ic2VydmVyKHRoaXMsICdjb250ZW50JywgbnVsbCwgJ19jb250ZW50RGlk
        Q2hhbmdlJyk7CiAgfSwKCiAgaXRlbVZpZXdDbGFzczogRW1iZXIuX01ldGFt
        b3JwaFZpZXcsCiAgZW1wdHlWaWV3Q2xhc3M6IEVtYmVyLl9NZXRhbW9ycGhW
        aWV3LAoKICBjcmVhdGVDaGlsZFZpZXc6IGZ1bmN0aW9uKHZpZXcsIGF0dHJz
        KSB7CiAgICB2aWV3ID0gdGhpcy5fc3VwZXIodmlldywgYXR0cnMpOwoKICAg
        IC8vIEF0IHRoZSBtb21lbnQsIGlmIGEgY29udGFpbmVyIHZpZXcgc3ViY2xh
        c3Mgd2FudHMKICAgIC8vIHRvIGluc2VydCBrZXl3b3JkcywgaXQgaXMgcmVz
        cG9uc2libGUgZm9yIGNsb25pbmcKICAgIC8vIHRoZSBrZXl3b3JkcyBoYXNo
        LiBUaGlzIHdpbGwgYmUgZml4ZWQgbW9tZW50YXJpbHkuCiAgICB2YXIga2V5
        d29yZCA9IGdldCh0aGlzLCAna2V5d29yZCcpOwogICAgdmFyIGNvbnRlbnQg
        PSBnZXQodmlldywgJ2NvbnRlbnQnKTsKCiAgICBpZiAoa2V5d29yZCkgewog
        ICAgICB2YXIgZGF0YSA9IGdldCh2aWV3LCAndGVtcGxhdGVEYXRhJyk7Cgog
        ICAgICBkYXRhID0gRW1iZXIuY29weShkYXRhKTsKICAgICAgZGF0YS5rZXl3
        b3JkcyA9IHZpZXcuY2xvbmVLZXl3b3JkcygpOwogICAgICBzZXQodmlldywg
        J3RlbXBsYXRlRGF0YScsIGRhdGEpOwoKICAgICAgLy8gSW4gdGhpcyBjYXNl
        LCB3ZSBkbyBub3QgYmluZCwgYmVjYXVzZSB0aGUgYGNvbnRlbnRgIG9mCiAg
        ICAgIC8vIGEgI2VhY2ggaXRlbSBjYW5ub3QgY2hhbmdlLgogICAgICBkYXRh
        LmtleXdvcmRzW2tleXdvcmRdID0gY29udGVudDsKICAgIH0KCiAgICAvLyBJ
        ZiB7eyNlYWNofX0gaXMgbG9vcGluZyBvdmVyIGFuIGFycmF5IG9mIGNvbnRy
        b2xsZXJzLAogICAgLy8gcG9pbnQgZWFjaCBjaGlsZCB2aWV3IGF0IHRoZWly
        IHJlc3BlY3RpdmUgY29udHJvbGxlci4KICAgIGlmIChjb250ZW50ICYmIGdl
        dChjb250ZW50LCAnaXNDb250cm9sbGVyJykpIHsKICAgICAgc2V0KHZpZXcs
        ICdjb250cm9sbGVyJywgY29udGVudCk7CiAgICB9CgogICAgcmV0dXJuIHZp
        ZXc7CiAgfSwKCiAgZGVzdHJveTogZnVuY3Rpb24oKSB7CiAgICBpZiAoIXRo
        aXMuX3N1cGVyKCkpIHsgcmV0dXJuOyB9CgogICAgdmFyIGFycmF5Q29udHJv
        bGxlciA9IGdldCh0aGlzLCAnX2FycmF5Q29udHJvbGxlcicpOwoKICAgIGlm
        IChhcnJheUNvbnRyb2xsZXIpIHsKICAgICAgYXJyYXlDb250cm9sbGVyLmRl
        c3Ryb3koKTsKICAgIH0KCiAgICByZXR1cm4gdGhpczsKICB9Cn0pOwoKdmFy
        IEdyb3VwZWRFYWNoID0gRW1iZXIuSGFuZGxlYmFycy5Hcm91cGVkRWFjaCA9
        IGZ1bmN0aW9uKGNvbnRleHQsIHBhdGgsIG9wdGlvbnMpIHsKICB2YXIgc2Vs
        ZiA9IHRoaXMsCiAgICAgIG5vcm1hbGl6ZWQgPSBFbWJlci5IYW5kbGViYXJz
        Lm5vcm1hbGl6ZVBhdGgoY29udGV4dCwgcGF0aCwgb3B0aW9ucy5kYXRhKTsK
        CiAgdGhpcy5jb250ZXh0ID0gY29udGV4dDsKICB0aGlzLnBhdGggPSBwYXRo
        OwogIHRoaXMub3B0aW9ucyA9IG9wdGlvbnM7CiAgdGhpcy50ZW1wbGF0ZSA9
        IG9wdGlvbnMuZm47CiAgdGhpcy5jb250YWluaW5nVmlldyA9IG9wdGlvbnMu
        ZGF0YS52aWV3OwogIHRoaXMubm9ybWFsaXplZFJvb3QgPSBub3JtYWxpemVk
        LnJvb3Q7CiAgdGhpcy5ub3JtYWxpemVkUGF0aCA9IG5vcm1hbGl6ZWQucGF0
        aDsKICB0aGlzLmNvbnRlbnQgPSB0aGlzLmxvb2t1cENvbnRlbnQoKTsKCiAg
        dGhpcy5hZGRDb250ZW50T2JzZXJ2ZXJzKCk7CiAgdGhpcy5hZGRBcnJheU9i
        c2VydmVycygpOwoKICB0aGlzLmNvbnRhaW5pbmdWaWV3Lm9uKCd3aWxsQ2xl
        YXJSZW5kZXInLCBmdW5jdGlvbigpIHsKICAgIHNlbGYuZGVzdHJveSgpOwog
        IH0pOwp9OwoKR3JvdXBlZEVhY2gucHJvdG90eXBlID0gewogIGNvbnRlbnRX
        aWxsQ2hhbmdlOiBmdW5jdGlvbigpIHsKICAgIHRoaXMucmVtb3ZlQXJyYXlP
        YnNlcnZlcnMoKTsKICB9LAoKICBjb250ZW50RGlkQ2hhbmdlOiBmdW5jdGlv
        bigpIHsKICAgIHRoaXMuY29udGVudCA9IHRoaXMubG9va3VwQ29udGVudCgp
        OwogICAgdGhpcy5hZGRBcnJheU9ic2VydmVycygpOwogICAgdGhpcy5yZXJl
        bmRlckNvbnRhaW5pbmdWaWV3KCk7CiAgfSwKCiAgY29udGVudEFycmF5V2ls
        bENoYW5nZTogRW1iZXIuSywKCiAgY29udGVudEFycmF5RGlkQ2hhbmdlOiBm
        dW5jdGlvbigpIHsKICAgIHRoaXMucmVyZW5kZXJDb250YWluaW5nVmlldygp
        OwogIH0sCgogIGxvb2t1cENvbnRlbnQ6IGZ1bmN0aW9uKCkgewogICAgcmV0
        dXJuIEVtYmVyLkhhbmRsZWJhcnMuZ2V0KHRoaXMubm9ybWFsaXplZFJvb3Qs
        IHRoaXMubm9ybWFsaXplZFBhdGgsIHRoaXMub3B0aW9ucyk7CiAgfSwKCiAg
        YWRkQXJyYXlPYnNlcnZlcnM6IGZ1bmN0aW9uKCkgewogICAgaWYgKCF0aGlz
        LmNvbnRlbnQpIHsgcmV0dXJuOyB9CgogICAgdGhpcy5jb250ZW50LmFkZEFy
        cmF5T2JzZXJ2ZXIodGhpcywgewogICAgICB3aWxsQ2hhbmdlOiAnY29udGVu
        dEFycmF5V2lsbENoYW5nZScsCiAgICAgIGRpZENoYW5nZTogJ2NvbnRlbnRB
        cnJheURpZENoYW5nZScKICAgIH0pOwogIH0sCgogIHJlbW92ZUFycmF5T2Jz
        ZXJ2ZXJzOiBmdW5jdGlvbigpIHsKICAgIGlmICghdGhpcy5jb250ZW50KSB7
        IHJldHVybjsgfQoKICAgIHRoaXMuY29udGVudC5yZW1vdmVBcnJheU9ic2Vy
        dmVyKHRoaXMsIHsKICAgICAgd2lsbENoYW5nZTogJ2NvbnRlbnRBcnJheVdp
        bGxDaGFuZ2UnLAogICAgICBkaWRDaGFuZ2U6ICdjb250ZW50QXJyYXlEaWRD
        aGFuZ2UnCiAgICB9KTsKICB9LAoKICBhZGRDb250ZW50T2JzZXJ2ZXJzOiBm
        dW5jdGlvbigpIHsKICAgIEVtYmVyLmFkZEJlZm9yZU9ic2VydmVyKHRoaXMu
        bm9ybWFsaXplZFJvb3QsIHRoaXMubm9ybWFsaXplZFBhdGgsIHRoaXMsIHRo
        aXMuY29udGVudFdpbGxDaGFuZ2UpOwogICAgRW1iZXIuYWRkT2JzZXJ2ZXIo
        dGhpcy5ub3JtYWxpemVkUm9vdCwgdGhpcy5ub3JtYWxpemVkUGF0aCwgdGhp
        cywgdGhpcy5jb250ZW50RGlkQ2hhbmdlKTsKICB9LAoKICByZW1vdmVDb250
        ZW50T2JzZXJ2ZXJzOiBmdW5jdGlvbigpIHsKICAgIEVtYmVyLnJlbW92ZUJl
        Zm9yZU9ic2VydmVyKHRoaXMubm9ybWFsaXplZFJvb3QsIHRoaXMubm9ybWFs
        aXplZFBhdGgsIHRoaXMuY29udGVudFdpbGxDaGFuZ2UpOwogICAgRW1iZXIu
        cmVtb3ZlT2JzZXJ2ZXIodGhpcy5ub3JtYWxpemVkUm9vdCwgdGhpcy5ub3Jt
        YWxpemVkUGF0aCwgdGhpcy5jb250ZW50RGlkQ2hhbmdlKTsKICB9LAoKICBy
        ZW5kZXI6IGZ1bmN0aW9uKCkgewogICAgaWYgKCF0aGlzLmNvbnRlbnQpIHsg
        cmV0dXJuOyB9CgogICAgdmFyIGNvbnRlbnQgPSB0aGlzLmNvbnRlbnQsCiAg
        ICAgICAgY29udGVudExlbmd0aCA9IGdldChjb250ZW50LCAnbGVuZ3RoJyks
        CiAgICAgICAgZGF0YSA9IHRoaXMub3B0aW9ucy5kYXRhLAogICAgICAgIHRl
        bXBsYXRlID0gdGhpcy50ZW1wbGF0ZTsKCiAgICBkYXRhLmluc2lkZUVhY2gg
        PSB0cnVlOwogICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjb250ZW50TGVuZ3Ro
        OyBpKyspIHsKICAgICAgdGVtcGxhdGUoY29udGVudC5vYmplY3RBdChpKSwg
        eyBkYXRhOiBkYXRhIH0pOwogICAgfQogIH0sCgogIHJlcmVuZGVyQ29udGFp
        bmluZ1ZpZXc6IGZ1bmN0aW9uKCkgewogICAgdmFyIHNlbGYgPSB0aGlzOwog
        ICAgRW1iZXIucnVuLnNjaGVkdWxlT25jZSgncmVuZGVyJywgdGhpcywgZnVu
        Y3Rpb24oKSB7CiAgICAgIC8vIEl0J3MgcG9zc2libGUgaXQncyBiZWVuIGRl
        c3Ryb3llZCBhZnRlciB3ZSBlbnF1ZXVlZCBhIHJlLXJlbmRlciBjYWxsLgog
        ICAgICBpZiAoIXNlbGYuZGVzdHJveWVkKSB7CiAgICAgICAgc2VsZi5jb250
        YWluaW5nVmlldy5yZXJlbmRlcigpOwogICAgICB9CiAgICB9KTsKICB9LAoK
        ICBkZXN0cm95OiBmdW5jdGlvbigpIHsKICAgIHRoaXMucmVtb3ZlQ29udGVu
        dE9ic2VydmVycygpOwogICAgaWYgKHRoaXMuY29udGVudCkgewogICAgICB0
        aGlzLnJlbW92ZUFycmF5T2JzZXJ2ZXJzKCk7CiAgICB9CiAgICB0aGlzLmRl
        c3Ryb3llZCA9IHRydWU7CiAgfQp9OwoKLyoqCiAgVGhlIGB7eyNlYWNofX1g
        IGhlbHBlciBsb29wcyBvdmVyIGVsZW1lbnRzIGluIGEgY29sbGVjdGlvbiwg
        cmVuZGVyaW5nIGl0cwogIGJsb2NrIG9uY2UgZm9yIGVhY2ggaXRlbS4gSXQg
        aXMgYW4gZXh0ZW5zaW9uIG9mIHRoZSBiYXNlIEhhbmRsZWJhcnMgYHt7I2Vh
        Y2h9fWAKICBoZWxwZXI6CgogIGBgYGphdmFzY3JpcHQKICBEZXZlbG9wZXJz
        ID0gW3tuYW1lOiAnWWVodWRhJ30se25hbWU6ICdUb20nfSwge25hbWU6ICdQ
        YXVsJ31dOwogIGBgYAoKICBgYGBoYW5kbGViYXJzCiAge3sjZWFjaCBEZXZl
        bG9wZXJzfX0KICAgIHt7bmFtZX19CiAge3svZWFjaH19CiAgYGBgCgogIGB7
        e2VhY2h9fWAgc3VwcG9ydHMgYW4gYWx0ZXJuYXRpdmUgc3ludGF4IHdpdGgg
        ZWxlbWVudCBuYW1pbmc6CgogIGBgYGhhbmRsZWJhcnMKICB7eyNlYWNoIHBl
        cnNvbiBpbiBEZXZlbG9wZXJzfX0KICAgIHt7cGVyc29uLm5hbWV9fQogIHt7
        L2VhY2h9fQogIGBgYAoKICBXaGVuIGxvb3Bpbmcgb3ZlciBvYmplY3RzIHRo
        YXQgZG8gbm90IGhhdmUgcHJvcGVydGllcywgYHt7dGhpc319YCBjYW4gYmUg
        dXNlZAogIHRvIHJlbmRlciB0aGUgb2JqZWN0OgoKICBgYGBqYXZhc2NyaXB0
        CiAgRGV2ZWxvcGVyTmFtZXMgPSBbJ1llaHVkYScsICdUb20nLCAnUGF1bCdd
        CiAgYGBgCgogIGBgYGhhbmRsZWJhcnMKICB7eyNlYWNoIERldmVsb3Blck5h
        bWVzfX0KICAgIHt7dGhpc319CiAge3svZWFjaH19CiAgYGBgCiAgIyMjIHt7
        ZWxzZX19IGNvbmRpdGlvbgogIGB7eyNlYWNofX1gIGNhbiBoYXZlIGEgbWF0
        Y2hpbmcgYHt7ZWxzZX19YC4gVGhlIGNvbnRlbnRzIG9mIHRoaXMgYmxvY2sg
        d2lsbCByZW5kZXIKICBpZiB0aGUgY29sbGVjdGlvbiBpcyBlbXB0eS4KCiAg
        YGBgCiAge3sjZWFjaCBwZXJzb24gaW4gRGV2ZWxvcGVyc319CiAgICB7e3Bl
        cnNvbi5uYW1lfX0KICB7e2Vsc2V9fQogICAgPHA+U29ycnksIG5vYm9keSBp
        cyBhdmFpbGFibGUgZm9yIHRoaXMgdGFzay48L3A+CiAge3svZWFjaH19CiAg
        YGBgCiAgIyMjIFNwZWNpZnlpbmcgYSBWaWV3IGNsYXNzIGZvciBpdGVtcwog
        IElmIHlvdSBwcm92aWRlIGFuIGBpdGVtVmlld0NsYXNzYCBvcHRpb24gdGhh
        dCByZWZlcmVuY2VzIGEgdmlldyBjbGFzcwogIHdpdGggaXRzIG93biBgdGVt
        cGxhdGVgIHlvdSBjYW4gb21pdCB0aGUgYmxvY2suCgogIFRoZSBmb2xsb3dp
        bmcgdGVtcGxhdGU6CgogIGBgYGhhbmRsZWJhcnMKICB7eyN2aWV3IEFwcC5N
        eVZpZXcgfX0KICAgIHt7ZWFjaCB2aWV3Lml0ZW1zIGl0ZW1WaWV3Q2xhc3M9
        IkFwcC5Bbkl0ZW1WaWV3In19CiAge3svdmlld319CiAgYGBgCgogIEFuZCBh
        cHBsaWNhdGlvbiBjb2RlCgogIGBgYGphdmFzY3JpcHQKICBBcHAgPSBFbWJl
        ci5BcHBsaWNhdGlvbi5jcmVhdGUoewogICAgTXlWaWV3OiBFbWJlci5WaWV3
        LmV4dGVuZCh7CiAgICAgIGl0ZW1zOiBbCiAgICAgICAgRW1iZXIuT2JqZWN0
        LmNyZWF0ZSh7bmFtZTogJ0RhdmUnfSksCiAgICAgICAgRW1iZXIuT2JqZWN0
        LmNyZWF0ZSh7bmFtZTogJ01hcnknfSksCiAgICAgICAgRW1iZXIuT2JqZWN0
        LmNyZWF0ZSh7bmFtZTogJ1NhcmEnfSkKICAgICAgXQogICAgfSkKICB9KTsK
        CiAgQXBwLkFuSXRlbVZpZXcgPSBFbWJlci5WaWV3LmV4dGVuZCh7CiAgICB0
        ZW1wbGF0ZTogRW1iZXIuSGFuZGxlYmFycy5jb21waWxlKCJHcmVldGluZ3Mg
        e3tuYW1lfX0iKQogIH0pOwogIGBgYAoKICBXaWxsIHJlc3VsdCBpbiB0aGUg
        SFRNTCBzdHJ1Y3R1cmUgYmVsb3cKCiAgYGBgaHRtbAogIDxkaXYgY2xhc3M9
        ImVtYmVyLXZpZXciPgogICAgPGRpdiBjbGFzcz0iZW1iZXItdmlldyI+R3Jl
        ZXRpbmdzIERhdmU8L2Rpdj4KICAgIDxkaXYgY2xhc3M9ImVtYmVyLXZpZXci
        PkdyZWV0aW5ncyBNYXJ5PC9kaXY+CiAgICA8ZGl2IGNsYXNzPSJlbWJlci12
        aWV3Ij5HcmVldGluZ3MgU2FyYTwvZGl2PgogIDwvZGl2PgogIGBgYAoKICBJ
        ZiBhbiBgaXRlbVZpZXdDbGFzc2AgaXMgZGVmaW5lZCBvbiB0aGUgaGVscGVy
        LCBhbmQgdGhlcmVmb3JlIHRoZSBoZWxwZXIgaXMgbm90CiAgYmVpbmcgdXNl
        ZCBhcyBhIGJsb2NrLCBhbiBgZW1wdHlWaWV3Q2xhc3NgIGNhbiBhbHNvIGJl
        IHByb3ZpZGVkIG9wdGlvbmFsbHkuCiAgVGhlIGBlbXB0eVZpZXdDbGFzc2Ag
        d2lsbCBtYXRjaCB0aGUgYmVoYXZpb3Igb2YgdGhlIGB7e2Vsc2V9fWAgY29u
        ZGl0aW9uCiAgZGVzY3JpYmVkIGFib3ZlLiBUaGF0IGlzLCB0aGUgYGVtcHR5
        Vmlld0NsYXNzYCB3aWxsIHJlbmRlciBpZiB0aGUgY29sbGVjdGlvbgogIGlz
        IGVtcHR5LgoKICAjIyMgUmVwcmVzZW50aW5nIGVhY2ggaXRlbSB3aXRoIGEg
        Q29udHJvbGxlci4KICBCeSBkZWZhdWx0IHRoZSBjb250cm9sbGVyIGxvb2t1
        cCB3aXRoaW4gYW4gYHt7I2VhY2h9fWAgYmxvY2sgd2lsbCBiZQogIHRoZSBj
        b250cm9sbGVyIG9mIHRoZSB0ZW1wbGF0ZSB3aGVyZSB0aGUgYHt7I2VhY2h9
        fWAgd2FzIHVzZWQuIElmIGVhY2gKICBpdGVtIG5lZWRzIHRvIGJlIHByZXNl
        bnRlZCBieSBhIGN1c3RvbSBjb250cm9sbGVyIHlvdSBjYW4gcHJvdmlkZSBh
        CiAgYGl0ZW1Db250cm9sbGVyYCBvcHRpb24gd2hpY2ggcmVmZXJlbmNlcyBh
        IGNvbnRyb2xsZXIgYnkgbG9va3VwIG5hbWUuCiAgRWFjaCBpdGVtIGluIHRo
        ZSBsb29wIHdpbGwgYmUgd3JhcHBlZCBpbiBhbiBpbnN0YW5jZSBvZiB0aGlz
        IGNvbnRyb2xsZXIKICBhbmQgdGhlIGl0ZW0gaXRzZWxmIHdpbGwgYmUgc2V0
        IHRvIHRoZSBgY29udGVudGAgcHJvcGVydHkgb2YgdGhhdCBjb250cm9sbGVy
        LgoKICBUaGlzIGlzIHVzZWZ1bCBpbiBjYXNlcyB3aGVyZSBwcm9wZXJ0aWVz
        IG9mIG1vZGVsIG9iamVjdHMgbmVlZCB0cmFuc2Zvcm1hdGlvbgogIG9yIHN5
        bnRoZXNpcyBmb3IgZGlzcGxheToKCiAgYGBgamF2YXNjcmlwdAogIEFwcC5E
        ZXZlbG9wZXJDb250cm9sbGVyID0gRW1iZXIuT2JqZWN0Q29udHJvbGxlci5l
        eHRlbmQoewogICAgaXNBdmFpbGFibGVGb3JIaXJlOiBmdW5jdGlvbigpIHsK
        ICAgICAgcmV0dXJuICF0aGlzLmdldCgnY29udGVudC5pc0VtcGxveWVkJykg
        JiYgdGhpcy5nZXQoJ2NvbnRlbnQuaXNTZWVraW5nV29yaycpOwogICAgfS5w
        cm9wZXJ0eSgnaXNFbXBsb3llZCcsICdpc1NlZWtpbmdXb3JrJykKICB9KQog
        IGBgYAoKICBgYGBoYW5kbGViYXJzCiAge3sjZWFjaCBwZXJzb24gaW4gZGV2
        ZWxvcGVycyBpdGVtQ29udHJvbGxlcj0iZGV2ZWxvcGVyIn19CiAgICB7e3Bl
        cnNvbi5uYW1lfX0ge3sjaWYgcGVyc29uLmlzQXZhaWxhYmxlRm9ySGlyZX19
        SGlyZSBtZSF7ey9pZn19CiAge3svZWFjaH19CiAgYGBgCgogIEVhY2ggaXRl
        bUNvbnRyb2xsZXIgd2lsbCByZWNlaXZlIGEgcmVmZXJlbmNlIHRvIHRoZSBj
        dXJyZW50IGNvbnRyb2xsZXIgYXMKICBhIGBwYXJlbnRDb250cm9sbGVyYCBw
        cm9wZXJ0eS4KCiAgIyMjIChFeHBlcmltZW50YWwpIEdyb3VwZWQgRWFjaAoK
        ICBXaGVuIHVzZWQgaW4gY29uanVuY3Rpb24gd2l0aCB0aGUgZXhwZXJpbWVu
        dGFsIFtncm91cCBoZWxwZXJdKGh0dHBzOi8vZ2l0aHViLmNvbS9lbWJlcmpz
        L2dyb3VwLWhlbHBlciksCiAgeW91IGNhbiBpbmZvcm0gSGFuZGxlYmFycyB0
        byByZS1yZW5kZXIgYW4gZW50aXJlIGdyb3VwIG9mIGl0ZW1zIGluc3RlYWQg
        b2YKICByZS1yZW5kZXJpbmcgdGhlbSBvbmUgYXQgYSB0aW1lIChpbiB0aGUg
        ZXZlbnQgdGhhdCB0aGV5IGFyZSBjaGFuZ2VkIGVuIG1hc3NlCiAgb3IgYW4g
        aXRlbSBpcyBhZGRlZC9yZW1vdmVkKS4KCiAgYGBgaGFuZGxlYmFycwogIHt7
        I2dyb3VwfX0KICAgIHt7I2VhY2ggcGVvcGxlfX0KICAgICAge3tmaXJzdE5h
        bWV9fSB7e2xhc3ROYW1lfX0KICAgIHt7L2VhY2h9fQogIHt7L2dyb3VwfX0K
        ICBgYGAKCiAgVGhpcyBjYW4gYmUgZmFzdGVyIHRoYW4gdGhlIG5vcm1hbCB3
        YXkgdGhhdCBIYW5kbGViYXJzIHJlLXJlbmRlcnMgaXRlbXMKICBpbiBzb21l
        IGNhc2VzLgoKICBJZiBmb3Igc29tZSByZWFzb24geW91IGhhdmUgYSBncm91
        cCB3aXRoIG1vcmUgdGhhbiBvbmUgYCNlYWNoYCwgeW91IGNhbiBtYWtlCiAg
        b25lIG9mIHRoZSBjb2xsZWN0aW9ucyBiZSB1cGRhdGVkIGluIG5vcm1hbCAo
        bm9uLWdyb3VwZWQpIGZhc2hpb24gYnkgc2V0dGluZwogIHRoZSBvcHRpb24g
        YGdyb3VwZWRSb3dzPXRydWVgIChjb3VudGVyLWludHVpdGl2ZSwgSSBrbm93
        KS4KCiAgRm9yIGV4YW1wbGUsCgogIGBgYGhhbmRsZWJhcnMKICB7e2RlYWxl
        cnNoaXBOYW1lfX0KCiAge3sjZ3JvdXB9fQogICAge3sjZWFjaCBkZWFsZXJz
        fX0KICAgICAge3tmaXJzdE5hbWV9fSB7e2xhc3ROYW1lfX0KICAgIHt7L2Vh
        Y2h9fQoKICAgIHt7I2VhY2ggY2FyIGluIGNhcnMgZ3JvdXBlZFJvd3M9dHJ1
        ZX19CiAgICAgIHt7Y2FyLm1ha2V9fSB7e2Nhci5tb2RlbH19IHt7Y2FyLmNv
        bG9yfX0KICAgIHt7L2VhY2h9fQogIHt7L2dyb3VwfX0KICBgYGAKICBBbnkg
        Y2hhbmdlIHRvIGBkZWFsZXJzaGlwTmFtZWAgb3IgdGhlIGBkZWFsZXJzYCBj
        b2xsZWN0aW9uIHdpbGwgY2F1c2UgdGhlCiAgZW50aXJlIGdyb3VwIHRvIGJl
        IHJlLXJlbmRlcmVkLiBIb3dldmVyLCBjaGFuZ2VzIHRvIHRoZSBgY2Fyc2Ag
        Y29sbGVjdGlvbgogIHdpbGwgYmUgcmUtcmVuZGVyZWQgaW5kaXZpZHVhbGx5
        IChhcyBub3JtYWwpLgoKICBOb3RlIHRoYXQgYGdyb3VwYCBiZWhhdmlvciBp
        cyBhbHNvIGRpc2FibGVkIGJ5IHNwZWNpZnlpbmcgYW4gYGl0ZW1WaWV3Q2xh
        c3NgLgoKICBAbWV0aG9kIGVhY2gKICBAZm9yIEVtYmVyLkhhbmRsZWJhcnMu
        aGVscGVycwogIEBwYXJhbSBbbmFtZV0ge1N0cmluZ30gbmFtZSBmb3IgaXRl
        bSAodXNlZCB3aXRoIGBpbmApCiAgQHBhcmFtIFtwYXRoXSB7U3RyaW5nfSBw
        YXRoCiAgQHBhcmFtIFtvcHRpb25zXSB7T2JqZWN0fSBIYW5kbGViYXJzIGtl
        eS92YWx1ZSBwYWlycyBvZiBvcHRpb25zCiAgQHBhcmFtIFtvcHRpb25zLml0
        ZW1WaWV3Q2xhc3NdIHtTdHJpbmd9IGEgcGF0aCB0byBhIHZpZXcgY2xhc3Mg
        dXNlZCBmb3IgZWFjaCBpdGVtCiAgQHBhcmFtIFtvcHRpb25zLml0ZW1Db250
        cm9sbGVyXSB7U3RyaW5nfSBuYW1lIG9mIGEgY29udHJvbGxlciB0byBiZSBj
        cmVhdGVkIGZvciBlYWNoIGl0ZW0KICBAcGFyYW0gW29wdGlvbnMuZ3JvdXBl
        ZFJvd3NdIHtib29sZWFufSBlbmFibGUgbm9ybWFsIGl0ZW0tYnktaXRlbSBy
        ZW5kZXJpbmcgd2hlbiBpbnNpZGUgYSBgI2dyb3VwYCBoZWxwZXIKKi8KRW1i
        ZXIuSGFuZGxlYmFycy5yZWdpc3RlckhlbHBlcignZWFjaCcsIGZ1bmN0aW9u
        KHBhdGgsIG9wdGlvbnMpIHsKICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0g
        NCkgewogICAgRW1iZXIuYXNzZXJ0KCJJZiB5b3UgcGFzcyBtb3JlIHRoYW4g
        b25lIGFyZ3VtZW50IHRvIHRoZSBlYWNoIGhlbHBlciwgaXQgbXVzdCBiZSBp
        biB0aGUgZm9ybSAjZWFjaCBmb28gaW4gYmFyIiwgYXJndW1lbnRzWzFdID09
        PSAiaW4iKTsKCiAgICB2YXIga2V5d29yZE5hbWUgPSBhcmd1bWVudHNbMF07
        CgogICAgb3B0aW9ucyA9IGFyZ3VtZW50c1szXTsKICAgIHBhdGggPSBhcmd1
        bWVudHNbMl07CiAgICBpZiAocGF0aCA9PT0gJycpIHsgcGF0aCA9ICJ0aGlz
        IjsgfQoKICAgIG9wdGlvbnMuaGFzaC5rZXl3b3JkID0ga2V5d29yZE5hbWU7
        CiAgfQoKICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMSkgewogICAgb3B0
        aW9ucyA9IHBhdGg7CiAgICBwYXRoID0gJ3RoaXMnOwogIH0KCiAgb3B0aW9u
        cy5oYXNoLmRhdGFTb3VyY2VCaW5kaW5nID0gcGF0aDsKICAvLyBTZXQgdXAg
        ZW1wdHlWaWV3IGFzIGEgbWV0YW1vcnBoIHdpdGggbm8gdGFnCiAgLy9vcHRp
        b25zLmhhc2guZW1wdHlWaWV3Q2xhc3MgPSBFbWJlci5fTWV0YW1vcnBoVmll
        dzsKCiAgaWYgKG9wdGlvbnMuZGF0YS5pbnNpZGVHcm91cCAmJiAhb3B0aW9u
        cy5oYXNoLmdyb3VwZWRSb3dzICYmICFvcHRpb25zLmhhc2guaXRlbVZpZXdD
        bGFzcykgewogICAgbmV3IEVtYmVyLkhhbmRsZWJhcnMuR3JvdXBlZEVhY2go
        dGhpcywgcGF0aCwgb3B0aW9ucykucmVuZGVyKCk7CiAgfSBlbHNlIHsKICAg
        IHJldHVybiBFbWJlci5IYW5kbGViYXJzLmhlbHBlcnMuY29sbGVjdGlvbi5j
        YWxsKHRoaXMsICdFbWJlci5IYW5kbGViYXJzLkVhY2hWaWV3Jywgb3B0aW9u
        cyk7CiAgfQp9KTsKCn0pKCk7CgoKCihmdW5jdGlvbigpIHsKLyoqCkBtb2R1
        bGUgZW1iZXIKQHN1Ym1vZHVsZSBlbWJlci1oYW5kbGViYXJzCiovCgovKioK
        ICBgdGVtcGxhdGVgIGFsbG93cyB5b3UgdG8gcmVuZGVyIGEgdGVtcGxhdGUg
        ZnJvbSBpbnNpZGUgYW5vdGhlciB0ZW1wbGF0ZS4KICBUaGlzIGFsbG93cyB5
        b3UgdG8gcmUtdXNlIHRoZSBzYW1lIHRlbXBsYXRlIGluIG11bHRpcGxlIHBs
        YWNlcy4gRm9yIGV4YW1wbGU6CgogIGBgYGh0bWwKICA8c2NyaXB0IHR5cGU9
        InRleHQveC1oYW5kbGViYXJzIiBkYXRhLXRlbXBsYXRlLW5hbWU9ImxvZ2dl
        ZF9pbl91c2VyIj4KICAgIHt7I3dpdGggbG9nZ2VkSW5Vc2VyfX0KICAgICAg
        TGFzdCBMb2dpbjoge3tsYXN0TG9naW59fQogICAgICBVc2VyIEluZm86IHt7
        dGVtcGxhdGUgInVzZXJfaW5mbyJ9fQogICAge3svd2l0aH19CiAgPC9zY3Jp
        cHQ+CiAgYGBgCgogIGBgYGh0bWwKICA8c2NyaXB0IHR5cGU9InRleHQveC1o
        YW5kbGViYXJzIiBkYXRhLXRlbXBsYXRlLW5hbWU9InVzZXJfaW5mbyI+CiAg
        ICBOYW1lOiA8ZW0+e3tuYW1lfX08L2VtPgogICAgS2FybWE6IDxlbT57e2th
        cm1hfX08L2VtPgogIDwvc2NyaXB0PgogIGBgYAoKICBgYGBoYW5kbGViYXJz
        CiAge3sjaWYgaXNVc2VyfX0KICAgIHt7dGVtcGxhdGUgInVzZXJfaW5mbyJ9
        fQogIHt7ZWxzZX19CiAgICB7e3RlbXBsYXRlICJ1bmxvZ2dlZF91c2VyX2lu
        Zm8ifX0KICB7ey9pZn19CiAgYGBgCgogIFRoaXMgaGVscGVyIGxvb2tzIGZv
        ciB0ZW1wbGF0ZXMgaW4gdGhlIGdsb2JhbCBgRW1iZXIuVEVNUExBVEVTYCBo
        YXNoLiBJZiB5b3UKICBhZGQgYDxzY3JpcHQ+YCB0YWdzIHRvIHlvdXIgcGFn
        ZSB3aXRoIHRoZSBgZGF0YS10ZW1wbGF0ZS1uYW1lYCBhdHRyaWJ1dGUgc2V0
        LAogIHRoZXkgd2lsbCBiZSBjb21waWxlZCBhbmQgcGxhY2VkIGluIHRoaXMg
        aGFzaCBhdXRvbWF0aWNhbGx5LgoKICBZb3UgY2FuIGFsc28gbWFudWFsbHkg
        cmVnaXN0ZXIgdGVtcGxhdGVzIGJ5IGFkZGluZyB0aGVtIHRvIHRoZSBoYXNo
        OgoKICBgYGBqYXZhc2NyaXB0CiAgRW1iZXIuVEVNUExBVEVTWyJteV9jb29s
        X3RlbXBsYXRlIl0gPSBFbWJlci5IYW5kbGViYXJzLmNvbXBpbGUoJzxiPnt7
        dXNlcn19PC9iPicpOwogIGBgYAoKICBAZGVwcmVjYXRlZAogIEBtZXRob2Qg
        dGVtcGxhdGUKICBAZm9yIEVtYmVyLkhhbmRsZWJhcnMuaGVscGVycwogIEBw
        YXJhbSB7U3RyaW5nfSB0ZW1wbGF0ZU5hbWUgdGhlIHRlbXBsYXRlIHRvIHJl
        bmRlcgoqLwoKRW1iZXIuSGFuZGxlYmFycy5yZWdpc3RlckhlbHBlcigndGVt
        cGxhdGUnLCBmdW5jdGlvbihuYW1lLCBvcHRpb25zKSB7CiAgRW1iZXIuZGVw
        cmVjYXRlKCJUaGUgYHRlbXBsYXRlYCBoZWxwZXIgaGFzIGJlZW4gZGVwcmVj
        YXRlZCBpbiBmYXZvciBvZiB0aGUgYHBhcnRpYWxgIGhlbHBlci4gUGxlYXNl
        IHVzZSBgcGFydGlhbGAgaW5zdGVhZCwgd2hpY2ggd2lsbCB3b3JrIHRoZSBz
        YW1lIHdheS4iKTsKICByZXR1cm4gRW1iZXIuSGFuZGxlYmFycy5oZWxwZXJz
        LnBhcnRpYWwuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKfSk7Cgp9KSgpOwoK
        CgooZnVuY3Rpb24oKSB7Ci8qKgpAbW9kdWxlIGVtYmVyCkBzdWJtb2R1bGUg
        ZW1iZXItaGFuZGxlYmFycwoqLwoKLyoqCiAgYHBhcnRpYWxgIHJlbmRlcnMg
        YSB0ZW1wbGF0ZSBkaXJlY3RseSB1c2luZyB0aGUgY3VycmVudCBjb250ZXh0
        LgogIElmIG5lZWRlZCB0aGUgY29udGV4dCBjYW4gYmUgc2V0IHVzaW5nIHRo
        ZSBge3sjd2l0aCBmb299fWAgaGVscGVyLgoKICBgYGBodG1sCiAgPHNjcmlw
        dCB0eXBlPSJ0ZXh0L3gtaGFuZGxlYmFycyIgZGF0YS10ZW1wbGF0ZS1uYW1l
        PSJoZWFkZXJfYmFyIj4KICAgIHt7I3dpdGggY3VycmVudFVzZXJ9fQogICAg
        ICB7e3BhcnRpYWwgdXNlcl9pbmZvfX0KICAgIHt7L3dpdGh9fQogIDwvc2Ny
        aXB0PgogIGBgYAoKICBUaGUgYGRhdGEtdGVtcGxhdGUtbmFtZWAgYXR0cmli
        dXRlIG9mIGEgcGFydGlhbCB0ZW1wbGF0ZQogIGlzIHByZWZpeGVkIHdpdGgg
        YW4gdW5kZXJzY29yZS4KCiAgYGBgaHRtbAogIDxzY3JpcHQgdHlwZT0idGV4
        dC94LWhhbmRsZWJhcnMiIGRhdGEtdGVtcGxhdGUtbmFtZT0iX3VzZXJfaW5m
        byI+CiAgICA8c3Bhbj5IZWxsbyB7e3VzZXJuYW1lfX0hPC9zcGFuPgogIDwv
        c2NyaXB0PgogIGBgYAoKICBAbWV0aG9kIHBhcnRpYWwKICBAZm9yIEVtYmVy
        LkhhbmRsZWJhcnMuaGVscGVycwogIEBwYXJhbSB7U3RyaW5nfSBwYXJ0aWFs
        TmFtZSB0aGUgbmFtZSBvZiB0aGUgdGVtcGxhdGUgdG8gcmVuZGVyIG1pbnVz
        IHRoZSBsZWFkaW5nIHVuZGVyc2NvcmUKKi8KCkVtYmVyLkhhbmRsZWJhcnMu
        cmVnaXN0ZXJIZWxwZXIoJ3BhcnRpYWwnLCBmdW5jdGlvbihuYW1lLCBvcHRp
        b25zKSB7CiAgdmFyIG5hbWVQYXJ0cyA9IG5hbWUuc3BsaXQoIi8iKSwKICAg
        ICAgbGFzdFBhcnQgPSBuYW1lUGFydHNbbmFtZVBhcnRzLmxlbmd0aCAtIDFd
        OwoKICBuYW1lUGFydHNbbmFtZVBhcnRzLmxlbmd0aCAtIDFdID0gIl8iICsg
        bGFzdFBhcnQ7CgogIHZhciB2aWV3ID0gb3B0aW9ucy5kYXRhLnZpZXcsCiAg
        ICAgIHVuZGVyc2NvcmVkTmFtZSA9IG5hbWVQYXJ0cy5qb2luKCIvIiksCiAg
        ICAgIHRlbXBsYXRlID0gdmlldy50ZW1wbGF0ZUZvck5hbWUodW5kZXJzY29y
        ZWROYW1lKSwKICAgICAgZGVwcmVjYXRlZFRlbXBsYXRlID0gIXRlbXBsYXRl
        ICYmIHZpZXcudGVtcGxhdGVGb3JOYW1lKG5hbWUpOwoKICBFbWJlci5hc3Nl
        cnQoIlVuYWJsZSB0byBmaW5kIHBhcnRpYWwgd2l0aCBuYW1lICciK25hbWUr
        IicuIiwgdGVtcGxhdGUgfHwgZGVwcmVjYXRlZFRlbXBsYXRlKTsKCiAgdGVt
        cGxhdGUgPSB0ZW1wbGF0ZSB8fCBkZXByZWNhdGVkVGVtcGxhdGU7CgogIHRl
        bXBsYXRlKHRoaXMsIHsgZGF0YTogb3B0aW9ucy5kYXRhIH0pOwp9KTsKCn0p
        KCk7CgoKCihmdW5jdGlvbigpIHsKLyoqCkBtb2R1bGUgZW1iZXIKQHN1Ym1v
        ZHVsZSBlbWJlci1oYW5kbGViYXJzCiovCgp2YXIgZ2V0ID0gRW1iZXIuZ2V0
        LCBzZXQgPSBFbWJlci5zZXQ7CgovKioKICBge3t5aWVsZH19YCBkZW5vdGVz
        IGFuIGFyZWEgb2YgYSB0ZW1wbGF0ZSB0aGF0IHdpbGwgYmUgcmVuZGVyZWQg
        aW5zaWRlCiAgb2YgYW5vdGhlciB0ZW1wbGF0ZS4gSXQgaGFzIHR3byBtYWlu
        IHVzZXM6CgogICMjIyBVc2Ugd2l0aCBgbGF5b3V0YAogIFdoZW4gdXNlZCBp
        biBhIEhhbmRsZWJhcnMgdGVtcGxhdGUgdGhhdCBpcyBhc3NpZ25lZCB0byBh
        biBgRW1iZXIuVmlld2AKICBpbnN0YW5jZSdzIGBsYXlvdXRgIHByb3BlcnR5
        IEVtYmVyIHdpbGwgcmVuZGVyIHRoZSBsYXlvdXQgdGVtcGxhdGUgZmlyc3Qs
        CiAgaW5zZXJ0aW5nIHRoZSB2aWV3J3Mgb3duIHJlbmRlcmVkIG91dHB1dCBh
        dCB0aGUgYHt7eWllbGR9fWAgbG9jYXRpb24uCgogIEFuIGVtcHR5IGA8Ym9k
        eT5gIGFuZCB0aGUgZm9sbG93aW5nIGFwcGxpY2F0aW9uIGNvZGU6CgogIGBg
        YGphdmFzY3JpcHQKICBBVmlldyA9IEVtYmVyLlZpZXcuZXh0ZW5kKHsKICAg
        IGNsYXNzTmFtZXM6IFsnYS12aWV3LXdpdGgtbGF5b3V0J10sCiAgICBsYXlv
        dXQ6IEVtYmVyLkhhbmRsZWJhcnMuY29tcGlsZSgnPGRpdiBjbGFzcz0id3Jh
        cHBlciI+e3t5aWVsZH19PC9kaXY+JyksCiAgICB0ZW1wbGF0ZTogRW1iZXIu
        SGFuZGxlYmFycy5jb21waWxlKCc8c3Bhbj5JIGFtIHdyYXBwZWQ8L3NwYW4+
        JykKICB9KTsKCiAgYVZpZXcgPSBBVmlldy5jcmVhdGUoKTsKICBhVmlldy5h
        cHBlbmRUbygnYm9keScpOwogIGBgYAoKICBXaWxsIHJlc3VsdCBpbiB0aGUg
        Zm9sbG93aW5nIEhUTUwgb3V0cHV0OgoKICBgYGBodG1sCiAgPGJvZHk+CiAg
        ICA8ZGl2IGNsYXNzPSdlbWJlci12aWV3IGEtdmlldy13aXRoLWxheW91dCc+
        CiAgICAgIDxkaXYgY2xhc3M9IndyYXBwZXIiPgogICAgICAgIDxzcGFuPkkg
        YW0gd3JhcHBlZDwvc3Bhbj4KICAgICAgPC9kaXY+CiAgICA8L2Rpdj4KICA8
        L2JvZHk+CiAgYGBgCgogIFRoZSBgeWllbGRgIGhlbHBlciBjYW5ub3QgYmUg
        dXNlZCBvdXRzaWRlIG9mIGEgdGVtcGxhdGUgYXNzaWduZWQgdG8gYW4KICBg
        RW1iZXIuVmlld2AncyBgbGF5b3V0YCBwcm9wZXJ0eSBhbmQgd2lsbCB0aHJv
        dyBhbiBlcnJvciBpZiBhdHRlbXB0ZWQuCgogIGBgYGphdmFzY3JpcHQKICBC
        VmlldyA9IEVtYmVyLlZpZXcuZXh0ZW5kKHsKICAgIGNsYXNzTmFtZXM6IFsn
        YS12aWV3LXdpdGgtbGF5b3V0J10sCiAgICB0ZW1wbGF0ZTogRW1iZXIuSGFu
        ZGxlYmFycy5jb21waWxlKCd7e3lpZWxkfX0nKQogIH0pOwoKICBiVmlldyA9
        IEJWaWV3LmNyZWF0ZSgpOwogIGJWaWV3LmFwcGVuZFRvKCdib2R5Jyk7Cgog
        IC8vIHRocm93cwogIC8vIFVuY2F1Z2h0IEVycm9yOiBhc3NlcnRpb24gZmFp
        bGVkOgogIC8vIFlvdSBjYWxsZWQgeWllbGQgaW4gYSB0ZW1wbGF0ZSB0aGF0
        IHdhcyBub3QgYSBsYXlvdXQKICBgYGAKCiAgIyMjIFVzZSB3aXRoIEVtYmVy
        LkNvbXBvbmVudAogIFdoZW4gZGVzaWduaW5nIGNvbXBvbmVudHMgYHt7eWll
        bGR9fWAgaXMgdXNlZCB0byBkZW5vdGUgd2hlcmUsIGluc2lkZSB0aGUgY29t
        cG9uZW50J3MKICB0ZW1wbGF0ZSwgYW4gb3B0aW9uYWwgYmxvY2sgcGFzc2Vk
        IHRvIHRoZSBjb21wb25lbnQgc2hvdWxkIHJlbmRlcjoKCiAgYGBgaGFuZGxl
        YmFycwogIDwhLS0gYXBwbGljYXRpb24uaGJzIC0tPgogIHt7I2xhYmVsZWQt
        dGV4dGZpZWxkIHZhbHVlPXNvbWVQcm9wZXJ0eX19CiAgICBGaXJzdCBuYW1l
        OgogIHt7L2xhYmVsZWQtdGV4dGZpZWxkfX0KICBgYGAKCiAgYGBgaGFuZGxl
        YmFycwogIDwhLS0gY29tcG9uZW50cy9sYWJlbGVkLXRleHRmaWVsZC5oYnMg
        LS0+CiAgPGxhYmVsPgogICAge3t5aWVsZH19IHt7aW5wdXQgdmFsdWU9dmFs
        dWV9fQogIDwvbGFiZWw+CiAgYGBgCgogIFJlc3VsdDoKCiAgYGBgaHRtbAog
        IDxsYWJlbD4KICAgIEZpcnN0IG5hbWU6IDxpbnB1dCB0eXBlPSJ0ZXh0IiAv
        PgogIDxsYWJlbD4KICBgYGAKCiAgQG1ldGhvZCB5aWVsZAogIEBmb3IgRW1i
        ZXIuSGFuZGxlYmFycy5oZWxwZXJzCiAgQHBhcmFtIHtIYXNofSBvcHRpb25z
        CiAgQHJldHVybiB7U3RyaW5nfSBIVE1MIHN0cmluZwoqLwpFbWJlci5IYW5k
        bGViYXJzLnJlZ2lzdGVySGVscGVyKCd5aWVsZCcsIGZ1bmN0aW9uKG9wdGlv
        bnMpIHsKICB2YXIgdmlldyA9IG9wdGlvbnMuZGF0YS52aWV3OwoKICB3aGls
        ZSAodmlldyAmJiAhZ2V0KHZpZXcsICdsYXlvdXQnKSkgewogICAgaWYgKHZp
        ZXcuX2NvbnRleHRWaWV3KSB7CiAgICAgIHZpZXcgPSB2aWV3Ll9jb250ZXh0
        VmlldzsKICAgIH0gZWxzZSB7CiAgICAgIHZpZXcgPSBnZXQodmlldywgJ3Bh
        cmVudFZpZXcnKTsKICAgIH0KICB9CgogIEVtYmVyLmFzc2VydCgiWW91IGNh
        bGxlZCB5aWVsZCBpbiBhIHRlbXBsYXRlIHRoYXQgd2FzIG5vdCBhIGxheW91
        dCIsICEhdmlldyk7CgogIHZpZXcuX3lpZWxkKHRoaXMsIG9wdGlvbnMpOwp9
        KTsKCn0pKCk7CgoKCihmdW5jdGlvbigpIHsKLyoqCkBtb2R1bGUgZW1iZXIK
        QHN1Ym1vZHVsZSBlbWJlci1oYW5kbGViYXJzCiovCgovKioKICBgbG9jYCBs
        b29rcyB1cCB0aGUgc3RyaW5nIGluIHRoZSBsb2NhbGl6ZWQgc3RyaW5ncyBo
        YXNoLgogIFRoaXMgaXMgYSBjb252ZW5pZW50IHdheSB0byBsb2NhbGl6ZSB0
        ZXh0LiBGb3IgZXhhbXBsZToKCiAgYGBgaHRtbAogIDxzY3JpcHQgdHlwZT0i
        dGV4dC94LWhhbmRsZWJhcnMiIGRhdGEtdGVtcGxhdGUtbmFtZT0iaG9tZSI+
        CiAgICB7e2xvYyAid2VsY29tZSJ9fQogIDwvc2NyaXB0PgogIGBgYAoKICBU
        YWtlIG5vdGUgdGhhdCBgIndlbGNvbWUiYCBpcyBhIHN0cmluZyBhbmQgbm90
        IGFuIG9iamVjdAogIHJlZmVyZW5jZS4KCiAgQG1ldGhvZCBsb2MKICBAZm9y
        IEVtYmVyLkhhbmRsZWJhcnMuaGVscGVycwogIEBwYXJhbSB7U3RyaW5nfSBz
        dHIgVGhlIHN0cmluZyB0byBmb3JtYXQKKi8KCkVtYmVyLkhhbmRsZWJhcnMu
        cmVnaXN0ZXJIZWxwZXIoJ2xvYycsIGZ1bmN0aW9uKHN0cikgewogIHJldHVy
        biBFbWJlci5TdHJpbmcubG9jKHN0cik7Cn0pOwoKfSkoKTsKCgoKKGZ1bmN0
        aW9uKCkgewoKfSkoKTsKCgoKKGZ1bmN0aW9uKCkgewoKfSkoKTsKCgoKKGZ1
        bmN0aW9uKCkgewovKioKQG1vZHVsZSBlbWJlcgpAc3VibW9kdWxlIGVtYmVy
        LWhhbmRsZWJhcnMKKi8KCnZhciBzZXQgPSBFbWJlci5zZXQsIGdldCA9IEVt
        YmVyLmdldDsKCi8qKgogIFRoZSBpbnRlcm5hbCBjbGFzcyB1c2VkIHRvIGNy
        ZWF0ZSB0ZXh0IGlucHV0cyB3aGVuIHRoZSBge3tpbnB1dH19YAogIGhlbHBl
        ciBpcyB1c2VkIHdpdGggYHR5cGVgIG9mIGBjaGVja2JveGAuCgogIFNlZSBI
        YW5kbGViYXJzLmhlbHBlcnMuaW5wdXQgZm9yIHVzYWdlIGRldGFpbHMuCgog
        ICMjIERpcmVjdCBtYW5pcHVsYXRpb24gb2YgYGNoZWNrZWRgCgogIFRoZSBg
        Y2hlY2tlZGAgYXR0cmlidXRlIG9mIGFuIGBFbWJlci5DaGVja2JveGAgb2Jq
        ZWN0IHNob3VsZCBhbHdheXMgYmUgc2V0CiAgdGhyb3VnaCB0aGUgRW1iZXIg
        b2JqZWN0IG9yIGJ5IGludGVyYWN0aW5nIHdpdGggaXRzIHJlbmRlcmVkIGVs
        ZW1lbnQKICByZXByZXNlbnRhdGlvbiB2aWEgdGhlIG1vdXNlLCBrZXlib2Fy
        ZCwgb3IgdG91Y2guIFVwZGF0aW5nIHRoZSB2YWx1ZSBvZiB0aGUKICBjaGVj
        a2JveCB2aWEgalF1ZXJ5IHdpbGwgcmVzdWx0IGluIHRoZSBjaGVja2VkIHZh
        bHVlIG9mIHRoZSBvYmplY3QgYW5kIGl0cwogIGVsZW1lbnQgbG9zaW5nIHN5
        bmNocm9uaXphdGlvbi4KCiAgIyMgTGF5b3V0IGFuZCBMYXlvdXROYW1lIHBy
        b3BlcnRpZXMKCiAgQmVjYXVzZSBIVE1MIGBpbnB1dGAgZWxlbWVudHMgYXJl
        IHNlbGYgY2xvc2luZyBgbGF5b3V0YCBhbmQgYGxheW91dE5hbWVgCiAgcHJv
        cGVydGllcyB3aWxsIG5vdCBiZSBhcHBsaWVkLiBTZWUgW0VtYmVyLlZpZXdd
        KC9hcGkvY2xhc3Nlcy9FbWJlci5WaWV3Lmh0bWwpJ3MKICBsYXlvdXQgc2Vj
        dGlvbiBmb3IgbW9yZSBpbmZvcm1hdGlvbi4KCiAgQGNsYXNzIENoZWNrYm94
        CiAgQG5hbWVzcGFjZSBFbWJlcgogIEBleHRlbmRzIEVtYmVyLlZpZXcKKi8K
        RW1iZXIuQ2hlY2tib3ggPSBFbWJlci5WaWV3LmV4dGVuZCh7CiAgY2xhc3NO
        YW1lczogWydlbWJlci1jaGVja2JveCddLAoKICB0YWdOYW1lOiAnaW5wdXQn
        LAoKICBhdHRyaWJ1dGVCaW5kaW5nczogWyd0eXBlJywgJ2NoZWNrZWQnLCAn
        aW5kZXRlcm1pbmF0ZScsICdkaXNhYmxlZCcsICd0YWJpbmRleCcsICduYW1l
        J10sCgogIHR5cGU6ICJjaGVja2JveCIsCiAgY2hlY2tlZDogZmFsc2UsCiAg
        ZGlzYWJsZWQ6IGZhbHNlLAogIGluZGV0ZXJtaW5hdGU6IGZhbHNlLAoKICBp
        bml0OiBmdW5jdGlvbigpIHsKICAgIHRoaXMuX3N1cGVyKCk7CiAgICB0aGlz
        Lm9uKCJjaGFuZ2UiLCB0aGlzLCB0aGlzLl91cGRhdGVFbGVtZW50VmFsdWUp
        OwogIH0sCgogIGRpZEluc2VydEVsZW1lbnQ6IGZ1bmN0aW9uKCkgewogICAg
        dGhpcy5fc3VwZXIoKTsKICAgIHRoaXMuZ2V0KCdlbGVtZW50JykuaW5kZXRl
        cm1pbmF0ZSA9ICEhdGhpcy5nZXQoJ2luZGV0ZXJtaW5hdGUnKTsKICB9LAoK
        ICBfdXBkYXRlRWxlbWVudFZhbHVlOiBmdW5jdGlvbigpIHsKICAgIHNldCh0
        aGlzLCAnY2hlY2tlZCcsIHRoaXMuJCgpLnByb3AoJ2NoZWNrZWQnKSk7CiAg
        fQp9KTsKCn0pKCk7CgoKCihmdW5jdGlvbigpIHsKLyoqCkBtb2R1bGUgZW1i
        ZXIKQHN1Ym1vZHVsZSBlbWJlci1oYW5kbGViYXJzCiovCgp2YXIgZ2V0ID0g
        RW1iZXIuZ2V0LCBzZXQgPSBFbWJlci5zZXQ7CgovKioKICBTaGFyZWQgbWl4
        aW4gdXNlZCBieSBgRW1iZXIuVGV4dEZpZWxkYCBhbmQgYEVtYmVyLlRleHRB
        cmVhYC4KCiAgQGNsYXNzIFRleHRTdXBwb3J0CiAgQG5hbWVzcGFjZSBFbWJl
        cgogIEBwcml2YXRlCiovCkVtYmVyLlRleHRTdXBwb3J0ID0gRW1iZXIuTWl4
        aW4uY3JlYXRlKHsKICB2YWx1ZTogIiIsCgogIGF0dHJpYnV0ZUJpbmRpbmdz
        OiBbJ3BsYWNlaG9sZGVyJywgJ2Rpc2FibGVkJywgJ21heGxlbmd0aCcsICd0
        YWJpbmRleCddLAogIHBsYWNlaG9sZGVyOiBudWxsLAogIGRpc2FibGVkOiBm
        YWxzZSwKICBtYXhsZW5ndGg6IG51bGwsCgogIGluaXQ6IGZ1bmN0aW9uKCkg
        ewogICAgdGhpcy5fc3VwZXIoKTsKICAgIHRoaXMub24oImZvY3VzT3V0Iiwg
        dGhpcywgdGhpcy5fZWxlbWVudFZhbHVlRGlkQ2hhbmdlKTsKICAgIHRoaXMu
        b24oImNoYW5nZSIsIHRoaXMsIHRoaXMuX2VsZW1lbnRWYWx1ZURpZENoYW5n
        ZSk7CiAgICB0aGlzLm9uKCJwYXN0ZSIsIHRoaXMsIHRoaXMuX2VsZW1lbnRW
        YWx1ZURpZENoYW5nZSk7CiAgICB0aGlzLm9uKCJjdXQiLCB0aGlzLCB0aGlz
        Ll9lbGVtZW50VmFsdWVEaWRDaGFuZ2UpOwogICAgdGhpcy5vbigiaW5wdXQi
        LCB0aGlzLCB0aGlzLl9lbGVtZW50VmFsdWVEaWRDaGFuZ2UpOwogICAgdGhp
        cy5vbigia2V5VXAiLCB0aGlzLCB0aGlzLmludGVycHJldEtleUV2ZW50cyk7
        CiAgfSwKCiAgLyoqCiAgICBUaGUgYWN0aW9uIHRvIGJlIHNlbnQgd2hlbiB0
        aGUgdXNlciBwcmVzc2VzIHRoZSByZXR1cm4ga2V5LgoKICAgIFRoaXMgaXMg
        c2ltaWxhciB0byB0aGUgYHt7YWN0aW9ufX1gIGhlbHBlciwgYnV0IGlzIGZp
        cmVkIHdoZW4KICAgIHRoZSB1c2VyIHByZXNzZXMgdGhlIHJldHVybiBrZXkg
        d2hlbiBlZGl0aW5nIGEgdGV4dCBmaWVsZCwgYW5kIHNlbmRzCiAgICB0aGUg
        dmFsdWUgb2YgdGhlIGZpZWxkIGFzIHRoZSBjb250ZXh0LgoKICAgIEBwcm9w
        ZXJ0eSBhY3Rpb24KICAgIEB0eXBlIFN0cmluZwogICAgQGRlZmF1bHQgbnVs
        bAogICovCiAgYWN0aW9uOiBudWxsLAoKICAvKioKICAgIFRoZSBldmVudCB0
        aGF0IHNob3VsZCBzZW5kIHRoZSBhY3Rpb24uCgogICAgT3B0aW9ucyBhcmU6
        CgogICAgKiBgZW50ZXJgOiB0aGUgdXNlciBwcmVzc2VkIGVudGVyCiAgICAq
        IGBrZXlQcmVzc2A6IHRoZSB1c2VyIHByZXNzZWQgYSBrZXkKCiAgICBAcHJv
        cGVydHkgb25FdmVudAogICAgQHR5cGUgU3RyaW5nCiAgICBAZGVmYXVsdCBl
        bnRlcgogICovCiAgb25FdmVudDogJ2VudGVyJywKCiAgLyoqCiAgICBXaGV0
        aGVyIHRoZXkgYGtleVVwYCBldmVudCB0aGF0IHRyaWdnZXJzIGFuIGBhY3Rp
        b25gIHRvIGJlIHNlbnQgY29udGludWVzCiAgICBwcm9wYWdhdGluZyB0byBv
        dGhlciB2aWV3cy4KCiAgICBCeSBkZWZhdWx0LCB3aGVuIHRoZSB1c2VyIHBy
        ZXNzZXMgdGhlIHJldHVybiBrZXkgb24gdGhlaXIga2V5Ym9hcmQgYW5kCiAg
        ICB0aGUgdGV4dCBmaWVsZCBoYXMgYW4gYGFjdGlvbmAgc2V0LCB0aGUgYWN0
        aW9uIHdpbGwgYmUgc2VudCB0byB0aGUgdmlldydzCiAgICBjb250cm9sbGVy
        IGFuZCB0aGUga2V5IGV2ZW50IHdpbGwgc3RvcCBwcm9wYWdhdGluZy4KCiAg
        ICBJZiB5b3Ugd291bGQgbGlrZSBwYXJlbnQgdmlld3MgdG8gcmVjZWl2ZSB0
        aGUgYGtleVVwYCBldmVudCBldmVuIGFmdGVyIGFuCiAgICBhY3Rpb24gaGFz
        IGJlZW4gZGlzcGF0Y2hlZCwgc2V0IGBidWJibGVzYCB0byB0cnVlLgoKICAg
        IEBwcm9wZXJ0eSBidWJibGVzCiAgICBAdHlwZSBCb29sZWFuCiAgICBAZGVm
        YXVsdCBmYWxzZQogICovCiAgYnViYmxlczogZmFsc2UsCgogIGludGVycHJl
        dEtleUV2ZW50czogZnVuY3Rpb24oZXZlbnQpIHsKICAgIHZhciBtYXAgPSBF
        bWJlci5UZXh0U3VwcG9ydC5LRVlfRVZFTlRTOwogICAgdmFyIG1ldGhvZCA9
        IG1hcFtldmVudC5rZXlDb2RlXTsKCiAgICB0aGlzLl9lbGVtZW50VmFsdWVE
        aWRDaGFuZ2UoKTsKICAgIGlmIChtZXRob2QpIHsgcmV0dXJuIHRoaXNbbWV0
        aG9kXShldmVudCk7IH0KICB9LAoKICBfZWxlbWVudFZhbHVlRGlkQ2hhbmdl
        OiBmdW5jdGlvbigpIHsKICAgIHNldCh0aGlzLCAndmFsdWUnLCB0aGlzLiQo
        KS52YWwoKSk7CiAgfSwKCiAgLyoqCiAgICBUaGUgYWN0aW9uIHRvIGJlIHNl
        bnQgd2hlbiB0aGUgdXNlciBpbnNlcnRzIGEgbmV3IGxpbmUuCgogICAgQ2Fs
        bGVkIGJ5IHRoZSBgRW1iZXIuVGV4dFN1cHBvcnRgIG1peGluIG9uIGtleVVw
        IGlmIGtleWNvZGUgbWF0Y2hlcyAxMy4KICAgIFVzZXMgc2VuZEFjdGlvbiB0
        byBzZW5kIHRoZSBgZW50ZXJgIGFjdGlvbiB0byB0aGUgY29udHJvbGxlci4K
        CiAgICBAbWV0aG9kIGluc2VydE5ld2xpbmUKICAgIEBwYXJhbSB7RXZlbnR9
        IGV2ZW50CiAgKi8KICBpbnNlcnROZXdsaW5lOiBmdW5jdGlvbihldmVudCkg
        ewogICAgc2VuZEFjdGlvbignZW50ZXInLCB0aGlzLCBldmVudCk7CiAgICBz
        ZW5kQWN0aW9uKCdpbnNlcnQtbmV3bGluZScsIHRoaXMsIGV2ZW50KTsKICB9
        LAoKICAvKioKICAgIENhbGxlZCB3aGVuIHRoZSB1c2VyIGhpdHMgZXNjYXBl
        LgoKICAgIENhbGxlZCBieSB0aGUgYEVtYmVyLlRleHRTdXBwb3J0YCBtaXhp
        biBvbiBrZXlVcCBpZiBrZXljb2RlIG1hdGNoZXMgMjcuCiAgICBVc2VzIHNl
        bmRBY3Rpb24gdG8gc2VuZCB0aGUgYGVzY2FwZS1wcmVzc2AgYWN0aW9uIHRv
        IHRoZSBjb250cm9sbGVyLgoKICAgIEBtZXRob2QgY2FuY2VsCiAgICBAcGFy
        YW0ge0V2ZW50fSBldmVudAogICovCiAgY2FuY2VsOiBmdW5jdGlvbihldmVu
        dCkgewogICAgc2VuZEFjdGlvbignZXNjYXBlLXByZXNzJywgdGhpcywgZXZl
        bnQpOwogIH0sCgogIC8qKgogICAgQ2FsbGVkIHdoZW4gdGhlIHRleHQgYXJl
        YSBpcyBmb2N1c2VkLgoKICAgIEBtZXRob2QgZm9jdXNJbgogICAgQHBhcmFt
        IHtFdmVudH0gZXZlbnQKICAqLwogIGZvY3VzSW46IGZ1bmN0aW9uKGV2ZW50
        KSB7CiAgICBzZW5kQWN0aW9uKCdmb2N1cy1pbicsIHRoaXMsIGV2ZW50KTsK
        ICB9LAoKICAvKioKICAgIENhbGxlZCB3aGVuIHRoZSB0ZXh0IGFyZWEgaXMg
        Ymx1cnJlZC4KCiAgICBAbWV0aG9kIGZvY3VzT3V0CiAgICBAcGFyYW0ge0V2
        ZW50fSBldmVudAogICovCiAgZm9jdXNPdXQ6IGZ1bmN0aW9uKGV2ZW50KSB7
        CiAgICBzZW5kQWN0aW9uKCdmb2N1cy1vdXQnLCB0aGlzLCBldmVudCk7CiAg
        fSwKCiAgLyoqCiAgICBUaGUgYWN0aW9uIHRvIGJlIHNlbnQgd2hlbiB0aGUg
        dXNlciBwcmVzc2VzIGEga2V5LiBFbmFibGVkIGJ5IHNldHRpbmcKICAgIHRo
        ZSBgb25FdmVudGAgcHJvcGVydHkgdG8gYGtleVByZXNzYC4KCiAgICBVc2Vz
        IHNlbmRBY3Rpb24gdG8gc2VuZCB0aGUgYGtleVByZXNzYCBhY3Rpb24gdG8g
        dGhlIGNvbnRyb2xsZXIuCgogICAgQG1ldGhvZCBrZXlQcmVzcwogICAgQHBh
        cmFtIHtFdmVudH0gZXZlbnQKICAqLwogIGtleVByZXNzOiBmdW5jdGlvbihl
        dmVudCkgewogICAgc2VuZEFjdGlvbigna2V5LXByZXNzJywgdGhpcywgZXZl
        bnQpOwogIH0KCn0pOwoKRW1iZXIuVGV4dFN1cHBvcnQuS0VZX0VWRU5UUyA9
        IHsKICAxMzogJ2luc2VydE5ld2xpbmUnLAogIDI3OiAnY2FuY2VsJwp9OwoK
        Ly8gSW4gcHJpbmNpcGxlLCB0aGlzIHNob3VsZG4ndCBiZSBuZWNlc3Nhcnks
        IGJ1dCB0aGUgbGVnYWN5Ci8vIHNlY3Rpb25BY3Rpb24gc2VtYW50aWNzIGZv
        ciBUZXh0RmllbGQgYXJlIGRpZmZlcmVudCBmcm9tCi8vIHRoZSBjb21wb25l
        bnQgc2VtYW50aWNzIHNvIHRoaXMgbWV0aG9kIG5vcm1hbGl6ZXMgdGhlbS4K
        ZnVuY3Rpb24gc2VuZEFjdGlvbihldmVudE5hbWUsIHZpZXcsIGV2ZW50KSB7
        CiAgdmFyIGFjdGlvbiA9IGdldCh2aWV3LCBldmVudE5hbWUpLAogICAgICBv
        biA9IGdldCh2aWV3LCAnb25FdmVudCcpLAogICAgICB2YWx1ZSA9IGdldCh2
        aWV3LCAndmFsdWUnKTsKCiAgLy8gYmFjay1jb21wYXQgc3VwcG9ydCBmb3Ig
        a2V5UHJlc3MgYXMgYW4gZXZlbnQgbmFtZSBldmVuIHRob3VnaAogIC8vIGl0
        J3MgYWxzbyBhIG1ldGhvZCBuYW1lIHRoYXQgY29uc3VtZXMgdGhlIGV2ZW50
        IChhbmQgdGhlcmVmb3JlCiAgLy8gaW5jb21wYXRpYmxlIHdpdGggc2VuZEFj
        dGlvbiBzZW1hbnRpY3MpLgogIGlmIChvbiA9PT0gZXZlbnROYW1lIHx8IChv
        biA9PT0gJ2tleVByZXNzJyAmJiBldmVudE5hbWUgPT09ICdrZXktcHJlc3Mn
        KSkgewogICAgdmlldy5zZW5kQWN0aW9uKCdhY3Rpb24nLCB2YWx1ZSk7CiAg
        fQoKICB2aWV3LnNlbmRBY3Rpb24oZXZlbnROYW1lLCB2YWx1ZSk7CgogIGlm
        IChhY3Rpb24gfHwgb24gPT09IGV2ZW50TmFtZSkgewogICAgaWYoIWdldCh2
        aWV3LCAnYnViYmxlcycpKSB7CiAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlv
        bigpOwogICAgfQogIH0KfQoKfSkoKTsKCgoKKGZ1bmN0aW9uKCkgewovKioK
        QG1vZHVsZSBlbWJlcgpAc3VibW9kdWxlIGVtYmVyLWhhbmRsZWJhcnMKKi8K
        CnZhciBnZXQgPSBFbWJlci5nZXQsIHNldCA9IEVtYmVyLnNldDsKCi8qKgoK
        ICBUaGUgaW50ZXJuYWwgY2xhc3MgdXNlZCB0byBjcmVhdGUgdGV4dCBpbnB1
        dHMgd2hlbiB0aGUgYHt7aW5wdXR9fWAKICBoZWxwZXIgaXMgdXNlZCB3aXRo
        IGB0eXBlYCBvZiBgdGV4dGAuCgogIFNlZSBbaGFuZGxlYmFycy5oZWxwZXJz
        LmlucHV0XShhcGkvY2xhc3Nlcy9FbWJlci5IYW5kbGViYXJzLmhlbHBlcnMu
        aHRtbCNtZXRob2RfaW5wdXQpICBmb3IgdXNhZ2UgZGV0YWlscy4KCiAgIyMg
        TGF5b3V0IGFuZCBMYXlvdXROYW1lIHByb3BlcnRpZXMKCiAgQmVjYXVzZSBI
        VE1MIGBpbnB1dGAgZWxlbWVudHMgYXJlIHNlbGYgY2xvc2luZyBgbGF5b3V0
        YCBhbmQgYGxheW91dE5hbWVgCiAgcHJvcGVydGllcyB3aWxsIG5vdCBiZSBh
        cHBsaWVkLiBTZWUgW0VtYmVyLlZpZXddKC9hcGkvY2xhc3Nlcy9FbWJlci5W
        aWV3Lmh0bWwpJ3MKICBsYXlvdXQgc2VjdGlvbiBmb3IgbW9yZSBpbmZvcm1h
        dGlvbi4KCiAgQGNsYXNzIFRleHRGaWVsZAogIEBuYW1lc3BhY2UgRW1iZXIK
        ICBAZXh0ZW5kcyBFbWJlci5Db21wb25lbnQKICBAdXNlcyBFbWJlci5UZXh0
        U3VwcG9ydAoqLwpFbWJlci5UZXh0RmllbGQgPSBFbWJlci5Db21wb25lbnQu
        ZXh0ZW5kKEVtYmVyLlRleHRTdXBwb3J0LAogIC8qKiBAc2NvcGUgRW1iZXIu
        VGV4dEZpZWxkLnByb3RvdHlwZSAqLyB7CgogIGNsYXNzTmFtZXM6IFsnZW1i
        ZXItdGV4dC1maWVsZCddLAogIHRhZ05hbWU6ICJpbnB1dCIsCiAgYXR0cmli
        dXRlQmluZGluZ3M6IFsndHlwZScsICd2YWx1ZScsICdzaXplJywgJ3BhdHRl
        cm4nLCAnbmFtZSddLAoKICAvKioKICAgIFRoZSBgdmFsdWVgIGF0dHJpYnV0
        ZSBvZiB0aGUgaW5wdXQgZWxlbWVudC4gQXMgdGhlIHVzZXIgaW5wdXRzIHRl
        eHQsIHRoaXMKICAgIHByb3BlcnR5IGlzIHVwZGF0ZWQgbGl2ZS4KCiAgICBA
        cHJvcGVydHkgdmFsdWUKICAgIEB0eXBlIFN0cmluZwogICAgQGRlZmF1bHQg
        IiIKICAqLwogIHZhbHVlOiAiIiwKCiAgLyoqCiAgICBUaGUgYHR5cGVgIGF0
        dHJpYnV0ZSBvZiB0aGUgaW5wdXQgZWxlbWVudC4KCiAgICBAcHJvcGVydHkg
        dHlwZQogICAgQHR5cGUgU3RyaW5nCiAgICBAZGVmYXVsdCAidGV4dCIKICAq
        LwogIHR5cGU6ICJ0ZXh0IiwKCiAgLyoqCiAgICBUaGUgYHNpemVgIG9mIHRo
        ZSB0ZXh0IGZpZWxkIGluIGNoYXJhY3RlcnMuCgogICAgQHByb3BlcnR5IHNp
        emUKICAgIEB0eXBlIFN0cmluZwogICAgQGRlZmF1bHQgbnVsbAogICovCiAg
        c2l6ZTogbnVsbCwKCiAgLyoqCiAgICBUaGUgYHBhdHRlcm5gIHRoZSBwYXR0
        ZXJuIGF0dHJpYnV0ZSBvZiBpbnB1dCBlbGVtZW50LgoKICAgIEBwcm9wZXJ0
        eSBwYXR0ZXJuCiAgICBAdHlwZSBTdHJpbmcKICAgIEBkZWZhdWx0IG51bGwK
        ICAqLwogIHBhdHRlcm46IG51bGwKfSk7Cgp9KSgpOwoKCgooZnVuY3Rpb24o
        KSB7Ci8qCkBtb2R1bGUgZW1iZXIKQHN1Ym1vZHVsZSBlbWJlci1oYW5kbGVi
        YXJzCiovCgp2YXIgZ2V0ID0gRW1iZXIuZ2V0LCBzZXQgPSBFbWJlci5zZXQ7
        CgovKgogIEBjbGFzcyBCdXR0b24KICBAbmFtZXNwYWNlIEVtYmVyCiAgQGV4
        dGVuZHMgRW1iZXIuVmlldwogIEB1c2VzIEVtYmVyLlRhcmdldEFjdGlvblN1
        cHBvcnQKICBAZGVwcmVjYXRlZAoqLwpFbWJlci5CdXR0b24gPSBFbWJlci5W
        aWV3LmV4dGVuZChFbWJlci5UYXJnZXRBY3Rpb25TdXBwb3J0LCB7CiAgY2xh
        c3NOYW1lczogWydlbWJlci1idXR0b24nXSwKICBjbGFzc05hbWVCaW5kaW5n
        czogWydpc0FjdGl2ZSddLAoKICB0YWdOYW1lOiAnYnV0dG9uJywKCiAgcHJv
        cGFnYXRlRXZlbnRzOiBmYWxzZSwKCiAgYXR0cmlidXRlQmluZGluZ3M6IFsn
        dHlwZScsICdkaXNhYmxlZCcsICdocmVmJywgJ3RhYmluZGV4J10sCgogIC8q
        CiAgICBAcHJpdmF0ZQoKICAgIE92ZXJyaWRlcyBgVGFyZ2V0QWN0aW9uU3Vw
        cG9ydGAncyBgdGFyZ2V0T2JqZWN0YCBjb21wdXRlZAogICAgcHJvcGVydHkg
        dG8gdXNlIEhhbmRsZWJhcnMtc3BlY2lmaWMgcGF0aCByZXNvbHV0aW9uLgoK
        ICAgIEBwcm9wZXJ0eSB0YXJnZXRPYmplY3QKICAqLwogIHRhcmdldE9iamVj
        dDogRW1iZXIuY29tcHV0ZWQoZnVuY3Rpb24oKSB7CiAgICB2YXIgdGFyZ2V0
        ID0gZ2V0KHRoaXMsICd0YXJnZXQnKSwKICAgICAgICByb290ID0gZ2V0KHRo
        aXMsICdjb250ZXh0JyksCiAgICAgICAgZGF0YSA9IGdldCh0aGlzLCAndGVt
        cGxhdGVEYXRhJyk7CgogICAgaWYgKHR5cGVvZiB0YXJnZXQgIT09ICdzdHJp
        bmcnKSB7IHJldHVybiB0YXJnZXQ7IH0KCiAgICByZXR1cm4gRW1iZXIuSGFu
        ZGxlYmFycy5nZXQocm9vdCwgdGFyZ2V0LCB7IGRhdGE6IGRhdGEgfSk7CiAg
        fSkucHJvcGVydHkoJ3RhcmdldCcpLAoKICAvLyBEZWZhdWx0cyB0byAnYnV0
        dG9uJyBpZiB0YWdOYW1lIGlzICdpbnB1dCcgb3IgJ2J1dHRvbicKICB0eXBl
        OiBFbWJlci5jb21wdXRlZChmdW5jdGlvbihrZXkpIHsKICAgIHZhciB0YWdO
        YW1lID0gdGhpcy50YWdOYW1lOwogICAgaWYgKHRhZ05hbWUgPT09ICdpbnB1
        dCcgfHwgdGFnTmFtZSA9PT0gJ2J1dHRvbicpIHsgcmV0dXJuICdidXR0b24n
        OyB9CiAgfSksCgogIGRpc2FibGVkOiBmYWxzZSwKCiAgLy8gQWxsb3cgJ2En
        IHRhZ3MgdG8gYWN0IGxpa2UgYnV0dG9ucwogIGhyZWY6IEVtYmVyLmNvbXB1
        dGVkKGZ1bmN0aW9uKCkgewogICAgcmV0dXJuIHRoaXMudGFnTmFtZSA9PT0g
        J2EnID8gJyMnIDogbnVsbDsKICB9KSwKCiAgbW91c2VEb3duOiBmdW5jdGlv
        bigpIHsKICAgIGlmICghZ2V0KHRoaXMsICdkaXNhYmxlZCcpKSB7CiAgICAg
        IHNldCh0aGlzLCAnaXNBY3RpdmUnLCB0cnVlKTsKICAgICAgdGhpcy5fbW91
        c2VEb3duID0gdHJ1ZTsKICAgICAgdGhpcy5fbW91c2VFbnRlcmVkID0gdHJ1
        ZTsKICAgIH0KICAgIHJldHVybiBnZXQodGhpcywgJ3Byb3BhZ2F0ZUV2ZW50
        cycpOwogIH0sCgogIG1vdXNlTGVhdmU6IGZ1bmN0aW9uKCkgewogICAgaWYg
        KHRoaXMuX21vdXNlRG93bikgewogICAgICBzZXQodGhpcywgJ2lzQWN0aXZl
        JywgZmFsc2UpOwogICAgICB0aGlzLl9tb3VzZUVudGVyZWQgPSBmYWxzZTsK
        ICAgIH0KICB9LAoKICBtb3VzZUVudGVyOiBmdW5jdGlvbigpIHsKICAgIGlm
        ICh0aGlzLl9tb3VzZURvd24pIHsKICAgICAgc2V0KHRoaXMsICdpc0FjdGl2
        ZScsIHRydWUpOwogICAgICB0aGlzLl9tb3VzZUVudGVyZWQgPSB0cnVlOwog
        ICAgfQogIH0sCgogIG1vdXNlVXA6IGZ1bmN0aW9uKGV2ZW50KSB7CiAgICBp
        ZiAoZ2V0KHRoaXMsICdpc0FjdGl2ZScpKSB7CiAgICAgIC8vIEFjdHVhbGx5
        IGludm9rZSB0aGUgYnV0dG9uJ3MgdGFyZ2V0IGFuZCBhY3Rpb24uCiAgICAg
        IC8vIFRoaXMgbWV0aG9kIGNvbWVzIGZyb20gdGhlIEVtYmVyLlRhcmdldEFj
        dGlvblN1cHBvcnQgbWl4aW4uCiAgICAgIHRoaXMudHJpZ2dlckFjdGlvbigp
        OwogICAgICBzZXQodGhpcywgJ2lzQWN0aXZlJywgZmFsc2UpOwogICAgfQoK
        ICAgIHRoaXMuX21vdXNlRG93biA9IGZhbHNlOwogICAgdGhpcy5fbW91c2VF
        bnRlcmVkID0gZmFsc2U7CiAgICByZXR1cm4gZ2V0KHRoaXMsICdwcm9wYWdh
        dGVFdmVudHMnKTsKICB9LAoKICBrZXlEb3duOiBmdW5jdGlvbihldmVudCkg
        ewogICAgLy8gSGFuZGxlIHNwYWNlIG9yIGVudGVyCiAgICBpZiAoZXZlbnQu
        a2V5Q29kZSA9PT0gMTMgfHwgZXZlbnQua2V5Q29kZSA9PT0gMzIpIHsKICAg
        ICAgdGhpcy5tb3VzZURvd24oKTsKICAgIH0KICB9LAoKICBrZXlVcDogZnVu
        Y3Rpb24oZXZlbnQpIHsKICAgIC8vIEhhbmRsZSBzcGFjZSBvciBlbnRlcgog
        ICAgaWYgKGV2ZW50LmtleUNvZGUgPT09IDEzIHx8IGV2ZW50LmtleUNvZGUg
        PT09IDMyKSB7CiAgICAgIHRoaXMubW91c2VVcCgpOwogICAgfQogIH0sCgog
        IC8vIFRPRE86IEhhbmRsZSBwcm9wZXIgdG91Y2ggYmVoYXZpb3IuIEluY2x1
        ZGluZyBzaG91bGQgbWFrZSBpbmFjdGl2ZSB3aGVuCiAgLy8gZmluZ2VyIG1v
        dmVzIG1vcmUgdGhhbiAyMHggb3V0c2lkZSBvZiB0aGUgZWRnZSBvZiB0aGUg
        YnV0dG9uICh2cyBtb3VzZQogIC8vIHdoaWNoIGdvZXMgaW5hY3RpdmUgYXMg
        c29vbiBhcyBtb3VzZSBnb2VzIG91dCBvZiBlZGdlcy4pCgogIHRvdWNoU3Rh
        cnQ6IGZ1bmN0aW9uKHRvdWNoKSB7CiAgICByZXR1cm4gdGhpcy5tb3VzZURv
        d24odG91Y2gpOwogIH0sCgogIHRvdWNoRW5kOiBmdW5jdGlvbih0b3VjaCkg
        ewogICAgcmV0dXJuIHRoaXMubW91c2VVcCh0b3VjaCk7CiAgfSwKCiAgaW5p
        dDogZnVuY3Rpb24oKSB7CiAgICBFbWJlci5kZXByZWNhdGUoIkVtYmVyLkJ1
        dHRvbiBpcyBkZXByZWNhdGVkIGFuZCB3aWxsIGJlIHJlbW92ZWQgZnJvbSBm
        dXR1cmUgcmVsZWFzZXMuIENvbnNpZGVyIHVzaW5nIHRoZSBge3thY3Rpb259
        fWAgaGVscGVyLiIpOwogICAgdGhpcy5fc3VwZXIoKTsKICB9Cn0pOwoKfSko
        KTsKCgoKKGZ1bmN0aW9uKCkgewovKioKQG1vZHVsZSBlbWJlcgpAc3VibW9k
        dWxlIGVtYmVyLWhhbmRsZWJhcnMKKi8KCnZhciBnZXQgPSBFbWJlci5nZXQs
        IHNldCA9IEVtYmVyLnNldDsKCi8qKgogIFRoZSBpbnRlcm5hbCBjbGFzcyB1
        c2VkIHRvIGNyZWF0ZSB0ZXh0YXJlYSBlbGVtZW50IHdoZW4gdGhlIGB7e3Rl
        eHRhcmVhfX1gCiAgaGVscGVyIGlzIHVzZWQuCgogIFNlZSBbaGFuZGxlYmFy
        cy5oZWxwZXJzLnRleHRhcmVhXSgvYXBpL2NsYXNzZXMvRW1iZXIuSGFuZGxl
        YmFycy5oZWxwZXJzLmh0bWwjbWV0aG9kX3RleHRhcmVhKSAgZm9yIHVzYWdl
        IGRldGFpbHMuCgogICMjIExheW91dCBhbmQgTGF5b3V0TmFtZSBwcm9wZXJ0
        aWVzCgogIEJlY2F1c2UgSFRNTCBgdGV4dGFyZWFgIGVsZW1lbnRzIGRvIG5v
        dCBjb250YWluIGlubmVyIEhUTUwgdGhlIGBsYXlvdXRgIGFuZAogIGBsYXlv
        dXROYW1lYCBwcm9wZXJ0aWVzIHdpbGwgbm90IGJlIGFwcGxpZWQuIFNlZSBb
        RW1iZXIuVmlld10oL2FwaS9jbGFzc2VzL0VtYmVyLlZpZXcuaHRtbCkncwog
        IGxheW91dCBzZWN0aW9uIGZvciBtb3JlIGluZm9ybWF0aW9uLgoKICBAY2xh
        c3MgVGV4dEFyZWEKICBAbmFtZXNwYWNlIEVtYmVyCiAgQGV4dGVuZHMgRW1i
        ZXIuQ29tcG9uZW50CiAgQHVzZXMgRW1iZXIuVGV4dFN1cHBvcnQKKi8KRW1i
        ZXIuVGV4dEFyZWEgPSBFbWJlci5Db21wb25lbnQuZXh0ZW5kKEVtYmVyLlRl
        eHRTdXBwb3J0LCB7CiAgY2xhc3NOYW1lczogWydlbWJlci10ZXh0LWFyZWEn
        XSwKCiAgdGFnTmFtZTogInRleHRhcmVhIiwKICBhdHRyaWJ1dGVCaW5kaW5n
        czogWydyb3dzJywgJ2NvbHMnLCAnbmFtZSddLAogIHJvd3M6IG51bGwsCiAg
        Y29sczogbnVsbCwKCiAgX3VwZGF0ZUVsZW1lbnRWYWx1ZTogRW1iZXIub2Jz
        ZXJ2ZXIoZnVuY3Rpb24oKSB7CiAgICAvLyBXZSBkbyB0aGlzIGNoZWNrIHNv
        IGN1cnNvciBwb3NpdGlvbiBkb2Vzbid0IGdldCBhZmZlY3RlZCBpbiBJRQog
        ICAgdmFyIHZhbHVlID0gZ2V0KHRoaXMsICd2YWx1ZScpLAogICAgICAgICRl
        bCA9IHRoaXMuJCgpOwogICAgaWYgKCRlbCAmJiB2YWx1ZSAhPT0gJGVsLnZh
        bCgpKSB7CiAgICAgICRlbC52YWwodmFsdWUpOwogICAgfQogIH0sICd2YWx1
        ZScpLAoKICBpbml0OiBmdW5jdGlvbigpIHsKICAgIHRoaXMuX3N1cGVyKCk7
        CiAgICB0aGlzLm9uKCJkaWRJbnNlcnRFbGVtZW50IiwgdGhpcywgdGhpcy5f
        dXBkYXRlRWxlbWVudFZhbHVlKTsKICB9Cgp9KTsKCn0pKCk7CgoKCihmdW5j
        dGlvbigpIHsKLypqc2hpbnQgZXFlcWVxOmZhbHNlICovCgovKioKQG1vZHVs
        ZSBlbWJlcgpAc3VibW9kdWxlIGVtYmVyLWhhbmRsZWJhcnMKKi8KCnZhciBz
        ZXQgPSBFbWJlci5zZXQsCiAgICBnZXQgPSBFbWJlci5nZXQsCiAgICBpbmRl
        eE9mID0gRW1iZXIuRW51bWVyYWJsZVV0aWxzLmluZGV4T2YsCiAgICBpbmRl
        eGVzT2YgPSBFbWJlci5FbnVtZXJhYmxlVXRpbHMuaW5kZXhlc09mLAogICAg
        Zm9yRWFjaCA9IEVtYmVyLkVudW1lcmFibGVVdGlscy5mb3JFYWNoLAogICAg
        cmVwbGFjZSA9IEVtYmVyLkVudW1lcmFibGVVdGlscy5yZXBsYWNlLAogICAg
        aXNBcnJheSA9IEVtYmVyLmlzQXJyYXksCiAgICBwcmVjb21waWxlVGVtcGxh
        dGUgPSBFbWJlci5IYW5kbGViYXJzLmNvbXBpbGU7CgpFbWJlci5TZWxlY3RP
        cHRpb24gPSBFbWJlci5WaWV3LmV4dGVuZCh7CiAgdGFnTmFtZTogJ29wdGlv
        bicsCiAgYXR0cmlidXRlQmluZGluZ3M6IFsndmFsdWUnLCAnc2VsZWN0ZWQn
        XSwKCiAgZGVmYXVsdFRlbXBsYXRlOiBmdW5jdGlvbihjb250ZXh0LCBvcHRp
        b25zKSB7CiAgICBvcHRpb25zID0geyBkYXRhOiBvcHRpb25zLmRhdGEsIGhh
        c2g6IHt9IH07CiAgICBFbWJlci5IYW5kbGViYXJzLmhlbHBlcnMuYmluZC5j
        YWxsKGNvbnRleHQsICJ2aWV3LmxhYmVsIiwgb3B0aW9ucyk7CiAgfSwKCiAg
        aW5pdDogZnVuY3Rpb24oKSB7CiAgICB0aGlzLmxhYmVsUGF0aERpZENoYW5n
        ZSgpOwogICAgdGhpcy52YWx1ZVBhdGhEaWRDaGFuZ2UoKTsKCiAgICB0aGlz
        Ll9zdXBlcigpOwogIH0sCgogIHNlbGVjdGVkOiBFbWJlci5jb21wdXRlZChm
        dW5jdGlvbigpIHsKICAgIHZhciBjb250ZW50ID0gZ2V0KHRoaXMsICdjb250
        ZW50JyksCiAgICAgICAgc2VsZWN0aW9uID0gZ2V0KHRoaXMsICdwYXJlbnRW
        aWV3LnNlbGVjdGlvbicpOwogICAgaWYgKGdldCh0aGlzLCAncGFyZW50Vmll
        dy5tdWx0aXBsZScpKSB7CiAgICAgIHJldHVybiBzZWxlY3Rpb24gJiYgaW5k
        ZXhPZihzZWxlY3Rpb24sIGNvbnRlbnQudmFsdWVPZigpKSA+IC0xOwogICAg
        fSBlbHNlIHsKICAgICAgLy8gUHJpbWl0aXZlcyBnZXQgcGFzc2VkIHRocm91
        Z2ggYmluZGluZ3MgYXMgb2JqZWN0cy4uLiBzaW5jZQogICAgICAvLyBgbmV3
        IE51bWJlcig0KSAhPT0gNGAsIHdlIHVzZSBgPT1gIGJlbG93CiAgICAgIHJl
        dHVybiBjb250ZW50ID09IHNlbGVjdGlvbjsKICAgIH0KICB9KS5wcm9wZXJ0
        eSgnY29udGVudCcsICdwYXJlbnRWaWV3LnNlbGVjdGlvbicpLAoKICBsYWJl
        bFBhdGhEaWRDaGFuZ2U6IEVtYmVyLm9ic2VydmVyKGZ1bmN0aW9uKCkgewog
        ICAgdmFyIGxhYmVsUGF0aCA9IGdldCh0aGlzLCAncGFyZW50Vmlldy5vcHRp
        b25MYWJlbFBhdGgnKTsKCiAgICBpZiAoIWxhYmVsUGF0aCkgeyByZXR1cm47
        IH0KCiAgICBFbWJlci5kZWZpbmVQcm9wZXJ0eSh0aGlzLCAnbGFiZWwnLCBF
        bWJlci5jb21wdXRlZChmdW5jdGlvbigpIHsKICAgICAgcmV0dXJuIGdldCh0
        aGlzLCBsYWJlbFBhdGgpOwogICAgfSkucHJvcGVydHkobGFiZWxQYXRoKSk7
        CiAgfSwgJ3BhcmVudFZpZXcub3B0aW9uTGFiZWxQYXRoJyksCgogIHZhbHVl
        UGF0aERpZENoYW5nZTogRW1iZXIub2JzZXJ2ZXIoZnVuY3Rpb24oKSB7CiAg
        ICB2YXIgdmFsdWVQYXRoID0gZ2V0KHRoaXMsICdwYXJlbnRWaWV3Lm9wdGlv
        blZhbHVlUGF0aCcpOwoKICAgIGlmICghdmFsdWVQYXRoKSB7IHJldHVybjsg
        fQoKICAgIEVtYmVyLmRlZmluZVByb3BlcnR5KHRoaXMsICd2YWx1ZScsIEVt
        YmVyLmNvbXB1dGVkKGZ1bmN0aW9uKCkgewogICAgICByZXR1cm4gZ2V0KHRo
        aXMsIHZhbHVlUGF0aCk7CiAgICB9KS5wcm9wZXJ0eSh2YWx1ZVBhdGgpKTsK
        ICB9LCAncGFyZW50Vmlldy5vcHRpb25WYWx1ZVBhdGgnKQp9KTsKCkVtYmVy
        LlNlbGVjdE9wdGdyb3VwID0gRW1iZXIuQ29sbGVjdGlvblZpZXcuZXh0ZW5k
        KHsKICB0YWdOYW1lOiAnb3B0Z3JvdXAnLAogIGF0dHJpYnV0ZUJpbmRpbmdz
        OiBbJ2xhYmVsJ10sCgogIHNlbGVjdGlvbkJpbmRpbmc6ICdwYXJlbnRWaWV3
        LnNlbGVjdGlvbicsCiAgbXVsdGlwbGVCaW5kaW5nOiAncGFyZW50Vmlldy5t
        dWx0aXBsZScsCiAgb3B0aW9uTGFiZWxQYXRoQmluZGluZzogJ3BhcmVudFZp
        ZXcub3B0aW9uTGFiZWxQYXRoJywKICBvcHRpb25WYWx1ZVBhdGhCaW5kaW5n
        OiAncGFyZW50Vmlldy5vcHRpb25WYWx1ZVBhdGgnLAoKICBpdGVtVmlld0Ns
        YXNzQmluZGluZzogJ3BhcmVudFZpZXcub3B0aW9uVmlldycKfSk7CgovKioK
        ICBUaGUgYEVtYmVyLlNlbGVjdGAgdmlldyBjbGFzcyByZW5kZXJzIGEKICBb
        c2VsZWN0XShodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi9IVE1M
        L0VsZW1lbnQvc2VsZWN0KSBIVE1MIGVsZW1lbnQsCiAgYWxsb3dpbmcgdGhl
        IHVzZXIgdG8gY2hvb3NlIGZyb20gYSBsaXN0IG9mIG9wdGlvbnMuCgogIFRo
        ZSB0ZXh0IGFuZCBgdmFsdWVgIHByb3BlcnR5IG9mIGVhY2ggYDxvcHRpb24+
        YCBlbGVtZW50IHdpdGhpbiB0aGUKICBgPHNlbGVjdD5gIGVsZW1lbnQgYXJl
        IHBvcHVsYXRlZCBmcm9tIHRoZSBvYmplY3RzIGluIHRoZSBgRWxlbWVudC5T
        ZWxlY3RgJ3MKICBgY29udGVudGAgcHJvcGVydHkuIFRoZSB1bmRlcmx5aW5n
        IGRhdGEgb2JqZWN0IG9mIHRoZSBzZWxlY3RlZCBgPG9wdGlvbj5gIGlzCiAg
        c3RvcmVkIGluIHRoZSBgRWxlbWVudC5TZWxlY3RgJ3MgYHZhbHVlYCBwcm9w
        ZXJ0eS4KCiAgIyMgVGhlIENvbnRlbnQgUHJvcGVydHkgKGFycmF5IG9mIHN0
        cmluZ3MpCgogIFRoZSBzaW1wbGVzdCB2ZXJzaW9uIG9mIGFuIGBFbWJlci5T
        ZWxlY3RgIHRha2VzIGFuIGFycmF5IG9mIHN0cmluZ3MgYXMgaXRzCiAgYGNv
        bnRlbnRgIHByb3BlcnR5LiBUaGUgc3RyaW5nIHdpbGwgYmUgdXNlZCBhcyBi
        b3RoIHRoZSBgdmFsdWVgIHByb3BlcnR5IGFuZAogIHRoZSBpbm5lciB0ZXh0
        IG9mIGVhY2ggYDxvcHRpb24+YCBlbGVtZW50IGluc2lkZSB0aGUgcmVuZGVy
        ZWQgYDxzZWxlY3Q+YC4KCiAgRXhhbXBsZToKCiAgYGBgamF2YXNjcmlwdAog
        IEFwcC5BcHBsaWNhdGlvbkNvbnRyb2xsZXIgPSBFbWJlci5Db250cm9sbGVy
        LmV4dGVuZCh7CiAgICBuYW1lczogWyJZZWh1ZGEiLCAiVG9tIl0KICB9KTsK
        ICBgYGAKCiAgYGBgaGFuZGxlYmFycwogIHt7dmlldyBFbWJlci5TZWxlY3Qg
        Y29udGVudD1uYW1lc319CiAgYGBgCgogIFdvdWxkIHJlc3VsdCBpbiB0aGUg
        Zm9sbG93aW5nIEhUTUw6CgogIGBgYGh0bWwKICA8c2VsZWN0IGNsYXNzPSJl
        bWJlci1zZWxlY3QiPgogICAgPG9wdGlvbiB2YWx1ZT0iWWVodWRhIj5ZZWh1
        ZGE8L29wdGlvbj4KICAgIDxvcHRpb24gdmFsdWU9IlRvbSI+VG9tPC9vcHRp
        b24+CiAgPC9zZWxlY3Q+CiAgYGBgCgogIFlvdSBjYW4gY29udHJvbCB3aGlj
        aCBgPG9wdGlvbj5gIGlzIHNlbGVjdGVkIHRocm91Z2ggdGhlIGBFbWJlci5T
        ZWxlY3RgJ3MKICBgdmFsdWVgIHByb3BlcnR5OgoKICBgYGBqYXZhc2NyaXB0
        CiAgQXBwLkFwcGxpY2F0aW9uQ29udHJvbGxlciA9IEVtYmVyLkNvbnRyb2xs
        ZXIuZXh0ZW5kKHsKICAgIHNlbGVjdGVkTmFtZTogJ1RvbScsCiAgICBuYW1l
        czogWyJZZWh1ZGEiLCAiVG9tIl0KICB9KTsKICBgYGAKCiAgYGBgaGFuZGxl
        YmFycwogIHt7dmlldyBFbWJlci5TZWxlY3QKICAgICAgICAgY29udGVudD1u
        YW1lcwogICAgICAgICB2YWx1ZT1zZWxlY3RlZE5hbWUKICB9fQogIGBgYAoK
        ICBXb3VsZCByZXN1bHQgaW4gdGhlIGZvbGxvd2luZyBIVE1MIHdpdGggdGhl
        IGA8b3B0aW9uPmAgZm9yICdUb20nIHNlbGVjdGVkOgoKICBgYGBodG1sCiAg
        PHNlbGVjdCBjbGFzcz0iZW1iZXItc2VsZWN0Ij4KICAgIDxvcHRpb24gdmFs
        dWU9IlllaHVkYSI+WWVodWRhPC9vcHRpb24+CiAgICA8b3B0aW9uIHZhbHVl
        PSJUb20iIHNlbGVjdGVkPSJzZWxlY3RlZCI+VG9tPC9vcHRpb24+CiAgPC9z
        ZWxlY3Q+CiAgYGBgCgogIEEgdXNlciBpbnRlcmFjdGluZyB3aXRoIHRoZSBy
        ZW5kZXJlZCBgPHNlbGVjdD5gIHRvIGNob29zZSAiWWVodWRhIiB3b3VsZAog
        IHVwZGF0ZSB0aGUgdmFsdWUgb2YgYHNlbGVjdGVkTmFtZWAgdG8gIlllaHVk
        YSIuCgogICMjIFRoZSBDb250ZW50IFByb3BlcnR5IChhcnJheSBvZiBPYmpl
        Y3RzKQoKICBBbiBgRW1iZXIuU2VsZWN0YCBjYW4gYWxzbyB0YWtlIGFuIGFy
        cmF5IG9mIEphdmFTY3JpcHQgb3IgRW1iZXIgb2JqZWN0cyBhcwogIGl0cyBg
        Y29udGVudGAgcHJvcGVydHkuCgogIFdoZW4gdXNpbmcgb2JqZWN0cyB5b3Ug
        bmVlZCB0byB0ZWxsIHRoZSBgRW1iZXIuU2VsZWN0YCB3aGljaCBwcm9wZXJ0
        eSBzaG91bGQKICBiZSBhY2Nlc3NlZCBvbiBlYWNoIG9iamVjdCB0byBzdXBw
        bHkgdGhlIGB2YWx1ZWAgYXR0cmlidXRlIG9mIHRoZSBgPG9wdGlvbj5gCiAg
        YW5kIHdoaWNoIHByb3BlcnR5IHNob3VsZCBiZSB1c2VkIHRvIHN1cHBseSB0
        aGUgZWxlbWVudCB0ZXh0LgoKICBUaGUgYG9wdGlvblZhbHVlUGF0aGAgb3B0
        aW9uIGlzIHVzZWQgdG8gc3BlY2lmeSB0aGUgcGF0aCBvbiBlYWNoIG9iamVj
        dCB0bwogIHRoZSBkZXNpcmVkIHByb3BlcnR5IGZvciB0aGUgYHZhbHVlYCBh
        dHRyaWJ1dGUuIFRoZSBgb3B0aW9uTGFiZWxQYXRoYAogIHNwZWNpZmllcyB0
        aGUgcGF0aCBvbiBlYWNoIG9iamVjdCB0byB0aGUgZGVzaXJlZCBwcm9wZXJ0
        eSBmb3IgdGhlCiAgZWxlbWVudCdzIHRleHQuIEJvdGggcGF0aHMgbXVzdCBy
        ZWZlcmVuY2UgZWFjaCBvYmplY3QgaXRzZWxmIGFzIGBjb250ZW50YDoKCiAg
        YGBgamF2YXNjcmlwdAogIEFwcC5BcHBsaWNhdGlvbkNvbnRyb2xsZXIgPSBF
        bWJlci5Db250cm9sbGVyLmV4dGVuZCh7CiAgICBwcm9ncmFtbWVyczogWwog
        ICAgICB7Zmlyc3ROYW1lOiAiWWVodWRhIiwgaWQ6IDF9LAogICAgICB7Zmly
        c3ROYW1lOiAiVG9tIiwgICAgaWQ6IDJ9CiAgICBdCiAgfSk7CiAgYGBgCgog
        IGBgYGhhbmRsZWJhcnMKICB7e3ZpZXcgRW1iZXIuU2VsZWN0CiAgICAgICAg
        IGNvbnRlbnQ9cHJvZ3JhbW1lcnMKICAgICAgICAgb3B0aW9uVmFsdWVQYXRo
        PSJjb250ZW50LmlkIgogICAgICAgICBvcHRpb25MYWJlbFBhdGg9ImNvbnRl
        bnQuZmlyc3ROYW1lIn19CiAgYGBgCgogIFdvdWxkIHJlc3VsdCBpbiB0aGUg
        Zm9sbG93aW5nIEhUTUw6CgogIGBgYGh0bWwKICA8c2VsZWN0IGNsYXNzPSJl
        bWJlci1zZWxlY3QiPgogICAgPG9wdGlvbiB2YWx1ZT0iMSI+WWVodWRhPC9v
        cHRpb24+CiAgICA8b3B0aW9uIHZhbHVlPSIyIj5Ub208L29wdGlvbj4KICA8
        L3NlbGVjdD4KICBgYGAKCiAgVGhlIGB2YWx1ZWAgYXR0cmlidXRlIG9mIHRo
        ZSBzZWxlY3RlZCBgPG9wdGlvbj5gIHdpdGhpbiBhbiBgRW1iZXIuU2VsZWN0
        YAogIGNhbiBiZSBib3VuZCB0byBhIHByb3BlcnR5IG9uIGFub3RoZXIgb2Jq
        ZWN0OgoKICBgYGBqYXZhc2NyaXB0CiAgQXBwLkFwcGxpY2F0aW9uQ29udHJv
        bGxlciA9IEVtYmVyLkNvbnRyb2xsZXIuZXh0ZW5kKHsKICAgIHByb2dyYW1t
        ZXJzOiBbCiAgICAgIHtmaXJzdE5hbWU6ICJZZWh1ZGEiLCBpZDogMX0sCiAg
        ICAgIHtmaXJzdE5hbWU6ICJUb20iLCAgICBpZDogMn0KICAgIF0sCiAgICBj
        dXJyZW50UHJvZ3JhbW1lcjogewogICAgICBpZDogMgogICAgfQogIH0pOwog
        IGBgYAoKICBgYGBoYW5kbGViYXJzCiAge3t2aWV3IEVtYmVyLlNlbGVjdAog
        ICAgICAgICBjb250ZW50PXByb2dyYW1tZXJzCiAgICAgICAgIG9wdGlvblZh
        bHVlUGF0aD0iY29udGVudC5pZCIKICAgICAgICAgb3B0aW9uTGFiZWxQYXRo
        PSJjb250ZW50LmZpcnN0TmFtZSIKICAgICAgICAgdmFsdWU9Y3VycmVudFBy
        b2dyYW1tZXIuaWR9fQogIGBgYAoKICBXb3VsZCByZXN1bHQgaW4gdGhlIGZv
        bGxvd2luZyBIVE1MIHdpdGggYSBzZWxlY3RlZCBvcHRpb246CgogIGBgYGh0
        bWwKICA8c2VsZWN0IGNsYXNzPSJlbWJlci1zZWxlY3QiPgogICAgPG9wdGlv
        biB2YWx1ZT0iMSI+WWVodWRhPC9vcHRpb24+CiAgICA8b3B0aW9uIHZhbHVl
        PSIyIiBzZWxlY3RlZD0ic2VsZWN0ZWQiPlRvbTwvb3B0aW9uPgogIDwvc2Vs
        ZWN0PgogIGBgYAoKICBJbnRlcmFjdGluZyB3aXRoIHRoZSByZW5kZXJlZCBl
        bGVtZW50IGJ5IHNlbGVjdGluZyB0aGUgZmlyc3Qgb3B0aW9uCiAgKCdZZWh1
        ZGEnKSB3aWxsIHVwZGF0ZSB0aGUgYGlkYCBvZiBgY3VycmVudFByb2dyYW1t
        ZXJgCiAgdG8gbWF0Y2ggdGhlIGB2YWx1ZWAgcHJvcGVydHkgb2YgdGhlIG5l
        d2x5IHNlbGVjdGVkIGA8b3B0aW9uPmAuCgogIEFsdGVybmF0aXZlbHksIHlv
        dSBjYW4gY29udHJvbCBzZWxlY3Rpb24gdGhyb3VnaCB0aGUgdW5kZXJseWlu
        ZyBvYmplY3RzCiAgdXNlZCB0byByZW5kZXIgZWFjaCBvYmplY3QgYnkgYmlu
        ZGluZyB0aGUgYHNlbGVjdGlvbmAgb3B0aW9uLiBXaGVuIHRoZSBzZWxlY3Rl
        ZAogIGA8b3B0aW9uPmAgaXMgY2hhbmdlZCwgdGhlIHByb3BlcnR5IHBhdGgg
        cHJvdmlkZWQgdG8gYHNlbGVjdGlvbmAKICB3aWxsIGJlIHVwZGF0ZWQgdG8g
        bWF0Y2ggdGhlIGNvbnRlbnQgb2JqZWN0IG9mIHRoZSByZW5kZXJlZCBgPG9w
        dGlvbj5gCiAgZWxlbWVudDoKCiAgYGBgamF2YXNjcmlwdAogIEFwcC5BcHBs
        aWNhdGlvbkNvbnRyb2xsZXIgPSBFbWJlci5Db250cm9sbGVyLmV4dGVuZCh7
        CiAgICBzZWxlY3RlZFBlcnNvbjogbnVsbCwKICAgIHByb2dyYW1tZXJzOiBb
        CiAgICAgIHtmaXJzdE5hbWU6ICJZZWh1ZGEiLCBpZDogMX0sCiAgICAgIHtm
        aXJzdE5hbWU6ICJUb20iLCAgICBpZDogMn0KICAgIF0KICB9KTsKICBgYGAK
        CiAgYGBgaGFuZGxlYmFycwogIHt7dmlldyBFbWJlci5TZWxlY3QKICAgICAg
        ICAgY29udGVudD1wcm9ncmFtbWVycwogICAgICAgICBvcHRpb25WYWx1ZVBh
        dGg9ImNvbnRlbnQuaWQiCiAgICAgICAgIG9wdGlvbkxhYmVsUGF0aD0iY29u
        dGVudC5maXJzdE5hbWUiCiAgICAgICAgIHNlbGVjdGlvbj1zZWxlY3RlZFBl
        cnNvbn19CiAgYGBgCgogIFdvdWxkIHJlc3VsdCBpbiB0aGUgZm9sbG93aW5n
        IEhUTUwgd2l0aCBhIHNlbGVjdGVkIG9wdGlvbjoKCiAgYGBgaHRtbAogIDxz
        ZWxlY3QgY2xhc3M9ImVtYmVyLXNlbGVjdCI+CiAgICA8b3B0aW9uIHZhbHVl
        PSIxIj5ZZWh1ZGE8L29wdGlvbj4KICAgIDxvcHRpb24gdmFsdWU9IjIiIHNl
        bGVjdGVkPSJzZWxlY3RlZCI+VG9tPC9vcHRpb24+CiAgPC9zZWxlY3Q+CiAg
        YGBgCgogIEludGVyYWN0aW5nIHdpdGggdGhlIHJlbmRlcmVkIGVsZW1lbnQg
        Ynkgc2VsZWN0aW5nIHRoZSBmaXJzdCBvcHRpb24KICAoJ1llaHVkYScpIHdp
        bGwgdXBkYXRlIHRoZSBgc2VsZWN0ZWRQZXJzb25gIHRvIG1hdGNoIHRoZSBv
        YmplY3Qgb2YKICB0aGUgbmV3bHkgc2VsZWN0ZWQgYDxvcHRpb24+YC4gSW4g
        dGhpcyBjYXNlIGl0IGlzIHRoZSBmaXJzdCBvYmplY3QKICBpbiB0aGUgYHBy
        b2dyYW1tZXJzYAoKICAjIyBTdXBwbHlpbmcgYSBQcm9tcHQKCiAgQSBgbnVs
        bGAgdmFsdWUgZm9yIHRoZSBgRW1iZXIuU2VsZWN0YCdzIGB2YWx1ZWAgb3Ig
        YHNlbGVjdGlvbmAgcHJvcGVydHkKICByZXN1bHRzIGluIHRoZXJlIGJlaW5n
        IG5vIGA8b3B0aW9uPmAgd2l0aCBhIGBzZWxlY3RlZGAgYXR0cmlidXRlOgoK
        ICBgYGBqYXZhc2NyaXB0CiAgQXBwLkFwcGxpY2F0aW9uQ29udHJvbGxlciA9
        IEVtYmVyLkNvbnRyb2xsZXIuZXh0ZW5kKHsKICAgIHNlbGVjdGVkUHJvZ3Jh
        bW1lcjogbnVsbCwKICAgIHByb2dyYW1tZXJzOiBbCiAgICAgICJZZWh1ZGEi
        LAogICAgICAiVG9tIgogICAgXQogIH0pOwogIGBgYAoKICBgYGAgaGFuZGxl
        YmFycwogIHt7dmlldyBFbWJlci5TZWxlY3QKICAgICAgICAgY29udGVudD1w
        cm9ncmFtbWVycwogICAgICAgICB2YWx1ZT1zZWxlY3RlZFByb2dyYW1tZXIK
        ICB9fQogIGBgYAoKICBXb3VsZCByZXN1bHQgaW4gdGhlIGZvbGxvd2luZyBI
        VE1MOgoKICBgYGBodG1sCiAgPHNlbGVjdCBjbGFzcz0iZW1iZXItc2VsZWN0
        Ij4KICAgIDxvcHRpb24gdmFsdWU9IlllaHVkYSI+WWVodWRhPC9vcHRpb24+
        CiAgICA8b3B0aW9uIHZhbHVlPSJUb20iPlRvbTwvb3B0aW9uPgogIDwvc2Vs
        ZWN0PgogIGBgYAoKICBBbHRob3VnaCBgc2VsZWN0ZWRQcm9ncmFtbWVyYCBp
        cyBgbnVsbGAgYW5kIG5vIGA8b3B0aW9uPmAKICBoYXMgYSBgc2VsZWN0ZWRg
        IGF0dHJpYnV0ZSB0aGUgcmVuZGVyZWQgSFRNTCB3aWxsIGRpc3BsYXkgdGhl
        CiAgZmlyc3QgaXRlbSBhcyB0aG91Z2ggaXQgd2VyZSBzZWxlY3RlZC4gWW91
        IGNhbiBzdXBwbHkgYSBzdHJpbmcKICB2YWx1ZSBmb3IgdGhlIGBFbWJlci5T
        ZWxlY3RgIHRvIGRpc3BsYXkgd2hlbiB0aGVyZSBpcyBubyBzZWxlY3Rpb24K
        ICB3aXRoIHRoZSBgcHJvbXB0YCBvcHRpb246CgogIGBgYGphdmFzY3JpcHQK
        ICBBcHAuQXBwbGljYXRpb25Db250cm9sbGVyID0gRW1iZXIuQ29udHJvbGxl
        ci5leHRlbmQoewogICAgc2VsZWN0ZWRQcm9ncmFtbWVyOiBudWxsLAogICAg
        cHJvZ3JhbW1lcnM6IFsKICAgICAgIlllaHVkYSIsCiAgICAgICJUb20iCiAg
        ICBdCiAgfSk7CiAgYGBgCgogIGBgYGhhbmRsZWJhcnMKICB7e3ZpZXcgRW1i
        ZXIuU2VsZWN0CiAgICAgICAgIGNvbnRlbnQ9cHJvZ3JhbW1lcnMKICAgICAg
        ICAgdmFsdWU9c2VsZWN0ZWRQcm9ncmFtbWVyCiAgICAgICAgIHByb21wdD0i
        UGxlYXNlIHNlbGVjdCBhIG5hbWUiCiAgfX0KICBgYGAKCiAgV291bGQgcmVz
        dWx0IGluIHRoZSBmb2xsb3dpbmcgSFRNTDoKCiAgYGBgaHRtbAogIDxzZWxl
        Y3QgY2xhc3M9ImVtYmVyLXNlbGVjdCI+CiAgICA8b3B0aW9uPlBsZWFzZSBz
        ZWxlY3QgYSBuYW1lPC9vcHRpb24+CiAgICA8b3B0aW9uIHZhbHVlPSJZZWh1
        ZGEiPlllaHVkYTwvb3B0aW9uPgogICAgPG9wdGlvbiB2YWx1ZT0iVG9tIj5U
        b208L29wdGlvbj4KICA8L3NlbGVjdD4KICBgYGAKCiAgQGNsYXNzIFNlbGVj
        dAogIEBuYW1lc3BhY2UgRW1iZXIKICBAZXh0ZW5kcyBFbWJlci5WaWV3Ciov
        CkVtYmVyLlNlbGVjdCA9IEVtYmVyLlZpZXcuZXh0ZW5kKAogIC8qKiBAc2Nv
        cGUgRW1iZXIuU2VsZWN0LnByb3RvdHlwZSAqLyB7CgogIHRhZ05hbWU6ICdz
        ZWxlY3QnLAogIGNsYXNzTmFtZXM6IFsnZW1iZXItc2VsZWN0J10sCiAgZGVm
        YXVsdFRlbXBsYXRlOiBFbWJlci5IYW5kbGViYXJzLnRlbXBsYXRlKGZ1bmN0
        aW9uIGFub255bW91cyhIYW5kbGViYXJzLGRlcHRoMCxoZWxwZXJzLHBhcnRp
        YWxzLGRhdGEpIHsKdGhpcy5jb21waWxlckluZm8gPSBbNCwnPj0gMS4wLjAn
        XTsKaGVscGVycyA9IHRoaXMubWVyZ2UoaGVscGVycywgRW1iZXIuSGFuZGxl
        YmFycy5oZWxwZXJzKTsgZGF0YSA9IGRhdGEgfHwge307CiAgdmFyIGJ1ZmZl
        ciA9ICcnLCBzdGFjazEsIGhhc2hUeXBlcywgaGFzaENvbnRleHRzLCBlc2Nh
        cGVFeHByZXNzaW9uPXRoaXMuZXNjYXBlRXhwcmVzc2lvbiwgc2VsZj10aGlz
        OwoKZnVuY3Rpb24gcHJvZ3JhbTEoZGVwdGgwLGRhdGEpIHsKICAKICB2YXIg
        YnVmZmVyID0gJycsIGhhc2hUeXBlcywgaGFzaENvbnRleHRzOwogIGRhdGEu
        YnVmZmVyLnB1c2goIjxvcHRpb24gdmFsdWU9XCJcIj4iKTsKICBoYXNoVHlw
        ZXMgPSB7fTsKICBoYXNoQ29udGV4dHMgPSB7fTsKICBkYXRhLmJ1ZmZlci5w
        dXNoKGVzY2FwZUV4cHJlc3Npb24oaGVscGVycy5fdHJpYWdlTXVzdGFjaGUu
        Y2FsbChkZXB0aDAsICJ2aWV3LnByb21wdCIsIHtoYXNoOnt9LGNvbnRleHRz
        OltkZXB0aDBdLHR5cGVzOlsiSUQiXSxoYXNoQ29udGV4dHM6aGFzaENvbnRl
        eHRzLGhhc2hUeXBlczpoYXNoVHlwZXMsZGF0YTpkYXRhfSkpKTsKICBkYXRh
        LmJ1ZmZlci5wdXNoKCI8L29wdGlvbj4iKTsKICByZXR1cm4gYnVmZmVyOwog
        IH0KCmZ1bmN0aW9uIHByb2dyYW0zKGRlcHRoMCxkYXRhKSB7CiAgCiAgdmFy
        IHN0YWNrMSwgaGFzaFR5cGVzLCBoYXNoQ29udGV4dHM7CiAgaGFzaFR5cGVz
        ID0ge307CiAgaGFzaENvbnRleHRzID0ge307CiAgc3RhY2sxID0gaGVscGVy
        cy5lYWNoLmNhbGwoZGVwdGgwLCAidmlldy5ncm91cGVkQ29udGVudCIsIHto
        YXNoOnt9LGludmVyc2U6c2VsZi5ub29wLGZuOnNlbGYucHJvZ3JhbSg0LCBw
        cm9ncmFtNCwgZGF0YSksY29udGV4dHM6W2RlcHRoMF0sdHlwZXM6WyJJRCJd
        LGhhc2hDb250ZXh0czpoYXNoQ29udGV4dHMsaGFzaFR5cGVzOmhhc2hUeXBl
        cyxkYXRhOmRhdGF9KTsKICBpZihzdGFjazEgfHwgc3RhY2sxID09PSAwKSB7
        IGRhdGEuYnVmZmVyLnB1c2goc3RhY2sxKTsgfQogIGVsc2UgeyBkYXRhLmJ1
        ZmZlci5wdXNoKCcnKTsgfQogIH0KZnVuY3Rpb24gcHJvZ3JhbTQoZGVwdGgw
        LGRhdGEpIHsKICAKICB2YXIgaGFzaENvbnRleHRzLCBoYXNoVHlwZXM7CiAg
        aGFzaENvbnRleHRzID0geydjb250ZW50JzogZGVwdGgwLCdsYWJlbCc6IGRl
        cHRoMH07CiAgaGFzaFR5cGVzID0geydjb250ZW50JzogIklEIiwnbGFiZWwn
        OiAiSUQifTsKICBkYXRhLmJ1ZmZlci5wdXNoKGVzY2FwZUV4cHJlc3Npb24o
        aGVscGVycy52aWV3LmNhbGwoZGVwdGgwLCAidmlldy5ncm91cFZpZXciLCB7
        aGFzaDp7CiAgICAnY29udGVudCc6ICgiY29udGVudCIpLAogICAgJ2xhYmVs
        JzogKCJsYWJlbCIpCiAgfSxjb250ZXh0czpbZGVwdGgwXSx0eXBlczpbIklE
        Il0saGFzaENvbnRleHRzOmhhc2hDb250ZXh0cyxoYXNoVHlwZXM6aGFzaFR5
        cGVzLGRhdGE6ZGF0YX0pKSk7CiAgfQoKZnVuY3Rpb24gcHJvZ3JhbTYoZGVw
        dGgwLGRhdGEpIHsKICAKICB2YXIgc3RhY2sxLCBoYXNoVHlwZXMsIGhhc2hD
        b250ZXh0czsKICBoYXNoVHlwZXMgPSB7fTsKICBoYXNoQ29udGV4dHMgPSB7
        fTsKICBzdGFjazEgPSBoZWxwZXJzLmVhY2guY2FsbChkZXB0aDAsICJ2aWV3
        LmNvbnRlbnQiLCB7aGFzaDp7fSxpbnZlcnNlOnNlbGYubm9vcCxmbjpzZWxm
        LnByb2dyYW0oNywgcHJvZ3JhbTcsIGRhdGEpLGNvbnRleHRzOltkZXB0aDBd
        LHR5cGVzOlsiSUQiXSxoYXNoQ29udGV4dHM6aGFzaENvbnRleHRzLGhhc2hU
        eXBlczpoYXNoVHlwZXMsZGF0YTpkYXRhfSk7CiAgaWYoc3RhY2sxIHx8IHN0
        YWNrMSA9PT0gMCkgeyBkYXRhLmJ1ZmZlci5wdXNoKHN0YWNrMSk7IH0KICBl
        bHNlIHsgZGF0YS5idWZmZXIucHVzaCgnJyk7IH0KICB9CmZ1bmN0aW9uIHBy
        b2dyYW03KGRlcHRoMCxkYXRhKSB7CiAgCiAgdmFyIGhhc2hDb250ZXh0cywg
        aGFzaFR5cGVzOwogIGhhc2hDb250ZXh0cyA9IHsnY29udGVudCc6IGRlcHRo
        MH07CiAgaGFzaFR5cGVzID0geydjb250ZW50JzogIklEIn07CiAgZGF0YS5i
        dWZmZXIucHVzaChlc2NhcGVFeHByZXNzaW9uKGhlbHBlcnMudmlldy5jYWxs
        KGRlcHRoMCwgInZpZXcub3B0aW9uVmlldyIsIHtoYXNoOnsKICAgICdjb250
        ZW50JzogKCIiKQogIH0sY29udGV4dHM6W2RlcHRoMF0sdHlwZXM6WyJJRCJd
        LGhhc2hDb250ZXh0czpoYXNoQ29udGV4dHMsaGFzaFR5cGVzOmhhc2hUeXBl
        cyxkYXRhOmRhdGF9KSkpOwogIH0KCiAgaGFzaFR5cGVzID0ge307CiAgaGFz
        aENvbnRleHRzID0ge307CiAgc3RhY2sxID0gaGVscGVyc1snaWYnXS5jYWxs
        KGRlcHRoMCwgInZpZXcucHJvbXB0Iiwge2hhc2g6e30saW52ZXJzZTpzZWxm
        Lm5vb3AsZm46c2VsZi5wcm9ncmFtKDEsIHByb2dyYW0xLCBkYXRhKSxjb250
        ZXh0czpbZGVwdGgwXSx0eXBlczpbIklEIl0saGFzaENvbnRleHRzOmhhc2hD
        b250ZXh0cyxoYXNoVHlwZXM6aGFzaFR5cGVzLGRhdGE6ZGF0YX0pOwogIGlm
        KHN0YWNrMSB8fCBzdGFjazEgPT09IDApIHsgZGF0YS5idWZmZXIucHVzaChz
        dGFjazEpOyB9CiAgaGFzaFR5cGVzID0ge307CiAgaGFzaENvbnRleHRzID0g
        e307CiAgc3RhY2sxID0gaGVscGVyc1snaWYnXS5jYWxsKGRlcHRoMCwgInZp
        ZXcub3B0aW9uR3JvdXBQYXRoIiwge2hhc2g6e30saW52ZXJzZTpzZWxmLnBy
        b2dyYW0oNiwgcHJvZ3JhbTYsIGRhdGEpLGZuOnNlbGYucHJvZ3JhbSgzLCBw
        cm9ncmFtMywgZGF0YSksY29udGV4dHM6W2RlcHRoMF0sdHlwZXM6WyJJRCJd
        LGhhc2hDb250ZXh0czpoYXNoQ29udGV4dHMsaGFzaFR5cGVzOmhhc2hUeXBl
        cyxkYXRhOmRhdGF9KTsKICBpZihzdGFjazEgfHwgc3RhY2sxID09PSAwKSB7
        IGRhdGEuYnVmZmVyLnB1c2goc3RhY2sxKTsgfQogIHJldHVybiBidWZmZXI7
        CiAgCn0pLAogIGF0dHJpYnV0ZUJpbmRpbmdzOiBbJ211bHRpcGxlJywgJ2Rp
        c2FibGVkJywgJ3RhYmluZGV4JywgJ25hbWUnXSwKCiAgLyoqCiAgICBUaGUg
        YG11bHRpcGxlYCBhdHRyaWJ1dGUgb2YgdGhlIHNlbGVjdCBlbGVtZW50LiBJ
        bmRpY2F0ZXMgd2hldGhlciBtdWx0aXBsZQogICAgb3B0aW9ucyBjYW4gYmUg
        c2VsZWN0ZWQuCgogICAgQHByb3BlcnR5IG11bHRpcGxlCiAgICBAdHlwZSBC
        b29sZWFuCiAgICBAZGVmYXVsdCBmYWxzZQogICovCiAgbXVsdGlwbGU6IGZh
        bHNlLAoKICAvKioKICAgIFRoZSBgZGlzYWJsZWRgIGF0dHJpYnV0ZSBvZiB0
        aGUgc2VsZWN0IGVsZW1lbnQuIEluZGljYXRlcyB3aGV0aGVyCiAgICB0aGUg
        ZWxlbWVudCBpcyBkaXNhYmxlZCBmcm9tIGludGVyYWN0aW9ucy4KCiAgICBA
        cHJvcGVydHkgZGlzYWJsZWQKICAgIEB0eXBlIEJvb2xlYW4KICAgIEBkZWZh
        dWx0IGZhbHNlCiAgKi8KICBkaXNhYmxlZDogZmFsc2UsCgogIC8qKgogICAg
        VGhlIGxpc3Qgb2Ygb3B0aW9ucy4KCiAgICBJZiBgb3B0aW9uTGFiZWxQYXRo
        YCBhbmQgYG9wdGlvblZhbHVlUGF0aGAgYXJlIG5vdCBvdmVycmlkZGVuLCB0
        aGlzIHNob3VsZAogICAgYmUgYSBsaXN0IG9mIHN0cmluZ3MsIHdoaWNoIHdp
        bGwgc2VydmUgc2ltdWx0YW5lb3VzbHkgYXMgbGFiZWxzIGFuZCB2YWx1ZXMu
        CgogICAgT3RoZXJ3aXNlLCB0aGlzIHNob3VsZCBiZSBhIGxpc3Qgb2Ygb2Jq
        ZWN0cy4gRm9yIGluc3RhbmNlOgoKICAgIGBgYGphdmFzY3JpcHQKICAgIEVt
        YmVyLlNlbGVjdC5jcmVhdGUoewogICAgICBjb250ZW50OiBFbWJlci5BKFsK
        ICAgICAgICAgIHsgaWQ6IDEsIGZpcnN0TmFtZTogJ1llaHVkYScgfSwKICAg
        ICAgICAgIHsgaWQ6IDIsIGZpcnN0TmFtZTogJ1RvbScgfQogICAgICAgIF0p
        LAogICAgICBvcHRpb25MYWJlbFBhdGg6ICdjb250ZW50LmZpcnN0TmFtZScs
        CiAgICAgIG9wdGlvblZhbHVlUGF0aDogJ2NvbnRlbnQuaWQnCiAgICB9KTsK
        ICAgIGBgYAoKICAgIEBwcm9wZXJ0eSBjb250ZW50CiAgICBAdHlwZSBBcnJh
        eQogICAgQGRlZmF1bHQgbnVsbAogICovCiAgY29udGVudDogbnVsbCwKCiAg
        LyoqCiAgICBXaGVuIGBtdWx0aXBsZWAgaXMgYGZhbHNlYCwgdGhlIGVsZW1l
        bnQgb2YgYGNvbnRlbnRgIHRoYXQgaXMgY3VycmVudGx5CiAgICBzZWxlY3Rl
        ZCwgaWYgYW55LgoKICAgIFdoZW4gYG11bHRpcGxlYCBpcyBgdHJ1ZWAsIGFu
        IGFycmF5IG9mIHN1Y2ggZWxlbWVudHMuCgogICAgQHByb3BlcnR5IHNlbGVj
        dGlvbgogICAgQHR5cGUgT2JqZWN0IG9yIEFycmF5CiAgICBAZGVmYXVsdCBu
        dWxsCiAgKi8KICBzZWxlY3Rpb246IG51bGwsCgogIC8qKgogICAgSW4gc2lu
        Z2xlIHNlbGVjdGlvbiBtb2RlICh3aGVuIGBtdWx0aXBsZWAgaXMgYGZhbHNl
        YCksIHZhbHVlIGNhbiBiZSB1c2VkIHRvCiAgICBnZXQgdGhlIGN1cnJlbnQg
        c2VsZWN0aW9uJ3MgdmFsdWUgb3Igc2V0IHRoZSBzZWxlY3Rpb24gYnkgaXQn
        cyB2YWx1ZS4KCiAgICBJdCBpcyBub3QgY3VycmVudGx5IHN1cHBvcnRlZCBp
        biBtdWx0aXBsZSBzZWxlY3Rpb24gbW9kZS4KCiAgICBAcHJvcGVydHkgdmFs
        dWUKICAgIEB0eXBlIFN0cmluZwogICAgQGRlZmF1bHQgbnVsbAogICovCiAg
        dmFsdWU6IEVtYmVyLmNvbXB1dGVkKGZ1bmN0aW9uKGtleSwgdmFsdWUpIHsK
        ICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAyKSB7IHJldHVybiB2YWx1
        ZTsgfQogICAgdmFyIHZhbHVlUGF0aCA9IGdldCh0aGlzLCAnb3B0aW9uVmFs
        dWVQYXRoJykucmVwbGFjZSgvXmNvbnRlbnRcLj8vLCAnJyk7CiAgICByZXR1
        cm4gdmFsdWVQYXRoID8gZ2V0KHRoaXMsICdzZWxlY3Rpb24uJyArIHZhbHVl
        UGF0aCkgOiBnZXQodGhpcywgJ3NlbGVjdGlvbicpOwogIH0pLnByb3BlcnR5
        KCdzZWxlY3Rpb24nKSwKCiAgLyoqCiAgICBJZiBnaXZlbiwgYSB0b3AtbW9z
        dCBkdW1teSBvcHRpb24gd2lsbCBiZSByZW5kZXJlZCB0byBzZXJ2ZSBhcyBh
        IHVzZXIKICAgIHByb21wdC4KCiAgICBAcHJvcGVydHkgcHJvbXB0CiAgICBA
        dHlwZSBTdHJpbmcKICAgIEBkZWZhdWx0IG51bGwKICAqLwogIHByb21wdDog
        bnVsbCwKCiAgLyoqCiAgICBUaGUgcGF0aCBvZiB0aGUgb3B0aW9uIGxhYmVs
        cy4gU2VlIFtjb250ZW50XSgvYXBpL2NsYXNzZXMvRW1iZXIuU2VsZWN0Lmh0
        bWwjcHJvcGVydHlfY29udGVudCkuCgogICAgQHByb3BlcnR5IG9wdGlvbkxh
        YmVsUGF0aAogICAgQHR5cGUgU3RyaW5nCiAgICBAZGVmYXVsdCAnY29udGVu
        dCcKICAqLwogIG9wdGlvbkxhYmVsUGF0aDogJ2NvbnRlbnQnLAoKICAvKioK
        ICAgIFRoZSBwYXRoIG9mIHRoZSBvcHRpb24gdmFsdWVzLiBTZWUgW2NvbnRl
        bnRdKC9hcGkvY2xhc3Nlcy9FbWJlci5TZWxlY3QuaHRtbCNwcm9wZXJ0eV9j
        b250ZW50KS4KCiAgICBAcHJvcGVydHkgb3B0aW9uVmFsdWVQYXRoCiAgICBA
        dHlwZSBTdHJpbmcKICAgIEBkZWZhdWx0ICdjb250ZW50JwogICovCiAgb3B0
        aW9uVmFsdWVQYXRoOiAnY29udGVudCcsCgogIC8qKgogICAgVGhlIHBhdGgg
        b2YgdGhlIG9wdGlvbiBncm91cC4KICAgIFdoZW4gdGhpcyBwcm9wZXJ0eSBp
        cyB1c2VkLCBgY29udGVudGAgc2hvdWxkIGJlIHNvcnRlZCBieSBgb3B0aW9u
        R3JvdXBQYXRoYC4KCiAgICBAcHJvcGVydHkgb3B0aW9uR3JvdXBQYXRoCiAg
        ICBAdHlwZSBTdHJpbmcKICAgIEBkZWZhdWx0IG51bGwKICAqLwogIG9wdGlv
        bkdyb3VwUGF0aDogbnVsbCwKCiAgLyoqCiAgICBUaGUgdmlldyBjbGFzcyBm
        b3Igb3B0Z3JvdXAuCgogICAgQHByb3BlcnR5IGdyb3VwVmlldwogICAgQHR5
        cGUgRW1iZXIuVmlldwogICAgQGRlZmF1bHQgRW1iZXIuU2VsZWN0T3B0Z3Jv
        dXAKICAqLwogIGdyb3VwVmlldzogRW1iZXIuU2VsZWN0T3B0Z3JvdXAsCgog
        IGdyb3VwZWRDb250ZW50OiBFbWJlci5jb21wdXRlZChmdW5jdGlvbigpIHsK
        ICAgIHZhciBncm91cFBhdGggPSBnZXQodGhpcywgJ29wdGlvbkdyb3VwUGF0
        aCcpOwogICAgdmFyIGdyb3VwZWRDb250ZW50ID0gRW1iZXIuQSgpOwogICAg
        dmFyIGNvbnRlbnQgPSBnZXQodGhpcywgJ2NvbnRlbnQnKSB8fCBbXTsKCiAg
        ICBmb3JFYWNoKGNvbnRlbnQsIGZ1bmN0aW9uKGl0ZW0pIHsKICAgICAgdmFy
        IGxhYmVsID0gZ2V0KGl0ZW0sIGdyb3VwUGF0aCk7CgogICAgICBpZiAoZ2V0
        KGdyb3VwZWRDb250ZW50LCAnbGFzdE9iamVjdC5sYWJlbCcpICE9PSBsYWJl
        bCkgewogICAgICAgIGdyb3VwZWRDb250ZW50LnB1c2hPYmplY3QoewogICAg
        ICAgICAgbGFiZWw6IGxhYmVsLAogICAgICAgICAgY29udGVudDogRW1iZXIu
        QSgpCiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIGdldChncm91cGVkQ29u
        dGVudCwgJ2xhc3RPYmplY3QuY29udGVudCcpLnB1c2goaXRlbSk7CiAgICB9
        KTsKCiAgICByZXR1cm4gZ3JvdXBlZENvbnRlbnQ7CiAgfSkucHJvcGVydHko
        J29wdGlvbkdyb3VwUGF0aCcsICdjb250ZW50LkBlYWNoJyksCgogIC8qKgog
        ICAgVGhlIHZpZXcgY2xhc3MgZm9yIG9wdGlvbi4KCiAgICBAcHJvcGVydHkg
        b3B0aW9uVmlldwogICAgQHR5cGUgRW1iZXIuVmlldwogICAgQGRlZmF1bHQg
        RW1iZXIuU2VsZWN0T3B0aW9uCiAgKi8KICBvcHRpb25WaWV3OiBFbWJlci5T
        ZWxlY3RPcHRpb24sCgogIF9jaGFuZ2U6IGZ1bmN0aW9uKCkgewogICAgaWYg
        KGdldCh0aGlzLCAnbXVsdGlwbGUnKSkgewogICAgICB0aGlzLl9jaGFuZ2VN
        dWx0aXBsZSgpOwogICAgfSBlbHNlIHsKICAgICAgdGhpcy5fY2hhbmdlU2lu
        Z2xlKCk7CiAgICB9CiAgfSwKCiAgc2VsZWN0aW9uRGlkQ2hhbmdlOiBFbWJl
        ci5vYnNlcnZlcihmdW5jdGlvbigpIHsKICAgIHZhciBzZWxlY3Rpb24gPSBn
        ZXQodGhpcywgJ3NlbGVjdGlvbicpOwogICAgaWYgKGdldCh0aGlzLCAnbXVs
        dGlwbGUnKSkgewogICAgICBpZiAoIWlzQXJyYXkoc2VsZWN0aW9uKSkgewog
        ICAgICAgIHNldCh0aGlzLCAnc2VsZWN0aW9uJywgRW1iZXIuQShbc2VsZWN0
        aW9uXSkpOwogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICB0aGlzLl9z
        ZWxlY3Rpb25EaWRDaGFuZ2VNdWx0aXBsZSgpOwogICAgfSBlbHNlIHsKICAg
        ICAgdGhpcy5fc2VsZWN0aW9uRGlkQ2hhbmdlU2luZ2xlKCk7CiAgICB9CiAg
        fSwgJ3NlbGVjdGlvbi5AZWFjaCcpLAoKICB2YWx1ZURpZENoYW5nZTogRW1i
        ZXIub2JzZXJ2ZXIoZnVuY3Rpb24oKSB7CiAgICB2YXIgY29udGVudCA9IGdl
        dCh0aGlzLCAnY29udGVudCcpLAogICAgICAgIHZhbHVlID0gZ2V0KHRoaXMs
        ICd2YWx1ZScpLAogICAgICAgIHZhbHVlUGF0aCA9IGdldCh0aGlzLCAnb3B0
        aW9uVmFsdWVQYXRoJykucmVwbGFjZSgvXmNvbnRlbnRcLj8vLCAnJyksCiAg
        ICAgICAgc2VsZWN0ZWRWYWx1ZSA9ICh2YWx1ZVBhdGggPyBnZXQodGhpcywg
        J3NlbGVjdGlvbi4nICsgdmFsdWVQYXRoKSA6IGdldCh0aGlzLCAnc2VsZWN0
        aW9uJykpLAogICAgICAgIHNlbGVjdGlvbjsKCiAgICBpZiAodmFsdWUgIT09
        IHNlbGVjdGVkVmFsdWUpIHsKICAgICAgc2VsZWN0aW9uID0gY29udGVudCA/
        IGNvbnRlbnQuZmluZChmdW5jdGlvbihvYmopIHsKICAgICAgICByZXR1cm4g
        dmFsdWUgPT09ICh2YWx1ZVBhdGggPyBnZXQob2JqLCB2YWx1ZVBhdGgpIDog
        b2JqKTsKICAgICAgfSkgOiBudWxsOwoKICAgICAgdGhpcy5zZXQoJ3NlbGVj
        dGlvbicsIHNlbGVjdGlvbik7CiAgICB9CiAgfSwgJ3ZhbHVlJyksCgoKICBf
        dHJpZ2dlckNoYW5nZTogZnVuY3Rpb24oKSB7CiAgICB2YXIgc2VsZWN0aW9u
        ID0gZ2V0KHRoaXMsICdzZWxlY3Rpb24nKTsKICAgIHZhciB2YWx1ZSA9IGdl
        dCh0aGlzLCAndmFsdWUnKTsKCiAgICBpZiAoIUVtYmVyLmlzTm9uZShzZWxl
        Y3Rpb24pKSB7IHRoaXMuc2VsZWN0aW9uRGlkQ2hhbmdlKCk7IH0KICAgIGlm
        ICghRW1iZXIuaXNOb25lKHZhbHVlKSkgeyB0aGlzLnZhbHVlRGlkQ2hhbmdl
        KCk7IH0KCiAgICB0aGlzLl9jaGFuZ2UoKTsKICB9LAoKICBfY2hhbmdlU2lu
        Z2xlOiBmdW5jdGlvbigpIHsKICAgIHZhciBzZWxlY3RlZEluZGV4ID0gdGhp
        cy4kKClbMF0uc2VsZWN0ZWRJbmRleCwKICAgICAgICBjb250ZW50ID0gZ2V0
        KHRoaXMsICdjb250ZW50JyksCiAgICAgICAgcHJvbXB0ID0gZ2V0KHRoaXMs
        ICdwcm9tcHQnKTsKCiAgICBpZiAoIWNvbnRlbnQgfHwgIWdldChjb250ZW50
        LCAnbGVuZ3RoJykpIHsgcmV0dXJuOyB9CiAgICBpZiAocHJvbXB0ICYmIHNl
        bGVjdGVkSW5kZXggPT09IDApIHsgc2V0KHRoaXMsICdzZWxlY3Rpb24nLCBu
        dWxsKTsgcmV0dXJuOyB9CgogICAgaWYgKHByb21wdCkgeyBzZWxlY3RlZElu
        ZGV4IC09IDE7IH0KICAgIHNldCh0aGlzLCAnc2VsZWN0aW9uJywgY29udGVu
        dC5vYmplY3RBdChzZWxlY3RlZEluZGV4KSk7CiAgfSwKCgogIF9jaGFuZ2VN
        dWx0aXBsZTogZnVuY3Rpb24oKSB7CiAgICB2YXIgb3B0aW9ucyA9IHRoaXMu
        JCgnb3B0aW9uOnNlbGVjdGVkJyksCiAgICAgICAgcHJvbXB0ID0gZ2V0KHRo
        aXMsICdwcm9tcHQnKSwKICAgICAgICBvZmZzZXQgPSBwcm9tcHQgPyAxIDog
        MCwKICAgICAgICBjb250ZW50ID0gZ2V0KHRoaXMsICdjb250ZW50JyksCiAg
        ICAgICAgc2VsZWN0aW9uID0gZ2V0KHRoaXMsICdzZWxlY3Rpb24nKTsKCiAg
        ICBpZiAoIWNvbnRlbnQpIHsgcmV0dXJuOyB9CiAgICBpZiAob3B0aW9ucykg
        ewogICAgICB2YXIgc2VsZWN0ZWRJbmRleGVzID0gb3B0aW9ucy5tYXAoZnVu
        Y3Rpb24oKSB7CiAgICAgICAgcmV0dXJuIHRoaXMuaW5kZXggLSBvZmZzZXQ7
        CiAgICAgIH0pLnRvQXJyYXkoKTsKICAgICAgdmFyIG5ld1NlbGVjdGlvbiA9
        IGNvbnRlbnQub2JqZWN0c0F0KHNlbGVjdGVkSW5kZXhlcyk7CgogICAgICBp
        ZiAoaXNBcnJheShzZWxlY3Rpb24pKSB7CiAgICAgICAgcmVwbGFjZShzZWxl
        Y3Rpb24sIDAsIGdldChzZWxlY3Rpb24sICdsZW5ndGgnKSwgbmV3U2VsZWN0
        aW9uKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBzZXQodGhpcywgJ3NlbGVj
        dGlvbicsIG5ld1NlbGVjdGlvbik7CiAgICAgIH0KICAgIH0KICB9LAoKICBf
        c2VsZWN0aW9uRGlkQ2hhbmdlU2luZ2xlOiBmdW5jdGlvbigpIHsKICAgIHZh
        ciBlbCA9IHRoaXMuZ2V0KCdlbGVtZW50Jyk7CiAgICBpZiAoIWVsKSB7IHJl
        dHVybjsgfQoKICAgIHZhciBjb250ZW50ID0gZ2V0KHRoaXMsICdjb250ZW50
        JyksCiAgICAgICAgc2VsZWN0aW9uID0gZ2V0KHRoaXMsICdzZWxlY3Rpb24n
        KSwKICAgICAgICBzZWxlY3Rpb25JbmRleCA9IGNvbnRlbnQgPyBpbmRleE9m
        KGNvbnRlbnQsIHNlbGVjdGlvbikgOiAtMSwKICAgICAgICBwcm9tcHQgPSBn
        ZXQodGhpcywgJ3Byb21wdCcpOwoKICAgIGlmIChwcm9tcHQpIHsgc2VsZWN0
        aW9uSW5kZXggKz0gMTsgfQogICAgaWYgKGVsKSB7IGVsLnNlbGVjdGVkSW5k
        ZXggPSBzZWxlY3Rpb25JbmRleDsgfQogIH0sCgogIF9zZWxlY3Rpb25EaWRD
        aGFuZ2VNdWx0aXBsZTogZnVuY3Rpb24oKSB7CiAgICB2YXIgY29udGVudCA9
        IGdldCh0aGlzLCAnY29udGVudCcpLAogICAgICAgIHNlbGVjdGlvbiA9IGdl
        dCh0aGlzLCAnc2VsZWN0aW9uJyksCiAgICAgICAgc2VsZWN0ZWRJbmRleGVz
        ID0gY29udGVudCA/IGluZGV4ZXNPZihjb250ZW50LCBzZWxlY3Rpb24pIDog
        Wy0xXSwKICAgICAgICBwcm9tcHQgPSBnZXQodGhpcywgJ3Byb21wdCcpLAog
        ICAgICAgIG9mZnNldCA9IHByb21wdCA/IDEgOiAwLAogICAgICAgIG9wdGlv
        bnMgPSB0aGlzLiQoJ29wdGlvbicpLAogICAgICAgIGFkanVzdGVkOwoKICAg
        IGlmIChvcHRpb25zKSB7CiAgICAgIG9wdGlvbnMuZWFjaChmdW5jdGlvbigp
        IHsKICAgICAgICBhZGp1c3RlZCA9IHRoaXMuaW5kZXggPiAtMSA/IHRoaXMu
        aW5kZXggLSBvZmZzZXQgOiAtMTsKICAgICAgICB0aGlzLnNlbGVjdGVkID0g
        aW5kZXhPZihzZWxlY3RlZEluZGV4ZXMsIGFkanVzdGVkKSA+IC0xOwogICAg
        ICB9KTsKICAgIH0KICB9LAoKICBpbml0OiBmdW5jdGlvbigpIHsKICAgIHRo
        aXMuX3N1cGVyKCk7CiAgICB0aGlzLm9uKCJkaWRJbnNlcnRFbGVtZW50Iiwg
        dGhpcywgdGhpcy5fdHJpZ2dlckNoYW5nZSk7CiAgICB0aGlzLm9uKCJjaGFu
        Z2UiLCB0aGlzLCB0aGlzLl9jaGFuZ2UpOwogIH0KfSk7Cgp9KSgpOwoKCgoo
        ZnVuY3Rpb24oKSB7Ci8qKgpAbW9kdWxlIGVtYmVyCkBzdWJtb2R1bGUgZW1i
        ZXItaGFuZGxlYmFycy1jb21waWxlcgoqLwoKLyoqCgogIFRoZSBge3tpbnB1
        dH19YCBoZWxwZXIgaW5zZXJ0cyBhbiBIVE1MIGA8aW5wdXQ+YCB0YWcgaW50
        byB0aGUgdGVtcGxhdGUsCiAgd2l0aCBhIGB0eXBlYCB2YWx1ZSBvZiBlaXRo
        ZXIgYHRleHRgIG9yIGBjaGVja2JveGAuIElmIG5vIGB0eXBlYCBpcyBwcm92
        aWRlZCwKICBgdGV4dGAgd2lsbCBiZSB0aGUgZGVmYXVsdCB2YWx1ZSBhcHBs
        aWVkLiBUaGUgYXR0cmlidXRlcyBvZiBge3tpbnB1dH19YAogIG1hdGNoIHRo
        b3NlIG9mIHRoZSBuYXRpdmUgSFRNTCB0YWcgYXMgY2xvc2VseSBhcyBwb3Nz
        aWJsZSBmb3IgdGhlc2UgdHdvIHR5cGVzLgoKICAjIyBVc2UgYXMgdGV4dCBm
        aWVsZAogIEFuIGB7e2lucHV0fX1gIHdpdGggbm8gYHR5cGVgIG9yIGEgYHR5
        cGVgIG9mIGB0ZXh0YCB3aWxsIHJlbmRlciBhbiBIVE1MIHRleHQgaW5wdXQu
        CiAgVGhlIGZvbGxvd2luZyBIVE1MIGF0dHJpYnV0ZXMgY2FuIGJlIHNldCB2
        aWEgdGhlIGhlbHBlcjoKCiogYHZhbHVlYAoqIGBzaXplYAoqIGBuYW1lYAoq
        IGBwYXR0ZXJuYAoqIGBwbGFjZWhvbGRlcmAKKiBgZGlzYWJsZWRgCiogYG1h
        eGxlbmd0aGAKKiBgdGFiaW5kZXhgCgoKICBXaGVuIHNldCB0byBhIHF1b3Rl
        ZCBzdHJpbmcsIHRoZXNlIHZhbHVlcyB3aWxsIGJlIGRpcmVjdGx5IGFwcGxp
        ZWQgdG8gdGhlIEhUTUwKICBlbGVtZW50LiBXaGVuIGxlZnQgdW5xdW90ZWQs
        IHRoZXNlIHZhbHVlcyB3aWxsIGJlIGJvdW5kIHRvIGEgcHJvcGVydHkgb24g
        dGhlCiAgdGVtcGxhdGUncyBjdXJyZW50IHJlbmRlcmluZyBjb250ZXh0ICht
        b3N0IHR5cGljYWxseSBhIGNvbnRyb2xsZXIgaW5zdGFuY2UpLgoKICAjIyBV
        bmJvdW5kOgoKICBgYGBoYW5kbGViYXJzCiAge3tpbnB1dCB2YWx1ZT0iaHR0
        cDovL3d3dy5mYWNlYm9vay5jb20ifX0KICBgYGAKCgogIGBgYGh0bWwKICA8
        aW5wdXQgdHlwZT0idGV4dCIgdmFsdWU9Imh0dHA6Ly93d3cuZmFjZWJvb2su
        Y29tIi8+CiAgYGBgCgogICMjIEJvdW5kOgoKICBgYGBqYXZhc2NyaXB0CiAg
        QXBwLkFwcGxpY2F0aW9uQ29udHJvbGxlciA9IEVtYmVyLkNvbnRyb2xsZXIu
        ZXh0ZW5kKHsKICAgIGZpcnN0TmFtZTogIlN0YW5sZXkiLAogICAgZW50cnlO
        b3RBbGxvd2VkOiB0cnVlCiAgfSk7CiAgYGBgCgoKICBgYGBoYW5kbGViYXJz
        CiAge3tpbnB1dCB0eXBlPSJ0ZXh0IiB2YWx1ZT1maXJzdE5hbWUgZGlzYWJs
        ZWQ9ZW50cnlOb3RBbGxvd2VkIHNpemU9IjUwIn19CiAgYGBgCgoKICBgYGBo
        dG1sCiAgPGlucHV0IHR5cGU9InRleHQiIHZhbHVlPSJTdGFubGV5IiBkaXNh
        YmxlZD0iZGlzYWJsZWQiIHNpemU9IjUwIi8+CiAgYGBgCgogICMjIEV4dGVu
        c2lvbgoKICBJbnRlcm5hbGx5LCBge3tpbnB1dCB0eXBlPSJ0ZXh0In19YCBj
        cmVhdGVzIGFuIGluc3RhbmNlIG9mIGBFbWJlci5UZXh0RmllbGRgLCBwYXNz
        aW5nCiAgYXJndW1lbnRzIGZyb20gdGhlIGhlbHBlciB0byBgRW1iZXIuVGV4
        dEZpZWxkYCdzIGBjcmVhdGVgIG1ldGhvZC4gWW91IGNhbiBleHRlbmQgdGhl
        CiAgY2FwYWJsaWx0aWVzIG9mIHRleHQgaW5wdXRzIGluIHlvdXIgYXBwbGlj
        YXRpb25zIGJ5IHJlb3BlbmluZyB0aGlzIGNsYXNzLiBGb3IgZXhhbXBsZSwK
        ICBpZiB5b3UgYXJlIGRlcGxveWluZyB0byBicm93c2VycyB3aGVyZSB0aGUg
        YHJlcXVpcmVkYCBhdHRyaWJ1dGUgaXMgdXNlZCwgeW91CiAgY2FuIGFkZCB0
        aGlzIHRvIHRoZSBgVGV4dEZpZWxkYCdzIGBhdHRyaWJ1dGVCaW5kaW5nc2Ag
        cHJvcGVydHk6CgogIGBgYGphdmFzY3JpcHQKICBFbWJlci5UZXh0RmllbGQu
        cmVvcGVuKHsKICAgIGF0dHJpYnV0ZUJpbmRpbmdzOiBbJ3JlcXVpcmVkJ10K
        ICB9KTsKICBgYGAKCiAgS2VlcCBpbiBtaW5kIHdoZW4gd3JpdGluZyBgRW1i
        ZXIuVGV4dEZpZWxkYCBzdWJjbGFzc2VzIHRoYXQgYEVtYmVyLlRleHRGaWVs
        ZGAKICBpdHNlbGYgZXh0ZW5kcyBgRW1iZXIuQ29tcG9uZW50YCwgbWVhbmlu
        ZyB0aGF0IGl0IGRvZXMgTk9UIGluaGVyaXQKICB0aGUgYGNvbnRyb2xsZXJg
        IG9mIHRoZSBwYXJlbnQgdmlldy4KCiAgU2VlIG1vcmUgYWJvdXQgW0VtYmVy
        IGNvbXBvbmVudHNdKGFwaS9jbGFzc2VzL0VtYmVyLkNvbXBvbmVudC5odG1s
        KQoKCiAgIyMgVXNlIGFzIGNoZWNrYm94CgogIEFuIGB7e2lucHV0fX1gIHdp
        dGggYSBgdHlwZWAgb2YgYGNoZWNrYm94YCB3aWxsIHJlbmRlciBhbiBIVE1M
        IGNoZWNrYm94IGlucHV0LgogIFRoZSBmb2xsb3dpbmcgSFRNTCBhdHRyaWJ1
        dGVzIGNhbiBiZSBzZXQgdmlhIHRoZSBoZWxwZXI6CgoqIGBjaGVja2VkYAoq
        IGBkaXNhYmxlZGAKKiBgdGFiaW5kZXhgCiogYGluZGV0ZXJtaW5hdGVgCiog
        YG5hbWVgCgogIFdoZW4gc2V0IHRvIGEgcXVvdGVkIHN0cmluZywgdGhlc2Ug
        dmFsdWVzIHdpbGwgYmUgZGlyZWN0bHkgYXBwbGllZCB0byB0aGUgSFRNTAog
        IGVsZW1lbnQuIFdoZW4gbGVmdCB1bnF1b3RlZCwgdGhlc2UgdmFsdWVzIHdp
        bGwgYmUgYm91bmQgdG8gYSBwcm9wZXJ0eSBvbiB0aGUKICB0ZW1wbGF0ZSdz
        IGN1cnJlbnQgcmVuZGVyaW5nIGNvbnRleHQgKG1vc3QgdHlwaWNhbGx5IGEg
        Y29udHJvbGxlciBpbnN0YW5jZSkuCgogICMjIFVuYm91bmQ6CgogIGBgYGhh
        bmRsZWJhcnMKICB7e2lucHV0IHR5cGU9ImNoZWNrYm94IiBuYW1lPSJpc0Fk
        bWluIn19CiAgYGBgCgogIGBgYGh0bWwKICA8aW5wdXQgdHlwZT0iY2hlY2ti
        b3giIG5hbWU9ImlzQWRtaW4iIC8+CiAgYGBgCgogICMjIEJvdW5kOgoKICBg
        YGBqYXZhc2NyaXB0CiAgQXBwLkFwcGxpY2F0aW9uQ29udHJvbGxlciA9IEVt
        YmVyLkNvbnRyb2xsZXIuZXh0ZW5kKHsKICAgIGlzQWRtaW46IHRydWUKICB9
        KTsKICBgYGAKCgogIGBgYGhhbmRsZWJhcnMKICB7e2lucHV0IHR5cGU9ImNo
        ZWNrYm94IiBjaGVja2VkPWlzQWRtaW4gfX0KICBgYGAKCgogIGBgYGh0bWwK
        ICA8aW5wdXQgdHlwZT0iY2hlY2tib3giIGNoZWNrZWQ9ImNoZWNrZWQiIC8+
        CiAgYGBgCgogICMjIEV4dGVuc2lvbgoKICBJbnRlcm5hbGx5LCBge3tpbnB1
        dCB0eXBlPSJjaGVja2JveCJ9fWAgY3JlYXRlcyBhbiBpbnN0YW5jZSBvZiBg
        RW1iZXIuQ2hlY2tib3hgLCBwYXNzaW5nCiAgYXJndW1lbnRzIGZyb20gdGhl
        IGhlbHBlciB0byBgRW1iZXIuQ2hlY2tib3hgJ3MgYGNyZWF0ZWAgbWV0aG9k
        LiBZb3UgY2FuIGV4dGVuZCB0aGUKICBjYXBhYmxpbHRpZXMgb2YgY2hlY2ti
        b3ggaW5wdXRzIGluIHlvdXIgYXBwbGljYXRpb25zIGJ5IHJlb3BlbmluZyB0
        aGlzIGNsYXNzLiBGb3IgZXhhbXBsZSwKICBpZiB5b3Ugd2FudGVkIHRvIGFk
        ZCBhIGNzcyBjbGFzcyB0byBhbGwgY2hlY2tib3hlcyBpbiB5b3VyIGFwcGxp
        Y2F0aW9uOgoKICBgYGBqYXZhc2NyaXB0CiAgRW1iZXIuQ2hlY2tib3gucmVv
        cGVuKHsKICAgIGNsYXNzTmFtZXM6IFsnbXktYXBwLWNoZWNrYm94J10KICB9
        KTsKICBgYGAKCgogIEBtZXRob2QgaW5wdXQKICBAZm9yIEVtYmVyLkhhbmRs
        ZWJhcnMuaGVscGVycwogIEBwYXJhbSB7SGFzaH0gb3B0aW9ucwoqLwpFbWJl
        ci5IYW5kbGViYXJzLnJlZ2lzdGVySGVscGVyKCdpbnB1dCcsIGZ1bmN0aW9u
        KG9wdGlvbnMpIHsKICBFbWJlci5hc3NlcnQoJ1lvdSBjYW4gb25seSBwYXNz
        IGF0dHJpYnV0ZXMgdG8gdGhlIGBpbnB1dGAgaGVscGVyLCBub3QgYXJndW1l
        bnRzJywgYXJndW1lbnRzLmxlbmd0aCA8IDIpOwoKICB2YXIgaGFzaCA9IG9w
        dGlvbnMuaGFzaCwKICAgICAgdHlwZXMgPSBvcHRpb25zLmhhc2hUeXBlcywK
        ICAgICAgaW5wdXRUeXBlID0gaGFzaC50eXBlLAogICAgICBvbkV2ZW50ID0g
        aGFzaC5vbjsKCiAgZGVsZXRlIGhhc2gudHlwZTsKICBkZWxldGUgaGFzaC5v
        bjsKCiAgaWYgKGlucHV0VHlwZSA9PT0gJ2NoZWNrYm94JykgewogICAgcmV0
        dXJuIEVtYmVyLkhhbmRsZWJhcnMuaGVscGVycy52aWV3LmNhbGwodGhpcywg
        RW1iZXIuQ2hlY2tib3gsIG9wdGlvbnMpOwogIH0gZWxzZSB7CiAgICBpZiAo
        aW5wdXRUeXBlKSB7IGhhc2gudHlwZSA9IGlucHV0VHlwZTsgfQogICAgaGFz
        aC5vbkV2ZW50ID0gb25FdmVudCB8fCAnZW50ZXInOwogICAgcmV0dXJuIEVt
        YmVyLkhhbmRsZWJhcnMuaGVscGVycy52aWV3LmNhbGwodGhpcywgRW1iZXIu
        VGV4dEZpZWxkLCBvcHRpb25zKTsKICB9Cn0pOwoKLyoqCiAgYHt7dGV4dGFy
        ZWF9fWAgaW5zZXJ0cyBhIG5ldyBpbnN0YW5jZSBvZiBgPHRleHRhcmVhPmAg
        dGFnIGludG8gdGhlIHRlbXBsYXRlLgogIFRoZSBhdHRyaWJ1dGVzIG9mIGB7
        e3RleHRhcmVhfX1gIG1hdGNoIHRob3NlIG9mIHRoZSBuYXRpdmUgSFRNTCB0
        YWdzIGFzCiAgY2xvc2VseSBhcyBwb3NzaWJsZS4KCiAgVGhlIGZvbGxvd2lu
        ZyBIVE1MIGF0dHJpYnV0ZXMgY2FuIGJlIHNldDoKCiAgICAqIGB2YWx1ZWAK
        ICAgICogYG5hbWVgCiAgICAqIGByb3dzYAogICAgKiBgY29sc2AKICAgICog
        YHBsYWNlaG9sZGVyYAogICAgKiBgZGlzYWJsZWRgCiAgICAqIGBtYXhsZW5n
        dGhgCiAgICAqIGB0YWJpbmRleGAKCiAgV2hlbiBzZXQgdG8gYSBxdW90ZWQg
        c3RyaW5nLCB0aGVzZSB2YWx1ZSB3aWxsIGJlIGRpcmVjdGx5IGFwcGxpZWQg
        dG8gdGhlIEhUTUwKICBlbGVtZW50LiBXaGVuIGxlZnQgdW5xdW90ZWQsIHRo
        ZXNlIHZhbHVlcyB3aWxsIGJlIGJvdW5kIHRvIGEgcHJvcGVydHkgb24gdGhl
        CiAgdGVtcGxhdGUncyBjdXJyZW50IHJlbmRlcmluZyBjb250ZXh0IChtb3N0
        IHR5cGljYWxseSBhIGNvbnRyb2xsZXIgaW5zdGFuY2UpLgoKICBVbmJvdW5k
        OgoKICBgYGBoYW5kbGViYXJzCiAge3t0ZXh0YXJlYSB2YWx1ZT0iTG90cyBv
        ZiBzdGF0aWMgdGV4dCB0aGF0IElTTidUIGJvdW5kIn19CiAgYGBgCgogIFdv
        dWxkIHJlc3VsdCBpbiB0aGUgZm9sbG93aW5nIEhUTUw6CgogIGBgYGh0bWwK
        ICA8dGV4dGFyZWEgY2xhc3M9ImVtYmVyLXRleHQtYXJlYSI+CiAgICBMb3Rz
        IG9mIHN0YXRpYyB0ZXh0IHRoYXQgSVNOJ1QgYm91bmQKICA8L3RleHRhcmVh
        PgogIGBgYAoKICBCb3VuZDoKCiAgSW4gdGhlIGZvbGxvd2luZyBleGFtcGxl
        LCB0aGUgYHdyaXR0ZW5Xb3Jkc2AgcHJvcGVydHkgb24gYEFwcC5BcHBsaWNh
        dGlvbkNvbnRyb2xsZXJgCiAgd2lsbCBiZSB1cGRhdGVkIGxpdmUgYXMgdGhl
        IHVzZXIgdHlwZXMgJ0xvdHMgb2YgdGV4dCB0aGF0IElTIGJvdW5kJyBpbnRv
        CiAgdGhlIHRleHQgYXJlYSBvZiB0aGVpciBicm93c2VyJ3Mgd2luZG93LgoK
        ICBgYGBqYXZhc2NyaXB0CiAgQXBwLkFwcGxpY2F0aW9uQ29udHJvbGxlciA9
        IEVtYmVyLkNvbnRyb2xsZXIuZXh0ZW5kKHsKICAgIHdyaXR0ZW5Xb3Jkczog
        IkxvdHMgb2YgdGV4dCB0aGF0IElTIGJvdW5kIgogIH0pOwogIGBgYAoKICBg
        YGBoYW5kbGViYXJzCiAge3t0ZXh0YXJlYSB2YWx1ZT13cml0dGVuV29yZHN9
        fQogIGBgYAoKICAgV291bGQgcmVzdWx0IGluIHRoZSBmb2xsb3dpbmcgSFRN
        TDoKCiAgYGBgaHRtbAogIDx0ZXh0YXJlYSBjbGFzcz0iZW1iZXItdGV4dC1h
        cmVhIj4KICAgIExvdHMgb2YgdGV4dCB0aGF0IElTIGJvdW5kCiAgPC90ZXh0
        YXJlYT4KICBgYGAKCiAgSWYgeW91IHdhbnRlZCBhIG9uZSB3YXkgYmluZGlu
        ZyBiZXR3ZWVuIHRoZSB0ZXh0IGFyZWEgYW5kIGEgZGl2IHRhZwogIHNvbWV3
        aGVyZSBlbHNlIG9uIHlvdXIgc2NyZWVuLCB5b3UgY291bGQgdXNlIGBFbWJl
        ci5jb21wdXRlZC5vbmVXYXlgOgoKICBgYGBqYXZhc2NyaXB0CiAgQXBwLkFw
        cGxpY2F0aW9uQ29udHJvbGxlciA9IEVtYmVyLkNvbnRyb2xsZXIuZXh0ZW5k
        KHsKICAgIHdyaXR0ZW5Xb3JkczogIkxvdHMgb2YgdGV4dCB0aGF0IElTIGJv
        dW5kIiwKICAgIG91dHB1dFdyaXR0ZW5Xb3JkczogRW1iZXIuY29tcHV0ZWQu
        b25lV2F5KCJ3cml0dGVuV29yZHMiKQogIH0pOwogIGBgYAoKICBgYGBoYW5k
        bGViYXJzCiAge3t0ZXh0YXJlYSB2YWx1ZT13cml0dGVuV29yZHN9fQoKICA8
        ZGl2PgogICAge3tvdXRwdXRXcml0dGVuV29yZHN9fQogIDwvZGl2PgogIGBg
        YAoKICBXb3VsZCByZXN1bHQgaW4gdGhlIGZvbGxvd2luZyBIVE1MOgoKICBg
        YGBodG1sCiAgPHRleHRhcmVhIGNsYXNzPSJlbWJlci10ZXh0LWFyZWEiPgog
        ICAgTG90cyBvZiB0ZXh0IHRoYXQgSVMgYm91bmQKICA8L3RleHRhcmVhPgoK
        ICA8LS0gdGhlIGZvbGxvd2luZyBkaXYgd2lsbCBiZSB1cGRhdGVkIGluIHJl
        YWwgdGltZSBhcyB5b3UgdHlwZSAtLT4KCiAgPGRpdj4KICAgIExvdHMgb2Yg
        dGV4dCB0aGF0IElTIGJvdW5kCiAgPC9kaXY+CiAgYGBgCgogIEZpbmFsbHks
        IHRoaXMgZXhhbXBsZSByZWFsbHkgc2hvd3MgdGhlIHBvd2VyIGFuZCBlYXNl
        IG9mIEVtYmVyIHdoZW4gdHdvCiAgcHJvcGVydGllcyBhcmUgYm91bmQgdG8g
        ZWFjaG90aGVyIHZpYSBgRW1iZXIuY29tcHV0ZWQuYWxpYXNgLiBUeXBlIGlu
        dG8KICBlaXRoZXIgdGV4dCBhcmVhIGJveCBhbmQgdGhleSdsbCBib3RoIHN0
        YXkgaW4gc3luYy4gTm90ZSB0aGF0CiAgYEVtYmVyLmNvbXB1dGVkLmFsaWFz
        YCBjb3N0cyBtb3JlIGluIHRlcm1zIG9mIHBlcmZvcm1hbmNlLCBzbyBvbmx5
        IHVzZSBpdCB3aGVuCiAgeW91ciByZWFsbHkgYmluZGluZyBpbiBib3RoIGRp
        cmVjdGlvbnM6CgogIGBgYGphdmFzY3JpcHQKICBBcHAuQXBwbGljYXRpb25D
        b250cm9sbGVyID0gRW1iZXIuQ29udHJvbGxlci5leHRlbmQoewogICAgd3Jp
        dHRlbldvcmRzOiAiTG90cyBvZiB0ZXh0IHRoYXQgSVMgYm91bmQiLAogICAg
        dHdvV2F5V3JpdHRlbldvcmRzOiBFbWJlci5jb21wdXRlZC5hbGlhcygid3Jp
        dHRlbldvcmRzIikKICB9KTsKICBgYGAKCiAgYGBgaGFuZGxlYmFycwogIHt7
        dGV4dGFyZWEgdmFsdWU9d3JpdHRlbldvcmRzfX0KICB7e3RleHRhcmVhIHZh
        bHVlPXR3b1dheVdyaXR0ZW5Xb3Jkc319CiAgYGBgCgogIGBgYGh0bWwKICA8
        dGV4dGFyZWEgaWQ9ImVtYmVyMSIgY2xhc3M9ImVtYmVyLXRleHQtYXJlYSI+
        CiAgICBMb3RzIG9mIHRleHQgdGhhdCBJUyBib3VuZAogIDwvdGV4dGFyZWE+
        CgogIDwtLSBib3RoIHVwZGF0ZWQgaW4gcmVhbCB0aW1lIC0tPgoKICA8dGV4
        dGFyZWEgaWQ9ImVtYmVyMiIgY2xhc3M9ImVtYmVyLXRleHQtYXJlYSI+CiAg
        ICBMb3RzIG9mIHRleHQgdGhhdCBJUyBib3VuZAogIDwvdGV4dGFyZWE+CiAg
        YGBgCgogICMjIEV4dGVuc2lvbgoKICBJbnRlcm5hbGx5LCBge3t0ZXh0YXJl
        YX19YCBjcmVhdGVzIGFuIGluc3RhbmNlIG9mIGBFbWJlci5UZXh0QXJlYWAs
        IHBhc3NpbmcKICBhcmd1bWVudHMgZnJvbSB0aGUgaGVscGVyIHRvIGBFbWJl
        ci5UZXh0QXJlYWAncyBgY3JlYXRlYCBtZXRob2QuIFlvdSBjYW4KICBleHRl
        bmQgdGhlIGNhcGFiaWxpdGllcyBvZiB0ZXh0IGFyZWFzIGluIHlvdXIgYXBw
        bGljYXRpb24gYnkgcmVvcGVuaW5nIHRoaXMKICBjbGFzcy4gRm9yIGV4YW1w
        bGUsIGlmIHlvdSBhcmUgZGVwbG95aW5nIHRvIGJyb3dzZXJzIHdoZXJlIHRo
        ZSBgcmVxdWlyZWRgCiAgYXR0cmlidXRlIGlzIHVzZWQsIHlvdSBjYW4gZ2xv
        YmFsbHkgYWRkIHN1cHBvcnQgZm9yIHRoZSBgcmVxdWlyZWRgIGF0dHJpYnV0
        ZQogIG9uIGFsbCB7e3RleHRhcmVhfX0ncycgaW4geW91ciBhcHAgYnkgcmVv
        cGVuaW5nIGBFbWJlci5UZXh0QXJlYWAgb3IKICBgRW1iZXIuVGV4dFN1cHBv
        cnRgIGFuZCBhZGRpbmcgaXQgdG8gdGhlIGBhdHRyaWJ1dGVCaW5kaW5nc2Ag
        Y29uY2F0ZW5hdGVkCiAgcHJvcGVydHk6CgogIGBgYGphdmFzY3JpcHQKICBF
        bWJlci5UZXh0QXJlYS5yZW9wZW4oewogICAgYXR0cmlidXRlQmluZGluZ3M6
        IFsncmVxdWlyZWQnXQogIH0pOwogIGBgYAoKICBLZWVwIGluIG1pbmQgd2hl
        biB3cml0aW5nIGBFbWJlci5UZXh0QXJlYWAgc3ViY2xhc3NlcyB0aGF0IGBF
        bWJlci5UZXh0QXJlYWAKICBpdHNlbGYgZXh0ZW5kcyBgRW1iZXIuQ29tcG9u
        ZW50YCwgbWVhbmluZyB0aGF0IGl0IGRvZXMgTk9UIGluaGVyaXQKICB0aGUg
        YGNvbnRyb2xsZXJgIG9mIHRoZSBwYXJlbnQgdmlldy4KCiAgU2VlIG1vcmUg
        YWJvdXQgW0VtYmVyIGNvbXBvbmVudHNdKGFwaS9jbGFzc2VzL0VtYmVyLkNv
        bXBvbmVudC5odG1sKQoKICBAbWV0aG9kIHRleHRhcmVhCiAgQGZvciBFbWJl
        ci5IYW5kbGViYXJzLmhlbHBlcnMKICBAcGFyYW0ge0hhc2h9IG9wdGlvbnMK
        Ki8KRW1iZXIuSGFuZGxlYmFycy5yZWdpc3RlckhlbHBlcigndGV4dGFyZWEn
        LCBmdW5jdGlvbihvcHRpb25zKSB7CiAgRW1iZXIuYXNzZXJ0KCdZb3UgY2Fu
        IG9ubHkgcGFzcyBhdHRyaWJ1dGVzIHRvIHRoZSBgdGV4dGFyZWFgIGhlbHBl
        ciwgbm90IGFyZ3VtZW50cycsIGFyZ3VtZW50cy5sZW5ndGggPCAyKTsKCiAg
        dmFyIGhhc2ggPSBvcHRpb25zLmhhc2gsCiAgICAgIHR5cGVzID0gb3B0aW9u
        cy5oYXNoVHlwZXM7CgogIHJldHVybiBFbWJlci5IYW5kbGViYXJzLmhlbHBl
        cnMudmlldy5jYWxsKHRoaXMsIEVtYmVyLlRleHRBcmVhLCBvcHRpb25zKTsK
        fSk7Cgp9KSgpOwoKCgooZnVuY3Rpb24oKSB7Ci8qZ2xvYmFscyBIYW5kbGVi
        YXJzICovCi8qKgpAbW9kdWxlIGVtYmVyCkBzdWJtb2R1bGUgZW1iZXItaGFu
        ZGxlYmFycwoqLwoKLyoqCiAgQHByaXZhdGUKCiAgRmluZCB0ZW1wbGF0ZXMg
        c3RvcmVkIGluIHRoZSBoZWFkIHRhZyBhcyBzY3JpcHQgdGFncyBhbmQgbWFr
        ZSB0aGVtIGF2YWlsYWJsZQogIHRvIGBFbWJlci5Db3JlVmlld2AgaW4gdGhl
        IGdsb2JhbCBgRW1iZXIuVEVNUExBVEVTYCBvYmplY3QuIFRoaXMgd2lsbCBi
        ZSBydW4KICBhcyBhcyBqUXVlcnkgRE9NLXJlYWR5IGNhbGxiYWNrLgoKICBT
        Y3JpcHQgdGFncyB3aXRoIGB0ZXh0L3gtaGFuZGxlYmFyc2Agd2lsbCBiZSBj
        b21waWxlZAogIHdpdGggRW1iZXIncyBIYW5kbGViYXJzIGFuZCBhcmUgc3Vp
        dGFibGUgZm9yIHVzZSBhcyBhIHZpZXcncyB0ZW1wbGF0ZS4KICBUaG9zZSB3
        aXRoIHR5cGUgYHRleHQveC1yYXctaGFuZGxlYmFyc2Agd2lsbCBiZSBjb21w
        aWxlZCB3aXRoIHJlZ3VsYXIKICBIYW5kbGViYXJzIGFuZCBhcmUgc3VpdGFi
        bGUgZm9yIHVzZSBpbiB2aWV3cycgY29tcHV0ZWQgcHJvcGVydGllcy4KCiAg
        QG1ldGhvZCBib290c3RyYXAKICBAZm9yIEVtYmVyLkhhbmRsZWJhcnMKICBA
        c3RhdGljCiAgQHBhcmFtIGN0eAoqLwpFbWJlci5IYW5kbGViYXJzLmJvb3Rz
        dHJhcCA9IGZ1bmN0aW9uKGN0eCkgewogIHZhciBzZWxlY3RvcnMgPSAnc2Ny
        aXB0W3R5cGU9InRleHQveC1oYW5kbGViYXJzIl0sIHNjcmlwdFt0eXBlPSJ0
        ZXh0L3gtcmF3LWhhbmRsZWJhcnMiXSc7CgogIEVtYmVyLiQoc2VsZWN0b3Jz
        LCBjdHgpCiAgICAuZWFjaChmdW5jdGlvbigpIHsKICAgIC8vIEdldCBhIHJl
        ZmVyZW5jZSB0byB0aGUgc2NyaXB0IHRhZwogICAgdmFyIHNjcmlwdCA9IEVt
        YmVyLiQodGhpcyk7CgogICAgdmFyIGNvbXBpbGUgPSAoc2NyaXB0LmF0dHIo
        J3R5cGUnKSA9PT0gJ3RleHQveC1yYXctaGFuZGxlYmFycycpID8KICAgICAg
        ICAgICAgICAgICAgRW1iZXIuJC5wcm94eShIYW5kbGViYXJzLmNvbXBpbGUs
        IEhhbmRsZWJhcnMpIDoKICAgICAgICAgICAgICAgICAgRW1iZXIuJC5wcm94
        eShFbWJlci5IYW5kbGViYXJzLmNvbXBpbGUsIEVtYmVyLkhhbmRsZWJhcnMp
        LAogICAgICAvLyBHZXQgdGhlIG5hbWUgb2YgdGhlIHNjcmlwdCwgdXNlZCBi
        eSBFbWJlci5WaWV3J3MgdGVtcGxhdGVOYW1lIHByb3BlcnR5LgogICAgICAv
        LyBGaXJzdCBsb29rIGZvciBkYXRhLXRlbXBsYXRlLW5hbWUgYXR0cmlidXRl
        LCB0aGVuIGZhbGwgYmFjayB0byBpdHMKICAgICAgLy8gaWQgaWYgbm8gbmFt
        ZSBpcyBmb3VuZC4KICAgICAgdGVtcGxhdGVOYW1lID0gc2NyaXB0LmF0dHIo
        J2RhdGEtdGVtcGxhdGUtbmFtZScpIHx8IHNjcmlwdC5hdHRyKCdpZCcpIHx8
        ICdhcHBsaWNhdGlvbicsCiAgICAgIHRlbXBsYXRlID0gY29tcGlsZShzY3Jp
        cHQuaHRtbCgpKTsKCiAgICAvLyBDaGVjayBpZiB0ZW1wbGF0ZSBvZiBzYW1l
        IG5hbWUgYWxyZWFkeSBleGlzdHMKICAgIGlmIChFbWJlci5URU1QTEFURVNb
        dGVtcGxhdGVOYW1lXSAhPT0gdW5kZWZpbmVkKSB7CiAgICAgIHRocm93IG5l
        dyBFbWJlci5FcnJvcignVGVtcGxhdGUgbmFtZWQgIicgKyB0ZW1wbGF0ZU5h
        bWUgICsgJyIgYWxyZWFkeSBleGlzdHMuJyk7CiAgICB9CgogICAgLy8gRm9y
        IHRlbXBsYXRlcyB3aGljaCBoYXZlIGEgbmFtZSwgd2Ugc2F2ZSB0aGVtIGFu
        ZCB0aGVuIHJlbW92ZSB0aGVtIGZyb20gdGhlIERPTQogICAgRW1iZXIuVEVN
        UExBVEVTW3RlbXBsYXRlTmFtZV0gPSB0ZW1wbGF0ZTsKCiAgICAvLyBSZW1v
        dmUgc2NyaXB0IHRhZyBmcm9tIERPTQogICAgc2NyaXB0LnJlbW92ZSgpOwog
        IH0pOwp9OwoKZnVuY3Rpb24gYm9vdHN0cmFwKCkgewogIEVtYmVyLkhhbmRs
        ZWJhcnMuYm9vdHN0cmFwKCBFbWJlci4kKGRvY3VtZW50KSApOwp9CgpmdW5j
        dGlvbiByZWdpc3RlckNvbXBvbmVudHMoY29udGFpbmVyKSB7CiAgdmFyIHRl
        bXBsYXRlcyA9IEVtYmVyLlRFTVBMQVRFUywgbWF0Y2g7CiAgaWYgKCF0ZW1w
        bGF0ZXMpIHsgcmV0dXJuOyB9CgogIGZvciAodmFyIHByb3AgaW4gdGVtcGxh
        dGVzKSB7CiAgICBpZiAobWF0Y2ggPSBwcm9wLm1hdGNoKC9eY29tcG9uZW50
        c1wvKC4qKSQvKSkgewogICAgICByZWdpc3RlckNvbXBvbmVudChjb250YWlu
        ZXIsIG1hdGNoWzFdKTsKICAgIH0KICB9Cn0KCgpmdW5jdGlvbiByZWdpc3Rl
        ckNvbXBvbmVudChjb250YWluZXIsIG5hbWUpIHsKICBFbWJlci5hc3NlcnQo
        IllvdSBwcm92aWRlZCBhIHRlbXBsYXRlIG5hbWVkICdjb21wb25lbnRzLyIg
        KyBuYW1lICsgIicsIGJ1dCBjdXN0b20gY29tcG9uZW50cyBtdXN0IGluY2x1
        ZGUgYSAnLSciLCBuYW1lLm1hdGNoKC8tLykpOwoKICB2YXIgZnVsbE5hbWUg
        PSAnY29tcG9uZW50OicgKyBuYW1lOwoKICBjb250YWluZXIuaW5qZWN0aW9u
        KGZ1bGxOYW1lLCAnbGF5b3V0JywgJ3RlbXBsYXRlOmNvbXBvbmVudHMvJyAr
        IG5hbWUpOwoKICB2YXIgQ29tcG9uZW50ID0gY29udGFpbmVyLmxvb2t1cEZh
        Y3RvcnkoZnVsbE5hbWUpOwoKICBpZiAoIUNvbXBvbmVudCkgewogICAgY29u
        dGFpbmVyLnJlZ2lzdGVyKGZ1bGxOYW1lLCBFbWJlci5Db21wb25lbnQpOwog
        ICAgQ29tcG9uZW50ID0gY29udGFpbmVyLmxvb2t1cEZhY3RvcnkoZnVsbE5h
        bWUpOwogIH0KCiAgRW1iZXIuSGFuZGxlYmFycy5oZWxwZXIobmFtZSwgQ29t
        cG9uZW50KTsKfQoKLyoKICBXZSB0aWUgdGhpcyB0byBhcHBsaWNhdGlvbi5s
        b2FkIHRvIGVuc3VyZSB0aGF0IHdlJ3ZlIGF0IGxlYXN0CiAgYXR0ZW1wdGVk
        IHRvIGJvb3RzdHJhcCBhdCB0aGUgcG9pbnQgdGhhdCB0aGUgYXBwbGljYXRp
        b24gaXMgbG9hZGVkLgoKICBXZSBhbHNvIHRpZSB0aGlzIHRvIGRvY3VtZW50
        IHJlYWR5IHNpbmNlIHdlJ3JlIGd1YXJhbnRlZWQgdGhhdCBhbGwKICB0aGUg
        aW5saW5lIHRlbXBsYXRlcyBhcmUgcHJlc2VudCBhdCB0aGlzIHBvaW50LgoK
        ICBUaGVyZSdzIG5vIGhhcm0gdG8gcnVubmluZyB0aGlzIHR3aWNlLCBzaW5j
        ZSB3ZSByZW1vdmUgdGhlIHRlbXBsYXRlcwogIGZyb20gdGhlIERPTSBhZnRl
        ciBwcm9jZXNzaW5nLgoqLwoKRW1iZXIub25Mb2FkKCdFbWJlci5BcHBsaWNh
        dGlvbicsIGZ1bmN0aW9uKEFwcGxpY2F0aW9uKSB7CiAgQXBwbGljYXRpb24u
        aW5pdGlhbGl6ZXIoewogICAgbmFtZTogJ2RvbVRlbXBsYXRlcycsCiAgICBp
        bml0aWFsaXplOiBib290c3RyYXAKICB9KTsKCiAgQXBwbGljYXRpb24uaW5p
        dGlhbGl6ZXIoewogICAgbmFtZTogJ3JlZ2lzdGVyQ29tcG9uZW50cycsCiAg
        ICBhZnRlcjogJ2RvbVRlbXBsYXRlcycsCiAgICBpbml0aWFsaXplOiByZWdp
        c3RlckNvbXBvbmVudHMKICB9KTsKfSk7Cgp9KSgpOwoKCgooZnVuY3Rpb24o
        KSB7Ci8qKgpFbWJlciBIYW5kbGViYXJzCgpAbW9kdWxlIGVtYmVyCkBzdWJt
        b2R1bGUgZW1iZXItaGFuZGxlYmFycwpAcmVxdWlyZXMgZW1iZXItdmlld3MK
        Ki8KCkVtYmVyLnJ1bkxvYWRIb29rcygnRW1iZXIuSGFuZGxlYmFycycsIEVt
        YmVyLkhhbmRsZWJhcnMpOwoKfSkoKTsKCihmdW5jdGlvbigpIHsKZGVmaW5l
        KCJyb3V0ZS1yZWNvZ25pemVyIiwKICBbXSwKICBmdW5jdGlvbigpIHsKICAg
        ICJ1c2Ugc3RyaWN0IjsKICAgIHZhciBzcGVjaWFscyA9IFsKICAgICAgJy8n
        LCAnLicsICcqJywgJysnLCAnPycsICd8JywKICAgICAgJygnLCAnKScsICdb
        JywgJ10nLCAneycsICd9JywgJ1xcJwogICAgXTsKCiAgICB2YXIgZXNjYXBl
        UmVnZXggPSBuZXcgUmVnRXhwKCcoXFwnICsgc3BlY2lhbHMuam9pbignfFxc
        JykgKyAnKScsICdnJyk7CgogICAgLy8gQSBTZWdtZW50IHJlcHJlc2VudHMg
        YSBzZWdtZW50IGluIHRoZSBvcmlnaW5hbCByb3V0ZSBkZXNjcmlwdGlvbi4K
        ICAgIC8vIEVhY2ggU2VnbWVudCB0eXBlIHByb3ZpZGVzIGFuIGBlYWNoQ2hh
        cmAgYW5kIGByZWdleGAgbWV0aG9kLgogICAgLy8KICAgIC8vIFRoZSBgZWFj
        aENoYXJgIG1ldGhvZCBpbnZva2VzIHRoZSBjYWxsYmFjayB3aXRoIG9uZSBv
        ciBtb3JlIGNoYXJhY3RlcgogICAgLy8gc3BlY2lmaWNhdGlvbnMuIEEgY2hh
        cmFjdGVyIHNwZWNpZmljYXRpb24gY29uc3VtZXMgb25lIG9yIG1vcmUgaW5w
        dXQKICAgIC8vIGNoYXJhY3RlcnMuCiAgICAvLwogICAgLy8gVGhlIGByZWdl
        eGAgbWV0aG9kIHJldHVybnMgYSByZWdleCBmcmFnbWVudCBmb3IgdGhlIHNl
        Z21lbnQuIElmIHRoZQogICAgLy8gc2VnbWVudCBpcyBhIGR5bmFtaWMgb2Yg
        c3RhciBzZWdtZW50LCB0aGUgcmVnZXggZnJhZ21lbnQgYWxzbyBpbmNsdWRl
        cwogICAgLy8gYSBjYXB0dXJlLgogICAgLy8KICAgIC8vIEEgY2hhcmFjdGVy
        IHNwZWNpZmljYXRpb24gY29udGFpbnM6CiAgICAvLwogICAgLy8gKiBgdmFs
        aWRDaGFyc2A6IGEgU3RyaW5nIHdpdGggYSBsaXN0IG9mIGFsbCB2YWxpZCBj
        aGFyYWN0ZXJzLCBvcgogICAgLy8gKiBgaW52YWxpZENoYXJzYDogYSBTdHJp
        bmcgd2l0aCBhIGxpc3Qgb2YgYWxsIGludmFsaWQgY2hhcmFjdGVycwogICAg
        Ly8gKiBgcmVwZWF0YDogdHJ1ZSBpZiB0aGUgY2hhcmFjdGVyIHNwZWNpZmlj
        YXRpb24gY2FuIHJlcGVhdAoKICAgIGZ1bmN0aW9uIFN0YXRpY1NlZ21lbnQo
        c3RyaW5nKSB7IHRoaXMuc3RyaW5nID0gc3RyaW5nOyB9CiAgICBTdGF0aWNT
        ZWdtZW50LnByb3RvdHlwZSA9IHsKICAgICAgZWFjaENoYXI6IGZ1bmN0aW9u
        KGNhbGxiYWNrKSB7CiAgICAgICAgdmFyIHN0cmluZyA9IHRoaXMuc3RyaW5n
        LCBjaGFyOwoKICAgICAgICBmb3IgKHZhciBpPTAsIGw9c3RyaW5nLmxlbmd0
        aDsgaTxsOyBpKyspIHsKICAgICAgICAgIGNoYXIgPSBzdHJpbmcuY2hhckF0
        KGkpOwogICAgICAgICAgY2FsbGJhY2soeyB2YWxpZENoYXJzOiBjaGFyIH0p
        OwogICAgICAgIH0KICAgICAgfSwKCiAgICAgIHJlZ2V4OiBmdW5jdGlvbigp
        IHsKICAgICAgICByZXR1cm4gdGhpcy5zdHJpbmcucmVwbGFjZShlc2NhcGVS
        ZWdleCwgJ1xcJDEnKTsKICAgICAgfSwKCiAgICAgIGdlbmVyYXRlOiBmdW5j
        dGlvbigpIHsKICAgICAgICByZXR1cm4gdGhpcy5zdHJpbmc7CiAgICAgIH0K
        ICAgIH07CgogICAgZnVuY3Rpb24gRHluYW1pY1NlZ21lbnQobmFtZSkgeyB0
        aGlzLm5hbWUgPSBuYW1lOyB9CiAgICBEeW5hbWljU2VnbWVudC5wcm90b3R5
        cGUgPSB7CiAgICAgIGVhY2hDaGFyOiBmdW5jdGlvbihjYWxsYmFjaykgewog
        ICAgICAgIGNhbGxiYWNrKHsgaW52YWxpZENoYXJzOiAiLyIsIHJlcGVhdDog
        dHJ1ZSB9KTsKICAgICAgfSwKCiAgICAgIHJlZ2V4OiBmdW5jdGlvbigpIHsK
        ICAgICAgICByZXR1cm4gIihbXi9dKykiOwogICAgICB9LAoKICAgICAgZ2Vu
        ZXJhdGU6IGZ1bmN0aW9uKHBhcmFtcykgewogICAgICAgIHJldHVybiBwYXJh
        bXNbdGhpcy5uYW1lXTsKICAgICAgfQogICAgfTsKCiAgICBmdW5jdGlvbiBT
        dGFyU2VnbWVudChuYW1lKSB7IHRoaXMubmFtZSA9IG5hbWU7IH0KICAgIFN0
        YXJTZWdtZW50LnByb3RvdHlwZSA9IHsKICAgICAgZWFjaENoYXI6IGZ1bmN0
        aW9uKGNhbGxiYWNrKSB7CiAgICAgICAgY2FsbGJhY2soeyBpbnZhbGlkQ2hh
        cnM6ICIiLCByZXBlYXQ6IHRydWUgfSk7CiAgICAgIH0sCgogICAgICByZWdl
        eDogZnVuY3Rpb24oKSB7CiAgICAgICAgcmV0dXJuICIoLispIjsKICAgICAg
        fSwKCiAgICAgIGdlbmVyYXRlOiBmdW5jdGlvbihwYXJhbXMpIHsKICAgICAg
        ICByZXR1cm4gcGFyYW1zW3RoaXMubmFtZV07CiAgICAgIH0KICAgIH07Cgog
        ICAgZnVuY3Rpb24gRXBzaWxvblNlZ21lbnQoKSB7fQogICAgRXBzaWxvblNl
        Z21lbnQucHJvdG90eXBlID0gewogICAgICBlYWNoQ2hhcjogZnVuY3Rpb24o
        KSB7fSwKICAgICAgcmVnZXg6IGZ1bmN0aW9uKCkgeyByZXR1cm4gIiI7IH0s
        CiAgICAgIGdlbmVyYXRlOiBmdW5jdGlvbigpIHsgcmV0dXJuICIiOyB9CiAg
        ICB9OwoKICAgIGZ1bmN0aW9uIHBhcnNlKHJvdXRlLCBuYW1lcywgdHlwZXMp
        IHsKICAgICAgLy8gbm9ybWFsaXplIHJvdXRlIGFzIG5vdCBzdGFydGluZyB3
        aXRoIGEgIi8iLiBSZWNvZ25pdGlvbiB3aWxsCiAgICAgIC8vIGFsc28gbm9y
        bWFsaXplLgogICAgICBpZiAocm91dGUuY2hhckF0KDApID09PSAiLyIpIHsg
        cm91dGUgPSByb3V0ZS5zdWJzdHIoMSk7IH0KCiAgICAgIHZhciBzZWdtZW50
        cyA9IHJvdXRlLnNwbGl0KCIvIiksIHJlc3VsdHMgPSBbXTsKCiAgICAgIGZv
        ciAodmFyIGk9MCwgbD1zZWdtZW50cy5sZW5ndGg7IGk8bDsgaSsrKSB7CiAg
        ICAgICAgdmFyIHNlZ21lbnQgPSBzZWdtZW50c1tpXSwgbWF0Y2g7CgogICAg
        ICAgIGlmIChtYXRjaCA9IHNlZ21lbnQubWF0Y2goL146KFteXC9dKykkLykp
        IHsKICAgICAgICAgIHJlc3VsdHMucHVzaChuZXcgRHluYW1pY1NlZ21lbnQo
        bWF0Y2hbMV0pKTsKICAgICAgICAgIG5hbWVzLnB1c2gobWF0Y2hbMV0pOwog
        ICAgICAgICAgdHlwZXMuZHluYW1pY3MrKzsKICAgICAgICB9IGVsc2UgaWYg
        KG1hdGNoID0gc2VnbWVudC5tYXRjaCgvXlwqKFteXC9dKykkLykpIHsKICAg
        ICAgICAgIHJlc3VsdHMucHVzaChuZXcgU3RhclNlZ21lbnQobWF0Y2hbMV0p
        KTsKICAgICAgICAgIG5hbWVzLnB1c2gobWF0Y2hbMV0pOwogICAgICAgICAg
        dHlwZXMuc3RhcnMrKzsKICAgICAgICB9IGVsc2UgaWYgKHNlZ21lbnQgPT09
        ICIiKSB7CiAgICAgICAgICByZXN1bHRzLnB1c2gobmV3IEVwc2lsb25TZWdt
        ZW50KCkpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICByZXN1bHRzLnB1
        c2gobmV3IFN0YXRpY1NlZ21lbnQoc2VnbWVudCkpOwogICAgICAgICAgdHlw
        ZXMuc3RhdGljcysrOwogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJu
        IHJlc3VsdHM7CiAgICB9CgogICAgLy8gQSBTdGF0ZSBoYXMgYSBjaGFyYWN0
        ZXIgc3BlY2lmaWNhdGlvbiBhbmQgKGBjaGFyU3BlY2ApIGFuZCBhIGxpc3Qg
        b2YgcG9zc2libGUKICAgIC8vIHN1YnNlcXVlbnQgc3RhdGVzIChgbmV4dFN0
        YXRlc2ApLgogICAgLy8KICAgIC8vIElmIGEgU3RhdGUgaXMgYW4gYWNjZXB0
        aW5nIHN0YXRlLCBpdCB3aWxsIGFsc28gaGF2ZSBzZXZlcmFsIGFkZGl0aW9u
        YWwKICAgIC8vIHByb3BlcnRpZXM6CiAgICAvLwogICAgLy8gKiBgcmVnZXhg
        OiBBIHJlZ3VsYXIgZXhwcmVzc2lvbiB0aGF0IGlzIHVzZWQgdG8gZXh0cmFj
        dCBwYXJhbWV0ZXJzIGZyb20gcGF0aHMKICAgIC8vICAgdGhhdCByZWFjaGVk
        IHRoaXMgYWNjZXB0aW5nIHN0YXRlLgogICAgLy8gKiBgaGFuZGxlcnNgOiBJ
        bmZvcm1hdGlvbiBvbiBob3cgdG8gY29udmVydCB0aGUgbGlzdCBvZiBjYXB0
        dXJlcyBpbnRvIGNhbGxzCiAgICAvLyAgIHRvIHJlZ2lzdGVyZWQgaGFuZGxl
        cnMgd2l0aCB0aGUgc3BlY2lmaWVkIHBhcmFtZXRlcnMKICAgIC8vICogYHR5
        cGVzYDogSG93IG1hbnkgc3RhdGljLCBkeW5hbWljIG9yIHN0YXIgc2VnbWVu
        dHMgaW4gdGhpcyByb3V0ZS4gVXNlZCB0bwogICAgLy8gICBkZWNpZGUgd2hp
        Y2ggcm91dGUgdG8gdXNlIGlmIG11bHRpcGxlIHJlZ2lzdGVyZWQgcm91dGVz
        IG1hdGNoIGEgcGF0aC4KICAgIC8vCiAgICAvLyBDdXJyZW50bHksIFN0YXRl
        IGlzIGltcGxlbWVudGVkIG5haXZlbHkgYnkgbG9vcGluZyBvdmVyIGBuZXh0
        U3RhdGVzYCBhbmQKICAgIC8vIGNvbXBhcmluZyBhIGNoYXJhY3RlciBzcGVj
        aWZpY2F0aW9uIGFnYWluc3QgYSBjaGFyYWN0ZXIuIEEgbW9yZSBlZmZpY2ll
        bnQKICAgIC8vIGltcGxlbWVudGF0aW9uIHdvdWxkIHVzZSBhIGhhc2ggb2Yg
        a2V5cyBwb2ludGluZyBhdCBvbmUgb3IgbW9yZSBuZXh0IHN0YXRlcy4KCiAg
        ICBmdW5jdGlvbiBTdGF0ZShjaGFyU3BlYykgewogICAgICB0aGlzLmNoYXJT
        cGVjID0gY2hhclNwZWM7CiAgICAgIHRoaXMubmV4dFN0YXRlcyA9IFtdOwog
        ICAgfQoKICAgIFN0YXRlLnByb3RvdHlwZSA9IHsKICAgICAgZ2V0OiBmdW5j
        dGlvbihjaGFyU3BlYykgewogICAgICAgIHZhciBuZXh0U3RhdGVzID0gdGhp
        cy5uZXh0U3RhdGVzOwoKICAgICAgICBmb3IgKHZhciBpPTAsIGw9bmV4dFN0
        YXRlcy5sZW5ndGg7IGk8bDsgaSsrKSB7CiAgICAgICAgICB2YXIgY2hpbGQg
        PSBuZXh0U3RhdGVzW2ldOwoKICAgICAgICAgIHZhciBpc0VxdWFsID0gY2hp
        bGQuY2hhclNwZWMudmFsaWRDaGFycyA9PT0gY2hhclNwZWMudmFsaWRDaGFy
        czsKICAgICAgICAgIGlzRXF1YWwgPSBpc0VxdWFsICYmIGNoaWxkLmNoYXJT
        cGVjLmludmFsaWRDaGFycyA9PT0gY2hhclNwZWMuaW52YWxpZENoYXJzOwoK
        ICAgICAgICAgIGlmIChpc0VxdWFsKSB7IHJldHVybiBjaGlsZDsgfQogICAg
        ICAgIH0KICAgICAgfSwKCiAgICAgIHB1dDogZnVuY3Rpb24oY2hhclNwZWMp
        IHsKICAgICAgICB2YXIgc3RhdGU7CgogICAgICAgIC8vIElmIHRoZSBjaGFy
        YWN0ZXIgc3BlY2lmaWNhdGlvbiBhbHJlYWR5IGV4aXN0cyBpbiBhIGNoaWxk
        IG9mIHRoZSBjdXJyZW50CiAgICAgICAgLy8gc3RhdGUsIGp1c3QgcmV0dXJu
        IHRoYXQgc3RhdGUuCiAgICAgICAgaWYgKHN0YXRlID0gdGhpcy5nZXQoY2hh
        clNwZWMpKSB7IHJldHVybiBzdGF0ZTsgfQoKICAgICAgICAvLyBNYWtlIGEg
        bmV3IHN0YXRlIGZvciB0aGUgY2hhcmFjdGVyIHNwZWMKICAgICAgICBzdGF0
        ZSA9IG5ldyBTdGF0ZShjaGFyU3BlYyk7CgogICAgICAgIC8vIEluc2VydCB0
        aGUgbmV3IHN0YXRlIGFzIGEgY2hpbGQgb2YgdGhlIGN1cnJlbnQgc3RhdGUK
        ICAgICAgICB0aGlzLm5leHRTdGF0ZXMucHVzaChzdGF0ZSk7CgogICAgICAg
        IC8vIElmIHRoaXMgY2hhcmFjdGVyIHNwZWNpZmljYXRpb24gcmVwZWF0cywg
        aW5zZXJ0IHRoZSBuZXcgc3RhdGUgYXMgYSBjaGlsZAogICAgICAgIC8vIG9m
        IGl0c2VsZi4gTm90ZSB0aGF0IHRoaXMgd2lsbCBub3QgdHJpZ2dlciBhbiBp
        bmZpbml0ZSBsb29wIGJlY2F1c2UgZWFjaAogICAgICAgIC8vIHRyYW5zaXRp
        b24gZHVyaW5nIHJlY29nbml0aW9uIGNvbnN1bWVzIGEgY2hhcmFjdGVyLgog
        ICAgICAgIGlmIChjaGFyU3BlYy5yZXBlYXQpIHsKICAgICAgICAgIHN0YXRl
        Lm5leHRTdGF0ZXMucHVzaChzdGF0ZSk7CiAgICAgICAgfQoKICAgICAgICAv
        LyBSZXR1cm4gdGhlIG5ldyBzdGF0ZQogICAgICAgIHJldHVybiBzdGF0ZTsK
        ICAgICAgfSwKCiAgICAgIC8vIEZpbmQgYSBsaXN0IG9mIGNoaWxkIHN0YXRl
        cyBtYXRjaGluZyB0aGUgbmV4dCBjaGFyYWN0ZXIKICAgICAgbWF0Y2g6IGZ1
        bmN0aW9uKGNoYXIpIHsKICAgICAgICAvLyBERUJVRyAiUHJvY2Vzc2luZyBg
        IiArIGNoYXIgKyAiYDoiCiAgICAgICAgdmFyIG5leHRTdGF0ZXMgPSB0aGlz
        Lm5leHRTdGF0ZXMsCiAgICAgICAgICAgIGNoaWxkLCBjaGFyU3BlYywgY2hh
        cnM7CgogICAgICAgIC8vIERFQlVHICIgICIgKyBkZWJ1Z1N0YXRlKHRoaXMp
        CiAgICAgICAgdmFyIHJldHVybmVkID0gW107CgogICAgICAgIGZvciAodmFy
        IGk9MCwgbD1uZXh0U3RhdGVzLmxlbmd0aDsgaTxsOyBpKyspIHsKICAgICAg
        ICAgIGNoaWxkID0gbmV4dFN0YXRlc1tpXTsKCiAgICAgICAgICBjaGFyU3Bl
        YyA9IGNoaWxkLmNoYXJTcGVjOwoKICAgICAgICAgIGlmICh0eXBlb2YgKGNo
        YXJzID0gY2hhclNwZWMudmFsaWRDaGFycykgIT09ICd1bmRlZmluZWQnKSB7
        CiAgICAgICAgICAgIGlmIChjaGFycy5pbmRleE9mKGNoYXIpICE9PSAtMSkg
        eyByZXR1cm5lZC5wdXNoKGNoaWxkKTsgfQogICAgICAgICAgfSBlbHNlIGlm
        ICh0eXBlb2YgKGNoYXJzID0gY2hhclNwZWMuaW52YWxpZENoYXJzKSAhPT0g
        J3VuZGVmaW5lZCcpIHsKICAgICAgICAgICAgaWYgKGNoYXJzLmluZGV4T2Yo
        Y2hhcikgPT09IC0xKSB7IHJldHVybmVkLnB1c2goY2hpbGQpOyB9CiAgICAg
        ICAgICB9CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gcmV0dXJuZWQ7CiAg
        ICAgIH0KCiAgICAgIC8qKiBJRiBERUJVRwogICAgICAsIGRlYnVnOiBmdW5j
        dGlvbigpIHsKICAgICAgICB2YXIgY2hhclNwZWMgPSB0aGlzLmNoYXJTcGVj
        LAogICAgICAgICAgICBkZWJ1ZyA9ICJbIiwKICAgICAgICAgICAgY2hhcnMg
        PSBjaGFyU3BlYy52YWxpZENoYXJzIHx8IGNoYXJTcGVjLmludmFsaWRDaGFy
        czsKCiAgICAgICAgaWYgKGNoYXJTcGVjLmludmFsaWRDaGFycykgeyBkZWJ1
        ZyArPSAiXiI7IH0KICAgICAgICBkZWJ1ZyArPSBjaGFyczsKICAgICAgICBk
        ZWJ1ZyArPSAiXSI7CgogICAgICAgIGlmIChjaGFyU3BlYy5yZXBlYXQpIHsg
        ZGVidWcgKz0gIisiOyB9CgogICAgICAgIHJldHVybiBkZWJ1ZzsKICAgICAg
        fQogICAgICBFTkQgSUYgKiovCiAgICB9OwoKICAgIC8qKiBJRiBERUJVRwog
        ICAgZnVuY3Rpb24gZGVidWcobG9nKSB7CiAgICAgIGNvbnNvbGUubG9nKGxv
        Zyk7CiAgICB9CgogICAgZnVuY3Rpb24gZGVidWdTdGF0ZShzdGF0ZSkgewog
        ICAgICByZXR1cm4gc3RhdGUubmV4dFN0YXRlcy5tYXAoZnVuY3Rpb24obikg
        ewogICAgICAgIGlmIChuLm5leHRTdGF0ZXMubGVuZ3RoID09PSAwKSB7IHJl
        dHVybiAiKCAiICsgbi5kZWJ1ZygpICsgIiBbYWNjZXB0aW5nXSApIjsgfQog
        ICAgICAgIHJldHVybiAiKCAiICsgbi5kZWJ1ZygpICsgIiA8dGhlbj4gIiAr
        IG4ubmV4dFN0YXRlcy5tYXAoZnVuY3Rpb24ocykgeyByZXR1cm4gcy5kZWJ1
        ZygpIH0pLmpvaW4oIiBvciAiKSArICIgKSI7CiAgICAgIH0pLmpvaW4oIiwg
        IikKICAgIH0KICAgIEVORCBJRiAqKi8KCiAgICAvLyBUaGlzIGlzIGEgc29t
        ZXdoYXQgbmFpdmUgc3RyYXRlZ3ksIGJ1dCBzaG91bGQgd29yayBpbiBhIGxv
        dCBvZiBjYXNlcwogICAgLy8gQSBiZXR0ZXIgc3RyYXRlZ3kgd291bGQgcHJv
        cGVybHkgcmVzb2x2ZSAvcG9zdHMvOmlkL25ldyBhbmQgL3Bvc3RzL2VkaXQv
        OmlkCiAgICBmdW5jdGlvbiBzb3J0U29sdXRpb25zKHN0YXRlcykgewogICAg
        ICByZXR1cm4gc3RhdGVzLnNvcnQoZnVuY3Rpb24oYSwgYikgewogICAgICAg
        IGlmIChhLnR5cGVzLnN0YXJzICE9PSBiLnR5cGVzLnN0YXJzKSB7IHJldHVy
        biBhLnR5cGVzLnN0YXJzIC0gYi50eXBlcy5zdGFyczsgfQogICAgICAgIGlm
        IChhLnR5cGVzLmR5bmFtaWNzICE9PSBiLnR5cGVzLmR5bmFtaWNzKSB7IHJl
        dHVybiBhLnR5cGVzLmR5bmFtaWNzIC0gYi50eXBlcy5keW5hbWljczsgfQog
        ICAgICAgIGlmIChhLnR5cGVzLnN0YXRpY3MgIT09IGIudHlwZXMuc3RhdGlj
        cykgeyByZXR1cm4gYS50eXBlcy5zdGF0aWNzIC0gYi50eXBlcy5zdGF0aWNz
        OyB9CgogICAgICAgIHJldHVybiAwOwogICAgICB9KTsKICAgIH0KCiAgICBm
        dW5jdGlvbiByZWNvZ25pemVDaGFyKHN0YXRlcywgY2hhcikgewogICAgICB2
        YXIgbmV4dFN0YXRlcyA9IFtdOwoKICAgICAgZm9yICh2YXIgaT0wLCBsPXN0
        YXRlcy5sZW5ndGg7IGk8bDsgaSsrKSB7CiAgICAgICAgdmFyIHN0YXRlID0g
        c3RhdGVzW2ldOwoKICAgICAgICBuZXh0U3RhdGVzID0gbmV4dFN0YXRlcy5j
        b25jYXQoc3RhdGUubWF0Y2goY2hhcikpOwogICAgICB9CgogICAgICByZXR1
        cm4gbmV4dFN0YXRlczsKICAgIH0KCiAgICBmdW5jdGlvbiBmaW5kSGFuZGxl
        cihzdGF0ZSwgcGF0aCkgewogICAgICB2YXIgaGFuZGxlcnMgPSBzdGF0ZS5o
        YW5kbGVycywgcmVnZXggPSBzdGF0ZS5yZWdleDsKICAgICAgdmFyIGNhcHR1
        cmVzID0gcGF0aC5tYXRjaChyZWdleCksIGN1cnJlbnRDYXB0dXJlID0gMTsK
        ICAgICAgdmFyIHJlc3VsdCA9IFtdOwoKICAgICAgZm9yICh2YXIgaT0wLCBs
        PWhhbmRsZXJzLmxlbmd0aDsgaTxsOyBpKyspIHsKICAgICAgICB2YXIgaGFu
        ZGxlciA9IGhhbmRsZXJzW2ldLCBuYW1lcyA9IGhhbmRsZXIubmFtZXMsIHBh
        cmFtcyA9IHt9OwoKICAgICAgICBmb3IgKHZhciBqPTAsIG09bmFtZXMubGVu
        Z3RoOyBqPG07IGorKykgewogICAgICAgICAgcGFyYW1zW25hbWVzW2pdXSA9
        IGNhcHR1cmVzW2N1cnJlbnRDYXB0dXJlKytdOwogICAgICAgIH0KCiAgICAg
        ICAgcmVzdWx0LnB1c2goeyBoYW5kbGVyOiBoYW5kbGVyLmhhbmRsZXIsIHBh
        cmFtczogcGFyYW1zLCBpc0R5bmFtaWM6ICEhbmFtZXMubGVuZ3RoIH0pOwog
        ICAgICB9CgogICAgICByZXR1cm4gcmVzdWx0OwogICAgfQoKICAgIGZ1bmN0
        aW9uIGFkZFNlZ21lbnQoY3VycmVudFN0YXRlLCBzZWdtZW50KSB7CiAgICAg
        IHNlZ21lbnQuZWFjaENoYXIoZnVuY3Rpb24oY2hhcikgewogICAgICAgIHZh
        ciBzdGF0ZTsKCiAgICAgICAgY3VycmVudFN0YXRlID0gY3VycmVudFN0YXRl
        LnB1dChjaGFyKTsKICAgICAgfSk7CgogICAgICByZXR1cm4gY3VycmVudFN0
        YXRlOwogICAgfQoKICAgIC8vIFRoZSBtYWluIGludGVyZmFjZQoKICAgIHZh
        ciBSb3V0ZVJlY29nbml6ZXIgPSBmdW5jdGlvbigpIHsKICAgICAgdGhpcy5y
        b290U3RhdGUgPSBuZXcgU3RhdGUoKTsKICAgICAgdGhpcy5uYW1lcyA9IHt9
        OwogICAgfTsKCgogICAgUm91dGVSZWNvZ25pemVyLnByb3RvdHlwZSA9IHsK
        ICAgICAgYWRkOiBmdW5jdGlvbihyb3V0ZXMsIG9wdGlvbnMpIHsKICAgICAg
        ICB2YXIgY3VycmVudFN0YXRlID0gdGhpcy5yb290U3RhdGUsIHJlZ2V4ID0g
        Il4iLAogICAgICAgICAgICB0eXBlcyA9IHsgc3RhdGljczogMCwgZHluYW1p
        Y3M6IDAsIHN0YXJzOiAwIH0sCiAgICAgICAgICAgIGhhbmRsZXJzID0gW10s
        IGFsbFNlZ21lbnRzID0gW10sIG5hbWU7CgogICAgICAgIHZhciBpc0VtcHR5
        ID0gdHJ1ZTsKCiAgICAgICAgZm9yICh2YXIgaT0wLCBsPXJvdXRlcy5sZW5n
        dGg7IGk8bDsgaSsrKSB7CiAgICAgICAgICB2YXIgcm91dGUgPSByb3V0ZXNb
        aV0sIG5hbWVzID0gW107CgogICAgICAgICAgdmFyIHNlZ21lbnRzID0gcGFy
        c2Uocm91dGUucGF0aCwgbmFtZXMsIHR5cGVzKTsKCiAgICAgICAgICBhbGxT
        ZWdtZW50cyA9IGFsbFNlZ21lbnRzLmNvbmNhdChzZWdtZW50cyk7CgogICAg
        ICAgICAgZm9yICh2YXIgaj0wLCBtPXNlZ21lbnRzLmxlbmd0aDsgajxtOyBq
        KyspIHsKICAgICAgICAgICAgdmFyIHNlZ21lbnQgPSBzZWdtZW50c1tqXTsK
        CiAgICAgICAgICAgIGlmIChzZWdtZW50IGluc3RhbmNlb2YgRXBzaWxvblNl
        Z21lbnQpIHsgY29udGludWU7IH0KCiAgICAgICAgICAgIGlzRW1wdHkgPSBm
        YWxzZTsKCiAgICAgICAgICAgIC8vIEFkZCBhICIvIiBmb3IgdGhlIG5ldyBz
        ZWdtZW50CiAgICAgICAgICAgIGN1cnJlbnRTdGF0ZSA9IGN1cnJlbnRTdGF0
        ZS5wdXQoeyB2YWxpZENoYXJzOiAiLyIgfSk7CiAgICAgICAgICAgIHJlZ2V4
        ICs9ICIvIjsKCiAgICAgICAgICAgIC8vIEFkZCBhIHJlcHJlc2VudGF0aW9u
        IG9mIHRoZSBzZWdtZW50IHRvIHRoZSBORkEgYW5kIHJlZ2V4CiAgICAgICAg
        ICAgIGN1cnJlbnRTdGF0ZSA9IGFkZFNlZ21lbnQoY3VycmVudFN0YXRlLCBz
        ZWdtZW50KTsKICAgICAgICAgICAgcmVnZXggKz0gc2VnbWVudC5yZWdleCgp
        OwogICAgICAgICAgfQoKICAgICAgICAgIGhhbmRsZXJzLnB1c2goeyBoYW5k
        bGVyOiByb3V0ZS5oYW5kbGVyLCBuYW1lczogbmFtZXMgfSk7CiAgICAgICAg
        fQoKICAgICAgICBpZiAoaXNFbXB0eSkgewogICAgICAgICAgY3VycmVudFN0
        YXRlID0gY3VycmVudFN0YXRlLnB1dCh7IHZhbGlkQ2hhcnM6ICIvIiB9KTsK
        ICAgICAgICAgIHJlZ2V4ICs9ICIvIjsKICAgICAgICB9CgogICAgICAgIGN1
        cnJlbnRTdGF0ZS5oYW5kbGVycyA9IGhhbmRsZXJzOwogICAgICAgIGN1cnJl
        bnRTdGF0ZS5yZWdleCA9IG5ldyBSZWdFeHAocmVnZXggKyAiJCIpOwogICAg
        ICAgIGN1cnJlbnRTdGF0ZS50eXBlcyA9IHR5cGVzOwoKICAgICAgICBpZiAo
        bmFtZSA9IG9wdGlvbnMgJiYgb3B0aW9ucy5hcykgewogICAgICAgICAgdGhp
        cy5uYW1lc1tuYW1lXSA9IHsKICAgICAgICAgICAgc2VnbWVudHM6IGFsbFNl
        Z21lbnRzLAogICAgICAgICAgICBoYW5kbGVyczogaGFuZGxlcnMKICAgICAg
        ICAgIH07CiAgICAgICAgfQogICAgICB9LAoKICAgICAgaGFuZGxlcnNGb3I6
        IGZ1bmN0aW9uKG5hbWUpIHsKICAgICAgICB2YXIgcm91dGUgPSB0aGlzLm5h
        bWVzW25hbWVdLCByZXN1bHQgPSBbXTsKICAgICAgICBpZiAoIXJvdXRlKSB7
        IHRocm93IG5ldyBFcnJvcigiVGhlcmUgaXMgbm8gcm91dGUgbmFtZWQgIiAr
        IG5hbWUpOyB9CgogICAgICAgIGZvciAodmFyIGk9MCwgbD1yb3V0ZS5oYW5k
        bGVycy5sZW5ndGg7IGk8bDsgaSsrKSB7CiAgICAgICAgICByZXN1bHQucHVz
        aChyb3V0ZS5oYW5kbGVyc1tpXSk7CiAgICAgICAgfQoKICAgICAgICByZXR1
        cm4gcmVzdWx0OwogICAgICB9LAoKICAgICAgaGFzUm91dGU6IGZ1bmN0aW9u
        KG5hbWUpIHsKICAgICAgICByZXR1cm4gISF0aGlzLm5hbWVzW25hbWVdOwog
        ICAgICB9LAoKICAgICAgZ2VuZXJhdGU6IGZ1bmN0aW9uKG5hbWUsIHBhcmFt
        cykgewogICAgICAgIHZhciByb3V0ZSA9IHRoaXMubmFtZXNbbmFtZV0sIG91
        dHB1dCA9ICIiOwogICAgICAgIGlmICghcm91dGUpIHsgdGhyb3cgbmV3IEVy
        cm9yKCJUaGVyZSBpcyBubyByb3V0ZSBuYW1lZCAiICsgbmFtZSk7IH0KCiAg
        ICAgICAgdmFyIHNlZ21lbnRzID0gcm91dGUuc2VnbWVudHM7CgogICAgICAg
        IGZvciAodmFyIGk9MCwgbD1zZWdtZW50cy5sZW5ndGg7IGk8bDsgaSsrKSB7
        CiAgICAgICAgICB2YXIgc2VnbWVudCA9IHNlZ21lbnRzW2ldOwoKICAgICAg
        ICAgIGlmIChzZWdtZW50IGluc3RhbmNlb2YgRXBzaWxvblNlZ21lbnQpIHsg
        Y29udGludWU7IH0KCiAgICAgICAgICBvdXRwdXQgKz0gIi8iOwogICAgICAg
        ICAgb3V0cHV0ICs9IHNlZ21lbnQuZ2VuZXJhdGUocGFyYW1zKTsKICAgICAg
        ICB9CgogICAgICAgIGlmIChvdXRwdXQuY2hhckF0KDApICE9PSAnLycpIHsg
        b3V0cHV0ID0gJy8nICsgb3V0cHV0OyB9CgogICAgICAgIHJldHVybiBvdXRw
        dXQ7CiAgICAgIH0sCgogICAgICByZWNvZ25pemU6IGZ1bmN0aW9uKHBhdGgp
        IHsKICAgICAgICB2YXIgc3RhdGVzID0gWyB0aGlzLnJvb3RTdGF0ZSBdLAog
        ICAgICAgICAgICBwYXRoTGVuLCBpLCBsOwoKICAgICAgICAvLyBERUJVRyBH
        Uk9VUCBwYXRoCgogICAgICAgIGlmIChwYXRoLmNoYXJBdCgwKSAhPT0gIi8i
        KSB7IHBhdGggPSAiLyIgKyBwYXRoOyB9CgogICAgICAgIHBhdGhMZW4gPSBw
        YXRoLmxlbmd0aDsKICAgICAgICBpZiAocGF0aExlbiA+IDEgJiYgcGF0aC5j
        aGFyQXQocGF0aExlbiAtIDEpID09PSAiLyIpIHsKICAgICAgICAgIHBhdGgg
        PSBwYXRoLnN1YnN0cigwLCBwYXRoTGVuIC0gMSk7CiAgICAgICAgfQoKICAg
        ICAgICBmb3IgKGk9MCwgbD1wYXRoLmxlbmd0aDsgaTxsOyBpKyspIHsKICAg
        ICAgICAgIHN0YXRlcyA9IHJlY29nbml6ZUNoYXIoc3RhdGVzLCBwYXRoLmNo
        YXJBdChpKSk7CiAgICAgICAgICBpZiAoIXN0YXRlcy5sZW5ndGgpIHsgYnJl
        YWs7IH0KICAgICAgICB9CgogICAgICAgIC8vIEVORCBERUJVRyBHUk9VUAoK
        ICAgICAgICB2YXIgc29sdXRpb25zID0gW107CiAgICAgICAgZm9yIChpPTAs
        IGw9c3RhdGVzLmxlbmd0aDsgaTxsOyBpKyspIHsKICAgICAgICAgIGlmIChz
        dGF0ZXNbaV0uaGFuZGxlcnMpIHsgc29sdXRpb25zLnB1c2goc3RhdGVzW2ld
        KTsgfQogICAgICAgIH0KCiAgICAgICAgc3RhdGVzID0gc29ydFNvbHV0aW9u
        cyhzb2x1dGlvbnMpOwoKICAgICAgICB2YXIgc3RhdGUgPSBzb2x1dGlvbnNb
        MF07CgogICAgICAgIGlmIChzdGF0ZSAmJiBzdGF0ZS5oYW5kbGVycykgewog
        ICAgICAgICAgcmV0dXJuIGZpbmRIYW5kbGVyKHN0YXRlLCBwYXRoKTsKICAg
        ICAgICB9CiAgICAgIH0KICAgIH07CgogICAgZnVuY3Rpb24gVGFyZ2V0KHBh
        dGgsIG1hdGNoZXIsIGRlbGVnYXRlKSB7CiAgICAgIHRoaXMucGF0aCA9IHBh
        dGg7CiAgICAgIHRoaXMubWF0Y2hlciA9IG1hdGNoZXI7CiAgICAgIHRoaXMu
        ZGVsZWdhdGUgPSBkZWxlZ2F0ZTsKICAgIH0KCiAgICBUYXJnZXQucHJvdG90
        eXBlID0gewogICAgICB0bzogZnVuY3Rpb24odGFyZ2V0LCBjYWxsYmFjaykg
        ewogICAgICAgIHZhciBkZWxlZ2F0ZSA9IHRoaXMuZGVsZWdhdGU7CgogICAg
        ICAgIGlmIChkZWxlZ2F0ZSAmJiBkZWxlZ2F0ZS53aWxsQWRkUm91dGUpIHsK
        ICAgICAgICAgIHRhcmdldCA9IGRlbGVnYXRlLndpbGxBZGRSb3V0ZSh0aGlz
        Lm1hdGNoZXIudGFyZ2V0LCB0YXJnZXQpOwogICAgICAgIH0KCiAgICAgICAg
        dGhpcy5tYXRjaGVyLmFkZCh0aGlzLnBhdGgsIHRhcmdldCk7CgogICAgICAg
        IGlmIChjYWxsYmFjaykgewogICAgICAgICAgaWYgKGNhbGxiYWNrLmxlbmd0
        aCA9PT0gMCkgeyB0aHJvdyBuZXcgRXJyb3IoIllvdSBtdXN0IGhhdmUgYW4g
        YXJndW1lbnQgaW4gdGhlIGZ1bmN0aW9uIHBhc3NlZCB0byBgdG9gIik7IH0K
        ICAgICAgICAgIHRoaXMubWF0Y2hlci5hZGRDaGlsZCh0aGlzLnBhdGgsIHRh
        cmdldCwgY2FsbGJhY2ssIHRoaXMuZGVsZWdhdGUpOwogICAgICAgIH0KICAg
        ICAgfQogICAgfTsKCiAgICBmdW5jdGlvbiBNYXRjaGVyKHRhcmdldCkgewog
        ICAgICB0aGlzLnJvdXRlcyA9IHt9OwogICAgICB0aGlzLmNoaWxkcmVuID0g
        e307CiAgICAgIHRoaXMudGFyZ2V0ID0gdGFyZ2V0OwogICAgfQoKICAgIE1h
        dGNoZXIucHJvdG90eXBlID0gewogICAgICBhZGQ6IGZ1bmN0aW9uKHBhdGgs
        IGhhbmRsZXIpIHsKICAgICAgICB0aGlzLnJvdXRlc1twYXRoXSA9IGhhbmRs
        ZXI7CiAgICAgIH0sCgogICAgICBhZGRDaGlsZDogZnVuY3Rpb24ocGF0aCwg
        dGFyZ2V0LCBjYWxsYmFjaywgZGVsZWdhdGUpIHsKICAgICAgICB2YXIgbWF0
        Y2hlciA9IG5ldyBNYXRjaGVyKHRhcmdldCk7CiAgICAgICAgdGhpcy5jaGls
        ZHJlbltwYXRoXSA9IG1hdGNoZXI7CgogICAgICAgIHZhciBtYXRjaCA9IGdl
        bmVyYXRlTWF0Y2gocGF0aCwgbWF0Y2hlciwgZGVsZWdhdGUpOwoKICAgICAg
        ICBpZiAoZGVsZWdhdGUgJiYgZGVsZWdhdGUuY29udGV4dEVudGVyZWQpIHsK
        ICAgICAgICAgIGRlbGVnYXRlLmNvbnRleHRFbnRlcmVkKHRhcmdldCwgbWF0
        Y2gpOwogICAgICAgIH0KCiAgICAgICAgY2FsbGJhY2sobWF0Y2gpOwogICAg
        ICB9CiAgICB9OwoKICAgIGZ1bmN0aW9uIGdlbmVyYXRlTWF0Y2goc3RhcnRp
        bmdQYXRoLCBtYXRjaGVyLCBkZWxlZ2F0ZSkgewogICAgICByZXR1cm4gZnVu
        Y3Rpb24ocGF0aCwgbmVzdGVkQ2FsbGJhY2spIHsKICAgICAgICB2YXIgZnVs
        bFBhdGggPSBzdGFydGluZ1BhdGggKyBwYXRoOwoKICAgICAgICBpZiAobmVz
        dGVkQ2FsbGJhY2spIHsKICAgICAgICAgIG5lc3RlZENhbGxiYWNrKGdlbmVy
        YXRlTWF0Y2goZnVsbFBhdGgsIG1hdGNoZXIsIGRlbGVnYXRlKSk7CiAgICAg
        ICAgfSBlbHNlIHsKICAgICAgICAgIHJldHVybiBuZXcgVGFyZ2V0KHN0YXJ0
        aW5nUGF0aCArIHBhdGgsIG1hdGNoZXIsIGRlbGVnYXRlKTsKICAgICAgICB9
        CiAgICAgIH07CiAgICB9CgogICAgZnVuY3Rpb24gYWRkUm91dGUocm91dGVB
        cnJheSwgcGF0aCwgaGFuZGxlcikgewogICAgICB2YXIgbGVuID0gMDsKICAg
        ICAgZm9yICh2YXIgaT0wLCBsPXJvdXRlQXJyYXkubGVuZ3RoOyBpPGw7IGkr
        KykgewogICAgICAgIGxlbiArPSByb3V0ZUFycmF5W2ldLnBhdGgubGVuZ3Ro
        OwogICAgICB9CgogICAgICBwYXRoID0gcGF0aC5zdWJzdHIobGVuKTsKICAg
        ICAgcm91dGVBcnJheS5wdXNoKHsgcGF0aDogcGF0aCwgaGFuZGxlcjogaGFu
        ZGxlciB9KTsKICAgIH0KCiAgICBmdW5jdGlvbiBlYWNoUm91dGUoYmFzZVJv
        dXRlLCBtYXRjaGVyLCBjYWxsYmFjaywgYmluZGluZykgewogICAgICB2YXIg
        cm91dGVzID0gbWF0Y2hlci5yb3V0ZXM7CgogICAgICBmb3IgKHZhciBwYXRo
        IGluIHJvdXRlcykgewogICAgICAgIGlmIChyb3V0ZXMuaGFzT3duUHJvcGVy
        dHkocGF0aCkpIHsKICAgICAgICAgIHZhciByb3V0ZUFycmF5ID0gYmFzZVJv
        dXRlLnNsaWNlKCk7CiAgICAgICAgICBhZGRSb3V0ZShyb3V0ZUFycmF5LCBw
        YXRoLCByb3V0ZXNbcGF0aF0pOwoKICAgICAgICAgIGlmIChtYXRjaGVyLmNo
        aWxkcmVuW3BhdGhdKSB7CiAgICAgICAgICAgIGVhY2hSb3V0ZShyb3V0ZUFy
        cmF5LCBtYXRjaGVyLmNoaWxkcmVuW3BhdGhdLCBjYWxsYmFjaywgYmluZGlu
        Zyk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBjYWxsYmFjay5j
        YWxsKGJpbmRpbmcsIHJvdXRlQXJyYXkpOwogICAgICAgICAgfQogICAgICAg
        IH0KICAgICAgfQogICAgfQoKICAgIFJvdXRlUmVjb2duaXplci5wcm90b3R5
        cGUubWFwID0gZnVuY3Rpb24oY2FsbGJhY2ssIGFkZFJvdXRlQ2FsbGJhY2sp
        IHsKICAgICAgdmFyIG1hdGNoZXIgPSBuZXcgTWF0Y2hlcigpOwoKICAgICAg
        Y2FsbGJhY2soZ2VuZXJhdGVNYXRjaCgiIiwgbWF0Y2hlciwgdGhpcy5kZWxl
        Z2F0ZSkpOwoKICAgICAgZWFjaFJvdXRlKFtdLCBtYXRjaGVyLCBmdW5jdGlv
        bihyb3V0ZSkgewogICAgICAgIGlmIChhZGRSb3V0ZUNhbGxiYWNrKSB7IGFk
        ZFJvdXRlQ2FsbGJhY2sodGhpcywgcm91dGUpOyB9CiAgICAgICAgZWxzZSB7
        IHRoaXMuYWRkKHJvdXRlKTsgfQogICAgICB9LCB0aGlzKTsKICAgIH07CiAg
        ICByZXR1cm4gUm91dGVSZWNvZ25pemVyOwogIH0pOwoKfSkoKTsKCgoKKGZ1
        bmN0aW9uKCkgewpkZWZpbmUoInJvdXRlciIsCiAgWyJyb3V0ZS1yZWNvZ25p
        emVyIiwicnN2cCJdLAogIGZ1bmN0aW9uKFJvdXRlUmVjb2duaXplciwgUlNW
        UCkgewogICAgInVzZSBzdHJpY3QiOwogICAgLyoqCiAgICAgIEBwcml2YXRl
        CgogICAgICBUaGlzIGZpbGUgcmVmZXJlbmNlcyBzZXZlcmFsIGludGVybmFs
        IHN0cnVjdHVyZXM6CgogICAgICAjIyBgUmVjb2duaXplZEhhbmRsZXJgCgog
        ICAgICAqIGB7U3RyaW5nfSBoYW5kbGVyYDogQSBoYW5kbGVyIG5hbWUKICAg
        ICAgKiBge09iamVjdH0gcGFyYW1zYDogQSBoYXNoIG9mIHJlY29nbml6ZWQg
        cGFyYW1ldGVycwoKICAgICAgIyMgYEhhbmRsZXJJbmZvYAoKICAgICAgKiBg
        e0Jvb2xlYW59IGlzRHluYW1pY2A6IHdoZXRoZXIgYSBoYW5kbGVyIGhhcyBh
        bnkgZHluYW1pYyBzZWdtZW50cwogICAgICAqIGB7U3RyaW5nfSBuYW1lYDog
        dGhlIG5hbWUgb2YgYSBoYW5kbGVyCiAgICAgICogYHtPYmplY3R9IGhhbmRs
        ZXJgOiBhIGhhbmRsZXIgb2JqZWN0CiAgICAgICogYHtPYmplY3R9IGNvbnRl
        eHRgOiB0aGUgYWN0aXZlIGNvbnRleHQgZm9yIHRoZSBoYW5kbGVyCiAgICAq
        LwoKCiAgICB2YXIgc2xpY2UgPSBBcnJheS5wcm90b3R5cGUuc2xpY2U7CgoK
        CiAgICAvKioKICAgICAgQHByaXZhdGUKCiAgICAgIEEgVHJhbnNpdGlvbiBp
        cyBhIHRoZW5uYWJsZSAoYSBwcm9taXNlLWxpa2Ugb2JqZWN0KSB0aGF0IHJl
        cHJlc2VudHMKICAgICAgYW4gYXR0ZW1wdCB0byB0cmFuc2l0aW9uIHRvIGFu
        b3RoZXIgcm91dGUuIEl0IGNhbiBiZSBhYm9ydGVkLCBlaXRoZXIKICAgICAg
        ZXhwbGljaXRseSB2aWEgYGFib3J0YCBvciBieSBhdHRlbXB0aW5nIGFub3Ro
        ZXIgdHJhbnNpdGlvbiB3aGlsZSBhCiAgICAgIHByZXZpb3VzIG9uZSBpcyBz
        dGlsbCB1bmRlcndheS4gQW4gYWJvcnRlZCB0cmFuc2l0aW9uIGNhbiBhbHNv
        CiAgICAgIGJlIGByZXRyeSgpYGQgbGF0ZXIuCiAgICAgKi8KCiAgICBmdW5j
        dGlvbiBUcmFuc2l0aW9uKHJvdXRlciwgcHJvbWlzZSkgewogICAgICB0aGlz
        LnJvdXRlciA9IHJvdXRlcjsKICAgICAgdGhpcy5wcm9taXNlID0gcHJvbWlz
        ZTsKICAgICAgdGhpcy5kYXRhID0ge307CiAgICAgIHRoaXMucmVzb2x2ZWRN
        b2RlbHMgPSB7fTsKICAgICAgdGhpcy5wcm92aWRlZE1vZGVscyA9IHt9Owog
        ICAgICB0aGlzLnByb3ZpZGVkTW9kZWxzQXJyYXkgPSBbXTsKICAgICAgdGhp
        cy5zZXF1ZW5jZSA9ICsrVHJhbnNpdGlvbi5jdXJyZW50U2VxdWVuY2U7CiAg
        ICAgIHRoaXMucGFyYW1zID0ge307CiAgICB9CgogICAgVHJhbnNpdGlvbi5j
        dXJyZW50U2VxdWVuY2UgPSAwOwoKICAgIFRyYW5zaXRpb24ucHJvdG90eXBl
        ID0gewogICAgICB0YXJnZXROYW1lOiBudWxsLAogICAgICB1cmxNZXRob2Q6
        ICd1cGRhdGUnLAogICAgICBwcm92aWRlZE1vZGVsczogbnVsbCwKICAgICAg
        cmVzb2x2ZWRNb2RlbHM6IG51bGwsCiAgICAgIHBhcmFtczogbnVsbCwKCiAg
        ICAgIC8qKgogICAgICAgIFRoZSBUcmFuc2l0aW9uJ3MgaW50ZXJuYWwgcHJv
        bWlzZS4gQ2FsbGluZyBgLnRoZW5gIG9uIHRoaXMgcHJvcGVydHkKICAgICAg
        ICBpcyB0aGF0IHNhbWUgYXMgY2FsbGluZyBgLnRoZW5gIG9uIHRoZSBUcmFu
        c2l0aW9uIG9iamVjdCBpdHNlbGYsIGJ1dAogICAgICAgIHRoaXMgcHJvcGVy
        dHkgaXMgZXhwb3NlZCBmb3Igd2hlbiB5b3Ugd2FudCB0byBwYXNzIGFyb3Vu
        ZCBhCiAgICAgICAgVHJhbnNpdGlvbidzIHByb21pc2UsIGJ1dCBub3QgdGhl
        IFRyYW5zaXRpb24gb2JqZWN0IGl0c2VsZiwgc2luY2UKICAgICAgICBUcmFu
        c2l0aW9uIG9iamVjdCBjYW4gYmUgZXh0ZXJuYWxseSBgYWJvcnRgZWQsIHdo
        aWxlIHRoZSBwcm9taXNlCiAgICAgICAgY2Fubm90LgogICAgICAgKi8KICAg
        ICAgcHJvbWlzZTogbnVsbCwKCiAgICAgIC8qKgogICAgICAgIEN1c3RvbSBz
        dGF0ZSBjYW4gYmUgc3RvcmVkIG9uIGEgVHJhbnNpdGlvbidzIGBkYXRhYCBv
        YmplY3QuCiAgICAgICAgVGhpcyBjYW4gYmUgdXNlZnVsIGZvciBkZWNvcmF0
        aW5nIGEgVHJhbnNpdGlvbiB3aXRoaW4gYW4gZWFybGllcgogICAgICAgIGhv
        b2sgYW5kIHNoYXJlZCB3aXRoIGEgbGF0ZXIgaG9vay4gUHJvcGVydGllcyBz
        ZXQgb24gYGRhdGFgIHdpbGwKICAgICAgICBiZSBjb3BpZWQgdG8gbmV3IHRy
        YW5zaXRpb25zIGdlbmVyYXRlZCBieSBjYWxsaW5nIGByZXRyeWAgb24gdGhp
        cwogICAgICAgIHRyYW5zaXRpb24uCiAgICAgICAqLwogICAgICBkYXRhOiBu
        dWxsLAoKICAgICAgLyoqCiAgICAgICAgQSBzdGFuZGFyZCBwcm9taXNlIGhv
        b2sgdGhhdCByZXNvbHZlcyBpZiB0aGUgdHJhbnNpdGlvbgogICAgICAgIHN1
        Y2NlZWRzIGFuZCByZWplY3RzIGlmIGl0IGZhaWxzL3JlZGlyZWN0cy9hYm9y
        dHMuCgogICAgICAgIEZvcndhcmRzIHRvIHRoZSBpbnRlcm5hbCBgcHJvbWlz
        ZWAgcHJvcGVydHkgd2hpY2ggeW91IGNhbgogICAgICAgIHVzZSBpbiBzaXR1
        YXRpb25zIHdoZXJlIHlvdSB3YW50IHRvIHBhc3MgYXJvdW5kIGEgdGhlbm5h
        YmxlLAogICAgICAgIGJ1dCBub3QgdGhlIFRyYW5zaXRpb24gaXRzZWxmLgoK
        ICAgICAgICBAcGFyYW0ge0Z1bmN0aW9ufSBzdWNjZXNzCiAgICAgICAgQHBh
        cmFtIHtGdW5jdGlvbn0gZmFpbHVyZQogICAgICAgKi8KICAgICAgdGhlbjog
        ZnVuY3Rpb24oc3VjY2VzcywgZmFpbHVyZSkgewogICAgICAgIHJldHVybiB0
        aGlzLnByb21pc2UudGhlbihzdWNjZXNzLCBmYWlsdXJlKTsKICAgICAgfSwK
        CiAgICAgIC8qKgogICAgICAgIEFib3J0cyB0aGUgVHJhbnNpdGlvbi4gTm90
        ZSB5b3UgY2FuIGFsc28gaW1wbGljaXRseSBhYm9ydCBhIHRyYW5zaXRpb24K
        ICAgICAgICBieSBpbml0aWF0aW5nIGFub3RoZXIgdHJhbnNpdGlvbiB3aGls
        ZSBhIHByZXZpb3VzIG9uZSBpcyB1bmRlcndheS4KICAgICAgICovCiAgICAg
        IGFib3J0OiBmdW5jdGlvbigpIHsKICAgICAgICBpZiAodGhpcy5pc0Fib3J0
        ZWQpIHsgcmV0dXJuIHRoaXM7IH0KICAgICAgICBsb2codGhpcy5yb3V0ZXIs
        IHRoaXMuc2VxdWVuY2UsIHRoaXMudGFyZ2V0TmFtZSArICI6IHRyYW5zaXRp
        b24gd2FzIGFib3J0ZWQiKTsKICAgICAgICB0aGlzLmlzQWJvcnRlZCA9IHRy
        dWU7CiAgICAgICAgdGhpcy5yb3V0ZXIuYWN0aXZlVHJhbnNpdGlvbiA9IG51
        bGw7CiAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAgIH0sCgogICAgICAvKioK
        ICAgICAgICBSZXRyaWVzIGEgcHJldmlvdXNseS1hYm9ydGVkIHRyYW5zaXRp
        b24gKG1ha2luZyBzdXJlIHRvIGFib3J0IHRoZQogICAgICAgIHRyYW5zaXRp
        b24gaWYgaXQncyBzdGlsbCBhY3RpdmUpLiBSZXR1cm5zIGEgbmV3IHRyYW5z
        aXRpb24gdGhhdAogICAgICAgIHJlcHJlc2VudHMgdGhlIG5ldyBhdHRlbXB0
        IHRvIHRyYW5zaXRpb24uCiAgICAgICAqLwogICAgICByZXRyeTogZnVuY3Rp
        b24oKSB7CiAgICAgICAgdGhpcy5hYm9ydCgpOwoKICAgICAgICB2YXIgcmVj
        b2dIYW5kbGVycyA9IHRoaXMucm91dGVyLnJlY29nbml6ZXIuaGFuZGxlcnNG
        b3IodGhpcy50YXJnZXROYW1lKSwKICAgICAgICAgICAgbmV3VHJhbnNpdGlv
        biA9IHBlcmZvcm1UcmFuc2l0aW9uKHRoaXMucm91dGVyLCByZWNvZ0hhbmRs
        ZXJzLCB0aGlzLnByb3ZpZGVkTW9kZWxzQXJyYXksIHRoaXMucGFyYW1zLCB0
        aGlzLmRhdGEpOwoKICAgICAgICByZXR1cm4gbmV3VHJhbnNpdGlvbjsKICAg
        ICAgfSwKCiAgICAgIC8qKgogICAgICAgIFNldHMgdGhlIFVSTC1jaGFuZ2lu
        ZyBtZXRob2QgdG8gYmUgZW1wbG95ZWQgYXQgdGhlIGVuZCBvZiBhCiAgICAg
        ICAgc3VjY2Vzc2Z1bCB0cmFuc2l0aW9uLiBCeSBkZWZhdWx0LCBhIG5ldyBU
        cmFuc2l0aW9uIHdpbGwganVzdAogICAgICAgIHVzZSBgdXBkYXRlVVJMYCwg
        YnV0IHBhc3NpbmcgJ3JlcGxhY2UnIHRvIHRoaXMgbWV0aG9kIHdpbGwKICAg
        ICAgICBjYXVzZSB0aGUgVVJMIHRvIHVwZGF0ZSB1c2luZyAncmVwbGFjZVdp
        dGgnIGluc3RlYWQuIE9taXR0aW5nCiAgICAgICAgYSBwYXJhbWV0ZXIgd2ls
        bCBkaXNhYmxlIHRoZSBVUkwgY2hhbmdlLCBhbGxvd2luZyBmb3IgdHJhbnNp
        dGlvbnMKICAgICAgICB0aGF0IGRvbid0IHVwZGF0ZSB0aGUgVVJMIGF0IGNv
        bXBsZXRpb24gKHRoaXMgaXMgYWxzbyB1c2VkIGZvcgogICAgICAgIGhhbmRs
        ZVVSTCwgc2luY2UgdGhlIFVSTCBoYXMgYWxyZWFkeSBjaGFuZ2VkIGJlZm9y
        ZSB0aGUKICAgICAgICB0cmFuc2l0aW9uIHRvb2sgcGxhY2UpLgoKICAgICAg
        ICBAcGFyYW0ge1N0cmluZ30gbWV0aG9kIHRoZSB0eXBlIG9mIFVSTC1jaGFu
        Z2luZyBtZXRob2QgdG8gdXNlCiAgICAgICAgICBhdCB0aGUgZW5kIG9mIGEg
        dHJhbnNpdGlvbi4gQWNjZXB0ZWQgdmFsdWVzIGFyZSAncmVwbGFjZScsCiAg
        ICAgICAgICBmYWxzeSB2YWx1ZXMsIG9yIGFueSBvdGhlciBub24tZmFsc3kg
        dmFsdWUgKHdoaWNoIGlzCiAgICAgICAgICBpbnRlcnByZXRlZCBhcyBhbiB1
        cGRhdGVVUkwgdHJhbnNpdGlvbikuCgogICAgICAgIEByZXR1cm4ge1RyYW5z
        aXRpb259IHRoaXMgdHJhbnNpdGlvbgogICAgICAgKi8KICAgICAgbWV0aG9k
        OiBmdW5jdGlvbihtZXRob2QpIHsKICAgICAgICB0aGlzLnVybE1ldGhvZCA9
        IG1ldGhvZDsKICAgICAgICByZXR1cm4gdGhpczsKICAgICAgfQogICAgfTsK
        CiAgICBmdW5jdGlvbiBSb3V0ZXIoKSB7CiAgICAgIHRoaXMucmVjb2duaXpl
        ciA9IG5ldyBSb3V0ZVJlY29nbml6ZXIoKTsKICAgIH0KCgoKICAgIC8qKgog
        ICAgICBQcm9taXNlIHJlamVjdCByZWFzb25zIHBhc3NlZCB0byBwcm9taXNl
        IHJlamVjdGlvbgogICAgICBoYW5kbGVycyBmb3IgZmFpbGVkIHRyYW5zaXRp
        b25zLgogICAgICovCiAgICBSb3V0ZXIuVW5yZWNvZ25pemVkVVJMRXJyb3Ig
        PSBmdW5jdGlvbihtZXNzYWdlKSB7CiAgICAgIHRoaXMubWVzc2FnZSA9ICht
        ZXNzYWdlIHx8ICJVbnJlY29nbml6ZWRVUkxFcnJvciIpOwogICAgICB0aGlz
        Lm5hbWUgPSAiVW5yZWNvZ25pemVkVVJMRXJyb3IiOwogICAgfTsKCiAgICBS
        b3V0ZXIuVHJhbnNpdGlvbkFib3J0ZWQgPSBmdW5jdGlvbihtZXNzYWdlKSB7
        CiAgICAgIHRoaXMubWVzc2FnZSA9IChtZXNzYWdlIHx8ICJUcmFuc2l0aW9u
        QWJvcnRlZCIpOwogICAgICB0aGlzLm5hbWUgPSAiVHJhbnNpdGlvbkFib3J0
        ZWQiOwogICAgfTsKCiAgICBmdW5jdGlvbiBlcnJvclRyYW5zaXRpb24ocm91
        dGVyLCByZWFzb24pIHsKICAgICAgcmV0dXJuIG5ldyBUcmFuc2l0aW9uKHJv
        dXRlciwgUlNWUC5yZWplY3QocmVhc29uKSk7CiAgICB9CgoKICAgIFJvdXRl
        ci5wcm90b3R5cGUgPSB7CiAgICAgIC8qKgogICAgICAgIFRoZSBtYWluIGVu
        dHJ5IHBvaW50IGludG8gdGhlIHJvdXRlci4gVGhlIEFQSSBpcyBlc3NlbnRp
        YWxseQogICAgICAgIHRoZSBzYW1lIGFzIHRoZSBgbWFwYCBtZXRob2QgaW4g
        YHJvdXRlLXJlY29nbml6ZXJgLgoKICAgICAgICBUaGlzIG1ldGhvZCBleHRy
        YWN0cyB0aGUgU3RyaW5nIGhhbmRsZXIgYXQgdGhlIGxhc3QgYC50bygpYAog
        ICAgICAgIGNhbGwgYW5kIHVzZXMgaXQgYXMgdGhlIG5hbWUgb2YgdGhlIHdo
        b2xlIHJvdXRlLgoKICAgICAgICBAcGFyYW0ge0Z1bmN0aW9ufSBjYWxsYmFj
        awogICAgICAqLwogICAgICBtYXA6IGZ1bmN0aW9uKGNhbGxiYWNrKSB7CiAg
        ICAgICAgdGhpcy5yZWNvZ25pemVyLmRlbGVnYXRlID0gdGhpcy5kZWxlZ2F0
        ZTsKCiAgICAgICAgdGhpcy5yZWNvZ25pemVyLm1hcChjYWxsYmFjaywgZnVu
        Y3Rpb24ocmVjb2duaXplciwgcm91dGUpIHsKICAgICAgICAgIHZhciBsYXN0
        SGFuZGxlciA9IHJvdXRlW3JvdXRlLmxlbmd0aCAtIDFdLmhhbmRsZXI7CiAg
        ICAgICAgICB2YXIgYXJncyA9IFtyb3V0ZSwgeyBhczogbGFzdEhhbmRsZXIg
        fV07CiAgICAgICAgICByZWNvZ25pemVyLmFkZC5hcHBseShyZWNvZ25pemVy
        LCBhcmdzKTsKICAgICAgICB9KTsKICAgICAgfSwKCiAgICAgIGhhc1JvdXRl
        OiBmdW5jdGlvbihyb3V0ZSkgewogICAgICAgIHJldHVybiB0aGlzLnJlY29n
        bml6ZXIuaGFzUm91dGUocm91dGUpOwogICAgICB9LAoKICAgICAgLyoqCiAg
        ICAgICAgQ2xlYXJzIHRoZSBjdXJyZW50IGFuZCB0YXJnZXQgcm91dGUgaGFu
        ZGxlcnMgYW5kIHRyaWdnZXJzIGV4aXQKICAgICAgICBvbiBlYWNoIG9mIHRo
        ZW0gc3RhcnRpbmcgYXQgdGhlIGxlYWYgYW5kIHRyYXZlcnNpbmcgdXAgdGhy
        b3VnaAogICAgICAgIGl0cyBhbmNlc3RvcnMuCiAgICAgICovCiAgICAgIHJl
        c2V0OiBmdW5jdGlvbigpIHsKICAgICAgICBlYWNoSGFuZGxlcih0aGlzLmN1
        cnJlbnRIYW5kbGVySW5mb3MgfHwgW10sIGZ1bmN0aW9uKGhhbmRsZXJJbmZv
        KSB7CiAgICAgICAgICB2YXIgaGFuZGxlciA9IGhhbmRsZXJJbmZvLmhhbmRs
        ZXI7CiAgICAgICAgICBpZiAoaGFuZGxlci5leGl0KSB7CiAgICAgICAgICAg
        IGhhbmRsZXIuZXhpdCgpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAg
        ICAgIHRoaXMuY3VycmVudEhhbmRsZXJJbmZvcyA9IG51bGw7CiAgICAgICAg
        dGhpcy50YXJnZXRIYW5kbGVySW5mb3MgPSBudWxsOwogICAgICB9LAoKICAg
        ICAgYWN0aXZlVHJhbnNpdGlvbjogbnVsbCwKCiAgICAgIC8qKgogICAgICAg
        IHZhciBoYW5kbGVyID0gaGFuZGxlckluZm8uaGFuZGxlcjsKICAgICAgICBU
        aGUgZW50cnkgcG9pbnQgZm9yIGhhbmRsaW5nIGEgY2hhbmdlIHRvIHRoZSBV
        UkwgKHVzdWFsbHkKICAgICAgICB2aWEgdGhlIGJhY2sgYW5kIGZvcndhcmQg
        YnV0dG9uKS4KCiAgICAgICAgUmV0dXJucyBhbiBBcnJheSBvZiBoYW5kbGVy
        cyBhbmQgdGhlIHBhcmFtZXRlcnMgYXNzb2NpYXRlZAogICAgICAgIHdpdGgg
        dGhvc2UgcGFyYW1ldGVycy4KCiAgICAgICAgQHBhcmFtIHtTdHJpbmd9IHVy
        bCBhIFVSTCB0byBwcm9jZXNzCgogICAgICAgIEByZXR1cm4ge0FycmF5fSBh
        biBBcnJheSBvZiBgW2hhbmRsZXIsIHBhcmFtZXRlcl1gIHR1cGxlcwogICAg
        ICAqLwogICAgICBoYW5kbGVVUkw6IGZ1bmN0aW9uKHVybCkgewogICAgICAg
        IC8vIFBlcmZvcm0gYSBVUkwtYmFzZWQgdHJhbnNpdGlvbiwgYnV0IGRvbid0
        IGNoYW5nZQogICAgICAgIC8vIHRoZSBVUkwgYWZ0ZXJ3YXJkLCBzaW5jZSBp
        dCBhbHJlYWR5IGhhcHBlbmVkLgogICAgICAgIHZhciBhcmdzID0gc2xpY2Uu
        Y2FsbChhcmd1bWVudHMpOwogICAgICAgIGlmICh1cmwuY2hhckF0KDApICE9
        PSAnLycpIHsgYXJnc1swXSA9ICcvJyArIHVybDsgfQogICAgICAgIHJldHVy
        biBkb1RyYW5zaXRpb24odGhpcywgYXJncykubWV0aG9kKG51bGwpOwogICAg
        ICB9LAoKICAgICAgLyoqCiAgICAgICAgSG9vayBwb2ludCBmb3IgdXBkYXRp
        bmcgdGhlIFVSTC4KCiAgICAgICAgQHBhcmFtIHtTdHJpbmd9IHVybCBhIFVS
        TCB0byB1cGRhdGUgdG8KICAgICAgKi8KICAgICAgdXBkYXRlVVJMOiBmdW5j
        dGlvbigpIHsKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoInVwZGF0ZVVSTCBp
        cyBub3QgaW1wbGVtZW50ZWQiKTsKICAgICAgfSwKCiAgICAgIC8qKgogICAg
        ICAgIEhvb2sgcG9pbnQgZm9yIHJlcGxhY2luZyB0aGUgY3VycmVudCBVUkws
        IGkuZS4gd2l0aCByZXBsYWNlU3RhdGUKCiAgICAgICAgQnkgZGVmYXVsdCB0
        aGlzIGJlaGF2ZXMgdGhlIHNhbWUgYXMgYHVwZGF0ZVVSTGAKCiAgICAgICAg
        QHBhcmFtIHtTdHJpbmd9IHVybCBhIFVSTCB0byB1cGRhdGUgdG8KICAgICAg
        Ki8KICAgICAgcmVwbGFjZVVSTDogZnVuY3Rpb24odXJsKSB7CiAgICAgICAg
        dGhpcy51cGRhdGVVUkwodXJsKTsKICAgICAgfSwKCiAgICAgIC8qKgogICAg
        ICAgIFRyYW5zaXRpb24gaW50byB0aGUgc3BlY2lmaWVkIG5hbWVkIHJvdXRl
        LgoKICAgICAgICBJZiBuZWNlc3NhcnksIHRyaWdnZXIgdGhlIGV4aXQgY2Fs
        bGJhY2sgb24gYW55IGhhbmRsZXJzCiAgICAgICAgdGhhdCBhcmUgbm8gbG9u
        Z2VyIHJlcHJlc2VudGVkIGJ5IHRoZSB0YXJnZXQgcm91dGUuCgogICAgICAg
        IEBwYXJhbSB7U3RyaW5nfSBuYW1lIHRoZSBuYW1lIG9mIHRoZSByb3V0ZQog
        ICAgICAqLwogICAgICB0cmFuc2l0aW9uVG86IGZ1bmN0aW9uKG5hbWUpIHsK
        ICAgICAgICByZXR1cm4gZG9UcmFuc2l0aW9uKHRoaXMsIGFyZ3VtZW50cyk7
        CiAgICAgIH0sCgogICAgICAvKioKICAgICAgICBJZGVudGljYWwgdG8gYHRy
        YW5zaXRpb25Ub2AgZXhjZXB0IHRoYXQgdGhlIGN1cnJlbnQgVVJMIHdpbGwg
        YmUgcmVwbGFjZWQKICAgICAgICBpZiBwb3NzaWJsZS4KCiAgICAgICAgVGhp
        cyBtZXRob2QgaXMgaW50ZW5kZWQgcHJpbWFyaWx5IGZvciB1c2Ugd2l0aCBg
        cmVwbGFjZVN0YXRlYC4KCiAgICAgICAgQHBhcmFtIHtTdHJpbmd9IG5hbWUg
        dGhlIG5hbWUgb2YgdGhlIHJvdXRlCiAgICAgICovCiAgICAgIHJlcGxhY2VX
        aXRoOiBmdW5jdGlvbihuYW1lKSB7CiAgICAgICAgcmV0dXJuIGRvVHJhbnNp
        dGlvbih0aGlzLCBhcmd1bWVudHMpLm1ldGhvZCgncmVwbGFjZScpOwogICAg
        ICB9LAoKICAgICAgLyoqCiAgICAgICAgQHByaXZhdGUKCiAgICAgICAgVGhp
        cyBtZXRob2QgdGFrZXMgYSBoYW5kbGVyIG5hbWUgYW5kIGEgbGlzdCBvZiBj
        b250ZXh0cyBhbmQgcmV0dXJucwogICAgICAgIGEgc2VyaWFsaXplZCBwYXJh
        bWV0ZXIgaGFzaCBzdWl0YWJsZSB0byBwYXNzIHRvIGByZWNvZ25pemVyLmdl
        bmVyYXRlKClgLgoKICAgICAgICBAcGFyYW0ge1N0cmluZ30gaGFuZGxlck5h
        bWUKICAgICAgICBAcGFyYW0ge0FycmF5W09iamVjdF19IGNvbnRleHRzCiAg
        ICAgICAgQHJldHVybiB7T2JqZWN0fSBhIHNlcmlhbGl6ZWQgcGFyYW1ldGVy
        IGhhc2gKICAgICAgKi8KICAgICAgcGFyYW1zRm9ySGFuZGxlcjogZnVuY3Rp
        b24oaGFuZGxlck5hbWUsIGNvbnRleHRzKSB7CiAgICAgICAgcmV0dXJuIHBh
        cmFtc0ZvckhhbmRsZXIodGhpcywgaGFuZGxlck5hbWUsIHNsaWNlLmNhbGwo
        YXJndW1lbnRzLCAxKSk7CiAgICAgIH0sCgogICAgICAvKioKICAgICAgICBU
        YWtlIGEgbmFtZWQgcm91dGUgYW5kIGNvbnRleHQgb2JqZWN0cyBhbmQgZ2Vu
        ZXJhdGUgYQogICAgICAgIFVSTC4KCiAgICAgICAgQHBhcmFtIHtTdHJpbmd9
        IG5hbWUgdGhlIG5hbWUgb2YgdGhlIHJvdXRlIHRvIGdlbmVyYXRlCiAgICAg
        ICAgICBhIFVSTCBmb3IKICAgICAgICBAcGFyYW0gey4uLk9iamVjdH0gb2Jq
        ZWN0cyBhIGxpc3Qgb2Ygb2JqZWN0cyB0byBzZXJpYWxpemUKCiAgICAgICAg
        QHJldHVybiB7U3RyaW5nfSBhIFVSTAogICAgICAqLwogICAgICBnZW5lcmF0
        ZTogZnVuY3Rpb24oaGFuZGxlck5hbWUpIHsKICAgICAgICB2YXIgcGFyYW1z
        ID0gcGFyYW1zRm9ySGFuZGxlcih0aGlzLCBoYW5kbGVyTmFtZSwgc2xpY2Uu
        Y2FsbChhcmd1bWVudHMsIDEpKTsKICAgICAgICByZXR1cm4gdGhpcy5yZWNv
        Z25pemVyLmdlbmVyYXRlKGhhbmRsZXJOYW1lLCBwYXJhbXMpOwogICAgICB9
        LAoKICAgICAgaXNBY3RpdmU6IGZ1bmN0aW9uKGhhbmRsZXJOYW1lKSB7CiAg
        ICAgICAgdmFyIGNvbnRleHRzID0gc2xpY2UuY2FsbChhcmd1bWVudHMsIDEp
        OwoKICAgICAgICB2YXIgdGFyZ2V0SGFuZGxlckluZm9zID0gdGhpcy50YXJn
        ZXRIYW5kbGVySW5mb3MsCiAgICAgICAgICAgIGZvdW5kID0gZmFsc2UsIG5h
        bWVzLCBvYmplY3QsIGhhbmRsZXJJbmZvLCBoYW5kbGVyT2JqOwoKICAgICAg
        ICBpZiAoIXRhcmdldEhhbmRsZXJJbmZvcykgeyByZXR1cm4gZmFsc2U7IH0K
        CiAgICAgICAgdmFyIHJlY29nSGFuZGxlcnMgPSB0aGlzLnJlY29nbml6ZXIu
        aGFuZGxlcnNGb3IodGFyZ2V0SGFuZGxlckluZm9zW3RhcmdldEhhbmRsZXJJ
        bmZvcy5sZW5ndGggLSAxXS5uYW1lKTsKCiAgICAgICAgZm9yICh2YXIgaT10
        YXJnZXRIYW5kbGVySW5mb3MubGVuZ3RoLTE7IGk+PTA7IGktLSkgewogICAg
        ICAgICAgaGFuZGxlckluZm8gPSB0YXJnZXRIYW5kbGVySW5mb3NbaV07CiAg
        ICAgICAgICBpZiAoaGFuZGxlckluZm8ubmFtZSA9PT0gaGFuZGxlck5hbWUp
        IHsgZm91bmQgPSB0cnVlOyB9CgogICAgICAgICAgaWYgKGZvdW5kKSB7CiAg
        ICAgICAgICAgIGlmIChjb250ZXh0cy5sZW5ndGggPT09IDApIHsgYnJlYWs7
        IH0KCiAgICAgICAgICAgIGlmIChoYW5kbGVySW5mby5pc0R5bmFtaWMpIHsK
        ICAgICAgICAgICAgICBvYmplY3QgPSBjb250ZXh0cy5wb3AoKTsKCiAgICAg
        ICAgICAgICAgaWYgKGlzUGFyYW0ob2JqZWN0KSkgewogICAgICAgICAgICAg
        ICAgdmFyIHJlY29nSGFuZGxlciA9IHJlY29nSGFuZGxlcnNbaV0sIG5hbWUg
        PSByZWNvZ0hhbmRsZXIubmFtZXNbMF07CiAgICAgICAgICAgICAgICBpZiAo
        IiIgKyBvYmplY3QgIT09IHRoaXMuY3VycmVudFBhcmFtc1tuYW1lXSkgeyBy
        ZXR1cm4gZmFsc2U7IH0KICAgICAgICAgICAgICB9IGVsc2UgaWYgKGhhbmRs
        ZXJJbmZvLmNvbnRleHQgIT09IG9iamVjdCkgewogICAgICAgICAgICAgICAg
        cmV0dXJuIGZhbHNlOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQog
        ICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIGNvbnRleHRz
        Lmxlbmd0aCA9PT0gMCAmJiBmb3VuZDsKICAgICAgfSwKCiAgICAgIHRyaWdn
        ZXI6IGZ1bmN0aW9uKG5hbWUpIHsKICAgICAgICB2YXIgYXJncyA9IHNsaWNl
        LmNhbGwoYXJndW1lbnRzKTsKICAgICAgICB0cmlnZ2VyKHRoaXMsIHRoaXMu
        Y3VycmVudEhhbmRsZXJJbmZvcywgZmFsc2UsIGFyZ3MpOwogICAgICB9LAoK
        ICAgICAgLyoqCiAgICAgICAgSG9vayBwb2ludCBmb3IgbG9nZ2luZyB0cmFu
        c2l0aW9uIHN0YXR1cyB1cGRhdGVzLgoKICAgICAgICBAcGFyYW0ge1N0cmlu
        Z30gbWVzc2FnZSBUaGUgbWVzc2FnZSB0byBsb2cuCiAgICAgICovCiAgICAg
        IGxvZzogbnVsbAogICAgfTsKCiAgICAvKioKICAgICAgQHByaXZhdGUKCiAg
        ICAgIFVzZWQgaW50ZXJuYWxseSBmb3IgYm90aCBVUkwgYW5kIG5hbWVkIHRy
        YW5zaXRpb24gdG8gZGV0ZXJtaW5lCiAgICAgIGEgc2hhcmVkIHBpdm90IHBh
        cmVudCByb3V0ZSBhbmQgb3RoZXIgZGF0YSBuZWNlc3NhcnkgdG8gcGVyZm9y
        bQogICAgICBhIHRyYW5zaXRpb24uCiAgICAgKi8KICAgIGZ1bmN0aW9uIGdl
        dE1hdGNoUG9pbnQocm91dGVyLCBoYW5kbGVycywgb2JqZWN0cywgaW5wdXRQ
        YXJhbXMpIHsKCiAgICAgIHZhciBtYXRjaFBvaW50ID0gaGFuZGxlcnMubGVu
        Z3RoLAogICAgICAgICAgcHJvdmlkZWRNb2RlbHMgPSB7fSwgaSwKICAgICAg
        ICAgIGN1cnJlbnRIYW5kbGVySW5mb3MgPSByb3V0ZXIuY3VycmVudEhhbmRs
        ZXJJbmZvcyB8fCBbXSwKICAgICAgICAgIHBhcmFtcyA9IHt9LAogICAgICAg
        ICAgb2xkUGFyYW1zID0gcm91dGVyLmN1cnJlbnRQYXJhbXMgfHwge30sCiAg
        ICAgICAgICBhY3RpdmVUcmFuc2l0aW9uID0gcm91dGVyLmFjdGl2ZVRyYW5z
        aXRpb24sCiAgICAgICAgICBoYW5kbGVyUGFyYW1zID0ge30sCiAgICAgICAg
        ICBvYmo7CgogICAgICBvYmplY3RzID0gc2xpY2UuY2FsbChvYmplY3RzKTsK
        ICAgICAgbWVyZ2UocGFyYW1zLCBpbnB1dFBhcmFtcyk7CgogICAgICBmb3Ig
        KGkgPSBoYW5kbGVycy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkgewogICAg
        ICAgIHZhciBoYW5kbGVyT2JqID0gaGFuZGxlcnNbaV0sCiAgICAgICAgICAg
        IGhhbmRsZXJOYW1lID0gaGFuZGxlck9iai5oYW5kbGVyLAogICAgICAgICAg
        ICBvbGRIYW5kbGVySW5mbyA9IGN1cnJlbnRIYW5kbGVySW5mb3NbaV0sCiAg
        ICAgICAgICAgIGhhc0NoYW5nZWQgPSBmYWxzZTsKCiAgICAgICAgLy8gQ2hl
        Y2sgaWYgaGFuZGxlciBuYW1lcyBoYXZlIGNoYW5nZWQuCiAgICAgICAgaWYg
        KCFvbGRIYW5kbGVySW5mbyB8fCBvbGRIYW5kbGVySW5mby5uYW1lICE9PSBo
        YW5kbGVyT2JqLmhhbmRsZXIpIHsgaGFzQ2hhbmdlZCA9IHRydWU7IH0KCiAg
        ICAgICAgaWYgKGhhbmRsZXJPYmouaXNEeW5hbWljKSB7CiAgICAgICAgICAv
        LyBVUkwgdHJhbnNpdGlvbi4KCiAgICAgICAgICBpZiAob2JqID0gZ2V0TWF0
        Y2hQb2ludE9iamVjdChvYmplY3RzLCBoYW5kbGVyTmFtZSwgYWN0aXZlVHJh
        bnNpdGlvbiwgdHJ1ZSwgcGFyYW1zKSkgewogICAgICAgICAgICBoYXNDaGFu
        Z2VkID0gdHJ1ZTsKICAgICAgICAgICAgcHJvdmlkZWRNb2RlbHNbaGFuZGxl
        ck5hbWVdID0gb2JqOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAg
        aGFuZGxlclBhcmFtc1toYW5kbGVyTmFtZV0gPSB7fTsKICAgICAgICAgICAg
        Zm9yICh2YXIgcHJvcCBpbiBoYW5kbGVyT2JqLnBhcmFtcykgewogICAgICAg
        ICAgICAgIGlmICghaGFuZGxlck9iai5wYXJhbXMuaGFzT3duUHJvcGVydHko
        cHJvcCkpIHsgY29udGludWU7IH0KICAgICAgICAgICAgICB2YXIgbmV3UGFy
        YW0gPSBoYW5kbGVyT2JqLnBhcmFtc1twcm9wXTsKICAgICAgICAgICAgICBp
        ZiAob2xkUGFyYW1zW3Byb3BdICE9PSBuZXdQYXJhbSkgeyBoYXNDaGFuZ2Vk
        ID0gdHJ1ZTsgfQogICAgICAgICAgICAgIGhhbmRsZXJQYXJhbXNbaGFuZGxl
        ck5hbWVdW3Byb3BdID0gcGFyYW1zW3Byb3BdID0gbmV3UGFyYW07CiAgICAg
        ICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgaWYgKGhhbmRs
        ZXJPYmouaGFzT3duUHJvcGVydHkoJ25hbWVzJykpIHsKICAgICAgICAgIC8v
        IE5hbWVkIHRyYW5zaXRpb24uCgogICAgICAgICAgaWYgKG9iamVjdHMubGVu
        Z3RoKSB7IGhhc0NoYW5nZWQgPSB0cnVlOyB9CgogICAgICAgICAgaWYgKG9i
        aiA9IGdldE1hdGNoUG9pbnRPYmplY3Qob2JqZWN0cywgaGFuZGxlck5hbWUs
        IGFjdGl2ZVRyYW5zaXRpb24sIGhhbmRsZXJPYmoubmFtZXNbMF0sIHBhcmFt
        cykpIHsKICAgICAgICAgICAgcHJvdmlkZWRNb2RlbHNbaGFuZGxlck5hbWVd
        ID0gb2JqOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdmFyIG5h
        bWVzID0gaGFuZGxlck9iai5uYW1lczsKICAgICAgICAgICAgaGFuZGxlclBh
        cmFtc1toYW5kbGVyTmFtZV0gPSB7fTsKICAgICAgICAgICAgZm9yICh2YXIg
        aiA9IDAsIGxlbiA9IG5hbWVzLmxlbmd0aDsgaiA8IGxlbjsgKytqKSB7CiAg
        ICAgICAgICAgICAgdmFyIG5hbWUgPSBuYW1lc1tqXTsKICAgICAgICAgICAg
        ICBoYW5kbGVyUGFyYW1zW2hhbmRsZXJOYW1lXVtuYW1lXSA9IHBhcmFtc1tu
        YW1lXSA9IHBhcmFtc1tuYW1lXSB8fCBvbGRQYXJhbXNbbmFtZV07CiAgICAg
        ICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGlmICho
        YXNDaGFuZ2VkKSB7IG1hdGNoUG9pbnQgPSBpOyB9CiAgICAgIH0KCiAgICAg
        IGlmIChvYmplY3RzLmxlbmd0aCA+IDApIHsKICAgICAgICB0aHJvdyBuZXcg
        RXJyb3IoIk1vcmUgY29udGV4dCBvYmplY3RzIHdlcmUgcGFzc2VkIHRoYW4g
        dGhlcmUgYXJlIGR5bmFtaWMgc2VnbWVudHMgZm9yIHRoZSByb3V0ZTogIiAr
        IGhhbmRsZXJzW2hhbmRsZXJzLmxlbmd0aCAtIDFdLmhhbmRsZXIpOwogICAg
        ICB9CgogICAgICByZXR1cm4geyBtYXRjaFBvaW50OiBtYXRjaFBvaW50LCBw
        cm92aWRlZE1vZGVsczogcHJvdmlkZWRNb2RlbHMsIHBhcmFtczogcGFyYW1z
        LCBoYW5kbGVyUGFyYW1zOiBoYW5kbGVyUGFyYW1zIH07CiAgICB9CgogICAg
        ZnVuY3Rpb24gZ2V0TWF0Y2hQb2ludE9iamVjdChvYmplY3RzLCBoYW5kbGVy
        TmFtZSwgYWN0aXZlVHJhbnNpdGlvbiwgcGFyYW1OYW1lLCBwYXJhbXMpIHsK
        CiAgICAgIGlmIChvYmplY3RzLmxlbmd0aCAmJiBwYXJhbU5hbWUpIHsKCiAg
        ICAgICAgdmFyIG9iamVjdCA9IG9iamVjdHMucG9wKCk7CgogICAgICAgIC8v
        IElmIHByb3ZpZGVkIG9iamVjdCBpcyBzdHJpbmcgb3IgbnVtYmVyLCB0cmVh
        dCBhcyBwYXJhbS4KICAgICAgICBpZiAoaXNQYXJhbShvYmplY3QpKSB7CiAg
        ICAgICAgICBwYXJhbXNbcGFyYW1OYW1lXSA9IG9iamVjdC50b1N0cmluZygp
        OwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICByZXR1cm4gb2JqZWN0Owog
        ICAgICAgIH0KICAgICAgfSBlbHNlIGlmIChhY3RpdmVUcmFuc2l0aW9uKSB7
        CiAgICAgICAgLy8gVXNlIG1vZGVsIGZyb20gcHJldmlvdXMgdHJhbnNpdGlv
        biBhdHRlbXB0LCBwcmVmZXJhYmx5IHRoZSByZXNvbHZlZCBvbmUuCiAgICAg
        ICAgcmV0dXJuIGFjdGl2ZVRyYW5zaXRpb24ucmVzb2x2ZWRNb2RlbHNbaGFu
        ZGxlck5hbWVdIHx8CiAgICAgICAgICAgICAgIChwYXJhbU5hbWUgJiYgYWN0
        aXZlVHJhbnNpdGlvbi5wcm92aWRlZE1vZGVsc1toYW5kbGVyTmFtZV0pOwog
        ICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gaXNQYXJhbShvYmplY3QpIHsK
        ICAgICAgcmV0dXJuICh0eXBlb2Ygb2JqZWN0ID09PSAic3RyaW5nIiB8fCBv
        YmplY3QgaW5zdGFuY2VvZiBTdHJpbmcgfHwgIWlzTmFOKG9iamVjdCkpOwog
        ICAgfQoKICAgIC8qKgogICAgICBAcHJpdmF0ZQoKICAgICAgVGhpcyBtZXRo
        b2QgdGFrZXMgYSBoYW5kbGVyIG5hbWUgYW5kIGEgbGlzdCBvZiBjb250ZXh0
        cyBhbmQgcmV0dXJucwogICAgICBhIHNlcmlhbGl6ZWQgcGFyYW1ldGVyIGhh
        c2ggc3VpdGFibGUgdG8gcGFzcyB0byBgcmVjb2duaXplci5nZW5lcmF0ZSgp
        YC4KCiAgICAgIEBwYXJhbSB7Um91dGVyfSByb3V0ZXIKICAgICAgQHBhcmFt
        IHtTdHJpbmd9IGhhbmRsZXJOYW1lCiAgICAgIEBwYXJhbSB7QXJyYXlbT2Jq
        ZWN0XX0gb2JqZWN0cwogICAgICBAcmV0dXJuIHtPYmplY3R9IGEgc2VyaWFs
        aXplZCBwYXJhbWV0ZXIgaGFzaAogICAgKi8KICAgIGZ1bmN0aW9uIHBhcmFt
        c0ZvckhhbmRsZXIocm91dGVyLCBoYW5kbGVyTmFtZSwgb2JqZWN0cykgewoK
        ICAgICAgdmFyIGhhbmRsZXJzID0gcm91dGVyLnJlY29nbml6ZXIuaGFuZGxl
        cnNGb3IoaGFuZGxlck5hbWUpLAogICAgICAgICAgcGFyYW1zID0ge30sCiAg
        ICAgICAgICBtYXRjaFBvaW50ID0gZ2V0TWF0Y2hQb2ludChyb3V0ZXIsIGhh
        bmRsZXJzLCBvYmplY3RzKS5tYXRjaFBvaW50LAogICAgICAgICAgb2JqZWN0
        LCBoYW5kbGVyT2JqLCBoYW5kbGVyLCBuYW1lcywgaTsKCiAgICAgIGZvciAo
        aT0wOyBpPGhhbmRsZXJzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgaGFuZGxl
        ck9iaiA9IGhhbmRsZXJzW2ldOwogICAgICAgIGhhbmRsZXIgPSByb3V0ZXIu
        Z2V0SGFuZGxlcihoYW5kbGVyT2JqLmhhbmRsZXIpOwogICAgICAgIG5hbWVz
        ID0gaGFuZGxlck9iai5uYW1lczsKCiAgICAgICAgLy8gSWYgaXQncyBhIGR5
        bmFtaWMgc2VnbWVudAogICAgICAgIGlmIChuYW1lcy5sZW5ndGgpIHsKICAg
        ICAgICAgIC8vIElmIHdlIGhhdmUgb2JqZWN0cywgdXNlIHRoZW0KICAgICAg
        ICAgIGlmIChpID49IG1hdGNoUG9pbnQpIHsKICAgICAgICAgICAgb2JqZWN0
        ID0gb2JqZWN0cy5zaGlmdCgpOwogICAgICAgICAgLy8gT3RoZXJ3aXNlIHVz
        ZSBleGlzdGluZyBjb250ZXh0CiAgICAgICAgICB9IGVsc2UgewogICAgICAg
        ICAgICBvYmplY3QgPSBoYW5kbGVyLmNvbnRleHQ7CiAgICAgICAgICB9Cgog
        ICAgICAgICAgLy8gU2VyaWFsaXplIHRvIGdlbmVyYXRlIHBhcmFtcwogICAg
        ICAgICAgbWVyZ2UocGFyYW1zLCBzZXJpYWxpemUoaGFuZGxlciwgb2JqZWN0
        LCBuYW1lcykpOwogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gcGFy
        YW1zOwogICAgfQoKICAgIGZ1bmN0aW9uIG1lcmdlKGhhc2gsIG90aGVyKSB7
        CiAgICAgIGZvciAodmFyIHByb3AgaW4gb3RoZXIpIHsKICAgICAgICBpZiAo
        b3RoZXIuaGFzT3duUHJvcGVydHkocHJvcCkpIHsgaGFzaFtwcm9wXSA9IG90
        aGVyW3Byb3BdOyB9CiAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAgQHBy
        aXZhdGUKICAgICovCiAgICBmdW5jdGlvbiBjcmVhdGVOYW1lZFRyYW5zaXRp
        b24ocm91dGVyLCBhcmdzKSB7CiAgICAgIHZhciBoYW5kbGVycyA9IHJvdXRl
        ci5yZWNvZ25pemVyLmhhbmRsZXJzRm9yKGFyZ3NbMF0pOwoKICAgICAgbG9n
        KHJvdXRlciwgIkF0dGVtcHRpbmcgdHJhbnNpdGlvbiB0byAiICsgYXJnc1sw
        XSk7CgogICAgICByZXR1cm4gcGVyZm9ybVRyYW5zaXRpb24ocm91dGVyLCBo
        YW5kbGVycywgc2xpY2UuY2FsbChhcmdzLCAxKSwgcm91dGVyLmN1cnJlbnRQ
        YXJhbXMpOwogICAgfQoKICAgIC8qKgogICAgICBAcHJpdmF0ZQogICAgKi8K
        ICAgIGZ1bmN0aW9uIGNyZWF0ZVVSTFRyYW5zaXRpb24ocm91dGVyLCB1cmwp
        IHsKCiAgICAgIHZhciByZXN1bHRzID0gcm91dGVyLnJlY29nbml6ZXIucmVj
        b2duaXplKHVybCksCiAgICAgICAgICBjdXJyZW50SGFuZGxlckluZm9zID0g
        cm91dGVyLmN1cnJlbnRIYW5kbGVySW5mb3M7CgogICAgICBsb2cocm91dGVy
        LCAiQXR0ZW1wdGluZyBVUkwgdHJhbnNpdGlvbiB0byAiICsgdXJsKTsKCiAg
        ICAgIGlmICghcmVzdWx0cykgewogICAgICAgIHJldHVybiBlcnJvclRyYW5z
        aXRpb24ocm91dGVyLCBuZXcgUm91dGVyLlVucmVjb2duaXplZFVSTEVycm9y
        KHVybCkpOwogICAgICB9CgogICAgICByZXR1cm4gcGVyZm9ybVRyYW5zaXRp
        b24ocm91dGVyLCByZXN1bHRzLCBbXSwge30pOwogICAgfQoKCiAgICAvKioK
        ICAgICAgQHByaXZhdGUKCiAgICAgIFRha2VzIGFuIEFycmF5IG9mIGBIYW5k
        bGVySW5mb2BzLCBmaWd1cmVzIG91dCB3aGljaCBvbmVzIGFyZQogICAgICBl
        eGl0aW5nLCBlbnRlcmluZywgb3IgY2hhbmdpbmcgY29udGV4dHMsIGFuZCBj
        YWxscyB0aGUKICAgICAgcHJvcGVyIGhhbmRsZXIgaG9va3MuCgogICAgICBG
        b3IgZXhhbXBsZSwgY29uc2lkZXIgdGhlIGZvbGxvd2luZyB0cmVlIG9mIGhh
        bmRsZXJzLiBFYWNoIGhhbmRsZXIgaXMKICAgICAgZm9sbG93ZWQgYnkgdGhl
        IFVSTCBzZWdtZW50IGl0IGhhbmRsZXMuCgogICAgICBgYGAKICAgICAgfH5p
        bmRleCAoIi8iKQogICAgICB8IHx+cG9zdHMgKCIvcG9zdHMiKQogICAgICB8
        IHwgfC1zaG93UG9zdCAoIi86aWQiKQogICAgICB8IHwgfC1uZXdQb3N0ICgi
        L25ldyIpCiAgICAgIHwgfCB8LWVkaXRQb3N0ICgiL2VkaXQiKQogICAgICB8
        IHx+YWJvdXQgKCIvYWJvdXQvOmlkIikKICAgICAgYGBgCgogICAgICBDb25z
        aWRlciB0aGUgZm9sbG93aW5nIHRyYW5zaXRpb25zOgoKICAgICAgMS4gQSBV
        UkwgdHJhbnNpdGlvbiB0byBgL3Bvc3RzLzFgLgogICAgICAgICAxLiBUcmln
        Z2VycyB0aGUgYCptb2RlbGAgY2FsbGJhY2tzIG9uIHRoZQogICAgICAgICAg
        ICBgaW5kZXhgLCBgcG9zdHNgLCBhbmQgYHNob3dQb3N0YCBoYW5kbGVycwog
        ICAgICAgICAyLiBUcmlnZ2VycyB0aGUgYGVudGVyYCBjYWxsYmFjayBvbiB0
        aGUgc2FtZQogICAgICAgICAzLiBUcmlnZ2VycyB0aGUgYHNldHVwYCBjYWxs
        YmFjayBvbiB0aGUgc2FtZQogICAgICAyLiBBIGRpcmVjdCB0cmFuc2l0aW9u
        IHRvIGBuZXdQb3N0YAogICAgICAgICAxLiBUcmlnZ2VycyB0aGUgYGV4aXRg
        IGNhbGxiYWNrIG9uIGBzaG93UG9zdGAKICAgICAgICAgMi4gVHJpZ2dlcnMg
        dGhlIGBlbnRlcmAgY2FsbGJhY2sgb24gYG5ld1Bvc3RgCiAgICAgICAgIDMu
        IFRyaWdnZXJzIHRoZSBgc2V0dXBgIGNhbGxiYWNrIG9uIGBuZXdQb3N0YAog
        ICAgICAzLiBBIGRpcmVjdCB0cmFuc2l0aW9uIHRvIGBhYm91dGAgd2l0aCBh
        IHNwZWNpZmllZAogICAgICAgICBjb250ZXh0IG9iamVjdAogICAgICAgICAx
        LiBUcmlnZ2VycyB0aGUgYGV4aXRgIGNhbGxiYWNrIG9uIGBuZXdQb3N0YAog
        ICAgICAgICAgICBhbmQgYHBvc3RzYAogICAgICAgICAyLiBUcmlnZ2VycyB0
        aGUgYHNlcmlhbGl6ZWAgY2FsbGJhY2sgb24gYGFib3V0YAogICAgICAgICAz
        LiBUcmlnZ2VycyB0aGUgYGVudGVyYCBjYWxsYmFjayBvbiBgYWJvdXRgCiAg
        ICAgICAgIDQuIFRyaWdnZXJzIHRoZSBgc2V0dXBgIGNhbGxiYWNrIG9uIGBh
        Ym91dGAKCiAgICAgIEBwYXJhbSB7VHJhbnNpdGlvbn0gdHJhbnNpdGlvbgog
        ICAgICBAcGFyYW0ge0FycmF5W0hhbmRsZXJJbmZvXX0gaGFuZGxlckluZm9z
        CiAgICAqLwogICAgZnVuY3Rpb24gc2V0dXBDb250ZXh0cyh0cmFuc2l0aW9u
        LCBoYW5kbGVySW5mb3MpIHsKICAgICAgdmFyIHJvdXRlciA9IHRyYW5zaXRp
        b24ucm91dGVyLAogICAgICAgICAgcGFydGl0aW9uID0gcGFydGl0aW9uSGFu
        ZGxlcnMocm91dGVyLmN1cnJlbnRIYW5kbGVySW5mb3MgfHwgW10sIGhhbmRs
        ZXJJbmZvcyk7CgogICAgICByb3V0ZXIudGFyZ2V0SGFuZGxlckluZm9zID0g
        aGFuZGxlckluZm9zOwoKICAgICAgZWFjaEhhbmRsZXIocGFydGl0aW9uLmV4
        aXRlZCwgZnVuY3Rpb24oaGFuZGxlckluZm8pIHsKICAgICAgICB2YXIgaGFu
        ZGxlciA9IGhhbmRsZXJJbmZvLmhhbmRsZXI7CiAgICAgICAgZGVsZXRlIGhh
        bmRsZXIuY29udGV4dDsKICAgICAgICBpZiAoaGFuZGxlci5leGl0KSB7IGhh
        bmRsZXIuZXhpdCgpOyB9CiAgICAgIH0pOwoKICAgICAgdmFyIGN1cnJlbnRI
        YW5kbGVySW5mb3MgPSBwYXJ0aXRpb24udW5jaGFuZ2VkLnNsaWNlKCk7CiAg
        ICAgIHJvdXRlci5jdXJyZW50SGFuZGxlckluZm9zID0gY3VycmVudEhhbmRs
        ZXJJbmZvczsKCiAgICAgIGVhY2hIYW5kbGVyKHBhcnRpdGlvbi51cGRhdGVk
        Q29udGV4dCwgZnVuY3Rpb24oaGFuZGxlckluZm8pIHsKICAgICAgICBoYW5k
        bGVyRW50ZXJlZE9yVXBkYXRlZCh0cmFuc2l0aW9uLCBjdXJyZW50SGFuZGxl
        ckluZm9zLCBoYW5kbGVySW5mbywgZmFsc2UpOwogICAgICB9KTsKCiAgICAg
        IGVhY2hIYW5kbGVyKHBhcnRpdGlvbi5lbnRlcmVkLCBmdW5jdGlvbihoYW5k
        bGVySW5mbykgewogICAgICAgIGhhbmRsZXJFbnRlcmVkT3JVcGRhdGVkKHRy
        YW5zaXRpb24sIGN1cnJlbnRIYW5kbGVySW5mb3MsIGhhbmRsZXJJbmZvLCB0
        cnVlKTsKICAgICAgfSk7CiAgICB9CgogICAgLyoqCiAgICAgIEBwcml2YXRl
        CgogICAgICBIZWxwZXIgbWV0aG9kIHVzZWQgYnkgc2V0dXBDb250ZXh0cy4g
        SGFuZGxlcyBlcnJvcnMgb3IgcmVkaXJlY3RzCiAgICAgIHRoYXQgbWF5IGhh
        cHBlbiBpbiBlbnRlci9zZXR1cC4KICAgICovCiAgICBmdW5jdGlvbiBoYW5k
        bGVyRW50ZXJlZE9yVXBkYXRlZCh0cmFuc2l0aW9uLCBjdXJyZW50SGFuZGxl
        ckluZm9zLCBoYW5kbGVySW5mbywgZW50ZXIpIHsKICAgICAgdmFyIGhhbmRs
        ZXIgPSBoYW5kbGVySW5mby5oYW5kbGVyLAogICAgICAgICAgY29udGV4dCA9
        IGhhbmRsZXJJbmZvLmNvbnRleHQ7CgogICAgICB0cnkgewogICAgICAgIGlm
        IChlbnRlciAmJiBoYW5kbGVyLmVudGVyKSB7IGhhbmRsZXIuZW50ZXIoKTsg
        fQogICAgICAgIGNoZWNrQWJvcnQodHJhbnNpdGlvbik7CgogICAgICAgIHNl
        dENvbnRleHQoaGFuZGxlciwgY29udGV4dCk7CgogICAgICAgIGlmIChoYW5k
        bGVyLnNldHVwKSB7IGhhbmRsZXIuc2V0dXAoY29udGV4dCk7IH0KICAgICAg
        ICBjaGVja0Fib3J0KHRyYW5zaXRpb24pOwogICAgICB9IGNhdGNoKGUpIHsK
        ICAgICAgICBpZiAoIShlIGluc3RhbmNlb2YgUm91dGVyLlRyYW5zaXRpb25B
        Ym9ydGVkKSkgewogICAgICAgICAgLy8gVHJpZ2dlciB0aGUgYGVycm9yYCBl
        dmVudCBzdGFydGluZyBmcm9tIHRoaXMgZmFpbGVkIGhhbmRsZXIuCiAgICAg
        ICAgICB0cmlnZ2VyKHRyYW5zaXRpb24ucm91dGVyLCBjdXJyZW50SGFuZGxl
        ckluZm9zLmNvbmNhdChoYW5kbGVySW5mbyksIHRydWUsIFsnZXJyb3InLCBl
        LCB0cmFuc2l0aW9uXSk7CiAgICAgICAgfQoKICAgICAgICAvLyBQcm9wYWdh
        dGUgdGhlIGVycm9yIHNvIHRoYXQgdGhlIHRyYW5zaXRpb24gcHJvbWlzZSB3
        aWxsIHJlamVjdC4KICAgICAgICB0aHJvdyBlOwogICAgICB9CgogICAgICBj
        dXJyZW50SGFuZGxlckluZm9zLnB1c2goaGFuZGxlckluZm8pOwogICAgfQoK
        CiAgICAvKioKICAgICAgQHByaXZhdGUKCiAgICAgIEl0ZXJhdGVzIG92ZXIg
        YW4gYXJyYXkgb2YgYEhhbmRsZXJJbmZvYHMsIHBhc3NpbmcgdGhlIGhhbmRs
        ZXIKICAgICAgYW5kIGNvbnRleHQgaW50byB0aGUgY2FsbGJhY2suCgogICAg
        ICBAcGFyYW0ge0FycmF5W0hhbmRsZXJJbmZvXX0gaGFuZGxlckluZm9zCiAg
        ICAgIEBwYXJhbSB7RnVuY3Rpb24oT2JqZWN0LCBPYmplY3QpfSBjYWxsYmFj
        awogICAgKi8KICAgIGZ1bmN0aW9uIGVhY2hIYW5kbGVyKGhhbmRsZXJJbmZv
        cywgY2FsbGJhY2spIHsKICAgICAgZm9yICh2YXIgaT0wLCBsPWhhbmRsZXJJ
        bmZvcy5sZW5ndGg7IGk8bDsgaSsrKSB7CiAgICAgICAgY2FsbGJhY2soaGFu
        ZGxlckluZm9zW2ldKTsKICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICBA
        cHJpdmF0ZQoKICAgICAgVGhpcyBmdW5jdGlvbiBpcyBjYWxsZWQgd2hlbiB0
        cmFuc2l0aW9uaW5nIGZyb20gb25lIFVSTCB0bwogICAgICBhbm90aGVyIHRv
        IGRldGVybWluZSB3aGljaCBoYW5kbGVycyBhcmUgbm90IGxvbmdlciBhY3Rp
        dmUsCiAgICAgIHdoaWNoIGhhbmRsZXJzIGFyZSBuZXdseSBhY3RpdmUsIGFu
        ZCB3aGljaCBoYW5kbGVycyByZW1haW4KICAgICAgYWN0aXZlIGJ1dCBoYXZl
        IHRoZWlyIGNvbnRleHQgY2hhbmdlZC4KCiAgICAgIFRha2UgYSBsaXN0IG9m
        IG9sZCBoYW5kbGVycyBhbmQgbmV3IGhhbmRsZXJzIGFuZCBwYXJ0aXRpb24K
        ICAgICAgdGhlbSBpbnRvIGZvdXIgYnVja2V0czoKCiAgICAgICogdW5jaGFu
        Z2VkOiB0aGUgaGFuZGxlciB3YXMgYWN0aXZlIGluIGJvdGggdGhlIG9sZCBh
        bmQKICAgICAgICBuZXcgVVJMLCBhbmQgaXRzIGNvbnRleHQgcmVtYWlucyB0
        aGUgc2FtZQogICAgICAqIHVwZGF0ZWQgY29udGV4dDogdGhlIGhhbmRsZXIg
        d2FzIGFjdGl2ZSBpbiBib3RoIHRoZQogICAgICAgIG9sZCBhbmQgbmV3IFVS
        TCwgYnV0IGl0cyBjb250ZXh0IGNoYW5nZWQuIFRoZSBoYW5kbGVyJ3MKICAg
        ICAgICBgc2V0dXBgIG1ldGhvZCwgaWYgYW55LCB3aWxsIGJlIGNhbGxlZCB3
        aXRoIHRoZSBuZXcKICAgICAgICBjb250ZXh0LgogICAgICAqIGV4aXRlZDog
        dGhlIGhhbmRsZXIgd2FzIGFjdGl2ZSBpbiB0aGUgb2xkIFVSTCwgYnV0IGlz
        CiAgICAgICAgbm8gbG9uZ2VyIGFjdGl2ZS4KICAgICAgKiBlbnRlcmVkOiB0
        aGUgaGFuZGxlciB3YXMgbm90IGFjdGl2ZSBpbiB0aGUgb2xkIFVSTCwgYnV0
        CiAgICAgICAgaXMgbm93IGFjdGl2ZS4KCiAgICAgIFRoZSBQYXJ0aXRpb25l
        ZEhhbmRsZXJzIHN0cnVjdHVyZSBoYXMgZm91ciBmaWVsZHM6CgogICAgICAq
        IGB1cGRhdGVkQ29udGV4dGA6IGEgbGlzdCBvZiBgSGFuZGxlckluZm9gIG9i
        amVjdHMgdGhhdAogICAgICAgIHJlcHJlc2VudCBoYW5kbGVycyB0aGF0IHJl
        bWFpbiBhY3RpdmUgYnV0IGhhdmUgYSBjaGFuZ2VkCiAgICAgICAgY29udGV4
        dAogICAgICAqIGBlbnRlcmVkYDogYSBsaXN0IG9mIGBIYW5kbGVySW5mb2Ag
        b2JqZWN0cyB0aGF0IHJlcHJlc2VudAogICAgICAgIGhhbmRsZXJzIHRoYXQg
        YXJlIG5ld2x5IGFjdGl2ZQogICAgICAqIGBleGl0ZWRgOiBhIGxpc3Qgb2Yg
        YEhhbmRsZXJJbmZvYCBvYmplY3RzIHRoYXQgYXJlIG5vCiAgICAgICAgbG9u
        Z2VyIGFjdGl2ZS4KICAgICAgKiBgdW5jaGFuZ2VkYDogYSBsaXN0IG9mIGBI
        YW5kZXJJbmZvYCBvYmplY3RzIHRoYXQgcmVtYWluIGFjdGl2ZS4KCiAgICAg
        IEBwYXJhbSB7QXJyYXlbSGFuZGxlckluZm9dfSBvbGRIYW5kbGVycyBhIGxp
        c3Qgb2YgdGhlIGhhbmRsZXIKICAgICAgICBpbmZvcm1hdGlvbiBmb3IgdGhl
        IHByZXZpb3VzIFVSTCAob3IgYFtdYCBpZiB0aGlzIGlzIHRoZQogICAgICAg
        IGZpcnN0IGhhbmRsZWQgdHJhbnNpdGlvbikKICAgICAgQHBhcmFtIHtBcnJh
        eVtIYW5kbGVySW5mb119IG5ld0hhbmRsZXJzIGEgbGlzdCBvZiB0aGUgaGFu
        ZGxlcgogICAgICAgIGluZm9ybWF0aW9uIGZvciB0aGUgbmV3IFVSTAoKICAg
        ICAgQHJldHVybiB7UGFydGl0aW9ufQogICAgKi8KICAgIGZ1bmN0aW9uIHBh
        cnRpdGlvbkhhbmRsZXJzKG9sZEhhbmRsZXJzLCBuZXdIYW5kbGVycykgewog
        ICAgICB2YXIgaGFuZGxlcnMgPSB7CiAgICAgICAgICAgIHVwZGF0ZWRDb250
        ZXh0OiBbXSwKICAgICAgICAgICAgZXhpdGVkOiBbXSwKICAgICAgICAgICAg
        ZW50ZXJlZDogW10sCiAgICAgICAgICAgIHVuY2hhbmdlZDogW10KICAgICAg
        ICAgIH07CgogICAgICB2YXIgaGFuZGxlckNoYW5nZWQsIGNvbnRleHRDaGFu
        Z2VkLCBpLCBsOwoKICAgICAgZm9yIChpPTAsIGw9bmV3SGFuZGxlcnMubGVu
        Z3RoOyBpPGw7IGkrKykgewogICAgICAgIHZhciBvbGRIYW5kbGVyID0gb2xk
        SGFuZGxlcnNbaV0sIG5ld0hhbmRsZXIgPSBuZXdIYW5kbGVyc1tpXTsKCiAg
        ICAgICAgaWYgKCFvbGRIYW5kbGVyIHx8IG9sZEhhbmRsZXIuaGFuZGxlciAh
        PT0gbmV3SGFuZGxlci5oYW5kbGVyKSB7CiAgICAgICAgICBoYW5kbGVyQ2hh
        bmdlZCA9IHRydWU7CiAgICAgICAgfQoKICAgICAgICBpZiAoaGFuZGxlckNo
        YW5nZWQpIHsKICAgICAgICAgIGhhbmRsZXJzLmVudGVyZWQucHVzaChuZXdI
        YW5kbGVyKTsKICAgICAgICAgIGlmIChvbGRIYW5kbGVyKSB7IGhhbmRsZXJz
        LmV4aXRlZC51bnNoaWZ0KG9sZEhhbmRsZXIpOyB9CiAgICAgICAgfSBlbHNl
        IGlmIChjb250ZXh0Q2hhbmdlZCB8fCBvbGRIYW5kbGVyLmNvbnRleHQgIT09
        IG5ld0hhbmRsZXIuY29udGV4dCkgewogICAgICAgICAgY29udGV4dENoYW5n
        ZWQgPSB0cnVlOwogICAgICAgICAgaGFuZGxlcnMudXBkYXRlZENvbnRleHQu
        cHVzaChuZXdIYW5kbGVyKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAg
        aGFuZGxlcnMudW5jaGFuZ2VkLnB1c2gob2xkSGFuZGxlcik7CiAgICAgICAg
        fQogICAgICB9CgogICAgICBmb3IgKGk9bmV3SGFuZGxlcnMubGVuZ3RoLCBs
        PW9sZEhhbmRsZXJzLmxlbmd0aDsgaTxsOyBpKyspIHsKICAgICAgICBoYW5k
        bGVycy5leGl0ZWQudW5zaGlmdChvbGRIYW5kbGVyc1tpXSk7CiAgICAgIH0K
        CiAgICAgIHJldHVybiBoYW5kbGVyczsKICAgIH0KCiAgICBmdW5jdGlvbiB0
        cmlnZ2VyKHJvdXRlciwgaGFuZGxlckluZm9zLCBpZ25vcmVGYWlsdXJlLCBh
        cmdzKSB7CiAgICAgIGlmIChyb3V0ZXIudHJpZ2dlckV2ZW50KSB7CiAgICAg
        ICAgcm91dGVyLnRyaWdnZXJFdmVudChoYW5kbGVySW5mb3MsIGlnbm9yZUZh
        aWx1cmUsIGFyZ3MpOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAg
        dmFyIG5hbWUgPSBhcmdzLnNoaWZ0KCk7CgogICAgICBpZiAoIWhhbmRsZXJJ
        bmZvcykgewogICAgICAgIGlmIChpZ25vcmVGYWlsdXJlKSB7IHJldHVybjsg
        fQogICAgICAgIHRocm93IG5ldyBFcnJvcigiQ291bGQgbm90IHRyaWdnZXIg
        ZXZlbnQgJyIgKyBuYW1lICsgIicuIFRoZXJlIGFyZSBubyBhY3RpdmUgaGFu
        ZGxlcnMiKTsKICAgICAgfQoKICAgICAgdmFyIGV2ZW50V2FzSGFuZGxlZCA9
        IGZhbHNlOwoKICAgICAgZm9yICh2YXIgaT1oYW5kbGVySW5mb3MubGVuZ3Ro
        LTE7IGk+PTA7IGktLSkgewogICAgICAgIHZhciBoYW5kbGVySW5mbyA9IGhh
        bmRsZXJJbmZvc1tpXSwKICAgICAgICAgICAgaGFuZGxlciA9IGhhbmRsZXJJ
        bmZvLmhhbmRsZXI7CgogICAgICAgIGlmIChoYW5kbGVyLmV2ZW50cyAmJiBo
        YW5kbGVyLmV2ZW50c1tuYW1lXSkgewogICAgICAgICAgaWYgKGhhbmRsZXIu
        ZXZlbnRzW25hbWVdLmFwcGx5KGhhbmRsZXIsIGFyZ3MpID09PSB0cnVlKSB7
        CiAgICAgICAgICAgIGV2ZW50V2FzSGFuZGxlZCA9IHRydWU7CiAgICAgICAg
        ICB9IGVsc2UgewogICAgICAgICAgICByZXR1cm47CiAgICAgICAgICB9CiAg
        ICAgICAgfQogICAgICB9CgogICAgICBpZiAoIWV2ZW50V2FzSGFuZGxlZCAm
        JiAhaWdub3JlRmFpbHVyZSkgewogICAgICAgIHRocm93IG5ldyBFcnJvcigi
        Tm90aGluZyBoYW5kbGVkIHRoZSBldmVudCAnIiArIG5hbWUgKyAiJy4iKTsK
        ICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIHNldENvbnRleHQoaGFuZGxl
        ciwgY29udGV4dCkgewogICAgICBoYW5kbGVyLmNvbnRleHQgPSBjb250ZXh0
        OwogICAgICBpZiAoaGFuZGxlci5jb250ZXh0RGlkQ2hhbmdlKSB7IGhhbmRs
        ZXIuY29udGV4dERpZENoYW5nZSgpOyB9CiAgICB9CgogICAgLyoqCiAgICAg
        IEBwcml2YXRlCgogICAgICBDcmVhdGVzLCBiZWdpbnMsIGFuZCByZXR1cm5z
        IGEgVHJhbnNpdGlvbi4KICAgICAqLwogICAgZnVuY3Rpb24gcGVyZm9ybVRy
        YW5zaXRpb24ocm91dGVyLCByZWNvZ0hhbmRsZXJzLCBwcm92aWRlZE1vZGVs
        c0FycmF5LCBwYXJhbXMsIGRhdGEpIHsKCiAgICAgIHZhciBtYXRjaFBvaW50
        UmVzdWx0cyA9IGdldE1hdGNoUG9pbnQocm91dGVyLCByZWNvZ0hhbmRsZXJz
        LCBwcm92aWRlZE1vZGVsc0FycmF5LCBwYXJhbXMpLAogICAgICAgICAgdGFy
        Z2V0TmFtZSA9IHJlY29nSGFuZGxlcnNbcmVjb2dIYW5kbGVycy5sZW5ndGgg
        LSAxXS5oYW5kbGVyLAogICAgICAgICAgd2FzVHJhbnNpdGlvbmluZyA9IGZh
        bHNlLAogICAgICAgICAgY3VycmVudEhhbmRsZXJJbmZvcyA9IHJvdXRlci5j
        dXJyZW50SGFuZGxlckluZm9zOwoKICAgICAgLy8gQ2hlY2sgaWYgdGhlcmUn
        cyBhbHJlYWR5IGEgdHJhbnNpdGlvbiB1bmRlcndheS4KICAgICAgaWYgKHJv
        dXRlci5hY3RpdmVUcmFuc2l0aW9uKSB7CiAgICAgICAgaWYgKHRyYW5zaXRp
        b25zSWRlbnRpY2FsKHJvdXRlci5hY3RpdmVUcmFuc2l0aW9uLCB0YXJnZXRO
        YW1lLCBwcm92aWRlZE1vZGVsc0FycmF5KSkgewogICAgICAgICAgcmV0dXJu
        IHJvdXRlci5hY3RpdmVUcmFuc2l0aW9uOwogICAgICAgIH0KICAgICAgICBy
        b3V0ZXIuYWN0aXZlVHJhbnNpdGlvbi5hYm9ydCgpOwogICAgICAgIHdhc1Ry
        YW5zaXRpb25pbmcgPSB0cnVlOwogICAgICB9CgogICAgICB2YXIgZGVmZXJy
        ZWQgPSBSU1ZQLmRlZmVyKCksCiAgICAgICAgICB0cmFuc2l0aW9uID0gbmV3
        IFRyYW5zaXRpb24ocm91dGVyLCBkZWZlcnJlZC5wcm9taXNlKTsKCiAgICAg
        IHRyYW5zaXRpb24udGFyZ2V0TmFtZSA9IHRhcmdldE5hbWU7CiAgICAgIHRy
        YW5zaXRpb24ucHJvdmlkZWRNb2RlbHMgPSBtYXRjaFBvaW50UmVzdWx0cy5w
        cm92aWRlZE1vZGVsczsKICAgICAgdHJhbnNpdGlvbi5wcm92aWRlZE1vZGVs
        c0FycmF5ID0gcHJvdmlkZWRNb2RlbHNBcnJheTsKICAgICAgdHJhbnNpdGlv
        bi5wYXJhbXMgPSBtYXRjaFBvaW50UmVzdWx0cy5wYXJhbXM7CiAgICAgIHRy
        YW5zaXRpb24uZGF0YSA9IGRhdGEgfHwge307CiAgICAgIHJvdXRlci5hY3Rp
        dmVUcmFuc2l0aW9uID0gdHJhbnNpdGlvbjsKCiAgICAgIHZhciBoYW5kbGVy
        SW5mb3MgPSBnZW5lcmF0ZUhhbmRsZXJJbmZvcyhyb3V0ZXIsIHJlY29nSGFu
        ZGxlcnMpOwoKICAgICAgLy8gRmlyZSAnd2lsbFRyYW5zaXRpb24nIGV2ZW50
        IG9uIGN1cnJlbnQgaGFuZGxlcnMsIGJ1dCBkb24ndCBmaXJlIGl0CiAgICAg
        IC8vIGlmIGEgdHJhbnNpdGlvbiB3YXMgYWxyZWFkeSB1bmRlcndheS4KICAg
        ICAgaWYgKCF3YXNUcmFuc2l0aW9uaW5nKSB7CiAgICAgICAgdHJpZ2dlcihy
        b3V0ZXIsIGN1cnJlbnRIYW5kbGVySW5mb3MsIHRydWUsIFsnd2lsbFRyYW5z
        aXRpb24nLCB0cmFuc2l0aW9uXSk7CiAgICAgIH0KCiAgICAgIGxvZyhyb3V0
        ZXIsIHRyYW5zaXRpb24uc2VxdWVuY2UsICJCZWdpbm5pbmcgdmFsaWRhdGlv
        biBmb3IgdHJhbnNpdGlvbiB0byAiICsgdHJhbnNpdGlvbi50YXJnZXROYW1l
        KTsKICAgICAgdmFsaWRhdGVFbnRyeSh0cmFuc2l0aW9uLCBoYW5kbGVySW5m
        b3MsIDAsIG1hdGNoUG9pbnRSZXN1bHRzLm1hdGNoUG9pbnQsIG1hdGNoUG9p
        bnRSZXN1bHRzLmhhbmRsZXJQYXJhbXMpCiAgICAgICAgICAgICAgICAgICAu
        dGhlbih0cmFuc2l0aW9uU3VjY2VzcywgdHJhbnNpdGlvbkZhaWx1cmUpOwoK
        ICAgICAgcmV0dXJuIHRyYW5zaXRpb247CgogICAgICBmdW5jdGlvbiB0cmFu
        c2l0aW9uU3VjY2VzcygpIHsKICAgICAgICBjaGVja0Fib3J0KHRyYW5zaXRp
        b24pOwoKICAgICAgICB0cnkgewogICAgICAgICAgbG9nKHJvdXRlciwgdHJh
        bnNpdGlvbi5zZXF1ZW5jZSwgIlZhbGlkYXRpb24gc3VjY2VlZGVkLCBmaW5h
        bGl6aW5nIHRyYW5zaXRpb247Iik7CgogICAgICAgICAgLy8gRG9uJ3Qgb3Zl
        cndyaXRlIGNvbnRleHRzIC8gdXBkYXRlIFVSTCBpZiB0aGlzIHdhcyBhIG5v
        b3AgdHJhbnNpdGlvbi4KICAgICAgICAgIGlmICghY3VycmVudEhhbmRsZXJJ
        bmZvcyB8fCAhY3VycmVudEhhbmRsZXJJbmZvcy5sZW5ndGggfHwKICAgICAg
        ICAgICAgICAhcm91dGVyLnJlY29nbml6ZXIuaGFzUm91dGUoY3VycmVudEhh
        bmRsZXJJbmZvc1tjdXJyZW50SGFuZGxlckluZm9zLmxlbmd0aCAtIDFdLm5h
        bWUpIHx8CiAgICAgICAgICAgICAgY3VycmVudEhhbmRsZXJJbmZvcy5sZW5n
        dGggIT09IG1hdGNoUG9pbnRSZXN1bHRzLm1hdGNoUG9pbnQpIHsKICAgICAg
        ICAgICAgZmluYWxpemVUcmFuc2l0aW9uKHRyYW5zaXRpb24sIGhhbmRsZXJJ
        bmZvcyk7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKHJvdXRlci5kaWRU
        cmFuc2l0aW9uKSB7CiAgICAgICAgICAgIHJvdXRlci5kaWRUcmFuc2l0aW9u
        KGhhbmRsZXJJbmZvcyk7CiAgICAgICAgICB9CgogICAgICAgICAgbG9nKHJv
        dXRlciwgdHJhbnNpdGlvbi5zZXF1ZW5jZSwgIlRSQU5TSVRJT04gQ09NUExF
        VEUuIik7CgogICAgICAgICAgLy8gUmVzb2x2ZSB3aXRoIHRoZSBmaW5hbCBo
        YW5kbGVyLgogICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShoYW5kbGVySW5m
        b3NbaGFuZGxlckluZm9zLmxlbmd0aCAtIDFdLmhhbmRsZXIpOwogICAgICAg
        IH0gY2F0Y2goZSkgewogICAgICAgICAgZGVmZXJyZWQucmVqZWN0KGUpOwog
        ICAgICAgIH0KCiAgICAgICAgLy8gRG9uJ3QgbnVsbGlmeSBpZiBhbm90aGVy
        IHRyYW5zaXRpb24gaXMgdW5kZXJ3YXkgKG1lYW5pbmcKICAgICAgICAvLyB0
        aGVyZSB3YXMgYSB0cmFuc2l0aW9uIGluaXRpYXRlZCB3aXRoIGVudGVyL3Nl
        dHVwKS4KICAgICAgICBpZiAoIXRyYW5zaXRpb24uaXNBYm9ydGVkKSB7CiAg
        ICAgICAgICByb3V0ZXIuYWN0aXZlVHJhbnNpdGlvbiA9IG51bGw7CiAgICAg
        ICAgfQogICAgICB9CgogICAgICBmdW5jdGlvbiB0cmFuc2l0aW9uRmFpbHVy
        ZShyZWFzb24pIHsKICAgICAgICBkZWZlcnJlZC5yZWplY3QocmVhc29uKTsK
        ICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICBAcHJpdmF0ZQoKICAgICAg
        QWNjZXB0cyBoYW5kbGVycyBpbiBSZWNvZ25pemVyIGZvcm1hdCwgZWl0aGVy
        IHJldHVybmVkIGZyb20KICAgICAgcmVjb2duaXplKCkgb3IgaGFuZGxlcnNG
        b3IoKSwgYW5kIHJldHVybnMgdW5pZmllZAogICAgICBgSGFuZGxlckluZm9g
        cy4KICAgICAqLwogICAgZnVuY3Rpb24gZ2VuZXJhdGVIYW5kbGVySW5mb3Mo
        cm91dGVyLCByZWNvZ0hhbmRsZXJzKSB7CiAgICAgIHZhciBoYW5kbGVySW5m
        b3MgPSBbXTsKICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IHJlY29nSGFu
        ZGxlcnMubGVuZ3RoOyBpIDwgbGVuOyArK2kpIHsKICAgICAgICB2YXIgaGFu
        ZGxlck9iaiA9IHJlY29nSGFuZGxlcnNbaV0sCiAgICAgICAgICAgIGlzRHlu
        YW1pYyA9IGhhbmRsZXJPYmouaXNEeW5hbWljIHx8IChoYW5kbGVyT2JqLm5h
        bWVzICYmIGhhbmRsZXJPYmoubmFtZXMubGVuZ3RoKTsKCiAgICAgICAgaGFu
        ZGxlckluZm9zLnB1c2goewogICAgICAgICAgaXNEeW5hbWljOiAhIWlzRHlu
        YW1pYywKICAgICAgICAgIG5hbWU6IGhhbmRsZXJPYmouaGFuZGxlciwKICAg
        ICAgICAgIGhhbmRsZXI6IHJvdXRlci5nZXRIYW5kbGVyKGhhbmRsZXJPYmou
        aGFuZGxlcikKICAgICAgICB9KTsKICAgICAgfQogICAgICByZXR1cm4gaGFu
        ZGxlckluZm9zOwogICAgfQoKICAgIC8qKgogICAgICBAcHJpdmF0ZQogICAg
        ICovCiAgICBmdW5jdGlvbiB0cmFuc2l0aW9uc0lkZW50aWNhbChvbGRUcmFu
        c2l0aW9uLCB0YXJnZXROYW1lLCBwcm92aWRlZE1vZGVsc0FycmF5KSB7Cgog
        ICAgICBpZiAob2xkVHJhbnNpdGlvbi50YXJnZXROYW1lICE9PSB0YXJnZXRO
        YW1lKSB7IHJldHVybiBmYWxzZTsgfQoKICAgICAgdmFyIG9sZE1vZGVscyA9
        IG9sZFRyYW5zaXRpb24ucHJvdmlkZWRNb2RlbHNBcnJheTsKICAgICAgaWYg
        KG9sZE1vZGVscy5sZW5ndGggIT09IHByb3ZpZGVkTW9kZWxzQXJyYXkubGVu
        Z3RoKSB7IHJldHVybiBmYWxzZTsgfQoKICAgICAgZm9yICh2YXIgaSA9IDAs
        IGxlbiA9IG9sZE1vZGVscy5sZW5ndGg7IGkgPCBsZW47ICsraSkgewogICAg
        ICAgIGlmIChvbGRNb2RlbHNbaV0gIT09IHByb3ZpZGVkTW9kZWxzQXJyYXlb
        aV0pIHsgcmV0dXJuIGZhbHNlOyB9CiAgICAgIH0KICAgICAgcmV0dXJuIHRy
        dWU7CiAgICB9CgogICAgLyoqCiAgICAgIEBwcml2YXRlCgogICAgICBVcGRh
        dGVzIHRoZSBVUkwgKGlmIG5lY2Vzc2FyeSkgYW5kIGNhbGxzIGBzZXR1cENv
        bnRleHRzYAogICAgICB0byB1cGRhdGUgdGhlIHJvdXRlcidzIGFycmF5IG9m
        IGBjdXJyZW50SGFuZGxlckluZm9zYC4KICAgICAqLwogICAgZnVuY3Rpb24g
        ZmluYWxpemVUcmFuc2l0aW9uKHRyYW5zaXRpb24sIGhhbmRsZXJJbmZvcykg
        ewoKICAgICAgdmFyIHJvdXRlciA9IHRyYW5zaXRpb24ucm91dGVyLAogICAg
        ICAgICAgc2VxID0gdHJhbnNpdGlvbi5zZXF1ZW5jZSwKICAgICAgICAgIGhh
        bmRsZXJOYW1lID0gaGFuZGxlckluZm9zW2hhbmRsZXJJbmZvcy5sZW5ndGgg
        LSAxXS5uYW1lOwoKICAgICAgLy8gQ29sbGVjdCBwYXJhbXMgZm9yIFVSTC4K
        ICAgICAgdmFyIG9iamVjdHMgPSBbXSwgcHJvdmlkZWRNb2RlbHMgPSB0cmFu
        c2l0aW9uLnByb3ZpZGVkTW9kZWxzQXJyYXkuc2xpY2UoKTsKICAgICAgZm9y
        ICh2YXIgaSA9IGhhbmRsZXJJbmZvcy5sZW5ndGggLSAxOyBpPj0wOyAtLWkp
        IHsKICAgICAgICB2YXIgaGFuZGxlckluZm8gPSBoYW5kbGVySW5mb3NbaV07
        CiAgICAgICAgaWYgKGhhbmRsZXJJbmZvLmlzRHluYW1pYykgewogICAgICAg
        ICAgdmFyIHByb3ZpZGVkTW9kZWwgPSBwcm92aWRlZE1vZGVscy5wb3AoKTsK
        ICAgICAgICAgIG9iamVjdHMudW5zaGlmdChpc1BhcmFtKHByb3ZpZGVkTW9k
        ZWwpID8gcHJvdmlkZWRNb2RlbC50b1N0cmluZygpIDogaGFuZGxlckluZm8u
        Y29udGV4dCk7CiAgICAgICAgfQogICAgICB9CgogICAgICB2YXIgcGFyYW1z
        ID0gcGFyYW1zRm9ySGFuZGxlcihyb3V0ZXIsIGhhbmRsZXJOYW1lLCBvYmpl
        Y3RzKTsKCiAgICAgIHJvdXRlci5jdXJyZW50UGFyYW1zID0gcGFyYW1zOwoK
        ICAgICAgdmFyIHVybE1ldGhvZCA9IHRyYW5zaXRpb24udXJsTWV0aG9kOwog
        ICAgICBpZiAodXJsTWV0aG9kKSB7CiAgICAgICAgdmFyIHVybCA9IHJvdXRl
        ci5yZWNvZ25pemVyLmdlbmVyYXRlKGhhbmRsZXJOYW1lLCBwYXJhbXMpOwoK
        ICAgICAgICBpZiAodXJsTWV0aG9kID09PSAncmVwbGFjZScpIHsKICAgICAg
        ICAgIHJvdXRlci5yZXBsYWNlVVJMKHVybCk7CiAgICAgICAgfSBlbHNlIHsK
        ICAgICAgICAgIC8vIEFzc3VtZSBldmVyeXRoaW5nIGVsc2UgaXMganVzdCBh
        IFVSTCB1cGRhdGUgZm9yIG5vdy4KICAgICAgICAgIHJvdXRlci51cGRhdGVV
        UkwodXJsKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHNldHVwQ29udGV4
        dHModHJhbnNpdGlvbiwgaGFuZGxlckluZm9zKTsKICAgIH0KCiAgICAvKioK
        ICAgICAgQHByaXZhdGUKCiAgICAgIEludGVybmFsIGZ1bmN0aW9uIHVzZWQg
        dG8gY29uc3RydWN0IHRoZSBjaGFpbiBvZiBwcm9taXNlcyB1c2VkCiAgICAg
        IHRvIHZhbGlkYXRlIGEgdHJhbnNpdGlvbi4gV3JhcHMgY2FsbHMgdG8gYGJl
        Zm9yZU1vZGVsYCwgYG1vZGVsYCwKICAgICAgYW5kIGBhZnRlck1vZGVsYCBp
        biBwcm9taXNlcywgYW5kIGNoZWNrcyBmb3IgcmVkaXJlY3RzL2Fib3J0cwog
        ICAgICBiZXR3ZWVuIGVhY2guCiAgICAgKi8KICAgIGZ1bmN0aW9uIHZhbGlk
        YXRlRW50cnkodHJhbnNpdGlvbiwgaGFuZGxlckluZm9zLCBpbmRleCwgbWF0
        Y2hQb2ludCwgaGFuZGxlclBhcmFtcykgewoKICAgICAgaWYgKGluZGV4ID09
        PSBoYW5kbGVySW5mb3MubGVuZ3RoKSB7CiAgICAgICAgLy8gTm8gbW9yZSBj
        b250ZXh0cyB0byByZXNvbHZlLgogICAgICAgIHJldHVybiBSU1ZQLnJlc29s
        dmUodHJhbnNpdGlvbi5yZXNvbHZlZE1vZGVscyk7CiAgICAgIH0KCiAgICAg
        IHZhciByb3V0ZXIgPSB0cmFuc2l0aW9uLnJvdXRlciwKICAgICAgICAgIGhh
        bmRsZXJJbmZvID0gaGFuZGxlckluZm9zW2luZGV4XSwKICAgICAgICAgIGhh
        bmRsZXIgPSBoYW5kbGVySW5mby5oYW5kbGVyLAogICAgICAgICAgaGFuZGxl
        ck5hbWUgPSBoYW5kbGVySW5mby5uYW1lLAogICAgICAgICAgc2VxID0gdHJh
        bnNpdGlvbi5zZXF1ZW5jZTsKCiAgICAgIGlmIChpbmRleCA8IG1hdGNoUG9p
        bnQpIHsKICAgICAgICBsb2cocm91dGVyLCBzZXEsIGhhbmRsZXJOYW1lICsg
        IjogdXNpbmcgY29udGV4dCBmcm9tIGFscmVhZHktYWN0aXZlIGhhbmRsZXIi
        KTsKCiAgICAgICAgLy8gV2UncmUgYmVmb3JlIHRoZSBtYXRjaCBwb2ludCwg
        c28gZG9uJ3QgcnVuIGFueSBob29rcywKICAgICAgICAvLyBqdXN0IHVzZSB0
        aGUgYWxyZWFkeSByZXNvbHZlZCBjb250ZXh0IGZyb20gdGhlIGhhbmRsZXIu
        CiAgICAgICAgdHJhbnNpdGlvbi5yZXNvbHZlZE1vZGVsc1toYW5kbGVySW5m
        by5uYW1lXSA9CiAgICAgICAgICB0cmFuc2l0aW9uLnByb3ZpZGVkTW9kZWxz
        W2hhbmRsZXJJbmZvLm5hbWVdIHx8CiAgICAgICAgICBoYW5kbGVySW5mby5o
        YW5kbGVyLmNvbnRleHQ7CiAgICAgICAgcmV0dXJuIHByb2NlZWQoKTsKICAg
        ICAgfQoKICAgICAgcmV0dXJuIFJTVlAucmVzb2x2ZSgpLnRoZW4oaGFuZGxl
        QWJvcnQpCiAgICAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGJlZm9y
        ZU1vZGVsKQogICAgICAgICAgICAgICAgICAgICAgICAgICAudGhlbihoYW5k
        bGVBYm9ydCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4obW9k
        ZWwpCiAgICAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGhhbmRsZUFi
        b3J0KQogICAgICAgICAgICAgICAgICAgICAgICAgICAudGhlbihhZnRlck1v
        ZGVsKQogICAgICAgICAgICAgICAgICAgICAgICAgICAudGhlbihoYW5kbGVB
        Ym9ydCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4obnVsbCwg
        aGFuZGxlRXJyb3IpCiAgICAgICAgICAgICAgICAgICAgICAgICAgIC50aGVu
        KHByb2NlZWQpOwoKICAgICAgZnVuY3Rpb24gaGFuZGxlQWJvcnQocmVzdWx0
        KSB7CiAgICAgICAgaWYgKHRyYW5zaXRpb24uaXNBYm9ydGVkKSB7CiAgICAg
        ICAgICBsb2codHJhbnNpdGlvbi5yb3V0ZXIsIHRyYW5zaXRpb24uc2VxdWVu
        Y2UsICJkZXRlY3RlZCBhYm9ydC4iKTsKICAgICAgICAgIHJldHVybiBSU1ZQ
        LnJlamVjdChuZXcgUm91dGVyLlRyYW5zaXRpb25BYm9ydGVkKCkpOwogICAg
        ICAgIH0KCiAgICAgICAgcmV0dXJuIHJlc3VsdDsKICAgICAgfQoKICAgICAg
        ZnVuY3Rpb24gaGFuZGxlRXJyb3IocmVhc29uKSB7CiAgICAgICAgaWYgKHJl
        YXNvbiBpbnN0YW5jZW9mIFJvdXRlci5UcmFuc2l0aW9uQWJvcnRlZCkgewog
        ICAgICAgICAgLy8gaWYgdGhlIHRyYW5zaXRpb24gd2FzIGFib3J0ZWQgYW5k
        ICpubyBhZGRpdGlvbmFsKiBlcnJvciB3YXMgdGhyb3duLAogICAgICAgICAg
        Ly8gcmVqZWN0IHdpdGggdGhlIFJvdXRlci5UcmFuc2l0aW9uQWJvcnRlZCBp
        bnN0YW5jZQogICAgICAgICAgcmV0dXJuIFJTVlAucmVqZWN0KHJlYXNvbik7
        CiAgICAgICAgfQoKICAgICAgICAvLyBvdGhlcndpc2UsIHdlJ3JlIGhlcmUg
        YmVjYXVzZSBvZiBhIGRpZmZlcmVudCBlcnJvcgogICAgICAgIHRyYW5zaXRp
        b24uYWJvcnQoKTsKCiAgICAgICAgbG9nKHJvdXRlciwgc2VxLCBoYW5kbGVy
        TmFtZSArICI6IGhhbmRsaW5nIGVycm9yOiAiICsgcmVhc29uKTsKCiAgICAg
        ICAgLy8gQW4gZXJyb3Igd2FzIHRocm93biAvIHByb21pc2UgcmVqZWN0ZWQs
        IHNvIGZpcmUgYW4KICAgICAgICAvLyBgZXJyb3JgIGV2ZW50IGZyb20gdGhp
        cyBoYW5kbGVyIGluZm8gdXAgdG8gcm9vdC4KICAgICAgICB0cmlnZ2VyKHJv
        dXRlciwgaGFuZGxlckluZm9zLnNsaWNlKDAsIGluZGV4ICsgMSksIHRydWUs
        IFsnZXJyb3InLCByZWFzb24sIHRyYW5zaXRpb25dKTsKCiAgICAgICAgLy8g
        UHJvcGFnYXRlIHRoZSBvcmlnaW5hbCBlcnJvci4KICAgICAgICByZXR1cm4g
        UlNWUC5yZWplY3QocmVhc29uKTsKICAgICAgfQoKICAgICAgZnVuY3Rpb24g
        YmVmb3JlTW9kZWwoKSB7CgogICAgICAgIGxvZyhyb3V0ZXIsIHNlcSwgaGFu
        ZGxlck5hbWUgKyAiOiBjYWxsaW5nIGJlZm9yZU1vZGVsIGhvb2siKTsKCiAg
        ICAgICAgdmFyIHAgPSBoYW5kbGVyLmJlZm9yZU1vZGVsICYmIGhhbmRsZXIu
        YmVmb3JlTW9kZWwodHJhbnNpdGlvbik7CiAgICAgICAgcmV0dXJuIChwIGlu
        c3RhbmNlb2YgVHJhbnNpdGlvbikgPyBudWxsIDogcDsKICAgICAgfQoKICAg
        ICAgZnVuY3Rpb24gbW9kZWwoKSB7CiAgICAgICAgbG9nKHJvdXRlciwgc2Vx
        LCBoYW5kbGVyTmFtZSArICI6IHJlc29sdmluZyBtb2RlbCIpOwoKICAgICAg
        ICB2YXIgcCA9IGdldE1vZGVsKGhhbmRsZXJJbmZvLCB0cmFuc2l0aW9uLCBo
        YW5kbGVyUGFyYW1zW2hhbmRsZXJOYW1lXSwgaW5kZXggPj0gbWF0Y2hQb2lu
        dCk7CiAgICAgICAgcmV0dXJuIChwIGluc3RhbmNlb2YgVHJhbnNpdGlvbikg
        PyBudWxsIDogcDsKICAgICAgfQoKICAgICAgZnVuY3Rpb24gYWZ0ZXJNb2Rl
        bChjb250ZXh0KSB7CgogICAgICAgIGxvZyhyb3V0ZXIsIHNlcSwgaGFuZGxl
        ck5hbWUgKyAiOiBjYWxsaW5nIGFmdGVyTW9kZWwgaG9vayIpOwoKICAgICAg
        ICAvLyBQYXNzIHRoZSBjb250ZXh0IGFuZCByZXNvbHZlZCBwYXJlbnQgY29u
        dGV4dHMgdG8gYWZ0ZXJNb2RlbCwgYnV0IHdlIGRvbid0CiAgICAgICAgLy8g
        d2FudCB0byB1c2UgdGhlIHZhbHVlIHJldHVybmVkIGZyb20gYGFmdGVyTW9k
        ZWxgIGluIGFueSB3YXksIGJ1dCByYXRoZXIKICAgICAgICAvLyBhbHdheXMg
        cmVzb2x2ZSB3aXRoIHRoZSBvcmlnaW5hbCBgY29udGV4dGAgb2JqZWN0LgoK
        ICAgICAgICB0cmFuc2l0aW9uLnJlc29sdmVkTW9kZWxzW2hhbmRsZXJJbmZv
        Lm5hbWVdID0gY29udGV4dDsKCiAgICAgICAgdmFyIHAgPSBoYW5kbGVyLmFm
        dGVyTW9kZWwgJiYgaGFuZGxlci5hZnRlck1vZGVsKGNvbnRleHQsIHRyYW5z
        aXRpb24pOwogICAgICAgIHJldHVybiAocCBpbnN0YW5jZW9mIFRyYW5zaXRp
        b24pID8gbnVsbCA6IHA7CiAgICAgIH0KCiAgICAgIGZ1bmN0aW9uIHByb2Nl
        ZWQoKSB7CiAgICAgICAgbG9nKHJvdXRlciwgc2VxLCBoYW5kbGVyTmFtZSAr
        ICI6IHZhbGlkYXRpb24gc3VjY2VlZGVkLCBwcm9jZWVkaW5nIik7CgogICAg
        ICAgIGhhbmRsZXJJbmZvLmNvbnRleHQgPSB0cmFuc2l0aW9uLnJlc29sdmVk
        TW9kZWxzW2hhbmRsZXJJbmZvLm5hbWVdOwogICAgICAgIHJldHVybiB2YWxp
        ZGF0ZUVudHJ5KHRyYW5zaXRpb24sIGhhbmRsZXJJbmZvcywgaW5kZXggKyAx
        LCBtYXRjaFBvaW50LCBoYW5kbGVyUGFyYW1zKTsKICAgICAgfQogICAgfQoK
        ICAgIC8qKgogICAgICBAcHJpdmF0ZQoKICAgICAgVGhyb3dzIGEgVHJhbnNp
        dGlvbkFib3J0ZWQgaWYgdGhlIHByb3ZpZGVkIHRyYW5zaXRpb24gaGFzIGJl
        ZW4gYWJvcnRlZC4KICAgICAqLwogICAgZnVuY3Rpb24gY2hlY2tBYm9ydCh0
        cmFuc2l0aW9uKSB7CiAgICAgIGlmICh0cmFuc2l0aW9uLmlzQWJvcnRlZCkg
        ewogICAgICAgIGxvZyh0cmFuc2l0aW9uLnJvdXRlciwgdHJhbnNpdGlvbi5z
        ZXF1ZW5jZSwgImRldGVjdGVkIGFib3J0LiIpOwogICAgICAgIHRocm93IG5l
        dyBSb3V0ZXIuVHJhbnNpdGlvbkFib3J0ZWQoKTsKICAgICAgfQogICAgfQoK
        ICAgIC8qKgogICAgICBAcHJpdmF0ZQoKICAgICAgRW5jYXBzdWxhdGVzIHRo
        ZSBsb2dpYyBmb3Igd2hldGhlciB0byBjYWxsIGBtb2RlbGAgb24gYSByb3V0
        ZSwKICAgICAgb3IgdXNlIG9uZSBvZiB0aGUgbW9kZWxzIHByb3ZpZGVkIHRv
        IGB0cmFuc2l0aW9uVG9gLgogICAgICovCiAgICBmdW5jdGlvbiBnZXRNb2Rl
        bChoYW5kbGVySW5mbywgdHJhbnNpdGlvbiwgaGFuZGxlclBhcmFtcywgbmVl
        ZHNVcGRhdGUpIHsKCiAgICAgIHZhciBoYW5kbGVyID0gaGFuZGxlckluZm8u
        aGFuZGxlciwKICAgICAgICAgIGhhbmRsZXJOYW1lID0gaGFuZGxlckluZm8u
        bmFtZTsKCiAgICAgIGlmICghbmVlZHNVcGRhdGUgJiYgaGFuZGxlci5oYXNP
        d25Qcm9wZXJ0eSgnY29udGV4dCcpKSB7CiAgICAgICAgcmV0dXJuIGhhbmRs
        ZXIuY29udGV4dDsKICAgICAgfQoKICAgICAgaWYgKHRyYW5zaXRpb24ucHJv
        dmlkZWRNb2RlbHMuaGFzT3duUHJvcGVydHkoaGFuZGxlck5hbWUpKSB7CiAg
        ICAgICAgdmFyIHByb3ZpZGVkTW9kZWwgPSB0cmFuc2l0aW9uLnByb3ZpZGVk
        TW9kZWxzW2hhbmRsZXJOYW1lXTsKICAgICAgICByZXR1cm4gdHlwZW9mIHBy
        b3ZpZGVkTW9kZWwgPT09ICdmdW5jdGlvbicgPyBwcm92aWRlZE1vZGVsKCkg
        OiBwcm92aWRlZE1vZGVsOwogICAgICB9CgogICAgICByZXR1cm4gaGFuZGxl
        ci5tb2RlbCAmJiBoYW5kbGVyLm1vZGVsKGhhbmRsZXJQYXJhbXMgfHwge30s
        IHRyYW5zaXRpb24pOwogICAgfQoKICAgIC8qKgogICAgICBAcHJpdmF0ZQog
        ICAgICovCiAgICBmdW5jdGlvbiBsb2cocm91dGVyLCBzZXF1ZW5jZSwgbXNn
        KSB7CgogICAgICBpZiAoIXJvdXRlci5sb2cpIHsgcmV0dXJuOyB9CgogICAg
        ICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMykgewogICAgICAgIHJvdXRl
        ci5sb2coIlRyYW5zaXRpb24gIyIgKyBzZXF1ZW5jZSArICI6ICIgKyBtc2cp
        OwogICAgICB9IGVsc2UgewogICAgICAgIG1zZyA9IHNlcXVlbmNlOwogICAg
        ICAgIHJvdXRlci5sb2cobXNnKTsKICAgICAgfQogICAgfQoKICAgIC8qKgog
        ICAgICBAcHJpdmF0ZQoKICAgICAgQmVnaW5zIGFuZCByZXR1cm5zIGEgVHJh
        bnNpdGlvbiBiYXNlZCBvbiB0aGUgcHJvdmlkZWQKICAgICAgYXJndW1lbnRz
        LiBBY2NlcHRzIGFyZ3VtZW50cyBpbiB0aGUgZm9ybSBvZiBib3RoIFVSTAog
        ICAgICB0cmFuc2l0aW9ucyBhbmQgbmFtZWQgdHJhbnNpdGlvbnMuCgogICAg
        ICBAcGFyYW0ge1JvdXRlcn0gcm91dGVyCiAgICAgIEBwYXJhbSB7QXJyYXlb
        T2JqZWN0XX0gYXJncyBhcmd1bWVudHMgcGFzc2VkIHRvIHRyYW5zaXRpb25U
        bywKICAgICAgICByZXBsYWNlV2l0aCwgb3IgaGFuZGxlVVJMCiAgICAqLwog
        ICAgZnVuY3Rpb24gZG9UcmFuc2l0aW9uKHJvdXRlciwgYXJncykgewogICAg
        ICAvLyBOb3JtYWxpemUgYmxhbmsgdHJhbnNpdGlvbnMgdG8gcm9vdCBVUkwg
        dHJhbnNpdGlvbnMuCiAgICAgIHZhciBuYW1lID0gYXJnc1swXSB8fCAnLyc7
        CgogICAgICBpZiAobmFtZS5jaGFyQXQoMCkgPT09ICcvJykgewogICAgICAg
        IHJldHVybiBjcmVhdGVVUkxUcmFuc2l0aW9uKHJvdXRlciwgbmFtZSk7CiAg
        ICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIGNyZWF0ZU5hbWVkVHJhbnNp
        dGlvbihyb3V0ZXIsIGFyZ3MpOwogICAgICB9CiAgICB9CgogICAgLyoqCiAg
        ICAgIEBwcml2YXRlCgogICAgICBTZXJpYWxpemVzIGEgaGFuZGxlciB1c2lu
        ZyBpdHMgY3VzdG9tIGBzZXJpYWxpemVgIG1ldGhvZCBvcgogICAgICBieSBh
        IGRlZmF1bHQgdGhhdCBsb29rcyB1cCB0aGUgZXhwZWN0ZWQgcHJvcGVydHkg
        bmFtZSBmcm9tCiAgICAgIHRoZSBkeW5hbWljIHNlZ21lbnQuCgogICAgICBA
        cGFyYW0ge09iamVjdH0gaGFuZGxlciBhIHJvdXRlciBoYW5kbGVyCiAgICAg
        IEBwYXJhbSB7T2JqZWN0fSBtb2RlbCB0aGUgbW9kZWwgdG8gYmUgc2VyaWFs
        aXplZCBmb3IgdGhpcyBoYW5kbGVyCiAgICAgIEBwYXJhbSB7QXJyYXlbT2Jq
        ZWN0XX0gbmFtZXMgdGhlIG5hbWVzIGFycmF5IGF0dGFjaGVkIHRvIGFuCiAg
        ICAgICAgaGFuZGxlciBvYmplY3QgcmV0dXJuZWQgZnJvbSByb3V0ZXIucmVj
        b2duaXplci5oYW5kbGVyc0ZvcigpCiAgICAqLwogICAgZnVuY3Rpb24gc2Vy
        aWFsaXplKGhhbmRsZXIsIG1vZGVsLCBuYW1lcykgewoKICAgICAgdmFyIG9i
        amVjdCA9IHt9OwogICAgICBpZiAoaXNQYXJhbShtb2RlbCkpIHsKICAgICAg
        ICBvYmplY3RbbmFtZXNbMF1dID0gbW9kZWw7CiAgICAgICAgcmV0dXJuIG9i
        amVjdDsKICAgICAgfQoKICAgICAgLy8gVXNlIGN1c3RvbSBzZXJpYWxpemUg
        aWYgaXQgZXhpc3RzLgogICAgICBpZiAoaGFuZGxlci5zZXJpYWxpemUpIHsK
        ICAgICAgICByZXR1cm4gaGFuZGxlci5zZXJpYWxpemUobW9kZWwsIG5hbWVz
        KTsKICAgICAgfQoKICAgICAgaWYgKG5hbWVzLmxlbmd0aCAhPT0gMSkgeyBy
        ZXR1cm47IH0KCiAgICAgIHZhciBuYW1lID0gbmFtZXNbMF07CgogICAgICBp
        ZiAoL19pZCQvLnRlc3QobmFtZSkpIHsKICAgICAgICBvYmplY3RbbmFtZV0g
        PSBtb2RlbC5pZDsKICAgICAgfSBlbHNlIHsKICAgICAgICBvYmplY3RbbmFt
        ZV0gPSBtb2RlbDsKICAgICAgfQogICAgICByZXR1cm4gb2JqZWN0OwogICAg
        fQoKCiAgICByZXR1cm4gUm91dGVyOwogIH0pOwoKfSkoKTsKCgoKKGZ1bmN0
        aW9uKCkgewovKioKQG1vZHVsZSBlbWJlcgpAc3VibW9kdWxlIGVtYmVyLXJv
        dXRpbmcKKi8KCmZ1bmN0aW9uIERTTChuYW1lKSB7CiAgdGhpcy5wYXJlbnQg
        PSBuYW1lOwogIHRoaXMubWF0Y2hlcyA9IFtdOwp9CgpEU0wucHJvdG90eXBl
        ID0gewogIHJlc291cmNlOiBmdW5jdGlvbihuYW1lLCBvcHRpb25zLCBjYWxs
        YmFjaykgewogICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDIgJiYgdHlw
        ZW9mIG9wdGlvbnMgPT09ICdmdW5jdGlvbicpIHsKICAgICAgY2FsbGJhY2sg
        PSBvcHRpb25zOwogICAgICBvcHRpb25zID0ge307CiAgICB9CgogICAgaWYg
        KGFyZ3VtZW50cy5sZW5ndGggPT09IDEpIHsKICAgICAgb3B0aW9ucyA9IHt9
        OwogICAgfQoKICAgIGlmICh0eXBlb2Ygb3B0aW9ucy5wYXRoICE9PSAnc3Ry
        aW5nJykgewogICAgICBvcHRpb25zLnBhdGggPSAiLyIgKyBuYW1lOwogICAg
        fQoKICAgIGlmIChjYWxsYmFjaykgewogICAgICB2YXIgZHNsID0gbmV3IERT
        TChuYW1lKTsKICAgICAgY2FsbGJhY2suY2FsbChkc2wpOwogICAgICB0aGlz
        LnB1c2gob3B0aW9ucy5wYXRoLCBuYW1lLCBkc2wuZ2VuZXJhdGUoKSk7CiAg
        ICB9IGVsc2UgewogICAgICB0aGlzLnB1c2gob3B0aW9ucy5wYXRoLCBuYW1l
        KTsKICAgIH0KICB9LAoKICBwdXNoOiBmdW5jdGlvbih1cmwsIG5hbWUsIGNh
        bGxiYWNrKSB7CiAgICB2YXIgcGFydHMgPSBuYW1lLnNwbGl0KCcuJyk7CiAg
        ICBpZiAodXJsID09PSAiIiB8fCB1cmwgPT09ICIvIiB8fCBwYXJ0c1twYXJ0
        cy5sZW5ndGgtMV0gPT09ICJpbmRleCIpIHsgdGhpcy5leHBsaWNpdEluZGV4
        ID0gdHJ1ZTsgfQoKICAgIHRoaXMubWF0Y2hlcy5wdXNoKFt1cmwsIG5hbWUs
        IGNhbGxiYWNrXSk7CiAgfSwKCiAgcm91dGU6IGZ1bmN0aW9uKG5hbWUsIG9w
        dGlvbnMpIHsKICAgIEVtYmVyLmFzc2VydCgiWW91IG11c3QgdXNlIGB0aGlz
        LnJlc291cmNlYCB0byBuZXN0IiwgdHlwZW9mIG9wdGlvbnMgIT09ICdmdW5j
        dGlvbicpOwoKICAgIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9OwoKICAgIGlm
        ICh0eXBlb2Ygb3B0aW9ucy5wYXRoICE9PSAnc3RyaW5nJykgewogICAgICBv
        cHRpb25zLnBhdGggPSAiLyIgKyBuYW1lOwogICAgfQoKICAgIGlmICh0aGlz
        LnBhcmVudCAmJiB0aGlzLnBhcmVudCAhPT0gJ2FwcGxpY2F0aW9uJykgewog
        ICAgICBuYW1lID0gdGhpcy5wYXJlbnQgKyAiLiIgKyBuYW1lOwogICAgfQoK
        ICAgIHRoaXMucHVzaChvcHRpb25zLnBhdGgsIG5hbWUpOwogIH0sCgogIGdl
        bmVyYXRlOiBmdW5jdGlvbigpIHsKICAgIHZhciBkc2xNYXRjaGVzID0gdGhp
        cy5tYXRjaGVzOwoKICAgIGlmICghdGhpcy5leHBsaWNpdEluZGV4KSB7CiAg
        ICAgIHRoaXMucm91dGUoImluZGV4IiwgeyBwYXRoOiAiLyIgfSk7CiAgICB9
        CgogICAgcmV0dXJuIGZ1bmN0aW9uKG1hdGNoKSB7CiAgICAgIGZvciAodmFy
        IGk9MCwgbD1kc2xNYXRjaGVzLmxlbmd0aDsgaTxsOyBpKyspIHsKICAgICAg
        ICB2YXIgZHNsTWF0Y2ggPSBkc2xNYXRjaGVzW2ldOwogICAgICAgIG1hdGNo
        KGRzbE1hdGNoWzBdKS50byhkc2xNYXRjaFsxXSwgZHNsTWF0Y2hbMl0pOwog
        ICAgICB9CiAgICB9OwogIH0KfTsKCkRTTC5tYXAgPSBmdW5jdGlvbihjYWxs
        YmFjaykgewogIHZhciBkc2wgPSBuZXcgRFNMKCk7CiAgY2FsbGJhY2suY2Fs
        bChkc2wpOwogIHJldHVybiBkc2w7Cn07CgpFbWJlci5Sb3V0ZXJEU0wgPSBE
        U0w7Cgp9KSgpOwoKCgooZnVuY3Rpb24oKSB7CnZhciBnZXQgPSBFbWJlci5n
        ZXQ7CgovKioKQG1vZHVsZSBlbWJlcgpAc3VibW9kdWxlIGVtYmVyLXJvdXRp
        bmcKKi8KCi8qKgogIAogIEZpbmRzIGEgY29udHJvbGxlciBpbnN0YW5jZS4K
        CiAgQGZvciBFbWJlcgogIEBtZXRob2QgY29udHJvbGxlckZvcgogIEBwcml2
        YXRlCiovCkVtYmVyLmNvbnRyb2xsZXJGb3IgPSBmdW5jdGlvbihjb250YWlu
        ZXIsIGNvbnRyb2xsZXJOYW1lLCBsb29rdXBPcHRpb25zKSB7CiAgcmV0dXJu
        IGNvbnRhaW5lci5sb29rdXAoJ2NvbnRyb2xsZXI6JyArIGNvbnRyb2xsZXJO
        YW1lLCBsb29rdXBPcHRpb25zKTsKfTsKCi8qKgogIEdlbmVyYXRlcyBhIGNv
        bnRyb2xsZXIgYXV0b21hdGljYWxseSBpZiBub25lIHdhcyBwcm92aWRlZC4K
        ICBUaGUgdHlwZSBvZiBnZW5lcmF0ZWQgY29udHJvbGxlciBkZXBlbmRzIG9u
        IHRoZSBjb250ZXh0LgogIFlvdSBjYW4gY3VzdG9taXplIHlvdXIgZ2VuZXJh
        dGVkIGNvbnRyb2xsZXJzIGJ5IGRlZmluaW5nCiAgYEFwcC5PYmplY3RDb250
        cm9sbGVyYCBhbmQgYEFwcC5BcnJheUNvbnRyb2xsZXJgCiAgCiAgQGZvciBF
        bWJlcgogIEBtZXRob2QgZ2VuZXJhdGVDb250cm9sbGVyCiAgQHByaXZhdGUK
        Ki8KRW1iZXIuZ2VuZXJhdGVDb250cm9sbGVyID0gZnVuY3Rpb24oY29udGFp
        bmVyLCBjb250cm9sbGVyTmFtZSwgY29udGV4dCkgewogIHZhciBDb250cm9s
        bGVyRmFjdG9yeSwgZnVsbE5hbWUsIGluc3RhbmNlLCBuYW1lLCBmYWN0b3J5
        TmFtZSwgY29udHJvbGxlclR5cGU7CgogIGlmIChjb250ZXh0ICYmIEVtYmVy
        LmlzQXJyYXkoY29udGV4dCkpIHsKICAgIGNvbnRyb2xsZXJUeXBlID0gJ2Fy
        cmF5JzsKICB9IGVsc2UgaWYgKGNvbnRleHQpIHsKICAgIGNvbnRyb2xsZXJU
        eXBlID0gJ29iamVjdCc7CiAgfSBlbHNlIHsKICAgIGNvbnRyb2xsZXJUeXBl
        ID0gJ2Jhc2ljJzsKICB9CgogIGZhY3RvcnlOYW1lID0gJ2NvbnRyb2xsZXI6
        JyArIGNvbnRyb2xsZXJUeXBlOwoKICBDb250cm9sbGVyRmFjdG9yeSA9IGNv
        bnRhaW5lci5sb29rdXBGYWN0b3J5KGZhY3RvcnlOYW1lKS5leHRlbmQoewog
        ICAgaXNHZW5lcmF0ZWQ6IHRydWUsCiAgICB0b1N0cmluZzogZnVuY3Rpb24o
        KSB7CiAgICAgIHJldHVybiAiKGdlbmVyYXRlZCAiICsgY29udHJvbGxlck5h
        bWUgKyAiIGNvbnRyb2xsZXIpIjsKICAgIH0KICB9KTsKCiAgZnVsbE5hbWUg
        PSAnY29udHJvbGxlcjonICsgY29udHJvbGxlck5hbWU7CgogIGNvbnRhaW5l
        ci5yZWdpc3RlcihmdWxsTmFtZSwgQ29udHJvbGxlckZhY3RvcnkpOwoKICBp
        bnN0YW5jZSA9IGNvbnRhaW5lci5sb29rdXAoZnVsbE5hbWUpOwoKICBpZiAo
        Z2V0KGluc3RhbmNlLCAnbmFtZXNwYWNlLkxPR19BQ1RJVkVfR0VORVJBVElP
        TicpKSB7CiAgICBFbWJlci5Mb2dnZXIuaW5mbygiZ2VuZXJhdGVkIC0+ICIg
        KyBmdWxsTmFtZSwgeyBmdWxsTmFtZTogZnVsbE5hbWUgfSk7CiAgfQoKICBy
        ZXR1cm4gaW5zdGFuY2U7Cn07Cgp9KSgpOwoKCgooZnVuY3Rpb24oKSB7Ci8q
        KgpAbW9kdWxlIGVtYmVyCkBzdWJtb2R1bGUgZW1iZXItcm91dGluZwoqLwoK
        dmFyIFJvdXRlciA9IHJlcXVpcmVNb2R1bGUoInJvdXRlciIpOwp2YXIgZ2V0
        ID0gRW1iZXIuZ2V0LCBzZXQgPSBFbWJlci5zZXQ7CnZhciBkZWZpbmVQcm9w
        ZXJ0eSA9IEVtYmVyLmRlZmluZVByb3BlcnR5OwoKdmFyIERlZmF1bHRWaWV3
        ID0gRW1iZXIuX01ldGFtb3JwaFZpZXc7Ci8qKgogIFRoZSBgRW1iZXIuUm91
        dGVyYCBjbGFzcyBtYW5hZ2VzIHRoZSBhcHBsaWNhdGlvbiBzdGF0ZSBhbmQg
        VVJMcy4gUmVmZXIgdG8KICB0aGUgW3JvdXRpbmcgZ3VpZGVdKGh0dHA6Ly9l
        bWJlcmpzLmNvbS9ndWlkZXMvcm91dGluZy8pIGZvciBkb2N1bWVudGF0aW9u
        LgoKICBAY2xhc3MgUm91dGVyCiAgQG5hbWVzcGFjZSBFbWJlcgogIEBleHRl
        bmRzIEVtYmVyLk9iamVjdAoqLwpFbWJlci5Sb3V0ZXIgPSBFbWJlci5PYmpl
        Y3QuZXh0ZW5kKHsKICBsb2NhdGlvbjogJ2hhc2gnLAoKICBpbml0OiBmdW5j
        dGlvbigpIHsKICAgIHRoaXMucm91dGVyID0gdGhpcy5jb25zdHJ1Y3Rvci5y
        b3V0ZXIgfHwgdGhpcy5jb25zdHJ1Y3Rvci5tYXAoRW1iZXIuSyk7CiAgICB0
        aGlzLl9hY3RpdmVWaWV3cyA9IHt9OwogICAgdGhpcy5fc2V0dXBMb2NhdGlv
        bigpOwogIH0sCgogIHVybDogRW1iZXIuY29tcHV0ZWQoZnVuY3Rpb24oKSB7
        CiAgICByZXR1cm4gZ2V0KHRoaXMsICdsb2NhdGlvbicpLmdldFVSTCgpOwog
        IH0pLAoKICBzdGFydFJvdXRpbmc6IGZ1bmN0aW9uKCkgewogICAgdGhpcy5y
        b3V0ZXIgPSB0aGlzLnJvdXRlciB8fCB0aGlzLmNvbnN0cnVjdG9yLm1hcChF
        bWJlci5LKTsKCiAgICB2YXIgcm91dGVyID0gdGhpcy5yb3V0ZXIsCiAgICAg
        ICAgbG9jYXRpb24gPSBnZXQodGhpcywgJ2xvY2F0aW9uJyksCiAgICAgICAg
        Y29udGFpbmVyID0gdGhpcy5jb250YWluZXIsCiAgICAgICAgc2VsZiA9IHRo
        aXM7CgogICAgdGhpcy5fc2V0dXBSb3V0ZXIocm91dGVyLCBsb2NhdGlvbik7
        CgogICAgY29udGFpbmVyLnJlZ2lzdGVyKCd2aWV3OmRlZmF1bHQnLCBEZWZh
        dWx0Vmlldyk7CiAgICBjb250YWluZXIucmVnaXN0ZXIoJ3ZpZXc6dG9wbGV2
        ZWwnLCBFbWJlci5WaWV3LmV4dGVuZCgpKTsKCiAgICBsb2NhdGlvbi5vblVw
        ZGF0ZVVSTChmdW5jdGlvbih1cmwpIHsKICAgICAgc2VsZi5oYW5kbGVVUkwo
        dXJsKTsKICAgIH0pOwoKICAgIHRoaXMuaGFuZGxlVVJMKGxvY2F0aW9uLmdl
        dFVSTCgpKTsKICB9LAoKICBkaWRUcmFuc2l0aW9uOiBmdW5jdGlvbihpbmZv
        cykgewogICAgdmFyIGFwcENvbnRyb2xsZXIgPSB0aGlzLmNvbnRhaW5lci5s
        b29rdXAoJ2NvbnRyb2xsZXI6YXBwbGljYXRpb24nKSwKICAgICAgICBwYXRo
        ID0gRW1iZXIuUm91dGVyLl9yb3V0ZVBhdGgoaW5mb3MpOwoKICAgIGlmICgh
        KCdjdXJyZW50UGF0aCcgaW4gYXBwQ29udHJvbGxlcikpIHsgZGVmaW5lUHJv
        cGVydHkoYXBwQ29udHJvbGxlciwgJ2N1cnJlbnRQYXRoJyk7IH0KICAgIHNl
        dChhcHBDb250cm9sbGVyLCAnY3VycmVudFBhdGgnLCBwYXRoKTsKCiAgICBp
        ZiAoISgnY3VycmVudFJvdXRlTmFtZScgaW4gYXBwQ29udHJvbGxlcikpIHsg
        ZGVmaW5lUHJvcGVydHkoYXBwQ29udHJvbGxlciwgJ2N1cnJlbnRSb3V0ZU5h
        bWUnKTsgfQogICAgc2V0KGFwcENvbnRyb2xsZXIsICdjdXJyZW50Um91dGVO
        YW1lJywgaW5mb3NbaW5mb3MubGVuZ3RoIC0gMV0ubmFtZSk7CgogICAgdGhp
        cy5ub3RpZnlQcm9wZXJ0eUNoYW5nZSgndXJsJyk7CgogICAgaWYgKGdldCh0
        aGlzLCAnbmFtZXNwYWNlJykuTE9HX1RSQU5TSVRJT05TKSB7CiAgICAgIEVt
        YmVyLkxvZ2dlci5sb2coIlRyYW5zaXRpb25lZCBpbnRvICciICsgcGF0aCAr
        ICInIik7CiAgICB9CiAgfSwKCiAgaGFuZGxlVVJMOiBmdW5jdGlvbih1cmwp
        IHsKICAgIHJldHVybiB0aGlzLl9kb1RyYW5zaXRpb24oJ2hhbmRsZVVSTCcs
        IFt1cmxdKTsKICB9LAoKICB0cmFuc2l0aW9uVG86IGZ1bmN0aW9uKCkgewog
        ICAgcmV0dXJuIHRoaXMuX2RvVHJhbnNpdGlvbigndHJhbnNpdGlvblRvJywg
        YXJndW1lbnRzKTsKICB9LAoKICByZXBsYWNlV2l0aDogZnVuY3Rpb24oKSB7
        CiAgICByZXR1cm4gdGhpcy5fZG9UcmFuc2l0aW9uKCdyZXBsYWNlV2l0aCcs
        IGFyZ3VtZW50cyk7CiAgfSwKCiAgZ2VuZXJhdGU6IGZ1bmN0aW9uKCkgewog
        ICAgdmFyIHVybCA9IHRoaXMucm91dGVyLmdlbmVyYXRlLmFwcGx5KHRoaXMu
        cm91dGVyLCBhcmd1bWVudHMpOwogICAgcmV0dXJuIHRoaXMubG9jYXRpb24u
        Zm9ybWF0VVJMKHVybCk7CiAgfSwKCiAgaXNBY3RpdmU6IGZ1bmN0aW9uKHJv
        dXRlTmFtZSkgewogICAgdmFyIHJvdXRlciA9IHRoaXMucm91dGVyOwogICAg
        cmV0dXJuIHJvdXRlci5pc0FjdGl2ZS5hcHBseShyb3V0ZXIsIGFyZ3VtZW50
        cyk7CiAgfSwKCiAgc2VuZDogZnVuY3Rpb24obmFtZSwgY29udGV4dCkgewog
        ICAgdGhpcy5yb3V0ZXIudHJpZ2dlci5hcHBseSh0aGlzLnJvdXRlciwgYXJn
        dW1lbnRzKTsKICB9LAoKICBoYXNSb3V0ZTogZnVuY3Rpb24ocm91dGUpIHsK
        ICAgIHJldHVybiB0aGlzLnJvdXRlci5oYXNSb3V0ZShyb3V0ZSk7CiAgfSwK
        CiAgLyoqCiAgICBAcHJpdmF0ZQoKICAgIFJlc2V0cyB0aGUgc3RhdGUgb2Yg
        dGhlIHJvdXRlciBieSBjbGVhcmluZyB0aGUgY3VycmVudCByb3V0ZQogICAg
        aGFuZGxlcnMgYW5kIGRlYWN0aXZhdGluZyB0aGVtLgoKICAgIEBtZXRob2Qg
        cmVzZXQKICAgKi8KICByZXNldDogZnVuY3Rpb24oKSB7CiAgICB0aGlzLnJv
        dXRlci5yZXNldCgpOwogIH0sCgogIF9sb29rdXBBY3RpdmVWaWV3OiBmdW5j
        dGlvbih0ZW1wbGF0ZU5hbWUpIHsKICAgIHZhciBhY3RpdmUgPSB0aGlzLl9h
        Y3RpdmVWaWV3c1t0ZW1wbGF0ZU5hbWVdOwogICAgcmV0dXJuIGFjdGl2ZSAm
        JiBhY3RpdmVbMF07CiAgfSwKCiAgX2Nvbm5lY3RBY3RpdmVWaWV3OiBmdW5j
        dGlvbih0ZW1wbGF0ZU5hbWUsIHZpZXcpIHsKICAgIHZhciBleGlzdGluZyA9
        IHRoaXMuX2FjdGl2ZVZpZXdzW3RlbXBsYXRlTmFtZV07CgogICAgaWYgKGV4
        aXN0aW5nKSB7CiAgICAgIGV4aXN0aW5nWzBdLm9mZignd2lsbERlc3Ryb3lF
        bGVtZW50JywgdGhpcywgZXhpc3RpbmdbMV0pOwogICAgfQoKICAgIHZhciBk
        aXNjb25uZWN0ID0gZnVuY3Rpb24oKSB7CiAgICAgIGRlbGV0ZSB0aGlzLl9h
        Y3RpdmVWaWV3c1t0ZW1wbGF0ZU5hbWVdOwogICAgfTsKCiAgICB0aGlzLl9h
        Y3RpdmVWaWV3c1t0ZW1wbGF0ZU5hbWVdID0gW3ZpZXcsIGRpc2Nvbm5lY3Rd
        OwogICAgdmlldy5vbmUoJ3dpbGxEZXN0cm95RWxlbWVudCcsIHRoaXMsIGRp
        c2Nvbm5lY3QpOwogIH0sCgogIF9zZXR1cExvY2F0aW9uOiBmdW5jdGlvbigp
        IHsKICAgIHZhciBsb2NhdGlvbiA9IGdldCh0aGlzLCAnbG9jYXRpb24nKSwK
        ICAgICAgICByb290VVJMID0gZ2V0KHRoaXMsICdyb290VVJMJyksCiAgICAg
        ICAgb3B0aW9ucyA9IHt9OwoKICAgIGlmICh0eXBlb2Ygcm9vdFVSTCA9PT0g
        J3N0cmluZycpIHsKICAgICAgb3B0aW9ucy5yb290VVJMID0gcm9vdFVSTDsK
        ICAgIH0KCiAgICBpZiAoJ3N0cmluZycgPT09IHR5cGVvZiBsb2NhdGlvbikg
        ewogICAgICBvcHRpb25zLmltcGxlbWVudGF0aW9uID0gbG9jYXRpb247CiAg
        ICAgIGxvY2F0aW9uID0gc2V0KHRoaXMsICdsb2NhdGlvbicsIEVtYmVyLkxv
        Y2F0aW9uLmNyZWF0ZShvcHRpb25zKSk7CiAgICB9CiAgfSwKCiAgX2dldEhh
        bmRsZXJGdW5jdGlvbjogZnVuY3Rpb24oKSB7CiAgICB2YXIgc2VlbiA9IHt9
        LCBjb250YWluZXIgPSB0aGlzLmNvbnRhaW5lciwKICAgICAgICBEZWZhdWx0
        Um91dGUgPSBjb250YWluZXIubG9va3VwRmFjdG9yeSgncm91dGU6YmFzaWMn
        KSwKICAgICAgICBzZWxmID0gdGhpczsKCiAgICByZXR1cm4gZnVuY3Rpb24o
        bmFtZSkgewogICAgICB2YXIgcm91dGVOYW1lID0gJ3JvdXRlOicgKyBuYW1l
        LAogICAgICAgICAgaGFuZGxlciA9IGNvbnRhaW5lci5sb29rdXAocm91dGVO
        YW1lKTsKCiAgICAgIGlmIChzZWVuW25hbWVdKSB7IHJldHVybiBoYW5kbGVy
        OyB9CgogICAgICBzZWVuW25hbWVdID0gdHJ1ZTsKCiAgICAgIGlmICghaGFu
        ZGxlcikgewogICAgICAgIGlmIChuYW1lID09PSAnbG9hZGluZycpIHsgcmV0
        dXJuIHt9OyB9CgogICAgICAgIGNvbnRhaW5lci5yZWdpc3Rlcihyb3V0ZU5h
        bWUsIERlZmF1bHRSb3V0ZS5leHRlbmQoKSk7CiAgICAgICAgaGFuZGxlciA9
        IGNvbnRhaW5lci5sb29rdXAocm91dGVOYW1lKTsKCiAgICAgICAgaWYgKGdl
        dChzZWxmLCAnbmFtZXNwYWNlLkxPR19BQ1RJVkVfR0VORVJBVElPTicpKSB7
        CiAgICAgICAgICBFbWJlci5Mb2dnZXIuaW5mbygiZ2VuZXJhdGVkIC0+ICIg
        KyByb3V0ZU5hbWUsIHsgZnVsbE5hbWU6IHJvdXRlTmFtZSB9KTsKICAgICAg
        ICB9CiAgICAgIH0KCiAgICAgIGlmIChuYW1lID09PSAnYXBwbGljYXRpb24n
        KSB7CiAgICAgICAgLy8gSW5qZWN0IGRlZmF1bHQgYGVycm9yYCBoYW5kbGVy
        LgogICAgICAgIC8vIE5vdGU6IGBldmVudHNgIGlzIGRlcHJlY2F0ZWQsIGJ1
        dCB3ZSdsbCBsZXQgdGhlCiAgICAgICAgLy8gZGVwcmVjYXRpb24gd2Fybmlu
        Z3MgYmUgaGFuZGxlZCBhdCBldmVudC1oYW5kbGluZyB0aW1lIHJhdGhlcgog
        ICAgICAgIC8vIHRoYW4gZHVwbGljYXRpbmcgdGhhdCBsb2dpYyBoZXJlLgog
        ICAgICAgIHZhciBhY3Rpb25zID0gaGFuZGxlci5fYWN0aW9ucyB8fCBoYW5k
        bGVyLmV2ZW50czsKICAgICAgICBpZiAoIWFjdGlvbnMpIHsgYWN0aW9ucyA9
        IGhhbmRsZXIuX2FjdGlvbnMgPSB7fTsgfQogICAgICAgIGFjdGlvbnMuZXJy
        b3IgPSBhY3Rpb25zLmVycm9yIHx8IEVtYmVyLlJvdXRlci5fZGVmYXVsdEVy
        cm9ySGFuZGxlcjsKICAgICAgfQoKICAgICAgaGFuZGxlci5yb3V0ZU5hbWUg
        PSBuYW1lOwogICAgICByZXR1cm4gaGFuZGxlcjsKICAgIH07CiAgfSwKCiAg
        X3NldHVwUm91dGVyOiBmdW5jdGlvbihyb3V0ZXIsIGxvY2F0aW9uKSB7CiAg
        ICB2YXIgbGFzdFVSTCwgZW1iZXJSb3V0ZXIgPSB0aGlzOwoKICAgIHJvdXRl
        ci5nZXRIYW5kbGVyID0gdGhpcy5fZ2V0SGFuZGxlckZ1bmN0aW9uKCk7Cgog
        ICAgdmFyIGRvVXBkYXRlVVJMID0gZnVuY3Rpb24oKSB7CiAgICAgIGxvY2F0
        aW9uLnNldFVSTChsYXN0VVJMKTsKICAgIH07CgogICAgcm91dGVyLnVwZGF0
        ZVVSTCA9IGZ1bmN0aW9uKHBhdGgpIHsKICAgICAgbGFzdFVSTCA9IHBhdGg7
        CiAgICAgIEVtYmVyLnJ1bi5vbmNlKGRvVXBkYXRlVVJMKTsKICAgIH07Cgog
        ICAgaWYgKGxvY2F0aW9uLnJlcGxhY2VVUkwpIHsKICAgICAgdmFyIGRvUmVw
        bGFjZVVSTCA9IGZ1bmN0aW9uKCkgewogICAgICAgIGxvY2F0aW9uLnJlcGxh
        Y2VVUkwobGFzdFVSTCk7CiAgICAgIH07CgogICAgICByb3V0ZXIucmVwbGFj
        ZVVSTCA9IGZ1bmN0aW9uKHBhdGgpIHsKICAgICAgICBsYXN0VVJMID0gcGF0
        aDsKICAgICAgICBFbWJlci5ydW4ub25jZShkb1JlcGxhY2VVUkwpOwogICAg
        ICB9OwogICAgfQoKICAgIHJvdXRlci5kaWRUcmFuc2l0aW9uID0gZnVuY3Rp
        b24oaW5mb3MpIHsKICAgICAgZW1iZXJSb3V0ZXIuZGlkVHJhbnNpdGlvbihp
        bmZvcyk7CiAgICB9OwogIH0sCgogIF9kb1RyYW5zaXRpb246IGZ1bmN0aW9u
        KG1ldGhvZCwgYXJncykgewogICAgLy8gTm9ybWFsaXplIGJsYW5rIHJvdXRl
        IHRvIHJvb3QgVVJMLgogICAgYXJncyA9IFtdLnNsaWNlLmNhbGwoYXJncyk7
        CiAgICBhcmdzWzBdID0gYXJnc1swXSB8fCAnLyc7CgogICAgdmFyIHBhc3Nl
        ZE5hbWUgPSBhcmdzWzBdLCBuYW1lLCBzZWxmID0gdGhpczsKCiAgICBpZiAo
        cGFzc2VkTmFtZS5jaGFyQXQoMCkgPT09ICcvJykgewogICAgICBuYW1lID0g
        cGFzc2VkTmFtZTsKICAgIH0gZWxzZSB7CgogICAgICBpZiAoIXRoaXMucm91
        dGVyLmhhc1JvdXRlKHBhc3NlZE5hbWUpKSB7CiAgICAgICAgbmFtZSA9IGFy
        Z3NbMF0gPSBwYXNzZWROYW1lICsgJy5pbmRleCc7CiAgICAgIH0gZWxzZSB7
        CiAgICAgICAgbmFtZSA9IHBhc3NlZE5hbWU7CiAgICAgIH0KCiAgICAgIEVt
        YmVyLmFzc2VydCgiVGhlIHJvdXRlICIgKyBwYXNzZWROYW1lICsgIiB3YXMg
        bm90IGZvdW5kIiwgdGhpcy5yb3V0ZXIuaGFzUm91dGUobmFtZSkpOwogICAg
        fQoKICAgIHZhciB0cmFuc2l0aW9uUHJvbWlzZSA9IHRoaXMucm91dGVyW21l
        dGhvZF0uYXBwbHkodGhpcy5yb3V0ZXIsIGFyZ3MpOwoKICAgIC8vIERvbid0
        IHNjaGVkdWxlIGxvYWRpbmcgc3RhdGUgZW50cnkgaWYgdXNlciBoYXMgYWxy
        ZWFkeSBhYm9ydGVkIHRoZSB0cmFuc2l0aW9uLgogICAgaWYgKHRoaXMucm91
        dGVyLmFjdGl2ZVRyYW5zaXRpb24pIHsKICAgICAgdGhpcy5fc2NoZWR1bGVM
        b2FkaW5nU3RhdGVFbnRyeSgpOwogICAgfQoKICAgIHRyYW5zaXRpb25Qcm9t
        aXNlLnRoZW4oZnVuY3Rpb24ocm91dGUpIHsKICAgICAgc2VsZi5fdHJhbnNp
        dGlvbkNvbXBsZXRlZChyb3V0ZSk7CiAgICB9LCBmdW5jdGlvbihlcnJvcikg
        ewogICAgICBpZiAoZXJyb3IubmFtZSA9PT0gIlVucmVjb2duaXplZFVSTEVy
        cm9yIikgewogICAgICAgIEVtYmVyLmFzc2VydCgiVGhlIFVSTCAnIiArIGVy
        cm9yLm1lc3NhZ2UgKyAiJyBkaWQgbm90IG1hdGNoIGFueSByb3V0ZXMgaW4g
        eW91ciBhcHBsaWNhdGlvbiIpOwogICAgICB9CiAgICB9KTsKCiAgICAvLyBX
        ZSB3YW50IHRvIHJldHVybiB0aGUgY29uZmlndXJhYmxlIHByb21pc2Ugb2Jq
        ZWN0CiAgICAvLyBzbyB0aGF0IGNhbGxlcnMgb2YgdGhpcyBmdW5jdGlvbiBj
        YW4gdXNlIGAubWV0aG9kKClgIG9uIGl0LAogICAgLy8gd2hpY2ggb2J2aW91
        c2x5IGRvZXNuJ3QgZXhpc3QgZm9yIG5vcm1hbCBSU1ZQIHByb21pc2VzLgog
        ICAgcmV0dXJuIHRyYW5zaXRpb25Qcm9taXNlOwogIH0sCgogIF9zY2hlZHVs
        ZUxvYWRpbmdTdGF0ZUVudHJ5OiBmdW5jdGlvbigpIHsKICAgIGlmICh0aGlz
        Ll9sb2FkaW5nU3RhdGVBY3RpdmUpIHsgcmV0dXJuOyB9CiAgICB0aGlzLl9z
        aG91bGRFbnRlckxvYWRpbmdTdGF0ZSA9IHRydWU7CiAgICBFbWJlci5ydW4u
        c2NoZWR1bGVPbmNlKCdyb3V0ZXJUcmFuc2l0aW9ucycsIHRoaXMsIHRoaXMu
        X2VudGVyTG9hZGluZ1N0YXRlKTsKICB9LAoKICBfZW50ZXJMb2FkaW5nU3Rh
        dGU6IGZ1bmN0aW9uKCkgewogICAgaWYgKHRoaXMuX2xvYWRpbmdTdGF0ZUFj
        dGl2ZSB8fCAhdGhpcy5fc2hvdWxkRW50ZXJMb2FkaW5nU3RhdGUpIHsgcmV0
        dXJuOyB9CgogICAgdmFyIGxvYWRpbmdSb3V0ZSA9IHRoaXMucm91dGVyLmdl
        dEhhbmRsZXIoJ2xvYWRpbmcnKTsKICAgIGlmIChsb2FkaW5nUm91dGUpIHsK
        ICAgICAgaWYgKGxvYWRpbmdSb3V0ZS5lbnRlcikgeyBsb2FkaW5nUm91dGUu
        ZW50ZXIoKTsgfQogICAgICBpZiAobG9hZGluZ1JvdXRlLnNldHVwKSB7IGxv
        YWRpbmdSb3V0ZS5zZXR1cCgpOyB9CiAgICAgIHRoaXMuX2xvYWRpbmdTdGF0
        ZUFjdGl2ZSA9IHRydWU7CiAgICB9CiAgfSwKCiAgX2V4aXRMb2FkaW5nU3Rh
        dGU6IGZ1bmN0aW9uICgpIHsKICAgIHRoaXMuX3Nob3VsZEVudGVyTG9hZGlu
        Z1N0YXRlID0gZmFsc2U7CiAgICBpZiAoIXRoaXMuX2xvYWRpbmdTdGF0ZUFj
        dGl2ZSkgeyByZXR1cm47IH0KCiAgICB2YXIgbG9hZGluZ1JvdXRlID0gdGhp
        cy5yb3V0ZXIuZ2V0SGFuZGxlcignbG9hZGluZycpOwogICAgaWYgKGxvYWRp
        bmdSb3V0ZSAmJiBsb2FkaW5nUm91dGUuZXhpdCkgeyBsb2FkaW5nUm91dGUu
        ZXhpdCgpOyB9CiAgICB0aGlzLl9sb2FkaW5nU3RhdGVBY3RpdmUgPSBmYWxz
        ZTsKICB9LAoKICBfdHJhbnNpdGlvbkNvbXBsZXRlZDogZnVuY3Rpb24ocm91
        dGUpIHsKICAgIHRoaXMubm90aWZ5UHJvcGVydHlDaGFuZ2UoJ3VybCcpOwog
        ICAgdGhpcy5fZXhpdExvYWRpbmdTdGF0ZSgpOwogIH0KfSk7CgpmdW5jdGlv
        biB0cmlnZ2VyRXZlbnQoaGFuZGxlckluZm9zLCBpZ25vcmVGYWlsdXJlLCBh
        cmdzKSB7CiAgdmFyIG5hbWUgPSBhcmdzLnNoaWZ0KCk7CgogIGlmICghaGFu
        ZGxlckluZm9zKSB7CiAgICBpZiAoaWdub3JlRmFpbHVyZSkgeyByZXR1cm47
        IH0KICAgIHRocm93IG5ldyBFbWJlci5FcnJvcigiQ291bGQgbm90IHRyaWdn
        ZXIgZXZlbnQgJyIgKyBuYW1lICsgIicuIFRoZXJlIGFyZSBubyBhY3RpdmUg
        aGFuZGxlcnMiKTsKICB9CgogIHZhciBldmVudFdhc0hhbmRsZWQgPSBmYWxz
        ZTsKCiAgZm9yICh2YXIgaT1oYW5kbGVySW5mb3MubGVuZ3RoLTE7IGk+PTA7
        IGktLSkgewogICAgdmFyIGhhbmRsZXJJbmZvID0gaGFuZGxlckluZm9zW2ld
        LAogICAgICAgIGhhbmRsZXIgPSBoYW5kbGVySW5mby5oYW5kbGVyOwoKICAg
        IGlmIChoYW5kbGVyLl9hY3Rpb25zICYmIGhhbmRsZXIuX2FjdGlvbnNbbmFt
        ZV0pIHsKICAgICAgaWYgKGhhbmRsZXIuX2FjdGlvbnNbbmFtZV0uYXBwbHko
        aGFuZGxlciwgYXJncykgPT09IHRydWUpIHsKICAgICAgICBldmVudFdhc0hh
        bmRsZWQgPSB0cnVlOwogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybjsK
        ICAgICAgfQogICAgfSBlbHNlIGlmIChoYW5kbGVyLmV2ZW50cyAmJiBoYW5k
        bGVyLmV2ZW50c1tuYW1lXSkgewogICAgICBFbWJlci5kZXByZWNhdGUoJ0Fj
        dGlvbiBoYW5kbGVycyBjb250YWluZWQgaW4gYW4gYGV2ZW50c2Agb2JqZWN0
        IGFyZSBkZXByZWNhdGVkIGluIGZhdm9yIG9mIHB1dHRpbmcgdGhlbSBpbiBh
        biBgYWN0aW9uc2Agb2JqZWN0ICgnICsgbmFtZSArICcgb24gJyArIGhhbmRs
        ZXIgKyAnKScsIGZhbHNlKTsKICAgICAgaWYgKGhhbmRsZXIuZXZlbnRzW25h
        bWVdLmFwcGx5KGhhbmRsZXIsIGFyZ3MpID09PSB0cnVlKSB7CiAgICAgICAg
        ZXZlbnRXYXNIYW5kbGVkID0gdHJ1ZTsKICAgICAgfSBlbHNlIHsKICAgICAg
        ICByZXR1cm47CiAgICAgIH0KICAgIH0KICB9CgogIGlmICghZXZlbnRXYXNI
        YW5kbGVkICYmICFpZ25vcmVGYWlsdXJlKSB7CiAgICB0aHJvdyBuZXcgRW1i
        ZXIuRXJyb3IoIk5vdGhpbmcgaGFuZGxlZCB0aGUgZXZlbnQgJyIgKyBuYW1l
        ICsgIicuIik7CiAgfQp9CgpFbWJlci5Sb3V0ZXIucmVvcGVuQ2xhc3Moewog
        IHJvdXRlcjogbnVsbCwKICBtYXA6IGZ1bmN0aW9uKGNhbGxiYWNrKSB7CiAg
        ICB2YXIgcm91dGVyID0gdGhpcy5yb3V0ZXI7CiAgICBpZiAoIXJvdXRlcikg
        ewogICAgICByb3V0ZXIgPSBuZXcgUm91dGVyKCk7CiAgICAgIHJvdXRlci5j
        YWxsYmFja3MgPSBbXTsKICAgICAgcm91dGVyLnRyaWdnZXJFdmVudCA9IHRy
        aWdnZXJFdmVudDsKICAgICAgdGhpcy5yZW9wZW5DbGFzcyh7IHJvdXRlcjog
        cm91dGVyIH0pOwogICAgfQoKICAgIGlmIChnZXQodGhpcywgJ25hbWVzcGFj
        ZS5MT0dfVFJBTlNJVElPTlNfSU5URVJOQUwnKSkgewogICAgICByb3V0ZXIu
        bG9nID0gRW1iZXIuTG9nZ2VyLmRlYnVnOwogICAgfQoKICAgIHZhciBkc2wg
        PSBFbWJlci5Sb3V0ZXJEU0wubWFwKGZ1bmN0aW9uKCkgewogICAgICB0aGlz
        LnJlc291cmNlKCdhcHBsaWNhdGlvbicsIHsgcGF0aDogIi8iIH0sIGZ1bmN0
        aW9uKCkgewogICAgICAgIGZvciAodmFyIGk9MDsgaSA8IHJvdXRlci5jYWxs
        YmFja3MubGVuZ3RoOyBpKyspIHsKICAgICAgICAgIHJvdXRlci5jYWxsYmFj
        a3NbaV0uY2FsbCh0aGlzKTsKICAgICAgICB9CiAgICAgICAgY2FsbGJhY2su
        Y2FsbCh0aGlzKTsKICAgICAgfSk7CiAgICB9KTsKCiAgICByb3V0ZXIuY2Fs
        bGJhY2tzLnB1c2goY2FsbGJhY2spOwogICAgcm91dGVyLm1hcChkc2wuZ2Vu
        ZXJhdGUoKSk7CiAgICByZXR1cm4gcm91dGVyOwogIH0sCgogIF9kZWZhdWx0
        RXJyb3JIYW5kbGVyOiBmdW5jdGlvbihlcnJvciwgdHJhbnNpdGlvbikgewog
        ICAgRW1iZXIuTG9nZ2VyLmVycm9yKCdFcnJvciB3aGlsZSBsb2FkaW5nIHJv
        dXRlOicsIGVycm9yKTsKCiAgICAvLyBVc2luZyBzZXRUaW1lb3V0IGFsbG93
        cyB1cyB0byBlc2NhcGUgZnJvbSB0aGUgUHJvbWlzZSdzIHRyeS9jYXRjaCBi
        bG9jawogICAgc2V0VGltZW91dChmdW5jdGlvbigpIHsgdGhyb3cgZXJyb3I7
        IH0pOwogIH0sCgogIF9yb3V0ZVBhdGg6IGZ1bmN0aW9uKGhhbmRsZXJJbmZv
        cykgewogICAgdmFyIHBhdGggPSBbXTsKCiAgICBmb3IgKHZhciBpPTEsIGw9
        aGFuZGxlckluZm9zLmxlbmd0aDsgaTxsOyBpKyspIHsKICAgICAgdmFyIG5h
        bWUgPSBoYW5kbGVySW5mb3NbaV0ubmFtZSwKICAgICAgICAgIG5hbWVQYXJ0
        cyA9IG5hbWUuc3BsaXQoIi4iKTsKCiAgICAgIHBhdGgucHVzaChuYW1lUGFy
        dHNbbmFtZVBhcnRzLmxlbmd0aCAtIDFdKTsKICAgIH0KCiAgICByZXR1cm4g
        cGF0aC5qb2luKCIuIik7CiAgfQp9KTsKCgp9KSgpOwoKCgooZnVuY3Rpb24o
        KSB7Ci8qKgpAbW9kdWxlIGVtYmVyCkBzdWJtb2R1bGUgZW1iZXItcm91dGlu
        ZwoqLwoKdmFyIGdldCA9IEVtYmVyLmdldCwgc2V0ID0gRW1iZXIuc2V0LAog
        ICAgZ2V0UHJvcGVydGllcyA9IEVtYmVyLmdldFByb3BlcnRpZXMsCiAgICBj
        bGFzc2lmeSA9IEVtYmVyLlN0cmluZy5jbGFzc2lmeSwKICAgIGZtdCA9IEVt
        YmVyLlN0cmluZy5mbXQsCiAgICBhX2ZvckVhY2ggPSBFbWJlci5FbnVtZXJh
        YmxlVXRpbHMuZm9yRWFjaCwKICAgIGFfcmVwbGFjZSA9IEVtYmVyLkVudW1l
        cmFibGVVdGlscy5yZXBsYWNlOwoKLyoqCiAgVGhlIGBFbWJlci5Sb3V0ZWAg
        Y2xhc3MgaXMgdXNlZCB0byBkZWZpbmUgaW5kaXZpZHVhbCByb3V0ZXMuIFJl
        ZmVyIHRvCiAgdGhlIFtyb3V0aW5nIGd1aWRlXShodHRwOi8vZW1iZXJqcy5j
        b20vZ3VpZGVzL3JvdXRpbmcvKSBmb3IgZG9jdW1lbnRhdGlvbi4KCiAgQGNs
        YXNzIFJvdXRlCiAgQG5hbWVzcGFjZSBFbWJlcgogIEBleHRlbmRzIEVtYmVy
        Lk9iamVjdAoqLwpFbWJlci5Sb3V0ZSA9IEVtYmVyLk9iamVjdC5leHRlbmQo
        RW1iZXIuQWN0aW9uSGFuZGxlciwgewogIC8qKgogICAgQHByaXZhdGUKCiAg
        ICBAbWV0aG9kIGV4aXQKICAqLwogIGV4aXQ6IGZ1bmN0aW9uKCkgewogICAg
        dGhpcy5kZWFjdGl2YXRlKCk7CiAgICB0aGlzLnRlYXJkb3duVmlld3MoKTsK
        ICB9LAoKICAvKioKICAgIEBwcml2YXRlCgogICAgQG1ldGhvZCBlbnRlcgog
        ICovCiAgZW50ZXI6IGZ1bmN0aW9uKCkgewogICAgdGhpcy5hY3RpdmF0ZSgp
        OwogIH0sCgogIC8qKgogICAgVGhlIGNvbGxlY3Rpb24gb2YgZnVuY3Rpb25z
        LCBrZXllZCBieSBuYW1lLCBhdmFpbGFibGUgb24gdGhpcyByb3V0ZSBhcwog
        ICAgYWN0aW9uIHRhcmdldHMuCgogICAgVGhlc2UgZnVuY3Rpb25zIHdpbGwg
        YmUgaW52b2tlZCB3aGVuIGEgbWF0Y2hpbmcgYHt7YWN0aW9ufX1gIGlzIHRy
        aWdnZXJlZAogICAgZnJvbSB3aXRoaW4gYSB0ZW1wbGF0ZSBhbmQgdGhlIGFw
        cGxpY2F0aW9uJ3MgY3VycmVudCByb3V0ZSBpcyB0aGlzIHJvdXRlLgoKICAg
        IEFjdGlvbnMgY2FuIGFsc28gYmUgaW52b2tlZCBmcm9tIG90aGVyIHBhcnRz
        IG9mIHlvdXIgYXBwbGljYXRpb24gdmlhIGBSb3V0ZSNzZW5kYAogICAgb3Ig
        YENvbnRyb2xsZXIjc2VuZGAuCgogICAgVGhlIGBhY3Rpb25zYCBoYXNoIHdp
        bGwgaW5oZXJpdCBhY3Rpb24gaGFuZGxlcnMgZnJvbQogICAgdGhlIGBhY3Rp
        b25zYCBoYXNoIGRlZmluZWQgb24gZXh0ZW5kZWQgUm91dGUgcGFyZW50IGNs
        YXNzZXMKICAgIG9yIG1peGlucyByYXRoZXIgdGhhbiBqdXN0IHJlcGxhY2Ug
        dGhlIGVudGlyZSBoYXNoLCBlLmcuOgoKICAgIGBgYGpzCiAgICBBcHAuQ2Fu
        RGlzcGxheUJhbm5lciA9IEVtYmVyLk1peGluLmNyZWF0ZSh7CiAgICAgIGFj
        dGlvbnM6IHsKICAgICAgICBkaXNwbGF5QmFubmVyOiBmdW5jdGlvbihtc2cp
        IHsKICAgICAgICAgIC8vIC4uLgogICAgICAgIH0KICAgICAgfQogICAgfSk7
        CgogICAgQXBwLldlbGNvbWVSb3V0ZSA9IEVtYmVyLlJvdXRlLmV4dGVuZChB
        cHAuQ2FuRGlzcGxheUJhbm5lciwgewogICAgICBhY3Rpb25zOiB7CiAgICAg
        ICAgcGxheU11c2ljOiBmdW5jdGlvbigpIHsKICAgICAgICAgIC8vIC4uLgog
        ICAgICAgIH0KICAgICAgfQogICAgfSk7CgogICAgLy8gYFdlbGNvbWVSb3V0
        ZWAsIHdoZW4gYWN0aXZlLCB3aWxsIGJlIGFibGUgdG8gcmVzcG9uZAogICAg
        Ly8gdG8gYm90aCBhY3Rpb25zLCBzaW5jZSB0aGUgYWN0aW9ucyBoYXNoIGlz
        IG1lcmdlZCByYXRoZXIKICAgIC8vIHRoZW4gcmVwbGFjZWQgd2hlbiBleHRl
        bmRpbmcgbWl4aW5zIC8gcGFyZW50IGNsYXNzZXMuCiAgICB0aGlzLnNlbmQo
        J2Rpc3BsYXlCYW5uZXInKTsKICAgIHRoaXMuc2VuZCgncGxheU11c2ljJyk7
        CiAgICBgYGAKCiAgICBXaXRoaW4gYSByb3V0ZSdzIGFjdGlvbiBoYW5kbGVy
        LCB0aGUgdmFsdWUgb2YgdGhlIGB0aGlzYCBjb250ZXh0CiAgICBpcyB0aGUg
        Um91dGUgb2JqZWN0OgoKICAgIGBgYGpzCiAgICBBcHAuU29uZ1JvdXRlID0g
        RW1iZXIuUm91dGUuZXh0ZW5kKHsKICAgICAgYWN0aW9uczogewogICAgICAg
        IG15QWN0aW9uOiBmdW5jdGlvbigpIHsKICAgICAgICAgIHRoaXMuY29udHJv
        bGxlckZvcigic29uZyIpOwogICAgICAgICAgdGhpcy50cmFuc2l0aW9uVG8o
        Im90aGVyLnJvdXRlIik7CiAgICAgICAgICAuLi4KICAgICAgICB9CiAgICAg
        IH0KICAgIH0pOwogICAgYGBgCgogICAgSXQgaXMgYWxzbyBwb3NzaWJsZSB0
        byBjYWxsIGB0aGlzLl9zdXBlcigpYCBmcm9tIHdpdGhpbiBhbgogICAgYWN0
        aW9uIGhhbmRsZXIgaWYgaXQgb3ZlcnJpZGVzIGEgaGFuZGxlciBkZWZpbmVk
        IG9uIGEgcGFyZW50CiAgICBjbGFzcyBvciBtaXhpbjoKCiAgICBUYWtlIGZv
        ciBleGFtcGxlIHRoZSBmb2xsb3dpbmcgcm91dGVzOgoKICAgIGBgYGpzCiAg
        ICBBcHAuRGVidWdSb3V0ZSA9IEVtYmVyLk1peGluLmNyZWF0ZSh7CiAgICAg
        IGFjdGlvbnM6IHsKICAgICAgICBkZWJ1Z1JvdXRlSW5mb3JtYXRpb246IGZ1
        bmN0aW9uKCkgewogICAgICAgICAgY29uc29sZS5kZWJ1ZygidHJvbG9sbyIp
        OwogICAgICAgIH0KICAgICAgfQogICAgfSk7CgogICAgQXBwLkFubm95aW5n
        RGVidWdSb3V0ZSA9IEVtYmVyLlJvdXRlLmV4dGVuZChBcHAuRGVidWdSb3V0
        ZSwgewogICAgICBhY3Rpb25zOiB7CiAgICAgICAgZGVidWdSb3V0ZUluZm9y
        bWF0aW9uOiBmdW5jdGlvbigpIHsKICAgICAgICAgIC8vIGFsc28gY2FsbCB0
        aGUgZGVidWdSb3V0ZUluZm9ybWF0aW9uIG9mIG1peGVkIGluIEFwcC5EZWJ1
        Z1JvdXRlCiAgICAgICAgICB0aGlzLl9zdXBlcigpOwoKICAgICAgICAgIC8v
        IHNob3cgYWRkaXRpb25hbCBhbm5veWFuY2UKICAgICAgICAgIHdpbmRvdy5h
        bGVydCguLi4pOwogICAgICAgIH0KICAgICAgfQogICAgfSk7CiAgICBgYGAK
        CiAgICAjIyBCdWJibGluZwoKICAgIEJ5IGRlZmF1bHQsIGFuIGFjdGlvbiB3
        aWxsIHN0b3AgYnViYmxpbmcgb25jZSBhIGhhbmRsZXIgZGVmaW5lZAogICAg
        b24gdGhlIGBhY3Rpb25zYCBoYXNoIGhhbmRsZXMgaXQuIFRvIGNvbnRpbnVl
        IGJ1YmJsaW5nIHRoZSBhY3Rpb24sCiAgICB5b3UgbXVzdCByZXR1cm4gYHRy
        dWVgIGZyb20gdGhlIGhhbmRsZXI6CgogICAgYGBganMKICAgIEFwcC5Sb3V0
        ZXIubWFwKGZ1bmN0aW9uKCkgewogICAgICB0aGlzLnJlc291cmNlKCJhbGJ1
        bSIsIGZ1bmN0aW9uKCkgewogICAgICAgIHRoaXMucm91dGUoInNvbmciKTsK
        ICAgICAgfSk7CiAgICB9KTsKCiAgICBBcHAuQWxidW1Sb3V0ZSA9IEVtYmVy
        LlJvdXRlLmV4dGVuZCh7CiAgICAgIGFjdGlvbnM6IHsKICAgICAgICBzdGFy
        dFBsYXlpbmc6IGZ1bmN0aW9uKCkgewogICAgICAgIH0KICAgICAgfQogICAg
        fSk7CgogICAgQXBwLkFsYnVtU29uZ1JvdXRlID0gRW1iZXIuUm91dGUuZXh0
        ZW5kKHsKICAgICAgYWN0aW9uczogewogICAgICAgIHN0YXJ0UGxheWluZzog
        ZnVuY3Rpb24oKSB7CiAgICAgICAgICAvLyAuLi4KCiAgICAgICAgICBpZiAo
        YWN0aW9uU2hvdWxkQWxzb0JlVHJpZ2dlcmVkT25QYXJlbnRSb3V0ZSkgewog
        ICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgIH0KICAgICAgICB9
        CiAgICAgIH0KICAgIH0pOwogICAgYGBgCgogICAgIyMgQnVpbHQtaW4gYWN0
        aW9ucwoKICAgIFRoZXJlIGFyZSBhIGZldyBidWlsdC1pbiBhY3Rpb25zIHBl
        cnRhaW5pbmcgdG8gdHJhbnNpdGlvbnMgdGhhdCB5b3UKICAgIGNhbiB1c2Ug
        dG8gY3VzdG9taXplIHRyYW5zaXRpb24gYmVoYXZpb3I6IGB3aWxsVHJhbnNp
        dGlvbmAgYW5kCiAgICBgZXJyb3JgLgoKICAgICMjIyBgd2lsbFRyYW5zaXRp
        b25gCgogICAgVGhlIGB3aWxsVHJhbnNpdGlvbmAgYWN0aW9uIGlzIGZpcmVk
        IGF0IHRoZSBiZWdpbm5pbmcgb2YgYW55CiAgICBhdHRlbXB0ZWQgdHJhbnNp
        dGlvbiB3aXRoIGEgYFRyYW5zaXRpb25gIG9iamVjdCBhcyB0aGUgc29sZQog
        ICAgYXJndW1lbnQuIFRoaXMgYWN0aW9uIGNhbiBiZSB1c2VkIGZvciBhYm9y
        dGluZywgcmVkaXJlY3RpbmcsCiAgICBvciBkZWNvcmF0aW5nIHRoZSB0cmFu
        c2l0aW9uIGZyb20gdGhlIGN1cnJlbnRseSBhY3RpdmUgcm91dGVzLgoKICAg
        IEEgZ29vZCBleGFtcGxlIGlzIHByZXZlbnRpbmcgbmF2aWdhdGlvbiB3aGVu
        IGEgZm9ybSBpcwogICAgaGFsZi1maWxsZWQgb3V0OgoKICAgIGBgYGpzCiAg
        ICBBcHAuQ29udGFjdEZvcm1Sb3V0ZSA9IEVtYmVyLlJvdXRlLmV4dGVuZCh7
        CiAgICAgIGFjdGlvbnM6IHsKICAgICAgICB3aWxsVHJhbnNpdGlvbjogZnVu
        Y3Rpb24odHJhbnNpdGlvbikgewogICAgICAgICAgaWYgKHRoaXMuY29udHJv
        bGxlci5nZXQoJ3VzZXJIYXNFbnRlcmVkRGF0YScpKSB7CiAgICAgICAgICAg
        IHRoaXMuY29udHJvbGxlci5kaXNwbGF5TmF2aWdhdGlvbkNvbmZpcm0oKTsK
        ICAgICAgICAgICAgdHJhbnNpdGlvbi5hYm9ydCgpOwogICAgICAgICAgfQog
        ICAgICAgIH0KICAgICAgfQogICAgfSk7CiAgICBgYGAKCiAgICBZb3UgY2Fu
        IGFsc28gcmVkaXJlY3QgZWxzZXdoZXJlIGJ5IGNhbGxpbmcKICAgIGB0aGlz
        LnRyYW5zaXRpb25UbygnZWxzZXdoZXJlJylgIGZyb20gd2l0aGluIGB3aWxs
        VHJhbnNpdGlvbmAuCiAgICBOb3RlIHRoYXQgYHdpbGxUcmFuc2l0aW9uYCB3
        aWxsIG5vdCBiZSBmaXJlZCBmb3IgdGhlCiAgICByZWRpcmVjdGluZyBgdHJh
        bnNpdGlvblRvYCwgc2luY2UgYHdpbGxUcmFuc2l0aW9uYCBkb2Vzbid0CiAg
        ICBmaXJlIHdoZW4gdGhlcmUgaXMgYWxyZWFkeSBhIHRyYW5zaXRpb24gdW5k
        ZXJ3YXkuIElmIHlvdSB3YW50CiAgICBzdWJzZXF1ZW50IGB3aWxsVHJhbnNp
        dGlvbmAgYWN0aW9ucyB0byBmaXJlIGZvciB0aGUgcmVkaXJlY3RpbmcKICAg
        IHRyYW5zaXRpb24sIHlvdSBtdXN0IGZpcnN0IGV4cGxpY2l0bHkgY2FsbAog
        ICAgYHRyYW5zaXRpb24uYWJvcnQoKWAuCgogICAgIyMjIGBlcnJvcmAKCiAg
        ICBXaGVuIGF0dGVtcHRpbmcgdG8gdHJhbnNpdGlvbiBpbnRvIGEgcm91dGUs
        IGFueSBvZiB0aGUgaG9va3MKICAgIG1heSB0aHJvdyBhbiBlcnJvciwgb3Ig
        cmV0dXJuIGEgcHJvbWlzZSB0aGF0IHJlamVjdHMsIGF0IHdoaWNoCiAgICBw
        b2ludCBhbiBgZXJyb3JgIGFjdGlvbiB3aWxsIGJlIGZpcmVkIG9uIHRoZSBw
        YXJ0aWFsbHktZW50ZXJlZAogICAgcm91dGVzLCBhbGxvd2luZyBmb3IgcGVy
        LXJvdXRlIGVycm9yIGhhbmRsaW5nIGxvZ2ljLCBvciBzaGFyZWQKICAgIGVy
        cm9yIGhhbmRsaW5nIGxvZ2ljIGRlZmluZWQgb24gYSBwYXJlbnQgcm91dGUu
        CgogICAgSGVyZSBpcyBhbiBleGFtcGxlIG9mIGFuIGVycm9yIGhhbmRsZXIg
        dGhhdCB3aWxsIGJlIGludm9rZWQKICAgIGZvciByZWplY3RlZCBwcm9taXNl
        cyAvIHRocm93biBlcnJvcnMgZnJvbSB0aGUgdmFyaW91cyBob29rcwogICAg
        b24gdGhlIHJvdXRlLCBhcyB3ZWxsIGFzIGFueSB1bmhhbmRsZWQgZXJyb3Jz
        IGZyb20gY2hpbGQKICAgIHJvdXRlczoKCiAgICBgYGBqcwogICAgQXBwLkFk
        bWluUm91dGUgPSBFbWJlci5Sb3V0ZS5leHRlbmQoewogICAgICBiZWZvcmVN
        b2RlbDogZnVuY3Rpb24oKSB7CiAgICAgICAgdGhyb3cgImJhZCB0aGluZ3Mh
        IjsKICAgICAgICAvLyAuLi5vciwgZXF1aXZhbGVudGx5OgogICAgICAgIHJl
        dHVybiBFbWJlci5SU1ZQLnJlamVjdCgiYmFkIHRoaW5ncyEiKTsKICAgICAg
        fSwKCiAgICAgIGFjdGlvbnM6IHsKICAgICAgICBlcnJvcjogZnVuY3Rpb24o
        ZXJyb3IsIHRyYW5zaXRpb24pIHsKICAgICAgICAgIC8vIEFzc3VtaW5nIHdl
        IGdvdCBoZXJlIGR1ZSB0byB0aGUgZXJyb3IgaW4gYGJlZm9yZU1vZGVsYCwK
        ICAgICAgICAgIC8vIHdlIGNhbiBleHBlY3QgdGhhdCBlcnJvciA9PT0gImJh
        ZCB0aGluZ3MhIiwKICAgICAgICAgIC8vIGJ1dCBhIHByb21pc2UgbW9kZWwg
        cmVqZWN0aW5nIHdvdWxkIGFsc28KICAgICAgICAgIC8vIGNhbGwgdGhpcyBo
        b29rLCBhcyB3b3VsZCBhbnkgZXJyb3JzIGVuY291bnRlcmVkCiAgICAgICAg
        ICAvLyBpbiBgYWZ0ZXJNb2RlbGAuCgogICAgICAgICAgLy8gVGhlIGBlcnJv
        cmAgaG9vayBpcyBhbHNvIHByb3ZpZGVkIHRoZSBmYWlsZWQKICAgICAgICAg
        IC8vIGB0cmFuc2l0aW9uYCwgd2hpY2ggY2FuIGJlIHN0b3JlZCBhbmQgbGF0
        ZXIKICAgICAgICAgIC8vIGAucmV0cnkoKWBkIGlmIGRlc2lyZWQuCgogICAg
        ICAgICAgdGhpcy50cmFuc2l0aW9uVG8oJ2xvZ2luJyk7CiAgICAgICAgfQog
        ICAgICB9CiAgICB9KTsKICAgIGBgYAoKICAgIGBlcnJvcmAgYWN0aW9ucyB0
        aGF0IGJ1YmJsZSB1cCBhbGwgdGhlIHdheSB0byBgQXBwbGljYXRpb25Sb3V0
        ZWAKICAgIHdpbGwgZmlyZSBhIGRlZmF1bHQgZXJyb3IgaGFuZGxlciB0aGF0
        IGxvZ3MgdGhlIGVycm9yLiBZb3UgY2FuCiAgICBzcGVjaWZ5IHlvdXIgb3du
        IGdsb2JhbCBkZWZhdWx0IGVycm9yIGhhbmRsZXIgYnkgb3ZlcnJpZGluZyB0
        aGUKICAgIGBlcnJvcmAgaGFuZGxlciBvbiBgQXBwbGljYXRpb25Sb3V0ZWA6
        CgogICAgYGBganMKICAgIEFwcC5BcHBsaWNhdGlvblJvdXRlID0gRW1iZXIu
        Um91dGUuZXh0ZW5kKHsKICAgICAgYWN0aW9uczogewogICAgICAgIGVycm9y
        OiBmdW5jdGlvbihlcnJvciwgdHJhbnNpdGlvbikgewogICAgICAgICAgdGhp
        cy5jb250cm9sbGVyRm9yKCdiYW5uZXInKS5kaXNwbGF5RXJyb3IoZXJyb3Iu
        bWVzc2FnZSk7CiAgICAgICAgfQogICAgICB9CiAgICB9KTsKICAgIGBgYAoK
        ICAgIEBzZWUge0VtYmVyLlJvdXRlI3NlbmR9CiAgICBAc2VlIHtIYW5kbGVi
        YXJzLmhlbHBlcnMuYWN0aW9ufQoKICAgIEBwcm9wZXJ0eSBhY3Rpb25zCiAg
        ICBAdHlwZSBIYXNoCiAgICBAZGVmYXVsdCBudWxsCiAgKi8KICBhY3Rpb25z
        OiBudWxsLAoKICAvKioKICAgIEBkZXByZWNhdGVkCgogICAgUGxlYXNlIHVz
        ZSBgYWN0aW9uc2AgaW5zdGVhZC4KICAgIEBtZXRob2QgZXZlbnRzCiAgKi8K
        ICBldmVudHM6IG51bGwsCgogIG1lcmdlZFByb3BlcnRpZXM6IFsnZXZlbnRz
        J10sCgogIC8qKgogICAgVGhpcyBob29rIGlzIGV4ZWN1dGVkIHdoZW4gdGhl
        IHJvdXRlciBjb21wbGV0ZWx5IGV4aXRzIHRoaXMgcm91dGUuIEl0IGlzCiAg
        ICBub3QgZXhlY3V0ZWQgd2hlbiB0aGUgbW9kZWwgZm9yIHRoZSByb3V0ZSBj
        aGFuZ2VzLgoKICAgIEBtZXRob2QgZGVhY3RpdmF0ZQogICovCiAgZGVhY3Rp
        dmF0ZTogRW1iZXIuSywKCiAgLyoqCiAgICBUaGlzIGhvb2sgaXMgZXhlY3V0
        ZWQgd2hlbiB0aGUgcm91dGVyIGVudGVycyB0aGUgcm91dGUgZm9yIHRoZSBm
        aXJzdCB0aW1lLgogICAgSXQgaXMgbm90IGV4ZWN1dGVkIHdoZW4gdGhlIG1v
        ZGVsIGZvciB0aGUgcm91dGUgY2hhbmdlcy4KCiAgICBAbWV0aG9kIGFjdGl2
        YXRlCiAgKi8KICBhY3RpdmF0ZTogRW1iZXIuSywKCiAgLyoqCiAgICBUcmFu
        c2l0aW9uIGludG8gYW5vdGhlciByb3V0ZS4gT3B0aW9uYWxseSBzdXBwbHkg
        bW9kZWwocykgZm9yIHRoZQogICAgcm91dGUgaW4gcXVlc3Rpb24uIElmIG11
        bHRpcGxlIG1vZGVscyBhcmUgc3VwcGxpZWQgdGhleSB3aWxsIGJlIGFwcGxp
        ZWQKICAgIGxhc3QgdG8gZmlyc3QgcmVjdXJzaXZlbHkgdXAgdGhlIHJlc291
        cmNlIHRyZWUgKHNlZSBNdWx0aXBsZSBNb2RlbHMgRXhhbXBsZQogICAgYmVs
        b3cpLiBUaGUgbW9kZWwocykgd2lsbCBiZSBzZXJpYWxpemVkIGludG8gdGhl
        IFVSTCB1c2luZyB0aGUgYXBwcm9wcmlhdGUgCiAgICByb3V0ZSdzIGBzZXJp
        YWxpemVgIGhvb2suIFNlZSBhbHNvICdyZXBsYWNlV2l0aCcuCgogICAgU2lt
        cGxlIFRyYW5zaXRpb24gRXhhbXBsZQoKICAgIGBgYGphdmFzY3JpcHQKICAg
        IEFwcC5Sb3V0ZXIubWFwKGZ1bmN0aW9uKCkgewogICAgICB0aGlzLnJvdXRl
        KCJpbmRleCIpOwogICAgICB0aGlzLnJvdXRlKCJzZWNyZXQiKTsKICAgICAg
        dGhpcy5yb3V0ZSgiZm91ck9oRm91ciIsIHsgcGF0aDogIio6In0pOwogICAg
        fSk7CgogICAgQXBwLkluZGV4Um91dGUgPSBFbWJlci5Sb3V0ZS5leHRlbmQo
        ewogICAgICBhY3Rpb25zOiB7CiAgICAgICAgbW92ZVRvU2VjcmV0OiBmdW5j
        dGlvbihjb250ZXh0KXsKICAgICAgICAgIGlmIChhdXRob3JpemVkKCkpewog
        ICAgICAgICAgICB0aGlzLnRyYW5zaXRpb25Ubygnc2VjcmV0JywgY29udGV4
        dCk7CiAgICAgICAgICB9CiAgICAgICAgICAgIHRoaXMudHJhbnNpdGlvblRv
        KCdmb3VyT2hGb3VyJyk7CiAgICAgICAgfQogICAgICB9CiAgICB9KTsKICAg
        IGBgYAoKICAgIE11bHRpcGxlIE1vZGVscyBFeGFtcGxlCgogICAgYGBgamF2
        YXNjcmlwdAogICAgQXBwLlJvdXRlci5tYXAoZnVuY3Rpb24oKSB7CiAgICAg
        IHRoaXMucm91dGUoImluZGV4Iik7CiAgICAgIHRoaXMucmVzb3VyY2UoJ2Jy
        ZWFrZmFzdCcsIHtwYXRoOic6YnJlYWtmYXN0SWQnfSwgZnVuY3Rpb24oKXsK
        ICAgICAgICB0aGlzLnJlc291cmNlKCdjZXJlYWwnLCB7cGF0aDogJzpjZXJl
        YWxJZCd9KTsKICAgICAgfSk7CiAgICB9KTsKCiAgICBBcHAuSW5kZXhSb3V0
        ZSA9IEVtYmVyLlJvdXRlLmV4dGVuZCh7CiAgICAgIGFjdGlvbnM6IHsKICAg
        ICAgICBtb3ZlVG9DaG9jb2xhdGVDZXJlYWw6IGZ1bmN0aW9uKCl7CiAgICAg
        ICAgICB2YXIgY2VyZWFsID0geyBjZXJlYWxJZDogIkNob2NvbGF0ZVl1bW1p
        bmVzcyJ9LAogICAgICAgICAgICAgIGJyZWFrZmFzdCA9IHticmVha2Zhc3RJ
        ZDogIkNlcmVhbEFuZE1pbGsifTsKCiAgICAgICAgICB0aGlzLnRyYW5zaXRp
        b25UbygnY2VyZWFsJywgYnJlYWtmYXN0LCBjZXJlYWwpOwogICAgICAgIH0K
        ICAgICAgfQogICAgfSk7CgogICAgQG1ldGhvZCB0cmFuc2l0aW9uVG8KICAg
        IEBwYXJhbSB7U3RyaW5nfSBuYW1lIHRoZSBuYW1lIG9mIHRoZSByb3V0ZQog
        ICAgQHBhcmFtIHsuLi5PYmplY3R9IG1vZGVscyB0aGUgbW9kZWwocykgdG8g
        YmUgdXNlZCB3aGlsZSB0cmFuc2l0aW9uaW5nCiAgICB0byB0aGUgcm91dGUu
        CiAgKi8KICB0cmFuc2l0aW9uVG86IGZ1bmN0aW9uKG5hbWUsIGNvbnRleHQp
        IHsKICAgIHZhciByb3V0ZXIgPSB0aGlzLnJvdXRlcjsKICAgIHJldHVybiBy
        b3V0ZXIudHJhbnNpdGlvblRvLmFwcGx5KHJvdXRlciwgYXJndW1lbnRzKTsK
        ICB9LAoKICAvKioKICAgIFRyYW5zaXRpb24gaW50byBhbm90aGVyIHJvdXRl
        IHdoaWxlIHJlcGxhY2luZyB0aGUgY3VycmVudCBVUkwsIGlmIHBvc3NpYmxl
        LgogICAgVGhpcyB3aWxsIHJlcGxhY2UgdGhlIGN1cnJlbnQgaGlzdG9yeSBl
        bnRyeSBpbnN0ZWFkIG9mIGFkZGluZyBhIG5ldyBvbmUuIAogICAgQmVzaWRl
        IHRoYXQsIGl0IGlzIGlkZW50aWNhbCB0byBgdHJhbnNpdGlvblRvYCBpbiBh
        bGwgb3RoZXIgcmVzcGVjdHMuIFNlZQogICAgJ3RyYW5zaXRpb25UbycgZm9y
        IGFkZGl0aW9uYWwgaW5mb3JtYXRpb24gcmVnYXJkaW5nIG11bHRpcGxlIG1v
        ZGVscy4KCiAgICBFeGFtcGxlCgogICAgYGBgamF2YXNjcmlwdAogICAgQXBw
        LlJvdXRlci5tYXAoZnVuY3Rpb24oKSB7CiAgICAgIHRoaXMucm91dGUoImlu
        ZGV4Iik7CiAgICAgIHRoaXMucm91dGUoInNlY3JldCIpOwogICAgfSk7Cgog
        ICAgQXBwLlNlY3JldFJvdXRlID0gRW1iZXIuUm91dGUuZXh0ZW5kKHsKICAg
        ICAgYWZ0ZXJNb2RlbDogZnVuY3Rpb24oKSB7CiAgICAgICAgaWYgKCFhdXRo
        b3JpemVkKCkpewogICAgICAgICAgdGhpcy5yZXBsYWNlV2l0aCgnaW5kZXgn
        KTsKICAgICAgICB9CiAgICAgIH0KICAgIH0pOwogICAgYGBgCgogICAgQG1l
        dGhvZCByZXBsYWNlV2l0aAogICAgQHBhcmFtIHtTdHJpbmd9IG5hbWUgdGhl
        IG5hbWUgb2YgdGhlIHJvdXRlCiAgICBAcGFyYW0gey4uLk9iamVjdH0gbW9k
        ZWxzIHRoZSBtb2RlbChzKSB0byBiZSB1c2VkIHdoaWxlIHRyYW5zaXRpb25p
        bmcKICAgIHRvIHRoZSByb3V0ZS4KICAqLwogIHJlcGxhY2VXaXRoOiBmdW5j
        dGlvbigpIHsKICAgIHZhciByb3V0ZXIgPSB0aGlzLnJvdXRlcjsKICAgIHJl
        dHVybiB0aGlzLnJvdXRlci5yZXBsYWNlV2l0aC5hcHBseSh0aGlzLnJvdXRl
        ciwgYXJndW1lbnRzKTsKICB9LAoKICAvKioKICAgIFNlbmRzIGFuIGFjdGlv
        biB0byB0aGUgcm91dGVyLCB3aGljaCB3aWxsIGRlbGVnYXRlIGl0IHRvIHRo
        ZSBjdXJyZW50bHkKICAgIGFjdGl2ZSByb3V0ZSBoaWVyYXJjaHkgcGVyIHRo
        ZSBidWJibGluZyBydWxlcyBleHBsYWluZWQgdW5kZXIgYGFjdGlvbnNgLgoK
        ICAgIEV4YW1wbGUKCiAgICBgYGBqYXZhc2NyaXB0CiAgICBBcHAuUm91dGVy
        Lm1hcChmdW5jdGlvbigpIHsKICAgICAgdGhpcy5yb3V0ZSgiaW5kZXgiKTsK
        ICAgIH0pOwoKICAgIEFwcC5BcHBsaWNhdGlvblJvdXRlID0gRW1iZXIuUm91
        dGUuZXh0ZW5kKHsKICAgICAgYWN0aW9uczogewogICAgICAgIHRyYWNrOiBm
        dW5jdGlvbihhcmcpIHsKICAgICAgICAgIGNvbnNvbGUubG9nKGFyZywgJ3dh
        cyBjbGlja2VkJyk7CiAgICAgICAgfQogICAgICB9CiAgICB9KTsKCiAgICBB
        cHAuSW5kZXhSb3V0ZSA9IEVtYmVyLlJvdXRlLmV4dGVuZCh7CiAgICAgIGFj
        dGlvbnM6IHsKICAgICAgICB0cmFja0lmRGVidWc6IGZ1bmN0aW9uKGFyZykg
        ewogICAgICAgICAgaWYgKGRlYnVnKSB7CiAgICAgICAgICAgIHRoaXMuc2Vu
        ZCgndHJhY2snLCBhcmcpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAg
        fQogICAgfSk7CiAgICBgYGAKCiAgICBAbWV0aG9kIHNlbmQKICAgIEBwYXJh
        bSB7U3RyaW5nfSBuYW1lIHRoZSBuYW1lIG9mIHRoZSBhY3Rpb24gdG8gdHJp
        Z2dlcgogICAgQHBhcmFtIHsuLi4qfSBhcmdzCiAgKi8KICBzZW5kOiBmdW5j
        dGlvbigpIHsKICAgIHJldHVybiB0aGlzLnJvdXRlci5zZW5kLmFwcGx5KHRo
        aXMucm91dGVyLCBhcmd1bWVudHMpOwogIH0sCgogIC8qKgogICAgQHByaXZh
        dGUKCiAgICBUaGlzIGhvb2sgaXMgdGhlIGVudHJ5IHBvaW50IGZvciByb3V0
        ZXIuanMKCiAgICBAbWV0aG9kIHNldHVwCiAgKi8KICBzZXR1cDogZnVuY3Rp
        b24oY29udGV4dCkgewogICAgdmFyIGNvbnRyb2xsZXJOYW1lID0gdGhpcy5j
        b250cm9sbGVyTmFtZSB8fCB0aGlzLnJvdXRlTmFtZSwKICAgICAgICBjb250
        cm9sbGVyID0gdGhpcy5jb250cm9sbGVyRm9yKGNvbnRyb2xsZXJOYW1lLCB0
        cnVlKTsKICAgIGlmICghY29udHJvbGxlcikgewogICAgICBjb250cm9sbGVy
        ID0gIHRoaXMuZ2VuZXJhdGVDb250cm9sbGVyKGNvbnRyb2xsZXJOYW1lLCBj
        b250ZXh0KTsKICAgIH0KCiAgICAvLyBBc3NpZ24gdGhlIHJvdXRlJ3MgY29u
        dHJvbGxlciBzbyB0aGF0IGl0IGNhbiBtb3JlIGVhc2lseSBiZQogICAgLy8g
        cmVmZXJlbmNlZCBpbiBhY3Rpb24gaGFuZGxlcnMKICAgIHRoaXMuY29udHJv
        bGxlciA9IGNvbnRyb2xsZXI7CgogICAgaWYgKHRoaXMuc2V0dXBDb250cm9s
        bGVycykgewogICAgICBFbWJlci5kZXByZWNhdGUoIkVtYmVyLlJvdXRlLnNl
        dHVwQ29udHJvbGxlcnMgaXMgZGVwcmVjYXRlZC4gUGxlYXNlIHVzZSBFbWJl
        ci5Sb3V0ZS5zZXR1cENvbnRyb2xsZXIoY29udHJvbGxlciwgbW9kZWwpIGlu
        c3RlYWQuIik7CiAgICAgIHRoaXMuc2V0dXBDb250cm9sbGVycyhjb250cm9s
        bGVyLCBjb250ZXh0KTsKICAgIH0gZWxzZSB7CiAgICAgIHRoaXMuc2V0dXBD
        b250cm9sbGVyKGNvbnRyb2xsZXIsIGNvbnRleHQpOwogICAgfQoKICAgIGlm
        ICh0aGlzLnJlbmRlclRlbXBsYXRlcykgewogICAgICBFbWJlci5kZXByZWNh
        dGUoIkVtYmVyLlJvdXRlLnJlbmRlclRlbXBsYXRlcyBpcyBkZXByZWNhdGVk
        LiBQbGVhc2UgdXNlIEVtYmVyLlJvdXRlLnJlbmRlclRlbXBsYXRlKGNvbnRy
        b2xsZXIsIG1vZGVsKSBpbnN0ZWFkLiIpOwogICAgICB0aGlzLnJlbmRlclRl
        bXBsYXRlcyhjb250ZXh0KTsKICAgIH0gZWxzZSB7CiAgICAgIHRoaXMucmVu
        ZGVyVGVtcGxhdGUoY29udHJvbGxlciwgY29udGV4dCk7CiAgICB9CiAgfSwK
        CiAgLyoqCiAgICBBIGhvb2sgeW91IGNhbiBpbXBsZW1lbnQgdG8gb3B0aW9u
        YWxseSByZWRpcmVjdCB0byBhbm90aGVyIHJvdXRlLgoKICAgIElmIHlvdSBj
        YWxsIGB0aGlzLnRyYW5zaXRpb25Ub2AgZnJvbSBpbnNpZGUgb2YgdGhpcyBo
        b29rLCB0aGlzIHJvdXRlCiAgICB3aWxsIG5vdCBiZSBlbnRlcmVkIGluIGZh
        dm9yIG9mIHRoZSBvdGhlciBob29rLgoKICAgIE5vdGUgdGhhdCB0aGlzIGhv
        b2sgaXMgY2FsbGVkIGJ5IHRoZSBkZWZhdWx0IGltcGxlbWVudGF0aW9uIG9m
        CiAgICBgYWZ0ZXJNb2RlbGAsIHNvIGlmIHlvdSBvdmVycmlkZSBgYWZ0ZXJN
        b2RlbGAsIHlvdSBtdXN0IGVpdGhlcgogICAgZXhwbGljaXRseSBjYWxsIGBy
        ZWRpcmVjdGAgb3IganVzdCBwdXQgeW91ciByZWRpcmVjdGluZwogICAgYHRo
        aXMudHJhbnNpdGlvblRvKClgIGNhbGwgd2l0aGluIGBhZnRlck1vZGVsYC4K
        CiAgICBAbWV0aG9kIHJlZGlyZWN0CiAgICBAcGFyYW0ge09iamVjdH0gbW9k
        ZWwgdGhlIG1vZGVsIGZvciB0aGlzIHJvdXRlCiAgKi8KICByZWRpcmVjdDog
        RW1iZXIuSywKCiAgLyoqCiAgICBUaGlzIGhvb2sgaXMgdGhlIGZpcnN0IG9m
        IHRoZSByb3V0ZSBlbnRyeSB2YWxpZGF0aW9uIGhvb2tzCiAgICBjYWxsZWQg
        d2hlbiBhbiBhdHRlbXB0IGlzIG1hZGUgdG8gdHJhbnNpdGlvbiBpbnRvIGEg
        cm91dGUKICAgIG9yIG9uZSBvZiBpdHMgY2hpbGRyZW4uIEl0IGlzIGNhbGxl
        ZCBiZWZvcmUgYG1vZGVsYCBhbmQKICAgIGBhZnRlck1vZGVsYCwgYW5kIGlz
        IGFwcHJvcHJpYXRlIGZvciBjYXNlcyB3aGVuOgoKICAgIDEpIEEgZGVjaXNp
        b24gY2FuIGJlIG1hZGUgdG8gcmVkaXJlY3QgZWxzZXdoZXJlIHdpdGhvdXQK
        ICAgICAgIG5lZWRpbmcgdG8gcmVzb2x2ZSB0aGUgbW9kZWwgZmlyc3QuCiAg
        ICAyKSBBbnkgYXN5bmMgb3BlcmF0aW9ucyBuZWVkIHRvIG9jY3VyIGZpcnN0
        IGJlZm9yZSB0aGUKICAgICAgIG1vZGVsIGlzIGF0dGVtcHRlZCB0byBiZSBy
        ZXNvbHZlZC4KCiAgICBUaGlzIGhvb2sgaXMgcHJvdmlkZWQgdGhlIGN1cnJl
        bnQgYHRyYW5zaXRpb25gIGF0dGVtcHQKICAgIGFzIGEgcGFyYW1ldGVyLCB3
        aGljaCBjYW4gYmUgdXNlZCB0byBgLmFib3J0KClgIHRoZSB0cmFuc2l0aW9u
        LAogICAgc2F2ZSBpdCBmb3IgYSBsYXRlciBgLnJldHJ5KClgLCBvciByZXRy
        aWV2ZSB2YWx1ZXMgc2V0CiAgICBvbiBpdCBmcm9tIGEgcHJldmlvdXMgaG9v
        ay4gWW91IGNhbiBhbHNvIGp1c3QgY2FsbAogICAgYHRoaXMudHJhbnNpdGlv
        blRvYCB0byBhbm90aGVyIHJvdXRlIHRvIGltcGxpY2l0bHkKICAgIGFib3J0
        IHRoZSBgdHJhbnNpdGlvbmAuCgogICAgWW91IGNhbiByZXR1cm4gYSBwcm9t
        aXNlIGZyb20gdGhpcyBob29rIHRvIHBhdXNlIHRoZQogICAgdHJhbnNpdGlv
        biB1bnRpbCB0aGUgcHJvbWlzZSByZXNvbHZlcyAob3IgcmVqZWN0cykuIFRo
        aXMgY291bGQKICAgIGJlIHVzZWZ1bCwgZm9yIGluc3RhbmNlLCBmb3IgcmV0
        cmlldmluZyBhc3luYyBjb2RlIGZyb20KICAgIHRoZSBzZXJ2ZXIgdGhhdCBp
        cyByZXF1aXJlZCB0byBlbnRlciBhIHJvdXRlLgoKICAgIGBgYGpzCiAgICBB
        cHAuUG9zdFJvdXRlID0gRW1iZXIuUm91dGUuZXh0ZW5kKHsKICAgICAgYmVm
        b3JlTW9kZWw6IGZ1bmN0aW9uKHRyYW5zaXRpb24pIHsKICAgICAgICBpZiAo
        IUFwcC5Qb3N0KSB7CiAgICAgICAgICByZXR1cm4gRW1iZXIuJC5nZXRTY3Jp
        cHQoJy9tb2RlbHMvcG9zdC5qcycpOwogICAgICAgIH0KICAgICAgfQogICAg
        fSk7CiAgICBgYGAKCiAgICBJZiBgQXBwLlBvc3RgIGRvZXNuJ3QgZXhpc3Qg
        aW4gdGhlIGFib3ZlIGV4YW1wbGUsCiAgICBgYmVmb3JlTW9kZWxgIHdpbGwg
        dXNlIGpRdWVyeSdzIGBnZXRTY3JpcHRgLCB3aGljaAogICAgcmV0dXJucyBh
        IHByb21pc2UgdGhhdCByZXNvbHZlcyBhZnRlciB0aGUgc2VydmVyIGhhcwog
        ICAgc3VjY2Vzc2Z1bGx5IHJldHJpZXZlZCBhbmQgZXhlY3V0ZWQgdGhlIGNv
        ZGUgZnJvbSB0aGUKICAgIHNlcnZlci4gTm90ZSB0aGF0IGlmIGFuIGVycm9y
        IHdlcmUgdG8gb2NjdXIsIGl0IHdvdWxkCiAgICBiZSBwYXNzZWQgdG8gdGhl
        IGBlcnJvcmAgaG9vayBvbiBgRW1iZXIuUm91dGVgLCBidXQKICAgIGl0J3Mg
        YWxzbyBwb3NzaWJsZSB0byBoYW5kbGUgZXJyb3JzIHNwZWNpZmljIHRvCiAg
        ICBgYmVmb3JlTW9kZWxgIHJpZ2h0IGZyb20gd2l0aGluIHRoZSBob29rICh0
        byBkaXN0aW5ndWlzaAogICAgZnJvbSB0aGUgc2hhcmVkIGVycm9yIGhhbmRs
        aW5nIGJlaGF2aW9yIG9mIHRoZSBgZXJyb3JgCiAgICBob29rKToKCiAgICBg
        YGBqcwogICAgQXBwLlBvc3RSb3V0ZSA9IEVtYmVyLlJvdXRlLmV4dGVuZCh7
        CiAgICAgIGJlZm9yZU1vZGVsOiBmdW5jdGlvbih0cmFuc2l0aW9uKSB7CiAg
        ICAgICAgaWYgKCFBcHAuUG9zdCkgewogICAgICAgICAgdmFyIHNlbGYgPSB0
        aGlzOwogICAgICAgICAgcmV0dXJuIEVtYmVyLiQuZ2V0U2NyaXB0KCdwb3N0
        LmpzJykudGhlbihudWxsLCBmdW5jdGlvbihlKSB7CiAgICAgICAgICAgIHNl
        bGYudHJhbnNpdGlvblRvKCdoZWxwJyk7CgogICAgICAgICAgICAvLyBOb3Rl
        IHRoYXQgdGhlIGFib3ZlIHRyYW5zaXRpb25UbyB3aWxsIGltcGxpY2l0bHkK
        ICAgICAgICAgICAgLy8gaGFsdCB0aGUgdHJhbnNpdGlvbi4gSWYgeW91IHdl
        cmUgdG8gcmV0dXJuCiAgICAgICAgICAgIC8vIG5vdGhpbmcgZnJvbSB0aGlz
        IHByb21pc2UgcmVqZWN0IGhhbmRsZXIsCiAgICAgICAgICAgIC8vIGFjY29y
        ZGluZyB0byBwcm9taXNlIHNlbWFudGljcywgdGhhdCB3b3VsZAogICAgICAg
        ICAgICAvLyBjb252ZXJ0IHRoZSByZWplY3QgaW50byBhIHJlc29sdmUgYW5k
        IHRoZQogICAgICAgICAgICAvLyB0cmFuc2l0aW9uIHdvdWxkIGNvbnRpbnVl
        LiBUbyBwcm9wYWdhdGUgdGhlCiAgICAgICAgICAgIC8vIGVycm9yIHNvIHRo
        YXQgaXQnZCBiZSBoYW5kbGVkIGJ5IHRoZSBgZXJyb3JgCiAgICAgICAgICAg
        IC8vIGhvb2ssIHlvdSB3b3VsZCBoYXZlIHRvIGVpdGhlcgogICAgICAgICAg
        ICByZXR1cm4gRW1iZXIuUlNWUC5yZWplY3QoZSk7CiAgICAgICAgICAgIC8v
        IG9yCiAgICAgICAgICAgIHRocm93IGU7CiAgICAgICAgICB9KTsKICAgICAg
        ICB9CiAgICAgIH0KICAgIH0pOwogICAgYGBgCgogICAgQG1ldGhvZCBiZWZv
        cmVNb2RlbAogICAgQHBhcmFtIHtUcmFuc2l0aW9ufSB0cmFuc2l0aW9uCiAg
        ICBAcmV0dXJuIHtQcm9taXNlfSBpZiB0aGUgdmFsdWUgcmV0dXJuZWQgZnJv
        bSB0aGlzIGhvb2sgaXMKICAgICAgYSBwcm9taXNlLCB0aGUgdHJhbnNpdGlv
        biB3aWxsIHBhdXNlIHVudGlsIHRoZSB0cmFuc2l0aW9uCiAgICAgIHJlc29s
        dmVzLiBPdGhlcndpc2UsIG5vbi1wcm9taXNlIHJldHVybiB2YWx1ZXMgYXJl
        IG5vdAogICAgICB1dGlsaXplZCBpbiBhbnkgd2F5LgogICovCiAgYmVmb3Jl
        TW9kZWw6IEVtYmVyLkssCgogIC8qKgogICAgVGhpcyBob29rIGlzIGNhbGxl
        ZCBhZnRlciB0aGlzIHJvdXRlJ3MgbW9kZWwgaGFzIHJlc29sdmVkLgogICAg
        SXQgZm9sbG93cyBpZGVudGljYWwgYXN5bmMvcHJvbWlzZSBzZW1hbnRpY3Mg
        dG8gYGJlZm9yZU1vZGVsYAogICAgYnV0IGlzIHByb3ZpZGVkIHRoZSByb3V0
        ZSdzIHJlc29sdmVkIG1vZGVsIGluIGFkZGl0aW9uIHRvCiAgICB0aGUgYHRy
        YW5zaXRpb25gLCBhbmQgaXMgdGhlcmVmb3JlIHN1aXRlZCB0byBwZXJmb3Jt
        aW5nCiAgICBsb2dpYyB0aGF0IGNhbiBvbmx5IHRha2UgcGxhY2UgYWZ0ZXIg
        dGhlIG1vZGVsIGhhcyBhbHJlYWR5CiAgICByZXNvbHZlZC4KCiAgICBgYGBq
        cwogICAgQXBwLlBvc3RzUm91dGUgPSBFbWJlci5Sb3V0ZS5leHRlbmQoewog
        ICAgICBhZnRlck1vZGVsOiBmdW5jdGlvbihwb3N0cywgdHJhbnNpdGlvbikg
        ewogICAgICAgIGlmIChwb3N0cy5sZW5ndGggPT09IDEpIHsKICAgICAgICAg
        IHRoaXMudHJhbnNpdGlvblRvKCdwb3N0LnNob3cnLCBwb3N0c1swXSk7CiAg
        ICAgICAgfQogICAgICB9CiAgICB9KTsKICAgIGBgYAoKICAgIFJlZmVyIHRv
        IGRvY3VtZW50YXRpb24gZm9yIGBiZWZvcmVNb2RlbGAgZm9yIGEgZGVzY3Jp
        cHRpb24KICAgIG9mIHRyYW5zaXRpb24tcGF1c2luZyBzZW1hbnRpY3Mgd2hl
        biBhIHByb21pc2UgaXMgcmV0dXJuZWQKICAgIGZyb20gdGhpcyBob29rLgoK
        ICAgIEBtZXRob2QgYWZ0ZXJNb2RlbAogICAgQHBhcmFtIHtPYmplY3R9IHJl
        c29sdmVkTW9kZWwgdGhlIHZhbHVlIHJldHVybmVkIGZyb20gYG1vZGVsYCwK
        ICAgICAgb3IgaXRzIHJlc29sdmVkIHZhbHVlIGlmIGl0IHdhcyBhIHByb21p
        c2UKICAgIEBwYXJhbSB7VHJhbnNpdGlvbn0gdHJhbnNpdGlvbgogICAgQHJl
        dHVybiB7UHJvbWlzZX0gaWYgdGhlIHZhbHVlIHJldHVybmVkIGZyb20gdGhp
        cyBob29rIGlzCiAgICAgIGEgcHJvbWlzZSwgdGhlIHRyYW5zaXRpb24gd2ls
        bCBwYXVzZSB1bnRpbCB0aGUgdHJhbnNpdGlvbgogICAgICByZXNvbHZlcy4g
        T3RoZXJ3aXNlLCBub24tcHJvbWlzZSByZXR1cm4gdmFsdWVzIGFyZSBub3QK
        ICAgICAgdXRpbGl6ZWQgaW4gYW55IHdheS4KICAgKi8KICBhZnRlck1vZGVs
        OiBmdW5jdGlvbihyZXNvbHZlZE1vZGVsLCB0cmFuc2l0aW9uKSB7CiAgICB0
        aGlzLnJlZGlyZWN0KHJlc29sdmVkTW9kZWwsIHRyYW5zaXRpb24pOwogIH0s
        CgoKICAvKioKICAgIEBwcml2YXRlCgogICAgQ2FsbGVkIHdoZW4gdGhlIGNv
        bnRleHQgaXMgY2hhbmdlZCBieSByb3V0ZXIuanMuCgogICAgQG1ldGhvZCBj
        b250ZXh0RGlkQ2hhbmdlCiAgKi8KICBjb250ZXh0RGlkQ2hhbmdlOiBmdW5j
        dGlvbigpIHsKICAgIHRoaXMuY3VycmVudE1vZGVsID0gdGhpcy5jb250ZXh0
        OwogIH0sCgogIC8qKgogICAgQSBob29rIHlvdSBjYW4gaW1wbGVtZW50IHRv
        IGNvbnZlcnQgdGhlIFVSTCBpbnRvIHRoZSBtb2RlbCBmb3IKICAgIHRoaXMg
        cm91dGUuCgogICAgYGBganMKICAgIEFwcC5Sb3V0ZXIubWFwKGZ1bmN0aW9u
        KCkgewogICAgICB0aGlzLnJlc291cmNlKCdwb3N0Jywge3BhdGg6ICcvcG9z
        dHMvOnBvc3RfaWQnfSk7CiAgICB9KTsKICAgIGBgYAoKICAgIFRoZSBtb2Rl
        bCBmb3IgdGhlIGBwb3N0YCByb3V0ZSBpcyBgQXBwLlBvc3QuZmluZChwYXJh
        bXMucG9zdF9pZClgLgoKICAgIEJ5IGRlZmF1bHQsIGlmIHlvdXIgcm91dGUg
        aGFzIGEgZHluYW1pYyBzZWdtZW50IGVuZGluZyBpbiBgX2lkYDoKCiAgICAq
        IFRoZSBtb2RlbCBjbGFzcyBpcyBkZXRlcm1pbmVkIGZyb20gdGhlIHNlZ21l
        bnQgKGBwb3N0X2lkYCdzCiAgICAgIGNsYXNzIGlzIGBBcHAuUG9zdGApCiAg
        ICAqIFRoZSBmaW5kIG1ldGhvZCBpcyBjYWxsZWQgb24gdGhlIG1vZGVsIGNs
        YXNzIHdpdGggdGhlIHZhbHVlIG9mCiAgICAgIHRoZSBkeW5hbWljIHNlZ21l
        bnQuCgogICAgTm90ZSB0aGF0IGZvciByb3V0ZXMgd2l0aCBkeW5hbWljIHNl
        Z21lbnRzLCB0aGlzIGhvb2sgaXMgb25seQogICAgZXhlY3V0ZWQgd2hlbiBl
        bnRlcmVkIHZpYSB0aGUgVVJMLiBJZiB0aGUgcm91dGUgaXMgZW50ZXJlZAog
        ICAgdGhyb3VnaCBhIHRyYW5zaXRpb24gKGUuZy4gd2hlbiB1c2luZyB0aGUg
        YGxpbmtUb2AgSGFuZGxlYmFycwogICAgaGVscGVyKSwgdGhlbiBhIG1vZGVs
        IGNvbnRleHQgaXMgYWxyZWFkeSBwcm92aWRlZCBhbmQgdGhpcyBob29rCiAg
        ICBpcyBub3QgY2FsbGVkLiBSb3V0ZXMgd2l0aG91dCBkeW5hbWljIHNlZ21l
        bnRzIHdpbGwgYWx3YXlzCiAgICBleGVjdXRlIHRoZSBtb2RlbCBob29rLgoK
        ICAgIFRoaXMgaG9vayBmb2xsb3dzIHRoZSBhc3luY2hyb25vdXMvcHJvbWlz
        ZSBzZW1hbnRpY3MKICAgIGRlc2NyaWJlZCBpbiB0aGUgZG9jdW1lbnRhdGlv
        biBmb3IgYGJlZm9yZU1vZGVsYC4gSW4gcGFydGljdWxhciwKICAgIGlmIGEg
        cHJvbWlzZSByZXR1cm5lZCBmcm9tIGBtb2RlbGAgZmFpbHMsIHRoZSBlcnJv
        ciB3aWxsIGJlCiAgICBoYW5kbGVkIGJ5IHRoZSBgZXJyb3JgIGhvb2sgb24g
        YEVtYmVyLlJvdXRlYC4KCiAgICBFeGFtcGxlCgogICAgYGBganMKICAgIEFw
        cC5Qb3N0Um91dGUgPSBFbWJlci5Sb3V0ZS5leHRlbmQoewogICAgICBtb2Rl
        bDogZnVuY3Rpb24ocGFyYW1zKSB7CiAgICAgICAgcmV0dXJuIEFwcC5Qb3N0
        LmZpbmQocGFyYW1zLnBvc3RfaWQpOwogICAgICB9CiAgICB9KTsKICAgIGBg
        YAoKICAgIEBtZXRob2QgbW9kZWwKICAgIEBwYXJhbSB7T2JqZWN0fSBwYXJh
        bXMgdGhlIHBhcmFtZXRlcnMgZXh0cmFjdGVkIGZyb20gdGhlIFVSTAogICAg
        QHBhcmFtIHtUcmFuc2l0aW9ufSB0cmFuc2l0aW9uCiAgICBAcmV0dXJuIHtP
        YmplY3R8UHJvbWlzZX0gdGhlIG1vZGVsIGZvciB0aGlzIHJvdXRlLiBJZgog
        ICAgICBhIHByb21pc2UgaXMgcmV0dXJuZWQsIHRoZSB0cmFuc2l0aW9uIHdp
        bGwgcGF1c2UgdW50aWwKICAgICAgdGhlIHByb21pc2UgcmVzb2x2ZXMsIGFu
        ZCB0aGUgcmVzb2x2ZWQgdmFsdWUgb2YgdGhlIHByb21pc2UKICAgICAgd2ls
        bCBiZSB1c2VkIGFzIHRoZSBtb2RlbCBmb3IgdGhpcyByb3V0ZS4KICAqLwog
        IG1vZGVsOiBmdW5jdGlvbihwYXJhbXMsIHRyYW5zaXRpb24pIHsKICAgIHZh
        ciBtYXRjaCwgbmFtZSwgc2F3UGFyYW1zLCB2YWx1ZTsKCiAgICBmb3IgKHZh
        ciBwcm9wIGluIHBhcmFtcykgewogICAgICBpZiAobWF0Y2ggPSBwcm9wLm1h
        dGNoKC9eKC4qKV9pZCQvKSkgewogICAgICAgIG5hbWUgPSBtYXRjaFsxXTsK
        ICAgICAgICB2YWx1ZSA9IHBhcmFtc1twcm9wXTsKICAgICAgfQogICAgICBz
        YXdQYXJhbXMgPSB0cnVlOwogICAgfQoKICAgIGlmICghbmFtZSAmJiBzYXdQ
        YXJhbXMpIHsgcmV0dXJuIHBhcmFtczsgfQogICAgZWxzZSBpZiAoIW5hbWUp
        IHsgcmV0dXJuOyB9CgogICAgcmV0dXJuIHRoaXMuZmluZE1vZGVsKG5hbWUs
        IHZhbHVlKTsKICB9LAoKICAvKioKCiAgICBAbWV0aG9kIGZpbmRNb2RlbAog
        ICAgQHBhcmFtIHtTdHJpbmd9IHR5cGUgdGhlIG1vZGVsIHR5cGUKICAgIEBw
        YXJhbSB7T2JqZWN0fSB2YWx1ZSB0aGUgdmFsdWUgcGFzc2VkIHRvIGZpbmQK
        ICAqLwogIGZpbmRNb2RlbDogZnVuY3Rpb24oKXsKICAgIHZhciBzdG9yZSA9
        IGdldCh0aGlzLCAnc3RvcmUnKTsKICAgIHJldHVybiBzdG9yZS5maW5kLmFw
        cGx5KHN0b3JlLCBhcmd1bWVudHMpOwogIH0sCgogIC8qKgogICAgU3RvcmUg
        cHJvcGVydHkgcHJvdmlkZXMgYSBob29rIGZvciBkYXRhIHBlcnNpc3RlbmNl
        IGxpYnJhcmllcyB0byBpbmplY3QgdGhlbXNlbHZlcy4KCiAgICBCeSBkZWZh
        dWx0LCB0aGlzIHN0b3JlIHByb3BlcnR5IHByb3ZpZGVzIHRoZSBleGFjdCBz
        YW1lIGZ1bmN0aW9uYWxpdHkgcHJldmlvdXNseQogICAgaW4gdGhlIG1vZGVs
        IGhvb2suCgogICAgQ3VycmVudGx5LCB0aGUgcmVxdWlyZWQgaW50ZXJmYWNl
        IGlzOgoKICAgIGBzdG9yZS5maW5kKG1vZGVsTmFtZSwgZmluZEFyZ3VtZW50
        cylgCgogICAgQG1ldGhvZCBzdG9yZQogICAgQHBhcmFtIHtPYmplY3R9IHN0
        b3JlCiAgKi8KICBzdG9yZTogRW1iZXIuY29tcHV0ZWQoZnVuY3Rpb24oKXsK
        ICAgIHZhciBjb250YWluZXIgPSB0aGlzLmNvbnRhaW5lcjsKICAgIHZhciBy
        b3V0ZU5hbWUgPSB0aGlzLnJvdXRlTmFtZTsKICAgIHZhciBuYW1lc3BhY2Ug
        PSBnZXQodGhpcywgJ3JvdXRlci5uYW1lc3BhY2UnKTsKCiAgICByZXR1cm4g
        ewogICAgICBmaW5kOiBmdW5jdGlvbihuYW1lLCB2YWx1ZSkgewogICAgICAg
        IHZhciBtb2RlbENsYXNzID0gY29udGFpbmVyLmxvb2t1cEZhY3RvcnkoJ21v
        ZGVsOicgKyBuYW1lKTsKCiAgICAgICAgRW1iZXIuYXNzZXJ0KCJZb3UgdXNl
        ZCB0aGUgZHluYW1pYyBzZWdtZW50ICIgKyBuYW1lICsgIl9pZCBpbiB5b3Vy
        IHJvdXRlICIrIHJvdXRlTmFtZSArICIsIGJ1dCAiICsgbmFtZXNwYWNlICsg
        Ii4iICsgY2xhc3NpZnkobmFtZSkgKyAiIGRpZCBub3QgZXhpc3QgYW5kIHlv
        dSBkaWQgbm90IG92ZXJyaWRlIHlvdXIgcm91dGUncyBgbW9kZWxgIGhvb2su
        IiwgbW9kZWxDbGFzcyk7CgogICAgICAgIHJldHVybiBtb2RlbENsYXNzLmZp
        bmQodmFsdWUpOwogICAgICB9CiAgICB9OwogIH0pLAoKICAvKioKICAgIEEg
        aG9vayB5b3UgY2FuIGltcGxlbWVudCB0byBjb252ZXJ0IHRoZSByb3V0ZSdz
        IG1vZGVsIGludG8gcGFyYW1ldGVycwogICAgZm9yIHRoZSBVUkwuCgogICAg
        YGBganMKICAgIEFwcC5Sb3V0ZXIubWFwKGZ1bmN0aW9uKCkgewogICAgICB0
        aGlzLnJlc291cmNlKCdwb3N0Jywge3BhdGg6ICcvcG9zdHMvOnBvc3RfaWQn
        fSk7CiAgICB9KTsKCiAgICBBcHAuUG9zdFJvdXRlID0gRW1iZXIuUm91dGUu
        ZXh0ZW5kKHsKICAgICAgbW9kZWw6IGZ1bmN0aW9uKHBhcmFtcykgewogICAg
        ICAgIC8vIHRoZSBzZXJ2ZXIgcmV0dXJucyBgeyBpZDogMTIgfWAKICAgICAg
        ICByZXR1cm4galF1ZXJ5LmdldEpTT04oIi9wb3N0cy8iICsgcGFyYW1zLnBv
        c3RfaWQpOwogICAgICB9LAoKICAgICAgc2VyaWFsaXplOiBmdW5jdGlvbiht
        b2RlbCkgewogICAgICAgIC8vIHRoaXMgd2lsbCBtYWtlIHRoZSBVUkwgYC9w
        b3N0cy8xMmAKICAgICAgICByZXR1cm4geyBwb3N0X2lkOiBtb2RlbC5pZCB9
        OwogICAgICB9CiAgICB9KTsKICAgIGBgYAoKICAgIFRoZSBkZWZhdWx0IGBz
        ZXJpYWxpemVgIG1ldGhvZCB3aWxsIGluc2VydCB0aGUgbW9kZWwncyBgaWRg
        IGludG8gdGhlCiAgICByb3V0ZSdzIGR5bmFtaWMgc2VnbWVudCAoaW4gdGhp
        cyBjYXNlLCBgOnBvc3RfaWRgKSBpZiB0aGUgc2VnbWVudCBjb250YWlucyAn
        X2lkJy4KICAgIElmIHRoZSByb3V0ZSBoYXMgbXVsdGlwbGUgZHluYW1pYyBz
        ZWdtZW50cyBvciBkb2VzIG5vdCBjb250YWluICdfaWQnLCBgc2VyaWFsaXpl
        YAogICAgd2lsbCByZXR1cm4gYEVtYmVyLmdldFByb3BlcnRpZXMobW9kZWws
        IHBhcmFtcylgCgogICAgVGhpcyBtZXRob2QgaXMgY2FsbGVkIHdoZW4gYHRy
        YW5zaXRpb25Ub2AgaXMgY2FsbGVkIHdpdGggYSBjb250ZXh0CiAgICBpbiBv
        cmRlciB0byBwb3B1bGF0ZSB0aGUgVVJMLgoKICAgIEBtZXRob2Qgc2VyaWFs
        aXplCiAgICBAcGFyYW0ge09iamVjdH0gbW9kZWwgdGhlIHJvdXRlJ3MgbW9k
        ZWwKICAgIEBwYXJhbSB7QXJyYXl9IHBhcmFtcyBhbiBBcnJheSBvZiBwYXJh
        bWV0ZXIgbmFtZXMgZm9yIHRoZSBjdXJyZW50CiAgICAgIHJvdXRlIChpbiB0
        aGUgZXhhbXBsZSwgYFsncG9zdF9pZCddYC4KICAgIEByZXR1cm4ge09iamVj
        dH0gdGhlIHNlcmlhbGl6ZWQgcGFyYW1ldGVycwogICovCiAgc2VyaWFsaXpl
        OiBmdW5jdGlvbihtb2RlbCwgcGFyYW1zKSB7CiAgICBpZiAocGFyYW1zLmxl
        bmd0aCA8IDEpIHsgcmV0dXJuOyB9CgogICAgdmFyIG5hbWUgPSBwYXJhbXNb
        MF0sIG9iamVjdCA9IHt9OwoKICAgIGlmICgvX2lkJC8udGVzdChuYW1lKSAm
        JiBwYXJhbXMubGVuZ3RoID09PSAxKSB7CiAgICAgIG9iamVjdFtuYW1lXSA9
        IGdldChtb2RlbCwgImlkIik7CiAgICB9IGVsc2UgewogICAgICBvYmplY3Qg
        PSBnZXRQcm9wZXJ0aWVzKG1vZGVsLCBwYXJhbXMpOwogICAgfQoKICAgIHJl
        dHVybiBvYmplY3Q7CiAgfSwKCiAgLyoqCiAgICBBIGhvb2sgeW91IGNhbiB1
        c2UgdG8gc2V0dXAgdGhlIGNvbnRyb2xsZXIgZm9yIHRoZSBjdXJyZW50IHJv
        dXRlLgoKICAgIFRoaXMgbWV0aG9kIGlzIGNhbGxlZCB3aXRoIHRoZSBjb250
        cm9sbGVyIGZvciB0aGUgY3VycmVudCByb3V0ZSBhbmQgdGhlCiAgICBtb2Rl
        bCBzdXBwbGllZCBieSB0aGUgYG1vZGVsYCBob29rLgoKICAgIEJ5IGRlZmF1
        bHQsIHRoZSBgc2V0dXBDb250cm9sbGVyYCBob29rIHNldHMgdGhlIGBjb250
        ZW50YCBwcm9wZXJ0eSBvZgogICAgdGhlIGNvbnRyb2xsZXIgdG8gdGhlIGBt
        b2RlbGAuCgogICAgVGhpcyBtZWFucyB0aGF0IHlvdXIgdGVtcGxhdGUgd2ls
        bCBnZXQgYSBwcm94eSBmb3IgdGhlIG1vZGVsIGFzIGl0cwogICAgY29udGV4
        dCwgYW5kIHlvdSBjYW4gYWN0IGFzIHRob3VnaCB0aGUgbW9kZWwgaXRzZWxm
        IHdhcyB0aGUgY29udGV4dC4KCiAgICBUaGUgcHJvdmlkZWQgY29udHJvbGxl
        ciB3aWxsIGJlIG9uZSByZXNvbHZlZCBiYXNlZCBvbiB0aGUgbmFtZQogICAg
        b2YgdGhpcyByb3V0ZS4KCiAgICBJZiBubyBleHBsaWNpdCBjb250cm9sbGVy
        IGlzIGRlZmluZWQsIEVtYmVyIHdpbGwgYXV0b21hdGljYWxseSBjcmVhdGUK
        ICAgIGFuIGFwcHJvcHJpYXRlIGNvbnRyb2xsZXIgZm9yIHRoZSBtb2RlbC4K
        CiAgICAqIGlmIHRoZSBtb2RlbCBpcyBhbiBgRW1iZXIuQXJyYXlgIChpbmNs
        dWRpbmcgcmVjb3JkIGFycmF5cyBmcm9tIEVtYmVyCiAgICAgIERhdGEpLCB0
        aGUgY29udHJvbGxlciBpcyBhbiBgRW1iZXIuQXJyYXlDb250cm9sbGVyYC4K
        ICAgICogb3RoZXJ3aXNlLCB0aGUgY29udHJvbGxlciBpcyBhbiBgRW1iZXIu
        T2JqZWN0Q29udHJvbGxlcmAuCgogICAgQXMgYW4gZXhhbXBsZSwgY29uc2lk
        ZXIgdGhlIHJvdXRlcjoKCiAgICBgYGBqcwogICAgQXBwLlJvdXRlci5tYXAo
        ZnVuY3Rpb24oKSB7CiAgICAgIHRoaXMucmVzb3VyY2UoJ3Bvc3QnLCB7cGF0
        aDogJy9wb3N0cy86cG9zdF9pZCd9KTsKICAgIH0pOwogICAgYGBgCgogICAg
        Rm9yIHRoZSBgcG9zdGAgcm91dGUsIGEgY29udHJvbGxlciBuYW1lZCBgQXBw
        LlBvc3RDb250cm9sbGVyYCB3b3VsZAogICAgYmUgdXNlZCBpZiBpdCBpcyBk
        ZWZpbmVkLiBJZiBpdCBpcyBub3QgZGVmaW5lZCwgYW4gYEVtYmVyLk9iamVj
        dENvbnRyb2xsZXJgCiAgICBpbnN0YW5jZSB3b3VsZCBiZSB1c2VkLgoKICAg
        IEV4YW1wbGUKICAgIGBgYGpzCiAgICBBcHAuUG9zdFJvdXRlID0gRW1iZXIu
        Um91dGUuZXh0ZW5kKHsKICAgICAgc2V0dXBDb250cm9sbGVyOiBmdW5jdGlv
        bihjb250cm9sbGVyLCBtb2RlbCkgewogICAgICAgIGNvbnRyb2xsZXIuc2V0
        KCdtb2RlbCcsIG1vZGVsKTsKICAgICAgfQogICAgfSk7CiAgICBgYGAKCiAg
        ICBAbWV0aG9kIHNldHVwQ29udHJvbGxlcgogICAgQHBhcmFtIHtDb250cm9s
        bGVyfSBjb250cm9sbGVyIGluc3RhbmNlCiAgICBAcGFyYW0ge09iamVjdH0g
        bW9kZWwKICAqLwogIHNldHVwQ29udHJvbGxlcjogZnVuY3Rpb24oY29udHJv
        bGxlciwgY29udGV4dCkgewogICAgaWYgKGNvbnRyb2xsZXIgJiYgKGNvbnRl
        eHQgIT09IHVuZGVmaW5lZCkpIHsKICAgICAgc2V0KGNvbnRyb2xsZXIsICdt
        b2RlbCcsIGNvbnRleHQpOwogICAgfQogIH0sCgogIC8qKgogICAgUmV0dXJu
        cyB0aGUgY29udHJvbGxlciBmb3IgYSBwYXJ0aWN1bGFyIHJvdXRlIG9yIG5h
        bWUuCgogICAgVGhlIGNvbnRyb2xsZXIgaW5zdGFuY2UgbXVzdCBhbHJlYWR5
        IGhhdmUgYmVlbiBjcmVhdGVkLCBlaXRoZXIgdGhyb3VnaCBlbnRlcmluZyB0
        aGUKICAgIGFzc29jaWF0ZWQgcm91dGUgb3IgdXNpbmcgYGdlbmVyYXRlQ29u
        dHJvbGxlcmAuCgogICAgYGBganMKICAgIEFwcC5Qb3N0Um91dGUgPSBFbWJl
        ci5Sb3V0ZS5leHRlbmQoewogICAgICBzZXR1cENvbnRyb2xsZXI6IGZ1bmN0
        aW9uKGNvbnRyb2xsZXIsIHBvc3QpIHsKICAgICAgICB0aGlzLl9zdXBlcihj
        b250cm9sbGVyLCBwb3N0KTsKICAgICAgICB0aGlzLmNvbnRyb2xsZXJGb3Io
        J3Bvc3RzJykuc2V0KCdjdXJyZW50UG9zdCcsIHBvc3QpOwogICAgICB9CiAg
        ICB9KTsKICAgIGBgYAoKICAgIEBtZXRob2QgY29udHJvbGxlckZvcgogICAg
        QHBhcmFtIHtTdHJpbmd9IG5hbWUgdGhlIG5hbWUgb2YgdGhlIHJvdXRlIG9y
        IGNvbnRyb2xsZXIKICAgIEByZXR1cm4ge0VtYmVyLkNvbnRyb2xsZXJ9CiAg
        Ki8KICBjb250cm9sbGVyRm9yOiBmdW5jdGlvbihuYW1lLCBfc2tpcEFzc2Vy
        dCkgewogICAgdmFyIGNvbnRhaW5lciA9IHRoaXMuY29udGFpbmVyLAogICAg
        ICAgIHJvdXRlID0gY29udGFpbmVyLmxvb2t1cCgncm91dGU6JytuYW1lKSwK
        ICAgICAgICBjb250cm9sbGVyOwoKICAgIGlmIChyb3V0ZSAmJiByb3V0ZS5j
        b250cm9sbGVyTmFtZSkgewogICAgICBuYW1lID0gcm91dGUuY29udHJvbGxl
        ck5hbWU7CiAgICB9CgogICAgY29udHJvbGxlciA9IGNvbnRhaW5lci5sb29r
        dXAoJ2NvbnRyb2xsZXI6JyArIG5hbWUpOwoKICAgIC8vIE5PVEU6IFdlJ3Jl
        IHNwZWNpZmljYWxseSBjaGVja2luZyB0aGF0IHNraXBBc3NlcnQgaXMgdHJ1
        ZSwgYmVjYXVzZSBhY2NvcmRpbmcKICAgIC8vICAgdG8gdGhlIG9sZCBBUEkg
        dGhlIHNlY29uZCBwYXJhbWV0ZXIgd2FzIG1vZGVsLiBXZSBkbyBub3Qgd2Fu
        dCBwZW9wbGUgd2hvCiAgICAvLyAgIHBhc3NlZCBhIG1vZGVsIHRvIHNraXAg
        dGhlIGFzc2VydGlvbi4KICAgIEVtYmVyLmFzc2VydCgiVGhlIGNvbnRyb2xs
        ZXIgbmFtZWQgJyIrbmFtZSsiJyBjb3VsZCBub3QgYmUgZm91bmQuIE1ha2Ug
        c3VyZSB0aGF0IHRoaXMgcm91dGUgZXhpc3RzIGFuZCBoYXMgYWxyZWFkeSBi
        ZWVuIGVudGVyZWQgYXQgbGVhc3Qgb25jZS4gSWYgeW91IGFyZSBhY2Nlc3Np
        bmcgYSBjb250cm9sbGVyIG5vdCBhc3NvY2lhdGVkIHdpdGggYSByb3V0ZSwg
        bWFrZSBzdXJlIHRoZSBjb250cm9sbGVyIGNsYXNzIGlzIGV4cGxpY2l0bHkg
        ZGVmaW5lZC4iLCBjb250cm9sbGVyIHx8IF9za2lwQXNzZXJ0ID09PSB0cnVl
        KTsKCiAgICByZXR1cm4gY29udHJvbGxlcjsKICB9LAoKICAvKioKICAgIEdl
        bmVyYXRlcyBhIGNvbnRyb2xsZXIgZm9yIGEgcm91dGUuCgogICAgSWYgdGhl
        IG9wdGlvbmFsIG1vZGVsIGlzIHBhc3NlZCB0aGVuIHRoZSBjb250cm9sbGVy
        IHR5cGUgaXMgZGV0ZXJtaW5lZCBhdXRvbWF0aWNhbGx5LAogICAgZS5nLiwg
        YW4gQXJyYXlDb250cm9sbGVyIGZvciBhcnJheXMuCgogICAgRXhhbXBsZQoK
        ICAgIGBgYGpzCiAgICBBcHAuUG9zdFJvdXRlID0gRW1iZXIuUm91dGUuZXh0
        ZW5kKHsKICAgICAgc2V0dXBDb250cm9sbGVyOiBmdW5jdGlvbihjb250cm9s
        bGVyLCBwb3N0KSB7CiAgICAgICAgdGhpcy5fc3VwZXIoY29udHJvbGxlciwg
        cG9zdCk7CiAgICAgICAgdGhpcy5nZW5lcmF0ZUNvbnRyb2xsZXIoJ3Bvc3Rz
        JywgcG9zdCk7CiAgICAgIH0KICAgIH0pOwogICAgYGBgCgogICAgQG1ldGhv
        ZCBnZW5lcmF0ZUNvbnRyb2xsZXIKICAgIEBwYXJhbSB7U3RyaW5nfSBuYW1l
        IHRoZSBuYW1lIG9mIHRoZSBjb250cm9sbGVyCiAgICBAcGFyYW0ge09iamVj
        dH0gbW9kZWwgdGhlIG1vZGVsIHRvIGluZmVyIHRoZSB0eXBlIG9mIHRoZSBj
        b250cm9sbGVyIChvcHRpb25hbCkKICAqLwogIGdlbmVyYXRlQ29udHJvbGxl
        cjogZnVuY3Rpb24obmFtZSwgbW9kZWwpIHsKICAgIHZhciBjb250YWluZXIg
        PSB0aGlzLmNvbnRhaW5lcjsKCiAgICBtb2RlbCA9IG1vZGVsIHx8IHRoaXMu
        bW9kZWxGb3IobmFtZSk7CgogICAgcmV0dXJuIEVtYmVyLmdlbmVyYXRlQ29u
        dHJvbGxlcihjb250YWluZXIsIG5hbWUsIG1vZGVsKTsKICB9LAoKICAvKioK
        ICAgIFJldHVybnMgdGhlIGN1cnJlbnQgbW9kZWwgZm9yIGEgZ2l2ZW4gcm91
        dGUuCgogICAgVGhpcyBpcyB0aGUgb2JqZWN0IHJldHVybmVkIGJ5IHRoZSBg
        bW9kZWxgIGhvb2sgb2YgdGhlIHJvdXRlCiAgICBpbiBxdWVzdGlvbi4KCiAg
        ICBFeGFtcGxlCgogICAgYGBganMKICAgIEFwcC5Sb3V0ZXIubWFwKGZ1bmN0
        aW9uKCkgewogICAgICAgIHRoaXMucmVzb3VyY2UoJ3Bvc3QnLCB7IHBhdGg6
        ICcvcG9zdC86cG9zdF9pZCcgfSwgZnVuY3Rpb24oKSB7CiAgICAgICAgICAg
        IHRoaXMucmVzb3VyY2UoJ2NvbW1lbnRzJyk7CiAgICAgICAgfSk7CiAgICB9
        KTsKCiAgICBBcHAuQ29tbWVudHNSb3V0ZSA9IEVtYmVyLlJvdXRlLmV4dGVu
        ZCh7CiAgICAgICAgYWZ0ZXJNb2RlbDogZnVuY3Rpb24oKSB7CiAgICAgICAg
        ICAgIHRoaXMuc2V0KCdwb3N0JywgdGhpcy5tb2RlbEZvcigncG9zdCcpKTsK
        ICAgICAgICB9CiAgICB9KTsKICAgIGBgYAoKICAgIEBtZXRob2QgbW9kZWxG
        b3IKICAgIEBwYXJhbSB7U3RyaW5nfSBuYW1lIHRoZSBuYW1lIG9mIHRoZSBy
        b3V0ZQogICAgQHJldHVybiB7T2JqZWN0fSB0aGUgbW9kZWwgb2JqZWN0CiAg
        Ki8KICBtb2RlbEZvcjogZnVuY3Rpb24obmFtZSkgewoKICAgIHZhciByb3V0
        ZSA9IHRoaXMuY29udGFpbmVyLmxvb2t1cCgncm91dGU6JyArIG5hbWUpLAog
        ICAgICAgIHRyYW5zaXRpb24gPSB0aGlzLnJvdXRlci5yb3V0ZXIuYWN0aXZl
        VHJhbnNpdGlvbjsKCiAgICAvLyBJZiB3ZSBhcmUgbWlkLXRyYW5zaXRpb24s
        IHdlIHdhbnQgdG8gdHJ5IGFuZCBsb29rIHVwCiAgICAvLyByZXNvbHZlZCBw
        YXJlbnQgY29udGV4dHMgb24gdGhlIGN1cnJlbnQgdHJhbnNpdGlvbkV2ZW50
        LgogICAgaWYgKHRyYW5zaXRpb24pIHsKICAgICAgdmFyIG1vZGVsTG9va3Vw
        TmFtZSA9IChyb3V0ZSAmJiByb3V0ZS5yb3V0ZU5hbWUpIHx8IG5hbWU7CiAg
        ICAgIGlmICh0cmFuc2l0aW9uLnJlc29sdmVkTW9kZWxzLmhhc093blByb3Bl
        cnR5KG1vZGVsTG9va3VwTmFtZSkpIHsKICAgICAgICByZXR1cm4gdHJhbnNp
        dGlvbi5yZXNvbHZlZE1vZGVsc1ttb2RlbExvb2t1cE5hbWVdOwogICAgICB9
        CiAgICB9CgogICAgcmV0dXJuIHJvdXRlICYmIHJvdXRlLmN1cnJlbnRNb2Rl
        bDsKICB9LAoKICAvKioKICAgIEEgaG9vayB5b3UgY2FuIHVzZSB0byByZW5k
        ZXIgdGhlIHRlbXBsYXRlIGZvciB0aGUgY3VycmVudCByb3V0ZS4KCiAgICBU
        aGlzIG1ldGhvZCBpcyBjYWxsZWQgd2l0aCB0aGUgY29udHJvbGxlciBmb3Ig
        dGhlIGN1cnJlbnQgcm91dGUgYW5kIHRoZQogICAgbW9kZWwgc3VwcGxpZWQg
        YnkgdGhlIGBtb2RlbGAgaG9vay4gQnkgZGVmYXVsdCwgaXQgcmVuZGVycyB0
        aGUgcm91dGUncwogICAgdGVtcGxhdGUsIGNvbmZpZ3VyZWQgd2l0aCB0aGUg
        Y29udHJvbGxlciBmb3IgdGhlIHJvdXRlLgoKICAgIFRoaXMgbWV0aG9kIGNh
        biBiZSBvdmVycmlkZGVuIHRvIHNldCB1cCBhbmQgcmVuZGVyIGFkZGl0aW9u
        YWwgb3IKICAgIGFsdGVybmF0aXZlIHRlbXBsYXRlcy4KCiAgICBgYGBqcwog
        ICAgQXBwLlBvc3RzUm91dGUgPSBFbWJlci5Sb3V0ZS5leHRlbmQoewogICAg
        ICByZW5kZXJUZW1wbGF0ZTogZnVuY3Rpb24oY29udHJvbGxlciwgbW9kZWwp
        IHsKICAgICAgICB2YXIgZmF2Q29udHJvbGxlciA9IHRoaXMuY29udHJvbGxl
        ckZvcignZmF2b3JpdGVQb3N0Jyk7CgogICAgICAgIC8vIFJlbmRlciB0aGUg
        YGZhdm9yaXRlUG9zdGAgdGVtcGxhdGUgaW50bwogICAgICAgIC8vIHRoZSBv
        dXRsZXQgYHBvc3RzYCwgYW5kIGRpc3BsYXkgdGhlIGBmYXZvcml0ZVBvc3Rg
        CiAgICAgICAgLy8gY29udHJvbGxlci4KICAgICAgICB0aGlzLnJlbmRlcign
        ZmF2b3JpdGVQb3N0JywgewogICAgICAgICAgb3V0bGV0OiAncG9zdHMnLAog
        ICAgICAgICAgY29udHJvbGxlcjogZmF2Q29udHJvbGxlcgogICAgICAgIH0p
        OwogICAgICB9CiAgICB9KTsKICAgIGBgYAoKICAgIEBtZXRob2QgcmVuZGVy
        VGVtcGxhdGUKICAgIEBwYXJhbSB7T2JqZWN0fSBjb250cm9sbGVyIHRoZSBy
        b3V0ZSdzIGNvbnRyb2xsZXIKICAgIEBwYXJhbSB7T2JqZWN0fSBtb2RlbCB0
        aGUgcm91dGUncyBtb2RlbAogICovCiAgcmVuZGVyVGVtcGxhdGU6IGZ1bmN0
        aW9uKGNvbnRyb2xsZXIsIG1vZGVsKSB7CiAgICB0aGlzLnJlbmRlcigpOwog
        IH0sCgogIC8qKgogICAgUmVuZGVycyBhIHRlbXBsYXRlIGludG8gYW4gb3V0
        bGV0LgoKICAgIFRoaXMgbWV0aG9kIGhhcyBhIG51bWJlciBvZiBkZWZhdWx0
        cywgYmFzZWQgb24gdGhlIG5hbWUgb2YgdGhlCiAgICByb3V0ZSBzcGVjaWZp
        ZWQgaW4gdGhlIHJvdXRlci4KCiAgICBGb3IgZXhhbXBsZToKCiAgICBgYGBq
        cwogICAgQXBwLlJvdXRlci5tYXAoZnVuY3Rpb24oKSB7CiAgICAgIHRoaXMu
        cm91dGUoJ2luZGV4Jyk7CiAgICAgIHRoaXMucmVzb3VyY2UoJ3Bvc3QnLCB7
        cGF0aDogJy9wb3N0cy86cG9zdF9pZCd9KTsKICAgIH0pOwoKICAgIEFwcC5Q
        b3N0Um91dGUgPSBBcHAuUm91dGUuZXh0ZW5kKHsKICAgICAgcmVuZGVyVGVt
        cGxhdGU6IGZ1bmN0aW9uKCkgewogICAgICAgIHRoaXMucmVuZGVyKCk7CiAg
        ICAgIH0KICAgIH0pOwogICAgYGBgCgogICAgVGhlIG5hbWUgb2YgdGhlIGBQ
        b3N0Um91dGVgLCBhcyBkZWZpbmVkIGJ5IHRoZSByb3V0ZXIsIGlzIGBwb3N0
        YC4KCiAgICBCeSBkZWZhdWx0LCByZW5kZXIgd2lsbDoKCiAgICAqIHJlbmRl
        ciB0aGUgYHBvc3RgIHRlbXBsYXRlCiAgICAqIHdpdGggdGhlIGBwb3N0YCB2
        aWV3IChgUG9zdFZpZXdgKSBmb3IgZXZlbnQgaGFuZGxpbmcsIGlmIG9uZSBl
        eGlzdHMKICAgICogYW5kIHRoZSBgcG9zdGAgY29udHJvbGxlciAoYFBvc3RD
        b250cm9sbGVyYCksIGlmIG9uZSBleGlzdHMKICAgICogaW50byB0aGUgYG1h
        aW5gIG91dGxldCBvZiB0aGUgYGFwcGxpY2F0aW9uYCB0ZW1wbGF0ZQoKICAg
        IFlvdSBjYW4gb3ZlcnJpZGUgdGhpcyBiZWhhdmlvcjoKCiAgICBgYGBqcwog
        ICAgQXBwLlBvc3RSb3V0ZSA9IEFwcC5Sb3V0ZS5leHRlbmQoewogICAgICBy
        ZW5kZXJUZW1wbGF0ZTogZnVuY3Rpb24oKSB7CiAgICAgICAgdGhpcy5yZW5k
        ZXIoJ215UG9zdCcsIHsgICAvLyB0aGUgdGVtcGxhdGUgdG8gcmVuZGVyCiAg
        ICAgICAgICBpbnRvOiAnaW5kZXgnLCAgICAgICAgICAvLyB0aGUgdGVtcGxh
        dGUgdG8gcmVuZGVyIGludG8KICAgICAgICAgIG91dGxldDogJ2RldGFpbCcs
        ICAgICAgIC8vIHRoZSBuYW1lIG9mIHRoZSBvdXRsZXQgaW4gdGhhdCB0ZW1w
        bGF0ZQogICAgICAgICAgY29udHJvbGxlcjogJ2Jsb2dQb3N0JyAgLy8gdGhl
        IGNvbnRyb2xsZXIgdG8gdXNlIGZvciB0aGUgdGVtcGxhdGUKICAgICAgICB9
        KTsKICAgICAgfQogICAgfSk7CiAgICBgYGAKCiAgICBSZW1lbWJlciB0aGF0
        IHRoZSBjb250cm9sbGVyJ3MgYGNvbnRlbnRgIHdpbGwgYmUgdGhlIHJvdXRl
        J3MgbW9kZWwuIEluCiAgICB0aGlzIGNhc2UsIHRoZSBkZWZhdWx0IG1vZGVs
        IHdpbGwgYmUgYEFwcC5Qb3N0LmZpbmQocGFyYW1zLnBvc3RfaWQpYC4KCiAg
        ICBAbWV0aG9kIHJlbmRlcgogICAgQHBhcmFtIHtTdHJpbmd9IG5hbWUgdGhl
        IG5hbWUgb2YgdGhlIHRlbXBsYXRlIHRvIHJlbmRlcgogICAgQHBhcmFtIHtP
        YmplY3R9IG9wdGlvbnMgdGhlIG9wdGlvbnMKICAqLwogIHJlbmRlcjogZnVu
        Y3Rpb24obmFtZSwgb3B0aW9ucykgewogICAgRW1iZXIuYXNzZXJ0KCJUaGUg
        bmFtZSBpbiB0aGUgZ2l2ZW4gYXJndW1lbnRzIGlzIHVuZGVmaW5lZCIsIGFy
        Z3VtZW50cy5sZW5ndGggPiAwID8gIUVtYmVyLmlzTm9uZShhcmd1bWVudHNb
        MF0pIDogdHJ1ZSk7CgogICAgdmFyIG5hbWVQYXNzZWQgPSAhIW5hbWU7Cgog
        ICAgaWYgKHR5cGVvZiBuYW1lID09PSAnb2JqZWN0JyAmJiAhb3B0aW9ucykg
        ewogICAgICBvcHRpb25zID0gbmFtZTsKICAgICAgbmFtZSA9IHRoaXMucm91
        dGVOYW1lOwogICAgfQoKICAgIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9Owog
        ICAgbmFtZSA9IG5hbWUgPyBuYW1lLnJlcGxhY2UoL1wvL2csICcuJykgOiB0
        aGlzLnJvdXRlTmFtZTsKICAgIHZhciB2aWV3TmFtZSA9IG9wdGlvbnMudmll
        dyB8fCB0aGlzLnZpZXdOYW1lIHx8IG5hbWU7CiAgICB2YXIgdGVtcGxhdGVO
        YW1lID0gdGhpcy50ZW1wbGF0ZU5hbWUgfHwgbmFtZTsKCiAgICB2YXIgY29u
        dGFpbmVyID0gdGhpcy5jb250YWluZXIsCiAgICAgICAgdmlldyA9IGNvbnRh
        aW5lci5sb29rdXAoJ3ZpZXc6JyArIHZpZXdOYW1lKSwKICAgICAgICB0ZW1w
        bGF0ZSA9IHZpZXcgPyB2aWV3LmdldCgndGVtcGxhdGUnKSA6IG51bGw7Cgog
        ICAgaWYgKCF0ZW1wbGF0ZSkgewogICAgICB0ZW1wbGF0ZSA9IGNvbnRhaW5l
        ci5sb29rdXAoJ3RlbXBsYXRlOicgKyB0ZW1wbGF0ZU5hbWUpOwogICAgfQoK
        ICAgIGlmICghdmlldyAmJiAhdGVtcGxhdGUpIHsKICAgICAgRW1iZXIuYXNz
        ZXJ0KCJDb3VsZCBub3QgZmluZCBcIiIgKyBuYW1lICsgIlwiIHRlbXBsYXRl
        IG9yIHZpZXcuIiwgIW5hbWVQYXNzZWQpOwogICAgICBpZiAoZ2V0KHRoaXMu
        cm91dGVyLCAnbmFtZXNwYWNlLkxPR19WSUVXX0xPT0tVUFMnKSkgewogICAg
        ICAgIEVtYmVyLkxvZ2dlci5pbmZvKCJDb3VsZCBub3QgZmluZCBcIiIgKyBu
        YW1lICsgIlwiIHRlbXBsYXRlIG9yIHZpZXcuIE5vdGhpbmcgd2lsbCBiZSBy
        ZW5kZXJlZCIsIHsgZnVsbE5hbWU6ICd0ZW1wbGF0ZTonICsgbmFtZSB9KTsK
        ICAgICAgfQogICAgICByZXR1cm47CiAgICB9CgogICAgb3B0aW9ucyA9IG5v
        cm1hbGl6ZU9wdGlvbnModGhpcywgbmFtZSwgdGVtcGxhdGUsIG9wdGlvbnMp
        OwogICAgdmlldyA9IHNldHVwVmlldyh2aWV3LCBjb250YWluZXIsIG9wdGlv
        bnMpOwoKICAgIGlmIChvcHRpb25zLm91dGxldCA9PT0gJ21haW4nKSB7IHRo
        aXMubGFzdFJlbmRlcmVkVGVtcGxhdGUgPSBuYW1lOyB9CgogICAgYXBwZW5k
        Vmlldyh0aGlzLCB2aWV3LCBvcHRpb25zKTsKICB9LAoKICAvKioKICAgIERp
        c2Nvbm5lY3RzIGEgdmlldyB0aGF0IGhhcyBiZWVuIHJlbmRlcmVkIGludG8g
        YW4gb3V0bGV0LgoKICAgIFlvdSBtYXkgcGFzcyBhbnkgb3IgYWxsIG9mIHRo
        ZSBmb2xsb3dpbmcgb3B0aW9ucyB0byBgZGlzY29ubmVjdE91dGxldGA6Cgog
        ICAgKiBgb3V0bGV0YDogdGhlIG5hbWUgb2YgdGhlIG91dGxldCB0byBjbGVh
        ciAoZGVmYXVsdDogJ21haW4nKQogICAgKiBgcGFyZW50Vmlld2A6IHRoZSBu
        YW1lIG9mIHRoZSB2aWV3IGNvbnRhaW5pbmcgdGhlIG91dGxldCB0byBjbGVh
        cgogICAgICAgKGRlZmF1bHQ6IHRoZSB2aWV3IHJlbmRlcmVkIGJ5IHRoZSBw
        YXJlbnQgcm91dGUpCgogICAgRXhhbXBsZToKCiAgICBgYGBqcwogICAgQXBw
        LkFwcGxpY2F0aW9uUm91dGUgPSBBcHAuUm91dGUuZXh0ZW5kKHsKICAgICAg
        YWN0aW9uczogewogICAgICAgIHNob3dNb2RhbDogZnVuY3Rpb24oZXZ0KSB7
        CiAgICAgICAgICB0aGlzLnJlbmRlcihldnQubW9kYWxOYW1lLCB7CiAgICAg
        ICAgICAgIG91dGxldDogJ21vZGFsJywKICAgICAgICAgICAgaW50bzogJ2Fw
        cGxpY2F0aW9uJwogICAgICAgICAgfSk7CiAgICAgICAgfSwKICAgICAgICBo
        aWRlTW9kYWw6IGZ1bmN0aW9uKGV2dCkgewogICAgICAgICAgdGhpcy5kaXNj
        b25uZWN0T3V0bGV0KHsKICAgICAgICAgICAgb3V0bGV0OiAnbW9kYWwnLAog
        ICAgICAgICAgICBwYXJlbnRWaWV3OiAnYXBwbGljYXRpb24nCiAgICAgICAg
        ICB9KTsKICAgICAgICB9CiAgICAgIH0KICAgIH0pOwogICAgYGBgCgogICAg
        QG1ldGhvZCBkaXNjb25uZWN0T3V0bGV0CiAgICBAcGFyYW0ge09iamVjdH0g
        b3B0aW9ucyB0aGUgb3B0aW9ucwogICovCiAgZGlzY29ubmVjdE91dGxldDog
        ZnVuY3Rpb24ob3B0aW9ucykgewogICAgb3B0aW9ucyA9IG9wdGlvbnMgfHwg
        e307CiAgICBvcHRpb25zLnBhcmVudFZpZXcgPSBvcHRpb25zLnBhcmVudFZp
        ZXcgPyBvcHRpb25zLnBhcmVudFZpZXcucmVwbGFjZSgvXC8vZywgJy4nKSA6
        IHBhcmVudFRlbXBsYXRlKHRoaXMpOwogICAgb3B0aW9ucy5vdXRsZXQgPSBv
        cHRpb25zLm91dGxldCB8fCAnbWFpbic7CgogICAgdmFyIHBhcmVudFZpZXcg
        PSB0aGlzLnJvdXRlci5fbG9va3VwQWN0aXZlVmlldyhvcHRpb25zLnBhcmVu
        dFZpZXcpOwogICAgcGFyZW50Vmlldy5kaXNjb25uZWN0T3V0bGV0KG9wdGlv
        bnMub3V0bGV0KTsKICB9LAoKICB3aWxsRGVzdHJveTogZnVuY3Rpb24oKSB7
        CiAgICB0aGlzLnRlYXJkb3duVmlld3MoKTsKICB9LAoKICAvKioKICAgIEBw
        cml2YXRlCgogICAgQG1ldGhvZCB0ZWFyZG93blZpZXdzCiAgKi8KICB0ZWFy
        ZG93blZpZXdzOiBmdW5jdGlvbigpIHsKICAgIC8vIFRlYXIgZG93biB0aGUg
        dG9wIGxldmVsIHZpZXcKICAgIGlmICh0aGlzLnRlYXJkb3duVG9wTGV2ZWxW
        aWV3KSB7IHRoaXMudGVhcmRvd25Ub3BMZXZlbFZpZXcoKTsgfQoKICAgIC8v
        IFRlYXIgZG93biBhbnkgb3V0bGV0cyByZW5kZXJlZCB3aXRoICdpbnRvJwog
        ICAgdmFyIHRlYXJkb3duT3V0bGV0Vmlld3MgPSB0aGlzLnRlYXJkb3duT3V0
        bGV0Vmlld3MgfHwgW107CiAgICBhX2ZvckVhY2godGVhcmRvd25PdXRsZXRW
        aWV3cywgZnVuY3Rpb24odGVhcmRvd25PdXRsZXRWaWV3KSB7CiAgICAgIHRl
        YXJkb3duT3V0bGV0VmlldygpOwogICAgfSk7CgogICAgZGVsZXRlIHRoaXMu
        dGVhcmRvd25Ub3BMZXZlbFZpZXc7CiAgICBkZWxldGUgdGhpcy50ZWFyZG93
        bk91dGxldFZpZXdzOwogICAgZGVsZXRlIHRoaXMubGFzdFJlbmRlcmVkVGVt
        cGxhdGU7CiAgfQp9KTsKCmZ1bmN0aW9uIHBhcmVudFJvdXRlKHJvdXRlKSB7
        CiAgdmFyIGhhbmRsZXJJbmZvcyA9IHJvdXRlLnJvdXRlci5yb3V0ZXIudGFy
        Z2V0SGFuZGxlckluZm9zOwoKICBpZiAoIWhhbmRsZXJJbmZvcykgeyByZXR1
        cm47IH0KCiAgdmFyIHBhcmVudCwgY3VycmVudDsKCiAgZm9yICh2YXIgaT0w
        LCBsPWhhbmRsZXJJbmZvcy5sZW5ndGg7IGk8bDsgaSsrKSB7CiAgICBjdXJy
        ZW50ID0gaGFuZGxlckluZm9zW2ldLmhhbmRsZXI7CiAgICBpZiAoY3VycmVu
        dCA9PT0gcm91dGUpIHsgcmV0dXJuIHBhcmVudDsgfQogICAgcGFyZW50ID0g
        Y3VycmVudDsKICB9Cn0KCmZ1bmN0aW9uIHBhcmVudFRlbXBsYXRlKHJvdXRl
        KSB7CiAgdmFyIHBhcmVudCA9IHBhcmVudFJvdXRlKHJvdXRlKSwgdGVtcGxh
        dGU7CgogIGlmICghcGFyZW50KSB7IHJldHVybjsgfQoKICBpZiAodGVtcGxh
        dGUgPSBwYXJlbnQubGFzdFJlbmRlcmVkVGVtcGxhdGUpIHsKICAgIHJldHVy
        biB0ZW1wbGF0ZTsKICB9IGVsc2UgewogICAgcmV0dXJuIHBhcmVudFRlbXBs
        YXRlKHBhcmVudCk7CiAgfQp9CgpmdW5jdGlvbiBub3JtYWxpemVPcHRpb25z
        KHJvdXRlLCBuYW1lLCB0ZW1wbGF0ZSwgb3B0aW9ucykgewogIG9wdGlvbnMg
        PSBvcHRpb25zIHx8IHt9OwogIG9wdGlvbnMuaW50byA9IG9wdGlvbnMuaW50
        byA/IG9wdGlvbnMuaW50by5yZXBsYWNlKC9cLy9nLCAnLicpIDogcGFyZW50
        VGVtcGxhdGUocm91dGUpOwogIG9wdGlvbnMub3V0bGV0ID0gb3B0aW9ucy5v
        dXRsZXQgfHwgJ21haW4nOwogIG9wdGlvbnMubmFtZSA9IG5hbWU7CiAgb3B0
        aW9ucy50ZW1wbGF0ZSA9IHRlbXBsYXRlOwogIG9wdGlvbnMuTE9HX1ZJRVdf
        TE9PS1VQUyA9IGdldChyb3V0ZS5yb3V0ZXIsICduYW1lc3BhY2UuTE9HX1ZJ
        RVdfTE9PS1VQUycpOwoKICBFbWJlci5hc3NlcnQoIkFuIG91dGxldCAoIitv
        cHRpb25zLm91dGxldCsiKSB3YXMgc3BlY2lmaWVkIGJ1dCB3YXMgbm90IGZv
        dW5kLiIsIG9wdGlvbnMub3V0bGV0ID09PSAnbWFpbicgfHwgb3B0aW9ucy5p
        bnRvKTsKCiAgdmFyIGNvbnRyb2xsZXIgPSBvcHRpb25zLmNvbnRyb2xsZXIs
        IG5hbWVkQ29udHJvbGxlcjsKCiAgaWYgKG9wdGlvbnMuY29udHJvbGxlcikg
        ewogICAgY29udHJvbGxlciA9IG9wdGlvbnMuY29udHJvbGxlcjsKICB9IGVs
        c2UgaWYgKG5hbWVkQ29udHJvbGxlciA9IHJvdXRlLmNvbnRhaW5lci5sb29r
        dXAoJ2NvbnRyb2xsZXI6JyArIG5hbWUpKSB7CiAgICBjb250cm9sbGVyID0g
        bmFtZWRDb250cm9sbGVyOwogIH0gZWxzZSB7CiAgICBjb250cm9sbGVyID0g
        cm91dGUuY29udHJvbGxlck5hbWUgfHwgcm91dGUucm91dGVOYW1lOwogIH0K
        CiAgaWYgKHR5cGVvZiBjb250cm9sbGVyID09PSAnc3RyaW5nJykgewogICAg
        Y29udHJvbGxlciA9IHJvdXRlLmNvbnRhaW5lci5sb29rdXAoJ2NvbnRyb2xs
        ZXI6JyArIGNvbnRyb2xsZXIpOwogIH0KCiAgb3B0aW9ucy5jb250cm9sbGVy
        ID0gY29udHJvbGxlcjsKCiAgcmV0dXJuIG9wdGlvbnM7Cn0KCmZ1bmN0aW9u
        IHNldHVwVmlldyh2aWV3LCBjb250YWluZXIsIG9wdGlvbnMpIHsKICBpZiAo
        dmlldykgewogICAgaWYgKG9wdGlvbnMuTE9HX1ZJRVdfTE9PS1VQUykgewog
        ICAgICBFbWJlci5Mb2dnZXIuaW5mbygiUmVuZGVyaW5nICIgKyBvcHRpb25z
        Lm5hbWUgKyAiIHdpdGggIiArIHZpZXcsIHsgZnVsbE5hbWU6ICd2aWV3Oicg
        KyBvcHRpb25zLm5hbWUgfSk7CiAgICB9CiAgfSBlbHNlIHsKICAgIHZhciBk
        ZWZhdWx0VmlldyA9IG9wdGlvbnMuaW50byA/ICd2aWV3OmRlZmF1bHQnIDog
        J3ZpZXc6dG9wbGV2ZWwnOwogICAgdmlldyA9IGNvbnRhaW5lci5sb29rdXAo
        ZGVmYXVsdFZpZXcpOwogICAgaWYgKG9wdGlvbnMuTE9HX1ZJRVdfTE9PS1VQ
        UykgewogICAgICBFbWJlci5Mb2dnZXIuaW5mbygiUmVuZGVyaW5nICIgKyBv
        cHRpb25zLm5hbWUgKyAiIHdpdGggZGVmYXVsdCB2aWV3ICIgKyB2aWV3LCB7
        IGZ1bGxOYW1lOiAndmlldzonICsgb3B0aW9ucy5uYW1lIH0pOwogICAgfQog
        IH0KCiAgaWYgKCFnZXQodmlldywgJ3RlbXBsYXRlTmFtZScpKSB7CiAgICBz
        ZXQodmlldywgJ3RlbXBsYXRlJywgb3B0aW9ucy50ZW1wbGF0ZSk7CgogICAg
        c2V0KHZpZXcsICdfZGVidWdUZW1wbGF0ZU5hbWUnLCBvcHRpb25zLm5hbWUp
        OwogIH0KCiAgc2V0KHZpZXcsICdyZW5kZXJlZE5hbWUnLCBvcHRpb25zLm5h
        bWUpOwogIHNldCh2aWV3LCAnY29udHJvbGxlcicsIG9wdGlvbnMuY29udHJv
        bGxlcik7CgogIHJldHVybiB2aWV3Owp9CgpmdW5jdGlvbiBhcHBlbmRWaWV3
        KHJvdXRlLCB2aWV3LCBvcHRpb25zKSB7CiAgaWYgKG9wdGlvbnMuaW50bykg
        ewogICAgdmFyIHBhcmVudFZpZXcgPSByb3V0ZS5yb3V0ZXIuX2xvb2t1cEFj
        dGl2ZVZpZXcob3B0aW9ucy5pbnRvKTsKICAgIHZhciB0ZWFyZG93bk91dGxl
        dFZpZXcgPSBnZW5lcmF0ZU91dGxldFRlYXJkb3duKHBhcmVudFZpZXcsIG9w
        dGlvbnMub3V0bGV0KTsKICAgIGlmICghcm91dGUudGVhcmRvd25PdXRsZXRW
        aWV3cykgeyByb3V0ZS50ZWFyZG93bk91dGxldFZpZXdzID0gW107IH0KICAg
        IGFfcmVwbGFjZShyb3V0ZS50ZWFyZG93bk91dGxldFZpZXdzLCAwLCAwLCBb
        dGVhcmRvd25PdXRsZXRWaWV3XSk7CiAgICBwYXJlbnRWaWV3LmNvbm5lY3RP
        dXRsZXQob3B0aW9ucy5vdXRsZXQsIHZpZXcpOwogIH0gZWxzZSB7CiAgICB2
        YXIgcm9vdEVsZW1lbnQgPSBnZXQocm91dGUsICdyb3V0ZXIubmFtZXNwYWNl
        LnJvb3RFbGVtZW50Jyk7CiAgICAvLyB0ZWFyIGRvd24gdmlldyBpZiBvbmUg
        aXMgYWxyZWFkeSByZW5kZXJlZAogICAgaWYgKHJvdXRlLnRlYXJkb3duVG9w
        TGV2ZWxWaWV3KSB7CiAgICAgIHJvdXRlLnRlYXJkb3duVG9wTGV2ZWxWaWV3
        KCk7CiAgICB9CiAgICByb3V0ZS5yb3V0ZXIuX2Nvbm5lY3RBY3RpdmVWaWV3
        KG9wdGlvbnMubmFtZSwgdmlldyk7CiAgICByb3V0ZS50ZWFyZG93blRvcExl
        dmVsVmlldyA9IGdlbmVyYXRlVG9wTGV2ZWxUZWFyZG93bih2aWV3KTsKICAg
        IHZpZXcuYXBwZW5kVG8ocm9vdEVsZW1lbnQpOwogIH0KfQoKZnVuY3Rpb24g
        Z2VuZXJhdGVUb3BMZXZlbFRlYXJkb3duKHZpZXcpIHsKICByZXR1cm4gZnVu
        Y3Rpb24oKSB7IHZpZXcuZGVzdHJveSgpOyB9Owp9CgpmdW5jdGlvbiBnZW5l
        cmF0ZU91dGxldFRlYXJkb3duKHBhcmVudFZpZXcsIG91dGxldCkgewogIHJl
        dHVybiBmdW5jdGlvbigpIHsgcGFyZW50Vmlldy5kaXNjb25uZWN0T3V0bGV0
        KG91dGxldCk7IH07Cn0KCn0pKCk7CgoKCihmdW5jdGlvbigpIHsKCn0pKCk7
        CgoKCihmdW5jdGlvbigpIHsKRW1iZXIub25Mb2FkKCdFbWJlci5IYW5kbGVi
        YXJzJywgZnVuY3Rpb24oKSB7CiAgdmFyIGhhbmRsZWJhcnNSZXNvbHZlID0g
        RW1iZXIuSGFuZGxlYmFycy5yZXNvbHZlUGFyYW1zLAogICAgICBtYXAgPSBF
        bWJlci5BcnJheVBvbHlmaWxscy5tYXAsCiAgICAgIGdldCA9IEVtYmVyLmdl
        dCwKICAgICAgaGFuZGxlYmFyc0dldCA9IEVtYmVyLkhhbmRsZWJhcnMuZ2V0
        OwoKICBmdW5jdGlvbiByZXNvbHZlUGFyYW1zKGNvbnRleHQsIHBhcmFtcywg
        b3B0aW9ucykgewogICAgcmV0dXJuIG1hcC5jYWxsKHJlc29sdmVQYXRocyhj
        b250ZXh0LCBwYXJhbXMsIG9wdGlvbnMpLCBmdW5jdGlvbihwYXRoLCBpKSB7
        CiAgICAgIGlmIChudWxsID09PSBwYXRoKSB7CiAgICAgICAgLy8gUGFyYW0g
        d2FzIHN0cmluZy9udW1iZXIsIG5vdCBhIHBhdGgsIHNvIGp1c3QgcmV0dXJu
        IHJhdyBzdHJpbmcvbnVtYmVyLgogICAgICAgIHJldHVybiBwYXJhbXNbaV07
        CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIGhhbmRsZWJhcnNHZXQo
        Y29udGV4dCwgcGF0aCwgb3B0aW9ucyk7CiAgICAgIH0KICAgIH0pOwogIH0K
        CiAgZnVuY3Rpb24gcmVzb2x2ZVBhdGhzKGNvbnRleHQsIHBhcmFtcywgb3B0
        aW9ucykgewogICAgdmFyIHJlc29sdmVkID0gaGFuZGxlYmFyc1Jlc29sdmUo
        Y29udGV4dCwgcGFyYW1zLCBvcHRpb25zKSwKICAgICAgICB0eXBlcyA9IG9w
        dGlvbnMudHlwZXM7CgogICAgcmV0dXJuIG1hcC5jYWxsKHJlc29sdmVkLCBm
        dW5jdGlvbihvYmplY3QsIGkpIHsKICAgICAgaWYgKHR5cGVzW2ldID09PSAn
        SUQnKSB7CiAgICAgICAgcmV0dXJuIHVud3JhcChvYmplY3QsIHBhcmFtc1tp
        XSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICAg
        IH0KICAgIH0pOwoKICAgIGZ1bmN0aW9uIHVud3JhcChvYmplY3QsIHBhdGgp
        IHsKICAgICAgaWYgKHBhdGggPT09ICdjb250cm9sbGVyJykgeyByZXR1cm4g
        cGF0aDsgfQoKICAgICAgaWYgKEVtYmVyLkNvbnRyb2xsZXJNaXhpbi5kZXRl
        Y3Qob2JqZWN0KSkgewogICAgICAgIHJldHVybiB1bndyYXAoZ2V0KG9iamVj
        dCwgJ21vZGVsJyksIHBhdGggPyBwYXRoICsgJy5tb2RlbCcgOiAnbW9kZWwn
        KTsKICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gcGF0aDsKICAgICAg
        fQogICAgfQogIH0KCiAgRW1iZXIuUm91dGVyLnJlc29sdmVQYXJhbXMgPSBy
        ZXNvbHZlUGFyYW1zOwogIEVtYmVyLlJvdXRlci5yZXNvbHZlUGF0aHMgPSBy
        ZXNvbHZlUGF0aHM7Cn0pOwoKfSkoKTsKCgoKKGZ1bmN0aW9uKCkgewovKioK
        QG1vZHVsZSBlbWJlcgpAc3VibW9kdWxlIGVtYmVyLXJvdXRpbmcKKi8KCnZh
        ciBnZXQgPSBFbWJlci5nZXQsIHNldCA9IEVtYmVyLnNldCwgZm10ID0gRW1i
        ZXIuU3RyaW5nLmZtdDsKRW1iZXIub25Mb2FkKCdFbWJlci5IYW5kbGViYXJz
        JywgZnVuY3Rpb24oSGFuZGxlYmFycykgewoKICB2YXIgcmVzb2x2ZVBhcmFt
        cyA9IEVtYmVyLlJvdXRlci5yZXNvbHZlUGFyYW1zLAogICAgICByZXNvbHZl
        UGF0aHMgID0gRW1iZXIuUm91dGVyLnJlc29sdmVQYXRocywKICAgICAgaXNT
        aW1wbGVDbGljayA9IEVtYmVyLlZpZXdVdGlscy5pc1NpbXBsZUNsaWNrOwoK
        ICBmdW5jdGlvbiBmdWxsUm91dGVOYW1lKHJvdXRlciwgbmFtZSkgewogICAg
        aWYgKCFyb3V0ZXIuaGFzUm91dGUobmFtZSkpIHsKICAgICAgbmFtZSA9IG5h
        bWUgKyAnLmluZGV4JzsKICAgIH0KCiAgICByZXR1cm4gbmFtZTsKICB9Cgog
        IGZ1bmN0aW9uIGdldFJlc29sdmVkUGF0aHMob3B0aW9ucykgewoKICAgIHZh
        ciB0eXBlcyA9IG9wdGlvbnMub3B0aW9ucy50eXBlcywKICAgICAgICBkYXRh
        ID0gb3B0aW9ucy5vcHRpb25zLmRhdGE7CgogICAgcmV0dXJuIHJlc29sdmVQ
        YXRocyhvcHRpb25zLmNvbnRleHQsIG9wdGlvbnMucGFyYW1zLCB7IHR5cGVz
        OiB0eXBlcywgZGF0YTogZGF0YSB9KTsKICB9CgogIC8qKgogICAgYEVtYmVy
        LkxpbmtWaWV3YCByZW5kZXJzIGFuIGVsZW1lbnQgd2hvc2UgYGNsaWNrYCBl
        dmVudCB0cmlnZ2VycyBhCiAgICB0cmFuc2l0aW9uIG9mIHRoZSBhcHBsaWNh
        dGlvbidzIGluc3RhbmNlIG9mIGBFbWJlci5Sb3V0ZXJgIHRvCiAgICBhIHN1
        cHBsaWVkIHJvdXRlIGJ5IG5hbWUuCgogICAgSW5zdGFuY2VzIG9mIGBMaW5r
        Vmlld2Agd2lsbCBtb3N0IGxpa2VseSBiZSBjcmVhdGVkIHRocm91Z2gKICAg
        IHRoZSBgbGluay10b2AgSGFuZGxlYmFycyBoZWxwZXIsIGJ1dCBwcm9wZXJ0
        aWVzIG9mIHRoaXMgY2xhc3MKICAgIGNhbiBiZSBvdmVycmlkZGVuIHRvIGN1
        c3RvbWl6ZSBhcHBsaWNhdGlvbi13aWRlIGJlaGF2aW9yLgoKICAgIEBjbGFz
        cyBMaW5rVmlldwogICAgQG5hbWVzcGFjZSBFbWJlcgogICAgQGV4dGVuZHMg
        RW1iZXIuVmlldwogICAgQHNlZSB7SGFuZGxlYmFycy5oZWxwZXJzLmxpbmst
        dG99CiAgKiovCiAgdmFyIExpbmtWaWV3ID0gRW1iZXIuTGlua1ZpZXcgPSBF
        bWJlci5WaWV3LmV4dGVuZCh7CiAgICB0YWdOYW1lOiAnYScsCiAgICBjdXJy
        ZW50V2hlbjogbnVsbCwKCiAgICAvKioKICAgICAgU2V0cyB0aGUgYHRpdGxl
        YCBhdHRyaWJ1dGUgb2YgdGhlIGBMaW5rVmlld2AncyBIVE1MIGVsZW1lbnQu
        CgogICAgICBAcHJvcGVydHkgdGl0bGUKICAgICAgQGRlZmF1bHQgbnVsbAog
        ICAgKiovCiAgICB0aXRsZTogbnVsbCwKCiAgICAvKioKICAgICAgU2V0cyB0
        aGUgYHJlbGAgYXR0cmlidXRlIG9mIHRoZSBgTGlua1ZpZXdgJ3MgSFRNTCBl
        bGVtZW50LgoKICAgICAgQHByb3BlcnR5IHJlbAogICAgICBAZGVmYXVsdCBu
        dWxsCiAgICAqKi8KICAgIHJlbDogbnVsbCwKCiAgICAvKioKICAgICAgVGhl
        IENTUyBjbGFzcyB0byBhcHBseSB0byBgTGlua1ZpZXdgJ3MgZWxlbWVudCB3
        aGVuIGl0cyBgYWN0aXZlYAogICAgICBwcm9wZXJ0eSBpcyBgdHJ1ZWAuCgog
        ICAgICBAcHJvcGVydHkgYWN0aXZlQ2xhc3MKICAgICAgQHR5cGUgU3RyaW5n
        CiAgICAgIEBkZWZhdWx0IGFjdGl2ZQogICAgKiovCiAgICBhY3RpdmVDbGFz
        czogJ2FjdGl2ZScsCgogICAgLyoqCiAgICAgIFRoZSBDU1MgY2xhc3MgdG8g
        YXBwbHkgdG8gYExpbmtWaWV3YCdzIGVsZW1lbnQgd2hlbiBpdHMgYGxvYWRp
        bmdgCiAgICAgIHByb3BlcnR5IGlzIGB0cnVlYC4KCiAgICAgIEBwcm9wZXJ0
        eSBsb2FkaW5nQ2xhc3MKICAgICAgQHR5cGUgU3RyaW5nCiAgICAgIEBkZWZh
        dWx0IGxvYWRpbmcKICAgICoqLwogICAgbG9hZGluZ0NsYXNzOiAnbG9hZGlu
        ZycsCgogICAgLyoqCiAgICAgIFRoZSBDU1MgY2xhc3MgdG8gYXBwbHkgdG8g
        YSBgTGlua1ZpZXdgJ3MgZWxlbWVudCB3aGVuIGl0cyBgZGlzYWJsZWRgCiAg
        ICAgIHByb3BlcnR5IGlzIGB0cnVlYC4KCiAgICAgIEBwcm9wZXJ0eSBkaXNh
        YmxlZENsYXNzCiAgICAgIEB0eXBlIFN0cmluZwogICAgICBAZGVmYXVsdCBk
        aXNhYmxlZAogICAgKiovCiAgICBkaXNhYmxlZENsYXNzOiAnZGlzYWJsZWQn
        LAogICAgX2lzRGlzYWJsZWQ6IGZhbHNlLAoKICAgIC8qKgogICAgICBEZXRl
        cm1pbmVzIHdoZXRoZXIgdGhlIGBMaW5rVmlld2Agd2lsbCB0cmlnZ2VyIHJv
        dXRpbmcgdmlhCiAgICAgIHRoZSBgcmVwbGFjZVdpdGhgIHJvdXRpbmcgc3Ry
        YXRlZ3kuCgogICAgICBAcHJvcGVydHkgcmVwbGFjZQogICAgICBAdHlwZSBC
        b29sZWFuCiAgICAgIEBkZWZhdWx0IGZhbHNlCiAgICAqKi8KICAgIHJlcGxh
        Y2U6IGZhbHNlLAoKICAgIC8qKgogICAgICBCeSBkZWZhdWx0IHRoZSBge3ts
        aW5rLXRvfX1gIGhlbHBlciB3aWxsIGJpbmQgdG8gdGhlIGBocmVmYCBhbmQK
        ICAgICAgYHRpdGxlYCBhdHRyaWJ1dGVzLiBJdCdzIGRpc2NvdXJhZ2UgdGhh
        dCB5b3Ugb3ZlcnJpZGUgdGhlc2UgZGVmYXVsdHMsCiAgICAgIGhvd2V2ZXIg
        eW91IGNhbiBwdXNoIG9udG8gdGhlIGFycmF5IGlmIG5lZWRlZC4KCiAgICAg
        IEBwcm9wZXJ0eSBhdHRyaWJ1dGVCaW5kaW5ncwogICAgICBAdHlwZSBBcnJh
        eSB8IFN0cmluZwogICAgICBAZGVmYXVsdCBbJ2hyZWYnLCAndGl0bGUnLCAn
        cmVsJ10KICAgICAqKi8KICAgIGF0dHJpYnV0ZUJpbmRpbmdzOiBbJ2hyZWYn
        LCAndGl0bGUnLCAncmVsJ10sCgogICAgLyoqCiAgICAgIEJ5IGRlZmF1bHQg
        dGhlIGB7e2xpbmstdG99fWAgaGVscGVyIHdpbGwgYmluZCB0byB0aGUgYGFj
        dGl2ZWAsIGBsb2FkaW5nYCwgYW5kCiAgICAgIGBkaXNhYmxlZGAgY2xhc3Nl
        cy4gSXQgaXMgZGlzY291cmFnZWQgdG8gb3ZlcnJpZGUgdGhlc2UgZGlyZWN0
        bHkuCgogICAgICBAcHJvcGVydHkgY2xhc3NOYW1lQmluZGluZ3MKICAgICAg
        QHR5cGUgQXJyYXkKICAgICAgQGRlZmF1bHQgWydhY3RpdmUnLCAnbG9hZGlu
        ZycsICdkaXNhYmxlZCddCiAgICAgKiovCiAgICBjbGFzc05hbWVCaW5kaW5n
        czogWydhY3RpdmUnLCAnbG9hZGluZycsICdkaXNhYmxlZCddLAoKICAgIC8q
        KgogICAgICBCeSBkZWZhdWx0IHRoZSBge3tsaW5rLXRvfX1gIGhlbHBlciBy
        ZXNwb25kcyB0byB0aGUgYGNsaWNrYCBldmVudC4gWW91CiAgICAgIGNhbiBv
        dmVycmlkZSB0aGlzIGdsb2JhbGx5IGJ5IHNldHRpbmcgdGhpcyBwcm9wZXJ0
        eSB0byB5b3VyIGN1c3RvbQogICAgICBldmVudCBuYW1lLgoKICAgICAgVGhp
        cyBpcyBwYXJ0aWN1bGFybHkgdXNlZnVsIG9uIG1vYmlsZSB3aGVuIG9uZSB3
        YW50cyB0byBhdm9pZCB0aGUgMzAwbXMKICAgICAgY2xpY2sgZGVsYXkgdXNp
        bmcgc29tZSBzb3J0IG9mIGN1c3RvbSBgdGFwYCBldmVudC4KCiAgICAgIEBw
        cm9wZXJ0eSBldmVudE5hbWUKICAgICAgQHR5cGUgU3RyaW5nCiAgICAgIEBk
        ZWZhdWx0IGNsaWNrCiAgICAqLwogICAgZXZlbnROYW1lOiAnY2xpY2snLAoK
        ICAgIC8vIHRoaXMgaXMgZG9jJ2VkIGhlcmUgc28gaXQgc2hvd3MgdXAgaW4g
        dGhlIGV2ZW50cwogICAgLy8gc2VjdGlvbiBvZiB0aGUgQVBJIGRvY3VtZW50
        YXRpb24sIHdoaWNoIGlzIHdoZXJlCiAgICAvLyBwZW9wbGUgd2lsbCBsaWtl
        bHkgZ28gbG9va2luZyBmb3IgaXQuCiAgICAvKioKICAgICAgVHJpZ2dlcnMg
        dGhlIGBMaW5rVmlld2AncyByb3V0aW5nIGJlaGF2aW9yLiBJZgogICAgICBg
        ZXZlbnROYW1lYCBpcyBjaGFuZ2VkIHRvIGEgdmFsdWUgb3RoZXIgdGhhbiBg
        Y2xpY2tgCiAgICAgIHRoZSByb3V0aW5nIGJlaGF2aW9yIHdpbGwgdHJpZ2dl
        ciBvbiB0aGF0IGN1c3RvbSBldmVudAogICAgICBpbnN0ZWFkLgoKICAgICAg
        QGV2ZW50IGNsaWNrCiAgICAqKi8KCiAgICAvKioKICAgICAgQW4gb3ZlcnJp
        ZGFibGUgbWV0aG9kIGNhbGxlZCB3aGVuIExpbmtWaWV3IG9iamVjdHMgYXJl
        IGluc3RhbnRpYXRlZC4KCiAgICAgIEV4YW1wbGU6CgogICAgICBgYGBqYXZh
        c2NyaXB0CiAgICAgIEFwcC5NeUxpbmtWaWV3ID0gRW1iZXIuTGlua1ZpZXcu
        ZXh0ZW5kKHsKICAgICAgICBpbml0OiBmdW5jdGlvbigpIHsKICAgICAgICAg
        IHRoaXMuX3N1cGVyKCk7CiAgICAgICAgICBFbWJlci5Mb2dnZXIubG9nKCdF
        dmVudCBpcyAnICsgdGhpcy5nZXQoJ2V2ZW50TmFtZScpKTsKICAgICAgICB9
        CiAgICAgIH0pOwogICAgICBgYGAKCiAgICAgIE5PVEU6IElmIHlvdSBkbyBv
        dmVycmlkZSBgaW5pdGAgZm9yIGEgZnJhbWV3b3JrIGNsYXNzIGxpa2UgYEVt
        YmVyLlZpZXdgIG9yCiAgICAgIGBFbWJlci5BcnJheUNvbnRyb2xsZXJgLCBi
        ZSBzdXJlIHRvIGNhbGwgYHRoaXMuX3N1cGVyKClgIGluIHlvdXIKICAgICAg
        YGluaXRgIGRlY2xhcmF0aW9uISBJZiB5b3UgZG9uJ3QsIEVtYmVyIG1heSBu
        b3QgaGF2ZSBhbiBvcHBvcnR1bml0eSB0bwogICAgICBkbyBpbXBvcnRhbnQg
        c2V0dXAgd29yaywgYW5kIHlvdSdsbCBzZWUgc3RyYW5nZSBiZWhhdmlvciBp
        biB5b3VyCiAgICAgIGFwcGxpY2F0aW9uLgoKICAgICAgQG1ldGhvZCBpbml0
        CiAgICAqLwogICAgaW5pdDogZnVuY3Rpb24oKSB7CiAgICAgIHRoaXMuX3N1
        cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CgogICAgICAvLyBNYXAgZGVz
        aXJlZCBldmVudCBuYW1lIHRvIGludm9rZSBmdW5jdGlvbgogICAgICB2YXIg
        ZXZlbnROYW1lID0gZ2V0KHRoaXMsICdldmVudE5hbWUnKTsKICAgICAgdGhp
        cy5vbihldmVudE5hbWUsIHRoaXMsIHRoaXMuX2ludm9rZSk7CgogICAgICB2
        YXIgaGVscGVyUGFyYW1ldGVycyA9IHRoaXMucGFyYW1ldGVycywKICAgICAg
        ICAgIHRlbXBsYXRlQ29udGV4dCA9IGhlbHBlclBhcmFtZXRlcnMuY29udGV4
        dCwKICAgICAgICAgIHBhdGhzID0gZ2V0UmVzb2x2ZWRQYXRocyhoZWxwZXJQ
        YXJhbWV0ZXJzKSwKICAgICAgICAgIGxlbmd0aCA9IHBhdGhzLmxlbmd0aCwK
        ICAgICAgICAgIHBhdGgsIGk7CgogICAgICBmb3IoaT0wOyBpIDwgbGVuZ3Ro
        OyBpKyspIHsKICAgICAgICBwYXRoID0gcGF0aHNbaV07CiAgICAgICAgaWYg
        KG51bGwgPT09IHBhdGgpIHsKICAgICAgICAgIC8vIEEgbGl0ZXJhbCB2YWx1
        ZSB3YXMgcHJvdmlkZWQsIG5vdCBhIHBhdGgsIHNvIG5vdGhpbmcgdG8gb2Jz
        ZXJ2ZS4KICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgIH0KCiAgICAgICAg
        dmFyIG5vcm1hbGl6ZWRQYXRoID0KICAgICAgICAgIEVtYmVyLkhhbmRsZWJh
        cnMubm9ybWFsaXplUGF0aCh0ZW1wbGF0ZUNvbnRleHQsIHBhdGgsIGhlbHBl
        clBhcmFtZXRlcnMub3B0aW9ucy5kYXRhKTsKICAgICAgICB0aGlzLnJlZ2lz
        dGVyT2JzZXJ2ZXIobm9ybWFsaXplZFBhdGgucm9vdCwgbm9ybWFsaXplZFBh
        dGgucGF0aCwgdGhpcywgdGhpcy5fcGFyYW1zQ2hhbmdlZCk7CiAgICAgIH0K
        ICAgIH0sCgogICAgLyoqCiAgICAgIEBwcml2YXRlCgogICAgICBUaGlzIG1l
        dGhvZCBpcyBpbnZva2VkIGJ5IG9ic2VydmVycyBpbnN0YWxsZWQgZHVyaW5n
        IGBpbml0YCB0aGF0IGZpcmUKICAgICAgd2hlbmV2ZXIgdGhlIGhlbHBlcnMK
        ICAgICAgQG1ldGhvZCBfcGFyYW1zQ2hhbmdlZAogICAgICovCiAgICBfcGFy
        YW1zQ2hhbmdlZDogZnVuY3Rpb24oKSB7CiAgICAgIHRoaXMubm90aWZ5UHJv
        cGVydHlDaGFuZ2UoJ3Jlc29sdmVkUGFyYW1zJyk7CiAgICB9LAoKICAgIC8q
        KgogICAgICBAcHJpdmF0ZQoKICAgICAgRXZlbiB0aG91Z2ggdGhpcyBpc24n
        dCBhIHZpcnR1YWwgdmlldywgd2Ugd2FudCB0byB0cmVhdCBpdCBhcyBpZiBp
        dCBpcwogICAgICBzbyB0aGF0IHlvdSBjYW4gYWNjZXNzIHRoZSBwYXJlbnQg
        d2l0aCB7e3ZpZXcucHJvcH19CgogICAgICBAbWV0aG9kIGNvbmNyZXRlVmll
        dwogICAgKiovCiAgICBjb25jcmV0ZVZpZXc6IEVtYmVyLmNvbXB1dGVkKGZ1
        bmN0aW9uKCkgewogICAgICByZXR1cm4gZ2V0KHRoaXMsICdwYXJlbnRWaWV3
        Jyk7CiAgICB9KS5wcm9wZXJ0eSgncGFyZW50VmlldycpLAoKICAgIC8qKgoK
        ICAgICAgQWNjZXNzZWQgYXMgYSBjbGFzc25hbWUgYmluZGluZyB0byBhcHBs
        eSB0aGUgYExpbmtWaWV3YCdzIGBkaXNhYmxlZENsYXNzYAogICAgICBDU1Mg
        YGNsYXNzYCB0byB0aGUgZWxlbWVudCB3aGVuIHRoZSBsaW5rIGlzIGRpc2Fi
        bGVkLgoKICAgICAgV2hlbiBgdHJ1ZWAgaW50ZXJhY3Rpb25zIHdpdGggdGhl
        IGVsZW1lbnQgd2lsbCBub3QgdHJpZ2dlciByb3V0ZSBjaGFuZ2VzLgogICAg
        ICBAcHJvcGVydHkgZGlzYWJsZWQKICAgICovCiAgICBkaXNhYmxlZDogRW1i
        ZXIuY29tcHV0ZWQoZnVuY3Rpb24oa2V5LCB2YWx1ZSkgewogICAgICBpZiAo
        dmFsdWUgIT09IHVuZGVmaW5lZCkgeyB0aGlzLnNldCgnX2lzRGlzYWJsZWQn
        LCB2YWx1ZSk7IH0KCiAgICAgIHJldHVybiB2YWx1ZSA/IGdldCh0aGlzLCAn
        ZGlzYWJsZWRDbGFzcycpIDogZmFsc2U7CiAgICB9KSwKCiAgICAvKioKICAg
        ICAgQWNjZXNzZWQgYXMgYSBjbGFzc25hbWUgYmluZGluZyB0byBhcHBseSB0
        aGUgYExpbmtWaWV3YCdzIGBhY3RpdmVDbGFzc2AKICAgICAgQ1NTIGBjbGFz
        c2AgdG8gdGhlIGVsZW1lbnQgd2hlbiB0aGUgbGluayBpcyBhY3RpdmUuCgog
        ICAgICBBIGBMaW5rVmlld2AgaXMgY29uc2lkZXJlZCBhY3RpdmUgd2hlbiBp
        dHMgYGN1cnJlbnRXaGVuYCBwcm9wZXJ0eSBpcyBgdHJ1ZWAKICAgICAgb3Ig
        dGhlIGFwcGxpY2F0aW9uJ3MgY3VycmVudCByb3V0ZSBpcyB0aGUgcm91dGUg
        dGhlIGBMaW5rVmlld2Agd291bGQgdHJpZ2dlcgogICAgICB0cmFuc2l0aW9u
        cyBpbnRvLgoKICAgICAgQHByb3BlcnR5IGFjdGl2ZQogICAgKiovCiAgICBh
        Y3RpdmU6IEVtYmVyLmNvbXB1dGVkKGZ1bmN0aW9uKCkgewogICAgICBpZiAo
        Z2V0KHRoaXMsICdsb2FkaW5nJykpIHsgcmV0dXJuIGZhbHNlOyB9CgogICAg
        ICB2YXIgcm91dGVyID0gZ2V0KHRoaXMsICdyb3V0ZXInKSwKICAgICAgICAg
        IHJvdXRlQXJncyA9IGdldCh0aGlzLCAncm91dGVBcmdzJyksCiAgICAgICAg
        ICBjb250ZXh0cyA9IHJvdXRlQXJncy5zbGljZSgxKSwKICAgICAgICAgIHJl
        c29sdmVkUGFyYW1zID0gZ2V0KHRoaXMsICdyZXNvbHZlZFBhcmFtcycpLAog
        ICAgICAgICAgY3VycmVudFdoZW4gPSB0aGlzLmN1cnJlbnRXaGVuIHx8IHJl
        c29sdmVkUGFyYW1zWzBdLAogICAgICAgICAgY3VycmVudFdpdGhJbmRleCA9
        IGN1cnJlbnRXaGVuICsgJy5pbmRleCcsCiAgICAgICAgICBpc0FjdGl2ZSA9
        IHJvdXRlci5pc0FjdGl2ZS5hcHBseShyb3V0ZXIsIFtjdXJyZW50V2hlbl0u
        Y29uY2F0KGNvbnRleHRzKSkgfHwKICAgICAgICAgICAgICAgICAgICAgcm91
        dGVyLmlzQWN0aXZlLmFwcGx5KHJvdXRlciwgW2N1cnJlbnRXaXRoSW5kZXhd
        LmNvbmNhdChjb250ZXh0cykpOwoKICAgICAgaWYgKGlzQWN0aXZlKSB7IHJl
        dHVybiBnZXQodGhpcywgJ2FjdGl2ZUNsYXNzJyk7IH0KICAgIH0pLnByb3Bl
        cnR5KCdyZXNvbHZlZFBhcmFtcycsICdyb3V0ZUFyZ3MnLCAncm91dGVyLnVy
        bCcpLAoKICAgIC8qKgogICAgICBBY2Nlc3NlZCBhcyBhIGNsYXNzbmFtZSBi
        aW5kaW5nIHRvIGFwcGx5IHRoZSBgTGlua1ZpZXdgJ3MgYGxvYWRpbmdDbGFz
        c2AKICAgICAgQ1NTIGBjbGFzc2AgdG8gdGhlIGVsZW1lbnQgd2hlbiB0aGUg
        bGluayBpcyBsb2FkaW5nLgoKICAgICAgQSBgTGlua1ZpZXdgIGlzIGNvbnNp
        ZGVyZWQgbG9hZGluZyB3aGVuIGl0IGhhcyBhdCBsZWFzdCBvbmUKICAgICAg
        cGFyYW1ldGVyIHdob3NlIHZhbHVlIGlzIGN1cnJlbnRseSBudWxsIG9yIHVu
        ZGVmaW5lZC4gRHVyaW5nCiAgICAgIHRoaXMgdGltZSwgY2xpY2tpbmcgdGhl
        IGxpbmsgd2lsbCBwZXJmb3JtIG5vIHRyYW5zaXRpb24gYW5kCiAgICAgIGVt
        aXQgYSB3YXJuaW5nIHRoYXQgdGhlIGxpbmsgaXMgc3RpbGwgaW4gYSBsb2Fk
        aW5nIHN0YXRlLgoKICAgICAgQHByb3BlcnR5IGxvYWRpbmcKICAgICoqLwog
        ICAgbG9hZGluZzogRW1iZXIuY29tcHV0ZWQoZnVuY3Rpb24oKSB7CiAgICAg
        IGlmICghZ2V0KHRoaXMsICdyb3V0ZUFyZ3MnKSkgeyByZXR1cm4gZ2V0KHRo
        aXMsICdsb2FkaW5nQ2xhc3MnKTsgfQogICAgfSkucHJvcGVydHkoJ3JvdXRl
        QXJncycpLAoKICAgIC8qKgogICAgICBAcHJpdmF0ZQoKICAgICAgUmV0dXJu
        cyB0aGUgYXBwbGljYXRpb24ncyBtYWluIHJvdXRlciBmcm9tIHRoZSBjb250
        YWluZXIuCgogICAgICBAcHJvcGVydHkgcm91dGVyCiAgICAqKi8KICAgIHJv
        dXRlcjogRW1iZXIuY29tcHV0ZWQoZnVuY3Rpb24oKSB7CiAgICAgIHJldHVy
        biBnZXQodGhpcywgJ2NvbnRyb2xsZXInKS5jb250YWluZXIubG9va3VwKCdy
        b3V0ZXI6bWFpbicpOwogICAgfSksCgogICAgLyoqCiAgICAgIEBwcml2YXRl
        CgogICAgICBFdmVudCBoYW5kbGVyIHRoYXQgaW52b2tlcyB0aGUgbGluaywg
        YWN0aXZhdGluZyB0aGUgYXNzb2NpYXRlZCByb3V0ZS4KCiAgICAgIEBtZXRo
        b2QgX2ludm9rZQogICAgICBAcGFyYW0ge0V2ZW50fSBldmVudAogICAgKi8K
        ICAgIF9pbnZva2U6IGZ1bmN0aW9uKGV2ZW50KSB7CiAgICAgIGlmICghaXNT
        aW1wbGVDbGljayhldmVudCkpIHsgcmV0dXJuIHRydWU7IH0KCiAgICAgIGV2
        ZW50LnByZXZlbnREZWZhdWx0KCk7CiAgICAgIGlmICh0aGlzLmJ1YmJsZXMg
        PT09IGZhbHNlKSB7IGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpOyB9CgogICAg
        ICBpZiAoZ2V0KHRoaXMsICdfaXNEaXNhYmxlZCcpKSB7IHJldHVybiBmYWxz
        ZTsgfQoKICAgICAgaWYgKGdldCh0aGlzLCAnbG9hZGluZycpKSB7CiAgICAg
        ICAgRW1iZXIuTG9nZ2VyLndhcm4oIlRoaXMgbGluay10byBpcyBpbiBhbiBp
        bmFjdGl2ZSBsb2FkaW5nIHN0YXRlIGJlY2F1c2UgYXQgbGVhc3Qgb25lIG9m
        IGl0cyBwYXJhbWV0ZXJzIHByZXNlbnRseSBoYXMgYSBudWxsL3VuZGVmaW5l
        ZCB2YWx1ZSwgb3IgdGhlIHByb3ZpZGVkIHJvdXRlIG5hbWUgaXMgaW52YWxp
        ZC4iKTsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KCiAgICAgIHZh
        ciByb3V0ZXIgPSBnZXQodGhpcywgJ3JvdXRlcicpLAogICAgICAgICAgcm91
        dGVBcmdzID0gZ2V0KHRoaXMsICdyb3V0ZUFyZ3MnKTsKCiAgICAgIGlmIChn
        ZXQodGhpcywgJ3JlcGxhY2UnKSkgewogICAgICAgIHJvdXRlci5yZXBsYWNl
        V2l0aC5hcHBseShyb3V0ZXIsIHJvdXRlQXJncyk7CiAgICAgIH0gZWxzZSB7
        CiAgICAgICAgcm91dGVyLnRyYW5zaXRpb25Uby5hcHBseShyb3V0ZXIsIHJv
        dXRlQXJncyk7CiAgICAgIH0KICAgIH0sCgogICAgLyoqCiAgICAgIEBwcml2
        YXRlCgogICAgICBDb21wdXRlZCBwcm9wZXJ0eSB0aGF0IHJldHVybnMgdGhl
        IHJlc29sdmVkIHBhcmFtZXRlcnMuCgogICAgICBAcHJvcGVydHkKICAgICAg
        QHJldHVybiB7QXJyYXl9CiAgICAgKi8KICAgIHJlc29sdmVkUGFyYW1zOiBF
        bWJlci5jb21wdXRlZChmdW5jdGlvbigpIHsKICAgICAgdmFyIHBhcmFtZXRl
        cnMgPSB0aGlzLnBhcmFtZXRlcnMsCiAgICAgICAgICBvcHRpb25zID0gcGFy
        YW1ldGVycy5vcHRpb25zLAogICAgICAgICAgdHlwZXMgPSBvcHRpb25zLnR5
        cGVzLAogICAgICAgICAgZGF0YSA9IG9wdGlvbnMuZGF0YTsKCiAgICAgIHJl
        dHVybiByZXNvbHZlUGFyYW1zKHBhcmFtZXRlcnMuY29udGV4dCwgcGFyYW1l
        dGVycy5wYXJhbXMsIHsgdHlwZXM6IHR5cGVzLCBkYXRhOiBkYXRhIH0pOwog
        ICAgfSkucHJvcGVydHkoKSwKCiAgICAvKioKICAgICAgQHByaXZhdGUKCiAg
        ICAgIENvbXB1dGVkIHByb3BlcnR5IHRoYXQgcmV0dXJucyB0aGUgY3VycmVu
        dCByb3V0ZSBuYW1lIGFuZAogICAgICBhbnkgZHluYW1pYyBzZWdtZW50cy4K
        CiAgICAgIEBwcm9wZXJ0eQogICAgICBAcmV0dXJuIHtBcnJheX0gQW4gYXJy
        YXkgd2l0aCB0aGUgcm91dGUgbmFtZSBhbmQgYW55IGR5bmFtaWMgc2VnbWVu
        dHMKICAgICAqLwogICAgcm91dGVBcmdzOiBFbWJlci5jb21wdXRlZChmdW5j
        dGlvbigpIHsKCiAgICAgIHZhciByZXNvbHZlZFBhcmFtcyA9IGdldCh0aGlz
        LCAncmVzb2x2ZWRQYXJhbXMnKS5zbGljZSgwKSwKICAgICAgICAgIHJvdXRl
        ciA9IGdldCh0aGlzLCAncm91dGVyJyksCiAgICAgICAgICBuYW1lZFJvdXRl
        ID0gcmVzb2x2ZWRQYXJhbXNbMF07CgogICAgICBpZiAoIW5hbWVkUm91dGUp
        IHsgcmV0dXJuOyB9CgogICAgICBuYW1lZFJvdXRlID0gZnVsbFJvdXRlTmFt
        ZShyb3V0ZXIsIG5hbWVkUm91dGUpOwogICAgICByZXNvbHZlZFBhcmFtc1sw
        XSA9IG5hbWVkUm91dGU7CgogICAgICBFbWJlci5hc3NlcnQoZm10KCJUaGUg
        YXR0ZW1wdCB0byBsaW5rLXRvIHJvdXRlICclQCcgZmFpbGVkLiBUaGUgcm91
        dGVyIGRpZCBub3QgZmluZCAnJUAnIGluIGl0cyBwb3NzaWJsZSByb3V0ZXM6
        ICclQCciLCBbbmFtZWRSb3V0ZSwgbmFtZWRSb3V0ZSwgRW1iZXIua2V5cyhy
        b3V0ZXIucm91dGVyLnJlY29nbml6ZXIubmFtZXMpLmpvaW4oIicsICciKV0p
        LCByb3V0ZXIuaGFzUm91dGUobmFtZWRSb3V0ZSkpOwoKICAgICAgZm9yICh2
        YXIgaSA9IDEsIGxlbiA9IHJlc29sdmVkUGFyYW1zLmxlbmd0aDsgaSA8IGxl
        bjsgKytpKSB7CiAgICAgICAgdmFyIHBhcmFtID0gcmVzb2x2ZWRQYXJhbXNb
        aV07CiAgICAgICAgaWYgKHBhcmFtID09PSBudWxsIHx8IHR5cGVvZiBwYXJh
        bSA9PT0gJ3VuZGVmaW5lZCcpIHsKICAgICAgICAgIC8vIElmIGNvbnRleHRz
        IGFyZW4ndCBwcmVzZW50LCBjb25zaWRlciB0aGUgbGlua1ZpZXcgdW5sb2Fk
        ZWQuCiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICB9CgogICAg
        ICByZXR1cm4gcmVzb2x2ZWRQYXJhbXM7CiAgICB9KS5wcm9wZXJ0eSgncmVz
        b2x2ZWRQYXJhbXMnKSwKCiAgICAvKioKICAgICAgU2V0cyB0aGUgZWxlbWVu
        dCdzIGBocmVmYCBhdHRyaWJ1dGUgdG8gdGhlIHVybCBmb3IKICAgICAgdGhl
        IGBMaW5rVmlld2AncyB0YXJnZXRlZCByb3V0ZS4KCiAgICAgIElmIHRoZSBg
        TGlua1ZpZXdgJ3MgYHRhZ05hbWVgIGlzIGNoYW5nZWQgdG8gYSB2YWx1ZSBv
        dGhlcgogICAgICB0aGFuIGBhYCwgdGhpcyBwcm9wZXJ0eSB3aWxsIGJlIGln
        bm9yZWQuCgogICAgICBAcHJvcGVydHkgaHJlZgogICAgKiovCiAgICBocmVm
        OiBFbWJlci5jb21wdXRlZChmdW5jdGlvbigpIHsKICAgICAgaWYgKGdldCh0
        aGlzLCAndGFnTmFtZScpICE9PSAnYScpIHsgcmV0dXJuOyB9CgogICAgICB2
        YXIgcm91dGVyID0gZ2V0KHRoaXMsICdyb3V0ZXInKSwKICAgICAgICAgIHJv
        dXRlQXJncyA9IGdldCh0aGlzLCAncm91dGVBcmdzJyk7CgogICAgICByZXR1
        cm4gcm91dGVBcmdzID8gcm91dGVyLmdlbmVyYXRlLmFwcGx5KHJvdXRlciwg
        cm91dGVBcmdzKSA6IGdldCh0aGlzLCAnbG9hZGluZ0hyZWYnKTsKICAgIH0p
        LnByb3BlcnR5KCdyb3V0ZUFyZ3MnKSwKCiAgICAvKioKICAgICAgVGhlIGRl
        ZmF1bHQgaHJlZiB2YWx1ZSB0byB1c2Ugd2hpbGUgYSBsaW5rLXRvIGlzIGxv
        YWRpbmcuCiAgICAgIE9ubHkgYXBwbGllcyB3aGVuIHRhZ05hbWUgaXMgJ2En
        CgogICAgICBAcHJvcGVydHkgbG9hZGluZ0hyZWYKICAgICAgQHR5cGUgU3Ry
        aW5nCiAgICAgIEBkZWZhdWx0ICMKICAgICovCiAgICBsb2FkaW5nSHJlZjog
        JyMnCiAgfSk7CgogIExpbmtWaWV3LnRvU3RyaW5nID0gZnVuY3Rpb24oKSB7
        IHJldHVybiAiTGlua1ZpZXciOyB9OwoKICAvKioKICAgIFRoZSBge3tsaW5r
        LXRvfX1gIGhlbHBlciByZW5kZXJzIGEgbGluayB0byB0aGUgc3VwcGxpZWQK
        ICAgIGByb3V0ZU5hbWVgIHBhc3NpbmcgYW4gb3B0aW9uYWxseSBzdXBwbGll
        ZCBtb2RlbCB0byB0aGUKICAgIHJvdXRlIGFzIGl0cyBgbW9kZWxgIGNvbnRl
        eHQgb2YgdGhlIHJvdXRlLiBUaGUgYmxvY2sKICAgIGZvciBge3tsaW5rLXRv
        fX1gIGJlY29tZXMgdGhlIGlubmVySFRNTCBvZiB0aGUgcmVuZGVyZWQKICAg
        IGVsZW1lbnQ6CgogICAgYGBgaGFuZGxlYmFycwogICAge3sjbGluay10byAn
        cGhvdG9HYWxsZXJ5J319CiAgICAgIEdyZWF0IEhhbXN0ZXIgUGhvdG9zCiAg
        ICB7ey9saW5rLXRvfX0KICAgIGBgYAoKICAgIGBgYGh0bWwKICAgIDxhIGhy
        ZWY9Ii9oYW1zdGVyLXBob3RvcyI+CiAgICAgIEdyZWF0IEhhbXN0ZXIgUGhv
        dG9zCiAgICA8L2E+CiAgICBgYGAKCiAgICAjIyMgU3VwcGx5aW5nIGEgdGFn
        TmFtZQogICAgQnkgZGVmYXVsdCBge3tsaW5rLXRvfX1gIHJlbmRlcnMgYW4g
        YDxhPmAgZWxlbWVudC4gVGhpcyBjYW4KICAgIGJlIG92ZXJyaWRkZW4gZm9y
        IGEgc2luZ2xlIHVzZSBvZiBge3tsaW5rLXRvfX1gIGJ5IHN1cHBseWluZwog
        ICAgYSBgdGFnTmFtZWAgb3B0aW9uOgoKICAgIGBgYGhhbmRsZWJhcnMKICAg
        IHt7I2xpbmstdG8gJ3Bob3RvR2FsbGVyeScgdGFnTmFtZT0ibGkifX0KICAg
        ICAgR3JlYXQgSGFtc3RlciBQaG90b3MKICAgIHt7L2xpbmstdG99fQogICAg
        YGBgCgogICAgYGBgaHRtbAogICAgPGxpPgogICAgICBHcmVhdCBIYW1zdGVy
        IFBob3RvcwogICAgPC9saT4KICAgIGBgYAoKICAgIFRvIG92ZXJyaWRlIHRo
        aXMgb3B0aW9uIGZvciB5b3VyIGVudGlyZSBhcHBsaWNhdGlvbiwgc2VlCiAg
        ICAiT3ZlcnJpZGluZyBBcHBsaWNhdGlvbi13aWRlIERlZmF1bHRzIi4KICAg
        IAogICAgIyMjIERpc2FibGluZyB0aGUgYGxpbmstdG9gIGhlbHBlcgogICAg
        QnkgZGVmYXVsdCBge3tsaW5rLXRvfX1gIGlzIGVuYWJsZWQuIAogICAgYW55
        IHBhc3NlZCB2YWx1ZSB0byBgZGlzYWJsZWRgIGhlbHBlciBwcm9wZXJ0eSB3
        aWxsIGRpc2FibGUgdGhlIGBsaW5rLXRvYCBoZWxwZXIuCiAgICAgCiAgICBz
        dGF0aWMgdXNlOiB0aGUgYGRpc2FibGVkYCBvcHRpb246CiAKICAgIGBgYGhh
        bmRsZWJhcnMKICAgIHt7I2xpbmstdG8gJ3Bob3RvR2FsbGVyeScgZGlzYWJs
        ZWQ9dHJ1ZX19CiAgICAgIEdyZWF0IEhhbXN0ZXIgUGhvdG9zCiAgICB7ey9s
        aW5rLXRvfX0KICAgIGBgYAogICAgIAogICAgZHluYW1pYyB1c2U6IHRoZSBg
        ZGlzYWJsZWRXaGVuYCBvcHRpb246CiAgICAKICAgIGBgYGhhbmRsZWJhcnMK
        ICAgIHt7I2xpbmstdG8gJ3Bob3RvR2FsbGVyeScgZGlzYWJsZWRXaGVuPWNv
        bnRyb2xsZXIuc29tZVByb3BlcnR5fX0KICAgICAgR3JlYXQgSGFtc3RlciBQ
        aG90b3MKICAgIHt7L2xpbmstdG99fQogICAgYGBgCiAgICAKICAgIGFueSBw
        YXNzZWQgdmFsdWUgdG8gYGRpc2FibGVkYCB3aWxsIGRpc2FibGUgaXQgZXhj
        ZXB0IGB1bmRlZmluZWRgLgogICAgdG8gZW5zdXJlIHRoYXQgb25seSBgdHJ1
        ZWAgZGlzYWJsZSB0aGUgYGxpbmstdG9gIGhlbHBlciB5b3UgY2FuCiAgICBv
        dmVycmlkZSB0aGUgZ2xvYmFsIGJlaGF2aW91ciBvZiBgRW1iZXIuTGlua1Zp
        ZXdgLgogICAgICAgICAKICAgIGBgYGphdmFzY3JpcHQgIAogICAgRW1iZXIu
        TGlua1ZpZXcucmVvcGVuKHsKICAgICAgZGlzYWJsZWQ6IEVtYmVyLmNvbXB1
        dGVkKGZ1bmN0aW9uKGtleSwgdmFsdWUpIHsKICAgICAgICBpZiAodmFsdWUg
        IT09IHVuZGVmaW5lZCkgeyAKICAgICAgICAgIHRoaXMuc2V0KCdfaXNEaXNh
        YmxlZCcsIHZhbHVlID09PSB0cnVlKTsgCiAgICAgICAgfQogICAgICAgIHJl
        dHVybiB2YWx1ZSA9PT0gdHJ1ZSA/IGdldCh0aGlzLCAnZGlzYWJsZWRDbGFz
        cycpIDogZmFsc2U7CiAgICAgIH0pCiAgICB9KTsKICAgIGBgYAogICAgIAog
        ICAgc2VlICJPdmVycmlkaW5nIEFwcGxpY2F0aW9uLXdpZGUgRGVmYXVsdHMi
        IGZvciBtb3JlLgogICAgCiAgICAjIyMgSGFuZGxpbmcgYGhyZWZgCiAgICBg
        e3tsaW5rLXRvfX1gIHdpbGwgdXNlIHlvdXIgYXBwbGljYXRpb24ncyBSb3V0
        ZXIgdG8KICAgIGZpbGwgdGhlIGVsZW1lbnQncyBgaHJlZmAgcHJvcGVydHkg
        d2l0aCBhIHVybCB0aGF0CiAgICBtYXRjaGVzIHRoZSBwYXRoIHRvIHRoZSBz
        dXBwbGllZCBgcm91dGVOYW1lYCBmb3IgeW91cgogICAgcm91dGVycydzIGNv
        bmZpZ3VyZWQgYExvY2F0aW9uYCBzY2hlbWUsIHdoaWNoIGRlZmF1bHRzCiAg
        ICB0byBFbWJlci5IYXNoTG9jYXRpb24uCgogICAgIyMjIEhhbmRsaW5nIGN1
        cnJlbnQgcm91dGUKICAgIGB7e2xpbmstdG99fWAgd2lsbCBhcHBseSBhIENT
        UyBjbGFzcyBuYW1lIG9mICdhY3RpdmUnCiAgICB3aGVuIHRoZSBhcHBsaWNh
        dGlvbidzIGN1cnJlbnQgcm91dGUgbWF0Y2hlcwogICAgdGhlIHN1cHBsaWVk
        IHJvdXRlTmFtZS4gRm9yIGV4YW1wbGUsIGlmIHRoZSBhcHBsaWNhdGlvbidz
        CiAgICBjdXJyZW50IHJvdXRlIGlzICdwaG90b0dhbGxlcnkucmVjZW50JyB0
        aGUgZm9sbG93aW5nCiAgICB1c2Ugb2YgYHt7bGluay10b319YDoKCiAgICBg
        YGBoYW5kbGViYXJzCiAgICB7eyNsaW5rLXRvICdwaG90b0dhbGxlcnkucmVj
        ZW50J319CiAgICAgIEdyZWF0IEhhbXN0ZXIgUGhvdG9zIGZyb20gdGhlIGxh
        c3Qgd2VlawogICAge3svbGluay10b319CiAgICBgYGAKCiAgICB3aWxsIHJl
        c3VsdCBpbgoKICAgIGBgYGh0bWwKICAgIDxhIGhyZWY9Ii9oYW1zdGVyLXBo
        b3Rvcy90aGlzLXdlZWsiIGNsYXNzPSJhY3RpdmUiPgogICAgICBHcmVhdCBI
        YW1zdGVyIFBob3RvcwogICAgPC9hPgogICAgYGBgCgogICAgVGhlIENTUyBj
        bGFzcyBuYW1lIHVzZWQgZm9yIGFjdGl2ZSBjbGFzc2VzIGNhbiBiZSBjdXN0
        b21pemVkCiAgICBmb3IgYSBzaW5nbGUgdXNlIG9mIGB7e2xpbmstdG99fWAg
        YnkgcGFzc2luZyBhbiBgYWN0aXZlQ2xhc3NgCiAgICBvcHRpb246CgogICAg
        YGBgaGFuZGxlYmFycwogICAge3sjbGluay10byAncGhvdG9HYWxsZXJ5LnJl
        Y2VudCcgYWN0aXZlQ2xhc3M9ImN1cnJlbnQtdXJsIn19CiAgICAgIEdyZWF0
        IEhhbXN0ZXIgUGhvdG9zIGZyb20gdGhlIGxhc3Qgd2VlawogICAge3svbGlu
        ay10b319CiAgICBgYGAKCiAgICBgYGBodG1sCiAgICA8YSBocmVmPSIvaGFt
        c3Rlci1waG90b3MvdGhpcy13ZWVrIiBjbGFzcz0iY3VycmVudC11cmwiPgog
        ICAgICBHcmVhdCBIYW1zdGVyIFBob3RvcwogICAgPC9hPgogICAgYGBgCgog
        ICAgVG8gb3ZlcnJpZGUgdGhpcyBvcHRpb24gZm9yIHlvdXIgZW50aXJlIGFw
        cGxpY2F0aW9uLCBzZWUKICAgICJPdmVycmlkaW5nIEFwcGxpY2F0aW9uLXdp
        ZGUgRGVmYXVsdHMiLgoKICAgICMjIyBTdXBwbHlpbmcgYSBtb2RlbAogICAg
        QW4gb3B0aW9uYWwgbW9kZWwgYXJndW1lbnQgY2FuIGJlIHVzZWQgZm9yIHJv
        dXRlcyB3aG9zZQogICAgcGF0aHMgY29udGFpbiBkeW5hbWljIHNlZ21lbnRz
        LiBUaGlzIGFyZ3VtZW50IHdpbGwgYmVjb21lCiAgICB0aGUgbW9kZWwgY29u
        dGV4dCBvZiB0aGUgbGlua2VkIHJvdXRlOgoKICAgIGBgYGphdmFzY3JpcHQK
        ICAgIEFwcC5Sb3V0ZXIubWFwKGZ1bmN0aW9uKCkgewogICAgICB0aGlzLnJl
        c291cmNlKCJwaG90b0dhbGxlcnkiLCB7cGF0aDogImhhbXN0ZXItcGhvdG9z
        LzpwaG90b19pZCJ9KTsKICAgIH0pOwogICAgYGBgCgogICAgYGBgaGFuZGxl
        YmFycwogICAge3sjbGluay10byAncGhvdG9HYWxsZXJ5JyBhUGhvdG99fQog
        ICAgICB7e2FQaG90by50aXRsZX19CiAgICB7ey9saW5rLXRvfX0KICAgIGBg
        YAoKICAgIGBgYGh0bWwKICAgIDxhIGhyZWY9Ii9oYW1zdGVyLXBob3Rvcy80
        MiI+CiAgICAgIFRvbXN0ZXIKICAgIDwvYT4KICAgIGBgYAoKICAgICMjIyBT
        dXBwbHlpbmcgbXVsdGlwbGUgbW9kZWxzCiAgICBGb3IgZGVlcC1saW5raW5n
        IHRvIHJvdXRlIHBhdGhzIHRoYXQgY29udGFpbiBtdWx0aXBsZQogICAgZHlu
        YW1pYyBzZWdtZW50cywgbXVsdGlwbGUgbW9kZWwgYXJndW1lbnRzIGNhbiBi
        ZSB1c2VkLgogICAgQXMgdGhlIHJvdXRlciB0cmFuc2l0aW9ucyB0aHJvdWdo
        IHRoZSByb3V0ZSBwYXRoLCBlYWNoCiAgICBzdXBwbGllZCBtb2RlbCBhcmd1
        bWVudCB3aWxsIGJlY29tZSB0aGUgY29udGV4dCBmb3IgdGhlCiAgICByb3V0
        ZSB3aXRoIHRoZSBkeW5hbWljIHNlZ21lbnRzOgoKICAgIGBgYGphdmFzY3Jp
        cHQKICAgIEFwcC5Sb3V0ZXIubWFwKGZ1bmN0aW9uKCkgewogICAgICB0aGlz
        LnJlc291cmNlKCJwaG90b0dhbGxlcnkiLCB7cGF0aDogImhhbXN0ZXItcGhv
        dG9zLzpwaG90b19pZCJ9LCBmdW5jdGlvbigpIHsKICAgICAgICB0aGlzLnJv
        dXRlKCJjb21tZW50Iiwge3BhdGg6ICJjb21tZW50cy86Y29tbWVudF9pZCJ9
        KTsKICAgICAgfSk7CiAgICB9KTsKICAgIGBgYAogICAgVGhpcyBhcmd1bWVu
        dCB3aWxsIGJlY29tZSB0aGUgbW9kZWwgY29udGV4dCBvZiB0aGUgbGlua2Vk
        IHJvdXRlOgoKICAgIGBgYGhhbmRsZWJhcnMKICAgIHt7I2xpbmstdG8gJ3Bo
        b3RvR2FsbGVyeS5jb21tZW50JyBhUGhvdG8gY29tbWVudH19CiAgICAgIHt7
        Y29tbWVudC5ib2R5fX0KICAgIHt7L2xpbmstdG99fQogICAgYGBgCgogICAg
        YGBgaHRtbAogICAgPGEgaHJlZj0iL2hhbXN0ZXItcGhvdG9zLzQyL2NvbW1l
        bnQvNzE4Ij4KICAgICAgQSsrKyB3b3VsZCBzbnVnZ2xlIGFnYWluLgogICAg
        PC9hPgogICAgYGBgCgogICAgIyMjIFN1cHBseWluZyBhbiBleHBsaWNpdCBk
        eW5hbWljIHNlZ21lbnQgdmFsdWUKICAgIElmIHlvdSBkb24ndCBoYXZlIGEg
        bW9kZWwgb2JqZWN0IGF2YWlsYWJsZSB0byBwYXNzIHRvIGB7e2xpbmstdG99
        fWAsCiAgICBhbiBvcHRpb25hbCBzdHJpbmcgb3IgaW50ZWdlciBhcmd1bWVu
        dCBjYW4gYmUgcGFzc2VkIGZvciByb3V0ZXMgd2hvc2UKICAgIHBhdGhzIGNv
        bnRhaW4gZHluYW1pYyBzZWdtZW50cy4gVGhpcyBhcmd1bWVudCB3aWxsIGJl
        Y29tZSB0aGUgdmFsdWUKICAgIG9mIHRoZSBkeW5hbWljIHNlZ21lbnQ6Cgog
        ICAgYGBgamF2YXNjcmlwdAogICAgQXBwLlJvdXRlci5tYXAoZnVuY3Rpb24o
        KSB7CiAgICAgIHRoaXMucmVzb3VyY2UoInBob3RvR2FsbGVyeSIsIHtwYXRo
        OiAiaGFtc3Rlci1waG90b3MvOnBob3RvX2lkIn0pOwogICAgfSk7CiAgICBg
        YGAKCiAgICBgYGBoYW5kbGViYXJzCiAgICB7eyNsaW5rLXRvICdwaG90b0dh
        bGxlcnknIGFQaG90b0lkfX0KICAgICAge3thUGhvdG8udGl0bGV9fQogICAg
        e3svbGluay10b319CiAgICBgYGAKCiAgICBgYGBodG1sCiAgICA8YSBocmVm
        PSIvaGFtc3Rlci1waG90b3MvNDIiPgogICAgICBUb21zdGVyCiAgICA8L2E+
        CiAgICBgYGAKCiAgICBXaGVuIHRyYW5zaXRpb25pbmcgaW50byB0aGUgbGlu
        a2VkIHJvdXRlLCB0aGUgYG1vZGVsYCBob29rIHdpbGwKICAgIGJlIHRyaWdn
        ZXJlZCB3aXRoIHBhcmFtZXRlcnMgaW5jbHVkaW5nIHRoaXMgcGFzc2VkIGlk
        ZW50aWZpZXIuCgogICAgIyMjIE92ZXJyaWRpbmcgYXR0cmlidXRlcwogICAg
        WW91IGNhbiBvdmVycmlkZSBhbnkgZ2l2ZW4gcHJvcGVydHkgb2YgdGhlIEVt
        YmVyLkxpbmtWaWV3CiAgICB0aGF0IGlzIGdlbmVyYXRlZCBieSB0aGUgYHt7
        bGluay10b319YCBoZWxwZXIgYnkgcGFzc2luZwogICAga2V5L3ZhbHVlIHBh
        aXJzLCBsaWtlIHNvOgoKICAgIGBgYGhhbmRsZWJhcnMKICAgIHt7I2xpbmst
        dG8gIGFQaG90byB0YWdOYW1lPSdsaScgdGl0bGU9J0ZvbGxvd2luZyB0aGlz
        IGxpbmsgd2lsbCBjaGFuZ2UgeW91ciBsaWZlJyBjbGFzc05hbWVzPVsncGlj
        JywgJ3N3ZWV0J119fQogICAgICBVaC1tYXppbmchCiAgICB7ey9saW5rLXRv
        fX0KICAgIGBgYAoKICAgIFNlZSBbRW1iZXIuTGlua1ZpZXddKC9hcGkvY2xh
        c3Nlcy9FbWJlci5MaW5rVmlldy5odG1sKSBmb3IgYQogICAgY29tcGxldGUg
        bGlzdCBvZiBvdmVycmlkZWFibGUgcHJvcGVydGllcy4gQmUgc3VyZSB0byBh
        bHNvCiAgICBjaGVjayBvdXQgaW5oZXJpdGVkIHByb3BlcnRpZXMgb2YgYExp
        bmtWaWV3YC4KCiAgICAjIyMgT3ZlcnJpZGluZyBBcHBsaWNhdGlvbi13aWRl
        IERlZmF1bHRzCiAgICBgYHt7bGluay10b319YGAgY3JlYXRlcyBhbiBpbnN0
        YW5jZSBvZiBFbWJlci5MaW5rVmlldwogICAgZm9yIHJlbmRlcmluZy4gVG8g
        b3ZlcnJpZGUgb3B0aW9ucyBmb3IgeW91ciBlbnRpcmUKICAgIGFwcGxpY2F0
        aW9uLCByZW9wZW4gRW1iZXIuTGlua1ZpZXcgYW5kIHN1cHBseSB0aGUKICAg
        IGRlc2lyZWQgdmFsdWVzOgoKICAgIGBgYCBqYXZhc2NyaXB0CiAgICBFbWJl
        ci5MaW5rVmlldy5yZW9wZW4oewogICAgICBhY3RpdmVDbGFzczogImlzLWFj
        dGl2ZSIsCiAgICAgIHRhZ05hbWU6ICdsaScKICAgIH0pCiAgICBgYGAKCiAg
        ICBJdCBpcyBhbHNvIHBvc3NpYmxlIHRvIG92ZXJyaWRlIHRoZSBkZWZhdWx0
        IGV2ZW50IGluCiAgICB0aGlzIG1hbm5lcjoKCiAgICBgYGAgamF2YXNjcmlw
        dAogICAgRW1iZXIuTGlua1ZpZXcucmVvcGVuKHsKICAgICAgZXZlbnROYW1l
        OiAnY3VzdG9tRXZlbnROYW1lJwogICAgfSk7CiAgICBgYGAKCiAgICBAbWV0
        aG9kIGxpbmstdG8KICAgIEBmb3IgRW1iZXIuSGFuZGxlYmFycy5oZWxwZXJz
        CiAgICBAcGFyYW0ge1N0cmluZ30gcm91dGVOYW1lCiAgICBAcGFyYW0ge09i
        amVjdH0gW2NvbnRleHRdKgogICAgQHBhcmFtIFtvcHRpb25zXSB7T2JqZWN0
        fSBIYW5kbGViYXJzIGtleS92YWx1ZSBwYWlycyBvZiBvcHRpb25zLCB5b3Ug
        Y2FuIG92ZXJyaWRlIGFueSBwcm9wZXJ0eSBvZiBFbWJlci5MaW5rVmlldwog
        ICAgQHJldHVybiB7U3RyaW5nfSBIVE1MIHN0cmluZwogICAgQHNlZSB7RW1i
        ZXIuTGlua1ZpZXd9CiAgKi8KICBFbWJlci5IYW5kbGViYXJzLnJlZ2lzdGVy
        SGVscGVyKCdsaW5rLXRvJywgZnVuY3Rpb24obmFtZSkgewogICAgdmFyIG9w
        dGlvbnMgPSBbXS5zbGljZS5jYWxsKGFyZ3VtZW50cywgLTEpWzBdLAogICAg
        ICAgIHBhcmFtcyA9IFtdLnNsaWNlLmNhbGwoYXJndW1lbnRzLCAwLCAtMSks
        CiAgICAgICAgaGFzaCA9IG9wdGlvbnMuaGFzaDsKCiAgICBoYXNoLmRpc2Fi
        bGVkQmluZGluZyA9IGhhc2guZGlzYWJsZWRXaGVuOwoKICAgIGhhc2gucGFy
        YW1ldGVycyA9IHsKICAgICAgY29udGV4dDogdGhpcywKICAgICAgb3B0aW9u
        czogb3B0aW9ucywKICAgICAgcGFyYW1zOiBwYXJhbXMKICAgIH07CgogICAg
        cmV0dXJuIEVtYmVyLkhhbmRsZWJhcnMuaGVscGVycy52aWV3LmNhbGwodGhp
        cywgTGlua1ZpZXcsIG9wdGlvbnMpOwogIH0pOwoKICAvKioKICAgIFNlZSBb
        bGluay10b10oL2FwaS9jbGFzc2VzL0VtYmVyLkhhbmRsZWJhcnMuaGVscGVy
        cy5odG1sI21ldGhvZF9saW5rLXRvKQoKICAgIEBtZXRob2QgbGlua1RvCiAg
        ICBAZm9yIEVtYmVyLkhhbmRsZWJhcnMuaGVscGVycwogICAgQGRlcHJlY2F0
        ZWQKICAgIEBwYXJhbSB7U3RyaW5nfSByb3V0ZU5hbWUKICAgIEBwYXJhbSB7
        T2JqZWN0fSBbY29udGV4dF0qCiAgICBAcmV0dXJuIHtTdHJpbmd9IEhUTUwg
        c3RyaW5nCiAgKi8KICBFbWJlci5IYW5kbGViYXJzLnJlZ2lzdGVySGVscGVy
        KCdsaW5rVG8nLCBFbWJlci5IYW5kbGViYXJzLmhlbHBlcnNbJ2xpbmstdG8n
        XSk7Cn0pOwoKCgp9KSgpOwoKCgooZnVuY3Rpb24oKSB7Ci8qKgpAbW9kdWxl
        IGVtYmVyCkBzdWJtb2R1bGUgZW1iZXItcm91dGluZwoqLwoKdmFyIGdldCA9
        IEVtYmVyLmdldCwgc2V0ID0gRW1iZXIuc2V0OwpFbWJlci5vbkxvYWQoJ0Vt
        YmVyLkhhbmRsZWJhcnMnLCBmdW5jdGlvbihIYW5kbGViYXJzKSB7CiAgLyoq
        CiAgQG1vZHVsZSBlbWJlcgogIEBzdWJtb2R1bGUgZW1iZXItcm91dGluZwog
        ICovCgogIEhhbmRsZWJhcnMuT3V0bGV0VmlldyA9IEVtYmVyLkNvbnRhaW5l
        clZpZXcuZXh0ZW5kKEVtYmVyLl9NZXRhbW9ycGgpOwoKICAvKioKICAgIFRo
        ZSBgb3V0bGV0YCBoZWxwZXIgaXMgYSBwbGFjZWhvbGRlciB0aGF0IHRoZSBy
        b3V0ZXIgd2lsbCBmaWxsIGluIHdpdGgKICAgIHRoZSBhcHByb3ByaWF0ZSB0
        ZW1wbGF0ZSBiYXNlZCBvbiB0aGUgY3VycmVudCBzdGF0ZSBvZiB0aGUgYXBw
        bGljYXRpb24uCgogICAgYGBgIGhhbmRsZWJhcnMKICAgIHt7b3V0bGV0fX0K
        ICAgIGBgYAoKICAgIEJ5IGRlZmF1bHQsIGEgdGVtcGxhdGUgYmFzZWQgb24g
        RW1iZXIncyBuYW1pbmcgY29udmVudGlvbnMgd2lsbCBiZSByZW5kZXJlZAog
        ICAgaW50byB0aGUgYG91dGxldGAgKGUuZy4gYEFwcC5Qb3N0c1JvdXRlYCB3
        aWxsIHJlbmRlciB0aGUgYHBvc3RzYCB0ZW1wbGF0ZSkuCgogICAgWW91IGNh
        biByZW5kZXIgYSBkaWZmZXJlbnQgdGVtcGxhdGUgYnkgdXNpbmcgdGhlIGBy
        ZW5kZXIoKWAgbWV0aG9kIGluIHRoZQogICAgcm91dGUncyBgcmVuZGVyVGVt
        cGxhdGVgIGhvb2suIFRoZSBmb2xsb3dpbmcgd2lsbCByZW5kZXIgdGhlIGBm
        YXZvcml0ZVBvc3RgCiAgICB0ZW1wbGF0ZSBpbnRvIHRoZSBgb3V0bGV0YC4K
        CiAgICBgYGAgamF2YXNjcmlwdAogICAgQXBwLlBvc3RzUm91dGUgPSBFbWJl
        ci5Sb3V0ZS5leHRlbmQoewogICAgICByZW5kZXJUZW1wbGF0ZTogZnVuY3Rp
        b24oKSB7CiAgICAgICAgdGhpcy5yZW5kZXIoJ2Zhdm9yaXRlUG9zdCcpOwog
        ICAgICB9CiAgICB9KTsKICAgIGBgYAoKICAgIFlvdSBjYW4gY3JlYXRlIGN1
        c3RvbSBuYW1lZCBvdXRsZXRzIGZvciBtb3JlIGNvbnRyb2wuCgogICAgYGBg
        IGhhbmRsZWJhcnMKICAgIHt7b3V0bGV0ICdmYXZvcml0ZVBvc3QnfX0KICAg
        IHt7b3V0bGV0ICdwb3N0cyd9fQogICAgYGBgCgogICAgVGhlbiB5b3UgY2Fu
        IGRlZmluZSB3aGF0IHRlbXBsYXRlIGlzIHJlbmRlcmVkIGludG8gZWFjaCBv
        dXRsZXQgaW4geW91cgogICAgcm91dGUuCgoKICAgIGBgYCBqYXZhc2NyaXB0
        CiAgICBBcHAuUG9zdHNSb3V0ZSA9IEVtYmVyLlJvdXRlLmV4dGVuZCh7CiAg
        ICAgIHJlbmRlclRlbXBsYXRlOiBmdW5jdGlvbigpIHsKICAgICAgICB0aGlz
        LnJlbmRlcignZmF2b3JpdGVQb3N0JywgeyBvdXRsZXQ6ICdmYXZvcml0ZVBv
        c3QnIH0pOwogICAgICAgIHRoaXMucmVuZGVyKCdwb3N0cycsIHsgb3V0bGV0
        OiAncG9zdHMnIH0pOwogICAgICB9CiAgICB9KTsKICAgIGBgYAoKICAgIFlv
        dSBjYW4gc3BlY2lmeSB0aGUgdmlldyBjbGFzcyB0aGF0IHRoZSBvdXRsZXQg
        dXNlcyB0byBjb250YWluIGFuZCBtYW5hZ2UgdGhlCiAgICB0ZW1wbGF0ZXMg
        cmVuZGVyZWQgaW50byBpdC4KCiAgICBgYGAgaGFuZGxlYmFycwogICAge3tv
        dXRsZXQgdmlld0NsYXNzPUFwcC5TZWN0aW9uQ29udGFpbmVyfX0KICAgIGBg
        YAoKICAgIGBgYCBqYXZhc2NyaXB0CiAgICBBcHAuU2VjdGlvbkNvbnRhaW5l
        ciA9IEVtYmVyLkNvbnRhaW5lclZpZXcuZXh0ZW5kKHsKICAgICAgdGFnTmFt
        ZTogJ3NlY3Rpb24nLAogICAgICBjbGFzc05hbWVzOiBbJ3NwZWNpYWwnXQog
        ICAgfSk7CiAgICBgYGAKCiAgICBAbWV0aG9kIG91dGxldAogICAgQGZvciBF
        bWJlci5IYW5kbGViYXJzLmhlbHBlcnMKICAgIEBwYXJhbSB7U3RyaW5nfSBw
        cm9wZXJ0eSB0aGUgcHJvcGVydHkgb24gdGhlIGNvbnRyb2xsZXIKICAgICAg
        dGhhdCBob2xkcyB0aGUgdmlldyBmb3IgdGhpcyBvdXRsZXQKICAgIEByZXR1
        cm4ge1N0cmluZ30gSFRNTCBzdHJpbmcKICAqLwogIEhhbmRsZWJhcnMucmVn
        aXN0ZXJIZWxwZXIoJ291dGxldCcsIGZ1bmN0aW9uKHByb3BlcnR5LCBvcHRp
        b25zKSB7CiAgICB2YXIgb3V0bGV0U291cmNlLCBvdXRsZXRDb250YWluZXJD
        bGFzczsKCiAgICBpZiAocHJvcGVydHkgJiYgcHJvcGVydHkuZGF0YSAmJiBw
        cm9wZXJ0eS5kYXRhLmlzUmVuZGVyRGF0YSkgewogICAgICBvcHRpb25zID0g
        cHJvcGVydHk7CiAgICAgIHByb3BlcnR5ID0gJ21haW4nOwogICAgfQoKICAg
        IG91dGxldFNvdXJjZSA9IG9wdGlvbnMuZGF0YS52aWV3OwogICAgd2hpbGUg
        KCFvdXRsZXRTb3VyY2UuZ2V0KCd0ZW1wbGF0ZS5pc1RvcCcpKSB7CiAgICAg
        IG91dGxldFNvdXJjZSA9IG91dGxldFNvdXJjZS5nZXQoJ19wYXJlbnRWaWV3
        Jyk7CiAgICB9CgogICAgb3V0bGV0Q29udGFpbmVyQ2xhc3MgPSBvcHRpb25z
        Lmhhc2gudmlld0NsYXNzIHx8IEhhbmRsZWJhcnMuT3V0bGV0VmlldzsKCiAg
        ICBvcHRpb25zLmRhdGEudmlldy5zZXQoJ291dGxldFNvdXJjZScsIG91dGxl
        dFNvdXJjZSk7CiAgICBvcHRpb25zLmhhc2guY3VycmVudFZpZXdCaW5kaW5n
        ID0gJ192aWV3Lm91dGxldFNvdXJjZS5fb3V0bGV0cy4nICsgcHJvcGVydHk7
        CgogICAgcmV0dXJuIEhhbmRsZWJhcnMuaGVscGVycy52aWV3LmNhbGwodGhp
        cywgb3V0bGV0Q29udGFpbmVyQ2xhc3MsIG9wdGlvbnMpOwogIH0pOwp9KTsK
        Cn0pKCk7CgoKCihmdW5jdGlvbigpIHsKLyoqCkBtb2R1bGUgZW1iZXIKQHN1
        Ym1vZHVsZSBlbWJlci1yb3V0aW5nCiovCgp2YXIgZ2V0ID0gRW1iZXIuZ2V0
        LCBzZXQgPSBFbWJlci5zZXQ7CkVtYmVyLm9uTG9hZCgnRW1iZXIuSGFuZGxl
        YmFycycsIGZ1bmN0aW9uKEhhbmRsZWJhcnMpIHsKCiAgLyoqCiAgICBDYWxs
        aW5nIGBge3tyZW5kZXJ9fWBgIGZyb20gd2l0aGluIGEgdGVtcGxhdGUgd2ls
        bCBpbnNlcnQgYW5vdGhlciAKICAgIHRlbXBsYXRlIHRoYXQgbWF0Y2hlcyB0
        aGUgcHJvdmlkZWQgbmFtZS4gVGhlIGluc2VydGVkIHRlbXBsYXRlIHdpbGwK
        ICAgIGFjY2VzcyBpdHMgcHJvcGVydGllcyBvbiBpdHMgb3duIGNvbnRyb2xs
        ZXIgKHJhdGhlciB0aGFuIHRoZSBjb250cm9sbGVyCiAgICBvZiB0aGUgcGFy
        ZW50IHRlbXBsYXRlKS4KCiAgICBJZiBhIHZpZXcgY2xhc3Mgd2l0aCB0aGUg
        c2FtZSBuYW1lIGV4aXN0cywgdGhlIHZpZXcgY2xhc3MgYWxzbyB3aWxsIGJl
        IHVzZWQuCiAgICAKICAgIE5vdGU6IEEgZ2l2ZW4gY29udHJvbGxlciBtYXkg
        b25seSBiZSB1c2VkICpvbmNlKiBpbiB5b3VyIGFwcCBpbiB0aGlzIG1hbm5l
        ci4KICAgIEEgc2luZ2xldG9uIGluc3RhbmNlIG9mIHRoZSBjb250cm9sbGVy
        IHdpbGwgYmUgY3JlYXRlZCBmb3IgeW91LgoKICAgIEV4YW1wbGU6CgogICAg
        YGBgamF2YXNjcmlwdAogICAgQXBwLk5hdmlnYXRpb25Db250cm9sbGVyID0g
        RW1iZXIuQ29udHJvbGxlci5leHRlbmQoewogICAgICB3aG86ICJ3b3JsZCIK
        ICAgIH0pOwogICAgYGBgCgogICAgYGBgaGFuZGVsYmFycwogICAgPCEtLSBu
        YXZpZ2F0aW9uLmhicyAtLT4KICAgIEhlbGxvLCB7e3dob319LgogICAgYGBg
        CgogICAgYGBgaGFuZGVsYmFycwogICAgPCEtLSBhcHBsaWNhdGlvbnMuaGJz
        IC0tPgogICAgPGgxPk15IGdyZWF0IGFwcDwvaDE+CiAgICB7e3JlbmRlciBu
        YXZpZ2F0b259fQogICAgYGBgCiAgICAKICAgIGBgYGh0bWwKICAgIDxoMT5N
        eSBncmVhdCBhcHA8L2gxPgogICAgPGRpdiBjbGFzcz0nZW1iZXItdmlldyc+
        CiAgICAgIEhlbGxvLCB3b3JsZC4KICAgIDwvZGl2PgogICAgYGBgCgogICAg
        T3B0aW9uYWxseSB5b3UgbWF5IHByb3ZpZGUgYSAgc2Vjb25kIGFyZ3VtZW50
        OiBhIHByb3BlcnR5IHBhdGgKICAgIHRoYXQgd2lsbCBiZSBib3VuZCB0byB0
        aGUgYG1vZGVsYCBwcm9wZXJ0eSBvZiB0aGUgY29udHJvbGxlci4KCiAgICBJ
        ZiBhIGBtb2RlbGAgcHJvcGVydHkgcGF0aCBpcyBzcGVjaWZpZWQsIHRoZW4g
        YSBuZXcgaW5zdGFuY2Ugb2YgdGhlCiAgICBjb250cm9sbGVyIHdpbGwgYmUg
        Y3JlYXRlZCBhbmQgYHt7cmVuZGVyfX1gIGNhbiBiZSB1c2VkIG11bHRpcGxl
        IHRpbWVzCiAgICB3aXRoIHRoZSBzYW1lIG5hbWUuCgogICBGb3IgZXhhbXBs
        ZSBpZiB5b3UgaGFkIHRoaXMgYGF1dGhvcmAgdGVtcGxhdGUuCgogICBgYGBo
        YW5kbGViYXJzCjxkaXYgY2xhc3M9ImF1dGhvciI+CiAgV3JpdHRlbiBieSB7
        e2ZpcnN0TmFtZX19IHt7bGFzdE5hbWV9fS4KICBUb3RhbCBQb3N0czoge3tw
        b3N0Q291bnR9fQo8L2Rpdj4KICBgYGAKCiAgWW91IGNvdWxkIHJlbmRlciBp
        dCBpbnNpZGUgdGhlIGBwb3N0YCB0ZW1wbGF0ZSB1c2luZyB0aGUgYHJlbmRl
        cmAgaGVscGVyLgoKICBgYGBoYW5kbGViYXJzCjxkaXYgY2xhc3M9InBvc3Qi
        PgogIDxoMT57e3RpdGxlfX08L2gxPgogIDxkaXY+e3tib2R5fX08L2Rpdj4K
        ICB7e3JlbmRlciAiYXV0aG9yIiBhdXRob3J9fQo8L2Rpdj4KICAgYGBgCgog
        ICAgQG1ldGhvZCByZW5kZXIKICAgIEBmb3IgRW1iZXIuSGFuZGxlYmFycy5o
        ZWxwZXJzCiAgICBAcGFyYW0ge1N0cmluZ30gbmFtZQogICAgQHBhcmFtIHtP
        YmplY3Q/fSBjb250ZXh0U3RyaW5nCiAgICBAcGFyYW0ge0hhc2h9IG9wdGlv
        bnMKICAgIEByZXR1cm4ge1N0cmluZ30gSFRNTCBzdHJpbmcKICAqLwogIEVt
        YmVyLkhhbmRsZWJhcnMucmVnaXN0ZXJIZWxwZXIoJ3JlbmRlcicsIGZ1bmN0
        aW9uKG5hbWUsIGNvbnRleHRTdHJpbmcsIG9wdGlvbnMpIHsKICAgIEVtYmVy
        LmFzc2VydCgiWW91IG11c3QgcGFzcyBhIHRlbXBsYXRlIHRvIHJlbmRlciIs
        IGFyZ3VtZW50cy5sZW5ndGggPj0gMik7CiAgICB2YXIgY29udGV4dFByb3Zp
        ZGVkID0gYXJndW1lbnRzLmxlbmd0aCA9PT0gMywKICAgICAgICBjb250YWlu
        ZXIsIHJvdXRlciwgY29udHJvbGxlciwgdmlldywgY29udGV4dCwgbG9va3Vw
        T3B0aW9uczsKCiAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMikgewog
        ICAgICBvcHRpb25zID0gY29udGV4dFN0cmluZzsKICAgICAgY29udGV4dFN0
        cmluZyA9IHVuZGVmaW5lZDsKICAgIH0KCiAgICBpZiAodHlwZW9mIGNvbnRl
        eHRTdHJpbmcgPT09ICdzdHJpbmcnKSB7CiAgICAgIGNvbnRleHQgPSBFbWJl
        ci5IYW5kbGViYXJzLmdldChvcHRpb25zLmNvbnRleHRzWzFdLCBjb250ZXh0
        U3RyaW5nLCBvcHRpb25zKTsKICAgICAgbG9va3VwT3B0aW9ucyA9IHsgc2lu
        Z2xldG9uOiBmYWxzZSB9OwogICAgfQoKICAgIG5hbWUgPSBuYW1lLnJlcGxh
        Y2UoL1wvL2csICcuJyk7CiAgICBjb250YWluZXIgPSBvcHRpb25zLmRhdGEu
        a2V5d29yZHMuY29udHJvbGxlci5jb250YWluZXI7CiAgICByb3V0ZXIgPSBj
        b250YWluZXIubG9va3VwKCdyb3V0ZXI6bWFpbicpOwoKICAgIEVtYmVyLmFz
        c2VydCgiWW91IGNhbiBvbmx5IHVzZSB0aGUge3tyZW5kZXJ9fSBoZWxwZXIg
        b25jZSB3aXRob3V0IGEgbW9kZWwgb2JqZWN0IGFzIGl0cyBzZWNvbmQgYXJn
        dW1lbnQsIGFzIGluIHt7cmVuZGVyIFwicG9zdFwiIHBvc3R9fS4iLCBjb250
        ZXh0UHJvdmlkZWQgfHwgIXJvdXRlciB8fCAhcm91dGVyLl9sb29rdXBBY3Rp
        dmVWaWV3KG5hbWUpKTsKCiAgICB2aWV3ID0gY29udGFpbmVyLmxvb2t1cCgn
        dmlldzonICsgbmFtZSkgfHwgY29udGFpbmVyLmxvb2t1cCgndmlldzpkZWZh
        dWx0Jyk7CgogICAgdmFyIGNvbnRyb2xsZXJOYW1lID0gb3B0aW9ucy5oYXNo
        LmNvbnRyb2xsZXI7CgogICAgLy8gTG9vayB1cCB0aGUgY29udHJvbGxlciBi
        eSBuYW1lLCBpZiBwcm92aWRlZC4KICAgIGlmIChjb250cm9sbGVyTmFtZSkg
        ewogICAgICBjb250cm9sbGVyID0gY29udGFpbmVyLmxvb2t1cCgnY29udHJv
        bGxlcjonICsgY29udHJvbGxlck5hbWUsIGxvb2t1cE9wdGlvbnMpOwogICAg
        ICBFbWJlci5hc3NlcnQoIlRoZSBjb250cm9sbGVyIG5hbWUgeW91IHN1cHBs
        aWVkICciICsgY29udHJvbGxlck5hbWUgKyAiJyBkaWQgbm90IHJlc29sdmUg
        dG8gYSBjb250cm9sbGVyLiIsICEhY29udHJvbGxlcik7CiAgICB9IGVsc2Ug
        ewogICAgICBjb250cm9sbGVyID0gY29udGFpbmVyLmxvb2t1cCgnY29udHJv
        bGxlcjonICsgbmFtZSwgbG9va3VwT3B0aW9ucykgfHwKICAgICAgICAgICAg
        ICAgICAgICAgIEVtYmVyLmdlbmVyYXRlQ29udHJvbGxlcihjb250YWluZXIs
        IG5hbWUsIGNvbnRleHQpOwogICAgfQoKICAgIGlmIChjb250cm9sbGVyICYm
        IGNvbnRleHRQcm92aWRlZCkgewogICAgICBjb250cm9sbGVyLnNldCgnbW9k
        ZWwnLCBjb250ZXh0KTsKICAgIH0KCiAgICB2YXIgcm9vdCA9IG9wdGlvbnMu
        Y29udGV4dHNbMV07CgogICAgaWYgKHJvb3QpIHsKICAgICAgdmlldy5yZWdp
        c3Rlck9ic2VydmVyKHJvb3QsIGNvbnRleHRTdHJpbmcsIGZ1bmN0aW9uKCkg
        ewogICAgICAgIGNvbnRyb2xsZXIuc2V0KCdtb2RlbCcsIEVtYmVyLkhhbmRs
        ZWJhcnMuZ2V0KHJvb3QsIGNvbnRleHRTdHJpbmcsIG9wdGlvbnMpKTsKICAg
        ICAgfSk7CiAgICB9CgogICAgY29udHJvbGxlci5zZXQoJ3RhcmdldCcsIG9w
        dGlvbnMuZGF0YS5rZXl3b3Jkcy5jb250cm9sbGVyKTsKCiAgICBvcHRpb25z
        Lmhhc2gudmlld05hbWUgPSBFbWJlci5TdHJpbmcuY2FtZWxpemUobmFtZSk7
        CiAgICBvcHRpb25zLmhhc2gudGVtcGxhdGUgPSBjb250YWluZXIubG9va3Vw
        KCd0ZW1wbGF0ZTonICsgbmFtZSk7CiAgICBvcHRpb25zLmhhc2guY29udHJv
        bGxlciA9IGNvbnRyb2xsZXI7CgogICAgaWYgKHJvdXRlciAmJiAhY29udGV4
        dCkgewogICAgICByb3V0ZXIuX2Nvbm5lY3RBY3RpdmVWaWV3KG5hbWUsIHZp
        ZXcpOwogICAgfQoKICAgIEVtYmVyLkhhbmRsZWJhcnMuaGVscGVycy52aWV3
        LmNhbGwodGhpcywgdmlldywgb3B0aW9ucyk7CiAgfSk7Cgp9KTsKCn0pKCk7
        CgoKCihmdW5jdGlvbigpIHsKLyoqCkBtb2R1bGUgZW1iZXIKQHN1Ym1vZHVs
        ZSBlbWJlci1yb3V0aW5nCiovCkVtYmVyLm9uTG9hZCgnRW1iZXIuSGFuZGxl
        YmFycycsIGZ1bmN0aW9uKEhhbmRsZWJhcnMpIHsKCiAgdmFyIHJlc29sdmVQ
        YXJhbXMgPSBFbWJlci5Sb3V0ZXIucmVzb2x2ZVBhcmFtcywKICAgICAgaXNT
        aW1wbGVDbGljayA9IEVtYmVyLlZpZXdVdGlscy5pc1NpbXBsZUNsaWNrOwoK
        ICB2YXIgRW1iZXJIYW5kbGViYXJzID0gRW1iZXIuSGFuZGxlYmFycywKICAg
        ICAgaGFuZGxlYmFyc0dldCA9IEVtYmVySGFuZGxlYmFycy5nZXQsCiAgICAg
        IFNhZmVTdHJpbmcgPSBFbWJlckhhbmRsZWJhcnMuU2FmZVN0cmluZywKICAg
        ICAgZm9yRWFjaCA9IEVtYmVyLkFycmF5UG9seWZpbGxzLmZvckVhY2gsCiAg
        ICAgIGdldCA9IEVtYmVyLmdldCwKICAgICAgYV9zbGljZSA9IEFycmF5LnBy
        b3RvdHlwZS5zbGljZTsKCiAgZnVuY3Rpb24gYXJncyhvcHRpb25zLCBhY3Rp
        b25OYW1lKSB7CiAgICB2YXIgcmV0ID0gW107CiAgICBpZiAoYWN0aW9uTmFt
        ZSkgeyByZXQucHVzaChhY3Rpb25OYW1lKTsgfQoKICAgIHZhciB0eXBlcyA9
        IG9wdGlvbnMub3B0aW9ucy50eXBlcy5zbGljZSgxKSwKICAgICAgICBkYXRh
        ID0gb3B0aW9ucy5vcHRpb25zLmRhdGE7CgogICAgcmV0dXJuIHJldC5jb25j
        YXQocmVzb2x2ZVBhcmFtcyhvcHRpb25zLmNvbnRleHQsIG9wdGlvbnMucGFy
        YW1zLCB7IHR5cGVzOiB0eXBlcywgZGF0YTogZGF0YSB9KSk7CiAgfQoKICB2
        YXIgQWN0aW9uSGVscGVyID0gRW1iZXJIYW5kbGViYXJzLkFjdGlvbkhlbHBl
        ciA9IHsKICAgIHJlZ2lzdGVyZWRBY3Rpb25zOiB7fQogIH07CgogIHZhciBr
        ZXlzID0gWyJhbHQiLCAic2hpZnQiLCAibWV0YSIsICJjdHJsIl07CgogIHZh
        ciBpc0FsbG93ZWRDbGljayA9IGZ1bmN0aW9uKGV2ZW50LCBhbGxvd2VkS2V5
        cykgewogICAgaWYgKHR5cGVvZiBhbGxvd2VkS2V5cyA9PT0gInVuZGVmaW5l
        ZCIpIHsKICAgICAgcmV0dXJuIGlzU2ltcGxlQ2xpY2soZXZlbnQpOwogICAg
        fQoKICAgIGlmIChhbGxvd2VkS2V5cy5pbmRleE9mKCJhbnkiKSA+PSAwKSB7
        CiAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIHZhciBhbGxvd2VkID0g
        dHJ1ZTsKCiAgICBmb3JFYWNoLmNhbGwoa2V5cywgZnVuY3Rpb24oa2V5KSB7
        CiAgICAgIGlmIChldmVudFtrZXkgKyAiS2V5Il0gJiYgYWxsb3dlZEtleXMu
        aW5kZXhPZihrZXkpID09PSAtMSkgewogICAgICAgIGFsbG93ZWQgPSBmYWxz
        ZTsKICAgICAgfQogICAgfSk7CgogICAgcmV0dXJuIGFsbG93ZWQ7CiAgfTsK
        CiAgQWN0aW9uSGVscGVyLnJlZ2lzdGVyQWN0aW9uID0gZnVuY3Rpb24oYWN0
        aW9uTmFtZSwgb3B0aW9ucywgYWxsb3dlZEtleXMpIHsKICAgIHZhciBhY3Rp
        b25JZCA9ICgrK0VtYmVyLnV1aWQpLnRvU3RyaW5nKCk7CgogICAgQWN0aW9u
        SGVscGVyLnJlZ2lzdGVyZWRBY3Rpb25zW2FjdGlvbklkXSA9IHsKICAgICAg
        ZXZlbnROYW1lOiBvcHRpb25zLmV2ZW50TmFtZSwKICAgICAgaGFuZGxlcjog
        ZnVuY3Rpb24oZXZlbnQpIHsKICAgICAgICBpZiAoIWlzQWxsb3dlZENsaWNr
        KGV2ZW50LCBhbGxvd2VkS2V5cykpIHsgcmV0dXJuIHRydWU7IH0KCiAgICAg
        ICAgZXZlbnQucHJldmVudERlZmF1bHQoKTsKCiAgICAgICAgaWYgKG9wdGlv
        bnMuYnViYmxlcyA9PT0gZmFsc2UpIHsKICAgICAgICAgIGV2ZW50LnN0b3BQ
        cm9wYWdhdGlvbigpOwogICAgICAgIH0KCiAgICAgICAgdmFyIHRhcmdldCA9
        IG9wdGlvbnMudGFyZ2V0OwoKICAgICAgICBpZiAodGFyZ2V0LnRhcmdldCkg
        ewogICAgICAgICAgdGFyZ2V0ID0gaGFuZGxlYmFyc0dldCh0YXJnZXQucm9v
        dCwgdGFyZ2V0LnRhcmdldCwgdGFyZ2V0Lm9wdGlvbnMpOwogICAgICAgIH0g
        ZWxzZSB7CiAgICAgICAgICB0YXJnZXQgPSB0YXJnZXQucm9vdDsKICAgICAg
        ICB9CgogICAgICAgIEVtYmVyLnJ1bihmdW5jdGlvbigpIHsKICAgICAgICAg
        IGlmICh0YXJnZXQuc2VuZCkgewogICAgICAgICAgICB0YXJnZXQuc2VuZC5h
        cHBseSh0YXJnZXQsIGFyZ3Mob3B0aW9ucy5wYXJhbWV0ZXJzLCBhY3Rpb25O
        YW1lKSk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBFbWJlci5h
        c3NlcnQoIlRoZSBhY3Rpb24gJyIgKyBhY3Rpb25OYW1lICsgIicgZGlkIG5v
        dCBleGlzdCBvbiAiICsgdGFyZ2V0LCB0eXBlb2YgdGFyZ2V0W2FjdGlvbk5h
        bWVdID09PSAnZnVuY3Rpb24nKTsKICAgICAgICAgICAgdGFyZ2V0W2FjdGlv
        bk5hbWVdLmFwcGx5KHRhcmdldCwgYXJncyhvcHRpb25zLnBhcmFtZXRlcnMp
        KTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfQogICAgfTsKCiAg
        ICBvcHRpb25zLnZpZXcub24oJ3dpbGxDbGVhclJlbmRlcicsIGZ1bmN0aW9u
        KCkgewogICAgICBkZWxldGUgQWN0aW9uSGVscGVyLnJlZ2lzdGVyZWRBY3Rp
        b25zW2FjdGlvbklkXTsKICAgIH0pOwoKICAgIHJldHVybiBhY3Rpb25JZDsK
        ICB9OwoKICAvKioKICAgIFRoZSBge3thY3Rpb259fWAgaGVscGVyIHJlZ2lz
        dGVycyBhbiBIVE1MIGVsZW1lbnQgd2l0aGluIGEgdGVtcGxhdGUgZm9yIERP
        TQogICAgZXZlbnQgaGFuZGxpbmcgYW5kIGZvcndhcmRzIHRoYXQgaW50ZXJh
        Y3Rpb24gdG8gdGhlIHRlbXBsYXRlcydzIGNvbnRyb2xsZXIKICAgIG9yIHN1
        cHBsaWVkIGB0YXJnZXRgIG9wdGlvbiAoc2VlICdTcGVjaWZ5aW5nIGEgVGFy
        Z2V0JykuCgogICAgSWYgdGhlIGNvbnRyb2xsZXIgZG9lcyBub3QgaW1wbGVt
        ZW50IHRoZSBldmVudCwgdGhlIGV2ZW50IGlzIHNlbnQKICAgIHRvIHRoZSBj
        dXJyZW50IHJvdXRlLCBhbmQgaXQgYnViYmxlcyB1cCB0aGUgcm91dGUgaGll
        cmFyY2h5IGZyb20gdGhlcmUuCgogICAgVXNlciBpbnRlcmFjdGlvbiB3aXRo
        IHRoYXQgZWxlbWVudCB3aWxsIGludm9rZSB0aGUgc3VwcGxpZWQgYWN0aW9u
        IG5hbWUgb24KICAgIHRoZSBhcHByb3ByaWF0ZSB0YXJnZXQuCgogICAgR2l2
        ZW4gdGhlIGZvbGxvd2luZyBhcHBsaWNhdGlvbiBIYW5kbGViYXJzIHRlbXBs
        YXRlIG9uIHRoZSBwYWdlCgogICAgYGBgaGFuZGxlYmFycwogICAgPGRpdiB7
        e2FjdGlvbiAnYW5BY3Rpb25OYW1lJ319PgogICAgICBjbGljayBtZQogICAg
        PC9kaXY+CiAgICBgYGAKCiAgICBBbmQgYXBwbGljYXRpb24gY29kZQoKICAg
        IGBgYGphdmFzY3JpcHQKICAgIEFwcC5BcHBsaWNhdGlvbkNvbnRyb2xsZXIg
        PSBFbWJlci5Db250cm9sbGVyLmV4dGVuZCh7CiAgICAgIGFjdGlvbnM6IHsK
        ICAgICAgICBhbkFjdGlvbk5hbWU6IGZ1bmN0aW9uKCkgewogICAgICAgICAg
        CiAgICAgICAgfSAgCiAgICAgIH0KICAgIH0pOwogICAgYGBgCgogICAgV2ls
        bCByZXN1bHQgaW4gdGhlIGZvbGxvd2luZyByZW5kZXJlZCBIVE1MCgogICAg
        YGBgaHRtbAogICAgPGRpdiBjbGFzcz0iZW1iZXItdmlldyI+CiAgICAgIDxk
        aXYgZGF0YS1lbWJlci1hY3Rpb249IjEiPgogICAgICAgIGNsaWNrIG1lCiAg
        ICAgIDwvZGl2PgogICAgPC9kaXY+CiAgICBgYGAKCiAgICBDbGlja2luZyAi
        Y2xpY2sgbWUiIHdpbGwgdHJpZ2dlciB0aGUgYGFuQWN0aW9uTmFtZWAgYWN0
        aW9uIG9mIHRoZQogICAgYEFwcC5BcHBsaWNhdGlvbkNvbnRyb2xsZXJgLiBJ
        biB0aGlzIGNhc2UsIG5vIGFkZGl0aW9uYWwgcGFyYW1ldGVycyB3aWxsIGJl
        IHBhc3NlZC4KCiAgICBJZiB5b3UgcHJvdmlkZSBhZGRpdGlvbmFsIHBhcmFt
        ZXRlcnMgdG8gdGhlIGhlbHBlcjoKCiAgICBgYGBoYW5kbGViYXJzCiAgICA8
        YnV0dG9uIHt7YWN0aW9uICdlZGl0JyBwb3N0fX0+RWRpdDwvYnV0dG9uPgog
        ICAgYGBgCgogICAgVGhvc2UgcGFyYW1ldGVycyB3aWxsIGJlIHBhc3NlZCBh
        bG9uZyBhcyBhcmd1bWVudHMgdG8gdGhlIEphdmFTY3JpcHQKICAgIGZ1bmN0
        aW9uIGltcGxlbWVudGluZyB0aGUgYWN0aW9uLgoKICAgICMjIyBFdmVudCBQ
        cm9wYWdhdGlvbgoKICAgIEV2ZW50cyB0cmlnZ2VyZWQgdGhyb3VnaCB0aGUg
        YWN0aW9uIGhlbHBlciB3aWxsIGF1dG9tYXRpY2FsbHkgaGF2ZQogICAgYC5w
        cmV2ZW50RGVmYXVsdCgpYCBjYWxsZWQgb24gdGhlbS4gWW91IGRvIG5vdCBu
        ZWVkIHRvIGRvIHNvIGluIHlvdXIgZXZlbnQKICAgIGhhbmRsZXJzLgoKICAg
        IFRvIGFsc28gZGlzYWJsZSBidWJibGluZywgcGFzcyBgYnViYmxlcz1mYWxz
        ZWAgdG8gdGhlIGhlbHBlcjoKCiAgICBgYGBoYW5kbGViYXJzCiAgICA8YnV0
        dG9uIHt7YWN0aW9uICdlZGl0JyBwb3N0IGJ1YmJsZXM9ZmFsc2V9fT5FZGl0
        PC9idXR0b24+CiAgICBgYGAKCiAgICBJZiB5b3UgbmVlZCB0aGUgZGVmYXVs
        dCBoYW5kbGVyIHRvIHRyaWdnZXIgeW91IHNob3VsZCBlaXRoZXIgcmVnaXN0
        ZXIgeW91cgogICAgb3duIGV2ZW50IGhhbmRsZXIsIG9yIHVzZSBldmVudCBt
        ZXRob2RzIG9uIHlvdXIgdmlldyBjbGFzcy4gU2VlIFtFbWJlci5WaWV3XSgv
        YXBpL2NsYXNzZXMvRW1iZXIuVmlldy5odG1sKQogICAgJ1Jlc3BvbmRpbmcg
        dG8gQnJvd3NlciBFdmVudHMnIGZvciBtb3JlIGluZm9ybWF0aW9uLgoKICAg
        ICMjIyBTcGVjaWZ5aW5nIERPTSBldmVudCB0eXBlCgogICAgQnkgZGVmYXVs
        dCB0aGUgYHt7YWN0aW9ufX1gIGhlbHBlciByZWdpc3RlcnMgZm9yIERPTSBg
        Y2xpY2tgIGV2ZW50cy4gWW91IGNhbgogICAgc3VwcGx5IGFuIGBvbmAgb3B0
        aW9uIHRvIHRoZSBoZWxwZXIgdG8gc3BlY2lmeSBhIGRpZmZlcmVudCBET00g
        ZXZlbnQgbmFtZToKCiAgICBgYGBoYW5kbGViYXJzCiAgICA8ZGl2IHt7YWN0
        aW9uICJhbkFjdGlvbk5hbWUiIG9uPSJkb3VibGVDbGljayJ9fT4KICAgICAg
        Y2xpY2sgbWUKICAgIDwvZGl2PgogICAgYGBgCgogICAgU2VlIGBFbWJlci5W
        aWV3YCAnUmVzcG9uZGluZyB0byBCcm93c2VyIEV2ZW50cycgZm9yIGEgbGlz
        dCBvZgogICAgYWNjZXB0YWJsZSBET00gZXZlbnQgbmFtZXMuCgogICAgTk9U
        RTogQmVjYXVzZSBge3thY3Rpb259fWAgZGVwZW5kcyBvbiBFbWJlcidzIGV2
        ZW50IGRpc3BhdGNoIHN5c3RlbSBpdCB3aWxsCiAgICBvbmx5IGZ1bmN0aW9u
        IGlmIGFuIGBFbWJlci5FdmVudERpc3BhdGNoZXJgIGluc3RhbmNlIGlzIGF2
        YWlsYWJsZS4gQW4KICAgIGBFbWJlci5FdmVudERpc3BhdGNoZXJgIGluc3Rh
        bmNlIHdpbGwgYmUgY3JlYXRlZCB3aGVuIGEgbmV3IGBFbWJlci5BcHBsaWNh
        dGlvbmAKICAgIGlzIGNyZWF0ZWQuIEhhdmluZyBhbiBpbnN0YW5jZSBvZiBg
        RW1iZXIuQXBwbGljYXRpb25gIHdpbGwgc2F0aXNmeSB0aGlzCiAgICByZXF1
        aXJlbWVudC4KCiAgICAjIyMgU3BlY2lmeWluZyB3aGl0ZWxpc3RlZCBtb2Rp
        ZmllciBrZXlzCgogICAgQnkgZGVmYXVsdCB0aGUgYHt7YWN0aW9ufX1gIGhl
        bHBlciB3aWxsIGlnbm9yZSBjbGljayBldmVudCB3aXRoIHByZXNzZWQgbW9k
        aWZpZXIKICAgIGtleXMuIFlvdSBjYW4gc3VwcGx5IGFuIGBhbGxvd2VkS2V5
        c2Agb3B0aW9uIHRvIHNwZWNpZnkgd2hpY2gga2V5cyBzaG91bGQgbm90IGJl
        IGlnbm9yZWQuCgogICAgYGBgaGFuZGxlYmFycwogICAgPGRpdiB7e2FjdGlv
        biAiYW5BY3Rpb25OYW1lIiBhbGxvd2VkS2V5cz0iYWx0In19PgogICAgICBj
        bGljayBtZQogICAgPC9kaXY+CiAgICBgYGAKCiAgICBUaGlzIHdheSB0aGUg
        YHt7YWN0aW9ufX1gIHdpbGwgZmlyZSB3aGVuIGNsaWNraW5nIHdpdGggdGhl
        IGFsdCBrZXkgcHJlc3NlZCBkb3duLgoKICAgIEFsdGVybmF0aXZlbHksIHN1
        cHBseSAiYW55IiB0byB0aGUgYGFsbG93ZWRLZXlzYCBvcHRpb24gdG8gYWNj
        ZXB0IGFueSBjb21iaW5hdGlvbiBvZiBtb2RpZmllciBrZXlzLgoKICAgIGBg
        YGhhbmRsZWJhcnMKICAgIDxkaXYge3thY3Rpb24gImFuQWN0aW9uTmFtZSIg
        YWxsb3dlZEtleXM9ImFueSJ9fT4KICAgICAgY2xpY2sgbWUgd2l0aCBhbnkg
        a2V5IHByZXNzZWQKICAgIDwvZGl2PgogICAgYGBgCgogICAgIyMjIFNwZWNp
        ZnlpbmcgYSBUYXJnZXQKCiAgICBUaGVyZSBhcmUgc2V2ZXJhbCBwb3NzaWJs
        ZSB0YXJnZXQgb2JqZWN0cyBmb3IgYHt7YWN0aW9ufX1gIGhlbHBlcnM6Cgog
        ICAgSW4gYSB0eXBpY2FsIEVtYmVyIGFwcGxpY2F0aW9uLCB3aGVyZSB2aWV3
        cyBhcmUgbWFuYWdlZCB0aHJvdWdoIHVzZSBvZiB0aGUKICAgIGB7e291dGxl
        dH19YCBoZWxwZXIsIGFjdGlvbnMgd2lsbCBidWJibGUgdG8gdGhlIGN1cnJl
        bnQgY29udHJvbGxlciwgdGhlbgogICAgdG8gdGhlIGN1cnJlbnQgcm91dGUs
        IGFuZCB0aGVuIHVwIHRoZSByb3V0ZSBoaWVyYXJjaHkuCgogICAgQWx0ZXJu
        YXRpdmVseSwgYSBgdGFyZ2V0YCBvcHRpb24gY2FuIGJlIHByb3ZpZGVkIHRv
        IHRoZSBoZWxwZXIgdG8gY2hhbmdlCiAgICB3aGljaCBvYmplY3Qgd2lsbCBy
        ZWNlaXZlIHRoZSBtZXRob2QgY2FsbC4gVGhpcyBvcHRpb24gbXVzdCBiZSBh
        IHBhdGgKICAgIHRvIGFuIG9iamVjdCwgYWNjZXNzaWJsZSBpbiB0aGUgY3Vy
        cmVudCBjb250ZXh0OgoKICAgIGBgYGhhbmRsZWJhcnMKICAgIHt7ISB0aGUg
        YXBwbGljYXRpb24gdGVtcGxhdGUgfX0KICAgIDxkaXYge3thY3Rpb24gImFu
        QWN0aW9uTmFtZSIgdGFyZ2V0PXZpZXd9fT4KICAgICAgY2xpY2sgbWUKICAg
        IDwvZGl2PgogICAgYGBgCgogICAgYGBgamF2YXNjcmlwdAogICAgQXBwLkFw
        cGxpY2F0aW9uVmlldyA9IEVtYmVyLlZpZXcuZXh0ZW5kKHsKICAgICAgYWN0
        aW9uczogewogICAgICAgIGFuQWN0aW9uTmFtZTogZnVuY3Rpb24oKXt9CiAg
        ICAgIH0KICAgIH0pOwoKICAgIGBgYAoKICAgICMjIyBBZGRpdGlvbmFsIFBh
        cmFtZXRlcnMKCiAgICBZb3UgbWF5IHNwZWNpZnkgYWRkaXRpb25hbCBwYXJh
        bWV0ZXJzIHRvIHRoZSBge3thY3Rpb259fWAgaGVscGVyLiBUaGVzZQogICAg
        cGFyYW1ldGVycyBhcmUgcGFzc2VkIGFsb25nIGFzIHRoZSBhcmd1bWVudHMg
        dG8gdGhlIEphdmFTY3JpcHQgZnVuY3Rpb24KICAgIGltcGxlbWVudGluZyB0
        aGUgYWN0aW9uLgoKICAgIGBgYGhhbmRsZWJhcnMKICAgIHt7I2VhY2ggcGVy
        c29uIGluIHBlb3BsZX19CiAgICAgIDxkaXYge3thY3Rpb24gImVkaXQiIHBl
        cnNvbn19PgogICAgICAgIGNsaWNrIG1lCiAgICAgIDwvZGl2PgogICAge3sv
        ZWFjaH19CiAgICBgYGAKCiAgICBDbGlja2luZyAiY2xpY2sgbWUiIHdpbGwg
        dHJpZ2dlciB0aGUgYGVkaXRgIG1ldGhvZCBvbiB0aGUgY3VycmVudCBjb250
        cm9sbGVyCiAgICB3aXRoIHRoZSB2YWx1ZSBvZiBgcGVyc29uYCBhcyBhIHBh
        cmFtZXRlci4KCiAgICBAbWV0aG9kIGFjdGlvbgogICAgQGZvciBFbWJlci5I
        YW5kbGViYXJzLmhlbHBlcnMKICAgIEBwYXJhbSB7U3RyaW5nfSBhY3Rpb25O
        YW1lCiAgICBAcGFyYW0ge09iamVjdH0gW2NvbnRleHRdKgogICAgQHBhcmFt
        IHtIYXNofSBvcHRpb25zCiAgKi8KICBFbWJlckhhbmRsZWJhcnMucmVnaXN0
        ZXJIZWxwZXIoJ2FjdGlvbicsIGZ1bmN0aW9uKGFjdGlvbk5hbWUpIHsKICAg
        IHZhciBvcHRpb25zID0gYXJndW1lbnRzW2FyZ3VtZW50cy5sZW5ndGggLSAx
        XSwKICAgICAgICBjb250ZXh0cyA9IGFfc2xpY2UuY2FsbChhcmd1bWVudHMs
        IDEsIC0xKTsKCiAgICB2YXIgaGFzaCA9IG9wdGlvbnMuaGFzaCwKICAgICAg
        ICBjb250cm9sbGVyOwoKICAgIC8vIGNyZWF0ZSBhIGhhc2ggdG8gcGFzcyBh
        bG9uZyB0byByZWdpc3RlckFjdGlvbgogICAgdmFyIGFjdGlvbiA9IHsKICAg
        ICAgZXZlbnROYW1lOiBoYXNoLm9uIHx8ICJjbGljayIKICAgIH07CgogICAg
        YWN0aW9uLnBhcmFtZXRlcnMgPSB7CiAgICAgIGNvbnRleHQ6IHRoaXMsCiAg
        ICAgIG9wdGlvbnM6IG9wdGlvbnMsCiAgICAgIHBhcmFtczogY29udGV4dHMK
        ICAgIH07CgogICAgYWN0aW9uLnZpZXcgPSBvcHRpb25zLmRhdGEudmlldzsK
        CiAgICB2YXIgcm9vdCwgdGFyZ2V0OwoKICAgIGlmIChoYXNoLnRhcmdldCkg
        ewogICAgICByb290ID0gdGhpczsKICAgICAgdGFyZ2V0ID0gaGFzaC50YXJn
        ZXQ7CiAgICB9IGVsc2UgaWYgKGNvbnRyb2xsZXIgPSBvcHRpb25zLmRhdGEu
        a2V5d29yZHMuY29udHJvbGxlcikgewogICAgICByb290ID0gY29udHJvbGxl
        cjsKICAgIH0KCiAgICBhY3Rpb24udGFyZ2V0ID0geyByb290OiByb290LCB0
        YXJnZXQ6IHRhcmdldCwgb3B0aW9uczogb3B0aW9ucyB9OwogICAgYWN0aW9u
        LmJ1YmJsZXMgPSBoYXNoLmJ1YmJsZXM7CgogICAgdmFyIGFjdGlvbklkID0g
        QWN0aW9uSGVscGVyLnJlZ2lzdGVyQWN0aW9uKGFjdGlvbk5hbWUsIGFjdGlv
        biwgaGFzaC5hbGxvd2VkS2V5cyk7CiAgICByZXR1cm4gbmV3IFNhZmVTdHJp
        bmcoJ2RhdGEtZW1iZXItYWN0aW9uPSInICsgYWN0aW9uSWQgKyAnIicpOwog
        IH0pOwoKfSk7Cgp9KSgpOwoKCgooZnVuY3Rpb24oKSB7Ci8qKgpAbW9kdWxl
        IGVtYmVyCkBzdWJtb2R1bGUgZW1iZXItcm91dGluZwoqLwoKaWYgKEVtYmVy
        LkVOVi5FWFBFUklNRU5UQUxfQ09OVFJPTF9IRUxQRVIpIHsKICB2YXIgZ2V0
        ID0gRW1iZXIuZ2V0LCBzZXQgPSBFbWJlci5zZXQ7CgogIC8qKgogICBge3tj
        b250cm9sfX1gIHdvcmtzIGxpa2UgcmVuZGVyLCBleGNlcHQgaXQgdXNlcyBh
        IG5ldyBjb250cm9sbGVyIGluc3RhbmNlIGZvciBldmVyeSBjYWxsLCBpbnN0
        ZWFkIG9mIHJldXNpbmcgdGhlIHNpbmdsZXRvbiBjb250cm9sbGVyLgoKICAg
        IFRoZSBjb250cm9sIGhlbHBlciBpcyBjdXJyZW50bHkgdW5kZXIgZGV2ZWxv
        cG1lbnQgYW5kIGlzIGNvbnNpZGVyZWQgZXhwZXJpbWVudGFsLgogICAgVG8g
        ZW5hYmxlIGl0LCBzZXQgYEVOVi5FWFBFUklNRU5UQUxfQ09OVFJPTF9IRUxQ
        RVIgPSB0cnVlYCBiZWZvcmUgcmVxdWlyaW5nIEVtYmVyLgoKICAgRm9yIGV4
        YW1wbGUgaWYgeW91IGhhZCB0aGlzIGBhdXRob3JgIHRlbXBsYXRlLgoKICAg
        YGBgaGFuZGxlYmFycwo8ZGl2IGNsYXNzPSJhdXRob3IiPgogIFdyaXR0ZW4g
        Ynkge3tmaXJzdE5hbWV9fSB7e2xhc3ROYW1lfX0uCiAgVG90YWwgUG9zdHM6
        IHt7cG9zdENvdW50fX0KPC9kaXY+CiAgIGBgYAoKICAgWW91IGNvdWxkIHJl
        bmRlciBpdCBpbnNpZGUgdGhlIGBwb3N0YCB0ZW1wbGF0ZSB1c2luZyB0aGUg
        YGNvbnRyb2xgIGhlbHBlci4KCiAgIGBgYGhhbmRsZWJhcnMKPGRpdiBjbGFz
        cz0icG9zdCI+CiAgPGgxPnt7dGl0bGV9fTwvaDE+CiAgPGRpdj57e2JvZHl9
        fTwvZGl2PgogICAgIHt7Y29udHJvbCAiYXV0aG9yIiBhdXRob3J9fQo8L2Rp
        dj4KICAgYGBgCgogICAgQG1ldGhvZCBjb250cm9sCiAgICBAZm9yIEVtYmVy
        LkhhbmRsZWJhcnMuaGVscGVycwogICAgQHBhcmFtIHtTdHJpbmd9IHBhdGgK
        ICAgIEBwYXJhbSB7U3RyaW5nfSBtb2RlbFBhdGgKICAgIEBwYXJhbSB7SGFz
        aH0gb3B0aW9ucwogICAgQHJldHVybiB7U3RyaW5nfSBIVE1MIHN0cmluZwog
        ICovCiAgRW1iZXIuSGFuZGxlYmFycy5yZWdpc3RlckhlbHBlcignY29udHJv
        bCcsIGZ1bmN0aW9uKHBhdGgsIG1vZGVsUGF0aCwgb3B0aW9ucykgewogICAg
        aWYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDIpIHsKICAgICAgb3B0aW9ucyA9
        IG1vZGVsUGF0aDsKICAgICAgbW9kZWxQYXRoID0gdW5kZWZpbmVkOwogICAg
        fQoKICAgIHZhciBtb2RlbDsKCiAgICBpZiAobW9kZWxQYXRoKSB7CiAgICAg
        IG1vZGVsID0gRW1iZXIuSGFuZGxlYmFycy5nZXQodGhpcywgbW9kZWxQYXRo
        LCBvcHRpb25zKTsKICAgIH0KCiAgICB2YXIgY29udHJvbGxlciA9IG9wdGlv
        bnMuZGF0YS5rZXl3b3Jkcy5jb250cm9sbGVyLAogICAgICAgIHZpZXcgPSBv
        cHRpb25zLmRhdGEua2V5d29yZHMudmlldywKICAgICAgICBjaGlsZHJlbiA9
        IGdldChjb250cm9sbGVyLCAnX2NoaWxkQ29udGFpbmVycycpLAogICAgICAg
        IGNvbnRyb2xJRCA9IG9wdGlvbnMuaGFzaC5jb250cm9sSUQsCiAgICAgICAg
        Y29udGFpbmVyLCBzdWJDb250YWluZXI7CgogICAgaWYgKGNoaWxkcmVuLmhh
        c093blByb3BlcnR5KGNvbnRyb2xJRCkpIHsKICAgICAgc3ViQ29udGFpbmVy
        ID0gY2hpbGRyZW5bY29udHJvbElEXTsKICAgIH0gZWxzZSB7CiAgICAgIGNv
        bnRhaW5lciA9IGdldChjb250cm9sbGVyLCAnY29udGFpbmVyJyksCiAgICAg
        IHN1YkNvbnRhaW5lciA9IGNvbnRhaW5lci5jaGlsZCgpOwogICAgICBjaGls
        ZHJlbltjb250cm9sSURdID0gc3ViQ29udGFpbmVyOwogICAgfQoKICAgIHZh
        ciBub3JtYWxpemVkUGF0aCA9IHBhdGgucmVwbGFjZSgvXC8vZywgJy4nKTsK
        CiAgICB2YXIgY2hpbGRWaWV3ID0gc3ViQ29udGFpbmVyLmxvb2t1cCgndmll
        dzonICsgbm9ybWFsaXplZFBhdGgpIHx8IHN1YkNvbnRhaW5lci5sb29rdXAo
        J3ZpZXc6ZGVmYXVsdCcpLAogICAgICAgIGNoaWxkQ29udHJvbGxlciA9IHN1
        YkNvbnRhaW5lci5sb29rdXAoJ2NvbnRyb2xsZXI6JyArIG5vcm1hbGl6ZWRQ
        YXRoKSwKICAgICAgICBjaGlsZFRlbXBsYXRlID0gc3ViQ29udGFpbmVyLmxv
        b2t1cCgndGVtcGxhdGU6JyArIHBhdGgpOwoKICAgIEVtYmVyLmFzc2VydCgi
        Q291bGQgbm90IGZpbmQgY29udHJvbGxlciBmb3IgcGF0aDogIiArIG5vcm1h
        bGl6ZWRQYXRoLCBjaGlsZENvbnRyb2xsZXIpOwogICAgRW1iZXIuYXNzZXJ0
        KCJDb3VsZCBub3QgZmluZCB2aWV3IGZvciBwYXRoOiAiICsgbm9ybWFsaXpl
        ZFBhdGgsIGNoaWxkVmlldyk7CgogICAgc2V0KGNoaWxkQ29udHJvbGxlciwg
        J3RhcmdldCcsIGNvbnRyb2xsZXIpOwogICAgc2V0KGNoaWxkQ29udHJvbGxl
        ciwgJ21vZGVsJywgbW9kZWwpOwoKICAgIG9wdGlvbnMuaGFzaC50ZW1wbGF0
        ZSA9IGNoaWxkVGVtcGxhdGU7CiAgICBvcHRpb25zLmhhc2guY29udHJvbGxl
        ciA9IGNoaWxkQ29udHJvbGxlcjsKCiAgICBmdW5jdGlvbiBvYnNlcnZlcigp
        IHsKICAgICAgdmFyIG1vZGVsID0gRW1iZXIuSGFuZGxlYmFycy5nZXQodGhp
        cywgbW9kZWxQYXRoLCBvcHRpb25zKTsKICAgICAgc2V0KGNoaWxkQ29udHJv
        bGxlciwgJ21vZGVsJywgbW9kZWwpOwogICAgICBjaGlsZFZpZXcucmVyZW5k
        ZXIoKTsKICAgIH0KCiAgICBpZiAobW9kZWxQYXRoKSB7CiAgICAgIEVtYmVy
        LmFkZE9ic2VydmVyKHRoaXMsIG1vZGVsUGF0aCwgb2JzZXJ2ZXIpOwogICAg
        ICBjaGlsZFZpZXcub25lKCd3aWxsRGVzdHJveUVsZW1lbnQnLCB0aGlzLCBm
        dW5jdGlvbigpIHsKICAgICAgICBFbWJlci5yZW1vdmVPYnNlcnZlcih0aGlz
        LCBtb2RlbFBhdGgsIG9ic2VydmVyKTsKICAgICAgfSk7CiAgICB9CgogICAg
        RW1iZXIuSGFuZGxlYmFycy5oZWxwZXJzLnZpZXcuY2FsbCh0aGlzLCBjaGls
        ZFZpZXcsIG9wdGlvbnMpOwogIH0pOwp9Cgp9KSgpOwoKCgooZnVuY3Rpb24o
        KSB7Cgp9KSgpOwoKCgooZnVuY3Rpb24oKSB7Ci8qKgpAbW9kdWxlIGVtYmVy
        CkBzdWJtb2R1bGUgZW1iZXItcm91dGluZwoqLwoKdmFyIGdldCA9IEVtYmVy
        LmdldCwgc2V0ID0gRW1iZXIuc2V0OwoKRW1iZXIuQ29udHJvbGxlck1peGlu
        LnJlb3Blbih7CiAgLyoqCiAgICBUcmFuc2l0aW9uIHRoZSBhcHBsaWNhdGlv
        biBpbnRvIGFub3RoZXIgcm91dGUuIFRoZSByb3V0ZSBtYXkKICAgIGJlIGVp
        dGhlciBhIHNpbmdsZSByb3V0ZSBvciByb3V0ZSBwYXRoOgoKICAgIGBgYGph
        dmFzY3JpcHQKICAgICAgYUNvbnRyb2xsZXIudHJhbnNpdGlvblRvUm91dGUo
        J2Jsb2dQb3N0cycpOwogICAgICBhQ29udHJvbGxlci50cmFuc2l0aW9uVG9S
        b3V0ZSgnYmxvZ1Bvc3RzLnJlY2VudEVudHJpZXMnKTsKICAgIGBgYAoKICAg
        IE9wdGlvbmFsbHkgc3VwcGx5IGEgbW9kZWwgZm9yIHRoZSByb3V0ZSBpbiBx
        dWVzdGlvbi4gVGhlIG1vZGVsCiAgICB3aWxsIGJlIHNlcmlhbGl6ZWQgaW50
        byB0aGUgVVJMIHVzaW5nIHRoZSBgc2VyaWFsaXplYCBob29rIG9mCiAgICB0
        aGUgcm91dGU6CgogICAgYGBgamF2YXNjcmlwdAogICAgICBhQ29udHJvbGxl
        ci50cmFuc2l0aW9uVG9Sb3V0ZSgnYmxvZ1Bvc3QnLCBhUG9zdCk7CiAgICBg
        YGAKCiAgICBNdWx0aXBsZSBtb2RlbHMgd2lsbCBiZSBhcHBsaWVkIGxhc3Qg
        dG8gZmlyc3QgcmVjdXJzaXZlbHkgdXAgdGhlCiAgICByZXNvdXJjZSB0cmVl
        LgoKICAgIGBgYGphdmFzY3JpcHQKCiAgICAgIHRoaXMucmVzb3VyY2UoJ2Js
        b2dQb3N0Jywge3BhdGg6JzpibG9nUG9zdElkJ30sIGZ1bmN0aW9uKCl7CiAg
        ICAgICAgdGhpcy5yZXNvdXJjZSgnYmxvZ0NvbW1lbnQnLCB7cGF0aDogJzpi
        bG9nQ29tbWVudElkJ30pOwogICAgICB9KTsKICAgICAgCiAgICAgIGFDb250
        cm9sbGVyLnRyYW5zaXRpb25Ub1JvdXRlKCdibG9nQ29tbWVudCcsIGFQb3N0
        LCBhQ29tbWVudCk7CiAgICBgYGAKCiAgICBTZWUgYWxzbyAncmVwbGFjZVJv
        dXRlJy4KCiAgICBAcGFyYW0ge1N0cmluZ30gbmFtZSB0aGUgbmFtZSBvZiB0
        aGUgcm91dGUKICAgIEBwYXJhbSB7Li4uT2JqZWN0fSBtb2RlbHMgdGhlIG1v
        ZGVsKHMpIHRvIGJlIHVzZWQgd2hpbGUgdHJhbnNpdGlvbmluZwogICAgdG8g
        dGhlIHJvdXRlLgogICAgQGZvciBFbWJlci5Db250cm9sbGVyTWl4aW4KICAg
        IEBtZXRob2QgdHJhbnNpdGlvblRvUm91dGUKICAqLwogIHRyYW5zaXRpb25U
        b1JvdXRlOiBmdW5jdGlvbigpIHsKICAgIC8vIHRhcmdldCBtYXkgYmUgZWl0
        aGVyIGFub3RoZXIgY29udHJvbGxlciBvciBhIHJvdXRlcgogICAgdmFyIHRh
        cmdldCA9IGdldCh0aGlzLCAndGFyZ2V0JyksCiAgICAgICAgbWV0aG9kID0g
        dGFyZ2V0LnRyYW5zaXRpb25Ub1JvdXRlIHx8IHRhcmdldC50cmFuc2l0aW9u
        VG87CiAgICByZXR1cm4gbWV0aG9kLmFwcGx5KHRhcmdldCwgYXJndW1lbnRz
        KTsKICB9LAoKICAvKioKICAgIEBkZXByZWNhdGVkCiAgICBAZm9yIEVtYmVy
        LkNvbnRyb2xsZXJNaXhpbgogICAgQG1ldGhvZCB0cmFuc2l0aW9uVG8KICAq
        LwogIHRyYW5zaXRpb25UbzogZnVuY3Rpb24oKSB7CiAgICBFbWJlci5kZXBy
        ZWNhdGUoInRyYW5zaXRpb25UbyBpcyBkZXByZWNhdGVkLiBQbGVhc2UgdXNl
        IHRyYW5zaXRpb25Ub1JvdXRlLiIpOwogICAgcmV0dXJuIHRoaXMudHJhbnNp
        dGlvblRvUm91dGUuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICB9LAoKICAv
        KioKICAgIFRyYW5zaXRpb24gaW50byBhbm90aGVyIHJvdXRlIHdoaWxlIHJl
        cGxhY2luZyB0aGUgY3VycmVudCBVUkwsIGlmIHBvc3NpYmxlLgogICAgVGhp
        cyB3aWxsIHJlcGxhY2UgdGhlIGN1cnJlbnQgaGlzdG9yeSBlbnRyeSBpbnN0
        ZWFkIG9mIGFkZGluZyBhIG5ldyBvbmUuIAogICAgQmVzaWRlIHRoYXQsIGl0
        IGlzIGlkZW50aWNhbCB0byBgdHJhbnNpdGlvblRvUm91dGVgIGluIGFsbCBv
        dGhlciByZXNwZWN0cy4KCiAgICBgYGBqYXZhc2NyaXB0CiAgICAgIGFDb250
        cm9sbGVyLnJlcGxhY2VSb3V0ZSgnYmxvZ1Bvc3RzJyk7CiAgICAgIGFDb250
        cm9sbGVyLnJlcGxhY2VSb3V0ZSgnYmxvZ1Bvc3RzLnJlY2VudEVudHJpZXMn
        KTsKICAgIGBgYAoKICAgIE9wdGlvbmFsbHkgc3VwcGx5IGEgbW9kZWwgZm9y
        IHRoZSByb3V0ZSBpbiBxdWVzdGlvbi4gVGhlIG1vZGVsCiAgICB3aWxsIGJl
        IHNlcmlhbGl6ZWQgaW50byB0aGUgVVJMIHVzaW5nIHRoZSBgc2VyaWFsaXpl
        YCBob29rIG9mCiAgICB0aGUgcm91dGU6CgogICAgYGBgamF2YXNjcmlwdAog
        ICAgICBhQ29udHJvbGxlci5yZXBsYWNlUm91dGUoJ2Jsb2dQb3N0JywgYVBv
        c3QpOwogICAgYGBgCgogICAgTXVsdGlwbGUgbW9kZWxzIHdpbGwgYmUgYXBw
        bGllZCBsYXN0IHRvIGZpcnN0IHJlY3Vyc2l2ZWx5IHVwIHRoZQogICAgcmVz
        b3VyY2UgdHJlZS4KCiAgICBgYGBqYXZhc2NyaXB0CgogICAgICB0aGlzLnJl
        c291cmNlKCdibG9nUG9zdCcsIHtwYXRoOic6YmxvZ1Bvc3RJZCd9LCBmdW5j
        dGlvbigpewogICAgICAgIHRoaXMucmVzb3VyY2UoJ2Jsb2dDb21tZW50Jywg
        e3BhdGg6ICc6YmxvZ0NvbW1lbnRJZCd9KTsKICAgICAgfSk7CiAgICAgIAog
        ICAgICBhQ29udHJvbGxlci5yZXBsYWNlUm91dGUoJ2Jsb2dDb21tZW50Jywg
        YVBvc3QsIGFDb21tZW50KTsKICAgIGBgYAoKICAgIEBwYXJhbSB7U3RyaW5n
        fSBuYW1lIHRoZSBuYW1lIG9mIHRoZSByb3V0ZQogICAgQHBhcmFtIHsuLi5P
        YmplY3R9IG1vZGVscyB0aGUgbW9kZWwocykgdG8gYmUgdXNlZCB3aGlsZSB0
        cmFuc2l0aW9uaW5nCiAgICB0byB0aGUgcm91dGUuCiAgICBAZm9yIEVtYmVy
        LkNvbnRyb2xsZXJNaXhpbgogICAgQG1ldGhvZCByZXBsYWNlUm91dGUKICAq
        LwogIHJlcGxhY2VSb3V0ZTogZnVuY3Rpb24oKSB7CiAgICAvLyB0YXJnZXQg
        bWF5IGJlIGVpdGhlciBhbm90aGVyIGNvbnRyb2xsZXIgb3IgYSByb3V0ZXIK
        ICAgIHZhciB0YXJnZXQgPSBnZXQodGhpcywgJ3RhcmdldCcpLAogICAgICAg
        IG1ldGhvZCA9IHRhcmdldC5yZXBsYWNlUm91dGUgfHwgdGFyZ2V0LnJlcGxh
        Y2VXaXRoOwogICAgcmV0dXJuIG1ldGhvZC5hcHBseSh0YXJnZXQsIGFyZ3Vt
        ZW50cyk7CiAgfSwKCiAgLyoqCiAgICBAZGVwcmVjYXRlZAogICAgQGZvciBF
        bWJlci5Db250cm9sbGVyTWl4aW4KICAgIEBtZXRob2QgcmVwbGFjZVdpdGgK
        ICAqLwogIHJlcGxhY2VXaXRoOiBmdW5jdGlvbigpIHsKICAgIEVtYmVyLmRl
        cHJlY2F0ZSgicmVwbGFjZVdpdGggaXMgZGVwcmVjYXRlZC4gUGxlYXNlIHVz
        ZSByZXBsYWNlUm91dGUuIik7CiAgICByZXR1cm4gdGhpcy5yZXBsYWNlUm91
        dGUuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICB9Cn0pOwoKfSkoKTsKCgoK
        KGZ1bmN0aW9uKCkgewovKioKQG1vZHVsZSBlbWJlcgpAc3VibW9kdWxlIGVt
        YmVyLXJvdXRpbmcKKi8KCnZhciBnZXQgPSBFbWJlci5nZXQsIHNldCA9IEVt
        YmVyLnNldDsKCkVtYmVyLlZpZXcucmVvcGVuKHsKCiAgLyoqCiAgICBTZXRz
        IHRoZSBwcml2YXRlIGBfb3V0bGV0c2Agb2JqZWN0IG9uIHRoZSB2aWV3LgoK
        ICAgIEBtZXRob2QgaW5pdAogICAqLwogIGluaXQ6IGZ1bmN0aW9uKCkgewog
        ICAgc2V0KHRoaXMsICdfb3V0bGV0cycsIHt9KTsKICAgIHRoaXMuX3N1cGVy
        KCk7CiAgfSwKCiAgLyoqCiAgICBNYW51YWxseSBmaWxsIGFueSBvZiBhIHZp
        ZXcncyBge3tvdXRsZXR9fWAgYXJlYXMgd2l0aCB0aGUKICAgIHN1cHBsaWVk
        IHZpZXcuCgogICAgRXhhbXBsZQoKICAgIGBgYGphdmFzY3JpcHQKICAgIHZh
        ciBNeVZpZXcgPSBFbWJlci5WaWV3LmV4dGVuZCh7CiAgICAgIHRlbXBsYXRl
        OiBFbWJlci5IYW5kbGViYXJzLmNvbXBpbGUoJ0NoaWxkIHZpZXc6IHt7b3V0
        bGV0ICJtYWluIn19ICcpCiAgICB9KTsKICAgIHZhciBteVZpZXcgPSBNeVZp
        ZXcuY3JlYXRlKCk7CiAgICBteVZpZXcuYXBwZW5kVG8oJ2JvZHknKTsKICAg
        IC8vIFRoZSBodG1sIGZvciBteVZpZXcgbm93IGxvb2tzIGxpa2U6CiAgICAv
        LyA8ZGl2IGlkPSJlbWJlcjIyOCIgY2xhc3M9ImVtYmVyLXZpZXciPkNoaWxk
        IHZpZXc6IDwvZGl2PgoKICAgIG15Vmlldy5jb25uZWN0T3V0bGV0KCdtYWlu
        JywgRW1iZXIuVmlldy5leHRlbmQoewogICAgICB0ZW1wbGF0ZTogRW1iZXIu
        SGFuZGxlYmFycy5jb21waWxlKCc8aDE+Rm9vPC9oMT4gJykKICAgIH0pKTsK
        ICAgIC8vIFRoZSBodG1sIGZvciBteVZpZXcgbm93IGxvb2tzIGxpa2U6CiAg
        ICAvLyA8ZGl2IGlkPSJlbWJlcjIyOCIgY2xhc3M9ImVtYmVyLXZpZXciPkNo
        aWxkIHZpZXc6CiAgICAvLyAgIDxkaXYgaWQ9ImVtYmVyMjM0IiBjbGFzcz0i
        ZW1iZXItdmlldyI+PGgxPkZvbzwvaDE+IDwvZGl2PgogICAgLy8gPC9kaXY+
        CiAgICBgYGAKICAgIEBtZXRob2QgY29ubmVjdE91dGxldAogICAgQHBhcmFt
        ICB7U3RyaW5nfSBvdXRsZXROYW1lIEEgdW5pcXVlIG5hbWUgZm9yIHRoZSBv
        dXRsZXQKICAgIEBwYXJhbSAge09iamVjdH0gdmlldyAgICAgICBBbiBFbWJl
        ci5WaWV3CiAgICovCiAgY29ubmVjdE91dGxldDogZnVuY3Rpb24ob3V0bGV0
        TmFtZSwgdmlldykgewogICAgaWYgKHRoaXMuX3BlbmRpbmdEaXNjb25uZWN0
        aW9ucykgewogICAgICBkZWxldGUgdGhpcy5fcGVuZGluZ0Rpc2Nvbm5lY3Rp
        b25zW291dGxldE5hbWVdOwogICAgfQoKICAgIGlmICh0aGlzLl9oYXNFcXVp
        dmFsZW50VmlldyhvdXRsZXROYW1lLCB2aWV3KSkgewogICAgICB2aWV3LmRl
        c3Ryb3koKTsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIHZhciBvdXRsZXRz
        ID0gZ2V0KHRoaXMsICdfb3V0bGV0cycpLAogICAgICAgIGNvbnRhaW5lciA9
        IGdldCh0aGlzLCAnY29udGFpbmVyJyksCiAgICAgICAgcm91dGVyID0gY29u
        dGFpbmVyICYmIGNvbnRhaW5lci5sb29rdXAoJ3JvdXRlcjptYWluJyksCiAg
        ICAgICAgcmVuZGVyZWROYW1lID0gZ2V0KHZpZXcsICdyZW5kZXJlZE5hbWUn
        KTsKCiAgICBzZXQob3V0bGV0cywgb3V0bGV0TmFtZSwgdmlldyk7CgogICAg
        aWYgKHJvdXRlciAmJiByZW5kZXJlZE5hbWUpIHsKICAgICAgcm91dGVyLl9j
        b25uZWN0QWN0aXZlVmlldyhyZW5kZXJlZE5hbWUsIHZpZXcpOwogICAgfQog
        IH0sCgogIC8qKgogICAgQHByaXZhdGUKCiAgICBEZXRlcm1pbmVzIGlmIHRo
        ZSB2aWV3IGhhcyBhbHJlYWR5IGJlZW4gY3JlYXRlZCBieSBjaGVja2luZyBp
        ZgogICAgdGhlIHZpZXcgaGFzIHRoZSBzYW1lIGNvbnN0cnVjdG9yLCB0ZW1w
        bGF0ZSwgYW5kIGNvbnRleHQgYXMgdGhlCiAgICB2aWV3IGluIHRoZSBgX291
        dGxldHNgIG9iamVjdC4KCiAgICBAbWV0aG9kIF9oYXNFcXVpdmFsZW50Vmll
        dwogICAgQHBhcmFtICB7U3RyaW5nfSBvdXRsZXROYW1lIFRoZSBuYW1lIG9m
        IHRoZSBvdXRsZXQgd2UgYXJlIGNoZWNraW5nCiAgICBAcGFyYW0gIHtPYmpl
        Y3R9IHZpZXcgICAgICAgQW4gRW1iZXIuVmlldwogICAgQHJldHVybiB7Qm9v
        bGVhbn0KICAgKi8KICBfaGFzRXF1aXZhbGVudFZpZXc6IGZ1bmN0aW9uKG91
        dGxldE5hbWUsIHZpZXcpIHsKICAgIHZhciBleGlzdGluZ1ZpZXcgPSBnZXQo
        dGhpcywgJ19vdXRsZXRzLicrb3V0bGV0TmFtZSk7CiAgICByZXR1cm4gZXhp
        c3RpbmdWaWV3ICYmCiAgICAgIGV4aXN0aW5nVmlldy5jb25zdHJ1Y3RvciA9
        PT0gdmlldy5jb25zdHJ1Y3RvciAmJgogICAgICBleGlzdGluZ1ZpZXcuZ2V0
        KCd0ZW1wbGF0ZScpID09PSB2aWV3LmdldCgndGVtcGxhdGUnKSAmJgogICAg
        ICBleGlzdGluZ1ZpZXcuZ2V0KCdjb250ZXh0JykgPT09IHZpZXcuZ2V0KCdj
        b250ZXh0Jyk7CiAgfSwKCiAgLyoqCiAgICBSZW1vdmVzIGFuIG91dGxldCBm
        cm9tIHRoZSB2aWV3LgoKICAgIEV4YW1wbGUKCiAgICBgYGBqYXZhc2NyaXB0
        CiAgICB2YXIgTXlWaWV3ID0gRW1iZXIuVmlldy5leHRlbmQoewogICAgICB0
        ZW1wbGF0ZTogRW1iZXIuSGFuZGxlYmFycy5jb21waWxlKCdDaGlsZCB2aWV3
        OiB7e291dGxldCAibWFpbiJ9fSAnKQogICAgfSk7CiAgICB2YXIgbXlWaWV3
        ID0gTXlWaWV3LmNyZWF0ZSgpOwogICAgbXlWaWV3LmFwcGVuZFRvKCdib2R5
        Jyk7CiAgICAvLyBteVZpZXcncyBodG1sOgogICAgLy8gPGRpdiBpZD0iZW1i
        ZXIyMjgiIGNsYXNzPSJlbWJlci12aWV3Ij5DaGlsZCB2aWV3OiA8L2Rpdj4K
        CiAgICBteVZpZXcuY29ubmVjdE91dGxldCgnbWFpbicsIEVtYmVyLlZpZXcu
        ZXh0ZW5kKHsKICAgICAgdGVtcGxhdGU6IEVtYmVyLkhhbmRsZWJhcnMuY29t
        cGlsZSgnPGgxPkZvbzwvaDE+ICcpCiAgICB9KSk7CiAgICAvLyBteVZpZXcn
        cyBodG1sOgogICAgLy8gPGRpdiBpZD0iZW1iZXIyMjgiIGNsYXNzPSJlbWJl
        ci12aWV3Ij5DaGlsZCB2aWV3OgogICAgLy8gICA8ZGl2IGlkPSJlbWJlcjIz
        NCIgY2xhc3M9ImVtYmVyLXZpZXciPjxoMT5Gb288L2gxPiA8L2Rpdj4KICAg
        IC8vIDwvZGl2PgoKICAgIG15Vmlldy5kaXNjb25uZWN0T3V0bGV0KCdtYWlu
        Jyk7CiAgICAvLyBteVZpZXcncyBodG1sOgogICAgLy8gPGRpdiBpZD0iZW1i
        ZXIyMjgiIGNsYXNzPSJlbWJlci12aWV3Ij5DaGlsZCB2aWV3OiA8L2Rpdj4K
        ICAgIGBgYAoKICAgIEBtZXRob2QgZGlzY29ubmVjdE91dGxldAogICAgQHBh
        cmFtICB7U3RyaW5nfSBvdXRsZXROYW1lIFRoZSBuYW1lIG9mIHRoZSBvdXRs
        ZXQgdG8gYmUgcmVtb3ZlZAogICAqLwogIGRpc2Nvbm5lY3RPdXRsZXQ6IGZ1
        bmN0aW9uKG91dGxldE5hbWUpIHsKICAgIGlmICghdGhpcy5fcGVuZGluZ0Rp
        c2Nvbm5lY3Rpb25zKSB7CiAgICAgIHRoaXMuX3BlbmRpbmdEaXNjb25uZWN0
        aW9ucyA9IHt9OwogICAgfQogICAgdGhpcy5fcGVuZGluZ0Rpc2Nvbm5lY3Rp
        b25zW291dGxldE5hbWVdID0gdHJ1ZTsKICAgIEVtYmVyLnJ1bi5vbmNlKHRo
        aXMsICdfZmluaXNoRGlzY29ubmVjdGlvbnMnKTsKICB9LAoKICAvKioKICAg
        IEBwcml2YXRlCgogICAgR2V0cyBhbiBvdXRsZXQgdGhhdCBpcyBwZW5kaW5n
        IGRpc2Nvbm5lY3Rpb24gYW5kIHRoZW4KICAgIG51bGxpZnlzIHRoZSBvYmpl
        Y3Qgb24gdGhlIGBfb3V0bGV0YCBvYmplY3QuCgogICAgQG1ldGhvZCBfZmlu
        aXNoRGlzY29ubmVjdGlvbnMKICAgKi8KICBfZmluaXNoRGlzY29ubmVjdGlv
        bnM6IGZ1bmN0aW9uKCkgewogICAgdmFyIG91dGxldHMgPSBnZXQodGhpcywg
        J19vdXRsZXRzJyk7CiAgICB2YXIgcGVuZGluZ0Rpc2Nvbm5lY3Rpb25zID0g
        dGhpcy5fcGVuZGluZ0Rpc2Nvbm5lY3Rpb25zOwogICAgdGhpcy5fcGVuZGlu
        Z0Rpc2Nvbm5lY3Rpb25zID0gbnVsbDsKCiAgICBmb3IgKHZhciBvdXRsZXRO
        YW1lIGluIHBlbmRpbmdEaXNjb25uZWN0aW9ucykgewogICAgICBzZXQob3V0
        bGV0cywgb3V0bGV0TmFtZSwgbnVsbCk7CiAgICB9CiAgfQp9KTsKCn0pKCk7
        CgoKCihmdW5jdGlvbigpIHsKLyoqCkBtb2R1bGUgZW1iZXIKQHN1Ym1vZHVs
        ZSBlbWJlci12aWV3cwoqLwoKLy8gQWRkIGEgbmV3IG5hbWVkIHF1ZXVlIGFm
        dGVyIHRoZSAnYWN0aW9ucycgcXVldWUgKHdoZXJlIFJTVlAgcHJvbWlzZXMK
        Ly8gcmVzb2x2ZSksIHdoaWNoIGlzIHVzZWQgaW4gcm91dGVyIHRyYW5zaXRp
        b25zIHRvIHByZXZlbnQgdW5uZWNlc3NhcnkKLy8gbG9hZGluZyBzdGF0ZSBl
        bnRyeSBpZiBhbGwgY29udGV4dCBwcm9taXNlcyByZXNvbHZlIG9uIHRoZSAK
        Ly8gJ2FjdGlvbnMnIHF1ZXVlIGZpcnN0LgoKdmFyIHF1ZXVlcyA9IEVtYmVy
        LnJ1bi5xdWV1ZXMsCiAgICBpbmRleE9mID0gRW1iZXIuQXJyYXlQb2x5Zmls
        bHMuaW5kZXhPZjsKcXVldWVzLnNwbGljZShpbmRleE9mLmNhbGwocXVldWVz
        LCAnYWN0aW9ucycpICsgMSwgMCwgJ3JvdXRlclRyYW5zaXRpb25zJyk7Cgp9
        KSgpOwoKCgooZnVuY3Rpb24oKSB7Ci8qKgpAbW9kdWxlIGVtYmVyCkBzdWJt
        b2R1bGUgZW1iZXItcm91dGluZwoqLwoKdmFyIGdldCA9IEVtYmVyLmdldCwg
        c2V0ID0gRW1iZXIuc2V0OwoKLyoKICBUaGlzIGZpbGUgaW1wbGVtZW50cyB0
        aGUgYGxvY2F0aW9uYCBBUEkgdXNlZCBieSBFbWJlcidzIHJvdXRlci4KCiAg
        VGhhdCBBUEkgaXM6CgogIGdldFVSTDogcmV0dXJucyB0aGUgY3VycmVudCBV
        UkwKICBzZXRVUkwocGF0aCk6IHNldHMgdGhlIGN1cnJlbnQgVVJMCiAgcmVw
        bGFjZVVSTChwYXRoKTogcmVwbGFjZSB0aGUgY3VycmVudCBVUkwgKG9wdGlv
        bmFsKQogIG9uVXBkYXRlVVJMKGNhbGxiYWNrKTogdHJpZ2dlcnMgdGhlIGNh
        bGxiYWNrIHdoZW4gdGhlIFVSTCBjaGFuZ2VzCiAgZm9ybWF0VVJMKHVybCk6
        IGZvcm1hdHMgYHVybGAgdG8gYmUgcGxhY2VkIGludG8gYGhyZWZgIGF0dHJp
        YnV0ZQoKICBDYWxsaW5nIHNldFVSTCBvciByZXBsYWNlVVJMIHdpbGwgbm90
        IHRyaWdnZXIgb25VcGRhdGVVUkwgY2FsbGJhY2tzLgoKICBUT0RPOiBUaGlz
        IHNob3VsZCBwZXJoYXBzIGJlIG1vdmVkIHNvIHRoYXQgaXQncyB2aXNpYmxl
        IGluIHRoZSBkb2Mgb3V0cHV0LgoqLwoKLyoqCiAgRW1iZXIuTG9jYXRpb24g
        cmV0dXJucyBhbiBpbnN0YW5jZSBvZiB0aGUgY29ycmVjdCBpbXBsZW1lbnRh
        dGlvbiBvZgogIHRoZSBgbG9jYXRpb25gIEFQSS4KCiAgWW91IGNhbiBwYXNz
        IGl0IGEgYGltcGxlbWVudGF0aW9uYCAoJ2hhc2gnLCAnaGlzdG9yeScsICdu
        b25lJykgdG8gZm9yY2UgYQogIHBhcnRpY3VsYXIgaW1wbGVtZW50YXRpb24u
        CgogIEBjbGFzcyBMb2NhdGlvbgogIEBuYW1lc3BhY2UgRW1iZXIKICBAc3Rh
        dGljCiovCkVtYmVyLkxvY2F0aW9uID0gewogIC8qKgogICBDcmVhdGUgYW4g
        aW5zdGFuY2Ugb2YgYSBhbiBpbXBsZW1lbnRhdGlvbiBvZiB0aGUgYGxvY2F0
        aW9uYCBBUEkuIFJlcXVpcmVzCiAgIGFuIG9wdGlvbnMgb2JqZWN0IHdpdGgg
        YW4gYGltcGxlbWVudGF0aW9uYCBwcm9wZXJ0eS4KCiAgIEV4YW1wbGUKCiAg
        IGBgYGphdmFzY3JpcHQKICAgdmFyIGhhc2hMb2NhdGlvbiA9IEVtYmVyLkxv
        Y2F0aW9uLmNyZWF0ZSh7aW1wbGVtZW50YXRpb246ICdoYXNoJ30pOwogICB2
        YXIgaGlzdG9yeUxvY2F0aW9uID0gRW1iZXIuTG9jYXRpb24uY3JlYXRlKHtp
        bXBsZW1lbnRhdGlvbjogJ2hpc3RvcnknfSk7CiAgIHZhciBub25lTG9jYXRp
        b24gPSBFbWJlci5Mb2NhdGlvbi5jcmVhdGUoe2ltcGxlbWVudGF0aW9uOiAn
        bm9uZSd9KTsKICAgYGBgCgogICAgQG1ldGhvZCBjcmVhdGUKICAgIEBwYXJh
        bSB7T2JqZWN0fSBvcHRpb25zCiAgICBAcmV0dXJuIHtPYmplY3R9IGFuIGlu
        c3RhbmNlIG9mIGFuIGltcGxlbWVudGF0aW9uIG9mIHRoZSBgbG9jYXRpb25g
        IEFQSQogICovCiAgY3JlYXRlOiBmdW5jdGlvbihvcHRpb25zKSB7CiAgICB2
        YXIgaW1wbGVtZW50YXRpb24gPSBvcHRpb25zICYmIG9wdGlvbnMuaW1wbGVt
        ZW50YXRpb247CiAgICBFbWJlci5hc3NlcnQoIkVtYmVyLkxvY2F0aW9uLmNy
        ZWF0ZTogeW91IG11c3Qgc3BlY2lmeSBhICdpbXBsZW1lbnRhdGlvbicgb3B0
        aW9uIiwgISFpbXBsZW1lbnRhdGlvbik7CgogICAgdmFyIGltcGxlbWVudGF0
        aW9uQ2xhc3MgPSB0aGlzLmltcGxlbWVudGF0aW9uc1tpbXBsZW1lbnRhdGlv
        bl07CiAgICBFbWJlci5hc3NlcnQoIkVtYmVyLkxvY2F0aW9uLmNyZWF0ZTog
        IiArIGltcGxlbWVudGF0aW9uICsgIiBpcyBub3QgYSB2YWxpZCBpbXBsZW1l
        bnRhdGlvbiIsICEhaW1wbGVtZW50YXRpb25DbGFzcyk7CgogICAgcmV0dXJu
        IGltcGxlbWVudGF0aW9uQ2xhc3MuY3JlYXRlLmFwcGx5KGltcGxlbWVudGF0
        aW9uQ2xhc3MsIGFyZ3VtZW50cyk7CiAgfSwKCiAgLyoqCiAgIFJlZ2lzdGVy
        cyBhIGNsYXNzIHRoYXQgaW1wbGVtZW50cyB0aGUgYGxvY2F0aW9uYCBBUEkg
        d2l0aCBhbiBpbXBsZW1lbnRhdGlvbgogICBuYW1lLiBUaGlzIGltcGxlbWVu
        dGF0aW9uIG5hbWUgY2FuIHRoZW4gYmUgc3BlY2lmaWVkIGJ5IHRoZSBsb2Nh
        dGlvbiBwcm9wZXJ0eSBvbgogICB0aGUgYXBwbGljYXRpb24ncyByb3V0ZXIg
        Y2xhc3MuCgogICBFeGFtcGxlCgogICBgYGBqYXZhc2NyaXB0CiAgIEVtYmVy
        LkxvY2F0aW9uLnJlZ2lzdGVySW1wbGVtZW50YXRpb24oJ2hpc3RvcnknLCBF
        bWJlci5IaXN0b3J5TG9jYXRpb24pOwoKICAgQXBwLlJvdXRlci5yZW9wZW4o
        ewogICAgIGxvY2F0aW9uOiAnaGlzdG9yeScKICAgfSk7CiAgIGBgYAoKICAg
        IEBtZXRob2QgcmVnaXN0ZXJJbXBsZW1lbnRhdGlvbgogICAgQHBhcmFtIHtT
        dHJpbmd9IG5hbWUKICAgIEBwYXJhbSB7T2JqZWN0fSBpbXBsZW1lbnRhdGlv
        biBvZiB0aGUgYGxvY2F0aW9uYCBBUEkKICAqLwogIHJlZ2lzdGVySW1wbGVt
        ZW50YXRpb246IGZ1bmN0aW9uKG5hbWUsIGltcGxlbWVudGF0aW9uKSB7CiAg
        ICB0aGlzLmltcGxlbWVudGF0aW9uc1tuYW1lXSA9IGltcGxlbWVudGF0aW9u
        OwogIH0sCgogIGltcGxlbWVudGF0aW9uczoge30KfTsKCn0pKCk7CgoKCihm
        dW5jdGlvbigpIHsKLyoqCkBtb2R1bGUgZW1iZXIKQHN1Ym1vZHVsZSBlbWJl
        ci1yb3V0aW5nCiovCgp2YXIgZ2V0ID0gRW1iZXIuZ2V0LCBzZXQgPSBFbWJl
        ci5zZXQ7CgovKioKICBFbWJlci5Ob25lTG9jYXRpb24gZG9lcyBub3QgaW50
        ZXJhY3Qgd2l0aCB0aGUgYnJvd3Nlci4gSXQgaXMgdXNlZnVsIGZvcgogIHRl
        c3RpbmcsIG9yIHdoZW4geW91IG5lZWQgdG8gbWFuYWdlIHN0YXRlIHdpdGgg
        eW91ciBSb3V0ZXIsIGJ1dCB0ZW1wb3JhcmlseQogIGRvbid0IHdhbnQgaXQg
        dG8gbXVjayB3aXRoIHRoZSBVUkwgKGZvciBleGFtcGxlIHdoZW4geW91IGVt
        YmVkIHlvdXIKICBhcHBsaWNhdGlvbiBpbiBhIGxhcmdlciBwYWdlKS4KCiAg
        QGNsYXNzIE5vbmVMb2NhdGlvbgogIEBuYW1lc3BhY2UgRW1iZXIKICBAZXh0
        ZW5kcyBFbWJlci5PYmplY3QKKi8KRW1iZXIuTm9uZUxvY2F0aW9uID0gRW1i
        ZXIuT2JqZWN0LmV4dGVuZCh7CiAgcGF0aDogJycsCgogIC8qKgogICAgQHBy
        aXZhdGUKCiAgICBSZXR1cm5zIHRoZSBjdXJyZW50IHBhdGguCgogICAgQG1l
        dGhvZCBnZXRVUkwKICAgIEByZXR1cm4ge1N0cmluZ30gcGF0aAogICovCiAg
        Z2V0VVJMOiBmdW5jdGlvbigpIHsKICAgIHJldHVybiBnZXQodGhpcywgJ3Bh
        dGgnKTsKICB9LAoKICAvKioKICAgIEBwcml2YXRlCgogICAgU2V0IHRoZSBw
        YXRoIGFuZCByZW1lbWJlcnMgd2hhdCB3YXMgc2V0LiBVc2luZyB0aGlzIG1l
        dGhvZAogICAgdG8gY2hhbmdlIHRoZSBwYXRoIHdpbGwgbm90IGludm9rZSB0
        aGUgYHVwZGF0ZVVSTGAgY2FsbGJhY2suCgogICAgQG1ldGhvZCBzZXRVUkwK
        ICAgIEBwYXJhbSBwYXRoIHtTdHJpbmd9CiAgKi8KICBzZXRVUkw6IGZ1bmN0
        aW9uKHBhdGgpIHsKICAgIHNldCh0aGlzLCAncGF0aCcsIHBhdGgpOwogIH0s
        CgogIC8qKgogICAgQHByaXZhdGUKCiAgICBSZWdpc3RlciBhIGNhbGxiYWNr
        IHRvIGJlIGludm9rZWQgd2hlbiB0aGUgcGF0aCBjaGFuZ2VzLiBUaGVzZQog
        ICAgY2FsbGJhY2tzIHdpbGwgZXhlY3V0ZSB3aGVuIHRoZSB1c2VyIHByZXNz
        ZXMgdGhlIGJhY2sgb3IgZm9yd2FyZAogICAgYnV0dG9uLCBidXQgbm90IGFm
        dGVyIGBzZXRVUkxgIGlzIGludm9rZWQuCgogICAgQG1ldGhvZCBvblVwZGF0
        ZVVSTAogICAgQHBhcmFtIGNhbGxiYWNrIHtGdW5jdGlvbn0KICAqLwogIG9u
        VXBkYXRlVVJMOiBmdW5jdGlvbihjYWxsYmFjaykgewogICAgdGhpcy51cGRh
        dGVDYWxsYmFjayA9IGNhbGxiYWNrOwogIH0sCgogIC8qKgogICAgQHByaXZh
        dGUKCiAgICBTZXRzIHRoZSBwYXRoIGFuZCBjYWxscyB0aGUgYHVwZGF0ZVVS
        TGAgY2FsbGJhY2suCgogICAgQG1ldGhvZCBoYW5kbGVVUkwKICAgIEBwYXJh
        bSBjYWxsYmFjayB7RnVuY3Rpb259CiAgKi8KICBoYW5kbGVVUkw6IGZ1bmN0
        aW9uKHVybCkgewogICAgc2V0KHRoaXMsICdwYXRoJywgdXJsKTsKICAgIHRo
        aXMudXBkYXRlQ2FsbGJhY2sodXJsKTsKICB9LAoKICAvKioKICAgIEBwcml2
        YXRlCgogICAgR2l2ZW4gYSBVUkwsIGZvcm1hdHMgaXQgdG8gYmUgcGxhY2Vk
        IGludG8gdGhlIHBhZ2UgYXMgcGFydAogICAgb2YgYW4gZWxlbWVudCdzIGBo
        cmVmYCBhdHRyaWJ1dGUuCgogICAgVGhpcyBpcyB1c2VkLCBmb3IgZXhhbXBs
        ZSwgd2hlbiB1c2luZyB0aGUge3thY3Rpb259fSBoZWxwZXIKICAgIHRvIGdl
        bmVyYXRlIGEgVVJMIGJhc2VkIG9uIGFuIGV2ZW50LgoKICAgIEBtZXRob2Qg
        Zm9ybWF0VVJMCiAgICBAcGFyYW0gdXJsIHtTdHJpbmd9CiAgICBAcmV0dXJu
        IHtTdHJpbmd9IHVybAogICovCiAgZm9ybWF0VVJMOiBmdW5jdGlvbih1cmwp
        IHsKICAgIC8vIFRoZSByZXR1cm4gdmFsdWUgaXMgbm90IG92ZXJseSBtZWFu
        aW5nZnVsLCBidXQgd2UgZG8gbm90IHdhbnQgdG8gdGhyb3cKICAgIC8vIGVy
        cm9ycyB3aGVuIHRlc3QgY29kZSByZW5kZXJzIHRlbXBsYXRlcyBjb250YWlu
        aW5nIHt7YWN0aW9uIGhyZWY9dHJ1ZX19CiAgICAvLyBoZWxwZXJzLgogICAg
        cmV0dXJuIHVybDsKICB9Cn0pOwoKRW1iZXIuTG9jYXRpb24ucmVnaXN0ZXJJ
        bXBsZW1lbnRhdGlvbignbm9uZScsIEVtYmVyLk5vbmVMb2NhdGlvbik7Cgp9
        KSgpOwoKCgooZnVuY3Rpb24oKSB7Ci8qKgpAbW9kdWxlIGVtYmVyCkBzdWJt
        b2R1bGUgZW1iZXItcm91dGluZwoqLwoKdmFyIGdldCA9IEVtYmVyLmdldCwg
        c2V0ID0gRW1iZXIuc2V0OwoKLyoqCiAgRW1iZXIuSGFzaExvY2F0aW9uIGlt
        cGxlbWVudHMgdGhlIGxvY2F0aW9uIEFQSSB1c2luZyB0aGUgYnJvd3Nlcidz
        CiAgaGFzaC4gQXQgcHJlc2VudCwgaXQgcmVsaWVzIG9uIGEgaGFzaGNoYW5n
        ZSBldmVudCBleGlzdGluZyBpbiB0aGUKICBicm93c2VyLgoKICBAY2xhc3Mg
        SGFzaExvY2F0aW9uCiAgQG5hbWVzcGFjZSBFbWJlcgogIEBleHRlbmRzIEVt
        YmVyLk9iamVjdAoqLwpFbWJlci5IYXNoTG9jYXRpb24gPSBFbWJlci5PYmpl
        Y3QuZXh0ZW5kKHsKCiAgaW5pdDogZnVuY3Rpb24oKSB7CiAgICBzZXQodGhp
        cywgJ2xvY2F0aW9uJywgZ2V0KHRoaXMsICdsb2NhdGlvbicpIHx8IHdpbmRv
        dy5sb2NhdGlvbik7CiAgfSwKCiAgLyoqCiAgICBAcHJpdmF0ZQoKICAgIFJl
        dHVybnMgdGhlIGN1cnJlbnQgYGxvY2F0aW9uLmhhc2hgLCBtaW51cyB0aGUg
        JyMnIGF0IHRoZSBmcm9udC4KCiAgICBAbWV0aG9kIGdldFVSTAogICovCiAg
        Z2V0VVJMOiBmdW5jdGlvbigpIHsKICAgIHJldHVybiBnZXQodGhpcywgJ2xv
        Y2F0aW9uJykuaGFzaC5zdWJzdHIoMSk7CiAgfSwKCiAgLyoqCiAgICBAcHJp
        dmF0ZQoKICAgIFNldCB0aGUgYGxvY2F0aW9uLmhhc2hgIGFuZCByZW1lbWJl
        cnMgd2hhdCB3YXMgc2V0LiBUaGlzIHByZXZlbnRzCiAgICBgb25VcGRhdGVV
        UkxgIGNhbGxiYWNrcyBmcm9tIHRyaWdnZXJpbmcgd2hlbiB0aGUgaGFzaCB3
        YXMgc2V0IGJ5CiAgICBgSGFzaExvY2F0aW9uYC4KCiAgICBAbWV0aG9kIHNl
        dFVSTAogICAgQHBhcmFtIHBhdGgge1N0cmluZ30KICAqLwogIHNldFVSTDog
        ZnVuY3Rpb24ocGF0aCkgewogICAgZ2V0KHRoaXMsICdsb2NhdGlvbicpLmhh
        c2ggPSBwYXRoOwogICAgc2V0KHRoaXMsICdsYXN0U2V0VVJMJywgcGF0aCk7
        CiAgfSwKCiAgLyoqCiAgICBAcHJpdmF0ZQoKICAgIFVzZXMgbG9jYXRpb24u
        cmVwbGFjZSB0byB1cGRhdGUgdGhlIHVybCB3aXRob3V0IGEgcGFnZSByZWxv
        YWQKICAgIG9yIGhpc3RvcnkgbW9kaWZpY2F0aW9uLgoKICAgIEBtZXRob2Qg
        cmVwbGFjZVVSTAogICAgQHBhcmFtIHBhdGgge1N0cmluZ30KICAqLwogIHJl
        cGxhY2VVUkw6IGZ1bmN0aW9uKHBhdGgpIHsKICAgIGdldCh0aGlzLCAnbG9j
        YXRpb24nKS5yZXBsYWNlKCcjJyArIHBhdGgpOwogIH0sCgogIC8qKgogICAg
        QHByaXZhdGUKCiAgICBSZWdpc3RlciBhIGNhbGxiYWNrIHRvIGJlIGludm9r
        ZWQgd2hlbiB0aGUgaGFzaCBjaGFuZ2VzLiBUaGVzZQogICAgY2FsbGJhY2tz
        IHdpbGwgZXhlY3V0ZSB3aGVuIHRoZSB1c2VyIHByZXNzZXMgdGhlIGJhY2sg
        b3IgZm9yd2FyZAogICAgYnV0dG9uLCBidXQgbm90IGFmdGVyIGBzZXRVUkxg
        IGlzIGludm9rZWQuCgogICAgQG1ldGhvZCBvblVwZGF0ZVVSTAogICAgQHBh
        cmFtIGNhbGxiYWNrIHtGdW5jdGlvbn0KICAqLwogIG9uVXBkYXRlVVJMOiBm
        dW5jdGlvbihjYWxsYmFjaykgewogICAgdmFyIHNlbGYgPSB0aGlzOwogICAg
        dmFyIGd1aWQgPSBFbWJlci5ndWlkRm9yKHRoaXMpOwoKICAgIEVtYmVyLiQo
        d2luZG93KS5vbignaGFzaGNoYW5nZS5lbWJlci1sb2NhdGlvbi0nK2d1aWQs
        IGZ1bmN0aW9uKCkgewogICAgICBFbWJlci5ydW4oZnVuY3Rpb24oKSB7CiAg
        ICAgICAgdmFyIHBhdGggPSBsb2NhdGlvbi5oYXNoLnN1YnN0cigxKTsKICAg
        ICAgICBpZiAoZ2V0KHNlbGYsICdsYXN0U2V0VVJMJykgPT09IHBhdGgpIHsg
        cmV0dXJuOyB9CgogICAgICAgIHNldChzZWxmLCAnbGFzdFNldFVSTCcsIG51
        bGwpOwoKICAgICAgICBjYWxsYmFjayhwYXRoKTsKICAgICAgfSk7CiAgICB9
        KTsKICB9LAoKICAvKioKICAgIEBwcml2YXRlCgogICAgR2l2ZW4gYSBVUkws
        IGZvcm1hdHMgaXQgdG8gYmUgcGxhY2VkIGludG8gdGhlIHBhZ2UgYXMgcGFy
        dAogICAgb2YgYW4gZWxlbWVudCdzIGBocmVmYCBhdHRyaWJ1dGUuCgogICAg
        VGhpcyBpcyB1c2VkLCBmb3IgZXhhbXBsZSwgd2hlbiB1c2luZyB0aGUge3th
        Y3Rpb259fSBoZWxwZXIKICAgIHRvIGdlbmVyYXRlIGEgVVJMIGJhc2VkIG9u
        IGFuIGV2ZW50LgoKICAgIEBtZXRob2QgZm9ybWF0VVJMCiAgICBAcGFyYW0g
        dXJsIHtTdHJpbmd9CiAgKi8KICBmb3JtYXRVUkw6IGZ1bmN0aW9uKHVybCkg
        ewogICAgcmV0dXJuICcjJyt1cmw7CiAgfSwKCiAgLyoqCiAgICBAcHJpdmF0
        ZQoKICAgIENsZWFucyB1cCB0aGUgSGFzaExvY2F0aW9uIGV2ZW50IGxpc3Rl
        bmVyLgoKICAgIEBtZXRob2Qgd2lsbERlc3Ryb3kKICAqLwogIHdpbGxEZXN0
        cm95OiBmdW5jdGlvbigpIHsKICAgIHZhciBndWlkID0gRW1iZXIuZ3VpZEZv
        cih0aGlzKTsKCiAgICBFbWJlci4kKHdpbmRvdykub2ZmKCdoYXNoY2hhbmdl
        LmVtYmVyLWxvY2F0aW9uLScrZ3VpZCk7CiAgfQp9KTsKCkVtYmVyLkxvY2F0
        aW9uLnJlZ2lzdGVySW1wbGVtZW50YXRpb24oJ2hhc2gnLCBFbWJlci5IYXNo
        TG9jYXRpb24pOwoKfSkoKTsKCgoKKGZ1bmN0aW9uKCkgewovKioKQG1vZHVs
        ZSBlbWJlcgpAc3VibW9kdWxlIGVtYmVyLXJvdXRpbmcKKi8KCnZhciBnZXQg
        PSBFbWJlci5nZXQsIHNldCA9IEVtYmVyLnNldDsKdmFyIHBvcHN0YXRlRmly
        ZWQgPSBmYWxzZTsKdmFyIHN1cHBvcnRzSGlzdG9yeVN0YXRlID0gd2luZG93
        Lmhpc3RvcnkgJiYgJ3N0YXRlJyBpbiB3aW5kb3cuaGlzdG9yeTsKCi8qKgog
        IEVtYmVyLkhpc3RvcnlMb2NhdGlvbiBpbXBsZW1lbnRzIHRoZSBsb2NhdGlv
        biBBUEkgdXNpbmcgdGhlIGJyb3dzZXIncwogIGhpc3RvcnkucHVzaFN0YXRl
        IEFQSS4KCiAgQGNsYXNzIEhpc3RvcnlMb2NhdGlvbgogIEBuYW1lc3BhY2Ug
        RW1iZXIKICBAZXh0ZW5kcyBFbWJlci5PYmplY3QKKi8KRW1iZXIuSGlzdG9y
        eUxvY2F0aW9uID0gRW1iZXIuT2JqZWN0LmV4dGVuZCh7CgogIGluaXQ6IGZ1
        bmN0aW9uKCkgewogICAgc2V0KHRoaXMsICdsb2NhdGlvbicsIGdldCh0aGlz
        LCAnbG9jYXRpb24nKSB8fCB3aW5kb3cubG9jYXRpb24pOwogICAgdGhpcy5p
        bml0U3RhdGUoKTsKICB9LAoKICAvKioKICAgIEBwcml2YXRlCgogICAgVXNl
        ZCB0byBzZXQgc3RhdGUgb24gZmlyc3QgY2FsbCB0byBzZXRVUkwKCiAgICBA
        bWV0aG9kIGluaXRTdGF0ZQogICovCiAgaW5pdFN0YXRlOiBmdW5jdGlvbigp
        IHsKICAgIHNldCh0aGlzLCAnaGlzdG9yeScsIGdldCh0aGlzLCAnaGlzdG9y
        eScpIHx8IHdpbmRvdy5oaXN0b3J5KTsKICAgIHRoaXMucmVwbGFjZVN0YXRl
        KHRoaXMuZm9ybWF0VVJMKHRoaXMuZ2V0VVJMKCkpKTsKICB9LAoKICAvKioK
        ICAgIFdpbGwgYmUgcHJlLXBlbmRlZCB0byBwYXRoIHVwb24gc3RhdGUgY2hh
        bmdlCgogICAgQHByb3BlcnR5IHJvb3RVUkwKICAgIEBkZWZhdWx0ICcvJwog
        ICovCiAgcm9vdFVSTDogJy8nLAoKICAvKioKICAgIEBwcml2YXRlCgogICAg
        UmV0dXJucyB0aGUgY3VycmVudCBgbG9jYXRpb24ucGF0aG5hbWVgIHdpdGhv
        dXQgcm9vdFVSTAoKICAgIEBtZXRob2QgZ2V0VVJMCiAgICBAcmV0dXJuIHVy
        bCB7U3RyaW5nfQogICovCiAgZ2V0VVJMOiBmdW5jdGlvbigpIHsKICAgIHZh
        ciByb290VVJMID0gZ2V0KHRoaXMsICdyb290VVJMJyksCiAgICAgICAgdXJs
        ID0gZ2V0KHRoaXMsICdsb2NhdGlvbicpLnBhdGhuYW1lOwoKICAgIHJvb3RV
        UkwgPSByb290VVJMLnJlcGxhY2UoL1wvJC8sICcnKTsKICAgIHVybCA9IHVy
        bC5yZXBsYWNlKHJvb3RVUkwsICcnKTsKCiAgICByZXR1cm4gdXJsOwogIH0s
        CgogIC8qKgogICAgQHByaXZhdGUKCiAgICBVc2VzIGBoaXN0b3J5LnB1c2hT
        dGF0ZWAgdG8gdXBkYXRlIHRoZSB1cmwgd2l0aG91dCBhIHBhZ2UgcmVsb2Fk
        LgoKICAgIEBtZXRob2Qgc2V0VVJMCiAgICBAcGFyYW0gcGF0aCB7U3RyaW5n
        fQogICovCiAgc2V0VVJMOiBmdW5jdGlvbihwYXRoKSB7CiAgICB2YXIgc3Rh
        dGUgPSB0aGlzLmdldFN0YXRlKCk7CiAgICBwYXRoID0gdGhpcy5mb3JtYXRV
        UkwocGF0aCk7CgogICAgaWYgKHN0YXRlICYmIHN0YXRlLnBhdGggIT09IHBh
        dGgpIHsKICAgICAgdGhpcy5wdXNoU3RhdGUocGF0aCk7CiAgICB9CiAgfSwK
        CiAgLyoqCiAgICBAcHJpdmF0ZQoKICAgIFVzZXMgYGhpc3RvcnkucmVwbGFj
        ZVN0YXRlYCB0byB1cGRhdGUgdGhlIHVybCB3aXRob3V0IGEgcGFnZSByZWxv
        YWQKICAgIG9yIGhpc3RvcnkgbW9kaWZpY2F0aW9uLgoKICAgIEBtZXRob2Qg
        cmVwbGFjZVVSTAogICAgQHBhcmFtIHBhdGgge1N0cmluZ30KICAqLwogIHJl
        cGxhY2VVUkw6IGZ1bmN0aW9uKHBhdGgpIHsKICAgIHZhciBzdGF0ZSA9IHRo
        aXMuZ2V0U3RhdGUoKTsKICAgIHBhdGggPSB0aGlzLmZvcm1hdFVSTChwYXRo
        KTsKCiAgICBpZiAoc3RhdGUgJiYgc3RhdGUucGF0aCAhPT0gcGF0aCkgewog
        ICAgICB0aGlzLnJlcGxhY2VTdGF0ZShwYXRoKTsKICAgIH0KICB9LAoKICAv
        KioKICAgQHByaXZhdGUKCiAgIEdldCB0aGUgY3VycmVudCBgaGlzdG9yeS5z
        dGF0ZWAKICAgUG9seWZpbGwgY2hlY2tzIGZvciBuYXRpdmUgYnJvd3NlciBz
        dXBwb3J0IGFuZCBmYWxscyBiYWNrIHRvIHJldHJpZXZpbmcKICAgZnJvbSBh
        IHByaXZhdGUgX2hpc3RvcnlTdGF0ZSB2YXJpYWJsZQoKICAgQG1ldGhvZCBn
        ZXRTdGF0ZQogICBAcmV0dXJuIHN0YXRlIHtPYmplY3R9CiAgKi8KICBnZXRT
        dGF0ZTogZnVuY3Rpb24oKSB7CiAgICByZXR1cm4gc3VwcG9ydHNIaXN0b3J5
        U3RhdGUgPyBnZXQodGhpcywgJ2hpc3RvcnknKS5zdGF0ZSA6IHRoaXMuX2hp
        c3RvcnlTdGF0ZTsKICB9LAoKICAvKioKICAgQHByaXZhdGUKCiAgIFB1c2hl
        cyBhIG5ldyBzdGF0ZQoKICAgQG1ldGhvZCBwdXNoU3RhdGUKICAgQHBhcmFt
        IHBhdGgge1N0cmluZ30KICAqLwogIHB1c2hTdGF0ZTogZnVuY3Rpb24ocGF0
        aCkgewogICAgdmFyIHN0YXRlID0geyBwYXRoOiBwYXRoIH07CgogICAgZ2V0
        KHRoaXMsICdoaXN0b3J5JykucHVzaFN0YXRlKHN0YXRlLCBudWxsLCBwYXRo
        KTsKCiAgICAvLyBzdG9yZSBzdGF0ZSBpZiBicm93c2VyIGRvZXNuJ3Qgc3Vw
        cG9ydCBgaGlzdG9yeS5zdGF0ZWAKICAgIGlmICghc3VwcG9ydHNIaXN0b3J5
        U3RhdGUpIHsKICAgICAgdGhpcy5faGlzdG9yeVN0YXRlID0gc3RhdGU7CiAg
        ICB9CgogICAgLy8gdXNlZCBmb3Igd2Via2l0IHdvcmthcm91bmQKICAgIHRo
        aXMuX3ByZXZpb3VzVVJMID0gdGhpcy5nZXRVUkwoKTsKICB9LAoKICAvKioK
        ICAgQHByaXZhdGUKCiAgIFJlcGxhY2VzIHRoZSBjdXJyZW50IHN0YXRlCgog
        ICBAbWV0aG9kIHJlcGxhY2VTdGF0ZQogICBAcGFyYW0gcGF0aCB7U3RyaW5n
        fQogICovCiAgcmVwbGFjZVN0YXRlOiBmdW5jdGlvbihwYXRoKSB7CiAgICB2
        YXIgc3RhdGUgPSB7IHBhdGg6IHBhdGggfTsKCiAgICBnZXQodGhpcywgJ2hp
        c3RvcnknKS5yZXBsYWNlU3RhdGUoc3RhdGUsIG51bGwsIHBhdGgpOwoKICAg
        IC8vIHN0b3JlIHN0YXRlIGlmIGJyb3dzZXIgZG9lc24ndCBzdXBwb3J0IGBo
        aXN0b3J5LnN0YXRlYAogICAgaWYgKCFzdXBwb3J0c0hpc3RvcnlTdGF0ZSkg
        ewogICAgICB0aGlzLl9oaXN0b3J5U3RhdGUgPSBzdGF0ZTsKICAgIH0KCiAg
        ICAvLyB1c2VkIGZvciB3ZWJraXQgd29ya2Fyb3VuZAogICAgdGhpcy5fcHJl
        dmlvdXNVUkwgPSB0aGlzLmdldFVSTCgpOwogIH0sCgogIC8qKgogICAgQHBy
        aXZhdGUKCiAgICBSZWdpc3RlciBhIGNhbGxiYWNrIHRvIGJlIGludm9rZWQg
        d2hlbmV2ZXIgdGhlIGJyb3dzZXIKICAgIGhpc3RvcnkgY2hhbmdlcywgaW5j
        bHVkaW5nIHVzaW5nIGZvcndhcmQgYW5kIGJhY2sgYnV0dG9ucy4KCiAgICBA
        bWV0aG9kIG9uVXBkYXRlVVJMCiAgICBAcGFyYW0gY2FsbGJhY2sge0Z1bmN0
        aW9ufQogICovCiAgb25VcGRhdGVVUkw6IGZ1bmN0aW9uKGNhbGxiYWNrKSB7
        CiAgICB2YXIgZ3VpZCA9IEVtYmVyLmd1aWRGb3IodGhpcyksCiAgICAgICAg
        c2VsZiA9IHRoaXM7CgogICAgRW1iZXIuJCh3aW5kb3cpLm9uKCdwb3BzdGF0
        ZS5lbWJlci1sb2NhdGlvbi0nK2d1aWQsIGZ1bmN0aW9uKGUpIHsKICAgICAg
        Ly8gSWdub3JlIGluaXRpYWwgcGFnZSBsb2FkIHBvcHN0YXRlIGV2ZW50IGlu
        IENocm9tZQogICAgICBpZiAoIXBvcHN0YXRlRmlyZWQpIHsKICAgICAgICBw
        b3BzdGF0ZUZpcmVkID0gdHJ1ZTsKICAgICAgICBpZiAoc2VsZi5nZXRVUkwo
        KSA9PT0gc2VsZi5fcHJldmlvdXNVUkwpIHsgcmV0dXJuOyB9CiAgICAgIH0K
        ICAgICAgY2FsbGJhY2soc2VsZi5nZXRVUkwoKSk7CiAgICB9KTsKICB9LAoK
        ICAvKioKICAgIEBwcml2YXRlCgogICAgVXNlZCB3aGVuIHVzaW5nIGB7e2Fj
        dGlvbn19YCBoZWxwZXIuICBUaGUgdXJsIGlzIGFsd2F5cyBhcHBlbmRlZCB0
        byB0aGUgcm9vdFVSTC4KCiAgICBAbWV0aG9kIGZvcm1hdFVSTAogICAgQHBh
        cmFtIHVybCB7U3RyaW5nfQogICAgQHJldHVybiBmb3JtYXR0ZWQgdXJsIHtT
        dHJpbmd9CiAgKi8KICBmb3JtYXRVUkw6IGZ1bmN0aW9uKHVybCkgewogICAg
        dmFyIHJvb3RVUkwgPSBnZXQodGhpcywgJ3Jvb3RVUkwnKTsKCiAgICBpZiAo
        dXJsICE9PSAnJykgewogICAgICByb290VVJMID0gcm9vdFVSTC5yZXBsYWNl
        KC9cLyQvLCAnJyk7CiAgICB9CgogICAgcmV0dXJuIHJvb3RVUkwgKyB1cmw7
        CiAgfSwKCiAgLyoqCiAgICBAcHJpdmF0ZQoKICAgIENsZWFucyB1cCB0aGUg
        SGlzdG9yeUxvY2F0aW9uIGV2ZW50IGxpc3RlbmVyLgoKICAgIEBtZXRob2Qg
        d2lsbERlc3Ryb3kKICAqLwogIHdpbGxEZXN0cm95OiBmdW5jdGlvbigpIHsK
        ICAgIHZhciBndWlkID0gRW1iZXIuZ3VpZEZvcih0aGlzKTsKCiAgICBFbWJl
        ci4kKHdpbmRvdykub2ZmKCdwb3BzdGF0ZS5lbWJlci1sb2NhdGlvbi0nK2d1
        aWQpOwogIH0KfSk7CgpFbWJlci5Mb2NhdGlvbi5yZWdpc3RlckltcGxlbWVu
        dGF0aW9uKCdoaXN0b3J5JywgRW1iZXIuSGlzdG9yeUxvY2F0aW9uKTsKCn0p
        KCk7CgoKCihmdW5jdGlvbigpIHsKCn0pKCk7CgoKCihmdW5jdGlvbigpIHsK
        LyoqCkVtYmVyIFJvdXRpbmcKCkBtb2R1bGUgZW1iZXIKQHN1Ym1vZHVsZSBl
        bWJlci1yb3V0aW5nCkByZXF1aXJlcyBlbWJlci12aWV3cwoqLwoKfSkoKTsK
        CihmdW5jdGlvbigpIHsKZnVuY3Rpb24gdmlzaXQodmVydGV4LCBmbiwgdmlz
        aXRlZCwgcGF0aCkgewogIHZhciBuYW1lID0gdmVydGV4Lm5hbWUsCiAgICB2
        ZXJ0aWNlcyA9IHZlcnRleC5pbmNvbWluZywKICAgIG5hbWVzID0gdmVydGV4
        LmluY29taW5nTmFtZXMsCiAgICBsZW4gPSBuYW1lcy5sZW5ndGgsCiAgICBp
        OwogIGlmICghdmlzaXRlZCkgewogICAgdmlzaXRlZCA9IHt9OwogIH0KICBp
        ZiAoIXBhdGgpIHsKICAgIHBhdGggPSBbXTsKICB9CiAgaWYgKHZpc2l0ZWQu
        aGFzT3duUHJvcGVydHkobmFtZSkpIHsKICAgIHJldHVybjsKICB9CiAgcGF0
        aC5wdXNoKG5hbWUpOwogIHZpc2l0ZWRbbmFtZV0gPSB0cnVlOwogIGZvciAo
        aSA9IDA7IGkgPCBsZW47IGkrKykgewogICAgdmlzaXQodmVydGljZXNbbmFt
        ZXNbaV1dLCBmbiwgdmlzaXRlZCwgcGF0aCk7CiAgfQogIGZuKHZlcnRleCwg
        cGF0aCk7CiAgcGF0aC5wb3AoKTsKfQoKZnVuY3Rpb24gREFHKCkgewogIHRo
        aXMubmFtZXMgPSBbXTsKICB0aGlzLnZlcnRpY2VzID0ge307Cn0KCkRBRy5w
        cm90b3R5cGUuYWRkID0gZnVuY3Rpb24obmFtZSkgewogIGlmICghbmFtZSkg
        eyByZXR1cm47IH0KICBpZiAodGhpcy52ZXJ0aWNlcy5oYXNPd25Qcm9wZXJ0
        eShuYW1lKSkgewogICAgcmV0dXJuIHRoaXMudmVydGljZXNbbmFtZV07CiAg
        fQogIHZhciB2ZXJ0ZXggPSB7CiAgICBuYW1lOiBuYW1lLCBpbmNvbWluZzog
        e30sIGluY29taW5nTmFtZXM6IFtdLCBoYXNPdXRnb2luZzogZmFsc2UsIHZh
        bHVlOiBudWxsCiAgfTsKICB0aGlzLnZlcnRpY2VzW25hbWVdID0gdmVydGV4
        OwogIHRoaXMubmFtZXMucHVzaChuYW1lKTsKICByZXR1cm4gdmVydGV4Owp9
        OwoKREFHLnByb3RvdHlwZS5tYXAgPSBmdW5jdGlvbihuYW1lLCB2YWx1ZSkg
        ewogIHRoaXMuYWRkKG5hbWUpLnZhbHVlID0gdmFsdWU7Cn07CgpEQUcucHJv
        dG90eXBlLmFkZEVkZ2UgPSBmdW5jdGlvbihmcm9tTmFtZSwgdG9OYW1lKSB7
        CiAgaWYgKCFmcm9tTmFtZSB8fCAhdG9OYW1lIHx8IGZyb21OYW1lID09PSB0
        b05hbWUpIHsKICAgIHJldHVybjsKICB9CiAgdmFyIGZyb20gPSB0aGlzLmFk
        ZChmcm9tTmFtZSksIHRvID0gdGhpcy5hZGQodG9OYW1lKTsKICBpZiAodG8u
        aW5jb21pbmcuaGFzT3duUHJvcGVydHkoZnJvbU5hbWUpKSB7CiAgICByZXR1
        cm47CiAgfQogIGZ1bmN0aW9uIGNoZWNrQ3ljbGUodmVydGV4LCBwYXRoKSB7
        CiAgICBpZiAodmVydGV4Lm5hbWUgPT09IHRvTmFtZSkgewogICAgICB0aHJv
        dyBuZXcgRW1iZXIuRXJyb3IoImN5Y2xlIGRldGVjdGVkOiAiICsgdG9OYW1l
        ICsgIiA8LSAiICsgcGF0aC5qb2luKCIgPC0gIikpOwogICAgfQogIH0KICB2
        aXNpdChmcm9tLCBjaGVja0N5Y2xlKTsKICBmcm9tLmhhc091dGdvaW5nID0g
        dHJ1ZTsKICB0by5pbmNvbWluZ1tmcm9tTmFtZV0gPSBmcm9tOwogIHRvLmlu
        Y29taW5nTmFtZXMucHVzaChmcm9tTmFtZSk7Cn07CgpEQUcucHJvdG90eXBl
        LnRvcHNvcnQgPSBmdW5jdGlvbihmbikgewogIHZhciB2aXNpdGVkID0ge30s
        CiAgICB2ZXJ0aWNlcyA9IHRoaXMudmVydGljZXMsCiAgICBuYW1lcyA9IHRo
        aXMubmFtZXMsCiAgICBsZW4gPSBuYW1lcy5sZW5ndGgsCiAgICBpLCB2ZXJ0
        ZXg7CiAgZm9yIChpID0gMDsgaSA8IGxlbjsgaSsrKSB7CiAgICB2ZXJ0ZXgg
        PSB2ZXJ0aWNlc1tuYW1lc1tpXV07CiAgICBpZiAoIXZlcnRleC5oYXNPdXRn
        b2luZykgewogICAgICB2aXNpdCh2ZXJ0ZXgsIGZuLCB2aXNpdGVkKTsKICAg
        IH0KICB9Cn07CgpEQUcucHJvdG90eXBlLmFkZEVkZ2VzID0gZnVuY3Rpb24o
        bmFtZSwgdmFsdWUsIGJlZm9yZSwgYWZ0ZXIpIHsKICB2YXIgaTsKICB0aGlz
        Lm1hcChuYW1lLCB2YWx1ZSk7CiAgaWYgKGJlZm9yZSkgewogICAgaWYgKHR5
        cGVvZiBiZWZvcmUgPT09ICdzdHJpbmcnKSB7CiAgICAgIHRoaXMuYWRkRWRn
        ZShuYW1lLCBiZWZvcmUpOwogICAgfSBlbHNlIHsKICAgICAgZm9yIChpID0g
        MDsgaSA8IGJlZm9yZS5sZW5ndGg7IGkrKykgewogICAgICAgIHRoaXMuYWRk
        RWRnZShuYW1lLCBiZWZvcmVbaV0pOwogICAgICB9CiAgICB9CiAgfQogIGlm
        IChhZnRlcikgewogICAgaWYgKHR5cGVvZiBhZnRlciA9PT0gJ3N0cmluZycp
        IHsKICAgICAgdGhpcy5hZGRFZGdlKGFmdGVyLCBuYW1lKTsKICAgIH0gZWxz
        ZSB7CiAgICAgIGZvciAoaSA9IDA7IGkgPCBhZnRlci5sZW5ndGg7IGkrKykg
        ewogICAgICAgIHRoaXMuYWRkRWRnZShhZnRlcltpXSwgbmFtZSk7CiAgICAg
        IH0KICAgIH0KICB9Cn07CgpFbWJlci5EQUcgPSBEQUc7Cgp9KSgpOwoKCgoo
        ZnVuY3Rpb24oKSB7Ci8qKgpAbW9kdWxlIGVtYmVyCkBzdWJtb2R1bGUgZW1i
        ZXItYXBwbGljYXRpb24KKi8KCnZhciBnZXQgPSBFbWJlci5nZXQsCiAgICBj
        bGFzc2lmeSA9IEVtYmVyLlN0cmluZy5jbGFzc2lmeSwKICAgIGNhcGl0YWxp
        emUgPSBFbWJlci5TdHJpbmcuY2FwaXRhbGl6ZSwKICAgIGRlY2FtZWxpemUg
        PSBFbWJlci5TdHJpbmcuZGVjYW1lbGl6ZTsKCi8qKgogIFRoZSBEZWZhdWx0
        UmVzb2x2ZXIgZGVmaW5lcyB0aGUgZGVmYXVsdCBsb29rdXAgcnVsZXMgdG8g
        cmVzb2x2ZQogIGNvbnRhaW5lciBsb29rdXBzIGJlZm9yZSBjb25zdWx0aW5n
        IHRoZSBjb250YWluZXIgZm9yIHJlZ2lzdGVyZWQKICBpdGVtczoKCiogdGVt
        cGxhdGVzIGFyZSBsb29rZWQgdXAgb24gYEVtYmVyLlRFTVBMQVRFU2AKKiBv
        dGhlciBuYW1lcyBhcmUgbG9va2VkIHVwIG9uIHRoZSBhcHBsaWNhdGlvbiBh
        ZnRlciBjb252ZXJ0aW5nCiAgdGhlIG5hbWUuIEZvciBleGFtcGxlLCBgY29u
        dHJvbGxlcjpwb3N0YCBsb29rcyB1cAogIGBBcHAuUG9zdENvbnRyb2xsZXJg
        IGJ5IGRlZmF1bHQuCiogdGhlcmUgYXJlIHNvbWUgbnVhbmNlcyAoc2VlIGV4
        YW1wbGVzIGJlbG93KQoKICAjIyMgSG93IFJlc29sdmluZyBXb3JrcwoKICBU
        aGUgY29udGFpbmVyIGNhbGxzIHRoaXMgb2JqZWN0J3MgYHJlc29sdmVgIG1l
        dGhvZCB3aXRoIHRoZQogIGBmdWxsTmFtZWAgYXJndW1lbnQuCgogIEl0IGZp
        cnN0IHBhcnNlcyB0aGUgZnVsbE5hbWUgaW50byBhbiBvYmplY3QgdXNpbmcg
        YHBhcnNlTmFtZWAuCgogIFRoZW4gaXQgY2hlY2tzIGZvciB0aGUgcHJlc2Vu
        Y2Ugb2YgYSB0eXBlLXNwZWNpZmljIGluc3RhbmNlCiAgbWV0aG9kIG9mIHRo
        ZSBmb3JtIGByZXNvbHZlW1R5cGVdYCBhbmQgY2FsbHMgaXQgaWYgaXQgZXhp
        c3RzLgogIEZvciBleGFtcGxlIGlmIGl0IHdhcyByZXNvbHZpbmcgJ3RlbXBs
        YXRlOnBvc3QnLCBpdCB3b3VsZCBjYWxsCiAgdGhlIGByZXNvbHZlVGVtcGxh
        dGVgIG1ldGhvZC4KCiAgSXRzIGxhc3QgcmVzb3J0IGlzIHRvIGNhbGwgdGhl
        IGByZXNvbHZlT3RoZXJgIG1ldGhvZC4KCiAgVGhlIG1ldGhvZHMgb2YgdGhp
        cyBvYmplY3QgYXJlIGRlc2lnbmVkIHRvIGJlIGVhc3kgdG8gb3ZlcnJpZGUK
        ICBpbiBhIHN1YmNsYXNzLiBGb3IgZXhhbXBsZSwgeW91IGNvdWxkIGVuaGFu
        Y2UgaG93IGEgdGVtcGxhdGUKICBpcyByZXNvbHZlZCBsaWtlIHNvOgoKICBg
        YGBqYXZhc2NyaXB0CiAgQXBwID0gRW1iZXIuQXBwbGljYXRpb24uY3JlYXRl
        KHsKICAgIFJlc29sdmVyOiBFbWJlci5EZWZhdWx0UmVzb2x2ZXIuZXh0ZW5k
        KHsKICAgICAgcmVzb2x2ZVRlbXBsYXRlOiBmdW5jdGlvbihwYXJzZWROYW1l
        KSB7CiAgICAgICAgdmFyIHJlc29sdmVkVGVtcGxhdGUgPSB0aGlzLl9zdXBl
        cihwYXJzZWROYW1lKTsKICAgICAgICBpZiAocmVzb2x2ZWRUZW1wbGF0ZSkg
        eyByZXR1cm4gcmVzb2x2ZWRUZW1wbGF0ZTsgfQogICAgICAgIHJldHVybiBF
        bWJlci5URU1QTEFURVNbJ25vdF9mb3VuZCddOwogICAgICB9CiAgICB9KQog
        IH0pOwogIGBgYAoKICBTb21lIGV4YW1wbGVzIG9mIGhvdyBuYW1lcyBhcmUg
        cmVzb2x2ZWQ6CgogIGBgYAogICd0ZW1wbGF0ZTpwb3N0JyAvLz0+IEVtYmVy
        LlRFTVBMQVRFU1sncG9zdCddCiAgJ3RlbXBsYXRlOnBvc3RzL2J5bGluZScg
        Ly89PiBFbWJlci5URU1QTEFURVNbJ3Bvc3RzL2J5bGluZSddCiAgJ3RlbXBs
        YXRlOnBvc3RzLmJ5bGluZScgLy89PiBFbWJlci5URU1QTEFURVNbJ3Bvc3Rz
        L2J5bGluZSddCiAgJ3RlbXBsYXRlOmJsb2dQb3N0JyAvLz0+IEVtYmVyLlRF
        TVBMQVRFU1snYmxvZ1Bvc3QnXQogICAgICAgICAgICAgICAgICAgICAgLy8g
        ICBPUgogICAgICAgICAgICAgICAgICAgICAgLy8gICBFbWJlci5URU1QTEFU
        RVNbJ2Jsb2dfcG9zdCddCiAgJ2NvbnRyb2xsZXI6cG9zdCcgLy89PiBBcHAu
        UG9zdENvbnRyb2xsZXIKICAnY29udHJvbGxlcjpwb3N0cy5pbmRleCcgLy89
        PiBBcHAuUG9zdHNJbmRleENvbnRyb2xsZXIKICAnY29udHJvbGxlcjpibG9n
        L3Bvc3QnIC8vPT4gQmxvZy5Qb3N0Q29udHJvbGxlcgogICdjb250cm9sbGVy
        OmJhc2ljJyAvLz0+IEVtYmVyLkNvbnRyb2xsZXIKICAncm91dGU6cG9zdCcg
        Ly89PiBBcHAuUG9zdFJvdXRlCiAgJ3JvdXRlOnBvc3RzLmluZGV4JyAvLz0+
        IEFwcC5Qb3N0c0luZGV4Um91dGUKICAncm91dGU6YmxvZy9wb3N0JyAvLz0+
        IEJsb2cuUG9zdFJvdXRlCiAgJ3JvdXRlOmJhc2ljJyAvLz0+IEVtYmVyLlJv
        dXRlCiAgJ3ZpZXc6cG9zdCcgLy89PiBBcHAuUG9zdFZpZXcKICAndmlldzpw
        b3N0cy5pbmRleCcgLy89PiBBcHAuUG9zdHNJbmRleFZpZXcKICAndmlldzpi
        bG9nL3Bvc3QnIC8vPT4gQmxvZy5Qb3N0VmlldwogICd2aWV3OmJhc2ljJyAv
        Lz0+IEVtYmVyLlZpZXcKICAnZm9vOnBvc3QnIC8vPT4gQXBwLlBvc3RGb28K
        ICAnbW9kZWw6cG9zdCcgLy89PiBBcHAuUG9zdAogIGBgYAoKICBAY2xhc3Mg
        RGVmYXVsdFJlc29sdmVyCiAgQG5hbWVzcGFjZSBFbWJlcgogIEBleHRlbmRz
        IEVtYmVyLk9iamVjdAoqLwpFbWJlci5EZWZhdWx0UmVzb2x2ZXIgPSBFbWJl
        ci5PYmplY3QuZXh0ZW5kKHsKICAvKioKICAgIFRoaXMgd2lsbCBiZSBzZXQg
        dG8gdGhlIEFwcGxpY2F0aW9uIGluc3RhbmNlIHdoZW4gaXQgaXMKICAgIGNy
        ZWF0ZWQuCgogICAgQHByb3BlcnR5IG5hbWVzcGFjZQogICovCiAgbmFtZXNw
        YWNlOiBudWxsLAoKICBub3JtYWxpemU6IGZ1bmN0aW9uKGZ1bGxOYW1lKSB7
        CiAgICB2YXIgc3BsaXQgPSBmdWxsTmFtZS5zcGxpdCgnOicsIDIpLAogICAg
        ICAgIHR5cGUgPSBzcGxpdFswXSwKICAgICAgICBuYW1lID0gc3BsaXRbMV07
        CgogICAgRW1iZXIuYXNzZXJ0KCJUcmllZCB0byBub3JtYWxpemUgYSBjb250
        YWluZXIgbmFtZSB3aXRob3V0IGEgY29sb24gKDopIGluIGl0LiBZb3UgcHJv
        YmFibHkgdHJpZWQgdG8gbG9va3VwIGEgbmFtZSB0aGF0IGRpZCBub3QgY29u
        dGFpbiBhIHR5cGUsIGEgY29sb24sIGFuZCBhIG5hbWUuIEEgcHJvcGVyIGxv
        b2t1cCBuYW1lIHdvdWxkIGJlIGB2aWV3OnBvc3RgLiIsIHNwbGl0Lmxlbmd0
        aCA9PT0gMik7CgogICAgaWYgKHR5cGUgIT09ICd0ZW1wbGF0ZScpIHsKICAg
        ICAgdmFyIHJlc3VsdCA9IG5hbWU7CgogICAgICBpZiAocmVzdWx0LmluZGV4
        T2YoJy4nKSA+IC0xKSB7CiAgICAgICAgcmVzdWx0ID0gcmVzdWx0LnJlcGxh
        Y2UoL1wuKC4pL2csIGZ1bmN0aW9uKG0pIHsgcmV0dXJuIG0uY2hhckF0KDEp
        LnRvVXBwZXJDYXNlKCk7IH0pOwogICAgICB9CgogICAgICBpZiAobmFtZS5p
        bmRleE9mKCdfJykgPiAtMSkgewogICAgICAgIHJlc3VsdCA9IHJlc3VsdC5y
        ZXBsYWNlKC9fKC4pL2csIGZ1bmN0aW9uKG0pIHsgcmV0dXJuIG0uY2hhckF0
        KDEpLnRvVXBwZXJDYXNlKCk7IH0pOwogICAgICB9CgogICAgICByZXR1cm4g
        dHlwZSArICc6JyArIHJlc3VsdDsKICAgIH0gZWxzZSB7CiAgICAgIHJldHVy
        biBmdWxsTmFtZTsKICAgIH0KICB9LAoKCiAgLyoqCiAgICBUaGlzIG1ldGhv
        ZCBpcyBjYWxsZWQgdmlhIHRoZSBjb250YWluZXIncyByZXNvbHZlciBtZXRo
        b2QuCiAgICBJdCBwYXJzZXMgdGhlIHByb3ZpZGVkIGBmdWxsTmFtZWAgYW5k
        IHRoZW4gbG9va3MgdXAgYW5kCiAgICByZXR1cm5zIHRoZSBhcHByb3ByaWF0
        ZSB0ZW1wbGF0ZSBvciBjbGFzcy4KCiAgICBAbWV0aG9kIHJlc29sdmUKICAg
        IEBwYXJhbSB7U3RyaW5nfSBmdWxsTmFtZSB0aGUgbG9va3VwIHN0cmluZwog
        ICAgQHJldHVybiB7T2JqZWN0fSB0aGUgcmVzb2x2ZWQgZmFjdG9yeQogICov
        CiAgcmVzb2x2ZTogZnVuY3Rpb24oZnVsbE5hbWUpIHsKICAgIHZhciBwYXJz
        ZWROYW1lID0gdGhpcy5wYXJzZU5hbWUoZnVsbE5hbWUpLAogICAgICAgIHR5
        cGVTcGVjaWZpY1Jlc29sdmVNZXRob2QgPSB0aGlzW3BhcnNlZE5hbWUucmVz
        b2x2ZU1ldGhvZE5hbWVdOwoKICAgIGlmICghcGFyc2VkTmFtZS5uYW1lIHx8
        ICFwYXJzZWROYW1lLnR5cGUpIHsKICAgICAgdGhyb3cgbmV3IFR5cGVFcnJv
        cigiSW52YWxpZCBmdWxsTmFtZTogYCIgKyBmdWxsTmFtZSArICJgLCBtdXN0
        IG9mIG9mIHRoZSBmb3JtIGB0eXBlOm5hbWVgICIpOwogICAgfQoKICAgIGlm
        ICh0eXBlU3BlY2lmaWNSZXNvbHZlTWV0aG9kKSB7CiAgICAgIHZhciByZXNv
        bHZlZCA9IHR5cGVTcGVjaWZpY1Jlc29sdmVNZXRob2QuY2FsbCh0aGlzLCBw
        YXJzZWROYW1lKTsKICAgICAgaWYgKHJlc29sdmVkKSB7IHJldHVybiByZXNv
        bHZlZDsgfQogICAgfQogICAgcmV0dXJuIHRoaXMucmVzb2x2ZU90aGVyKHBh
        cnNlZE5hbWUpOwogIH0sCiAgLyoqCiAgICBDb252ZXJ0IHRoZSBzdHJpbmcg
        bmFtZSBvZiB0aGUgZm9ybSAidHlwZTpuYW1lIiB0bwogICAgYSBKYXZhc2Ny
        aXB0IG9iamVjdCB3aXRoIHRoZSBwYXJzZWQgYXNwZWN0cyBvZiB0aGUgbmFt
        ZQogICAgYnJva2VuIG91dC4KCiAgICBAcHJvdGVjdGVkCiAgICBAcGFyYW0g
        e1N0cmluZ30gZnVsbE5hbWUgdGhlIGxvb2t1cCBzdHJpbmcKICAgIEBtZXRo
        b2QgcGFyc2VOYW1lCiAgKi8KICBwYXJzZU5hbWU6IGZ1bmN0aW9uKGZ1bGxO
        YW1lKSB7CiAgICB2YXIgbmFtZVBhcnRzID0gZnVsbE5hbWUuc3BsaXQoIjoi
        KSwKICAgICAgICB0eXBlID0gbmFtZVBhcnRzWzBdLCBmdWxsTmFtZVdpdGhv
        dXRUeXBlID0gbmFtZVBhcnRzWzFdLAogICAgICAgIG5hbWUgPSBmdWxsTmFt
        ZVdpdGhvdXRUeXBlLAogICAgICAgIG5hbWVzcGFjZSA9IGdldCh0aGlzLCAn
        bmFtZXNwYWNlJyksCiAgICAgICAgcm9vdCA9IG5hbWVzcGFjZTsKCiAgICBp
        ZiAodHlwZSAhPT0gJ3RlbXBsYXRlJyAmJiBuYW1lLmluZGV4T2YoJy8nKSAh
        PT0gLTEpIHsKICAgICAgdmFyIHBhcnRzID0gbmFtZS5zcGxpdCgnLycpOwog
        ICAgICBuYW1lID0gcGFydHNbcGFydHMubGVuZ3RoIC0gMV07CiAgICAgIHZh
        ciBuYW1lc3BhY2VOYW1lID0gY2FwaXRhbGl6ZShwYXJ0cy5zbGljZSgwLCAt
        MSkuam9pbignLicpKTsKICAgICAgcm9vdCA9IEVtYmVyLk5hbWVzcGFjZS5i
        eU5hbWUobmFtZXNwYWNlTmFtZSk7CgogICAgICBFbWJlci5hc3NlcnQoJ1lv
        dSBhcmUgbG9va2luZyBmb3IgYSAnICsgbmFtZSArICcgJyArIHR5cGUgKyAn
        IGluIHRoZSAnICsgbmFtZXNwYWNlTmFtZSArICcgbmFtZXNwYWNlLCBidXQg
        dGhlIG5hbWVzcGFjZSBjb3VsZCBub3QgYmUgZm91bmQnLCByb290KTsKICAg
        IH0KCiAgICByZXR1cm4gewogICAgICBmdWxsTmFtZTogZnVsbE5hbWUsCiAg
        ICAgIHR5cGU6IHR5cGUsCiAgICAgIGZ1bGxOYW1lV2l0aG91dFR5cGU6IGZ1
        bGxOYW1lV2l0aG91dFR5cGUsCiAgICAgIG5hbWU6IG5hbWUsCiAgICAgIHJv
        b3Q6IHJvb3QsCiAgICAgIHJlc29sdmVNZXRob2ROYW1lOiAicmVzb2x2ZSIg
        KyBjbGFzc2lmeSh0eXBlKQogICAgfTsKICB9LAogIC8qKgogICAgTG9vayB1
        cCB0aGUgdGVtcGxhdGUgaW4gRW1iZXIuVEVNUExBVEVTCgogICAgQHByb3Rl
        Y3RlZAogICAgQHBhcmFtIHtPYmplY3R9IHBhcnNlZE5hbWUgYSBwYXJzZU5h
        bWUgb2JqZWN0IHdpdGggdGhlIHBhcnNlZAogICAgICBmdWxsTmFtZSBsb29r
        dXAgc3RyaW5nCiAgICBAbWV0aG9kIHJlc29sdmVUZW1wbGF0ZQogICovCiAg
        cmVzb2x2ZVRlbXBsYXRlOiBmdW5jdGlvbihwYXJzZWROYW1lKSB7CiAgICB2
        YXIgdGVtcGxhdGVOYW1lID0gcGFyc2VkTmFtZS5mdWxsTmFtZVdpdGhvdXRU
        eXBlLnJlcGxhY2UoL1wuL2csICcvJyk7CgogICAgaWYgKEVtYmVyLlRFTVBM
        QVRFU1t0ZW1wbGF0ZU5hbWVdKSB7CiAgICAgIHJldHVybiBFbWJlci5URU1Q
        TEFURVNbdGVtcGxhdGVOYW1lXTsKICAgIH0KCiAgICB0ZW1wbGF0ZU5hbWUg
        PSBkZWNhbWVsaXplKHRlbXBsYXRlTmFtZSk7CiAgICBpZiAoRW1iZXIuVEVN
        UExBVEVTW3RlbXBsYXRlTmFtZV0pIHsKICAgICAgcmV0dXJuIEVtYmVyLlRF
        TVBMQVRFU1t0ZW1wbGF0ZU5hbWVdOwogICAgfQogIH0sCiAgLyoqCiAgICBH
        aXZlbiBhIHBhcnNlTmFtZSBvYmplY3QgKG91dHB1dCBmcm9tIGBwYXJzZU5h
        bWVgKSwgYXBwbHkKICAgIHRoZSBjb252ZW50aW9ucyBleHBlY3RlZCBieSBg
        RW1iZXIuUm91dGVyYAoKICAgIEBwcm90ZWN0ZWQKICAgIEBwYXJhbSB7T2Jq
        ZWN0fSBwYXJzZWROYW1lIGEgcGFyc2VOYW1lIG9iamVjdCB3aXRoIHRoZSBw
        YXJzZWQKICAgICAgZnVsbE5hbWUgbG9va3VwIHN0cmluZwogICAgQG1ldGhv
        ZCB1c2VSb3V0ZXJOYW1pbmcKICAqLwogIHVzZVJvdXRlck5hbWluZzogZnVu
        Y3Rpb24ocGFyc2VkTmFtZSkgewogICAgcGFyc2VkTmFtZS5uYW1lID0gcGFy
        c2VkTmFtZS5uYW1lLnJlcGxhY2UoL1wuL2csICdfJyk7CiAgICBpZiAocGFy
        c2VkTmFtZS5uYW1lID09PSAnYmFzaWMnKSB7CiAgICAgIHBhcnNlZE5hbWUu
        bmFtZSA9ICcnOwogICAgfQogIH0sCiAgLyoqCiAgICBMb29rdXAgdGhlIGNv
        bnRyb2xsZXIgdXNpbmcgYHJlc29sdmVPdGhlcmAKCiAgICBAcHJvdGVjdGVk
        CiAgICBAcGFyYW0ge09iamVjdH0gcGFyc2VkTmFtZSBhIHBhcnNlTmFtZSBv
        YmplY3Qgd2l0aCB0aGUgcGFyc2VkCiAgICAgIGZ1bGxOYW1lIGxvb2t1cCBz
        dHJpbmcKICAgIEBtZXRob2QgcmVzb2x2ZUNvbnRyb2xsZXIKICAqLwogIHJl
        c29sdmVDb250cm9sbGVyOiBmdW5jdGlvbihwYXJzZWROYW1lKSB7CiAgICB0
        aGlzLnVzZVJvdXRlck5hbWluZyhwYXJzZWROYW1lKTsKICAgIHJldHVybiB0
        aGlzLnJlc29sdmVPdGhlcihwYXJzZWROYW1lKTsKICB9LAogIC8qKgogICAg
        TG9va3VwIHRoZSByb3V0ZSB1c2luZyBgcmVzb2x2ZU90aGVyYAoKICAgIEBw
        cm90ZWN0ZWQKICAgIEBwYXJhbSB7T2JqZWN0fSBwYXJzZWROYW1lIGEgcGFy
        c2VOYW1lIG9iamVjdCB3aXRoIHRoZSBwYXJzZWQKICAgICAgZnVsbE5hbWUg
        bG9va3VwIHN0cmluZwogICAgQG1ldGhvZCByZXNvbHZlUm91dGUKICAqLwog
        IHJlc29sdmVSb3V0ZTogZnVuY3Rpb24ocGFyc2VkTmFtZSkgewogICAgdGhp
        cy51c2VSb3V0ZXJOYW1pbmcocGFyc2VkTmFtZSk7CiAgICByZXR1cm4gdGhp
        cy5yZXNvbHZlT3RoZXIocGFyc2VkTmFtZSk7CiAgfSwKICAvKioKICAgIExv
        b2t1cCB0aGUgdmlldyB1c2luZyBgcmVzb2x2ZU90aGVyYAoKICAgIEBwcm90
        ZWN0ZWQKICAgIEBwYXJhbSB7T2JqZWN0fSBwYXJzZWROYW1lIGEgcGFyc2VO
        YW1lIG9iamVjdCB3aXRoIHRoZSBwYXJzZWQKICAgICAgZnVsbE5hbWUgbG9v
        a3VwIHN0cmluZwogICAgQG1ldGhvZCByZXNvbHZlVmlldwogICovCiAgcmVz
        b2x2ZVZpZXc6IGZ1bmN0aW9uKHBhcnNlZE5hbWUpIHsKICAgIHRoaXMudXNl
        Um91dGVyTmFtaW5nKHBhcnNlZE5hbWUpOwogICAgcmV0dXJuIHRoaXMucmVz
        b2x2ZU90aGVyKHBhcnNlZE5hbWUpOwogIH0sCgogIC8qKgogICAgTG9va3Vw
        IHRoZSBtb2RlbCBvbiB0aGUgQXBwbGljYXRpb24gbmFtZXNwYWNlCgogICAg
        QHByb3RlY3RlZAogICAgQHBhcmFtIHtPYmplY3R9IHBhcnNlZE5hbWUgYSBw
        YXJzZU5hbWUgb2JqZWN0IHdpdGggdGhlIHBhcnNlZAogICAgICBmdWxsTmFt
        ZSBsb29rdXAgc3RyaW5nCiAgICBAbWV0aG9kIHJlc29sdmVNb2RlbAogICov
        CiAgcmVzb2x2ZU1vZGVsOiBmdW5jdGlvbihwYXJzZWROYW1lKSB7CiAgICB2
        YXIgY2xhc3NOYW1lID0gY2xhc3NpZnkocGFyc2VkTmFtZS5uYW1lKSwKICAg
        ICAgICBmYWN0b3J5ID0gZ2V0KHBhcnNlZE5hbWUucm9vdCwgY2xhc3NOYW1l
        KTsKCiAgICAgaWYgKGZhY3RvcnkpIHsgcmV0dXJuIGZhY3Rvcnk7IH0KICB9
        LAogIC8qKgogICAgTG9vayB1cCB0aGUgc3BlY2lmaWVkIG9iamVjdCAoZnJv
        bSBwYXJzZWROYW1lKSBvbiB0aGUgYXBwcm9wcmlhdGUKICAgIG5hbWVzcGFj
        ZSAodXN1YWxseSBvbiB0aGUgQXBwbGljYXRpb24pCgogICAgQHByb3RlY3Rl
        ZAogICAgQHBhcmFtIHtPYmplY3R9IHBhcnNlZE5hbWUgYSBwYXJzZU5hbWUg
        b2JqZWN0IHdpdGggdGhlIHBhcnNlZAogICAgICBmdWxsTmFtZSBsb29rdXAg
        c3RyaW5nCiAgICBAbWV0aG9kIHJlc29sdmVPdGhlcgogICovCiAgcmVzb2x2
        ZU90aGVyOiBmdW5jdGlvbihwYXJzZWROYW1lKSB7CiAgICB2YXIgY2xhc3NO
        YW1lID0gY2xhc3NpZnkocGFyc2VkTmFtZS5uYW1lKSArIGNsYXNzaWZ5KHBh
        cnNlZE5hbWUudHlwZSksCiAgICAgICAgZmFjdG9yeSA9IGdldChwYXJzZWRO
        YW1lLnJvb3QsIGNsYXNzTmFtZSk7CiAgICBpZiAoZmFjdG9yeSkgeyByZXR1
        cm4gZmFjdG9yeTsgfQogIH0sCgogIC8qKgogICAgUmV0dXJucyBhIGh1bWFu
        LXJlYWRhYmxlIGRlc2NyaXB0aW9uIGZvciBhIGZ1bGxOYW1lLiBVc2VkIGJ5
        IHRoZQogICAgQXBwbGljYXRpb24gbmFtZXNwYWNlIGluIGFzc2VydGlvbnMg
        dG8gZGVzY3JpYmUgdGhlCiAgICBwcmVjaXNlIG5hbWUgb2YgdGhlIGNsYXNz
        IHRoYXQgRW1iZXIgaXMgbG9va2luZyBmb3IsIHJhdGhlciB0aGFuCiAgICBj
        b250YWluZXIga2V5cy4KCiAgICBAcHJvdGVjdGVkCiAgICBAcGFyYW0ge1N0
        cmluZ30gZnVsbE5hbWUgdGhlIGxvb2t1cCBzdHJpbmcKICAgIEBtZXRob2Qg
        bG9va3VwRGVzY3JpcHRpb24KICAqLwogIGxvb2t1cERlc2NyaXB0aW9uOiBm
        dW5jdGlvbihmdWxsTmFtZSkgewogICAgdmFyIHBhcnNlZE5hbWUgPSB0aGlz
        LnBhcnNlTmFtZShmdWxsTmFtZSk7CgogICAgaWYgKHBhcnNlZE5hbWUudHlw
        ZSA9PT0gJ3RlbXBsYXRlJykgewogICAgICByZXR1cm4gInRlbXBsYXRlIGF0
        ICIgKyBwYXJzZWROYW1lLmZ1bGxOYW1lV2l0aG91dFR5cGUucmVwbGFjZSgv
        XC4vZywgJy8nKTsKICAgIH0KCiAgICB2YXIgZGVzY3JpcHRpb24gPSBwYXJz
        ZWROYW1lLnJvb3QgKyAiLiIgKyBjbGFzc2lmeShwYXJzZWROYW1lLm5hbWUp
        OwogICAgaWYgKHBhcnNlZE5hbWUudHlwZSAhPT0gJ21vZGVsJykgeyBkZXNj
        cmlwdGlvbiArPSBjbGFzc2lmeShwYXJzZWROYW1lLnR5cGUpOyB9CgogICAg
        cmV0dXJuIGRlc2NyaXB0aW9uOwogIH0sCgogIG1ha2VUb1N0cmluZzogZnVu
        Y3Rpb24oZmFjdG9yeSwgZnVsbE5hbWUpIHsKICAgIHJldHVybiBmYWN0b3J5
        LnRvU3RyaW5nKCk7CiAgfQp9KTsKCn0pKCk7CgoKCihmdW5jdGlvbigpIHsK
        LyoqCkBtb2R1bGUgZW1iZXIKQHN1Ym1vZHVsZSBlbWJlci1hcHBsaWNhdGlv
        bgoqLwoKdmFyIGdldCA9IEVtYmVyLmdldCwgc2V0ID0gRW1iZXIuc2V0OwoK
        ZnVuY3Rpb24gRGVwcmVjYXRlZENvbnRhaW5lcihjb250YWluZXIpIHsKICB0
        aGlzLl9jb250YWluZXIgPSBjb250YWluZXI7Cn0KCkRlcHJlY2F0ZWRDb250
        YWluZXIuZGVwcmVjYXRlID0gZnVuY3Rpb24obWV0aG9kKSB7CiAgcmV0dXJu
        IGZ1bmN0aW9uKCkgewogICAgdmFyIGNvbnRhaW5lciA9IHRoaXMuX2NvbnRh
        aW5lcjsKCiAgICBFbWJlci5kZXByZWNhdGUoJ1VzaW5nIHRoZSBkZWZhdWx0
        Q29udGFpbmVyIGlzIG5vIGxvbmdlciBzdXBwb3J0ZWQuIFtkZWZhdWx0Q29u
        dGFpbmVyIycgKyBtZXRob2QgKyAnXSBzZWU6IGh0dHA6Ly9naXQuaW8vRUtQ
        cG5BJywgZmFsc2UpOwogICAgcmV0dXJuIGNvbnRhaW5lclttZXRob2RdLmFw
        cGx5KGNvbnRhaW5lciwgYXJndW1lbnRzKTsKICB9Owp9OwoKRGVwcmVjYXRl
        ZENvbnRhaW5lci5wcm90b3R5cGUgPSB7CiAgX2NvbnRhaW5lcjogbnVsbCwK
        ICBsb29rdXA6IERlcHJlY2F0ZWRDb250YWluZXIuZGVwcmVjYXRlKCdsb29r
        dXAnKSwKICByZXNvbHZlOiBEZXByZWNhdGVkQ29udGFpbmVyLmRlcHJlY2F0
        ZSgncmVzb2x2ZScpLAogIHJlZ2lzdGVyOiBEZXByZWNhdGVkQ29udGFpbmVy
        LmRlcHJlY2F0ZSgncmVnaXN0ZXInKQp9OwoKLyoqCiAgQW4gaW5zdGFuY2Ug
        b2YgYEVtYmVyLkFwcGxpY2F0aW9uYCBpcyB0aGUgc3RhcnRpbmcgcG9pbnQg
        Zm9yIGV2ZXJ5IEVtYmVyCiAgYXBwbGljYXRpb24uIEl0IGhlbHBzIHRvIGlu
        c3RhbnRpYXRlLCBpbml0aWFsaXplIGFuZCBjb29yZGluYXRlIHRoZSBtYW55
        CiAgb2JqZWN0cyB0aGF0IG1ha2UgdXAgeW91ciBhcHAuCgogIEVhY2ggRW1i
        ZXIgYXBwIGhhcyBvbmUgYW5kIG9ubHkgb25lIGBFbWJlci5BcHBsaWNhdGlv
        bmAgb2JqZWN0LiBJbiBmYWN0LCB0aGUKICB2ZXJ5IGZpcnN0IHRoaW5nIHlv
        dSBzaG91bGQgZG8gaW4geW91ciBhcHBsaWNhdGlvbiBpcyBjcmVhdGUgdGhl
        IGluc3RhbmNlOgoKICBgYGBqYXZhc2NyaXB0CiAgd2luZG93LkFwcCA9IEVt
        YmVyLkFwcGxpY2F0aW9uLmNyZWF0ZSgpOwogIGBgYAoKICBUeXBpY2FsbHks
        IHRoZSBhcHBsaWNhdGlvbiBvYmplY3QgaXMgdGhlIG9ubHkgZ2xvYmFsIHZh
        cmlhYmxlLiBBbGwgb3RoZXIKICBjbGFzc2VzIGluIHlvdXIgYXBwIHNob3Vs
        ZCBiZSBwcm9wZXJ0aWVzIG9uIHRoZSBgRW1iZXIuQXBwbGljYXRpb25gIGlu
        c3RhbmNlLAogIHdoaWNoIGhpZ2hsaWdodHMgaXRzIGZpcnN0IHJvbGU6IGEg
        Z2xvYmFsIG5hbWVzcGFjZS4KCiAgRm9yIGV4YW1wbGUsIGlmIHlvdSBkZWZp
        bmUgYSB2aWV3IGNsYXNzLCBpdCBtaWdodCBsb29rIGxpa2UgdGhpczoKCiAg
        YGBgamF2YXNjcmlwdAogIEFwcC5NeVZpZXcgPSBFbWJlci5WaWV3LmV4dGVu
        ZCgpOwogIGBgYAoKICBCeSBkZWZhdWx0LCBjYWxsaW5nIGBFbWJlci5BcHBs
        aWNhdGlvbi5jcmVhdGUoKWAgd2lsbCBhdXRvbWF0aWNhbGx5IGluaXRpYWxp
        emUKICB5b3VyIGFwcGxpY2F0aW9uIGJ5IGNhbGxpbmcgdGhlIGBFbWJlci5B
        cHBsaWNhdGlvbi5pbml0aWFsaXplKClgIG1ldGhvZC4gSWYKICB5b3UgbmVl
        ZCB0byBkZWxheSBpbml0aWFsaXphdGlvbiwgeW91IGNhbiBjYWxsIHlvdXIg
        YXBwJ3MgYGRlZmVyUmVhZGluZXNzKClgCiAgbWV0aG9kLiBXaGVuIHlvdSBh
        cmUgcmVhZHkgZm9yIHlvdXIgYXBwIHRvIGJlIGluaXRpYWxpemVkLCBjYWxs
        IGl0cwogIGBhZHZhbmNlUmVhZGluZXNzKClgIG1ldGhvZC4KCiAgWW91IGNh
        biBkZWZpbmUgYSBgcmVhZHlgIG1ldGhvZCBvbiB0aGUgYEVtYmVyLkFwcGxp
        Y2F0aW9uYCBpbnN0YW5jZSwgd2hpY2gKICB3aWxsIGJlIHJ1biBieSBFbWJl
        ciB3aGVuIHRoZSBhcHBsaWNhdGlvbiBpcyBpbml0aWFsaXplZC4KCiAgQmVj
        YXVzZSBgRW1iZXIuQXBwbGljYXRpb25gIGluaGVyaXRzIGZyb20gYEVtYmVy
        Lk5hbWVzcGFjZWAsIGFueSBjbGFzc2VzCiAgeW91IGNyZWF0ZSB3aWxsIGhh
        dmUgdXNlZnVsIHN0cmluZyByZXByZXNlbnRhdGlvbnMgd2hlbiBjYWxsaW5n
        IGB0b1N0cmluZygpYC4KICBTZWUgdGhlIGBFbWJlci5OYW1lc3BhY2VgIGRv
        Y3VtZW50YXRpb24gZm9yIG1vcmUgaW5mb3JtYXRpb24uCgogIFdoaWxlIHlv
        dSBjYW4gdGhpbmsgb2YgeW91ciBgRW1iZXIuQXBwbGljYXRpb25gIGFzIGEg
        Y29udGFpbmVyIHRoYXQgaG9sZHMgdGhlCiAgb3RoZXIgY2xhc3NlcyBpbiB5
        b3VyIGFwcGxpY2F0aW9uLCB0aGVyZSBhcmUgc2V2ZXJhbCBvdGhlciByZXNw
        b25zaWJpbGl0aWVzCiAgZ29pbmcgb24gdW5kZXItdGhlLWhvb2QgdGhhdCB5
        b3UgbWF5IHdhbnQgdG8gdW5kZXJzdGFuZC4KCiAgIyMjIEV2ZW50IERlbGVn
        YXRpb24KCiAgRW1iZXIgdXNlcyBhIHRlY2huaXF1ZSBjYWxsZWQgX2V2ZW50
        IGRlbGVnYXRpb25fLiBUaGlzIGFsbG93cyB0aGUgZnJhbWV3b3JrCiAgdG8g
        c2V0IHVwIGEgZ2xvYmFsLCBzaGFyZWQgZXZlbnQgbGlzdGVuZXIgaW5zdGVh
        ZCBvZiByZXF1aXJpbmcgZWFjaCB2aWV3IHRvCiAgZG8gaXQgbWFudWFsbHku
        IEZvciBleGFtcGxlLCBpbnN0ZWFkIG9mIGVhY2ggdmlldyByZWdpc3Rlcmlu
        ZyBpdHMgb3duCiAgYG1vdXNlZG93bmAgbGlzdGVuZXIgb24gaXRzIGFzc29j
        aWF0ZWQgZWxlbWVudCwgRW1iZXIgc2V0cyB1cCBhIGBtb3VzZWRvd25gCiAg
        bGlzdGVuZXIgb24gdGhlIGBib2R5YC4KCiAgSWYgYSBgbW91c2Vkb3duYCBl
        dmVudCBvY2N1cnMsIEVtYmVyIHdpbGwgbG9vayBhdCB0aGUgdGFyZ2V0IG9m
        IHRoZSBldmVudCBhbmQKICBzdGFydCB3YWxraW5nIHVwIHRoZSBET00gbm9k
        ZSB0cmVlLCBmaW5kaW5nIGNvcnJlc3BvbmRpbmcgdmlld3MgYW5kIGludm9r
        aW5nCiAgdGhlaXIgYG1vdXNlRG93bmAgbWV0aG9kIGFzIGl0IGdvZXMuCgog
        IGBFbWJlci5BcHBsaWNhdGlvbmAgaGFzIGEgbnVtYmVyIG9mIGRlZmF1bHQg
        ZXZlbnRzIHRoYXQgaXQgbGlzdGVucyBmb3IsIGFzCiAgd2VsbCBhcyBhIG1h
        cHBpbmcgZnJvbSBsb3dlcmNhc2UgZXZlbnRzIHRvIGNhbWVsLWNhc2VkIHZp
        ZXcgbWV0aG9kIG5hbWVzLiBGb3IKICBleGFtcGxlLCB0aGUgYGtleXByZXNz
        YCBldmVudCBjYXVzZXMgdGhlIGBrZXlQcmVzc2AgbWV0aG9kIG9uIHRoZSB2
        aWV3IHRvIGJlCiAgY2FsbGVkLCB0aGUgYGRibGNsaWNrYCBldmVudCBjYXVz
        ZXMgYGRvdWJsZUNsaWNrYCB0byBiZSBjYWxsZWQsIGFuZCBzbyBvbi4KCiAg
        SWYgdGhlcmUgaXMgYSBidWJibGluZyBicm93c2VyIGV2ZW50IHRoYXQgRW1i
        ZXIgZG9lcyBub3QgbGlzdGVuIGZvciBieQogIGRlZmF1bHQsIHlvdSBjYW4g
        c3BlY2lmeSBjdXN0b20gZXZlbnRzIGFuZCB0aGVpciBjb3JyZXNwb25kaW5n
        IHZpZXcgbWV0aG9kCiAgbmFtZXMgYnkgc2V0dGluZyB0aGUgYXBwbGljYXRp
        b24ncyBgY3VzdG9tRXZlbnRzYCBwcm9wZXJ0eToKCiAgYGBgamF2YXNjcmlw
        dAogIEFwcCA9IEVtYmVyLkFwcGxpY2F0aW9uLmNyZWF0ZSh7CiAgICBjdXN0
        b21FdmVudHM6IHsKICAgICAgLy8gYWRkIHN1cHBvcnQgZm9yIHRoZSBwYXN0
        ZSBldmVudAogICAgICAncGFzdGU6ICJwYXN0ZSIKICAgIH0KICB9KTsKICBg
        YGAKCiAgQnkgZGVmYXVsdCwgdGhlIGFwcGxpY2F0aW9uIHNldHMgdXAgdGhl
        c2UgZXZlbnQgbGlzdGVuZXJzIG9uIHRoZSBkb2N1bWVudAogIGJvZHkuIEhv
        d2V2ZXIsIGluIGNhc2VzIHdoZXJlIHlvdSBhcmUgZW1iZWRkaW5nIGFuIEVt
        YmVyIGFwcGxpY2F0aW9uIGluc2lkZQogIGFuIGV4aXN0aW5nIHBhZ2UsIHlv
        dSBtYXkgd2FudCBpdCB0byBzZXQgdXAgdGhlIGxpc3RlbmVycyBvbiBhbiBl
        bGVtZW50CiAgaW5zaWRlIHRoZSBib2R5LgoKICBGb3IgZXhhbXBsZSwgaWYg
        b25seSBldmVudHMgaW5zaWRlIGEgRE9NIGVsZW1lbnQgd2l0aCB0aGUgSUQg
        b2YgYGVtYmVyLWFwcGAKICBzaG91bGQgYmUgZGVsZWdhdGVkLCBzZXQgeW91
        ciBhcHBsaWNhdGlvbidzIGByb290RWxlbWVudGAgcHJvcGVydHk6CgogIGBg
        YGphdmFzY3JpcHQKICB3aW5kb3cuQXBwID0gRW1iZXIuQXBwbGljYXRpb24u
        Y3JlYXRlKHsKICAgIHJvb3RFbGVtZW50OiAnI2VtYmVyLWFwcCcKICB9KTsK
        ICBgYGAKCiAgVGhlIGByb290RWxlbWVudGAgY2FuIGJlIGVpdGhlciBhIERP
        TSBlbGVtZW50IG9yIGEgalF1ZXJ5LWNvbXBhdGlibGUgc2VsZWN0b3IKICBz
        dHJpbmcuIE5vdGUgdGhhdCAqdmlld3MgYXBwZW5kZWQgdG8gdGhlIERPTSBv
        dXRzaWRlIHRoZSByb290IGVsZW1lbnQgd2lsbAogIG5vdCByZWNlaXZlIGV2
        ZW50cy4qIElmIHlvdSBzcGVjaWZ5IGEgY3VzdG9tIHJvb3QgZWxlbWVudCwg
        bWFrZSBzdXJlIHlvdSBvbmx5CiAgYXBwZW5kIHZpZXdzIGluc2lkZSBpdCEK
        CiAgVG8gbGVhcm4gbW9yZSBhYm91dCB0aGUgYWR2YW50YWdlcyBvZiBldmVu
        dCBkZWxlZ2F0aW9uIGFuZCB0aGUgRW1iZXIgdmlldwogIGxheWVyLCBhbmQg
        YSBsaXN0IG9mIHRoZSBldmVudCBsaXN0ZW5lcnMgdGhhdCBhcmUgc2V0dXAg
        YnkgZGVmYXVsdCwgdmlzaXQgdGhlCiAgW0VtYmVyIFZpZXcgTGF5ZXIgZ3Vp
        ZGVdKGh0dHA6Ly9lbWJlcmpzLmNvbS9ndWlkZXMvdW5kZXJzdGFuZGluZy1l
        bWJlci90aGUtdmlldy1sYXllci8jdG9jX2V2ZW50LWRlbGVnYXRpb24pLgoK
        ICAjIyMgSW5pdGlhbGl6ZXJzCgogIExpYnJhcmllcyBvbiB0b3Agb2YgRW1i
        ZXIgY2FuIHJlZ2lzdGVyIGFkZGl0aW9uYWwgaW5pdGlhbGl6ZXJzLCBsaWtl
        IHNvOgoKICBgYGBqYXZhc2NyaXB0CiAgRW1iZXIuQXBwbGljYXRpb24uaW5p
        dGlhbGl6ZXIoewogICAgbmFtZTogInN0b3JlIiwKCiAgICBpbml0aWFsaXpl
        OiBmdW5jdGlvbihjb250YWluZXIsIGFwcGxpY2F0aW9uKSB7CiAgICAgIGNv
        bnRhaW5lci5yZWdpc3Rlcignc3RvcmU6bWFpbicsIGFwcGxpY2F0aW9uLlN0
        b3JlKTsKICAgIH0KICB9KTsKICBgYGAKCiAgIyMjIFJvdXRpbmcKCiAgSW4g
        YWRkaXRpb24gdG8gY3JlYXRpbmcgeW91ciBhcHBsaWNhdGlvbidzIHJvdXRl
        ciwgYEVtYmVyLkFwcGxpY2F0aW9uYCBpcwogIGFsc28gcmVzcG9uc2libGUg
        Zm9yIHRlbGxpbmcgdGhlIHJvdXRlciB3aGVuIHRvIHN0YXJ0IHJvdXRpbmcu
        IFRyYW5zaXRpb25zCiAgYmV0d2VlbiByb3V0ZXMgY2FuIGJlIGxvZ2dlZCB3
        aXRoIHRoZSBgTE9HX1RSQU5TSVRJT05TYCBmbGFnLCBhbmQgbW9yZQogIGRl
        dGFpbGVkIGludHJhLXRyYW5zaXRpb24gbG9nZ2luZyBjYW4gYmUgbG9nZ2Vk
        IHdpdGgKICB0aGUgYExPR19UUkFOU0lUSU9OU19JTlRFUk5BTGAgZmxhZzoK
        CiAgYGBgamF2YXNjcmlwdAogIHdpbmRvdy5BcHAgPSBFbWJlci5BcHBsaWNh
        dGlvbi5jcmVhdGUoewogICAgTE9HX1RSQU5TSVRJT05TOiB0cnVlLCAvLyBi
        YXNpYyBsb2dnaW5nIG9mIHN1Y2Nlc3NmdWwgdHJhbnNpdGlvbnMKICAgIExP
        R19UUkFOU0lUSU9OU19JTlRFUk5BTDogdHJ1ZSAvLyBkZXRhaWxlZCBsb2dn
        aW5nIG9mIGFsbCByb3V0aW5nIHN0ZXBzCiAgfSk7CiAgYGBgCgogIEJ5IGRl
        ZmF1bHQsIHRoZSByb3V0ZXIgd2lsbCBiZWdpbiB0cnlpbmcgdG8gdHJhbnNs
        YXRlIHRoZSBjdXJyZW50IFVSTCBpbnRvCiAgYXBwbGljYXRpb24gc3RhdGUg
        b25jZSB0aGUgYnJvd3NlciBlbWl0cyB0aGUgYERPTUNvbnRlbnRSZWFkeWAg
        ZXZlbnQuIElmIHlvdQogIG5lZWQgdG8gZGVmZXIgcm91dGluZywgeW91IGNh
        biBjYWxsIHRoZSBhcHBsaWNhdGlvbidzIGBkZWZlclJlYWRpbmVzcygpYAog
        IG1ldGhvZC4gT25jZSByb3V0aW5nIGNhbiBiZWdpbiwgY2FsbCB0aGUgYGFk
        dmFuY2VSZWFkaW5lc3MoKWAgbWV0aG9kLgoKICBJZiB0aGVyZSBpcyBhbnkg
        c2V0dXAgcmVxdWlyZWQgYmVmb3JlIHJvdXRpbmcgYmVnaW5zLCB5b3UgY2Fu
        IGltcGxlbWVudCBhCiAgYHJlYWR5KClgIG1ldGhvZCBvbiB5b3VyIGFwcCB0
        aGF0IHdpbGwgYmUgaW52b2tlZCBpbW1lZGlhdGVseSBiZWZvcmUgcm91dGlu
        ZwogIGJlZ2lucy4KICBgYGAKCiAgQGNsYXNzIEFwcGxpY2F0aW9uCiAgQG5h
        bWVzcGFjZSBFbWJlcgogIEBleHRlbmRzIEVtYmVyLk5hbWVzcGFjZQoqLwoK
        dmFyIEFwcGxpY2F0aW9uID0gRW1iZXIuQXBwbGljYXRpb24gPSBFbWJlci5O
        YW1lc3BhY2UuZXh0ZW5kKEVtYmVyLkRlZmVycmVkTWl4aW4sIHsKCiAgLyoq
        CiAgICBUaGUgcm9vdCBET00gZWxlbWVudCBvZiB0aGUgQXBwbGljYXRpb24u
        IFRoaXMgY2FuIGJlIHNwZWNpZmllZCBhcyBhbgogICAgZWxlbWVudCBvciBh
        CiAgICBbalF1ZXJ5LWNvbXBhdGlibGUgc2VsZWN0b3Igc3RyaW5nXShodHRw
        Oi8vYXBpLmpxdWVyeS5jb20vY2F0ZWdvcnkvc2VsZWN0b3JzLykuCgogICAg
        VGhpcyBpcyB0aGUgZWxlbWVudCB0aGF0IHdpbGwgYmUgcGFzc2VkIHRvIHRo
        ZSBBcHBsaWNhdGlvbidzLAogICAgYGV2ZW50RGlzcGF0Y2hlcmAsIHdoaWNo
        IHNldHMgdXAgdGhlIGxpc3RlbmVycyBmb3IgZXZlbnQgZGVsZWdhdGlvbi4g
        RXZlcnkKICAgIHZpZXcgaW4geW91ciBhcHBsaWNhdGlvbiBzaG91bGQgYmUg
        YSBjaGlsZCBvZiB0aGUgZWxlbWVudCB5b3Ugc3BlY2lmeSBoZXJlLgoKICAg
        IEBwcm9wZXJ0eSByb290RWxlbWVudAogICAgQHR5cGUgRE9NRWxlbWVudAog
        ICAgQGRlZmF1bHQgJ2JvZHknCiAgKi8KICByb290RWxlbWVudDogJ2JvZHkn
        LAoKICAvKioKICAgIFRoZSBgRW1iZXIuRXZlbnREaXNwYXRjaGVyYCByZXNw
        b25zaWJsZSBmb3IgZGVsZWdhdGluZyBldmVudHMgdG8gdGhpcwogICAgYXBw
        bGljYXRpb24ncyB2aWV3cy4KCiAgICBUaGUgZXZlbnQgZGlzcGF0Y2hlciBp
        cyBjcmVhdGVkIGJ5IHRoZSBhcHBsaWNhdGlvbiBhdCBpbml0aWFsaXphdGlv
        biB0aW1lCiAgICBhbmQgc2V0cyB1cCBldmVudCBsaXN0ZW5lcnMgb24gdGhl
        IERPTSBlbGVtZW50IGRlc2NyaWJlZCBieSB0aGUKICAgIGFwcGxpY2F0aW9u
        J3MgYHJvb3RFbGVtZW50YCBwcm9wZXJ0eS4KCiAgICBTZWUgdGhlIGRvY3Vt
        ZW50YXRpb24gZm9yIGBFbWJlci5FdmVudERpc3BhdGNoZXJgIGZvciBtb3Jl
        IGluZm9ybWF0aW9uLgoKICAgIEBwcm9wZXJ0eSBldmVudERpc3BhdGNoZXIK
        ICAgIEB0eXBlIEVtYmVyLkV2ZW50RGlzcGF0Y2hlcgogICAgQGRlZmF1bHQg
        bnVsbAogICovCiAgZXZlbnREaXNwYXRjaGVyOiBudWxsLAoKICAvKioKICAg
        IFRoZSBET00gZXZlbnRzIGZvciB3aGljaCB0aGUgZXZlbnQgZGlzcGF0Y2hl
        ciBzaG91bGQgbGlzdGVuLgoKICAgIEJ5IGRlZmF1bHQsIHRoZSBhcHBsaWNh
        dGlvbidzIGBFbWJlci5FdmVudERpc3BhdGNoZXJgIGxpc3RlbnMKICAgIGZv
        ciBhIHNldCBvZiBzdGFuZGFyZCBET00gZXZlbnRzLCBzdWNoIGFzIGBtb3Vz
        ZWRvd25gIGFuZAogICAgYGtleXVwYCwgYW5kIGRlbGVnYXRlcyB0aGVtIHRv
        IHlvdXIgYXBwbGljYXRpb24ncyBgRW1iZXIuVmlld2AKICAgIGluc3RhbmNl
        cy4KCiAgICBJZiB5b3Ugd291bGQgbGlrZSBhZGRpdGlvbmFsIGJ1YmJsaW5n
        IGV2ZW50cyB0byBiZSBkZWxlZ2F0ZWQgdG8geW91cgogICAgdmlld3MsIHNl
        dCB5b3VyIGBFbWJlci5BcHBsaWNhdGlvbmAncyBgY3VzdG9tRXZlbnRzYCBw
        cm9wZXJ0eQogICAgdG8gYSBoYXNoIGNvbnRhaW5pbmcgdGhlIERPTSBldmVu
        dCBuYW1lIGFzIHRoZSBrZXkgYW5kIHRoZQogICAgY29ycmVzcG9uZGluZyB2
        aWV3IG1ldGhvZCBuYW1lIGFzIHRoZSB2YWx1ZS4gRm9yIGV4YW1wbGU6Cgog
        ICAgYGBgamF2YXNjcmlwdAogICAgQXBwID0gRW1iZXIuQXBwbGljYXRpb24u
        Y3JlYXRlKHsKICAgICAgY3VzdG9tRXZlbnRzOiB7CiAgICAgICAgLy8gYWRk
        IHN1cHBvcnQgZm9yIHRoZSBwYXN0ZSBldmVudAogICAgICAgICdwYXN0ZTog
        InBhc3RlIgogICAgICB9CiAgICB9KTsKICAgIGBgYAoKICAgIEBwcm9wZXJ0
        eSBjdXN0b21FdmVudHMKICAgIEB0eXBlIE9iamVjdAogICAgQGRlZmF1bHQg
        bnVsbAogICovCiAgY3VzdG9tRXZlbnRzOiBudWxsLAoKICAvLyBTdGFydCBv
        ZmYgdGhlIG51bWJlciBvZiBkZWZlcnJhbHMgYXQgMS4gVGhpcyB3aWxsIGJl
        CiAgLy8gZGVjcmVtZW50ZWQgYnkgdGhlIEFwcGxpY2F0aW9uJ3Mgb3duIGBp
        bml0aWFsaXplYCBtZXRob2QuCiAgX3JlYWRpbmVzc0RlZmVycmFsczogMSwK
        CiAgaW5pdDogZnVuY3Rpb24oKSB7CiAgICBpZiAoIXRoaXMuJCkgeyB0aGlz
        LiQgPSBFbWJlci4kOyB9CiAgICB0aGlzLl9fY29udGFpbmVyX18gPSB0aGlz
        LmJ1aWxkQ29udGFpbmVyKCk7CgogICAgdGhpcy5Sb3V0ZXIgPSB0aGlzLlJv
        dXRlciB8fCB0aGlzLmRlZmF1bHRSb3V0ZXIoKTsKICAgIGlmICh0aGlzLlJv
        dXRlcikgeyB0aGlzLlJvdXRlci5uYW1lc3BhY2UgPSB0aGlzOyB9CgogICAg
        dGhpcy5fc3VwZXIoKTsKCiAgICB0aGlzLnNjaGVkdWxlSW5pdGlhbGl6ZSgp
        OwoKICAgIEVtYmVyLmxpYnJhcmllcy5yZWdpc3RlckNvcmVMaWJyYXJ5KCdI
        YW5kbGViYXJzJywgRW1iZXIuSGFuZGxlYmFycy5WRVJTSU9OKTsKICAgIEVt
        YmVyLmxpYnJhcmllcy5yZWdpc3RlckNvcmVMaWJyYXJ5KCdqUXVlcnknLCBF
        bWJlci4kKCkuanF1ZXJ5KTsKCiAgICBpZiAoIEVtYmVyLkxPR19WRVJTSU9O
        ICkgewogICAgICBFbWJlci5MT0dfVkVSU0lPTiA9IGZhbHNlOyAvLyB3ZSBv
        bmx5IG5lZWQgdG8gc2VlIHRoaXMgb25jZSBwZXIgQXBwbGljYXRpb24jaW5p
        dAogICAgICB2YXIgbWF4TmFtZUxlbmd0aCA9IE1hdGgubWF4LmFwcGx5KHRo
        aXMsIEVtYmVyLkEoRW1iZXIubGlicmFyaWVzKS5tYXBCeSgibmFtZS5sZW5n
        dGgiKSk7CgogICAgICBFbWJlci5kZWJ1ZygnLS0tLS0tLS0tLS0tLS0tLS0t
        LS0tLS0tLS0tLS0tLScpOwogICAgICBFbWJlci5saWJyYXJpZXMuZWFjaChm
        dW5jdGlvbihuYW1lLCB2ZXJzaW9uKSB7CiAgICAgICAgdmFyIHNwYWNlcyA9
        IG5ldyBBcnJheShtYXhOYW1lTGVuZ3RoIC0gbmFtZS5sZW5ndGggKyAxKS5q
        b2luKCIgIik7CiAgICAgICAgRW1iZXIuZGVidWcoW25hbWUsIHNwYWNlcywg
        JyA6ICcsIHZlcnNpb25dLmpvaW4oIiIpKTsKICAgICAgfSk7CiAgICAgIEVt
        YmVyLmRlYnVnKCctLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tJyk7
        CiAgICB9CiAgfSwKCiAgLyoqCiAgICBAcHJpdmF0ZQoKICAgIEJ1aWxkIHRo
        ZSBjb250YWluZXIgZm9yIHRoZSBjdXJyZW50IGFwcGxpY2F0aW9uLgoKICAg
        IEFsc28gcmVnaXN0ZXIgYSBkZWZhdWx0IGFwcGxpY2F0aW9uIHZpZXcgaW4g
        Y2FzZSB0aGUgYXBwbGljYXRpb24KICAgIGl0c2VsZiBkb2VzIG5vdC4KCiAg
        ICBAbWV0aG9kIGJ1aWxkQ29udGFpbmVyCiAgICBAcmV0dXJuIHtFbWJlci5D
        b250YWluZXJ9IHRoZSBjb25maWd1cmVkIGNvbnRhaW5lcgogICovCiAgYnVp
        bGRDb250YWluZXI6IGZ1bmN0aW9uKCkgewogICAgdmFyIGNvbnRhaW5lciA9
        IHRoaXMuX19jb250YWluZXJfXyA9IEFwcGxpY2F0aW9uLmJ1aWxkQ29udGFp
        bmVyKHRoaXMpOwoKICAgIHJldHVybiBjb250YWluZXI7CiAgfSwKCiAgLyoq
        CiAgICBAcHJpdmF0ZQoKICAgIElmIHRoZSBhcHBsaWNhdGlvbiBoYXMgbm90
        IG9wdGVkIG91dCBvZiByb3V0aW5nIGFuZCBoYXMgbm90IGV4cGxpY2l0bHkK
        ICAgIGRlZmluZWQgYSByb3V0ZXIsIHN1cHBseSBhIGRlZmF1bHQgcm91dGVy
        IGZvciB0aGUgYXBwbGljYXRpb24gYXV0aG9yCiAgICB0byBjb25maWd1cmUu
        CgogICAgVGhpcyBhbGxvd3MgYXBwbGljYXRpb24gZGV2ZWxvcGVycyB0byBk
        bzoKCiAgICBgYGBqYXZhc2NyaXB0CiAgICB2YXIgQXBwID0gRW1iZXIuQXBw
        bGljYXRpb24uY3JlYXRlKCk7CgogICAgQXBwLlJvdXRlci5tYXAoZnVuY3Rp
        b24oKSB7CiAgICAgIHRoaXMucmVzb3VyY2UoJ3Bvc3RzJyk7CiAgICB9KTsK
        ICAgIGBgYAoKICAgIEBtZXRob2QgZGVmYXVsdFJvdXRlcgogICAgQHJldHVy
        biB7RW1iZXIuUm91dGVyfSB0aGUgZGVmYXVsdCByb3V0ZXIKICAqLwogIGRl
        ZmF1bHRSb3V0ZXI6IGZ1bmN0aW9uKCkgewogICAgLy8gQ3JlYXRlIGEgZGVm
        YXVsdCBBcHAuUm91dGVyIGlmIG9uZSB3YXMgbm90IHN1cHBsaWVkIHRvIG1h
        a2UKICAgIC8vIGl0IHBvc3NpYmxlIHRvIGRvIEFwcC5Sb3V0ZXIubWFwKC4u
        Likgd2l0aG91dCBleHBsaWNpdGx5CiAgICAvLyBjcmVhdGluZyBhIHJvdXRl
        ciBmaXJzdC4KICAgIGlmICh0aGlzLnJvdXRlciA9PT0gdW5kZWZpbmVkKSB7
        CiAgICAgIHJldHVybiBFbWJlci5Sb3V0ZXIuZXh0ZW5kKCk7CiAgICB9CiAg
        fSwKCiAgLyoqCiAgICBAcHJpdmF0ZQoKICAgIEF1dG9tYXRpY2FsbHkgaW5p
        dGlhbGl6ZSB0aGUgYXBwbGljYXRpb24gb25jZSB0aGUgRE9NIGhhcwogICAg
        YmVjb21lIHJlYWR5LgoKICAgIFRoZSBpbml0aWFsaXphdGlvbiBpdHNlbGYg
        aXMgc2NoZWR1bGVkIG9uIHRoZSBhY3Rpb25zIHF1ZXVlCiAgICB3aGljaCBl
        bnN1cmVzIHRoYXQgYXBwbGljYXRpb24gbG9hZGluZyBmaW5pc2hlcyBiZWZv
        cmUKICAgIGJvb3RpbmcuCgogICAgSWYgeW91IGFyZSBhc3luY2hyb25vdXNs
        eSBsb2FkaW5nIGNvZGUsIHlvdSBzaG91bGQgY2FsbAogICAgYGRlZmVyUmVh
        ZGluZXNzKClgIHRvIGRlZmVyIGJvb3RpbmcsIGFuZCB0aGVuIGNhbGwKICAg
        IGBhZHZhbmNlUmVhZGluZXNzKClgIG9uY2UgYWxsIG9mIHlvdXIgY29kZSBo
        YXMgZmluaXNoZWQKICAgIGxvYWRpbmcuCgogICAgQG1ldGhvZCBzY2hlZHVs
        ZUluaXRpYWxpemUKICAqLwogIHNjaGVkdWxlSW5pdGlhbGl6ZTogZnVuY3Rp
        b24oKSB7CiAgICB2YXIgc2VsZiA9IHRoaXM7CgogICAgaWYgKCF0aGlzLiQg
        fHwgdGhpcy4kLmlzUmVhZHkpIHsKICAgICAgRW1iZXIucnVuLnNjaGVkdWxl
        KCdhY3Rpb25zJywgc2VsZiwgJ19pbml0aWFsaXplJyk7CiAgICB9IGVsc2Ug
        ewogICAgICB0aGlzLiQoKS5yZWFkeShmdW5jdGlvbigpIHsKICAgICAgICBF
        bWJlci5ydW4oc2VsZiwgJ19pbml0aWFsaXplJyk7CiAgICAgIH0pOwogICAg
        fQogIH0sCgogIC8qKgogICAgVXNlIHRoaXMgdG8gZGVmZXIgcmVhZGluZXNz
        IHVudGlsIHNvbWUgY29uZGl0aW9uIGlzIHRydWUuCgogICAgRXhhbXBsZToK
        CiAgICBgYGBqYXZhc2NyaXB0CiAgICBBcHAgPSBFbWJlci5BcHBsaWNhdGlv
        bi5jcmVhdGUoKTsKICAgIEFwcC5kZWZlclJlYWRpbmVzcygpOwoKICAgIGpR
        dWVyeS5nZXRKU09OKCIvYXV0aC10b2tlbiIsIGZ1bmN0aW9uKHRva2VuKSB7
        CiAgICAgIEFwcC50b2tlbiA9IHRva2VuOwogICAgICBBcHAuYWR2YW5jZVJl
        YWRpbmVzcygpOwogICAgfSk7CiAgICBgYGAKCiAgICBUaGlzIGFsbG93cyB5
        b3UgdG8gcGVyZm9ybSBhc3luY2hyb25vdXMgc2V0dXAgbG9naWMgYW5kIGRl
        ZmVyCiAgICBib290aW5nIHlvdXIgYXBwbGljYXRpb24gdW50aWwgdGhlIHNl
        dHVwIGhhcyBmaW5pc2hlZC4KCiAgICBIb3dldmVyLCBpZiB0aGUgc2V0dXAg
        cmVxdWlyZXMgYSBsb2FkaW5nIFVJLCBpdCBtaWdodCBiZSBiZXR0ZXIKICAg
        IHRvIHVzZSB0aGUgcm91dGVyIGZvciB0aGlzIHB1cnBvc2UuCgogICAgQG1l
        dGhvZCBkZWZlclJlYWRpbmVzcwogICovCiAgZGVmZXJSZWFkaW5lc3M6IGZ1
        bmN0aW9uKCkgewogICAgRW1iZXIuYXNzZXJ0KCJZb3UgbXVzdCBjYWxsIGRl
        ZmVyUmVhZGluZXNzIG9uIGFuIGluc3RhbmNlIG9mIEVtYmVyLkFwcGxpY2F0
        aW9uIiwgdGhpcyBpbnN0YW5jZW9mIEVtYmVyLkFwcGxpY2F0aW9uKTsKICAg
        IEVtYmVyLmFzc2VydCgiWW91IGNhbm5vdCBkZWZlciByZWFkaW5lc3Mgc2lu
        Y2UgdGhlIGByZWFkeSgpYCBob29rIGhhcyBhbHJlYWR5IGJlZW4gY2FsbGVk
        LiIsIHRoaXMuX3JlYWRpbmVzc0RlZmVycmFscyA+IDApOwogICAgdGhpcy5f
        cmVhZGluZXNzRGVmZXJyYWxzKys7CiAgfSwKCiAgLyoqCiAgICBDYWxsIGBh
        ZHZhbmNlUmVhZGluZXNzYCBhZnRlciBhbnkgYXN5bmNocm9ub3VzIHNldHVw
        IGxvZ2ljIGhhcyBjb21wbGV0ZWQuCiAgICBFYWNoIGNhbGwgdG8gYGRlZmVy
        UmVhZGluZXNzYCBtdXN0IGJlIG1hdGNoZWQgYnkgYSBjYWxsIHRvIGBhZHZh
        bmNlUmVhZGluZXNzYAogICAgb3IgdGhlIGFwcGxpY2F0aW9uIHdpbGwgbmV2
        ZXIgYmVjb21lIHJlYWR5IGFuZCByb3V0aW5nIHdpbGwgbm90IGJlZ2luLgog
        ICAgCiAgICBAbWV0aG9kIGFkdmFuY2VSZWFkaW5lc3MKICAgIEBzZWUge0Vt
        YmVyLkFwcGxpY2F0aW9uI2RlZmVyUmVhZGluZXNzfQogICovCiAgYWR2YW5j
        ZVJlYWRpbmVzczogZnVuY3Rpb24oKSB7CiAgICBFbWJlci5hc3NlcnQoIllv
        dSBtdXN0IGNhbGwgYWR2YW5jZVJlYWRpbmVzcyBvbiBhbiBpbnN0YW5jZSBv
        ZiBFbWJlci5BcHBsaWNhdGlvbiIsIHRoaXMgaW5zdGFuY2VvZiBFbWJlci5B
        cHBsaWNhdGlvbik7CiAgICB0aGlzLl9yZWFkaW5lc3NEZWZlcnJhbHMtLTsK
        CiAgICBpZiAodGhpcy5fcmVhZGluZXNzRGVmZXJyYWxzID09PSAwKSB7CiAg
        ICAgIEVtYmVyLnJ1bi5vbmNlKHRoaXMsIHRoaXMuZGlkQmVjb21lUmVhZHkp
        OwogICAgfQogIH0sCgogIC8qKgogICAgcmVnaXN0ZXJzIGEgZmFjdG9yeSBm
        b3IgbGF0ZXIgaW5qZWN0aW9uCgogICAgRXhhbXBsZToKCiAgICBgYGBqYXZh
        c2NyaXB0CiAgICBBcHAgPSBFbWJlci5BcHBsaWNhdGlvbi5jcmVhdGUoKTsK
        CiAgICBBcHAuUGVyc29uICA9IEVtYmVyLk9iamVjdC5leHRlbmQoe30pOwog
        ICAgQXBwLk9yYW5nZSAgPSBFbWJlci5PYmplY3QuZXh0ZW5kKHt9KTsKICAg
        IEFwcC5FbWFpbCAgID0gRW1iZXIuT2JqZWN0LmV4dGVuZCh7fSk7CiAgICBB
        cHAuU2Vzc2lvbiA9IEVtYmVyLk9iamVjdC5jcmVhdGUoe30pOwoKICAgIEFw
        cC5yZWdpc3RlcignbW9kZWw6dXNlcicsIEFwcC5QZXJzb24sIHtzaW5nbGV0
        b246IGZhbHNlIH0pOwogICAgQXBwLnJlZ2lzdGVyKCdmcnVpdDpmYXZvcml0
        ZScsIEFwcC5PcmFuZ2UpOwogICAgQXBwLnJlZ2lzdGVyKCdjb21tdW5pY2F0
        aW9uOm1haW4nLCBBcHAuRW1haWwsIHtzaW5nbGV0b246IGZhbHNlfSk7CiAg
        ICBBcHAucmVnaXN0ZXIoJ3Nlc3Npb24nLCBBcHAuU2Vzc2lvbiwge2luc3Rh
        bnRpYXRlOiBmYWxzZX0pOwogICAgYGBgCgogICAgQG1ldGhvZCByZWdpc3Rl
        cgogICAgQHBhcmFtICBmdWxsTmFtZSB7U3RyaW5nfSB0eXBlOm5hbWUgKGUu
        Zy4sICdtb2RlbDp1c2VyJykKICAgIEBwYXJhbSAgZmFjdG9yeSB7RnVuY3Rp
        b259IChlLmcuLCBBcHAuUGVyc29uKQogICAgQHBhcmFtICBvcHRpb25zIHtT
        dHJpbmd9IChvcHRpb25hbCkKICAqKi8KICByZWdpc3RlcjogZnVuY3Rpb24o
        KSB7CiAgICB2YXIgY29udGFpbmVyID0gdGhpcy5fX2NvbnRhaW5lcl9fOwog
        ICAgY29udGFpbmVyLnJlZ2lzdGVyLmFwcGx5KGNvbnRhaW5lciwgYXJndW1l
        bnRzKTsKICB9LAogIC8qKgogICAgZGVmaW5lcyBhbiBpbmplY3Rpb24gb3Ig
        dHlwZUluamVjdGlvbgoKICAgIEV4YW1wbGU6CgogICAgYGBgamF2YXNjcmlw
        dAogICAgQXBwLmluamVjdCg8ZnVsbF9uYW1lIG9yIHR5cGU+LCA8cHJvcGVy
        dHkgbmFtZT4sIDxmdWxsX25hbWU+KQogICAgQXBwLmluamVjdCgnbW9kZWw6
        dXNlcicsICdlbWFpbCcsICdtb2RlbDplbWFpbCcpCiAgICBBcHAuaW5qZWN0
        KCdtb2RlbCcsICdzb3VyY2UnLCAnc291cmNlOm1haW4nKQogICAgYGBgCgog
        ICAgQG1ldGhvZCBpbmplY3QKICAgIEBwYXJhbSAgZmFjdG9yeU5hbWVPclR5
        cGUge1N0cmluZ30KICAgIEBwYXJhbSAgcHJvcGVydHkge1N0cmluZ30KICAg
        IEBwYXJhbSAgaW5qZWN0aW9uTmFtZSB7U3RyaW5nfQogICoqLwogIGluamVj
        dDogZnVuY3Rpb24oKSB7CiAgICB2YXIgY29udGFpbmVyID0gdGhpcy5fX2Nv
        bnRhaW5lcl9fOwogICAgY29udGFpbmVyLmluamVjdGlvbi5hcHBseShjb250
        YWluZXIsIGFyZ3VtZW50cyk7CiAgfSwKCiAgLyoqCiAgICBAcHJpdmF0ZQog
        ICAgQGRlcHJlY2F0ZWQKCiAgICBDYWxsaW5nIGluaXRpYWxpemUgbWFudWFs
        bHkgaXMgbm90IHN1cHBvcnRlZC4KCiAgICBQbGVhc2Ugc2VlIEVtYmVyLkFw
        cGxpY2F0aW9uI2FkdmFuY2VSZWFkaW5lc3MgYW5kCiAgICBFbWJlci5BcHBs
        aWNhdGlvbiNkZWZlclJlYWRpbmVzcy4KCiAgICBAbWV0aG9kIGluaXRpYWxp
        emUKICAgKiovCiAgaW5pdGlhbGl6ZTogZnVuY3Rpb24oKSB7CiAgICBFbWJl
        ci5kZXByZWNhdGUoJ0NhbGxpbmcgaW5pdGlhbGl6ZSBtYW51YWxseSBpcyBu
        b3Qgc3VwcG9ydGVkLiBQbGVhc2Ugc2VlIEVtYmVyLkFwcGxpY2F0aW9uI2Fk
        dmFuY2VSZWFkaW5lc3MgYW5kIEVtYmVyLkFwcGxpY2F0aW9uI2RlZmVyUmVh
        ZGluZXNzJyk7CiAgfSwKICAvKioKICAgIEBwcml2YXRlCgogICAgSW5pdGlh
        bGl6ZSB0aGUgYXBwbGljYXRpb24uIFRoaXMgaGFwcGVucyBhdXRvbWF0aWNh
        bGx5LgoKICAgIFJ1biBhbnkgaW5pdGlhbGl6ZXJzIGFuZCBydW4gdGhlIGFw
        cGxpY2F0aW9uIGxvYWQgaG9vay4gVGhlc2UgaG9va3MgbWF5CiAgICBjaG9v
        c2UgdG8gZGVmZXIgcmVhZGluZXNzLiBGb3IgZXhhbXBsZSwgYW4gYXV0aGVu
        dGljYXRpb24gaG9vayBtaWdodCB3YW50CiAgICB0byBkZWZlciByZWFkaW5l
        c3MgdW50aWwgdGhlIGF1dGggdG9rZW4gaGFzIGJlZW4gcmV0cmlldmVkLgoK
        ICAgIEBtZXRob2QgX2luaXRpYWxpemUKICAqLwogIF9pbml0aWFsaXplOiBm
        dW5jdGlvbigpIHsKICAgIGlmICh0aGlzLmlzRGVzdHJveWVkKSB7IHJldHVy
        bjsgfQoKICAgIC8vIEF0IHRoaXMgcG9pbnQsIHRoZSBBcHAuUm91dGVyIG11
        c3QgYWxyZWFkeSBiZSBhc3NpZ25lZAogICAgaWYgKHRoaXMuUm91dGVyKSB7
        CiAgICAgIHRoaXMucmVnaXN0ZXIoJ3JvdXRlcjptYWluJywgdGhpcy5Sb3V0
        ZXIpOwogICAgfQoKICAgIHRoaXMucnVuSW5pdGlhbGl6ZXJzKCk7CiAgICBF
        bWJlci5ydW5Mb2FkSG9va3MoJ2FwcGxpY2F0aW9uJywgdGhpcyk7CgogICAg
        Ly8gQXQgdGhpcyBwb2ludCwgYW55IGluaXRpYWxpemVycyBvciBsb2FkIGhv
        b2tzIHRoYXQgd291bGQgaGF2ZSB3YW50ZWQKICAgIC8vIHRvIGRlZmVyIHJl
        YWRpbmVzcyBoYXZlIGZpcmVkLiBJbiBnZW5lcmFsLCBhZHZhbmNpbmcgcmVh
        ZGluZXNzIGhlcmUKICAgIC8vIHdpbGwgcHJvY2VlZCB0byBkaWRCZWNvbWVS
        ZWFkeS4KICAgIHRoaXMuYWR2YW5jZVJlYWRpbmVzcygpOwoKICAgIHJldHVy
        biB0aGlzOwogIH0sCgogIC8qKgogICAgUmVzZXQgdGhlIGFwcGxpY2F0aW9u
        LiBUaGlzIGlzIHR5cGljYWxseSB1c2VkIG9ubHkgaW4gdGVzdHMuIEl0IGNs
        ZWFucyB1cAogICAgdGhlIGFwcGxpY2F0aW9uIGluIHRoZSBmb2xsb3dpbmcg
        b3JkZXI6CgogICAgMS4gRGVhY3RpdmF0ZSBleGlzdGluZyByb3V0ZXMKICAg
        IDIuIERlc3Ryb3kgYWxsIG9iamVjdHMgaW4gdGhlIGNvbnRhaW5lcgogICAg
        My4gQ3JlYXRlIGEgbmV3IGFwcGxpY2F0aW9uIGNvbnRhaW5lcgogICAgNC4g
        UmUtcm91dGUgdG8gdGhlIGV4aXN0aW5nIHVybAoKICAgIFR5cGljYWwgRXhh
        bXBsZToKCiAgICBgYGBqYXZhc2NyaXB0CgogICAgdmFyIEFwcDsKCiAgICBF
        bWJlci5ydW4oZnVuY3Rpb24oKSB7CiAgICAgIEFwcCA9IEVtYmVyLkFwcGxp
        Y2F0aW9uLmNyZWF0ZSgpOwogICAgfSk7CgogICAgbW9kdWxlKCJhY2NlcHRh
        bmNlIHRlc3QiLCB7CiAgICAgIHNldHVwOiBmdW5jdGlvbigpIHsKICAgICAg
        ICBBcHAucmVzZXQoKTsKICAgICAgfQogICAgfSk7CgogICAgdGVzdCgiZmly
        c3QgdGVzdCIsIGZ1bmN0aW9uKCkgewogICAgICAvLyBBcHAgaXMgZnJlc2hs
        eSByZXNldAogICAgfSk7CgogICAgdGVzdCgiZmlyc3QgdGVzdCIsIGZ1bmN0
        aW9uKCkgewogICAgICAvLyBBcHAgaXMgYWdhaW4gZnJlc2hseSByZXNldAog
        ICAgfSk7CiAgICBgYGAKCiAgICBBZHZhbmNlZCBFeGFtcGxlOgoKICAgIE9j
        Y2FzaW9uYWxseSB5b3UgbWF5IHdhbnQgdG8gcHJldmVudCB0aGUgYXBwIGZy
        b20gaW5pdGlhbGl6aW5nIGR1cmluZwogICAgc2V0dXAuIFRoaXMgY291bGQg
        ZW5hYmxlIGV4dHJhIGNvbmZpZ3VyYXRpb24sIG9yIGVuYWJsZSBhc3NlcnRp
        bmcgcHJpb3IKICAgIHRvIHRoZSBhcHAgYmVjb21pbmcgcmVhZHkuCgogICAg
        YGBgamF2YXNjcmlwdAoKICAgIHZhciBBcHA7CgogICAgRW1iZXIucnVuKGZ1
        bmN0aW9uKCkgewogICAgICBBcHAgPSBFbWJlci5BcHBsaWNhdGlvbi5jcmVh
        dGUoKTsKICAgIH0pOwoKICAgIG1vZHVsZSgiYWNjZXB0YW5jZSB0ZXN0Iiwg
        ewogICAgICBzZXR1cDogZnVuY3Rpb24oKSB7CiAgICAgICAgRW1iZXIucnVu
        KGZ1bmN0aW9uKCkgewogICAgICAgICAgQXBwLnJlc2V0KCk7CiAgICAgICAg
        ICBBcHAuZGVmZXJSZWFkaW5lc3MoKTsKICAgICAgICB9KTsKICAgICAgfQog
        ICAgfSk7CgogICAgdGVzdCgiZmlyc3QgdGVzdCIsIGZ1bmN0aW9uKCkgewog
        ICAgICBvayh0cnVlLCAnc29tZXRoaW5nIGJlZm9yZSBhcHAgaXMgaW5pdGlh
        bGl6ZWQnKTsKCiAgICAgIEVtYmVyLnJ1bihmdW5jdGlvbigpIHsKICAgICAg
        ICBBcHAuYWR2YW5jZVJlYWRpbmVzcygpOwogICAgICB9KTsKICAgICAgb2so
        dHJ1ZSwgJ3NvbWV0aGluZyBhZnRlciBhcHAgaXMgaW5pdGlhbGl6ZWQnKTsK
        ICAgIH0pOwogICAgYGBgCgogICAgQG1ldGhvZCByZXNldAogICoqLwogIHJl
        c2V0OiBmdW5jdGlvbigpIHsKICAgIHRoaXMuX3JlYWRpbmVzc0RlZmVycmFs
        cyA9IDE7CgogICAgZnVuY3Rpb24gaGFuZGxlUmVzZXQoKSB7CiAgICAgIHZh
        ciByb3V0ZXIgPSB0aGlzLl9fY29udGFpbmVyX18ubG9va3VwKCdyb3V0ZXI6
        bWFpbicpOwogICAgICByb3V0ZXIucmVzZXQoKTsKCiAgICAgIEVtYmVyLnJ1
        bih0aGlzLl9fY29udGFpbmVyX18sICdkZXN0cm95Jyk7CgogICAgICB0aGlz
        LmJ1aWxkQ29udGFpbmVyKCk7CgogICAgICBFbWJlci5ydW4uc2NoZWR1bGUo
        J2FjdGlvbnMnLCB0aGlzLCBmdW5jdGlvbigpIHsKICAgICAgICB0aGlzLl9p
        bml0aWFsaXplKCk7CiAgICAgIH0pOwogICAgfQoKICAgIEVtYmVyLnJ1bi5q
        b2luKHRoaXMsIGhhbmRsZVJlc2V0KTsKICB9LAoKICAvKioKICAgIEBwcml2
        YXRlCiAgICBAbWV0aG9kIHJ1bkluaXRpYWxpemVycwogICovCiAgcnVuSW5p
        dGlhbGl6ZXJzOiBmdW5jdGlvbigpIHsKICAgIHZhciBpbml0aWFsaXplcnMg
        PSBnZXQodGhpcy5jb25zdHJ1Y3RvciwgJ2luaXRpYWxpemVycycpLAogICAg
        ICAgIGNvbnRhaW5lciA9IHRoaXMuX19jb250YWluZXJfXywKICAgICAgICBn
        cmFwaCA9IG5ldyBFbWJlci5EQUcoKSwKICAgICAgICBuYW1lc3BhY2UgPSB0
        aGlzLAogICAgICAgIG5hbWUsIGluaXRpYWxpemVyOwoKICAgIGZvciAobmFt
        ZSBpbiBpbml0aWFsaXplcnMpIHsKICAgICAgaW5pdGlhbGl6ZXIgPSBpbml0
        aWFsaXplcnNbbmFtZV07CiAgICAgIGdyYXBoLmFkZEVkZ2VzKGluaXRpYWxp
        emVyLm5hbWUsIGluaXRpYWxpemVyLmluaXRpYWxpemUsIGluaXRpYWxpemVy
        LmJlZm9yZSwgaW5pdGlhbGl6ZXIuYWZ0ZXIpOwogICAgfQoKICAgIGdyYXBo
        LnRvcHNvcnQoZnVuY3Rpb24gKHZlcnRleCkgewogICAgICB2YXIgaW5pdGlh
        bGl6ZXIgPSB2ZXJ0ZXgudmFsdWU7CiAgICAgIEVtYmVyLmFzc2VydCgiTm8g
        YXBwbGljYXRpb24gaW5pdGlhbGl6ZXIgbmFtZWQgJyIrdmVydGV4Lm5hbWUr
        IiciLCBpbml0aWFsaXplcik7CiAgICAgIGluaXRpYWxpemVyKGNvbnRhaW5l
        ciwgbmFtZXNwYWNlKTsKICAgIH0pOwogIH0sCgogIC8qKgogICAgQHByaXZh
        dGUKICAgIEBtZXRob2QgZGlkQmVjb21lUmVhZHkKICAqLwogIGRpZEJlY29t
        ZVJlYWR5OiBmdW5jdGlvbigpIHsKICAgIHRoaXMuc2V0dXBFdmVudERpc3Bh
        dGNoZXIoKTsKICAgIHRoaXMucmVhZHkoKTsgLy8gdXNlciBob29rCiAgICB0
        aGlzLnN0YXJ0Um91dGluZygpOwoKICAgIGlmICghRW1iZXIudGVzdGluZykg
        ewogICAgICAvLyBFYWdlcmx5IG5hbWUgYWxsIGNsYXNzZXMgdGhhdCBhcmUg
        YWxyZWFkeSBsb2FkZWQKICAgICAgRW1iZXIuTmFtZXNwYWNlLnByb2Nlc3NB
        bGwoKTsKICAgICAgRW1iZXIuQk9PVEVEID0gdHJ1ZTsKICAgIH0KCiAgICB0
        aGlzLnJlc29sdmUodGhpcyk7CiAgfSwKCiAgLyoqCiAgICBAcHJpdmF0ZQoK
        ICAgIFNldHVwIHVwIHRoZSBldmVudCBkaXNwYXRjaGVyIHRvIHJlY2VpdmUg
        ZXZlbnRzIG9uIHRoZQogICAgYXBwbGljYXRpb24ncyBgcm9vdEVsZW1lbnRg
        IHdpdGggYW55IHJlZ2lzdGVyZWQKICAgIGBjdXN0b21FdmVudHNgLgoKICAg
        IEBtZXRob2Qgc2V0dXBFdmVudERpc3BhdGNoZXIKICAqLwogIHNldHVwRXZl
        bnREaXNwYXRjaGVyOiBmdW5jdGlvbigpIHsKICAgIHZhciBjdXN0b21FdmVu
        dHMgPSBnZXQodGhpcywgJ2N1c3RvbUV2ZW50cycpLAogICAgICAgIHJvb3RF
        bGVtZW50ID0gZ2V0KHRoaXMsICdyb290RWxlbWVudCcpLAogICAgICAgIGRp
        c3BhdGNoZXIgPSB0aGlzLl9fY29udGFpbmVyX18ubG9va3VwKCdldmVudF9k
        aXNwYXRjaGVyOm1haW4nKTsKCiAgICBzZXQodGhpcywgJ2V2ZW50RGlzcGF0
        Y2hlcicsIGRpc3BhdGNoZXIpOwogICAgZGlzcGF0Y2hlci5zZXR1cChjdXN0
        b21FdmVudHMsIHJvb3RFbGVtZW50KTsKICB9LAoKICAvKioKICAgIEBwcml2
        YXRlCgogICAgdHJpZ2dlciBhIG5ldyBjYWxsIHRvIGByb3V0ZWAgd2hlbmV2
        ZXIgdGhlIFVSTCBjaGFuZ2VzLgogICAgSWYgdGhlIGFwcGxpY2F0aW9uIGhh
        cyBhIHJvdXRlciwgdXNlIGl0IHRvIHJvdXRlIHRvIHRoZSBjdXJyZW50IFVS
        TCwgYW5kCgogICAgQG1ldGhvZCBzdGFydFJvdXRpbmcKICAgIEBwcm9wZXJ0
        eSByb3V0ZXIge0VtYmVyLlJvdXRlcn0KICAqLwogIHN0YXJ0Um91dGluZzog
        ZnVuY3Rpb24oKSB7CiAgICB2YXIgcm91dGVyID0gdGhpcy5fX2NvbnRhaW5l
        cl9fLmxvb2t1cCgncm91dGVyOm1haW4nKTsKICAgIGlmICghcm91dGVyKSB7
        IHJldHVybjsgfQoKICAgIHJvdXRlci5zdGFydFJvdXRpbmcoKTsKICB9LAoK
        ICBoYW5kbGVVUkw6IGZ1bmN0aW9uKHVybCkgewogICAgdmFyIHJvdXRlciA9
        IHRoaXMuX19jb250YWluZXJfXy5sb29rdXAoJ3JvdXRlcjptYWluJyk7Cgog
        ICAgcm91dGVyLmhhbmRsZVVSTCh1cmwpOwogIH0sCgogIC8qKgogICAgQ2Fs
        bGVkIHdoZW4gdGhlIEFwcGxpY2F0aW9uIGhhcyBiZWNvbWUgcmVhZHkuCiAg
        ICBUaGUgY2FsbCB3aWxsIGJlIGRlbGF5ZWQgdW50aWwgdGhlIERPTSBoYXMg
        YmVjb21lIHJlYWR5LgoKICAgIEBldmVudCByZWFkeQogICovCiAgcmVhZHk6
        IEVtYmVyLkssCgogIC8qKgogICAgQGRlcHJlY2F0ZWQgVXNlICdSZXNvbHZl
        cicgaW5zdGVhZAogICAgU2V0IHRoaXMgdG8gcHJvdmlkZSBhbiBhbHRlcm5h
        dGUgY2xhc3MgdG8gYEVtYmVyLkRlZmF1bHRSZXNvbHZlcmAKCgogICAgQHBy
        b3BlcnR5IHJlc29sdmVyCiAgKi8KICByZXNvbHZlcjogbnVsbCwKCiAgLyoq
        CiAgICBTZXQgdGhpcyB0byBwcm92aWRlIGFuIGFsdGVybmF0ZSBjbGFzcyB0
        byBgRW1iZXIuRGVmYXVsdFJlc29sdmVyYAoKICAgIEBwcm9wZXJ0eSByZXNv
        bHZlcgogICovCiAgUmVzb2x2ZXI6IG51bGwsCgogIHdpbGxEZXN0cm95OiBm
        dW5jdGlvbigpIHsKICAgIEVtYmVyLkJPT1RFRCA9IGZhbHNlOwoKICAgIHRo
        aXMuX19jb250YWluZXJfXy5kZXN0cm95KCk7CiAgfSwKCiAgaW5pdGlhbGl6
        ZXI6IGZ1bmN0aW9uKG9wdGlvbnMpIHsKICAgIHRoaXMuY29uc3RydWN0b3Iu
        aW5pdGlhbGl6ZXIob3B0aW9ucyk7CiAgfQp9KTsKCkVtYmVyLkFwcGxpY2F0
        aW9uLnJlb3BlbkNsYXNzKHsKICBpbml0aWFsaXplcnM6IHt9LAogIGluaXRp
        YWxpemVyOiBmdW5jdGlvbihpbml0aWFsaXplcikgewogICAgLy8gSWYgdGhp
        cyBpcyB0aGUgZmlyc3QgaW5pdGlhbGl6ZXIgYmVpbmcgYWRkZWQgdG8gYSBz
        dWJjbGFzcywgd2UgYXJlIGdvaW5nIHRvIHJlb3BlbiB0aGUgY2xhc3MKICAg
        IC8vIHRvIG1ha2Ugc3VyZSB3ZSBoYXZlIGEgbmV3IGBpbml0aWFsaXplcnNg
        IG9iamVjdCwgd2hpY2ggZXh0ZW5kcyBmcm9tIHRoZSBwYXJlbnQgY2xhc3Mn
        IHVzaW5nCiAgICAvLyBwcm90b3R5cGFsIGluaGVyaXRhbmNlLiBXaXRob3V0
        IHRoaXMsIGF0dGVtcHRpbmcgdG8gYWRkIGluaXRpYWxpemVycyB0byB0aGUg
        c3ViY2xhc3Mgd291bGQKICAgIC8vIHBvbGx1dGUgdGhlIHBhcmVudCBjbGFz
        cyBhcyB3ZWxsIGFzIG90aGVyIHN1YmNsYXNzZXMuCiAgICBpZiAodGhpcy5z
        dXBlcmNsYXNzLmluaXRpYWxpemVycyAhPT0gdW5kZWZpbmVkICYmIHRoaXMu
        c3VwZXJjbGFzcy5pbml0aWFsaXplcnMgPT09IHRoaXMuaW5pdGlhbGl6ZXJz
        KSB7CiAgICAgIHRoaXMucmVvcGVuQ2xhc3MoewogICAgICAgIGluaXRpYWxp
        emVyczogRW1iZXIuY3JlYXRlKHRoaXMuaW5pdGlhbGl6ZXJzKQogICAgICB9
        KTsKICAgIH0KCiAgICBFbWJlci5hc3NlcnQoIlRoZSBpbml0aWFsaXplciAn
        IiArIGluaXRpYWxpemVyLm5hbWUgKyAiJyBoYXMgYWxyZWFkeSBiZWVuIHJl
        Z2lzdGVyZWQiLCAhdGhpcy5pbml0aWFsaXplcnNbaW5pdGlhbGl6ZXIubmFt
        ZV0pOwogICAgRW1iZXIuYXNzZXJ0KCJBbiBpbml0aWFsaXplciBjYW5ub3Qg
        YmUgcmVnaXN0ZXJlZCB3aXRoIGJvdGggYSBiZWZvcmUgYW5kIGFuIGFmdGVy
        IiwgIShpbml0aWFsaXplci5iZWZvcmUgJiYgaW5pdGlhbGl6ZXIuYWZ0ZXIp
        KTsKICAgIEVtYmVyLmFzc2VydCgiQW4gaW5pdGlhbGl6ZXIgY2Fubm90IGJl
        IHJlZ2lzdGVyZWQgd2l0aG91dCBhbiBpbml0aWFsaXplIGZ1bmN0aW9uIiwg
        RW1iZXIuY2FuSW52b2tlKGluaXRpYWxpemVyLCAnaW5pdGlhbGl6ZScpKTsK
        CiAgICB0aGlzLmluaXRpYWxpemVyc1tpbml0aWFsaXplci5uYW1lXSA9IGlu
        aXRpYWxpemVyOwogIH0sCgogIC8qKgogICAgQHByaXZhdGUKCiAgICBUaGlz
        IGNyZWF0ZXMgYSBjb250YWluZXIgd2l0aCB0aGUgZGVmYXVsdCBFbWJlciBu
        YW1pbmcgY29udmVudGlvbnMuCgogICAgSXQgYWxzbyBjb25maWd1cmVzIHRo
        ZSBjb250YWluZXI6CgogICAgKiByZWdpc3RlcmVkIHZpZXdzIGFyZSBjcmVh
        dGVkIGV2ZXJ5IHRpbWUgdGhleSBhcmUgbG9va2VkIHVwICh0aGV5IGFyZQog
        ICAgICBub3Qgc2luZ2xldG9ucykKICAgICogcmVnaXN0ZXJlZCB0ZW1wbGF0
        ZXMgYXJlIG5vdCBmYWN0b3JpZXM7IHRoZSByZWdpc3RlcmVkIHZhbHVlIGlz
        CiAgICAgIHJldHVybmVkIGRpcmVjdGx5LgogICAgKiB0aGUgcm91dGVyIHJl
        Y2VpdmVzIHRoZSBhcHBsaWNhdGlvbiBhcyBpdHMgYG5hbWVzcGFjZWAgcHJv
        cGVydHkKICAgICogYWxsIGNvbnRyb2xsZXJzIHJlY2VpdmUgdGhlIHJvdXRl
        ciBhcyB0aGVpciBgdGFyZ2V0YCBhbmQgYGNvbnRyb2xsZXJzYAogICAgICBw
        cm9wZXJ0aWVzCiAgICAqIGFsbCBjb250cm9sbGVycyByZWNlaXZlIHRoZSBh
        cHBsaWNhdGlvbiBhcyB0aGVpciBgbmFtZXNwYWNlYCBwcm9wZXJ0eQogICAg
        KiB0aGUgYXBwbGljYXRpb24gdmlldyByZWNlaXZlcyB0aGUgYXBwbGljYXRp
        b24gY29udHJvbGxlciBhcyBpdHMKICAgICAgYGNvbnRyb2xsZXJgIHByb3Bl
        cnR5CiAgICAqIHRoZSBhcHBsaWNhdGlvbiB2aWV3IHJlY2VpdmVzIHRoZSBh
        cHBsaWNhdGlvbiB0ZW1wbGF0ZSBhcyBpdHMKICAgICAgYGRlZmF1bHRUZW1w
        bGF0ZWAgcHJvcGVydHkKCiAgICBAbWV0aG9kIGJ1aWxkQ29udGFpbmVyCiAg
        ICBAc3RhdGljCiAgICBAcGFyYW0ge0VtYmVyLkFwcGxpY2F0aW9ufSBuYW1l
        c3BhY2UgdGhlIGFwcGxpY2F0aW9uIHRvIGJ1aWxkIHRoZQogICAgICBjb250
        YWluZXIgZm9yLgogICAgQHJldHVybiB7RW1iZXIuQ29udGFpbmVyfSB0aGUg
        YnVpbHQgY29udGFpbmVyCiAgKi8KICBidWlsZENvbnRhaW5lcjogZnVuY3Rp
        b24obmFtZXNwYWNlKSB7CiAgICB2YXIgY29udGFpbmVyID0gbmV3IEVtYmVy
        LkNvbnRhaW5lcigpOwoKICAgIEVtYmVyLkNvbnRhaW5lci5kZWZhdWx0Q29u
        dGFpbmVyID0gbmV3IERlcHJlY2F0ZWRDb250YWluZXIoY29udGFpbmVyKTsK
        CiAgICBjb250YWluZXIuc2V0ID0gRW1iZXIuc2V0OwogICAgY29udGFpbmVy
        LnJlc29sdmVyICA9IHJlc29sdmVyRm9yKG5hbWVzcGFjZSk7CiAgICBjb250
        YWluZXIubm9ybWFsaXplID0gY29udGFpbmVyLnJlc29sdmVyLm5vcm1hbGl6
        ZTsKICAgIGNvbnRhaW5lci5kZXNjcmliZSAgPSBjb250YWluZXIucmVzb2x2
        ZXIuZGVzY3JpYmU7CiAgICBjb250YWluZXIubWFrZVRvU3RyaW5nID0gY29u
        dGFpbmVyLnJlc29sdmVyLm1ha2VUb1N0cmluZzsKCiAgICBjb250YWluZXIu
        b3B0aW9uc0ZvclR5cGUoJ2NvbXBvbmVudCcsIHsgc2luZ2xldG9uOiBmYWxz
        ZSB9KTsKICAgIGNvbnRhaW5lci5vcHRpb25zRm9yVHlwZSgndmlldycsIHsg
        c2luZ2xldG9uOiBmYWxzZSB9KTsKICAgIGNvbnRhaW5lci5vcHRpb25zRm9y
        VHlwZSgndGVtcGxhdGUnLCB7IGluc3RhbnRpYXRlOiBmYWxzZSB9KTsKICAg
        IGNvbnRhaW5lci5yZWdpc3RlcignYXBwbGljYXRpb246bWFpbicsIG5hbWVz
        cGFjZSwgeyBpbnN0YW50aWF0ZTogZmFsc2UgfSk7CgogICAgY29udGFpbmVy
        LnJlZ2lzdGVyKCdjb250cm9sbGVyOmJhc2ljJywgRW1iZXIuQ29udHJvbGxl
        ciwgeyBpbnN0YW50aWF0ZTogZmFsc2UgfSk7CiAgICBjb250YWluZXIucmVn
        aXN0ZXIoJ2NvbnRyb2xsZXI6b2JqZWN0JywgRW1iZXIuT2JqZWN0Q29udHJv
        bGxlciwgeyBpbnN0YW50aWF0ZTogZmFsc2UgfSk7CiAgICBjb250YWluZXIu
        cmVnaXN0ZXIoJ2NvbnRyb2xsZXI6YXJyYXknLCBFbWJlci5BcnJheUNvbnRy
        b2xsZXIsIHsgaW5zdGFudGlhdGU6IGZhbHNlIH0pOwogICAgY29udGFpbmVy
        LnJlZ2lzdGVyKCdyb3V0ZTpiYXNpYycsIEVtYmVyLlJvdXRlLCB7IGluc3Rh
        bnRpYXRlOiBmYWxzZSB9KTsKICAgIGNvbnRhaW5lci5yZWdpc3RlcignZXZl
        bnRfZGlzcGF0Y2hlcjptYWluJywgRW1iZXIuRXZlbnREaXNwYXRjaGVyKTsK
        CiAgICBjb250YWluZXIuaW5qZWN0aW9uKCdyb3V0ZXI6bWFpbicsICduYW1l
        c3BhY2UnLCAnYXBwbGljYXRpb246bWFpbicpOwoKICAgIGNvbnRhaW5lci5p
        bmplY3Rpb24oJ2NvbnRyb2xsZXInLCAndGFyZ2V0JywgJ3JvdXRlcjptYWlu
        Jyk7CiAgICBjb250YWluZXIuaW5qZWN0aW9uKCdjb250cm9sbGVyJywgJ25h
        bWVzcGFjZScsICdhcHBsaWNhdGlvbjptYWluJyk7CgogICAgY29udGFpbmVy
        LmluamVjdGlvbigncm91dGUnLCAncm91dGVyJywgJ3JvdXRlcjptYWluJyk7
        CgogICAgcmV0dXJuIGNvbnRhaW5lcjsKICB9Cn0pOwoKLyoqCiAgQHByaXZh
        dGUKCiAgVGhpcyBmdW5jdGlvbiBkZWZpbmVzIHRoZSBkZWZhdWx0IGxvb2t1
        cCBydWxlcyBmb3IgY29udGFpbmVyIGxvb2t1cHM6CgogICogdGVtcGxhdGVz
        IGFyZSBsb29rZWQgdXAgb24gYEVtYmVyLlRFTVBMQVRFU2AKICAqIG90aGVy
        IG5hbWVzIGFyZSBsb29rZWQgdXAgb24gdGhlIGFwcGxpY2F0aW9uIGFmdGVy
        IGNsYXNzaWZ5aW5nIHRoZSBuYW1lLgogICAgRm9yIGV4YW1wbGUsIGBjb250
        cm9sbGVyOnBvc3RgIGxvb2tzIHVwIGBBcHAuUG9zdENvbnRyb2xsZXJgIGJ5
        IGRlZmF1bHQuCiAgKiBpZiB0aGUgZGVmYXVsdCBsb29rdXAgZmFpbHMsIGxv
        b2sgZm9yIHJlZ2lzdGVyZWQgY2xhc3NlcyBvbiB0aGUgY29udGFpbmVyCgog
        IFRoaXMgYWxsb3dzIHRoZSBhcHBsaWNhdGlvbiB0byByZWdpc3RlciBkZWZh
        dWx0IGluamVjdGlvbnMgaW4gdGhlIGNvbnRhaW5lcgogIHRoYXQgY291bGQg
        YmUgb3ZlcnJpZGRlbiBieSB0aGUgbm9ybWFsIG5hbWluZyBjb252ZW50aW9u
        LgoKICBAbWV0aG9kIHJlc29sdmVyRm9yCiAgQHBhcmFtIHtFbWJlci5OYW1l
        c3BhY2V9IG5hbWVzcGFjZSB0aGUgbmFtZXNwYWNlIHRvIGxvb2sgZm9yIGNs
        YXNzZXMKICBAcmV0dXJuIHsqfSB0aGUgcmVzb2x2ZWQgdmFsdWUgZm9yIGEg
        Z2l2ZW4gbG9va3VwCiovCmZ1bmN0aW9uIHJlc29sdmVyRm9yKG5hbWVzcGFj
        ZSkgewogIGlmIChuYW1lc3BhY2UuZ2V0KCdyZXNvbHZlcicpKSB7CiAgICBF
        bWJlci5kZXByZWNhdGUoJ0FwcGxpY2F0aW9uLnJlc29sdmVyIGlzIGRlcHJl
        Y2F0ZWQgaW4gZmF2b3Igb2YgQXBwbGljYXRpb24uUmVzb2x2ZXInLCBmYWxz
        ZSk7CiAgfQoKICB2YXIgUmVzb2x2ZXJDbGFzcyA9IG5hbWVzcGFjZS5nZXQo
        J3Jlc29sdmVyJykgfHwgbmFtZXNwYWNlLmdldCgnUmVzb2x2ZXInKSB8fCBF
        bWJlci5EZWZhdWx0UmVzb2x2ZXI7CiAgdmFyIHJlc29sdmVyID0gUmVzb2x2
        ZXJDbGFzcy5jcmVhdGUoewogICAgbmFtZXNwYWNlOiBuYW1lc3BhY2UKICB9
        KTsKCiAgZnVuY3Rpb24gcmVzb2x2ZShmdWxsTmFtZSkgewogICAgcmV0dXJu
        IHJlc29sdmVyLnJlc29sdmUoZnVsbE5hbWUpOwogIH0KCiAgcmVzb2x2ZS5k
        ZXNjcmliZSA9IGZ1bmN0aW9uKGZ1bGxOYW1lKSB7CiAgICByZXR1cm4gcmVz
        b2x2ZXIubG9va3VwRGVzY3JpcHRpb24oZnVsbE5hbWUpOwogIH07CgogIHJl
        c29sdmUubWFrZVRvU3RyaW5nID0gZnVuY3Rpb24oZmFjdG9yeSwgZnVsbE5h
        bWUpIHsKICAgIHJldHVybiByZXNvbHZlci5tYWtlVG9TdHJpbmcoZmFjdG9y
        eSwgZnVsbE5hbWUpOwogIH07CgogIHJlc29sdmUubm9ybWFsaXplID0gZnVu
        Y3Rpb24oZnVsbE5hbWUpIHsKICAgIGlmIChyZXNvbHZlci5ub3JtYWxpemUp
        IHsKICAgICAgcmV0dXJuIHJlc29sdmVyLm5vcm1hbGl6ZShmdWxsTmFtZSk7
        CiAgICB9IGVsc2UgewogICAgICBFbWJlci5kZXByZWNhdGUoJ1RoZSBSZXNv
        bHZlciBzaG91bGQgbm93IHByb3ZpZGUgYSBcJ25vcm1hbGl6ZVwnIGZ1bmN0
        aW9uJywgZmFsc2UpOwogICAgICByZXR1cm4gZnVsbE5hbWU7CiAgICB9CiAg
        fTsKCiAgcmV0dXJuIHJlc29sdmU7Cn0KCkVtYmVyLnJ1bkxvYWRIb29rcygn
        RW1iZXIuQXBwbGljYXRpb24nLCBFbWJlci5BcHBsaWNhdGlvbik7Cgp9KSgp
        OwoKCgooZnVuY3Rpb24oKSB7Cgp9KSgpOwoKCgooZnVuY3Rpb24oKSB7Ci8q
        KgpAbW9kdWxlIGVtYmVyCkBzdWJtb2R1bGUgZW1iZXItYXBwbGljYXRpb24K
        Ki8KCnZhciBnZXQgPSBFbWJlci5nZXQsIHNldCA9IEVtYmVyLnNldDsKCmZ1
        bmN0aW9uIHZlcmlmeU5lZWRzRGVwZW5kZW5jaWVzKGNvbnRyb2xsZXIsIGNv
        bnRhaW5lciwgbmVlZHMpIHsKICB2YXIgZGVwZW5kZW5jeSwgaSwgbDsKCiAg
        Zm9yIChpPTAsIGw9bmVlZHMubGVuZ3RoOyBpPGw7IGkrKykgewogICAgZGVw
        ZW5kZW5jeSA9IG5lZWRzW2ldOwogICAgaWYgKGRlcGVuZGVuY3kuaW5kZXhP
        ZignOicpID09PSAtMSkgewogICAgICBkZXBlbmRlbmN5ID0gImNvbnRyb2xs
        ZXI6IiArIGRlcGVuZGVuY3k7CiAgICB9CgogICAgLy8gU3RydWN0dXJlIGFz
        c2VydCB0byBzdGlsbCBkbyB2ZXJpZmljYXRpb24gYnV0IG5vdCBzdHJpbmcg
        Y29uY2F0IGluIHByb2R1Y3Rpb24KICAgIGlmICghY29udGFpbmVyLmhhcyhk
        ZXBlbmRlbmN5KSkgewogICAgICBFbWJlci5hc3NlcnQoRW1iZXIuaW5zcGVj
        dChjb250cm9sbGVyKSArICIgbmVlZHMgIiArIGRlcGVuZGVuY3kgKyAiIGJ1
        dCBpdCBkb2VzIG5vdCBleGlzdCIsIGZhbHNlKTsKICAgIH0KICB9Cn0KCi8q
        KgogIEBjbGFzcyBDb250cm9sbGVyTWl4aW4KICBAbmFtZXNwYWNlIEVtYmVy
        CiovCkVtYmVyLkNvbnRyb2xsZXJNaXhpbi5yZW9wZW4oewogIGNvbmNhdGVu
        YXRlZFByb3BlcnRpZXM6IFsnbmVlZHMnXSwKCiAgLyoqCiAgICBBbiBhcnJh
        eSBvZiBvdGhlciBjb250cm9sbGVyIG9iamVjdHMgYXZhaWxhYmxlIGluc2lk
        ZQogICAgaW5zdGFuY2VzIG9mIHRoaXMgY29udHJvbGxlciB2aWEgdGhlIGBj
        b250cm9sbGVyc2AKICAgIHByb3BlcnR5OgoKICAgIEZvciBleGFtcGxlLCB3
        aGVuIHlvdSBkZWZpbmUgYSBjb250cm9sbGVyOgoKICAgIGBgYGphdmFzY3Jp
        cHQKICAgIEFwcC5Db21tZW50c0NvbnRyb2xsZXIgPSBFbWJlci5BcnJheUNv
        bnRyb2xsZXIuZXh0ZW5kKHsKICAgICAgbmVlZHM6IFsncG9zdCddCiAgICB9
        KTsKICAgIGBgYAoKICAgIFRoZSBhcHBsaWNhdGlvbidzIHNpbmdsZSBpbnN0
        YW5jZSBvZiB0aGVzZSBvdGhlcgogICAgY29udHJvbGxlcnMgYXJlIGFjY2Vz
        c2libGUgYnkgbmFtZSB0aHJvdWdoIHRoZQogICAgYGNvbnRyb2xsZXJzYCBw
        cm9wZXJ0eToKCiAgICBgYGBqYXZhc2NyaXB0CiAgICB0aGlzLmdldCgnY29u
        dHJvbGxlcnMucG9zdCcpOyAvLyBpbnN0YW5jZSBvZiBBcHAuUG9zdENvbnRy
        b2xsZXIKICAgIGBgYAoKICAgIFRoaXMgaXMgb25seSBhdmFpbGFibGUgZm9y
        IHNpbmdsZXRvbiBjb250cm9sbGVycy4KCiAgICBAcHJvcGVydHkge0FycmF5
        fSBuZWVkcwogICAgQGRlZmF1bHQgW10KICAqLwogIG5lZWRzOiBbXSwKCiAg
        aW5pdDogZnVuY3Rpb24oKSB7CiAgICB2YXIgbmVlZHMgPSBnZXQodGhpcywg
        J25lZWRzJyksCiAgICBsZW5ndGggPSBnZXQobmVlZHMsICdsZW5ndGgnKTsK
        CiAgICBpZiAobGVuZ3RoID4gMCkgewogICAgICBFbWJlci5hc3NlcnQoJyBg
        JyArIEVtYmVyLmluc3BlY3QodGhpcykgKyAnIHNwZWNpZmllcyBgbmVlZHNg
        LCBidXQgZG9lcyBub3QgaGF2ZSBhIGNvbnRhaW5lci4gUGxlYXNlIGVuc3Vy
        ZSB0aGlzIGNvbnRyb2xsZXIgd2FzIGluc3RhbnRpYXRlZCB3aXRoIGEgY29u
        dGFpbmVyLicsIHRoaXMuY29udGFpbmVyKTsKCiAgICAgIHZlcmlmeU5lZWRz
        RGVwZW5kZW5jaWVzKHRoaXMsIHRoaXMuY29udGFpbmVyLCBuZWVkcyk7Cgog
        ICAgICAvLyBpZiBuZWVkcyB0aGVuIGluaXRpYWxpemUgY29udHJvbGxlcnMg
        cHJveHkKICAgICAgZ2V0KHRoaXMsICdjb250cm9sbGVycycpOwogICAgfQoK
        ICAgIHRoaXMuX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgfSwK
        CiAgLyoqCiAgICBAbWV0aG9kIGNvbnRyb2xsZXJGb3IKICAgIEBzZWUge0Vt
        YmVyLlJvdXRlI2NvbnRyb2xsZXJGb3J9CiAgICBAZGVwcmVjYXRlZCBVc2Ug
        YG5lZWRzYCBpbnN0ZWFkCiAgKi8KICBjb250cm9sbGVyRm9yOiBmdW5jdGlv
        bihjb250cm9sbGVyTmFtZSkgewogICAgRW1iZXIuZGVwcmVjYXRlKCJDb250
        cm9sbGVyI2NvbnRyb2xsZXJGb3IgaXMgZGVwcmVjYXRlZCwgcGxlYXNlIHVz
        ZSBDb250cm9sbGVyI25lZWRzIGluc3RlYWQiKTsKICAgIHJldHVybiBFbWJl
        ci5jb250cm9sbGVyRm9yKGdldCh0aGlzLCAnY29udGFpbmVyJyksIGNvbnRy
        b2xsZXJOYW1lKTsKICB9LAoKICAvKioKICAgIFN0b3JlcyB0aGUgaW5zdGFu
        Y2VzIG9mIG90aGVyIGNvbnRyb2xsZXJzIGF2YWlsYWJsZSBmcm9tIHdpdGhp
        bgogICAgdGhpcyBjb250cm9sbGVyLiBBbnkgY29udHJvbGxlciBsaXN0ZWQg
        YnkgbmFtZSBpbiB0aGUgYG5lZWRzYAogICAgcHJvcGVydHkgd2lsbCBiZSBh
        Y2Nlc3NpYmxlIGJ5IG5hbWUgdGhyb3VnaCB0aGlzIHByb3BlcnR5LgoKICAg
        IGBgYGphdmFzY3JpcHQKICAgIEFwcC5Db21tZW50c0NvbnRyb2xsZXIgPSBF
        bWJlci5BcnJheUNvbnRyb2xsZXIuZXh0ZW5kKHsKICAgICAgbmVlZHM6IFsn
        cG9zdCddLAogICAgICBwb3N0VGl0bGU6IGZ1bmN0aW9uKCl7CiAgICAgICAg
        dmFyIGN1cnJlbnRQb3N0ID0gdGhpcy5nZXQoJ2NvbnRyb2xsZXJzLnBvc3Qn
        KTsgLy8gaW5zdGFuY2Ugb2YgQXBwLlBvc3RDb250cm9sbGVyCiAgICAgICAg
        cmV0dXJuIGN1cnJlbnRQb3N0LmdldCgndGl0bGUnKTsKICAgICAgfS5wcm9w
        ZXJ0eSgnY29udHJvbGxlcnMucG9zdC50aXRsZScpCiAgICB9KTsKICAgIGBg
        YAoKICAgIEBzZWUge0VtYmVyLkNvbnRyb2xsZXJNaXhpbiNuZWVkc30KICAg
        IEBwcm9wZXJ0eSB7T2JqZWN0fSBjb250cm9sbGVycwogICAgQGRlZmF1bHQg
        bnVsbAogICovCiAgY29udHJvbGxlcnM6IEVtYmVyLmNvbXB1dGVkKGZ1bmN0
        aW9uKCkgewogICAgdmFyIGNvbnRyb2xsZXIgPSB0aGlzOwoKICAgIHJldHVy
        biB7CiAgICAgIG5lZWRzOiBnZXQoY29udHJvbGxlciwgJ25lZWRzJyksCiAg
        ICAgIGNvbnRhaW5lcjogZ2V0KGNvbnRyb2xsZXIsICdjb250YWluZXInKSwK
        ICAgICAgdW5rbm93blByb3BlcnR5OiBmdW5jdGlvbihjb250cm9sbGVyTmFt
        ZSkgewogICAgICAgIHZhciBuZWVkcyA9IHRoaXMubmVlZHMsCiAgICAgICAg
        ICBkZXBlbmRlbmN5LCBpLCBsOwogICAgICAgIGZvciAoaT0wLCBsPW5lZWRz
        Lmxlbmd0aDsgaTxsOyBpKyspIHsKICAgICAgICAgIGRlcGVuZGVuY3kgPSBu
        ZWVkc1tpXTsKICAgICAgICAgIGlmIChkZXBlbmRlbmN5ID09PSBjb250cm9s
        bGVyTmFtZSkgewogICAgICAgICAgICByZXR1cm4gdGhpcy5jb250YWluZXIu
        bG9va3VwKCdjb250cm9sbGVyOicgKyBjb250cm9sbGVyTmFtZSk7CiAgICAg
        ICAgICB9CiAgICAgICAgfQoKICAgICAgICB2YXIgZXJyb3JNZXNzYWdlID0g
        RW1iZXIuaW5zcGVjdChjb250cm9sbGVyKSArICcjbmVlZHMgZG9lcyBub3Qg
        aW5jbHVkZSBgJyArIGNvbnRyb2xsZXJOYW1lICsgJ2AuIFRvIGFjY2VzcyB0
        aGUgJyArIGNvbnRyb2xsZXJOYW1lICsgJyBjb250cm9sbGVyIGZyb20gJyAr
        IEVtYmVyLmluc3BlY3QoY29udHJvbGxlcikgKyAnLCAnICsgRW1iZXIuaW5z
        cGVjdChjb250cm9sbGVyKSArICcgc2hvdWxkIGhhdmUgYSBgbmVlZHNgIHBy
        b3BlcnR5IHRoYXQgaXMgYW4gYXJyYXkgb2YgdGhlIGNvbnRyb2xsZXJzIGl0
        IGhhcyBhY2Nlc3MgdG8uJzsKICAgICAgICB0aHJvdyBuZXcgUmVmZXJlbmNl
        RXJyb3IoZXJyb3JNZXNzYWdlKTsKICAgICAgfQogICAgfTsKICB9KS5yZWFk
        T25seSgpCn0pOwoKfSkoKTsKCgoKKGZ1bmN0aW9uKCkgewoKfSkoKTsKCgoK
        KGZ1bmN0aW9uKCkgewovKioKRW1iZXIgQXBwbGljYXRpb24KCkBtb2R1bGUg
        ZW1iZXIKQHN1Ym1vZHVsZSBlbWJlci1hcHBsaWNhdGlvbgpAcmVxdWlyZXMg
        ZW1iZXItdmlld3MsIGVtYmVyLXJvdXRpbmcKKi8KCn0pKCk7CgooZnVuY3Rp
        b24oKSB7Ci8qKgpAbW9kdWxlIGVtYmVyCkBzdWJtb2R1bGUgZW1iZXItZXh0
        ZW5zaW9uLXN1cHBvcnQKKi8KLyoqCiAgVGhlIGBEYXRhQWRhcHRlcmAgaGVs
        cHMgYSBkYXRhIHBlcnNpc3RlbmNlIGxpYnJhcnkKICBpbnRlcmZhY2Ugd2l0
        aCB0b29scyB0aGF0IGRlYnVnIEVtYmVyIHN1Y2gKICBhcyB0aGUgQ2hyb21l
        IEVtYmVyIEV4dGVuc2lvbi4KCiAgVGhpcyBjbGFzcyB3aWxsIGJlIGV4dGVu
        ZGVkIGJ5IGEgcGVyc2lzdGVuY2UgbGlicmFyeQogIHdoaWNoIHdpbGwgb3Zl
        cnJpZGUgc29tZSBvZiB0aGUgbWV0aG9kcyB3aXRoCiAgbGlicmFyeS1zcGVj
        aWZpYyBjb2RlLgoKICBUaGUgbWV0aG9kcyBsaWtlbHkgdG8gYmUgb3ZlcnJp
        ZGVuIGFyZQogIGBnZXRGaWx0ZXJzYCwgYGRldGVjdGAsIGBjb2x1bW5zRm9y
        VHlwZWAsCiAgYGdldFJlY29yZHNgLCBgZ2V0UmVjb3JkQ29sdW1uVmFsdWVz
        YCwKICBgZ2V0UmVjb3JkS2V5d29yZHNgLCBgZ2V0UmVjb3JkRmlsdGVyVmFs
        dWVzYCwKICBgZ2V0UmVjb3JkQ29sb3JgLCBgb2JzZXJ2ZVJlY29yZGAKCiAg
        VGhlIGFkYXB0ZXIgd2lsbCBuZWVkIHRvIGJlIHJlZ2lzdGVyZWQKICBpbiB0
        aGUgYXBwbGljYXRpb24ncyBjb250YWluZXIgYXMgYGRhdGFBZGFwdGVyOm1h
        aW5gCgogIEV4YW1wbGU6CiAgYGBgamF2YXNjcmlwdAogIEFwcGxpY2F0aW9u
        LmluaXRpYWxpemVyKHsKICAgIG5hbWU6ICJkYXRhQWRhcHRlciIsCgogICAg
        aW5pdGlhbGl6ZTogZnVuY3Rpb24oY29udGFpbmVyLCBhcHBsaWNhdGlvbikg
        ewogICAgICBhcHBsaWNhdGlvbi5yZWdpc3RlcignZGF0YUFkYXB0ZXI6bWFp
        bicsIERTLkRhdGFBZGFwdGVyKTsKICAgIH0KICB9KTsKICBgYGAKCiAgQGNs
        YXNzIERhdGFBZGFwdGVyCiAgQG5hbWVzcGFjZSBFbWJlcgogIEBleHRlbmRz
        IEVtYmVyLk9iamVjdAoqLwpFbWJlci5EYXRhQWRhcHRlciA9IEVtYmVyLk9i
        amVjdC5leHRlbmQoewogIGluaXQ6IGZ1bmN0aW9uKCkgewogICAgdGhpcy5f
        c3VwZXIoKTsKICAgIHRoaXMucmVsZWFzZU1ldGhvZHMgPSBFbWJlci5BKCk7
        CiAgfSwKCiAgLyoqCiAgICBUaGUgY29udGFpbmVyIG9mIHRoZSBhcHBsaWNh
        dGlvbiBiZWluZyBkZWJ1Z2dlZC4KICAgIFRoaXMgcHJvcGVydHkgd2lsbCBi
        ZSBpbmplY3RlZAogICAgb24gY3JlYXRpb24uCiAgKi8KICBjb250YWluZXI6
        IG51bGwsCgogIC8qKgogICAgQHByaXZhdGUKCiAgICBOdW1iZXIgb2YgYXR0
        cmlidXRlcyB0byBzZW5kCiAgICBhcyBjb2x1bW5zLiAoRW5vdWdoIHRvIG1h
        a2UgdGhlIHJlY29yZAogICAgaWRlbnRpZmlhYmxlKS4KICAqLwogIGF0dHJp
        YnV0ZUxpbWl0OiAzLAoKICAvKioKICAgIEBwcml2YXRlCgogICAgU3RvcmVz
        IGFsbCBtZXRob2RzIHRoYXQgY2xlYXIgb2JzZXJ2ZXJzLgogICAgVGhlc2Ug
        bWV0aG9kcyB3aWxsIGJlIGNhbGxlZCBvbiBkZXN0cnVjdGlvbi4KICAqLwog
        IHJlbGVhc2VNZXRob2RzOiBFbWJlci5BKCksCgogIC8qKgogICAgQHB1Ymxp
        YwoKICAgIFNwZWNpZmllcyBob3cgcmVjb3JkcyBjYW4gYmUgZmlsdGVyZWQu
        CiAgICBSZWNvcmRzIHJldHVybmVkIHdpbGwgbmVlZCB0byBoYXZlIGEgYGZp
        bHRlclZhbHVlc2AKICAgIHByb3BlcnR5IHdpdGggYSBrZXkgZm9yIGV2ZXJ5
        IG5hbWUgaW4gdGhlIHJldHVybmVkIGFycmF5LgoKICAgIEBtZXRob2QgZ2V0
        RmlsdGVycwogICAgQHJldHVybiB7QXJyYXl9IExpc3Qgb2Ygb2JqZWN0cyBk
        ZWZpbmluZyBmaWx0ZXJzLgogICAgIFRoZSBvYmplY3Qgc2hvdWxkIGhhdmUg
        YSBgbmFtZWAgYW5kIGBkZXNjYCBwcm9wZXJ0eS4KICAqLwogIGdldEZpbHRl
        cnM6IGZ1bmN0aW9uKCkgewogICAgcmV0dXJuIEVtYmVyLkEoKTsKICB9LAoK
        ICAvKioKICAgIEBwdWJsaWMKCiAgICBGZXRjaCB0aGUgbW9kZWwgdHlwZXMg
        YW5kIG9ic2VydmUgdGhlbSBmb3IgY2hhbmdlcy4KCiAgICBAbWV0aG9kIHdh
        dGNoTW9kZWxUeXBlcwoKICAgIEBwYXJhbSB7RnVuY3Rpb259IHR5cGVzQWRk
        ZWQgQ2FsbGJhY2sgdG8gY2FsbCB0byBhZGQgdHlwZXMuCiAgICBUYWtlcyBh
        biBhcnJheSBvZiBvYmplY3RzIGNvbnRhaW5pbmcgd3JhcHBlZCB0eXBlcyAo
        cmV0dXJuZWQgZnJvbSBgd3JhcE1vZGVsVHlwZWApLgoKICAgIEBwYXJhbSB7
        RnVuY3Rpb259IHR5cGVzVXBkYXRlZCBDYWxsYmFjayB0byBjYWxsIHdoZW4g
        YSB0eXBlIGhhcyBjaGFuZ2VkLgogICAgVGFrZXMgYW4gYXJyYXkgb2Ygb2Jq
        ZWN0cyBjb250YWluaW5nIHdyYXBwZWQgdHlwZXMuCgogICAgQHJldHVybiB7
        RnVuY3Rpb259IE1ldGhvZCB0byBjYWxsIHRvIHJlbW92ZSBhbGwgb2JzZXJ2
        ZXJzCiAgKi8KICB3YXRjaE1vZGVsVHlwZXM6IGZ1bmN0aW9uKHR5cGVzQWRk
        ZWQsIHR5cGVzVXBkYXRlZCkgewogICAgdmFyIG1vZGVsVHlwZXMgPSB0aGlz
        LmdldE1vZGVsVHlwZXMoKSwKICAgICAgICBzZWxmID0gdGhpcywgdHlwZXNU
        b1NlbmQsIHJlbGVhc2VNZXRob2RzID0gRW1iZXIuQSgpOwoKICAgIHR5cGVz
        VG9TZW5kID0gbW9kZWxUeXBlcy5tYXAoZnVuY3Rpb24odHlwZSkgewogICAg
        ICB2YXIgd3JhcHBlZCA9IHNlbGYud3JhcE1vZGVsVHlwZSh0eXBlKTsKICAg
        ICAgcmVsZWFzZU1ldGhvZHMucHVzaChzZWxmLm9ic2VydmVNb2RlbFR5cGUo
        dHlwZSwgdHlwZXNVcGRhdGVkKSk7CiAgICAgIHJldHVybiB3cmFwcGVkOwog
        ICAgfSk7CgogICAgdHlwZXNBZGRlZCh0eXBlc1RvU2VuZCk7CgogICAgdmFy
        IHJlbGVhc2UgPSBmdW5jdGlvbigpIHsKICAgICAgcmVsZWFzZU1ldGhvZHMu
        Zm9yRWFjaChmdW5jdGlvbihmbikgeyBmbigpOyB9KTsKICAgICAgc2VsZi5y
        ZWxlYXNlTWV0aG9kcy5yZW1vdmVPYmplY3QocmVsZWFzZSk7CiAgICB9Owog
        ICAgdGhpcy5yZWxlYXNlTWV0aG9kcy5wdXNoT2JqZWN0KHJlbGVhc2UpOwog
        ICAgcmV0dXJuIHJlbGVhc2U7CiAgfSwKCiAgLyoqCiAgICBAcHVibGljCgog
        ICAgRmV0Y2ggdGhlIHJlY29yZHMgb2YgYSBnaXZlbiB0eXBlIGFuZCBvYnNl
        cnZlIHRoZW0gZm9yIGNoYW5nZXMuCgogICAgQG1ldGhvZCB3YXRjaFJlY29y
        ZHMKCiAgICBAcGFyYW0ge0Z1bmN0aW9ufSByZWNvcmRzQWRkZWQgQ2FsbGJh
        Y2sgdG8gY2FsbCB0byBhZGQgcmVjb3Jkcy4KICAgIFRha2VzIGFuIGFycmF5
        IG9mIG9iamVjdHMgY29udGFpbmluZyB3cmFwcGVkIHJlY29yZHMuCiAgICBU
        aGUgb2JqZWN0IHNob3VsZCBoYXZlIHRoZSBmb2xsb3dpbmcgcHJvcGVydGll
        czoKICAgICAgY29sdW1uVmFsdWVzOiB7T2JqZWN0fSBrZXkgYW5kIHZhbHVl
        IG9mIGEgdGFibGUgY2VsbAogICAgICBvYmplY3Q6IHtPYmplY3R9IHRoZSBh
        Y3R1YWwgcmVjb3JkIG9iamVjdAoKICAgIEBwYXJhbSB7RnVuY3Rpb259IHJl
        Y29yZHNVcGRhdGVkIENhbGxiYWNrIHRvIGNhbGwgd2hlbiBhIHJlY29yZCBo
        YXMgY2hhbmdlZC4KICAgIFRha2VzIGFuIGFycmF5IG9mIG9iamVjdHMgY29u
        dGFpbmluZyB3cmFwcGVkIHJlY29yZHMuCgogICAgQHBhcmFtIHtGdW5jdGlv
        bn0gcmVjb3Jkc1JlbW92ZWQgQ2FsbGJhY2sgdG8gY2FsbCB3aGVuIGEgcmVj
        b3JkIGhhcyByZW1vdmVkLgogICAgVGFrZXMgdGhlIGZvbGxvd2luZyBwYXJh
        bWV0ZXJzOgogICAgICBpbmRleDogdGhlIGFycmF5IGluZGV4IHdoZXJlIHRo
        ZSByZWNvcmRzIHdlcmUgcmVtb3ZlZAogICAgICBjb3VudDogdGhlIG51bWJl
        ciBvZiByZWNvcmRzIHJlbW92ZWQKCiAgICBAcmV0dXJuIHtGdW5jdGlvbn0g
        TWV0aG9kIHRvIGNhbGwgdG8gcmVtb3ZlIGFsbCBvYnNlcnZlcnMKICAqLwog
        IHdhdGNoUmVjb3JkczogZnVuY3Rpb24odHlwZSwgcmVjb3Jkc0FkZGVkLCBy
        ZWNvcmRzVXBkYXRlZCwgcmVjb3Jkc1JlbW92ZWQpIHsKICAgIHZhciBzZWxm
        ID0gdGhpcywgcmVsZWFzZU1ldGhvZHMgPSBFbWJlci5BKCksIHJlY29yZHMg
        PSB0aGlzLmdldFJlY29yZHModHlwZSksIHJlbGVhc2U7CgogICAgdmFyIHJl
        Y29yZFVwZGF0ZWQgPSBmdW5jdGlvbih1cGRhdGVkUmVjb3JkKSB7CiAgICAg
        IHJlY29yZHNVcGRhdGVkKFt1cGRhdGVkUmVjb3JkXSk7CiAgICB9OwoKICAg
        IHZhciByZWNvcmRzVG9TZW5kID0gcmVjb3Jkcy5tYXAoZnVuY3Rpb24ocmVj
        b3JkKSB7CiAgICAgIHJlbGVhc2VNZXRob2RzLnB1c2goc2VsZi5vYnNlcnZl
        UmVjb3JkKHJlY29yZCwgcmVjb3JkVXBkYXRlZCkpOwogICAgICByZXR1cm4g
        c2VsZi53cmFwUmVjb3JkKHJlY29yZCk7CiAgICB9KTsKCgogICAgdmFyIGNv
        bnRlbnREaWRDaGFuZ2UgPSBmdW5jdGlvbihhcnJheSwgaWR4LCByZW1vdmVk
        Q291bnQsIGFkZGVkQ291bnQpIHsKICAgICAgZm9yICh2YXIgaSA9IGlkeDsg
        aSA8IGlkeCArIGFkZGVkQ291bnQ7IGkrKykgewogICAgICAgIHZhciByZWNv
        cmQgPSBhcnJheS5vYmplY3RBdChpKTsKICAgICAgICB2YXIgd3JhcHBlZCA9
        IHNlbGYud3JhcFJlY29yZChyZWNvcmQpOwogICAgICAgIHJlbGVhc2VNZXRo
        b2RzLnB1c2goc2VsZi5vYnNlcnZlUmVjb3JkKHJlY29yZCwgcmVjb3JkVXBk
        YXRlZCkpOwogICAgICAgIHJlY29yZHNBZGRlZChbd3JhcHBlZF0pOwogICAg
        ICB9CgogICAgICBpZiAocmVtb3ZlZENvdW50KSB7CiAgICAgICAgcmVjb3Jk
        c1JlbW92ZWQoaWR4LCByZW1vdmVkQ291bnQpOwogICAgICB9CiAgICB9OwoK
        ICAgIHZhciBvYnNlcnZlciA9IHsgZGlkQ2hhbmdlOiBjb250ZW50RGlkQ2hh
        bmdlLCB3aWxsQ2hhbmdlOiBFbWJlci5LIH07CiAgICByZWNvcmRzLmFkZEFy
        cmF5T2JzZXJ2ZXIoc2VsZiwgb2JzZXJ2ZXIpOwoKICAgIHJlbGVhc2UgPSBm
        dW5jdGlvbigpIHsKICAgICAgcmVsZWFzZU1ldGhvZHMuZm9yRWFjaChmdW5j
        dGlvbihmbikgeyBmbigpOyB9KTsKICAgICAgcmVjb3Jkcy5yZW1vdmVBcnJh
        eU9ic2VydmVyKHNlbGYsIG9ic2VydmVyKTsKICAgICAgc2VsZi5yZWxlYXNl
        TWV0aG9kcy5yZW1vdmVPYmplY3QocmVsZWFzZSk7CiAgICB9OwoKICAgIHJl
        Y29yZHNBZGRlZChyZWNvcmRzVG9TZW5kKTsKCiAgICB0aGlzLnJlbGVhc2VN
        ZXRob2RzLnB1c2hPYmplY3QocmVsZWFzZSk7CiAgICByZXR1cm4gcmVsZWFz
        ZTsKICB9LAoKICAvKioKICAgIEBwcml2YXRlCgogICAgQ2xlYXIgYWxsIG9i
        c2VydmVycyBiZWZvcmUgZGVzdHJ1Y3Rpb24KICAqLwogIHdpbGxEZXN0cm95
        OiBmdW5jdGlvbigpIHsKICAgIHRoaXMuX3N1cGVyKCk7CiAgICB0aGlzLnJl
        bGVhc2VNZXRob2RzLmZvckVhY2goZnVuY3Rpb24oZm4pIHsKICAgICAgZm4o
        KTsKICAgIH0pOwogIH0sCgogIC8qKgogICAgQHByaXZhdGUKCiAgICBEZXRl
        Y3Qgd2hldGhlciBhIGNsYXNzIGlzIGEgbW9kZWwuCgogICAgVGVzdCB0aGF0
        IGFnYWluc3QgdGhlIG1vZGVsIGNsYXNzCiAgICBvZiB5b3VyIHBlcnNpc3Rl
        bmNlIGxpYnJhcnkKCiAgICBAbWV0aG9kIGRldGVjdAogICAgQHBhcmFtIHtD
        bGFzc30ga2xhc3MgVGhlIGNsYXNzIHRvIHRlc3QKICAgIEByZXR1cm4gYm9v
        bGVhbiBXaGV0aGVyIHRoZSBjbGFzcyBpcyBhIG1vZGVsIGNsYXNzIG9yIG5v
        dAogICovCiAgZGV0ZWN0OiBmdW5jdGlvbihrbGFzcykgewogICAgcmV0dXJu
        IGZhbHNlOwogIH0sCgogIC8qKgogICAgQHByaXZhdGUKCiAgICBHZXQgdGhl
        IGNvbHVtbnMgZm9yIGEgZ2l2ZW4gbW9kZWwgdHlwZS4KCiAgICBAbWV0aG9k
        IGNvbHVtbnNGb3JUeXBlCiAgICBAcGFyYW0ge0NsYXNzfSB0eXBlIFRoZSBt
        b2RlbCB0eXBlCiAgICBAcmV0dXJuIHtBcnJheX0gQW4gYXJyYXkgb2YgY29s
        dW1ucyBvZiB0aGUgZm9sbG93aW5nIGZvcm1hdDoKICAgICBuYW1lOiB7U3Ry
        aW5nfSBuYW1lIG9mIHRoZSBjb2x1bW4KICAgICBkZXNjOiB7U3RyaW5nfSBI
        dW1hbml6ZWQgZGVzY3JpcHRpb24gKHdoYXQgd291bGQgc2hvdyBpbiBhIHRh
        YmxlIGNvbHVtbiBuYW1lKQogICovCiAgY29sdW1uc0ZvclR5cGU6IGZ1bmN0
        aW9uKHR5cGUpIHsKICAgIHJldHVybiBFbWJlci5BKCk7CiAgfSwKCiAgLyoq
        CiAgICBAcHJpdmF0ZQoKICAgIEFkZHMgb2JzZXJ2ZXJzIHRvIGEgbW9kZWwg
        dHlwZSBjbGFzcy4KCiAgICBAbWV0aG9kIG9ic2VydmVNb2RlbFR5cGUKICAg
        IEBwYXJhbSB7Q2xhc3N9IHR5cGUgVGhlIG1vZGVsIHR5cGUgY2xhc3MKICAg
        IEBwYXJhbSB7RnVuY3Rpb259IHR5cGVzVXBkYXRlZCBDYWxsZWQgd2hlbiBh
        IHR5cGUgaXMgbW9kaWZpZWQuCiAgICBAcmV0dXJuIHtGdW5jdGlvbn0gVGhl
        IGZ1bmN0aW9uIHRvIGNhbGwgdG8gcmVtb3ZlIG9ic2VydmVycwogICovCgog
        IG9ic2VydmVNb2RlbFR5cGU6IGZ1bmN0aW9uKHR5cGUsIHR5cGVzVXBkYXRl
        ZCkgewogICAgdmFyIHNlbGYgPSB0aGlzLCByZWNvcmRzID0gdGhpcy5nZXRS
        ZWNvcmRzKHR5cGUpOwoKICAgIHZhciBvbkNoYW5nZSA9IGZ1bmN0aW9uKCkg
        ewogICAgICB0eXBlc1VwZGF0ZWQoW3NlbGYud3JhcE1vZGVsVHlwZSh0eXBl
        KV0pOwogICAgfTsKICAgIHZhciBvYnNlcnZlciA9IHsKICAgICAgZGlkQ2hh
        bmdlOiBmdW5jdGlvbigpIHsKICAgICAgICBFbWJlci5ydW4uc2NoZWR1bGVP
        bmNlKCdhY3Rpb25zJywgdGhpcywgb25DaGFuZ2UpOwogICAgICB9LAogICAg
        ICB3aWxsQ2hhbmdlOiBFbWJlci5LCiAgICB9OwoKICAgIHJlY29yZHMuYWRk
        QXJyYXlPYnNlcnZlcih0aGlzLCBvYnNlcnZlcik7CgogICAgdmFyIHJlbGVh
        c2UgPSBmdW5jdGlvbigpIHsKICAgICAgcmVjb3Jkcy5yZW1vdmVBcnJheU9i
        c2VydmVyKHNlbGYsIG9ic2VydmVyKTsKICAgIH07CgogICAgcmV0dXJuIHJl
        bGVhc2U7CiAgfSwKCgogIC8qKgogICAgQHByaXZhdGUKCiAgICBXcmFwcyBh
        IGdpdmVuIG1vZGVsIHR5cGUgYW5kIG9ic2VydmVzIGNoYW5nZXMgdG8gaXQu
        CgogICAgQG1ldGhvZCB3cmFwTW9kZWxUeXBlCiAgICBAcGFyYW0ge0NsYXNz
        fSB0eXBlIEEgbW9kZWwgY2xhc3MKICAgIEBwYXJhbSB7RnVuY3Rpb259IHR5
        cGVzVXBkYXRlZCBjYWxsYmFjayB0byBjYWxsIHdoZW4gdGhlIHR5cGUgY2hh
        bmdlcwogICAgQHJldHVybiB7T2JqZWN0fSBjb250YWlucyB0aGUgd3JhcHBl
        ZCB0eXBlIGFuZCB0aGUgZnVuY3Rpb24gdG8gcmVtb3ZlIG9ic2VydmVycwog
        ICAgRm9ybWF0OgogICAgICB0eXBlOiB7T2JqZWN0fSB0aGUgd3JhcHBlZCB0
        eXBlCiAgICAgICAgVGhlIHdyYXBwZWQgdHlwZSBoYXMgdGhlIGZvbGxvd2lu
        ZyBmb3JtYXQ6CiAgICAgICAgICBuYW1lOiB7U3RyaW5nfSBuYW1lIG9mIHRo
        ZSB0eXBlCiAgICAgICAgICBjb3VudDoge0ludGVnZXJ9IG51bWJlciBvZiBy
        ZWNvcmRzIGF2YWlsYWJsZQogICAgICAgICAgY29sdW1uczoge0NvbHVtbnN9
        IGFycmF5IG9mIGNvbHVtbnMgdG8gZGVzY3JpYmUgdGhlIHJlY29yZAogICAg
        ICAgICAgb2JqZWN0OiB7Q2xhc3N9IHRoZSBhY3R1YWwgTW9kZWwgdHlwZSBj
        bGFzcwogICAgICByZWxlYXNlOiB7RnVuY3Rpb259IFRoZSBmdW5jdGlvbiB0
        byByZW1vdmUgb2JzZXJ2ZXJzCiAgKi8KICB3cmFwTW9kZWxUeXBlOiBmdW5j
        dGlvbih0eXBlLCB0eXBlc1VwZGF0ZWQpIHsKICAgIHZhciByZWxlYXNlLCBy
        ZWNvcmRzID0gdGhpcy5nZXRSZWNvcmRzKHR5cGUpLAogICAgICAgIHR5cGVU
        b1NlbmQsIHNlbGYgPSB0aGlzOwoKICAgIHR5cGVUb1NlbmQgPSB7CiAgICAg
        IG5hbWU6IHR5cGUudG9TdHJpbmcoKSwKICAgICAgY291bnQ6IEVtYmVyLmdl
        dChyZWNvcmRzLCAnbGVuZ3RoJyksCiAgICAgIGNvbHVtbnM6IHRoaXMuY29s
        dW1uc0ZvclR5cGUodHlwZSksCiAgICAgIG9iamVjdDogdHlwZQogICAgfTsK
        CgogICAgcmV0dXJuIHR5cGVUb1NlbmQ7CiAgfSwKCgogIC8qKgogICAgQHBy
        aXZhdGUKCiAgICBGZXRjaGVzIGFsbCBtb2RlbHMgZGVmaW5lZCBpbiB0aGUg
        YXBwbGljYXRpb24uCiAgICBUT0RPOiBVc2UgdGhlIHJlc29sdmVyIGluc3Rl
        YWQgb2YgbG9vcGluZyBvdmVyIG5hbWVzcGFjZXMuCgogICAgQG1ldGhvZCBn
        ZXRNb2RlbFR5cGVzCiAgICBAcmV0dXJuIHtBcnJheX0gQXJyYXkgb2YgbW9k
        ZWwgdHlwZXMKICAqLwogIGdldE1vZGVsVHlwZXM6IGZ1bmN0aW9uKCkgewog
        ICAgdmFyIG5hbWVzcGFjZXMgPSBFbWJlci5BKEVtYmVyLk5hbWVzcGFjZS5O
        QU1FU1BBQ0VTKSwgdHlwZXMgPSBFbWJlci5BKCksIHNlbGYgPSB0aGlzOwoK
        ICAgIG5hbWVzcGFjZXMuZm9yRWFjaChmdW5jdGlvbihuYW1lc3BhY2UpIHsK
        ICAgICAgZm9yICh2YXIga2V5IGluIG5hbWVzcGFjZSkgewogICAgICAgIGlm
        ICghbmFtZXNwYWNlLmhhc093blByb3BlcnR5KGtleSkpIHsgY29udGludWU7
        IH0KICAgICAgICB2YXIga2xhc3MgPSBuYW1lc3BhY2Vba2V5XTsKICAgICAg
        ICBpZiAoc2VsZi5kZXRlY3Qoa2xhc3MpKSB7CiAgICAgICAgICB0eXBlcy5w
        dXNoKGtsYXNzKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0pOwogICAgcmV0
        dXJuIHR5cGVzOwogIH0sCgogIC8qKgogICAgQHByaXZhdGUKCiAgICBGZXRj
        aGVzIGFsbCBsb2FkZWQgcmVjb3JkcyBmb3IgYSBnaXZlbiB0eXBlLgoKICAg
        IEBtZXRob2QgZ2V0UmVjb3JkcwogICAgQHJldHVybiB7QXJyYXl9IGFycmF5
        IG9mIHJlY29yZHMuCiAgICAgVGhpcyBhcnJheSB3aWxsIGJlIG9ic2VydmVk
        IGZvciBjaGFuZ2VzLAogICAgIHNvIGl0IHNob3VsZCB1cGRhdGUgd2hlbiBu
        ZXcgcmVjb3JkcyBhcmUgYWRkZWQvcmVtb3ZlZC4KICAqLwogIGdldFJlY29y
        ZHM6IGZ1bmN0aW9uKHR5cGUpIHsKICAgIHJldHVybiBFbWJlci5BKCk7CiAg
        fSwKCiAgLyoqCiAgICBAcHJpdmF0ZQoKICAgIFdyYXBzIGEgcmVjb3JkIGFu
        ZCBvYnNlcnZlcnMgY2hhbmdlcyB0byBpdAoKICAgIEBtZXRob2Qgd3JhcFJl
        Y29yZAogICAgQHBhcmFtIHtPYmplY3R9IHJlY29yZCBUaGUgcmVjb3JkIGlu
        c3RhbmNlCiAgICBAcmV0dXJuIHtPYmplY3R9IHRoZSB3cmFwcGVkIHJlY29y
        ZC4gRm9ybWF0OgogICAgY29sdW1uVmFsdWVzOiB7QXJyYXl9CiAgICBzZWFy
        Y2hLZXl3b3Jkczoge0FycmF5fQogICovCiAgd3JhcFJlY29yZDogZnVuY3Rp
        b24ocmVjb3JkKSB7CiAgICB2YXIgcmVjb3JkVG9TZW5kID0geyBvYmplY3Q6
        IHJlY29yZCB9LCBjb2x1bW5WYWx1ZXMgPSB7fSwgc2VsZiA9IHRoaXM7Cgog
        ICAgcmVjb3JkVG9TZW5kLmNvbHVtblZhbHVlcyA9IHRoaXMuZ2V0UmVjb3Jk
        Q29sdW1uVmFsdWVzKHJlY29yZCk7CiAgICByZWNvcmRUb1NlbmQuc2VhcmNo
        S2V5d29yZHMgPSB0aGlzLmdldFJlY29yZEtleXdvcmRzKHJlY29yZCk7CiAg
        ICByZWNvcmRUb1NlbmQuZmlsdGVyVmFsdWVzID0gdGhpcy5nZXRSZWNvcmRG
        aWx0ZXJWYWx1ZXMocmVjb3JkKTsKICAgIHJlY29yZFRvU2VuZC5jb2xvciA9
        IHRoaXMuZ2V0UmVjb3JkQ29sb3IocmVjb3JkKTsKCiAgICByZXR1cm4gcmVj
        b3JkVG9TZW5kOwogIH0sCgogIC8qKgogICAgQHByaXZhdGUKCiAgICBHZXRz
        IHRoZSB2YWx1ZXMgZm9yIGVhY2ggY29sdW1uLgoKICAgIEBtZXRob2QgZ2V0
        UmVjb3JkQ29sdW1uVmFsdWVzCiAgICBAcmV0dXJuIHtPYmplY3R9IEtleXMg
        c2hvdWxkIG1hdGNoIGNvbHVtbiBuYW1lcyBkZWZpbmVkCiAgICBieSB0aGUg
        bW9kZWwgdHlwZS4KICAqLwogIGdldFJlY29yZENvbHVtblZhbHVlczogZnVu
        Y3Rpb24ocmVjb3JkKSB7CiAgICByZXR1cm4ge307CiAgfSwKCiAgLyoqCiAg
        ICBAcHJpdmF0ZQoKICAgIFJldHVybnMga2V5d29yZHMgdG8gbWF0Y2ggd2hl
        biBzZWFyY2hpbmcgcmVjb3Jkcy4KCiAgICBAbWV0aG9kIGdldFJlY29yZEtl
        eXdvcmRzCiAgICBAcmV0dXJuIHtBcnJheX0gUmVsZXZhbnQga2V5d29yZHMg
        Zm9yIHNlYXJjaC4KICAqLwogIGdldFJlY29yZEtleXdvcmRzOiBmdW5jdGlv
        bihyZWNvcmQpIHsKICAgIHJldHVybiBFbWJlci5BKCk7CiAgfSwKCiAgLyoq
        CiAgICBAcHJpdmF0ZQoKICAgIFJldHVybnMgdGhlIHZhbHVlcyBvZiBmaWx0
        ZXJzIGRlZmluZWQgYnkgYGdldEZpbHRlcnNgLgoKICAgIEBtZXRob2QgZ2V0
        UmVjb3JkRmlsdGVyVmFsdWVzCiAgICBAcGFyYW0ge09iamVjdH0gcmVjb3Jk
        IFRoZSByZWNvcmQgaW5zdGFuY2UKICAgIEByZXR1cm4ge09iamVjdH0gVGhl
        IGZpbHRlciB2YWx1ZXMKICAqLwogIGdldFJlY29yZEZpbHRlclZhbHVlczog
        ZnVuY3Rpb24ocmVjb3JkKSB7CiAgICByZXR1cm4ge307CiAgfSwKCiAgLyoq
        CiAgICBAcHJpdmF0ZQoKICAgIEVhY2ggcmVjb3JkIGNhbiBoYXZlIGEgY29s
        b3IgdGhhdCByZXByZXNlbnRzIGl0cyBzdGF0ZS4KCiAgICBAbWV0aG9kIGdl
        dFJlY29yZENvbG9yCiAgICBAcGFyYW0ge09iamVjdH0gcmVjb3JkIFRoZSBy
        ZWNvcmQgaW5zdGFuY2UKICAgIEByZXR1cm4ge1N0cmluZ30gVGhlIHJlY29y
        ZCdzIGNvbG9yCiAgICAgIFBvc3NpYmxlIG9wdGlvbnM6IGJsYWNrLCByZWQs
        IGJsdWUsIGdyZWVuCiAgKi8KICBnZXRSZWNvcmRDb2xvcjogZnVuY3Rpb24o
        cmVjb3JkKSB7CiAgICByZXR1cm4gbnVsbDsKICB9LAoKICAvKioKICAgIEBw
        cml2YXRlCgogICAgT2JzZXJ2ZXMgYWxsIHJlbGV2YW50IHByb3BlcnRpZXMg
        YW5kIHJlLXNlbmRzIHRoZSB3cmFwcGVkIHJlY29yZAogICAgd2hlbiBhIGNo
        YW5nZSBvY2N1cnMuCgogICAgQG1ldGhvZCBvYnNlcnZlclJlY29yZAogICAg
        QHBhcmFtIHtPYmplY3R9IHJlY29yZCBUaGUgcmVjb3JkIGluc3RhbmNlCiAg
        ICBAcGFyYW0ge0Z1bmN0aW9ufSByZWNvcmRVcGRhdGVkIFRoZSBjYWxsYmFj
        ayB0byBjYWxsIHdoZW4gYSByZWNvcmQgaXMgdXBkYXRlZC4KICAgIEByZXR1
        cm4ge0Z1bmN0aW9ufSBUaGUgZnVuY3Rpb24gdG8gY2FsbCB0byByZW1vdmUg
        YWxsIG9ic2VydmVycy4KICAqLwogIG9ic2VydmVSZWNvcmQ6IGZ1bmN0aW9u
        KHJlY29yZCwgcmVjb3JkVXBkYXRlZCkgewogICAgcmV0dXJuIGZ1bmN0aW9u
        KCl7fTsKICB9Cgp9KTsKCgp9KSgpOwoKCgooZnVuY3Rpb24oKSB7Ci8qKgpF
        bWJlciBFeHRlbnNpb24gU3VwcG9ydAoKQG1vZHVsZSBlbWJlcgpAc3VibW9k
        dWxlIGVtYmVyLWV4dGVuc2lvbi1zdXBwb3J0CkByZXF1aXJlcyBlbWJlci1h
        cHBsaWNhdGlvbgoqLwoKfSkoKTsKCihmdW5jdGlvbigpIHsKLyoqCiAgQG1v
        ZHVsZSBlbWJlcgogIEBzdWJtb2R1bGUgZW1iZXItdGVzdGluZwogKi8KdmFy
        IHNsaWNlID0gW10uc2xpY2UsCiAgICBoZWxwZXJzID0ge30sCiAgICBvcmln
        aW5hbE1ldGhvZHMgPSB7fSwKICAgIGluamVjdEhlbHBlcnNDYWxsYmFja3Mg
        PSBbXTsKCi8qKgogIFRoaXMgaXMgYSBjb250YWluZXIgZm9yIGFuIGFzc29y
        dG1lbnQgb2YgdGVzdGluZyByZWxhdGVkIGZ1bmN0aW9uYWxpdHk6CgogICog
        Q2hvb3NlIHlvdXIgZGVmYXVsdCB0ZXN0IGFkYXB0ZXIgKGZvciB5b3VyIGZy
        YW1ld29yayBvZiBjaG9pY2UpLgogICogUmVnaXN0ZXIvVW5yZWdpc3RlciBh
        ZGRpdGlvbmFsIHRlc3QgaGVscGVycy4KICAqIFNldHVwIGNhbGxiYWNrcyB0
        byBiZSBmaXJlZCB3aGVuIHRoZSB0ZXN0IGhlbHBlcnMgYXJlIGluamVjdGVk
        IGludG8KICAgIHlvdXIgYXBwbGljYXRpb24uCiAgCiAgQGNsYXNzIFRlc3QK
        ICBAbmFtZXNwYWNlIEVtYmVyCiovCkVtYmVyLlRlc3QgPSB7CgogIC8qKgog
        ICAgYHJlZ2lzdGVySGVscGVyYCBpcyB1c2VkIHRvIHJlZ2lzdGVyIGEgdGVz
        dCBoZWxwZXIgdGhhdCB3aWxsIGJlIGluamVjdGVkCiAgICB3aGVuIGBBcHAu
        aW5qZWN0VGVzdEhlbHBlcnNgIGlzIGNhbGxlZC4KCiAgICBUaGUgaGVscGVy
        IG1ldGhvZCB3aWxsIGFsd2F5cyBiZSBjYWxsZWQgd2l0aCB0aGUgY3VycmVu
        dCBBcHBsaWNhdGlvbiBhcwogICAgdGhlIGZpcnN0IHBhcmFtZXRlci4KCiAg
        ICBGb3IgZXhhbXBsZToKICAgIGBgYGphdmFzY3JpcHQKICAgICAgRW1iZXIu
        VGVzdC5yZWdpc3RlckhlbHBlcignYm9vdCcsIGZ1bmN0aW9uKGFwcCkgewog
        ICAgICAgIEVtYmVyLnJ1bihhcHAsIGFwcC5kZWZlclJlYWRpbmVzcyk7CiAg
        ICAgIH0pOwogICAgYGBgCgogICAgVGhpcyBoZWxwZXIgY2FuIGxhdGVyIGJl
        IGNhbGxlZCB3aXRob3V0IGFyZ3VtZW50cyBiZWNhdXNlIGl0IHdpbGwgYmUK
        ICAgIGNhbGxlZCB3aXRoIGBhcHBgIGFzIHRoZSBmaXJzdCBwYXJhbWV0ZXIu
        CgogICAgYGBgamF2YXNjcmlwdAogICAgICBBcHAgPSBFbWJlci5BcHBsaWNh
        dGlvbi5jcmVhdGUoKTsKICAgICAgQXBwLmluamVjdFRlc3RIZWxwZXJzKCk7
        CiAgICAgIGJvb3QoKTsKICAgIGBgYAoKICAgIFdoZW5ldmVyIHlvdSByZWdp
        c3RlciBhIGhlbHBlciB0aGF0IHBlcmZvcm1zIGFzeW5jIG9wZXJhdGlvbnMs
        IG1ha2Ugc3VyZQogICAgeW91IGByZXR1cm4gd2FpdCgpO2AgYXQgdGhlIGVu
        ZCBvZiB0aGUgaGVscGVyLgoKICAgIElmIGFuIGFzeW5jIGhlbHBlciBhbHNv
        IG5lZWRzIHRvIHJldHVybiBhIHZhbHVlLCBwYXNzIGl0IHRvIHRoZSBgd2Fp
        dGAKICAgIGhlbHBlciBhcyBhIGZpcnN0IGFyZ3VtZW50OgogICAgYHJldHVy
        biB3YWl0KHZhbCk7YAoKICAgIEBwdWJsaWMKICAgIEBtZXRob2QgcmVnaXN0
        ZXJIZWxwZXIKICAgIEBwYXJhbSB7U3RyaW5nfSBuYW1lIFRoZSBuYW1lIG9m
        IHRoZSBoZWxwZXIgbWV0aG9kIHRvIGFkZC4KICAgIEBwYXJhbSB7RnVuY3Rp
        b259IGhlbHBlck1ldGhvZAogICovCiAgcmVnaXN0ZXJIZWxwZXI6IGZ1bmN0
        aW9uKG5hbWUsIGhlbHBlck1ldGhvZCkgewogICAgaGVscGVyc1tuYW1lXSA9
        IGhlbHBlck1ldGhvZDsKICB9LAogIC8qKgogICAgUmVtb3ZlIGEgcHJldmlv
        dXNseSBhZGRlZCBoZWxwZXIgbWV0aG9kLgoKICAgIEV4YW1wbGU6CiAgICBg
        YGAKICAgIEVtYmVyLlRlc3QudW5yZWdpc3RlckhlbHBlcignd2FpdCcpOwog
        ICAgYGBgCgogICAgQHB1YmxpYwogICAgQG1ldGhvZCB1bnJlZ2lzdGVySGVs
        cGVyCiAgICBAcGFyYW0ge1N0cmluZ30gbmFtZSBUaGUgaGVscGVyIHRvIHJl
        bW92ZS4KICAqLwogIHVucmVnaXN0ZXJIZWxwZXI6IGZ1bmN0aW9uKG5hbWUp
        IHsKICAgIGRlbGV0ZSBoZWxwZXJzW25hbWVdOwogICAgaWYgKG9yaWdpbmFs
        TWV0aG9kc1tuYW1lXSkgewogICAgICB3aW5kb3dbbmFtZV0gPSBvcmlnaW5h
        bE1ldGhvZHNbbmFtZV07CiAgICB9CiAgICBkZWxldGUgb3JpZ2luYWxNZXRo
        b2RzW25hbWVdOwogIH0sCgogIC8qKgogICAgVXNlZCB0byByZWdpc3RlciBj
        YWxsYmFja3MgdG8gYmUgZmlyZWQgd2hlbmV2ZXIgYEFwcC5pbmplY3RUZXN0
        SGVscGVyc2AKICAgIGlzIGNhbGxlZC4KCiAgICBUaGUgY2FsbGJhY2sgd2ls
        bCByZWNlaXZlIHRoZSBjdXJyZW50IGFwcGxpY2F0aW9uIGFzIGFuIGFyZ3Vt
        ZW50LgoKICAgIEV4YW1wbGU6CiAgICBgYGAKICAgIEVtYmVyLlRlc3Qub25J
        bmplY3RIZWxwZXJzKGZ1bmN0aW9uKCkgewogICAgICBFbWJlci4kKGRvY3Vt
        ZW50KS5hamF4U3RhcnQoZnVuY3Rpb24oKSB7CiAgICAgICAgVGVzdC5wZW5k
        aW5nQWpheFJlcXVlc3RzKys7CiAgICAgIH0pOwoKICAgICAgRW1iZXIuJChk
        b2N1bWVudCkuYWpheFN0b3AoZnVuY3Rpb24oKSB7CiAgICAgICAgVGVzdC5w
        ZW5kaW5nQWpheFJlcXVlc3RzLS07CiAgICAgIH0pOwogICAgfSk7CiAgICBg
        YGAKCiAgICBAcHVibGljCiAgICBAbWV0aG9kIG9uSW5qZWN0SGVscGVycwog
        ICAgQHBhcmFtIHtGdW5jdGlvbn0gY2FsbGJhY2sgVGhlIGZ1bmN0aW9uIHRv
        IGJlIGNhbGxlZC4KICAqLwogIG9uSW5qZWN0SGVscGVyczogZnVuY3Rpb24o
        Y2FsbGJhY2spIHsKICAgIGluamVjdEhlbHBlcnNDYWxsYmFja3MucHVzaChj
        YWxsYmFjayk7CiAgfSwKCiAgLyoqCiAgICBUaGlzIHJldHVybnMgYSB0aGVu
        YWJsZSB0YWlsb3JlZCBmb3IgdGVzdGluZy4gIEl0IGNhdGNoZXMgZmFpbGVk
        CiAgICBgb25TdWNjZXNzYCBjYWxsYmFja3MgYW5kIGludm9rZXMgdGhlIGBF
        bWJlci5UZXN0LmFkYXB0ZXIuZXhjZXB0aW9uYAogICAgY2FsbGJhY2sgaW4g
        dGhlIGxhc3QgY2hhaW5lZCB0aGVuLgoKICAgIFRoaXMgbWV0aG9kIHNob3Vs
        ZCBiZSByZXR1cm5lZCBieSBhc3luYyBoZWxwZXJzIHN1Y2ggYXMgYHdhaXRg
        LgoKICAgIEBwdWJsaWMKICAgIEBtZXRob2QgcHJvbWlzZQogICAgQHBhcmFt
        IHtGdW5jdGlvbn0gcmVzb2x2ZXIgVGhlIGZ1bmN0aW9uIHVzZWQgdG8gcmVz
        b2x2ZSB0aGUgcHJvbWlzZS4KICAqLwogIHByb21pc2U6IGZ1bmN0aW9uKHJl
        c29sdmVyKSB7CiAgICB2YXIgcHJvbWlzZSA9IG5ldyBFbWJlci5SU1ZQLlBy
        b21pc2UocmVzb2x2ZXIpOwogICAgdmFyIHRoZW5hYmxlID0gewogICAgICBj
        aGFpbmVkOiBmYWxzZQogICAgfTsKICAgIHRoZW5hYmxlLnRoZW4gPSBmdW5j
        dGlvbihvblN1Y2Nlc3MsIG9uRmFpbHVyZSkgewogICAgICB2YXIgdGhlblBy
        b21pc2UsIG5leHRQcm9taXNlOwogICAgICB0aGVuYWJsZS5jaGFpbmVkID0g
        dHJ1ZTsKICAgICAgdGhlblByb21pc2UgPSBwcm9taXNlLnRoZW4ob25TdWNj
        ZXNzLCBvbkZhaWx1cmUpOwogICAgICAvLyB0aGlzIGlzIHRvIGVuc3VyZSBh
        bGwgZG93bnN0cmVhbSBmdWxmaWxsbWVudAogICAgICAvLyBoYW5kbGVycyBh
        cmUgd3JhcHBlZCBpbiB0aGUgZXJyb3IgaGFuZGxpbmcKICAgICAgbmV4dFBy
        b21pc2UgPSBFbWJlci5UZXN0LnByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSkg
        ewogICAgICAgIHJlc29sdmUodGhlblByb21pc2UpOwogICAgICB9KTsKICAg
        ICAgdGhlblByb21pc2UudGhlbihudWxsLCBmdW5jdGlvbihyZWFzb24pIHsK
        ICAgICAgICAvLyBlbnN1cmUgdGhpcyBpcyB0aGUgbGFzdCBwcm9taXNlIGlu
        IHRoZSBjaGFpbgogICAgICAgIC8vIGlmIG5vdCwgaWdub3JlIGFuZCB0aGUg
        ZXhjZXB0aW9uIHdpbGwgcHJvcGFnYXRlCiAgICAgICAgLy8gdGhpcyBwcmV2
        ZW50cyB0aGUgc2FtZSBlcnJvciBmcm9tIGJlaW5nIGZpcmVkIG11bHRpcGxl
        IHRpbWVzCiAgICAgICAgaWYgKCFuZXh0UHJvbWlzZS5jaGFpbmVkKSB7CiAg
        ICAgICAgICBFbWJlci5UZXN0LmFkYXB0ZXIuZXhjZXB0aW9uKHJlYXNvbik7
        CiAgICAgICAgfQogICAgICB9KTsKICAgICAgcmV0dXJuIG5leHRQcm9taXNl
        OwogICAgfTsKICAgIHJldHVybiB0aGVuYWJsZTsKICB9LAoKICAvKioKICAg
        VXNlZCB0byBhbGxvdyBlbWJlci10ZXN0aW5nIHRvIGNvbW11bmljYXRlIHdp
        dGggYSBzcGVjaWZpYyB0ZXN0aW5nCiAgIGZyYW1ld29yay4KCiAgIFlvdSBj
        YW4gbWFudWFsbHkgc2V0IGl0IGJlZm9yZSBjYWxsaW5nIGBBcHAuc2V0dXBG
        b3JUZXN0aW5nKClgLgoKICAgRXhhbXBsZToKICAgYGBgCiAgIEVtYmVyLlRl
        c3QuYWRhcHRlciA9IE15Q3VzdG9tQWRhcHRlci5jcmVhdGUoKQogICBgYGAK
        CiAgIElmIHlvdSBkbyBub3Qgc2V0IGl0LCBlbWJlci10ZXN0aW5nIHdpbGwg
        ZGVmYXVsdCB0byBgRW1iZXIuVGVzdC5RVW5pdEFkYXB0ZXJgLgoKICAgQHB1
        YmxpYwogICBAcHJvcGVydHkgYWRhcHRlcgogICBAdHlwZSB7Q2xhc3N9IFRo
        ZSBhZGFwdGVyIHRvIGJlIHVzZWQuCiAgIEBkZWZhdWx0IEVtYmVyLlRlc3Qu
        UVVuaXRBZGFwdGVyCiAgKi8KICBhZGFwdGVyOiBudWxsCn07CgpmdW5jdGlv
        biBjdXJyeShhcHAsIGZuKSB7CiAgcmV0dXJuIGZ1bmN0aW9uKCkgewogICAg
        dmFyIGFyZ3MgPSBzbGljZS5jYWxsKGFyZ3VtZW50cyk7CiAgICBhcmdzLnVu
        c2hpZnQoYXBwKTsKICAgIHJldHVybiBmbi5hcHBseShhcHAsIGFyZ3MpOwog
        IH07Cn0KCkVtYmVyLkFwcGxpY2F0aW9uLnJlb3Blbih7CiAgLyoqCiAgICBA
        cHJvcGVydHkgdGVzdEhlbHBlcnMKICAgIEB0eXBlIHtPYmplY3R9CiAgICBA
        ZGVmYXVsdCB7fQogICovCiAgdGVzdEhlbHBlcnM6IHt9LAoKICAvKioKICAg
        VGhpcyBob29rIGRlZmVycyB0aGUgcmVhZGluZXNzIG9mIHRoZSBhcHBsaWNh
        dGlvbiwgc28gdGhhdCB5b3UgY2FuIHN0YXJ0CiAgIHRoZSBhcHAgd2hlbiB5
        b3VyIHRlc3RzIGFyZSByZWFkeSB0byBydW4uIEl0IGFsc28gc2V0cyB0aGUg
        cm91dGVyJ3MKICAgbG9jYXRpb24gdG8gJ25vbmUnLCBzbyB0aGF0IHRoZSB3
        aW5kb3cncyBsb2NhdGlvbiB3aWxsIG5vdCBiZSBtb2RpZmllZAogICAocHJl
        dmVudGluZyBib3RoIGFjY2lkZW50YWwgbGVha2luZyBvZiBzdGF0ZSBiZXR3
        ZWVuIHRlc3RzIGFuZCBpbnRlcmZlcmVuY2UKICAgd2l0aCB5b3VyIHRlc3Rp
        bmcgZnJhbWV3b3JrKS4KCiAgIEV4YW1wbGU6CiAgYGBgCiAgQXBwLnNldHVw
        Rm9yVGVzdGluZygpOwogIGBgYAoKICAgIEBtZXRob2Qgc2V0dXBGb3JUZXN0
        aW5nCiAgKi8KICBzZXR1cEZvclRlc3Rpbmc6IGZ1bmN0aW9uKCkgewogICAg
        RW1iZXIudGVzdGluZyA9IHRydWU7CgogICAgdGhpcy5kZWZlclJlYWRpbmVz
        cygpOwoKICAgIHRoaXMuUm91dGVyLnJlb3Blbih7CiAgICAgIGxvY2F0aW9u
        OiAnbm9uZScKICAgIH0pOwoKICAgIC8vIGlmIGFkYXB0ZXIgaXMgbm90IG1h
        bnVhbGx5IHNldCBkZWZhdWx0IHRvIFFVbml0CiAgICBpZiAoIUVtYmVyLlRl
        c3QuYWRhcHRlcikgewogICAgICAgRW1iZXIuVGVzdC5hZGFwdGVyID0gRW1i
        ZXIuVGVzdC5RVW5pdEFkYXB0ZXIuY3JlYXRlKCk7CiAgICB9CiAgfSwKCiAg
        LyoqCiAgICBUaGlzIGluamVjdHMgdGhlIHRlc3QgaGVscGVycyBpbnRvIHRo
        ZSB3aW5kb3cncyBzY29wZS4gSWYgYSBmdW5jdGlvbiBvZiB0aGUKICAgIHNh
        bWUgbmFtZSBoYXMgYWxyZWFkeSBiZWVuIGRlZmluZWQgaXQgd2lsbCBiZSBj
        YWNoZWQgKHNvIHRoYXQgaXQgY2FuIGJlIHJlc2V0CiAgICBpZiB0aGUgaGVs
        cGVyIGlzIHJlbW92ZWQgd2l0aCBgdW5yZWdpc3RlckhlbHBlcmAgb3IgYHJl
        bW92ZVRlc3RIZWxwZXJzYCkuCgogICBBbnkgY2FsbGJhY2tzIHJlZ2lzdGVy
        ZWQgd2l0aCBgb25JbmplY3RIZWxwZXJzYCB3aWxsIGJlIGNhbGxlZCBvbmNl
        IHRoZQogICBoZWxwZXJzIGhhdmUgYmVlbiBpbmplY3RlZC4KCiAgRXhhbXBs
        ZToKICBgYGAKICBBcHAuaW5qZWN0VGVzdEhlbHBlcnMoKTsKICBgYGAKCiAg
        ICBAbWV0aG9kIGluamVjdFRlc3RIZWxwZXJzCiAgKi8KICBpbmplY3RUZXN0
        SGVscGVyczogZnVuY3Rpb24oKSB7CiAgICB0aGlzLnRlc3RIZWxwZXJzID0g
        e307CiAgICBmb3IgKHZhciBuYW1lIGluIGhlbHBlcnMpIHsKICAgICAgb3Jp
        Z2luYWxNZXRob2RzW25hbWVdID0gd2luZG93W25hbWVdOwogICAgICB0aGlz
        LnRlc3RIZWxwZXJzW25hbWVdID0gd2luZG93W25hbWVdID0gY3VycnkodGhp
        cywgaGVscGVyc1tuYW1lXSk7CiAgICB9CgogICAgZm9yKHZhciBpID0gMCwg
        bCA9IGluamVjdEhlbHBlcnNDYWxsYmFja3MubGVuZ3RoOyBpIDwgbDsgaSsr
        KSB7CiAgICAgIGluamVjdEhlbHBlcnNDYWxsYmFja3NbaV0odGhpcyk7CiAg
        ICB9CiAgfSwKCiAgLyoqCiAgICBUaGlzIHJlbW92ZXMgYWxsIGhlbHBlcnMg
        dGhhdCBoYXZlIGJlZW4gcmVnaXN0ZXJlZCwgYW5kIHJlc2V0cyBhbmQgZnVu
        Y3Rpb25zCiAgICB0aGF0IHdlcmUgb3ZlcnJpZGRlbiBieSB0aGUgaGVscGVy
        cy4KCiAgICBFeGFtcGxlOgogICAgYGBgCiAgICBBcHAucmVtb3ZlVGVzdEhl
        bHBlcnMoKTsKICAgIGBgYAoKICAgIEBwdWJsaWMKICAgIEBtZXRob2QgcmVt
        b3ZlVGVzdEhlbHBlcnMKICAqLwogIHJlbW92ZVRlc3RIZWxwZXJzOiBmdW5j
        dGlvbigpIHsKICAgIGZvciAodmFyIG5hbWUgaW4gaGVscGVycykgewogICAg
        ICB3aW5kb3dbbmFtZV0gPSBvcmlnaW5hbE1ldGhvZHNbbmFtZV07CiAgICAg
        IGRlbGV0ZSB0aGlzLnRlc3RIZWxwZXJzW25hbWVdOwogICAgICBkZWxldGUg
        b3JpZ2luYWxNZXRob2RzW25hbWVdOwogICAgfQogIH0KfSk7Cgp9KSgpOwoK
        CgooZnVuY3Rpb24oKSB7Ci8qKgogIEBtb2R1bGUgZW1iZXIKICBAc3VibW9k
        dWxlIGVtYmVyLXRlc3RpbmcKICovCgp2YXIgJCA9IEVtYmVyLiQ7CgovKioK
        ICBUaGlzIG1ldGhvZCBjcmVhdGVzIGEgY2hlY2tib3ggYW5kIHRyaWdnZXJz
        IHRoZSBjbGljayBldmVudCB0byBmaXJlIHRoZQogIHBhc3NlZCBpbiBoYW5k
        bGVyLiBJdCBpcyB1c2VkIHRvIGNvcnJlY3QgZm9yIGEgYnVnIGluIG9sZGVy
        IHZlcnNpb25zCiAgb2YgalF1ZXJ5IChlLmcgMS44LjMpLgoKICBAcHJpdmF0
        ZQogIEBtZXRob2QgdGVzdENoZWNrYm94Q2xpY2sKKi8KZnVuY3Rpb24gdGVz
        dENoZWNrYm94Q2xpY2soaGFuZGxlcikgewogICQoJzxpbnB1dCB0eXBlPSJj
        aGVja2JveCI+JykKICAgIC5jc3MoeyBwb3NpdGlvbjogJ2Fic29sdXRlJywg
        bGVmdDogJy0xMDAwcHgnLCB0b3A6ICctMTAwMHB4JyB9KQogICAgLmFwcGVu
        ZFRvKCdib2R5JykKICAgIC5vbignY2xpY2snLCBoYW5kbGVyKQogICAgLmNs
        aWNrKCkKICAgIC5yZW1vdmUoKTsKfQoKJChmdW5jdGlvbigpIHsKICAvKgog
        ICAgRGV0ZXJtaW5lIHdoZXRoZXIgYSBjaGVja2JveCBjaGVja2VkIHVzaW5n
        IGpRdWVyeSdzICJjbGljayIgbWV0aG9kIHdpbGwgaGF2ZQogICAgdGhlIGNv
        cnJlY3QgdmFsdWUgZm9yIGl0cyBjaGVja2VkIHByb3BlcnR5LgoKICAgIElm
        IHdlIGRldGVybWluZSB0aGF0IHRoZSBjdXJyZW50IGpRdWVyeSB2ZXJzaW9u
        IGV4aGliaXRzIHRoaXMgYmVoYXZpb3IsCiAgICBwYXRjaCBpdCB0byB3b3Jr
        IGNvcnJlY3RseSBhcyBpbiB0aGUgY29tbWl0IGZvciB0aGUgYWN0dWFsIGZp
        eDoKICAgIGh0dHBzOi8vZ2l0aHViLmNvbS9qcXVlcnkvanF1ZXJ5L2NvbW1p
        dC8xZmIyZjkyLgogICovCiAgdGVzdENoZWNrYm94Q2xpY2soZnVuY3Rpb24o
        KSB7CiAgICBpZiAoIXRoaXMuY2hlY2tlZCAmJiAhJC5ldmVudC5zcGVjaWFs
        LmNsaWNrKSB7CiAgICAgICQuZXZlbnQuc3BlY2lhbC5jbGljayA9IHsKICAg
        ICAgICAvLyBGb3IgY2hlY2tib3gsIGZpcmUgbmF0aXZlIGV2ZW50IHNvIGNo
        ZWNrZWQgc3RhdGUgd2lsbCBiZSByaWdodAogICAgICAgIHRyaWdnZXI6IGZ1
        bmN0aW9uKCkgewogICAgICAgICAgaWYgKCQubm9kZU5hbWUoIHRoaXMsICJp
        bnB1dCIgKSAmJiB0aGlzLnR5cGUgPT09ICJjaGVja2JveCIgJiYgdGhpcy5j
        bGljaykgewogICAgICAgICAgICB0aGlzLmNsaWNrKCk7CiAgICAgICAgICAg
        IHJldHVybiBmYWxzZTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH07
        CiAgICB9CiAgfSk7CgogIC8vIFRyeSBhZ2FpbiB0byB2ZXJpZnkgdGhhdCB0
        aGUgcGF0Y2ggdG9vayBlZmZlY3Qgb3IgYmxvdyB1cC4KICB0ZXN0Q2hlY2ti
        b3hDbGljayhmdW5jdGlvbigpIHsKICAgIEVtYmVyLndhcm4oImNsaWNrZWQg
        Y2hlY2tib3hlcyBzaG91bGQgYmUgY2hlY2tlZCEgdGhlIGpRdWVyeSBwYXRj
        aCBkaWRuJ3Qgd29yayIsIHRoaXMuY2hlY2tlZCk7CiAgfSk7Cn0pOwoKfSko
        KTsKCgoKKGZ1bmN0aW9uKCkgewovKioKIEBtb2R1bGUgZW1iZXIKIEBzdWJt
        b2R1bGUgZW1iZXItdGVzdGluZwoqLwoKdmFyIFRlc3QgPSBFbWJlci5UZXN0
        OwoKLyoqCiAgVGhlIHByaW1hcnkgcHVycG9zZSBvZiB0aGlzIGNsYXNzIGlz
        IHRvIGNyZWF0ZSBob29rcyB0aGF0IGNhbiBiZSBpbXBsZW1lbnRlZAogIGJ5
        IGFuIGFkYXB0ZXIgZm9yIHZhcmlvdXMgdGVzdCBmcmFtZXdvcmtzLgoKICBA
        Y2xhc3MgQWRhcHRlcgogIEBuYW1lc3BhY2UgRW1iZXIuVGVzdAoqLwpUZXN0
        LkFkYXB0ZXIgPSBFbWJlci5PYmplY3QuZXh0ZW5kKHsKICAvKioKICAgIFRo
        aXMgY2FsbGJhY2sgd2lsbCBiZSBjYWxsZWQgd2hlbmV2ZXIgYW4gYXN5bmMg
        b3BlcmF0aW9uIGlzIGFib3V0IHRvIHN0YXJ0LgoKICAgIE92ZXJyaWRlIHRo
        aXMgdG8gY2FsbCB5b3VyIGZyYW1ld29yaydzIG1ldGhvZHMgdGhhdCBoYW5k
        bGUgYXN5bmMKICAgIG9wZXJhdGlvbnMuCgogICAgQHB1YmxpYwogICAgQG1l
        dGhvZCBhc3luY1N0YXJ0CiAgKi8KICBhc3luY1N0YXJ0OiBFbWJlci5LLAoK
        ICAvKioKICAgIFRoaXMgY2FsbGJhY2sgd2lsbCBiZSBjYWxsZWQgd2hlbmV2
        ZXIgYW4gYXN5bmMgb3BlcmF0aW9uIGhhcyBjb21wbGV0ZWQuCgogICAgQHB1
        YmxpYwogICAgQG1ldGhvZCBhc3luY0VuZAogICovCiAgYXN5bmNFbmQ6IEVt
        YmVyLkssCgogIC8qKgogICAgT3ZlcnJpZGUgdGhpcyBtZXRob2Qgd2l0aCB5
        b3VyIHRlc3RpbmcgZnJhbWV3b3JrJ3MgZmFsc2UgYXNzZXJ0aW9uLgogICAg
        VGhpcyBmdW5jdGlvbiBpcyBjYWxsZWQgd2hlbmV2ZXIgYW4gZXhjZXB0aW9u
        IG9jY3VycyBjYXVzaW5nIHRoZSB0ZXN0aW5nCiAgICBwcm9taXNlIHRvIGZh
        aWwuCgogICAgUVVuaXQgZXhhbXBsZToKCiAgICBgYGBqYXZhc2NyaXB0CiAg
        ICAgIGV4Y2VwdGlvbjogZnVuY3Rpb24oZXJyb3IpIHsKICAgICAgICBvayhm
        YWxzZSwgZXJyb3IpOwogICAgICB9OwogICAgYGBgCgogICAgQHB1YmxpYwog
        ICAgQG1ldGhvZCBleGNlcHRpb24KICAgIEBwYXJhbSB7U3RyaW5nfSBlcnJv
        ciBUaGUgZXhjZXB0aW9uIHRvIGJlIHJhaXNlZC4KICAqLwogIGV4Y2VwdGlv
        bjogZnVuY3Rpb24oZXJyb3IpIHsKICAgIHNldFRpbWVvdXQoZnVuY3Rpb24o
        KSB7CiAgICAgIHRocm93IGVycm9yOwogICAgfSk7CiAgfQp9KTsKCi8qKgog
        IFRoaXMgY2xhc3MgaW1wbGVtZW50cyB0aGUgbWV0aG9kcyBkZWZpbmVkIGJ5
        IEVtYmVyLlRlc3QuQWRhcHRlciBmb3IgdGhlCiAgUVVuaXQgdGVzdGluZyBm
        cmFtZXdvcmsuCgogIEBjbGFzcyBRVW5pdEFkYXB0ZXIKICBAbmFtZXNwYWNl
        IEVtYmVyLlRlc3QKICBAZXh0ZW5kcyBFbWJlci5UZXN0LkFkYXB0ZXIKKi8K
        VGVzdC5RVW5pdEFkYXB0ZXIgPSBUZXN0LkFkYXB0ZXIuZXh0ZW5kKHsKICBh
        c3luY1N0YXJ0OiBmdW5jdGlvbigpIHsKICAgIHN0b3AoKTsKICB9LAogIGFz
        eW5jRW5kOiBmdW5jdGlvbigpIHsKICAgIHN0YXJ0KCk7CiAgfSwKICBleGNl
        cHRpb246IGZ1bmN0aW9uKGVycm9yKSB7CiAgICBvayhmYWxzZSwgRW1iZXIu
        aW5zcGVjdChlcnJvcikpOwogIH0KfSk7Cgp9KSgpOwoKCgooZnVuY3Rpb24o
        KSB7Ci8qKgoqIEBtb2R1bGUgZW1iZXIKKiBAc3VibW9kdWxlIGVtYmVyLXRl
        c3RpbmcKKi8KCnZhciBnZXQgPSBFbWJlci5nZXQsCiAgICBUZXN0ID0gRW1i
        ZXIuVGVzdCwKICAgIGhlbHBlciA9IFRlc3QucmVnaXN0ZXJIZWxwZXIsCiAg
        ICBjb3VudEFzeW5jID0gMDsKClRlc3QucGVuZGluZ0FqYXhSZXF1ZXN0cyA9
        IDA7CgpUZXN0Lm9uSW5qZWN0SGVscGVycyhmdW5jdGlvbigpIHsKICBFbWJl
        ci4kKGRvY3VtZW50KS5hamF4U3RhcnQoZnVuY3Rpb24oKSB7CiAgICBUZXN0
        LnBlbmRpbmdBamF4UmVxdWVzdHMrKzsKICB9KTsKCiAgRW1iZXIuJChkb2N1
        bWVudCkuYWpheFN0b3AoZnVuY3Rpb24oKSB7CiAgICBFbWJlci5hc3NlcnQo
        IkFuIGFqYXhTdG9wIGV2ZW50IHdoaWNoIHdvdWxkIGNhdXNlIHRoZSBudW1i
        ZXIgb2YgcGVuZGluZyBBSkFYIHJlcXVlc3RzIHRvIGJlIG5lZ2F0aXZlIGhh
        cyBiZWVuIHRyaWdnZXJlZC4gVGhpcyBpcyBtb3N0IGxpa2VseSBjYXVzZWQg
        YnkgQUpBWCBldmVudHMgdGhhdCB3ZXJlIHN0YXJ0ZWQgYmVmb3JlIGNhbGxp
        bmcgYGluamVjdFRlc3RIZWxwZXJzKClgLiIsIFRlc3QucGVuZGluZ0FqYXhS
        ZXF1ZXN0cyAhPT0gMCk7CiAgICBUZXN0LnBlbmRpbmdBamF4UmVxdWVzdHMt
        LTsKICB9KTsKfSk7CgoKZnVuY3Rpb24gdmlzaXQoYXBwLCB1cmwpIHsKICBh
        cHAuX19jb250YWluZXJfXy5sb29rdXAoJ3JvdXRlcjptYWluJykubG9jYXRp
        b24uc2V0VVJMKHVybCk7CiAgRW1iZXIucnVuKGFwcCwgYXBwLmhhbmRsZVVS
        TCwgdXJsKTsKICByZXR1cm4gd2FpdChhcHApOwp9CgpmdW5jdGlvbiBjbGlj
        ayhhcHAsIHNlbGVjdG9yLCBjb250ZXh0KSB7CiAgdmFyICRlbCA9IGZpbmRX
        aXRoQXNzZXJ0KGFwcCwgc2VsZWN0b3IsIGNvbnRleHQpOwogIEVtYmVyLnJ1
        bigkZWwsICdtb3VzZWRvd24nKTsKCiAgaWYgKCRlbC5pcygnOmlucHV0Jykp
        IHsKICAgIHZhciB0eXBlID0gJGVsLnByb3AoJ3R5cGUnKTsKICAgIGlmICh0
        eXBlICE9PSAnY2hlY2tib3gnICYmIHR5cGUgIT09ICdyYWRpbycgJiYgdHlw
        ZSAhPT0gJ2hpZGRlbicpIHsKICAgICAgRW1iZXIucnVuKCRlbCwgZnVuY3Rp
        b24oKXsKICAgICAgICAvLyBGaXJlZm94IGRvZXMgbm90IHRyaWdnZXIgdGhl
        IGBmb2N1c2luYCBldmVudCBpZiB0aGUgd2luZG93CiAgICAgICAgLy8gZG9l
        cyBub3QgaGF2ZSBmb2N1cy4gSWYgdGhlIGRvY3VtZW50IGRvZXNuJ3QgaGF2
        ZSBmb2N1cyBqdXN0CiAgICAgICAgLy8gdXNlIHRyaWdnZXIoJ2ZvY3VzaW4n
        KSBpbnN0ZWFkLgogICAgICAgIGlmICghZG9jdW1lbnQuaGFzRm9jdXMgfHwg
        ZG9jdW1lbnQuaGFzRm9jdXMoKSkgewogICAgICAgICAgdGhpcy5mb2N1cygp
        OwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aGlzLnRyaWdnZXIoJ2Zv
        Y3VzaW4nKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfQogIH0KCiAgRW1i
        ZXIucnVuKCRlbCwgJ21vdXNldXAnKTsKICBFbWJlci5ydW4oJGVsLCAnY2xp
        Y2snKTsKCiAgcmV0dXJuIHdhaXQoYXBwKTsKfQoKZnVuY3Rpb24ga2V5RXZl
        bnQoYXBwLCBzZWxlY3RvciwgY29udGV4dCwgdHlwZSwga2V5Q29kZSkgewog
        IHZhciAkZWw7CiAgaWYgKHR5cGVvZiBrZXlDb2RlID09PSAndW5kZWZpbmVk
        JykgewogICAga2V5Q29kZSA9IHR5cGU7CiAgICB0eXBlID0gY29udGV4dDsK
        ICAgIGNvbnRleHQgPSBudWxsOwogIH0KICAkZWwgPSBmaW5kV2l0aEFzc2Vy
        dChhcHAsIHNlbGVjdG9yLCBjb250ZXh0KTsKICB2YXIgZXZlbnQgPSBFbWJl
        ci4kLkV2ZW50KHR5cGUsIHsga2V5Q29kZToga2V5Q29kZSB9KTsKICBFbWJl
        ci5ydW4oJGVsLCAndHJpZ2dlcicsIGV2ZW50KTsKICByZXR1cm4gd2FpdChh
        cHApOwp9CgpmdW5jdGlvbiBmaWxsSW4oYXBwLCBzZWxlY3RvciwgY29udGV4
        dCwgdGV4dCkgewogIHZhciAkZWw7CiAgaWYgKHR5cGVvZiB0ZXh0ID09PSAn
        dW5kZWZpbmVkJykgewogICAgdGV4dCA9IGNvbnRleHQ7CiAgICBjb250ZXh0
        ID0gbnVsbDsKICB9CiAgJGVsID0gZmluZFdpdGhBc3NlcnQoYXBwLCBzZWxl
        Y3RvciwgY29udGV4dCk7CiAgRW1iZXIucnVuKGZ1bmN0aW9uKCkgewogICAg
        JGVsLnZhbCh0ZXh0KS5jaGFuZ2UoKTsKICB9KTsKICByZXR1cm4gd2FpdChh
        cHApOwp9CgpmdW5jdGlvbiBmaW5kV2l0aEFzc2VydChhcHAsIHNlbGVjdG9y
        LCBjb250ZXh0KSB7CiAgdmFyICRlbCA9IGZpbmQoYXBwLCBzZWxlY3Rvciwg
        Y29udGV4dCk7CiAgaWYgKCRlbC5sZW5ndGggPT09IDApIHsKICAgIHRocm93
        IG5ldyBFbWJlci5FcnJvcigiRWxlbWVudCAiICsgc2VsZWN0b3IgKyAiIG5v
        dCBmb3VuZC4iKTsKICB9CiAgcmV0dXJuICRlbDsKfQoKZnVuY3Rpb24gZmlu
        ZChhcHAsIHNlbGVjdG9yLCBjb250ZXh0KSB7CiAgdmFyICRlbDsKICBjb250
        ZXh0ID0gY29udGV4dCB8fCBnZXQoYXBwLCAncm9vdEVsZW1lbnQnKTsKICAk
        ZWwgPSBhcHAuJChzZWxlY3RvciwgY29udGV4dCk7CgogIHJldHVybiAkZWw7
        Cn0KCmZ1bmN0aW9uIHdhaXQoYXBwLCB2YWx1ZSkgewogIHZhciBwcm9taXNl
        OwoKICBwcm9taXNlID0gVGVzdC5wcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUp
        IHsKICAgIGlmICgrK2NvdW50QXN5bmMgPT09IDEpIHsKICAgICAgVGVzdC5h
        ZGFwdGVyLmFzeW5jU3RhcnQoKTsKICAgIH0KICAgIHZhciB3YXRjaGVyID0g
        c2V0SW50ZXJ2YWwoZnVuY3Rpb24oKSB7CiAgICAgIHZhciByb3V0ZXJJc0xv
        YWRpbmcgPSBhcHAuX19jb250YWluZXJfXy5sb29rdXAoJ3JvdXRlcjptYWlu
        Jykucm91dGVyLmlzTG9hZGluZzsKICAgICAgaWYgKHJvdXRlcklzTG9hZGlu
        ZykgeyByZXR1cm47IH0KICAgICAgaWYgKFRlc3QucGVuZGluZ0FqYXhSZXF1
        ZXN0cykgeyByZXR1cm47IH0KICAgICAgaWYgKEVtYmVyLnJ1bi5oYXNTY2hl
        ZHVsZWRUaW1lcnMoKSB8fCBFbWJlci5ydW4uY3VycmVudFJ1bkxvb3ApIHsg
        cmV0dXJuOyB9CgogICAgICBjbGVhckludGVydmFsKHdhdGNoZXIpOwoKICAg
        ICAgaWYgKC0tY291bnRBc3luYyA9PT0gMCkgewogICAgICAgIFRlc3QuYWRh
        cHRlci5hc3luY0VuZCgpOwogICAgICB9CgogICAgICBFbWJlci5ydW4obnVs
        bCwgcmVzb2x2ZSwgdmFsdWUpOwogICAgfSwgMTApOwogIH0pOwoKICByZXR1
        cm4gYnVpbGRDaGFpbk9iamVjdChhcHAsIHByb21pc2UpOwp9CgovKgogQnVp
        bGRzIGFuIG9iamVjdCB0aGF0IGNvbnRhaW5zIGFsbCBoZWxwZXIgbWV0aG9k
        cy4gVGhpcyBvYmplY3Qgd2lsbCBiZQogcmV0dXJuZWQgYnkgaGVscGVycyBh
        bmQgdGhlbi1wcm9taXNlcy4KCiBUaGlzIGFsbG93cyB1cyB0byBjaGFpbiBo
        ZWxwZXJzOgoKIGBgYGphdmFzY3JpcHQKICB2aXNpdCgncG9zdHMvbmV3JykK
        ICAuY2xpY2soJy5hZGQtYnRuJykKICAuZmlsbEluKCcudGl0bGUnLCAnUG9z
        dCcpCiAgLmNsaWNrKCcuc3VibWl0JykKICAudGhlbihmdW5jdGlvbigpIHsK
        ICAgIGVxdWFsKCcucG9zdC10aXRsZScsICdQb3N0Jyk7CiAgfSkKICAudmlz
        aXQoJ2NvbW1lbnRzJykKICAudGhlbihmdW5jdGlvbigpIHsKICAgIGVxdWFs
        KGZpbmQoJy5jb21tZW50cycpLGxlbmd0aCwgMCk7CiAgfSk7CiBgYGAKCiBA
        bWV0aG9kIGJ1aWxkQ2hhaW5PYmplY3QKIEBwYXJhbSB7RW1iZXIuQXBwbGlj
        YXRpb259IGFwcAogQHBhcmFtIHtFbWJlci5SU1ZQLlByb21pc2V9IHByb21p
        c2UKIEByZXR1cm4ge09iamVjdH0gQSBuZXcgb2JqZWN0IHdpdGggcHJvcGVy
        dGllcyBmb3IgZWFjaAogICAgICAgICAgICAgICAgICBvZiBhcHAncyBoZWxw
        ZXJzIHRvIGJlIHVzZWQgZm9yIGNvbnRpbnVlZAogICAgICAgICAgICAgICAg
        ICBtZXRob2QgY2hhaW5pbmcgKHVzaW5nIHByb21pc2VzKS4KKi8KZnVuY3Rp
        b24gYnVpbGRDaGFpbk9iamVjdChhcHAsIHByb21pc2UpIHsKICB2YXIgaGVs
        cGVyTmFtZSwgb2JqID0ge307CiAgZm9yKGhlbHBlck5hbWUgaW4gYXBwLnRl
        c3RIZWxwZXJzKSB7CiAgICBvYmpbaGVscGVyTmFtZV0gPSBjaGFpbihhcHAs
        IHByb21pc2UsIGFwcC50ZXN0SGVscGVyc1toZWxwZXJOYW1lXSk7CiAgfQog
        IG9iai50aGVuID0gZnVuY3Rpb24oZm4pIHsKICAgIHZhciB0aGVuUHJvbWlz
        ZSA9IHByb21pc2UudGhlbihmbik7CiAgICByZXR1cm4gYnVpbGRDaGFpbk9i
        amVjdChhcHAsIHRoZW5Qcm9taXNlKTsKICB9OwogIHJldHVybiBvYmo7Cn0K
        Ci8qCiAgVXNlZCBpbiBjb25qdW5jdGlvbiB3aXRoIGJ1aWxkQ2hhaW5PYmpl
        Y3QgdG8gc2V0dXAgYQogIGNvbnRpbnVlZCBjaGFpbiBvZiBtZXRob2QgY2Fs
        bHMgKHdpdGggcHJvbWlzZXMpCgogIEBtZXRob2QgY2hhaW4KICBAcGFyYW0g
        e0VtYmVyLkFwcGxpY2F0aW9ufSBhcHAKICBAcGFyYW0ge0VtYmVyLlJTVlAu
        UHJvbWlzZX0gcHJvbWlzZQogIEBwYXJhbSB7RnVuY3Rpb259IGZuCiovCmZ1
        bmN0aW9uIGNoYWluKGFwcCwgcHJvbWlzZSwgZm4pIHsKICByZXR1cm4gZnVu
        Y3Rpb24oKSB7CiAgICB2YXIgYXJncyA9IGFyZ3VtZW50cywgY2hhaW5lZFBy
        b21pc2U7CiAgICBjaGFpbmVkUHJvbWlzZSA9IHByb21pc2UudGhlbihmdW5j
        dGlvbigpIHsKICAgICAgcmV0dXJuIGZuLmFwcGx5KG51bGwsIGFyZ3MpOwog
        ICAgfSk7CiAgICByZXR1cm4gYnVpbGRDaGFpbk9iamVjdChhcHAsIGNoYWlu
        ZWRQcm9taXNlKTsKICB9Owp9CgovKioKKiBMb2FkcyBhIHJvdXRlLCBzZXRz
        IHVwIGFueSBjb250cm9sbGVycywgYW5kIHJlbmRlcnMgYW55IHRlbXBsYXRl
        cyBhc3NvY2lhdGVkCiogd2l0aCB0aGUgcm91dGUgYXMgdGhvdWdoIGEgcmVh
        bCB1c2VyIGhhZCB0cmlnZ2VyZWQgdGhlIHJvdXRlIGNoYW5nZSB3aGlsZQoq
        IHVzaW5nIHlvdXIgYXBwLgoqCiogRXhhbXBsZToKKgoqIGBgYAoqIHZpc2l0
        KCdwb3N0cy9pbmRleCcpLnRoZW4oZnVuY3Rpb24oKSB7CiogICAvLyBhc3Nl
        cnQgc29tZXRoaW5nCiogfSk7CiogYGBgCioKKiBAbWV0aG9kIHZpc2l0Ciog
        QHBhcmFtIHtTdHJpbmd9IHVybCB0aGUgbmFtZSBvZiB0aGUgcm91dGUKKiBA
        cmV0dXJuIHtSU1ZQLlByb21pc2V9CiovCmhlbHBlcigndmlzaXQnLCB2aXNp
        dCk7CgovKioKKiBDbGlja3MgYW4gZWxlbWVudCBhbmQgdHJpZ2dlcnMgYW55
        IGFjdGlvbnMgdHJpZ2dlcmVkIGJ5IHRoZSBlbGVtZW50J3MgYGNsaWNrYAoq
        IGV2ZW50LgoqCiogRXhhbXBsZToKKgoqIGBgYAoqIGNsaWNrKCcuc29tZS1q
        UXVlcnktc2VsZWN0b3InKS50aGVuKGZ1bmN0aW9uKCkgewoqICAvLyBhc3Nl
        cnQgc29tZXRoaW5nCiogfSk7CiogYGBgCioKKiBAbWV0aG9kIGNsaWNrCiog
        QHBhcmFtIHtTdHJpbmd9IHNlbGVjdG9yIGpRdWVyeSBzZWxlY3RvciBmb3Ig
        ZmluZGluZyBlbGVtZW50IG9uIHRoZSBET00KKiBAcmV0dXJuIHtSU1ZQLlBy
        b21pc2V9CiovCmhlbHBlcignY2xpY2snLCBjbGljayk7CgovKioKKiBTaW11
        bGF0ZXMgYSBrZXkgZXZlbnQsIGUuZy4gYGtleXByZXNzYCwgYGtleWRvd25g
        LCBga2V5dXBgIHdpdGggdGhlIGRlc2lyZWQga2V5Q29kZQoqCiogRXhhbXBs
        ZToKKgoqIGBgYAoqIGtleUV2ZW50KCcuc29tZS1qUXVlcnktc2VsZWN0b3In
        LCAna2V5cHJlc3MnLCAxMykudGhlbihmdW5jdGlvbigpIHsKKiAgLy8gYXNz
        ZXJ0IHNvbWV0aGluZwoqIH0pOwoqIGBgYAoqCiogQG1ldGhvZCBrZXlFdmVu
        dAoqIEBwYXJhbSB7U3RyaW5nfSBzZWxlY3RvciBqUXVlcnkgc2VsZWN0b3Ig
        Zm9yIGZpbmRpbmcgZWxlbWVudCBvbiB0aGUgRE9NCiogQHBhcmFtIHtTdHJp
        bmd9IHRoZSB0eXBlIG9mIGtleSBldmVudCwgZS5nLiBga2V5cHJlc3NgLCBg
        a2V5ZG93bmAsIGBrZXl1cGAKKiBAcGFyYW0ge051bWJlcn0gdGhlIGtleUNv
        ZGUgb2YgdGhlIHNpbXVsYXRlZCBrZXkgZXZlbnQKKiBAcmV0dXJuIHtSU1ZQ
        LlByb21pc2V9CiovCmhlbHBlcigna2V5RXZlbnQnLCBrZXlFdmVudCk7Cgov
        KioKKiBGaWxscyBpbiBhbiBpbnB1dCBlbGVtZW50IHdpdGggc29tZSB0ZXh0
        LgoqCiogRXhhbXBsZToKKgoqIGBgYAoqIGZpbGxJbignI2VtYWlsJywgJ3lv
        dUBleGFtcGxlLmNvbScpLnRoZW4oZnVuY3Rpb24oKSB7CiogICAvLyBhc3Nl
        cnQgc29tZXRoaW5nCiogfSk7CiogYGBgCioKKiBAbWV0aG9kIGZpbGxJbgoq
        IEBwYXJhbSB7U3RyaW5nfSBzZWxlY3RvciBqUXVlcnkgc2VsZWN0b3IgZmlu
        ZGluZyBhbiBpbnB1dCBlbGVtZW50IG9uIHRoZSBET00KKiB0byBmaWxsIHRl
        eHQgd2l0aAoqIEBwYXJhbSB7U3RyaW5nfSB0ZXh0IHRleHQgdG8gcGxhY2Ug
        aW5zaWRlIHRoZSBpbnB1dCBlbGVtZW50CiogQHJldHVybiB7UlNWUC5Qcm9t
        aXNlfQoqLwpoZWxwZXIoJ2ZpbGxJbicsIGZpbGxJbik7CgovKioKKiBGaW5k
        cyBhbiBlbGVtZW50IGluIHRoZSBjb250ZXh0IG9mIHRoZSBhcHAncyBjb250
        YWluZXIgZWxlbWVudC4gQSBzaW1wbGUgYWxpYXMKKiBmb3IgYGFwcC4kKHNl
        bGVjdG9yKWAuCioKKiBFeGFtcGxlOgoqCiogYGBgCiogdmFyICRlbCA9IGZp
        bmQoJy5teS1zZWxlY3Rvcik7CiogYGBgCioKKiBAbWV0aG9kIGZpbmQKKiBA
        cGFyYW0ge1N0cmluZ30gc2VsZWN0b3IgalF1ZXJ5IHN0cmluZyBzZWxlY3Rv
        ciBmb3IgZWxlbWVudCBsb29rdXAKKiBAcmV0dXJuIHtPYmplY3R9IGpRdWVy
        eSBvYmplY3QgcmVwcmVzZW50aW5nIHRoZSByZXN1bHRzIG9mIHRoZSBxdWVy
        eQoqLwpoZWxwZXIoJ2ZpbmQnLCBmaW5kKTsKCi8qKgoqCiogTGlrZSBgZmlu
        ZGAsIGJ1dCB0aHJvd3MgYW4gZXJyb3IgaWYgdGhlIGVsZW1lbnQgc2VsZWN0
        b3IgcmV0dXJucyBubyByZXN1bHRzCioKKiBFeGFtcGxlOgoqCiogYGBgCiog
        dmFyICRlbCA9IGZpbmRXaXRoQXNzZXJ0KCcuZG9lc250LWV4aXN0Jyk7IC8v
        IHRocm93cyBlcnJvcgoqIGBgYAoqCiogQG1ldGhvZCBmaW5kV2l0aEFzc2Vy
        dAoqIEBwYXJhbSB7U3RyaW5nfSBzZWxlY3RvciBqUXVlcnkgc2VsZWN0b3Ig
        c3RyaW5nIGZvciBmaW5kaW5nIGFuIGVsZW1lbnQgd2l0aGluCiogdGhlIERP
        TQoqIEByZXR1cm4ge09iamVjdH0galF1ZXJ5IG9iamVjdCByZXByZXNlbnRp
        bmcgdGhlIHJlc3VsdHMgb2YgdGhlIHF1ZXJ5CiogQHRocm93cyB7RXJyb3J9
        IHRocm93cyBlcnJvciBpZiBqUXVlcnkgb2JqZWN0IHJldHVybmVkIGhhcyBh
        IGxlbmd0aCBvZiAwCiovCmhlbHBlcignZmluZFdpdGhBc3NlcnQnLCBmaW5k
        V2l0aEFzc2VydCk7CgovKioKICBDYXVzZXMgdGhlIHJ1biBsb29wIHRvIHBy
        b2Nlc3MgYW55IHBlbmRpbmcgZXZlbnRzLiBUaGlzIGlzIHVzZWQgdG8gZW5z
        dXJlIHRoYXQKICBhbnkgYXN5bmMgb3BlcmF0aW9ucyBmcm9tIG90aGVyIGhl
        bHBlcnMgKG9yIHlvdXIgYXNzZXJ0aW9ucykgaGF2ZSBiZWVuIHByb2Nlc3Nl
        ZC4KCiAgVGhpcyBpcyBtb3N0IG9mdGVuIHVzZWQgYXMgdGhlIHJldHVybiB2
        YWx1ZSBmb3IgdGhlIGhlbHBlciBmdW5jdGlvbnMgKHNlZSAnY2xpY2snLAog
        ICdmaWxsSW4nLCd2aXNpdCcsZXRjKS4KCiAgRXhhbXBsZToKCiAgYGBgCiAg
        RW1iZXIuVGVzdC5yZWdpc3RlckhlbHBlcignbG9naW5Vc2VyJywgZnVuY3Rp
        b24oYXBwLCB1c2VybmFtZSwgcGFzc3dvcmQpIHsKICAgIHZpc2l0KCdzZWN1
        cmVkL3BhdGgvaGVyZScpCiAgICAuZmlsbEluKCcjdXNlcm5hbWUnLCB1c2Vy
        bmFtZSkKICAgIC5maWxsSW4oJyNwYXNzd29yZCcsIHVzZXJuYW1lKQogICAg
        LmNsaWNrKCcuc3VibWl0JykKCiAgICByZXR1cm4gd2FpdChhcHApOwogIH0p
        OwoKICBAbWV0aG9kIHdhaXQKICBAcGFyYW0ge09iamVjdH0gdmFsdWUgVGhl
        IHZhbHVlIHRvIGJlIHJldHVybmVkLgogIEByZXR1cm4ge1JTVlAuUHJvbWlz
        ZX0KICBgYGAKKi8KaGVscGVyKCd3YWl0Jywgd2FpdCk7Cgp9KSgpOwoKCgoo
        ZnVuY3Rpb24oKSB7Ci8qKgogIEVtYmVyIFRlc3RpbmcKCiAgQG1vZHVsZSBl
        bWJlcgogIEBzdWJtb2R1bGUgZW1iZXItdGVzdGluZwogIEByZXF1aXJlcyBl
        bWJlci1hcHBsaWNhdGlvbgoqLwoKfSkoKTsKCihmdW5jdGlvbigpIHsKLyoq
        CkVtYmVyCgpAbW9kdWxlIGVtYmVyCiovCgpmdW5jdGlvbiB0aHJvd1dpdGhN
        ZXNzYWdlKG1zZykgewogIHJldHVybiBmdW5jdGlvbigpIHsKICAgIHRocm93
        IG5ldyBFbWJlci5FcnJvcihtc2cpOwogIH07Cn0KCmZ1bmN0aW9uIGdlbmVy
        YXRlUmVtb3ZlZENsYXNzKGNsYXNzTmFtZSkgewogIHZhciBtc2cgPSAiIGhh
        cyBiZWVuIG1vdmVkIGludG8gYSBwbHVnaW46IGh0dHBzOi8vZ2l0aHViLmNv
        bS9lbWJlcmpzL2VtYmVyLXN0YXRlcyI7CgogIHJldHVybiB7CiAgICBleHRl
        bmQ6IHRocm93V2l0aE1lc3NhZ2UoY2xhc3NOYW1lICsgbXNnKSwKICAgIGNy
        ZWF0ZTogdGhyb3dXaXRoTWVzc2FnZShjbGFzc05hbWUgKyBtc2cpCiAgfTsK
        fQoKRW1iZXIuU3RhdGVNYW5hZ2VyID0gZ2VuZXJhdGVSZW1vdmVkQ2xhc3Mo
        IkVtYmVyLlN0YXRlTWFuYWdlciIpOwoKLyoqCiAgVGhpcyB3YXMgZXhwb3J0
        ZWQgdG8gZW1iZXItc3RhdGVzIHBsdWdpbiBmb3IgdiAxLjAuMCByZWxlYXNl
        LiBTZWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9lbWJlcmpzL2VtYmVyLXN0YXRl
        cwogIAogIEBjbGFzcyBTdGF0ZU1hbmFnZXIKICBAbmFtZXNwYWNlIEVtYmVy
        CiovCgpFbWJlci5TdGF0ZSA9IGdlbmVyYXRlUmVtb3ZlZENsYXNzKCJFbWJl
        ci5TdGF0ZSIpOwoKLyoqCiAgVGhpcyB3YXMgZXhwb3J0ZWQgdG8gZW1iZXIt
        c3RhdGVzIHBsdWdpbiBmb3IgdiAxLjAuMCByZWxlYXNlLiBTZWU6IGh0dHBz
        Oi8vZ2l0aHViLmNvbS9lbWJlcmpzL2VtYmVyLXN0YXRlcwogIAogIEBjbGFz
        cyBTdGF0ZQogIEBuYW1lc3BhY2UgRW1iZXIKKi8KCn0pKCk7CgoKfSkoKTsK
    http_version: 
  recorded_at: Wed, 30 Oct 2013 21:47:17 GMT
- request:
    method: get
    uri: http://builds.emberjs.com/release/ember-data.js
    body:
      encoding: US-ASCII
      string: ''
    headers:
      Accept:
      - ! '*/*'
      User-Agent:
      - Ruby
  response:
    status:
      code: 404
      message: Not Found
    headers:
      X-Amz-Request-Id:
      - 2B545EECBD479228
      X-Amz-Id-2:
      - +nU11OpVtq9h8Jx1XUwfsCSPz7IBs5TFeoApZ9+Z0owhe6o9dGS6xli/LrUekr1Z
      Content-Type:
      - text/html; charset=utf-8
      Content-Length:
      - '344'
      Date:
      - Wed, 30 Oct 2013 21:47:17 GMT
      Server:
      - AmazonS3
    body:
      encoding: US-ASCII
      string: ! '<html>

        <head><title>404 Not Found</title></head>

        <body>

        <h1>404 Not Found</h1>

        <ul>

        <li>Code: NoSuchKey</li>

        <li>Message: The specified key does not exist.</li>

        <li>Key: release/ember-data.js</li>

        <li>RequestId: 2B545EECBD479228</li>

        <li>HostId: +nU11OpVtq9h8Jx1XUwfsCSPz7IBs5TFeoApZ9+Z0owhe6o9dGS6xli/LrUekr1Z</li>

        </ul>

        <hr/>

        </body>

        </html>

'
    http_version: 
  recorded_at: Wed, 30 Oct 2013 21:47:17 GMT
recorded_with: VCR 2.6.0
